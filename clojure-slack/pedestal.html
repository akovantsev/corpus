<!DOCTYPE html>
<head><title>pedestal</title><meta charset="UTF-8" /><style type="text/css">body {
    font-family: Monaco, Menlo, Consolas, "Courier New", sans-serif;
    font-size: 12px;
    margin: 15px;
}
h2 {text-align: center}
pre,
code {
    font-family: Monaco, Menlo, Consolas, "Courier New", monospace;
    color: #333;
    line-break: anywhere;
}
a {
    line-break: anywhere;
}
code {
    /*line-height: 1.2;*/
    white-space: normal;
    color: #c25;
    background-color: #f7f7f9;
    border: 1px solid #e1e1e8;
}
pre {
    margin: .5rem 0 .2rem;
    font-size: .75rem;
    /*line-height: 1.15rem;*/
    background: #fbfaf8;
    padding: .5rem;
    word-break: normal;
    display: block;
    border: 1px solid rgba(0, 0, 0, .15);
    white-space: pre-wrap;
    word-wrap: break-word;
    border-radius: 4px;
}
/*span {*/
z {
    white-space: pre-wrap;
}

d {padding-right: 8px;}
h {padding-right: 16px;}

w, r {
    margin-right: 10px;
    padding-right: 8px;
    text-align: right;
}

d,h,w,r {
    background-color: lavender;
    margin-top: 1px;
    display: inline-table; /* prevents doubleclick selection spillover into neighbour elements */
}

h:hover,
d:hover {
    text-decoration: underline;
    color: blue;
    cursor: row-resize;
}
d {padding-right: 8px;}
h {padding-right: 16px;}

z {display: block;}

z:target > r,
z:target > w,
z:target > d,
z:target > h {
    background-color: aquamarine
}

#filters-container {
    position: fixed;
    left: 50px;
    z-index: 1;
}
#filters-container > input {
    /*column:*/
    display: block;
    outline-color: aquamarine;
}

y {
    cursor: pointer;
    text-decoration: none;
    color: blue;
    position: absolute;
    left: 3px;
}

y:hover {
    text-decoration: underline;
    color: aquamarine;
}


</style></head><body><style id="css-username">w {min-width: 192px;} r {min-width: 224px;}</style><style id="css-text-filter"></style><style id="css-date-filter"></style><style id="css-filter-override"></style><p id="filters-container"><input id="text-filter" onkeyup="debtextfilter(this.value)" placeholder="filter text" type="string" /><button hidden="hidden" id="date-filter" onclick="cleardatefilter()"></button></p><h2>#pedestal</h2><pre><i>generated UTC: 2023-11-22 19:58</i><i>
latest data: <a href="https://clojurians-log.clojureverse.org/pedestal/2023-11-14">https://clojurians-log.clojureverse.org/pedestal/2023-11-14</a></i><i>
messages: 7128</i>
pro tips:
* Double click on text to filter by it. (doubleclick + cmd-f for extra points).
* Click on date to keep day visible regardless of filter.
* Click on time to keep hour visible regardless of filter.</pre><script>const textFilterInput = document.getElementById("text-filter");
const dateFilterInput = document.getElementById("date-filter");
const filterTextStyle = document.getElementById("css-text-filter");
const filterDateStyle = document.getElementById("css-date-filter");
const filterStyleOverride = document.getElementById("css-filter-override");



function textFilter2(text) {
    var style = '';
    if (text.trim() !== '') {
        text.split(' ').forEach(function (t) {
            if (t !== '') {
                style = style + "z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
            }
        });
    }
    filterTextStyle.innerHTML = style;
}
function textFilter(text) {
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (s){
            var sid = s.getAttribute("id");
            text.split(' ').forEach(function (t) {
                if (t !== '') {
                    filterTextStyle.innerHTML += "\ng#" + sid + " > z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
                }
            });
        })
    }
}
function textFilter3(text) {
    console.time("text search");
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        const re = new RegExp( text, "i");
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (w){
            var zs = w.getElementsByTagName ("z");
            var zsArr = Array.prototype.slice.call(zs);
            var ids = zsArr
                .filter(function (el) {
                    return !re.test(el.innerText);
                })
                .map(function (el){
                    return el.getAttribute("id");
                });
            if (ids) {
                filterTextStyle.innerHTML += "\n#" + ids.join(",#") + " {display: none; opacity: 0.6}";
            }
        })
    }
    console.timeEnd("text search");
}


function filterSelection (e) {
    let sel = document.getSelection();
    let txt = sel.toString();
    textFilterInput.value = (txt || "");
    textFilter(txt);
}
function debounce1(callback, delay) {
    let timeout;
    return function(arg) {
        clearTimeout(timeout);
        timeout = setTimeout(callback, delay, arg);
    }
}

function keyUp (e) {
    if (e.code === "KeyF" && e.ctrlKey) {
        let txt = document.getSelection().toString();
        if (txt.length > 0) {
            textFilterInput.value = (txt || "");
            textFilter(txt);
        }
    }
}


function showDateTimes (el, datestr, hourstr) {
    dateFilterInput.innerText = "clear: " + datestr + " " + hourstr;
    dateFilterInput.hidden = false;
    let ids = [];
    const clicked = el.parentElement;  // el = z#id/t
    ids.push(clicked.id);
    // var idbefore, idafter;
    let cursor = clicked;
    function nextCursor (cursor) {
        const id = (cursor && cursor.id);
        const d = (cursor && cursor.children[1]);
        const h = (cursor && cursor.children[2])
        if (id) {
            ids.push(id); //includes 1st next-id not matching date.
        } else {
            cursor = null;
        }
        if (d && (d.textContent === datestr) && (!hourstr || (h && h.textContent.startsWith(hourstr)))) {
        } else {
            cursor = null;
        }
        return cursor;
    }
    while (cursor) {
        cursor = nextCursor(cursor.previousElementSibling);
    }

    cursor = clicked;

    while (cursor) {
        cursor = nextCursor(cursor.nextElementSibling);
    }


    var style1 = '';
    var style2 = '';
    var content;
    if (datestr.includes(" ")) { //hour
        content = " *";
    } else {
        content = "**";
    }
    ids.forEach(function (id) {
        if (id) {
            style1 = style1 + ", #" + id;
            style2 = style2 + ", #" + id + " h:after";
        }
    })
    if (style1) {
        style1 = style1.substring(1) + " {display: block !important}";
    }
    if (style2) {
        style2 = style2.substring(1) + " {content: \"" + content + "\"; position: absolute}"
    }
    filterDateStyle.innerHTML = style1 + "\n" + style2;
}

// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView
function filterDay (el) {
    showDateTimes(el, el.textContent);
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function filterHours (el) {
    showDateTimes(el, el.previousElementSibling.textContent, el.textContent.substring(0, 2));
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function forceShowSelected (el) {
    var id = el.parentElement.id
    if (id) {
        window.location.hash = "#" + id;
        filterStyleOverride.innerHTML = ""
            + "#" + id
            + " {display: block !important;}"
            + "#" + id + " h:after"
            + " {content: \"  #\"; position: absolute}";

    } else {
        window.location.hash = "";
        filterStyleOverride.innerHTML = "";
    }
}


function cleardatefilter () {
    dateFilterInput.hidden = true;
    dateFilterInput.innerText = "";
    filterDateStyle.innerHTML = "";
}

const debtextfilter = debounce1(textFilter, 200);

function doubleClick (e) {
    if (e.target.tagName !== "INPUT"
        && e.target.tagName !== "D"
        && e.target.tagName !== "H") {

        filterSelection();
        e.target.scrollIntoView({behavior: "auto", block: "center", inline: "start"});
    }
}

function onclick(e) {
    if (e.target.tagName === "Y") {
        e.preventDefault();
        forceShowSelected(e.target);
    } else if (e.target.tagName === "D") {
        e.preventDefault();
        filterDay(e.target);
    } else if (e.target.tagName === "H") {
        e.preventDefault();
        filterHours(e.target);
    }
}

document.onclick = onclick;
document.ondblclick = doubleClick;
document.onkeyup = keyUp;
textFilterInput.focus();
</script><div><g id="s0"><z id="t1453663565" t="frankiesardo I was going to create it but it’s nice to see someone already started it"><y>#</y><d>2016-01-24</d><h>19:26</h><w>frankiesardo</w>I was going to create it but it’s nice to see someone already started it</z><z id="t1453663606" t="frankiesardo Not 100% related, but if you have questions about tripod this can be a good place to ask too"><y>#</y><d>2016-01-24</d><h>19:26</h><w>frankiesardo</w>Not 100% related, but if you have questions about tripod this can be a good place to ask too</z><z id="t1453744408" t="jplaza somebody has a fast way/script to auto-reload updated namespaces when running server with lein run-dev ?"><y>#</y><d>2016-01-25</d><h>17:53</h><w>jplaza</w>somebody has a fast way/script to auto-reload updated namespaces when running server with <code>lein run-dev</code> ?</z><z id="t1453745509" t="jonahbenton hey [:attrs {:href &quot;/_/_/users/U0624D031&quot;}] you should be able to use https://github.com/weavejester/ns-tracker as described in https://cmdrdats.wordpress.com/2012/08/14/auto-reloading-code-with-clojure/"><y>#</y><d>2016-01-25</d><h>18:11</h><w>jonahbenton</w>hey <a>@jplaza</a> you should be able to use <a href="https://github.com/weavejester/ns-tracker" target="_blank">https://github.com/weavejester/ns-tracker</a> as described in <a href="https://cmdrdats.wordpress.com/2012/08/14/auto-reloading-code-with-clojure/" target="_blank">https://cmdrdats.wordpress.com/2012/08/14/auto-reloading-code-with-clojure/</a></z><z id="t1453746769" t="jplaza Cool thanks! [:attrs {:href &quot;/_/_/users/U0FF3A4V6&quot;}]"><y>#</y><d>2016-01-25</d><h>18:32</h><w>jplaza</w>Cool thanks! <a>@jonahbenton</a></z><z id="t1453810168" t="frankiesardo [:attrs {:href &quot;/_/_/users/U0624D031&quot;}] : there’s also a good example in pedestal-micro https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/service.clj"><y>#</y><d>2016-01-26</d><h>12:09</h><w>frankiesardo</w><a>@jplaza</a>: there’s also a good example in pedestal-micro <a href="https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/service.clj" target="_blank">https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/service.clj</a></z><z id="t1453817379" t="xlevus Is anybody able to explain (defroutes route-table [[[&quot;/events&quot; {:get [::events (start-event-stream stream-ready)]}]]]) in : https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-sse.md Does :: events need to be implemented? or is it just an arbitrary symbol?"><y>#</y><d>2016-01-26</d><h>14:09</h><w>xlevus</w>Is anybody able to explain <pre>(defroutes route-table
  [[[&quot;/events&quot; {:get [::events (start-event-stream stream-ready)]}]]])</pre> in : <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-sse.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-sse.md</a>
Does <b>::</b>events need to be implemented? or is it just an arbitrary symbol?</z><z id="t1453819111" t="jonahbenton hey [:attrs {:href &quot;/_/_/users/U0529P22K&quot;}] . the short answer is that it&apos;s an optional part of the routing data structure. see https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#verb-maps . :: events is an optional name for that particular route, and see https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#route-names for more about route naming."><y>#</y><d>2016-01-26</d><h>14:38</h><w>jonahbenton</w>hey <a>@xlevus</a>. the short answer is that it&apos;s an optional part of the routing data structure. 
see <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#verb-maps" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#verb-maps</a>. <b>::</b>events is an optional name for that particular route, and see <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#route-names" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-routing.md#route-names</a> for more about route naming.</z><z id="t1453819253" t="xlevus hmm ok"><y>#</y><d>2016-01-26</d><h>14:40</h><w>xlevus</w>hmm ok</z><z id="t1453819938" t="xlevus I keep getting Exception in thread &quot;async-thread-macro-1&quot; java.lang.ClassCastException: clojure.lang.Keyword cannot be cast to java.util.Locale whenever I do anything in the function passed to start-event-stream . But when I make the body of the function just nil it seems to work fine, and my browser appears to open the EventStream connection fine."><y>#</y><d>2016-01-26</d><h>14:52</h><w>xlevus</w>I keep getting <code>Exception in thread &quot;async-thread-macro-1&quot; java.lang.ClassCastException: clojure.lang.Keyword cannot be cast to java.util.Locale</code> whenever I do anything in the function passed to <code>start-event-stream</code>. 
But when I make the body of the function just <code>nil</code> it seems to work fine, and my browser appears to open the EventStream connection fine.</z><z id="t1453820407" t="xlevus oh. nope. only happens with timbre. ok."><y>#</y><d>2016-01-26</d><h>15:00</h><w>xlevus</w>oh. nope. only happens with timbre. ok.</z><z id="t1453821261" t="jonahbenton all well?"><y>#</y><d>2016-01-26</d><h>15:14</h><w>jonahbenton</w>all well?</z><z id="t1453821687" t="xlevus yeah, mostly. Can&apos;t seem to call Timbre logging functions within anything that&apos;s async. but might be another issue altogether"><y>#</y><d>2016-01-26</d><h>15:21</h><w>xlevus</w>yeah, mostly. Can&apos;t seem to call Timbre logging functions within anything that&apos;s async. but might be another issue altogether</z><z id="t1453824448" t="jplaza Cool thanks [:attrs {:href &quot;/_/_/users/U050SU21B&quot;}] ! I’m still trying to understand why isn’t this something that comes as part of the library. Or someone builds something on top of pedestal. This is a pretty common use case when developing web apps"><y>#</y><d>2016-01-26</d><h>16:07</h><w>jplaza</w>Cool thanks <a>@frankie</a> ! I’m still trying to understand why isn’t this something that comes as part of the library. Or someone builds something on top of pedestal. This is a pretty common use case when developing web apps</z><z id="t1453824537" t="frankiesardo jplaza: I think they’ve packaged it under the service-tools https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj"><y>#</y><d>2016-01-26</d><h>16:08</h><w>frankiesardo</w>jplaza: I think they’ve packaged it under the service-tools <a href="https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj</a></z><z id="t1453993266" t="christianromney re: the ::events (sorry late to the party)"><y>#</y><d>2016-01-28</d><h>15:01</h><w>christianromney</w>re: the <code>::events</code> (sorry late to the party)</z><z id="t1453993282" t="christianromney [&quot;/events&quot; {:get [::events (start-event-stream stream-ready)]}]"><y>#</y><d>2016-01-28</d><h>15:01</h><w>christianromney</w><code>[&quot;/events&quot; {:get [::events (start-event-stream stream-ready)]}]</code></z><z id="t1453993341" t="christianromney this maps GET requests the url ”/events” to (start-event-stream) but also names the route"><y>#</y><d>2016-01-28</d><h>15:02</h><w>christianromney</w>this maps GET requests the url <code>”/events”</code> to <code>(start-event-stream)</code> but also names the route</z><z id="t1453993369" t="christianromney you can have unnamed routes {:get (start-event-stream stream-ready)}"><y>#</y><d>2016-01-28</d><h>15:02</h><w>christianromney</w>you can have unnamed routes <code>{:get (start-event-stream stream-ready)}</code></z><z id="t1453993375" t="christianromney or named routes as above"><y>#</y><d>2016-01-28</d><h>15:02</h><w>christianromney</w>or named routes as above</z><z id="t1453993392" t="christianromney you name them with a keyword that you can pass to route/url-for"><y>#</y><d>2016-01-28</d><h>15:03</h><w>christianromney</w>you name them with a keyword that you can pass to <code>route/url-for</code></z><z id="t1453993423" t="christianromney in this case, the keyword is namespaced, hence the extra colon :"><y>#</y><d>2016-01-28</d><h>15:03</h><w>christianromney</w>in this case, the keyword is namespaced, hence the extra colon :</z><z id="t1453993434" t="christianromney so assuming that file is in ns"><y>#</y><d>2016-01-28</d><h>15:03</h><w>christianromney</w>so assuming that file is in ns</z><z id="t1453993447" t="christianromney (ns example.routes)"><y>#</y><d>2016-01-28</d><h>15:04</h><w>christianromney</w><code>(ns example.routes)</code></z><z id="t1453993475" t="christianromney then ::events is shorthand for :example.routes/events"><y>#</y><d>2016-01-28</d><h>15:04</h><w>christianromney</w>then <code>::events</code> is shorthand for <code>:example.routes/events</code></z><z id="t1453993500" t="christianromney this allows you to use a generic word like ‘events&apos;"><y>#</y><d>2016-01-28</d><h>15:05</h><w>christianromney</w>this allows you to use a generic word like ‘events&apos;</z><z id="t1453993505" t="christianromney while avoiding name clashes"><y>#</y><d>2016-01-28</d><h>15:05</h><w>christianromney</w>while avoiding name clashes</z><z id="t1453993557" t="christianromney from a hypothetically different namespace, assume you want to redirect someone to that endpoint"><y>#</y><d>2016-01-28</d><h>15:05</h><w>christianromney</w>from a hypothetically different namespace, assume you want to redirect someone to that endpoint</z><z id="t1453993560" t="christianromney you could do"><y>#</y><d>2016-01-28</d><h>15:06</h><w>christianromney</w>you could do</z><z id="t1453993636" t="christianromney `(ns example.other (:require [io.pedestal.http.route :as route] [example.routes :as r])) … (ring/redirect (route/url-for :: r/events)) `"><y>#</y><d>2016-01-28</d><h>15:07</h><w>christianromney</w>`(ns example.other 
    (:require [io.pedestal.http.route :as route]
                        [example.routes :as r]))
…
(ring/redirect (route/url-for <b>::</b>r/events)) `</z><z id="t1453993648" t="christianromney meh forgive the formatting, hopefully the idea is clear..."><y>#</y><d>2016-01-28</d><h>15:07</h><w>christianromney</w>meh forgive the formatting, hopefully the idea is clear...</z><z id="t1453993727" t="christianromney hope that helps someone"><y>#</y><d>2016-01-28</d><h>15:08</h><w>christianromney</w>hope that helps someone</z><z id="t1454069068" t="xlevus [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] : Cheers 💯"><y>#</y><d>2016-01-29</d><h>12:04</h><w>xlevus</w><a>@christianromney</a>: Cheers <b>💯</b></z><z id="t1456412019" t="rauh I&apos;m not sure if it&apos;s a bug or not. But if not, default-parser-map should def. have an example with :transit-options since it needs an awkward bracket. This works:"><y>#</y><d>2016-02-25</d><h>14:53</h><w>rauh</w>I&apos;m not sure if it&apos;s a bug or not. But if not, <code>default-parser-map</code> should def. have an example with <code>:transit-options</code> since it needs an awkward bracket. This works:</z><z id="t1456412065" t="rauh Without vectoring the options map it does nothing and gets silently ignored."><y>#</y><d>2016-02-25</d><h>14:54</h><w>rauh</w>Without vectoring the options map it does nothing and gets silently ignored.</z><z id="t1458071018" t="oliy hi everyone, i&apos;ve released a library called pedestal-api for building swagger-driven REST apis on pedestal"><y>#</y><d>2016-03-15</d><h>19:43</h><w>oliy</w>hi everyone, i&apos;ve released a library called pedestal-api for building swagger-driven REST apis on pedestal</z><z id="t1458071027" t="oliy you can read an introduction here: https://blog.juxt.pro/posts/pedestal-api.html"><y>#</y><d>2016-03-15</d><h>19:43</h><w>oliy</w>you can read an introduction here: <a href="https://blog.juxt.pro/posts/pedestal-api.html" target="_blank">https://blog.juxt.pro/posts/pedestal-api.html</a></z><z id="t1458071045" t="oliy or go straight to the library here: https://github.com/oliyh/pedestal-api"><y>#</y><d>2016-03-15</d><h>19:44</h><w>oliy</w>or go straight to the library here: <a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a></z><z id="t1458071052" t="oliy hope you find it useful"><y>#</y><d>2016-03-15</d><h>19:44</h><w>oliy</w>hope you find it useful</z><z id="t1458247596" t="afhammad how does ns reloading in dev mode work in pedestal? I generated a new project using lein new pedestal-service and ran using lein run-dev but changes aren’t picked up without restarting the repl/server"><y>#</y><d>2016-03-17</d><h>20:46</h><w>afhammad</w>how does ns reloading in dev mode work in pedestal? I generated a new project using <code>lein new pedestal-service</code> and ran using <code>lein run-dev</code> but changes aren’t picked up without restarting the repl/server</z><z id="t1458284227" t="rauh [:attrs {:href &quot;/_/_/users/U06BBKF2A&quot;}] : If you make changes to the server config itself then you have to restart it manually or use a component-like framework that does that for you."><y>#</y><d>2016-03-18</d><h>06:57</h><w>rauh</w><a>@afhammad</a>: If you make changes to the server config itself then you have to restart it manually or use a component-like framework that does that for you.</z><z id="t1458284263" t="rauh If you just want the routes/handler to stay up to date just save your file and make sure you specify the routes as a function with a deref."><y>#</y><d>2016-03-18</d><h>06:57</h><w>rauh</w>If you just want the routes/handler to stay up to date just save your file and make sure you specify the routes as a function with a deref.</z><z id="t1458284343" t="rauh [:attrs {:href &quot;/_/_/users/U06BBKF2A&quot;}] : https://github.com/pedestal/pedestal/issues/356"><y>#</y><d>2016-03-18</d><h>06:59</h><w>rauh</w><a>@afhammad</a>:  <a href="https://github.com/pedestal/pedestal/issues/356" target="_blank">https://github.com/pedestal/pedestal/issues/356</a></z><z id="t1458416715" t="lmergen hey guys, i&apos;m interested in possibly refactoring an early stage api server away from ring, due to the lack of async support, and it feels a bit... chaotic"><y>#</y><d>2016-03-19</d><h>19:45</h><w>lmergen</w>hey guys, i&apos;m interested in possibly refactoring an early stage api server away from ring, due to the lack of async support, and it feels a bit... chaotic</z><z id="t1458416747" t="lmergen i see a great place for pedestal here, but my development environment is under windows, which i see is unsupported"><y>#</y><d>2016-03-19</d><h>19:45</h><w>lmergen</w>i see a great place for pedestal here, but my development environment is under windows, which i see is unsupported</z><z id="t1458416826" t="lmergen what kind of level of &quot;unsupported&quot; is this? is it &quot;it will not even compile&quot;-unsupported, or &quot;dont use it for production&quot;-unsupported?"><y>#</y><d>2016-03-19</d><h>19:47</h><w>lmergen</w>what kind of level of &quot;unsupported&quot; is this? is it &quot;it will not even compile&quot;-unsupported, or &quot;dont use it for production&quot;-unsupported?</z><z id="t1458416877" t="lmergen since we&apos;re already using vagrant, an option could be to run the entire dev environment in a vagrant box, but that would complicate the development process a lot i think"><y>#</y><d>2016-03-19</d><h>19:47</h><w>lmergen</w>since we&apos;re already using vagrant, an option could be to run the entire dev environment in a vagrant box, but that would complicate the development process a lot i think</z><z id="t1458426321" t="jonahbenton hey [:attrs {:href &quot;/_/_/users/U0M8Y3G6N&quot;}] pedestal ships with some ancillary .sh scripts, but there&apos;s nothing in the library that is OS specific."><y>#</y><d>2016-03-19</d><h>22:25</h><w>jonahbenton</w>hey <a>@lmergen</a> pedestal ships with some ancillary .sh scripts, but there&apos;s nothing in the library that is OS specific.</z><z id="t1458426386" t="lmergen ahhh so there&apos;s nothing to worry about really"><y>#</y><d>2016-03-19</d><h>22:26</h><w>lmergen</w>ahhh so there&apos;s nothing to worry about really</z><z id="t1458426392" t="lmergen that&apos;s great news"><y>#</y><d>2016-03-19</d><h>22:26</h><w>lmergen</w>that&apos;s great news</z><z id="t1458426392" t="jonahbenton should not be"><y>#</y><d>2016-03-19</d><h>22:26</h><w>jonahbenton</w>should not be</z><z id="t1458426407" t="lmergen you should update the github Readme"><y>#</y><d>2016-03-19</d><h>22:26</h><w>lmergen</w>you should update the github Readme</z><z id="t1458426448" t="jonahbenton yeah, agree, that should go into an issue"><y>#</y><d>2016-03-19</d><h>22:27</h><w>jonahbenton</w>yeah, agree, that should go into an issue</z><z id="t1458426465" t="lmergen it kind of had me thinking it&apos;s currently not working. it should read something like &quot;although we don&apos;t actively test it, it should work. blah blah&quot;"><y>#</y><d>2016-03-19</d><h>22:27</h><w>lmergen</w>it kind of had me thinking it&apos;s currently not working. it should read something like &quot;although we don&apos;t actively test it, it should work. blah blah&quot;</z><z id="t1458426558" t="jonahbenton yeah- there has been a flurry of activity in the repo recently, that would be good to clarify"><y>#</y><d>2016-03-19</d><h>22:29</h><w>jonahbenton</w>yeah- there has been a flurry of activity in the repo recently, that would be good to clarify</z><z id="t1458426593" t="lmergen i&apos;ll make sure to test it soon and if it works send in a PR for the Readme simple_smile"><y>#</y><d>2016-03-19</d><h>22:29</h><w>lmergen</w>i&apos;ll make sure to test it soon and if it works send in a PR for the Readme <b>simple_smile</b></z><z id="t1458426641" t="jonahbenton that would be great!"><y>#</y><d>2016-03-19</d><h>22:30</h><w>jonahbenton</w>that would be great!</z><z id="t1458426744" t="lmergen what&apos;s the recommended way to run pedestal, if i&apos;m planning on doing some async work? is jetty9 already supported?"><y>#</y><d>2016-03-19</d><h>22:32</h><w>lmergen</w>what&apos;s the recommended way to run pedestal, if i&apos;m planning on doing some async work? is jetty9 already supported?</z><z id="t1458427395" t="jonahbenton it&apos;s been a while since i&apos;ve looked but you should be able to write async interceptors and use non-blocking io with any container."><y>#</y><d>2016-03-19</d><h>22:43</h><w>jonahbenton</w>it&apos;s been a while since i&apos;ve looked but you should be able to write async interceptors and use non-blocking io with any container.</z><z id="t1458427426" t="jonahbenton and yes the jetty adapter pulls in jetty 9"><y>#</y><d>2016-03-19</d><h>22:43</h><w>jonahbenton</w>and yes the jetty adapter pulls in jetty 9</z><z id="t1458432612" t="afhammad hey, can anyone point me to an example of a pedestal + mount + figwheel setup?"><y>#</y><d>2016-03-20</d><h>00:10</h><w>afhammad</w>hey, can anyone point me to an example of a pedestal + mount + figwheel setup?</z><z id="t1458504106" t="xlevus Is there a sane way to debug routes? I&apos;ve done a (concat api-routes routes) to join two defroutes together. and when doing (map :path all-routes) I more or less get what I expect... (&quot;/&quot; &quot;/about&quot; &quot;/api/swagger.json&quot; &quot;/api/*resource&quot;) but doing a GET on /api/swagger.json 404s."><y>#</y><d>2016-03-20</d><h>20:01</h><w>xlevus</w>Is there a sane way to debug routes? 
I&apos;ve done a <code>(concat api-routes routes)</code> to join two <code>defroutes</code> together. and when doing <code>(map :path all-routes)</code> I more or less get what I expect...  <code>(&quot;/&quot; &quot;/about&quot; &quot;/api/swagger.json&quot; &quot;/api/*resource&quot;)</code> but doing a GET on /api/swagger.json 404s.</z><z id="t1458509148" t="xlevus ahh. Completely different issue. Was following: https://blog.juxt.pro/posts/pedestal-api.html and the glob was consuming everything for whatever reason"><y>#</y><d>2016-03-20</d><h>21:25</h><w>xlevus</w>ahh. Completely different issue. Was following: <a href="https://blog.juxt.pro/posts/pedestal-api.html" target="_blank">https://blog.juxt.pro/posts/pedestal-api.html</a> and the glob was consuming everything for whatever reason</z><z id="t1458511162" t="xlevus but how the example redirects / to /index.html and then serves content is pretty much a mystery. And why having [&quot;/*resource&quot; {:get api/swagger-ui}] in my API routes gobbles everything under /api up in my project and not in the demo project is also a mystery. Questions for tomorrow I think."><y>#</y><d>2016-03-20</d><h>21:59</h><w>xlevus</w>but how the example redirects <code>/</code> to <code>/index.html</code> and then serves content is pretty much a mystery. 
And why having <code>[&quot;/*resource&quot; {:get api/swagger-ui}]</code> in my API routes gobbles everything under <code>/api</code> up in my project and not in the demo project is also a mystery.
Questions for tomorrow I think.</z><z id="t1458594375" t="oliy [:attrs {:href &quot;/_/_/users/U0529P22K&quot;}] are you using linear search?"><y>#</y><d>2016-03-21</d><h>21:06</h><w>oliy</w><a>@xlevus</a> are you using linear search?</z><z id="t1458594385" t="xlevus linear search?"><y>#</y><d>2016-03-21</d><h>21:06</h><w>xlevus</w>linear search?</z><z id="t1458594395" t="oliy It&apos;s a pedestal routing option"><y>#</y><d>2016-03-21</d><h>21:06</h><w>oliy</w>It&apos;s a pedestal routing option</z><z id="t1458594448" t="xlevus how do I know?"><y>#</y><d>2016-03-21</d><h>21:07</h><w>xlevus</w>how do I know?</z><z id="t1458594543" t="oliy ::bootstrap/router :linear-search"><y>#</y><d>2016-03-21</d><h>21:09</h><w>oliy</w><code>::bootstrap/router :linear-search</code></z><z id="t1458594549" t="oliy is that in your service map?"><y>#</y><d>2016-03-21</d><h>21:09</h><w>oliy</w>is that in your service map?</z><z id="t1458594620" t="oliy /*resource needs to eat everything under the api in order to serve the UI (which has many, many resources) but requests to your API endpoints should be tried first, and the easiest way to guarantee that is to use linear search"><y>#</y><d>2016-03-21</d><h>21:10</h><w>oliy</w><code>/*resource</code> needs to eat everything under the api in order to serve the UI (which has many, many resources) but requests to your API endpoints should be tried first,  and the easiest way to guarantee that is to use linear search</z><z id="t1458594643" t="xlevus nope. it&apos;s not. adds"><y>#</y><d>2016-03-21</d><h>21:10</h><w>xlevus</w>nope. it&apos;s not. adds</z><z id="t1458594691" t="xlevus ahah! pow. right in the kisser."><y>#</y><d>2016-03-21</d><h>21:11</h><w>xlevus</w>ahah! pow. right in the kisser.</z><z id="t1458594786" t="xlevus [:attrs {:href &quot;/_/_/users/U076R6N1L&quot;}] : Chur!"><y>#</y><d>2016-03-21</d><h>21:13</h><w>xlevus</w><a>@oliy</a>: Chur!</z><z id="t1458594809" t="oliy welcome"><y>#</y><d>2016-03-21</d><h>21:13</h><w>oliy</w>welcome</z><z id="t1458594827" t="xlevus Might be worth mentioning in https://blog.juxt.pro/posts/pedestal-api.html or https://github.com/oliyh/pedestal-api/blob/master/example/src/pedestal_api_example/service.clj"><y>#</y><d>2016-03-21</d><h>21:13</h><w>xlevus</w>Might be worth mentioning in <a href="https://blog.juxt.pro/posts/pedestal-api.html" target="_blank">https://blog.juxt.pro/posts/pedestal-api.html</a> or <a href="https://github.com/oliyh/pedestal-api/blob/master/example/src/pedestal_api_example/service.clj" target="_blank">https://github.com/oliyh/pedestal-api/blob/master/example/src/pedestal_api_example/service.clj</a></z><z id="t1458594865" t="oliy ;; important"><y>#</y><d>2016-03-21</d><h>21:14</h><w>oliy</w><code>;; important</code></z><z id="t1458594908" t="xlevus the option in the service map isn&apos;t even mentioned in the default pedestal template. Probably would never have found it otherwise."><y>#</y><d>2016-03-21</d><h>21:15</h><w>xlevus</w>the option in the service map isn&apos;t even mentioned in the default pedestal template. Probably would never have found it otherwise.</z><z id="t1458594952" t="oliy ok thanks for your feedback, i&apos;ll add a comment in the example i think"><y>#</y><d>2016-03-21</d><h>21:15</h><w>oliy</w>ok thanks for your feedback, i&apos;ll add a comment in the example i think</z><z id="t1458594967" t="xlevus 👍"><y>#</y><d>2016-03-21</d><h>21:16</h><w>xlevus</w><b>👍</b></z><z id="t1458595129" t="xlevus I&apos;m assuming it&apos;s only needed if you want the swagger-ui?"><y>#</y><d>2016-03-21</d><h>21:18</h><w>xlevus</w>I&apos;m assuming it&apos;s only needed if you want the swagger-ui?</z><z id="t1458595133" t="oliy yep"><y>#</y><d>2016-03-21</d><h>21:18</h><w>oliy</w>yep</z><z id="t1458595143" t="oliy it&apos;s just that /*resources handler"><y>#</y><d>2016-03-21</d><h>21:19</h><w>oliy</w>it&apos;s just that <code>/*resources</code> handler</z><z id="t1458595178" t="xlevus is there any reason to use or not-use :linear-search if you don&apos;t need the UI?"><y>#</y><d>2016-03-21</d><h>21:19</h><w>xlevus</w>is there any reason to use or not-use :linear-search if you don&apos;t need the UI?</z><z id="t1458595325" t="oliy i guess it depends on if you have colliding routes and you want to have an explicit order of preference"><y>#</y><d>2016-03-21</d><h>21:22</h><w>oliy</w>i guess it depends on if you have colliding routes and you want to have an explicit order of preference</z><z id="t1458595344" t="oliy e.g. [&quot;/path/:param&quot; {...} &quot;/path/:another-param&quot; {...}] "><y>#</y><d>2016-03-21</d><h>21:22</h><w>oliy</w>e.g.
<pre>[&quot;/path/:param&quot; {...}
 &quot;/path/:another-param&quot; {...}]
</pre></z><z id="t1458595449" t="xlevus ok, ta."><y>#</y><d>2016-03-21</d><h>21:24</h><w>xlevus</w>ok, ta.</z><z id="t1458595823" t="oliy [:attrs {:href &quot;/_/_/users/U0529P22K&quot;}] i&apos;ve updated the example and readme as suggested, thanks"><y>#</y><d>2016-03-21</d><h>21:30</h><w>oliy</w><a>@xlevus</a> i&apos;ve updated the example and readme as suggested, thanks</z><z id="t1458596748" t="xlevus ta for your help. Now I can actually make things \ o /"><y>#</y><d>2016-03-21</d><h>21:45</h><w>xlevus</w>ta for your help. Now I can actually make things \ o /</z><z id="t1458596857" t="oliy welcome!"><y>#</y><d>2016-03-21</d><h>21:47</h><w>oliy</w>welcome!</z><z id="t1458684609" t="xlevus [:attrs {:href &quot;/_/_/users/U076R6N1L&quot;}] : Is there any reason your pedestal-api example re-defines the :parameters for the views that are handled via the load-pet interceptor?"><y>#</y><d>2016-03-22</d><h>22:10</h><w>xlevus</w><a>@oliy</a>: Is there any reason your pedestal-api example re-defines the <code>:parameters</code> for the views that are handled via the <code>load-pet</code> interceptor?</z><z id="t1458684639" t="xlevus unless my code hasn&apos;t updated properly, it appears that the load-pet interceptor provides that for its sub-views."><y>#</y><d>2016-03-22</d><h>22:10</h><w>xlevus</w>unless my code hasn&apos;t updated properly, it appears that the load-pet interceptor provides that for its sub-views.</z><z id="t1458719071" t="oliy [:attrs {:href &quot;/_/_/users/U0529P22K&quot;}] they all get merged, not replaced, so it&apos;s simply declaring its own parameters, safe in the knowledge that if the handlers define a different set of params (or indeed none at all) it will be guaranteed to work"><y>#</y><d>2016-03-23</d><h>07:44</h><w>oliy</w><a>@xlevus</a> they all get merged, not replaced, so it&apos;s simply declaring its own parameters, safe in the knowledge that if the handlers define a different set of params (or indeed none at all) it will be guaranteed to work</z><z id="t1463425281" t="donaldball Hey folks, I’m running into a minor hurdle migrating a pedestal project to use component for system state"><y>#</y><d>2016-05-16</d><h>19:01</h><w>donaldball</w>Hey folks, I’m running into a minor hurdle migrating a pedestal project to use component for system state</z><z id="t1463425297" t="donaldball (defrecord Pedestal [service] component/Lifecycle (start [this] (let [server (-&gt; service http/create-server http/start)] (assoc this ::server server))) (stop [this] (http/stop (::server this)) (dissoc this ::server))) "><y>#</y><d>2016-05-16</d><h>19:01</h><w>donaldball</w><pre>(defrecord Pedestal [service]
  component/Lifecycle
  (start [this]
    (let [server (-&gt; service http/create-server http/start)]
      (assoc this ::server server)))
  (stop [this]
    (http/stop (::server this))
    (dissoc this ::server)))
</pre></z><z id="t1463425333" t="donaldball That’s my bog-standard component (http being io.pedestal.http). It starts and stops fine once, but fails to restart thereafter, claiming:"><y>#</y><d>2016-05-16</d><h>19:02</h><w>donaldball</w>That’s my bog-standard component (http being io.pedestal.http). It starts and stops fine once, but fails to restart thereafter, claiming:</z><z id="t1463425345" t="donaldball 2016-05-16 14:56:10.754-0400 ERROR org.apache.coyote.http11.Http11NioProtocol Failed to initialize end point associated with ProtocolHandler [&quot;http-nio-8080&quot;] java.net.BindException: Address already in use"><y>#</y><d>2016-05-16</d><h>19:02</h><w>donaldball</w><pre>2016-05-16 14:56:10.754-0400 ERROR org.apache.coyote.http11.Http11NioProtocol Failed to initialize end point associated with ProtocolHandler [&quot;http-nio-8080&quot;]
java.net.BindException: Address already in use</pre></z><z id="t1463426089" t="donaldball FWIW this seems to be specific to the tomcat server type, so plausibly is a bug"><y>#</y><d>2016-05-16</d><h>19:14</h><w>donaldball</w>FWIW this seems to be specific to the tomcat server type, so plausibly is a bug</z><z id="t1463426680" t="donaldball I kinda like the design, but the docs are laughable, and the registration process for interceptors seems haphazard"><y>#</y><d>2016-05-16</d><h>19:24</h><w>donaldball</w>I kinda like the design, but the docs are laughable, and the registration process for interceptors seems haphazard</z><z id="t1463450759" t="donaldball (Oh my. FWIW, while I stand by the above, it was intended as a private gripe to another party. I am embarrassed that I accidentally published it here. Had I intended a public critique, I would have been much more thoughtful and respectful.)"><y>#</y><d>2016-05-17</d><h>02:05</h><w>donaldball</w>(Oh my. FWIW, while I stand by the above, it was intended as a private gripe to another party. I am embarrassed that I accidentally published it here. Had I intended a public critique, I would have been much more thoughtful and respectful.)</z><z id="t1463493475" t="tessellator [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] : I get the same error when using Tomcat with pedestal+component. Even using a server start/stop/start sequence with the default pedestal-service project has issues when using Tomcat. I would agree this is likely a bug. Would you like to open an issue or drop a note to the mailing list?"><y>#</y><d>2016-05-17</d><h>13:57</h><w>tessellator</w><a>@donaldball</a>: I get the same error when using Tomcat with pedestal+component. Even using a server start/stop/start sequence with the default pedestal-service project has issues when using Tomcat. I would agree this is likely a bug. Would you like to open an issue or drop a note to the mailing list?</z><z id="t1463493810" t="donaldball Thanks for the confirmation that it’s not something specific to my environment; I’ll do so."><y>#</y><d>2016-05-17</d><h>14:03</h><w>donaldball</w>Thanks for the confirmation that it’s not something specific to my environment; I’ll do so.</z><z id="t1463503049" t="christianromney [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] : the dissoc in the snippet above will cause a regular map to be returned instead of a record. you might prefer assoc w/ nil"><y>#</y><d>2016-05-17</d><h>16:37</h><w>christianromney</w><a>@donaldball</a>: the dissoc in the snippet above will cause a regular map to be returned instead of a record. you might prefer assoc w/ nil</z><z id="t1463503153" t="christianromney also, it&apos;s good practice to make the calls idempotent so that calling start on a started component just returns this. ditto for stop on a stopped component"><y>#</y><d>2016-05-17</d><h>16:39</h><w>christianromney</w>also, it&apos;s good practice to make the calls idempotent so that calling start on a started component just returns this. ditto for stop on a stopped component</z><z id="t1463503876" t="donaldball I go back and forth on the idempotence of lifecycle fns tbqh"><y>#</y><d>2016-05-17</d><h>16:51</h><w>donaldball</w>I go back and forth on the idempotence of lifecycle fns tbqh</z><z id="t1463503898" t="donaldball But the dissoc in this case is preserving the type. Is this behavior new in clojure 1.8?"><y>#</y><d>2016-05-17</d><h>16:51</h><w>donaldball</w>But the dissoc in this case is preserving the type. Is this behavior new in clojure 1.8?</z><z id="t1463507573" t="christianromney not new functionality (record dissoc). the reason i usually go for idempotent lifecycle is to avoid the exception that&apos;s thrown on start when you&apos;re already bound to the port and i never have any good reason for not making them idempotent"><y>#</y><d>2016-05-17</d><h>17:52</h><w>christianromney</w>not new functionality (record dissoc). the reason i usually go for idempotent lifecycle is to avoid the exception that&apos;s thrown on start when you&apos;re already bound to the port and i never have any good reason for not making them idempotent</z><z id="t1464797501" t="chrisetheridge Is there anything special to parse post params in a request?"><y>#</y><d>2016-06-01</d><h>16:11</h><w>chrisetheridge</w>Is there anything special to parse <code>post</code> params in a request?</z><z id="t1464797585" t="chrisetheridge i’m posting to our route, but the params are empty"><y>#</y><d>2016-06-01</d><h>16:13</h><w>chrisetheridge</w>i’m posting to our route, but the <code>params</code> are empty</z><z id="t1464801632" t="andrewhr [:attrs {:href &quot;/_/_/users/U0HJ7CX6H&quot;}] : have you tried io.pedestal.http.body-params/body-params ? It will put form encoded data into request&apos;s :form-params attribute"><y>#</y><d>2016-06-01</d><h>17:20</h><w>andrewhr</w><a>@biscuitpants</a>: have you tried <code>io.pedestal.http.body-params/body-params</code>? It will put form encoded data into request&apos;s <code>:form-params</code> attribute</z><z id="t1464801864" t="andrewhr you just need to add it to your interceptor chain. Bear in mind body-params is not an interceptor per se, but an interceptor-returning function. This example shows how to use it https://github.com/pedestal/pedestal/blob/master/samples/war-example/src/war_example/service.clj#L20"><y>#</y><d>2016-06-01</d><h>17:24</h><w>andrewhr</w>you just need to add it to your interceptor chain. Bear in mind <code>body-params</code> is not an interceptor per se, but an interceptor-returning function. This example shows how to use it <a href="https://github.com/pedestal/pedestal/blob/master/samples/war-example/src/war_example/service.clj#L20" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/war-example/src/war_example/service.clj#L20</a></z><z id="t1465240152" t="donaldball Does anyone else get these kinds of warnings from tomcat when stopping a pedestal war?"><y>#</y><d>2016-06-06</d><h>19:09</h><w>donaldball</w>Does anyone else get these kinds of warnings from tomcat when stopping a pedestal war?</z><z id="t1465240154" t="donaldball 06-Jun-2016 18:14:02.800 SEVERE [localhost-startStop-2] org.apache.catalina.loader.WebappClassLoaderBase.checkThreadLocalMapForLeaks The web application [ROOT] created a ThreadLocal with key of type [clojure.lang.Var$1] (value [clojure.lang.Var$1@1337b298]) and a value of type [clojure.lang.Var.Frame] (value [clojure.lang.Var$Frame@28c976d]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak."><y>#</y><d>2016-06-06</d><h>19:09</h><w>donaldball</w><pre>06-Jun-2016 18:14:02.800 SEVERE [localhost-startStop-2] org.apache.catalina.loader.WebappClassLoaderBase.checkThreadLocalMapForLeaks The web application [ROOT] created a ThreadLocal with key of type [clojure.lang.Var$1] (value [clojure.lang.Var$1@1337b298]) and a value of type [clojure.lang.Var.Frame] (value [clojure.lang.Var$Frame@28c976d]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.</pre></z><z id="t1465240200" t="donaldball I’ve been able to create a sample war that gives a related warning:"><y>#</y><d>2016-06-06</d><h>19:10</h><w>donaldball</w>I’ve been able to create a sample war that gives a related warning:</z><z id="t1465240202" t="donaldball 03-Jun-2016 15:04:12.628 WARNING [localhost-startStop-1] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [sample] appears to have started a thread named [clojure.core.async.timers/timeout-daemon] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread: sun.misc.Unsafe.park(Native Method) java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039) java.util.concurrent.DelayQueue.take(DelayQueue.java:211) clojure.core.async.impl.timers$timeout_worker.invokeStatic(timers.clj:60) clojure.core.async.impl.timers$timeout_worker.invoke(timers.clj:56) clojure.lang.AFn.run(AFn.java:22) java.lang.Thread.run(Thread.java:745) "><y>#</y><d>2016-06-06</d><h>19:10</h><w>donaldball</w><pre>03-Jun-2016 15:04:12.628 WARNING [localhost-startStop-1] org.apache.catalina.loader.WebappClassLoaderBase.clearReferencesThreads The web application [sample] appears to have started a thread named [clojure.core.async.timers/timeout-daemon] but has failed to stop it. This is very likely to create a memory leak. Stack trace of thread:
 sun.misc.Unsafe.park(Native Method)
 java.util.concurrent.locks.LockSupport.park(LockSupport.java:175)
 java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2039)
 java.util.concurrent.DelayQueue.take(DelayQueue.java:211)
 clojure.core.async.impl.timers$timeout_worker.invokeStatic(timers.clj:60)
 clojure.core.async.impl.timers$timeout_worker.invoke(timers.clj:56)
 clojure.lang.AFn.run(AFn.java:22)
 java.lang.Thread.run(Thread.java:745)
</pre></z><z id="t1465240229" t="donaldball But not the SEVERE warning"><y>#</y><d>2016-06-06</d><h>19:10</h><w>donaldball</w>But not the SEVERE warning</z><z id="t1465246629" t="oliy apologies if this is a simple question, but are there any helper functions for the following: - enqueuing an interceptor as the next one in the chain (`io.pedestal.interceptor.chain/enqueue` adds it at the end) - enqueuing an interceptor during the leave phase (i.e. pushing it on to the :io.pedestal.interceptor.chain/stack )"><y>#</y><d>2016-06-06</d><h>20:57</h><w>oliy</w>apologies if this is a simple question, but are there any helper functions for the following:
- enqueuing an interceptor as the next one in the chain (`io.pedestal.interceptor.chain/enqueue` adds it at the end)
- enqueuing an interceptor during the leave phase (i.e. pushing it on to the <code>:io.pedestal.interceptor.chain/stack</code>)</z><z id="t1465246697" t="oliy i would imagine it would live in io.pedestal.interceptor.chain if it did exist. it feels like it would be better to have a function to help you with the queue/stack internals than directly manipulating them"><y>#</y><d>2016-06-06</d><h>20:58</h><w>oliy</w>i would imagine it would live in <code>io.pedestal.interceptor.chain</code> if it did exist. it feels like it would be better to have a function to help you with the queue/stack internals than directly manipulating them</z><z id="t1465846089" t="donaldball Prior to 0.5.0, I had used this stanza for my exception handler:"><y>#</y><d>2016-06-13</d><h>19:28</h><w>donaldball</w>Prior to 0.5.0, I had used this stanza for my exception handler:</z><z id="t1465846091" t="donaldball (def exception-handler (error/error-dispatch [context e] [{:interceptor ::routes/requires}] (assoc context :response {:status 503 :body {:message &quot;System unavailable&quot;}}) :else (assoc context :io.pedestal.impl.interceptor/error e))) "><y>#</y><d>2016-06-13</d><h>19:28</h><w>donaldball</w><pre>(def exception-handler
  (error/error-dispatch [context e]
    [{:interceptor ::routes/requires}]
    (assoc context :response {:status 503 :body {:message &quot;System unavailable&quot;}})
    :else (assoc context :io.pedestal.impl.interceptor/error e)))
</pre></z><z id="t1465846102" t="donaldball Does anyone know what the correct key value for the :else clause is now?"><y>#</y><d>2016-06-13</d><h>19:28</h><w>donaldball</w>Does anyone know what the correct key value for the :else clause is now?</z><z id="t1465883894" t="rauh Please also ping me if somebody answers this. I have the same problem."><y>#</y><d>2016-06-14</d><h>05:58</h><w>rauh</w>Please also ping me if somebody answers this. I have the same problem.</z><z id="t1465913251" t="christianromney i believe it&apos;s :io.pedestal.interceptor.chain/error"><y>#</y><d>2016-06-14</d><h>14:07</h><w>christianromney</w>i believe it&apos;s <code>:io.pedestal.interceptor.chain/error</code></z><z id="t1465913263" t="christianromney the code that was assoc&apos;ing :: error moved to this namespace"><y>#</y><d>2016-06-14</d><h>14:07</h><w>christianromney</w>the code that was assoc&apos;ing <b>::</b>error moved to this namespace</z><z id="t1465913336" t="christianromney while a short term fix for you might be to use that key, you might be better off rethrowing."><y>#</y><d>2016-06-14</d><h>14:08</h><w>christianromney</w>while a short term fix for you might be to use that key, you might be better off rethrowing.</z><z id="t1465914402" t="christianromney that breaking change is actually in the release notes https://github.com/pedestal/pedestal/releases/tag/0.5.0 (first item under breaking changes)"><y>#</y><d>2016-06-14</d><h>14:26</h><w>christianromney</w>that breaking change is actually in the release notes <a href="https://github.com/pedestal/pedestal/releases/tag/0.5.0" target="_blank">https://github.com/pedestal/pedestal/releases/tag/0.5.0</a> (first item under breaking changes)</z><z id="t1465921818" t="donaldball ha, thanks"><y>#</y><d>2016-06-14</d><h>16:30</h><w>donaldball</w>ha, thanks</z><z id="t1466538184" t="ikitommi Hi. Pedestal interceptors seem to merge the original exception keys with the interceptor extra data in https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L34-L39 . Could it hold the original ex-data under :data or something so the original data could be retrieved later? Also, having a custom ex-info with keys like :stage will mess up the exception handling."><y>#</y><d>2016-06-21</d><h>19:43</h><w>ikitommi</w>Hi. Pedestal interceptors seem to merge the original exception keys with the interceptor extra data in <a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L34-L39" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L34-L39</a>. Could it hold the original ex-data under <code>:data</code> or something so the original data could be retrieved later? Also, having a custom ex-info with keys like <code>:stage</code> will mess up the exception handling.</z><z id="t1466539824" t="ikitommi ah, the original exception can be fetched with (-&gt; ex ex-data :exception) , but custom keys can still clash with the pedestal ones."><y>#</y><d>2016-06-21</d><h>20:10</h><w>ikitommi</w>ah, the original exception can be fetched with <code>(-&gt; ex ex-data :exception)</code>, but custom keys can still clash with the pedestal ones.</z><z id="t1467301226" t="lellis Hi guys! I want to use Friend framework for authentication and authorization , but all the examples use compjure as route service. Is there any problem to use with the pedestal ? Anyone here use?"><y>#</y><d>2016-06-30</d><h>15:40</h><w>lellis</w>Hi guys! I want to use Friend framework for authentication and authorization , but all the examples use compjure as route service. Is there any problem to use with the pedestal ? Anyone here use?</z><z id="t1467393412" t="christianromney I use geheimtur with pedestal to good effect"><y>#</y><d>2016-07-01</d><h>17:16</h><w>christianromney</w>I use geheimtur with pedestal to good effect</z><z id="t1467393833" t="lellis ty [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] . I have also find it!"><y>#</y><d>2016-07-01</d><h>17:23</h><w>lellis</w>ty <a>@christianromney</a>. I have also find it!</z><z id="t1467570772" t="adamfrey I see that if I want an interceptor to run for every route I can list it at the top level “/“ route in my router. But just for my understanding, why when I insert an interceptor at the beginning of the default interceptor list returned by create-server is my interceptor never called?"><y>#</y><d>2016-07-03</d><h>18:32</h><w>adamfrey</w>I see that if I want an interceptor to run for every route I can list it at the top level “/“ route in my router. But just for my understanding, why when I insert an interceptor at the beginning of the default interceptor list returned by <code>create-server</code> is my interceptor never called?</z><z id="t1467570825" t="adamfrey here’s the interceptor list before the server is started: (:my.app/my-interceptor :io.pedestal.http/log-request :io.pedestal.http.cors/allow-origin :io.pedestal.http/not-found :io.pedestal.http.ring-middlewares/content-type-interceptor :io.pedestal.http.route/query-params :io.pedestal.http.route/method-param :io.pedestal.http.ring-middlewares/resource :io.pedestal.http.secure-headers/secure-headers :io.pedestal.http.route/router) and my interceptor is never called"><y>#</y><d>2016-07-03</d><h>18:33</h><w>adamfrey</w>here’s the interceptor list before the server is started: <pre>(:my.app/my-interceptor
 :io.pedestal.http/log-request
 :io.pedestal.http.cors/allow-origin
 :io.pedestal.http/not-found
 :io.pedestal.http.ring-middlewares/content-type-interceptor
 :io.pedestal.http.route/query-params
 :io.pedestal.http.route/method-param
 :io.pedestal.http.ring-middlewares/resource
 :io.pedestal.http.secure-headers/secure-headers
 :io.pedestal.http.route/router)
</pre> and my interceptor is never called</z><z id="t1468486435" t="oliy pedestal-api - easily write APIs for the pedestal web server - v0.3.0 is out with better Swagger compliance. Find it on Github https://github.com/oliyh/pedestal-api"><y>#</y><d>2016-07-14</d><h>08:53</h><w>oliy</w>pedestal-api - easily write APIs for the pedestal web server - v0.3.0 is out with better Swagger compliance. Find it on Github <a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a></z><z id="t1469716469" t="donaldball Has anyone written or used a library for working with caching headers from pedestal?"><y>#</y><d>2016-07-28</d><h>14:34</h><w>donaldball</w>Has anyone written or used a library for working with caching headers from pedestal?</z><z id="t1470166271" t="crimeminister Sorry to say I haven&apos;t"><y>#</y><d>2016-08-02</d><h>19:31</h><w>crimeminister</w>Sorry to say I haven&apos;t</z><z id="t1470940945" t="lellis Hi guys, any another example using websocket with pedestal?"><y>#</y><d>2016-08-11</d><h>18:42</h><w>lellis</w>Hi guys, any another example using websocket with pedestal?</z><z id="t1471038049" t="hlship I’m having a problem in 0.5.0 where my interceptor may return a channel."><y>#</y><d>2016-08-12</d><h>21:40</h><w>hlship</w>I’m having a problem in 0.5.0 where my interceptor may return a channel.</z><z id="t1471038086" t="hlship I’m wrapping a normal Ring handler but trying to allow the handler to return a channel that conveys the response."><y>#</y><d>2016-08-12</d><h>21:41</h><w>hlship</w>I’m wrapping a normal Ring handler but trying to allow the handler to return a channel that conveys the response.</z><z id="t1471038095" t="hlship (defn ^:private read-port? [v] (satisfies? ReadPort v)) (defn ^:private wrap-for-async &quot;Invokes the function yielding the response. Returns either the context with the :response key set, or a channel that will convey the context when ready (if the endpoint function returns a channel).&quot; [f] (fn [context] (let [v (f context)] (if (read-port? v) (go (assoc context :response (&lt;! v))) (assoc context :response v))))) "><y>#</y><d>2016-08-12</d><h>21:41</h><w>hlship</w><pre>(defn ^:private read-port?
  [v]
  (satisfies? ReadPort v))

(defn ^:private wrap-for-async
  &quot;Invokes the function yielding the response.  Returns either the context with the :response
  key set, or a channel that will convey the context when ready (if the endpoint function returns
  a channel).&quot;
  [f]
  (fn [context]
    (let [v (f context)]
      (if (read-port? v)
        (go (assoc context :response (&lt;! v)))
        (assoc context :response v)))))
</pre></z><z id="t1471038157" t="hlship So, this should work: my intereceptor builds off of this: (interceptor {:name endpoint-kw :enter (wrap-for-async generate-response)}) "><y>#</y><d>2016-08-12</d><h>21:42</h><w>hlship</w>So, this should work: my intereceptor builds off of this:

<pre>(interceptor {:name endpoint-kw
                  :enter (wrap-for-async generate-response)})
</pre></z><z id="t1471038184" t="hlship generate-response takes the Pedestal context and returns just the Ring response map, or a channel that conveys that map."><y>#</y><d>2016-08-12</d><h>21:43</h><w>hlship</w><code>generate-response</code> takes the Pedestal context and returns just the Ring response map, or a channel that conveys that map.</z><z id="t1471038204" t="hlship It’s not working in practice; if my handler returns a map, that passes through the interceptors just fine."><y>#</y><d>2016-08-12</d><h>21:43</h><w>hlship</w>It’s not working in practice; if my handler returns a map, that passes through the interceptors just fine.</z><z id="t1471038229" t="hlship If it returns a channel that conveys the map, I see a nil passing back up."><y>#</y><d>2016-08-12</d><h>21:43</h><w>hlship</w>If it returns a channel that conveys the map, I see a nil passing back up.</z><z id="t1471038239" t="hlship One moment while I get some logging ..."><y>#</y><d>2016-08-12</d><h>21:43</h><w>hlship</w>One moment while I get some logging ...</z><z id="t1471038394" t="hlship DEBUG io.pedestal.interceptor.chain - {:in begin, :execution-id 13, :line 291} DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137} DEBUG io.pedestal.interceptor.chain - {:interceptor :io.pedestal.http.route/router, :stage :enter, :execution-id 13, :fn #object[io.pedestal.http.route$eval12858$fn__12859$fn__12860 0xbacd2c6 &quot;io.pedestal.http.route$eval12858$fn__12859$fn__12860@bacd2c6&quot;], :line 48} DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137} DEBUG io.pedestal.interceptor.chain - {:interceptor :sample.async-widgets/view-widget, :stage :enter, :execution-id 13, :fn #object[io.aviso.rook$wrap_for_async$fn__11267 0x73b76e78 &quot;io.aviso.rook$wrap_for_async$fn__11267@73b76e78&quot;], :line 48} DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137} DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 13, :line 218} DEBUG io.pedestal.interceptor.chain - {:in end, :execution-id 13, :context-keys (:request :io.pedestal.interceptor.chain/execution-id :io.pedestal.interceptor.chain/stack :route :url-for :bindings :response), :line 298} "><y>#</y><d>2016-08-12</d><h>21:46</h><w>hlship</w><pre>DEBUG io.pedestal.interceptor.chain - {:in begin, :execution-id 13, :line 291}
DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137}
DEBUG io.pedestal.interceptor.chain - {:interceptor :io.pedestal.http.route/router, :stage :enter, :execution-id 13, :fn #object[io.pedestal.http.route$eval12858$fn__12859$fn__12860 0xbacd2c6 &quot;io.pedestal.http.route$eval12858$fn__12859$fn__12860@bacd2c6&quot;], :line 48}
DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137}
DEBUG io.pedestal.interceptor.chain - {:interceptor :sample.async-widgets/view-widget, :stage :enter, :execution-id 13, :fn #object[io.aviso.rook$wrap_for_async$fn__11267 0x73b76e78 &quot;io.aviso.rook$wrap_for_async$fn__11267@73b76e78&quot;], :line 48}
DEBUG io.pedestal.interceptor.chain - {:in enter-all, :execution-id 13, :line 137}
DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 13, :line 218}
DEBUG io.pedestal.interceptor.chain - {:in end, :execution-id 13, :context-keys (:request :io.pedestal.interceptor.chain/execution-id :io.pedestal.interceptor.chain/stack :route :url-for :bindings :response), :line 298}
</pre></z><z id="t1471038736" t="hlship Hm. It’s got to be something in my code, because I see an interceptor around the endpoint get invoked and it has the correct :response key on the context."><y>#</y><d>2016-08-12</d><h>21:52</h><w>hlship</w>Hm. It’s got to be something in my code, because I see an interceptor around the endpoint get invoked and it has the correct :response key on the context.</z><z id="t1471039163" t="hlship Maybe not … it seems like somethings up. Here’s how I run a request: (defn execute-request [routes path request] (let [interceptors (-&gt; routes (table/table-routes) (route/router :prefix-tree))] (-&gt; {:request (merge {:request-method :get} {:path-info path} request)} (chain/enqueue [interceptors]) chain/execute))) "><y>#</y><d>2016-08-12</d><h>21:59</h><w>hlship</w>Maybe not … it seems like somethings up.  Here’s how I run a request:

<pre>(defn execute-request
  [routes path request]
  (let [interceptors (-&gt; routes
                         (table/table-routes)
                         (route/router :prefix-tree))]
    (-&gt; {:request (merge {:request-method :get}
                         {:path-info path}
                         request)}
        (chain/enqueue [interceptors])
        chain/execute)))
</pre></z><z id="t1471039209" t="hlship This is part of my test suite. This is returning as expected for requests that don’t involve any async, but returns nil for those that are async."><y>#</y><d>2016-08-12</d><h>22:00</h><w>hlship</w>This is part of my test suite.  This is returning as expected for requests that don’t involve any async, but returns nil for those that are async.</z><z id="t1471039351" t="hlship This might be related: https://github.com/pedestal/pedestal/issues/430 I need to dig through more of the code to see what “goes async” really means."><y>#</y><d>2016-08-12</d><h>22:02</h><w>hlship</w>This might be related: <a href="https://github.com/pedestal/pedestal/issues/430" target="_blank">https://github.com/pedestal/pedestal/issues/430</a>  I need to dig through more of the code to see what “goes async” really means.</z><z id="t1471042847" t="hlship My guess is that the stack of interceptors built up in execute-request doesn’t reflect usage in a real server; I’m working on end-to-end tests instead."><y>#</y><d>2016-08-12</d><h>23:00</h><w>hlship</w>My guess is that the stack of interceptors built up in execute-request doesn’t reflect usage in a real server; I’m working on end-to-end tests instead.</z><z id="t1471045020" t="hlship End to end worked perfectly so it’s just a matter of my test harness not being up to snuff. Some docs or examples on how to set up the interceptor chain for fast testing in this way would be welcome!"><y>#</y><d>2016-08-12</d><h>23:37</h><w>hlship</w>End to end worked perfectly so it’s just a matter of my test harness not being up to snuff. Some docs or examples on how to set up the interceptor chain for fast testing in this way would be welcome!</z><z id="t1471045093" t="hlship What I’m working on, BTW: https://github.com/AvisoNovate/rook/tree/rook-2-pedestal"><y>#</y><d>2016-08-12</d><h>23:38</h><w>hlship</w>What I’m working on, BTW: <a href="https://github.com/AvisoNovate/rook/tree/rook-2-pedestal" target="_blank">https://github.com/AvisoNovate/rook/tree/rook-2-pedestal</a></z><z id="t1471365271" t="hlship Paul informed me of response-for : https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L261 I’ll give that a try when I get a chance."><y>#</y><d>2016-08-16</d><h>16:34</h><w>hlship</w>Paul informed me of <code>response-for</code>: <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L261" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L261</a>  I’ll give that a try when I get a chance.</z><z id="t1471368014" t="donaldball FWIW I found that route/url-for does not work when used in a response-for context"><y>#</y><d>2016-08-16</d><h>17:20</h><w>donaldball</w>FWIW I found that <code>route/url-for</code> does not work when used in a <code>response-for</code> context</z><z id="t1471368050" t="donaldball Though possibly I just didn’t populate enough of the headers for it to work correctly"><y>#</y><d>2016-08-16</d><h>17:20</h><w>donaldball</w>Though possibly I just didn’t populate enough of the headers for it to work correctly</z><z id="t1472227449" t="lellis Hi guys! How can i set timeout in my websocket creation. I’ve created and connected using WS, but dont know how to set timeout for the connection"><y>#</y><d>2016-08-26</d><h>16:04</h><w>lellis</w>Hi guys! How can i set timeout in my websocket creation. I’ve created and connected using WS, but dont know  how to set timeout for the connection</z><z id="t1472255734" t="hlship A thing I’ve been working on: https://github.com/AvisoNovate/rook"><y>#</y><d>2016-08-26</d><h>23:55</h><w>hlship</w>A thing I’ve been working on: <a href="https://github.com/AvisoNovate/rook" target="_blank">https://github.com/AvisoNovate/rook</a></z><z id="t1472789202" t="jimmy how to define else route pattern for the route that is not hit by other defined routes. It&apos;s not notfound route btw."><y>#</y><d>2016-09-02</d><h>04:06</h><w>jimmy</w>how to define else route pattern for the route that is not hit by other defined routes. It&apos;s not notfound route btw.</z><z id="t1472996847" t="rui.yang hi, tried to deploy a pedestal to heroku, got exception that no ctor for io.pedestal.http.helper before"><y>#</y><d>2016-09-04</d><h>13:47</h><w>rui.yang</w>hi, tried to deploy a pedestal to heroku, got exception that no ctor for io.pedestal.http.helper before</z><z id="t1472996893" t="rui.yang anyone got similar issue? there is a similar issue in github, the suggestion is to use interceptor directly"><y>#</y><d>2016-09-04</d><h>13:48</h><w>rui.yang</w>anyone got similar issue? there is a similar issue in github, the suggestion is to use interceptor directly</z><z id="t1472996942" t="rui.yang i tried to write a macro to avoid some duplication in defining handler, no luck"><y>#</y><d>2016-09-04</d><h>13:49</h><w>rui.yang</w>i tried to write a macro to avoid some duplication in defining handler, no luck</z><z id="t1472996996" t="rui.yang wonder if there is some solutions already"><y>#</y><d>2016-09-04</d><h>13:49</h><w>rui.yang</w>wonder if there is some solutions already</z><z id="t1473050453" t="jimmy [:attrs {:href &quot;/_/_/users/U06BCP80H&quot;}] you should post your error log here, maybe someone can help"><y>#</y><d>2016-09-05</d><h>04:40</h><w>jimmy</w><a>@rui.yang</a> you should post your error log here, maybe someone can help</z><z id="t1473050463" t="jimmy Re asking T_T"><y>#</y><d>2016-09-05</d><h>04:41</h><w>jimmy</w>Re asking T_T</z><z id="t1473061854" t="rui.yang the exception I got is: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__6962"><y>#</y><d>2016-09-05</d><h>07:50</h><w>rui.yang</w>the exception I got is: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__6962</z><z id="t1473061879" t="rui.yang but in my codes, there is no direct reference to before or defbefore"><y>#</y><d>2016-09-05</d><h>07:51</h><w>rui.yang</w>but in my codes, there is no direct reference to before or defbefore</z><z id="t1473061885" t="rui.yang but I used defhandler"><y>#</y><d>2016-09-05</d><h>07:51</h><w>rui.yang</w>but I used defhandler</z><z id="t1473061931" t="rui.yang which is created by calling defsimpleinterceptordef in pedestal. I am not sure if that’s the cause"><y>#</y><d>2016-09-05</d><h>07:52</h><w>rui.yang</w>which is created by calling defsimpleinterceptordef in pedestal. I am not sure if that’s the cause</z><z id="t1473061980" t="rui.yang using a macro to create another macro, my brain exploded 😞"><y>#</y><d>2016-09-05</d><h>07:53</h><w>rui.yang</w>using a macro to create another macro, my brain exploded  <b>😞</b></z><z id="t1473063321" t="rui.yang i solved by remove using defhandler"><y>#</y><d>2016-09-05</d><h>08:15</h><w>rui.yang</w>i solved by remove using defhandler</z><z id="t1473063357" t="rui.yang using a simple macro i wrote to wrap the handler function"><y>#</y><d>2016-09-05</d><h>08:15</h><w>rui.yang</w>using a simple macro i wrote to wrap the handler function</z><z id="t1473170209" t="geraldodev It&apos;s annoying that exceptions created with ex-info are boxed inside another ex-info, because we need to use guard to capture our ex-info data. Imho (very humble), since core-match is called on ex-data it is data already, a simple map. When catching the exception pedestal could check if it is a ex-info and merge its keys with its data, qualified … https://gist.github.com/geraldodev/3a0d16da4b6c8fcdd9af575c9f9d9805"><y>#</y><d>2016-09-06</d><h>13:56</h><w>geraldodev</w>It&apos;s annoying that exceptions created with ex-info are boxed inside another ex-info, because we need to use guard to capture our ex-info data. Imho (very humble), since core-match is called on ex-data it is data already, a simple map. When catching the exception pedestal could check if it is a ex-info and merge its keys with its data, qualified …  <a href="https://gist.github.com/geraldodev/3a0d16da4b6c8fcdd9af575c9f9d9805" target="_blank">https://gist.github.com/geraldodev/3a0d16da4b6c8fcdd9af575c9f9d9805</a></z><z id="t1473253438" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Really late response on the catchall route, but you can put &quot;/*path&quot; as the last route."><y>#</y><d>2016-09-07</d><h>13:03</h><w>mtnygard</w><a>@nxqd</a> Really late response on the catchall route, but you can put &quot;/*path&quot; as the last route.</z><z id="t1473253454" t="mtnygard I think that has to use the terse syntax, not the table syntax though."><y>#</y><d>2016-09-07</d><h>13:04</h><w>mtnygard</w>I think that has to use the terse syntax, not the table syntax though.</z><z id="t1473497111" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks for pointing out 😄 I think pedestal needs more love for docs especially for beginner like me 😄"><y>#</y><d>2016-09-10</d><h>08:45</h><w>jimmy</w><a>@mtnygard</a> thanks for pointing out <b>😄</b> I think pedestal needs more love for docs especially for beginner like me <b>😄</b></z><z id="t1473498520" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I have this route def (defn routes [interceptor] (route/expand-routes `[[[&quot;/&quot; {:get index-page} ^:interceptors [bootstrap/html-body ~interceptor] [&quot;/api&quot; {:post omnext-service} ^:interceptors [iinterceptor/om-body-params iinterceptor/om-response]] [&quot;/*&quot; {:get index-page} ^:interceptors [bootstrap/html-body ~interceptor]]]]])) I think config it wrong, I got the error Route names are not unique "><y>#</y><d>2016-09-10</d><h>09:08</h><w>jimmy</w><a>@mtnygard</a> I have this route def
<pre>(defn routes
  [interceptor]
  (route/expand-routes
   `[[[&quot;/&quot; {:get index-page}
       ^:interceptors [bootstrap/html-body ~interceptor]
       [&quot;/api&quot; {:post omnext-service}
        ^:interceptors [iinterceptor/om-body-params iinterceptor/om-response]]
       [&quot;/*&quot; {:get index-page}
        ^:interceptors [bootstrap/html-body ~interceptor]]]]]))
</pre>
I think config it wrong, I got the error  <code> Route names are not unique </code></z><z id="t1473521448" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] The trouble is that both &quot;/&apos; and &quot;/*&quot; are defined to {:get index-page}. That&apos;s why they both get assigned the same route-name. Are you trying to set it up so any request that would be 404 shows the index page instead? If so, you might be better off providing a &quot;not-found-interceptor&quot; in your service map. See http://pedestal.io/reference/service-map for details."><y>#</y><d>2016-09-10</d><h>15:30</h><w>mtnygard</w><a>@nxqd</a> The trouble is that both &quot;/&apos; and &quot;/*&quot; are defined to {:get index-page}. That&apos;s why they both get assigned the same route-name.

Are you trying to set it up so any request that would be 404 shows the index page instead? If so, you might be better off providing a &quot;not-found-interceptor&quot; in your service map. See <a href="http://pedestal.io/reference/service-map" target="_blank">http://pedestal.io/reference/service-map</a> for details.</z><z id="t1473552332" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I have defning only /* , however when I request / it doesn&apos;t work. I have to have something /index for it to work. Ah, I&apos;m working on a SPA, I don&apos;t setup server rendering yet. For now, I would like to forward all others request to the client so the javascript will take care of the routing for me."><y>#</y><d>2016-09-11</d><h>00:05</h><w>jimmy</w><a>@mtnygard</a> 
I have defning only <code>/*</code>, however when I request <code>/</code> it doesn&apos;t work. I have to have something <code>/index</code> for it to work. Ah, I&apos;m working on a SPA, I don&apos;t setup server rendering yet. For now, I would like to forward all others request to the client so the javascript will take care of the routing for me.</z><z id="t1473634354" t="geraldodev error-dispatch core.match is based on (ex-data ex) and captures :exception for which there is no mentioning on documentation or test of error-dispatch"><y>#</y><d>2016-09-11</d><h>22:52</h><w>geraldodev</w>error-dispatch core.match is based on (ex-data ex) and captures :exception for which there is no mentioning on documentation or test of error-dispatch</z><z id="t1473634449" t="geraldodev I ve got this notes on my error-dispatch: note that match and as a consequence guard is based on (ex-data ex) so inside guard you can skip (ex-data ex) and go straight for (:exception %) which is one of the fields captured by pedestal"><y>#</y><d>2016-09-11</d><h>22:54</h><w>geraldodev</w>I ve got this notes on my error-dispatch:  note that match and as a consequence guard is based on (ex-data ex)
 so inside guard you can skip (ex-data ex) and go straight for (:exception %) which is one
 of the fields captured by pedestal</z><z id="t1473962084" t="mtnygard New doc published: Routing quick reference http://pedestal.io/reference/routing-quick-reference"><y>#</y><d>2016-09-15</d><h>17:54</h><w>mtnygard</w>New doc published: Routing quick reference <a href="http://pedestal.io/reference/routing-quick-reference" target="_blank">http://pedestal.io/reference/routing-quick-reference</a></z><z id="t1473975486" t="mtnygard New guide published: Defining Routes http://pedestal.io/guides/defining-routes (this uses the table routing syntax)"><y>#</y><d>2016-09-15</d><h>21:38</h><w>mtnygard</w>New guide published: Defining Routes <a href="http://pedestal.io/guides/defining-routes" target="_blank">http://pedestal.io/guides/defining-routes</a>
(this uses the table routing syntax)</z><z id="t1473975501" t="mtnygard Reviews, issues, and pull requests are most welcome."><y>#</y><d>2016-09-15</d><h>21:38</h><w>mtnygard</w>Reviews, issues, and pull requests are most welcome.</z><z id="t1473975965" t="shaun-mahood I see some blank spaces in the guide for interceptors - if I wanted to read up on them generally, are there any existing resources you would recommend?"><y>#</y><d>2016-09-15</d><h>21:46</h><w>shaun-mahood</w>I see some blank spaces in the guide for interceptors - if I wanted to read up on them generally, are there any existing resources you would recommend?</z><z id="t1473976001" t="mtnygard Calling it &quot;some blank spaces&quot; is being kind... that guide is nothing but blank spaces as yet. 🙂"><y>#</y><d>2016-09-15</d><h>21:46</h><w>mtnygard</w>Calling it &quot;some blank spaces&quot; is being kind... that guide is nothing but blank spaces as yet. <b>🙂</b></z><z id="t1473976031" t="mtnygard You can get some information from the somewhat outdated guide in the pedestal repo itself. https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md"><y>#</y><d>2016-09-15</d><h>21:47</h><w>mtnygard</w>You can get some information from the somewhat outdated guide in the pedestal repo itself. <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md</a></z><z id="t1473976065" t="mtnygard A more recent version appears in one of the hello world guides. http://spark-gap:8820/guides/hello-world-content-types#_interceptors"><y>#</y><d>2016-09-15</d><h>21:47</h><w>mtnygard</w>A more recent version appears in one of the hello world guides. <a href="http://spark-gap:8820/guides/hello-world-content-types#_interceptors" target="_blank">http://spark-gap:8820/guides/hello-world-content-types#_interceptors</a></z><z id="t1473976072" t="mtnygard Oops, local link. One ec."><y>#</y><d>2016-09-15</d><h>21:47</h><w>mtnygard</w>Oops, local link. One ec.</z><z id="t1473976082" t="mtnygard http://pedestal.io/guides/hello-world-content-types#_interceptors"><y>#</y><d>2016-09-15</d><h>21:48</h><w>mtnygard</w><a href="http://pedestal.io/guides/hello-world-content-types#_interceptors" target="_blank">http://pedestal.io/guides/hello-world-content-types#_interceptors</a></z><z id="t1473976128" t="shaun-mahood Ok, great!"><y>#</y><d>2016-09-15</d><h>21:48</h><w>shaun-mahood</w>Ok, great!</z><z id="t1473976162" t="mtnygard As you read those, please send me any questions that they don&apos;t answer. That&apos;ll help me know what to cover."><y>#</y><d>2016-09-15</d><h>21:49</h><w>mtnygard</w>As you read those, please send me any questions that they don&apos;t answer. That&apos;ll help me know what to cover.</z><z id="t1473976258" t="shaun-mahood While we&apos;re on the topic, was there any kind of prior or inspiration for Pedestal interceptors that would be worth looking into for general interest? I can&apos;t remember if I&apos;ve ever seen anything about the genesis of the idea and always have had the assumption that they were invented for Pedestal based on issues with Ring middleware."><y>#</y><d>2016-09-15</d><h>21:50</h><w>shaun-mahood</w>While we&apos;re on the topic, was there any kind of prior or inspiration for Pedestal interceptors that would be worth looking into for general interest? I can&apos;t remember if I&apos;ve ever seen anything about the genesis of the idea and always have had the assumption that they were invented for Pedestal based on issues with Ring middleware.</z><z id="t1473976344" t="mtnygard They came up through a long series of discussions that many people at Relevance took part in. We looked at things like servlet filters, valves (from Tomcat IIRC), ATG&apos;s servlet pipeline."><y>#</y><d>2016-09-15</d><h>21:52</h><w>mtnygard</w>They came up through a long series of discussions that many people at Relevance took part in. We looked at things like servlet filters, valves (from Tomcat IIRC), ATG&apos;s servlet pipeline.</z><z id="t1473976353" t="mtnygard All of those were very code-centric solutions."><y>#</y><d>2016-09-15</d><h>21:52</h><w>mtnygard</w>All of those were very code-centric solutions.</z><z id="t1473976360" t="mtnygard We wanted something that was more like data."><y>#</y><d>2016-09-15</d><h>21:52</h><w>mtnygard</w>We wanted something that was more like data.</z><z id="t1473976375" t="mtnygard We started talking about continuation-passing systems and the idea of a reified call stack emerged."><y>#</y><d>2016-09-15</d><h>21:52</h><w>mtnygard</w>We started talking about continuation-passing systems and the idea of a reified call stack emerged.</z><z id="t1473976424" t="mtnygard Things clicked quickly after that. It was easy to see how to implement parts of the framework itself as interceptors. It was also easy to see how we could pause and resume on different threads. Async and SSE was always part of the design space for Pedestal, so interceptors really fit the bill there."><y>#</y><d>2016-09-15</d><h>21:53</h><w>mtnygard</w>Things clicked quickly after that. It was easy to see how to implement parts of the framework itself as interceptors. It was also easy to see how we could pause and resume on different threads. Async and SSE was always part of the design space for Pedestal, so interceptors really fit the bill there.</z><z id="t1473976502" t="mtnygard More broadly, I guess you could say interceptors are an example of the Pipeline architecture pattern."><y>#</y><d>2016-09-15</d><h>21:55</h><w>mtnygard</w>More broadly, I guess you could say interceptors are an example of the Pipeline architecture pattern.</z><z id="t1473976765" t="shaun-mahood Cool, that&apos;s pretty interesting - reified call stack is a concept that really sits well with me."><y>#</y><d>2016-09-15</d><h>21:59</h><w>shaun-mahood</w>Cool, that&apos;s pretty interesting - reified call stack is a concept that really sits well with me.</z><z id="t1474061885" t="mtnygard New reference doc published: Pedestal architecture overview http://pedestal.io/reference/architecture-overview"><y>#</y><d>2016-09-16</d><h>21:38</h><w>mtnygard</w>New reference doc published: Pedestal architecture overview 
<a href="http://pedestal.io/reference/architecture-overview" target="_blank">http://pedestal.io/reference/architecture-overview</a></z><z id="t1474314288" t="ovan Really happy about the focus on building better documentation for Pedestal. I love the architecture and the idea of interceptors but it&apos;s been a bit of a hard sell at times because of the limited material to quickly learn and later debug things."><y>#</y><d>2016-09-19</d><h>19:44</h><w>ovan</w>Really happy about the focus on building better documentation for Pedestal. I love the architecture and the idea of interceptors but it&apos;s been a bit of a hard sell at times because of the limited material to quickly learn and later debug things.</z><z id="t1474315067" t="gjnoonan Yeah the new docs are great, good work :thumbsup:"><y>#</y><d>2016-09-19</d><h>19:57</h><w>gjnoonan</w>Yeah the new docs are great, good work <b>:thumbsup:</b></z><z id="t1474315744" t="mtnygard Let me know what else should be in them. There are quite a few placeholders right now, but I&apos;m sure there are gaps that I don&apos;t even have placeholders for."><y>#</y><d>2016-09-19</d><h>20:09</h><w>mtnygard</w>Let me know what else should be in them. There are quite a few placeholders right now, but I&apos;m sure there are gaps that I don&apos;t even have placeholders for.</z><z id="t1474385705" t="shaun-mahood I know Pedestal doesn&apos;t officially support Windows, but does anyone know if it currently works with it?"><y>#</y><d>2016-09-20</d><h>15:35</h><w>shaun-mahood</w>I know Pedestal doesn&apos;t officially support Windows, but does anyone know if it currently works with it?</z><z id="t1474386148" t="majenful Happy too for a better documentation. Nevertheless, and despite all the efforts put in, I don’t really like (I know, my tateste) these « official » designs. But isn’t too confusing for new comers that pedestal shares the same http://clojure.org and http://clojurescript.org design ?"><y>#</y><d>2016-09-20</d><h>15:42</h><w>majenful</w>Happy too for a better documentation. Nevertheless, and despite all the efforts put in, I don’t really like (I know, my tateste) these « official » designs. But isn’t too confusing for new comers that pedestal shares the same <a href="http://clojure.org" target="_blank">http://clojure.org</a> and <a href="http://clojurescript.org" target="_blank">http://clojurescript.org</a> design ?</z><z id="t1474386202" t="majenful Datomic has its own cool design, I think pedestal should have too"><y>#</y><d>2016-09-20</d><h>15:43</h><w>majenful</w>Datomic has its own cool design, I think pedestal should have too</z><z id="t1474386206" t="mtnygard [:attrs {:href &quot;/_/_/users/U0ACJECDA&quot;}] I reused the design in order to get the site out sooner."><y>#</y><d>2016-09-20</d><h>15:43</h><w>mtnygard</w><a>@majenful</a> I reused the design in order to get the site out sooner.</z><z id="t1474386210" t="mtnygard Plus I&apos;m no designer."><y>#</y><d>2016-09-20</d><h>15:43</h><w>mtnygard</w>Plus I&apos;m no designer.</z><z id="t1474386232" t="mtnygard If you have the wherewithal to make some mockups, I would definitely consider a design change."><y>#</y><d>2016-09-20</d><h>15:43</h><w>mtnygard</w>If you have the wherewithal to make some mockups, I would definitely consider a design change.</z><z id="t1474386269" t="majenful Oh ok 🙂 , I didn’t understand like this."><y>#</y><d>2016-09-20</d><h>15:44</h><w>majenful</w>Oh ok <b>🙂</b>, I didn’t understand like this.</z><z id="t1474386275" t="mtnygard [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] I know of no reason why it wouldn&apos;t work. I think it&apos;ll depend more on the underlying network container you use. (E.g., Jetty works great, Tomcat works great. Not sure about others.)"><y>#</y><d>2016-09-20</d><h>15:44</h><w>mtnygard</w><a>@shaun-mahood</a> I know of no reason why it wouldn&apos;t work. I think it&apos;ll depend more on the underlying network container you use. (E.g., Jetty works great, Tomcat works great. Not sure about others.)</z><z id="t1474386310" t="majenful I’ll think about it, do you have any color sheet or some color values to base on ?"><y>#</y><d>2016-09-20</d><h>15:45</h><w>majenful</w>I’ll think about it, do you have any color sheet or some color values to base on ?</z><z id="t1474386376" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] : Ok that&apos;s good - based on the statement on the readme I assumed there would be some other issues as well."><y>#</y><d>2016-09-20</d><h>15:46</h><w>shaun-mahood</w><a>@mtnygard</a>: Ok that&apos;s good - based on the statement on the readme I assumed there would be some other issues as well.</z><z id="t1474393030" t="mtnygard [:attrs {:href &quot;/_/_/users/U0ACJECDA&quot;}] No specific color sheet or values."><y>#</y><d>2016-09-20</d><h>17:37</h><w>mtnygard</w><a>@majenful</a> No specific color sheet or values.</z><z id="t1474582687" t="crimeminister Hi folks, I have a piece of monitoring software making an HTTP request to a Pedestal API. The logs from those requests are pure clutter; is there a way to selectively disable logging for a single route?"><y>#</y><d>2016-09-22</d><h>22:18</h><w>crimeminister</w>Hi folks, I have a piece of monitoring software making an HTTP request to a Pedestal API. The logs from those requests are pure clutter; is there a way to selectively disable logging for a single route?</z><z id="t1474582708" t="crimeminister Also, +1 from me on the documentation effort"><y>#</y><d>2016-09-22</d><h>22:18</h><w>crimeminister</w>Also, +1 from me on the documentation effort</z><z id="t1474650395" t="christianromney check the logback configuration"><y>#</y><d>2016-09-23</d><h>17:06</h><w>christianromney</w>check the logback configuration</z><z id="t1474650417" t="christianromney ^ [:attrs {:href &quot;/_/_/users/U066SF64X&quot;}]"><y>#</y><d>2016-09-23</d><h>17:06</h><w>christianromney</w>^ <a>@crimeminister</a></z><z id="t1474653112" t="crimeminister Cool, thanks [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] "><y>#</y><d>2016-09-23</d><h>17:51</h><w>crimeminister</w>Cool, thanks <a>@christianromney</a> </z><z id="t1474653138" t="christianromney happy to help. good luck!"><y>#</y><d>2016-09-23</d><h>17:52</h><w>christianromney</w>happy to help. good luck!</z><z id="t1475093438" t="mtnygard New reference doc posted: interceptors. http://pedestal.io/reference/interceptors"><y>#</y><d>2016-09-28</d><h>20:10</h><w>mtnygard</w>New reference doc posted: interceptors.

<a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1475094798" t="mtnygard Also, I think I forgot to post the draft on streaming responses:"><y>#</y><d>2016-09-28</d><h>20:33</h><w>mtnygard</w>Also, I think I forgot to post the draft on streaming responses:</z><z id="t1475094798" t="mtnygard http://pedestal.io/reference/streaming"><y>#</y><d>2016-09-28</d><h>20:33</h><w>mtnygard</w><a href="http://pedestal.io/reference/streaming" target="_blank">http://pedestal.io/reference/streaming</a></z><z id="t1475136103" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks!"><y>#</y><d>2016-09-29</d><h>08:01</h><w>kirill.salykin</w><a>@mtnygard</a> thanks!</z><z id="t1475176497" t="grzm [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks for bootstrap -&gt; http! I know it&apos;s a small thing in the end, but I know it makes a difference to me 😉"><y>#</y><d>2016-09-29</d><h>19:14</h><w>grzm</w><a>@mtnygard</a> Thanks for bootstrap -&gt; http! I know it&apos;s a small thing in the end, but I know it makes a difference to me <b>😉</b></z><z id="t1475176703" t="mtnygard [:attrs {:href &quot;/_/_/users/U0EHU1800&quot;}] You&apos;re welcome."><y>#</y><d>2016-09-29</d><h>19:18</h><w>mtnygard</w><a>@grzm</a> You&apos;re welcome.</z><z id="t1475261393" t="souenzzo Hi I&apos;m migrating from pedestal .4 to .5 and using the new interceptor logic (` defroutes -&gt; table-routes `) How do I add an error-dispatch handler in this new routeing/handler logic? My actual defroutes looks like this: (def err-hand (io.pedestal.interceptor.error/error-dispatch [ctx ex] ,,,) (defroutes r [[[^:interceptors [err-hand] [&quot;/srv&quot; {:any srv}]]]]) "><y>#</y><d>2016-09-30</d><h>18:49</h><w>souenzzo</w>Hi
I&apos;m migrating from pedestal .4 to .5 and using the new interceptor logic (` defroutes <code> -&gt; </code> table-routes `)
How do I add an <code> error-dispatch </code> handler in this new routeing/handler logic?
My actual defroutes looks like this:
<pre>(def err-hand
  (io.pedestal.interceptor.error/error-dispatch [ctx ex] ,,,)
(defroutes r
  [[[^:interceptors [err-hand]
     [&quot;/srv&quot; {:any srv}]]]])
</pre></z><z id="t1475264663" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] In the table-routes syntax, interceptors are just an ordinary Clojure vector. So one option would be to prepend err-hand at the front of each vector."><y>#</y><d>2016-09-30</d><h>19:44</h><w>mtnygard</w><a>@souenzzo</a> In the table-routes syntax, interceptors are just an ordinary Clojure vector. So one option would be to prepend <code>err-hand</code> at the front of each vector.</z><z id="t1475264690" t="mtnygard E.g., #{[&quot;/srv&quot; :any [err-hand srv]]} "><y>#</y><d>2016-09-30</d><h>19:44</h><w>mtnygard</w>E.g.,

<pre>#{[&quot;/srv&quot; :any [err-hand srv]]}
</pre></z><z id="t1475264727" t="mtnygard If you have many routes that gets unwieldy. I often make a helper function that builds the &quot;standard&quot; interceptors that I want every route to have."><y>#</y><d>2016-09-30</d><h>19:45</h><w>mtnygard</w>If you have many routes that gets unwieldy. I often make a helper function that builds the &quot;standard&quot; interceptors that I want every route to have.</z><z id="t1475264755" t="mtnygard Of course, the terse syntax still exists and still inherits interceptors and paths down the tree, so feel free to keep using that syntax if it works better for you."><y>#</y><d>2016-09-30</d><h>19:45</h><w>mtnygard</w>Of course, the terse syntax still exists and still inherits interceptors and paths down the tree, so feel free to keep using that syntax if it works better for you.</z><z id="t1475265115" t="souenzzo I found this. https://github.com/pedestal/pedestal/blob/0.5.1/interceptor/src/io/pedestal/interceptor/error.clj#L24 So (def err-inter {:name ::err :error err-hand}) where (defn err-hand [ctx ex] ,,,) . It&apos;s not on docs http://pedestal.io/reference/interceptors I&apos;m still having some problems in migration but I&apos;m progressing"><y>#</y><d>2016-09-30</d><h>19:51</h><w>souenzzo</w>I found this.
<a href="https://github.com/pedestal/pedestal/blob/0.5.1/interceptor/src/io/pedestal/interceptor/error.clj#L24" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.1/interceptor/src/io/pedestal/interceptor/error.clj#L24</a>
So <code> (def err-inter {:name ::err :error err-hand})</code> where <code> (defn err-hand [ctx ex] ,,,) </code>.
It&apos;s not on docs <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a>
I&apos;m still having some problems in migration but I&apos;m progressing</z><z id="t1475265333" t="mtnygard AFAIK, io.pedestal.interceptor.error/error-dispatch is still the right thing to create."><y>#</y><d>2016-09-30</d><h>19:55</h><w>mtnygard</w>AFAIK, <code>io.pedestal.interceptor.error/error-dispatch</code> is still the right thing to create.</z><z id="t1475265380" t="mtnygard I don&apos;t think you need to further wrap it with err-inter like that."><y>#</y><d>2016-09-30</d><h>19:56</h><w>mtnygard</w>I don&apos;t think you need to further wrap it with <code>err-inter</code> like that.</z><z id="t1475265396" t="mtnygard (def err-hand (io.pedestal.interceptor.error/error-dispatch [ctx ex] ,,,) should work fine"><y>#</y><d>2016-09-30</d><h>19:56</h><w>mtnygard</w><pre>(def err-hand
  (io.pedestal.interceptor.error/error-dispatch [ctx ex] ,,,)
</pre>
should work fine</z><z id="t1475265432" t="mtnygard Can you paste more of the code?"><y>#</y><d>2016-09-30</d><h>19:57</h><w>mtnygard</w>Can you paste more of the code?</z><z id="t1475266462" t="souenzzo [:attrs {:href &quot;/_/_/users/U1ER5BCMD&quot;}] will paste"><y>#</y><d>2016-09-30</d><h>20:14</h><w>souenzzo</w><a>@eric.vieira</a> will paste</z><z id="t1475266496" t="eric.vieira (def error-dispatch (error-int/error-dispatch [ctx ex] (assoc ctx :response {:status 400 :body (do (log/error ex) (cheshire.core/generate-string (parse-data-exception ex)))}) :else (assoc ctx :response {:status 400 :body (do (log/error ex) (cheshire.core/generate-string (parse-data-exception ex)))}) )) (def interceptor-error-handler {:name ::error-handler :error error-dispatch } ) "><y>#</y><d>2016-09-30</d><h>20:14</h><w>eric.vieira</w><pre>(def error-dispatch
  (error-int/error-dispatch [ctx ex]
                            (assoc ctx :response {:status 400 :body (do
                                                                      (log/error ex)
                                                                      (cheshire.core/generate-string (parse-data-exception ex)))})
                            :else (assoc ctx :response {:status 400 :body (do
                                                                            (log/error ex)
                                                                            (cheshire.core/generate-string (parse-data-exception ex)))})

                            ))

(def interceptor-error-handler
  {:name ::error-handler
   :error error-dispatch
   }
  )
</pre></z><z id="t1475266635" t="mtnygard Something definitely doesn&apos;t look right."><y>#</y><d>2016-09-30</d><h>20:17</h><w>mtnygard</w>Something definitely doesn&apos;t look right.</z><z id="t1475266669" t="mtnygard The body of error-dispatch should be core.match forms. Here&apos;s an example from the test suite:"><y>#</y><d>2016-09-30</d><h>20:17</h><w>mtnygard</w>The body of <code>error-dispatch</code> should be core.match forms. Here&apos;s an example from the test suite:</z><z id="t1475266675" t="mtnygard (def service-error-handler (error-int/error-dispatch [ctx ex] [{:exception-type :java.lang.ArithmeticException :interceptor :: another-bad-one}] (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;}) [{:exception-type :java.lang.ArithmeticException}] (assoc ctx :response {:status 400 :body &quot;A bad one&quot;}) ;; If we don&apos;t match, forward it on :else (assoc ctx :io.pedestal.interceptor.chain/error ex)))"><y>#</y><d>2016-09-30</d><h>20:17</h><w>mtnygard</w>(def service-error-handler
  (error-int/error-dispatch [ctx ex]
    [{:exception-type :java.lang.ArithmeticException
      :interceptor <b>::</b>another-bad-one}] (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;})
    [{:exception-type :java.lang.ArithmeticException}] (assoc ctx :response {:status 400 :body &quot;A bad one&quot;})
    ;; If we don&apos;t match, forward it on
    :else (assoc ctx :io.pedestal.interceptor.chain/error ex)))</z><z id="t1475266681" t="mtnygard (def service-error-handler (error-int/error-dispatch [ctx ex] [{:exception-type :java.lang.ArithmeticException :interceptor ::another-bad-one}] (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;}) [{:exception-type :java.lang.ArithmeticException}] (assoc ctx :response {:status 400 :body &quot;A bad one&quot;}) ;; If we don&apos;t match, forward it on :else (assoc ctx :io.pedestal.interceptor.chain/error ex))) "><y>#</y><d>2016-09-30</d><h>20:18</h><w>mtnygard</w><pre>(def service-error-handler
  (error-int/error-dispatch [ctx ex]
    [{:exception-type :java.lang.ArithmeticException
      :interceptor ::another-bad-one}] (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;})
    [{:exception-type :java.lang.ArithmeticException}] (assoc ctx :response {:status 400 :body &quot;A bad one&quot;})
    ;; If we don&apos;t match, forward it on
    :else (assoc ctx :io.pedestal.interceptor.chain/error ex)))
</pre></z><z id="t1475266694" t="mtnygard One sec, let me reformat for clarity"><y>#</y><d>2016-09-30</d><h>20:18</h><w>mtnygard</w>One sec, let me reformat for clarity</z><z id="t1475266729" t="mtnygard (def service-error-handler (error-int/error-dispatch [ctx ex] [{:exception-type :java.lang.ArithmeticException :interceptor ::another-bad-one}] (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;}) [{:exception-type :java.lang.ArithmeticException}] (assoc ctx :response {:status 400 :body &quot;A bad one&quot;}) ;; If we don&apos;t match, forward it on :else (assoc ctx :io.pedestal.interceptor.chain/error ex))) "><y>#</y><d>2016-09-30</d><h>20:18</h><w>mtnygard</w><pre>(def service-error-handler
  (error-int/error-dispatch [ctx ex]
    [{:exception-type :java.lang.ArithmeticException :interceptor ::another-bad-one}]
    (assoc ctx :response {:status 400 :body &quot;Another bad one&quot;})
                            
    [{:exception-type :java.lang.ArithmeticException}]
    (assoc ctx :response {:status 400 :body &quot;A bad one&quot;})
    
    ;; If we don&apos;t match, forward it on
    :else
    (assoc ctx :io.pedestal.interceptor.chain/error ex)))
</pre></z><z id="t1475266759" t="mtnygard The body is in pairs of forms. The first form is a pattern match. The second clause is what to execute if the pattern matches."><y>#</y><d>2016-09-30</d><h>20:19</h><w>mtnygard</w>The body is in pairs of forms. The first form is a pattern match. The second clause is what to execute if the pattern matches.</z><z id="t1475266778" t="mtnygard And the return value from error-dispatch is an interceptor, so no need to further wrap it in another interceptor."><y>#</y><d>2016-09-30</d><h>20:19</h><w>mtnygard</w>And the return value from <code>error-dispatch</code> is an interceptor, so no need to further wrap it in another interceptor.</z><z id="t1475505403" t="ul hi there! i&apos;m trying to make simple proxy endpoint in my service, and write it like this (defn image-proxy [request] (-&gt; request (get-in [:params :url]) (client/get) (deref) (select-keys [:status :headers :body]) (update :headers #(encore/map-keys name %)))) (def routes #{[&quot;/proxy&quot; :get [`proxy]]}) But when I visit http://localhost:8080/proxy?url=http://google.com I get an error: `"><y>#</y><d>2016-10-03</d><h>14:36</h><w>ul</w>hi there! i&apos;m trying to make simple proxy endpoint in my service, and write it like this
<pre>(defn image-proxy [request]
  (-&gt; request
      (get-in [:params :url])
      (client/get)
      (deref)
      (select-keys [:status :headers :body])
      (update :headers #(encore/map-keys name %))))

(def routes #{[&quot;/proxy&quot; :get [`proxy]]})
</pre>

But when I visit <a href="http://localhost:8080/proxy?url=http://google.com" target="_blank">http://localhost:8080/proxy?url=http://google.com</a> I get an error:
<code></code>`</z><z id="t1475505443" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U055Y1X47&quot;}] . I can help"><y>#</y><d>2016-10-03</d><h>14:37</h><w>mtnygard</w>Hi <a>@ul</a>. I can help</z><z id="t1475505448" t="mtnygard The error didn’t come through though."><y>#</y><d>2016-10-03</d><h>14:37</h><w>mtnygard</w>The error didn’t come through though.</z><z id="t1475505463" t="ul one second, will put it into gist, too big to flood the chat"><y>#</y><d>2016-10-03</d><h>14:37</h><w>ul</w>one second, will put it into gist, too big to flood the chat</z><z id="t1475505467" t="mtnygard OK"><y>#</y><d>2016-10-03</d><h>14:37</h><w>mtnygard</w>OK</z><z id="t1475505550" t="mtnygard That is a sizeable error all right."><y>#</y><d>2016-10-03</d><h>14:39</h><w>mtnygard</w>That is a sizeable error all right.</z><z id="t1475505551" t="ul Essentially it is Caused by: org.xnio.channels.FixedLengthOverflowException: null"><y>#</y><d>2016-10-03</d><h>14:39</h><w>ul</w>Essentially it is <code>Caused by: org.xnio.channels.FixedLengthOverflowException: null</code></z><z id="t1475505573" t="ul Would you mind explaining me? I&apos;m lost honestly speaking"><y>#</y><d>2016-10-03</d><h>14:39</h><w>ul</w>Would you mind explaining me? I&apos;m lost honestly speaking</z><z id="t1475505645" t="ul I plan to use this proxy endpoint to convey images to my app&apos;s canvas. To allow canvas to be snapshotted they must come from my domain, thus need for proxy"><y>#</y><d>2016-10-03</d><h>14:40</h><w>ul</w>I plan to use this proxy endpoint to convey images to my app&apos;s canvas. To allow canvas to be snapshotted they must come from my domain, thus need for proxy</z><z id="t1475505649" t="mtnygard I’m looking at the stack trace, and I notice Undertow in the mix."><y>#</y><d>2016-10-03</d><h>14:40</h><w>mtnygard</w>I’m looking at the stack trace, and I notice Undertow in the mix.</z><z id="t1475505667" t="mtnygard Could you try the same thing with Jetty as the container? Just to see if it’s specific to Undertow"><y>#</y><d>2016-10-03</d><h>14:41</h><w>mtnygard</w>Could you try the same thing with Jetty as the container? Just to see if it’s specific to Undertow</z><z id="t1475505673" t="ul yes, i use io.pedestal/pedestal.immutant"><y>#</y><d>2016-10-03</d><h>14:41</h><w>ul</w>yes, i use <code>io.pedestal/pedestal.immutant</code></z><z id="t1475505681" t="ul just a sec"><y>#</y><d>2016-10-03</d><h>14:41</h><w>ul</w>just a sec</z><z id="t1475505812" t="mtnygard OK, that helps a lot."><y>#</y><d>2016-10-03</d><h>14:43</h><w>mtnygard</w>OK, that helps a lot.</z><z id="t1475505838" t="mtnygard I think the issue is that when you do (select-keys) from the Google response, you’re picking up the Content-Length header. But the body is somehow now exactly the same length."><y>#</y><d>2016-10-03</d><h>14:43</h><w>mtnygard</w>I think the issue is that when you do (select-keys) from the Google response, you’re picking up the Content-Length header. But the body is somehow now exactly the same length.</z><z id="t1475505848" t="mtnygard That’s what those errors each indicate in their own special way."><y>#</y><d>2016-10-03</d><h>14:44</h><w>mtnygard</w>That’s what those errors each indicate in their own special way.</z><z id="t1475505862" t="mtnygard Just that Content-Length doesn’t match the number of bytes sent"><y>#</y><d>2016-10-03</d><h>14:44</h><w>mtnygard</w>Just that Content-Length doesn’t match the number of bytes sent</z><z id="t1475505875" t="ul Aha! Not obvious... Thank you very much! I think I can just drop that header?"><y>#</y><d>2016-10-03</d><h>14:44</h><w>ul</w>Aha! Not obvious... Thank you very much! I think I can just drop that header?</z><z id="t1475505890" t="mtnygard I think so. The server should fill it in for you"><y>#</y><d>2016-10-03</d><h>14:44</h><w>mtnygard</w>I think so. The server should fill it in for you</z><z id="t1475505919" t="mtnygard I’d be concerned about some of the other headers that Google offers… like the privacy policy. IDK if it’s legit to just pass that along."><y>#</y><d>2016-10-03</d><h>14:45</h><w>mtnygard</w>I’d be concerned about some of the other headers that Google offers… like the privacy policy. IDK if it’s legit to just pass that along.</z><z id="t1475505924" t="mtnygard But it should work for your images."><y>#</y><d>2016-10-03</d><h>14:45</h><w>mtnygard</w>But it should work for your images.</z><z id="t1475505960" t="ul perhaps the best would be to define whitelist of headers safe to pass, like content-type"><y>#</y><d>2016-10-03</d><h>14:46</h><w>ul</w>perhaps the best would be to define whitelist of headers safe to pass, like content-type</z><z id="t1475505973" t="ul thank you very much!"><y>#</y><d>2016-10-03</d><h>14:46</h><w>ul</w>thank you very much!</z><z id="t1475505974" t="mtnygard That makes sense"><y>#</y><d>2016-10-03</d><h>14:46</h><w>mtnygard</w>That makes sense</z><z id="t1475505975" t="mtnygard yw"><y>#</y><d>2016-10-03</d><h>14:46</h><w>mtnygard</w>yw</z><z id="t1475508087" t="mtnygard New doc published. Covers error handling and the pattern-matching error-dispatch macro."><y>#</y><d>2016-10-03</d><h>15:21</h><w>mtnygard</w>New doc published. Covers error handling and the pattern-matching error-dispatch macro.</z><z id="t1475508088" t="mtnygard http://pedestal.io/reference/error-handling"><y>#</y><d>2016-10-03</d><h>15:21</h><w>mtnygard</w><a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a></z><z id="t1475508113" t="mtnygard As always, I welcome bug reports and pull requests."><y>#</y><d>2016-10-03</d><h>15:21</h><w>mtnygard</w>As always, I welcome bug reports and pull requests.</z><z id="t1475508180" t="grzm that looks really useful. Thanks, mtnygard!"><y>#</y><d>2016-10-03</d><h>15:23</h><w>grzm</w>that looks really useful. Thanks, mtnygard!</z><z id="t1475668295" t="mtnygard Dan De Aguiar contributed a guide on using Pedestal with Component."><y>#</y><d>2016-10-05</d><h>11:51</h><w>mtnygard</w>Dan De Aguiar contributed a guide on using Pedestal with Component.</z><z id="t1475668296" t="mtnygard http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2016-10-05</d><h>11:51</h><w>mtnygard</w><a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1475668302" t="mtnygard Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2016-10-05</d><h>11:51</h><w>mtnygard</w>Thanks <a>@ddeaguiar</a> !</z><z id="t1475674291" t="ddeaguiar 👍"><y>#</y><d>2016-10-05</d><h>13:31</h><w>ddeaguiar</w><b>👍</b></z><z id="t1475832195" t="chrisetheridge am i being daft, or are there no guides on dynamically adding/removing interceptors to the chain in a route? the guides link to a 404"><y>#</y><d>2016-10-07</d><h>09:23</h><w>chrisetheridge</w>am i being daft, or are there no guides on dynamically adding/removing interceptors to the chain in a route? the guides link to a 404</z><z id="t1475846155" t="mtnygard [:attrs {:href &quot;/_/_/users/U0HJ7CX6H&quot;}] The docs are definitely still a work in progress. I’ve been adding guides when I can, and trying to add placeholders when I link to something that doesn’t exist yet."><y>#</y><d>2016-10-07</d><h>13:15</h><w>mtnygard</w><a>@biscuitpants</a> The docs are definitely still a work in progress. I’ve been adding guides when I can, and trying to add placeholders when I link to something that doesn’t exist yet.</z><z id="t1475846174" t="chrisetheridge oh no i mean the docs on github 🙂 not the new docs!"><y>#</y><d>2016-10-07</d><h>13:16</h><w>chrisetheridge</w>oh no i mean the docs on github <b>🙂</b> not the new docs!</z><z id="t1475846192" t="mtnygard OK. Which link did you follow that was 404?"><y>#</y><d>2016-10-07</d><h>13:16</h><w>mtnygard</w>OK. Which link did you follow that was 404?</z><z id="t1475846352" t="chrisetheridge this one: https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/route.clj"><y>#</y><d>2016-10-07</d><h>13:19</h><w>chrisetheridge</w>this one: <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/route.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/route.clj</a></z><z id="t1475846384" t="mtnygard Yep, that’s a 404. It should go to https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj now"><y>#</y><d>2016-10-07</d><h>13:19</h><w>mtnygard</w>Yep, that’s a 404. It should go to <a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj</a> now</z><z id="t1475846395" t="mtnygard Do you recall which page that link was on?"><y>#</y><d>2016-10-07</d><h>13:19</h><w>mtnygard</w>Do you recall which page that link was on?</z><z id="t1475846526" t="mtnygard Ah, I think I’ve found it. From the “service-interceptors.md” page, right?"><y>#</y><d>2016-10-07</d><h>13:22</h><w>mtnygard</w>Ah, I think I’ve found it. From the “service-interceptors.md” page, right?</z><z id="t1475846568" t="chrisetheridge yeah this one, sorry, https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md"><y>#</y><d>2016-10-07</d><h>13:22</h><w>chrisetheridge</w>yeah this one, sorry, <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-interceptors.md</a></z><z id="t1475846580" t="mtnygard Thanks. I will fix that."><y>#</y><d>2016-10-07</d><h>13:23</h><w>mtnygard</w>Thanks. I will fix that.</z><z id="t1475846669" t="chrisetheridge thanks so much!"><y>#</y><d>2016-10-07</d><h>13:24</h><w>chrisetheridge</w>thanks so much!</z><z id="t1475846716" t="chrisetheridge ah thank you for the original link"><y>#</y><d>2016-10-07</d><h>13:25</h><w>chrisetheridge</w>ah thank you for the original link</z><z id="t1475846860" t="chrisetheridge [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] so is this the inteceptor being spoken about: https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L410"><y>#</y><d>2016-10-07</d><h>13:27</h><w>chrisetheridge</w><a>@mtnygard</a> so is this the inteceptor being spoken about: <a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L410" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L410</a></z><z id="t1475846914" t="mtnygard Yes, but it’s no longer a useful example of adding interceptors, because there are a couple levels of indirection still inside that interceptor."><y>#</y><d>2016-10-07</d><h>13:28</h><w>mtnygard</w>Yes, but it’s no longer a useful example of adding interceptors, because there are a couple levels of indirection still inside that interceptor.</z><z id="t1475847011" t="chrisetheridge ah. is there another newer example?"><y>#</y><d>2016-10-07</d><h>13:30</h><w>chrisetheridge</w>ah. is there another newer example?</z><z id="t1475847025" t="mtnygard I’m digging up a link to the API you need for that."><y>#</y><d>2016-10-07</d><h>13:30</h><w>mtnygard</w>I’m digging up a link to the API you need for that.</z><z id="t1475847027" t="chrisetheridge basically, we’d like to drop some interceptors on the route health-check"><y>#</y><d>2016-10-07</d><h>13:30</h><w>chrisetheridge</w>basically, we’d like to drop some interceptors on the route <code>health-check</code></z><z id="t1475847031" t="chrisetheridge perfect, thank you so much!"><y>#</y><d>2016-10-07</d><h>13:30</h><w>chrisetheridge</w>perfect, thank you so much!</z><z id="t1475847037" t="mtnygard http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-enqueue"><y>#</y><d>2016-10-07</d><h>13:30</h><w>mtnygard</w><a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-enqueue" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-enqueue</a></z></g><g id="s1"><z id="t1475847056" t="mtnygard Basically, you just call enqueue with the current context and the new interceptors you want to add to the stack"><y>#</y><d>2016-10-07</d><h>13:30</h><w>mtnygard</w>Basically, you just call <code>enqueue</code> with the current context and the new interceptors you want to add to the stack</z><z id="t1475847081" t="chrisetheridge okay great. seems simple enough. thank you for the help"><y>#</y><d>2016-10-07</d><h>13:31</h><w>chrisetheridge</w>okay great. seems simple enough. thank you for the help</z><z id="t1475847120" t="mtnygard yw"><y>#</y><d>2016-10-07</d><h>13:32</h><w>mtnygard</w>yw</z><z id="t1475854293" t="si14 interceptors are basically in every project that I like — pedestal, re-frame, Netty (they don&apos;t call &apos;em interceptors, but they are) :)"><y>#</y><d>2016-10-07</d><h>15:31</h><w>si14</w>interceptors are basically in every project that I like — pedestal, re-frame, Netty (they don&apos;t call &apos;em interceptors, but they are) :)</z><z id="t1476381702" t="juliobarros From the guides page http://pedestal.io/guides/developing-at-the-repl 404s. Does that guide still exist?"><y>#</y><d>2016-10-13</d><h>18:01</h><w>juliobarros</w>From the guides page <a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a> 404s. Does that guide still exist?</z><z id="t1476391024" t="mtnygard [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] It is under development. You can look at https://github.com/pedestal/pedestal-docs/pull/37 for the current draft and discussion."><y>#</y><d>2016-10-13</d><h>20:37</h><w>mtnygard</w><a>@juliobarros</a> It is under development. You can look at <a href="https://github.com/pedestal/pedestal-docs/pull/37" target="_blank">https://github.com/pedestal/pedestal-docs/pull/37</a> for the current draft and discussion.</z><z id="t1476391051" t="mtnygard And a quicker view of the content. https://github.com/christianromney/docs/blob/eb63b2fc8b2bbfd43424f353604f6fe7a48d56f7/content/guides/developing-at-the-repl.adoc"><y>#</y><d>2016-10-13</d><h>20:37</h><w>mtnygard</w>And a quicker view of the content. <a href="https://github.com/christianromney/docs/blob/eb63b2fc8b2bbfd43424f353604f6fe7a48d56f7/content/guides/developing-at-the-repl.adoc" target="_blank">https://github.com/christianromney/docs/blob/eb63b2fc8b2bbfd43424f353604f6fe7a48d56f7/content/guides/developing-at-the-repl.adoc</a></z><z id="t1476391062" t="mtnygard Thanks to [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] for drafting this one!"><y>#</y><d>2016-10-13</d><h>20:37</h><w>mtnygard</w>Thanks to <a>@christianromney</a> for drafting this one!</z><z id="t1476391094" t="juliobarros [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] : thanks!"><y>#</y><d>2016-10-13</d><h>20:38</h><w>juliobarros</w><a>@mtnygard</a>: thanks!</z><z id="t1476393690" t="christianromney Paul had some great feedback for me that I plan to incorporate soon. If you have anything else to add, please feel free to let me know"><y>#</y><d>2016-10-13</d><h>21:21</h><w>christianromney</w>Paul had some great feedback for me that I plan to incorporate soon. If you have anything else to add, please feel free to let me know</z><z id="t1476738795" t="eric.vieira Hi, I`m trying to send a request with a :delete params and :body. however, don`t acess body in interception and handler before it changes to table-routes."><y>#</y><d>2016-10-17</d><h>21:13</h><w>eric.vieira</w>Hi, I`m trying to send a request with a :delete params  and :body. however,  don`t acess body in interception and handler before it changes to  table-routes.</z><z id="t1476738885" t="eric.vieira example: (response-for test-utils/service :delete “/entity&quot; :body “….”)"><y>#</y><d>2016-10-17</d><h>21:14</h><w>eric.vieira</w>example: 
<pre>(response-for test-utils/service :delete  “/entity&quot;  :body  “….”)</pre></z><z id="t1476738902" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U1ER5BCMD&quot;}] , I might be able to help. This is in testing?"><y>#</y><d>2016-10-17</d><h>21:15</h><w>mtnygard</w>Hi <a>@eric.vieira</a>, I might be able to help. This is in testing?</z><z id="t1476739004" t="eric.vieira th request :post is ok … but request :delete no access body-params"><y>#</y><d>2016-10-17</d><h>21:16</h><w>eric.vieira</w>th request :post is ok … but request :delete no access body-params</z><z id="t1476739015" t="mtnygard Can you paste your routes?"><y>#</y><d>2016-10-17</d><h>21:16</h><w>mtnygard</w>Can you paste your routes?</z><z id="t1476739100" t="eric.vieira (def routes (table/table-routes {} [ [&quot;/“ :post (public-interceptors home-page) :route-name :main] [&quot;/&quot; :delete (auth-interceptors delete-entidade) :route-name :main-delete] ] ) ) "><y>#</y><d>2016-10-17</d><h>21:18</h><w>eric.vieira</w><pre>(def routes
  (table/table-routes
    {}
    [
     [&quot;/“ :post (public-interceptors home-page) :route-name :main]
     [&quot;/&quot; :delete (auth-interceptors delete-entidade) :route-name :main-delete]
]
    )
  )
</pre></z><z id="t1476739136" t="mtnygard That part looks OK. What is in the auth-interceptors function?"><y>#</y><d>2016-10-17</d><h>21:18</h><w>mtnygard</w>That part looks OK. What is in the <code>auth-interceptors</code> function?</z><z id="t1476739171" t="eric.vieira list of intercpetors"><y>#</y><d>2016-10-17</d><h>21:19</h><w>eric.vieira</w>list of intercpetors</z><z id="t1476739220" t="mtnygard Does that list include the interceptor returned from the body-params function?"><y>#</y><d>2016-10-17</d><h>21:20</h><w>mtnygard</w>Does that list include the interceptor returned from the <code>body-params</code> function?</z><z id="t1476739241" t="eric.vieira (defn auth-interceptors [handler] [ error-handler/interceptor-error-handler (body-params/body-params) {:name :json-body :enter nil :leave parser/json-&gt;body} {:name :: auth :enter auth/token-&gt;auth :leave auth/auth-&gt;token} {:name :json-edn :enter parser/json-&gt;edn :leave parser/edn-&gt;json} handler] )"><y>#</y><d>2016-10-17</d><h>21:20</h><w>eric.vieira</w>(defn auth-interceptors [handler]
  [
   error-handler/interceptor-error-handler
   (body-params/body-params)
   {:name :json-body :enter nil :leave parser/json-&gt;body}
   {:name <b>::</b>auth :enter auth/token-&gt;auth :leave auth/auth-&gt;token}
   {:name :json-edn :enter parser/json-&gt;edn :leave parser/edn-&gt;json}
   handler]
  )</z><z id="t1476739298" t="eric.vieira the problem is not acess body in request :delete .. in :post it is OK"><y>#</y><d>2016-10-17</d><h>21:21</h><w>eric.vieira</w>the problem is not acess body in request  :delete .. in :post it is OK</z><z id="t1476739402" t="mtnygard And you are not doing anything to set the Content-Type header on the test requests, right?"><y>#</y><d>2016-10-17</d><h>21:23</h><w>mtnygard</w>And you are not doing anything to set the Content-Type header on the test requests, right?</z><z id="t1476739445" t="eric.vieira no set"><y>#</y><d>2016-10-17</d><h>21:24</h><w>eric.vieira</w>no set</z><z id="t1476739490" t="mtnygard I&apos;m going to make a quick test app and see what&apos;s going on. I&apos;ll be back in a few minutes."><y>#</y><d>2016-10-17</d><h>21:24</h><w>mtnygard</w>I&apos;m going to make a quick test app and see what&apos;s going on. I&apos;ll be back in a few minutes.</z><z id="t1476739500" t="eric.vieira ok"><y>#</y><d>2016-10-17</d><h>21:25</h><w>eric.vieira</w>ok</z><z id="t1476739591" t="eric.vieira find error.. miss set :headers {&quot;Content-Type&quot; &quot;application/json&quot;}"><y>#</y><d>2016-10-17</d><h>21:26</h><w>eric.vieira</w>find error.. miss set :headers {&quot;Content-Type&quot;  &quot;application/json&quot;}</z><z id="t1476739598" t="eric.vieira thanks"><y>#</y><d>2016-10-17</d><h>21:26</h><w>eric.vieira</w>thanks</z><z id="t1476739611" t="mtnygard I&apos;m glad you found the problem!"><y>#</y><d>2016-10-17</d><h>21:26</h><w>mtnygard</w>I&apos;m glad you found the problem!</z><z id="t1476817973" t="scott.haleen Is there a sample of how to handle fileupload or just multipart/form-data with pedestal?"><y>#</y><d>2016-10-18</d><h>19:12</h><w>scott.haleen</w>Is there a sample of how to handle fileupload or just multipart/form-data with pedestal?</z><z id="t1476818012" t="mtnygard There was some discussion of this in https://github.com/pedestal/pedestal/issues/444"><y>#</y><d>2016-10-18</d><h>19:13</h><w>mtnygard</w>There was some discussion of this in <a href="https://github.com/pedestal/pedestal/issues/444" target="_blank">https://github.com/pedestal/pedestal/issues/444</a></z><z id="t1476818032" t="mtnygard (At my fingertips because I&apos;m working on a doc that should incorporate that info. Like right now.)"><y>#</y><d>2016-10-18</d><h>19:13</h><w>mtnygard</w>(At my fingertips because I&apos;m working on a doc that should incorporate that info. Like right now.)</z><z id="t1476818033" t="mtnygard 🙂"><y>#</y><d>2016-10-18</d><h>19:13</h><w>mtnygard</w><b>🙂</b></z><z id="t1476818050" t="souenzzo Hello! How do I handle internal erros(exceptions)? curl &apos;&apos; returns text/plain 500 Internal server error Internally: clojure.lang.ExceptionInfo: Interceptor Exception: URLDecoder: Incomplete trailing escape (%) pattern Can I intercept/handle this to make a custon response?"><y>#</y><d>2016-10-18</d><h>19:14</h><w>souenzzo</w>Hello! How do I handle internal erros(exceptions)?
<code>curl &apos;&apos;</code> returns <code>text/plain</code> <code>500</code> <code>Internal server error</code>
Internally: <code>clojure.lang.ExceptionInfo: Interceptor Exception: URLDecoder: Incomplete trailing escape (%) pattern</code>
Can I intercept/handle this to make a custon response?</z><z id="t1476818057" t="scott.haleen awesome thanks, I will check that out"><y>#</y><d>2016-10-18</d><h>19:14</h><w>scott.haleen</w>awesome thanks, I will check that out</z><z id="t1476818087" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] . You sure can. Take a look at http://pedestal.io/reference/error-handling and let me know if it tells you what you need to know."><y>#</y><d>2016-10-18</d><h>19:14</h><w>mtnygard</w>Hi <a>@souenzzo</a>. You sure can. Take a look at <a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a> and let me know if it tells you what you need to know.</z><z id="t1476818137" t="souenzzo It seems that this happens before this interceptor"><y>#</y><d>2016-10-18</d><h>19:15</h><w>souenzzo</w>It seems that this happens before this interceptor</z><z id="t1476818239" t="souenzzo My :else dosen&apos;t get this except...."><y>#</y><d>2016-10-18</d><h>19:17</h><w>souenzzo</w>My <code>:else</code> dosen&apos;t get this except....</z><z id="t1476818266" t="mtnygard Which :else would that be?"><y>#</y><d>2016-10-18</d><h>19:17</h><w>mtnygard</w>Which <code>:else</code> would that be?</z><z id="t1476818439" t="souenzzo My :else on io.pedestal.interceptor.error/error-dispatch macro. I&apos;ts my first interceptor on (def r table-routes [[&quot;/query&quot; :get [err-interceptor query] :route-name :query])"><y>#</y><d>2016-10-18</d><h>19:20</h><w>souenzzo</w>My <code>:else</code> on <code>io.pedestal.interceptor.error/error-dispatch</code> macro.
I&apos;ts my first interceptor on <code>  (def r table-routes [[&quot;/query&quot; :get [err-interceptor query] :route-name :query])</code></z><z id="t1476818465" t="mtnygard Interesting! Give me a minute to try to replicate that."><y>#</y><d>2016-10-18</d><h>19:21</h><w>mtnygard</w>Interesting! Give me a minute to try to replicate that.</z><z id="t1476818834" t="mtnygard I can definitely reproduce the problem. Looking into a solution now."><y>#</y><d>2016-10-18</d><h>19:27</h><w>mtnygard</w>I can definitely reproduce the problem. Looking into a solution now.</z><z id="t1476819074" t="souenzzo On my example is missing the ? . minimal example shoud be localhost/?%"><y>#</y><d>2016-10-18</d><h>19:31</h><w>souenzzo</w>On my example is missing the <code>?</code>.
minimal example shoud be <code>localhost/?%</code></z><z id="t1476819508" t="mtnygard OK, I&apos;ve got an explanation and a solution for you. Which would you like to have first? 🙂"><y>#</y><d>2016-10-18</d><h>19:38</h><w>mtnygard</w>OK, I&apos;ve got an explanation and a solution for you. Which would you like to have first? <b>🙂</b></z><z id="t1476819543" t="mtnygard In the interest of time, I&apos;ll start with the solution."><y>#</y><d>2016-10-18</d><h>19:39</h><w>mtnygard</w>In the interest of time, I&apos;ll start with the solution.</z><z id="t1476819574" t="mtnygard 1. Instead of putting the error handling in your routes, you will need to have it come early in the chain of interceptors. Before the router, in fact. The way to do this is as follows:"><y>#</y><d>2016-10-18</d><h>19:39</h><w>mtnygard</w>1. Instead of putting the error handling in your routes, you will need to have it come early in the chain of interceptors. Before the router, in fact. The way to do this is as follows:</z><z id="t1476819601" t="mtnygard - Call io.pedestal.http/default-interceptors with your service map. The result will be a service map with the default interceptors attached."><y>#</y><d>2016-10-18</d><h>19:40</h><w>mtnygard</w>- Call <code>io.pedestal.http/default-interceptors</code> with your service map. The result will be a service map with the default interceptors attached.</z><z id="t1476819624" t="mtnygard - Prepend your error handler to the :io.pedestal.http/interceptors key in the service map."><y>#</y><d>2016-10-18</d><h>19:40</h><w>mtnygard</w>- Prepend your error handler to the <code>:io.pedestal.http/interceptors</code> key in the service map.</z><z id="t1476819640" t="mtnygard - Call create-servlet or create-server as normal. The default interceptors will not be appended a second time."><y>#</y><d>2016-10-18</d><h>19:40</h><w>mtnygard</w>- Call <code>create-servlet</code> or <code>create-server</code> as normal. The default interceptors will not be appended a second time.</z><z id="t1476819680" t="mtnygard 2. Explanation: the exception is happening before a route is selected by the router. Thus, your error handling interceptor never gets pushed onto the stack."><y>#</y><d>2016-10-18</d><h>19:41</h><w>mtnygard</w>2. Explanation: the exception is happening before a route is selected by the router. Thus, your error handling interceptor never gets pushed onto the stack.</z><z id="t1476819710" t="mtnygard As an aside: I&apos;ll be updating the error handling reference to cover this case."><y>#</y><d>2016-10-18</d><h>19:41</h><w>mtnygard</w>As an aside: I&apos;ll be updating the error handling reference to cover this case.</z><z id="t1476826086" t="mtnygard New reference document drafted: parameters (query params, body params, and path params)"><y>#</y><d>2016-10-18</d><h>21:28</h><w>mtnygard</w>New reference document drafted: parameters (query params, body params, and path params)</z><z id="t1476826087" t="mtnygard http://pedestal.io/reference/parameters"><y>#</y><d>2016-10-18</d><h>21:28</h><w>mtnygard</w><a href="http://pedestal.io/reference/parameters" target="_blank">http://pedestal.io/reference/parameters</a></z><z id="t1476826118" t="mtnygard There&apos;s a heading that says &quot;placeholder&quot; in there... a commit that removes it is working its way through Travis right now."><y>#</y><d>2016-10-18</d><h>21:28</h><w>mtnygard</w>There&apos;s a heading that says &quot;placeholder&quot; in there... a commit that removes it is working its way through Travis right now.</z><z id="t1476872482" t="rauh So url-for-routes omits trailing / which are part of my URL. Is this intentional or a bug?"><y>#</y><d>2016-10-19</d><h>10:21</h><w>rauh</w>So <code>url-for-routes</code> omits trailing <code>/</code> which are part of my URL. Is this intentional or a bug?</z><z id="t1476887683" t="mtnygard [:attrs {:href &quot;/_/_/users/U051SA920&quot;}]"><y>#</y><d>2016-10-19</d><h>14:34</h><w>mtnygard</w><a>@rauh</a></z><z id="t1476887730" t="mtnygard [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] Interesting... I think that has to do with the path parsing. The trailing / probably gets turned into an empty string in the route&apos;s :path-parts . Running a check to verify that now."><y>#</y><d>2016-10-19</d><h>14:35</h><w>mtnygard</w><a>@rauh</a> Interesting... I think that has to do with the path parsing. The trailing <code>/</code> probably gets turned into an empty string in the route&apos;s <code>:path-parts</code>. Running a check to verify that now.</z><z id="t1476887927" t="mtnygard [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] Nope, I was wrong. The trailing slash gets elided completely when parsing the route. So by the time you call url-for-routes , there&apos;s nothing there to represent that slash."><y>#</y><d>2016-10-19</d><h>14:38</h><w>mtnygard</w><a>@rauh</a> Nope, I was wrong. The trailing slash gets elided completely when parsing the route. So by the time you call <code>url-for-routes</code>, there&apos;s nothing there to represent that slash.</z><z id="t1476888049" t="rauh [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] If it matters: I&apos;m using the new/fast MapRouter"><y>#</y><d>2016-10-19</d><h>14:40</h><w>rauh</w><a>@mtnygard</a> If it matters: I&apos;m using the new/fast MapRouter</z><z id="t1476888076" t="mtnygard I don&apos;t think that matters, but I will double-check."><y>#</y><d>2016-10-19</d><h>14:41</h><w>mtnygard</w>I don&apos;t think that matters, but I will double-check.</z><z id="t1476888125" t="mtnygard OK, so I just confirmed. The router doesn&apos;t affect url-for-routes. Which route syntax are you using?"><y>#</y><d>2016-10-19</d><h>14:42</h><w>mtnygard</w>OK, so I just confirmed. The router doesn&apos;t affect url-for-routes. Which route syntax are you using?</z><z id="t1476890561" t="rauh ((router/url-for-routes (table/table-routes [[&quot;/api/&quot; :get identity :route-name :x]])) :x) ;; =&gt; &quot;/api&quot; "><y>#</y><d>2016-10-19</d><h>15:22</h><w>rauh</w><pre>((router/url-for-routes
   (table/table-routes
     [[&quot;/api/&quot;
       :get identity
       :route-name :x]]))
  :x)
;; =&gt; &quot;/api&quot;
</pre></z><z id="t1476890587" t="rauh [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ^"><y>#</y><d>2016-10-19</d><h>15:23</h><w>rauh</w><a>@mtnygard</a>  ^</z><z id="t1476890623" t="mtnygard I would bet that matches on both “/api/“ and “/api&quot;"><y>#</y><d>2016-10-19</d><h>15:23</h><w>mtnygard</w>I would bet that matches on both “/api/“ and “/api&quot;</z><z id="t1476890635" t="rauh Nope, 404&apos;s"><y>#</y><d>2016-10-19</d><h>15:23</h><w>rauh</w>Nope, 404&apos;s</z><z id="t1476890645" t="mtnygard Huh. OK."><y>#</y><d>2016-10-19</d><h>15:24</h><w>mtnygard</w>Huh. OK.</z><z id="t1476890665" t="mtnygard Can you paste the value that table/table-routes returns?"><y>#</y><d>2016-10-19</d><h>15:24</h><w>mtnygard</w>Can you paste the value that <code>table/table-routes</code> returns?</z><z id="t1476890682" t="rauh =&gt; ({:path &quot;/api/&quot;, :method :get, :path-re #&quot;/\Qapi\E&quot;, :path-parts [&quot;api&quot;], :interceptors [#Interceptor{:name }], :route-name :x, :path-params []}) "><y>#</y><d>2016-10-19</d><h>15:24</h><w>rauh</w><pre>=&gt; ({:path &quot;/api/&quot;, :method :get, :path-re #&quot;/\Qapi\E&quot;, :path-parts [&quot;api&quot;], :interceptors [#Interceptor{:name }], :route-name :x, :path-params []})
</pre></z><z id="t1476890720" t="mtnygard one sec."><y>#</y><d>2016-10-19</d><h>15:25</h><w>mtnygard</w>one sec.</z><z id="t1476890812" t="mtnygard OK, now I see what’s going on. The map-tree router uses :path to match, whereas the prefix-tree and linear-search use :path-re"><y>#</y><d>2016-10-19</d><h>15:26</h><w>mtnygard</w>OK, now I see what’s going on. The map-tree router uses :path to match, whereas the prefix-tree and linear-search use :path-re</z><z id="t1476890827" t="mtnygard But url-for-routes reconstructs the path from :path-parts."><y>#</y><d>2016-10-19</d><h>15:27</h><w>mtnygard</w>But url-for-routes reconstructs the path from :path-parts.</z><z id="t1476890841" t="mtnygard I’d definitely call this a bug."><y>#</y><d>2016-10-19</d><h>15:27</h><w>mtnygard</w>I’d definitely call this a bug.</z><z id="t1476890851" t="rauh I see. Thanks for checking, should I report?"><y>#</y><d>2016-10-19</d><h>15:27</h><w>rauh</w>I see. Thanks for checking, should I report?</z><z id="t1476890855" t="mtnygard Please do!"><y>#</y><d>2016-10-19</d><h>15:27</h><w>mtnygard</w>Please do!</z><z id="t1476890866" t="rauh ok"><y>#</y><d>2016-10-19</d><h>15:27</h><w>rauh</w>ok</z><z id="t1476890885" t="mtnygard I can’t think of a workaround at the moment. How important is that trailing slash to you? 🙂"><y>#</y><d>2016-10-19</d><h>15:28</h><w>mtnygard</w>I can’t think of a workaround at the moment. How important is that trailing slash to you? <b>🙂</b></z><z id="t1476893139" t="rauh I just wrapped it and added a slash 🙂"><y>#</y><d>2016-10-19</d><h>16:05</h><w>rauh</w>I just wrapped it and added a slash <b>🙂</b></z><z id="t1476893147" t="rauh Not important, only for my tests..."><y>#</y><d>2016-10-19</d><h>16:05</h><w>rauh</w>Not important, only for my tests...</z><z id="t1477333384" t="crimeminister Hi folks, does anyone have an example of a trivial or small Pedestal app using component?"><y>#</y><d>2016-10-24</d><h>18:23</h><w>crimeminister</w>Hi folks, does anyone have an example of a trivial or small Pedestal app using component?</z><z id="t1477339096" t="mtnygard [:attrs {:href &quot;/_/_/users/U066SF64X&quot;}] You are in luck: http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2016-10-24</d><h>19:58</h><w>mtnygard</w><a>@crimeminister</a> You are in luck: <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1477341492" t="crimeminister !!!"><y>#</y><d>2016-10-24</d><h>20:38</h><w>crimeminister</w>!!!</z><z id="t1477341526" t="crimeminister Excuse me while I wipe the egg off my face…"><y>#</y><d>2016-10-24</d><h>20:38</h><w>crimeminister</w>Excuse me while I wipe the egg off my face…</z><z id="t1477341594" t="mtnygard Hope it helps."><y>#</y><d>2016-10-24</d><h>20:39</h><w>mtnygard</w>Hope it helps.</z><z id="t1477342254" t="crimeminister Much appreciated"><y>#</y><d>2016-10-24</d><h>20:50</h><w>crimeminister</w>Much appreciated</z><z id="t1477345594" t="hagmonk I&apos;m going a bit mad here with pedestal, I must be doing something wrong"><y>#</y><d>2016-10-24</d><h>21:46</h><w>hagmonk</w>I&apos;m going a bit mad here with pedestal, I must be doing something wrong</z><z id="t1477345629" t="mtnygard You just caught me before heading out the door. Whatcha got?"><y>#</y><d>2016-10-24</d><h>21:47</h><w>mtnygard</w>You just caught me before heading out the door. Whatcha got?</z><z id="t1477345636" t="hagmonk Caused by: java.lang.IllegalArgumentException: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__23165"><y>#</y><d>2016-10-24</d><h>21:47</h><w>hagmonk</w>Caused by: java.lang.IllegalArgumentException: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__23165</z><z id="t1477345642" t="hagmonk I&apos;ll try to be quick :)("><y>#</y><d>2016-10-24</d><h>21:47</h><w>hagmonk</w>I&apos;ll try to be quick :)(</z><z id="t1477345644" t="hagmonk 🙂"><y>#</y><d>2016-10-24</d><h>21:47</h><w>hagmonk</w><b>🙂</b></z><z id="t1477345660" t="hagmonk thrown when I tried to start a debug repl in IntelliJ"><y>#</y><d>2016-10-24</d><h>21:47</h><w>hagmonk</w>thrown when I tried to start a debug repl in IntelliJ</z><z id="t1477345730" t="hagmonk it&apos;s making me wonder if I&apos;ve deviated from some normal way the pedestal namespaces are imported"><y>#</y><d>2016-10-24</d><h>21:48</h><w>hagmonk</w>it&apos;s making me wonder if I&apos;ve deviated from some normal way the pedestal namespaces are imported</z><z id="t1477345772" t="mtnygard Hmm... it doesn&apos;t look like a require problem. It looks like what happens when a macro emits a function value."><y>#</y><d>2016-10-24</d><h>21:49</h><w>mtnygard</w>Hmm... it doesn&apos;t look like a <code>require</code> problem. It looks like what happens when a macro emits a function value.</z><z id="t1477345788" t="mtnygard Are you wrapping anything with macros? Or syntax-quoting your routes, maybe?"><y>#</y><d>2016-10-24</d><h>21:49</h><w>mtnygard</w>Are you wrapping anything with macros? Or syntax-quoting your routes, maybe?</z><z id="t1477345842" t="hagmonk No I tried to steer away from the syntax quoting approach"><y>#</y><d>2016-10-24</d><h>21:50</h><w>hagmonk</w>No I tried to steer away from the syntax quoting approach</z><z id="t1477345858" t="hagmonk (defroutes routes [[[&quot;/__health&quot; {:get health}] [&quot;/api&quot; ^:interceptors [auth/configure-authentication auth/check-authentication] [&quot;/test&quot; {:get echo}] [&quot;/keyword-demo&quot; {:get keyword-demo-route}]]]]) "><y>#</y><d>2016-10-24</d><h>21:50</h><w>hagmonk</w><pre>(defroutes
  routes
  [[[&quot;/__health&quot; {:get health}]
    [&quot;/api&quot;
     ^:interceptors [auth/configure-authentication auth/check-authentication]
     [&quot;/test&quot; {:get echo}]
     [&quot;/keyword-demo&quot; {:get keyword-demo-route}]]]])
</pre></z><z id="t1477345877" t="mtnygard That seems OK at first glance."><y>#</y><d>2016-10-24</d><h>21:51</h><w>mtnygard</w>That seems OK at first glance.</z><z id="t1477345887" t="mtnygard Can you paste in the code where you&apos;re calling defbefore?"><y>#</y><d>2016-10-24</d><h>21:51</h><w>mtnygard</w>Can you paste in the code where you&apos;re calling defbefore?</z><z id="t1477345937" t="hagmonk This is all WIP code so forgive weirdness"><y>#</y><d>2016-10-24</d><h>21:52</h><w>hagmonk</w>This is all WIP code so forgive weirdness</z><z id="t1477345943" t="hagmonk (defbefore check-authentication [{:keys [request auth-backends] :as context}] (let [req (apply authentication-request request auth-backends)] (if (:identity req) (assoc context :request req) (-&gt; context terminate (assoc :response {:status 401 :body {:message &quot;Unauthorized&quot;} :headers {&quot;WWW-Authenticate&quot; (format &quot;Basic realm=\&quot;%s\&quot;&quot; &quot;Blip&quot;)}}))))) "><y>#</y><d>2016-10-24</d><h>21:52</h><w>hagmonk</w><pre>(defbefore
  check-authentication
  [{:keys [request auth-backends] :as context}]
  (let [req (apply authentication-request request auth-backends)]
    (if (:identity req)
      (assoc context :request req)
      (-&gt; context
          terminate
          (assoc :response {:status 401
                            :body {:message &quot;Unauthorized&quot;}
                            :headers {&quot;WWW-Authenticate&quot; (format &quot;Basic realm=\&quot;%s\&quot;&quot; &quot;Blip&quot;)}})))))
</pre></z><z id="t1477345985" t="hagmonk basically I&apos;m wiring up buddy-sign to do JWT authentication with a fallback to LDAP"><y>#</y><d>2016-10-24</d><h>21:53</h><w>hagmonk</w>basically I&apos;m wiring up buddy-sign to do JWT authentication with a fallback to LDAP</z><z id="t1477345997" t="mtnygard And if you comment that out, can you load the namespace?"><y>#</y><d>2016-10-24</d><h>21:53</h><w>mtnygard</w>And if you comment that out, can you load the namespace?</z><z id="t1477346020" t="hagmonk I bet so, but let me confirm"><y>#</y><d>2016-10-24</d><h>21:53</h><w>hagmonk</w>I bet so, but let me confirm</z><z id="t1477346178" t="hagmonk Yep if I commented out those defbefores it started working. What&apos;s weird is that they were working in regular REPL, when I switched to debug REPL that&apos;s when they started barfing"><y>#</y><d>2016-10-24</d><h>21:56</h><w>hagmonk</w>Yep if I commented out those defbefores it started working. What&apos;s weird is that they were working in regular REPL, when I switched to debug REPL that&apos;s when they started barfing</z><z id="t1477346218" t="mtnygard My advice would be to rework it from using defbefore. Hang on one minute and I&apos;ll show you an example."><y>#</y><d>2016-10-24</d><h>21:56</h><w>mtnygard</w>My advice would be to rework it from using defbefore. Hang on one minute and I&apos;ll show you an example.</z><z id="t1477346265" t="hagmonk Yah! I wanted to use plain data structures but kept barking my shins on those too 🙂"><y>#</y><d>2016-10-24</d><h>21:57</h><w>hagmonk</w>Yah! I wanted to use plain data structures but kept barking my shins on those too <b>🙂</b></z><z id="t1477346302" t="mtnygard (def check-authentication {::check-authentication :enter (fn [{:keys [request auth-backends] :as context}] (let [req (apply authentication-request request auth-backends)] (if (:identity req) (assoc context :request req) (-&gt; context terminate (assoc :response {:status 401 :body {:message &quot;Unauthorized&quot;} :headers {&quot;WWW-Authenticate&quot; (format &quot;Basic realm=\&quot;%s\&quot;&quot; &quot;Blip&quot;)}} )))))}) "><y>#</y><d>2016-10-24</d><h>21:58</h><w>mtnygard</w><pre>(def check-authentication
  {::check-authentication
   :enter
   (fn [{:keys [request auth-backends] :as context}]
     (let [req (apply authentication-request request auth-backends)]
       (if (:identity req)
         (assoc context :request req)
         (-&gt; context
            terminate
            (assoc :response {:status 401
                            :body {:message &quot;Unauthorized&quot;}
                            :headers {&quot;WWW-Authenticate&quot; (format &quot;Basic realm=\&quot;%s\&quot;&quot; &quot;Blip&quot;)}}
)))))})
</pre></z><z id="t1477346320" t="mtnygard I&apos;m not 100% sure I got the close parens right. I don&apos;t have a repl up right now."><y>#</y><d>2016-10-24</d><h>21:58</h><w>mtnygard</w>I&apos;m not 100% sure I got the close parens right. I don&apos;t have a repl up right now.</z><z id="t1477346339" t="mtnygard This actually removes 2 layers of wrapped macros."><y>#</y><d>2016-10-24</d><h>21:58</h><w>mtnygard</w>This actually removes 2 layers of wrapped macros.</z><z id="t1477346349" t="hagmonk fantastic"><y>#</y><d>2016-10-24</d><h>21:59</h><w>hagmonk</w>fantastic</z><z id="t1477346365" t="hagmonk well, I will continue poking at this and let you get out that door 🙂 super helpful, thanks so much"><y>#</y><d>2016-10-24</d><h>21:59</h><w>hagmonk</w>well, I will continue poking at this and let you get out that door <b>🙂</b> super helpful, thanks so much</z><z id="t1477346384" t="mtnygard yw. If you still have trouble, send me a direct message and I&apos;ll look at it later on."><y>#</y><d>2016-10-24</d><h>21:59</h><w>mtnygard</w>yw. If you still have trouble, send me a direct message and I&apos;ll look at it later on.</z><z id="t1477434776" t="tetriscodes Is it counterproductive to make to try and make pedestal route handlers components?"><y>#</y><d>2016-10-25</d><h>22:32</h><w>tetriscodes</w>Is it counterproductive to make to try and make pedestal route handlers components?</z><z id="t1477434859" t="tetriscodes I’m wanting to make a component that can have a database and mqtt client passed in and if specific HTTP routes get hit, it can write to the database and then put a message on an mqtt channel"><y>#</y><d>2016-10-25</d><h>22:34</h><w>tetriscodes</w>I’m wanting to make a component that can have a database and mqtt client passed in and if specific HTTP routes get hit, it can write to the database and then put a message on an mqtt channel</z><z id="t1477435000" t="tetriscodes (def routes (clojure.set/union #{} foo/routes-with-deps-injected))"><y>#</y><d>2016-10-25</d><h>22:36</h><w>tetriscodes</w><code>(def routes (clojure.set/union #{} foo/routes-with-deps-injected))</code></z><z id="t1477435401" t="donaldball I have one router component that builds the route handlers, passing in the required components"><y>#</y><d>2016-10-25</d><h>22:43</h><w>donaldball</w>I have one router component that builds the route handlers, passing in the required components</z><z id="t1477435466" t="donaldball I have thought about going the next step and having each router handler be its own component and take advantage of the component machinery for dependency graphs, but it felt like too much work for too little payoff in my case"><y>#</y><d>2016-10-25</d><h>22:44</h><w>donaldball</w>I have thought about going the next step and having each router handler be its own component and take advantage of the component machinery for dependency graphs, but it felt like too much work for too little payoff in my case</z><z id="t1477435810" t="tetriscodes Do you have a snippet?"><y>#</y><d>2016-10-25</d><h>22:50</h><w>tetriscodes</w>Do you have a snippet?</z><z id="t1477435850" t="tetriscodes Do you have your routes nested in a subsystem that gets built on start?"><y>#</y><d>2016-10-25</d><h>22:50</h><w>tetriscodes</w>Do you have your routes nested in a subsystem that gets built on start?</z><z id="t1477438197" t="christianromney [:attrs {:href &quot;/_/_/users/U0F7UF5U1&quot;}] have a look at this code https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L68-L95 The idea is that any components that the Pedestal component depends on are automatically added to the request map by the using-component interceptor."><y>#</y><d>2016-10-25</d><h>23:29</h><w>christianromney</w><a>@tetriscodes</a> have a look at this code <a href="https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L68-L95" target="_blank">https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L68-L95</a> The idea is that any components that the Pedestal component depends on are automatically added to the request map by the <code>using-component</code> interceptor.</z><z id="t1477438277" t="christianromney if this is my system definition:"><y>#</y><d>2016-10-25</d><h>23:31</h><w>christianromney</w>if this is my system definition:</z><z id="t1477438329" t="christianromney you can see that the Pedestal component depends on :config"><y>#</y><d>2016-10-25</d><h>23:32</h><w>christianromney</w>you can see that the Pedestal component depends on <code>:config</code></z><z id="t1477438409" t="christianromney if I then add the interceptor (using-component :config) to one of my routes, then the handler for that route will find the :config key on the request map with a reference to the configurator component"><y>#</y><d>2016-10-25</d><h>23:33</h><w>christianromney</w>if I then add the interceptor <code>(using-component :config)</code> to one of my routes, then the handler for that route will find the <code>:config</code> key on the request map with a reference to the configurator component</z><z id="t1477438461" t="christianromney using this scheme you can expose any component to your handlers (via the request map) simply by making the pedestal component depend on it."><y>#</y><d>2016-10-25</d><h>23:34</h><w>christianromney</w>using this scheme you can expose any component to your handlers (via the request map) simply by making the pedestal component depend on it.</z><z id="t1477438505" t="christianromney this is not &quot;the one true way&quot; to do what you want, but it is &quot;a way&quot; to do so..."><y>#</y><d>2016-10-25</d><h>23:35</h><w>christianromney</w>this is not &quot;the one true way&quot; to do what you want, but it is &quot;a way&quot; to do so...</z><z id="t1477439833" t="tetriscodes [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] thank you. I will take a look"><y>#</y><d>2016-10-25</d><h>23:57</h><w>tetriscodes</w><a>@christianromney</a> thank you. I will take a look</z><z id="t1477445222" t="donaldball My route handler ctors are more explicit about their requirements, expecting them to be passed in individually. I like this for the clarity about who depends on what, and to make it easier to provide alternate route handlers when a component happens to not be available."><y>#</y><d>2016-10-26</d><h>01:27</h><w>donaldball</w>My route handler ctors are more explicit about their requirements, expecting them to be passed in individually. I like this for the clarity about who depends on what, and to make it easier to provide alternate route handlers when a component happens to not be available.</z><z id="t1478130781" t="grant Is there a good way to accept :origin nil on a particular route? Specifically, I wanted to give an AWS ELB a path to do health checks on. Something like /api/heath-check ."><y>#</y><d>2016-11-02</d><h>23:53</h><w>grant</w>Is there a good way to accept <code>:origin nil</code> on a particular route? Specifically, I wanted to give an AWS ELB  a path to do health checks on. Something like <code>/api/heath-check</code>.</z><z id="t1478141177" t="jimmy does anyone here has used clojure pedestal with google cloud endpoints ?"><y>#</y><d>2016-11-03</d><h>02:46</h><w>jimmy</w>does anyone here has used clojure pedestal with google cloud endpoints ?</z><z id="t1478141440" t="grant I&apos;m pretty new to building web stuff, so please forgive the possibly silly question. What do you mean by &quot;clojure endpoints&quot;?"><y>#</y><d>2016-11-03</d><h>02:50</h><w>grant</w>I&apos;m pretty new to building web stuff, so please forgive the possibly silly question. What do you mean by &quot;clojure endpoints&quot;?</z><z id="t1478141506" t="jimmy [:attrs {:href &quot;/_/_/users/U0EFQAS4B&quot;}] Sorry, I meant google cloud endpoints"><y>#</y><d>2016-11-03</d><h>02:51</h><w>jimmy</w><a>@grant</a> Sorry, I meant google cloud endpoints</z><z id="t1478141608" t="grant Ah, that makes more sense. But no, haven&apos;t looked at any of the google stuff I&apos;m afraid."><y>#</y><d>2016-11-03</d><h>02:53</h><w>grant</w>Ah, that makes more sense. But no, haven&apos;t looked at any of the google stuff I&apos;m afraid.</z><z id="t1478141905" t="jimmy yeah, it&apos;s pretty much like swagger, it helps us generating a json which is a description of the service, then we can generate client api ( ios, android , web ) based on it. And I find it&apos;s faster to use google cloud endpoints than using swagger ( in terms of hosting services ourselves )"><y>#</y><d>2016-11-03</d><h>02:58</h><w>jimmy</w>yeah, it&apos;s pretty much like swagger, it helps us generating a json which is a description of the service, then we can generate client api ( ios, android , web ) based on it. And I find it&apos;s faster to use google cloud endpoints than using swagger ( in terms of hosting services ourselves )</z><z id="t1478142359" t="grant Oh, that is cool. I tried using swagger-api with pedestal, but found that it seemed to get in the way more than it helped."><y>#</y><d>2016-11-03</d><h>03:05</h><w>grant</w>Oh, that is cool. I tried using swagger-api with pedestal, but found that it seemed to get in the way more than it helped.</z><z id="t1478142463" t="grant Plus I&apos;m not exposing anything for direct access by anyone else, so there wasn&apos;t much advantage except for some pretty docs."><y>#</y><d>2016-11-03</d><h>03:07</h><w>grant</w>Plus I&apos;m not exposing anything for direct access by anyone else, so there wasn&apos;t much advantage except for some pretty docs.</z><z id="t1478143204" t="jimmy true"><y>#</y><d>2016-11-03</d><h>03:20</h><w>jimmy</w>true</z><z id="t1478183969" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U0EFQAS4B&quot;}] , late response b/c I was traveling. When you say :origin nil are you talking about a header?"><y>#</y><d>2016-11-03</d><h>14:39</h><w>mtnygard</w>Hi <a>@grant</a>, late response b/c I was traveling. When you say <code>:origin nil</code> are you talking about a header?</z><z id="t1478185113" t="grant Hi Michael. Yes, that is what I was talking about. And I actually figured out what I was trying to do. Just adding the route worked. Though I am still curious if it is possible to do per route origin checking."><y>#</y><d>2016-11-03</d><h>14:58</h><w>grant</w>Hi Michael. Yes, that is what I was talking about. And I actually figured out what I was trying to do. Just adding the route worked. Though I am still curious if it is possible to do per route origin checking.</z><z id="t1478187071" t="mtnygard I don&apos;t think there&apos;s a direct way to do it in the current routers. There are a couple of ways to solve the problem. They just take a bit more work."><y>#</y><d>2016-11-03</d><h>15:31</h><w>mtnygard</w>I don&apos;t think there&apos;s a direct way to do it in the current routers. There are a couple of ways to solve the problem. They just take a bit more work.</z><z id="t1478187149" t="mtnygard 1. You could create an &quot;origin router&quot;. It would sit in front of two or more regular routers. Instead of looking at the path in the request, it would look at the origin then enqueue one of the other routers. This would work best if you&apos;ve got several routes that should be treated differently based on origin."><y>#</y><d>2016-11-03</d><h>15:32</h><w>mtnygard</w>1. You could create an &quot;origin router&quot;. It would sit in front of two or more regular routers. Instead of looking at the path in the request, it would look at the origin then enqueue one of the other routers. This would work best if you&apos;ve got several routes that should be treated differently based on origin.</z><z id="t1478187212" t="mtnygard 2. You could create an origin interceptor. Your router would direct all requests for /api/health-check to the same interceptor vector, but if the origin doesn&apos;t match, then the origin interceptor can terminate the request. That would return a 404 exactly as if the route didn&apos;t exist."><y>#</y><d>2016-11-03</d><h>15:33</h><w>mtnygard</w>2. You could create an origin interceptor. Your router would direct all requests for <code>/api/health-check</code> to the same interceptor vector, but if the origin doesn&apos;t match, then the origin interceptor can terminate the request. That would return a 404 exactly as if the route didn&apos;t exist.</z><z id="t1478187396" t="grant Cool. Thanks for taking the time to answer my question. And the new pedestal docs you&apos;ve been writing have been helpful too, they are appreciated."><y>#</y><d>2016-11-03</d><h>15:36</h><w>grant</w>Cool. Thanks for taking the time to answer my question. And the new pedestal docs you&apos;ve been writing have been helpful too, they are appreciated.</z><z id="t1478215684" t="grant This is a rather tangential pedestal question, but not sure there is a better place to ask it. Does anyone know if there are still plans for Paul deGrandis&apos; Vase library to ever make it out into the wild?"><y>#</y><d>2016-11-03</d><h>23:28</h><w>grant</w>This is a rather tangential pedestal question, but not sure there is a better place to ask it. Does anyone know if there are still plans for Paul deGrandis&apos; Vase library to ever make it out into the wild?</z><z id="t1478296464" t="mtnygard [:attrs {:href &quot;/_/_/users/U0EFQAS4B&quot;}] I can answer that with a &quot;for now&quot; tacked on to the end."><y>#</y><d>2016-11-04</d><h>21:54</h><w>mtnygard</w><a>@grant</a> I can answer that with a &quot;for now&quot; tacked on to the end.</z><z id="t1478296511" t="mtnygard We&apos;re using it on three client projects that are hitting production soon. It&apos;s working pretty well. So in that sense, it is in the wild. I suspect you mean open-source though. At this time we are not open sourcing Vase."><y>#</y><d>2016-11-04</d><h>21:55</h><w>mtnygard</w>We&apos;re using it on three client projects that are hitting production soon. It&apos;s working pretty well. So in that sense, it is in the wild. I suspect you mean open-source though. At this time we are not open sourcing Vase.</z><z id="t1478300411" t="grant [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] That is pretty much the answer I was expecting, though I was hoping for a different one. 🙂 Thanks for removing the doubt for me, though."><y>#</y><d>2016-11-04</d><h>23:00</h><w>grant</w><a>@mtnygard</a> That is pretty much the answer I was expecting, though I was hoping for a different one. <b>🙂</b> Thanks for removing the doubt for me, though.</z><z id="t1478382923" t="kirill.salykin component"><y>#</y><d>2016-11-05</d><h>21:55</h><w>kirill.salykin</w>component</z><z id="t1478530664" t="crimeminister [:attrs {:href &quot;/_/_/users/U0EFQAS4B&quot;}] As someone who was pretty blown away by the talk he did on that approach to API development I would be interested in the answer as well"><y>#</y><d>2016-11-07</d><h>14:57</h><w>crimeminister</w><a>@grant</a> As someone who was pretty blown away by the talk he did on that approach to API development I would be interested in the answer as well</z><z id="t1478530784" t="crimeminister Would love to have that sort of capability available as an Arachne module/plugin"><y>#</y><d>2016-11-07</d><h>14:59</h><w>crimeminister</w>Would love to have that sort of capability available as an Arachne module/plugin</z><z id="t1478530892" t="crimeminister Anyone know of any similar projects, by the way? The only thing that springs to mind as remotely comparable is liberator"><y>#</y><d>2016-11-07</d><h>15:01</h><w>crimeminister</w>Anyone know of any similar projects, by the way? The only thing that springs to mind as remotely comparable is liberator</z><z id="t1478646570" t="semperos trying to wire up a StatsD reporter for use with Pedestal’s built-in metrics; I’m seeing StatsD report bad lines, as in: 8 Nov 18:01:22 - DEBUG: Bad line: io.pedestal/active-servlet-calls in msg &quot;:io.pedestal/active-servlet-calls:0|g&quot; I think this is caused by the leading : which the message format uses for field separation"><y>#</y><d>2016-11-08</d><h>23:09</h><w>semperos</w>trying to wire up a StatsD reporter for use with Pedestal’s built-in metrics; I’m seeing StatsD report bad lines, as in:
<pre>8 Nov 18:01:22 - DEBUG: Bad line: io.pedestal/active-servlet-calls in msg &quot;:io.pedestal/active-servlet-calls:0|g&quot;
</pre>
I think this is caused by the leading <code>:</code> which the message format uses for field separation</z><z id="t1478646617" t="semperos looking at io.pedestal.log namespace, the metric names appear to be stringified with str which would result in the above"><y>#</y><d>2016-11-08</d><h>23:10</h><w>semperos</w>looking at <code>io.pedestal.log</code> namespace, the metric names appear to be stringified with <code>str</code> which would result in the above</z><z id="t1478646860" t="semperos I’m seeing the same for the sample app that’s in the Pedestal repo: 8 Nov 18:13:59 - DEBUG: :helloworld-metrics.service/statsd-hits:1|g 8 Nov 18:13:59 - DEBUG: Bad line: helloworld-metrics.service/statsd-hits in msg &quot;:helloworld-metrics.service/statsd-hits:1|g&quot; "><y>#</y><d>2016-11-08</d><h>23:14</h><w>semperos</w>I’m seeing the same for the sample app that’s in the Pedestal repo:
<pre>8 Nov 18:13:59 - DEBUG: :helloworld-metrics.service/statsd-hits:1|g
8 Nov 18:13:59 - DEBUG: Bad line: helloworld-metrics.service/statsd-hits in msg &quot;:helloworld-metrics.service/statsd-hits:1|g&quot;
</pre></z><z id="t1478646878" t="semperos any thoughts ^^ ?"><y>#</y><d>2016-11-08</d><h>23:14</h><w>semperos</w>any thoughts ^^ ?</z><z id="t1478649928" t="semperos I’ve found that reimplementing the public fn’s in io.pedestal.log where the str call happens to use something like (str (namespace metric-name) “.” (name metric-name)) to solve the problem"><y>#</y><d>2016-11-09</d><h>00:05</h><w>semperos</w>I’ve found that reimplementing the public fn’s in <code>io.pedestal.log</code> where the <code>str</code> call happens to use something like <code>(str (namespace metric-name) “.” (name metric-name))</code> to solve the problem</z><z id="t1478704485" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U11SSJP2A&quot;}] maybe open an issue around this?"><y>#</y><d>2016-11-09</d><h>15:14</h><w>ddeaguiar</w><a>@semperos</a> maybe open an issue around this?</z><z id="t1478710913" t="mtnygard [:attrs {:href &quot;/_/_/users/U11SSJP2A&quot;}] : That really sounds like a bug. Would you open an issue for it?"><y>#</y><d>2016-11-09</d><h>17:01</h><w>mtnygard</w><a>@semperos</a>: That really sounds like a bug. Would you open an issue for it?</z><z id="t1478718653" t="semperos I’d be happy to, will likely be after EST working hours; thanks for the feedback"><y>#</y><d>2016-11-09</d><h>19:10</h><w>semperos</w>I’d be happy to, will likely be after EST working hours; thanks for the feedback</z><z id="t1478743848" t="semperos submitted https://github.com/pedestal/pedestal/issues/481"><y>#</y><d>2016-11-10</d><h>02:10</h><w>semperos</w>submitted <a href="https://github.com/pedestal/pedestal/issues/481" target="_blank">https://github.com/pedestal/pedestal/issues/481</a></z><z id="t1479052825" t="r0man [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Not running on app engine myself, but I think I have seen this error before. If I remember correctly it had something to do with the javax.servlet/javax.servlet-api dependency. Make sure you are actually running ther version that pedestal expects. I think it is 3.1.0."><y>#</y><d>2016-11-13</d><h>16:00</h><w>r0man</w><a>@nxqd</a> Not running on app engine myself, but I think I have seen this error before. If I remember correctly it had something to do with the javax.servlet/javax.servlet-api dependency. Make sure you are actually running ther version that pedestal expects. I think it is 3.1.0.</z><z id="t1479095404" t="jimmy [:attrs {:href &quot;/_/_/users/U0CKBRBD2&quot;}] cool, I will try to change the version then"><y>#</y><d>2016-11-14</d><h>03:50</h><w>jimmy</w><a>@r0man</a> cool, I will try to change the version then</z><z id="t1479417917" t="tetriscodes (defn http-test-trigger [triggercomp context] (check-value triggercomp (:json-params context)) (ring-resp/response {:response &quot;success&quot;})) (defn- routes [triggercomp] #{[&quot;/api/triggers&quot; :get (conj intercept/common-interceptors `http-get)] [&quot;/api/triggers/:id&quot; :get (conj intercept/common-interceptors `http-get-trigger)] [&quot;/api/triggers/:id&quot; :put (conj intercept/common-interceptors `http-put-trigger)] [&quot;/api/triggers&quot; :post (conj intercept/common-interceptors `http-post-trigger)] [&quot;/api/triggers/:id&quot; :delete (conj intercept/common-interceptors `http-delete-trigger)] [&quot;/api/triggers/check&quot; :post (conj intercept/common-interceptors `(partial http-test-trigger triggercomp))]})"><y>#</y><d>2016-11-17</d><h>21:25</h><w>tetriscodes</w><pre>(defn http-test-trigger [triggercomp context]
  (check-value triggercomp (:json-params context))
  (ring-resp/response {:response &quot;success&quot;}))

(defn- routes [triggercomp]
    #{[&quot;/api/triggers&quot; :get
       (conj intercept/common-interceptors `http-get)]
      [&quot;/api/triggers/:id&quot; :get
       (conj intercept/common-interceptors `http-get-trigger)]
      [&quot;/api/triggers/:id&quot; :put
       (conj intercept/common-interceptors `http-put-trigger)]
      [&quot;/api/triggers&quot; :post
       (conj intercept/common-interceptors `http-post-trigger)]
      [&quot;/api/triggers/:id&quot; :delete
       (conj intercept/common-interceptors `http-delete-trigger)]
      [&quot;/api/triggers/check&quot; :post
       (conj intercept/common-interceptors `(partial http-test-trigger triggercomp))]})</pre></z><z id="t1479417943" t="tetriscodes Anyone know why I can’t put a partial as a route handler?"><y>#</y><d>2016-11-17</d><h>21:25</h><w>tetriscodes</w>Anyone know why I can’t put a partial as a route handler?</z><z id="t1479418121" t="tetriscodes If I just use `http-test-trigger and remove the first component argument it works fine"><y>#</y><d>2016-11-17</d><h>21:28</h><w>tetriscodes</w>If I just use `http-test-trigger and remove the first component argument it works fine</z><z id="t1479419125" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0F7UF5U1&quot;}] You can use a partial but you need to specify a :route-name . I just did a quick test with a new pedestal app generated via lein"><y>#</y><d>2016-11-17</d><h>21:45</h><w>ddeaguiar</w><a>@tetriscodes</a> You can use a partial but you need to specify a <code>:route-name</code>. I just did a quick test with a new pedestal app generated via <code>lein</code></z><z id="t1479419206" t="ddeaguiar hope that helps"><y>#</y><d>2016-11-17</d><h>21:46</h><w>ddeaguiar</w>hope that helps</z><z id="t1479419340" t="ddeaguiar oh, looking more closely at the code you posted, you need wouldn&apos;t quote the partial. I think that&apos;s the problem in your example. That and the lack of a :route-name"><y>#</y><d>2016-11-17</d><h>21:49</h><w>ddeaguiar</w>oh, looking more closely at the code you posted, you need wouldn&apos;t quote the partial. I think that&apos;s the problem in your example. That and the lack of a <code>:route-name</code></z><z id="t1479419371" t="ddeaguiar The other routes will use the name of the quoted fn by default"><y>#</y><d>2016-11-17</d><h>21:49</h><w>ddeaguiar</w>The other routes will use the name of the quoted fn by default</z><z id="t1479419384" t="tetriscodes Its the lack of route name"><y>#</y><d>2016-11-17</d><h>21:49</h><w>tetriscodes</w>Its the lack of route name</z><z id="t1479419396" t="tetriscodes two different errors"><y>#</y><d>2016-11-17</d><h>21:49</h><w>tetriscodes</w>two different errors</z><z id="t1479419401" t="tetriscodes Thanks for the snippet"><y>#</y><d>2016-11-17</d><h>21:50</h><w>tetriscodes</w>Thanks for the snippet</z><z id="t1479419420" t="ddeaguiar Sure, you had to unquote as well, right?"><y>#</y><d>2016-11-17</d><h>21:50</h><w>ddeaguiar</w>Sure, you had to unquote as well, right?</z><z id="t1479419427" t="tetriscodes Yes"><y>#</y><d>2016-11-17</d><h>21:50</h><w>tetriscodes</w>Yes</z><z id="t1479419436" t="ddeaguiar ok, makes sense."><y>#</y><d>2016-11-17</d><h>21:50</h><w>ddeaguiar</w>ok, makes sense.</z><z id="t1479419452" t="ddeaguiar Glad to help 🙂"><y>#</y><d>2016-11-17</d><h>21:50</h><w>ddeaguiar</w>Glad to help <b>🙂</b></z><z id="t1479485679" t="scott.haleen I asked this on SO as well http://stackoverflow.com/questions/40681590/clojure-pedestal-root-serving-as-application-octet-stream"><y>#</y><d>2016-11-18</d><h>16:14</h><w>scott.haleen</w>I asked this on SO as well <a href="http://stackoverflow.com/questions/40681590/clojure-pedestal-root-serving-as-application-octet-stream" target="_blank">http://stackoverflow.com/questions/40681590/clojure-pedestal-root-serving-as-application-octet-stream</a></z><z id="t1479496690" t="christianromney you should add at least a default &quot;/&quot; route and you can use the resource interceptor"><y>#</y><d>2016-11-18</d><h>19:18</h><w>christianromney</w>you should add at least a default &quot;/&quot; route and you can use the resource interceptor</z><z id="t1479496833" t="christianromney http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html"><y>#</y><d>2016-11-18</d><h>19:20</h><w>christianromney</w><a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html</a></z><z id="t1479496971" t="christianromney http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-html-body"><y>#</y><d>2016-11-18</d><h>19:22</h><w>christianromney</w><a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-html-body" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-html-body</a></z><z id="t1479498629" t="scott.haleen I added (def routes (route/expand-routes [[[&quot;/&quot; ^:interceptors [http/html-body]]]])) but the behavior is still the same"><y>#</y><d>2016-11-18</d><h>19:50</h><w>scott.haleen</w>I added <code>(def routes  (route/expand-routes [[[&quot;/&quot; ^:interceptors [http/html-body]]]]))</code>  but the behavior is still the same</z><z id="t1479764813" t="mrcnc i’m getting this error when trying to build an uberjar Caused by: java.lang.IllegalArgumentException: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__1340"><y>#</y><d>2016-11-21</d><h>21:46</h><w>mrcnc</w>i’m getting this error when trying to build an uberjar <code>Caused by: java.lang.IllegalArgumentException: No matching ctor found for class io.pedestal.interceptor.helpers$before$fn__1340</code></z><z id="t1479764831" t="mrcnc the thing that’s confusing me is that i’m not even using the before helper"><y>#</y><d>2016-11-21</d><h>21:47</h><w>mrcnc</w>the thing that’s confusing me is that i’m not even using the before helper</z><z id="t1479765004" t="mtnygard [:attrs {:href &quot;/_/_/users/U2VN314UD&quot;}] I can help, but will need to look at some code with you. Can you share it here or would you prefer to go to a private chat?"><y>#</y><d>2016-11-21</d><h>21:50</h><w>mtnygard</w><a>@mrcnc</a> I can help, but will need to look at some code with you. Can you share it here or would you prefer to go to a private chat?</z><z id="t1479765028" t="mrcnc i can share here…what do you need?"><y>#</y><d>2016-11-21</d><h>21:50</h><w>mrcnc</w>i can share here…what do you need?</z><z id="t1479765058" t="mtnygard How many namespaces do you have in the uberjar?"><y>#</y><d>2016-11-21</d><h>21:50</h><w>mtnygard</w>How many namespaces do you have in the uberjar?</z><z id="t1479765164" t="mrcnc looks like 30"><y>#</y><d>2016-11-21</d><h>21:52</h><w>mrcnc</w>looks like 30</z><z id="t1479765179" t="mtnygard Hmm. Too many to go through right here."><y>#</y><d>2016-11-21</d><h>21:52</h><w>mtnygard</w>Hmm. Too many to go through right here.</z><z id="t1479765223" t="mrcnc what namespaces are you talking about? pedestal namespaces or for my app?"><y>#</y><d>2016-11-21</d><h>21:53</h><w>mrcnc</w>what namespaces are you talking about?  pedestal namespaces or for my app?</z><z id="t1479765247" t="mtnygard Your app."><y>#</y><d>2016-11-21</d><h>21:54</h><w>mtnygard</w>Your app.</z><z id="t1479765269" t="mtnygard Something in one of them is expanding out to a before or defbefore call at compilation time."><y>#</y><d>2016-11-21</d><h>21:54</h><w>mtnygard</w>Something in one of them is expanding out to a <code>before</code> or <code>defbefore</code> call at compilation time.</z><z id="t1479765307" t="mtnygard That &quot;no matching ctor&quot; message is what happens when there&apos;s a function value emitted as code from a macro. Often due to misplaced quoting."><y>#</y><d>2016-11-21</d><h>21:55</h><w>mtnygard</w>That &quot;no matching ctor&quot; message is what happens when there&apos;s a function value emitted as code from a macro. Often due to misplaced quoting.</z><z id="t1479765316" t="mtnygard Let&apos;s take a look at the namespace with your routes first."><y>#</y><d>2016-11-21</d><h>21:55</h><w>mtnygard</w>Let&apos;s take a look at the namespace with your routes first.</z><z id="t1479765529" t="mrcnc my routes are spread over a few namespaces"><y>#</y><d>2016-11-21</d><h>21:58</h><w>mrcnc</w>my routes are spread over a few namespaces</z><z id="t1479765626" t="mtnygard Would you try something for me? Convert the defhandler into just defn on authenticate-user and authorize-user."><y>#</y><d>2016-11-21</d><h>22:00</h><w>mtnygard</w>Would you try something for me? Convert the <code>defhandler</code> into just <code>defn</code> on authenticate-user and authorize-user.</z><z id="t1479765673" t="mrcnc ok"><y>#</y><d>2016-11-21</d><h>22:01</h><w>mrcnc</w>ok</z><z id="t1479765755" t="ddeaguiar Piggybacking on [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] &apos;s suggestion, I&apos;ll add that you should avoid using helpers like defhandler because they can lead to weird compilation issues."><y>#</y><d>2016-11-21</d><h>22:02</h><w>ddeaguiar</w>Piggybacking on <a>@mtnygard</a>&apos;s suggestion, I&apos;ll add that you should avoid using helpers like <code>defhandler</code> because they can lead to weird compilation issues.</z><z id="t1479765776" t="ddeaguiar They&apos;re still around for backwards compatibility"><y>#</y><d>2016-11-21</d><h>22:02</h><w>ddeaguiar</w>They&apos;re still around for backwards compatibility</z><z id="t1479766011" t="ddeaguiar fns can be used as handlers because they extent the IntoInterceptor protocol ( https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L33 ). This means that your usage of defhandler isn&apos;t buying you anything over defn ."><y>#</y><d>2016-11-21</d><h>22:06</h><w>ddeaguiar</w>fns can be used as handlers because they extent the <code>IntoInterceptor</code> protocol (<a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L33" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L33</a>). This means that your usage of <code>defhandler</code> isn&apos;t buying you anything over <code>defn</code>.</z><z id="t1479766087" t="mrcnc so mtnygard that worked! and thx for the tip [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2016-11-21</d><h>22:08</h><w>mrcnc</w>so mtnygard that worked!  and thx for the tip <a>@ddeaguiar</a></z><z id="t1479766097" t="ddeaguiar Unfortunately I don&apos;t think the docs are very clear about staying away from some of the helpers."><y>#</y><d>2016-11-21</d><h>22:08</h><w>ddeaguiar</w>Unfortunately I don&apos;t think the docs are very clear about staying away from some of the helpers.</z><z id="t1479766107" t="mrcnc i think i’ll go refactor all of my usages of defhandler now"><y>#</y><d>2016-11-21</d><h>22:08</h><w>mrcnc</w>i think i’ll go refactor all of my usages of defhandler now</z><z id="t1479766116" t="mtnygard Cool. I&apos;ve run into trouble with macros and AOT many times before. Uberjar often hits AOT so I had a hunch."><y>#</y><d>2016-11-21</d><h>22:08</h><w>mtnygard</w>Cool. I&apos;ve run into trouble with macros and AOT many times before. Uberjar often hits AOT so I had a hunch.</z><z id="t1479766132" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Would you be willing to file an issue on that?"><y>#</y><d>2016-11-21</d><h>22:08</h><w>mtnygard</w><a>@ddeaguiar</a> Would you be willing to file an issue on that?</z><z id="t1479766139" t="ddeaguiar Stay away from any helpers built using defsimpleinterceptordef ."><y>#</y><d>2016-11-21</d><h>22:08</h><w>ddeaguiar</w>Stay away from any helpers built using <code>defsimpleinterceptordef</code>.</z><z id="t1479766152" t="ddeaguiar Sure"><y>#</y><d>2016-11-21</d><h>22:09</h><w>ddeaguiar</w>Sure</z><z id="t1479767944" t="donaldball I build all my routes and interceptors at system start time, not at compile time. I don’t know if that’s pedestal’s recommended approach, but I find it much easier to reason about."><y>#</y><d>2016-11-21</d><h>22:39</h><w>donaldball</w>I build all my routes and interceptors at system start time, not at compile time. I don’t know if that’s pedestal’s recommended approach, but I find it much easier to reason about.</z><z id="t1479770540" t="ddeaguiar opened https://github.com/pedestal/pedestal/issues/483"><y>#</y><d>2016-11-21</d><h>23:22</h><w>ddeaguiar</w>opened <a href="https://github.com/pedestal/pedestal/issues/483" target="_blank">https://github.com/pedestal/pedestal/issues/483</a></z><z id="t1479813270" t="jimmy hi guys, in pedestal doesn&apos;t route /* hits / as well. I have route declaration as /* and it only works with /&lt;something-here&gt; and it doesn&apos;t work with /"><y>#</y><d>2016-11-22</d><h>11:14</h><w>jimmy</w>hi guys, in pedestal doesn&apos;t route <code>/*</code> hits <code>/</code> as well. I have route declaration as <code>/*</code> and it only works with <code>/&lt;something-here&gt;</code> and it doesn&apos;t work with <code>/</code></z><z id="t1479843269" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] that&apos;s not what I would expect but is how Pedestal behaves. I can&apos;t comment on whether this is by design or not."><y>#</y><d>2016-11-22</d><h>19:34</h><w>ddeaguiar</w><a>@nxqd</a> that&apos;s not what I would expect but is how Pedestal behaves. I can&apos;t comment on whether this is by design or not.</z><z id="t1479843945" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Does the behavior vary with different routers?"><y>#</y><d>2016-11-22</d><h>19:45</h><w>mtnygard</w><a>@nxqd</a> <a>@ddeaguiar</a> Does the behavior vary with different routers?</z><z id="t1479844281" t="ddeaguiar I had run a quick test across different routers and observed the same behavior"><y>#</y><d>2016-11-22</d><h>19:51</h><w>ddeaguiar</w>I had run a quick test across different routers and observed the same behavior</z><z id="t1479844759" t="ddeaguiar Although I find this behavior odd: (def rs (route/expand-routes #{[&quot;/*&quot; :get [(fn [req] &quot;test&quot;)] :route-name ::test]})) (route/try-routing-for rs :linear-search &quot;/foo&quot; :get) ;; =&gt; nil "><y>#</y><d>2016-11-22</d><h>19:59</h><w>ddeaguiar</w>Although I find this behavior odd:

<pre>(def rs (route/expand-routes #{[&quot;/*&quot;
                                :get
                                [(fn [req] &quot;test&quot;)]
                                :route-name ::test]}))

(route/try-routing-for rs :linear-search &quot;/foo&quot; :get) ;; =&gt; nil
</pre></z><z id="t1479844804" t="ddeaguiar whereas a different router finds a match"><y>#</y><d>2016-11-22</d><h>20:00</h><w>ddeaguiar</w>whereas a different router finds a match</z><z id="t1479844892" t="ddeaguiar I guess the :linear-search router does not support * ? I&apos;ve not looked through the source"><y>#</y><d>2016-11-22</d><h>20:01</h><w>ddeaguiar</w>I guess the <code>:linear-search</code> router does not support <code>*</code>? I&apos;ve not looked through the source</z><z id="t1479859949" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks for collaborating on this.Can you guys recommend the best way to design this route, this is what I have tried, and of course it does have problem regarding conflicted routing ( /api and /* ) : (defn routes [interceptor] (route/expand-routes `[[[&quot;/&quot; {:get index-page} ^:interceptors [bootstrap/html-body ~interceptor] [&quot;/api&quot; {:post omnext-service} ^:interceptors [iinterceptor/om-body-params iinterceptor/om-response]] [&quot;/*&quot; {:get index-page} ^:interceptors [bootstrap/html-body ~interceptor]]]]])) "><y>#</y><d>2016-11-23</d><h>00:12</h><w>jimmy</w><a>@ddeaguiar</a> <a>@mtnygard</a> Thanks for collaborating on this.Can you guys recommend the best way to design this route, this is what I have tried, and of course it does have problem regarding conflicted routing ( <code>/api</code> and <code>/*</code> ) : 
<pre>(defn routes
  [interceptor]
  (route/expand-routes
   `[[[&quot;/&quot; {:get index-page}
       ^:interceptors [bootstrap/html-body ~interceptor]
       [&quot;/api&quot; {:post omnext-service}
          ^:interceptors [iinterceptor/om-body-params iinterceptor/om-response]]
       [&quot;/*&quot; {:get index-page}
        ^:interceptors [bootstrap/html-body ~interceptor]]]]]))
</pre></z><z id="t1479907117" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I&apos;ve found a way to get what you want. Demonstration at https://gist.github.com/mtnygard/9f77639865592608ed3aa87a42191468"><y>#</y><d>2016-11-23</d><h>13:18</h><w>mtnygard</w><a>@nxqd</a> I&apos;ve found a way to get what you want. Demonstration at <a href="https://gist.github.com/mtnygard/9f77639865592608ed3aa87a42191468" target="_blank">https://gist.github.com/mtnygard/9f77639865592608ed3aa87a42191468</a></z><z id="t1479907157" t="mtnygard The key here is to use the :not-found-interceptor instead of a wildcard route."><y>#</y><d>2016-11-23</d><h>13:19</h><w>mtnygard</w>The key here is to use the :not-found-interceptor instead of a wildcard route.</z><z id="t1479907982" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] that&apos;s neat, nice tips 😄 . Thanks"><y>#</y><d>2016-11-23</d><h>13:33</h><w>jimmy</w><a>@mtnygard</a> that&apos;s neat, nice tips <b>😄</b>. Thanks</z><z id="t1480604384" t="fatihict [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I&apos;d like to thank you on the pedestal guides. They really helped me a lot 🙂"><y>#</y><d>2016-12-01</d><h>14:59</h><w>fatihict</w><a>@mtnygard</a> I&apos;d like to thank you on the pedestal guides. They really helped me a lot <b>🙂</b></z><z id="t1480628674" t="mtnygard [:attrs {:href &quot;/_/_/users/U28947274&quot;}] : I&apos;m glad they are helpful! What other guides would be useful?"><y>#</y><d>2016-12-01</d><h>21:44</h><w>mtnygard</w><a>@fatihict</a>: I&apos;m glad they are helpful! What other guides would be useful?</z><z id="t1480678110" t="fatihict I think the setup of the guides is really good. Some guides and/or sections already have a title, but are not written yet. I think those would be useful aswell. If I can help out by reading a draft of new docs I will gladly help."><y>#</y><d>2016-12-02</d><h>11:28</h><w>fatihict</w>I think the setup of the guides is really good. Some guides and/or sections already have a title, but are not written yet. I think those would be useful aswell. If I can help out by reading a draft of new docs I will gladly help.</z><z id="t1481499534" t="hagmonk pardon the crosspost from #clojurescript, but is anyone using pedestal with boot-reload? I’m trying but failing to make these two things work together"><y>#</y><d>2016-12-11</d><h>23:38</h><w>hagmonk</w>pardon the crosspost from #clojurescript, but is anyone using pedestal with boot-reload? I’m trying but failing to make these two things work together</z><z id="t1481965051" t="jimmy hi guys, is there any good tutorial running pedestal on google app engine ?"><y>#</y><d>2016-12-17</d><h>08:57</h><w>jimmy</w>hi guys, is there any good tutorial running pedestal on google app engine ?</z><z id="t1482121500" t="jimmy I just found out that pedestal does modify threads and google app engine does have some limitation on modifying thread, we have to use google thread lib instead. This is troublesome -_-"><y>#</y><d>2016-12-19</d><h>04:25</h><w>jimmy</w>I just found out that pedestal does modify threads and google app engine does have some limitation on modifying thread, we have to use google thread lib instead. This is troublesome -_-</z><z id="t1482207383" t="joshjones How is an interceptor fundamentally different from a handler, other than the format of &quot;context&quot; versus &quot;request/response&quot;?"><y>#</y><d>2016-12-20</d><h>04:16</h><w>joshjones</w>How is an interceptor fundamentally different from a handler, other than the format of &quot;context&quot; versus &quot;request/response&quot;?</z><z id="t1482207456" t="joshjones My service needs to make a call to another service which could take anywhere from 500ms to 1000ms, and I want to go async instead of blocking and tying up threads. Should the call to the 3rd party service go in an interceptor, or in the handler?"><y>#</y><d>2016-12-20</d><h>04:17</h><w>joshjones</w>My service needs to make a call to another service which could take anywhere from 500ms to 1000ms, and I want to go async instead of blocking and tying up threads.  Should the call to the 3rd party service go in an interceptor, or in the handler?</z><z id="t1482243232" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1ALMRBLL&quot;}] Handlers are special case interceptors that operate on request maps and return response maps. I typically create Interceptors for things like validation and any other pre-processing needed for request handling. Refer to http://pedestal.io/reference/interceptors for more info"><y>#</y><d>2016-12-20</d><h>14:13</h><w>ddeaguiar</w><a>@joshjones</a> Handlers are special case interceptors that operate on request maps and return response maps. I typically create Interceptors for things like validation and any other pre-processing needed for request handling. Refer to <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a> for more info</z><z id="t1482243477" t="ddeaguiar If the implementation requires some sort of post processing (i.e., transformation, etc...) I&apos;d probably implement the 3rd party call in an interceptor, put the result on the request map and perform the transform of the result in a handler."><y>#</y><d>2016-12-20</d><h>14:17</h><w>ddeaguiar</w>If the implementation requires some sort of post processing (i.e., transformation, etc...) I&apos;d probably implement the 3rd party call in an interceptor, put the result on the request map and perform the transform of the result in a handler.</z><z id="t1482243488" t="ddeaguiar Using channels for async"><y>#</y><d>2016-12-20</d><h>14:18</h><w>ddeaguiar</w>Using channels for async</z><z id="t1482243537" t="ddeaguiar I&apos;d also prefer thread vs the go macro because the backing thread pool used by the go macro is limited"><y>#</y><d>2016-12-20</d><h>14:18</h><w>ddeaguiar</w>I&apos;d also prefer <code>thread</code> vs the <code>go</code> macro because the backing thread pool used by the <code>go</code> macro is limited</z><z id="t1482243585" t="ddeaguiar Hope this helps!"><y>#</y><d>2016-12-20</d><h>14:19</h><w>ddeaguiar</w>Hope this helps!</z><z id="t1482243900" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] is it possible to share such interceptors (validation etc)?"><y>#</y><d>2016-12-20</d><h>14:25</h><w>kirill.salykin</w><a>@ddeaguiar</a> is it possible to share such interceptors (validation etc)?</z><z id="t1482243919" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I mean, can you please share them? 🙂"><y>#</y><d>2016-12-20</d><h>14:25</h><w>kirill.salykin</w><a>@ddeaguiar</a> I mean, can you please share them? <b>🙂</b></z><z id="t1482243996" t="ddeaguiar I can create an example if I don&apos;t have any I can share"><y>#</y><d>2016-12-20</d><h>14:26</h><w>ddeaguiar</w>I can create an example if I don&apos;t have any I can share</z><z id="t1482244028" t="ddeaguiar But think of it this way, these are the same operations you&apos;d perform in ring middleware"><y>#</y><d>2016-12-20</d><h>14:27</h><w>ddeaguiar</w>But think of it this way, these are the same operations you&apos;d perform in ring middleware</z><z id="t1482244052" t="ddeaguiar The neat thing about interceptors is that you have access to the interceptor chain and you can manipulate it"><y>#</y><d>2016-12-20</d><h>14:27</h><w>ddeaguiar</w>The neat thing about interceptors is that you have access to the interceptor chain and you can manipulate it</z><z id="t1482244065" t="ddeaguiar dynamically add/remove interceptors"><y>#</y><d>2016-12-20</d><h>14:27</h><w>ddeaguiar</w>dynamically add/remove interceptors</z><z id="t1482244073" t="ddeaguiar You can&apos;t do that with ring middleware"><y>#</y><d>2016-12-20</d><h>14:27</h><w>ddeaguiar</w>You can&apos;t do that with ring middleware</z><z id="t1482244394" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] The Pedestal docs site includes an example of an interceptor that performs request pre-processing ( http://pedestal.io/reference/interceptors ). The db-interceptor associates a db to the request. In that example, the database value is stored elsewhere in a global var."><y>#</y><d>2016-12-20</d><h>14:33</h><w>ddeaguiar</w><a>@kirill.salykin</a> The Pedestal docs site includes an example of an interceptor that performs request pre-processing (<a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a>). The <code>db-interceptor</code> associates a db to the request. In that example, the database value is stored elsewhere in a global var.</z><z id="t1482244441" t="ddeaguiar attach-database provides a similar example"><y>#</y><d>2016-12-20</d><h>14:34</h><w>ddeaguiar</w><code>attach-database</code> provides a similar example</z><z id="t1482245176" t="kirill.salykin I am just looking for the good intereceptor + validation db interceptor seems simplier to me 🙂"><y>#</y><d>2016-12-20</d><h>14:46</h><w>kirill.salykin</w>I am just looking for the good intereceptor + validation

db interceptor seems simplier to me <b>🙂</b></z><z id="t1482245186" t="kirill.salykin would really approciate if you can share it with me"><y>#</y><d>2016-12-20</d><h>14:46</h><w>kirill.salykin</w>would really approciate if you can share it with me</z><z id="t1482245263" t="ddeaguiar Ok, I&apos;ll dig something up and ping you sometime near EOD EST"><y>#</y><d>2016-12-20</d><h>14:47</h><w>ddeaguiar</w>Ok, I&apos;ll dig something up and ping you sometime near EOD EST</z><z id="t1482245293" t="kirill.salykin not urgent"><y>#</y><d>2016-12-20</d><h>14:48</h><w>kirill.salykin</w>not urgent</z><z id="t1482245296" t="kirill.salykin thanks a lot!"><y>#</y><d>2016-12-20</d><h>14:48</h><w>kirill.salykin</w>thanks a lot!</z><z id="t1482245356" t="lellis Hi everybody, im gonna start implement security in my pedestal app, is friend the best framework to do that?"><y>#</y><d>2016-12-20</d><h>14:49</h><w>lellis</w>Hi everybody, im gonna start implement security in my pedestal app, is friend the best framework to do that?</z><z id="t1482246124" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1E404MAR&quot;}] check out https://github.com/propan/geheimtur or https://github.com/funcool/buddy"><y>#</y><d>2016-12-20</d><h>15:02</h><w>ddeaguiar</w><a>@lellis</a> check out <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a> or <a href="https://github.com/funcool/buddy" target="_blank">https://github.com/funcool/buddy</a></z><z id="t1482246135" t="ddeaguiar I&apos;ve had good experiences with both using Pedestal"><y>#</y><d>2016-12-20</d><h>15:02</h><w>ddeaguiar</w>I&apos;ve had good experiences with both using Pedestal</z><z id="t1482251003" t="joshjones Thank you [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] for the info. Since the 3rd party request will take maybe 500ms and our processing will take significantly less time (probably 30-50ms max), it somehow feels strange to put the 3rd party request in an interceptor, when it will take much longer than the actual handler — but it’s what makes sense, I think, if I’m reading you correctly."><y>#</y><d>2016-12-20</d><h>16:23</h><w>joshjones</w>Thank you <a>@ddeaguiar</a> for the info.  Since the 3rd party request will take maybe 500ms and our processing will take significantly less time (probably 30-50ms max), it somehow feels strange to put the 3rd party request in an interceptor, when it will take much longer than the actual handler — but it’s what makes sense, I think, if I’m reading you correctly.</z><z id="t1482251179" t="ddeaguiar I think you can do it in a handler. Just return a channel"><y>#</y><d>2016-12-20</d><h>16:26</h><w>ddeaguiar</w>I think you can do it in a handler. Just return a channel</z><z id="t1482251186" t="joshjones Potentially dumb question about pedestal — since the handler is the last “interceptor” to run, and it takes a request and returns a response, how to I do post-processing on the request? The interceptors seem to be pre-processing, but they work with context maps, and the handler works with req/resp maps. So how can I post-process the response map?"><y>#</y><d>2016-12-20</d><h>16:26</h><w>joshjones</w>Potentially dumb question about pedestal — since the handler is the last “interceptor” to run, and it takes a request and returns a response, how to I do post-processing on the request?  The interceptors seem to be pre-processing, but they work with context maps, and the handler works with req/resp maps.  So how can I post-process the response map?</z><z id="t1482251210" t="ddeaguiar Interceptors support :enter and :leave operations"><y>#</y><d>2016-12-20</d><h>16:26</h><w>ddeaguiar</w>Interceptors support <code>:enter</code> and <code>:leave</code> operations</z><z id="t1482251216" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] [:attrs {:href &quot;/_/_/users/U1ALMRBLL&quot;}] Handlers can&apos;t return channels, but interceptors can."><y>#</y><d>2016-12-20</d><h>16:26</h><w>mtnygard</w><a>@ddeaguiar</a> <a>@joshjones</a> Handlers can&apos;t return channels, but interceptors can.</z><z id="t1482251229" t="mtnygard The channel must deliver exactly one context map."><y>#</y><d>2016-12-20</d><h>16:27</h><w>mtnygard</w>The channel must deliver exactly one context map.</z><z id="t1482251232" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ah, thanks. Was fuzzy on that."><y>#</y><d>2016-12-20</d><h>16:27</h><w>ddeaguiar</w><a>@mtnygard</a> ah, thanks. Was fuzzy on that.</z><z id="t1482251245" t="mtnygard After the context map is delivered, then the rest of the :leave functions will be called as normal"><y>#</y><d>2016-12-20</d><h>16:27</h><w>mtnygard</w>After the context map is delivered, then the rest of the :leave functions will be called as normal</z><z id="t1482251255" t="joshjones But I thought the :leave operation accepts a context map, and returns a context map — not a request or response map"><y>#</y><d>2016-12-20</d><h>16:27</h><w>joshjones</w>But I thought the <code>:leave</code> operation accepts a context map, and returns a context map — not a request or response map</z><z id="t1482251306" t="mtnygard [:attrs {:href &quot;/_/_/users/U1ALMRBLL&quot;}] That&apos;s right. When a handler returns a response map, Pedestal just attaches that response map to the context map, then starts calling the :leave functions with the updated context map."><y>#</y><d>2016-12-20</d><h>16:28</h><w>mtnygard</w><a>@joshjones</a> That&apos;s right. When a handler returns a response map, Pedestal just attaches that response map to the context map, then starts calling the :leave functions with the updated context map.</z><z id="t1482251325" t="joshjones Fantastic, that clear it up, thanks [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2016-12-20</d><h>16:28</h><w>joshjones</w>Fantastic, that clear it up, thanks <a>@mtnygard</a></z><z id="t1482251356" t="mtnygard You&apos;re welcome!"><y>#</y><d>2016-12-20</d><h>16:29</h><w>mtnygard</w>You&apos;re welcome!</z><z id="t1482251395" t="joshjones Our app currently serves a few thousand requests per second, and I’m trying to improve latency by going async and hopefully pedestal will help with that — I think the best thing for me to do here is to write a simple app that utilizes the functionality of some of these pieces, and then I’ll be better informed to ask questions 🙂"><y>#</y><d>2016-12-20</d><h>16:29</h><w>joshjones</w>Our app currently serves a few thousand requests per second, and I’m trying to improve latency by going async and hopefully pedestal will help with that — I think the best thing for me to do here is to write a simple app that utilizes the functionality of some of these pieces, and then I’ll be better informed to ask questions <b>🙂</b></z><z id="t1482251461" t="mtnygard Just keep in mind that there are two ways to return a channel:"><y>#</y><d>2016-12-20</d><h>16:31</h><w>mtnygard</w>Just keep in mind that there are two ways to return a channel:</z><z id="t1482251487" t="mtnygard 1. If the interceptor returns a channel instead of a context map, then that channel can only deliver 1 value, which must be the new context map. That&apos;s the &quot;async&quot; case."><y>#</y><d>2016-12-20</d><h>16:31</h><w>mtnygard</w>1. If the interceptor returns a channel instead of a context map, then that channel can only deliver 1 value, which must be the new context map. That&apos;s the &quot;async&quot; case.</z><z id="t1482251532" t="mtnygard 2. If the interceptor returns a context map with a response whose body is a channel, every value delivered by that channel is streamed to the caller. That&apos;s the &quot;streaming&quot; case."><y>#</y><d>2016-12-20</d><h>16:32</h><w>mtnygard</w>2. If the interceptor returns a context map with a response whose body is a channel, every value delivered by that channel is streamed to the caller. That&apos;s the &quot;streaming&quot; case.</z><z id="t1482251568" t="mtnygard Your description sounds like the async case, so you&apos;re on the right track."><y>#</y><d>2016-12-20</d><h>16:32</h><w>mtnygard</w>Your description sounds like the async case, so you&apos;re on the right track.</z><z id="t1482251949" t="joshjones excellent, I will use that as a guide :thumbsup: :skin-tone-2:"><y>#</y><d>2016-12-20</d><h>16:39</h><w>joshjones</w>excellent, I will use that as a guide <b>:thumbsup:</b><b>:skin-tone-2:</b></z><z id="t1482262436" t="marciol Hi guys, I saw that are several ways of building routes on pedestal, this could be verified on this test file: https://github.com/pedestal/pedestal/blob/master/service/test/io/pedestal/http/route_test.clj"><y>#</y><d>2016-12-20</d><h>19:33</h><w>marciol</w>Hi guys, I saw that are several ways of building routes on pedestal, this could be verified on this test file: <a href="https://github.com/pedestal/pedestal/blob/master/service/test/io/pedestal/http/route_test.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/test/io/pedestal/http/route_test.clj</a></z><z id="t1482262475" t="marciol So my question is, how I choose the better way to express the routes of an application, is there a guideline?"><y>#</y><d>2016-12-20</d><h>19:34</h><w>marciol</w>So my question is, how I choose the better way to express the routes of an application, is there a guideline?</z><z id="t1482264115" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U28A9C90Q&quot;}] ! The different flavors of routing syntax are there because we&apos;ve had some &quot;evolution&quot; over time. The &quot;verbose&quot; syntax is not something that anyone should write by hand. It is the most expanded form, mainly intended for internal use by the routers. The &quot;terse&quot; syntax is good if you need to express a deep tree of routes and you want to take advantage of &quot;inheritance&quot; down the tree for interceptors. For most uses, I would steer you toward the &quot;table&quot; syntax. It is the easiest to read and write, at the cost of some redundancy from row to row."><y>#</y><d>2016-12-20</d><h>20:01</h><w>mtnygard</w>Hi <a>@marciol</a>! The different flavors of routing syntax are there because we&apos;ve had some &quot;evolution&quot; over time. The &quot;verbose&quot; syntax is not something that anyone should write by hand. It is the most expanded form, mainly intended for internal use by the routers. The &quot;terse&quot; syntax is good if you need to express a deep tree of routes and you want to take advantage of &quot;inheritance&quot; down the tree for interceptors.  For most uses, I would steer you toward the &quot;table&quot; syntax. It is the easiest to read and write, at the cost of some redundancy from row to row.</z><z id="t1482264237" t="marciol Hi [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] my gut feeling sayings that the table syntax is better for most cases, thanks"><y>#</y><d>2016-12-20</d><h>20:03</h><w>marciol</w>Hi <a>@mtnygard</a> my gut feeling sayings that the table syntax is better for most cases, thanks</z><z id="t1482264259" t="mtnygard Well, speaking as the person who designed the table syntax, I&apos;m happy to hear that!"><y>#</y><d>2016-12-20</d><h>20:04</h><w>mtnygard</w>Well, speaking as the person who designed the table syntax, I&apos;m happy to hear that!</z><z id="t1482264359" t="marciol great!"><y>#</y><d>2016-12-20</d><h>20:05</h><w>marciol</w>great!</z><z id="t1482327866" t="andrewhr I’m a big fan of the terse syntax, but I confess it is not the friendliest one for newcomers. Take time to grasp the “vector of vectors of vectors” thing"><y>#</y><d>2016-12-21</d><h>13:44</h><w>andrewhr</w>I’m a big fan of the terse syntax, but I confess it is not the friendliest one for newcomers. Take time to grasp the “vector of vectors of vectors” thing</z><z id="t1482329808" t="marciol indentation could help in this case"><y>#</y><d>2016-12-21</d><h>14:16</h><w>marciol</w>indentation could help in this case</z><z id="t1482346664" t="joshjones So I can create a new pedestal project in lein using lein new pedestal-service abc . In that template, the -main function calls server/start with runnable-service , which calls server/create-server , which gives the service-map to create-provider , which gives the service-map to default-interceptors . In default-interceptors , there are default interceptors defined, for example, the not-found interceptor. What if I wanted to have NO not-found interceptor? For a custom one, I’d just specify it in the service map and it would be the one used, but if I wanted to eliminate some interceptors from the default that I felt I didn’t need? Can I build my interceptor list from scratch? Would I then call create-server ? [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2016-12-21</d><h>18:57</h><w>joshjones</w>So I can create a new pedestal project in lein using <code>lein new pedestal-service abc</code>. In that template, the <code>-main</code> function calls <code>server/start</code> with <code>runnable-service</code>, which calls <code>server/create-server</code>, which gives the <code>service-map</code> to <code>create-provider</code>, which gives the <code>service-map</code> to <code>default-interceptors</code>.  In <code>default-interceptors</code>, there are default interceptors defined, for example, the <code>not-found</code> interceptor.  What if I wanted to have NO <code>not-found</code> interceptor?  For a custom one, I’d just specify it in the service map and it would be the one used, but if I wanted to eliminate some interceptors from the default that I felt I didn’t need?  Can I build my interceptor list from scratch?  Would I then call <code>create-server</code>?   <a>@mtnygard</a></z><z id="t1482346747" t="mtnygard [:attrs {:href &quot;/_/_/users/U1ALMRBLL&quot;}] You can definitely build the interceptor list from scratch. http://pedestal.io/reference/default-interceptors shows all the interceptors that get created for you. You&apos;re welcome to construct them directly and set the :io.pedestal.http/interceptors key on your service map before calling create-server"><y>#</y><d>2016-12-21</d><h>18:59</h><w>mtnygard</w><a>@joshjones</a> You can definitely build the interceptor list from scratch. <a href="http://pedestal.io/reference/default-interceptors" target="_blank">http://pedestal.io/reference/default-interceptors</a> shows all the interceptors that get created for you. You&apos;re welcome to construct them directly and set the :io.pedestal.http/interceptors key on your service map before calling <code>create-server</code></z><z id="t1483046170" t="ewen Hi, when closing a channel returned by an asynchronous interceptor (instead of putting a well formed context in the channel), the interceptor chain hangs, the socket is not closed and no response is returned to the client. Should this be considered a bug ?"><y>#</y><d>2016-12-29</d><h>21:16</h><w>ewen</w>Hi, when closing a channel returned by an asynchronous interceptor (instead of putting a well formed context in the channel), the interceptor chain hangs, the socket is not closed and no response is returned to the client. Should this be considered a bug ?</z><z id="t1483155836" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U066KJ18E&quot;}] . I would call that a bug. IMO that should be treated as either a 404 or a 500."><y>#</y><d>2016-12-31</d><h>03:43</h><w>mtnygard</w>Hi <a>@ewen</a>. I would call that a bug. IMO that should be treated as either a 404 or a 500.</z><z id="t1483189926" t="ewen [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ok I will open a issue for this"><y>#</y><d>2016-12-31</d><h>13:12</h><w>ewen</w><a>@mtnygard</a> ok I will open a issue for this</z><z id="t1483986275" t="bostonaholic are people building web applications with pedestal and deploying to heroku?"><y>#</y><d>2017-01-09</d><h>18:24</h><w>bostonaholic</w>are people building web applications with pedestal and deploying to heroku?</z><z id="t1483986296" t="bostonaholic is so, any resources you can point me to would be fantastic!"><y>#</y><d>2017-01-09</d><h>18:24</h><w>bostonaholic</w>is so, any resources you can point me to would be fantastic!</z><z id="t1484026326" t="mavbozo [:attrs {:href &quot;/_/_/users/U066DVDM5&quot;}] you just deploy pedestal web application as uberjar. here&apos;s the doc https://devcenter.heroku.com/articles/deploying-clojure-applications-with-the-heroku-leiningen-plugin"><y>#</y><d>2017-01-10</d><h>05:32</h><w>mavbozo</w><a>@bostonaholic</a> you just deploy pedestal web application as uberjar. here&apos;s the doc <a href="https://devcenter.heroku.com/articles/deploying-clojure-applications-with-the-heroku-leiningen-plugin" target="_blank">https://devcenter.heroku.com/articles/deploying-clojure-applications-with-the-heroku-leiningen-plugin</a></z><z id="t1484026398" t="bostonaholic thanks [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}]"><y>#</y><d>2017-01-10</d><h>05:33</h><w>bostonaholic</w>thanks <a>@mavbozo</a></z><z id="t1484026442" t="bostonaholic I don&apos;t know why I thought a pedestal app would be any different"><y>#</y><d>2017-01-10</d><h>05:34</h><w>bostonaholic</w>I don&apos;t know why I thought a pedestal app would be any different</z><z id="t1484155303" t="curtosis Poking my head in after being away for a long while … what’s happening in pedestal-land these days?"><y>#</y><d>2017-01-11</d><h>17:21</h><w>curtosis</w>Poking my head in after being away for a long while … what’s happening in pedestal-land these days?</z><z id="t1484168611" t="rafaelzlisboa is there any way to test SSE on pedestal using the io.pedestal.test the tooling?"><y>#</y><d>2017-01-11</d><h>21:03</h><w>rafaelzlisboa</w>is there any way to test SSE on pedestal using the io.pedestal.test the tooling?</z><z id="t1484272475" t="mtnygard [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] Depending on when you last used it, the big story is probably breaking out some parts so they could be used independently of the web framework. E.g., interceptors can now be used in any Clojure application. Pedestal has also grown logging and metrics in recent times. Oh, and 0.5.2 was released today."><y>#</y><d>2017-01-13</d><h>01:54</h><w>mtnygard</w><a>@curtosis</a> Depending on when you last used it, the big story is probably breaking out some parts so they could be used independently of the web framework. E.g., interceptors can now be used in any Clojure application. Pedestal has also grown logging and metrics in recent times. Oh, and 0.5.2 was released today.</z><z id="t1484272510" t="mtnygard Release notes: https://github.com/pedestal/pedestal/releases"><y>#</y><d>2017-01-13</d><h>01:55</h><w>mtnygard</w>Release notes: <a href="https://github.com/pedestal/pedestal/releases" target="_blank">https://github.com/pedestal/pedestal/releases</a></z><z id="t1484272536" t="mtnygard [:attrs {:href &quot;/_/_/users/U2GLFCS11&quot;}] : I don&apos;t think io.pedestal.test offers anything for SSE"><y>#</y><d>2017-01-13</d><h>01:55</h><w>mtnygard</w><a>@rafaelzlisboa</a>: I don&apos;t think io.pedestal.test offers anything for SSE</z><z id="t1484272543" t="mtnygard Sorry. :-("><y>#</y><d>2017-01-13</d><h>01:55</h><w>mtnygard</w>Sorry. :-(</z><z id="t1484312871" t="martinklepsch When using interceptors, would it be an anti-pattern to add stuff to the beginning of the queue by recreating it with existing items at the end?"><y>#</y><d>2017-01-13</d><h>13:07</h><w>martinklepsch</w>When using interceptors, would it be an anti-pattern to add stuff to the beginning of the queue by recreating it with existing items at the end?</z><z id="t1484313492" t="martinklepsch I have a situation where I want to do thing A or thing B based on the resulting context from a previous interceptor basically"><y>#</y><d>2017-01-13</d><h>13:18</h><w>martinklepsch</w>I have a situation where I want to do thing A or thing B based on the resulting context from a previous interceptor basically</z><z id="t1484315567" t="mavbozo [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] i don&apos;t understand your first sentence but I have made a authenticate-interceptor--&gt;authorize-interceptor chain where I put user data in context inside authenticate-interceptor and the authorize interceptor do things differently based on the rule and user data put by the previous (authenticate) interceptor"><y>#</y><d>2017-01-13</d><h>13:52</h><w>mavbozo</w><a>@martinklepsch</a> i don&apos;t understand your first sentence but I have made a authenticate-interceptor--&gt;authorize-interceptor chain where I put user data in context inside authenticate-interceptor and the authorize interceptor do things differently based on the rule and user data put by the previous (authenticate) interceptor</z><z id="t1484315753" t="curtosis [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks … I think I last played with it a few months after the app side went away. So it’s been a while. 🙂"><y>#</y><d>2017-01-13</d><h>13:55</h><w>curtosis</w><a>@mtnygard</a> thanks … I think I last played with it a few months after the app side went away. So it’s been a while. <b>🙂</b></z><z id="t1484316803" t="martinklepsch [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] What you’re describing is Interceptor A influencing the behavior of interceptor B. What I’m trying to figure out is how the result of Interceptor A could influence wether interceptor B or interceptor C is used."><y>#</y><d>2017-01-13</d><h>14:13</h><w>martinklepsch</w><a>@mavbozo</a> What you’re describing is Interceptor A influencing the behavior of interceptor B. What I’m trying to figure out is how the result of Interceptor A could influence wether interceptor B or interceptor C is used.</z><z id="t1484316885" t="martinklepsch &gt; When using interceptors, would it be an anti-pattern to add stuff to the beginning of the queue by recreating it with existing items at the end? Agreed that this probably wasn’t very clear. 🙂 The ::queue in the interceptor context is a FIFO queue which means I can’t add things to the beginning without recreating it completely (I think). Does that make it any clearer?"><y>#</y><d>2017-01-13</d><h>14:14</h><w>martinklepsch</w>&gt; When using interceptors, would it be an anti-pattern to add stuff to the beginning of the queue by recreating it with existing items at the end?

Agreed that this probably wasn’t very clear. <b>🙂</b> The <code>::queue</code> in the interceptor context is a FIFO queue which means I can’t add things to the beginning without recreating it completely (I think). Does that make it any clearer?</z><z id="t1484316908" t="kirill.salykin as far as I know you can change interceptors queue, similar to what router currently doing"><y>#</y><d>2017-01-13</d><h>14:15</h><w>kirill.salykin</w>as far as I know you can change interceptors queue, similar to what router currently doing</z><z id="t1484316930" t="kirill.salykin routes is interceptor, which updates interceptor queue"><y>#</y><d>2017-01-13</d><h>14:15</h><w>kirill.salykin</w>routes is interceptor, which updates interceptor queue</z><z id="t1484317034" t="kirill.salykin I dont understand this, but maybe it can help you: https://gist.github.com/ohpauleez/15522bc408d8e09cd7657dd768643a5f"><y>#</y><d>2017-01-13</d><h>14:17</h><w>kirill.salykin</w>I dont understand this, but maybe it can help you:
<a href="https://gist.github.com/ohpauleez/15522bc408d8e09cd7657dd768643a5f" target="_blank">https://gist.github.com/ohpauleez/15522bc408d8e09cd7657dd768643a5f</a></z><z id="t1484317272" t="martinklepsch You’re right about the router modifying the queue but it adds interceptors to the end of it not to the beginning"><y>#</y><d>2017-01-13</d><h>14:21</h><w>martinklepsch</w>You’re right about the router modifying the queue but it adds interceptors to the end of it not to the beginning</z><z id="t1484317364" t="kirill.salykin oh, you want o insert interceptors BEFORE currect?"><y>#</y><d>2017-01-13</d><h>14:22</h><w>kirill.salykin</w>oh, you want o insert interceptors BEFORE currect?</z><z id="t1484317366" t="rafaelzlisboa [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks for replying! do you know what’s the most common way to test it, even if not using the mock requests from io.pedestal.test?"><y>#</y><d>2017-01-13</d><h>14:22</h><w>rafaelzlisboa</w><a>@mtnygard</a> thanks for replying! do you know what’s the most common way to test it, even if not using the mock requests from io.pedestal.test?</z></g><g id="s2"><z id="t1484317420" t="martinklepsch [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] yes"><y>#</y><d>2017-01-13</d><h>14:23</h><w>martinklepsch</w><a>@kirill.salykin</a> yes</z><z id="t1484317452" t="martinklepsch I think would get it working so I’m mostly wondering if I’m setting myself up for failure with this kind of thing"><y>#</y><d>2017-01-13</d><h>14:24</h><w>martinklepsch</w>I think would get it working so I’m mostly wondering if I’m setting myself up for failure with this kind of thing</z><z id="t1484317550" t="kirill.salykin maybe you can always have these intercepters, but they will work only in case of some attr attached to context map? (I assume you want them triggered in :leave state)?"><y>#</y><d>2017-01-13</d><h>14:25</h><w>kirill.salykin</w>maybe you can always have these intercepters, but they will work only in case of some attr attached to context map?
(I assume you want them triggered in :leave state)?</z><z id="t1484317658" t="martinklepsch yes that would be a workaround but it reminds me a lot of GOTO 😄"><y>#</y><d>2017-01-13</d><h>14:27</h><w>martinklepsch</w>yes that would be a workaround but it reminds me a lot of GOTO <b>😄</b></z><z id="t1484317698" t="martinklepsch (I want them triggered in :enter but I don’t think that’s too important… not using them in the context of HTTP reqs)"><y>#</y><d>2017-01-13</d><h>14:28</h><w>martinklepsch</w>(I want them triggered in :enter but I don’t think that’s too important… not using them in the context of HTTP reqs)</z><z id="t1484317734" t="kirill.salykin yes, workaround looks a little like GOTO"><y>#</y><d>2017-01-13</d><h>14:28</h><w>kirill.salykin</w>yes, workaround looks a little like GOTO</z><z id="t1484319533" t="martinklepsch Posted to the mailinglist: https://groups.google.com/forum/#!topic/pedestal-users/j4Sbjmw2cd4"><y>#</y><d>2017-01-13</d><h>14:58</h><w>martinklepsch</w>Posted to the mailinglist: <a href="https://groups.google.com/forum/#!topic/pedestal-users/j4Sbjmw2cd4" target="_blank">https://groups.google.com/forum/#!topic/pedestal-users/j4Sbjmw2cd4</a></z><z id="t1484319707" t="mavbozo [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] interesting, according to this old guide https://github.com/pedestal/pedestal/blob/94632d306fdaac5411a0a1ae13b7c0ce987883e9/guides/documentation/service-context-reference.md"><y>#</y><d>2017-01-13</d><h>15:01</h><w>mavbozo</w><a>@martinklepsch</a> interesting, according to this old guide <a href="https://github.com/pedestal/pedestal/blob/94632d306fdaac5411a0a1ae13b7c0ce987883e9/guides/documentation/service-context-reference.md" target="_blank">https://github.com/pedestal/pedestal/blob/94632d306fdaac5411a0a1ae13b7c0ce987883e9/guides/documentation/service-context-reference.md</a></z><z id="t1484319757" t="mavbozo there is a key :io.pedestal.impl.interceptor/stack inside context which is - A PersistentList of interceptors which still need to be executed during the &apos;leave&apos; stage. So long as this value is not empty, the tail of the list will be removed and executed.`"><y>#</y><d>2017-01-13</d><h>15:02</h><w>mavbozo</w>there is a key <code>:io.pedestal.impl.interceptor/stack</code> inside context which is  - A PersistentList of interceptors which still need to be executed during the &apos;leave&apos; stage. So long as this value is not empty, the tail of the list will be removed and executed.`</z><z id="t1484319796" t="mavbozo suppose your chain is A -&gt; B -&gt; C"><y>#</y><d>2017-01-13</d><h>15:03</h><w>mavbozo</w>suppose your chain is A -&gt; B -&gt; C</z><z id="t1484319875" t="mavbozo maybe inside B interceptor you could push the new interceptor X to i.p.i.i/stack so that the leave chain become for example A &lt;- X &lt;- B &lt;- C"><y>#</y><d>2017-01-13</d><h>15:04</h><w>mavbozo</w>maybe inside B interceptor you could push the new interceptor X to <code>i.p.i.i/stack</code> so that the leave chain become for example A &lt;- X &lt;- B  &lt;- C</z><z id="t1484320494" t="curtosis I’m curious where/why people are picking pedestal to build on these days. Sort of a meta “where does it fit in the current landscape” question."><y>#</y><d>2017-01-13</d><h>15:14</h><w>curtosis</w>I’m curious where/why people are picking pedestal to build on these days. Sort of a meta “where does it fit in the current landscape” question.</z><z id="t1484322139" t="mavbozo [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] I feel pedestal features makes my code easier for me to understand. routes as data makes specifying routes and generating url in html pages unified--I don&apos;t have to hard code url in html template."><y>#</y><d>2017-01-13</d><h>15:42</h><w>mavbozo</w><a>@curtosis</a> I feel pedestal features makes my code easier for me to understand. routes as data makes specifying routes and generating url in html pages unified--I don&apos;t have to hard code url in html template.</z><z id="t1484322500" t="mavbozo routes as data makes me easier to specify different interceptors for each part of the website inside one route data. for example: my web-app could have different interceptors inside /backoffice and /api path while the rest of the paths /* are for customer"><y>#</y><d>2017-01-13</d><h>15:48</h><w>mavbozo</w>routes as data makes me easier to specify different interceptors for each part of the website inside one route data. for example: my web-app could have different interceptors inside /backoffice and /api path while the rest of the paths /* are for customer</z><z id="t1484322865" t="mavbozo injecting dependencies become easier--just put the required components inside context instead of putting the required components inside :request or :response map. It feels cleaner"><y>#</y><d>2017-01-13</d><h>15:54</h><w>mavbozo</w>injecting dependencies become easier--just put the required components inside context instead of putting the required components inside :request or :response map. It feels cleaner</z><z id="t1484323006" t="mavbozo just my personal feeling about pedestal. I never used modern framework such as Django, RoR, CodeIgniter seriously. Before using clojure, most of my time I maintained and developed non framework PHP web apps."><y>#</y><d>2017-01-13</d><h>15:56</h><w>mavbozo</w>just my personal feeling about pedestal. I never used modern framework such as Django, RoR, CodeIgniter seriously. Before using clojure, most of my time I maintained and developed non framework PHP web apps.</z><z id="t1484324114" t="curtosis thanks, that’s a helpful way to look at it"><y>#</y><d>2017-01-13</d><h>16:15</h><w>curtosis</w>thanks, that’s a helpful way to look at it</z><z id="t1484324181" t="curtosis my recent experimenting has been mostly in untangled, which is more of a om.next-centric story"><y>#</y><d>2017-01-13</d><h>16:16</h><w>curtosis</w>my recent experimenting has been mostly in untangled, which is more of a om.next-centric story</z><z id="t1484324265" t="curtosis (not to take anything away from untangled-server, of course; it’s just first and foremost conceived as a backend for the untangled om.next-based front-end)"><y>#</y><d>2017-01-13</d><h>16:17</h><w>curtosis</w>(not to take anything away from untangled-server, of course; it’s just first and foremost conceived as a backend for the untangled om.next-based front-end)</z><z id="t1484324311" t="curtosis I’m trying to get a better mental map of where pedestal sits today compared to, say hoplon or luminus (to pick two that come to mind)"><y>#</y><d>2017-01-13</d><h>16:18</h><w>curtosis</w>I’m trying to get a better mental map of where pedestal sits today compared to, say hoplon or luminus (to pick two that come to mind)</z><z id="t1484334914" t="dfcarpenter Hi everyone, beginner here. Im going through the beginning tutorials on the pedestal website ( http://pedestal.io/guides/hello-world ) and I have question about restarting the web server in a repl. The guide says I can just press Ctrl-C and it will kill the server which it does, but when I try to restart the server using (hello/start) it says the port is in use. Is there a different way to kill the server which releases the port so I can easily restart it?"><y>#</y><d>2017-01-13</d><h>19:15</h><w>dfcarpenter</w>Hi everyone, beginner here.  Im going through the beginning tutorials on the pedestal website (<a href="http://pedestal.io/guides/hello-world" target="_blank">http://pedestal.io/guides/hello-world</a>) and I have question about restarting the web server in a repl. The guide says I can just press Ctrl-C and it will kill the server which it does, but when I try to restart the server using (hello/start) it says the port is in use. Is there a different way to kill the server which releases the port so I can easily restart it?</z><z id="t1484335281" t="mavbozo [:attrs {:href &quot;/_/_/users/U0FMLLTFW&quot;}] can you try again the steps but after you press Ctrl-C, please check whether the server is really killed by accessing the /greet url in the browser"><y>#</y><d>2017-01-13</d><h>19:21</h><w>mavbozo</w><a>@dfcarpenter</a> can you try again the steps but after you press Ctrl-C, please check whether the server is really killed by accessing the <code>/greet</code> url in the browser</z><z id="t1484335370" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0FMLLTFW&quot;}] I typically bind the server to a var when starting. I then stop it using http/stop where http is an alias for io.pedestal.http ."><y>#</y><d>2017-01-13</d><h>19:22</h><w>ddeaguiar</w><a>@dfcarpenter</a> I typically bind the server to a var when starting. I then stop it using <code>http/stop</code> where <code>http</code> is an alias for <code>io.pedestal.http</code>.</z><z id="t1484335388" t="dfcarpenter [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] It looks like it isn’t. When I run the curl commands I get back a response."><y>#</y><d>2017-01-13</d><h>19:23</h><w>dfcarpenter</w><a>@mavbozo</a> It looks like it isn’t. When I run the curl commands I get back a response.</z><z id="t1484335407" t="ddeaguiar I assume your starting via run-dev found in the lein pedestal template?"><y>#</y><d>2017-01-13</d><h>19:23</h><w>ddeaguiar</w>I assume your starting via <code>run-dev</code> found in the lein pedestal template?</z><z id="t1484335419" t="ddeaguiar oh the guide, sec"><y>#</y><d>2017-01-13</d><h>19:23</h><w>ddeaguiar</w>oh the guide, sec</z><z id="t1484335423" t="dfcarpenter [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Ahh good idea. Ill try that. No i’m using the boot repl configuration in the tutorial"><y>#</y><d>2017-01-13</d><h>19:23</h><w>dfcarpenter</w><a>@ddeaguiar</a> Ahh good idea. Ill try that. No i’m using the boot repl configuration in the tutorial</z><z id="t1484335498" t="dfcarpenter In the next part of the guide it tells the reader to restart the server based on changes but it isn’t clear how to do that well. Maybe I should open an issue for it to be to clarified (like using a var for (hello/start)?"><y>#</y><d>2017-01-13</d><h>19:24</h><w>dfcarpenter</w>In the next part of the guide it tells the reader to restart the server based on changes but it isn’t clear how to do that well. Maybe I should open an issue for it to be to clarified (like using a var for (hello/start)?</z><z id="t1484335503" t="mavbozo you can still using the guide but add ::http/join? false in the http/create-server function"><y>#</y><d>2017-01-13</d><h>19:25</h><w>mavbozo</w>you can still using the guide but add <code>::http/join? false</code> in the http/create-server function</z><z id="t1484335503" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0FMLLTFW&quot;}] the guide should be updated. If you don&apos;t bind the result of starting the server to a var then you can&apos;t stop it without killing the repl"><y>#</y><d>2017-01-13</d><h>19:25</h><w>ddeaguiar</w><a>@dfcarpenter</a> the guide should be updated. If you don&apos;t bind the result of starting the server to a var then you can&apos;t stop it without killing the repl</z><z id="t1484335607" t="mavbozo you can start the server by (def my-server (hello/start))"><y>#</y><d>2017-01-13</d><h>19:26</h><w>mavbozo</w>you can start the server by <code>(def my-server (hello/start))</code></z><z id="t1484335648" t="mavbozo then to stop the server use (io.pedestal.http/stop my-server)"><y>#</y><d>2017-01-13</d><h>19:27</h><w>mavbozo</w>then to stop the server use <code>(io.pedestal.http/stop my-server)</code></z><z id="t1484335747" t="ddeaguiar At the risk of being pedantic, I&apos;d extend that to (alter-var-root #&apos;my-server io.pedestal.http/stop)"><y>#</y><d>2017-01-13</d><h>19:29</h><w>ddeaguiar</w>At the risk of being pedantic, I&apos;d extend that to <code>(alter-var-root #&apos;my-server io.pedestal.http/stop)</code></z><z id="t1484335780" t="dfcarpenter Thank you all for your help"><y>#</y><d>2017-01-13</d><h>19:29</h><w>dfcarpenter</w>Thank you all for your help</z><z id="t1484335837" t="ddeaguiar Thanks for the guide feedback. I&apos;ll look into issuing a pr with clarifications"><y>#</y><d>2017-01-13</d><h>19:30</h><w>ddeaguiar</w>Thanks for the guide feedback. I&apos;ll look into issuing a pr with clarifications</z><z id="t1484339046" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0FMLLTFW&quot;}] fyi https://github.com/pedestal/pedestal-docs/pull/53"><y>#</y><d>2017-01-13</d><h>20:24</h><w>ddeaguiar</w><a>@dfcarpenter</a> fyi <a href="https://github.com/pedestal/pedestal-docs/pull/53" target="_blank">https://github.com/pedestal/pedestal-docs/pull/53</a></z><z id="t1484339859" t="ddeaguiar hmm, just saw Paul&apos;s response on the pedestal mailing list. I think I&apos;m going to close this PR"><y>#</y><d>2017-01-13</d><h>20:37</h><w>ddeaguiar</w>hmm, just saw Paul&apos;s response on the pedestal mailing list. I think I&apos;m going to close this PR</z><z id="t1484341283" t="dfcarpenter [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thanks again! and yes I saw the thread."><y>#</y><d>2017-01-13</d><h>21:01</h><w>dfcarpenter</w><a>@ddeaguiar</a> Thanks again! and yes I saw the thread.</z><z id="t1484341310" t="ddeaguiar np, I left the PR open at Paul&apos;s discretion"><y>#</y><d>2017-01-13</d><h>21:01</h><w>ddeaguiar</w>np, I left the PR open at Paul&apos;s discretion</z><z id="t1484768051" t="souenzzo There is some way to add data to ctx? [&quot;/&quot; hello :route-name :hello :my-data {:foo 123}]"><y>#</y><d>2017-01-18</d><h>19:34</h><w>souenzzo</w>There is some way to add data to ctx?
<code>[&quot;/&quot; hello :route-name :hello :my-data {:foo 123}]</code></z><z id="t1484768173" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] data can be assoc&apos;d to the context via interceptors"><y>#</y><d>2017-01-18</d><h>19:36</h><w>ddeaguiar</w><a>@souenzzo</a> data can be assoc&apos;d to the context via interceptors</z><z id="t1484768237" t="souenzzo It would be interesting to have it declared alongside the route"><y>#</y><d>2017-01-18</d><h>19:37</h><w>souenzzo</w>It would be interesting to have it declared alongside the route</z><z id="t1484768332" t="souenzzo I will try (with-meta :hello {:my &apos;stuff})"><y>#</y><d>2017-01-18</d><h>19:38</h><w>souenzzo</w>I will try <code>(with-meta :hello {:my &apos;stuff})</code></z><z id="t1484768446" t="rafaelzlisboa you can add interceptors to the route"><y>#</y><d>2017-01-18</d><h>19:40</h><w>rafaelzlisboa</w>you can add interceptors to the route</z><z id="t1484768482" t="rafaelzlisboa like… to that exact one, if need be"><y>#</y><d>2017-01-18</d><h>19:41</h><w>rafaelzlisboa</w>like… to that exact one, if need be</z><z id="t1484768540" t="souenzzo There is a &quot;conform-spec&quot; interceptor. But I need to specify {:body-spec ::spec/entity}"><y>#</y><d>2017-01-18</d><h>19:42</h><w>souenzzo</w>There is a &quot;conform-spec&quot; interceptor. But I need to specify <code>{:body-spec ::spec/entity}</code></z><z id="t1484936918" t="ddellacosta so I’m seeing some really bizarre behavior that I can’t wrap my head around"><y>#</y><d>2017-01-20</d><h>18:28</h><w>ddellacosta</w>so I’m seeing some really bizarre behavior that I can’t wrap my head around</z><z id="t1484936927" t="ddellacosta I’ve got enter and leave interceptors set up"><y>#</y><d>2017-01-20</d><h>18:28</h><w>ddellacosta</w>I’ve got enter and leave interceptors set up</z><z id="t1484936950" t="ddellacosta and I have logging in both of those, and those calls are getting hit—I see the request go through"><y>#</y><d>2017-01-20</d><h>18:29</h><w>ddellacosta</w>and I have logging in both of those, and those calls are getting hit—I see the request go through</z><z id="t1484936970" t="ddellacosta but the response is a 404 response. I am just completely stumped as to what is going on or how to debug it at this point."><y>#</y><d>2017-01-20</d><h>18:29</h><w>ddellacosta</w>but the response is a 404 response. I am just completely stumped as to what is going on or how to debug it at this point.</z><z id="t1484936978" t="ddellacosta has anyone seen this?"><y>#</y><d>2017-01-20</d><h>18:29</h><w>ddellacosta</w>has anyone seen this?</z><z id="t1484937080" t="ddellacosta I’m on the latest, 0.5.2, using jetty"><y>#</y><d>2017-01-20</d><h>18:31</h><w>ddellacosta</w>I’m on the latest, 0.5.2, using jetty</z><z id="t1484938741" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0B6ER3U3&quot;}] without seeing any code I can only guess that you&apos;re not assoc&apos;ing a response to the context. Did you set up a handler for the route?"><y>#</y><d>2017-01-20</d><h>18:59</h><w>ddeaguiar</w><a>@ddellacosta</a> without seeing any code I can only guess that you&apos;re not assoc&apos;ing a response to the context. Did you set up a handler for the route?</z><z id="t1484938864" t="ddellacosta [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yes, I’ve got an :enter interceptor handler set up"><y>#</y><d>2017-01-20</d><h>19:01</h><w>ddellacosta</w><a>@ddeaguiar</a> yes, I’ve got an <code>:enter</code> interceptor handler set up</z><z id="t1484938878" t="ddellacosta it dumps out a logging message, which I see, and assocs a b.s. response map to the context"><y>#</y><d>2017-01-20</d><h>19:01</h><w>ddellacosta</w>it dumps out a logging message, which I see, and assocs a b.s. response map to the context</z><z id="t1484938887" t="ddellacosta but still I’m getting a 404 for some reason"><y>#</y><d>2017-01-20</d><h>19:01</h><w>ddellacosta</w>but still I’m getting a 404 for some reason</z><z id="t1484938913" t="ddellacosta I must be doing something incredibly basically stupid here but I can’t for the life of me figure out what it is"><y>#</y><d>2017-01-20</d><h>19:01</h><w>ddellacosta</w>I must be doing something incredibly basically stupid here but I can’t for the life of me figure out what it is</z><z id="t1484938961" t="ddeaguiar Can you share a code snippet for your interceptor as well as the routes?"><y>#</y><d>2017-01-20</d><h>19:02</h><w>ddeaguiar</w>Can you share a code snippet for your interceptor as well as the routes?</z><z id="t1484938998" t="ddellacosta one sec"><y>#</y><d>2017-01-20</d><h>19:03</h><w>ddellacosta</w>one sec</z><z id="t1484939043" t="ddeaguiar So the default not-found interceptor checks the context for a response. If none is present then a 404 is returned"><y>#</y><d>2017-01-20</d><h>19:04</h><w>ddeaguiar</w>So the default <code>not-found</code> interceptor checks the context for a response. If none is present then a <code>404</code> is returned</z><z id="t1484939096" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L92"><y>#</y><d>2017-01-20</d><h>19:04</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L92" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L92</a></z><z id="t1484939288" t="ddellacosta Sorry for the confusing layout and formatting; basically the top half is the interceptor code and configuration, the bottom bit is the test I’m running it within, and the fixture that starts and stops the server"><y>#</y><d>2017-01-20</d><h>19:08</h><w>ddellacosta</w>Sorry for the confusing layout and formatting; basically the top half is the interceptor code and configuration, the bottom bit is the test I’m running it within, and the fixture that starts and stops the server</z><z id="t1484939321" t="ddellacosta I can only imagine that somehow it’s behaving as you suggest, and it’s not finding the response, but I can’t see how"><y>#</y><d>2017-01-20</d><h>19:08</h><w>ddellacosta</w>I can only imagine that somehow it’s behaving as you suggest, and it’s not finding the response, but I can’t see how</z><z id="t1484939349" t="ddellacosta what I see in my output, among other things, is the response: 12│ ?? {:request-time 6, :repeatable? false, :protocol-version {:name HTTP, :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase Not Found, :headers {Connection close, Date Fri, 20 Jan 2017 19:06:49 GMT, Content-Type text/plain}, :orig-content-encoding nil, :status 404, :length -1, :body Not Found, :trace-redirects []}"><y>#</y><d>2017-01-20</d><h>19:09</h><w>ddellacosta</w>what I see in my output, among other things, is the response:
<pre>12│  ??  {:request-time 6, :repeatable? false, :protocol-version {:name HTTP, :major 1, :minor 1}, :streaming? true, :chunked? false, :reason-phrase Not Found, :headers {Connection close, Date Fri, 20 Jan 2017 19:06:49 GMT, Content-Type text/plain}, :orig-content-encoding nil, :status 404, :length -1, :body Not Found, :trace-redirects []}</pre></z><z id="t1484939364" t="ddellacosta and, the logging message (”this shows up”)"><y>#</y><d>2017-01-20</d><h>19:09</h><w>ddellacosta</w>and, the logging message (”this shows up”)</z><z id="t1484939379" t="ddeaguiar try adding :status 200 to the response map"><y>#</y><d>2017-01-20</d><h>19:09</h><w>ddeaguiar</w>try adding <code>:status 200</code> to the response map</z><z id="t1484939441" t="ddeaguiar so the not-found interceptor uses the response? predicate https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L84"><y>#</y><d>2017-01-20</d><h>19:10</h><w>ddeaguiar</w>so the <code>not-found</code> interceptor uses the <code>response?</code> predicate <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L84" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L84</a></z><z id="t1484939459" t="ddeaguiar which checks that the response is a map and that status is an integer"><y>#</y><d>2017-01-20</d><h>19:10</h><w>ddeaguiar</w>which checks that the response is a map and that status is an integer</z><z id="t1484939484" t="ddellacosta apparently that was it"><y>#</y><d>2017-01-20</d><h>19:11</h><w>ddellacosta</w>apparently that was it</z><z id="t1484939489" t="ddellacosta thank you [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2017-01-20</d><h>19:11</h><w>ddellacosta</w>thank you <a>@ddeaguiar</a></z><z id="t1484939496" t="ddellacosta I knew it was something incredibly stupid"><y>#</y><d>2017-01-20</d><h>19:11</h><w>ddellacosta</w>I knew it was something incredibly stupid</z><z id="t1484939518" t="ddellacosta and, thanks for the pointers to the relevant code"><y>#</y><d>2017-01-20</d><h>19:11</h><w>ddellacosta</w>and, thanks for the pointers to the relevant code</z><z id="t1484939521" t="ddeaguiar Well, I think there may be some opportunity to improve messaging"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddeaguiar</w>Well, I think there may be some opportunity to improve messaging</z><z id="t1484939534" t="ddellacosta yeah, this cost me almost half a day, it was very frustrating"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddellacosta</w>yeah, this cost me almost half a day, it was very frustrating</z><z id="t1484939540" t="ddeaguiar sorry to hear that"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddeaguiar</w>sorry to hear that</z><z id="t1484939542" t="ddellacosta and it was an incredibly basic mistake"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddellacosta</w>and it was an incredibly basic mistake</z><z id="t1484939556" t="ddeaguiar I do have some suggestions for you"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddeaguiar</w>I do have some suggestions for you</z><z id="t1484939562" t="ddellacosta part of that is probably that I failed to read the necessary docs on how you should add responses to the context though"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddellacosta</w>part of that is probably that I failed to read the necessary docs on how you should add responses to the context though</z><z id="t1484939576" t="ddellacosta wherever those are…I’m pathological about reading docs after the fact"><y>#</y><d>2017-01-20</d><h>19:12</h><w>ddellacosta</w>wherever those are…I’m pathological about reading docs after the fact</z><z id="t1484939601" t="ddeaguiar 1. construct responses using ring&apos;s response helper"><y>#</y><d>2017-01-20</d><h>19:13</h><w>ddeaguiar</w>1. construct responses using ring&apos;s response helper</z><z id="t1484939602" t="ddellacosta but yeah, suggestions welcome..."><y>#</y><d>2017-01-20</d><h>19:13</h><w>ddellacosta</w>but yeah, suggestions welcome...</z><z id="t1484939653" t="ddeaguiar 2. prefer simple handler fns over interceptors for returning responses"><y>#</y><d>2017-01-20</d><h>19:14</h><w>ddeaguiar</w>2. prefer simple handler fns over interceptors for returning responses</z><z id="t1484939680" t="ddeaguiar Docs can be found here: http://pedestal.io/ . Requests for improvement welcome"><y>#</y><d>2017-01-20</d><h>19:14</h><w>ddeaguiar</w>Docs can be found here: <a href="http://pedestal.io/" target="_blank">http://pedestal.io/</a>. Requests for improvement welcome</z><z id="t1484939708" t="ddellacosta got it—thanks for those tips, and I’ll take the time to actually read the docs now. All your help is much appreciated [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2017-01-20</d><h>19:15</h><w>ddellacosta</w>got it—thanks for those tips, and I’ll take the time to actually read the docs now. All your help is much appreciated <a>@ddeaguiar</a> !</z><z id="t1484939721" t="ddeaguiar np! Good luck!"><y>#</y><d>2017-01-20</d><h>19:15</h><w>ddeaguiar</w>np! Good luck!</z><z id="t1484939928" t="ddellacosta oh and yeah, as far as improving messaging I suppose it would have been super helpful if pedestal had dumped out something like, “hey dumbass, there is not a response map/your response map is missing some basic stuff…” Granted, I should have known, but I guess I was kind of assuming that pedestal would magically merge stuff in somehow. Thinking back on it I don’t know why I thought that, and the behavior I was seeing makes a ton of sense now, but a warning or something would have been great."><y>#</y><d>2017-01-20</d><h>19:18</h><w>ddellacosta</w>oh and yeah, as far as improving messaging I suppose it would have been super helpful if pedestal had dumped out something like, “hey dumbass, there is not a response map/your response map is missing some basic stuff…” Granted, I should have known, but I guess I was kind of assuming that pedestal would magically merge stuff in somehow. Thinking back on it I don’t know why I thought that, and the behavior I was seeing makes a ton of sense now, but a warning or something would have been great.</z><z id="t1484939958" t="ddeaguiar agreed"><y>#</y><d>2017-01-20</d><h>19:19</h><w>ddeaguiar</w>agreed</z><z id="t1485118607" t="mtnygard [:attrs {:href &quot;/_/_/users/U0B6ER3U3&quot;}] [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I just added issue #55 to the pedestal-docs repo to add a section for capturing this &quot;gotcha&quot;. Really sorry that it cost you so much time [:attrs {:href &quot;/_/_/users/U0B6ER3U3&quot;}] ."><y>#</y><d>2017-01-22</d><h>20:56</h><w>mtnygard</w><a>@ddellacosta</a> <a>@ddeaguiar</a> I just added issue #55 to the pedestal-docs repo to add a section for capturing this &quot;gotcha&quot;. Really sorry that it cost you so much time <a>@ddellacosta</a>.</z><z id="t1485121112" t="ddellacosta [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] no apology needed, in the end this was my fault—but thanks very much for adding this as an issue!"><y>#</y><d>2017-01-22</d><h>21:38</h><w>ddellacosta</w><a>@mtnygard</a> no apology needed, in the end this was my fault—but thanks very much for adding this as an issue!</z><z id="t1485155274" t="martinklepsch In the interceptor code: Is there a good reason peek is used to obtain the first item of the stack? It’s a list so first should be just as good? https://github.com/pedestal/pedestal/blob/0.5.2/interceptor/src/io/pedestal/interceptor/chain.clj#L246"><y>#</y><d>2017-01-23</d><h>07:07</h><w>martinklepsch</w>In the interceptor code: Is there a good reason <code>peek</code> is used to obtain the first item of the stack? It’s a list so <code>first</code> should be just as good? <a href="https://github.com/pedestal/pedestal/blob/0.5.2/interceptor/src/io/pedestal/interceptor/chain.clj#L246" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.2/interceptor/src/io/pedestal/interceptor/chain.clj#L246</a></z><z id="t1485155438" t="martinklepsch I’m doing some, ahem, adventurous stuff I guess and modify the stack (appending something) which the usage of peek complicates because it explicitly requires a PersistentList and anything that comes out of concat is LazySeq/Cons"><y>#</y><d>2017-01-23</d><h>07:10</h><w>martinklepsch</w>I’m doing some, ahem, adventurous stuff I guess and modify the stack (appending something) which the usage of <code>peek</code> complicates because it explicitly requires a PersistentList and anything that comes out of <code>concat</code> is LazySeq/Cons</z><z id="t1485181664" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I can only speculate that it&apos;s used to decouple the semantics of the operation from the underlying collection type. Is laziness an important property of your implementation?"><y>#</y><d>2017-01-23</d><h>14:27</h><w>ddeaguiar</w><a>@martinklepsch</a> I can only speculate that it&apos;s used to decouple the semantics of the operation from the underlying collection type. Is laziness an important property of your implementation?</z><z id="t1485181769" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Hey 🙂 laziness is not important, appending is. I ended up using something like this: (defn concat-stack [l1 l2] ;; (into &apos;(4 5) (reverse &apos;(1 2 3))) ; =&gt; &apos;(1 2 3 4 5) (into l2 (reverse l1))) "><y>#</y><d>2017-01-23</d><h>14:29</h><w>martinklepsch</w><a>@ddeaguiar</a> Hey <b>🙂</b> laziness is not important, appending is. I ended up using something like this:
<pre>(defn concat-stack [l1 l2]
  ;; (into &apos;(4 5) (reverse &apos;(1 2 3))) ; =&gt; &apos;(1 2 3 4 5)
  (into l2 (reverse l1)))
</pre></z><z id="t1485181921" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I was initially thinking “oh maybe this should be a PersistentQueue” as well but has repercussions into many places and complicates adding to the front"><y>#</y><d>2017-01-23</d><h>14:32</h><w>martinklepsch</w><a>@ddeaguiar</a> I was initially thinking “oh maybe this should be a PersistentQueue” as well but has repercussions into many places and complicates adding to the front</z><z id="t1485181969" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] trying to think of a reason you’d want this decoupled from collection type but when would the stack be something else than a PersistentList?"><y>#</y><d>2017-01-23</d><h>14:32</h><w>martinklepsch</w><a>@ddeaguiar</a> trying to think of a reason you’d want this decoupled from collection type but when would the stack be something else than a PersistentList?</z><z id="t1485182088" t="ddeaguiar Yeah, so I&apos;m just speculating. Perhaps [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] could clarify. Unfortunately I personally have not done much work requiring manipulation of the interceptor chain."><y>#</y><d>2017-01-23</d><h>14:34</h><w>ddeaguiar</w>Yeah, so I&apos;m just speculating. Perhaps <a>@mtnygard</a> could clarify. Unfortunately I personally have not done much work requiring manipulation of the interceptor chain.</z><z id="t1485182933" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I had a quick conversation with Paul deGrandis about this. Although the underlying collection type of the stack doesn&apos;t change, that&apos;s an implementation detail. The current implementation should still work if you changed the collection types of :: queue and :: stack dynamically."><y>#</y><d>2017-01-23</d><h>14:48</h><w>ddeaguiar</w><a>@martinklepsch</a> I had a quick conversation with Paul deGrandis about this. Although the underlying collection type of the stack doesn&apos;t change, that&apos;s an implementation detail. The current implementation should still work if you changed the collection types of <b>::</b>queue and <b>::</b>stack dynamically.</z><z id="t1485183027" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] to what type would I change it? PersistentQueue is the only one that supports pop/peek afaik?"><y>#</y><d>2017-01-23</d><h>14:50</h><w>martinklepsch</w><a>@ddeaguiar</a> to what type would I change it? PersistentQueue is the only one that supports pop/peek afaik?</z><z id="t1485183041" t="martinklepsch Good to know you’re sitting close to the source heh 🙂"><y>#</y><d>2017-01-23</d><h>14:50</h><w>martinklepsch</w>Good to know you’re sitting close to the source heh <b>🙂</b></z><z id="t1485183091" t="ddeaguiar peek/pop work with lists, queues and vectors"><y>#</y><d>2017-01-23</d><h>14:51</h><w>ddeaguiar</w>peek/pop work with lists, queues and vectors</z><z id="t1485183157" t="martinklepsch right vectors but then the code uses conj to add items to the stack 🙂"><y>#</y><d>2017-01-23</d><h>14:52</h><w>martinklepsch</w>right vectors but then the code uses conj to add items to the stack <b>🙂</b></z><z id="t1485183175" t="martinklepsch (so vectors are out)"><y>#</y><d>2017-01-23</d><h>14:52</h><w>martinklepsch</w>(so vectors are out)</z><z id="t1485183196" t="martinklepsch &gt; PersistentQueue is the only one that supports pop/peek afaik? should have included PersistentList"><y>#</y><d>2017-01-23</d><h>14:53</h><w>martinklepsch</w>&gt; PersistentQueue is the only one that supports pop/peek afaik? 
should have included PersistentList</z><z id="t1485183545" t="martinklepsch You could change it to PersistentQueue which would make some sense I guess (I can’t track down the repercussions mentioned earlier, maybe they were in my code not the interceptor code)"><y>#</y><d>2017-01-23</d><h>14:59</h><w>martinklepsch</w>You could change it to PersistentQueue which would make some sense I guess (I can’t track down the repercussions mentioned earlier, maybe they were in my code not the interceptor code)</z><z id="t1485183685" t="martinklepsch Either way, this is complaining at a high level, I solved my problem in an acceptable way so no need to discuss more unless more people think it’s irritating"><y>#</y><d>2017-01-23</d><h>15:01</h><w>martinklepsch</w>Either way, this is complaining at a high level, I solved my problem in an acceptable way so no need to discuss more unless more people think it’s irritating</z><z id="t1485183843" t="ddeaguiar Well, thanks for bringing this up. I&apos;m very interested in seeing how your work progresses!"><y>#</y><d>2017-01-23</d><h>15:04</h><w>ddeaguiar</w>Well, thanks for bringing this up. I&apos;m very interested in seeing how your work progresses!</z><z id="t1485183903" t="martinklepsch Me too 😄"><y>#</y><d>2017-01-23</d><h>15:05</h><w>martinklepsch</w>Me too <b>😄</b></z><z id="t1485183934" t="martinklepsch So far interceptors are holding up nicely (and I think I’ve abused them a fair bit 🙂 )"><y>#</y><d>2017-01-23</d><h>15:05</h><w>martinklepsch</w>So far interceptors are holding up nicely (and I think I’ve abused them a fair bit <b>🙂</b>)</z><z id="t1485349623" t="christianromney Pedestal context maps (and by extension Ring request / response maps) seem like a perfect use case for clojure.spec"><y>#</y><d>2017-01-25</d><h>13:07</h><w>christianromney</w>Pedestal context maps (and by extension Ring request / response maps) seem like a perfect use case for clojure.spec</z><z id="t1485349876" t="christianromney i&apos;ve been bitten more than once when carelessly implementing an interceptor that returns a response instead of a context. clojure.spec can help me enforce that all my interceptors are functions from context -&gt; context"><y>#</y><d>2017-01-25</d><h>13:11</h><w>christianromney</w>i&apos;ve been bitten more than once when carelessly implementing an interceptor that returns a response instead of a context. clojure.spec can help me enforce that all my interceptors are functions from context -&gt; context</z><z id="t1485349916" t="christianromney would be nice to establish some patterns here and maybe even push that down into the library 🙂"><y>#</y><d>2017-01-25</d><h>13:11</h><w>christianromney</w>would be nice to establish some patterns here and maybe even push that down into the library <b>🙂</b></z><z id="t1485383529" t="mtnygard [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] I definitely think that&apos;s a good use case. We&apos;ve been holding off on that until 1.9 is released."><y>#</y><d>2017-01-25</d><h>22:32</h><w>mtnygard</w><a>@christianromney</a> I definitely think that&apos;s a good use case. We&apos;ve been holding off on that until 1.9 is released.</z><z id="t1485383549" t="christianromney that makes sense"><y>#</y><d>2017-01-25</d><h>22:32</h><w>christianromney</w>that makes sense</z><z id="t1485383594" t="christianromney thanks for the roadmap update [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2017-01-25</d><h>22:33</h><w>christianromney</w>thanks for the roadmap update <a>@mtnygard</a></z><z id="t1485877059" t="mtnygard We&apos;ve released Vase, an add-on to Pedestal that makes building data-driven microservices easy. Blog post: http://bit.ly/2jqHeV6 , Repository: https://github.com/cognitect-labs/vase . Clojars: https://clojars.org/com.cognitect/pedestal.vase"><y>#</y><d>2017-01-31</d><h>15:37</h><w>mtnygard</w>We&apos;ve released Vase, an add-on to Pedestal that makes building data-driven microservices easy. 

Blog post: <a href="http://bit.ly/2jqHeV6" target="_blank">http://bit.ly/2jqHeV6</a>, Repository: <a href="https://github.com/cognitect-labs/vase" target="_blank">https://github.com/cognitect-labs/vase</a>.  Clojars: <a href="https://clojars.org/com.cognitect/pedestal.vase" target="_blank">https://clojars.org/com.cognitect/pedestal.vase</a></z><z id="t1485877259" t="ddeaguiar Nice!"><y>#</y><d>2017-01-31</d><h>15:40</h><w>ddeaguiar</w>Nice!</z><z id="t1485906610" t="nooga is there any way to define thwo different paths to a single handler using terse syntax?"><y>#</y><d>2017-01-31</d><h>23:50</h><w>nooga</w>is there any way to define thwo different paths to a single handler using terse syntax?</z><z id="t1485906713" t="nooga [”/” {:get bar} “/foo” {:get bar}] gives me errors, as well as [”/foo” {:put bar :post bar}]"><y>#</y><d>2017-01-31</d><h>23:51</h><w>nooga</w><code>[”/” {:get bar} “/foo” {:get bar}]</code> gives me errors, as well as <code>[”/foo” {:put bar :post bar}]</code></z><z id="t1485917589" t="mtnygard [:attrs {:href &quot;/_/_/users/U0ARQ14BA&quot;}] The error is probably coming because those get the same route name assigned to them. Try something like this:"><y>#</y><d>2017-02-01</d><h>02:53</h><w>mtnygard</w><a>@nooga</a> The error is probably coming because those get the same route name assigned to them. Try something like this:</z><z id="t1485917606" t="mtnygard #{[&quot;/&quot; :get bar :route-name :bar-slash] [&quot;/foo&quot; :get bar :route-name :bar-foo]}"><y>#</y><d>2017-02-01</d><h>02:53</h><w>mtnygard</w>#{[&quot;/&quot; :get bar :route-name :bar-slash]
   [&quot;/foo&quot; :get bar :route-name :bar-foo]}</z><z id="t1485917628" t="mtnygard or"><y>#</y><d>2017-02-01</d><h>02:53</h><w>mtnygard</w>or</z><z id="t1485917652" t="mtnygard #{[&quot;/foo&quot; :put bar :route-name :bar-put] [&quot;/foo&quot; :post bar :route-name :bar-post]}"><y>#</y><d>2017-02-01</d><h>02:54</h><w>mtnygard</w>#{[&quot;/foo&quot; :put bar :route-name :bar-put]
  [&quot;/foo&quot; :post bar :route-name :bar-post]}</z><z id="t1485917692" t="mtnygard (Note that I switched to table route syntax instead of terse. That&apos;s just because I can do table routes off the top of my head, but I always have to look up the terse syntax.)"><y>#</y><d>2017-02-01</d><h>02:54</h><w>mtnygard</w>(Note that I switched to table route syntax instead of terse. That&apos;s just because I can do table routes off the top of my head, but I always have to look up the terse syntax.)</z><z id="t1485941690" t="nooga [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks"><y>#</y><d>2017-02-01</d><h>09:34</h><w>nooga</w><a>@mtnygard</a> thanks</z><z id="t1485948219" t="nooga that’s what I though"><y>#</y><d>2017-02-01</d><h>11:23</h><w>nooga</w>that’s what I though</z><z id="t1485948264" t="nooga I just hoped that I can avoid duplicating bar declarations since they should work exactly the same way"><y>#</y><d>2017-02-01</d><h>11:24</h><w>nooga</w>I just hoped that I can avoid duplicating <code>bar</code> declarations since they should work exactly the same way</z><z id="t1486131073" t="dazld hey everyone"><y>#</y><d>2017-02-03</d><h>14:11</h><w>dazld</w>hey everyone</z><z id="t1486131080" t="dazld we’re playing around with vase a little"><y>#</y><d>2017-02-03</d><h>14:11</h><w>dazld</w>we’re playing around with vase a little</z><z id="t1486131101" t="mtnygard [:attrs {:href &quot;/_/_/users/U3ZUC5M0R&quot;}] Great!"><y>#</y><d>2017-02-03</d><h>14:11</h><w>mtnygard</w><a>@dazld</a> Great!</z><z id="t1486131105" t="dazld question - does this do very much without having an actual datomic instance running?"><y>#</y><d>2017-02-03</d><h>14:11</h><w>dazld</w>question - does this do very much without having an actual datomic instance running?</z><z id="t1486131119" t="dazld hey [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] was hoping you might be around 🙂"><y>#</y><d>2017-02-03</d><h>14:11</h><w>dazld</w>hey <a>@mtnygard</a> was hoping you might be around <b>🙂</b></z><z id="t1486131156" t="mtnygard With no Datomic at all, you can still use the #vase/respond and #vase/redirect literals. They&apos;re not terribly interesting by themselves. You can also write your own literals and use the rest of Vase&apos;s plumbing."><y>#</y><d>2017-02-03</d><h>14:12</h><w>mtnygard</w>With no Datomic at all, you can still use the #vase/respond and #vase/redirect literals. They&apos;re not terribly interesting by themselves. You can also write your own literals and use the rest of Vase&apos;s plumbing.</z><z id="t1486131169" t="dazld got it - this explains a lot"><y>#</y><d>2017-02-03</d><h>14:12</h><w>dazld</w>got it - this explains a lot</z><z id="t1486131174" t="mtnygard It you&apos;re just kicking the tires, you can also use Datomic&apos;s in-memory database."><y>#</y><d>2017-02-03</d><h>14:12</h><w>mtnygard</w>It you&apos;re just kicking the tires, you can also use Datomic&apos;s in-memory database.</z><z id="t1486131186" t="dazld could you point me at a quickstart for the in-memory db?"><y>#</y><d>2017-02-03</d><h>14:13</h><w>dazld</w>could you point me at a quickstart for the in-memory db?</z><z id="t1486131211" t="mtnygard It&apos;s pretty easy. You just don&apos;t run a transactor. 🙂 Then use &quot;datomic:&lt;mem://dbname&gt;&quot; as the URI."><y>#</y><d>2017-02-03</d><h>14:13</h><w>mtnygard</w>It&apos;s pretty easy. You just don&apos;t run a transactor. <b>🙂</b> Then use &quot;datomic:&lt;mem://dbname&gt;&quot; as the URI.</z><z id="t1486131223" t="mtnygard You can call create-database, connect, transact, etc."><y>#</y><d>2017-02-03</d><h>14:13</h><w>mtnygard</w>You can call create-database, connect, transact, etc.</z><z id="t1486131235" t="dazld oki, time to break out docker 🙂"><y>#</y><d>2017-02-03</d><h>14:13</h><w>dazld</w>oki, time to break out docker <b>🙂</b></z><z id="t1486131244" t="dazld I think i have a test licence hanging around still too"><y>#</y><d>2017-02-03</d><h>14:14</h><w>dazld</w>I think i have a test licence hanging around still too</z><z id="t1486131262" t="mtnygard (You don&apos;t even need a test license for the in-memory db.)"><y>#</y><d>2017-02-03</d><h>14:14</h><w>mtnygard</w>(You don&apos;t even need a test license for the in-memory db.)</z><z id="t1486131271" t="dazld oh, awesome"><y>#</y><d>2017-02-03</d><h>14:14</h><w>dazld</w>oh, awesome</z><z id="t1486131304" t="dazld as a suggestion, might want to add this information to the readme\"><y>#</y><d>2017-02-03</d><h>14:15</h><w>dazld</w>as a suggestion, might want to add this information to the readme\</z><z id="t1486131314" t="mtnygard Good idea."><y>#</y><d>2017-02-03</d><h>14:15</h><w>mtnygard</w>Good idea.</z><z id="t1486131326" t="dazld :thumbsup:"><y>#</y><d>2017-02-03</d><h>14:15</h><w>dazld</w><b>:thumbsup:</b></z><z id="t1486131400" t="mtnygard https://github.com/cognitect-labs/vase/issues/26"><y>#</y><d>2017-02-03</d><h>14:16</h><w>mtnygard</w><a href="https://github.com/cognitect-labs/vase/issues/26" target="_blank">https://github.com/cognitect-labs/vase/issues/26</a></z><z id="t1486131418" t="mtnygard Please let me know if you bump into any sharp corners."><y>#</y><d>2017-02-03</d><h>14:16</h><w>mtnygard</w>Please let me know if you bump into any sharp corners.</z><z id="t1486131423" t="mtnygard I&apos;ll add more to that issue."><y>#</y><d>2017-02-03</d><h>14:17</h><w>mtnygard</w>I&apos;ll add more to that issue.</z><z id="t1486131553" t="dazld how about a 500 if the datastore isn&apos;t available?"><y>#</y><d>2017-02-03</d><h>14:19</h><w>dazld</w>how about a 500 if the datastore isn&apos;t available?</z><z id="t1486131556" t="dazld or 5xx"><y>#</y><d>2017-02-03</d><h>14:19</h><w>dazld</w>or 5xx</z><z id="t1486131586" t="mtnygard What are you getting now?"><y>#</y><d>2017-02-03</d><h>14:19</h><w>mtnygard</w>What are you getting now?</z><z id="t1486131768" t="dazld 200"><y>#</y><d>2017-02-03</d><h>14:22</h><w>dazld</w>200</z><z id="t1486131788" t="mtnygard That does seem odd."><y>#</y><d>2017-02-03</d><h>14:23</h><w>mtnygard</w>That does seem odd.</z><z id="t1486131796" t="dazld on validate for example"><y>#</y><d>2017-02-03</d><h>14:23</h><w>dazld</w>on validate for example</z><z id="t1486131798" t="dazld or user"><y>#</y><d>2017-02-03</d><h>14:23</h><w>dazld</w>or user</z><z id="t1486131801" t="dazld get/post"><y>#</y><d>2017-02-03</d><h>14:23</h><w>dazld</w>get/post</z><z id="t1486137710" t="tetriscodes Anyone have Swagger working with pedestal?"><y>#</y><d>2017-02-03</d><h>16:01</h><w>tetriscodes</w>Anyone have Swagger working with pedestal?</z><z id="t1486137720" t="tetriscodes With spec instead of schema"><y>#</y><d>2017-02-03</d><h>16:02</h><w>tetriscodes</w>With spec instead of schema</z><z id="t1486137728" t="tetriscodes Similar to this: https://github.com/nubank/pedestal-swagger"><y>#</y><d>2017-02-03</d><h>16:02</h><w>tetriscodes</w>Similar to this: <a href="https://github.com/nubank/pedestal-swagger" target="_blank">https://github.com/nubank/pedestal-swagger</a></z><z id="t1486138978" t="mtnygard [:attrs {:href &quot;/_/_/users/U0F7UF5U1&quot;}] I have a client using pedestal-api, but none with pedestal-swagger."><y>#</y><d>2017-02-03</d><h>16:22</h><w>mtnygard</w><a>@tetriscodes</a> I have a client using pedestal-api, but none with pedestal-swagger.</z><z id="t1486139644" t="ikitommi the pedestal-swagger is fork from route-swagger which uses ring-swagger and is used by pedestal-api, which is the most up-to-date impl for pedestal."><y>#</y><d>2017-02-03</d><h>16:34</h><w>ikitommi</w>the pedestal-swagger is fork from route-swagger which uses ring-swagger and is used by pedestal-api, which is the most up-to-date impl for pedestal.</z><z id="t1486139704" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] I might need a diagram to follow that chain."><y>#</y><d>2017-02-03</d><h>16:35</h><w>mtnygard</w><a>@ikitommi</a> I might need a diagram to follow that chain.</z><z id="t1486140122" t="ikitommi haha. We have done the ring-swagger and now porting it for spec with same api for routing libs ( https://github.com/metosin/spec-swagger ). Waiting for spec internals to cool down. Should work with pedestal-api nicely. Haven&apos;t talked with Frankie about his plans with pedestal-api thou."><y>#</y><d>2017-02-03</d><h>16:42</h><w>ikitommi</w>haha. We have done the ring-swagger and now porting it for spec with same api for routing libs (<a href="https://github.com/metosin/spec-swagger" target="_blank">https://github.com/metosin/spec-swagger</a>). Waiting for spec internals to cool down. Should work with pedestal-api nicely. Haven&apos;t talked with Frankie about his plans with pedestal-api thou.</z><z id="t1486140425" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] Very cool! I&apos;ll be keeping my eye on that"><y>#</y><d>2017-02-03</d><h>16:47</h><w>mtnygard</w><a>@ikitommi</a> Very cool! I&apos;ll be keeping my eye on that</z><z id="t1486141048" t="tetriscodes [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] nice!"><y>#</y><d>2017-02-03</d><h>16:57</h><w>tetriscodes</w><a>@ikitommi</a> nice!</z><z id="t1487010309" t="mtnygard If anyone is using Vase, we just added a new literal: #vase/conform. Takes some data out of the context, conforms it to a spec, and reattaches it (possibly at a different key)"><y>#</y><d>2017-02-13</d><h>18:25</h><w>mtnygard</w>If anyone is using Vase, we just added a new literal: #vase/conform. Takes some data out of the context, conforms it to a spec, and reattaches it (possibly at a different key)</z><z id="t1487010348" t="mtnygard It’s only available on master for a little while. Feedback appreciated."><y>#</y><d>2017-02-13</d><h>18:25</h><w>mtnygard</w>It’s only available on master for a little while. Feedback appreciated.</z><z id="t1487012888" t="mtnygard Odd wording on my last message. I didn’t mean to make it sound like the new feature would go away. I meant that for now, it’s not in a release or snapshot jar. Just on master."><y>#</y><d>2017-02-13</d><h>19:08</h><w>mtnygard</w>Odd wording on my last message. I didn’t mean to make it sound like the new feature would go away. I meant that for now, it’s not in a release or snapshot jar. Just on master.</z><z id="t1487038044" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I find vase really interesting. It&apos;s super convenient to build fast backend API backend by datomic. I will try it out soon this week 😄"><y>#</y><d>2017-02-14</d><h>02:07</h><w>jimmy</w><a>@mtnygard</a> I find vase really interesting. It&apos;s super convenient to build fast backend API backend by datomic. I will try it out soon this week <b>😄</b></z><z id="t1487098378" t="ikitommi [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] have you thought of conforming with different wire formats as JSON &amp; Transit have different capabilities for presenting data.. Haven’t seen that (runtime conforming) part on the spec roadmap. Here’s something we are doing for it: https://gist.github.com/ikitommi/fb3e0200504dd8b635ed7edd0cdbc768#runtime-coercion ."><y>#</y><d>2017-02-14</d><h>18:52</h><w>ikitommi</w><a>@mtnygard</a> have you thought of conforming with different wire formats as JSON &amp; Transit have different capabilities for presenting data.. Haven’t seen that (runtime conforming) part on the spec roadmap. Here’s something we are doing for it: <a href="https://gist.github.com/ikitommi/fb3e0200504dd8b635ed7edd0cdbc768#runtime-coercion" target="_blank">https://gist.github.com/ikitommi/fb3e0200504dd8b635ed7edd0cdbc768#runtime-coercion</a>.</z><z id="t1487098606" t="ddeaguiar I think conformance and coercion are two different concepts but they can be related by using s/conformer . I think that strongly couples coercion to your spec definition, though. I could be mistaken."><y>#</y><d>2017-02-14</d><h>18:56</h><w>ddeaguiar</w>I think conformance and coercion are two different concepts but they can be related by using <code>s/conformer</code>. I think that strongly couples coercion to your spec definition, though. I could be mistaken.</z><z id="t1487099435" t="ikitommi Problem is that there is no coercion in spec. I’m using a special conformer, which doesn’t transform anything by default, only if you tell it to (do JSON or String -conversions). Another way would be to take a spec and transform it into a differently conforming spec, e.g. User -&gt; UserJSON , UserString . Currently not 100% proof due to the global spec registry. But something needs to be done IMO. I would be glad if I could toss away my current code for this."><y>#</y><d>2017-02-14</d><h>19:10</h><w>ikitommi</w>Problem is that there is no coercion in spec. I’m using a special conformer, which doesn’t transform anything by default, only if you tell it to (do JSON or String -conversions). Another way would be to take a spec and transform it into a differently conforming spec, e.g. <code>User</code> -&gt; <code>UserJSON</code>, <code>UserString</code>. Currently not 100% proof due to the global spec registry. But something needs to be done IMO. I would be glad if I could toss away my current code for this.</z><z id="t1487109260" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] Are you talking about this in the context of Pedestal in general or of Vase specifically?"><y>#</y><d>2017-02-14</d><h>21:54</h><w>mtnygard</w><a>@ikitommi</a> Are you talking about this in the context of Pedestal in general or of Vase specifically?</z><z id="t1487140658" t="ikitommi [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] well I picked that pushed conforming into Vase, but I think the problem applies for all Clojure http libs/apps."><y>#</y><d>2017-02-15</d><h>06:37</h><w>ikitommi</w><a>@mtnygard</a> well I picked that pushed conforming into Vase, but I think the problem applies for all Clojure http libs/apps.</z><z id="t1487238609" t="jimmy regarding vase, if we want to use internal eid in query, is there anyway we can use datomic/pull api ?"><y>#</y><d>2017-02-16</d><h>09:50</h><w>jimmy</w>regarding vase, if we want to use internal eid in query, is there anyway we can use datomic/pull api ?</z><z id="t1487342825" t="oconn Hey all. I&apos;m pretty new to pedestal and I&apos;m working on adding authorization to my routes. I was wondering if there was an easy way to solve the following; I have an interceptor that adds permitted roles to context, and then I have an interceptor, :authorization/check-roles , that checks if the current user&apos;s roles match any of the permitted roles. The problem I&apos;m running into is finding a way to dynamically add ::check-roles prior to the handler in the execution queue. I&apos;ve tried using io.pedestal.interceptor.chain.enqueue but this will add my ::check-roles interceptor after my handler. Is there an intuitive way to add an interceptor prior to the handler? Is it ok to modify {:route {:interceptors [...]}} and say add my interceptor right before the handler?"><y>#</y><d>2017-02-17</d><h>14:47</h><w>oconn</w>Hey all. I&apos;m pretty new to pedestal and I&apos;m working on adding authorization to my routes. I was wondering if there was an easy way to solve the following; I have an interceptor that adds permitted roles to context, and then I have an interceptor, <code>:authorization/check-roles</code>, that checks if the current user&apos;s roles match any of the permitted roles. The problem I&apos;m running into is finding a way to dynamically add <code>::check-roles</code> prior to the handler in the execution queue. I&apos;ve tried using <code>io.pedestal.interceptor.chain.enqueue</code> but this will add my <code>::check-roles</code> interceptor after my handler. Is there an intuitive way to add an interceptor prior to the handler? Is it ok to modify <code>{:route {:interceptors [...]}}</code> and say add my interceptor right before the handler?</z><z id="t1487345249" t="henriklundahl [:attrs {:href &quot;/_/_/users/U1APR44RE&quot;}] Can&apos;t you always have the authorization interceptor in the chain?"><y>#</y><d>2017-02-17</d><h>15:27</h><w>henriklundahl</w><a>@oconn</a> Can&apos;t you always have the authorization interceptor in the chain?</z><z id="t1487345422" t="oconn So I add :authorization/authorize to specific routes and pass in a role set. The problem I’m facing is when I have a route that is nested under that route that adds additional permissions"><y>#</y><d>2017-02-17</d><h>15:30</h><w>oconn</w>So I add <code>:authorization/authorize</code> to specific routes and pass in a role set. The problem I’m facing is when I have a route that is nested under that route that adds additional permissions</z><z id="t1487345608" t="oconn thats where ::check-roles was supposed to come into play and check the permissions that have accumulated prior to passing the request off to the handler"><y>#</y><d>2017-02-17</d><h>15:33</h><w>oconn</w>thats where <code>::check-roles</code> was supposed to come into play and check the permissions that have accumulated prior to passing the request off to the handler</z><z id="t1487345700" t="oconn But now that you mention it, is there a simple way to always include ::check-roles right before the handler for each route? I’m using the terse syntax if that makes a difference."><y>#</y><d>2017-02-17</d><h>15:35</h><w>oconn</w>But now that you mention it, is there a simple way to always include <code>::check-roles</code> right before the handler for each route? I’m using the terse syntax if that makes a difference.</z><z id="t1487345788" t="oconn [:attrs {:href &quot;/_/_/users/U0DMF8EPQ&quot;}]"><y>#</y><d>2017-02-17</d><h>15:36</h><w>oconn</w><a>@henriklundahl</a></z><z id="t1487348902" t="henriklundahl [:attrs {:href &quot;/_/_/users/U1APR44RE&quot;}] , I believe I don&apos;t understand the setup. When are the roles the user has determined? When are the roles required for being authorized to make the request determined?"><y>#</y><d>2017-02-17</d><h>16:28</h><w>henriklundahl</w><a>@oconn</a>, I believe I don&apos;t understand the setup. When are the roles the user has determined? When are the roles required for being authorized to make the request determined?</z><z id="t1487350278" t="oconn [:attrs {:href &quot;/_/_/users/U0DMF8EPQ&quot;}] https://gist.github.com/oconn/c38c4c6dfcfa7a98b195ac8ffe423898"><y>#</y><d>2017-02-17</d><h>16:51</h><w>oconn</w><a>@henriklundahl</a> <a href="https://gist.github.com/oconn/c38c4c6dfcfa7a98b195ac8ffe423898" target="_blank">https://gist.github.com/oconn/c38c4c6dfcfa7a98b195ac8ffe423898</a></z><z id="t1487350595" t="oconn This may be a problem that could be solved by reorganizing my routes or tackling the problem differently.. but I’d thought I’d ask and see if there was an easy way to support this."><y>#</y><d>2017-02-17</d><h>16:56</h><w>oconn</w>This may be a problem that could be solved by reorganizing my routes or tackling the problem differently..  but I’d thought I’d ask and see if there was an easy way to support this.</z><z id="t1487355521" t="henriklundahl [:attrs {:href &quot;/_/_/users/U1APR44RE&quot;}] , ok, I understand now. I&apos;m not sure, but I think that if you add an interceptor after the router, it will be called after the router but before the handler (in the enter stage)."><y>#</y><d>2017-02-17</d><h>18:18</h><w>henriklundahl</w><a>@oconn</a>, ok, I understand now. I&apos;m not sure, but I think that if you add an interceptor after the router,  it will be called after the router but before the handler (in the enter stage).</z><z id="t1487355724" t="oconn cool, I’ll give that a shot"><y>#</y><d>2017-02-17</d><h>18:22</h><w>oconn</w>cool, I’ll give that a shot</z><z id="t1487355727" t="oconn thanks"><y>#</y><d>2017-02-17</d><h>18:22</h><w>oconn</w>thanks</z><z id="t1487847752" t="rui.yang hi, are there some examples of testing the pedestal application? eg. how to mock the db, how to mock a handler"><y>#</y><d>2017-02-23</d><h>11:02</h><w>rui.yang</w>hi, are there some examples of testing the pedestal application? eg. how to mock the db, how to mock a handler</z><z id="t1487864862" t="donaldball We use http://pedestal.io/api/pedestal.service/io.pedestal.test.html#var-response-for to test issuing http requests against a pedestal app"><y>#</y><d>2017-02-23</d><h>15:47</h><w>donaldball</w>We use <a href="http://pedestal.io/api/pedestal.service/io.pedestal.test.html#var-response-for" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.test.html#var-response-for</a> to test issuing http requests against a pedestal app</z><z id="t1487864939" t="donaldball We use component to build our system and build it with in-memory protocol impls or separate instances of e.g. sql databases in our integrated tests"><y>#</y><d>2017-02-23</d><h>15:48</h><w>donaldball</w>We use component to build our system and build it with in-memory protocol impls or separate instances of e.g. sql databases in our integrated tests</z><z id="t1488014968" t="kirill.salykin Hi all, I am using pedestal based on Stuart Sierra component. Basically it is only 2 components now: Pedestal and Datomic. I am trying to inject datomic connection to intercepctors chain. But I keep getting this error: &quot;You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?&quot; (defrecord Pedestal [service-map service db] component/Lifecycle (start [component] (print (str &quot;DB:&quot; db)) (if service component (-&gt; service-map (assoc :http/routes (routes/routes db)) http/create-server http/start (assoc component :service)))) (stop [component] (when service (http/stop service)) (assoc component :service nil))) (defn routes [db-component] (let [session-inter (session {:store (cookie/cookie-store)}) conn (:conn db-component) attach-conn (attach-to-request :conn conn)] (route/expand-routes #{ [&quot;/&quot; :get [attach-conn session-inter authenticate guard &apos;root]] [&quot;/sign-up&quot; :get [attach-conn session-inter &apos;show-sign-up]] [&quot;/sign-up&quot; :post [attach-conn session-inter (body-params) keyword-params &apos;sign-up]] [&quot;/sign-in&quot; :get [attach-conn session-inter &apos;show-sign-in]] [&quot;/sign-in&quot; :post [attach-conn session-inter (body-params) keyword-params &apos;sign-in]] }))) (defn attach-to-request [name obj] (interceptor {:name ::attach-to-req :enter (fn [ctx] (assoc-in ctx [:request name] obj))})) Please advice what I am doing wrong. Thanks!"><y>#</y><d>2017-02-25</d><h>09:29</h><w>kirill.salykin</w>Hi all,

I am using pedestal based on Stuart Sierra component. Basically it is only 2 components now: Pedestal and Datomic.

I am trying to inject datomic connection to intercepctors chain.

But I keep getting this error: &quot;You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?&quot;

<pre>(defrecord Pedestal [service-map service db]
  component/Lifecycle
  (start [component]
    (print (str &quot;DB:&quot; db))
    (if service
      component
      (-&gt; service-map
          (assoc :http/routes (routes/routes db))
          http/create-server
          http/start
          (assoc component :service))))
  (stop [component]
    (when service (http/stop service))
    (assoc component :service nil)))
</pre>

<pre>(defn routes [db-component]
  (let [session-inter (session {:store (cookie/cookie-store)})
        conn (:conn db-component)
        attach-conn (attach-to-request :conn conn)]
    (route/expand-routes
     #{
       [&quot;/&quot;        :get  [attach-conn session-inter authenticate guard &apos;root]]
       [&quot;/sign-up&quot; :get  [attach-conn session-inter &apos;show-sign-up]]
       [&quot;/sign-up&quot; :post [attach-conn session-inter (body-params) keyword-params &apos;sign-up]]
       [&quot;/sign-in&quot; :get  [attach-conn session-inter &apos;show-sign-in]]
       [&quot;/sign-in&quot; :post [attach-conn session-inter (body-params) keyword-params &apos;sign-in]]
       })))
</pre>

<pre>(defn attach-to-request [name obj]
  (interceptor
   {:name ::attach-to-req
    :enter (fn [ctx]
               (assoc-in ctx [:request name] obj))}))
</pre>

Please advice what I am doing wrong.

Thanks!</z><z id="t1488018158" t="mavbozo [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] i suspect this line (assoc component :service)"><y>#</y><d>2017-02-25</d><h>10:22</h><w>mavbozo</w><a>@kirill.salykin</a> i suspect this line <code>(assoc component :service)</code></z><z id="t1488018202" t="mavbozo basically it will be expanded to (assoc (http/start ...) component service) while what you want is (assoc component :service (http/start ...))"><y>#</y><d>2017-02-25</d><h>10:23</h><w>mavbozo</w>basically it will be expanded to <code>(assoc (http/start ...) component service)</code> while what you want is <code>(assoc component :service (http/start ...))</code></z><z id="t1488018351" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] thanks!"><y>#</y><d>2017-02-25</d><h>10:25</h><w>kirill.salykin</w><a>@mavbozo</a> thanks!</z><z id="t1488018359" t="kirill.salykin looks like this is the reason"><y>#</y><d>2017-02-25</d><h>10:25</h><w>kirill.salykin</w>looks like this is the reason</z><z id="t1488018511" t="mavbozo I find it helpful for me to split the Pedestal component into 2 components: Pedestal Service component just for preparing the service map for Pedestal Server component which is responsible for creating/starting/stopping the server"><y>#</y><d>2017-02-25</d><h>10:28</h><w>mavbozo</w>I find it helpful for me to split the Pedestal component into 2 components: Pedestal Service component just for preparing the service map for Pedestal Server component which is responsible for creating/starting/stopping the server</z><z id="t1488021367" t="kirill.salykin sounds interesting"><y>#</y><d>2017-02-25</d><h>11:16</h><w>kirill.salykin</w>sounds interesting</z><z id="t1488021379" t="kirill.salykin I also found pedestal component from Sierra"><y>#</y><d>2017-02-25</d><h>11:16</h><w>kirill.salykin</w>I also found pedestal component from Sierra</z><z id="t1488021385" t="kirill.salykin trying this now"><y>#</y><d>2017-02-25</d><h>11:16</h><w>kirill.salykin</w>trying this now</z><z id="t1488021387" t="kirill.salykin thanks for help!"><y>#</y><d>2017-02-25</d><h>11:16</h><w>kirill.salykin</w>thanks for help!</z><z id="t1488207606" t="crimeminister http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2017-02-27</d><h>15:00</h><w>crimeminister</w><a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1488207644" t="crimeminister [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] this might be helpful ^ (it was for me when I asked similar questions here)"><y>#</y><d>2017-02-27</d><h>15:00</h><w>crimeminister</w> <a>@kirill.salykin</a> this might be helpful ^ (it was for me when I asked similar questions here)</z><z id="t1488207713" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U066SF64X&quot;}] thanks!"><y>#</y><d>2017-02-27</d><h>15:01</h><w>kirill.salykin</w><a>@crimeminister</a> thanks!</z><z id="t1488286147" t="rui.yang hi, wonder if there is some examples of simulating multi-part form submission in testing pedestal application? eg. for testing file uploading. using pedestal&apos;s response-for macro."><y>#</y><d>2017-02-28</d><h>12:49</h><w>rui.yang</w>hi, wonder if there is some examples of simulating multi-part form submission in testing pedestal application? eg. for testing file uploading. using pedestal&apos;s response-for macro.</z><z id="t1488286664" t="kirill.salykin Hi, is it possible to use function to build routes? I am trying this: ::http/routes (build-routes) (defn build-routes (route/expand-routes #{[…]})) But facing this: You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it? {:t nil, :type nil} "><y>#</y><d>2017-02-28</d><h>12:57</h><w>kirill.salykin</w>Hi,

is it possible to use function to build routes?

I am trying this:

<pre>::http/routes (build-routes)

(defn build-routes
  (route/expand-routes #{[…]})) 
</pre>

But facing this: 
<pre>You&apos;re trying to use something as an interceptor
that isn&apos;t supported by the protocol; Perhaps you need to extend it? {:t nil, :type nil}
</pre></z><z id="t1488289589" t="kirill.salykin Is it good approach to build routes this way? (def route-table #{[&quot;/&quot; :get [&apos;pages/root]] [&quot;/sign-up&quot; :get [&apos;pages/show-sign-up]] [&quot;/sign-up&quot; :post [&apos;pages/sign-up]] [&quot;/sign-in&quot; :get [&apos;pages/show-sign-in]] [&quot;/sign-in&quot; :post [&apos;pages/sign-in]]}) (def common-interceptors [http/html-body (using-component :db) (session {:store (cookie/cookie-store {:key &quot;some-key12345678&quot;})})]) (defn build-interceptors [verb interceptors] (let [interceptors (apply conj common-interceptors interceptors)] (if (= verb :get) interceptors (into [(body-params) keyword-params] interceptors)))) (defn browser-stack [[path verb interceptors]] [path verb (build-interceptors verb interceptors)]) (def routes (route/expand-routes (into #{} (map browser-stack route-table)))) "><y>#</y><d>2017-02-28</d><h>13:46</h><w>kirill.salykin</w>Is it good approach to build routes this way?

<pre>(def route-table
  #{[&quot;/&quot;        :get  [&apos;pages/root]]
    [&quot;/sign-up&quot; :get  [&apos;pages/show-sign-up]]
    [&quot;/sign-up&quot; :post [&apos;pages/sign-up]]
    [&quot;/sign-in&quot; :get  [&apos;pages/show-sign-in]]
    [&quot;/sign-in&quot; :post [&apos;pages/sign-in]]})


(def common-interceptors
  [http/html-body
   (using-component :db)
   (session {:store (cookie/cookie-store {:key &quot;some-key12345678&quot;})})])

(defn build-interceptors [verb interceptors]
  (let [interceptors (apply conj common-interceptors interceptors)]
    (if (= verb :get)
      interceptors
      (into [(body-params) keyword-params] interceptors))))

(defn browser-stack [[path verb interceptors]]
  [path verb (build-interceptors verb interceptors)])

(def routes
  (route/expand-routes (into #{} (map browser-stack route-table))))
</pre></z><z id="t1488290110" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] there&apos;s nothing wrong with building your routes programmatically, although given your example, I&apos;d build the route-table explicitly. IMO it would be easier to reason about"><y>#</y><d>2017-02-28</d><h>13:55</h><w>ddeaguiar</w><a>@kirill.salykin</a> there&apos;s nothing wrong with building your routes programmatically, although given your example, I&apos;d build the route-table explicitly. IMO it would be easier to reason about</z><z id="t1488290186" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] re: the error you&apos;re seeing, it may be due to how you refer to your handlers in the route table. Try using back-ticks instead of single quotes"><y>#</y><d>2017-02-28</d><h>13:56</h><w>ddeaguiar</w><a>@kirill.salykin</a> re: the error you&apos;re seeing, it may be due to how you refer to your handlers in the route table. Try using back-ticks instead of single quotes</z><z id="t1488290205" t="ddeaguiar the symbols need to be fully qualified"><y>#</y><d>2017-02-28</d><h>13:56</h><w>ddeaguiar</w>the symbols need to be fully qualified</z><z id="t1488290207" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks for response Thought it makes no sens to repeat (body-params) etc"><y>#</y><d>2017-02-28</d><h>13:56</h><w>kirill.salykin</w><a>@ddeaguiar</a> thanks for response
Thought it makes no sens to repeat (body-params)  etc</z><z id="t1488290249" t="kirill.salykin I see this error only when I am trying to implemet routes as function defn routes []"><y>#</y><d>2017-02-28</d><h>13:57</h><w>kirill.salykin</w>I see this error only when I am trying to implemet routes as function <code>defn routes []</code></z><z id="t1488290256" t="ddeaguiar you can capture the common get interceptors in a var if you like"><y>#</y><d>2017-02-28</d><h>13:57</h><w>ddeaguiar</w>you can capture the common get interceptors in a var if you like</z><z id="t1488290289" t="ddeaguiar but that&apos;s a matter of taste"><y>#</y><d>2017-02-28</d><h>13:58</h><w>ddeaguiar</w>but that&apos;s a matter of taste</z><z id="t1488290323" t="ddeaguiar again, nothing wrong with programmatically building the routes"><y>#</y><d>2017-02-28</d><h>13:58</h><w>ddeaguiar</w>again, nothing wrong with programmatically building the routes</z><z id="t1488290336" t="kirill.salykin thanks!"><y>#</y><d>2017-02-28</d><h>13:58</h><w>kirill.salykin</w>thanks!</z><z id="t1488290879" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] also, you don&apos;t need to call route/expand-routes"><y>#</y><d>2017-02-28</d><h>14:07</h><w>ddeaguiar</w><a>@kirill.salykin</a> also, you don&apos;t need to call <code>route/expand-routes</code></z><z id="t1488290911" t="kirill.salykin pedestal will do it for me because set used?"><y>#</y><d>2017-02-28</d><h>14:08</h><w>kirill.salykin</w>pedestal will do it for me because set used?</z><z id="t1488290947" t="ddeaguiar yeah"><y>#</y><d>2017-02-28</d><h>14:09</h><w>ddeaguiar</w>yeah</z><z id="t1488291015" t="ddeaguiar so I suspect what&apos;s happening is that the verbose route map produced by expand routes is trying to be expanded again by Pedestal&apos;s internals"><y>#</y><d>2017-02-28</d><h>14:10</h><w>ddeaguiar</w>so I suspect what&apos;s happening is that the verbose route map produced by expand routes is trying to be expanded again by Pedestal&apos;s internals</z><z id="t1488291024" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L355"><y>#</y><d>2017-02-28</d><h>14:10</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L355" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L355</a></z><z id="t1488291337" t="mtnygard [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] The message you&apos;re getting includes the value and type that Pedestal is trying to convert to an interceptor. The value is nil, so I suspect that your interceptor vector after browser-stack may have some issues. Can you print the value of the set after (into #{} (map browser-stack route-table)) ?"><y>#</y><d>2017-02-28</d><h>14:15</h><w>mtnygard</w><a>@kirill.salykin</a> The message you&apos;re getting includes the value and type that Pedestal is trying to convert to an interceptor. The value is nil, so I suspect that your interceptor vector after browser-stack may have some issues. Can you print the value of the set after <code>(into #{} (map browser-stack route-table))</code>?</z><z id="t1488291423" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] everything works I am facing issue if I am trying to use this: (def routes (route/expand-routes (into #{} (map browser-stack route-table)))) as function, eg : (defn routes [] (route/expand-routes (into #{} (map browser-stack route-table)))) "><y>#</y><d>2017-02-28</d><h>14:17</h><w>kirill.salykin</w><a>@mtnygard</a> everything works

I am facing issue if I am trying to use this:
<pre>(def routes
  (route/expand-routes (into #{} (map browser-stack route-table))))
</pre>
as function, eg :
<pre>(defn routes []
  (route/expand-routes (into #{} (map browser-stack route-table))))
</pre></z><z id="t1488291457" t="mtnygard Gotcha. Can you show me your service-map declaration?"><y>#</y><d>2017-02-28</d><h>14:17</h><w>mtnygard</w>Gotcha. Can you show me your service-map declaration?</z><z id="t1488291491" t="kirill.salykin (defn build-routes [] (fn [] (doseq [ns-sym (modified-namespaces)] (require ns-sym :reload)) routes)) (def pedestal-config {::http/host &quot;0.0.0.0&quot; ::http/port 8080 ::http/type :jetty ::http/join? true ::http/resource-path &quot;/public&quot; ::http/routes (build-routes)}) "><y>#</y><d>2017-02-28</d><h>14:18</h><w>kirill.salykin</w><pre>(defn build-routes []
  (fn []
    (doseq [ns-sym (modified-namespaces)]
      (require ns-sym :reload))
    routes))

(def pedestal-config
  {::http/host &quot;0.0.0.0&quot;
   ::http/port 8080
   ::http/type :jetty
   ::http/join? true
   ::http/resource-path &quot;/public&quot;
   ::http/routes (build-routes)})
</pre></z><z id="t1488291500" t="kirill.salykin routes defined above"><y>#</y><d>2017-02-28</d><h>14:18</h><w>kirill.salykin</w>routes defined above</z><z id="t1488291555" t="mtnygard OK, so you&apos;re using build-routes to do auto refresh. When you use (defn routes ...), did you change the last expression in build-routes to be a call to the routes function?"><y>#</y><d>2017-02-28</d><h>14:19</h><w>mtnygard</w>OK, so you&apos;re using build-routes to do auto refresh. When you use (defn routes ...), did you change the last expression in build-routes to be a call to the routes function?</z><z id="t1488291578" t="kirill.salykin yes I used this version (defn build-routes [] (fn [] (doseq [ns-sym (modified-namespaces)] (require ns-sym :reload)) (routes))) "><y>#</y><d>2017-02-28</d><h>14:19</h><w>kirill.salykin</w>yes
I used this version

<pre>(defn build-routes []
  (fn []
    (doseq [ns-sym (modified-namespaces)]
      (require ns-sym :reload))
    (routes)))
</pre></z><z id="t1488291609" t="mtnygard It never hurts to check to obvious stuff. 🙂"><y>#</y><d>2017-02-28</d><h>14:20</h><w>mtnygard</w>It never hurts to check to obvious stuff. <b>🙂</b></z><z id="t1488291617" t="mtnygard Can you paste in the output of (build-routes) ?"><y>#</y><d>2017-02-28</d><h>14:20</h><w>mtnygard</w>Can you paste in the output of (build-routes) ?</z><z id="t1488291617" t="kirill.salykin of course"><y>#</y><d>2017-02-28</d><h>14:20</h><w>kirill.salykin</w>of course</z><z id="t1488291627" t="kirill.salykin give me couple minutes"><y>#</y><d>2017-02-28</d><h>14:20</h><w>kirill.salykin</w>give me couple minutes</z><z id="t1488291733" t="kirill.salykin #object[blog$build_routes$fn__16210 0x4aa430d9 &quot;blog$build_routes$fn__16210@4aa430d9&quot;]"><y>#</y><d>2017-02-28</d><h>14:22</h><w>kirill.salykin</w>#object[blog$build_routes$fn__16210 0x4aa430d9 &quot;blog$build_routes$fn__16210@4aa430d9&quot;]</z><z id="t1488291847" t="mtnygard Well that&apos;s not terribly helpful..."><y>#</y><d>2017-02-28</d><h>14:24</h><w>mtnygard</w>Well that&apos;s not terribly helpful...</z><z id="t1488291851" t="kirill.salykin sorry 😞"><y>#</y><d>2017-02-28</d><h>14:24</h><w>kirill.salykin</w>sorry <b>😞</b></z><z id="t1488291869" t="mtnygard How about the output of ((build-routes))?"><y>#</y><d>2017-02-28</d><h>14:24</h><w>mtnygard</w>How about the output of ((build-routes))?</z><z id="t1488291950" t="kirill.salykin clojure.lang.ExceptionInfo: You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?"><y>#</y><d>2017-02-28</d><h>14:25</h><w>kirill.salykin</w>clojure.lang.ExceptionInfo: You&apos;re trying to use something as an interceptor
                                                       that isn&apos;t supported by the protocol; Perhaps you need to extend it?</z><z id="t1488291967" t="mtnygard ah."><y>#</y><d>2017-02-28</d><h>14:26</h><w>mtnygard</w>ah.</z><z id="t1488292064" t="mtnygard So then the problem is definitely with the data structure being passed to expand-routes. Can you show me the output of (into #{} (map browser-stack route-table))"><y>#</y><d>2017-02-28</d><h>14:27</h><w>mtnygard</w>So then the problem is definitely with the data structure being passed to expand-routes. Can you show me the output of <code> (into #{} (map browser-stack route-table))</code></z><z id="t1488292065" t="mtnygard ?"><y>#</y><d>2017-02-28</d><h>14:27</h><w>mtnygard</w>?</z><z id="t1488292129" t="kirill.salykin all route related declared in blog.web.routes when I calling (route) being in blog.web.routes this is returned: ({:path &quot;/sign-in&quot;, :method :get, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-in, :path-params []} {:path &quot;/sign-in&quot;, :method :post, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-in, :path-params []} {:path &quot;/sign-up&quot;, :method :post, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-up, :path-params []} {:path &quot;/sign-up&quot;, :method :get, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-up, :path-params []} {:path &quot;/&quot;, :method :get, :path-re #&quot;/\Q\E&quot;, :path-parts [&quot;&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/root, :path-params []}) "><y>#</y><d>2017-02-28</d><h>14:28</h><w>kirill.salykin</w>all route related declared in blog.web.routes

when I calling (route) being in blog.web.routes

this is returned:
<pre>({:path &quot;/sign-in&quot;, :method :get, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-in, :path-params []} {:path &quot;/sign-in&quot;, :method :post, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-in, :path-params []} {:path &quot;/sign-up&quot;, :method :post, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-up, :path-params []} {:path &quot;/sign-up&quot;, :method :get, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-up, :path-params []} {:path &quot;/&quot;, :method :get, :path-re #&quot;/\Q\E&quot;, :path-parts [&quot;&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/root, :path-params []})
</pre></z><z id="t1488292190" t="kirill.salykin but, when invoking ((build-routes) being in blog namespace having this declaration [blog.web.routes :refer [routes] everything breaks"><y>#</y><d>2017-02-28</d><h>14:29</h><w>kirill.salykin</w>but, when invoking ((build-routes) being in <code>blog</code> namespace having this declaration <code>[blog.web.routes :refer [routes]</code> everything breaks</z><z id="t1488292197" t="kirill.salykin can it be some name overlap?"><y>#</y><d>2017-02-28</d><h>14:29</h><w>kirill.salykin</w>can it be some name overlap?</z><z id="t1488292225" t="mtnygard Maybe ... I&apos;d need to see more of the code to know if that&apos;s the case."><y>#</y><d>2017-02-28</d><h>14:30</h><w>mtnygard</w>Maybe ... I&apos;d need to see more of the code to know if that&apos;s the case.</z><z id="t1488292231" t="mtnygard There is something odd about those routes though."><y>#</y><d>2017-02-28</d><h>14:30</h><w>mtnygard</w>There is something odd about those routes though.</z><z id="t1488292240" t="kirill.salykin I’ll push it to github a bit later"><y>#</y><d>2017-02-28</d><h>14:30</h><w>kirill.salykin</w>I’ll push it to github a bit later</z><z id="t1488292249" t="mtnygard The last interceptor in each vector just says #Interceptor {:name}."><y>#</y><d>2017-02-28</d><h>14:30</h><w>mtnygard</w>The last interceptor in each vector just says #Interceptor {:name}.</z><z id="t1488292266" t="mtnygard In your original table, were you using symbols or syntax-quoted names?"><y>#</y><d>2017-02-28</d><h>14:31</h><w>mtnygard</w>In your original table, were you using symbols or syntax-quoted names?</z><z id="t1488292294" t="kirill.salykin syntax quoted"><y>#</y><d>2017-02-28</d><h>14:31</h><w>kirill.salykin</w>syntax quoted</z><z id="t1488292307" t="mtnygard With backticks?"><y>#</y><d>2017-02-28</d><h>14:31</h><w>mtnygard</w>With backticks?</z><z id="t1488292328" t="kirill.salykin let me recheck, i have a feeling that i’ve used just ‘ symbol"><y>#</y><d>2017-02-28</d><h>14:32</h><w>kirill.salykin</w>let me recheck, i have a feeling that i’ve used just ‘ symbol</z><z id="t1488292343" t="kirill.salykin everything works"><y>#</y><d>2017-02-28</d><h>14:32</h><w>kirill.salykin</w>everything works</z><z id="t1488292345" t="kirill.salykin thanks"><y>#</y><d>2017-02-28</d><h>14:32</h><w>kirill.salykin</w>thanks</z><z id="t1488292346" t="mtnygard A backtick would make Pedestal pick up the interceptor name from the var name."><y>#</y><d>2017-02-28</d><h>14:32</h><w>mtnygard</w>A backtick would make Pedestal pick up the interceptor name from the var name.</z><z id="t1488292351" t="mtnygard Oh, that fixed it?"><y>#</y><d>2017-02-28</d><h>14:32</h><w>mtnygard</w>Oh, that fixed it?</z><z id="t1488292353" t="mtnygard Wow."><y>#</y><d>2017-02-28</d><h>14:32</h><w>mtnygard</w>Wow.</z><z id="t1488292356" t="kirill.salykin I am so sorry for this stupid error 😞"><y>#</y><d>2017-02-28</d><h>14:32</h><w>kirill.salykin</w>I am so sorry for this stupid error <b>😞</b></z><z id="t1488292361" t="kirill.salykin thanks a lot!"><y>#</y><d>2017-02-28</d><h>14:32</h><w>kirill.salykin</w>thanks a lot!</z><z id="t1488292377" t="mtnygard Kudos to [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] . He spotted that a while ago."><y>#</y><d>2017-02-28</d><h>14:32</h><w>mtnygard</w>Kudos to <a>@ddeaguiar</a>. He spotted that a while ago.</z><z id="t1488292405" t="kirill.salykin but last-interceptor still has empty name"><y>#</y><d>2017-02-28</d><h>14:33</h><w>kirill.salykin</w>but last-interceptor still has empty name</z><z id="t1488292420" t="kirill.salykin ((build-routes)) ({:path &quot;/sign-up&quot;, :method :get, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-up, :path-params []} {:path &quot;/sign-up&quot;, :method :post, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-up, :path-params []} {:path &quot;/sign-in&quot;, :method :post, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-in, :path-params []} {:path &quot;/sign-in&quot;, :method :get, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-in, :path-params []} {:path &quot;/&quot;, :method :get, :path-re #&quot;/\Q\E&quot;, :path-parts [&quot;&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/root, :path-params []}) "><y>#</y><d>2017-02-28</d><h>14:33</h><w>kirill.salykin</w><pre>((build-routes))
({:path &quot;/sign-up&quot;, :method :get, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-up, :path-params []} {:path &quot;/sign-up&quot;, :method :post, :path-re #&quot;/\Qsign-up\E&quot;, :path-parts [&quot;sign-up&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-up, :path-params []} {:path &quot;/sign-in&quot;, :method :post, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/sign-in, :path-params []} {:path &quot;/sign-in&quot;, :method :get, :path-re #&quot;/\Qsign-in\E&quot;, :path-parts [&quot;sign-in&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/show-sign-in, :path-params []} {:path &quot;/&quot;, :method :get, :path-re #&quot;/\Q\E&quot;, :path-parts [&quot;&quot;], :interceptors [#Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name :io.pedestal.http.ring-middlewares/session} #Interceptor{:name :blog.system.pedestal/using-component} #Interceptor{:name :io.pedestal.http.params/keyword-params} #Interceptor{:name }], :route-name :blog.web.pages/root, :path-params []})
</pre></z><z id="t1488292436" t="ddeaguiar hmm no they don&apos;t"><y>#</y><d>2017-02-28</d><h>14:33</h><w>ddeaguiar</w>hmm no they don&apos;t</z><z id="t1488292441" t="ddeaguiar oh wait"><y>#</y><d>2017-02-28</d><h>14:34</h><w>ddeaguiar</w>oh wait</z><z id="t1488292444" t="ddeaguiar yes"><y>#</y><d>2017-02-28</d><h>14:34</h><w>ddeaguiar</w>yes</z><z id="t1488292480" t="ddeaguiar that&apos;s the handler, though"><y>#</y><d>2017-02-28</d><h>14:34</h><w>ddeaguiar</w>that&apos;s the handler, though</z><z id="t1488292486" t="kirill.salykin yes"><y>#</y><d>2017-02-28</d><h>14:34</h><w>kirill.salykin</w>yes</z><z id="t1488292516" t="mtnygard Ah, I see what&apos;s happening. `pages/root gets turned into the fully-qualified symbol. If you had that directly in your route table it would still be a symbol when Pedestal turned it into an interceptor."><y>#</y><d>2017-02-28</d><h>14:35</h><w>mtnygard</w>Ah, I see what&apos;s happening. `pages/root gets turned into the fully-qualified symbol. If you had that directly in your route table it would still be a symbol when Pedestal turned it into an interceptor.</z><z id="t1488292559" t="mtnygard Hrm, nevermind... I was on the wrong track there."><y>#</y><d>2017-02-28</d><h>14:35</h><w>mtnygard</w>Hrm, nevermind... I was on the wrong track there.</z><z id="t1488292609" t="mtnygard I&apos;m glad it&apos;s working. I&apos;d be happy to take a closer look at the interceptor name thing later on when you&apos;ve posted the code."><y>#</y><d>2017-02-28</d><h>14:36</h><w>mtnygard</w>I&apos;m glad it&apos;s working. I&apos;d be happy to take a closer look at the interceptor name thing later on when you&apos;ve posted the code.</z><z id="t1488292634" t="kirill.salykin sure, thanks a lot [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] and [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2017-02-28</d><h>14:37</h><w>kirill.salykin</w>sure, thanks a lot <a>@ddeaguiar</a> and <a>@mtnygard</a></z><z id="t1488292649" t="ddeaguiar np 🙂"><y>#</y><d>2017-02-28</d><h>14:37</h><w>ddeaguiar</w>np <b>🙂</b></z><z id="t1488545993" t="julianwegkamp Are there examples of handling authentication with pedestal?"><y>#</y><d>2017-03-03</d><h>12:59</h><w>julianwegkamp</w>Are there examples of handling authentication with pedestal?</z><z id="t1488549462" t="mtnygard [:attrs {:href &quot;/_/_/users/U051S1QM3&quot;}] I know some people have had success using Buddy from a Pedestal service. Buddy-auth uses Ring middleware, but it&apos;s trivial to turn that into an interceptor. You might get some milage out of http://rundis.github.io/blog/2015/buddy_auth_part2.html"><y>#</y><d>2017-03-03</d><h>13:57</h><w>mtnygard</w><a>@julianwegkamp</a> I know some people have had success using Buddy from a Pedestal service. Buddy-auth uses Ring middleware, but it&apos;s trivial to turn that into an interceptor.

You might get some milage out of <a href="http://rundis.github.io/blog/2015/buddy_auth_part2.html" target="_blank">http://rundis.github.io/blog/2015/buddy_auth_part2.html</a></z><z id="t1488549895" t="julianwegkamp Thx [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] . I will take a look at it."><y>#</y><d>2017-03-03</d><h>14:04</h><w>julianwegkamp</w>Thx <a>@mtnygard</a>. I will take a look at it.</z><z id="t1488549982" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U051S1QM3&quot;}] take a look at geheimtur as well. https://github.com/propan/geheimtur"><y>#</y><d>2017-03-03</d><h>14:06</h><w>ddeaguiar</w><a>@julianwegkamp</a> take a look at geheimtur as well. <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a></z><z id="t1488550025" t="ddeaguiar I’ve worked with both. Buddy requires some minor work to port middleware but it’s no big deal"><y>#</y><d>2017-03-03</d><h>14:07</h><w>ddeaguiar</w>I’ve worked with both. Buddy requires some minor work to port middleware but it’s no big deal</z><z id="t1488550038" t="ddeaguiar as [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] pointed out"><y>#</y><d>2017-03-03</d><h>14:07</h><w>ddeaguiar</w>as <a>@mtnygard</a> pointed out</z><z id="t1488550069" t="mtnygard Geheimtur is new to me. Will check it out, thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2017-03-03</d><h>14:07</h><w>mtnygard</w>Geheimtur is new to me. Will check it out, thanks <a>@ddeaguiar</a></z><z id="t1488550078" t="ddeaguiar np"><y>#</y><d>2017-03-03</d><h>14:07</h><w>ddeaguiar</w>np</z><z id="t1488550156" t="ddeaguiar IIRC, I preferred Buddy when working with JWT"><y>#</y><d>2017-03-03</d><h>14:09</h><w>ddeaguiar</w>IIRC, I preferred Buddy when working with JWT</z><z id="t1488550449" t="julianwegkamp Thx. It surprises me that there isn&apos;t a go-to solution for pedestal. Isn&apos;t (some form of) authentication a standard use case for a web application server?"><y>#</y><d>2017-03-03</d><h>14:14</h><w>julianwegkamp</w>Thx. It surprises me that there isn&apos;t a go-to solution for pedestal. Isn&apos;t (some form of) authentication a standard use case for a web application server?</z><z id="t1488550682" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U051S1QM3&quot;}] there was a recent discussion re: this in the pedestal-users mailing list. See https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk for Paul’s thoughts"><y>#</y><d>2017-03-03</d><h>14:18</h><w>ddeaguiar</w><a>@julianwegkamp</a> there was a recent discussion re: this in the pedestal-users mailing list. See <a href="https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk" target="_blank">https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk</a> for Paul’s thoughts</z><z id="t1488551010" t="julianwegkamp thx"><y>#</y><d>2017-03-03</d><h>14:23</h><w>julianwegkamp</w>thx</z><z id="t1488551217" t="ddeaguiar np"><y>#</y><d>2017-03-03</d><h>14:26</h><w>ddeaguiar</w>np</z><z id="t1488556710" t="julianwegkamp FYI I just added my 2 ct to the discussion in pedestal-users"><y>#</y><d>2017-03-03</d><h>15:58</h><w>julianwegkamp</w>FYI I just added my 2 ct to the discussion in pedestal-users</z><z id="t1488565905" t="baris Hi all, I’m playing with vase/pedestal. What’s the best way to coerce a json value to timestamp/edn-date/java.util.Date within a #vase/transact ? I&apos;m looking for sth like the :edn-coerce […] which is used by #vase/query . Do I really have to use an interceptor for all my edn values like #inst or #uuid within a #vase/transact ?"><y>#</y><d>2017-03-03</d><h>18:31</h><w>baris</w>Hi all,

I’m playing with vase/pedestal.

What’s the best way to coerce a json value to timestamp/edn-date/java.util.Date within a <code>#vase/transact</code>?
I&apos;m looking for sth like the <code>:edn-coerce […]</code> which is used by <code>#vase/query</code>.

Do I really have to use an interceptor for all my edn values like <code>#inst</code> or <code>#uuid</code> within a <code>#vase/transact</code>?</z><z id="t1488565949" t="baris Like the one in the petstore-full example?"><y>#</y><d>2017-03-03</d><h>18:32</h><w>baris</w>Like the one in the petstore-full example?</z><z id="t1488568310" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U0B7FJABW&quot;}] . I&apos;m glad you&apos;re giving Vase a try. I&apos;m going to dig in to your question together with Paul deGrandis (the main author). He&apos;s not on Slack so I&apos;ll come back with an answer in a while."><y>#</y><d>2017-03-03</d><h>19:11</h><w>mtnygard</w>Hi <a>@baris</a>. I&apos;m glad you&apos;re giving Vase a try. I&apos;m going to dig in to your question together with Paul deGrandis (the main author). He&apos;s not on Slack so I&apos;ll come back with an answer in a while.</z><z id="t1488568361" t="baris Thanks a lot [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2017-03-03</d><h>19:12</h><w>baris</w>Thanks a lot <a>@mtnygard</a></z><z id="t1488571407" t="mtnygard [:attrs {:href &quot;/_/_/users/U0B7FJABW&quot;}] It&apos;s definitely a limitation of the Transact literal right now. I&apos;ve entered issue https://github.com/cognitect-labs/vase/issues/45 to address that. It should accept EDN and Transit as well as JSON."><y>#</y><d>2017-03-03</d><h>20:03</h><w>mtnygard</w><a>@baris</a> It&apos;s definitely a limitation of the Transact literal right now. I&apos;ve entered issue <a href="https://github.com/cognitect-labs/vase/issues/45" target="_blank">https://github.com/cognitect-labs/vase/issues/45</a> to address that. It should accept EDN and Transit as well as JSON.</z><z id="t1488571596" t="baris [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] that would be a great enhancement. For the moment I’m using custom interceptors"><y>#</y><d>2017-03-03</d><h>20:06</h><w>baris</w><a>@mtnygard</a> that would be a great enhancement. For the moment I’m using custom interceptors</z><z id="t1488571669" t="mtnygard [:attrs {:href &quot;/_/_/users/U0B7FJABW&quot;}] You might also be able to use the #vase/conform interceptor to do the coercion. That way you don&apos;t have to write custom interceptors for each transaction."><y>#</y><d>2017-03-03</d><h>20:07</h><w>mtnygard</w><a>@baris</a> You might also be able to use the <code>#vase/conform</code> interceptor to do the coercion. That way you don&apos;t have to write custom interceptors for each transaction.</z><z id="t1488571875" t="baris [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks for the hint. I’ll check the #vase/conform capabilities"><y>#</y><d>2017-03-03</d><h>20:11</h><w>baris</w><a>@mtnygard</a> thanks for the hint. I’ll check the <code>#vase/conform</code> capabilities</z><z id="t1488805938" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks of addressing the problem. I got the same problem that vase doesn&apos;t accept edn and transit, I would love to see those support, it would make things a lot easier since we love transit 😄"><y>#</y><d>2017-03-06</d><h>13:12</h><w>jimmy</w><a>@mtnygard</a> thanks of addressing the problem. I got the same problem that vase doesn&apos;t accept edn and transit, I would love to see those support, it would make things a lot easier since we love transit <b>😄</b></z><z id="t1488810648" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Could you do me a favor and either comment or add a response to https://github.com/cognitect-labs/vase/issues/45 so we can get a sense of how many people are interested in this?"><y>#</y><d>2017-03-06</d><h>14:30</h><w>mtnygard</w><a>@nxqd</a> Could you do me a favor and either comment or add a response to <a href="https://github.com/cognitect-labs/vase/issues/45" target="_blank">https://github.com/cognitect-labs/vase/issues/45</a> so we can get a sense of how many people are interested in this?</z><z id="t1488813367" t="jimmy sure, I will"><y>#</y><d>2017-03-06</d><h>15:16</h><w>jimmy</w>sure, I will</z><z id="t1488897135" t="mtnygard Would anyone be interested in picking up one of the docs listed here: https://github.com/pedestal/pedestal-docs/issues ?"><y>#</y><d>2017-03-07</d><h>14:32</h><w>mtnygard</w>Would anyone be interested in picking up one of the docs listed here: <a href="https://github.com/pedestal/pedestal-docs/issues" target="_blank">https://github.com/pedestal/pedestal-docs/issues</a> ?</z><z id="t1488897536" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I volunteer to do #55"><y>#</y><d>2017-03-07</d><h>14:38</h><w>ddeaguiar</w><a>@mtnygard</a> I volunteer to do #55</z><z id="t1488897551" t="ddeaguiar I can pick up another after that"><y>#</y><d>2017-03-07</d><h>14:39</h><w>ddeaguiar</w>I can pick up another after that</z><z id="t1488897779" t="mtnygard Thank you!"><y>#</y><d>2017-03-07</d><h>14:42</h><w>mtnygard</w>Thank you!</z><z id="t1488904509" t="jimmy I&apos;mt not sure if I got the response from server (`#vase/transact` api ) : { &quot;whitelist&quot;: [], &quot;transaction&quot;: [ [ null, null, null ], [ null, null, null ], [ null, null, null ], [ null, null, null ] ] } But there is no data being created. I retry with the petstore-full example it returns the same. It supposes to return instead of those nulls right ?"><y>#</y><d>2017-03-07</d><h>16:35</h><w>jimmy</w>I&apos;mt not sure if I got the response from server (`#vase/transact` api ) :
<pre>{
  &quot;whitelist&quot;: [],
  &quot;transaction&quot;: [
    [
      null,
      null,
      null
    ],
    [
      null,
      null,
      null
    ],
    [
      null,
      null,
      null
    ],
    [
      null,
      null,
      null
    ]
  ]
}
</pre>

But there is no data being created. I retry with the petstore-full example it returns the same. It supposes to return instead of those nulls right ?</z><z id="t1488904559" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] You should definitely see some data in &quot;whitelist&quot; if the transaction went through. This can happen if you send a request without the content-type header."><y>#</y><d>2017-03-07</d><h>16:35</h><w>mtnygard</w><a>@nxqd</a> You should definitely see some data in &quot;whitelist&quot; if the transaction went through.

This can happen if you send a request without the content-type header.</z></g><g id="s3"><z id="t1489047433" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] regarding spec validation. I just realize that when we write spec for vase, we have to write spec to validate the whole stuff {:payload [::entity-maps]} instead of only for entity-map. I&apos;m not sure if this only happens when I include external specs ( those which are not defined in descriptor ) or not ? And I think this is worth mentioning in docs."><y>#</y><d>2017-03-09</d><h>08:17</h><w>jimmy</w><a>@mtnygard</a> regarding spec validation. I just realize that when we write spec for vase, we have to write spec to validate the whole stuff <code>{:payload [::entity-maps]}</code> instead of only for entity-map. I&apos;m not sure if this only happens when I include external specs ( those which are not defined in descriptor )  or not ? And I think this is worth mentioning in docs.</z><z id="t1489062786" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Yeah, that has more to do with the Transact action than where the specs are defined. If you were validating params to a Query, or using Conform to reshape the results of a query, then that wouldn&apos;t apply."><y>#</y><d>2017-03-09</d><h>12:33</h><w>mtnygard</w><a>@nxqd</a> Yeah, that has more to do with the Transact action than where the specs are defined. If you were validating params to a Query, or using Conform to reshape the results of a query, then that wouldn&apos;t apply.</z><z id="t1489089631" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] , following up on your offer to help at https://github.com/cognitect-labs/vase/issues/50 . Thanks!"><y>#</y><d>2017-03-09</d><h>20:00</h><w>deg</w><a>@mtnygard</a>, following up on your offer to help at <a href="https://github.com/cognitect-labs/vase/issues/50" target="_blank">https://github.com/cognitect-labs/vase/issues/50</a>. Thanks!</z><z id="t1489089676" t="mtnygard Welcome [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] !"><y>#</y><d>2017-03-09</d><h>20:01</h><w>mtnygard</w>Welcome <a>@deg</a>!</z><z id="t1489089695" t="deg So, it&apos;s not clear to me if I need to do any Datomic config to start using Vase. Or, can I just treat it as a black box for a while?"><y>#</y><d>2017-03-09</d><h>20:01</h><w>deg</w>So, it&apos;s not clear to me if I need to do any Datomic config to start using Vase. Or, can I just treat it as a black box for a while?</z><z id="t1489089740" t="mtnygard If you just want to use an in-memory database, then you don&apos;t have to download or run anything. Can you paste in the value of your :datomic-api key? That will tell us what &quot;storage&quot; you&apos;ll be using."><y>#</y><d>2017-03-09</d><h>20:02</h><w>mtnygard</w>If you just want to use an in-memory database, then you don&apos;t have to download or run anything.

Can you paste in the value of your <code>:datomic-api</code> key? That will tell us what &quot;storage&quot; you&apos;ll be using.</z><z id="t1489089800" t="deg From which file? A quick grep did not find it."><y>#</y><d>2017-03-09</d><h>20:03</h><w>deg</w>From which file?  A quick grep did not find it.</z><z id="t1489089817" t="mtnygard It would be under resources, in a file with &quot;.edn&quot; as the extension."><y>#</y><d>2017-03-09</d><h>20:03</h><w>mtnygard</w>It would be under resources, in a file with &quot;.edn&quot; as the extension.</z><z id="t1489089839" t="deg maybe datomic-uri?"><y>#</y><d>2017-03-09</d><h>20:03</h><w>deg</w>maybe datomic-uri?</z><z id="t1489089862" t="mtnygard Doh. Yeah, I&apos;m not going be much help if I mistype things... Yes, :datomic-uri"><y>#</y><d>2017-03-09</d><h>20:04</h><w>mtnygard</w>Doh. Yeah, I&apos;m not going be much help if I mistype things... Yes, <code>:datomic-uri</code></z><z id="t1489089869" t="deg :datomic-uri &quot;datomic:&lt;mem://example&gt;&quot;"><y>#</y><d>2017-03-09</d><h>20:04</h><w>deg</w>:datomic-uri &quot;datomic:&lt;mem://example&gt;&quot;</z><z id="t1489089873" t="deg 🙂"><y>#</y><d>2017-03-09</d><h>20:04</h><w>deg</w><b>🙂</b></z><z id="t1489089900" t="mtnygard OK, the &quot;mem&quot; part of that means you&apos;re using the in-memory database. That runs completely inside your Java process so you don&apos;t need to set anything else up."><y>#</y><d>2017-03-09</d><h>20:05</h><w>mtnygard</w>OK, the &quot;mem&quot; part of that means you&apos;re using the in-memory database. That runs completely inside your Java process so you don&apos;t need to set anything else up.</z><z id="t1489089910" t="deg Cool."><y>#</y><d>2017-03-09</d><h>20:05</h><w>deg</w>Cool.</z><z id="t1489089913" t="mtnygard The down side, naturally, is that it doesn&apos;t persist."><y>#</y><d>2017-03-09</d><h>20:05</h><w>mtnygard</w>The down side, naturally, is that it doesn&apos;t persist.</z><z id="t1489089916" t="deg Does it also persist to file?"><y>#</y><d>2017-03-09</d><h>20:05</h><w>deg</w>Does it also persist to file?</z><z id="t1489089918" t="deg Hmm"><y>#</y><d>2017-03-09</d><h>20:05</h><w>deg</w>Hmm</z><z id="t1489089936" t="deg So, I&apos;ll be coming back to a blank slate anytime I restart the program?"><y>#</y><d>2017-03-09</d><h>20:05</h><w>deg</w>So, I&apos;ll be coming back to a blank slate anytime I restart the program?</z><z id="t1489089959" t="mtnygard Right, not only that, but you can create a new memory DB anytime to get a blank state. There&apos;s a &quot;dev&quot; mode that does persist to a file. To use that, you&apos;ll need to download Datomic Starter or Datomic Free."><y>#</y><d>2017-03-09</d><h>20:05</h><w>mtnygard</w>Right, not only that, but you can create a new memory DB anytime to get a blank state.

There&apos;s a &quot;dev&quot; mode that does persist to a file. To use that, you&apos;ll need to download Datomic Starter or Datomic Free.</z><z id="t1489090019" t="deg Ok. So, looks like the docs are a bit inconsistent about this. I guess in part because Vase development overlapped Cognitect&apos;s recent change of tiers."><y>#</y><d>2017-03-09</d><h>20:06</h><w>deg</w>Ok.  So, looks like the docs are a bit inconsistent about this.   I guess in part because Vase development overlapped Cognitect&apos;s recent change of tiers.</z><z id="t1489090034" t="mtnygard Hmm, that&apos;s probably true."><y>#</y><d>2017-03-09</d><h>20:07</h><w>mtnygard</w>Hmm, that&apos;s probably true.</z><z id="t1489090050" t="deg Where should I read to figure out the simplest way to do this integration?"><y>#</y><d>2017-03-09</d><h>20:07</h><w>deg</w>Where should I read to figure out the simplest way to do this integration?</z><z id="t1489090091" t="mtnygard The &quot;getting started&quot; docs for datomic aren&apos;t the greatest (being revised now, in fact) but they should get you going. http://docs.datomic.com/get-datomic.html"><y>#</y><d>2017-03-09</d><h>20:08</h><w>mtnygard</w>The &quot;getting started&quot; docs for datomic aren&apos;t the greatest (being revised now, in fact) but they should get you going.  <a href="http://docs.datomic.com/get-datomic.html" target="_blank">http://docs.datomic.com/get-datomic.html</a></z><z id="t1489090098" t="deg And, for the docs, it would be great to have this built in as an option. I suspect for Vase to win, it&apos;s going to need to attract a lot of new people to the full Datomic env."><y>#</y><d>2017-03-09</d><h>20:08</h><w>deg</w>And, for the docs, it would be great to have this built in as an option.  I suspect for Vase to win, it&apos;s going to need to attract a lot of new people to the full Datomic env.</z><z id="t1489090132" t="deg Thanks. Getting late here, and then I&apos;m off for a few days. But, I will tackle this next week and -- I suspect -- will bother you then with more questions. Thanks!"><y>#</y><d>2017-03-09</d><h>20:08</h><w>deg</w>Thanks.  Getting late here, and then I&apos;m off for a few days. But, I will tackle this next week and -- I suspect -- will bother you then with more questions.  Thanks!</z><z id="t1489090133" t="mtnygard You&apos;ll run a thing called a &quot;transactor&quot; as a separate process, then change the :datomic-uri to something like &quot;datomic:&lt;free://localhost:4334/&lt;dbname&gt;&gt;&quot;"><y>#</y><d>2017-03-09</d><h>20:08</h><w>mtnygard</w>You&apos;ll run a thing called a &quot;transactor&quot; as a separate process, then change the <code>:datomic-uri</code> to something like &quot;datomic:&lt;free://localhost:4334/&lt;dbname&gt;&gt;&quot;</z><z id="t1489090162" t="mtnygard I&apos;m heading out for Spring Break over the next week, but you can email me at &lt;mailto:mt /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt; in the meantime."><y>#</y><d>2017-03-09</d><h>20:09</h><w>mtnygard</w>I&apos;m heading out for Spring Break over the next week, but you can email me at &lt;mailto:mt<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt; in the meantime.</z><z id="t1489090181" t="mtnygard Can I ask what led you to consider Vase? I&apos;m always interested in where our users see value."><y>#</y><d>2017-03-09</d><h>20:09</h><w>mtnygard</w>Can I ask what led you to consider Vase? I&apos;m always interested in where our users see value.</z><z id="t1489090182" t="deg Enjoy. (drinks on beach emoji)"><y>#</y><d>2017-03-09</d><h>20:09</h><w>deg</w>Enjoy.    (drinks on beach emoji)</z><z id="t1489090231" t="deg I listen to the Cognicast podcast, and it was talked about a few weeks back. Also, I saw it mentioned in various online places"><y>#</y><d>2017-03-09</d><h>20:10</h><w>deg</w>I listen to the Cognicast podcast, and it was talked about a few weeks back.  Also, I saw it mentioned in various online places</z><z id="t1489090246" t="mtnygard Cool! Thanks."><y>#</y><d>2017-03-09</d><h>20:10</h><w>mtnygard</w>Cool! Thanks.</z><z id="t1489090305" t="deg And, I recently wrote a hobbyist CLJ/CLJS project with much too much scaffolding and no DB support, so was receptive to the right tools."><y>#</y><d>2017-03-09</d><h>20:11</h><w>deg</w>And, I recently wrote a hobbyist CLJ/CLJS project with much too much scaffolding and no DB support, so was receptive to the right tools.</z><z id="t1489090330" t="mtnygard haha ... that&apos;s exactly why we made Vase!"><y>#</y><d>2017-03-09</d><h>20:12</h><w>mtnygard</w>haha ... that&apos;s exactly why we made Vase!</z><z id="t1489090333" t="mtnygard same frustration."><y>#</y><d>2017-03-09</d><h>20:12</h><w>mtnygard</w>same frustration.</z><z id="t1489090360" t="deg I&apos;m still not totally sure that I buy into the persistent DB idea for dev work, so suspect I&apos;ll be cursing it for a while, while I radically refactor early stage code. But, can certainly see how it will win big for production deployments."><y>#</y><d>2017-03-09</d><h>20:12</h><w>deg</w>I&apos;m still not totally sure that I buy into the persistent DB idea for dev work, so suspect I&apos;ll be cursing it for a while, while I radically refactor early stage code. But, can certainly see how it will win big for production deployments.</z><z id="t1489090454" t="mtnygard So, when you get to unit testing, we&apos;ve got a cool story... basically you can make a fixture that wraps each test with its own in-memory db. so no need to mock out the database when you can always have an isolated instance. the main trick is generating a dbname via UUID. Like (str &quot;datomic:mem://&quot; (d/squuid))"><y>#</y><d>2017-03-09</d><h>20:14</h><w>mtnygard</w>So, when you get to unit testing, we&apos;ve got a cool story... basically you can make a fixture that wraps each test with its own in-memory db. so no need to mock out the database when you can always have an isolated instance.

the main trick is generating a dbname via UUID. Like <code>(str &quot;datomic:mem://&quot; (d/squuid))</code></z><z id="t1489090494" t="deg That is cool! Anyway, I&apos;m just entering the foothills of the learning curve."><y>#</y><d>2017-03-09</d><h>20:14</h><w>deg</w>That is cool!  Anyway, I&apos;m just entering the foothills of the learning curve.</z><z id="t1489090522" t="deg Running late here (I&apos;m seven hours ahead of EST), so I&apos;m gonna drop off now. Thanks again."><y>#</y><d>2017-03-09</d><h>20:15</h><w>deg</w>Running late here (I&apos;m seven hours ahead of EST), so I&apos;m gonna drop off now.  Thanks again.</z><z id="t1489090527" t="mtnygard Cheers"><y>#</y><d>2017-03-09</d><h>20:15</h><w>mtnygard</w>Cheers</z><z id="t1489092472" t="souenzzo Hey, how to use io.pedestal.interceptor.error/error-dispatch with datomic? I can&apos;t make patterns to catch datomic exceptions"><y>#</y><d>2017-03-09</d><h>20:47</h><w>souenzzo</w>Hey, how to use <code>io.pedestal.interceptor.error/error-dispatch</code>with datomic?
I can&apos;t make patterns to catch datomic exceptions</z><z id="t1489092542" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] If one of your interceptors throws an exception, including one from Datomic, Pedestal&apos;s chain handler will catch it and turn it into data. It&apos;s that data that you pattern-match in error-dispatch"><y>#</y><d>2017-03-09</d><h>20:49</h><w>mtnygard</w><a>@souenzzo</a> If one of your interceptors throws an exception, including one from Datomic, Pedestal&apos;s chain handler will catch it and turn it into data. It&apos;s that data that you pattern-match in <code>error-dispatch</code></z><z id="t1489092902" t="souenzzo But datomic exceptions match just on generic :exception-type :java.util.concurrent.ExecutionException or :exception-type :java.lang.IllegalArgumentException (Nothing guarantees me that only datomic exceptions entered here) Then I need to some nested .getCause , ex-data and make another router.... I did not know if there was a standard solution"><y>#</y><d>2017-03-09</d><h>20:55</h><w>souenzzo</w>But datomic exceptions match just on generic <code>:exception-type :java.util.concurrent.ExecutionException</code> or <code>:exception-type :java.lang.IllegalArgumentException</code> (Nothing guarantees me that only datomic exceptions  entered here)
Then I need to some nested <code>.getCause</code>, <code>ex-data</code> and make another router....
I did not know if there was a standard solution</z><z id="t1489093029" t="mtnygard I see what you mean. I suppose you could also match on the interceptor name that&apos;s throwing the exception."><y>#</y><d>2017-03-09</d><h>20:57</h><w>mtnygard</w>I see what you mean. I suppose you could also match on the interceptor name that&apos;s throwing the exception.</z><z id="t1489093040" t="mtnygard There might be another trick to apply. One sec while I look at the source."><y>#</y><d>2017-03-09</d><h>20:57</h><w>mtnygard</w>There might be another trick to apply. One sec while I look at the source.</z><z id="t1489093190" t="mtnygard OK, here&apos;s an avenue you might explore. error-dispatch uses core.match under the hood. It tries to unify the exception data against your patterns. The examples are all of basic map matching, but you can use any of the patterns in https://github.com/clojure/core.match/wiki/Overview that would work on the ex-data. That should include guard clauses on .getCause of the underlying exception."><y>#</y><d>2017-03-09</d><h>20:59</h><w>mtnygard</w>OK, here&apos;s an avenue you might explore. <code>error-dispatch</code> uses core.match under the hood. It tries to unify the exception data against your patterns. The examples are all of basic map matching, but you can use any of the patterns in <a href="https://github.com/clojure/core.match/wiki/Overview" target="_blank">https://github.com/clojure/core.match/wiki/Overview</a> that would work on the ex-data. That should include guard clauses on <code>.getCause</code> of the underlying exception.</z><z id="t1489112001" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks, I will try it out"><y>#</y><d>2017-03-10</d><h>02:13</h><w>jimmy</w><a>@mtnygard</a> thanks, I will try it out</z><z id="t1489130892" t="rauh [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Is there a reason pedestal/guides/documentation/routing-terse-syntax.md didn&apos;t get rewritten to point to the new docs? It contains some mistakes"><y>#</y><d>2017-03-10</d><h>07:28</h><w>rauh</w><a>@mtnygard</a> Is there a reason <code>pedestal/guides/documentation/routing-terse-syntax.md</code> didn&apos;t get rewritten to point to the new docs? It contains some mistakes</z><z id="t1489130911" t="rauh (expand-routes is in the wrong ns)"><y>#</y><d>2017-03-10</d><h>07:28</h><w>rauh</w>(expand-routes is in the wrong ns)</z><z id="t1489260368" t="mtnygard [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] No reason. I&apos;ll open an issue to make sure we don&apos;t forget about that. "><y>#</y><d>2017-03-11</d><h>19:26</h><w>mtnygard</w><a>@rauh</a> No reason. I&apos;ll open an issue to make sure we don&apos;t forget about that. </z><z id="t1489323239" t="ikitommi Is there an interceptor that would encode response body based on client set headers (`accept` &amp; friends), e.g. based on results of io.pedestal.http.content-negotiation/negotiate-content ?"><y>#</y><d>2017-03-12</d><h>12:53</h><w>ikitommi</w>Is there an interceptor that would encode response body based on client set headers (`accept` &amp; friends), e.g. based on results of <code>io.pedestal.http.content-negotiation/negotiate-content</code>?</z><z id="t1489323306" t="ikitommi as the io.pedestal.http.body-params/body-params does decoding for multiple formats..."><y>#</y><d>2017-03-12</d><h>12:55</h><w>ikitommi</w>as the <code>io.pedestal.http.body-params/body-params</code> does decoding for multiple formats...</z><z id="t1489361612" t="bradford Heyas, I&apos;m having trouble with the json parser. My defroutes is: (defroutes routes [[[&quot;/&quot; {:get [::send-counter (sse/start-event-stream sse-stream-ready)]} [&quot;/with-id&quot; {:get [::send-counter-with-id (sse/start-event-stream sse-stream-ready-with-id)]}] [&quot;/about&quot; {:get about-page}] [&quot;/echo&quot; {:post [(b/body-params) test-channel]}] ]]]) but when I compile I get the error Caused by: java.lang.AssertionError: Assert failed: This vector for the verb map has extra elements. The leftover elements are (test-channel) from the original data [(b/body-params) test-channel]"><y>#</y><d>2017-03-12</d><h>23:33</h><w>bradford</w>Heyas, I&apos;m having trouble with the json parser. My defroutes is: <pre>(defroutes routes
           [[[&quot;/&quot; {:get [::send-counter (sse/start-event-stream sse-stream-ready)]}
              [&quot;/with-id&quot; {:get [::send-counter-with-id
                                 (sse/start-event-stream sse-stream-ready-with-id)]}]
              [&quot;/about&quot; {:get about-page}]
              [&quot;/echo&quot; {:post [(b/body-params) test-channel]}]

              ]]])
</pre>  but when I compile I get the error  <pre>Caused by: java.lang.AssertionError: Assert failed: This vector for the verb map has extra elements. The leftover elements are (test-channel) from the original data [(b/body-params) test-channel]</pre></z><z id="t1489405255" t="thegeez [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] for the route syntax you&apos;re using you need"><y>#</y><d>2017-03-13</d><h>11:40</h><w>thegeez</w><a>@bradford</a> for the route syntax you&apos;re using you need</z><z id="t1489405259" t="thegeez [&quot;/echo&quot; ^:interceptors [(b/body-params)] {:post test-channel}]"><y>#</y><d>2017-03-13</d><h>11:40</h><w>thegeez</w><pre>[&quot;/echo&quot;
  ^:interceptors [(b/body-params)] 
  {:post test-channel}]</pre></z><z id="t1489410472" t="deg Is it better to ask Vase questions in the #vase channel (which seems to be very quiet) or here?"><y>#</y><d>2017-03-13</d><h>13:07</h><w>deg</w>Is it better to ask Vase questions in the #vase channel (which seems to be very quiet) or here?</z><z id="t1489410568" t="deg Hmm, LOL, looks like that channel has only two subscribers (including me). So, repeating question here:"><y>#</y><d>2017-03-13</d><h>13:09</h><w>deg</w>Hmm, LOL, looks like that channel has only two subscribers (including me). So, repeating question here:</z><z id="t1489410581" t="deg I&apos;m trying to run the petstore-full sample ( https://github.com/cognitect-labs/vase/tree/master/samples/petstore-full ) but I&apos;m getting an error Connection Refused localhost:4335"><y>#</y><d>2017-03-13</d><h>13:09</h><w>deg</w>I&apos;m trying to run the petstore-full sample (<a href="https://github.com/cognitect-labs/vase/tree/master/samples/petstore-full" target="_blank">https://github.com/cognitect-labs/vase/tree/master/samples/petstore-full</a>) but I&apos;m getting an error Connection Refused localhost:4335</z><z id="t1489410590" t="deg I did git clone &amp; lein install &amp; cd samples/petstore-full/ &amp; lein run"><y>#</y><d>2017-03-13</d><h>13:09</h><w>deg</w>I did git clone &amp; lein install &amp; cd samples/petstore-full/ &amp; lein run</z><z id="t1489412012" t="deg Hmm, I&apos;m guessing that I need to start Datomic, but how?"><y>#</y><d>2017-03-13</d><h>13:33</h><w>deg</w>Hmm, I&apos;m guessing that I need to start Datomic, but how?</z><z id="t1489412070" t="jimmy [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}]"><y>#</y><d>2017-03-13</d><h>13:34</h><w>jimmy</w><a>@deg</a></z><z id="t1489412155" t="jimmy you can quick start that vase example by replacing datomic uri from :datomic-uri &quot;datomic:&quot; to :datomic-uri &quot;datomic:&quot; . So you don&apos;t have to setup datomic free."><y>#</y><d>2017-03-13</d><h>13:35</h><w>jimmy</w>you can quick start that vase example by replacing datomic uri from <code> :datomic-uri  &quot;datomic:&quot;</code> to <code> :datomic-uri  &quot;datomic:&quot;</code> . So you don&apos;t have to setup datomic free.</z><z id="t1489412314" t="ddeaguiar Vase creates the db on startup if it doesn’t already exist"><y>#</y><d>2017-03-13</d><h>13:38</h><w>ddeaguiar</w>Vase creates the db on startup if it doesn’t already exist</z><z id="t1489412344" t="ddeaguiar By using an in memory datomic uri, you don’t have to do any additional setup"><y>#</y><d>2017-03-13</d><h>13:39</h><w>ddeaguiar</w>By using an in memory datomic uri, you don’t have to do any additional setup</z><z id="t1489412358" t="ddeaguiar as [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] stated"><y>#</y><d>2017-03-13</d><h>13:39</h><w>ddeaguiar</w>as <a>@nxqd</a> stated</z><z id="t1489412384" t="ddeaguiar To use Datomic Pro and a non in-memory db, you need to startup a separate Datomic process"><y>#</y><d>2017-03-13</d><h>13:39</h><w>ddeaguiar</w>To use Datomic Pro and a non in-memory db, you need to startup a separate Datomic process</z><z id="t1489412400" t="deg Thanks. I do this in all five of the .edn files?"><y>#</y><d>2017-03-13</d><h>13:40</h><w>deg</w>Thanks.  I do this in all five of the .edn files?</z><z id="t1489412419" t="ddeaguiar In case you’re interested, here’s where the Datomic DB get’s initialized. https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase.clj#L45"><y>#</y><d>2017-03-13</d><h>13:40</h><w>ddeaguiar</w>In case you’re interested, here’s where the Datomic DB get’s initialized. <a href="https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase.clj#L45" target="_blank">https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase.clj#L45</a></z><z id="t1489412472" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] seems so"><y>#</y><d>2017-03-13</d><h>13:41</h><w>ddeaguiar</w><a>@deg</a> seems so</z><z id="t1489412608" t="deg Thanks, that worked!"><y>#</y><d>2017-03-13</d><h>13:43</h><w>deg</w>Thanks, that worked!</z><z id="t1489412638" t="deg How could i have started up a separate Datomic process, if I didn&apos;t want to edit those files?"><y>#</y><d>2017-03-13</d><h>13:43</h><w>deg</w>How could i have started up a separate Datomic process, if I didn&apos;t want to edit those files?</z><z id="t1489412862" t="ddeaguiar So you’d download Datomic free: https://my.datomic.com/downloads/free"><y>#</y><d>2017-03-13</d><h>13:47</h><w>ddeaguiar</w>So you’d download Datomic free: <a href="https://my.datomic.com/downloads/free" target="_blank">https://my.datomic.com/downloads/free</a></z><z id="t1489412886" t="ddeaguiar Once you unzip the archive, there’s a bin dir"><y>#</y><d>2017-03-13</d><h>13:48</h><w>ddeaguiar</w>Once you unzip the archive, there’s a bin dir</z><z id="t1489412938" t="deg Thanks. And, I assume, some obvious help file inside saying what to run."><y>#</y><d>2017-03-13</d><h>13:48</h><w>deg</w>Thanks. And, I assume, some obvious help file inside saying what to run.</z><z id="t1489412956" t="ddeaguiar hmm, looking. Been a while since I’ve run Datomic free"><y>#</y><d>2017-03-13</d><h>13:49</h><w>ddeaguiar</w>hmm, looking. Been a while since I’ve run Datomic free</z><z id="t1489412962" t="ddeaguiar should be the same as pro"><y>#</y><d>2017-03-13</d><h>13:49</h><w>ddeaguiar</w>should be the same as pro</z><z id="t1489413031" t="deg Am I missing something about the Vase philosophy? The docs say that it is self-contained with Datomic enclosed. Yet, the sample app is configured to need Datomic pre-installed or undocumented changes to its config file."><y>#</y><d>2017-03-13</d><h>13:50</h><w>deg</w>Am I missing something about the Vase philosophy? The docs say that it is self-contained with Datomic enclosed. Yet, the sample app is configured to need Datomic pre-installed or undocumented changes to its config file.</z><z id="t1489413085" t="deg Stranger, the Vase sample app mentions that changes are needed to move from Datomic Free to Pro. But, no mention of what is needed for the in-mem version that comes with Vase itself."><y>#</y><d>2017-03-13</d><h>13:51</h><w>deg</w>Stranger, the Vase sample app mentions that changes are needed to move from Datomic Free to Pro. But, no mention of what is needed for the in-mem version that comes with Vase itself.</z><z id="t1489413128" t="deg (Is this even the right channel for me to be venting about this? Or is there a more Vase-specific place? -- #vase seems to abandoned)"><y>#</y><d>2017-03-13</d><h>13:52</h><w>deg</w>(Is this even the right channel for me to be venting about this? Or is there a more Vase-specific place?  -- #vase seems to abandoned)</z><z id="t1489413271" t="ddeaguiar So let me make sure I’m not giving you bad advice, It’s been a while since I’ve run the vase samples."><y>#</y><d>2017-03-13</d><h>13:54</h><w>ddeaguiar</w>So let me make sure I’m not giving you bad advice, It’s been a while since I’ve run the vase samples.</z><z id="t1489413548" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] , so for now I think this is the right place for your Q’s."><y>#</y><d>2017-03-13</d><h>13:59</h><w>ddeaguiar</w><a>@deg</a>, so for now I think this is the right place for your Q’s.</z><z id="t1489413579" t="ddeaguiar re: Datomic free, it requires you to spin up a local transactor using the bin/transactor cli which is available when you download Datomic free"><y>#</y><d>2017-03-13</d><h>13:59</h><w>ddeaguiar</w>re: Datomic free, it requires you to spin up a local transactor using the <code>bin/transactor</code> cli which is available when you download Datomic free</z><z id="t1489413599" t="ddeaguiar Vase does include Datomic free as a dependency but that’s for the peer"><y>#</y><d>2017-03-13</d><h>13:59</h><w>ddeaguiar</w>Vase does include Datomic free as a dependency but that’s for the peer</z><z id="t1489413627" t="ddeaguiar The Vase samples shouldn’t really depend on Datomic free. An In-memory DB would be better"><y>#</y><d>2017-03-13</d><h>14:00</h><w>ddeaguiar</w>The Vase samples shouldn’t really depend on Datomic free. An In-memory DB would be better</z><z id="t1489413865" t="ddeaguiar I’d recommend using at least Datomic free when running a real hobbie system. For Prod I’d consider Datomic Pro."><y>#</y><d>2017-03-13</d><h>14:04</h><w>ddeaguiar</w>I’d recommend using at least Datomic free when running a real hobbie system. For Prod I’d consider Datomic Pro.</z><z id="t1489413890" t="ddeaguiar for exploration, in memory db’s are fine"><y>#</y><d>2017-03-13</d><h>14:04</h><w>ddeaguiar</w>for exploration, in memory db’s are fine</z><z id="t1489413932" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] There are definitely gaps in the docs that need to be closed."><y>#</y><d>2017-03-13</d><h>14:05</h><w>ddeaguiar</w><a>@deg</a> There are definitely gaps in the docs that need to be closed.</z><z id="t1489413933" t="deg Got it, thanks. I&apos;m putting together a small PR with this and some other minor typos I found in the docs. I was going to just add to the readme, giving the change you supplied above. But, would it be better to instead change the .edn files so they work immediately?"><y>#</y><d>2017-03-13</d><h>14:05</h><w>deg</w>Got it, thanks.  I&apos;m putting together a small PR with this and some other minor typos I found in the docs.  I was going to just add to the readme, giving the change you supplied above. But, would it be better to instead change the .edn files so they work immediately?</z><z id="t1489413957" t="deg (same effort for me; I either commit the .edns I changed or the readme I changed)"><y>#</y><d>2017-03-13</d><h>14:05</h><w>deg</w>(same effort for me; I either commit the .edns I changed or the readme I changed)</z><z id="t1489413995" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] I’d create a separate PR for changing the edn files to use an in memory db plus the readme update."><y>#</y><d>2017-03-13</d><h>14:06</h><w>ddeaguiar</w><a>@deg</a> I’d create a separate PR for changing the edn files to use an in memory db plus the readme update.</z><z id="t1489414002" t="ddeaguiar that would be super helpful"><y>#</y><d>2017-03-13</d><h>14:06</h><w>ddeaguiar</w>that would be super helpful</z><z id="t1489414012" t="deg will do."><y>#</y><d>2017-03-13</d><h>14:06</h><w>deg</w>will do.</z><z id="t1489414025" t="deg Time allowing, I&apos;ll review the other samples too."><y>#</y><d>2017-03-13</d><h>14:07</h><w>deg</w>Time allowing, I&apos;ll review the other samples too.</z><z id="t1489414038" t="ddeaguiar Great, thanks for digging in!"><y>#</y><d>2017-03-13</d><h>14:07</h><w>ddeaguiar</w>Great, thanks for digging in!</z><z id="t1489414727" t="deg Most of the other samples work as is. But, vasebi crashes on first connection to localhost:8080. I don&apos;t grok the entire stack trace, but looks like the immediate cause is an NPE."><y>#</y><d>2017-03-13</d><h>14:18</h><w>deg</w>Most of the other samples work as is. But, vasebi crashes on first connection to localhost:8080. I don&apos;t grok the entire stack trace, but looks like the immediate cause is an NPE.</z><z id="t1489416703" t="bradford [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] thanks!"><y>#</y><d>2017-03-13</d><h>14:51</h><w>bradford</w><a>@thegeez</a> thanks!</z><z id="t1489432807" t="alanspringfield [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Is there anyway I can help with the development of Vase somehow? It seems very interesting. I&apos;m familiar with Clojure(script) but haven&apos;t had any experience contributing to open-source."><y>#</y><d>2017-03-13</d><h>19:20</h><w>alanspringfield</w><a>@ddeaguiar</a> Is there anyway I can help with the development of Vase somehow? It seems very interesting. I&apos;m familiar with Clojure(script) but haven&apos;t had any experience contributing to open-source.</z><z id="t1489435366" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U40A6N0GM&quot;}] , there sure is. There are gaps in the documentation. At minimum the creation of issues around that would be useful. There are already some issues for that as well. If you’d like to contribute to the code, be sure to check out the Contributing section of the README ( https://github.com/cognitect-labs/vase#contributing )."><y>#</y><d>2017-03-13</d><h>20:02</h><w>ddeaguiar</w><a>@alanspringfield</a>, there sure is. There are gaps in the documentation. At minimum the creation of issues around that would be useful. There are already some issues for that as well. If you’d like to contribute to the code, be sure to check out the Contributing section of the README (<a href="https://github.com/cognitect-labs/vase#contributing" target="_blank">https://github.com/cognitect-labs/vase#contributing</a>).</z><z id="t1489435430" t="ddeaguiar I highly recommend creating an issue and soliciting feedback for any remotely significant change… before doing any of the work."><y>#</y><d>2017-03-13</d><h>20:03</h><w>ddeaguiar</w>I highly recommend creating an issue and soliciting feedback for any remotely significant change… before doing any of the work.</z><z id="t1489435470" t="ddeaguiar In any case, doc fixes are a great way to dive into open source contribution."><y>#</y><d>2017-03-13</d><h>20:04</h><w>ddeaguiar</w>In any case, doc fixes are a great way to dive into open source contribution.</z><z id="t1489496857" t="deg I&apos;m trying to find a set of docs to read, to understand the full Pedestal picture. I&apos;m now five minutes into the process; probably close to the target; but frustrated/amused at the search. Recording notes here, both to vent and in the hope that this helps a future cleanup. 1) A Google search took me, somehow, to https://github.com/pedestal/app-tutorial . Looks great; starts with &quot;This tutorial will guide you step-by-step through pedestal-app in its entirety.&quot; But, then I noticed that this project has not been updated in four years! 2) Next, I found https://github.com/pedestal/pedestal-docs . But, quickly realized that this is the toolset for building the docs, not the droid I was looking for. 3) But the README.md does not have a link to where I should go for the docs. [Later: I now see there is a link, hidden at the top of the page above the GitHub status and file list. I didn&apos;t even know that GitHub lets projects write to there. So, ok, I should know to to go to http://pedestal.io . But, I missed that clue, so bear with me as I wander] 4) I go back to https://github.com/pedestal/pedestal , and read the README.md to the end. Hurrah, I find links to &quot;Documentation / Pedestal documentation / ... The latest API Docs&quot;, with two nice links. 5) So, I follow them. The API link looks useful for later, but I want to read some descriptions first. So, I save it to the side. The Pedestal Documentation link takes me to https://github.com/pedestal/pedestal/tree/master/guides/documentation . Looks good! 6) I read the first page. Nice intro. And, there is even a link at the bottom to the next page. This looks like exactly what I want: a linear guide through the key docs. 7) So, I follow the link to the next page: https://github.com/pedestal/pedestal/blob/master/guides/documentation/hello-world-service.md . Wham, Boof. &quot;Obsolete Guide&quot;. But, at least there is a link here to http://pedestal.io/guides/hello-world , so I now discover http://pedestal.io . End of saga, I hope!"><y>#</y><d>2017-03-14</d><h>13:07</h><w>deg</w>I&apos;m trying to find a set of docs to read, to understand the full Pedestal picture.  I&apos;m now five minutes into the process; probably close to the target; but frustrated/amused at the search. Recording notes here, both to vent and in the hope that this helps a future cleanup.
1) A Google search took me, somehow, to <a href="https://github.com/pedestal/app-tutorial" target="_blank">https://github.com/pedestal/app-tutorial</a>.  Looks great; starts with &quot;This tutorial will guide you step-by-step through pedestal-app in its entirety.&quot; But, then I noticed that this project has not been updated in four years!
2) Next, I found <a href="https://github.com/pedestal/pedestal-docs" target="_blank">https://github.com/pedestal/pedestal-docs</a>. But, quickly realized that this is the toolset for building the docs, not the droid I was looking for.
3) But the README.md does not have a link to where I should go for the docs.  [Later: I now see there is a link, hidden at the top of the page above the GitHub status and file list. I didn&apos;t even know that GitHub lets projects write to there.  So, ok, I should know to to go to <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>. But, I missed that clue, so bear with me as I wander]
4) I go back to <a href="https://github.com/pedestal/pedestal" target="_blank">https://github.com/pedestal/pedestal</a>, and read the README.md to the end.  Hurrah, I find links to &quot;Documentation / Pedestal documentation / ... The latest API Docs&quot;, with two nice links.
5) So, I follow them. The API link looks useful for later, but I want to read some descriptions first. So, I save it to the side.  The Pedestal Documentation link takes me to <a href="https://github.com/pedestal/pedestal/tree/master/guides/documentation" target="_blank">https://github.com/pedestal/pedestal/tree/master/guides/documentation</a>. Looks good!
6) I read the first page. Nice intro. And, there is even a link at the bottom to the next page. This looks like exactly what I want: a linear guide through the key docs.
7) So, I follow the link to the next page: <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/hello-world-service.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/hello-world-service.md</a>.  Wham, Boof.  &quot;Obsolete Guide&quot;.  But, at least there is a link here to <a href="http://pedestal.io/guides/hello-world" target="_blank">http://pedestal.io/guides/hello-world</a>, so I now discover <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>. 

End of saga, I hope!</z><z id="t1489497289" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] , I’m sorry it’s so difficult to find the information you need. The http://pedestal.io site is the correct place to go to get an understanding of Pedestal beyond what’s provided in the Pedestal README. Some of the guides in the Pedestal code base are out of date. There is currently an issue to review them and migrate them to the http://pedestal.io site."><y>#</y><d>2017-03-14</d><h>13:14</h><w>ddeaguiar</w><a>@deg</a>, I’m sorry it’s so difficult to find the information you need. The <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> site is the correct place to go to get an understanding of Pedestal beyond what’s provided in the Pedestal README. Some of the guides in the Pedestal code base are out of date. There is currently an issue to review them and migrate them to the <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> site.</z><z id="t1489497339" t="ddeaguiar I do agree that the link to the http://Pedestal.io site should be more prominent in the README"><y>#</y><d>2017-03-14</d><h>13:15</h><w>ddeaguiar</w>I do agree that the link to the <a href="http://Pedestal.io" target="_blank">http://Pedestal.io</a> site should be more prominent in the README</z><z id="t1489497687" t="ddeaguiar FYI, here’s the issue I was referring to: https://github.com/pedestal/pedestal/issues/501"><y>#</y><d>2017-03-14</d><h>13:21</h><w>ddeaguiar</w>FYI, here’s the issue I was referring to: <a href="https://github.com/pedestal/pedestal/issues/501" target="_blank">https://github.com/pedestal/pedestal/issues/501</a></z><z id="t1489499241" t="deg Thanks. No &quot;sorry&quot; needed. Mostly, I was just trying to document the wrong steps I took, so things can be improved in the future."><y>#</y><d>2017-03-14</d><h>13:47</h><w>deg</w>Thanks. No &quot;sorry&quot; needed. Mostly, I was just trying to document the wrong steps I took, so things can be improved in the future.</z><z id="t1489499312" t="ddeaguiar That is much appreciated"><y>#</y><d>2017-03-14</d><h>13:48</h><w>ddeaguiar</w>That is much appreciated</z><z id="t1489499346" t="deg Meanwhile, I&apos;ve also linked to this from https://github.com/cognitect-labs/vase/issues/50 , where I&apos;ve been trying to list the snags as I find them. (sorry I can&apos;t just fix the docs as I hit these; but I don&apos;t know enough yet)."><y>#</y><d>2017-03-14</d><h>13:49</h><w>deg</w>Meanwhile, I&apos;ve also linked to this from <a href="https://github.com/cognitect-labs/vase/issues/50" target="_blank">https://github.com/cognitect-labs/vase/issues/50</a>, where I&apos;ve been trying to list the snags as I find them.  (sorry I can&apos;t just fix the docs as I hit these; but I don&apos;t know enough yet).</z><z id="t1489499479" t="ddeaguiar That’s a great issue. Thanks for your thoroughness."><y>#</y><d>2017-03-14</d><h>13:51</h><w>ddeaguiar</w>That’s a great issue. Thanks for your thoroughness.</z><z id="t1489532003" t="bradford Heyas. Is it possible to stream multiple file uploads to a pedestal server? would that be content-type: multipart/form-data and transfer-encoding: chunked ? (sorry, I&apos;m rather new to this). Do I just use the multipart-form-data ring middleware?"><y>#</y><d>2017-03-14</d><h>22:53</h><w>bradford</w>Heyas. Is it possible to stream multiple file uploads to a pedestal server? would that be <code>content-type: multipart/form-data</code> and <code>transfer-encoding: chunked</code>?  (sorry, I&apos;m rather new to this). Do I just use the multipart-form-data ring middleware?</z><z id="t1489567211" t="alanspringfield [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Where should I start reading the code base to better understand what&apos;s going on?"><y>#</y><d>2017-03-15</d><h>08:40</h><w>alanspringfield</w><a>@ddeaguiar</a> Where should I start reading the code base to better understand what&apos;s going on?</z><z id="t1489583567" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U40A6N0GM&quot;}] I’d start with the io.pedestal.http ns. Basically work you way back from create-server ( https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L341 ) to see things are initialized. Where you go from there is up to you. Good candidates are the io.pedestal.http.route ns ( https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj ) or the io.pedestal.interceptor ns ( https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj )."><y>#</y><d>2017-03-15</d><h>13:12</h><w>ddeaguiar</w><a>@alanspringfield</a> I’d start with the <code>io.pedestal.http</code> ns. Basically work you way back from <code>create-server</code> (<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L341" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L341</a>) to see things are initialized. Where you go from there is up to you. Good candidates are the <code>io.pedestal.http.route</code> ns (<a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj</a>) or the <code>io.pedestal.interceptor</code> ns (<a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj</a>).</z><z id="t1489583683" t="ddeaguiar The code is really clean so it should be pretty easy to follow. Keep an eye out for abstractions as you go through it"><y>#</y><d>2017-03-15</d><h>13:14</h><w>ddeaguiar</w>The code is really clean so it should be pretty easy to follow. Keep an eye out for abstractions as you go through it</z><z id="t1489583729" t="ddeaguiar Just having an understanding of what’s going on in io.pedestal.http goes a long way imo"><y>#</y><d>2017-03-15</d><h>13:15</h><w>ddeaguiar</w>Just having an understanding of what’s going on in <code>io.pedestal.http</code> goes a long way imo</z><z id="t1489583796" t="ddeaguiar Knowing what default interceptors get wired up when is super useful. https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L180"><y>#</y><d>2017-03-15</d><h>13:16</h><w>ddeaguiar</w>Knowing what default interceptors get wired up when is super useful. <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L180" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L180</a></z><z id="t1489583889" t="ddeaguiar hope that helps"><y>#</y><d>2017-03-15</d><h>13:18</h><w>ddeaguiar</w>hope that helps</z><z id="t1489610910" t="rafaelzlisboa anybody using pedestal sse for broadcasting?"><y>#</y><d>2017-03-15</d><h>20:48</h><w>rafaelzlisboa</w>anybody using pedestal sse for broadcasting?</z><z id="t1489618703" t="mtnygard Hey all, checking in mid-week during spring break here. Catching up on the conversation, so I’ll be shotgunning out on some different topics."><y>#</y><d>2017-03-15</d><h>22:58</h><w>mtnygard</w>Hey all, checking in mid-week during spring break here. Catching up on the conversation, so I’ll be shotgunning out on some different topics.</z><z id="t1489618729" t="mtnygard [:attrs {:href &quot;/_/_/users/U2GLFCS11&quot;}] Yes, we’re definitely using SSE for broadcasting events."><y>#</y><d>2017-03-15</d><h>22:58</h><w>mtnygard</w><a>@rafaelzlisboa</a> Yes, we’re definitely using SSE for broadcasting events.</z><z id="t1489619237" t="rafaelzlisboa what’s the best way to set it up? what i’m doing is using a mult and tap ping the individual channels into a broadcaster main channel, with a watchdog to release them when there is a timeout. just wondering if there’s an easier way to implement it"><y>#</y><d>2017-03-15</d><h>23:07</h><r>rafaelzlisboa</r>what’s the best way to set it up?

what i’m doing is using a <code>mult</code> and <code>tap</code>ping the individual channels into a broadcaster main channel, with a watchdog to release them when there is a timeout. just wondering if there’s an easier way to implement it</z><z id="t1489619336" t="mtnygard I’ve not had good luck with mult and tap in the past. There’s something about them that I don’t understand. I keep a map with the connected clients. The start-event-stream function lets me identify a disconnect function that I use to clean up the map."><y>#</y><d>2017-03-15</d><h>23:08</h><r>mtnygard</r>I’ve not had good luck with mult and tap in the past. There’s something about them that I don’t understand. I keep a map with the connected clients. The start-event-stream function lets me identify a disconnect function that I use to clean up the map.</z><z id="t1489619412" t="rafaelzlisboa hmmm… then go through the entire map whenever we want to broadcast?"><y>#</y><d>2017-03-15</d><h>23:10</h><r>rafaelzlisboa</r>hmmm… then go through the entire map whenever we want to broadcast?</z><z id="t1489619424" t="mtnygard Yes, with a doseq."><y>#</y><d>2017-03-15</d><h>23:10</h><r>mtnygard</r>Yes, with a doseq.</z><z id="t1489619451" t="mtnygard It’s a map from a per-client key to the channel for that client."><y>#</y><d>2017-03-15</d><h>23:10</h><r>mtnygard</r>It’s a map from a per-client key to the channel for that client.</z><z id="t1489619509" t="mtnygard Here’s an excerpt: https://gist.github.com/mtnygard/3c05c26f4cfad420eee6ce32ac03819f"><y>#</y><d>2017-03-15</d><h>23:11</h><r>mtnygard</r>Here’s an excerpt: <a href="https://gist.github.com/mtnygard/3c05c26f4cfad420eee6ce32ac03819f" target="_blank">https://gist.github.com/mtnygard/3c05c26f4cfad420eee6ce32ac03819f</a></z><z id="t1489619720" t="rafaelzlisboa nice! I guess right now we’re at the point of not having good luck with mult and tap hahah. it randomly stops working somedays"><y>#</y><d>2017-03-15</d><h>23:15</h><r>rafaelzlisboa</r>nice! I guess right now we’re at the point of not having good luck with mult and tap hahah. it randomly stops working somedays</z><z id="t1489619761" t="mtnygard Yeah, I didn’t track it down far enough but it seemed like I couldn’t effectively isolate errors/slowdowns on one tap from others."><y>#</y><d>2017-03-15</d><h>23:16</h><r>mtnygard</r>Yeah, I didn’t track it down far enough but it seemed like I couldn’t effectively isolate errors/slowdowns on one tap from others.</z><z id="t1489619933" t="rafaelzlisboa thanks for the tip"><y>#</y><d>2017-03-15</d><h>23:18</h><r>rafaelzlisboa</r>thanks for the tip</z><z id="t1489618829" t="mtnygard [:attrs {:href &quot;/_/_/users/U40A6N0GM&quot;}] Vase builds on Pedestal, so learning Pedestal is definitely a good start. Going through the HTTP namespace as [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] suggests is the “outside to inside” approach. Depending on your learning style, you may also benefit from an “inside to outside” approach… that would be starting with the interceptors module. Pretty much everything that makes Vase interesting is about building interceptors out of data."><y>#</y><d>2017-03-15</d><h>23:00</h><w>mtnygard</w><a>@alanspringfield</a> Vase builds on Pedestal, so learning Pedestal is definitely a good start. Going through the HTTP namespace as <a>@ddeaguiar</a> suggests is the “outside to inside” approach. Depending on your learning style, you may also benefit from an “inside to outside” approach… that would be starting with the interceptors module. Pretty much everything that makes Vase interesting is about building interceptors out of data.</z><z id="t1489618917" t="mtnygard [:attrs {:href &quot;/_/_/users/U40A6N0GM&quot;}] As you get started, please take notes of anything that bites you. Or anything that just bites. The notes from [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] on doc deficiencies have been great. Each time someone goes through the process we can learn from anything that makes them stumble."><y>#</y><d>2017-03-15</d><h>23:01</h><w>mtnygard</w><a>@alanspringfield</a> As you get started, please take notes of anything that bites you. Or anything that just bites. The notes from <a>@deg</a> on doc deficiencies have been great. Each time someone goes through the process we can learn from anything that makes them stumble.</z><z id="t1489619042" t="mtnygard [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] I know a few people have done multipart forms that include uploads. IDK if that means multiple parallel uploads. The multipart form upload ring middleware is probably the quickest path to done."><y>#</y><d>2017-03-15</d><h>23:04</h><w>mtnygard</w><a>@bradford</a> I know a few people have done multipart forms that include uploads. IDK if that means multiple parallel uploads. The multipart form upload ring middleware is probably the quickest path to done.</z><z id="t1489619226" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] The “self contained” part of Vase is meant to refer to dependencies. There is probably a better term for it. As far as the #vase channel… I don’t know who started it and didn’t know there was one until you mentioned it."><y>#</y><d>2017-03-15</d><h>23:07</h><w>mtnygard</w><a>@deg</a> The “self contained” part of Vase is meant to refer to dependencies. There is probably a better term for it. As far as the #vase channel… I don’t know who started it and didn’t know there was one until you mentioned it.</z><z id="t1489619251" t="mtnygard This channel is normally friendly enough and low volume so I’d rather not split attention there too."><y>#</y><d>2017-03-15</d><h>23:07</h><w>mtnygard</w>This channel is normally friendly enough and low volume so I’d rather not split attention there too.</z><z id="t1489660954" t="bherrmann (also posted in #vase) boo… when I run the vase sample “omnext-todo” - can see the working vase api part.... but where can I access the omnext part?"><y>#</y><d>2017-03-16</d><h>10:42</h><w>bherrmann</w>(also posted in #vase) boo…  when I run the vase sample “omnext-todo” - can see the working vase api part.... but where can I access the omnext part?</z><z id="t1489681796" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] from what I can see, this sample only addresses the api needs for an om-next application. I’m not familiar with om-next’s ‘demand-driven’ queries so I can’t help with that."><y>#</y><d>2017-03-16</d><h>16:29</h><w>ddeaguiar</w><a>@bherrmann</a> from what I can see, this sample only addresses the api needs for an om-next application. I’m not familiar with om-next’s ‘demand-driven’ queries so I can’t help with that.</z><z id="t1489683539" t="bherrmann [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thanks, that makes sense."><y>#</y><d>2017-03-16</d><h>16:58</h><w>bherrmann</w><a>@ddeaguiar</a> Thanks, that makes sense.</z><z id="t1489792841" t="sineer Hi! I&apos;m having a hard time trying to get a proper pedestal dev setup up and running..."><y>#</y><d>2017-03-17</d><h>23:20</h><w>sineer</w>Hi! I&apos;m having a hard time trying to get a proper pedestal dev setup up and running...</z><z id="t1489792903" t="sineer I set my service route to :: server/routes #(route/expand-routes (deref #&apos;service/routes)) and it routes but whenever I reload code I can never get my updated routes to reslove without killing and restarting the server"><y>#</y><d>2017-03-17</d><h>23:21</h><w>sineer</w>I set my service route to <b>::</b>server/routes #(route/expand-routes (deref #&apos;service/routes))
and it routes but whenever I reload code I can never get my updated routes to reslove without killing and restarting the server</z><z id="t1489793627" t="sineer I don&apos;t get it, I run-dev and I&apos;m in the repl redeclaring interceptors and reloading code but nothing changes! It&apos;s not just the route even the content of simple interceptor when reloaded do not change untill I kill and restart jetty 😞"><y>#</y><d>2017-03-17</d><h>23:33</h><w>sineer</w>I don&apos;t get it, I run-dev and I&apos;m in the repl redeclaring interceptors and reloading code but nothing changes! It&apos;s not just the route even the content of simple interceptor when reloaded do not change untill I kill and restart jetty <b>😞</b></z><z id="t1489796798" t="sineer Holy shit I found out what I was doing wrong at last!"><y>#</y><d>2017-03-18</d><h>00:26</h><w>sineer</w>Holy shit I found out what I was doing wrong at last!</z><z id="t1489796861" t="sineer If you don&apos;t quote interceptors in routes def they can&apos;t be reloaded... It makes senses but I sure had to struggle a lot to figure it out!"><y>#</y><d>2017-03-18</d><h>00:27</h><w>sineer</w>If you don&apos;t quote interceptors in routes def they can&apos;t be reloaded... It makes senses but I sure had to struggle a lot to figure it out!</z><z id="t1489797142" t="sineer My routes still won&apos;t update too."><y>#</y><d>2017-03-18</d><h>00:32</h><w>sineer</w>My routes still won&apos;t update too.</z><z id="t1489803492" t="jimmy [:attrs {:href &quot;/_/_/users/U2QDZ8CNA&quot;}]"><y>#</y><d>2017-03-18</d><h>02:18</h><w>jimmy</w><a>@sineer</a></z><z id="t1489803500" t="jimmy how do you reload your code ?"><y>#</y><d>2017-03-18</d><h>02:18</h><w>jimmy</w>how do you reload your code ?</z><z id="t1489807864" t="sineer I&apos;m running the run-dev fn at the repl with my service&apos;s route set like :: http/routes #(route/expand-routes (deref #&apos;routes/master-routes))"><y>#</y><d>2017-03-18</d><h>03:31</h><w>sineer</w>I&apos;m running the run-dev fn at the repl with my service&apos;s route set like <b>::</b>http/routes #(route/expand-routes (deref #&apos;routes/master-routes))</z><z id="t1489807899" t="sineer I use cider-jack-in and also reploaded.repl"><y>#</y><d>2017-03-18</d><h>03:31</h><w>sineer</w>I use cider-jack-in and also reploaded.repl</z><z id="t1489807938" t="sineer I can deref my master-routes and see what changes in the repl but the jetty process never picks up the routes updates."><y>#</y><d>2017-03-18</d><h>03:32</h><w>sineer</w>I can deref my master-routes and see what changes in the repl but the jetty process never picks up the routes updates.</z><z id="t1489948509" t="deg I&apos;m reading through https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md , trying to grok it all, and cleaning up some small typos. I found two somewhat larger issues, and wanted to check before I trample: 1) It looks like the section &quot;Working with POST data&quot; is duplicated by the material in the later section &quot;Getting data in with transact&quot;. The latter seems to be more useful and complete. I&apos;d like to delete &quot;Working with POST data&quot; entirely. 2) The whole presentation of this material is awkward. The ...service.edn file starts with a much more complete set of examples, and the new user is expected to replace sections with shorter pieces. Instead, I think it would be cleaner to change the file to contain the final results suggested by yourfirst_api.md, and to leave the remaining material in comments."><y>#</y><d>2017-03-19</d><h>18:35</h><w>deg</w>I&apos;m reading through <a href="https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md" target="_blank">https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md</a>, trying to grok it all, and cleaning up some small typos. I found two somewhat larger issues, and wanted to check before I trample:
1) It looks like the section &quot;Working with POST data&quot; is duplicated by the material in the later section &quot;Getting data in with transact&quot;. The latter seems to be more useful and complete. I&apos;d like to delete &quot;Working with POST data&quot; entirely.
2) The whole presentation of this material is awkward. The ...service.edn file starts with a much more complete set of examples, and the new user is expected to replace sections with shorter pieces. Instead, I think it would be cleaner to change the file to contain the final results suggested by yourfirst_api.md, and to leave the remaining material in comments.</z><z id="t1490043796" t="deg Awfully quiet today. 🙂 In the template .edn file, is it intentional that :db.install/_attribute :db.part/db is used in the example of a norm? I understand from the docs that this is no longer needed."><y>#</y><d>2017-03-20</d><h>21:03</h><w>deg</w>Awfully quiet today. <b>🙂</b>

In the template .edn file, is it intentional that <code>:db.install/_attribute :db.part/db</code> is used in the example of a norm?  I understand from the docs that this is no longer needed.</z><z id="t1490043833" t="mtnygard That change in Datomic came more recently than the samples."><y>#</y><d>2017-03-20</d><h>21:03</h><w>mtnygard</w>That change in Datomic came more recently than the samples.</z><z id="t1490043852" t="mtnygard The samples can be updated as long as we add a note about the minimum revision of Datomic supported."><y>#</y><d>2017-03-20</d><h>21:04</h><w>mtnygard</w>The samples can be updated as long as we add a note about the minimum revision of Datomic supported.</z><z id="t1490043947" t="deg Is the minimum version documented somewhere? I&apos;m happy to add in this kind of thing as I&apos;m learning/proofreading, but I&apos;ve not yet found enough reference docs. The Vase docs still seem to be strongly example driven."><y>#</y><d>2017-03-20</d><h>21:05</h><w>deg</w>Is the minimum version documented somewhere?  I&apos;m happy to add in this kind of thing as I&apos;m learning/proofreading, but I&apos;ve not yet found enough reference docs. The Vase docs still seem to be strongly example driven.</z><z id="t1490043974" t="mtnygard Right now there isn&apos;t a minimum. You could use Vase on any release of Datomic ever."><y>#</y><d>2017-03-20</d><h>21:06</h><w>mtnygard</w>Right now there isn&apos;t a minimum. You could use Vase on any release of Datomic ever.</z><z id="t1490044159" t="deg Still, seems wrong to have the :db.install stuff in a beginner&apos;s doc. In trying to understand the .edn file, I had to browse through much too much of the Datomic Schema docs in order to just learn that I didn&apos;t need to pay attention to that line. 😞 (I had tried an exercise of rewriting the complex norm as a simple one, to ensure that I understood it completely. This line was a sticking point. FWIW, so was :unique vs :identity; also only answered by reading through the datomic docs)"><y>#</y><d>2017-03-20</d><h>21:09</h><w>deg</w>Still, seems wrong to have the <code>:db.install</code> stuff in a beginner&apos;s doc.  In trying to understand the .edn file, I had to browse through much too much of the Datomic Schema docs in order to just learn that I didn&apos;t need to pay attention to that line. <b>😞</b>   (I had tried an exercise of rewriting the complex norm as a simple one, to ensure that I understood it completely. This line was a sticking point.  FWIW, so was :unique vs :identity; also only answered by reading through the datomic docs)</z><z id="t1490044194" t="mtnygard I think what we need to do is make two docs."><y>#</y><d>2017-03-20</d><h>21:09</h><w>mtnygard</w>I think what we need to do is make two docs.</z><z id="t1490044220" t="mtnygard &quot;your_first_api.md&quot; today is really meant to be &quot;your first Vase API&quot; for someone who already knows Pedestal and Datomic, but wants to learn Vase."><y>#</y><d>2017-03-20</d><h>21:10</h><w>mtnygard</w>&quot;your_first_api.md&quot; today is really meant to be &quot;your first Vase API&quot; for someone who already knows Pedestal and Datomic, but wants to learn Vase.</z><z id="t1490044236" t="mtnygard I think you&apos;re aiming at something more like the Pedestal getting started guides."><y>#</y><d>2017-03-20</d><h>21:10</h><w>mtnygard</w>I think you&apos;re aiming at something more like the Pedestal getting started guides.</z><z id="t1490044281" t="deg That sounds right to me. Also, two .edn files. (See my #2 comment yesterday, about the awkwardness of being instructed to shorten a sample file)"><y>#</y><d>2017-03-20</d><h>21:11</h><w>deg</w>That sounds right to me.  Also, two .edn files.  (See my #2 comment yesterday, about the awkwardness of being instructed to shorten a sample file)</z><z id="t1490044319" t="mtnygard Not just two files. Two different directories."><y>#</y><d>2017-03-20</d><h>21:11</h><w>mtnygard</w>Not just two files. Two different directories.</z><z id="t1490044324" t="deg Yup"><y>#</y><d>2017-03-20</d><h>21:12</h><w>deg</w>Yup</z><z id="t1490044345" t="mtnygard The minimum necessary for a Vase app is quite small. The template generates a more full-features, production-ready app... but that&apos;s not helpful to learn from."><y>#</y><d>2017-03-20</d><h>21:12</h><w>mtnygard</w>The minimum necessary for a Vase app is quite small. The template generates a more full-features, production-ready app... but that&apos;s not helpful to learn from.</z><z id="t1490044400" t="deg Yup. I was blown away (in a very positive sense) by how little code was in my lein new vase foo ."><y>#</y><d>2017-03-20</d><h>21:13</h><w>deg</w>Yup.  I was blown away (in a very positive sense) by how little code was in my <code>lein new vase foo</code>.</z><z id="t1490044417" t="deg It would make a lot of sense to have two templates."><y>#</y><d>2017-03-20</d><h>21:13</h><w>deg</w>It would make a lot of sense to have two templates.</z><z id="t1490044422" t="mtnygard It&apos;s still more than I&apos;d like. 😉"><y>#</y><d>2017-03-20</d><h>21:13</h><w>mtnygard</w>It&apos;s still more than I&apos;d like. <b>😉</b></z><z id="t1490044534" t="deg That&apos;s a great goal. As a newbie, I&apos;ve found that one of the weaknesses in the Clojure client/server ecosystem is that it is evolving so quickly and so much knowledge is embedded in the codes generated by templates, that it is very hard to upgrade a project to take advantage of the changing landscape."><y>#</y><d>2017-03-20</d><h>21:15</h><w>deg</w>That&apos;s a great goal.  As a newbie, I&apos;ve found that one of the weaknesses in the Clojure client/server ecosystem is that it is evolving so quickly and so much knowledge is embedded in the codes generated by templates, that it is very hard to upgrade a project to take advantage of the changing landscape.</z><z id="t1490044567" t="mtnygard I agree. It&apos;s not just frustrating for a newbie. Way too much capability is tied up in templates and build tool plugins."><y>#</y><d>2017-03-20</d><h>21:16</h><w>mtnygard</w>I agree. It&apos;s not just frustrating for a newbie. Way too much capability is tied up in templates and build tool plugins.</z><z id="t1490044577" t="deg I know I&apos;m going to hit a learning curve in a few days when I try to introduce the client code into my toy Vase project."><y>#</y><d>2017-03-20</d><h>21:16</h><w>deg</w>I know I&apos;m going to hit a learning curve in a few days when I try to introduce the client code into my toy Vase project.</z><z id="t1490044637" t="mtnygard Do you mean front-end ClojureScript? Or do you mean call-outs to other services?"><y>#</y><d>2017-03-20</d><h>21:17</h><w>mtnygard</w>Do you mean front-end ClojureScript? Or do you mean call-outs to other services?</z><z id="t1490044669" t="deg Until now, I&apos;ve used the framework-like templates that put all the pieces together -- paying the price of manually upgrading each time the landscape improves -- so I don&apos;t really know how to hand-code all the goodness of figwheel + cider + production builds + etc. and Vase doesn&apos;t have this all rolled together. (for better and worse)"><y>#</y><d>2017-03-20</d><h>21:17</h><w>deg</w>Until now, I&apos;ve used the framework-like templates that put all the pieces together -- paying the price of manually upgrading each time the landscape improves -- so I don&apos;t really know how to hand-code all the goodness of figwheel + cider + production builds + etc.  and Vase doesn&apos;t have this all rolled together.  (for better and worse)</z><z id="t1490044744" t="deg Front-end Clojurescript. I like the idea that Vase is client-agnostic; it&apos;s certainly the right way to go. But, I write my clients in CLJS, and it is very convenient having both sides started by the same template framework. I don&apos;t know the right answer."><y>#</y><d>2017-03-20</d><h>21:19</h><w>deg</w>Front-end Clojurescript.  I like the idea that Vase is client-agnostic; it&apos;s certainly the right way to go. But, I write my clients in CLJS, and it is very convenient having both sides started by the same template framework.  I don&apos;t know the right answer.</z><z id="t1490044811" t="mtnygard One thing I&apos;d suggest is this: keep the client app and the Vase service separate. As in, different directories, different project.clj files."><y>#</y><d>2017-03-20</d><h>21:20</h><w>mtnygard</w>One thing I&apos;d suggest is this: keep the client app and the Vase service separate. As in, different directories, different project.clj files.</z><z id="t1490044832" t="mtnygard There&apos;s no need for them to occupy the same project and it just makes everything harder to configure and build."><y>#</y><d>2017-03-20</d><h>21:20</h><w>mtnygard</w>There&apos;s no need for them to occupy the same project and it just makes everything harder to configure and build.</z><z id="t1490044851" t="mtnygard So for the front end, feel free to use a figwheel template app. It&apos;ll work just fine with Vase services."><y>#</y><d>2017-03-20</d><h>21:20</h><w>mtnygard</w>So for the front end, feel free to use a figwheel template app. It&apos;ll work just fine with Vase services.</z><z id="t1490044865" t="mtnygard They just meet at the URLs."><y>#</y><d>2017-03-20</d><h>21:21</h><w>mtnygard</w>They just meet at the URLs.</z><z id="t1490044886" t="mtnygard Once you get a ways down the road, consider creating a third directory, with .cljc files that describe the specs for your data interface."><y>#</y><d>2017-03-20</d><h>21:21</h><w>mtnygard</w>Once you get a ways down the road, consider creating a third directory, with .cljc files that describe the specs for your data interface.</z><z id="t1490044893" t="mtnygard Then include that from both front and back end."><y>#</y><d>2017-03-20</d><h>21:21</h><w>mtnygard</w>Then include that from both front and back end.</z><z id="t1490044918" t="mtnygard There&apos;s a lot of power in creating a metadata driven contract between components."><y>#</y><d>2017-03-20</d><h>21:21</h><w>mtnygard</w>There&apos;s a lot of power in creating a metadata driven contract between components.</z><z id="t1490044928" t="deg Is there a standalone figwheel template? That does sound much more right. My last project was Luminus-based. It was very easy to get started, but I still have no friggin&apos; clue what&apos;s going on in the project.clj."><y>#</y><d>2017-03-20</d><h>21:22</h><w>deg</w>Is there a standalone figwheel template? That does sound much more right. My last project was Luminus-based. It was very easy to get started, but I still have no friggin&apos; clue what&apos;s going on in the project.clj.</z><z id="t1490044951" t="mtnygard Yep. lein new figwheel hello-world"><y>#</y><d>2017-03-20</d><h>21:22</h><w>mtnygard</w>Yep. <code>lein new figwheel hello-world</code></z><z id="t1490044960" t="mtnygard https://github.com/bhauman/figwheel-template"><y>#</y><d>2017-03-20</d><h>21:22</h><w>mtnygard</w><a href="https://github.com/bhauman/figwheel-template" target="_blank">https://github.com/bhauman/figwheel-template</a></z><z id="t1490045063" t="deg Thx. I&apos;ll take a look at that soon. I definitely like the idea of separate, understandable, projects."><y>#</y><d>2017-03-20</d><h>21:24</h><w>deg</w>Thx.  I&apos;ll take a look at that soon.  I definitely like the idea of separate, understandable, projects.</z><z id="t1490070801" t="souenzzo I&apos;m thinking of making an interceptor to open datomic connection (single db/connecton for all others interceptos/handler/fns. It&apos;s a good idea? Does anyone do some like?"><y>#</y><d>2017-03-21</d><h>04:33</h><w>souenzzo</w>I&apos;m thinking of making an interceptor to open datomic connection (single db/connecton for all others interceptos/handler/fns. It&apos;s a good idea? Does anyone do some like?</z><z id="t1490093434" t="manutter51 Well this is weird. I started a new pedestal service project (weekend project) and added in the ring-middlewares session interceptor with a custom redis-based session store. Saturday it all worked fine, and then on Sunday I started getting No matching ctor found for class io.pedestal.http.ring_middlewares$response_fn_adapter$fn__11673 every time I try to start a REPL"><y>#</y><d>2017-03-21</d><h>10:50</h><w>manutter51</w>Well this is weird. I started a new pedestal service project (weekend project) and added in the ring-middlewares session interceptor with a custom redis-based session store. Saturday it all worked fine, and then on Sunday I started getting <code>No matching ctor found for class io.pedestal.http.ring_middlewares$response_fn_adapter$fn__11673</code> every time I try to start a REPL</z><z id="t1490093522" t="manutter51 I’ve commented out the work I did since the last known good state, and I’ve added in the exclusions recommended by lein deps :tree and done numerous lein clean s. Not sure how to proceed from here."><y>#</y><d>2017-03-21</d><h>10:52</h><w>manutter51</w>I’ve commented out the work I did since the last known good state, and I’ve added in the exclusions recommended by <code>lein deps :tree</code> and done numerous <code>lein clean</code>s. Not sure how to proceed from here.</z><z id="t1490093556" t="manutter51 I have to head in to work now, but I’ll check this channel later in case anybody has any ideas/suggestions"><y>#</y><d>2017-03-21</d><h>10:52</h><w>manutter51</w>I have to head in to work now, but I’ll check this channel later in case anybody has any ideas/suggestions</z><z id="t1490093668" t="manutter51 Here’s a relevant chunk of code from my service.clj file"><y>#</y><d>2017-03-21</d><h>10:54</h><w>manutter51</w>Here’s a relevant chunk of code from my <code>service.clj</code> file</z><z id="t1490097697" t="deg &lt;vent&gt; This has to be the single most frustrating part of Clojure programming. I thought spec would clean up all these mess, but not yet, I guess &lt;/vent&gt; I just wrote a few dozen lines of in the ..._service.end file, trying out what I can do with Vase. Then restarted the program and got barfed at with &quot;Don&apos;t know how to create ISeq from: clojure.lang.Keyword&quot; from deep in the EdnReader parsing the file. Couldn&apos;t the error message have the grace to at least report a line number, if not the full line of input or at least the unexpected keyword?? I&apos;ll find the problem, of course. I&apos;ll divide-and-conquer until it&apos;s down to an obvious small bit. Then, I&apos;ll slap my head and fix my dumb typo. But, why!!"><y>#</y><d>2017-03-21</d><h>12:01</h><w>deg</w>&lt;vent&gt; This has to be the single most frustrating part of Clojure programming. I thought spec would clean up all these mess, but not yet, I guess &lt;/vent&gt;

I just wrote a few dozen lines of in the ..._service.end file, trying out what I can do with Vase.  Then restarted the program and got barfed at with &quot;Don&apos;t know how to create ISeq from: clojure.lang.Keyword&quot; from deep in the EdnReader parsing the file. Couldn&apos;t the error message have the grace to at least report a line number, if not the full line of input or at least the unexpected keyword??

I&apos;ll find the problem, of course.  I&apos;ll divide-and-conquer until it&apos;s down to an obvious small bit. Then, I&apos;ll slap my head and fix my dumb typo.  But, why!!</z><z id="t1490098632" t="deg Yeah, found it. And, yeah, it was a silly typo. And, yeah, I fixed it and restarted again. And, yup, there was another typo. And... a bunch later all fixed and the program starts. But, argghhhh!!"><y>#</y><d>2017-03-21</d><h>12:17</h><w>deg</w>Yeah, found it. And, yeah, it was a silly typo. And, yeah, I fixed it and restarted again. And, yup, there was another typo. And... a bunch later all fixed and the program starts.  But, argghhhh!!</z><z id="t1490099900" t="rauh [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] Printing the entire stacktrace didn&apos;t show the line? With Cursive you can even &quot;print last exception&quot; and just click on it and you usually see the problem right away."><y>#</y><d>2017-03-21</d><h>12:38</h><w>rauh</w><a>@deg</a> Printing the entire stacktrace didn&apos;t show the line? With Cursive you can even &quot;print last exception&quot; and just click on it and you usually see the problem right away.</z><z id="t1490100594" t="deg No. It showed the line that called the EdnReader. The root problem, I guess, is that Vase is reading a data file, not compiling a program. But, the data file has the size, complexity, and written-by-a-fallible-human attributes of a program."><y>#</y><d>2017-03-21</d><h>12:49</h><w>deg</w>No.  It showed the line that called the EdnReader.  The root problem, I guess, is that Vase is reading a data file, not compiling a program. But, the data file has the size, complexity, and written-by-a-fallible-human attributes of a program.</z><z id="t1490101617" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , using an interceptor to create a Datomic connection and make it available to downstream interceptors/handlers is perfectly acceptable"><y>#</y><d>2017-03-21</d><h>13:06</h><w>ddeaguiar</w><a>@souenzzo</a>, using an interceptor to create a Datomic connection and make it available to downstream interceptors/handlers is perfectly acceptable</z><z id="t1490101663" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , it’s common to make both a db and connection available"><y>#</y><d>2017-03-21</d><h>13:07</h><w>ddeaguiar</w><a>@souenzzo</a>, it’s common to make both a db and connection available</z><z id="t1490119859" t="souenzzo 😜 https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/db.clj#L20"><y>#</y><d>2017-03-21</d><h>18:10</h><r>souenzzo</r><b>😜</b>
<a href="https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/db.clj#L20" target="_blank">https://github.com/rkneufeld/pedestal-micro/blob/master/src/leiningen/new/pedestal_micro/db.clj#L20</a></z><z id="t1490120309" t="ddeaguiar yep 🙂 ."><y>#</y><d>2017-03-21</d><h>18:18</h><r>ddeaguiar</r>yep <b>🙂</b>.</z><z id="t1490120414" t="ddeaguiar Thanks for pointing that out. I have seen it before but never used it on a project. You may also be interested in http://www.rkn.io/2014/12/16/datomic-antipatterns-eager-conn/"><y>#</y><d>2017-03-21</d><h>18:20</h><r>ddeaguiar</r>Thanks for pointing that out. I have seen it before but never used it on a project. You may also be interested in <a href="http://www.rkn.io/2014/12/16/datomic-antipatterns-eager-conn/" target="_blank">http://www.rkn.io/2014/12/16/datomic-antipatterns-eager-conn/</a></z><z id="t1490120446" t="ddeaguiar I’m pretty sure that project influenced my approach as well"><y>#</y><d>2017-03-21</d><h>18:20</h><r>ddeaguiar</r>I’m pretty sure that project influenced my approach as well</z><z id="t1490129087" t="souenzzo It&apos;s on vase too https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/datomic.clj#L36"><y>#</y><d>2017-03-21</d><h>20:44</h><r>souenzzo</r>It&apos;s on <code>vase</code> too
<a href="https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/datomic.clj#L36" target="_blank">https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/datomic.clj#L36</a></z><z id="t1490129170" t="ddeaguiar Nice"><y>#</y><d>2017-03-21</d><h>20:46</h><r>ddeaguiar</r>Nice</z><z id="t1490101945" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] , I can’t identify the root cause of your error from the snippet you pasted but I’m curious as to why you don’t enable sessions via the service map."><y>#</y><d>2017-03-21</d><h>13:12</h><w>ddeaguiar</w><a>@manutter51</a>, I can’t identify the root cause of your error from the snippet you pasted but I’m curious as to why you don’t enable sessions via the service map.</z><z id="t1490101947" t="mtnygard [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] That is a very strange exception. Have you changed Pedestal or Clojure versions in your project.clj file?"><y>#</y><d>2017-03-21</d><h>13:12</h><w>mtnygard</w><a>@manutter51</a> That is a very strange exception. Have you changed Pedestal or Clojure versions in your project.clj file?</z><z id="t1490101979" t="ddeaguiar my question is likely a tangent though..."><y>#</y><d>2017-03-21</d><h>13:12</h><w>ddeaguiar</w>my question is likely a tangent though...</z><z id="t1490102020" t="mtnygard [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] lein clean doesn&apos;t remove quite everything... you may need to prune some parts of your ~/.m2/repository tree. Try removing org/clojure and io/pedestal to force a re-download of those jars."><y>#</y><d>2017-03-21</d><h>13:13</h><w>mtnygard</w><a>@manutter51</a> <code>lein clean</code> doesn&apos;t remove quite everything... you may need to prune some parts of your ~/.m2/repository tree. Try removing org/clojure and io/pedestal to force a re-download of those jars.</z><z id="t1490102411" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] When I first read your complaint about the error I thought it was something internal to Clojure itself. On second glance, though, it looks like something we might be able to address in Vase. Can you send me some details in a PM? I&apos;d like to see if we can make a better error message."><y>#</y><d>2017-03-21</d><h>13:20</h><w>mtnygard</w><a>@deg</a> When I first read your complaint about the error I thought it was something internal to Clojure itself. On second glance, though, it looks like something we might be able to address in Vase. Can you send me some details in a PM? I&apos;d like to see if we can make a better error message.</z><z id="t1490104525" t="deg Ok. I&apos;ll PM you more details in a minute"><y>#</y><d>2017-03-21</d><h>13:55</h><w>deg</w>Ok.  I&apos;ll PM you more details in a minute</z><z id="t1490108961" t="deg For debugging my Vase app, what is the syntax for a query that returns the entire db?"><y>#</y><d>2017-03-21</d><h>15:09</h><w>deg</w>For debugging my Vase app, what is the syntax for a query that returns the entire db?</z><z id="t1490109500" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] There are two ways to approach this. One is to use the datoms function and just get all datoms in total. The other would be to run a query with [:find ?e ?a ?v :where [?e ?a ?v]] . The second one only works if your whole db fits in memory."><y>#</y><d>2017-03-21</d><h>15:18</h><w>mtnygard</w><a>@deg</a> There are two ways to approach this. One is to use the <code>datoms</code> function and just get all datoms in total. The other would be to run a query with <code>[:find ?e ?a ?v :where [?e ?a ?v]]</code>. The second one only works if your whole db fits in memory.</z><z id="t1490109556" t="deg Thanks. Memory is not a problem at this stage; I&apos;d still fit on a PDP-8 🙂"><y>#</y><d>2017-03-21</d><h>15:19</h><w>deg</w>Thanks.  Memory is not a problem at this stage; I&apos;d still fit on a PDP-8 <b>🙂</b></z><z id="t1490109730" t="deg But, for your datoms solution... where can I get hold of the db? It seems to be passed implicitly in the current query syntax."><y>#</y><d>2017-03-21</d><h>15:22</h><w>deg</w>But, for your <code>datoms</code> solution... where can I get hold of the db? It seems to be passed implicitly in the current query syntax.</z><z id="t1490109804" t="deg Hmm, and for the second solution, I get` Interceptor Exception: :db.error/insufficient-binding Insufficient binding of db clause: [?e ?a ?v] would cause full scan`"><y>#</y><d>2017-03-21</d><h>15:23</h><w>deg</w>Hmm, and for the second solution, I get` Interceptor Exception: :db.error/insufficient-binding Insufficient binding of db clause: [?e ?a ?v] would cause full scan`</z><z id="t1490109854" t="mtnygard You&apos;d do that with an interceptor: #vase/intercept {:name :dump-db :enter (fn [ctx] (assoc ctx :response {:status 200 :body (datomic.api/datoms (-&gt; ctx :request :db) :eavt)}))}"><y>#</y><d>2017-03-21</d><h>15:24</h><w>mtnygard</w>You&apos;d do that with an interceptor:

<code>#vase/intercept {:name :dump-db :enter (fn [ctx] (assoc ctx :response {:status 200 :body (datomic.api/datoms (-&gt; ctx :request :db) :eavt)}))}</code></z><z id="t1490109872" t="mtnygard Ah, that&apos;s new."><y>#</y><d>2017-03-21</d><h>15:24</h><w>mtnygard</w>Ah, that&apos;s new.</z><z id="t1490109886" t="mtnygard Stick with datoms then, I guess."><y>#</y><d>2017-03-21</d><h>15:24</h><w>mtnygard</w>Stick with <code>datoms</code> then, I guess.</z><z id="t1490109975" t="deg 1) So, I assume that&apos;s some zealous protection against loading the whole db? Why needed? 2) In you snippet, what is namespace d ?"><y>#</y><d>2017-03-21</d><h>15:26</h><w>deg</w>1) So, I assume that&apos;s some zealous protection against loading the whole db?  Why needed?
2) In you snippet, what is namespace <code>d</code>?</z><z id="t1490110028" t="mtnygard Edited. I wrote that off the top of my head, then remembered that it would be evaluated in a context that may not have the usual requires."><y>#</y><d>2017-03-21</d><h>15:27</h><w>mtnygard</w>Edited. I wrote that off the top of my head, then remembered that it would be evaluated in a context that may not have the usual requires.</z><z id="t1490110049" t="mtnygard As for your first question, I can&apos;t answer it. That would be a Q for the Datomic gang."><y>#</y><d>2017-03-21</d><h>15:27</h><w>mtnygard</w>As for your first question, I can&apos;t answer it. That would be a Q for the Datomic gang.</z><z id="t1490110182" t="deg So, with &quot;/dump&quot; I get `Interceptor Exception: You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?`"><y>#</y><d>2017-03-21</d><h>15:29</h><w>deg</w>So, with <code>&quot;/dump&quot; </code>
I get 
`Interceptor Exception: You&apos;re trying to use something as an interceptor
                           that isn&apos;t supported by the protocol; Perhaps you need to extend it?`</z><z id="t1490110218" t="mtnygard one minute"><y>#</y><d>2017-03-21</d><h>15:30</h><w>mtnygard</w>one minute</z><z id="t1490110280" t="mtnygard &quot;/dump&quot; {:get "><y>#</y><d>2017-03-21</d><h>15:31</h><w>mtnygard</w><code>&quot;/dump&quot; {:get </code></z><z id="t1490110301" t="mtnygard It&apos;s like any other literal... has to have a verb"><y>#</y><d>2017-03-21</d><h>15:31</h><w>mtnygard</w>It&apos;s like any other literal... has to have a verb</z><z id="t1490110310" t="deg oops"><y>#</y><d>2017-03-21</d><h>15:31</h><w>deg</w>oops</z><z id="t1490110396" t="deg Hmm, now the query is not returning. But, I have to run help my kids. Back in a bit, hopefully after I find my typo."><y>#</y><d>2017-03-21</d><h>15:33</h><w>deg</w>Hmm, now the query is not returning.  But, I have to run help my kids. Back in a bit, hopefully after I find my typo.</z><z id="t1490112473" t="deg That body (datomic.api/datoms (-&gt; ctx :request :db) :eavt) returns an object that does not implement :default-content-type. It is datomic.db$datoms$reify__1965@26eb24d0"><y>#</y><d>2017-03-21</d><h>16:07</h><w>deg</w>That body <code> (datomic.api/datoms (-&gt; ctx :request :db) :eavt)</code> returns an object that does not implement :default-content-type.  It is <code>datomic.db$datoms$reify__1965@26eb24d0</code></z><z id="t1490112854" t="manutter51 [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks for the responses. I’m fairly new to pedestal service, and I missed the part about configuring enable-session in the service map, so I’ll try that when I get home. I did happen to try upgrading to alpha15 and reverted back to alpha14 (of 1.9.0) when I got a bunch of spec errors. I tried deleting the pedestal stuff from my .m2 directory but didn’t think of doing the same with org.clojure, so I’ll try that also."><y>#</y><d>2017-03-21</d><h>16:14</h><w>manutter51</w><a>@ddeaguiar</a> <a>@mtnygard</a> Thanks for the responses. I’m fairly new to pedestal service, and I missed the part about configuring enable-session in the service map, so I’ll try that when I get home. I did happen to try upgrading to alpha15 and reverted back to alpha14 (of 1.9.0) when I got a bunch of spec errors. I tried deleting the pedestal stuff from my .m2 directory but didn’t think of doing the same with org.clojure, so I’ll try that also.</z><z id="t1490112856" t="manutter51 thanks agai"><y>#</y><d>2017-03-21</d><h>16:14</h><w>manutter51</w>thanks agai</z><z id="t1490112860" t="manutter51 s/agai/again"><y>#</y><d>2017-03-21</d><h>16:14</h><w>manutter51</w>s/agai/again</z><z id="t1490112903" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] try wrapping it with seq"><y>#</y><d>2017-03-21</d><h>16:15</h><w>mtnygard</w><a>@deg</a> try wrapping it with seq</z><z id="t1490113370" t="deg Tried that. Didn&apos;t work. clojure.lang.LazySeq@1c94d503"><y>#</y><d>2017-03-21</d><h>16:22</h><w>deg</w>Tried that.  Didn&apos;t work. <code>clojure.lang.LazySeq@1c94d503</code></z><z id="t1490113374" t="deg and first of that gives..."><y>#</y><d>2017-03-21</d><h>16:22</h><w>deg</w>and first of that gives...</z><z id="t1490113431" t="deg datomic.db.Datum@3aad15de"><y>#</y><d>2017-03-21</d><h>16:23</h><w>deg</w><code>datomic.db.Datum@3aad15de</code></z><z id="t1490114188" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] , check out http://pedestal.io/reference/service-map re: enabling session via the service map."><y>#</y><d>2017-03-21</d><h>16:36</h><w>ddeaguiar</w><a>@manutter51</a>, check out <a href="http://pedestal.io/reference/service-map" target="_blank">http://pedestal.io/reference/service-map</a> re: enabling session via the service map.</z><z id="t1490119286" t="manutter51 Yeah, I found it right away once I knew I ought to be looking for it 🙂"><y>#</y><d>2017-03-21</d><h>18:01</h><w>manutter51</w>Yeah, I found it right away once I knew I ought to be looking for it <b>🙂</b></z><z id="t1490141300" t="bradford Hi! How do I configure jetty&apos;s maxidleconnections in a service? Right now I&apos;m doing: (def service {:env :prod ;; You can bring your own non-default interceptors. Make ;; sure you include routing and set it up right for ;; dev-mode. If you do, many other keys for configuring ;; default interceptors will be ignored. ;; :http/interceptors [] ::http/routes routes ;; Root for resource interceptor that is available by default. ::http/resource-path &quot;/public&quot; ;; Either :jetty or :tomcat (see comments in project.clj ;; to enable Tomcat) ::http/type :jetty ::http/port 8080})"><y>#</y><d>2017-03-22</d><h>00:08</h><w>bradford</w>Hi! How do I configure jetty&apos;s <code>maxidleconnections</code> in a service? Right now I&apos;m doing: <pre>(def service {:env :prod
              ;; You can bring your own non-default interceptors. Make
              ;; sure you include routing and set it up right for
              ;; dev-mode. If you do, many other keys for configuring
              ;; default interceptors will be ignored.
              ;; :http/interceptors []
              ::http/routes routes
              ;; Root for resource interceptor that is available by default.
              ::http/resource-path &quot;/public&quot;
              ;; Either :jetty or :tomcat (see comments in project.clj
              ;; to enable Tomcat)
              ::http/type :jetty
              ::http/port 8080})</pre></z><z id="t1490149188" t="manutter51 Interesting, I tried lein clean plus deleting io.pedestal and org.clojure from my .m2 directory, and now I’m getting No matching ctor found for class io.pedestal.interceptor.helpers$on_request$fn__8950 , which I’m not using anywhere in my project."><y>#</y><d>2017-03-22</d><h>02:19</h><w>manutter51</w>Interesting, I tried <code>lein clean</code> plus deleting io.pedestal and org.clojure from my .m2 directory, and now I’m getting <code>No matching ctor found for class io.pedestal.interceptor.helpers$on_request$fn__8950</code>, which I’m not using anywhere in my project.</z><z id="t1490149441" t="manutter51 I think my next attempt is going to be lein new plus incrementally copy over source files from my previous attempt."><y>#</y><d>2017-03-22</d><h>02:24</h><w>manutter51</w>I think my next attempt is going to be <code>lein new</code> plus incrementally copy over source files from my previous attempt.</z><z id="t1490149733" t="mtnygard [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] Are you using any additional libraries that might have been built against an older version of Pedestal? Try adding :pedantic? :abort to your project.clj to see if that&apos;s an issue."><y>#</y><d>2017-03-22</d><h>02:28</h><w>mtnygard</w><a>@manutter51</a> Are you using any additional libraries that might have been built against an older version of Pedestal? Try adding <code>:pedantic? :abort</code> to your project.clj to see if that&apos;s an issue.</z><z id="t1490172378" t="deg I&apos;m trying to write some Vase routes, but I can&apos;t find a full manual or reference. (I&apos;ve been copying from the examples, and mostly understand what&apos;s going on, but not completely). I&apos;ve looked at info about Vase, Datamic, and Datalog, and keep finding more pieces, but I can&apos;t find a doc that gives me the full picture; especially not from a Vase perspective. Where should I look? Ideally, I&apos;d like a doc where I can find answers to questions like: - How do I create a :get route that takes optional parameters? With this, how could I write a query that will find a user if I ask either api/user?name=joe or api/user?id=42 ? - What exactly is :in $ ... - When is it needed to give an entity an explicit id property? I would imagine this is seldom needed, yet it seems to be supplied in each of the Vase samples, so I&apos;m missing some fact here. - Etc.?"><y>#</y><d>2017-03-22</d><h>08:46</h><w>deg</w>I&apos;m trying to write some Vase routes, but I can&apos;t find a full manual or reference. (I&apos;ve been copying from the examples, and mostly understand what&apos;s going on, but not completely). I&apos;ve looked at info about Vase, Datamic, and Datalog, and keep finding more pieces, but I can&apos;t find a doc that gives me the full picture; especially not from a Vase perspective.

Where should I look?
Ideally, I&apos;d like a doc where I can find answers to questions like:
- How do I create a :get route that takes optional parameters? With this, how could I write a query that will find a user if I ask either <code>api/user?name=joe</code> or <code>api/user?id=42</code>?
- What exactly is <code>:in  $ ...</code>
- When is it needed to give an entity an explicit id property? I would imagine this is seldom needed, yet it seems to be supplied in each of the Vase samples, so I&apos;m missing some fact here.
- Etc.?</z><z id="t1490180068" t="manutter51 [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Ok, I added :pedantic? :abort , but same results. Here’s my dependencies, as given by lein deps :tree"><y>#</y><d>2017-03-22</d><h>10:54</h><w>manutter51</w><a>@mtnygard</a> Ok, I added <code>:pedantic? :abort</code>, but same results. Here’s my dependencies, as given by <code>lein deps :tree</code></z><z id="t1490180167" t="manutter51 Hmm, Slack is saying the snippet was truncated, but it’s all there. As far as I can tell there are no pedestal dependencies except the ones I get via pedestal-service and pedestal-jetty."><y>#</y><d>2017-03-22</d><h>10:56</h><w>manutter51</w>Hmm, Slack is saying the snippet was truncated, but it’s all there. As far as I can tell there are no pedestal dependencies except the ones I get via pedestal-service and pedestal-jetty.</z><z id="t1490180223" t="manutter51 Anyway, just for a sanity check, I did a lein new pedestal-service pedestal-test , and that runs just fine. So I guess I’ll just copy over stuff until the new project also breaks."><y>#</y><d>2017-03-22</d><h>10:57</h><w>manutter51</w>Anyway, just for a sanity check, I did a <code>lein new pedestal-service pedestal-test</code>, and that runs just fine. So I guess I’ll just copy over stuff until the new project also breaks.</z><z id="t1490187936" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] I don’t have an answer for you but I’d recommend posting it to the pedestal-users group as well."><y>#</y><d>2017-03-22</d><h>13:05</h><w>ddeaguiar</w><a>@bradford</a> I don’t have an answer for you but I’d recommend posting it to the pedestal-users group as well.</z><z id="t1490188321" t="mtnygard [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] Here&apos;s the answer I got from Paul deGrandis: There is an option within :container-options called :configurator it&apos;s a function that takes and returns the Jetty Server argument it&apos;s the ultimate escape hatch to do whatever you want to the server *as the very last step in setting up the server* https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj#L196 If it&apos;s not passed in, Pedestal sets the function to identity"><y>#</y><d>2017-03-22</d><h>13:12</h><w>mtnygard</w><a>@bradford</a> Here&apos;s the answer I got from Paul deGrandis:

There is an option within :container-options called :configurator
it&apos;s a function that takes and returns the Jetty Server argument
it&apos;s the ultimate escape hatch to do whatever you want to the server *as the very last step in setting up the server*
<a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj#L196" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj#L196</a>
If it&apos;s not passed in, Pedestal sets the function to <code>identity</code></z><z id="t1490188928" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] , thanks for the document suggestions. I was just wondering, though, were you able to find answers to those questions?"><y>#</y><d>2017-03-22</d><h>13:22</h><w>ddeaguiar</w><a>@deg</a>, thanks for the document suggestions. I was just wondering, though, were you able to find answers to those questions?</z><z id="t1490191092" t="deg [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] . Today&apos;s questions? No, not really. I did find some docs, mostly on the Datomic site, and now at least understand the syntax of the :in clause. But. my other questions still have me stumped, and are more at the Vase level."><y>#</y><d>2017-03-22</d><h>13:58</h><w>deg</w><a>@ddeaguiar</a>. Today&apos;s questions?  No, not really.  I did find some docs, mostly on the Datomic site, and now at least understand the syntax of the <code>:in</code> clause. But. my other questions still have me stumped, and are more at the Vase level.</z><z id="t1490191188" t="ddeaguiar Ok, re: parameters, have you seen the Handling Parameters section in the Your First API doc? ( https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md#handling-parameters )"><y>#</y><d>2017-03-22</d><h>13:59</h><w>ddeaguiar</w>Ok, re: parameters, have you seen the Handling Parameters section in the Your First API doc? (<a href="https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md#handling-parameters" target="_blank">https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md#handling-parameters</a>)</z><z id="t1490191302" t="deg Yup, I have read that. Am I missing something? It looks to me like all the parameters are reduced to positional and mandatory by the time they get to the query."><y>#</y><d>2017-03-22</d><h>14:01</h><w>deg</w>Yup, I have read that. Am I missing something? It looks to me like all the parameters are reduced to positional and mandatory by the time they get to the query.</z><z id="t1490191302" t="ddeaguiar re: explicit entity ids, I suspect this has to do with Datomic best practices ( http://docs.datomic.com/best-practices.html#unique-ids-for-external-keys )"><y>#</y><d>2017-03-22</d><h>14:01</h><w>ddeaguiar</w>re: explicit entity ids, I suspect this has to do with Datomic best practices (<a href="http://docs.datomic.com/best-practices.html#unique-ids-for-external-keys" target="_blank">http://docs.datomic.com/best-practices.html#unique-ids-for-external-keys</a>)</z><z id="t1490191378" t="deg Re ids, that&apos;s what I figured, finally. So, best practice would be not to specify an explicit id unless I need it for some external purpose?"><y>#</y><d>2017-03-22</d><h>14:02</h><w>deg</w>Re ids, that&apos;s what I figured, finally. So, best practice would be not to specify an explicit id unless I need it for some external purpose?</z><z id="t1490191396" t="deg This makes complete sense, but is not the first impression that I got from the Vase samples."><y>#</y><d>2017-03-22</d><h>14:03</h><w>deg</w>This makes complete sense, but is not the first impression that I got from the Vase samples.</z><z id="t1490191504" t="ddeaguiar So setting aside Vase for the moment, If you solely rely on the internal :db/id as an external identifier, it makes data migration more difficult"><y>#</y><d>2017-03-22</d><h>14:05</h><w>ddeaguiar</w>So setting aside Vase for the moment, If you solely rely on the internal :db/id as an external identifier, it makes data migration more difficult</z><z id="t1490191593" t="ddeaguiar I need to think about what this means in terms of a Vase-enabled app, but IMHO it’s really not a Datomic-specific issue either. It’s a good recommendation for any backend store that generates identifiers"><y>#</y><d>2017-03-22</d><h>14:06</h><w>ddeaguiar</w>I need to think about what this means in terms of a Vase-enabled app, but IMHO it’s really not a Datomic-specific issue either. It’s a good recommendation for any backend store that generates identifiers</z><z id="t1490191631" t="ddeaguiar datomic has a notion of entity ids and :db/id is just one variant"><y>#</y><d>2017-03-22</d><h>14:07</h><w>ddeaguiar</w>datomic has a notion of entity ids and <code>:db/id</code> is just one variant</z><z id="t1490191680" t="ddeaguiar See http://docs.datomic.com/identity.html#entity-identifiers"><y>#</y><d>2017-03-22</d><h>14:08</h><w>ddeaguiar</w>See <a href="http://docs.datomic.com/identity.html#entity-identifiers" target="_blank">http://docs.datomic.com/identity.html#entity-identifiers</a></z><z id="t1490191730" t="deg I&apos;ll need to think about that, in the context of my current toy application. But, assuming that I do want an external id on my entities, does Vase (or Datomic?) give an easy way to generate unique ids atomically?"><y>#</y><d>2017-03-22</d><h>14:08</h><w>deg</w>I&apos;ll need to think about that, in the context of my current toy application. But, assuming that I do want an external id on my entities, does Vase (or Datomic?) give an easy way to generate unique ids atomically?</z><z id="t1490191775" t="ddeaguiar you can generate unique ids that are Datomic index-friendly using (datomic.api/squuid) ( http://docs.datomic.com/clojure/index.html#datomic.api/squuid )"><y>#</y><d>2017-03-22</d><h>14:09</h><w>ddeaguiar</w>you can generate unique ids that are Datomic index-friendly using <code>(datomic.api/squuid)</code> (<a href="http://docs.datomic.com/clojure/index.html#datomic.api/squuid" target="_blank">http://docs.datomic.com/clojure/index.html#datomic.api/squuid</a>)</z><z id="t1490191834" t="deg Yup, I&apos;ve seen that Datomic section, but have not fully grokked it yet. So, how would I use squuid in the context of a #vase/transact ?"><y>#</y><d>2017-03-22</d><h>14:10</h><w>deg</w>Yup, I&apos;ve seen that Datomic section, but have not fully grokked it yet.  So, how would I use <code>squuid</code> in the context of a <code>#vase/transact</code>?</z><z id="t1490191882" t="deg I think my questions really keep boiling down to &quot;I&apos;m trying to understand how to do things right, but I&apos;m only learning from samples, rather than formal docs that don&apos;t yet exist&quot;"><y>#</y><d>2017-03-22</d><h>14:11</h><w>deg</w>I think my questions really keep boiling down to &quot;I&apos;m trying to understand how to do things right, but I&apos;m only learning from samples, rather than formal docs that don&apos;t yet exist&quot;</z><z id="t1490191994" t="ddeaguiar so to assign your own unique id, you’d need to pass it as part of your entity data in vase transact but"><y>#</y><d>2017-03-22</d><h>14:13</h><w>ddeaguiar</w>so to assign your own unique id, you’d need to pass it as part of your entity data in vase transact but</z><z id="t1490192038" t="ddeaguiar I think Vase will append a :db/id if it’s not present as well"><y>#</y><d>2017-03-22</d><h>14:13</h><w>ddeaguiar</w>I think Vase will append a <code>:db/id</code> if it’s not present as well</z><z id="t1490192052" t="ddeaguiar So you’d need to include both on transact"><y>#</y><d>2017-03-22</d><h>14:14</h><w>ddeaguiar</w>So you’d need to include both on transact</z><z id="t1490192069" t="ddeaguiar but I’d only query by the entity domain identifier"><y>#</y><d>2017-03-22</d><h>14:14</h><w>ddeaguiar</w>but I’d only query by the entity domain identifier</z><z id="t1490192136" t="ddeaguiar I need to go back and dig into Vase more deeply. My understanding of the internals is fuzzy so I’ll stop there before I inadvertently lead you astray."><y>#</y><d>2017-03-22</d><h>14:15</h><w>ddeaguiar</w>I need to go back and dig into Vase more deeply. My understanding of the internals is fuzzy so I’ll stop there before I inadvertently lead you astray.</z><z id="t1490192168" t="deg Yes, Vase does seem to append the :db/id. But the samples, e.g. https://github.com/cognitect-labs/vase/blob/master/samples/pet-store/resources/petstore-simple.edn , do also have a domain-specific identifier in the schema, but seem to assume that it somehow magically comes from the client, even on creation."><y>#</y><d>2017-03-22</d><h>14:16</h><w>deg</w>Yes, Vase does seem to append the :db/id.  But the samples, e.g. <a href="https://github.com/cognitect-labs/vase/blob/master/samples/pet-store/resources/petstore-simple.edn" target="_blank">https://github.com/cognitect-labs/vase/blob/master/samples/pet-store/resources/petstore-simple.edn</a>, do also have a domain-specific identifier in the schema, but seem to assume that it somehow magically comes from the client, even on creation.</z><z id="t1490192207" t="ddeaguiar sure, it needs to come from the client"><y>#</y><d>2017-03-22</d><h>14:16</h><w>ddeaguiar</w>sure, it needs to come from the client</z><z id="t1490192229" t="ddeaguiar or"><y>#</y><d>2017-03-22</d><h>14:17</h><w>ddeaguiar</w>or</z><z id="t1490192237" t="ddeaguiar you can add an interceptor that appends it"><y>#</y><d>2017-03-22</d><h>14:17</h><w>ddeaguiar</w>you can add an interceptor that appends it</z><z id="t1490192268" t="ddeaguiar I don’t think there’s a way to specify an attribute that get’s associated a value automatically upon transaction"><y>#</y><d>2017-03-22</d><h>14:17</h><w>ddeaguiar</w>I don’t think there’s a way to specify an attribute that get’s associated a value automatically upon transaction</z><z id="t1490192300" t="ddeaguiar my instinct tells me that, if anything, that’s would be done by an interceptor sitting in front of the transact action"><y>#</y><d>2017-03-22</d><h>14:18</h><w>ddeaguiar</w>my instinct tells me that, if anything, that’s would be done by an interceptor sitting in front of the transact action</z><z id="t1490192313" t="ddeaguiar At least that’s how I’d do it if I were building a Pedestal app"><y>#</y><d>2017-03-22</d><h>14:18</h><w>ddeaguiar</w>At least that’s how I’d do it if I were building a Pedestal app</z><z id="t1490192358" t="deg For the client to do it, would require some kind of guid, not just e.g. a simple counter maintained on the server. (But, as I write this, I&apos;m thinking that I&apos;m being naive, and not addressing scalability. So, maybe I&apos;m just blowing smoke here)."><y>#</y><d>2017-03-22</d><h>14:19</h><w>deg</w>For the client to do it, would require some kind of guid, not just e.g. a simple counter maintained on the server.    (But, as I write this, I&apos;m thinking that I&apos;m being naive, and not addressing scalability.  So, maybe I&apos;m just blowing smoke here).</z><z id="t1490192397" t="deg In any event, this seems like a good paragraph to add somewhere into the docs."><y>#</y><d>2017-03-22</d><h>14:19</h><w>deg</w>In any event, this seems like a good paragraph to add somewhere into the docs.</z><z id="t1490192433" t="ddeaguiar Again, thanks for the great feedback. I realize that the docs are failing you atm. We’re looking to fix that"><y>#</y><d>2017-03-22</d><h>14:20</h><w>ddeaguiar</w>Again, thanks for the great feedback. I realize that the docs are failing you atm. We’re looking to fix that</z><z id="t1490192447" t="deg Any thoughts on my other question (how could I write a query that will find a user if I ask either api/user?name=joe or api/user?id=42 )?"><y>#</y><d>2017-03-22</d><h>14:20</h><w>deg</w>Any thoughts on my other question (how could I write a query that will find a user if I ask either <code>api/user?name=joe</code> or <code>api/user?id=42</code>)?</z><z id="t1490192495" t="deg Thanks. I&apos;m happy to keep helping with the docs, but my knowledge is still limited. I&apos;ve made a few small PRs, but am afraid to document too much when I&apos;m just guessing."><y>#</y><d>2017-03-22</d><h>14:21</h><w>deg</w>Thanks. I&apos;m happy to keep helping with the docs, but my knowledge is still limited. I&apos;ve made a few small PRs, but am afraid to document too much when I&apos;m just guessing.</z><z id="t1490192690" t="ddeaguiar Regarding your query question, I don’t know off hand but I’d guess it’s doable using an or query predicate. I’d have to try it"><y>#</y><d>2017-03-22</d><h>14:24</h><w>ddeaguiar</w>Regarding your query question, I don’t know off hand but I’d guess it’s doable using an <code>or</code> query predicate. I’d have to try it</z><z id="t1490192733" t="ddeaguiar To clarify, include both params in the :params collection, and use an or in the :query"><y>#</y><d>2017-03-22</d><h>14:25</h><w>ddeaguiar</w>To clarify, include both params in the <code>:params</code> collection, and use an <code>or</code> in the <code>:query</code></z><z id="t1490192749" t="ddeaguiar But I’ve not tried it!"><y>#</y><d>2017-03-22</d><h>14:25</h><w>ddeaguiar</w>But I’ve not tried it!</z><z id="t1490192766" t="deg [I have to run... back in a bit, one fast reply] I did try or , but failed to get it to work; with an obscure error message."><y>#</y><d>2017-03-22</d><h>14:26</h><w>deg</w>[I have to run... back in a bit, one fast reply]  I did try <code>or</code>, but failed to get it to work; with an obscure error message.</z><z id="t1490192799" t="ddeaguiar hmm, I’m going to try that later today. I’m curious"><y>#</y><d>2017-03-22</d><h>14:26</h><w>ddeaguiar</w>hmm, I’m going to try that later today. I’m curious</z><z id="t1490268045" t="deg Well, I found a way to express, but it&apos;s ugly. Hope there is some nicer way to do this! ` :get #vase/query {:name :receipts-server.v1/user-get :params [name abbrev email] :query [:find ?e ?attr ?val ?found-email ?found-name ?found-abbrev ;; DBG :in $ ?name ?abbrev ?email :where [(count ?email) ?n-email] [(count ?name) ?n-name] [(count ?abbrev) ?n-abbrev] [(pos? ?n-email) ?p-email] [(pos? ?n-name) ?p-name] [(pos? ?n-abbrev) ?p-abbrev] [(and ?p-email :receipts.user/email) ?attr-email] [(and ?p-name :receipts.user/name) ?attr-name] [(and ?p-abbrev :receipts.user/abbrev) ?attr-abbrev] [(or ?attr-email ?attr-name ?attr-abbrev) ?attr] [(and ?p-email ?email) ?val-email] [(and ?p-name ?name) ?val-name] [(and ?p-abbrev ?abbrev) ?val-abbrev] [(or ?val-email ?val-name ?val-abbrev) ?val] [?e ?attr ?val] [?e :receipts.user/email ?found-email] ;; DBG [?e :receipts.user/name ?found-name] ;; DBG [?e :receipts.user/abbrev ?found-abbrev] ;; DBG ]} `"><y>#</y><d>2017-03-23</d><h>11:20</h><w>deg</w>Well, I found a way to express, but it&apos;s ugly.  Hope there is some nicer way to do this!
`
:get #vase/query {:name :receipts-server.v1/user-get
                                           :params [name abbrev email]
                                           :query [:find ?e
                                                         ?attr ?val ?found-email ?found-name ?found-abbrev ;; DBG
                                                   :in $ ?name ?abbrev ?email
                                                   :where
                                                   [(count ?email) ?n-email]
                                                   [(count ?name) ?n-name]
                                                   [(count ?abbrev) ?n-abbrev]
                                                   [(pos? ?n-email) ?p-email]
                                                   [(pos? ?n-name) ?p-name]
                                                   [(pos? ?n-abbrev) ?p-abbrev]
                                                   [(and ?p-email :receipts.user/email) ?attr-email]
                                                   [(and ?p-name :receipts.user/name) ?attr-name]
                                                   [(and ?p-abbrev :receipts.user/abbrev) ?attr-abbrev]
                                                   [(or ?attr-email ?attr-name ?attr-abbrev) ?attr]
                                                   [(and ?p-email ?email) ?val-email]
                                                   [(and ?p-name ?name) ?val-name]
                                                   [(and ?p-abbrev ?abbrev) ?val-abbrev]
                                                   [(or ?val-email ?val-name ?val-abbrev) ?val]
                                                   [?e ?attr ?val]
                                                   [?e :receipts.user/email ?found-email]   ;; DBG
                                                   [?e :receipts.user/name ?found-name]     ;; DBG
                                                   [?e :receipts.user/abbrev ?found-abbrev] ;; DBG
                                                   ]}
`</z><z id="t1490268135" t="deg (This is for a slightly harder case than what I asked -- three parameters) And, it still requires that the client pass in the empty parameters too, e.g. "><y>#</y><d>2017-03-23</d><h>11:22</h><w>deg</w>(This is for a slightly harder case than what I asked -- three parameters)
And, it still requires that the client pass in the empty parameters too, e.g.
<code></code></z><z id="t1490274331" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] I did get a chance to explore using optional parameters with an or in a query. Here’s a snippet https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb"><y>#</y><d>2017-03-23</d><h>13:05</h><w>ddeaguiar</w><a>@deg</a> I did get a chance to explore using optional parameters with an <code>or</code> in a query. Here’s a snippet <a href="https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb" target="_blank">https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb</a></z><z id="t1490274427" t="ddeaguiar You can specify default values for parameters by using a vector instead of a symbol for the parameter [[foo :some-default] bar] "><y>#</y><d>2017-03-23</d><h>13:07</h><w>ddeaguiar</w>You can specify default values for parameters by using a vector instead of a symbol for the parameter
<pre>[[foo :some-default] bar]
</pre></z><z id="t1490274451" t="ddeaguiar the first member of the vector will be the parameter and the second is the default"><y>#</y><d>2017-03-23</d><h>13:07</h><w>ddeaguiar</w>the first member of the vector will be the parameter and the second is the default</z><z id="t1490274459" t="deg Thanks. I did not know about the ability to supply default values. Not yet documented? Or did I just miss it in the docs?"><y>#</y><d>2017-03-23</d><h>13:07</h><w>deg</w>Thanks.  I did not know about the ability to supply default values. Not yet documented? Or did I just miss it in the docs?</z><z id="t1490274468" t="ddeaguiar looking"><y>#</y><d>2017-03-23</d><h>13:07</h><w>ddeaguiar</w>looking</z><z id="t1490274556" t="deg Re using :or-join, I did try something similar, which failed, but did not checkpoint that attempt so I&apos;m not sure what I did wrong. (The error was something about using different variables in the two clauses, but I think I did about what you did, so dunno)"><y>#</y><d>2017-03-23</d><h>13:09</h><w>deg</w>Re using :or-join, I did try something similar, which failed, but did not checkpoint that attempt so I&apos;m not sure what I did wrong.  (The error was something about using different variables in the two clauses, but I think I did about what you did, so dunno)</z><z id="t1490274561" t="ddeaguiar hmm I don’t see that in the docs but I may have missed it"><y>#</y><d>2017-03-23</d><h>13:09</h><w>ddeaguiar</w>hmm I don’t see that in the docs but I may have missed it</z><z id="t1490274665" t="ddeaguiar When you use an or clause in Datomic queries, all the clauses within it need to use the same set of variables"><y>#</y><d>2017-03-23</d><h>13:11</h><w>ddeaguiar</w>When you use an <code>or</code> clause in Datomic queries, all the clauses within it need to use the same set of variables</z><z id="t1490274703" t="ddeaguiar That’s probably why you saw that error"><y>#</y><d>2017-03-23</d><h>13:11</h><w>ddeaguiar</w>That’s probably why you saw that error</z><z id="t1490274711" t="deg Then, how does your example work, when one clause uses ?email and the other ?id ?"><y>#</y><d>2017-03-23</d><h>13:11</h><w>deg</w>Then, how does your example work, when one clause uses ?email and the other ?id ?</z><z id="t1490274720" t="ddeaguiar I’m using or-join"><y>#</y><d>2017-03-23</d><h>13:12</h><w>ddeaguiar</w>I’m using <code>or-join</code></z><z id="t1490274759" t="deg I thought I saw that erro with or-join . Maybe I&apos;m misremembering"><y>#</y><d>2017-03-23</d><h>13:12</h><w>deg</w>I thought I saw that erro with <code>or-join</code>. Maybe I&apos;m misremembering</z><z id="t1490274861" t="ddeaguiar I’d recommend avoiding overly generalized queries. Queries that include predicates like [?e ?attr ?val]"><y>#</y><d>2017-03-23</d><h>13:14</h><w>ddeaguiar</w>I’d recommend avoiding overly generalized queries. Queries that include predicates like <code>[?e ?attr ?val]</code></z><z id="t1490274957" t="deg I also notice your (pull ?e [*]) clause. I had found pull mentioned in some datomic doc, but had not been able to get the arguments to work for me. Again, I&apos;m puzzled, because I think I tried the same thing in one of my attempts, but it wanted another arg. In any event, pull is also something that should be in the mythical doc I keep harping on. In any event, I&apos;m not tweaking your sample to make sure it works in my file. I&apos;m confused that it looks so close to what I had, yet mine didn&apos;t work. Should take me another 2-3 minutes."><y>#</y><d>2017-03-23</d><h>13:15</h><w>deg</w>I also notice your <code>(pull ?e [*])</code> clause. I had found pull mentioned in some datomic doc, but had not been able to get the arguments to work for me. Again, I&apos;m puzzled, because I think I tried the same thing in one of my attempts, but it wanted another arg.   In any event, <code>pull</code> is also something that should be in the mythical doc I keep harping on.
In any event, I&apos;m not tweaking your sample to make sure it works in my file.  I&apos;m confused that it looks so close to what I had, yet mine didn&apos;t work.  Should take me another 2-3 minutes.</z><z id="t1490274963" t="ddeaguiar Here’s a list of some query best practices http://docs.datomic.com/best-practices.html#most-selective-clauses-first"><y>#</y><d>2017-03-23</d><h>13:16</h><w>ddeaguiar</w>Here’s a list of some query best practices <a href="http://docs.datomic.com/best-practices.html#most-selective-clauses-first" target="_blank">http://docs.datomic.com/best-practices.html#most-selective-clauses-first</a></z><z id="t1490274971" t="ddeaguiar I’m not sure if that ones listed there, though"><y>#</y><d>2017-03-23</d><h>13:16</h><w>ddeaguiar</w>I’m not sure if that ones listed there, though</z><z id="t1490275070" t="ddeaguiar Since Vase is based on Datomic and Pedestal, It’s difficult to determine what’s the essential information to pull from each tech for documentation purposes. Here’s info on pull http://docs.datomic.com/pull.html"><y>#</y><d>2017-03-23</d><h>13:17</h><w>ddeaguiar</w>Since Vase is based on Datomic and Pedestal, It’s difficult to determine what’s the essential information to pull from each tech for documentation purposes. Here’s info on pull <a href="http://docs.datomic.com/pull.html" target="_blank">http://docs.datomic.com/pull.html</a></z><z id="t1490275132" t="ddeaguiar And here’s more on pull in the context of queries http://docs.datomic.com/query.html#pull-expressions"><y>#</y><d>2017-03-23</d><h>13:18</h><w>ddeaguiar</w>And here’s more on pull in the context of queries <a href="http://docs.datomic.com/query.html#pull-expressions" target="_blank">http://docs.datomic.com/query.html#pull-expressions</a></z><z id="t1490275174" t="deg Your gist, with obvious mods, works in my app. No surprise. Thanks!"><y>#</y><d>2017-03-23</d><h>13:19</h><w>deg</w>Your gist, with obvious mods, works in my app. No surprise. Thanks!</z><z id="t1490275184" t="ddeaguiar np"><y>#</y><d>2017-03-23</d><h>13:19</h><w>ddeaguiar</w>np</z><z id="t1490275207" t="deg I wonder what I did different yesterday, but never gonna know. Probably required the exact level of ignorance I had then."><y>#</y><d>2017-03-23</d><h>13:20</h><w>deg</w>I wonder what I did different yesterday, but never gonna know. Probably required the exact level of ignorance I had then.</z><z id="t1490275209" t="ddeaguiar one thing is that if email and id are provided and each match a different user, then you’ll get two records back"><y>#</y><d>2017-03-23</d><h>13:20</h><w>ddeaguiar</w>one thing is that if email and id are provided and each match a different user, then you’ll get two records back</z></g><g id="s4"><z id="t1490275234" t="deg Yup. In general, the semantics of what I&apos;m asking are pretty fuzzy."><y>#</y><d>2017-03-23</d><h>13:20</h><w>deg</w>Yup. In general, the semantics of what I&apos;m asking are pretty fuzzy.</z><z id="t1490275258" t="deg Is there some way to ensure only one is passed in? I suppose that would be done with a one-liner interceptor?"><y>#</y><d>2017-03-23</d><h>13:20</h><w>deg</w>Is there some way to ensure only one is passed in?  I suppose that would be done with a one-liner interceptor?</z><z id="t1490275290" t="deg Actually, with a validator, I guess. right?"><y>#</y><d>2017-03-23</d><h>13:21</h><w>deg</w>Actually, with a validator, I guess. right?</z><z id="t1490275302" t="ddeaguiar hmm, maybe"><y>#</y><d>2017-03-23</d><h>13:21</h><w>ddeaguiar</w>hmm, maybe</z><z id="t1490275398" t="ddeaguiar I’d have to play around with it to say for sure"><y>#</y><d>2017-03-23</d><h>13:23</h><w>ddeaguiar</w>I’d have to play around with it to say for sure</z><z id="t1490275507" t="deg ok. Don&apos;t do so on my behalf; I&apos;m already well past what I need for this toy learning app. But, if you want to expand the docs, it would certainly be great to see examples of this sort. Thanks!"><y>#</y><d>2017-03-23</d><h>13:25</h><w>deg</w>ok.  Don&apos;t do so on my behalf; I&apos;m already well past what I need for this toy learning app.
But, if you want to expand the docs, it would certainly be great to see examples of this sort.
Thanks!</z><z id="t1490275601" t="ddeaguiar BTW, are you using the snapshot release of Vase in your app?"><y>#</y><d>2017-03-23</d><h>13:26</h><w>ddeaguiar</w>BTW, are you using the snapshot release of Vase in your app?</z><z id="t1490275621" t="deg yes, though I&apos;ve not updated it for a day or two. Why?"><y>#</y><d>2017-03-23</d><h>13:27</h><w>deg</w>yes, though I&apos;ve not updated it for a day or two. Why?</z><z id="t1490275662" t="ddeaguiar Just checking, because using multiple parameters with query actions is broken on the current, stable release"><y>#</y><d>2017-03-23</d><h>13:27</h><w>ddeaguiar</w>Just checking, because using multiple parameters with query actions is broken on the current, stable release</z><z id="t1490275667" t="ddeaguiar it’s fixed on master"><y>#</y><d>2017-03-23</d><h>13:27</h><w>ddeaguiar</w>it’s fixed on master</z><z id="t1490275678" t="ddeaguiar so I figured you were using the snapshot release"><y>#</y><d>2017-03-23</d><h>13:27</h><w>ddeaguiar</w>so I figured you were using the snapshot release</z><z id="t1490275680" t="deg Ah, ok. thanks."><y>#</y><d>2017-03-23</d><h>13:28</h><w>deg</w>Ah, ok. thanks.</z><z id="t1490275708" t="deg How often do you plan to release stable versions?"><y>#</y><d>2017-03-23</d><h>13:28</h><w>deg</w>How often do you plan to release stable versions?</z><z id="t1490275762" t="ddeaguiar That’s up to Paul and Mike. I’d need to follow up with them"><y>#</y><d>2017-03-23</d><h>13:29</h><w>ddeaguiar</w>That’s up to Paul and Mike. I’d need to follow up with them</z><z id="t1490275782" t="deg Ah, sorry. I thought you were one of the leads."><y>#</y><d>2017-03-23</d><h>13:29</h><w>deg</w>Ah, sorry. I thought you were one of the leads.</z><z id="t1490275809" t="ddeaguiar Nope, just a contributor."><y>#</y><d>2017-03-23</d><h>13:30</h><w>ddeaguiar</w>Nope, just a contributor.</z><z id="t1490275860" t="deg Then, double thank you. I appreciate all the time and help."><y>#</y><d>2017-03-23</d><h>13:31</h><w>deg</w>Then, double thank you.  I appreciate all the time and help.</z><z id="t1490275893" t="ddeaguiar anytime!"><y>#</y><d>2017-03-23</d><h>13:31</h><w>ddeaguiar</w>anytime!</z><z id="t1490281143" t="ddeaguiar fyi, https://twitter.com/datomic_team/status/844919159926476801"><y>#</y><d>2017-03-23</d><h>14:59</h><w>ddeaguiar</w>fyi, <a href="https://twitter.com/datomic_team/status/844919159926476801" target="_blank">https://twitter.com/datomic_team/status/844919159926476801</a></z><z id="t1490281146" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] You may enjoy some new Datomic training videos we released today: http://blog.datomic.com/2017/03/new-datomic-training-videos-and-getting.html"><y>#</y><d>2017-03-23</d><h>14:59</h><w>mtnygard</w><a>@deg</a> You may enjoy some new Datomic training videos we released today: <a href="http://blog.datomic.com/2017/03/new-datomic-training-videos-and-getting.html" target="_blank">http://blog.datomic.com/2017/03/new-datomic-training-videos-and-getting.html</a></z><z id="t1490281155" t="ddeaguiar jinx!"><y>#</y><d>2017-03-23</d><h>14:59</h><w>ddeaguiar</w>jinx!</z><z id="t1490281159" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] lol"><y>#</y><d>2017-03-23</d><h>14:59</h><w>mtnygard</w><a>@ddeaguiar</a> lol</z><z id="t1490282566" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] , btw, I realize that my contrived example shared in the gist was based on your desire to use multiple parameters in an or-like way. I’ve updated the gist to indicate how I’d likely implement support for looking up a user by email or id. https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb"><y>#</y><d>2017-03-23</d><h>15:22</h><w>ddeaguiar</w><a>@deg</a>, btw, I realize that my contrived example shared in the gist was based on your desire to use multiple parameters in an or-like way. I’ve updated the gist to indicate how I’d likely implement support for looking up a user by email or id. <a href="https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb" target="_blank">https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb</a></z><z id="t1490295329" t="deg I see. Definitely cleaner, for this case; though I was doing this more as a contrived example. Of course, don&apos;t forget my friend, Mr. &lt;mailto: /cdn-cgi/l/email-protection |jo /cdn-cgi/l/email-protection &gt;. (He&apos;s a cousin of Little Bobby Tables ( https://xkcd.com/327/ )."><y>#</y><d>2017-03-23</d><h>18:55</h><w>deg</w>I see. Definitely cleaner, for this case; though I was doing this more as a contrived example. Of course, don&apos;t forget my friend, Mr. &lt;mailto:<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|jo<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;.  (He&apos;s a cousin of Little Bobby Tables (<a href="https://xkcd.com/327/" target="_blank">https://xkcd.com/327/</a>).</z><z id="t1490295365" t="deg Oh, and replying to above. Thanks for video links. I&apos;ll take a look."><y>#</y><d>2017-03-23</d><h>18:56</h><w>deg</w>Oh, and replying to above. Thanks for video links. I&apos;ll take a look.</z><z id="t1490302941" t="ddeaguiar I’ve got a question for those folks who are interested in Vase."><y>#</y><d>2017-03-23</d><h>21:02</h><w>ddeaguiar</w>I’ve got a question for those folks who are interested in Vase.</z><z id="t1490302987" t="ddeaguiar What would be more useful: 1. Links to critical prerequisite Pedestal and Datomic docs or 2. Just-enough Pedestal/Datomic docs to get started?"><y>#</y><d>2017-03-23</d><h>21:03</h><w>ddeaguiar</w>What would be more useful:
1. Links to critical prerequisite Pedestal and Datomic docs or
2. Just-enough Pedestal/Datomic docs to get started?</z><z id="t1490302997" t="ddeaguiar I’m not sure what 2 would look like atm..."><y>#</y><d>2017-03-23</d><h>21:03</h><w>ddeaguiar</w>I’m not sure what 2 would look like atm...</z><z id="t1490336968" t="alanspringfield I would go with 1, that way you don&apos;t have to update the Vase docs everytime the Pedestal docs changes"><y>#</y><d>2017-03-24</d><h>06:29</h><w>alanspringfield</w>I would go with 1, that way you don&apos;t have to update the Vase docs everytime the Pedestal docs changes</z><z id="t1490355988" t="deg 1, with a short roadmap doc."><y>#</y><d>2017-03-24</d><h>11:46</h><w>deg</w>1, with a short roadmap doc.</z><z id="t1490358268" t="manutter51 To follow up on my earlier issue, my fairly new pedestal service started throwing exceptions when starting the REPL, complaining that No matching ctor found for class io.pedestal.http.ring_middlewares$response_fn_adapter$fn__11673 . After numerous lein clean , deleting and re-loading dependencies in ~/.m2 , and other suggestions, I was still getting the error, but today it stopped happening."><y>#</y><d>2017-03-24</d><h>12:24</h><w>manutter51</w>To follow up on my earlier issue, my fairly new pedestal service started throwing exceptions when starting the REPL, complaining that <code>No matching ctor found for class io.pedestal.http.ring_middlewares$response_fn_adapter$fn__11673</code>. After numerous <code>lein clean</code>, deleting and re-loading dependencies in <code>~/.m2</code>, and other suggestions, I was still getting the error, but today it stopped happening.</z><z id="t1490358357" t="mtnygard [:attrs {:href &quot;/_/_/users/U06CM8C3V&quot;}] I hate when bugs just go away on their own. That means they can come back on their own, too."><y>#</y><d>2017-03-24</d><h>12:25</h><w>mtnygard</w><a>@manutter51</a> I hate when bugs just go away on their own. That means they can come back on their own, too.</z><z id="t1490358387" t="manutter51 I didn’t have time this morning to fully test it, but the thing that seems to have done the trick is moving the session configuration to the service map in service.clj . I thought I had done that earlier, but I realized I had added it to the map in server.clj that run-dev merges with the main service map."><y>#</y><d>2017-03-24</d><h>12:26</h><w>manutter51</w>I didn’t have time this morning to fully test it, but the thing that seems to have done the trick is moving the session configuration to the service map in <code>service.clj</code>. I thought I had done that earlier, but I realized I had added it to the map in <code>server.clj</code> that <code>run-dev</code> merges with the main service map.</z><z id="t1490358417" t="manutter51 moving the session setting to the right map seems to have fixed the issue"><y>#</y><d>2017-03-24</d><h>12:26</h><w>manutter51</w>moving the session setting to the right map seems to have fixed the issue</z><z id="t1490358445" t="manutter51 though I have no clue why that particular cause would have that particular effect."><y>#</y><d>2017-03-24</d><h>12:27</h><w>manutter51</w>though I have no clue why that particular cause would have that particular effect.</z><z id="t1490382603" t="kenny Is the only way to exit the interceptor chain by throwing an exception? For example, I have 3 interceptors for my route and interceptor1 decides that the request should not be completed right now (maybe it was an invalid request, user not authorized, the server has other processing duties, etc.). Does interceptor1 have to throw an exception in order to stop subsequent interceptors from running, or is there another way?"><y>#</y><d>2017-03-24</d><h>19:10</h><w>kenny</w>Is the only way to exit the interceptor chain by throwing an exception? For example, I have 3 interceptors for my route and interceptor1 decides that the request should not be completed right now (maybe it was an invalid request, user not authorized, the server has other processing duties, etc.). Does interceptor1 have to throw an exception in order to stop subsequent interceptors from running, or is there another way?</z><z id="t1490382768" t="kenny I believe I found my answer 🙂 http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate"><y>#</y><d>2017-03-24</d><h>19:12</h><w>kenny</w>I believe I found my answer <b>🙂</b> <a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate</a></z><z id="t1490383008" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] you can also have your interceptor return a response"><y>#</y><d>2017-03-24</d><h>19:16</h><w>ddeaguiar</w><a>@kenny</a> you can also have your interceptor return a response</z><z id="t1490383046" t="ddeaguiar Once an interceptor returns a response, the execution of downstream interceptor :enter fns is terminated"><y>#</y><d>2017-03-24</d><h>19:17</h><w>ddeaguiar</w>Once an interceptor returns a response, the execution of downstream interceptor <code>:enter</code> fns is terminated</z><z id="t1490383093" t="ddeaguiar whoops"><y>#</y><d>2017-03-24</d><h>19:18</h><w>ddeaguiar</w>whoops</z><z id="t1490383106" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] not return a response, assoc a response onto the context"><y>#</y><d>2017-03-24</d><h>19:18</h><w>ddeaguiar</w><a>@kenny</a> not return a response, <code>assoc</code> a response onto the context</z><z id="t1490383176" t="ddeaguiar so to state it correctly, once an interceptor assoc’s a response to the context, the execution of downstream interceptor :enter fns is terminated"><y>#</y><d>2017-03-24</d><h>19:19</h><w>ddeaguiar</w>so to state it correctly, once an interceptor assoc’s a response to the context, the execution of downstream interceptor <code>:enter</code> fns is terminated</z><z id="t1490383198" t="kenny Ah gotcha. Unless I missed it, I don&apos;t believe that was mentioned in the docs."><y>#</y><d>2017-03-24</d><h>19:19</h><w>kenny</w>Ah gotcha. Unless I missed it, I don&apos;t believe that was mentioned in the docs.</z><z id="t1490383236" t="kenny Is the :leave called of subsequent interceptors?"><y>#</y><d>2017-03-24</d><h>19:20</h><w>kenny</w>Is the <code>:leave</code> called of subsequent interceptors?</z><z id="t1490383282" t="ddeaguiar so the :leave fn is called for all interceptors that were already executed"><y>#</y><d>2017-03-24</d><h>19:21</h><w>ddeaguiar</w>so the <code>:leave</code> fn is called for all interceptors that were already executed</z><z id="t1490383309" t="kenny Makes sense."><y>#</y><d>2017-03-24</d><h>19:21</h><w>kenny</w>Makes sense.</z><z id="t1490383362" t="ddeaguiar Hmm, I think you’re right about the docs ( http://pedestal.io/reference/interceptors ), they don’t mention this."><y>#</y><d>2017-03-24</d><h>19:22</h><w>ddeaguiar</w>Hmm, I think you’re right about the docs (<a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a>), they don’t mention this.</z><z id="t1490383500" t="kenny Yeah. I&apos;d think it would go under &quot;Interceptor Return Values&quot;"><y>#</y><d>2017-03-24</d><h>19:25</h><w>kenny</w>Yeah. I&apos;d think it would go under &quot;Interceptor Return Values&quot;</z><z id="t1490383525" t="kenny Not sure if you&apos;d ever want to do this but is it possible to terminate the :leave execution as well?"><y>#</y><d>2017-03-24</d><h>19:25</h><w>kenny</w>Not sure if you&apos;d ever want to do this but is it possible to terminate the <code>:leave</code> execution as well?</z><z id="t1490383610" t="kenny Wait I don&apos;t think assoc ing a :response onto the context stops the interceptor flow. I just tried it and my second interceptor got called"><y>#</y><d>2017-03-24</d><h>19:26</h><w>kenny</w>Wait I don&apos;t think <code>assoc</code>ing a <code>:response</code> onto the context stops the interceptor flow. I just tried it and my second interceptor got called</z><z id="t1490383664" t="ddeaguiar hmm, I do this all the time"><y>#</y><d>2017-03-24</d><h>19:27</h><w>ddeaguiar</w>hmm, I do this all the time</z><z id="t1490383675" t="kenny The second interceptor does not get called if I wrap the context with terminate ."><y>#</y><d>2017-03-24</d><h>19:27</h><w>kenny</w>The second interceptor does not get called if I wrap the context with <code>terminate</code>.</z><z id="t1490383754" t="kenny Yeah the second interceptor is definitely getting called even though the context has a :response assoc &apos;ed on it."><y>#</y><d>2017-03-24</d><h>19:29</h><w>kenny</w>Yeah the second interceptor is definitely getting called even though the context has a <code>:response</code> <code>assoc</code>&apos;ed on it.</z><z id="t1490383766" t="kenny I think that makes sense though."><y>#</y><d>2017-03-24</d><h>19:29</h><w>kenny</w>I think that makes sense though.</z><z id="t1490383796" t="kenny Explicit termination is much better than implicit. Usually 😉"><y>#</y><d>2017-03-24</d><h>19:29</h><w>kenny</w>Explicit termination is much better than implicit. Usually <b>😉</b></z><z id="t1490383808" t="ddeaguiar The interceptor after the one which assoc’d the response?"><y>#</y><d>2017-03-24</d><h>19:30</h><w>ddeaguiar</w>The interceptor after the one which assoc’d the response?</z><z id="t1490383814" t="kenny Yes"><y>#</y><d>2017-03-24</d><h>19:30</h><w>kenny</w>Yes</z><z id="t1490383832" t="kenny (def echo {:name :echo :enter (fn [context] (clojure.pprint/pprint context) (let [request (:request context) response (ok context)] (assoc context :response response)))}) (def echo2 {:name :echo2 :enter (fn [context] (println &quot;echo2&quot;) context)}) (def routes (route/expand-routes #{[&quot;/foo&quot; :post [echo echo2] :route-name :foo]})) "><y>#</y><d>2017-03-24</d><h>19:30</h><w>kenny</w><pre>(def echo
  {:name :echo
   :enter
         (fn [context]
           (clojure.pprint/pprint context)
           (let [request (:request context)
                 response (ok context)]
             (assoc context :response response)))})

(def echo2
  {:name  :echo2
   :enter (fn [context]
            (println &quot;echo2&quot;)
            context)})

(def routes
  (route/expand-routes
    #{[&quot;/foo&quot; :post [echo echo2] :route-name :foo]}))
</pre></z><z id="t1490383843" t="kenny echo2 is printed"><y>#</y><d>2017-03-24</d><h>19:30</h><w>kenny</w>echo2 is printed</z><z id="t1490383867" t="ddeaguiar hrmm, interesting"><y>#</y><d>2017-03-24</d><h>19:31</h><w>ddeaguiar</w>hrmm, interesting</z><z id="t1490383907" t="kenny If instead echo calls terminate : (def echo {:name :echo :enter (fn [context] (clojure.pprint/pprint context) (let [request (:request context) response (ok context)] (chain/terminate (assoc context :response response))))}) then echo2 is not printed."><y>#</y><d>2017-03-24</d><h>19:31</h><w>kenny</w>If instead <code>echo</code> calls <code>terminate</code>:
<pre>(def echo
  {:name :echo
   :enter
         (fn [context]
           (clojure.pprint/pprint context)
           (let [request (:request context)
                 response (ok context)]
             (chain/terminate (assoc context :response response))))})
</pre>
then echo2 is not printed.</z><z id="t1490384050" t="ddeaguiar I’m going to play with this because it doesn’t behave how I expected. Perhaps things have changed!"><y>#</y><d>2017-03-24</d><h>19:34</h><w>ddeaguiar</w>I’m going to play with this because it doesn’t behave how I expected. Perhaps things have changed!</z><z id="t1490384141" t="kenny You may be getting unnecessary database load if the chain isn&apos;t actually terminating 🙂"><y>#</y><d>2017-03-24</d><h>19:35</h><w>kenny</w>You may be getting unnecessary database load if the chain isn&apos;t actually terminating <b>🙂</b></z><z id="t1490385896" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] are you using a custom chain provider?"><y>#</y><d>2017-03-24</d><h>20:04</h><w>ddeaguiar</w><a>@kenny</a> are you using a custom chain provider?</z><z id="t1490385922" t="ddeaguiar or a default setup using lein new pedestal-service"><y>#</y><d>2017-03-24</d><h>20:05</h><w>ddeaguiar</w>or a default setup using <code>lein new pedestal-service</code></z><z id="t1490385984" t="kenny This is the ns I&apos;m messing with: http://pastebin.com/eMTkYEwu"><y>#</y><d>2017-03-24</d><h>20:06</h><w>kenny</w>This is the ns I&apos;m messing with: <a href="http://pastebin.com/eMTkYEwu" target="_blank">http://pastebin.com/eMTkYEwu</a></z><z id="t1490386392" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] , so this example ( https://gist.github.com/ddeaguiar/74eed4784848e49fa83179a2086aa9ea ) behaves as I described. Because the :io.pedestal.interceptor.chain/terminators coll on the context has a single predicate which is set by the default servlet chain provider. https://github.com/pedestal/pedestal/blob/41337e41ae773f3c17baeb1c244be13ddf6c28db/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L231"><y>#</y><d>2017-03-24</d><h>20:13</h><w>ddeaguiar</w><a>@kenny</a>, so this example (<a href="https://gist.github.com/ddeaguiar/74eed4784848e49fa83179a2086aa9ea" target="_blank">https://gist.github.com/ddeaguiar/74eed4784848e49fa83179a2086aa9ea</a>) behaves as I described. Because the <code>:io.pedestal.interceptor.chain/terminators</code> coll on the context has a single predicate which is set by the default servlet chain provider. <a href="https://github.com/pedestal/pedestal/blob/41337e41ae773f3c17baeb1c244be13ddf6c28db/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L231" target="_blank">https://github.com/pedestal/pedestal/blob/41337e41ae773f3c17baeb1c244be13ddf6c28db/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L231</a></z><z id="t1490386436" t="ddeaguiar Your example appears to use the default servlet chain provider as well"><y>#</y><d>2017-03-24</d><h>20:13</h><w>ddeaguiar</w>Your example appears to use the default servlet chain provider as well</z><z id="t1490386514" t="ddeaguiar In my example, when you request you’ll see this in the logs 16:01:31.660 [qtp2141354770-51] INFO terminator.service - {:msg &quot;In Terminator&quot;, :line 23} │ 16:01:31.663 [qtp2141354770-51] INFO terminator.service - {:terminators (#function[io.pedestal.http.impl.servlet-interceptor│ 16:01:31.663 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:in check-terminators, :terminate? true, :execution-id│ 16:01:31.664 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 19, :line 239} │ 16:01:31.666 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:interceptor :terminator.service/terminator, :stage :l│ 16:01:31.666 [qtp2141354770-51] INFO terminator.service - {:msg &quot;Leaving Terminator&quot;, :line 29} "><y>#</y><d>2017-03-24</d><h>20:15</h><w>ddeaguiar</w>In my example, when you request <code></code> you’ll see this in the logs
<pre>16:01:31.660 [qtp2141354770-51] INFO  terminator.service - {:msg &quot;In Terminator&quot;, :line 23}                                  │
16:01:31.663 [qtp2141354770-51] INFO  terminator.service - {:terminators (#function[io.pedestal.http.impl.servlet-interceptor│
16:01:31.663 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:in check-terminators, :terminate? true, :execution-id│
16:01:31.664 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 19, :line 239}           │
16:01:31.666 [qtp2141354770-51] DEBUG io.pedestal.interceptor.chain - {:interceptor :terminator.service/terminator, :stage :l│
16:01:31.666 [qtp2141354770-51] INFO  terminator.service - {:msg &quot;Leaving Terminator&quot;, :line 29}
</pre></z><z id="t1490386586" t="ddeaguiar I added the following line to my logback.xml file to log what the interceptor chain is doing: &lt;logger name=&quot;io.pedestal.interceptor.chain&quot; level=&quot;DEBUG&quot; /&gt; "><y>#</y><d>2017-03-24</d><h>20:16</h><w>ddeaguiar</w>I added the following line to my <code>logback.xml</code> file to log what the interceptor chain is doing:
<pre>&lt;logger name=&quot;io.pedestal.interceptor.chain&quot; level=&quot;DEBUG&quot; /&gt;
</pre></z><z id="t1490386776" t="kenny I understand why"><y>#</y><d>2017-03-24</d><h>20:19</h><w>kenny</w>I understand why</z><z id="t1490386787" t="ddeaguiar btw, I also recommend using fully qualified symbols in your routes"><y>#</y><d>2017-03-24</d><h>20:19</h><w>ddeaguiar</w>btw, I also recommend using fully qualified symbols in your routes</z><z id="t1490386887" t="kenny I copied this function from the guide. (defn response [status body &amp; {:as headers}] {:status status :body body :headers headers}) If you don&apos;t provide headers (e.g. (response 200 &quot;foo&quot;) ) then it returns {:status 200, :body &quot;foo&quot;, :headers {}} which is not a ring response. (ring.util.response/response? (response 200 &quot;foo&quot;)) =&gt; false "><y>#</y><d>2017-03-24</d><h>20:21</h><w>kenny</w>I copied this function from the guide.
<pre>(defn response [status body &amp; {:as headers}]
  {:status status :body body :headers headers})
</pre>
If you don&apos;t provide headers (e.g. <code>(response 200 &quot;foo&quot;)</code>) then it returns <code>{:status 200, :body &quot;foo&quot;, :headers {}}</code> which is not a ring response. 
<pre>(ring.util.response/response? (response 200 &quot;foo&quot;))
=&gt; false
</pre></z><z id="t1490386904" t="kenny Instead you need to do this: (defn response [status body &amp; {:as headers}] {:status status :body body :headers (or headers {})}) "><y>#</y><d>2017-03-24</d><h>20:21</h><w>kenny</w>Instead you need to do this: 
<pre>(defn response [status body &amp; {:as headers}]
  {:status status :body body :headers (or headers {})})
</pre></z><z id="t1490386912" t="ddeaguiar BTW, I really appreciate you asking this question. I’ve got a much deeper understanding of chain providers now!"><y>#</y><d>2017-03-24</d><h>20:21</h><w>ddeaguiar</w>BTW, I really appreciate you asking this question. I’ve got a much deeper understanding of chain providers now!</z><z id="t1490386929" t="kenny Once you do that the interceptor chain is terminated when a :response is assoc &apos;ed onto the context."><y>#</y><d>2017-03-24</d><h>20:22</h><w>kenny</w>Once you do that the interceptor chain is terminated when a <code>:response</code> is <code>assoc</code>&apos;ed onto the context.</z><z id="t1490386934" t="kenny Same here 🙂"><y>#</y><d>2017-03-24</d><h>20:22</h><w>kenny</w>Same here <b>🙂</b></z><z id="t1490386964" t="ddeaguiar hrm I think Pedestal needs better response checking"><y>#</y><d>2017-03-24</d><h>20:22</h><w>ddeaguiar</w>hrm I think Pedestal needs better response checking</z><z id="t1490386988" t="ddeaguiar like if something’s assoc’d to the context as :response but it’s not a valid response, then it should at least log a warning"><y>#</y><d>2017-03-24</d><h>20:23</h><w>ddeaguiar</w>like if something’s assoc’d to the context as <code>:response</code> but it’s not a valid response, then it should at least log a warning</z><z id="t1490387016" t="ddeaguiar So, everything that drives Pedestal can be found in the context"><y>#</y><d>2017-03-24</d><h>20:23</h><w>ddeaguiar</w>So, everything that drives Pedestal can be found in the context</z><z id="t1490387086" t="ddeaguiar If you create a custom chain provider and don’t need terminators, then don’t add io.pedestal.interceptor.chain/terminators to the context"><y>#</y><d>2017-03-24</d><h>20:24</h><w>ddeaguiar</w>If you create a custom chain provider and don’t need terminators, then don’t add <code>io.pedestal.interceptor.chain/terminators</code> to the context</z><z id="t1490387156" t="ddeaguiar For example, the Fast Pedestal example creates an initial context https://github.com/pedestal/pedestal/blob/master/samples/fast-pedestal/src/fast_pedestal/fasterjetty_service.clj#L67"><y>#</y><d>2017-03-24</d><h>20:25</h><w>ddeaguiar</w>For example, the Fast Pedestal example creates an initial context <a href="https://github.com/pedestal/pedestal/blob/master/samples/fast-pedestal/src/fast_pedestal/fasterjetty_service.clj#L67" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/fast-pedestal/src/fast_pedestal/fasterjetty_service.clj#L67</a></z><z id="t1490387187" t="ddeaguiar Notice how it lacks some keys"><y>#</y><d>2017-03-24</d><h>20:26</h><w>ddeaguiar</w>Notice how it lacks some keys</z><z id="t1490387228" t="ddeaguiar That’s part of a custom chain provider bound to direct-jetty-provider"><y>#</y><d>2017-03-24</d><h>20:27</h><w>ddeaguiar</w>That’s part of a custom chain provider bound to <code>direct-jetty-provider</code></z><z id="t1490387303" t="ddeaguiar So the nuance is, if you’re using a the default servlet chain provider, or another chain provider which terminates when a response is assoc’d to the context, then you don’t need to call terminate"><y>#</y><d>2017-03-24</d><h>20:28</h><w>ddeaguiar</w>So the nuance is, if you’re using a the default servlet chain provider, or another chain provider which terminates when a response is assoc’d to the context, then you don’t need to call <code>terminate</code></z><z id="t1490387389" t="ddeaguiar I’ll add a quote from ohpauleez &gt; please don&apos;t terminate unless the situation is dire"><y>#</y><d>2017-03-24</d><h>20:29</h><w>ddeaguiar</w>I’ll add a quote from ohpauleez
&gt; please don&apos;t terminate unless the situation is dire</z><z id="t1490387406" t="ddeaguiar meaning, don’t explicitly call terminate"><y>#</y><d>2017-03-24</d><h>20:30</h><w>ddeaguiar</w>meaning, don’t explicitly call <code>terminate</code></z><z id="t1490387498" t="kenny Really the only time you&apos;d want to terminate is after you have returned a response."><y>#</y><d>2017-03-24</d><h>20:31</h><w>kenny</w>Really the only time you&apos;d want to terminate is after you have returned a response.</z><z id="t1490387620" t="ddeaguiar and that’s handled for you"><y>#</y><d>2017-03-24</d><h>20:33</h><w>ddeaguiar</w>and that’s handled for you</z><z id="t1490387625" t="kenny Right"><y>#</y><d>2017-03-24</d><h>20:33</h><w>kenny</w>Right</z><z id="t1490387656" t="ddeaguiar So another thing to remember is that handlers are interceptors"><y>#</y><d>2017-03-24</d><h>20:34</h><w>ddeaguiar</w>So another thing to remember is that handlers are interceptors</z><z id="t1490387665" t="ddeaguiar So all of this makes sense, in retrospect"><y>#</y><d>2017-03-24</d><h>20:34</h><w>ddeaguiar</w>So all of this makes sense, in retrospect</z><z id="t1490387695" t="ddeaguiar but we always put handlers at the end of the interceptor chain"><y>#</y><d>2017-03-24</d><h>20:34</h><w>ddeaguiar</w>but we always put handlers at the end of the interceptor chain</z><z id="t1490387706" t="ddeaguiar I’ve actually never tried to put them anywhere else"><y>#</y><d>2017-03-24</d><h>20:35</h><w>ddeaguiar</w>I’ve actually never tried to put them anywhere else</z><z id="t1490387766" t="kenny Not sure if it&apos;d ever make sense to put them anywhere else"><y>#</y><d>2017-03-24</d><h>20:36</h><w>kenny</w>Not sure if it&apos;d ever make sense to put them anywhere else</z><z id="t1490387795" t="ddeaguiar exactly"><y>#</y><d>2017-03-24</d><h>20:36</h><w>ddeaguiar</w>exactly</z><z id="t1490387812" t="ddeaguiar It doesn’t. Why I’ve never done it"><y>#</y><d>2017-03-24</d><h>20:36</h><w>ddeaguiar</w>It doesn’t. Why I’ve never done it</z><z id="t1490387951" t="ddeaguiar hehe, this was a great rabbit hole!"><y>#</y><d>2017-03-24</d><h>20:39</h><w>ddeaguiar</w>hehe, this was a great rabbit hole!</z><z id="t1490387987" t="kenny On a side note, this came up because I was considering things like authentication. It&apos;s surprising that by default the only Pedestal authentication library geheimtur uses exceptions for control flow: https://github.com/propan/geheimtur/blob/master/src/geheimtur/interceptor.clj#L14"><y>#</y><d>2017-03-24</d><h>20:39</h><w>kenny</w>On a side note, this came up because I was considering things like authentication. It&apos;s surprising that by default the only Pedestal authentication library geheimtur uses exceptions for control flow: <a href="https://github.com/propan/geheimtur/blob/master/src/geheimtur/interceptor.clj#L14" target="_blank">https://github.com/propan/geheimtur/blob/master/src/geheimtur/interceptor.clj#L14</a></z><z id="t1490388094" t="ddeaguiar other auth impls do similar things"><y>#</y><d>2017-03-24</d><h>20:41</h><w>ddeaguiar</w>other auth impls do similar things</z><z id="t1490388101" t="ddeaguiar Take buddy-auth as an example"><y>#</y><d>2017-03-24</d><h>20:41</h><w>ddeaguiar</w>Take buddy-auth as an example</z><z id="t1490388103" t="kenny But it is terrible for perf"><y>#</y><d>2017-03-24</d><h>20:41</h><w>kenny</w>But it is terrible for perf</z><z id="t1490388115" t="ddeaguiar https://github.com/funcool/buddy-auth"><y>#</y><d>2017-03-24</d><h>20:41</h><w>ddeaguiar</w><a href="https://github.com/funcool/buddy-auth" target="_blank">https://github.com/funcool/buddy-auth</a></z><z id="t1490388148" t="kenny Just because other libs do it doesn&apos;t mean it was the right decision. IMO exceptions should only be used for exceptional things, not logic."><y>#</y><d>2017-03-24</d><h>20:42</h><w>kenny</w>Just because other libs do it doesn&apos;t mean it was the right decision. IMO exceptions should only be used for exceptional things, not logic.</z><z id="t1490388160" t="ddeaguiar which, btw, I created a sample demonstrating it’s usage: https://github.com/pedestal/pedestal/pull/503"><y>#</y><d>2017-03-24</d><h>20:42</h><w>ddeaguiar</w>which, btw, I created a sample demonstrating it’s usage: <a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a></z><z id="t1490388167" t="kenny https://github.com/pedestal/pedestal/tree/master/samples/fast-pedestal &gt; Avoid throwing exceptions (especially in interceptors)"><y>#</y><d>2017-03-24</d><h>20:42</h><w>kenny</w><a href="https://github.com/pedestal/pedestal/tree/master/samples/fast-pedestal" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/fast-pedestal</a>
&gt; Avoid throwing exceptions (especially in interceptors)</z><z id="t1490388183" t="ddeaguiar yeah, I tend to agree with you"><y>#</y><d>2017-03-24</d><h>20:43</h><w>ddeaguiar</w>yeah, I tend to agree with you</z><z id="t1490388211" t="kenny Also relevant: https://shipilev.net/blog/2014/exceptional-performance/"><y>#</y><d>2017-03-24</d><h>20:43</h><w>kenny</w>Also relevant: <a href="https://shipilev.net/blog/2014/exceptional-performance/" target="_blank">https://shipilev.net/blog/2014/exceptional-performance/</a></z><z id="t1490388223" t="kenny One of my fav articles on exception performance."><y>#</y><d>2017-03-24</d><h>20:43</h><w>kenny</w>One of my fav articles on exception performance.</z><z id="t1490388343" t="ddeaguiar So, for example, with buddy-auth, you don’t have to throw, you could just return a response as well"><y>#</y><d>2017-03-24</d><h>20:45</h><w>ddeaguiar</w>So, for example, with buddy-auth, you don’t have to throw, you could just return a response as well</z><z id="t1490388356" t="ddeaguiar My sample throws because that’s the default usage"><y>#</y><d>2017-03-24</d><h>20:45</h><w>ddeaguiar</w>My sample throws because that’s the default usage</z><z id="t1490388433" t="kenny Right but because they have throwing as a default usage it hints others that the use of exceptions is acceptable for control flow."><y>#</y><d>2017-03-24</d><h>20:47</h><w>kenny</w>Right but because they have throwing as a default usage it hints others that the use of exceptions is acceptable for control flow.</z><z id="t1490388458" t="ddeaguiar true"><y>#</y><d>2017-03-24</d><h>20:47</h><w>ddeaguiar</w>true</z><z id="t1490388485" t="ddeaguiar So when I write interceptors for things like validation, I short-circuit by returning a response"><y>#</y><d>2017-03-24</d><h>20:48</h><w>ddeaguiar</w>So when I write interceptors for things like validation, I short-circuit by returning a response</z><z id="t1490388490" t="kenny And although it may work, it certainly isn&apos;t performant and there loads of articles about why exceptions shouldn&apos;t be used for that purpose."><y>#</y><d>2017-03-24</d><h>20:48</h><w>kenny</w>And although it may work, it certainly isn&apos;t performant and there loads of articles about why exceptions shouldn&apos;t be used for that purpose.</z><z id="t1490388499" t="kenny Yeah, that&apos;s exactly what I would do."><y>#</y><d>2017-03-24</d><h>20:48</h><w>kenny</w>Yeah, that&apos;s exactly what I would do.</z><z id="t1490388511" t="kenny Anyway, the docs definitely need to be updated."><y>#</y><d>2017-03-24</d><h>20:48</h><w>kenny</w>Anyway, the docs definitely need to be updated.</z><z id="t1490388552" t="ddeaguiar Thanks for the article link. I’ll check that out later"><y>#</y><d>2017-03-24</d><h>20:49</h><w>ddeaguiar</w>Thanks for the article link. I’ll check that out later</z><z id="t1490388612" t="kenny It&apos;s long but I think it&apos;s valuable knowledge 🙂"><y>#</y><d>2017-03-24</d><h>20:50</h><w>kenny</w>It&apos;s long but I think it&apos;s valuable knowledge <b>🙂</b></z><z id="t1490388778" t="kenny I&apos;ll open an issue in pedestal-docs. If I have time this weekend I&apos;ll submit a PR."><y>#</y><d>2017-03-24</d><h>20:52</h><w>kenny</w>I&apos;ll open an issue in pedestal-docs. If I have time this weekend I&apos;ll submit a PR.</z><z id="t1490388847" t="kenny Ah, looks like you already did 🙂"><y>#</y><d>2017-03-24</d><h>20:54</h><w>kenny</w>Ah, looks like you already did <b>🙂</b></z><z id="t1490388863" t="ddeaguiar hehe yeah. Feel free to pick it up"><y>#</y><d>2017-03-24</d><h>20:54</h><w>ddeaguiar</w>hehe yeah. Feel free to pick it up</z><z id="t1490538510" t="deg [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] - in you gist a few days back ( https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb ), what exactly is returned by pull ?e [*] ? In my case - where a single result is found, I&apos;m seeing [[[{&quot;db/id&quot;:17592186045428,&quot;receipts.user/name&quot;:&quot;David Goldfarb&quot;,&quot;...}]]] , but [[]] when there are no matches. It seems that the first case has an extra vector wrapped around it."><y>#</y><d>2017-03-26</d><h>14:28</h><w>deg</w><a>@ddeaguiar</a> - in you gist a few days back (<a href="https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb" target="_blank">https://gist.github.com/ddeaguiar/d93a81282b60a261a2afb53262a3aeeb</a>), what exactly is returned by <code>pull ?e [*]</code>?
In my case - where a single result is found, I&apos;m seeing <code>[[[{&quot;db/id&quot;:17592186045428,&quot;receipts.user/name&quot;:&quot;David Goldfarb&quot;,&quot;...}]]]</code>, but <code>[[]]</code> when there are no matches. It seems that the first case has an extra vector wrapped around it.</z><z id="t1490539500" t="deg Another Vase question (unrelated to previous): It looks like, (judging by the example code, e.g. https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/resources/petstore-full-order.edn ): :get requests take unadorned keywords as parameters to a #vase/query literal. But :post queries need fully namespaced keywords to pass to a #vase/transact . Is this asymmetry really there, or am I misunderstanding something. If so, why?"><y>#</y><d>2017-03-26</d><h>14:45</h><w>deg</w>Another Vase question (unrelated to previous): It looks like, (judging by the example code, e.g. <a href="https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/resources/petstore-full-order.edn" target="_blank">https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/resources/petstore-full-order.edn</a>): <code>:get</code> requests take unadorned keywords as parameters to a <code>#vase/query</code> literal. But <code>:post</code> queries need fully namespaced keywords to pass to a <code>#vase/transact</code>. Is this asymmetry really there, or am I misunderstanding something. If so, why?</z><z id="t1490541415" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] There&apos;s a subtle reason for the difference, and it&apos;s reflected in the way those two different literals are formed. A query often uses parameters that come from the browser in a query string (e.g., for a GET, PUT, or DELETE.) These arrive from Pedestal as either :path-params or :query-params . Their names are URL-encoded by the browser and would be part of the request string in most cases. E.g., GET on /users/mtnygard would have a path that bind the last fragment to :id . None of these have anything to do with the Datomic schema or it&apos;s attribute names."><y>#</y><d>2017-03-26</d><h>15:16</h><w>mtnygard</w><a>@deg</a> There&apos;s a subtle reason for the difference, and it&apos;s reflected in the way those two different literals are formed. A query often uses parameters that come from the browser in a query string (e.g., for a GET, PUT, or DELETE.) These arrive from Pedestal as either <code>:path-params</code> or <code>:query-params</code>. Their names are URL-encoded by the browser and would be part of the request string in most cases. E.g., GET on /users/mtnygard would have a path that bind the last fragment to <code>:id</code>. None of these have anything to do with the Datomic schema or it&apos;s attribute names.</z><z id="t1490541487" t="mtnygard OTOH, transactions are directly dealing with form data. The :properties key on the transact literal is a whitelist of parameters from the form body that directly name Datomic attributes on the given entity. So they may be namespaced if you define your Datomic schema that way."><y>#</y><d>2017-03-26</d><h>15:18</h><w>mtnygard</w>OTOH, transactions are directly dealing with form data. The <code>:properties</code> key on the transact literal is a whitelist of parameters from the form body that directly name Datomic attributes on the given entity. So they may be namespaced if you define your Datomic schema that way.</z><z id="t1490543448" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] - That makes sense; or at least each half makes sense in isolation. But, it feels like the is forcing the creation of asymmetric APIs. I don&apos;t want to speculate about ways to fix it; I have some ideas, but anything I say will be naive and/or wrong at this stage, but it just has a funny smell to me. Are there any public samples of clients that interact with Vase servers? I&apos;d feel more comfortable expressing an opinion once I see how this is used by folks who know what they are doing."><y>#</y><d>2017-03-26</d><h>15:50</h><w>deg</w><a>@mtnygard</a> - That makes sense; or at least each half makes sense in isolation. But, it feels like the is forcing the creation of asymmetric APIs.    I don&apos;t want to speculate about ways to fix it;  I have some ideas, but anything I say will be naive and/or wrong at this stage, but it just has a funny smell to me.
Are there any public samples of clients that interact with Vase servers?  I&apos;d feel more comfortable expressing an opinion once I see how this is used by folks who know what they are doing.</z><z id="t1490638300" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] , regarding your last comment, when I think of form data, I think of traditional forms and the application/x-www-form-urlencoded and multipart/form-data encodings. I’m thinking request body is a more appropriate term."><y>#</y><d>2017-03-27</d><h>18:11</h><w>ddeaguiar</w><a>@mtnygard</a>, regarding your last comment, when I think of form data, I think of traditional forms and the <code>application/x-www-form-urlencoded</code> and <code>multipart/form-data</code> encodings. I’m thinking request body is a more appropriate term.</z><z id="t1490643610" t="deg Actually, are there any good samples of CLJS clients that play nicely with Vase servers? (I know the easy answer is &quot;Vase is REST and REST is standard so anything works&quot;) but it seems to me that the answer is more subtle than that... namespace issues; sharing schemas between client and server; dev tools and environments; etc."><y>#</y><d>2017-03-27</d><h>19:40</h><w>deg</w>Actually, are there any good samples of CLJS clients that play nicely with Vase servers?  (I know the easy answer is &quot;Vase is REST and REST is standard so anything works&quot;) but it seems to me that the answer is more subtle than that... namespace issues; sharing schemas between client and server; dev tools and environments; etc.</z><z id="t1490643729" t="deg I&apos;m wresting many more issues than I would have guessed, trying to write a toy app. Much is my own learning curve, so I&apos;m not yet sure which (if any) of the gaps are real."><y>#</y><d>2017-03-27</d><h>19:42</h><w>deg</w>I&apos;m wresting many more issues than I would have guessed, trying to write a toy app. Much is my own learning curve, so I&apos;m not yet sure which (if any) of the gaps are real.</z><z id="t1490643778" t="ddeaguiar Hmm, I don’t think I’d say Vase is REST. Folks throw around that term loosely nowadays."><y>#</y><d>2017-03-27</d><h>19:42</h><w>ddeaguiar</w>Hmm, I don’t think I’d say Vase is REST. Folks throw around that term loosely nowadays.</z><z id="t1490643824" t="ddeaguiar I think the exclusion of the term REST in the README is done on purpose"><y>#</y><d>2017-03-27</d><h>19:43</h><w>ddeaguiar</w>I think the exclusion of the term REST in the README is done on purpose</z><z id="t1490643872" t="deg You&apos;re right. I should have said something like Vase makes it easy to write REST-like and similar APIs that are designed to play nicely with any standard language for the client app, rather than forcing clients to be CLJS"><y>#</y><d>2017-03-27</d><h>19:44</h><w>deg</w>You&apos;re right. I should have said something like Vase makes it easy to write REST-like and similar APIs that are designed to play nicely with any standard language for the client app, rather than forcing clients to be CLJS</z><z id="t1490643875" t="ddeaguiar re: clients, theoretically any client will do. There is a sample that is intended to be used with Om.next"><y>#</y><d>2017-03-27</d><h>19:44</h><w>ddeaguiar</w>re: clients, theoretically any client will do. There is a sample that is intended to be used with Om.next</z><z id="t1490643897" t="ddeaguiar although Om.next is sorely under documented 😞"><y>#</y><d>2017-03-27</d><h>19:44</h><w>ddeaguiar</w>although Om.next is sorely under documented <b>😞</b></z><z id="t1490643966" t="ddeaguiar Reagent is pretty easy to learn/use https://github.com/reagent-project/reagent"><y>#</y><d>2017-03-27</d><h>19:46</h><w>ddeaguiar</w>Reagent is pretty easy to learn/use <a href="https://github.com/reagent-project/reagent" target="_blank">https://github.com/reagent-project/reagent</a></z><z id="t1490643968" t="deg But, my point -- reinforced by what you just said -- is that Vase&apos;s focus is &quot;any client will do&quot;. It makes it very easy to inter-operate, but may lose some of the extra advantages that come from using one language and, more importantly, one dev environemnt, across the client and server."><y>#</y><d>2017-03-27</d><h>19:46</h><w>deg</w>But, my point -- reinforced by what you just said -- is that Vase&apos;s focus is &quot;any client will do&quot;.  It makes it very easy to inter-operate, but may lose some of the extra advantages that come from using one language and, more importantly, one dev environemnt, across the client and server.</z><z id="t1490643982" t="deg Yes, I use reagent. That part is not the problem."><y>#</y><d>2017-03-27</d><h>19:46</h><w>deg</w>Yes, I use reagent.  That part is not the problem.</z><z id="t1490644125" t="deg It&apos;s more issues like: - namespaced keywords have suddenly become interesting in Clojure 1.9, but I don&apos;t yet have a good model of how to play nicely with them. - Sharing schemas across client and server encourages a three project design (client, server, and a shared code library including the schema). But, the minute I have two Lein packages in my CLJS environment, and actively edit both of them, then a lot of the niceties of Figwheel and friends just disappear."><y>#</y><d>2017-03-27</d><h>19:48</h><w>deg</w>It&apos;s more issues like:
- namespaced keywords have suddenly become interesting in Clojure 1.9, but I don&apos;t yet have a good model of how to play nicely with them.
- Sharing schemas across client and server encourages a three project design (client, server, and a shared code library including the schema). But, the minute I have two Lein packages in my CLJS environment, and actively edit both of them, then a lot of the  niceties of Figwheel and friends just disappear.</z><z id="t1490644394" t="deg My immediate problem is that the ecosystem is so vast and fragmented, that I don&apos;t know yet if (1) I&apos;m hitting known gaps or (2) I&apos;m doing things stupidly/unconventionally, so I&apos;m banging my head against unusual problems or (3) tools/practices do exist to solve my problems, but I&apos;ve simply not found them yet."><y>#</y><d>2017-03-27</d><h>19:53</h><w>deg</w>My immediate problem is that the ecosystem is so vast and fragmented, that I don&apos;t know yet if (1) I&apos;m hitting known gaps or (2) I&apos;m doing things stupidly/unconventionally, so I&apos;m banging my head against unusual problems or (3) tools/practices do exist to solve my problems, but I&apos;ve simply not found them yet.</z><z id="t1490644546" t="ddeaguiar hmm so you don’t have to have different lein projects. You can share code that’s in a cljc file. See https://github.com/clojure/clojurescript/wiki/Using-cljc"><y>#</y><d>2017-03-27</d><h>19:55</h><w>ddeaguiar</w>hmm so you don’t have to have different lein projects. You can share code that’s in a <code>cljc</code> file. See <a href="https://github.com/clojure/clojurescript/wiki/Using-cljc" target="_blank">https://github.com/clojure/clojurescript/wiki/Using-cljc</a></z><z id="t1490644554" t="ddeaguiar It depends on the system you are building"><y>#</y><d>2017-03-27</d><h>19:55</h><w>ddeaguiar</w>It depends on the system you are building</z><z id="t1490644566" t="ddeaguiar But you don’t have to lose tooling support"><y>#</y><d>2017-03-27</d><h>19:56</h><w>ddeaguiar</w>But you don’t have to lose tooling support</z><z id="t1490644630" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I do recommend multiple modules (possibly in different repos) for the client, server, and shared. I can offer “leiningen checkouts” as a feature that eases the pain of using code across libraries. That allows you to avoid repeated “lein install” commands on every code change."><y>#</y><d>2017-03-27</d><h>19:57</h><w>mtnygard</w><a>@deg</a> <a>@ddeaguiar</a> I do recommend multiple modules (possibly in different repos) for the client, server, and shared. I can offer “leiningen checkouts” as a feature that eases the pain of using code across libraries. That allows you to avoid repeated “lein install” commands on every code change.</z><z id="t1490644666" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] Also, if you have a REPL open to a process, you can reload a namespace that belongs to a library just the same way you would reload a namespace from the local project. It just replaces symbol definitions in the JVM."><y>#</y><d>2017-03-27</d><h>19:57</h><w>mtnygard</w><a>@deg</a> Also, if you have a REPL open to a process, you can reload a namespace that belongs to a library just the same way you would reload a namespace from the local project. It just replaces symbol definitions in the JVM.</z><z id="t1490644708" t="mtnygard But more broadly, I sympathize. There are so many different permutations of web framework, client library, build tooling, etc. that it’s hard to find one project that shows a canonical way to connect the parts."><y>#</y><d>2017-03-27</d><h>19:58</h><w>mtnygard</w>But more broadly, I sympathize. There are so many different permutations of web framework, client library, build tooling, etc. that it’s hard to find one project that shows a canonical way to connect the parts.</z><z id="t1490644752" t="mtnygard I’m working on that as I have time available. E.g., there are several projects on my personal github profile that illustrate different combinations of tech."><y>#</y><d>2017-03-27</d><h>19:59</h><w>mtnygard</w>I’m working on that as I have time available. E.g., there are several projects on my personal github profile that illustrate different combinations of tech.</z><z id="t1490644780" t="mtnygard For example: https://github.com/mtnygard/todo-backend-pedestal-vase"><y>#</y><d>2017-03-27</d><h>19:59</h><w>mtnygard</w>For example: <a href="https://github.com/mtnygard/todo-backend-pedestal-vase" target="_blank">https://github.com/mtnygard/todo-backend-pedestal-vase</a></z><z id="t1490644809" t="mtnygard But I don’t have any public projects that connect the front end because that’s a new area for me. I’m just learning the best ways to do that myself."><y>#</y><d>2017-03-27</d><h>20:00</h><w>mtnygard</w>But I don’t have any public projects that connect the front end because that’s a new area for me. I’m just learning the best ways to do that myself.</z><z id="t1490644848" t="deg My previous project used luminus + reagent/react + figwheel + cdier , etc. It was all very nicely integrated and easy to develop. The one tooling downside was that the project.clj was a complete bear. Except for adding new libraries, I was afraid to touch any part of it."><y>#</y><d>2017-03-27</d><h>20:00</h><w>deg</w>My previous project used luminus + reagent/react + figwheel + cdier , etc.  It was all very nicely integrated and easy to develop. The one tooling downside was that the project.clj was a complete bear. Except for adding new libraries, I was afraid to touch any part of it.</z><z id="t1490644890" t="deg This time, I&apos;m playing with Vase. I&apos;m attracted by its leaner feel and better separation of concerns. But, I&apos;m discovering now that this comes with a price."><y>#</y><d>2017-03-27</d><h>20:01</h><w>deg</w>This time, I&apos;m playing with Vase. I&apos;m attracted by its leaner feel and better separation of concerns. But, I&apos;m discovering now that this comes with a price.</z><z id="t1490644902" t="mtnygard I have a non-public project that uses Reagent and figwheel on the client. Vase and custom interceptors on the server. CIDER for everything."><y>#</y><d>2017-03-27</d><h>20:01</h><w>mtnygard</w>I have a non-public project that uses Reagent and figwheel on the client. Vase and custom interceptors on the server. CIDER for everything.</z><z id="t1490644915" t="mtnygard It’s just not something I have the right to open up."><y>#</y><d>2017-03-27</d><h>20:01</h><w>mtnygard</w>It’s just not something I have the right to open up.</z><z id="t1490644923" t="mtnygard (Oh, and there’s an Electron client, to boot.)"><y>#</y><d>2017-03-27</d><h>20:02</h><w>mtnygard</w>(Oh, and there’s an Electron client, to boot.)</z><z id="t1490644935" t="deg Would you be able to get the rights to release a stripped down version of it?"><y>#</y><d>2017-03-27</d><h>20:02</h><w>deg</w>Would you be able to get the rights to release a stripped down version of it?</z><z id="t1490644955" t="mtnygard Most likely. It’ll be a week or so before I can publish anything though."><y>#</y><d>2017-03-27</d><h>20:02</h><w>mtnygard</w>Most likely. It’ll be a week or so before I can publish anything though.</z><z id="t1490644955" t="ddeaguiar Maybe we create an issue to add a sample to the Vase repo?"><y>#</y><d>2017-03-27</d><h>20:02</h><w>ddeaguiar</w>Maybe we create an issue to add a sample to the Vase repo?</z><z id="t1490644972" t="ddeaguiar I’d be happy to pick that up as well"><y>#</y><d>2017-03-27</d><h>20:02</h><w>ddeaguiar</w>I’d be happy to pick that up as well</z><z id="t1490644973" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Without question."><y>#</y><d>2017-03-27</d><h>20:02</h><w>mtnygard</w><a>@ddeaguiar</a> Without question.</z><z id="t1490644985" t="ddeaguiar Ok. I’ll add it"><y>#</y><d>2017-03-27</d><h>20:03</h><w>ddeaguiar</w>Ok. I’ll add it</z><z id="t1490644995" t="mtnygard I think the samples right now kind of miss the mark. They’re either too isolated or too esoteric."><y>#</y><d>2017-03-27</d><h>20:03</h><w>mtnygard</w>I think the samples right now kind of miss the mark. They’re either too isolated or too esoteric.</z><z id="t1490645031" t="deg (FWIW, in my consulting business, I&apos;ve long had a clause in my contracts distinguishing between code that belongs to my clients and code that belongs to my library -- and I&apos;ve always kept the right to add my library while working on client projects. In decades of doing this, I&apos;ve never had a client complain, and it added value for them and all future clients)"><y>#</y><d>2017-03-27</d><h>20:03</h><w>deg</w>(FWIW, in my consulting business, I&apos;ve long had a clause in my contracts distinguishing between code that belongs to my clients and code that belongs to my library -- and I&apos;ve always kept the right to add my library while working on client projects.  In decades of doing this, I&apos;ve never had a client complain, and it added value for them and all future clients)</z><z id="t1490645065" t="mtnygard Yep, we have the same. There’s still a notification process though."><y>#</y><d>2017-03-27</d><h>20:04</h><w>mtnygard</w>Yep, we have the same. There’s still a notification process though.</z><z id="t1490645165" t="deg I managed to get away without the notification clause. But, that may have just been a combination of luck and small/intimidated clients. A few much larger companies forced us to sign their contracts, and kept things more isolated, so the point was moot."><y>#</y><d>2017-03-27</d><h>20:06</h><w>deg</w>I managed to get away without the notification clause.  But, that may have just been a combination of luck and small/intimidated clients. A few much larger companies forced us to sign their contracts, and kept things more isolated, so the point was moot.</z><z id="t1490645170" t="deg But, I digress. 🙂"><y>#</y><d>2017-03-27</d><h>20:06</h><w>deg</w>But, I digress.  <b>🙂</b></z><z id="t1490645238" t="deg I&apos;m happy to help out with making samples more usable. I think my outside perspective will help catch holes -- if nothing else, I&apos;ll be helping myself learn better."><y>#</y><d>2017-03-27</d><h>20:07</h><w>deg</w>I&apos;m happy to help out with making samples more usable. I think my outside perspective will help catch holes -- if nothing else, I&apos;ll be helping myself learn better.</z><z id="t1490645359" t="ddeaguiar https://github.com/cognitect-labs/vase/issues/65"><y>#</y><d>2017-03-27</d><h>20:09</h><w>ddeaguiar</w><a href="https://github.com/cognitect-labs/vase/issues/65" target="_blank">https://github.com/cognitect-labs/vase/issues/65</a></z><z id="t1490646134" t="mtnygard OK, authorization procured. Now I need a few hours to strip it down to a manageable sample."><y>#</y><d>2017-03-27</d><h>20:22</h><w>mtnygard</w>OK, authorization procured. Now I need a few hours to strip it down to a manageable sample.</z><z id="t1490680148" t="jimmy is this example relevant ? or we all change to use component reload workflow now ? https://github.com/pedestal/samples/tree/master/auto-reload-server"><y>#</y><d>2017-03-28</d><h>05:49</h><w>jimmy</w>is this example relevant ? or we all change to use component reload workflow now ? 
<a href="https://github.com/pedestal/samples/tree/master/auto-reload-server" target="_blank">https://github.com/pedestal/samples/tree/master/auto-reload-server</a></z><z id="t1490707090" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] That sample repository is deprecated."><y>#</y><d>2017-03-28</d><h>13:18</h><w>ddeaguiar</w><a>@nxqd</a> That sample repository is deprecated.</z><z id="t1490707106" t="ddeaguiar &gt; These samples are deprecated All maintained samples can be found within the Pedestal repository, with further documentation on the Pedestal site."><y>#</y><d>2017-03-28</d><h>13:18</h><w>ddeaguiar</w>&gt; These samples are deprecated All maintained samples can be found within the Pedestal repository, with further documentation on the Pedestal site.</z><z id="t1490707408" t="ddeaguiar Usage of Stuart Sierra’s reloaded workflow is great when using his Component library although the ideas are more generally applicable"><y>#</y><d>2017-03-28</d><h>13:23</h><w>ddeaguiar</w>Usage of Stuart Sierra’s reloaded workflow is great when using his Component library although the ideas are more generally applicable</z><z id="t1490709003" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] ah, my bad."><y>#</y><d>2017-03-28</d><h>13:50</h><w>jimmy</w><a>@ddeaguiar</a> ah, my bad.</z><z id="t1490709036" t="ddeaguiar Not sure about that. I wonder how many folks inadvertently make that mistake"><y>#</y><d>2017-03-28</d><h>13:50</h><w>ddeaguiar</w>Not sure about that. I wonder how many folks inadvertently make that mistake</z><z id="t1490709090" t="jimmy I do use reloaded workflow, but I always think it would be great that new comer knows about it and it should be integrated by default within pedestal."><y>#</y><d>2017-03-28</d><h>13:51</h><w>jimmy</w>I do use reloaded workflow, but I always think it would be great that new comer knows about it and it should be integrated by default within pedestal.</z><z id="t1490709282" t="ddeaguiar I tend to use component-based systems quite frequently but I’ve also found Pedestal’s support for reloading routes while developing quite good and sufficient for most situations."><y>#</y><d>2017-03-28</d><h>13:54</h><w>ddeaguiar</w>I tend to use component-based systems quite frequently but I’ve also found Pedestal’s support for reloading routes while developing quite good and sufficient for most situations.</z><z id="t1490709366" t="ddeaguiar I think the goal with Pedestal is that, once you start a server, you shouldn’t need to restart it to make changes to your handlers/interceptors"><y>#</y><d>2017-03-28</d><h>13:56</h><w>ddeaguiar</w>I think the goal with Pedestal is that, once you start a server, you shouldn’t need to restart it to make changes to your handlers/interceptors</z><z id="t1490709386" t="ddeaguiar Paul talked about this somewhere. I can’t recall off-hand"><y>#</y><d>2017-03-28</d><h>13:56</h><w>ddeaguiar</w>Paul talked about this somewhere. I can’t recall off-hand</z><z id="t1490709566" t="ddeaguiar BTW, service-tools does include ns watching and reloading utilities ( https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj ), but I have to admit that I don’t really use them"><y>#</y><d>2017-03-28</d><h>13:59</h><w>ddeaguiar</w>BTW, service-tools does include ns watching and reloading utilities (<a href="https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj</a>), but I have to admit that I don’t really use them</z><z id="t1490709620" t="ddeaguiar It’s included as a dev dependency in projects built with the pedestal-service template"><y>#</y><d>2017-03-28</d><h>14:00</h><w>ddeaguiar</w>It’s included as a dev dependency in projects built with the <code>pedestal-service</code> template</z><z id="t1490709644" t="mtnygard There&apos;s also this: http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2017-03-28</d><h>14:00</h><w>mtnygard</w>There&apos;s also this: <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1490709694" t="ddeaguiar Yeah, true!"><y>#</y><d>2017-03-28</d><h>14:01</h><w>ddeaguiar</w>Yeah, true!</z><z id="t1490710842" t="jimmy thanks guys 😄"><y>#</y><d>2017-03-28</d><h>14:20</h><w>jimmy</w>thanks guys <b>😄</b></z><z id="t1490710986" t="ddeaguiar I’d like to update that guide at some point. I’m now using component.repl vs reloaded.repl"><y>#</y><d>2017-03-28</d><h>14:23</h><w>ddeaguiar</w>I’d like to update that guide at some point. I’m now using <code>component.repl</code> vs <code>reloaded.repl</code></z><z id="t1490710995" t="ddeaguiar https://github.com/stuartsierra/component.repl"><y>#</y><d>2017-03-28</d><h>14:23</h><w>ddeaguiar</w><a href="https://github.com/stuartsierra/component.repl" target="_blank">https://github.com/stuartsierra/component.repl</a></z><z id="t1490711029" t="ddeaguiar I prefer it because it supports the convention of using a dev ns"><y>#</y><d>2017-03-28</d><h>14:23</h><w>ddeaguiar</w>I prefer it because it supports the convention of using a <code>dev</code> ns</z><z id="t1490711609" t="deg Another newbie-biting error message: I&apos;m not sure if this one is best caught by Vase or Datomic... I&apos;m populating a database from my client, and am passing in a load of generated [entity attribute value] triples. One of them has a null value, but the error message does not help me know which one: `ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 313} clojure.lang.ExceptionInfo: Interceptor Exception: java.lang.IllegalArgumentException: :db.error/nil-value Nil is not a legal value at clojure.core$ex_info.invokeStatic(core.clj:4725) at clojure.core$ex_info.invoke(core.clj:4725) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:33) ...`"><y>#</y><d>2017-03-28</d><h>14:33</h><w>deg</w>Another newbie-biting error message: I&apos;m not sure if this one is best caught by Vase or Datomic...
I&apos;m populating a database from my client, and am passing in a load of generated [entity attribute value] triples.  One of them has a null value, but the error message does not help me know which one:
`ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 313}
clojure.lang.ExceptionInfo: Interceptor Exception: java.lang.IllegalArgumentException: :db.error/nil-value Nil is not a legal value
	at clojure.core$ex_info.invokeStatic(core.clj:4725)
	at clojure.core$ex_info.invoke(core.clj:4725)
	at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:33)
...`</z><z id="t1490711809" t="ddeaguiar That’s best caught by Datomic imo, but i recall seeing the tuple in question in the error message when that’s happened to me. It’s been a while, though"><y>#</y><d>2017-03-28</d><h>14:36</h><w>ddeaguiar</w>That’s best caught by Datomic imo, but i recall seeing the tuple in question in the error message when that’s happened to me. It’s been a while, though</z><z id="t1490711813" t="jimmy [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] I&apos;m not sure it&apos;s better for Datomic to print out which value that has the failed datum. In this case, you can catch the exception and print failed datum out if you want."><y>#</y><d>2017-03-28</d><h>14:36</h><w>jimmy</w><a>@deg</a> I&apos;m not sure it&apos;s better for Datomic to print out which value that has the failed datum. In this case, you can catch the exception and print failed datum out if you want.</z><z id="t1490714027" t="deg Where is the right place to catch the exception? So far, all of my server-side &quot;code&quot; has been just data in the .edn file."><y>#</y><d>2017-03-28</d><h>15:13</h><w>deg</w>Where is the right place to catch the exception? So far, all of my server-side &quot;code&quot; has been just data in the .edn file.</z><z id="t1490714123" t="ddeaguiar You can define an interceptor using the #vase/intercept tagged literal"><y>#</y><d>2017-03-28</d><h>15:15</h><w>ddeaguiar</w>You can define an interceptor using the <code>#vase/intercept</code> tagged literal</z><z id="t1490714150" t="ddeaguiar or define it externally and include it, IIRC"><y>#</y><d>2017-03-28</d><h>15:15</h><w>ddeaguiar</w>or define it externally and include it, IIRC</z><z id="t1490714237" t="ddeaguiar Be aware of the rough edges around interceptors defined with #vase/intercept . I think they’re harder to debug when they error. That’s something which is being looked into."><y>#</y><d>2017-03-28</d><h>15:17</h><w>ddeaguiar</w>Be aware of the rough edges around interceptors defined with <code>#vase/intercept</code>. I think they’re harder to debug when they error. That’s something which is being looked into.</z><z id="t1490714387" t="deg Hmm, I&apos;m going to pass for the moment... I can find the error in my client log, so I don&apos;t have a pressing need right now and figuring out where and what to catch in the first interceptor that I&apos;ve not yet written is getting too deep down the shaven yak. Thanks, though."><y>#</y><d>2017-03-28</d><h>15:19</h><w>deg</w>Hmm, I&apos;m going to pass for the moment...  I can find the error in my client log, so I don&apos;t have a pressing need right now and figuring out where and what to catch in the first interceptor that I&apos;ve not yet written is getting too deep down the shaven yak.  Thanks, though.</z><z id="t1490714461" t="deg Is there an example somewhere of doing an upsert via Vase?"><y>#</y><d>2017-03-28</d><h>15:21</h><w>deg</w>Is there an example somewhere of doing an upsert via Vase?</z><z id="t1490715017" t="ddeaguiar I can’t say for sure but I presume any of the current samples capture that."><y>#</y><d>2017-03-28</d><h>15:30</h><w>ddeaguiar</w>I can’t say for sure but I presume any of the current samples capture that.</z><z id="t1490715090" t="ddeaguiar but I think you need to specify the :db/id of your entity when you are transacting changes"><y>#</y><d>2017-03-28</d><h>15:31</h><w>ddeaguiar</w>but I think you need to specify the <code>:db/id</code> of your entity when you are transacting changes</z><z id="t1490715170" t="deg Yup, I understand that, but am hitting snags in seeing exactly what to do. How do I know the :db/id if I don&apos;t even know if the entity exists yet?"><y>#</y><d>2017-03-28</d><h>15:32</h><w>deg</w>Yup, I understand that, but am hitting snags in seeing exactly what to do.  How do I know the :db/id if I don&apos;t even know if the entity exists yet?</z><z id="t1490715213" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] I&apos;d recommend using an attribute that uniquely identifies the entity in question, but not the db/id."><y>#</y><d>2017-03-28</d><h>15:33</h><w>mtnygard</w><a>@deg</a> I&apos;d recommend using an attribute that uniquely identifies the entity in question, but not the db/id.</z><z id="t1490715290" t="mtnygard http://docs.datomic.com/identity.html talks about uniqueness and identity attributes. The short version is that using :db/unique :db.unique/identity on an attribute means that any new assertions with that value for the attribute get merged into any existing entity. It&apos;s upsert for free, basically."><y>#</y><d>2017-03-28</d><h>15:34</h><w>mtnygard</w><a href="http://docs.datomic.com/identity.html" target="_blank">http://docs.datomic.com/identity.html</a> talks about uniqueness and identity attributes. The short version is that using :db/unique :db.unique/identity on an attribute means that any new assertions with that value for the attribute get merged into any existing entity. It&apos;s upsert for free, basically.</z><z id="t1490715361" t="ddeaguiar Thanks for clarifying [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] . I thought I had seen some code in Vase that assoc’d a :db/id if it wasn’t present in a submitted entity."><y>#</y><d>2017-03-28</d><h>15:36</h><w>ddeaguiar</w>Thanks for clarifying <a>@mtnygard</a>. I thought I had seen some code in Vase that assoc’d a <code>:db/id</code> if it wasn’t present in a submitted entity.</z><z id="t1490715388" t="mtnygard Hmm... let me double-check that."><y>#</y><d>2017-03-28</d><h>15:36</h><w>mtnygard</w>Hmm... let me double-check that.</z><z id="t1490715426" t="deg I&apos;m hitting a blind spot here. According to the your_first_api doc, I need to add :db/id in my my transact properties, iff I don&apos;t want to create a new object. But, my client does not know if it needs to create a new object then ...."><y>#</y><d>2017-03-28</d><h>15:37</h><w>deg</w>I&apos;m hitting a blind spot here. According to the your_first_api doc, I need to add <code>:db/id</code> in my my transact properties, iff I don&apos;t want to create a new object. But, my client does not know if it needs to create a new object then ....</z><z id="t1490715430" t="ddeaguiar yeah, that won’t work"><y>#</y><d>2017-03-28</d><h>15:37</h><w>ddeaguiar</w>yeah, that won’t work</z><z id="t1490715440" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] try it with the sample Petstore app"><y>#</y><d>2017-03-28</d><h>15:37</h><w>ddeaguiar</w><a>@mtnygard</a> try it with the sample Petstore app</z><z id="t1490715459" t="ddeaguiar I get this error message when I try to upsert Caused by: datomic.impl.Exceptions$IllegalStateExceptionInfo: :db.error/unique-conflict Unique conflict: :pet-store.pet/id, value: 1 already held by: 17592186045422 asserted for: 17592186045424 "><y>#</y><d>2017-03-28</d><h>15:37</h><w>ddeaguiar</w>I get this error message when I try to upsert

<pre>Caused by: datomic.impl.Exceptions$IllegalStateExceptionInfo: :db.error/unique-conflict Unique conflict: :pet-store.pet/id, value: 1 already held by: 17592186045422 asserted for: 17592186045424
</pre></z><z id="t1490715517" t="mtnygard I&apos;m looking at com.cognitect.vase.actions/process-id right now. Basically, it says if there&apos;s no db/id on the transaction, then a tempid will be assigned. If an entity has a tempid and uses the same value for a :db.unique/identity attribute, it is supposed to be merged."><y>#</y><d>2017-03-28</d><h>15:38</h><w>mtnygard</w>I&apos;m looking at com.cognitect.vase.actions/process-id right now. Basically, it says if there&apos;s no db/id on the transaction, then a tempid will be assigned. If an entity has a tempid and uses the same value for a :db.unique/identity attribute, it is supposed to be merged.</z><z id="t1490715599" t="mtnygard I think the issue is that pet-store uses :db.unique/value when it should use :db.unique/identity."><y>#</y><d>2017-03-28</d><h>15:39</h><w>mtnygard</w>I think the issue is that pet-store uses :db.unique/value when it should use :db.unique/identity.</z><z id="t1490715609" t="deg Another, maybe related question. I had tried a poor-man&apos;s upsert (get, followed by client-side logic), but the way I did it needed to get the :db/id of my newly-created entity. According to your_first_api, The JSON packet above, because it does not contain a :db/id field refers to a new entity and the return value from the Vase service will return its newly created :db/id. But, this does not seem to be the case, at least not fully usefully ..."><y>#</y><d>2017-03-28</d><h>15:40</h><w>deg</w>Another, maybe related question.  I had tried a poor-man&apos;s upsert (get, followed by client-side logic), but the way I did it needed to get the <code>:db/id</code> of my newly-created entity.  According to your_first_api, The JSON packet above, because it does not contain a :db/id field refers to a new entity and the return value from the Vase service will return its newly created :db/id.  But, this does not seem to be the case, at least not fully usefully ...</z><z id="t1490715617" t="mtnygard (The schema-tx literal uses :unique instead of :identity)"><y>#</y><d>2017-03-28</d><h>15:40</h><w>mtnygard</w>(The schema-tx literal uses :unique instead of :identity)</z><z id="t1490715737" t="ddeaguiar haha! yep"><y>#</y><d>2017-03-28</d><h>15:42</h><w>ddeaguiar</w>haha! yep</z><z id="t1490715740" t="ddeaguiar trying that"><y>#</y><d>2017-03-28</d><h>15:42</h><w>ddeaguiar</w>trying that</z><z id="t1490715774" t="deg It returns a map with :whitelist that contains the new entity, but without the :db/id and :transactions which does have the id embedded. but deep enough that it feels wrong to rely on the format as authoritative. Is the line in the doc just wrong, or something deeper?"><y>#</y><d>2017-03-28</d><h>15:42</h><w>deg</w>It returns a map with <code>:whitelist</code> that contains the new entity, but without the <code>:db/id</code> and <code>:transactions</code> which does have the id embedded. but deep enough that it feels wrong to rely on the format as authoritative.  Is the line in the doc just wrong, or something deeper?</z><z id="t1490715805" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] Give me a few minutes to dig into that."><y>#</y><d>2017-03-28</d><h>15:43</h><w>mtnygard</w><a>@deg</a> Give me a few minutes to dig into that.</z><z id="t1490716160" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] changing the attribute from :unique to :identity in the petstore example worked. Thanks for catching that, I should have known!"><y>#</y><d>2017-03-28</d><h>15:49</h><w>ddeaguiar</w><a>@mtnygard</a> changing the attribute from <code>:unique</code> to <code>:identity</code> in the petstore example worked. Thanks for catching that, I should have known!</z><z id="t1490716199" t="mtnygard That&apos;s a defect in the sample."><y>#</y><d>2017-03-28</d><h>15:49</h><w>mtnygard</w>That&apos;s a defect in the sample.</z><z id="t1490716300" t="ddeaguiar I didn’t realize the code in the transact action conditionally assoc’d a :db/id based on the presence of an identity attribute. That totally makes sense and is smart to boot!"><y>#</y><d>2017-03-28</d><h>15:51</h><w>ddeaguiar</w>I didn’t realize the code in the transact action conditionally assoc’d a <code>:db/id</code> based on the presence of an identity attribute. That totally makes sense and is smart to boot!</z><z id="t1490716455" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] , so, re your tempid answer above. I don&apos;t understand."><y>#</y><d>2017-03-28</d><h>15:54</h><w>deg</w><a>@mtnygard</a>, so, re your tempid answer above. I don&apos;t understand.</z><z id="t1490716534" t="ddeaguiar https://github.com/cognitect-labs/vase/issues/66"><y>#</y><d>2017-03-28</d><h>15:55</h><w>ddeaguiar</w><a href="https://github.com/cognitect-labs/vase/issues/66" target="_blank">https://github.com/cognitect-labs/vase/issues/66</a></z><z id="t1490716851" t="deg Hmm, are you saying that upsert does not work? and create does not return the id? So, if I want to add a maybe new entity, I need to: - Try to get it - If found, update with whatever changes I have - If not found, create it - After creating it, if I need to do anything else with the entity, either get it again, or have other unique property I can use to identify it"><y>#</y><d>2017-03-28</d><h>16:00</h><w>deg</w>Hmm, are you saying that upsert does not work? and create does not return the id? So, if I want to add a maybe new entity, I need to:
- Try to get it
- If found, update with whatever changes I have
- If not found, create it
- After creating it, if I need to do anything else with the entity, either get it again, or have other unique property I can use to identify it</z><z id="t1490716931" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] You&apos;re going to have to start assigning correlation-id&apos;s to your posts here... I think we&apos;re getting out-of-order and interleaved responses."><y>#</y><d>2017-03-28</d><h>16:02</h><w>mtnygard</w><a>@deg</a> You&apos;re going to have to start assigning correlation-id&apos;s to your posts here... I think we&apos;re getting out-of-order and interleaved responses.</z><z id="t1490716990" t="mtnygard Let&apos;s start from your needs. In your domain, is there a &quot;natural&quot; key for your entities?"><y>#</y><d>2017-03-28</d><h>16:03</h><w>mtnygard</w>Let&apos;s start from your needs. In your domain, is there a &quot;natural&quot; key for your entities?</z><z id="t1490717081" t="deg In most cases, yes; the name of the object. I&apos;m still playing as I code, so I&apos;m not sure that the answer is always yes."><y>#</y><d>2017-03-28</d><h>16:04</h><w>deg</w>In most cases, yes; the name of the object.  I&apos;m still playing as I code, so I&apos;m not sure that the answer is always yes.</z><z id="t1490717140" t="mtnygard OK, when there is a natural key: use the :identity option in the schema. When POSTing such an entity, use the attribute. It will upsert every time based on that attribute."><y>#</y><d>2017-03-28</d><h>16:05</h><w>mtnygard</w>OK, when there is a natural key: use the <code>:identity</code> option in the schema. When POSTing such an entity, use the attribute. It will upsert every time based on that attribute.</z><z id="t1490717144" t="deg To a large extent, I&apos;m writing this as a learning exercise, so my goal will often be to push the tool to the edge."><y>#</y><d>2017-03-28</d><h>16:05</h><w>deg</w>To a large extent, I&apos;m writing this as a learning exercise, so my goal will often be to push the tool to the edge.</z><z id="t1490717190" t="mtnygard When other entities need to refer to it, use a lookup ref as described in http://docs.datomic.com/identity.html as the value of the ref attribute that should point to that object."><y>#</y><d>2017-03-28</d><h>16:06</h><w>mtnygard</w>When other entities need to refer to it, use a lookup ref as described in <a href="http://docs.datomic.com/identity.html" target="_blank">http://docs.datomic.com/identity.html</a> as the value of the ref attribute that should point to that object.</z><z id="t1490717206" t="mtnygard When querying, just use the object name attribute."><y>#</y><d>2017-03-28</d><h>16:06</h><w>mtnygard</w>When querying, just use the object name attribute.</z><z id="t1490717223" t="mtnygard If you can do that in every case, then you shouldn&apos;t need to touch the db/ids."><y>#</y><d>2017-03-28</d><h>16:07</h><w>mtnygard</w>If you can do that in every case, then you shouldn&apos;t need to touch the db/ids.</z><z id="t1490717328" t="deg ok. I&apos;m going to dive into my keyboard to reorganize my code this way. Back in a bit if I hit snags. Thanks!! (Feels like I&apos;m commandeered this channel as my private support line!)"><y>#</y><d>2017-03-28</d><h>16:08</h><w>deg</w>ok.  I&apos;m going to dive into my keyboard to reorganize my code this way.  Back in a bit if I hit snags.   Thanks!!  (Feels like I&apos;m commandeered this channel as my private support line!)</z><z id="t1490717356" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] No worries. Also, I&apos;ve confirmed that the paragraph you mentioned (&quot;The JSON packet above, because it does not contain a :db/id field refers to a new entity and the return value from the Vase service will return its newly created :db/id. On the other hand, the following JSON refers to an existing entity in the database:&quot;) is just plain wrong."><y>#</y><d>2017-03-28</d><h>16:09</h><w>mtnygard</w><a>@deg</a> No worries. Also, I&apos;ve confirmed that the paragraph you mentioned (&quot;The JSON packet above, because it does not contain a :db/id field refers to a new entity and the return value from the Vase service will return its newly created :db/id. On the other hand, the following JSON refers to an existing entity in the database:&quot;) is just plain wrong.</z><z id="t1490717375" t="mtnygard But at the same time, there&apos;s something hinky about the response body from the transact action."><y>#</y><d>2017-03-28</d><h>16:09</h><w>mtnygard</w>But at the same time, there&apos;s something hinky about the response body from the transact action.</z><z id="t1490725037" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Nice improvements to the your_first_api doc in your changes today! A couple of bits that are still potentially unclear: - One note: Vase tracks which schemas it has already applied - this is hinting at deep concept that won&apos;t be obvious to many readers: that the schemas are tuples in the database rather than static definitions. It would be great to explain this, along with why/what, earlier in the doc. - ...treats it as a new entity and attaches a tempid - What is a tempid?"><y>#</y><d>2017-03-28</d><h>18:17</h><w>deg</w><a>@mtnygard</a> Nice improvements to the your_first_api doc in your changes today!  A couple of bits that are still potentially unclear:
- One note: Vase tracks which schemas it has already applied - this is hinting at deep concept that won&apos;t be obvious to many readers: that the schemas are tuples in the database rather than static definitions. It would be great to explain this, along with why/what, earlier in the doc.
- ...treats it as a new entity and attaches a tempid - What is a tempid?</z><z id="t1490734570" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] this is an implementation detail, but Vase uses for tracking schemas ( https://github.com/rkneufeld/conformity ). This is subject to change, though"><y>#</y><d>2017-03-28</d><h>20:56</h><w>ddeaguiar</w><a>@deg</a> this is an implementation detail, but Vase uses for tracking schemas (<a href="https://github.com/rkneufeld/conformity" target="_blank">https://github.com/rkneufeld/conformity</a>). This is subject to change, though</z><z id="t1490734633" t="ddeaguiar Temporary ids are described here http://docs.datomic.com/transactions.html#temporary-ids"><y>#</y><d>2017-03-28</d><h>20:57</h><w>ddeaguiar</w>Temporary ids are described here <a href="http://docs.datomic.com/transactions.html#temporary-ids" target="_blank">http://docs.datomic.com/transactions.html#temporary-ids</a></z><z id="t1490734649" t="ddeaguiar but we should probably capture that in the doc as well"><y>#</y><d>2017-03-28</d><h>20:57</h><w>ddeaguiar</w>but we should probably capture that in the doc as well</z><z id="t1490792131" t="souenzzo Pedestal team, there is the function that takes the exception + context and returns the exception with :exception-type ... and other things that appears magically on error interceptor?"><y>#</y><d>2017-03-29</d><h>12:55</h><w>souenzzo</w>Pedestal team, there is the function that takes the exception + context and returns the exception with <code>:exception-type ...</code> and other things that appears magically on error interceptor?</z><z id="t1490792485" t="ddeaguiar As per the doc-string of the `error-dispatch macro https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17 &gt; Pedestal wraps all exceptions in ex-info on error, providing the following keys to match on: :execution-id , :stage , :interceptor , :exception-type"><y>#</y><d>2017-03-29</d><h>13:01</h><w>ddeaguiar</w>As per the doc-string of the `error-dispatch macro <a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17</a>

&gt;  Pedestal wraps all exceptions in ex-info on error, providing the following keys to match on: <code>:execution-id</code>, <code>:stage</code>, <code>:interceptor</code>, <code>:exception-type</code></z><z id="t1490792513" t="ddeaguiar You can use that macro to create error handling interceptors"><y>#</y><d>2017-03-29</d><h>13:01</h><w>ddeaguiar</w>You can use that macro to create error handling interceptors</z><z id="t1490792529" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] does that help?"><y>#</y><d>2017-03-29</d><h>13:02</h><w>ddeaguiar</w><a>@souenzzo</a> does that help?</z><z id="t1490792743" t="souenzzo https://github.com/pedestal/pedestal/blob/b7219050359f016bac77468547340c6eee20cb6e/interceptor/src/io/pedestal/interceptor/chain.clj#L32"><y>#</y><d>2017-03-29</d><h>13:05</h><w>souenzzo</w><a href="https://github.com/pedestal/pedestal/blob/b7219050359f016bac77468547340c6eee20cb6e/interceptor/src/io/pedestal/interceptor/chain.clj#L32" target="_blank">https://github.com/pedestal/pedestal/blob/b7219050359f016bac77468547340c6eee20cb6e/interceptor/src/io/pedestal/interceptor/chain.clj#L32</a></z><z id="t1490792918" t="souenzzo I&apos;m doing a unit test on the error handler (to ensure that ex-x generates response y ). I wanted to see how the &quot;context&quot; (stage, type) is injected into the exception."><y>#</y><d>2017-03-29</d><h>13:08</h><w>souenzzo</w>I&apos;m doing a unit test on the error handler (to ensure that <code>ex-x</code> generates response <code>y</code>). I wanted to see how the &quot;context&quot; (stage, type) is injected into the exception.</z><z id="t1490793253" t="ddeaguiar oh I see"><y>#</y><d>2017-03-29</d><h>13:14</h><w>ddeaguiar</w>oh I see</z><z id="t1490806755" t="souenzzo Someone else using https://github.com/MichaelDrogalis/dire to &quot;overwrite&quot; transact ions exceptions? They are really odd to catch"><y>#</y><d>2017-03-29</d><h>16:59</h><w>souenzzo</w>Someone else using <a href="https://github.com/MichaelDrogalis/dire" target="_blank">https://github.com/MichaelDrogalis/dire</a> to &quot;overwrite&quot; <code>transact</code>ions exceptions? They are really odd to catch</z><z id="t1490875016" t="deg How do I pass an :instant to Datamic through a Vase route?"><y>#</y><d>2017-03-30</d><h>11:56</h><w>deg</w>How do I pass an <code>:instant</code> to Datamic through a Vase route?</z><z id="t1490875162" t="deg If I pass it as a string to the http query, Datomic sees it as a string and complains. (I&apos;d hoped that :edn-coerce might help, but seems not). If tried passing it as an #inst on the CLJS side, hoping that some magic wrapping would occur, but something (cljs-ajax I assume, though I can&apos;t yet see where) converts it to &quot;{}&quot; before it leaves the client."><y>#</y><d>2017-03-30</d><h>11:59</h><w>deg</w>If I pass it as a string to the http query, Datomic sees it as a string and complains. (I&apos;d hoped that <code>:edn-coerce</code> might help, but seems not).
If tried passing it as an <code>#inst</code> on the CLJS side, hoping that some magic wrapping would occur, but something (cljs-ajax I assume, though I can&apos;t yet see where) converts it to <code>&quot;{}&quot;</code> before it leaves the client.</z><z id="t1490878036" t="souenzzo I think you need to customize spec&apos;s coerce"><y>#</y><d>2017-03-30</d><h>12:47</h><w>souenzzo</w>I think you need to customize spec&apos;s coerce</z><z id="t1490878438" t="mtnygard I can’t speak to the CLJS side of it. But edn-coerce should work if the param contains a string like “#inst{xxxx}”. The tag has to be in the string."><y>#</y><d>2017-03-30</d><h>12:53</h><w>mtnygard</w>I can’t speak to the CLJS side of it. But edn-coerce should work if the param contains a string like “#inst{xxxx}”. The tag has to be in the string.</z><z id="t1490879166" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] - like this? &quot;#inst{Sept 20, 2014}&quot; ? Because it doesn&apos;t seem to be working."><y>#</y><d>2017-03-30</d><h>13:06</h><w>deg</w><a>@mtnygard</a> - like this?  <code>&quot;#inst{Sept 20, 2014}&quot;</code>?  Because it doesn&apos;t seem to be working.</z><z id="t1490879215" t="mtnygard It has to be in a specific time format: https://github.com/edn-format/edn#inst-rfc-3339-format"><y>#</y><d>2017-03-30</d><h>13:06</h><w>mtnygard</w>It has to be in a specific time format: <a href="https://github.com/edn-format/edn#inst-rfc-3339-format" target="_blank">https://github.com/edn-format/edn#inst-rfc-3339-format</a></z><z id="t1490879390" t="deg Do I need quote chars inside the braces? (I just tried and failed both with and without; so looking for other issues in my code too)"><y>#</y><d>2017-03-30</d><h>13:09</h><w>deg</w>Do I need quote chars inside the braces?  (I just tried and failed both with and without; so looking for other issues in my code too)</z><z id="t1490879419" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] what about using transit?"><y>#</y><d>2017-03-30</d><h>13:10</h><w>ddeaguiar</w><a>@mtnygard</a> what about using transit?</z><z id="t1490879432" t="mtnygard Quotes should not be needed. Can you post the contents of your HTTP request here?"><y>#</y><d>2017-03-30</d><h>13:10</h><w>mtnygard</w>Quotes should not be needed. Can you post the contents of your HTTP request here?</z><z id="t1490879459" t="mtnygard Sorry, let me amend my last."><y>#</y><d>2017-03-30</d><h>13:10</h><w>mtnygard</w>Sorry, let me amend my last.</z><z id="t1490879473" t="mtnygard Quotes are needed around the whole timestamp string, but not inside."><y>#</y><d>2017-03-30</d><h>13:11</h><w>mtnygard</w>Quotes are needed around the whole timestamp string, but not inside.</z><z id="t1490879494" t="deg {&quot;payload&quot;:[{&quot;receipts.purchase/vendor&quot;:&quot;Bus&quot;,&quot;receipts.purchase/uid&quot;:&quot;D-1002&quot;,&quot;receipts.purchase/date&quot;:&quot;#inst{1985-04-12T23:20:50.52Z}&quot;,&quot;receipts.purchase/price&quot;:12.34,&quot;receipts.purchase/comment&quot;:&quot;Test bus ride&quot;,&quot;receipts.purchase/currency&quot;:&quot;USD&quot;,&quot;receipts.purchase/category&quot;:&quot;Travel&quot;}]}"><y>#</y><d>2017-03-30</d><h>13:11</h><w>deg</w><code>{&quot;payload&quot;:[{&quot;receipts.purchase/vendor&quot;:&quot;Bus&quot;,&quot;receipts.purchase/uid&quot;:&quot;D-1002&quot;,&quot;receipts.purchase/date&quot;:&quot;#inst{1985-04-12T23:20:50.52Z}&quot;,&quot;receipts.purchase/price&quot;:12.34,&quot;receipts.purchase/comment&quot;:&quot;Test bus ride&quot;,&quot;receipts.purchase/currency&quot;:&quot;USD&quot;,&quot;receipts.purchase/category&quot;:&quot;Travel&quot;}]}</code></z><z id="t1490879521" t="deg Error is clojure.lang.ExceptionInfo: Interceptor Exception: java.lang.IllegalArgumentException: :db.error/wrong-type-for-attribute Value #inst{1985-04-12T23:20:50.52Z} is not a valid :inst for attribute :receipts.purchase/date"><y>#</y><d>2017-03-30</d><h>13:12</h><w>deg</w>Error is <code>clojure.lang.ExceptionInfo: Interceptor Exception: java.lang.IllegalArgumentException: :db.error/wrong-type-for-attribute Value #inst{1985-04-12T23:20:50.52Z} is not a valid :inst for attribute :receipts.purchase/date</code></z><z id="t1490879577" t="mtnygard I think the inst field should look like this: ”receipts.purchase/date”:”#inst\”1985-04-12T23:20:50.52Z\”&quot;"><y>#</y><d>2017-03-30</d><h>13:12</h><w>mtnygard</w>I think the inst field should look like this:

<code>”receipts.purchase/date”:”#inst\”1985-04-12T23:20:50.52Z\”&quot;</code></z><z id="t1490879608" t="deg Ah, without braces?"><y>#</y><d>2017-03-30</d><h>13:13</h><w>deg</w>Ah, without braces?</z><z id="t1490879614" t="mtnygard right"><y>#</y><d>2017-03-30</d><h>13:13</h><w>mtnygard</w>right</z><z id="t1490879626" t="mtnygard but the quotes around the timestamp have to be escaped for json"><y>#</y><d>2017-03-30</d><h>13:13</h><w>mtnygard</w>but the quotes around the timestamp have to be escaped for json</z><z id="t1490879633" t="deg Ah, you were just being meta-syntactic above?"><y>#</y><d>2017-03-30</d><h>13:13</h><w>deg</w>Ah, you were just being meta-syntactic above?</z><z id="t1490879654" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I’m not sure where we stand with the transit body support. I need to talk with Paul after the conference"><y>#</y><d>2017-03-30</d><h>13:14</h><w>mtnygard</w><a>@ddeaguiar</a> I’m not sure where we stand with the transit body support. I need to talk with Paul after the conference</z><z id="t1490879790" t="ddeaguiar Ah yes, there’s an open PR for that https://github.com/cognitect-labs/vase/pull/62"><y>#</y><d>2017-03-30</d><h>13:16</h><r>ddeaguiar</r>Ah yes, there’s an open PR for that <a href="https://github.com/cognitect-labs/vase/pull/62" target="_blank">https://github.com/cognitect-labs/vase/pull/62</a></z><z id="t1490879656" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] Yes."><y>#</y><d>2017-03-30</d><h>13:14</h><w>mtnygard</w><a>@deg</a> Yes.</z><z id="t1490879677" t="mtnygard And also working from memory instead of looking at the doc. 😕"><y>#</y><d>2017-03-30</d><h>13:14</h><w>mtnygard</w>And also working from memory instead of looking at the doc. <b>😕</b></z><z id="t1490879914" t="deg Still failing. And I tried both \&quot; (sending a quote across the wire) and \\\&quot; (in case the other side needed it quoted too). I don&apos;t want to keep wasting your time on this... can you point me to any doc?"><y>#</y><d>2017-03-30</d><h>13:18</h><w>deg</w>Still failing.  And I tried both <code>\&quot;</code> (sending a quote across the wire) and <code>\\\&quot;</code> (in case the other side needed it quoted too).
I don&apos;t want to keep wasting your time on this... can you point me to any doc?</z><z id="t1490879950" t="mtnygard just the edn spec i sent before"><y>#</y><d>2017-03-30</d><h>13:19</h><w>mtnygard</w>just the edn spec i sent before</z><z id="t1490880402" t="deg Hmm, so what I&apos;m sending now seems to be valid edn, but I don&apos;t know what :edn-coerce expects. So, I think this reduces down to &quot;I need more docs. You need to focus on Clojure West. This is not a critical piece of my toy; I can store dates as strings for now. So, Iet&apos;s revisit later&quot;. (is there any value in my opening github issues about these minor doc lacks, or will that be too noisy?)"><y>#</y><d>2017-03-30</d><h>13:26</h><w>deg</w>Hmm, so what I&apos;m sending now seems to be valid edn, but I don&apos;t know what :edn-coerce expects.  So, I think this reduces down to &quot;I need more docs. You need to focus on Clojure West. This is not a critical piece of my toy; I can store dates as strings for now. So, Iet&apos;s revisit later&quot;.   (is there any value in my opening github issues about these minor doc lacks, or will that be too noisy?)</z><z id="t1490880446" t="mtnygard from what you’ve shown me, i’d expect it to work. so there may be a bug here. please open an issue, but don’t assume its a doc task."><y>#</y><d>2017-03-30</d><h>13:27</h><w>mtnygard</w>from what you’ve shown me, i’d expect it to work. so there may be a bug here. please open an issue, but don’t assume its a doc task.</z><z id="t1490880458" t="deg ok."><y>#</y><d>2017-03-30</d><h>13:27</h><w>deg</w>ok.</z><z id="t1490880547" t="mtnygard if you feel like getting your hands dirty with something new, it would be a nice place to have a generative test. Something that would generate any data, encode it as json, pass it through an edn-coerced param, and compare the resulting value to the original. “Round trip” tests like that are a nice place to use generative tests."><y>#</y><d>2017-03-30</d><h>13:29</h><w>mtnygard</w>if you feel like getting your hands dirty with something new, it would be a nice place to have a generative test. Something that would generate any data, encode it as json, pass it through an edn-coerced param, and compare the resulting value to the original. “Round trip” tests like that are a nice place to use generative tests.</z><z id="t1490883617" t="deg Understood. Not sure how soon I&apos;ll have time for this, but I&apos;ll try."><y>#</y><d>2017-03-30</d><h>14:20</h><w>deg</w>Understood. Not sure how soon I&apos;ll have time for this, but I&apos;ll try.</z><z id="t1490883851" t="deg FWIW, edn itself seems to be more forgiving: =&gt; (clojure.edn/read-string &quot;#inst \&quot;1985\&quot;&quot;) #inst &quot;1985-01-01T00:00:00.000-00:00&quot;"><y>#</y><d>2017-03-30</d><h>14:24</h><w>deg</w>FWIW, edn itself seems to be more forgiving: <code>=&gt; (clojure.edn/read-string &quot;#inst \&quot;1985\&quot;&quot;)</code>
<code>#inst &quot;1985-01-01T00:00:00.000-00:00&quot;</code></z><z id="t1490884039" t="ddeaguiar I’d shy away from trying to shortcut the content of #inst"><y>#</y><d>2017-03-30</d><h>14:27</h><w>ddeaguiar</w>I’d shy away from trying to shortcut the content of <code>#inst</code></z><z id="t1490884217" t="ddeaguiar if anything create helpers that make it easier make the edn string"><y>#</y><d>2017-03-30</d><h>14:30</h><w>ddeaguiar</w>if anything create helpers that make it easier make the edn string</z><z id="t1490884241" t="mtnygard You mean the content of the #inst tag, right?"><y>#</y><d>2017-03-30</d><h>14:30</h><w>mtnygard</w>You mean the content of the <code>#inst</code> tag, right?</z><z id="t1490884263" t="ddeaguiar yeah"><y>#</y><d>2017-03-30</d><h>14:31</h><w>ddeaguiar</w>yeah</z><z id="t1490884282" t="ddeaguiar corrected"><y>#</y><d>2017-03-30</d><h>14:31</h><w>ddeaguiar</w>corrected</z><z id="t1490884315" t="ddeaguiar also that instant implies a level of resolution that is not real. Keep that in mind"><y>#</y><d>2017-03-30</d><h>14:31</h><w>ddeaguiar</w>also that instant implies a level of resolution that is not real. Keep that in mind</z><z id="t1490887483" t="deg I found the problem, but not sure how to solve it. Surface problem: I had mistakenly put the :edn-coerce in the wrong place. Real issue: I need it in a #vase/transact, but there is no :params binding there"><y>#</y><d>2017-03-30</d><h>15:24</h><w>deg</w>I found the problem, but not sure how to solve it.
Surface problem: I had mistakenly put the :edn-coerce in the wrong place.
Real issue: I need it in a #vase/transact, but there is no :params binding there</z><z id="t1490888148" t="deg Later: I see from the samples (omnext-todo and petstore-full) that this is solved with an interceptor that coerces the date string. Is this the long-term plan? It feels heavy."><y>#</y><d>2017-03-30</d><h>15:35</h><w>deg</w>Later: I see from the samples (omnext-todo and petstore-full) that this is solved with an interceptor that coerces the date string.  Is this the long-term plan? It feels heavy.</z><z id="t1490888493" t="souenzzo Hi, When I do (response-for service :get &quot;/path?foo&amp;bar=123&quot;) I expect :query-params {:foo nil :bar &quot;123&quot;} , but pedestal do :query-params {nil &quot;foo&quot; :bar &quot;123} It&apos;s Intentional/expected?"><y>#</y><d>2017-03-30</d><h>15:41</h><w>souenzzo</w>Hi,
When I do <code>(response-for service :get &quot;/path?foo&amp;bar=123&quot;)</code> I expect <code>:query-params {:foo nil :bar &quot;123&quot;}</code>, but pedestal do <code>:query-params {nil &quot;foo&quot; :bar &quot;123}</code>
It&apos;s Intentional/expected?</z><z id="t1490889007" t="ddeaguiar that’s not how you set query-params with response-for"><y>#</y><d>2017-03-30</d><h>15:50</h><w>ddeaguiar</w>that’s not how you set query-params with <code>response-for</code></z><z id="t1490889013" t="ddeaguiar let me dig up an example"><y>#</y><d>2017-03-30</d><h>15:50</h><w>ddeaguiar</w>let me dig up an example</z><z id="t1490889135" t="ddeaguiar actually I’m wrong"><y>#</y><d>2017-03-30</d><h>15:52</h><w>ddeaguiar</w>actually I’m wrong</z><z id="t1490889138" t="ddeaguiar this is what I typically use"><y>#</y><d>2017-03-30</d><h>15:52</h><w>ddeaguiar</w>this is what I typically use</z><z id="t1490889200" t="ddeaguiar (response-for service :get (url-for ::web/foo-bar :query-params {:foo “bar”}))"><y>#</y><d>2017-03-30</d><h>15:53</h><w>ddeaguiar</w><code>(response-for service :get (url-for ::web/foo-bar :query-params {:foo “bar”}))</code></z><z id="t1490889433" t="ddeaguiar which is the same as (response-for service :get /foo-bar-path?foo=bar but I’m pretty sure it encodes things for you"><y>#</y><d>2017-03-30</d><h>15:57</h><w>ddeaguiar</w>which is the same as
<code>(response-for service :get /foo-bar-path?foo=bar</code> but I’m pretty sure it encodes things for you</z><z id="t1490889455" t="ddeaguiar oh..."><y>#</y><d>2017-03-30</d><h>15:57</h><w>ddeaguiar</w>oh...</z><z id="t1490889496" t="ddeaguiar Now I understand your example [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2017-03-30</d><h>15:58</h><w>ddeaguiar</w>Now I understand your example <a>@souenzzo</a></z><z id="t1490889530" t="ddeaguiar so I think your example needs to be ”/path?foo=&amp;bar=123”"><y>#</y><d>2017-03-30</d><h>15:58</h><w>ddeaguiar</w>so I think your example needs to be <code>”/path?foo=&amp;bar=123”</code></z><z id="t1490889566" t="ddeaguiar but I highly recommend using the url-for helper for creating paths for use with response-for"><y>#</y><d>2017-03-30</d><h>15:59</h><w>ddeaguiar</w>but I highly recommend using the <code>url-for</code> helper for creating paths for use with <code>response-for</code></z><z id="t1490889588" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] hope that helps"><y>#</y><d>2017-03-30</d><h>15:59</h><w>ddeaguiar</w><a>@souenzzo</a> hope that helps</z><z id="t1490889761" t="souenzzo It&apos;s not exacly &quot;response-for&quot; problem, thats the nil key problem. I exemplified with response-for because I did not test &quot;in the real world&quot;"><y>#</y><d>2017-03-30</d><h>16:02</h><w>souenzzo</w>It&apos;s not exacly &quot;response-for&quot; problem, thats the <code>nil</code> key problem. I exemplified with <code>response-for</code> because I did not test &quot;in the real world&quot;</z><z id="t1490889777" t="ddeaguiar ”/path?foo=&amp;bar=123&quot;"><y>#</y><d>2017-03-30</d><h>16:02</h><w>ddeaguiar</w><code>”/path?foo=&amp;bar=123&quot;</code></z><z id="t1490889788" t="ddeaguiar you are missing the = after foo"><y>#</y><d>2017-03-30</d><h>16:03</h><w>ddeaguiar</w>you are missing the <code>=</code> after <code>foo</code></z><z id="t1490889821" t="ddeaguiar so what I pasted is what url-for would emit"><y>#</y><d>2017-03-30</d><h>16:03</h><w>ddeaguiar</w>so what I pasted is what <code>url-for</code> would emit</z><z id="t1490889854" t="ddeaguiar (url-for ::web/foo-bar :query-params {:foo nil :bar 123})"><y>#</y><d>2017-03-30</d><h>16:04</h><w>ddeaguiar</w><code>(url-for ::web/foo-bar :query-params {:foo nil :bar 123})</code></z><z id="t1490889890" t="ddeaguiar in tests you do something like this to create a url-for helper"><y>#</y><d>2017-03-30</d><h>16:04</h><w>ddeaguiar</w>in tests you do something like this to create a <code>url-for</code> helper</z><z id="t1490889994" t="ddeaguiar (def url-for (http.route/url-for-routes web/routes) "><y>#</y><d>2017-03-30</d><h>16:06</h><w>ddeaguiar</w><pre>(def url-for (http.route/url-for-routes web/routes)
</pre></z></g><g id="s5"><z id="t1490890018" t="ddeaguiar you may need to expand your routes"><y>#</y><d>2017-03-30</d><h>16:06</h><w>ddeaguiar</w>you may need to expand your routes</z><z id="t1490940473" t="jimmy hi guys, in pedestal, sometimes they use ::server in service map sometimes ::http . What is the different ?"><y>#</y><d>2017-03-31</d><h>06:07</h><w>jimmy</w>hi guys, in pedestal, sometimes they use <code>::server</code> in service map sometimes <code>::http</code>. What is the different ?</z><z id="t1490940730" t="rauh [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I think they&apos;re just differently aliased. Check out the ns :require s"><y>#</y><d>2017-03-31</d><h>06:12</h><w>rauh</w><a>@nxqd</a> I think they&apos;re just differently aliased. Check out the <code>ns</code> <code>:require</code>s</z><z id="t1490940855" t="jimmy oh my, it&apos;s my bad. THanks !"><y>#</y><d>2017-03-31</d><h>06:14</h><w>jimmy</w>oh my, it&apos;s my bad. THanks !</z><z id="t1490965656" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] The ::server convention came from the early days of Pedestal and Clojure, when we didn&apos;t have very strong conventions about namespace aliases. More &quot;modern&quot; Clojure usage says you should use the last part of the namespace as the alias, so we&apos;ve changed the templates to conform with that convention. That gives us ::http as the alias for io.pedestal.http ."><y>#</y><d>2017-03-31</d><h>13:07</h><w>mtnygard</w><a>@nxqd</a> The <code>::server</code> convention came from the early days of Pedestal and Clojure, when we didn&apos;t have very strong conventions about namespace aliases. More &quot;modern&quot; Clojure usage says you should use the last part of the namespace as the alias, so we&apos;ve changed the templates to conform with that convention. That gives us <code>::http</code> as the alias for <code>io.pedestal.http</code>.</z><z id="t1490977561" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] great answer as always"><y>#</y><d>2017-03-31</d><h>16:26</h><w>jimmy</w><a>@mtnygard</a> great answer as always</z><z id="t1491026448" t="bradford Hi! I&apos;m getting an odd error message at compile time:"><y>#</y><d>2017-04-01</d><h>06:00</h><w>bradford</w>Hi! I&apos;m getting an odd error message at compile time:</z><z id="t1491026610" t="bradford Invalid token: ::http/routes , which is rather odd. Here&apos;s the log and code: http://bit.ly/2oJmQgi"><y>#</y><d>2017-04-01</d><h>06:03</h><w>bradford</w><code>Invalid token: ::http/routes</code>, which is rather odd. Here&apos;s the log and code: <a href="http://bit.ly/2oJmQgi" target="_blank">http://bit.ly/2oJmQgi</a></z><z id="t1491026672" t="rauh [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] You should require pedestal with :as http for the keywords to be pedestal namespaced keywords"><y>#</y><d>2017-04-01</d><h>06:04</h><w>rauh</w><a>@bradford</a> You should require pedestal with <code>:as http</code> for the keywords to be pedestal namespaced keywords</z><z id="t1491026808" t="bradford [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] That was it! thanks"><y>#</y><d>2017-04-01</d><h>06:06</h><w>bradford</w><a>@rauh</a> That was it! thanks</z><z id="t1491028708" t="bradford OK, new prob. I&apos;m getting no response (not a 404), when I POST to localhost:8080/recs . The code&apos;s pretty simple, though... any ideas? http://bit.ly/2olEzOr"><y>#</y><d>2017-04-01</d><h>06:38</h><w>bradford</w>OK, new prob. I&apos;m getting <code>no response</code> (not a 404), when I <code>POST</code> to <code>localhost:8080/recs</code>. The code&apos;s pretty simple, though... any ideas? <a href="http://bit.ly/2olEzOr" target="_blank">http://bit.ly/2olEzOr</a></z><z id="t1491055391" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] defroutes is considered deprecated. You should use def with the tersre route syntaxt as follows: ;; Terse/Vector-based routes (def routes `[[[&quot;/&quot; {:get home-page} ^:interceptors [(body-params/body-params) http/html-body] [&quot;/about&quot; {:get about-page}]]]]) "><y>#</y><d>2017-04-01</d><h>14:03</h><w>ddeaguiar</w><a>@bradford</a> <code>defroutes</code> is considered deprecated. You should use <code>def</code> with the tersre route syntaxt as follows:

<pre>;; Terse/Vector-based routes
(def routes
  `[[[&quot;/&quot; {:get home-page}
      ^:interceptors [(body-params/body-params) http/html-body]
      [&quot;/about&quot; {:get about-page}]]]])
</pre></z><z id="t1491055435" t="ddeaguiar I recommend using the table syntax instead. See http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax"><y>#</y><d>2017-04-01</d><h>14:03</h><w>ddeaguiar</w>I recommend using the table syntax instead. See <a href="http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax" target="_blank">http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax</a></z><z id="t1491055467" t="ddeaguiar Refer to http://pedestal.io/reference/table-syntax"><y>#</y><d>2017-04-01</d><h>14:04</h><w>ddeaguiar</w>Refer to <a href="http://pedestal.io/reference/table-syntax" target="_blank">http://pedestal.io/reference/table-syntax</a></z><z id="t1491055474" t="ddeaguiar Hope this helps"><y>#</y><d>2017-04-01</d><h>14:04</h><w>ddeaguiar</w>Hope this helps</z><z id="t1491055856" t="ddeaguiar One other thing, although the example in the table-syntax reference uses route/expand-routes , don’t use it in your route definition"><y>#</y><d>2017-04-01</d><h>14:10</h><w>ddeaguiar</w>One other thing, although the example in the table-syntax reference uses <code>route/expand-routes</code>, don’t use it in your route definition</z><z id="t1491055869" t="ddeaguiar Pedestal will expand routes for you on start up if it’s default-interceptors fn is called. Which is probably in most cases since I suspect that overriding the default interceptors is less common."><y>#</y><d>2017-04-01</d><h>14:11</h><w>ddeaguiar</w>Pedestal will expand routes for you on start up if it’s <code>default-interceptors</code> fn is called. Which is probably in most cases since I suspect that overriding the default interceptors is less common.</z><z id="t1491055885" t="ddeaguiar I’m going to create an issue in the http://Pedestal.io guides about that"><y>#</y><d>2017-04-01</d><h>14:11</h><w>ddeaguiar</w>I’m going to create an issue in the <a href="http://Pedestal.io" target="_blank">http://Pedestal.io</a> guides about that</z><z id="t1491056089" t="ddeaguiar But, you’ll need to explicitly expand routes if you want to create and use a url-for helper in your tests."><y>#</y><d>2017-04-01</d><h>14:14</h><w>ddeaguiar</w>But, you’ll need to explicitly expand routes if you want to create and use a <code>url-for</code> helper in your tests.</z><z id="t1491059279" t="ddeaguiar For those interested in auth samples, the geheimtur demo app has been updated to use the latest version of Pedestal. See https://github.com/propan/geheimtur-demo"><y>#</y><d>2017-04-01</d><h>15:07</h><w>ddeaguiar</w>For those interested in auth samples, the geheimtur demo app has been updated to use the latest version of Pedestal. See <a href="https://github.com/propan/geheimtur-demo" target="_blank">https://github.com/propan/geheimtur-demo</a></z><z id="t1491059358" t="ddeaguiar Geheimtur has also been updated ( https://github.com/propan/geheimtur )."><y>#</y><d>2017-04-01</d><h>15:09</h><w>ddeaguiar</w>Geheimtur has also been updated (<a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a>).</z><z id="t1491076920" t="bradford [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks!"><y>#</y><d>2017-04-01</d><h>20:02</h><w>bradford</w><a>@ddeaguiar</a> thanks!</z><z id="t1491186553" t="jimmy Do you guys know if I assign ::http/interceptors [] , even it&apos;s an empty vector, then when there is an error, the only message I got is : Internal server error : no response . if I don&apos;t have ::http/interceptors , it returns a nice stack trace for me to debug. What is the right way to provide default interceptors on current service ?"><y>#</y><d>2017-04-03</d><h>02:29</h><w>jimmy</w>Do you guys know if I assign <code>::http/interceptors []</code> , even it&apos;s an empty vector, then when there is an error, the only message I got is : <code>Internal server error : no response</code>. if I don&apos;t have <code>::http/interceptors</code>, it returns a nice stack trace for me to debug. What is the right way to provide default interceptors on current service ?</z><z id="t1491197540" t="jimmy https://www.youtube.com/watch?v=_Cf-STRvFy8 Great talk, cannot wait to see pedestal chain on clojurescript !"><y>#</y><d>2017-04-03</d><h>05:32</h><w>jimmy</w><a href="https://www.youtube.com/watch?v=_Cf-STRvFy8" target="_blank">https://www.youtube.com/watch?v=_Cf-STRvFy8</a>
Great talk, cannot wait to see pedestal chain on clojurescript !</z><z id="t1491199094" t="rauh [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Just update conj the ::http/interceptors after you put called the default-interceptors . (Without the :http/interceptors since if default-interceptors sees that map key it won&apos;t do anything.)"><y>#</y><d>2017-04-03</d><h>05:58</h><w>rauh</w><a>@nxqd</a> Just <code>update conj</code> the <code>::http/interceptors</code> after you put called the <code>default-interceptors</code>. (Without the <code>:http/interceptors</code> since if <code>default-interceptors</code> sees that map key it won&apos;t do anything.)</z><z id="t1491199154" t="jimmy [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] thanks."><y>#</y><d>2017-04-03</d><h>05:59</h><w>jimmy</w><a>@rauh</a> thanks.</z><z id="t1491243551" t="borkdude Is content negotiation + coercion a manual practice like described in http://pedestal.io/guides/hello-world-content-types or is there some provided sane defaults in Pedestal?"><y>#</y><d>2017-04-03</d><h>18:19</h><w>borkdude</w>Is content negotiation + coercion a manual practice like described in <a href="http://pedestal.io/guides/hello-world-content-types" target="_blank">http://pedestal.io/guides/hello-world-content-types</a> or is there some provided sane defaults in Pedestal?</z><z id="t1491244227" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] , AFAIK that’s how it’s done."><y>#</y><d>2017-04-03</d><h>18:30</h><w>ddeaguiar</w><a>@borkdude</a>, AFAIK that’s how it’s done.</z><z id="t1491247291" t="crimeminister Hi all, is this the right place for Vase-related questions or should I take it to #vase?"><y>#</y><d>2017-04-03</d><h>19:21</h><w>crimeminister</w>Hi all, is this the right place for Vase-related questions or should I take it to #vase?</z><z id="t1491247393" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U066SF64X&quot;}] not sure who’s using #vase. I think this is the right place for now."><y>#</y><d>2017-04-03</d><h>19:23</h><w>ddeaguiar</w><a>@crimeminister</a> not sure who’s using #vase. I think this is the right place for now.</z><z id="t1491247402" t="crimeminister Cool!"><y>#</y><d>2017-04-03</d><h>19:23</h><w>crimeminister</w>Cool!</z><z id="t1491247543" t="crimeminister Am wondering about the possibility of using specs defined in an external library; getting Unable to resolve spec: :com.example/some-spec when I try. Anyone know if this is supported?"><y>#</y><d>2017-04-03</d><h>19:25</h><w>crimeminister</w>Am wondering about the possibility of using specs defined in an external library; getting <code>Unable to resolve spec: :com.example/some-spec</code> when I try. Anyone know if this is supported?</z><z id="t1491247573" t="crimeminister I should go spelunking, but figured it couldn&apos;t hurt to ask first ;)"><y>#</y><d>2017-04-03</d><h>19:26</h><w>crimeminister</w>I should go spelunking, but figured it couldn&apos;t hurt to ask first ;)</z><z id="t1491247631" t="ddeaguiar So I assume you mean specs that are registered via s/def , correct?"><y>#</y><d>2017-04-03</d><h>19:27</h><w>ddeaguiar</w>So I assume you mean specs that are registered via <code>s/def</code>, correct?</z><z id="t1491247664" t="crimeminister Yes"><y>#</y><d>2017-04-03</d><h>19:27</h><w>crimeminister</w>Yes</z><z id="t1491247688" t="ddeaguiar If so then I don’t see why that wouldn’t work. I imagine you need to require the appropriate namespaces before reading in the vase descriptor(s)"><y>#</y><d>2017-04-03</d><h>19:28</h><w>ddeaguiar</w>If so then I don’t see why that wouldn’t work. I imagine you need to require the appropriate namespaces before reading in the vase descriptor(s)</z><z id="t1491247720" t="crimeminister Cool, I will give it another whirl, thank you"><y>#</y><d>2017-04-03</d><h>19:28</h><w>crimeminister</w>Cool, I will give it another whirl, thank you</z><z id="t1491247924" t="crimeminister That worked, much appreciated"><y>#</y><d>2017-04-03</d><h>19:32</h><w>crimeminister</w>That worked, much appreciated</z><z id="t1491247964" t="ddeaguiar np, glad to help!"><y>#</y><d>2017-04-03</d><h>19:32</h><w>ddeaguiar</w>np, glad to help!</z><z id="t1491248031" t="crimeminister Am wondering: would it make sense to provide a list of namespaces to require as part of the Vase edn config?"><y>#</y><d>2017-04-03</d><h>19:33</h><w>crimeminister</w>Am wondering: would it make sense to provide a list of namespaces to require as part of the Vase edn config?</z><z id="t1491248166" t="ddeaguiar I think that’s app-specific. You normally won’t need much more than what’s defined in the service.clj file which is created by the Vase lein template."><y>#</y><d>2017-04-03</d><h>19:36</h><w>ddeaguiar</w>I think that’s app-specific. You normally won’t need much more than what’s defined in the <code>service.clj</code> file which is created by the Vase lein template.</z><z id="t1491248269" t="ddeaguiar Remember specs are registered globally. They’re actually stored in an atom defined in the spec ns."><y>#</y><d>2017-04-03</d><h>19:37</h><w>ddeaguiar</w>Remember specs are registered globally. They’re actually stored in an atom defined in the spec ns.</z><z id="t1491248293" t="ddeaguiar They get registered when the ns they are defined in is evaluated"><y>#</y><d>2017-04-03</d><h>19:38</h><w>ddeaguiar</w>They get registered when the ns they are defined in is evaluated</z><z id="t1491248369" t="ddeaguiar This means that specs defined in your descriptor(s) are also available elsewhere in your Vase-enabled app"><y>#</y><d>2017-04-03</d><h>19:39</h><w>ddeaguiar</w>This means that specs defined in your descriptor(s) are also available elsewhere in your Vase-enabled app</z><z id="t1491248398" t="crimeminister Agreed, just thinking that on occasion it might be useful to specify a namespace to evaluate as part of Vase config so the spec can be used by a #vase/validate without a having to touch server/service.clj . Minor thing though."><y>#</y><d>2017-04-03</d><h>19:39</h><w>crimeminister</w>Agreed, just thinking that on occasion it might be useful to specify a namespace to evaluate as part of Vase config so the spec can be used by a <code>#vase/validate</code> without  a having to touch <code>server/service.clj</code>. Minor thing though.</z><z id="t1491248417" t="crimeminister Didn&apos;t realize that was how spec was implemented; interesting"><y>#</y><d>2017-04-03</d><h>19:40</h><w>crimeminister</w>Didn&apos;t realize that was how spec was implemented; interesting</z><z id="t1491248459" t="ddeaguiar Oh, I see what you are asking for"><y>#</y><d>2017-04-03</d><h>19:40</h><w>ddeaguiar</w>Oh, I see what you are asking for</z><z id="t1491248509" t="crimeminister I have several apps all using shared specs in a library, just pulling those into the Vase microservice I am playing with"><y>#</y><d>2017-04-03</d><h>19:41</h><w>crimeminister</w>I have several apps all using shared specs in a library, just pulling those into the Vase microservice I am playing with</z><z id="t1491248634" t="ddeaguiar Hmm, IMO the convenience does not outweigh the trouble of implementing and supporting such a feature."><y>#</y><d>2017-04-03</d><h>19:43</h><w>ddeaguiar</w>Hmm, IMO the convenience does not outweigh the trouble of implementing and supporting such a feature.</z><z id="t1491248659" t="crimeminister Quite likely, and not sure how common this pattern is anyways"><y>#</y><d>2017-04-03</d><h>19:44</h><w>crimeminister</w>Quite likely, and not sure how common this pattern is anyways</z><z id="t1491248681" t="crimeminister No doubt others will chime in if it might be useful ;)"><y>#</y><d>2017-04-03</d><h>19:44</h><w>crimeminister</w>No doubt others will chime in if it might be useful ;)</z><z id="t1491248695" t="ddeaguiar very true!"><y>#</y><d>2017-04-03</d><h>19:44</h><w>ddeaguiar</w>very true!</z><z id="t1491251979" t="borkdude Does anyone got an example how to load resources from a jar? I tried this: (def font-awesome-webjars-resource-path “META-INF/resources/webjars/font-awesome/4.7.0”) … service-map {::http/routes routes ::http/type :jetty ::http/join? false ::http/resource-path &quot;/public&quot; ;; Doesn&apos;t work yet ::http/default-interceptors [(middlewares/resource font-awesome-webjars-resource-path) ] ::http/port port} "><y>#</y><d>2017-04-03</d><h>20:39</h><w>borkdude</w>Does anyone got an example how to load resources from a jar?
I tried this:
<pre>(def font-awesome-webjars-resource-path “META-INF/resources/webjars/font-awesome/4.7.0”)
…
service-map {::http/routes routes
                            ::http/type   :jetty
                            ::http/join?  false
                            ::http/resource-path &quot;/public&quot;
                            ;; Doesn&apos;t work yet
                            ::http/default-interceptors [(middlewares/resource
                                                          font-awesome-webjars-resource-path)
                                                         ]
                            ::http/port port}
</pre></z><z id="t1491259711" t="crimeminister I think you might want to look at , specifically (io/resource …)"><y>#</y><d>2017-04-03</d><h>22:48</h><w>crimeminister</w>I think you might want to look at <code></code>, specifically <code>(io/resource …)</code></z><z id="t1491259739" t="crimeminister Am in transit, otherwise would post a more substantial example, sorry"><y>#</y><d>2017-04-03</d><h>22:48</h><w>crimeminister</w>Am in transit, otherwise would post a more substantial example, sorry</z><z id="t1491298841" t="borkdude What’s wrong in this expression? (route/expand-routes [[[&quot;/foo&quot; {:get foo}]]]) "><y>#</y><d>2017-04-04</d><h>09:40</h><w>borkdude</w>What’s wrong in this expression?
<pre>(route/expand-routes [[[&quot;/foo&quot; {:get foo}]]])
</pre></z><z id="t1491299106" t="borkdude Hmm, this worked: (defroutes routes [[[&quot;/foo&quot; {:get foo}]]])"><y>#</y><d>2017-04-04</d><h>09:45</h><w>borkdude</w>Hmm, this worked: <code>(defroutes routes [[[&quot;/foo&quot; {:get foo}]]])</code></z><z id="t1491299176" t="borkdude Apparently I needed to quote the vector before calling expand-routes"><y>#</y><d>2017-04-04</d><h>09:46</h><w>borkdude</w>Apparently I needed to quote the vector before calling <code>expand-routes</code></z><z id="t1491311394" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] , defroutes has been deprecated. You shouldn’t call route/expand-routes if Pedestal’s default-interceptors are being applied since it will expand routes for you. I also recommend using the table route syntax as described here: http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax"><y>#</y><d>2017-04-04</d><h>13:09</h><w>ddeaguiar</w><a>@borkdude</a>, <code>defroutes</code> has been deprecated. You shouldn’t call <code>route/expand-routes</code> if Pedestal’s <code>default-interceptors</code> are being applied since it will expand routes for you. I also recommend using the table route syntax as described here: <a href="http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax" target="_blank">http://pedestal.io/guides/defining-routes#_a_note_about_routing_syntax</a></z><z id="t1491311772" t="deg What is the recommended way to share a Vase schema with my CLJS client code?"><y>#</y><d>2017-04-04</d><h>13:16</h><w>deg</w>What is the recommended way to share a Vase schema with my CLJS client code?</z><z id="t1491312333" t="deg (e.g., for client-side validity testing)"><y>#</y><d>2017-04-04</d><h>13:25</h><w>deg</w>(e.g., for client-side validity testing)</z><z id="t1491313172" t="ddeaguiar Hrm, I don’t know of a recommended way. There’s the Validation action but that doesn’t involve sharing schema."><y>#</y><d>2017-04-04</d><h>13:39</h><w>ddeaguiar</w>Hrm, I don’t know of a recommended way. There’s the Validation action but that doesn’t involve sharing schema.</z><z id="t1491313263" t="ddeaguiar You could share specs between Clojure Clojurescript code but there are some caveats to that. I can’t comment on the practicalities of it since I’ve not done it."><y>#</y><d>2017-04-04</d><h>13:41</h><w>ddeaguiar</w>You could share specs between Clojure Clojurescript code but there are some caveats to that. I can’t comment on the practicalities of it since I’ve not done it.</z><z id="t1491314772" t="deg The validation action is server-side validation. Often, I&apos;ll want some preliminary validation on the client-side too. Even the most basic client needs to know, e.g., whether an input field should be text, password, or numeric. It makes sense to me that this should be driven by the same DRY knowledge as the Vase schemas. But. this doesn&apos;t seem to be easy to do, at least not while following the conventions in the Vase samples I&apos;ve seen."><y>#</y><d>2017-04-04</d><h>14:06</h><w>deg</w>The validation action is server-side validation. Often, I&apos;ll want some preliminary validation on the client-side too. Even the most basic client needs to know, e.g., whether an input field should be text, password, or numeric.
It makes sense to me that this should be driven by the same DRY knowledge as the Vase schemas. But. this doesn&apos;t seem to be easy to do, at least not while following the conventions in the Vase samples I&apos;ve seen.</z><z id="t1491320024" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] My vision for that is that Vase will be able to generate a Swagger spec to describe itself. Full disclosure though: it&apos;s on the roadmap but not being worked right now."><y>#</y><d>2017-04-04</d><h>15:33</h><w>mtnygard</w><a>@deg</a> My vision for that is that Vase will be able to generate a Swagger spec to describe itself. Full disclosure though: it&apos;s on the roadmap but not being worked right now.</z><z id="t1491321264" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] That sounds like a very good thing, but I think it may be both too much and too little. Too little: Swagger&apos;s syntax is richer than Vase&apos;s, so I guess you are talking about a one-time tool to generate an initial Swagger spec. Too much: I envision something simpler - a natural way to compose the Vase .edn file from smaller pieces, some of which would be natural to share with the client code. (My use case is a server and client evolving simultaneously and owned by the same team)."><y>#</y><d>2017-04-04</d><h>15:54</h><w>deg</w><a>@mtnygard</a> That sounds like a very good thing, but I think it may be both too much and too little.
Too little: Swagger&apos;s syntax is richer than Vase&apos;s, so I guess you are talking about a one-time tool to generate an initial Swagger spec.
Too much: I envision something simpler - a natural way to compose the Vase .edn file from smaller pieces, some of which would be natural to share with the client code. (My use case is a server and client evolving simultaneously and owned by the same team).</z><z id="t1491322461" t="malch Yeah, I&apos;d also want to pass some values to the Vase edn - datomic-uri , for instance. I&apos;m wrapping my whole application in integrant (same with Component, doesn&apos;t matter) and would like to pass this config to my server component"><y>#</y><d>2017-04-04</d><h>16:14</h><w>malch</w>Yeah, I&apos;d also want to pass some values to the Vase edn - <code>datomic-uri</code>, for instance. I&apos;m wrapping my whole application in integrant (same with Component, doesn&apos;t matter) and would like to pass this config to my server component</z><z id="t1491334051" t="borkdude [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I was actually using Pedestal-API which adds another layer of macros to be confused by 🙂"><y>#</y><d>2017-04-04</d><h>19:27</h><w>borkdude</w><a>@ddeaguiar</a> I was actually using Pedestal-API which adds another layer of macros to be confused by <b>🙂</b></z><z id="t1491422440" t="curtosis [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] looking back to your ::http/interceptors statement, that’s the problem I think I’m having right now. Can you say more about what that should look like?"><y>#</y><d>2017-04-05</d><h>20:00</h><w>curtosis</w><a>@rauh</a> looking back to your <code>::http/interceptors</code> statement, that’s the problem I think I’m having right now. Can you say more about what that should look like?</z><z id="t1491456771" t="rauh [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] Make sure you understand clojure syntax. :foo/bar is a normal namespaced keyword with foo being the namespace. ::foo/bar however resolves to the namespace of the alias foo"><y>#</y><d>2017-04-06</d><h>05:32</h><w>rauh</w><a>@curtosis</a> Make sure you understand clojure syntax. <code>:foo/bar</code> is a normal namespaced keyword with <code>foo</code> being the namespace. <code>::foo/bar</code> however resolves to the namespace of the alias <code>foo</code></z><z id="t1491483002" t="curtosis [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] I do understand that. What I wasn’t getting (but do now) was how the default-interceptors interacted with ::http/interceptors – specifically, that ::http/interceptors takes manual control and doesn’t include the defaults."><y>#</y><d>2017-04-06</d><h>12:50</h><w>curtosis</w><a>@rauh</a> I do understand that. What I wasn’t getting (but do now) was how the <code>default-interceptors</code> interacted with <code>::http/interceptors</code> – specifically, that <code>::http/interceptors</code> takes manual control and doesn’t include the defaults.</z><z id="t1491483062" t="curtosis which was sort of what you were saying, but it didn’t quite parse for me there. got it now!"><y>#</y><d>2017-04-06</d><h>12:51</h><w>curtosis</w>which was sort of what you were saying, but it didn’t quite parse for me there. got it now!</z><z id="t1491513226" t="deg What is returned by :find (pull ?e [*]) in a #vase/query ? It seems to have more levels of nesting than I see in the Datomic pull documentation. I&apos;m just ignoring the seemingly unused bits of the structure, but this feels like I&apos;m doing something very wrong: (defn response-from-pull [pull-response] (let [relevant (first pull-response) cruft1 (next pull-response) cruft2 (not-empty (remove nil? (map next relevant)))] (when (or cruft1 cruft2) (prn &quot;ERROR: Unexpected pull response: &quot; pull-response)) (mapv first relevant))) "><y>#</y><d>2017-04-06</d><h>21:13</h><w>deg</w>What is returned by <code>:find (pull ?e [*])</code> in a <code>#vase/query</code>? It seems to have more levels of nesting than I see in the Datomic pull documentation.
I&apos;m just ignoring the seemingly unused bits of the structure, but this feels like I&apos;m doing something very wrong:
<pre>(defn response-from-pull [pull-response]
  (let [relevant (first pull-response)
        cruft1 (next pull-response)
        cruft2 (not-empty (remove nil? (map next relevant)))]
    (when (or cruft1 cruft2)
      (prn &quot;ERROR: Unexpected pull response: &quot; pull-response))
    (mapv first relevant)))
</pre></z><z id="t1491523082" t="ddeaguiar [*] returns a map containing all top level keys of an entity plus the keys of any component attributes."><y>#</y><d>2017-04-06</d><h>23:58</h><w>ddeaguiar</w><code>[*]</code> returns a map containing all top level keys of an entity plus the keys of any component attributes.</z><z id="t1491523157" t="ddeaguiar Refer to http://docs.datomic.com/pull.html#wildcard-specifications"><y>#</y><d>2017-04-06</d><h>23:59</h><w>ddeaguiar</w>Refer to <a href="http://docs.datomic.com/pull.html#wildcard-specifications" target="_blank">http://docs.datomic.com/pull.html#wildcard-specifications</a></z><z id="t1491523163" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] ^^"><y>#</y><d>2017-04-06</d><h>23:59</h><w>ddeaguiar</w><a>@deg</a> ^^</z><z id="t1491525616" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Looking for a sanity check. #vase/transact properties do not allow for defaults. However, Datomic doesn’t allow nils in transactions. That means we can’t have optional properties to a transact. Seems like an oversight to me. I want to add the same defaulting syntax to transact’s properties that query’s params has. Does anything there sound like it violates the principle of least surprise?"><y>#</y><d>2017-04-07</d><h>00:40</h><w>mtnygard</w><a>@ddeaguiar</a> Looking for a sanity check. <code>#vase/transact</code> properties do not allow for defaults. However, Datomic doesn’t allow nils in transactions. That means we can’t have optional properties to a transact. Seems like an oversight to me.

I want to add the same defaulting syntax to transact’s properties that query’s params has. Does anything there sound like it violates the principle of least surprise?</z><z id="t1491571382" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] , I’m biased by my knowledge of Datomic, so I think it does violate the principle of least surprise. It would make Query and Transact more symmetrical, though. However, I don’t think that’s a good enough reason to make it a supported feature. It’s also something that can be easily implemented on the client side. I’d hold off unless there’s a demand for it."><y>#</y><d>2017-04-07</d><h>13:23</h><r>ddeaguiar</r><a>@U06BLR1C6</a>, I’m biased by my knowledge of Datomic, so I think it does violate the principle of least surprise.

It would make Query and Transact more symmetrical, though. However, I don’t think that’s a good enough reason to make it a supported feature. It’s also something that can be easily implemented on the client side. I’d hold off unless there’s a demand for it.</z><z id="t1491571441" t="ddeaguiar If anything, nils should be filtered out. I don’t know if this is a property of #vase/transact or not"><y>#</y><d>2017-04-07</d><h>13:24</h><r>ddeaguiar</r>If anything, nils should be filtered out. I don’t know if this is a property of <code>#vase/transact</code> or not</z><z id="t1491578166" t="mtnygard Filtering nils is a good idea. I’ll do that now because it’s the smaller change to behavior."><y>#</y><d>2017-04-07</d><h>15:16</h><r>mtnygard</r>Filtering nils is a good idea. I’ll do that now because it’s the smaller change to behavior.</z><z id="t1491529510" t="imetallica Hi everyone, I&apos;m not being able to make Pedestal reload code on changes from the default project template. I&apos;ve run lein run-dev . Is there something missing? I&apos;m new to Clojure and still trying to get my feet wet. 🙂"><y>#</y><d>2017-04-07</d><h>01:45</h><w>imetallica</w>Hi everyone, I&apos;m not being able to make Pedestal reload code on changes from the default project template. I&apos;ve run <code>lein run-dev</code>. Is there something missing? I&apos;m new to Clojure and still trying to get my feet wet. <b>🙂</b></z><z id="t1491547794" t="jimmy [:attrs {:href &quot;/_/_/users/U0XE11ZRB&quot;}] check this article http://pedestal.io/guides/pedestal-with-component ."><y>#</y><d>2017-04-07</d><h>06:49</h><w>jimmy</w><a>@imetallica</a> check this article <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a>.</z><z id="t1491551226" t="jimmy hi guys, does pedestal test response-for supports passing params like transit-params or only headers and body ?"><y>#</y><d>2017-04-07</d><h>07:47</h><w>jimmy</w>hi guys, does pedestal test <code>response-for</code> supports passing params like <code>transit-params</code> or only <code>headers</code> and <code>body</code> ?</z><z id="t1491565395" t="imetallica [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] cool, I&apos;ll have a read. "><y>#</y><d>2017-04-07</d><h>11:43</h><w>imetallica</w><a>@nxqd</a> cool, I&apos;ll have a read. </z><z id="t1491571514" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0XE11ZRB&quot;}] you just need to reload the service ns"><y>#</y><d>2017-04-07</d><h>13:25</h><w>ddeaguiar</w><a>@imetallica</a> you just need to reload the <code>service</code> ns</z><z id="t1491571645" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] only body and headers . Refer to the doc-string of response-for https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L262"><y>#</y><d>2017-04-07</d><h>13:27</h><w>ddeaguiar</w><a>@nxqd</a> only <code>body</code> and <code>headers</code>. Refer to the doc-string of <code>response-for</code> <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L262" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L262</a></z><z id="t1491577825" t="deg [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I&apos;m seeing a much more nested structure than that. With route: &quot;/users&quot; {:get and query GET I get back [[[[&quot;^ &quot;,&quot;~:db/id&quot;,17592186045426,&quot;~:user/name&quot;,&quot;David Goldfarb&quot;,&quot;~:user/abbrev&quot;,&quot;D&quot;,&quot;~:user/email&quot;,&quot;"><y>#</y><d>2017-04-07</d><h>15:10</h><w>deg</w><a>@ddeaguiar</a> I&apos;m seeing a much more nested structure than that.
With route:
<pre>&quot;/users&quot; {:get </pre>
and query <code>GET </code>
I get back
<pre>[[[[&quot;^ &quot;,&quot;~:db/id&quot;,17592186045426,&quot;~:user/name&quot;,&quot;David Goldfarb&quot;,&quot;~:user/abbrev&quot;,&quot;D&quot;,&quot;~:user/email&quot;,&quot;</pre></z><z id="t1491577906" t="ddeaguiar hrm, so you can get rid of some of the nesting by doing this :find [(pull ?e [*]) ...]"><y>#</y><d>2017-04-07</d><h>15:11</h><w>ddeaguiar</w>hrm, so you can get rid of some of the nesting by doing this <code>:find [(pull ?e [*]) ...]</code></z><z id="t1491577924" t="ddeaguiar That’s from memory so I think it’s correct 🙂"><y>#</y><d>2017-04-07</d><h>15:12</h><w>ddeaguiar</w>That’s from memory so I think it’s correct <b>🙂</b></z><z id="t1491577942" t="deg Interesting. What does that mean exactly?"><y>#</y><d>2017-04-07</d><h>15:12</h><w>deg</w>Interesting. What does that mean exactly?</z><z id="t1491577983" t="ddeaguiar It’s an indication that you expect a collection of results back for the query expression"><y>#</y><d>2017-04-07</d><h>15:13</h><w>ddeaguiar</w>It’s an indication that you expect a collection of results back for the query expression</z><z id="t1491577990" t="ddeaguiar but"><y>#</y><d>2017-04-07</d><h>15:13</h><w>ddeaguiar</w>but</z><z id="t1491578016" t="ddeaguiar I would have thought you’d get maps back in that nested structure you pasted above"><y>#</y><d>2017-04-07</d><h>15:13</h><w>ddeaguiar</w>I would have thought you’d get maps back in that nested structure you pasted above</z><z id="t1491578051" t="ddeaguiar I’m curious. Let me run a quick test"><y>#</y><d>2017-04-07</d><h>15:14</h><w>ddeaguiar</w>I’m curious. Let me run a quick test</z><z id="t1491578082" t="deg With that change, I now get this: [[[&quot;^ &quot;,&quot;~:db/id&quot;,17592186045426,&quot;~:user/name&quot;,&quot;Degel&quot;,&quot;~:user/abbrev&quot;,&quot;Degel&quot;]]] . It looks like it only retrieved one user."><y>#</y><d>2017-04-07</d><h>15:14</h><w>deg</w>With that change, I now get this: <code>[[[&quot;^ &quot;,&quot;~:db/id&quot;,17592186045426,&quot;~:user/name&quot;,&quot;Degel&quot;,&quot;~:user/abbrev&quot;,&quot;Degel&quot;]]]</code>. It looks like it only retrieved one user.</z><z id="t1491578137" t="deg I&apos;m going to disappear in a few minutes, and I&apos;ll be only very intermittently here for the next two weeks. Apologies if I go silent; these slack channels hit the history horizon so fast that I may not even know you were talking to me."><y>#</y><d>2017-04-07</d><h>15:15</h><w>deg</w>I&apos;m going to disappear in a few minutes, and I&apos;ll be only very intermittently here for the next two weeks. Apologies if I go silent; these slack channels hit the history horizon so fast that I may not even know you were talking to me.</z><z id="t1491578787" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yeah I have read the docs. So we still need a http client lib like clj-http to do integration test? it would be great if response-for supports transit-params and such 😄"><y>#</y><d>2017-04-07</d><h>15:26</h><w>jimmy</w><a>@ddeaguiar</a> yeah I have read the docs. So we still need a http client lib like <code>clj-http</code> to do integration test? it would be great if <code>response-for</code> supports <code>transit-params</code> and such <b>😄</b></z><z id="t1491578878" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] , you should be able to generate a transit payload as the :body"><y>#</y><d>2017-04-07</d><h>15:27</h><w>ddeaguiar</w><a>@nxqd</a>, you should be able to generate a transit payload as the <code>:body</code></z><z id="t1491578992" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] hmm, yeah, forgot it. Thanks !"><y>#</y><d>2017-04-07</d><h>15:29</h><w>jimmy</w><a>@ddeaguiar</a> hmm, yeah, forgot it. Thanks !</z><z id="t1491579078" t="ddeaguiar Note how a level of nesting was removed by using ..."><y>#</y><d>2017-04-07</d><h>15:31</h><w>ddeaguiar</w>Note how a level of nesting was removed by using <code>...</code></z><z id="t1491579315" t="deg Got it. I hadn&apos;t realized above that the ... was literal."><y>#</y><d>2017-04-07</d><h>15:35</h><w>deg</w>Got it.  I hadn&apos;t realized above that the <code>...</code> was literal.</z><z id="t1491579371" t="deg This does reduce a level. But, still a nested vector rather than the map shown int the Datomic docs."><y>#</y><d>2017-04-07</d><h>15:36</h><w>deg</w>This does reduce a level. But, still a nested vector rather than the map shown int the Datomic docs.</z><z id="t1491604679" t="kenny Is there a way to gracefully shut down a SSE stream? If I have a client that connects and then disconnects sometime later, I always receive this error message: WARN io.pedestal.http.impl.servlet-interceptor - {:msg &quot;The pipe closed while async writing to the client; Client most likely disconnected.&quot;, :line 111, :src-chan #object[clojure.core.async.impl.channels.ManyToManyChannel 0x23572315 &quot;clojure.core.async.impl.channels.ManyToManyChannel@23572315&quot;]} "><y>#</y><d>2017-04-07</d><h>22:37</h><w>kenny</w>Is there a way to gracefully shut down a SSE stream? If I have a client that connects and then disconnects sometime later, I always receive this error message: 
<pre>WARN io.pedestal.http.impl.servlet-interceptor - {:msg &quot;The pipe closed while async writing to the client; Client most likely disconnected.&quot;, :line 111, :src-chan #object[clojure.core.async.impl.channels.ManyToManyChannel 0x23572315 &quot;clojure.core.async.impl.channels.ManyToManyChannel@23572315&quot;]}
</pre></z><z id="t1491658673" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] , I don’t have a lot of experience with SSE, but I think so. See https://github.com/pedestal/pedestal/issues/359 . Pedestal cleans up everything it creates when shutting down an SSE stream and it provides a hook via the on-client-disconnect option which can be set when starting the event stream."><y>#</y><d>2017-04-08</d><h>13:37</h><w>ddeaguiar</w><a>@kenny</a>, I don’t have a lot of experience with SSE, but I think so. See <a href="https://github.com/pedestal/pedestal/issues/359" target="_blank">https://github.com/pedestal/pedestal/issues/359</a>. Pedestal cleans up everything it creates when shutting down an SSE stream and it provides a hook via the <code>on-client-disconnect</code> option which can be set when starting the event stream.</z><z id="t1491658746" t="ddeaguiar https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L211"><y>#</y><d>2017-04-08</d><h>13:39</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L211" target="_blank">https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L211</a></z><z id="t1491658917" t="ddeaguiar the doc-string states that on-client-disconnect takes an arg but the code indicates it’s a no args fn."><y>#</y><d>2017-04-08</d><h>13:41</h><w>ddeaguiar</w>the doc-string states that <code>on-client-disconnect</code> takes an arg but the code indicates it’s a no args fn.</z><z id="t1491659421" t="ddeaguiar actually"><y>#</y><d>2017-04-08</d><h>13:50</h><w>ddeaguiar</w>actually</z><z id="t1491659424" t="ddeaguiar I’m wrong"><y>#</y><d>2017-04-08</d><h>13:50</h><w>ddeaguiar</w>I’m wrong</z><z id="t1491659482" t="ddeaguiar The on-client-disconnect function does take one argument, the context."><y>#</y><d>2017-04-08</d><h>13:51</h><w>ddeaguiar</w>The <code>on-client-disconnect</code> function does take one argument, the context.</z><z id="t1491659501" t="ddeaguiar Refer to https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L199"><y>#</y><d>2017-04-08</d><h>13:51</h><w>ddeaguiar</w>Refer to <a href="https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L199" target="_blank">https://github.com/pedestal/pedestal/blob/5b2450f67b3ea5ad8e853467e6305cee5125497c/service/src/io/pedestal/http/sse.clj#L199</a></z><z id="t1491670703" t="mtnygard I added https://www.youtube.com/watch?v=_Cf-STRvFy8 to http://pedestal.io"><y>#</y><d>2017-04-08</d><h>16:58</h><w>mtnygard</w>I added <a href="https://www.youtube.com/watch?v=_Cf-STRvFy8" target="_blank">https://www.youtube.com/watch?v=_Cf-STRvFy8</a> to <a href="http://pedestal.io" target="_blank">http://pedestal.io</a></z><z id="t1491864011" t="kenny [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Hmm, I&apos;m not sure what&apos;s happening then. I thought I solved the problem by stopping my loop with put! returned false but that doesn&apos;t appear to solve the problem."><y>#</y><d>2017-04-10</d><h>22:40</h><w>kenny</w><a>@ddeaguiar</a> Hmm, I&apos;m not sure what&apos;s happening then. I thought I solved the problem by stopping my loop with <code>put!</code> returned false but that doesn&apos;t appear to solve the problem.</z><z id="t1491930665" t="bahulneel Hi, is anyone using websockets with pedestal?"><y>#</y><d>2017-04-11</d><h>17:11</h><w>bahulneel</w>Hi, is anyone using websockets with pedestal?</z><z id="t1491930982" t="souenzzo yep"><y>#</y><d>2017-04-11</d><h>17:16</h><r>souenzzo</r>yep</z><z id="t1491931724" t="bahulneel Cool, how did you deal with connection management? The provided ws-map functions don&apos;t seem to carry any connection info"><y>#</y><d>2017-04-11</d><h>17:28</h><r>bahulneel</r>Cool, how did you deal with connection management? The provided ws-map functions don&apos;t seem to carry any connection info</z><z id="t1491931838" t="bahulneel Also, what did you use browser side? I&apos;m loath to implement my own reconnect logic if that kind of thing already exists."><y>#</y><d>2017-04-11</d><h>17:30</h><r>bahulneel</r>Also, what did you use browser side? I&apos;m loath to implement my own reconnect logic if that kind of thing already exists.</z><z id="t1491932714" t="souenzzo I did not find a standard way of dealing with &quot;keep alive&quot;. I implemented &quot;a thread&quot; that do a &quot;ping pong&quot; on all active connections and close."><y>#</y><d>2017-04-11</d><h>17:45</h><r>souenzzo</r>I did not find a standard way of dealing with &quot;keep alive&quot;. I implemented &quot;a thread&quot; that do a &quot;ping pong&quot; on all active connections and close.</z><z id="t1491932762" t="souenzzo Browser side I have no idea 🙂"><y>#</y><d>2017-04-11</d><h>17:46</h><r>souenzzo</r>Browser side I have no idea <b>🙂</b></z><z id="t1491932769" t="bahulneel lol"><y>#</y><d>2017-04-11</d><h>17:46</h><r>bahulneel</r>lol</z><z id="t1491932828" t="bahulneel thanks"><y>#</y><d>2017-04-11</d><h>17:47</h><r>bahulneel</r>thanks</z><z id="t1491933009" t="souenzzo If you find some &quot;standard&quot; way to deal with reconnection(in my case, dosen&apos;t matter, it&apos;s always a new connection) and keep alive (close unative connections) please share 😉"><y>#</y><d>2017-04-11</d><h>17:50</h><r>souenzzo</r>If you find some &quot;standard&quot; way to deal with reconnection(in my case, dosen&apos;t matter, it&apos;s always a new connection) and keep alive (close unative connections) please share <b>😉</b></z><z id="t1491933111" t="bahulneel Will do, it&apos;s a shame that there&apos;s no way to use either sente or chord"><y>#</y><d>2017-04-11</d><h>17:51</h><r>bahulneel</r>Will do, it&apos;s a shame that there&apos;s no way to use either sente or chord</z><z id="t1492004230" t="julianwegkamp [:attrs {:href &quot;/_/_/users/U053BACJP&quot;}] Regarding connection management for websockets: I implemented a defrecord that implements WebSocketConnectionListener and WebSocketListener"><y>#</y><d>2017-04-12</d><h>13:37</h><w>julianwegkamp</w><a>@bahulneel</a> Regarding connection management for websockets: I implemented a defrecord that implements WebSocketConnectionListener and WebSocketListener</z><z id="t1492004258" t="julianwegkamp this way you can store the ws session and refer to it in the callbacks"><y>#</y><d>2017-04-12</d><h>13:37</h><w>julianwegkamp</w>this way you can store the ws session and refer to it in the callbacks</z><z id="t1492004281" t="julianwegkamp it was just a short experiment and I think the code smells a bit"><y>#</y><d>2017-04-12</d><h>13:38</h><w>julianwegkamp</w>it was just a short experiment and I think the code smells a bit</z><z id="t1492004299" t="bahulneel Yeah, I&apos;ve done a similar thing."><y>#</y><d>2017-04-12</d><h>13:38</h><w>bahulneel</w>Yeah, I&apos;ve done a similar thing.</z><z id="t1492004540" t="julianwegkamp [:attrs {:href &quot;/_/_/users/U053BACJP&quot;}] is it similar to this snippet?"><y>#</y><d>2017-04-12</d><h>13:42</h><w>julianwegkamp</w><a>@bahulneel</a> is it similar to this snippet?</z><z id="t1492004610" t="bahulneel Something like that, I actually used the ws-map provided in pedestal. This worked for me because all my messages have all the context in them."><y>#</y><d>2017-04-12</d><h>13:43</h><w>bahulneel</w>Something like that, I actually used the ws-map provided in pedestal. This worked for me because all my messages have all the context in them.</z><z id="t1492004640" t="bahulneel Still have to do some house work to keep the connection pool clean and it smells a bit also"><y>#</y><d>2017-04-12</d><h>13:44</h><w>bahulneel</w>Still have to do some house work to keep the connection pool clean and it smells a bit also</z><z id="t1492004881" t="julianwegkamp You mean that a client always sends its id as part of this context?"><y>#</y><d>2017-04-12</d><h>13:48</h><w>julianwegkamp</w>You mean that a client always sends its id as part of this context?</z><z id="t1492010435" t="bahulneel yes"><y>#</y><d>2017-04-12</d><h>15:20</h><w>bahulneel</w>yes</z><z id="t1492010467" t="bahulneel well, actually when a client connects the server sends it an id."><y>#</y><d>2017-04-12</d><h>15:21</h><w>bahulneel</w>well, actually when a client connects the server sends it an id.</z><z id="t1492013863" t="PB Hey all. I feel rather dumb. Logs being logged with (io.pedestal.log/anylevel ….) are not showing up in my logfiles nor when the server is running. I have not modified the logback.xml or anything that I know of. Anybody know what this could be?"><y>#</y><d>2017-04-12</d><h>16:17</h><w>PB</w>Hey all. I feel rather dumb. Logs being logged with <code>(io.pedestal.log/anylevel ….)</code> are not showing up in my logfiles nor when the server is running. I have not modified the <code>logback.xml</code> or anything that I know of. Anybody know what this could be?</z><z id="t1492014670" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U08UTJ5PB&quot;}] was your service created using the lein pedestal-service template?"><y>#</y><d>2017-04-12</d><h>16:31</h><w>ddeaguiar</w><a>@petr</a> was your service created using the lein pedestal-service template?</z><z id="t1492014682" t="PB [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] it was"><y>#</y><d>2017-04-12</d><h>16:31</h><w>PB</w><a>@ddeaguiar</a> it was</z><z id="t1492014708" t="ddeaguiar I could only guess that some lib is bringing in org.slf4j/slf4j-nop and you need to exclude it"><y>#</y><d>2017-04-12</d><h>16:31</h><w>ddeaguiar</w>I could only guess that some lib is bringing in <code>org.slf4j/slf4j-nop</code> and you need to exclude it</z><z id="t1492014716" t="PB Datomic."><y>#</y><d>2017-04-12</d><h>16:31</h><w>PB</w>Datomic.</z><z id="t1492014718" t="PB I forgot about that"><y>#</y><d>2017-04-12</d><h>16:31</h><w>PB</w>I forgot about that</z><z id="t1492014720" t="ddeaguiar yep"><y>#</y><d>2017-04-12</d><h>16:32</h><w>ddeaguiar</w>yep</z><z id="t1492014721" t="ddeaguiar exclude it"><y>#</y><d>2017-04-12</d><h>16:32</h><w>ddeaguiar</w>exclude it</z><z id="t1492014722" t="PB Thank you"><y>#</y><d>2017-04-12</d><h>16:32</h><w>PB</w>Thank you</z><z id="t1492014727" t="ddeaguiar and you’ll be set"><y>#</y><d>2017-04-12</d><h>16:32</h><w>ddeaguiar</w>and you’ll be set</z><z id="t1492014733" t="PB Sorry it’s been so long since I setup a new project"><y>#</y><d>2017-04-12</d><h>16:32</h><w>PB</w>Sorry it’s been so long since I setup a new project</z><z id="t1492014749" t="ddeaguiar no worries. It’s happened to me more than once 🙂"><y>#</y><d>2017-04-12</d><h>16:32</h><w>ddeaguiar</w>no worries. It’s happened to me more than once <b>🙂</b></z><z id="t1492015947" t="PB [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] is it just org.slf4j/slf4j-nop"><y>#</y><d>2017-04-12</d><h>16:52</h><w>PB</w><a>@ddeaguiar</a> is it just <code>org.slf4j/slf4j-nop</code></z><z id="t1492015971" t="PB I have been looking at my other projects and I find: org.slf4j/jcl-over-slf4j org.slf4j/jul-to-slf4j org.slf4j/log4j-over-slf4j org.slf4j/slf4j-api org.slf4j/slf4j-nop"><y>#</y><d>2017-04-12</d><h>16:52</h><w>PB</w>I have been looking at my other projects and I find:
<pre>org.slf4j/jcl-over-slf4j
org.slf4j/jul-to-slf4j
org.slf4j/log4j-over-slf4j
org.slf4j/slf4j-api
org.slf4j/slf4j-nop</pre></z><z id="t1492015991" t="ddeaguiar Here’s what I typically exclude"><y>#</y><d>2017-04-12</d><h>16:53</h><w>ddeaguiar</w>Here’s what I typically exclude</z><z id="t1492016010" t="ddeaguiar [com.datomic/datomic-pro &quot;0.9.5544&quot; :exclusions [org.slf4j/slf4j-api org.slf4j/slf4j-nop org.slf4j/slf4j-log4j12 org.slf4j/log4j-over-slf4j org.slf4j/jcl-over-slf4j org.slf4j/jul-to-slf4j org.clojure/clojure commons-codec] "><y>#</y><d>2017-04-12</d><h>16:53</h><w>ddeaguiar</w><pre>[com.datomic/datomic-pro &quot;0.9.5544&quot; :exclusions [org.slf4j/slf4j-api
                                                 org.slf4j/slf4j-nop
                                                 org.slf4j/slf4j-log4j12
                                                 org.slf4j/log4j-over-slf4j
                                                 org.slf4j/jcl-over-slf4j
                                                 org.slf4j/jul-to-slf4j
                                                 org.clojure/clojure
                                                 commons-codec]
</pre></z><z id="t1492016019" t="PB CLojure as well?!"><y>#</y><d>2017-04-12</d><h>16:53</h><w>PB</w>CLojure as well?!</z><z id="t1492016064" t="ddeaguiar your project is already bringing in clojure"><y>#</y><d>2017-04-12</d><h>16:54</h><w>ddeaguiar</w>your project is already bringing in clojure</z><z id="t1492016078" t="ddeaguiar I think I did that because I was using clojure 1.9"><y>#</y><d>2017-04-12</d><h>16:54</h><w>ddeaguiar</w>I think I did that because I was using clojure 1.9</z><z id="t1492016095" t="PB Fair enough"><y>#</y><d>2017-04-12</d><h>16:54</h><w>PB</w>Fair enough</z><z id="t1492016283" t="mtnygard I wish more projects used :scope &quot;provided&quot; for their Clojure dependency. That would let the library use its version but the application&apos;s version would automatically override it."><y>#</y><d>2017-04-12</d><h>16:58</h><w>mtnygard</w>I wish more projects used :scope &quot;provided&quot; for their Clojure dependency. That would let the library use its version but the application&apos;s version would automatically override it.</z><z id="t1492018007" t="souenzzo I finally understood :provided"><y>#</y><d>2017-04-12</d><h>17:26</h><r>souenzzo</r>I finally understood <code>:provided</code></z><z id="t1492021913" t="bahulneel [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I&apos;ve never really understood how scopes work, is there a place I can go to learn?"><y>#</y><d>2017-04-12</d><h>18:31</h><w>bahulneel</w><a>@mtnygard</a> I&apos;ve never really understood how scopes work, is there a place I can go to learn?</z><z id="t1492022858" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U053BACJP&quot;}] refer to https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html . Maven is used under the covers"><y>#</y><d>2017-04-12</d><h>18:47</h><w>ddeaguiar</w><a>@bahulneel</a> refer to <a href="https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html" target="_blank">https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html</a>. Maven is used under the covers</z><z id="t1492022927" t="bahulneel [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Would explain why I&apos;ve had little success in finding documentation 🙂 , thanks for the help."><y>#</y><d>2017-04-12</d><h>18:48</h><w>bahulneel</w><a>@ddeaguiar</a> Would explain why I&apos;ve had little success in finding documentation <b>🙂</b>, thanks for the help.</z><z id="t1492023582" t="ddeaguiar np!"><y>#</y><d>2017-04-12</d><h>18:59</h><w>ddeaguiar</w>np!</z><z id="t1492024048" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U053BACJP&quot;}] I more exact answer is that Lein uses https://github.com/cemerick/pomegranate under the covers. Pomegranate wraps Sonatype Aether. The scopes are Maven scopes ( https://github.com/cemerick/pomegranate/blob/pomegranate-0.3.0/src/main/clojure/cemerick/pomegranate/aether.clj#L632 ). So the Maven docs are still a good place to look."><y>#</y><d>2017-04-12</d><h>19:07</h><w>ddeaguiar</w><a>@bahulneel</a> I more exact answer is that Lein uses <a href="https://github.com/cemerick/pomegranate" target="_blank">https://github.com/cemerick/pomegranate</a> under the covers. Pomegranate wraps Sonatype Aether. The scopes are Maven scopes (<a href="https://github.com/cemerick/pomegranate/blob/pomegranate-0.3.0/src/main/clojure/cemerick/pomegranate/aether.clj#L632" target="_blank">https://github.com/cemerick/pomegranate/blob/pomegranate-0.3.0/src/main/clojure/cemerick/pomegranate/aether.clj#L632</a>). So the Maven docs are still a good place to look.</z><z id="t1492024417" t="ddeaguiar And I suppose the :dependencies vector in project.clj is more precisely referred to as a vector of Maven coordinates."><y>#</y><d>2017-04-12</d><h>19:13</h><w>ddeaguiar</w>And I suppose the <code>:dependencies</code> vector in <code>project.clj</code> is more precisely referred to as a vector of Maven coordinates.</z><z id="t1492025210" t="bahulneel Thanks all"><y>#</y><d>2017-04-12</d><h>19:26</h><w>bahulneel</w>Thanks all</z><z id="t1492028491" t="deg Hey, so I just watched https://www.youtube.com/watch?v=_Cf-STRvFy8 . Paul does a great job of presenting Vase, and I learned that there is a lot more power than I had realized in the vase/apis syntax (e.g. :params in the slide at 23:00). I&apos;ve read the docs at https://github.com/cognitect-labs/vase/tree/master/docs , but haven&apos;t seen much of this. Are there more docs somewhere? (Or are we still at &quot;read the source, Luke?) It would be great to even have a beginner doc that walks through the syntax bits presented in this video."><y>#</y><d>2017-04-12</d><h>20:21</h><w>deg</w>Hey, so I just watched <a href="https://www.youtube.com/watch?v=_Cf-STRvFy8" target="_blank">https://www.youtube.com/watch?v=_Cf-STRvFy8</a>. Paul does a great job of presenting Vase, and I learned that there is a lot more power than I had realized in the <code>vase/apis</code> syntax (e.g. <code>:params</code> in the slide at 23:00).
I&apos;ve read the docs at <a href="https://github.com/cognitect-labs/vase/tree/master/docs" target="_blank">https://github.com/cognitect-labs/vase/tree/master/docs</a>, but haven&apos;t seen much of this. Are there more docs somewhere? (Or are we still at &quot;read the source, Luke?)
It would be great to even have a beginner doc that walks through the syntax bits presented in this video.</z><z id="t1492208136" t="hlship I&apos;d like to run Pedestal listening on three different ports. Each port is effectively its own server, with its own Pedestal stack ... but I&apos;d like to have a single Jetty Server instance, and single pool of Jetty threads. Reasonable?"><y>#</y><d>2017-04-14</d><h>22:15</h><w>hlship</w>I&apos;d like to run Pedestal listening on three different ports. Each port is effectively its own server, with its own Pedestal stack ... but I&apos;d like to have a single Jetty Server instance, and single pool of Jetty threads.  Reasonable?</z><z id="t1492208192" t="mtnygard [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] Totally doable, with some finesse about the lifecycle functions."><y>#</y><d>2017-04-14</d><h>22:16</h><w>mtnygard</w><a>@hlship</a> Totally doable, with some finesse about the lifecycle functions.</z><z id="t1492208212" t="mtnygard Basically you need to call the functions that Pedestal would normally call to create the parts."><y>#</y><d>2017-04-14</d><h>22:16</h><w>mtnygard</w>Basically you need to call the functions that Pedestal would normally call to create the parts.</z><z id="t1492208231" t="mtnygard You can still use the servlet-interceptor... three of them, in fact."><y>#</y><d>2017-04-14</d><h>22:17</h><w>mtnygard</w>You can still use the servlet-interceptor... three of them, in fact.</z><z id="t1492208255" t="mtnygard And once you get that hooked up as the servlet for Jetty to dispatch to, the rest is standard Pedestal code."><y>#</y><d>2017-04-14</d><h>22:17</h><w>mtnygard</w>And once you get that hooked up as the servlet for Jetty to dispatch to, the rest is standard Pedestal code.</z><z id="t1492210331" t="hlship I get lost a lot inside Jetty configuration; all that mutable state ..."><y>#</y><d>2017-04-14</d><h>22:52</h><w>hlship</w>I get lost a lot inside Jetty configuration; all that mutable state ...</z><z id="t1492482133" t="danielcompton Is there an example of a best practices Pedestal (and Vase?) app which uses Component?"><y>#</y><d>2017-04-18</d><h>02:22</h><w>danielcompton</w>Is there an example of a best practices Pedestal (and Vase?) app which uses Component?</z><z id="t1492502137" t="thegeez I can&apos;t claim this is best practice in each regard, but this project uses pedestal and component: https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/main.clj"><y>#</y><d>2017-04-18</d><h>07:55</h><w>thegeez</w>I can&apos;t claim this is best practice in each regard, but this project uses pedestal and component: <a href="https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/main.clj" target="_blank">https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/main.clj</a></z><z id="t1492502192" t="thegeez [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] the split with a component for the service (with the routes etc) and the jetty server is recommended for sure tho"><y>#</y><d>2017-04-18</d><h>07:56</h><w>thegeez</w><a>@danielcompton</a> the split with a component for the service (with the routes etc) and the jetty server is recommended for sure tho</z><z id="t1492521179" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] There’s a Vase sample that uses Component https://github.com/cognitect-labs/vase/tree/master/samples/vase-component"><y>#</y><d>2017-04-18</d><h>13:12</h><w>ddeaguiar</w><a>@danielcompton</a> There’s a Vase sample that uses Component <a href="https://github.com/cognitect-labs/vase/tree/master/samples/vase-component" target="_blank">https://github.com/cognitect-labs/vase/tree/master/samples/vase-component</a></z><z id="t1492521212" t="ddeaguiar There’s also a Pedestal guide http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2017-04-18</d><h>13:13</h><w>ddeaguiar</w>There’s also a Pedestal guide <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1492539966" t="danielcompton nice thanks 🙂"><y>#</y><d>2017-04-18</d><h>18:26</h><w>danielcompton</w>nice thanks <b>🙂</b></z><z id="t1492575453" t="danielcompton Does search work on the Pedestal website? http://pedestal.io/search?q=interceptor"><y>#</y><d>2017-04-19</d><h>04:17</h><w>danielcompton</w>Does search work on the Pedestal website? <a href="http://pedestal.io/search?q=interceptor" target="_blank">http://pedestal.io/search?q=interceptor</a></z><z id="t1492575461" t="danielcompton That link doesn&apos;t return any results"><y>#</y><d>2017-04-19</d><h>04:17</h><w>danielcompton</w>That link doesn&apos;t return any results</z><z id="t1492575589" t="jimmy [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] I find pedestal docs site needs some work. Just in case, this is the doc regarding interceptor : http://pedestal.io/reference/interceptors"><y>#</y><d>2017-04-19</d><h>04:19</h><w>jimmy</w><a>@danielcompton</a> I find pedestal docs site needs some work. Just in case, this is the doc regarding interceptor : <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1492575716" t="danielcompton thanks, I was looking for docs on :env and nothing came up so I tried something that I was sure would come back which was interceptors 🙂"><y>#</y><d>2017-04-19</d><h>04:21</h><w>danielcompton</w>thanks, I was looking for docs on <code>:env</code> and nothing came up so I tried something that I was sure would come back which was interceptors <b>🙂</b></z><z id="t1492575871" t="danielcompton specifically, I&apos;m looking for any patterns of adding interceptors at development time only"><y>#</y><d>2017-04-19</d><h>04:24</h><w>danielcompton</w>specifically, I&apos;m looking for any patterns of adding interceptors at development time only</z><z id="t1492575890" t="danielcompton I assumed that a good way to do this is to rely on the :env key?"><y>#</y><d>2017-04-19</d><h>04:24</h><w>danielcompton</w>I assumed that a good way to do this is to rely on the <code>:env</code> key?</z><z id="t1492577267" t="jimmy not particularly, they change the system-map for dev before running dev-service: https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L22-L39"><y>#</y><d>2017-04-19</d><h>04:47</h><w>jimmy</w>not particularly, they change the <code>system-map</code> for dev before running dev-service:
<a href="https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L22-L39" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L22-L39</a></z><z id="t1492577345" t="jimmy the :env is pretty much an indication from user not from this framework. And of course we can rely on that to do anythings."><y>#</y><d>2017-04-19</d><h>04:49</h><w>jimmy</w>the <code>:env</code> is pretty much an indication from user not from this framework. And of course we can rely on that to do anythings.</z><z id="t1492609297" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I just added an issue about the search feature on http://pedestal.io . Thanks for pointing that out. Anywhere else you see room for improvement? I’d like to turn any frustration you have into issues so I can improve the site."><y>#</y><d>2017-04-19</d><h>13:41</h><w>mtnygard</w><a>@nxqd</a> I just added an issue about the search feature on <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>. Thanks for pointing that out.

Anywhere else you see room for improvement? I’d like to turn any frustration you have into issues so I can improve the site.</z><z id="t1492609466" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ah in this page http://pedestal.io/guides/index . The interceptor document ( ) should point to interceptor reference for now, since we don&apos;t have any document atm."><y>#</y><d>2017-04-19</d><h>13:44</h><w>jimmy</w><a>@mtnygard</a> ah in this page <a href="http://pedestal.io/guides/index" target="_blank">http://pedestal.io/guides/index</a>. The interceptor document ( <code></code> ) should point to interceptor reference for now, since we don&apos;t have any document atm.</z><z id="t1492609520" t="mtnygard Unless you’d be interested in writing the guide…?"><y>#</y><d>2017-04-19</d><h>13:45</h><w>mtnygard</w>Unless you’d be interested in writing the guide…?</z><z id="t1492609550" t="mtnygard I’ve got a checklist of topics for that guide in https://github.com/pedestal/pedestal-docs/issues/48"><y>#</y><d>2017-04-19</d><h>13:45</h><w>mtnygard</w>I’ve got a checklist of topics for that guide in <a href="https://github.com/pedestal/pedestal-docs/issues/48" target="_blank">https://github.com/pedestal/pedestal-docs/issues/48</a></z><z id="t1492609745" t="jimmy I would love to, but I&apos;m quite busy atm ( quite terrible at writing btw ) . However, I will note this down."><y>#</y><d>2017-04-19</d><h>13:49</h><w>jimmy</w>I would love to, but I&apos;m quite busy atm ( quite terrible at writing btw ) . However, I will note this down.</z><z id="t1492609788" t="mtnygard Totally understand."><y>#</y><d>2017-04-19</d><h>13:49</h><w>mtnygard</w>Totally understand.</z><z id="t1492609813" t="mtnygard I’m just always on the lookout for ways to get the community engaged."><y>#</y><d>2017-04-19</d><h>13:50</h><w>mtnygard</w>I’m just always on the lookout for ways to get the community engaged.</z><z id="t1492712330" t="hagmonk so I&apos;m finding lots of use cases for interceptor chains in some data processing code I&apos;m writing"><y>#</y><d>2017-04-20</d><h>18:18</h><w>hagmonk</w>so I&apos;m finding lots of use cases for interceptor chains in some data processing code I&apos;m writing</z><z id="t1492712396" t="hagmonk I&apos;d like to re-use io.pedestal.interceptor for this if possible, but one of the primary things I would like is a way to instrument each :enter and :leave function so I can compute stats about how long the chain takes and what is slowing it down"><y>#</y><d>2017-04-20</d><h>18:19</h><w>hagmonk</w>I&apos;d like to re-use io.pedestal.interceptor for this if possible, but one of the primary things I would like is a way to instrument each :enter and :leave function so I can compute stats about how long the chain takes and what is slowing it down</z><z id="t1492712506" t="hagmonk so far I don&apos;t see an obvious hook in the source where I can wrap each interceptor ... could I be missing something?"><y>#</y><d>2017-04-20</d><h>18:21</h><w>hagmonk</w>so far I don&apos;t see an obvious hook in the source where I can wrap each interceptor ... could I be missing something?</z><z id="t1492712529" t="ddeaguiar I can see this being done a number of ways"><y>#</y><d>2017-04-20</d><h>18:22</h><w>ddeaguiar</w>I can see this being done a number of ways</z><z id="t1492712607" t="ddeaguiar when you construct an interceptor, the :enter and :leave impls are just functions. wrap them with a higher-order fn that keeps track of timing. But it might be better to implement a stateful interceptor"><y>#</y><d>2017-04-20</d><h>18:23</h><w>ddeaguiar</w>when you construct an interceptor, the <code>:enter</code> and <code>:leave</code> impls are just functions. wrap them with a higher-order fn that keeps track of timing. But it might be better to implement a stateful interceptor</z><z id="t1492712662" t="ddeaguiar You can create a record that implements the IntoInterceptor protocol https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L23"><y>#</y><d>2017-04-20</d><h>18:24</h><w>ddeaguiar</w>You can create a record that implements the <code>IntoInterceptor</code> protocol <a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L23" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L23</a></z><z id="t1492712664" t="mtnygard [:attrs {:href &quot;/_/_/users/U0R92J961&quot;}] I&apos;ll also put in a plug for the pedestal.log module as a way to convey the metrics out of the process"><y>#</y><d>2017-04-20</d><h>18:24</h><w>mtnygard</w><a>@hagmonk</a> I&apos;ll also put in a plug for the pedestal.log module as a way to convey the metrics out of the process</z><z id="t1492712702" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] true, pedestal.log has metrics support"><y>#</y><d>2017-04-20</d><h>18:25</h><w>ddeaguiar</w><a>@mtnygard</a> true, pedestal.log has metrics support</z><z id="t1492712713" t="hagmonk ooh, see I knew I was missing something"><y>#</y><d>2017-04-20</d><h>18:25</h><w>hagmonk</w>ooh, see I knew I was missing something</z><z id="t1492712733" t="ddeaguiar actually that would probably be easiest, no?"><y>#</y><d>2017-04-20</d><h>18:25</h><w>ddeaguiar</w>actually that would probably be easiest, no?</z><z id="t1492712746" t="ddeaguiar each :enter/:leave fn could emit a metric"><y>#</y><d>2017-04-20</d><h>18:25</h><w>ddeaguiar</w>each <code>:enter/:leave</code> fn could emit a metric</z><z id="t1492712773" t="mtnygard well, I don&apos;t want to get you too excited... the interceptor chain provider doesn&apos;t track metrics. that is still up to your interceptors."><y>#</y><d>2017-04-20</d><h>18:26</h><w>mtnygard</w>well, I don&apos;t want to get you too excited... the interceptor chain provider doesn&apos;t track metrics. that is still up to your interceptors.</z><z id="t1492712833" t="ddeaguiar yes, but you’re free to emit metrics using pedestal.log from your lifecycle implementations"><y>#</y><d>2017-04-20</d><h>18:27</h><w>ddeaguiar</w>yes, but you’re free to emit metrics using <code>pedestal.log</code> from your lifecycle implementations</z><z id="t1492712880" t="ddeaguiar given that, I’d use a higher-order fn which does that and wraps the :enter/:leave impls"><y>#</y><d>2017-04-20</d><h>18:28</h><w>ddeaguiar</w>given that, I’d use a higher-order fn which does that and wraps the <code>:enter/:leave</code> impls</z><z id="t1492712888" t="hagmonk it seems to use dropwizard which is perfect, the wrapper looks nicer than metrics-clojure anyway"><y>#</y><d>2017-04-20</d><h>18:28</h><w>hagmonk</w>it seems to use dropwizard which is perfect, the wrapper looks nicer than metrics-clojure anyway</z><z id="t1492712974" t="hagmonk so I could create an interceptor chain, then map a wrapper fn that handles metrics over that"><y>#</y><d>2017-04-20</d><h>18:29</h><w>hagmonk</w>so I could create an interceptor chain, then map a wrapper fn that handles metrics over that</z><z id="t1492712995" t="hagmonk or investigate an IntoInterceptor record"><y>#</y><d>2017-04-20</d><h>18:29</h><w>hagmonk</w>or investigate an IntoInterceptor record</z><z id="t1492713026" t="ddeaguiar hrm, I’ll redact my IntoInterceptor record recommendation. At least for now"><y>#</y><d>2017-04-20</d><h>18:30</h><w>ddeaguiar</w>hrm, I’ll redact my IntoInterceptor record recommendation. At least for now</z><z id="t1492713058" t="ddeaguiar I think it’s simpler to use a metrics wrapper"><y>#</y><d>2017-04-20</d><h>18:30</h><w>ddeaguiar</w>I think it’s simpler to use a metrics wrapper</z><z id="t1492713095" t="ddeaguiar Of course I’m designing this off the top of my head. The key insight is to use pedestal.log ’s metric support"><y>#</y><d>2017-04-20</d><h>18:31</h><w>ddeaguiar</w>Of course I’m designing this off the top of my head. The key insight is to use <code>pedestal.log</code>’s metric support</z><z id="t1492713108" t="hagmonk I think it&apos;s simpler too, but I&apos;m learning a lot by reading the pedestal source"><y>#</y><d>2017-04-20</d><h>18:31</h><w>hagmonk</w>I think it&apos;s simpler too, but I&apos;m learning a lot by reading the pedestal source</z><z id="t1492713127" t="ddeaguiar great stuff to be found there!"><y>#</y><d>2017-04-20</d><h>18:32</h><w>ddeaguiar</w>great stuff to be found there!</z><z id="t1492713166" t="hagmonk I&apos;m executing this chain on top of an Apache Ignite cluster so I&apos;m pondering if I can capitalize on that somehow"><y>#</y><d>2017-04-20</d><h>18:32</h><w>hagmonk</w>I&apos;m executing this chain on top of an Apache Ignite cluster so I&apos;m pondering if I can capitalize on that somehow</z><z id="t1492713220" t="ddeaguiar Not familiar with Apache Ignite so I can’t comment"><y>#</y><d>2017-04-20</d><h>18:33</h><w>ddeaguiar</w>Not familiar with Apache Ignite so I can’t comment</z><z id="t1492713256" t="hagmonk ideas will come to me as I implement, more just thinking out loud 😉"><y>#</y><d>2017-04-20</d><h>18:34</h><w>hagmonk</w>ideas will come to me as I implement, more just thinking out loud <b>😉</b></z><z id="t1492713607" t="hagmonk I&apos;ve been musing on this idea for general Clojure functions, but maybe interceptors are a better context. That idea was attaching metadata to functions that simply says &quot;time how long this takes&quot;, or &quot;attach this Failsafe policy&quot;, or &quot;rename the thread of execution inside this function&quot;"><y>#</y><d>2017-04-20</d><h>18:40</h><w>hagmonk</w>I&apos;ve been musing on this idea for general Clojure functions, but maybe interceptors are a better context. That idea was attaching metadata to functions that simply says &quot;time how long this takes&quot;, or &quot;attach this Failsafe policy&quot;, or &quot;rename the thread of execution inside this function&quot;</z><z id="t1492713652" t="hagmonk seems like I could build that on top of interceptors way easier than trying to figure out how to do meta magic on top of naked clojure functions"><y>#</y><d>2017-04-20</d><h>18:40</h><w>hagmonk</w>seems like I could build that on top of interceptors way easier than trying to figure out how to do meta magic on top of naked clojure functions</z><z id="t1492713666" t="mtnygard I agree. 🙂"><y>#</y><d>2017-04-20</d><h>18:41</h><w>mtnygard</w>I agree. <b>🙂</b></z><z id="t1492713714" t="hagmonk I suspected you might 😉"><y>#</y><d>2017-04-20</d><h>18:41</h><w>hagmonk</w>I suspected you might <b>😉</b></z><z id="t1492714077" t="hagmonk oh, the interceptor queue is an instance of the furtive clojure.lang.PersistentQueue. Cool."><y>#</y><d>2017-04-20</d><h>18:47</h><w>hagmonk</w>oh, the interceptor queue is an instance of the furtive clojure.lang.PersistentQueue. Cool.</z><z id="t1492771024" t="skylar Can someone give me an advice how to get the hot-loading feature on the development working in the REPL? A link would be helpful, I just couldn&apos;t find any relevant from the Pedestal issue or the Stackoverflow. I am running on Pedelstal version 0.5.2."><y>#</y><d>2017-04-21</d><h>10:37</h><w>skylar</w>Can someone give me an advice how to get the hot-loading feature on the development working in the REPL? A link would be helpful, I just couldn&apos;t find any relevant from the Pedestal issue or the Stackoverflow.

I am running on Pedelstal version 0.5.2.</z><z id="t1492771095" t="skylar I have also followed this guide: http://pedestal.io/guides/developing-at-the-repl"><y>#</y><d>2017-04-21</d><h>10:38</h><w>skylar</w>I have also followed this guide: <a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a></z><z id="t1492782535" t="martinklepsch I want to see the debug log messages of pedestals interceptor.chain namespace — can anyone point me how to enable debug logging for that namespace with pedestals logging lib?"><y>#</y><d>2017-04-21</d><h>13:48</h><w>martinklepsch</w>I want to see the debug log messages of pedestals interceptor.chain namespace — can anyone point me how to enable debug logging for that namespace with pedestals logging lib?</z><z id="t1492782952" t="martinklepsch I think I’m running into something where this line should be true but isn’t https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L75"><y>#</y><d>2017-04-21</d><h>13:55</h><w>martinklepsch</w>I think I’m running into something where this line should be true but isn’t <a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L75" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/chain.clj#L75</a></z><z id="t1492782972" t="martinklepsch thus I’m ending up with exceptions that are like “Interceptor Exception: Interceptor Exception: ….&quot;"><y>#</y><d>2017-04-21</d><h>13:56</h><w>martinklepsch</w>thus I’m ending up with exceptions that are like “Interceptor Exception: Interceptor Exception: ….&quot;</z><z id="t1492784197" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] update the logback.xml config as such &lt;logger name=&quot;io.pedestal.interceptor.chain&quot; level=&quot;DEBUG&quot; /&gt;"><y>#</y><d>2017-04-21</d><h>14:16</h><w>ddeaguiar</w><a>@martinklepsch</a> update the logback.xml config as such <code>&lt;logger name=&quot;io.pedestal.interceptor.chain&quot; level=&quot;DEBUG&quot; /&gt;</code></z><z id="t1492784221" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks!"><y>#</y><d>2017-04-21</d><h>14:17</h><w>martinklepsch</w><a>@ddeaguiar</a> thanks!</z><z id="t1492784227" t="ddeaguiar or use TRACE for more info"><y>#</y><d>2017-04-21</d><h>14:17</h><w>ddeaguiar</w>or use <code>TRACE</code> for more info</z><z id="t1492784247" t="ddeaguiar no need to restart the service. The change should hotload"><y>#</y><d>2017-04-21</d><h>14:17</h><w>ddeaguiar</w>no need to restart the service. The change should hotload</z><z id="t1492784362" t="ddeaguiar BTW, I’ve found lnav ( http://lnav.org/ ) to be an excellent tool for viewing logs. Here’s my lnav configuration: https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json"><y>#</y><d>2017-04-21</d><h>14:19</h><w>ddeaguiar</w>BTW, I’ve found lnav (<a href="http://lnav.org/" target="_blank">http://lnav.org/</a>) to be an excellent tool for viewing logs. Here’s my lnav configuration: <a href="https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json" target="_blank">https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json</a></z><z id="t1492784731" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] actually was looking for something similar the other day and settled on some other tool. already forgot the name again lol"><y>#</y><d>2017-04-21</d><h>14:25</h><w>martinklepsch</w><a>@ddeaguiar</a> actually was looking for something similar the other day and settled on some other tool. already forgot the name again lol</z><z id="t1492784759" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] does it support viewing remote log files, potentially from multiple systems at once?"><y>#</y><d>2017-04-21</d><h>14:25</h><w>martinklepsch</w><a>@ddeaguiar</a> does it support viewing remote log files, potentially from multiple systems at once?</z><z id="t1492784785" t="ddeaguiar I’ve not tried that so can’t comment"><y>#</y><d>2017-04-21</d><h>14:26</h><w>ddeaguiar</w>I’ve not tried that so can’t comment</z><z id="t1492784789" t="ddeaguiar that would be cool though"><y>#</y><d>2017-04-21</d><h>14:26</h><w>ddeaguiar</w>that would be cool though</z><z id="t1492784834" t="martinklepsch I’ve set up papertrail recently and while that’s helpful some terminal tool that shows me all logs might also be perfectly fine"><y>#</y><d>2017-04-21</d><h>14:27</h><w>martinklepsch</w>I’ve set up papertrail recently and while that’s helpful some terminal tool that shows me all logs might also be perfectly fine</z><z id="t1492784846" t="martinklepsch that said it doesn’t seem to be within the scope of inav"><y>#</y><d>2017-04-21</d><h>14:27</h><w>martinklepsch</w>that said it doesn’t seem to be within the scope of inav</z><z id="t1492784858" t="ddeaguiar I was looking for something that made it a bit easier to explore the data structures in the logs"><y>#</y><d>2017-04-21</d><h>14:27</h><w>ddeaguiar</w>I was looking for something that made it a bit easier to explore the data structures in the logs</z><z id="t1492784897" t="ddeaguiar The query support is nice but I’ve not used it too much"><y>#</y><d>2017-04-21</d><h>14:28</h><w>ddeaguiar</w>The query support is nice but I’ve not used it too much</z><z id="t1492784975" t="mtnygard IIRC, lnav can view remote logs as long as they&apos;re accessible via url"><y>#</y><d>2017-04-21</d><h>14:29</h><w>mtnygard</w>IIRC, lnav can view remote logs as long as they&apos;re accessible via url</z><z id="t1492785101" t="ddeaguiar From the lnav v0.8.0 release notes - Integration with &quot;&quot; for querying and tailing server log and syslog messages. See the Papertrail section in the online help for more details. - Remote files can be opened when lnav is built with libcurl v7.23.0+ "><y>#</y><d>2017-04-21</d><h>14:31</h><w>ddeaguiar</w>From the lnav v0.8.0 release notes
<pre>- Integration with &quot;&quot; for querying and tailing server log and syslog messages. See the Papertrail section in the online help for more details.
- Remote files can be opened when lnav is built with libcurl v7.23.0+
</pre></z><z id="t1492785130" t="ddeaguiar I’ve not tried to do any fancy things with it"><y>#</y><d>2017-04-21</d><h>14:32</h><w>ddeaguiar</w>I’ve not tried to do any fancy things with it</z><z id="t1492785153" t="martinklepsch Interesting!"><y>#</y><d>2017-04-21</d><h>14:32</h><w>martinklepsch</w>Interesting!</z><z id="t1492785211" t="ddeaguiar being able to dynamically expand and collapse log lines was a huge plus for me but I suppose my expectations were low 🙂"><y>#</y><d>2017-04-21</d><h>14:33</h><w>ddeaguiar</w>being able to dynamically expand and collapse log lines was a huge plus for me but I suppose my expectations were low <b>🙂</b></z><z id="t1492785281" t="martinklepsch I mostly look at logs with tail -f so I guess my expectations aren’t high either 😄"><y>#</y><d>2017-04-21</d><h>14:34</h><w>martinklepsch</w>I mostly look at logs with tail -f so I guess my expectations aren’t high either <b>😄</b></z><z id="t1492785351" t="ddeaguiar hehe, yeah. I just got tired of trying to eyeball the key/value pairs in logged request and context maps"><y>#</y><d>2017-04-21</d><h>14:35</h><w>ddeaguiar</w>hehe, yeah. I just got tired of trying to eyeball the key/value pairs in logged request and context maps</z><z id="t1492785681" t="ddeaguiar In any case, my threshold for pain is pretty high. I’m pretty sure my usage of lnav came out of a pairing session with [:attrs {:href &quot;/_/_/users/U0AL22XQB&quot;}] . His threshold for pain is lower 🙂"><y>#</y><d>2017-04-21</d><h>14:41</h><w>ddeaguiar</w>In any case, my threshold for pain is pretty high. I’m pretty sure my usage of lnav came out of a pairing session with <a>@christianromney</a>. His threshold for pain is lower <b>🙂</b></z><z id="t1492793006" t="christianromney spell of summoning...yes my pain threshold is notoriously low 🙂"><y>#</y><d>2017-04-21</d><h>16:43</h><w>christianromney</w>spell of summoning...yes my pain threshold is notoriously low <b>🙂</b></z><z id="t1492803344" t="PB How is everyone here reloading their app? I currently have to kill my repl if I make any changes to my service.clj file"><y>#</y><d>2017-04-21</d><h>19:35</h><w>PB</w>How is everyone here reloading their app? I currently have to kill my repl if I make any changes to my <code>service.clj</code> file</z><z id="t1492803495" t="PB Pedestal service that is"><y>#</y><d>2017-04-21</d><h>19:38</h><w>PB</w>Pedestal service that is</z><z id="t1492803676" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U08UTJ5PB&quot;}] was your app built from the pedestal-service lein template?"><y>#</y><d>2017-04-21</d><h>19:41</h><w>ddeaguiar</w><a>@petr</a> was your app built from the <code>pedestal-service</code> lein template?</z><z id="t1492803687" t="PB [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] it was indeed"><y>#</y><d>2017-04-21</d><h>19:41</h><w>PB</w><a>@ddeaguiar</a> it was indeed</z><z id="t1492803713" t="ddeaguiar ok, did you start your service using run-dev ?"><y>#</y><d>2017-04-21</d><h>19:41</h><w>ddeaguiar</w>ok, did you start your service using <code>run-dev</code>?</z><z id="t1492803729" t="PB I also have to reload for any namespaces required inside of the service.clj file"><y>#</y><d>2017-04-21</d><h>19:42</h><w>PB</w>I also have to reload for any namespaces required inside of the <code>service.clj</code> file</z><z id="t1492803739" t="PB I’m starting a repl and calling the run-dev fn"><y>#</y><d>2017-04-21</d><h>19:42</h><w>PB</w>I’m starting a repl and calling the <code>run-dev</code> fn</z><z id="t1492803753" t="PB As I like to connect emacs to a repl"><y>#</y><d>2017-04-21</d><h>19:42</h><w>PB</w>As I like to connect emacs to a repl</z><z id="t1492803870" t="ddeaguiar reloading your routes and the and any interceptors/handlers that changed should do it"><y>#</y><d>2017-04-21</d><h>19:44</h><w>ddeaguiar</w>reloading your routes and the and any interceptors/handlers that changed should do it</z><z id="t1492803900" t="ddeaguiar for example, if your service code is in service.clj as in the pedestal-service template, just load that file after making changes"><y>#</y><d>2017-04-21</d><h>19:45</h><w>ddeaguiar</w>for example, if your service code is in <code>service.clj</code> as in the <code>pedestal-service</code> template, just load that file after making changes</z><z id="t1492803939" t="ddeaguiar I presume you are trying to load changes you made to routes/interceptors/handlers"><y>#</y><d>2017-04-21</d><h>19:45</h><w>ddeaguiar</w>I presume you are trying to load changes you made to routes/interceptors/handlers</z><z id="t1492803946" t="PB I am indeed"><y>#</y><d>2017-04-21</d><h>19:45</h><w>PB</w>I am indeed</z><z id="t1492803949" t="skylar [:attrs {:href &quot;/_/_/users/U08UTJ5PB&quot;}] I was asking the same question"><y>#</y><d>2017-04-21</d><h>19:45</h><w>skylar</w><a>@petr</a> I was asking the same question</z><z id="t1492803959" t="PB But loading that file into my repl doesn’t change anything"><y>#</y><d>2017-04-21</d><h>19:45</h><w>PB</w>But loading that file into my repl doesn’t change anything</z><z id="t1492803965" t="PB I find myself having to restart hte repl"><y>#</y><d>2017-04-21</d><h>19:46</h><w>PB</w>I find myself having to restart hte repl</z><z id="t1492803971" t="PB Maybe it’s cidr?"><y>#</y><d>2017-04-21</d><h>19:46</h><w>PB</w>Maybe it’s cidr?</z><z id="t1492803983" t="ddeaguiar doubtful, I use cider + emacs"><y>#</y><d>2017-04-21</d><h>19:46</h><w>ddeaguiar</w>doubtful, I use cider + emacs</z><z id="t1492804000" t="PB Do you use C-c C-k ?"><y>#</y><d>2017-04-21</d><h>19:46</h><w>PB</w>Do you use <code>C-c C-k</code>?</z><z id="t1492804025" t="ddeaguiar I think so, let me test"><y>#</y><d>2017-04-21</d><h>19:47</h><w>ddeaguiar</w>I think so, let me test</z><z id="t1492804031" t="skylar I am using Intellij Idea with local REPL and it&apos;s not working"><y>#</y><d>2017-04-21</d><h>19:47</h><w>skylar</w>I am using Intellij Idea with local REPL and it&apos;s not working</z><z id="t1492804053" t="skylar I get it works with Lighttable"><y>#</y><d>2017-04-21</d><h>19:47</h><w>skylar</w>I get it works with Lighttable</z><z id="t1492804068" t="PB I remember when light table first came out"><y>#</y><d>2017-04-21</d><h>19:47</h><w>PB</w>I remember when light table first came out</z><z id="t1492804074" t="PB I was so excited for Chris"><y>#</y><d>2017-04-21</d><h>19:47</h><w>PB</w>I was so excited for Chris</z><z id="t1492804086" t="PB Its just so unuseable though"><y>#</y><d>2017-04-21</d><h>19:48</h><w>PB</w>Its just so unuseable though</z><z id="t1492804102" t="skylar That&apos;s why I moved to Idea"><y>#</y><d>2017-04-21</d><h>19:48</h><w>skylar</w>That&apos;s why I moved to Idea</z><z id="t1492804176" t="skylar but for some reason my run-dev is not working"><y>#</y><d>2017-04-21</d><h>19:49</h><w>skylar</w>but for some reason my run-dev is not working</z><z id="t1492804206" t="ddeaguiar yeah so it works when I cider-load-buffer (`C-C C-k`)"><y>#</y><d>2017-04-21</d><h>19:50</h><w>ddeaguiar</w>yeah so it works when I  <code>cider-load-buffer</code> (`C-C C-k`)</z><z id="t1492804246" t="ddeaguiar I just created a new pedestal service and I can change the home-page fn, reload and see the change"><y>#</y><d>2017-04-21</d><h>19:50</h><w>ddeaguiar</w>I just created a new pedestal service and I can change the home-page fn, reload and see the change</z><z id="t1492804310" t="ddeaguiar This should also work with intellij + cursive"><y>#</y><d>2017-04-21</d><h>19:51</h><w>ddeaguiar</w>This should also work with intellij + cursive</z><z id="t1492804370" t="ddeaguiar But it only works changes to routing in either case. Refer to https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21"><y>#</y><d>2017-04-21</d><h>19:52</h><w>ddeaguiar</w>But it only works changes to routing in either case. Refer to <a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21</a></z><z id="t1492804399" t="ddeaguiar If you change other properties of the service map, like port, etc, then you need to restart"><y>#</y><d>2017-04-21</d><h>19:53</h><w>ddeaguiar</w>If you change other properties of the service map, like port, etc, then you need to restart</z><z id="t1492804406" t="PB So I’m building atest quick"><y>#</y><d>2017-04-21</d><h>19:53</h><w>PB</w>So I’m building atest quick</z><z id="t1492804518" t="skylar I [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I have the latest Pedestal template and it&apos;s not working for me"><y>#</y><d>2017-04-21</d><h>19:55</h><w>skylar</w>I <a>@ddeaguiar</a> I have the latest Pedestal template and it&apos;s not working for me</z><z id="t1492804540" t="PB Hah he is right"><y>#</y><d>2017-04-21</d><h>19:55</h><w>PB</w>Hah he is right</z><z id="t1492804542" t="PB It is working"><y>#</y><d>2017-04-21</d><h>19:55</h><w>PB</w>It is working</z><z id="t1492804544" t="ddeaguiar hrm, lemme try in intellij"><y>#</y><d>2017-04-21</d><h>19:55</h><w>ddeaguiar</w>hrm, lemme try in intellij</z><z id="t1492804553" t="skylar yes please 🙂"><y>#</y><d>2017-04-21</d><h>19:55</h><w>skylar</w>yes please <b>🙂</b></z><z id="t1492804554" t="PB It’s probably my code not compiling"><y>#</y><d>2017-04-21</d><h>19:55</h><w>PB</w>It’s probably my code not compiling</z><z id="t1492804626" t="skylar [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] my intellij config: &quot;Run nREPL with Leiningen&quot; and &quot;Synchronize Leiningen Projects&quot;"><y>#</y><d>2017-04-21</d><h>19:57</h><w>skylar</w><a>@ddeaguiar</a> my intellij config: &quot;Run nREPL with Leiningen&quot; and &quot;Synchronize Leiningen Projects&quot;</z><z id="t1492804697" t="ddeaguiar ok, I don’t really use intellij so bare with me"><y>#</y><d>2017-04-21</d><h>19:58</h><w>ddeaguiar</w>ok, I don’t really use intellij so bare with me</z><z id="t1492805167" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U53B44U14&quot;}] it works for me in intellij as well"><y>#</y><d>2017-04-21</d><h>20:06</h><w>ddeaguiar</w><a>@skylar</a> it works for me in intellij as well</z><z id="t1492805195" t="ddeaguiar here’s how I start my service (def s (run-dev))"><y>#</y><d>2017-04-21</d><h>20:06</h><w>ddeaguiar</w>here’s how I start my service <code>(def s (run-dev))</code></z><z id="t1492805213" t="ddeaguiar then I make a change to a handler in service.clj"><y>#</y><d>2017-04-21</d><h>20:06</h><w>ddeaguiar</w>then I make a change to a handler in <code>service.clj</code></z><z id="t1492805238" t="ddeaguiar and Sync files in REPL"><y>#</y><d>2017-04-21</d><h>20:07</h><w>ddeaguiar</w>and Sync files in REPL</z><z id="t1492808744" t="souenzzo How do I put a prefix in :io.pedestal.http/resource-path ?"><y>#</y><d>2017-04-21</d><h>21:05</h><w>souenzzo</w>How do I put a prefix in <code>:io.pedestal.http/resource-path</code>?</z><z id="t1492808938" t="souenzzo I want to access &quot;resources&quot; via GET/static , for example..."><y>#</y><d>2017-04-21</d><h>21:08</h><w>souenzzo</w>I want to access &quot;resources&quot; via <code>GET/static</code>, for example...</z><z id="t1492809200" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I don&apos;t know if there&apos;s a way to do that right in the service map, but you can add a route like &quot;/static&quot; :get (io.pedestal.http.ring-middlewares/fast-resource nil)"><y>#</y><d>2017-04-21</d><h>21:13</h><w>mtnygard</w><a>@souenzzo</a> I don&apos;t know if there&apos;s a way to do that right in the service map, but you can add a route like <code>&quot;/static&quot; :get (io.pedestal.http.ring-middlewares/fast-resource nil)</code></z><z id="t1492809224" t="mtnygard That&apos;s the same interceptor that gets created for you when you put :resource-path on the service mpa"><y>#</y><d>2017-04-21</d><h>21:13</h><w>mtnygard</w>That&apos;s the same interceptor that gets created for you when you put :resource-path on the service mpa</z><z id="t1492809228" t="mtnygard s/mpa/map/"><y>#</y><d>2017-04-21</d><h>21:13</h><w>mtnygard</w>s/mpa/map/</z><z id="t1492809290" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] should the path parameter be the path in the resources dir instead of nil ?"><y>#</y><d>2017-04-21</d><h>21:14</h><w>ddeaguiar</w><a>@mtnygard</a> should the path parameter be the path in the <code>resources</code> dir instead of <code>nil</code>?</z><z id="t1492809328" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Probably. That&apos;s what I get for trying to beat you to the answer."><y>#</y><d>2017-04-21</d><h>21:15</h><w>mtnygard</w><a>@ddeaguiar</a> Probably. That&apos;s what I get for trying to beat you to the answer.</z><z id="t1492809375" t="ddeaguiar hehe, I’ve not used fast-resource I was going to suggest io.pedestal.http.ring-middlewares/resource"><y>#</y><d>2017-04-21</d><h>21:16</h><w>ddeaguiar</w>hehe, I’ve not used <code>fast-resource</code> I was going to suggest <code>io.pedestal.http.ring-middlewares/resource</code></z><z id="t1492809399" t="mtnygard Basically the same thing. Fast resource returns async and streams so time-to-first-byte is a bit better."><y>#</y><d>2017-04-21</d><h>21:16</h><w>mtnygard</w>Basically the same thing. Fast resource returns async and streams so time-to-first-byte is a bit better.</z><z id="t1492809410" t="ddeaguiar good recommendation"><y>#</y><d>2017-04-21</d><h>21:16</h><w>ddeaguiar</w>good recommendation</z></g><g id="s6"><z id="t1492809595" t="souenzzo fast-resource was always from /resources ?"><y>#</y><d>2017-04-21</d><h>21:19</h><w>souenzzo</w><code>fast-resource</code> was always from <code>/resources</code>?</z><z id="t1492809621" t="mtnygard It uses http://clojure.java.io/resource , so it looks for anything visible in your classpath"><y>#</y><d>2017-04-21</d><h>21:20</h><w>mtnygard</w>It uses <a href="http://clojure.java.io/resource" target="_blank">http://clojure.java.io/resource</a>, so it looks for anything visible in your classpath</z><z id="t1492809677" t="souenzzo hum... I think I should make something manual to restrict to html/js/css files..."><y>#</y><d>2017-04-21</d><h>21:21</h><w>souenzzo</w>hum... I think I should make something manual to restrict to <code>html/js/css</code> files...</z><z id="t1492809720" t="ddeaguiar I think you can just put the files you are interested in serving resources/public"><y>#</y><d>2017-04-21</d><h>21:22</h><w>ddeaguiar</w>I think you can just put the files you are interested in serving <code>resources/public</code></z><z id="t1492809779" t="ddeaguiar looking at the source for fast-resource now… sec"><y>#</y><d>2017-04-21</d><h>21:22</h><w>ddeaguiar</w>looking at the source for <code>fast-resource</code> now… sec</z><z id="t1492809794" t="ddeaguiar yeah"><y>#</y><d>2017-04-21</d><h>21:23</h><w>ddeaguiar</w>yeah</z><z id="t1492809818" t="souenzzo Yep. keep all stuff at resources/public and overwrite path-info/uri on ctx"><y>#</y><d>2017-04-21</d><h>21:23</h><w>souenzzo</w>Yep. keep all stuff at <code>resources/public</code> and overwrite  path-info/uri on ctx</z><z id="t1492809828" t="souenzzo tnks"><y>#</y><d>2017-04-21</d><h>21:23</h><w>souenzzo</w>tnks</z><z id="t1492809850" t="ddeaguiar I don’t think you need to overwrite anything"><y>#</y><d>2017-04-21</d><h>21:24</h><w>ddeaguiar</w>I don’t think you need to overwrite anything</z><z id="t1492809859" t="souenzzo nope?"><y>#</y><d>2017-04-21</d><h>21:24</h><w>souenzzo</w>nope?</z><z id="t1492809879" t="ddeaguiar hmm maybe so"><y>#</y><d>2017-04-21</d><h>21:24</h><w>ddeaguiar</w>hmm maybe so</z><z id="t1492809908" t="souenzzo path-info (str &quot;/public&quot; path-info) or some like..."><y>#</y><d>2017-04-21</d><h>21:25</h><w>souenzzo</w><code>path-info (str &quot;/public&quot; path-info)</code> or some like...</z><z id="t1492810006" t="ddeaguiar no I don’t think you need to overwrite anything"><y>#</y><d>2017-04-21</d><h>21:26</h><w>ddeaguiar</w>no I don’t think you need to overwrite anything</z><z id="t1492810014" t="ddeaguiar refer to https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L171"><y>#</y><d>2017-04-21</d><h>21:26</h><w>ddeaguiar</w>refer to <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L171" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L171</a></z><z id="t1492810032" t="ddeaguiar uri-path is (subs ... 1)"><y>#</y><d>2017-04-21</d><h>21:27</h><w>ddeaguiar</w><code>uri-path</code> is <code>(subs ... 1)</code></z><z id="t1492810048" t="ddeaguiar so your route path /static would be dropped"><y>#</y><d>2017-04-21</d><h>21:27</h><w>ddeaguiar</w>so your route path <code>/static</code> would be dropped</z><z id="t1492810059" t="ddeaguiar I’m guessing anyways"><y>#</y><d>2017-04-21</d><h>21:27</h><w>ddeaguiar</w>I’m guessing anyways</z><z id="t1492810087" t="ddeaguiar It makes sense to me. It would be odd to have to start manipulating the path to get it to work"><y>#</y><d>2017-04-21</d><h>21:28</h><w>ddeaguiar</w>It makes sense to me. It would be odd to have to start manipulating the path to get it to work</z><z id="t1492810143" t="souenzzo Maybe rename /resources/static ... And let some big comments arround. So: there isn&apos;t standard way. I will dig into.."><y>#</y><d>2017-04-21</d><h>21:29</h><w>souenzzo</w>Maybe rename <code>/resources/static</code>... And let some big comments arround.
So: there isn&apos;t standard way. I will dig into..</z><z id="t1492810175" t="ddeaguiar so, if you configured the interceptor with the root path of resources/public then requests for /static/css/foo.css would resolve to resources/public/css/foo.css"><y>#</y><d>2017-04-21</d><h>21:29</h><w>ddeaguiar</w>so, if you configured the interceptor with the root path of <code>resources/public</code> then requests for <code>/static/css/foo.css</code> would resolve to <code>resources/public/css/foo.css</code></z><z id="t1492810377" t="ddeaguiar alternatively you can stick stuff in resource/static and set ::http/resource-path to /static and call it a day"><y>#</y><d>2017-04-21</d><h>21:32</h><w>ddeaguiar</w>alternatively you can stick stuff in <code>resource/static</code> and set <code>::http/resource-path</code> to <code>/static</code> and call it a day</z><z id="t1492810419" t="ddeaguiar actually no"><y>#</y><d>2017-04-21</d><h>21:33</h><w>ddeaguiar</w>actually no</z><z id="t1492810421" t="ddeaguiar forget that"><y>#</y><d>2017-04-21</d><h>21:33</h><w>ddeaguiar</w>forget that</z><z id="t1492810448" t="ddeaguiar it is definitely getting late for me 🙂"><y>#</y><d>2017-04-21</d><h>21:34</h><w>ddeaguiar</w>it is definitely getting late for me <b>🙂</b></z><z id="t1492810469" t="souenzzo ::bootstrap/resource-path &quot;/public&quot; and resources/public/statc will do. Sure with empty resources/public"><y>#</y><d>2017-04-21</d><h>21:34</h><w>souenzzo</w><code>::bootstrap/resource-path     &quot;/public&quot;</code>
and
<code>resources/public/statc</code> will do. Sure with empty <code>resources/public</code></z><z id="t1492810489" t="ddeaguiar yeah that works"><y>#</y><d>2017-04-21</d><h>21:34</h><w>ddeaguiar</w>yeah that works</z><z id="t1492879517" t="kirill.salykin Hi Does anybody use url-for? I am having issue with Cyclic load dependency error, cause I am trying to use url-for if function which used in routes"><y>#</y><d>2017-04-22</d><h>16:45</h><w>kirill.salykin</w>Hi

Does anybody use url-for? 

I am having issue with <code>Cyclic load dependency</code> error,
cause I am trying to use <code>url-for</code> if function which used in routes</z><z id="t1492879520" t="kirill.salykin How I can avoid this?"><y>#</y><d>2017-04-22</d><h>16:45</h><w>kirill.salykin</w>How I can avoid this?</z><z id="t1492881216" t="souenzzo can I do this in pedestal? https://blog.golang.org/h2push"><y>#</y><d>2017-04-22</d><h>17:13</h><w>souenzzo</w>can I do this in pedestal?
<a href="https://blog.golang.org/h2push" target="_blank">https://blog.golang.org/h2push</a></z><z id="t1492881786" t="jimmy [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] https://github.com/pedestal/pedestal/tree/f89d0abe244d0e8385d66a697724ef56180a00e5/samples/http2"><y>#</y><d>2017-04-22</d><h>17:23</h><w>jimmy</w><a>@souenzzo</a> <a href="https://github.com/pedestal/pedestal/tree/f89d0abe244d0e8385d66a697724ef56180a00e5/samples/http2" target="_blank">https://github.com/pedestal/pedestal/tree/f89d0abe244d0e8385d66a697724ef56180a00e5/samples/http2</a></z><z id="t1492881886" t="jimmy [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] regarding on how to add servlet filter, you can check the example of adding DoSFilter here : https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/service/test/io/pedestal/http/jetty_util_test.clj"><y>#</y><d>2017-04-22</d><h>17:24</h><w>jimmy</w><a>@souenzzo</a> regarding on how to add servlet filter, you can check the example of adding DoSFilter here :
<a href="https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/service/test/io/pedestal/http/jetty_util_test.clj" target="_blank">https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/service/test/io/pedestal/http/jetty_util_test.clj</a></z><z id="t1492963144" t="skylar Thanks a lot [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] – it works 🙂"><y>#</y><d>2017-04-23</d><h>15:59</h><w>skylar</w>Thanks a lot <a>@ddeaguiar</a> – it works <b>🙂</b></z><z id="t1492965520" t="deg What, exactly, does Vase return when I call the pull API? I have a query containing ` :query [:find [(pull ?e [*]) ...] :where [?e :user/name]] ` It sometimes returns a vector of my tuples, and other times returns a seq whose first is the vector of tuples. Clarification: I&apos;m not yet sure what I mean by &quot;sometimes&quot;. I&apos;m seeing these different results in different machines and environments (Ubuntu vs Docker on Ubuntu vs Mac; all built from the same repo, but...) so I assume I&apos;ve changed some moving part that affects this behavior."><y>#</y><d>2017-04-23</d><h>16:38</h><w>deg</w>What, exactly, does Vase return when I call the <code>pull</code> API?
I have a query containing
<pre>`
:query [:find [(pull ?e [*]) ...]
        :where [?e :user/name]]
</pre>`
It sometimes returns a vector of my tuples, and other times returns a seq whose first is the vector of tuples.
Clarification: I&apos;m not yet sure what I mean by &quot;sometimes&quot;. I&apos;m seeing these different results in different machines and environments (Ubuntu vs Docker on Ubuntu vs Mac; all built from the same repo, but...) so I assume I&apos;ve changed some moving part that affects this behavior.</z><z id="t1492965976" t="deg Hmm, just realized that I might have been faked out by browser caching. (I had returned from vacation, back to a machine that had last run before I made some server changes). But, I&apos;m still curious exactly what that pull syntax is supposed to return."><y>#</y><d>2017-04-23</d><h>16:46</h><w>deg</w>Hmm, just realized that I might have been faked out by browser caching. (I had returned from vacation, back to a machine that had last run before I made some server changes).  But, I&apos;m still curious exactly what that pull syntax is supposed to return.</z><z id="t1492967114" t="souenzzo It&apos;s #datomic stuff but pull returns a map. In this case, you r using a query that calls pull . http://docs.datomic.com/query.html#sec-5-7"><y>#</y><d>2017-04-23</d><h>17:05</h><w>souenzzo</w>It&apos;s #datomic stuff but <code>pull</code> returns a map. In this case, you r using a query that calls <code>pull</code>. 
<a href="http://docs.datomic.com/query.html#sec-5-7" target="_blank">http://docs.datomic.com/query.html#sec-5-7</a></z><z id="t1492967223" t="souenzzo :find [?s ...] will always return a coll of ?s . In this case, ?s was a pull and pull&apos;s returns map&apos;s, so a coll of map"><y>#</y><d>2017-04-23</d><h>17:07</h><w>souenzzo</w><code>:find [?s ...]</code> will always return <code>a coll of ?s</code>. In this case, <code>?s</code> was a pull and pull&apos;s returns map&apos;s, so <code>a coll of map</code></z><z id="t1492971554" t="deg [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , thanks. But, why does a bare :find (pull ?e [*]) return a *more* nested structure? (IIRC, it had two more levels of vector wrapped around the vector)."><y>#</y><d>2017-04-23</d><h>18:19</h><w>deg</w><a>@souenzzo</a> , thanks.   But, why does a bare <code>:find (pull ?e [*])</code> return a *more* nested structure? (IIRC, it had two more levels of vector wrapped around the vector).</z><z id="t1492973390" t="souenzzo Datomic query by default return&apos;s &quot;a set of tuples of result&quot; (`#{[&lt;result1&gt;][&lt;result2&gt;]}`). I also have no idea why, and very curious to know."><y>#</y><d>2017-04-23</d><h>18:49</h><w>souenzzo</w>Datomic query by default return&apos;s &quot;a set of tuples of result&quot; (`#{[&lt;result1&gt;][&lt;result2&gt;]}`). I also have no idea why, and very curious to know.</z><z id="t1492973484" t="souenzzo I already researched a little about this and found nothing ... If you find some explanation, please share 🙂 [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}]"><y>#</y><d>2017-04-23</d><h>18:51</h><w>souenzzo</w>I already researched a little about this and found nothing ... If you find some explanation, please share <b>🙂</b> <a>@deg</a></z><z id="t1493027613" t="deg Like the old joke goes, I was wrong to say I was wrong. ... Yesterday&apos;s problem was not browser caching. I really was seeing different pull results from different instances of my server code. Turns out that the real issue is that I&apos;m using the Vase 0.9.1-SNAPSHOT, and the behavior changed two weeks ago, after I had last refreshed it on one of my machines. The change occurred in one of the three commits on April 6-7, and results in a pull query returning one less level of wrapping. The new behavior seems more correct to me, but is an incompatible change. I&apos;ll file an issue with the details in a few minutes. [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}]"><y>#</y><d>2017-04-24</d><h>09:53</h><w>deg</w>Like the old joke goes, I was wrong to say I was wrong. ...
Yesterday&apos;s problem was not browser caching. I really was seeing different pull results from different instances of my server code.
Turns out that the real issue is that I&apos;m using the Vase 0.9.1-SNAPSHOT, and the behavior changed two weeks ago, after I had last refreshed it on one of my machines.
The change occurred in one of the three commits on April 6-7, and results in a pull query returning one less level of wrapping.
The new behavior seems more correct to me, but is an incompatible change. I&apos;ll file an issue with the details in a few minutes.  <a>@mtnygard</a></z><z id="t1493028516" t="deg https://github.com/cognitect-labs/vase/issues/71"><y>#</y><d>2017-04-24</d><h>10:08</h><w>deg</w><a href="https://github.com/cognitect-labs/vase/issues/71" target="_blank">https://github.com/cognitect-labs/vase/issues/71</a></z><z id="t1493129926" t="vlaaad Hi! I&apos;m having trouble with vase — I want to retract attribute&apos;s value in entity, and can&apos;t find a way to do it: vase/transact either retracts entity fully, or asserts new facts about entity. How can I retract only one attribute/value?"><y>#</y><d>2017-04-25</d><h>14:18</h><w>vlaaad</w>Hi! I&apos;m having trouble with vase — I want to retract attribute&apos;s value in entity, and can&apos;t find a way to do it: <code>vase/transact</code> either retracts entity fully, or asserts new facts about entity. How can I retract only one attribute/value?</z><z id="t1493130242" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U47G49KHQ&quot;}] check out https://github.com/cognitect-labs/vase/blob/master/docs/action_literals.md#vasetransact"><y>#</y><d>2017-04-25</d><h>14:24</h><w>ddeaguiar</w><a>@vlaaad</a> check out <a href="https://github.com/cognitect-labs/vase/blob/master/docs/action_literals.md#vasetransact" target="_blank">https://github.com/cognitect-labs/vase/blob/master/docs/action_literals.md#vasetransact</a></z><z id="t1493130258" t="ddeaguiar although :db-op only supports retracting an entity hmm"><y>#</y><d>2017-04-25</d><h>14:24</h><w>ddeaguiar</w>although <code>:db-op</code> only supports retracting an entity hmm</z><z id="t1493131877" t="vlaaad [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yeah, been there, with no results"><y>#</y><d>2017-04-25</d><h>14:51</h><w>vlaaad</w><a>@ddeaguiar</a> yeah, been there, with no results</z><z id="t1493132219" t="ddeaguiar hrm. It may require the creation of an interceptor. Unfortunately I can’t dig into this atm 😞"><y>#</y><d>2017-04-25</d><h>14:56</h><w>ddeaguiar</w>hrm. It may require the creation of an interceptor. Unfortunately I can’t dig into this atm <b>😞</b></z><z id="t1493145613" t="sineer I spent hours trying to figure out why my pedestal router can&apos;t pickup newly modified &quot;master-routes&quot; when running in the repl 😞 I pass this to pedestal.service/service ... :: http/routes #(deref #&apos;routes/master-routes)"><y>#</y><d>2017-04-25</d><h>18:40</h><w>sineer</w>I spent hours trying to figure out why my pedestal router can&apos;t pickup newly modified &quot;master-routes&quot; when running in the repl <b>😞</b> I pass this to pedestal.service/service ... <b>::</b>http/routes #(deref #&apos;routes/master-routes)</z><z id="t1493145680" t="sineer when I (run-dev) in repl it starts jetty server and everything works, when I modify master-routes to let&apos;s say add a route it never works until I kill cider and restart run-dev even too my master-routes def has changed"><y>#</y><d>2017-04-25</d><h>18:41</h><w>sineer</w>when I (run-dev) in repl it starts jetty server and everything works, when I modify master-routes to let&apos;s say add a route it never works until I kill cider and restart run-dev even too my master-routes def has changed</z><z id="t1493145725" t="sineer I don&apos;t get it. when I (deref #&apos;routes/master-routes) I can see my changes, why is it pedestal router can&apos;t pick them up ?"><y>#</y><d>2017-04-25</d><h>18:42</h><w>sineer</w>I don&apos;t get it. when I (deref #&apos;routes/master-routes) I can see my changes, why is it pedestal router can&apos;t pick them up ?</z><z id="t1493145826" t="ddeaguiar If you’re working on an app created from the pedestal-service lein template, you need to reload the service namespace"><y>#</y><d>2017-04-25</d><h>18:43</h><w>ddeaguiar</w>If you’re working on an app created from the <code>pedestal-service</code> lein template, you need to reload the <code>service</code> namespace</z><z id="t1493145848" t="ddeaguiar or at least the fn in question"><y>#</y><d>2017-04-25</d><h>18:44</h><w>ddeaguiar</w>or at least the fn in question</z><z id="t1493145870" t="sineer I&apos;m using the figwheel template with boot so I may be confused a little"><y>#</y><d>2017-04-25</d><h>18:44</h><w>sineer</w>I&apos;m using the figwheel template with boot so I may be confused a little</z><z id="t1493145915" t="ddeaguiar still, if you’ve got a repl then reloading the namespace should work"><y>#</y><d>2017-04-25</d><h>18:45</h><w>ddeaguiar</w>still, if you’ve got a repl then reloading the namespace should work</z><z id="t1493146011" t="sineer Hrmm, I think I tried that by using cider-refresh and boot-refresh but I&apos;ll try again"><y>#</y><d>2017-04-25</d><h>18:46</h><w>sineer</w>Hrmm, I think I tried that by using cider-refresh and boot-refresh but I&apos;ll try again</z><z id="t1493146083" t="sineer It doesn&apos;t seem to be doing anything since the (run-dev) fn is already called and my router is setup to deref the master-routes var each lookup so I really don&apos;t get it 😞"><y>#</y><d>2017-04-25</d><h>18:48</h><w>sineer</w>It doesn&apos;t seem to be doing anything since the (run-dev) fn is already called and my router is setup to deref the master-routes var each lookup so I really don&apos;t get it <b>😞</b></z><z id="t1493146114" t="sineer I don&apos;t even know how I can kill the (run-dev) without killing cider"><y>#</y><d>2017-04-25</d><h>18:48</h><w>sineer</w>I don&apos;t even know how I can kill the (run-dev) without killing cider</z><z id="t1493146139" t="ddeaguiar I use C-c C-k which I think is bound to cider-load-buffer"><y>#</y><d>2017-04-25</d><h>18:48</h><w>ddeaguiar</w>I use <code>C-c C-k</code> which I think is bound to <code>cider-load-buffer</code></z><z id="t1493146162" t="ddeaguiar clearly I’m using emacs"><y>#</y><d>2017-04-25</d><h>18:49</h><w>ddeaguiar</w>clearly I’m using emacs</z><z id="t1493146167" t="ddeaguiar sorry if that doesn’t help"><y>#</y><d>2017-04-25</d><h>18:49</h><w>ddeaguiar</w>sorry if that doesn’t help</z><z id="t1493146212" t="sineer yes it does work, I see cider re-eval the buffer and I did that for service, server and routes namespaces"><y>#</y><d>2017-04-25</d><h>18:50</h><w>sineer</w>yes it does work, I see cider re-eval the buffer and I did that for service, server and routes namespaces</z><z id="t1493146229" t="sineer But again pedestal did not pickup my routes changes"><y>#</y><d>2017-04-25</d><h>18:50</h><w>sineer</w>But again pedestal did not pickup my routes changes</z><z id="t1493146244" t="sineer even too I can see in repl that (deref #&apos;master-routes) has my changes"><y>#</y><d>2017-04-25</d><h>18:50</h><w>sineer</w>even too I can see in repl that (deref #&apos;master-routes) has my changes</z><z id="t1493146350" t="ddeaguiar you also need to be careful with cider-refresh"><y>#</y><d>2017-04-25</d><h>18:52</h><w>ddeaguiar</w>you also need to be careful with cider-refresh</z><z id="t1493146367" t="ddeaguiar I’d restart the repl and try again without doing a cider-refresh"><y>#</y><d>2017-04-25</d><h>18:52</h><w>ddeaguiar</w>I’d restart the repl and try again without doing a cider-refresh</z><z id="t1493146388" t="ddeaguiar cider-refresh can throw things out of sorts"><y>#</y><d>2017-04-25</d><h>18:53</h><w>ddeaguiar</w>cider-refresh can throw things out of sorts</z><z id="t1493146402" t="ddeaguiar that is as technical as I can get about it :0"><y>#</y><d>2017-04-25</d><h>18:53</h><w>ddeaguiar</w>that is as technical as I can get about it :0</z><z id="t1493146432" t="sineer Ok I&apos;m commenting it out and trying it without"><y>#</y><d>2017-04-25</d><h>18:53</h><w>sineer</w>Ok I&apos;m commenting it out and trying it without</z><z id="t1493146590" t="sineer Damn it works!"><y>#</y><d>2017-04-25</d><h>18:56</h><w>sineer</w>Damn it works!</z><z id="t1493146631" t="sineer All this time I wonder what was wrong, I tried a few time before trying out cider refresh but I must&apos;ve been doing something wrong..."><y>#</y><d>2017-04-25</d><h>18:57</h><w>sineer</w>All this time I wonder what was wrong, I tried a few time before trying out cider refresh but I must&apos;ve been doing something wrong...</z><z id="t1493146641" t="sineer Thanks a lot my friend!"><y>#</y><d>2017-04-25</d><h>18:57</h><w>sineer</w>Thanks a lot my friend!</z><z id="t1493146776" t="ddeaguiar no worries"><y>#</y><d>2017-04-25</d><h>18:59</h><w>ddeaguiar</w>no worries</z><z id="t1493146784" t="ddeaguiar FWIW, I avoid cider-refresh"><y>#</y><d>2017-04-25</d><h>18:59</h><w>ddeaguiar</w>FWIW, I avoid cider-refresh</z><z id="t1493146875" t="sineer Ok thanks for the hint, I wanted to avoid it too if I could but I figure I&apos;d give it a try when I failed to reload code without it not sure why, I guess I just need more cider/repl practice 🙂"><y>#</y><d>2017-04-25</d><h>19:01</h><w>sineer</w>Ok thanks for the hint, I wanted to avoid it too if I could but I figure I&apos;d give it a try when I failed to reload code without it not sure why, I guess I just need more cider/repl practice <b>🙂</b></z><z id="t1493146881" t="ddeaguiar not sure what it’s doing different under the covers but I prefer invoking clojure.tools.namespace.repl refresh and refresh-all directly in a repl"><y>#</y><d>2017-04-25</d><h>19:01</h><w>ddeaguiar</w>not sure what it’s doing different under the covers but I prefer invoking <code>clojure.tools.namespace.repl</code> <code>refresh</code> and <code>refresh-all</code> directly in a repl</z><z id="t1493146905" t="ddeaguiar last I looked into this I couldn’t spot the difference but I definitely observed different behavior"><y>#</y><d>2017-04-25</d><h>19:01</h><w>ddeaguiar</w>last I looked into this I couldn’t spot the difference but I definitely observed different behavior</z><z id="t1493146952" t="ddeaguiar I also don’t refresh as much as I used to. I focus on reloading the namespace I’m in"><y>#</y><d>2017-04-25</d><h>19:02</h><w>ddeaguiar</w>I also don’t refresh as much as I used to. I focus on reloading the namespace I’m in</z><z id="t1493147004" t="sineer Yeah its probably something to do with it reloading lots of namespace at once, I just tried re-enabling cider-refresh and doing the cider-refresh in emacs and I confirm that it doesn&apos;t work..."><y>#</y><d>2017-04-25</d><h>19:03</h><w>sineer</w>Yeah its probably something to do with it reloading lots of namespace at once, I just tried re-enabling cider-refresh and doing the cider-refresh in emacs and I confirm that it doesn&apos;t work...</z><z id="t1493147065" t="sineer It&apos;s very strange too because if I do deref #&apos;master-routes I can see my changes but the old master-route is still being used by pedestal."><y>#</y><d>2017-04-25</d><h>19:04</h><w>sineer</w>It&apos;s very strange too because if I do deref #&apos;master-routes I can see my changes but the old master-route is still being used by pedestal.</z><z id="t1493147088" t="sineer lost several hours to figure that out heh, oh well. Thanks again! 🙂"><y>#</y><d>2017-04-25</d><h>19:04</h><w>sineer</w>lost several hours to figure that out heh, oh well. Thanks again! <b>🙂</b></z><z id="t1493147154" t="ddeaguiar np, glad to help!"><y>#</y><d>2017-04-25</d><h>19:05</h><w>ddeaguiar</w>np, glad to help!</z><z id="t1493218020" t="deg I&apos;m finally trying to move my Vase project from datomic:mem: to datomic:dev:. I set up the config file with my licence key and updated :datomic-url in my .edn file. I get an error Unsupported protocol :dev . After a bit of head-scratching, Google suggests that this is because I have a dependency on datomic-free instead of datomic-pro. Ok... Neither is referenced directly in my project.clj, but I see that vase does use datomic-free. But... I see in https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md : ` Note that the template project uses Datomic Pro. (You can change the project.clj dependency to use Datomic Free. Be sure to make the corresponding change in the :datomic-uri later.) ` I assume the Vase doc is just wrong? Or am I missing a different problem?"><y>#</y><d>2017-04-26</d><h>14:47</h><w>deg</w>I&apos;m finally trying to move my Vase project from datomic:mem: to datomic:dev:.  I set up the config file with my licence key and updated <code>:datomic-url</code> in my .edn file.
I get an error <code>Unsupported protocol :dev</code>.
After a bit of head-scratching, Google suggests that this is because I have a dependency on datomic-free instead of datomic-pro.
Ok...
Neither is referenced directly in my project.clj, but I see that vase does use datomic-free.
But...  I see in <a href="https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md" target="_blank">https://github.com/cognitect-labs/vase/blob/master/docs/your_first_api.md</a>:
<pre>`
Note that the template project uses Datomic Pro. (You can change the project.clj dependency to use Datomic Free. Be sure to make the corresponding change in the :datomic-uri later.)
</pre>`

I assume the Vase doc is just wrong? Or am I missing a different problem?</z><z id="t1493218557" t="deg Later: looks like [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] addressed this in https://raw.githubusercontent.com/cognitect-labs/vase/a907afb726bcdfe152876d85c7eac33e35e6e3cf/samples/petstore-full/project.clj-with-datomic-pro , and the problem is just that line in your_first_api.md"><y>#</y><d>2017-04-26</d><h>14:55</h><w>deg</w>Later: looks like <a>@mtnygard</a> addressed this in <a href="https://raw.githubusercontent.com/cognitect-labs/vase/a907afb726bcdfe152876d85c7eac33e35e6e3cf/samples/petstore-full/project.clj-with-datomic-pro" target="_blank">https://raw.githubusercontent.com/cognitect-labs/vase/a907afb726bcdfe152876d85c7eac33e35e6e3cf/samples/petstore-full/project.clj-with-datomic-pro</a>, and the problem is just that line in your_first_api.md</z><z id="t1493219853" t="deg ... but that then required - fixing the datomic version in the sample to match the one I&apos;ve installed - finding the un/under-documented datomic/bin/maven-install - installing maven - persuading the yak that he really wanted to be shaved But, looks like it is now working. I&apos;ll try to write up a few lines of doc later today."><y>#</y><d>2017-04-26</d><h>15:17</h><w>deg</w>... but that then required
- fixing the datomic version in the sample to match the one I&apos;ve installed
- finding the un/under-documented datomic/bin/maven-install
- installing maven
- persuading the yak that he really wanted to be shaved

But, looks like it is now working.
I&apos;ll try to write up a few lines of doc later today.</z><z id="t1493240132" t="deg https://github.com/cognitect-labs/vase/pull/72"><y>#</y><d>2017-04-26</d><h>20:55</h><w>deg</w><a href="https://github.com/cognitect-labs/vase/pull/72" target="_blank">https://github.com/cognitect-labs/vase/pull/72</a></z><z id="t1493369151" t="skylar Does Pedestal offer a helper to parse json-array?"><y>#</y><d>2017-04-28</d><h>08:45</h><w>skylar</w>Does Pedestal offer a helper to parse json-array?</z><z id="t1493387501" t="ddeaguiar Pedestal depends on Cheshire which it uses for parsing the body of requests with a content-type of application/json https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/body_params.clj#L178 ."><y>#</y><d>2017-04-28</d><h>13:51</h><w>ddeaguiar</w>Pedestal depends on Cheshire which it uses for parsing the body of requests with a content-type of <code>application/json</code> <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/body_params.clj#L178" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/body_params.clj#L178</a>.</z><z id="t1493387506" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U53B44U14&quot;}] ^^"><y>#</y><d>2017-04-28</d><h>13:51</h><w>ddeaguiar</w><a>@skylar</a> ^^</z><z id="t1493412402" t="bradford How do I turn multipart uploads into byte stream? See /upload -- it&apos;s just giving me :options and :upload instead of :bytes: ;; Wire root URL to sse event stream ;; Wire /custom URL to sse event stream with custom event-id setting (defroutes routes [[[&quot;/register&quot; {:get [::send-counter (sse/start-event-stream sse-stream-ready 20 10 {:on-client-disconnect close-conn})]}] [&quot;/about&quot; {:get about-page}] [&quot;/echo&quot; ^:interceptors [(b/body-params)] {:post test-channel}] [&quot;/upload&quot; ^:interceptors [(m/multipart-params {:store byte-a/byte-array-store})] {:post upload}]]])"><y>#</y><d>2017-04-28</d><h>20:46</h><w>bradford</w>How do I turn multipart uploads into byte stream? See <code>/upload</code> -- it&apos;s just giving me :options and :upload instead of <b>:bytes:</b> <pre>;; Wire root URL to sse event stream
;; Wire /custom URL to sse event stream with custom event-id setting
(defroutes routes
  [[[&quot;/register&quot; {:get [::send-counter (sse/start-event-stream sse-stream-ready 20 10 {:on-client-disconnect close-conn})]}]
    [&quot;/about&quot; {:get about-page}]
    [&quot;/echo&quot;
     ^:interceptors [(b/body-params)]
     {:post test-channel}]
    [&quot;/upload&quot;
     ^:interceptors [(m/multipart-params {:store byte-a/byte-array-store})]
     {:post upload}]]])</pre></z><z id="t1493468432" t="rui.yang Hi, wonder if there is any way to automatically do type casting in routing, e.g. for :path-params"><y>#</y><d>2017-04-29</d><h>12:20</h><w>rui.yang</w>Hi, wonder if there is any way to automatically do type casting in routing, e.g. for :path-params</z><z id="t1493468461" t="rui.yang seems that pedestal always return path-params as string"><y>#</y><d>2017-04-29</d><h>12:21</h><w>rui.yang</w>seems that pedestal always return path-params as string</z><z id="t1493468532" t="rui.yang but for route /orders/:order_id, ideally, :order_id could be Integer. If without type casting, postgresql will complain cannot compare integer with char."><y>#</y><d>2017-04-29</d><h>12:22</h><w>rui.yang</w>but for route /orders/:order_id,   ideally, :order_id could be Integer. If without type casting, postgresql will complain cannot compare integer with char.</z><z id="t1493468560" t="rui.yang Currently, I have to do it manually."><y>#</y><d>2017-04-29</d><h>12:22</h><w>rui.yang</w>Currently, I have to do it manually.</z><z id="t1493485323" t="skylar Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] , that helps a lot"><y>#</y><d>2017-04-29</d><h>17:02</h><w>skylar</w>Thanks <a>@ddeaguiar</a>, that helps a lot</z><z id="t1493550220" t="deg In a Vase app, can I query Datomic from an interceptor? If so, where do I find the Datomic object? It does not seem to be in the context passed to the interceptor."><y>#</y><d>2017-04-30</d><h>11:03</h><w>deg</w>In a Vase app, can I query Datomic from an interceptor? If so, where do I find the Datomic object? It does not seem to be in the context passed to the interceptor.</z><z id="t1493584303" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] a Datomic connection and db should be accessible on the request. It’s attached by the insert-datomic interceptor. Refer to https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/routes.clj#L41 and https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/datomic.clj#L33"><y>#</y><d>2017-04-30</d><h>20:31</h><w>ddeaguiar</w><a>@deg</a> a Datomic connection and db should be accessible on the request. It’s attached by the <code>insert-datomic</code> interceptor. Refer to <a href="https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/routes.clj#L41" target="_blank">https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/routes.clj#L41</a> and <a href="https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/datomic.clj#L33" target="_blank">https://github.com/cognitect-labs/vase/blob/ddb45e042cd12f1eb9e73b227727d46f81e3c0a6/src/com/cognitect/vase/datomic.clj#L33</a></z><z id="t1493586237" t="deg Thanks. I see it now, staring me in the face. &apos;scuse me one second while I tease myself for not seeing it earlier."><y>#</y><d>2017-04-30</d><h>21:03</h><w>deg</w>Thanks. I see it now, staring me in the face.  &apos;scuse me one second while I tease myself for not seeing it earlier.</z><z id="t1493586331" t="danielcompton Is vase suitable publishing directly to the internet with appropriate auth, or is it intended to sit behind the firewall as a microservice that is consumed by other systems?"><y>#</y><d>2017-04-30</d><h>21:05</h><w>danielcompton</w>Is vase suitable publishing directly to the internet with appropriate auth, or is it intended to sit behind the firewall as a microservice that is consumed by other systems?</z><z id="t1493586336" t="danielcompton I&apos;m looking at https://github.com/cognitect-labs/vase/blob/f49c4ac9299ef48e57a9613da089784ddd08af5c/docs/design.md#authorization-and-external-requests"><y>#</y><d>2017-04-30</d><h>21:05</h><w>danielcompton</w>I&apos;m looking at <a href="https://github.com/cognitect-labs/vase/blob/f49c4ac9299ef48e57a9613da089784ddd08af5c/docs/design.md#authorization-and-external-requests" target="_blank">https://github.com/cognitect-labs/vase/blob/f49c4ac9299ef48e57a9613da089784ddd08af5c/docs/design.md#authorization-and-external-requests</a></z><z id="t1493587225" t="danielcompton If I want to apply authz to several resources without duplicating that code (and possibly forgetting it), should I split those resources into their own .edn file and apply a :vase.api/interceptors to that file?"><y>#</y><d>2017-04-30</d><h>21:20</h><w>danielcompton</w>If I want to apply authz to several resources without duplicating that code (and possibly forgetting it), should I split those resources into their own <code>.edn</code> file and apply a <code>:vase.api/interceptors</code> to that file?</z><z id="t1493607725" t="bradford How do I disable secure-headers middleware? this does not seem to do it: (def service {:env prod :io.pedestal.http/secure=-headers nil ::http/routes routes ::http/type :jetty ::http/port 8080} "><y>#</y><d>2017-05-01</d><h>03:02</h><w>bradford</w>How do I disable <code>secure-headers</code> middleware? this does not seem to do it: 

<pre>(def service {:env prod :io.pedestal.http/secure=-headers nil ::http/routes routes ::http/type :jetty ::http/port 8080} </pre></z><z id="t1493608223" t="danielcompton :io.pedestal.http/secure=-headers -&gt; :io.pedestal.http/secure-headers ?"><y>#</y><d>2017-05-01</d><h>03:10</h><w>danielcompton</w><code>:io.pedestal.http/secure=-headers</code> -&gt; <code>:io.pedestal.http/secure-headers</code>?</z><z id="t1493608577" t="bradford [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] Yup, I&apos;m a genius"><y>#</y><d>2017-05-01</d><h>03:16</h><w>bradford</w><a>@danielcompton</a> Yup, I&apos;m a genius</z><z id="t1493632919" t="deg I either have a typo that I can&apos;t see, or I misunderstand how Pedestal interceptors work. I have an interceptor that modifies Vase query results to return them as a cvs string, rather than as a data structure. It gets back to my client as the raw string, rather than as the transit that the client expects. It looks like the problem is that modifying the context&apos;s :result in an interceptor somehow interrupts the interceptor chain, causing remaining interceptors not to run. In this code, including the update-in (rather than merely returning context ) causes trace-context not to trigger, and returns the raw string generated by my csv function. What am I doing wrong? If it&apos;s a typo, I sure can&apos;t see it. If it is not legal to modify :response, then how do I generate results? ;;; From .edn file &quot;/csv-history&quot; {:get ["><y>#</y><d>2017-05-01</d><h>10:01</h><w>deg</w>I either have a typo that I can&apos;t see, or I misunderstand how Pedestal interceptors work.
I have an interceptor that modifies Vase query results to return them as a cvs string, rather than as a data structure.
It gets back to my client as the raw string, rather than as the transit that the client expects.

It looks like the problem is that modifying the context&apos;s :result in an interceptor somehow interrupts the interceptor chain, causing remaining interceptors not to run.
In this code, including the <code>update-in</code> (rather than merely returning <code>context</code>) causes <code>trace-context</code> not to trigger, and returns the raw string generated by my <code>csv</code> function.

What am I doing wrong?  If it&apos;s a typo, I sure can&apos;t see it.  If it is not legal to modify :response, then how do I generate results?

<pre>;;; From .edn file

                &quot;/csv-history&quot; {:get [</pre></z><z id="t1493640208" t="malch [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] try assigning :response inside the :leave function"><y>#</y><d>2017-05-01</d><h>12:03</h><w>malch</w><a>@deg</a> try assigning <code>:response</code> inside the <code>:leave</code> function</z><z id="t1493640216" t="malch http://pedestal.io/reference/interceptors"><y>#</y><d>2017-05-01</d><h>12:03</h><w>malch</w><a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1493640392" t="deg Thanks, I&apos;ll try that right now. But (despite having read that doc a few times) I don&apos;t see that requirement. (The only hint I see is the last line of the doc &quot;Because a handler takes one kind of thing (request) and returns a different kind of thing (response), it can only be used in the last position of a stack.&quot;) What is the underlying logic that prevents assigning :response in the :enter ?"><y>#</y><d>2017-05-01</d><h>12:06</h><w>deg</w>Thanks, I&apos;ll try that right now. But (despite having read that doc a few times) I don&apos;t see that requirement.  (The only hint I see is the last line of the doc &quot;Because a handler takes one kind of thing (request) and returns a different kind of thing (response), it can only be used in the last position of a stack.&quot;)

What is the underlying logic that prevents assigning <code>:response</code> in the <code>:enter</code>?</z><z id="t1493640515" t="malch I don’t know that logic exactly but I’m guessing that :response acts like a result in a web stack"><y>#</y><d>2017-05-01</d><h>12:08</h><w>malch</w>I don’t know that logic exactly but I’m guessing that <code>:response</code> acts like a result in a web stack</z><z id="t1493640802" t="malch Actually that makes sense - you should assoc :response inside the last interceptor of your stack (it’s :leave function) and only update it inside other interceptors"><y>#</y><d>2017-05-01</d><h>12:13</h><w>malch</w>Actually that makes sense - you should assoc <code>:response</code> inside the last interceptor of your stack (it’s <code>:leave</code> function) and only update it inside other interceptors</z><z id="t1493641086" t="malch And here it is in the code (`terminator-injector`) https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L364-L377"><y>#</y><d>2017-05-01</d><h>12:18</h><w>malch</w>And here it is in the code (`terminator-injector`) <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L364-L377" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L364-L377</a></z><z id="t1493641557" t="deg I&apos;m not familiar with how a result acts in a web stack, but I guess that some mechanism looks for the existence of :response and aborts calling the :leave queue if a response already exists? In any event, you are obviously correct. That change solved half my problem. As expected, I now see calls to generate-csv/enter, trace-context/enter, trace-context/leave, and generate-csv/leave. All good so far. But, my client is still receiving the text/plain result, rather than the correct transit results. My guess is that I&apos;m putting the wrong thing in response. Maybe I&apos;m not supposed to supply the headers and status? Or maybe just give the body without any map wrapping it?"><y>#</y><d>2017-05-01</d><h>12:25</h><w>deg</w>I&apos;m not familiar with how a result acts in a web stack, but I guess that some mechanism looks for the existence of <code>:response</code> and aborts calling the <code>:leave</code> queue if a response already exists?

In any event, you are obviously correct.  That change solved half my problem.
As expected, I now see calls to generate-csv/enter, trace-context/enter, trace-context/leave, and generate-csv/leave.  All good so far.

But, my client is still receiving the <code>text/plain</code> result, rather than the correct transit results.
My guess is that I&apos;m putting the wrong thing in response.
Maybe I&apos;m not supposed to supply the headers and status?  Or maybe just give the body without any map wrapping it?</z><z id="t1493641720" t="deg Ugh, I think I found what&apos;s going on... https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L150 Looks like the body is only converted to Transit if it is a collection, not a string! Why?"><y>#</y><d>2017-05-01</d><h>12:28</h><w>deg</w>Ugh, I think I found what&apos;s going on...
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L150" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L150</a>
Looks like the body is only converted to Transit if it is a collection, not a string!   Why?</z><z id="t1493641814" t="deg Yup, that was it! I wrapped my body in {:cvs ...} and I&apos;m good now."><y>#</y><d>2017-05-01</d><h>12:30</h><w>deg</w>Yup, that was it!
I wrapped my body in {:cvs ...} and I&apos;m good now.</z><z id="t1493641960" t="deg So, questions for the gurus: - Why does Pedestal not allow a bare string to be passed back via transit? - Should Interceptors be better documented, explaining how and when to return a response? Where? In the Vase docs, or Pedestal, or both?"><y>#</y><d>2017-05-01</d><h>12:32</h><w>deg</w>So, questions for the gurus:
- Why does Pedestal not allow a bare string to be passed back via transit?
- Should Interceptors be better documented, explaining how and when to return a response?  Where? In the Vase docs, or Pedestal, or both?</z><z id="t1493643200" t="rauh [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] a string isn&apos;t valid JSON. Need to be either an (JS) array or a (JS) map."><y>#</y><d>2017-05-01</d><h>12:53</h><w>rauh</w><a>@deg</a> a string isn&apos;t valid JSON. Need to be either an (JS) array or a (JS) map.</z><z id="t1493643248" t="deg Is that true of Transit too? I&apos;ve seen that the transit library will happily take a bare string."><y>#</y><d>2017-05-01</d><h>12:54</h><w>deg</w>Is that true of Transit too?   I&apos;ve seen that the transit library will happily take a bare string.</z><z id="t1493643337" t="deg There is even an example of this in readme of the transit library https://github.com/cognitect/transit-clj"><y>#</y><d>2017-05-01</d><h>12:55</h><w>deg</w>There is even an example of this in readme of the transit library <a href="https://github.com/cognitect/transit-clj" target="_blank">https://github.com/cognitect/transit-clj</a></z><z id="t1493643442" t="deg Ah, but this is transit+json, so I guess it uses json as bearer and needs to be valid json too?"><y>#</y><d>2017-05-01</d><h>12:57</h><w>deg</w>Ah, but this is transit+json, so I guess it uses json as bearer and needs to be valid json too?</z><z id="t1493643841" t="rauh [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] the transit interceptor checks with (coll? body) so that&apos;s the problem. Though, it seems the updated JSON RFC also does allow single strings now."><y>#</y><d>2017-05-01</d><h>13:04</h><w>rauh</w><a>@deg</a> the transit interceptor checks with <code>(coll? body)</code> so that&apos;s the problem. Though, it seems the updated JSON RFC also does allow single strings now.</z><z id="t1493643869" t="rauh So you could do it by just setting the Content-Type header yourself."><y>#</y><d>2017-05-01</d><h>13:04</h><w>rauh</w>So you could do it by just setting the <code>Content-Type</code> header yourself.</z><z id="t1493643883" t="deg Yup, the coll? check is the imediate problem. My question was why code was there."><y>#</y><d>2017-05-01</d><h>13:04</h><w>deg</w>Yup, the coll? check is the imediate problem. My question was why code was there.</z><z id="t1493643938" t="rauh Oh you linked the coll? check yourself. Didn&apos;t click the link 🙂"><y>#</y><d>2017-05-01</d><h>13:05</h><w>rauh</w>Oh you linked the <code>coll?</code> check yourself. Didn&apos;t click the link <b>🙂</b></z><z id="t1493643969" t="deg It was easier just to wrap my result in a map, than to change the Content-Type. The latter would have meant playing with cljs-ajax to figure out what make it happy. Its handling of random content-types is somewhat, umm, random."><y>#</y><d>2017-05-01</d><h>13:06</h><w>deg</w>It was easier just to wrap my result in a map, than to change the Content-Type. The latter would have meant playing with cljs-ajax to figure out what make it happy. Its handling of random content-types is somewhat, umm, random.</z><z id="t1493644040" t="rauh FWIF I don&apos;t see the point of the cljs-ajax library. 😕"><y>#</y><d>2017-05-01</d><h>13:07</h><w>rauh</w>FWIF I don&apos;t see the point of the cljs-ajax library. <b>😕</b></z><z id="t1493644075" t="deg I use re-frame/http-fx, which depends on it."><y>#</y><d>2017-05-01</d><h>13:07</h><w>deg</w>I use re-frame/http-fx, which depends on it.</z><z id="t1493644120" t="deg And the re-frame stuff is nice enough, that I&apos;m generally happy to put up with its opinionation. (if that&apos;s a word 🙂 )"><y>#</y><d>2017-05-01</d><h>13:08</h><w>deg</w>And the re-frame stuff is nice enough, that I&apos;m generally happy to put up with its opinionation.  (if that&apos;s a word <b>🙂</b>  )</z><z id="t1493644133" t="deg Of course, that cost me too much time today, so..."><y>#</y><d>2017-05-01</d><h>13:08</h><w>deg</w>Of course, that cost me too much time today, so...</z><z id="t1493644171" t="rauh Yeah not sure I&apos;d wanna lock myself into using a http-fx library. What about retries, offline queuing etc?"><y>#</y><d>2017-05-01</d><h>13:09</h><w>rauh</w>Yeah not sure I&apos;d wanna lock myself into using a http-fx library. What about retries, offline queuing etc?</z><z id="t1493644232" t="deg Dunno yet. I&apos;m still writing toy code, mostly for the sake of exploring Vase + Pedestal + re-frame + ..."><y>#</y><d>2017-05-01</d><h>13:10</h><w>deg</w>Dunno yet.  I&apos;m still writing toy code, mostly for the sake of exploring Vase + Pedestal + re-frame + ...</z><z id="t1493644751" t="malch [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] Is there a cljs library that provides retries and offline queuing?"><y>#</y><d>2017-05-01</d><h>13:19</h><w>malch</w><a>@rauh</a> Is there a cljs library that provides retries and offline queuing?</z><z id="t1493644895" t="rauh [:attrs {:href &quot;/_/_/users/U0505A5QE&quot;}] there is goog.net.XhrManager but detecting if the browser if offline is difficult. I think there is a few JS libs"><y>#</y><d>2017-05-01</d><h>13:21</h><w>rauh</w><a>@malch</a> there is <code>goog.net.XhrManager</code> but detecting if the browser if offline is difficult. I think there is a few JS libs</z><z id="t1493644923" t="malch [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] Thanks, will take a look myself simple_smile"><y>#</y><d>2017-05-01</d><h>13:22</h><w>malch</w><a>@rauh</a> Thanks, will take a look myself <b>simple_smile</b></z><z id="t1493808548" t="rauh This is pretty cool in combination with metrics and interceptors: https://gist.github.com/paulirish/a76ac17fc211b019e538c09d8d827691"><y>#</y><d>2017-05-03</d><h>10:49</h><w>rauh</w>This is pretty cool in combination with metrics and interceptors: <a href="https://gist.github.com/paulirish/a76ac17fc211b019e538c09d8d827691" target="_blank">https://gist.github.com/paulirish/a76ac17fc211b019e538c09d8d827691</a></z><z id="t1493812281" t="jimmy [:attrs {:href &quot;/_/_/users/U051SA920&quot;}] that&apos;s pretty neat"><y>#</y><d>2017-05-03</d><h>11:51</h><w>jimmy</w><a>@rauh</a> that&apos;s pretty neat</z><z id="t1493938622" t="crimeminister I am curious if anyone knows of a better way to prepend interceptors to the chain so that they execute right after the current interceptor, and if not would there be interest in supporting that capability in Pedestal? https://gist.github.com/crimeminister/14d87055b893cb1c0c11dd3eb5f84458"><y>#</y><d>2017-05-04</d><h>22:57</h><w>crimeminister</w>I am curious if anyone knows of a better way to prepend interceptors to the chain so that they execute right after the current interceptor, and if not would there be interest in supporting that capability in Pedestal? <a href="https://gist.github.com/crimeminister/14d87055b893cb1c0c11dd3eb5f84458" target="_blank">https://gist.github.com/crimeminister/14d87055b893cb1c0c11dd3eb5f84458</a></z><z id="t1493950694" t="hagmonk [:attrs {:href &quot;/_/_/users/U066SF64X&quot;}] I&apos;ve started using pedestal interceptors for non-web stuff and I&apos;d certainly find that useful"><y>#</y><d>2017-05-05</d><h>02:18</h><w>hagmonk</w><a>@crimeminister</a> I&apos;ve started using pedestal interceptors for non-web stuff and I&apos;d certainly find that useful</z><z id="t1493966542" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U0R92J961&quot;}] very curious what you are using it for?"><y>#</y><d>2017-05-05</d><h>06:42</h><w>kirill.salykin</w><a>@hagmonk</a> very curious what you are using it for?</z><z id="t1493979344" t="hagmonk [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] basically I have a data processing pipeline, so I now set that up as a chain of interceptors"><y>#</y><d>2017-05-05</d><h>10:15</h><w>hagmonk</w><a>@kirill.salykin</a> basically I have a data processing pipeline, so I now set that up as a chain of interceptors</z><z id="t1493979379" t="hagmonk which allows me to specify the steps using data, and do other things like wrap the interceptors in metrics and logging"><y>#</y><d>2017-05-05</d><h>10:16</h><w>hagmonk</w>which allows me to specify the steps using data, and do other things like wrap the interceptors in metrics and logging</z><z id="t1493979417" t="hagmonk so I actually have each interceptor wrapped in another one that times step execution, adding that to the context map as we go. Very handy."><y>#</y><d>2017-05-05</d><h>10:16</h><w>hagmonk</w>so I actually have each interceptor wrapped in another one that times step execution, adding that to the context map as we go. Very handy.</z><z id="t1493979438" t="kirill.salykin indeed, thanks!"><y>#</y><d>2017-05-05</d><h>10:17</h><w>kirill.salykin</w>indeed, thanks!</z><z id="t1493979655" t="hagmonk I made a function that takes a symbol (which points to a function) and turns it into an interceptor: (defn make-interceptor [sym] (let [int-fn (deref sym) int-nm (-&gt; sym str (str/split #&quot;/&quot;) last keyword) int-id (uuid/v1) ent-fn (fn [ctx] (-&gt; ctx (assoc-in [:timings int-nm] (System/currentTimeMillis)) int-fn (update-in [:timings int-nm] #(- (System/currentTimeMillis) %))))] (interceptor {::chain/execution-id int-id :name int-nm :enter ent-fn}))) "><y>#</y><d>2017-05-05</d><h>10:20</h><w>hagmonk</w>I made a function that takes a symbol (which points to a function) and turns it into an interceptor: 

<pre>(defn make-interceptor [sym]
  (let [int-fn (deref sym)
        int-nm (-&gt; sym str (str/split #&quot;/&quot;) last keyword)
        int-id (uuid/v1)
        ent-fn (fn [ctx]
                 (-&gt; ctx
                     (assoc-in [:timings int-nm] (System/currentTimeMillis))
                     int-fn
                     (update-in [:timings int-nm] #(- (System/currentTimeMillis) %))))]
    (interceptor {::chain/execution-id int-id
                  :name                int-nm
                  :enter               ent-fn})))
</pre></z><z id="t1493991866" t="crimeminister hagmonk: I will use this, thanks. Makes me want a nice way for evaluating pipeline performance more generally, e.g. an easy way to run criterium on every interceptor fn and on the pipeline as a whole."><y>#</y><d>2017-05-05</d><h>13:44</h><r>crimeminister</r>hagmonk: I will use this, thanks. Makes me want a nice way for evaluating pipeline performance more generally, e.g. an easy way to run criterium on every interceptor fn and on the pipeline as a whole.</z><z id="t1494004750" t="hagmonk Yeah! I think there&apos;s a ton of stuff you can do. For instance I&apos;m trying to spec the context map as it goes, so this make-interceptor can be subjected to generative testing. Having a generative test that runs across my whole pipeline would be kind of mind blowing, and could be interesting for performance testing too."><y>#</y><d>2017-05-05</d><h>17:19</h><r>hagmonk</r>Yeah! I think there&apos;s a ton of stuff you can do. For instance I&apos;m trying to spec the context map as it goes, so this make-interceptor can be subjected to generative testing. Having a generative test that runs across my whole pipeline would be kind of mind blowing, and could be interesting for performance testing too.</z><z id="t1493991446" t="crimeminister [:attrs {:href &quot;/_/_/users/U0R92J961&quot;}] I have been using Onyx with its onyx-local-rt for setting up data processing pipelines, but I like the idea of the Pedestal interceptor chain becoming more of a first class citizen. It will be easier to embed, for one thing."><y>#</y><d>2017-05-05</d><h>13:37</h><w>crimeminister</w><a>@hagmonk</a> I have been using Onyx with its <code>onyx-local-rt</code> for setting up data processing pipelines, but I like the idea of the Pedestal interceptor chain becoming more of a first class citizen. It will be easier to embed, for one thing.</z><z id="t1493992991" t="deg In Vase, why is it required to give a :name to each interceptor in the service edn file? It seems that this often just adds noise that I don&apos;t directly care about."><y>#</y><d>2017-05-05</d><h>14:03</h><w>deg</w>In Vase, why is it required to give a <code>:name</code> to each interceptor in the service edn file? It seems that this often just adds noise that I don&apos;t directly care about.</z><z id="t1493994363" t="mtnygard Paul has just cut a release of Vase. 0.9.1 is on Clojars, along with an update of the template project."><y>#</y><d>2017-05-05</d><h>14:26</h><w>mtnygard</w>Paul has just cut a release of Vase. 0.9.1 is on Clojars, along with an update of the template project.</z><z id="t1494018858" t="curtosis any tips on where to look for why an interceptor crashes with a stack overflow?"><y>#</y><d>2017-05-05</d><h>21:14</h><w>curtosis</w>any tips on where to look for why an interceptor crashes with a stack overflow?</z><z id="t1494018941" t="curtosis or, perhaps better, how to trap it so it doesn’t overflow the stack?"><y>#</y><d>2017-05-05</d><h>21:15</h><w>curtosis</w>or, perhaps better, how to trap it so it doesn’t overflow the stack?</z><z id="t1494024515" t="curtosis hrm.. turns out it wasn’t directly an interceptor problem, but still not sure why pedestal was dumping a massive overflowing stack trace."><y>#</y><d>2017-05-05</d><h>22:48</h><w>curtosis</w>hrm.. turns out it wasn’t directly an interceptor problem, but still not sure why pedestal was dumping a massive overflowing stack trace.</z><z id="t1494038576" t="danielcompton Pedestal wraps exceptions maybe?"><y>#</y><d>2017-05-06</d><h>02:42</h><w>danielcompton</w>Pedestal wraps exceptions maybe?</z><z id="t1494115060" t="bradford Where is the source for Pesestal + Netty interceptor?"><y>#</y><d>2017-05-06</d><h>23:57</h><w>bradford</w>Where is the source for Pesestal + Netty interceptor?</z><z id="t1494261197" t="mtnygard [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] Late reply (I’ve been OOO). Paul says he’s working on it as part of a chain provider sample, but it’s not finished yet."><y>#</y><d>2017-05-08</d><h>16:33</h><w>mtnygard</w><a>@bradford</a> Late reply (I’ve been OOO). Paul says he’s working on it as part of a chain provider sample, but it’s not finished yet.</z><z id="t1494268085" t="bradford Thanks. Another Q: when I have multiple redirects, it takes 70 seconds for a browser to process each one. Any idea why? Connection: Close is already set"><y>#</y><d>2017-05-08</d><h>18:28</h><w>bradford</w>Thanks. Another Q: when I have multiple redirects, it takes 70 seconds for a browser to process each one. Any idea why? Connection: Close is already set</z><z id="t1494274499" t="mtnygard [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] 70 seconds is totally bonkers. I don’t know why that would happen. Could you post to the pedestal-users mailing list to get more minds looking at it?"><y>#</y><d>2017-05-08</d><h>20:14</h><w>mtnygard</w><a>@bradford</a> 70 seconds is totally bonkers. I don’t know why that would happen. Could you post to the pedestal-users mailing list to get more minds looking at it?</z><z id="t1494274519" t="bradford Sure, will do. Thanks"><y>#</y><d>2017-05-08</d><h>20:15</h><w>bradford</w>Sure, will do. Thanks</z><z id="t1494367336" t="johnj Should I learn ring first to use pedestal effectively?"><y>#</y><d>2017-05-09</d><h>22:02</h><w>johnj</w>Should I learn ring first to use pedestal effectively?</z><z id="t1494370817" t="souenzzo No. But once you learn pedestal, you will have no desire to learn ring"><y>#</y><d>2017-05-09</d><h>23:00</h><w>souenzzo</w>No. But once you learn pedestal, you will have no desire to learn ring</z><z id="t1494380074" t="johnj [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Ok, I asked because saw that ring-core is a dependency of pedestal. Async aside, what do you like more about pedestal? interceptors?"><y>#</y><d>2017-05-10</d><h>01:34</h><w>johnj</w><a>@souenzzo</a> Ok, I asked because saw that ring-core is a dependency of pedestal. Async aside, what do you like more about pedestal? interceptors?</z><z id="t1494416970" t="souenzzo lockdown-: pedestal&apos;s way of think about request/response cycle.... https://www.youtube.com/watch?v=9L5NrCciSDU 😉"><y>#</y><d>2017-05-10</d><h>11:49</h><r>souenzzo</r>lockdown-: pedestal&apos;s way of think about request/response cycle....
<a href="https://www.youtube.com/watch?v=9L5NrCciSDU" target="_blank">https://www.youtube.com/watch?v=9L5NrCciSDU</a>
<b>😉</b></z><z id="t1494403452" t="jimmy [:attrs {:href &quot;/_/_/users/U097654L8&quot;}] The problem is the default CSP policy is too strict."><y>#</y><d>2017-05-10</d><h>08:04</h><w>jimmy</w><a>@mike1452</a> The problem is the default CSP policy is too strict.</z><z id="t1494403485" t="jimmy https://github.com/pedestal/pedestal/issues/499"><y>#</y><d>2017-05-10</d><h>08:04</h><w>jimmy</w><a href="https://github.com/pedestal/pedestal/issues/499" target="_blank">https://github.com/pedestal/pedestal/issues/499</a></z><z id="t1494403491" t="jimmy this should solve your problem 🙂"><y>#</y><d>2017-05-10</d><h>08:04</h><w>jimmy</w>this should solve your problem <b>🙂</b></z><z id="t1494403610" t="mike_ananev [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] thanks. I will try the solution :: http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}"><y>#</y><d>2017-05-10</d><h>08:06</h><w>mike_ananev</w><a>@nxqd</a> thanks. I will try the solution <b>::</b>http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}</z><z id="t1494431853" t="souenzzo any reason to pedestal deref handler functions? I&apos;m using #{[&quot;/foo&quot; [interceptor #&apos;my-ns/handler]]}"><y>#</y><d>2017-05-10</d><h>15:57</h><w>souenzzo</w>any reason to pedestal <code>deref</code> handler functions? I&apos;m using <code>#{[&quot;/foo&quot; [interceptor #&apos;my-ns/handler]]}</code></z><z id="t1494505510" t="sineer [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] You want to (deref #&apos;your-routes-var) in case your-routes-var changes at runtime otherwise pedestal won&apos;t pickup the changes untill you restart the http server."><y>#</y><d>2017-05-11</d><h>12:25</h><w>sineer</w><a>@souenzzo</a> You want to (deref #&apos;your-routes-var) in case your-routes-var changes at runtime otherwise pedestal won&apos;t pickup the changes untill you restart the http server.</z><z id="t1494505620" t="souenzzo I want hot reload (w/o restart) but I can&apos;t get it."><y>#</y><d>2017-05-11</d><h>12:27</h><w>souenzzo</w>I want hot reload (w/o restart) but I can&apos;t get it.</z><z id="t1494509483" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] This doesn’t solve the problem, but I’ve seen the question come up a few times. Added https://github.com/pedestal/pedestal-docs/issues/71 to make sure we document it."><y>#</y><d>2017-05-11</d><h>13:31</h><w>mtnygard</w><a>@souenzzo</a> This doesn’t solve the problem, but I’ve seen the question come up a few times. Added <a href="https://github.com/pedestal/pedestal-docs/issues/71" target="_blank">https://github.com/pedestal/pedestal-docs/issues/71</a> to make sure we document it.</z><z id="t1494548077" t="sineer [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I struggled a lot to get working route reload in repl also... In the end (after I realized I needed to deref the var) it was when someone here helped me figure out that cider-refresh doesn&apos;t work well with pedestal and I started to use cider-load-buffer instead."><y>#</y><d>2017-05-12</d><h>00:14</h><w>sineer</w><a>@souenzzo</a> I struggled a lot to get working route reload in repl also... In the end (after I realized I needed to deref the var) it was when someone here helped me figure out that cider-refresh doesn&apos;t work well with pedestal and I started to use cider-load-buffer instead.</z><z id="t1494592112" t="mtnygard [:attrs {:href &quot;/_/_/users/U2QDZ8CNA&quot;}] Oh, that’s interesting! I never ran into that because I just habitually use cider-load-buffer."><y>#</y><d>2017-05-12</d><h>12:28</h><w>mtnygard</w><a>@sineer</a> Oh, that’s interesting! I never ran into that because I just habitually use cider-load-buffer.</z><z id="t1494625933" t="hagmonk Are there any libraries available that help define routes and documentation, parameter validation and docstrings, etc, but with these features: a) expressing all that goop as pure data, b) sharing it with CLJS for interactive docs, c) using pedestal to generate / process interceptors that do most of the heavy lifting"><y>#</y><d>2017-05-12</d><h>21:52</h><w>hagmonk</w>Are there any libraries available that help define routes and documentation, parameter validation and docstrings, etc, but with these features: a) expressing all that goop as pure data, b) sharing it with CLJS for interactive docs, c) using pedestal to generate / process interceptors that do most of the heavy lifting</z><z id="t1494625978" t="hagmonk Because I&apos;m about to write one … I want to write a single piece of data that describes my route, then some code that implements the logic, then walk away and be done"><y>#</y><d>2017-05-12</d><h>21:52</h><w>hagmonk</w>Because I&apos;m about to write one … I want to write a single piece of data that describes my route, then some code that implements the logic, then walk away and be done</z><z id="t1494625988" t="mtnygard [:attrs {:href &quot;/_/_/users/U0R92J961&quot;}] That&apos;s on my wish list. Pretty much exactly as you described."><y>#</y><d>2017-05-12</d><h>21:53</h><w>mtnygard</w><a>@hagmonk</a> That&apos;s on my wish list. Pretty much exactly as you described.</z><z id="t1494625997" t="mtnygard But maybe with a twist..."><y>#</y><d>2017-05-12</d><h>21:53</h><w>mtnygard</w>But maybe with a twist...</z><z id="t1494626038" t="mtnygard I&apos;ve been thinking of it in parts like this:"><y>#</y><d>2017-05-12</d><h>21:53</h><w>mtnygard</w>I&apos;ve been thinking of it in parts like this:</z><z id="t1494626069" t="mtnygard 1. A library to describe routes as data. This exists in the form of Vase. We just need to think about how to surface the specs about request bodies."><y>#</y><d>2017-05-12</d><h>21:54</h><w>mtnygard</w>1. A library to describe routes as data. This exists in the form of Vase. We just need to think about how to surface the specs about request bodies.</z><z id="t1494626094" t="mtnygard 2. The ability for Pedestal routes to have extra data that Pedestal doesn&apos;t care about, but carries along."><y>#</y><d>2017-05-12</d><h>21:54</h><w>mtnygard</w>2. The ability for Pedestal routes to have extra data that Pedestal doesn&apos;t care about, but carries along.</z><z id="t1494626109" t="mtnygard 3. A library that can consume that data and generate UI &amp; Swagger spec from it."><y>#</y><d>2017-05-12</d><h>21:55</h><w>mtnygard</w>3. A library that can consume that data and generate UI &amp; Swagger spec from it.</z><z id="t1494626115" t="mtnygard -end-"><y>#</y><d>2017-05-12</d><h>21:55</h><w>mtnygard</w>-end-</z><z id="t1494626549" t="hagmonk I&apos;m currently at this point where I use the content-type detection and either serve up json, or serve up a full blown CLJS SPA that lets you explore the whole data structure. It also includes individual timings of each pedestal interceptor so I can locate problems."><y>#</y><d>2017-05-12</d><h>22:02</h><w>hagmonk</w>I&apos;m currently at this point where I use the content-type detection and either serve up json, or serve up a full blown CLJS SPA that lets you explore the whole data structure. It also includes individual timings of each pedestal interceptor so I can locate problems.</z><z id="t1494626585" t="hagmonk So I started falling pretty hard for this idea of the self describing API, or the self reporting application, and wondered how close I could get to having this all spun off for free"><y>#</y><d>2017-05-12</d><h>22:03</h><w>hagmonk</w>So I started falling pretty hard for this idea of the self describing API, or the self reporting application, and wondered how close I could get to having this all spun off for free</z><z id="t1494626587" t="mtnygard wow, that sounds fantastic"><y>#</y><d>2017-05-12</d><h>22:03</h><w>mtnygard</w>wow, that sounds fantastic</z><z id="t1494626654" t="hagmonk I don&apos;t think there&apos;s anything proprietary in here, so, a screenshot:"><y>#</y><d>2017-05-12</d><h>22:04</h><w>hagmonk</w>I don&apos;t think there&apos;s anything proprietary in here, so, a screenshot:</z><z id="t1494626771" t="hagmonk so the CLJS thing I wrote is cool (and my first CLJS project) in that I&apos;ve just implemented a bunch of multi methods to handle different key types that come across the wire. So it&apos;s the same page for every single route, and as long as each route coughs up the right shape of data, you get a free web viz out of it"><y>#</y><d>2017-05-12</d><h>22:06</h><w>hagmonk</w>so the CLJS thing I wrote is cool (and my first CLJS project) in that I&apos;ve just implemented a bunch of multi methods to handle different key types that come across the wire. So it&apos;s the same page for every single route, and as long as each route coughs up the right shape of data, you get a free web viz out of it</z><z id="t1494626788" t="mtnygard right"><y>#</y><d>2017-05-12</d><h>22:06</h><w>mtnygard</w>right</z><z id="t1494626798" t="mtnygard nice and generic, open to extension"><y>#</y><d>2017-05-12</d><h>22:06</h><w>mtnygard</w>nice and generic, open to extension</z><z id="t1494626812" t="hagmonk (and I cheat and just stuff the data into a transit json encoded body attribute, no websocket here 😬 )"><y>#</y><d>2017-05-12</d><h>22:06</h><w>hagmonk</w>(and I cheat and just stuff the data into a transit json encoded body attribute, no websocket here <b>😬</b>)</z><z id="t1494626886" t="mtnygard If you were going to express your routes, docs, &amp; validation as data, what would it look like? Have you tried writing a spec or example for it?"><y>#</y><d>2017-05-12</d><h>22:08</h><w>mtnygard</w>If you were going to express your routes, docs, &amp; validation as data, what would it look like? Have you tried writing a spec or example for it?</z><z id="t1494627017" t="hagmonk I&apos;ve spec&apos;d the parameters one of my routes accepts … it was kind of fiddly. I went as far as writing generators for everything so I could generate sample parameter data for my routes."><y>#</y><d>2017-05-12</d><h>22:10</h><w>hagmonk</w>I&apos;ve spec&apos;d the parameters one of my routes accepts … it was kind of fiddly. I went as far as writing generators for everything so I could generate sample parameter data for my routes.</z><z id="t1494627035" t="hagmonk So I&apos;m not 100% sure what I&apos;d like that to look like in data, I do know I wouldn&apos;t want to do this for every single route by hand"><y>#</y><d>2017-05-12</d><h>22:10</h><w>hagmonk</w>So I&apos;m not 100% sure what I&apos;d like that to look like in data, I do know I wouldn&apos;t want to do this for every single route by hand</z><z id="t1494627078" t="mtnygard Yeah, it gets tedious to write big data structures by hand."><y>#</y><d>2017-05-12</d><h>22:11</h><w>mtnygard</w>Yeah, it gets tedious to write big data structures by hand.</z><z id="t1494627104" t="mtnygard Russ Olsen and I have been working on something to help with that. Still very much alpha."><y>#</y><d>2017-05-12</d><h>22:11</h><w>mtnygard</w>Russ Olsen and I have been working on something to help with that. Still very much alpha.</z><z id="t1494627104" t="mtnygard https://github.com/cognitect-labs/fern"><y>#</y><d>2017-05-12</d><h>22:11</h><w>mtnygard</w><a href="https://github.com/cognitect-labs/fern" target="_blank">https://github.com/cognitect-labs/fern</a></z><z id="t1494627138" t="mtnygard The basic idea is to write something by hand that&apos;s easier, then grab a key and pull a tree out of the flatter file."><y>#</y><d>2017-05-12</d><h>22:12</h><w>mtnygard</w>The basic idea is to write something by hand that&apos;s easier, then grab a key and pull a tree out of the flatter file.</z><z id="t1494627166" t="mtnygard I have an experimental fork of Vase to try using this format as a more human-friendly representation than straight .edn"><y>#</y><d>2017-05-12</d><h>22:12</h><w>mtnygard</w>I have an experimental fork of Vase to try using this format as a more human-friendly representation than straight .edn</z><z id="t1494627213" t="hagmonk Oh man, weavejester is going to have to update integrant 🙂"><y>#</y><d>2017-05-12</d><h>22:13</h><w>hagmonk</w>Oh man, weavejester is going to have to update integrant <b>🙂</b></z><z id="t1494627222" t="mtnygard What is integrant?"><y>#</y><d>2017-05-12</d><h>22:13</h><w>mtnygard</w>What is integrant?</z><z id="t1494627229" t="hagmonk https://github.com/weavejester/integrant"><y>#</y><d>2017-05-12</d><h>22:13</h><w>hagmonk</w><a href="https://github.com/weavejester/integrant" target="_blank">https://github.com/weavejester/integrant</a></z><z id="t1494627243" t="hagmonk i&apos;m using it in my apps now, I like it a lot"><y>#</y><d>2017-05-12</d><h>22:14</h><w>hagmonk</w>i&apos;m using it in my apps now, I like it a lot</z><z id="t1494627260" t="hagmonk It feels like a subset of fern after my very superficial skim through your page"><y>#</y><d>2017-05-12</d><h>22:14</h><w>hagmonk</w>It feels like a subset of fern after my very superficial skim through your page</z><z id="t1494627294" t="mtnygard There&apos;s some definite similarity."><y>#</y><d>2017-05-12</d><h>22:14</h><w>mtnygard</w>There&apos;s some definite similarity.</z><z id="t1494627296" t="hagmonk less dogmatic than component, less hope-and-pray than mount"><y>#</y><d>2017-05-12</d><h>22:14</h><w>hagmonk</w>less dogmatic than component, less hope-and-pray than mount</z><z id="t1494627321" t="mtnygard But fern is only about making it easier to write nested data structures."><y>#</y><d>2017-05-12</d><h>22:15</h><w>mtnygard</w>But fern is only about making it easier to write nested data structures.</z><z id="t1494627337" t="mtnygard It looks like Integrant does more"><y>#</y><d>2017-05-12</d><h>22:15</h><w>mtnygard</w>It looks like Integrant does more</z><z id="t1494627344" t="hagmonk right, it just so happens that integrant is using such a structure for app config bootup goop"><y>#</y><d>2017-05-12</d><h>22:15</h><w>hagmonk</w>right, it just so happens that integrant is using such a structure for app config bootup goop</z><z id="t1494627515" t="hagmonk I can see fern being really great for composing data structures together, for sharing and reusing parts of structure. That&apos;s a big component of how I&apos;d want to configure the routes in my app."><y>#</y><d>2017-05-12</d><h>22:18</h><w>hagmonk</w>I can see fern being really great for composing data structures together, for sharing and reusing parts of structure. That&apos;s a big component of how I&apos;d want to configure the routes in my app.</z><z id="t1494627551" t="hagmonk It&apos;s actually one of the lightbulbs I had with namespaced keywords … wait a second … this keyword has a specific, global meaning in my app"><y>#</y><d>2017-05-12</d><h>22:19</h><w>hagmonk</w>It&apos;s actually one of the lightbulbs I had with namespaced keywords … wait a second … this keyword has a specific, global meaning in my app</z><z id="t1494627554" t="mtnygard Yes. I also wanted to be able to extend Vase with &quot;literals&quot; from other libraries like pedestal.views"><y>#</y><d>2017-05-12</d><h>22:19</h><w>mtnygard</w>Yes. I also wanted to be able to extend Vase with &quot;literals&quot; from other libraries like pedestal.views</z><z id="t1494627579" t="hagmonk Hmm not sure I&apos;ve looked at pedestal views"><y>#</y><d>2017-05-12</d><h>22:19</h><w>hagmonk</w>Hmm not sure I&apos;ve looked at pedestal views</z><z id="t1494627589" t="mtnygard (It&apos;s not quite ready to unveil.)"><y>#</y><d>2017-05-12</d><h>22:19</h><w>mtnygard</w>(It&apos;s not quite ready to unveil.)</z><z id="t1494627640" t="hagmonk Ooh :)"><y>#</y><d>2017-05-12</d><h>22:20</h><w>hagmonk</w>Ooh :)</z><z id="t1494627671" t="mtnygard Fern also has some pretty nice error reporting:"><y>#</y><d>2017-05-12</d><h>22:21</h><w>mtnygard</w>Fern also has some pretty nice error reporting:</z><z id="t1494628022" t="mtnygard I&apos;ve got to run, but will keep thinking about how to move more of the API into data."><y>#</y><d>2017-05-12</d><h>22:27</h><w>mtnygard</w>I&apos;ve got to run, but will keep thinking about how to move more of the API into data.</z><z id="t1494628558" t="hagmonk Yeah for sure! I’ll think more on this too 👍"><y>#</y><d>2017-05-12</d><h>22:35</h><w>hagmonk</w>Yeah for sure! I’ll think more on this too <b>👍</b></z><z id="t1494763926" t="deg What is the recommended way to handle user authentication in a Vase app?"><y>#</y><d>2017-05-14</d><h>12:12</h><w>deg</w>What is the recommended way to handle user authentication in a Vase app?</z><z id="t1494798944" t="danielcompton [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] I think interceptors?"><y>#</y><d>2017-05-14</d><h>21:55</h><w>danielcompton</w><a>@deg</a> I think interceptors?</z><z id="t1494798971" t="danielcompton https://github.com/cognitect-labs/vase/blob/master/docs/design.md#authorization-and-external-requests"><y>#</y><d>2017-05-14</d><h>21:56</h><w>danielcompton</w><a href="https://github.com/cognitect-labs/vase/blob/master/docs/design.md#authorization-and-external-requests" target="_blank">https://github.com/cognitect-labs/vase/blob/master/docs/design.md#authorization-and-external-requests</a></z><z id="t1494799010" t="danielcompton My plan was to put an authn interceptor on the root, and authz interceptors on each vase route"><y>#</y><d>2017-05-14</d><h>21:56</h><w>danielcompton</w>My plan was to put an authn interceptor on the root, and authz interceptors on each vase route</z><z id="t1494799020" t="danielcompton But doing authorization that way seems a bit tricky"><y>#</y><d>2017-05-14</d><h>21:57</h><w>danielcompton</w>But doing authorization that way seems a bit tricky</z><z id="t1494799691" t="deg Yup, I assume interceptors. But, I was hoping for something more detailed. Meanwhile, I did find https://github.com/propan/geheimtur . It looks reasonable (at least at my first glance) and has a nicely worked sample for Pedestal. Looks like it should be straightforward to massage it to Vase; I hope to have time to explore. this sometime the next couple of days."><y>#</y><d>2017-05-14</d><h>22:08</h><w>deg</w>Yup, I assume interceptors. But, I was hoping for something more detailed.
Meanwhile, I did find <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a>. It looks reasonable (at least at my first glance) and has a nicely worked sample for Pedestal. Looks like it should be straightforward to massage it to Vase; I hope to have time to explore. this sometime the next couple of days.</z><z id="t1494843547" t="deg [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] I looked at this more carefully just now. Looks like there are already ongoing discussions about handling auth, but no complete packaged solution. Still missing are: - Wrapping this up into a Vase sample - A doc comparing Friend vs Buddy vs Geheimtur I don&apos;t know quite enough to do either of these tasks myself, but I&apos;m wrestling with whether I should I extend my current bikeshedding to learn enough. For my current toy project, the auth in https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/interceptors.clj is really all I need, so my rational side is arguing to not waste more time trying to do it right. For future reference: One conversation ( [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] and @ohpauleez) leading to PR for a demo in Pedestal: https://clojurians-log.clojureverse.org/pedestal/2017-03-03.html , https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk; https://github.com/pedestal/pedestal/issues/500 , https://github.com/pedestal/pedestal/pull/503 An existing Pedestal-based sample ( [:attrs {:href &quot;/_/_/users/U06QS5Z0U&quot;}] ): https://github.com/propan/geheimtur-demo"><y>#</y><d>2017-05-15</d><h>10:19</h><w>deg</w><a>@danielcompton</a> I looked at this more carefully just now. Looks like there are already ongoing discussions about handling auth, but no complete packaged solution.  

Still missing are:
- Wrapping this up into a Vase sample
- A doc comparing Friend vs Buddy vs Geheimtur

I don&apos;t know quite enough to do either of these tasks myself, but I&apos;m wrestling with whether I should I extend my current bikeshedding to learn enough.
For my current toy project, the auth in <a href="https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/interceptors.clj" target="_blank">https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/interceptors.clj</a> is really all I need, so my rational side is arguing to not waste more time trying to do it right.

For future reference:

One conversation (<a>@ddeaguiar</a> and @ohpauleez) leading to PR for a demo in Pedestal:
<a href="https://clojurians-log.clojureverse.org/pedestal/2017-03-03.html" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2017-03-03.html</a>, <a href="https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk;" target="_blank">https://groups.google.com/forum/#!topic/pedestal-users/MJL0h4ts_mk;</a> <a href="https://github.com/pedestal/pedestal/issues/500" target="_blank">https://github.com/pedestal/pedestal/issues/500</a>, <a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a>

An existing Pedestal-based sample (<a>@propan</a>):
<a href="https://github.com/propan/geheimtur-demo" target="_blank">https://github.com/propan/geheimtur-demo</a></z><z id="t1494860224" t="ikitommi Hi. Was the Pedestal entry in the Techempower Web Framework Benchmark now with good production settings? New results are out, much better but far from good (all clojure entries imo): https://www.techempower.com/benchmarks/diffs/r13-r14.html &amp; https://www.techempower.com/benchmarks/#section=data-r14&amp;amp;hw=ph&amp;amp;test=fortune"><y>#</y><d>2017-05-15</d><h>14:57</h><w>ikitommi</w>Hi. Was the Pedestal entry in the Techempower Web Framework Benchmark now with good production settings? New results are out, much better but far from good (all clojure entries imo): <a href="https://www.techempower.com/benchmarks/diffs/r13-r14.html" target="_blank">https://www.techempower.com/benchmarks/diffs/r13-r14.html</a> &amp; <a href="https://www.techempower.com/benchmarks/#section=data-r14&amp;amp;hw=ph&amp;amp;test=fortune" target="_blank">https://www.techempower.com/benchmarks/#section=data-r14&amp;amp;hw=ph&amp;amp;test=fortune</a></z><z id="t1494861364" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] I’ve passed your question on to Paul who was involved in the benchmarks. Will post here when I find out."><y>#</y><d>2017-05-15</d><h>15:16</h><w>mtnygard</w><a>@ikitommi</a> I’ve passed your question on to Paul who was involved in the benchmarks. Will post here when I find out.</z><z id="t1494861418" t="mtnygard (My commentary: I don’t understand the TE benchmark… I’ve seen 200K responses per second on my local hardware. But that is with routes designed to use the map-tree router which is super-fast.)"><y>#</y><d>2017-05-15</d><h>15:16</h><w>mtnygard</w>(My commentary: I don’t understand the TE benchmark… I’ve seen 200K responses per second on my local hardware. But that is with routes designed to use the map-tree router which is super-fast.)</z><z id="t1494862125" t="ikitommi [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks"><y>#</y><d>2017-05-15</d><h>15:28</h><w>ikitommi</w> <a>@mtnygard</a> thanks</z><z id="t1494862413" t="mtnygard FWIW, Paul also says that the published results don’t match any configuration we’ve seen. Way lower on all ratios."><y>#</y><d>2017-05-15</d><h>15:33</h><w>mtnygard</w>FWIW, Paul also says that the published results don’t match any configuration we’ve seen. Way lower on all ratios.</z><z id="t1494862435" t="mtnygard That’s across loopback, physical gigE connections, and AWS"><y>#</y><d>2017-05-15</d><h>15:33</h><w>mtnygard</w>That’s across loopback, physical gigE connections, and AWS</z><z id="t1494961493" t="jfntn Does anyone have an example of injecting component dependencies into a service handler?"><y>#</y><d>2017-05-16</d><h>19:04</h><w>jfntn</w>Does anyone have an example of injecting component dependencies into a service handler?</z><z id="t1494961536" t="jfntn In ring I used to inject everything in a server component and close over the dependencies when making the routes."><y>#</y><d>2017-05-16</d><h>19:05</h><w>jfntn</w>In ring I used to inject everything in a server component and close over the dependencies when making the routes.</z><z id="t1494961558" t="jfntn Not sure that’s the best approach with pedestal since it seems like a good use-case for an interceptor…?"><y>#</y><d>2017-05-16</d><h>19:05</h><w>jfntn</w>Not sure that’s the best approach with pedestal since it seems like a good use-case for an interceptor…?</z><z id="t1494961669" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] Unfortunately this guide is still pending http://pedestal.io/guides/pedestal-component-handlers-and-dependencies but I think your approach will work"><y>#</y><d>2017-05-16</d><h>19:07</h><w>ddeaguiar</w><a>@jfntn</a> Unfortunately this guide is still pending <a href="http://pedestal.io/guides/pedestal-component-handlers-and-dependencies" target="_blank">http://pedestal.io/guides/pedestal-component-handlers-and-dependencies</a> but I think your approach will work</z><z id="t1494961723" t="jfntn Yes I saw that, which is why I asked here 🙂"><y>#</y><d>2017-05-16</d><h>19:08</h><w>jfntn</w>Yes I saw that, which is why I asked here <b>🙂</b></z><z id="t1494961745" t="ddeaguiar You can have an interceptor which assoc’s the pedestal component to the context allowing downstream interceptors to pull the requisite dependencies off it"><y>#</y><d>2017-05-16</d><h>19:09</h><w>ddeaguiar</w>You can have an interceptor which assoc’s the pedestal component to the context allowing downstream interceptors to pull the requisite dependencies off it</z><z id="t1494961817" t="ddeaguiar Some of the links specified here are instructive: http://pedestal.io/guides/pedestal-with-component#_in_the_wild"><y>#</y><d>2017-05-16</d><h>19:10</h><w>ddeaguiar</w>Some of the  links specified here are instructive: <a href="http://pedestal.io/guides/pedestal-with-component#_in_the_wild" target="_blank">http://pedestal.io/guides/pedestal-with-component#_in_the_wild</a></z><z id="t1494961851" t="ddeaguiar I’m also working on an alternative implementation for this. I hope to release it soon and update the guide"><y>#</y><d>2017-05-16</d><h>19:10</h><w>ddeaguiar</w>I’m also working on an alternative implementation for this. I hope to release it soon and update the guide</z><z id="t1494961952" t="jfntn Ah I missed those links, thanks"><y>#</y><d>2017-05-16</d><h>19:12</h><w>jfntn</w>Ah I missed those links, thanks</z><z id="t1494961971" t="jfntn Is that the patter you were referring to [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L95 ?"><y>#</y><d>2017-05-16</d><h>19:12</h><w>jfntn</w>Is that the patter you were referring to <a>@ddeaguiar</a> <a href="https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L95" target="_blank">https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L95</a> ?</z><z id="t1494962474" t="ddeaguiar So I’m now preferring the approach outlined here: https://github.com/ddeaguiar/component-pedestal/tree/route-provider"><y>#</y><d>2017-05-16</d><h>19:21</h><w>ddeaguiar</w>So I’m now preferring the approach outlined here: <a href="https://github.com/ddeaguiar/component-pedestal/tree/route-provider" target="_blank">https://github.com/ddeaguiar/component-pedestal/tree/route-provider</a></z><z id="t1494962528" t="ddeaguiar again this is a work in progress but the idea is that components provide routes. Component-specific routes include interceptors which provide access to dependencies"><y>#</y><d>2017-05-16</d><h>19:22</h><w>ddeaguiar</w>again this is a work in progress but the idea is that components provide routes. Component-specific routes include interceptors which provide access to dependencies</z><z id="t1494962581" t="ddeaguiar Be aware that the usage described there demonstrates a handler accessing dependencies but I’m going to change that to be an interceptor instead"><y>#</y><d>2017-05-16</d><h>19:23</h><w>ddeaguiar</w>Be aware that the usage described there demonstrates a handler accessing dependencies but I’m going to change that to be an interceptor instead</z><z id="t1494962619" t="ddeaguiar by making dependencies accessible via the Context, you gain dynamic dependency mgmt which makes testing easier"><y>#</y><d>2017-05-16</d><h>19:23</h><w>ddeaguiar</w>by making dependencies accessible via the Context, you gain dynamic dependency mgmt which makes testing easier</z><z id="t1494962634" t="ddeaguiar imo anyways"><y>#</y><d>2017-05-16</d><h>19:23</h><w>ddeaguiar</w>imo anyways</z><z id="t1494962668" t="ddeaguiar But I’ve used the implementation demonstrated in the Elements project with success as well"><y>#</y><d>2017-05-16</d><h>19:24</h><w>ddeaguiar</w>But I’ve used the implementation demonstrated in the Elements project with success as well</z><z id="t1494962810" t="ddeaguiar FYI, the code in the master branch of the component-pedestal repo was really experimental. The implementation is cute but I don’t think it’s a good idea to decouple components from their usage in interceptors/handlers."><y>#</y><d>2017-05-16</d><h>19:26</h><w>ddeaguiar</w>FYI, the code in the master branch of the component-pedestal repo was really experimental. The implementation is cute but I don’t think it’s a good idea to decouple components from their usage in interceptors/handlers.</z><z id="t1494964505" t="jfntn That’s nice, had a similar RouteProvider protocol with our ring version and I liked it, but I’m not sure how if I like having per-route component injectors, I think I’d rather always add the union of all deps to the context and forget about it"><y>#</y><d>2017-05-16</d><h>19:55</h><w>jfntn</w>That’s nice, had a similar RouteProvider protocol with our ring version and I liked it, but I’m not sure how if I like having per-route component injectors, I think I’d rather always add the union of all deps to the context and forget about it</z><z id="t1494964691" t="ddeaguiar Then the approach implemented by Elements, which is based on Stuart Sierra’s component-pedestal exploration, is for you."><y>#</y><d>2017-05-16</d><h>19:58</h><w>ddeaguiar</w>Then the approach implemented by Elements, which is based on Stuart Sierra’s component-pedestal exploration, is for you.</z><z id="t1494964822" t="jfntn Looks good to me, thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2017-05-16</d><h>20:00</h><w>jfntn</w>Looks good to me, thanks <a>@ddeaguiar</a> !</z><z id="t1494964843" t="ddeaguiar np 🙂"><y>#</y><d>2017-05-16</d><h>20:00</h><w>ddeaguiar</w>np <b>🙂</b></z><z id="t1494979137" t="kenny What is the recommended way of handling parse failures from io.pedestal.http.body-params/body-params ? i.e. When a request contains invalid JSON causing Cheshire to fail parsing it. I see two options: 1. Write my own version of the body-params interceptor that wraps the call to parse-content-type in a try/catch. 2. Add an error interceptor to the interceptor chain that looks for parse failure exceptions and attaches a :status 400 to the :response . I don&apos;t really like option 2 because it forces you to have to remember that if you use the body-params interceptor you must also use the error interceptor. I&apos;m just wondering what you guys typically do."><y>#</y><d>2017-05-16</d><h>23:58</h><w>kenny</w>What is the recommended way of handling parse failures from <code>io.pedestal.http.body-params/body-params</code>? i.e. When a request contains invalid JSON causing Cheshire to fail parsing it. I see two options: 
1. Write my own version of the <code>body-params</code> interceptor that wraps the call to <code>parse-content-type</code> in a try/catch. 
2. Add an error interceptor to the interceptor chain that looks for parse failure exceptions and attaches a <code>:status</code> 400 to the <code>:response</code>.
I don&apos;t really like option 2 because it forces you to have to remember that if you use the <code>body-params</code> interceptor you must also use the error interceptor. I&apos;m just wondering what you guys typically do.</z><z id="t1494986990" t="v3ga does anyone here have any small apps such as a blog or forum written with pedestal? Preferably pedestal and component?"><y>#</y><d>2017-05-17</d><h>02:09</h><w>v3ga</w>does anyone here have any small apps such as a blog or forum written with pedestal? Preferably pedestal and component?</z><z id="t1495005376" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] I am using this approach https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b"><y>#</y><d>2017-05-17</d><h>07:16</h><w>kirill.salykin</w><a>@jfntn</a> I am using this approach
<a href="https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b" target="_blank">https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b</a></z><z id="t1495011613" t="kirill.salykin [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] maybe this would help? http://pedestal.io/reference/error-handling"><y>#</y><d>2017-05-17</d><h>09:00</h><w>kirill.salykin</w><a>@kenny</a> maybe this would help?
<a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a></z><z id="t1495024655" t="deg In my Vase app, after I define my schema, I&apos;d like to populate it with some domain data. Can I do this directly in the service .edn file?"><y>#</y><d>2017-05-17</d><h>12:37</h><w>deg</w>In my Vase app, after I define my schema, I&apos;d like to populate it with some domain data.  Can I do this directly in the service .edn file?</z><z id="t1495027612" t="mtnygard [:attrs {:href &quot;/_/_/users/U3JJ35GUT&quot;}] Yes, but be aware that Datomic doesn’t let you define attributes and use the attributes in the same transaction. Give me a minute and I can dig up a sample that does what you want."><y>#</y><d>2017-05-17</d><h>13:26</h><w>mtnygard</w><a>@deg</a> Yes, but be aware that Datomic doesn’t let you define attributes and use the attributes in the same transaction. Give me a minute and I can dig up a sample that does what you want.</z><z id="t1495027667" t="mtnygard Here’s a bit that goes under :vase/norms in one of my apps"><y>#</y><d>2017-05-17</d><h>13:27</h><w>mtnygard</w>Here’s a bit that goes under <code>:vase/norms</code> in one of my apps</z><z id="t1495027668" t="mtnygard {:control-server/clock {:vase.norm/txes ["><y>#</y><d>2017-05-17</d><h>13:27</h><w>mtnygard</w><pre>{:control-server/clock
   {:vase.norm/txes [</pre></z><z id="t1495027983" t="mtnygard [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] I’ve got this sample app https://github.com/mtnygard/todo-backend-pedestal . It doesn’t use Component, but there were some examples posted earlier yesterday that do."><y>#</y><d>2017-05-17</d><h>13:33</h><w>mtnygard</w><a>@decim</a> I’ve got this sample app <a href="https://github.com/mtnygard/todo-backend-pedestal" target="_blank">https://github.com/mtnygard/todo-backend-pedestal</a>. It doesn’t use Component, but there were some examples posted earlier yesterday that do.</z><z id="t1495028019" t="mtnygard You can find 2 different libraries that use Component with Pedestal at http://pedestal.io/community/index"><y>#</y><d>2017-05-17</d><h>13:33</h><w>mtnygard</w>You can find 2 different libraries that use Component with Pedestal at <a href="http://pedestal.io/community/index" target="_blank">http://pedestal.io/community/index</a></z><z id="t1495028033" t="mtnygard (Component.Pedestal and Point Slope Elements)"><y>#</y><d>2017-05-17</d><h>13:33</h><w>mtnygard</w>(Component.Pedestal and Point Slope Elements)</z><z id="t1495029194" t="deg [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks! I thought I had tried that, as one of about half a dozen permutations. I must have mistyped something. Will try again now."><y>#</y><d>2017-05-17</d><h>13:53</h><w>deg</w><a>@mtnygard</a> Thanks!  I thought I had tried that, as one of about half a dozen permutations. I must have mistyped something.  Will try again now.</z><z id="t1495029592" t="deg All good now. Thanks!"><y>#</y><d>2017-05-17</d><h>13:59</h><w>deg</w>All good now. Thanks!</z><z id="t1495030583" t="jfntn [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] ended up using almost the same code, merging (component/depencies pedestal) in the context map which I like since it makes all deps accessible under their key"><y>#</y><d>2017-05-17</d><h>14:16</h><w>jfntn</w><a>@kirill.salykin</a> ended up using almost the same code, merging <code>(component/depencies pedestal)</code> in the context map which I like since it makes all deps accessible under their key</z><z id="t1495031721" t="jimmy [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] are you still in need of an exmaple of pedestal and component. I will happily make [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] example work with component if he accepts PR."><y>#</y><d>2017-05-17</d><h>14:35</h><w>jimmy</w><a>@decim</a> are you still in need of an exmaple of pedestal and component. I will happily make <a>@mtnygard</a> example work with component if he accepts PR.</z><z id="t1495031771" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I’d be happy to take a PR."><y>#</y><d>2017-05-17</d><h>14:36</h><w>mtnygard</w><a>@nxqd</a> I’d be happy to take a PR.</z><z id="t1495031801" t="mtnygard But I’d be even happier with another example so we have all the different styles represented."><y>#</y><d>2017-05-17</d><h>14:36</h><w>mtnygard</w>But I’d be even happier with another example so we have all the different styles represented.</z><z id="t1495031833" t="mtnygard (E.g., I’ve also got https://github.com/mtnygard/todo-backend-pedestal-vase )"><y>#</y><d>2017-05-17</d><h>14:37</h><w>mtnygard</w>(E.g., I’ve also got <a href="https://github.com/mtnygard/todo-backend-pedestal-vase" target="_blank">https://github.com/mtnygard/todo-backend-pedestal-vase</a>)</z><z id="t1495031904" t="jimmy We can start with an example that most beginner request. What do you think ?"><y>#</y><d>2017-05-17</d><h>14:38</h><w>jimmy</w>We can start with an example that most beginner request. What do you think ?</z><z id="t1495031935" t="mtnygard I’m not sure what you’re proposing"><y>#</y><d>2017-05-17</d><h>14:38</h><w>mtnygard</w>I’m not sure what you’re proposing</z><z id="t1495031984" t="jimmy I haven&apos;t followed much these days, I meant I can start with pedestal + component first."><y>#</y><d>2017-05-17</d><h>14:39</h><w>jimmy</w>I haven&apos;t followed much these days, I meant I can start with pedestal + component first.</z><z id="t1495032076" t="mtnygard Ah, OK. Sure!"><y>#</y><d>2017-05-17</d><h>14:41</h><w>mtnygard</w>Ah, OK. Sure!</z><z id="t1495035482" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] we also have a guide for pedestal+component http://pedestal.io/guides/pedestal-with-component . What we’re missing is the follow up guide re: passing dependencies to interceptors and handlers. I think a sample demonstrating that would be great"><y>#</y><d>2017-05-17</d><h>15:38</h><w>ddeaguiar</w><a>@nxqd</a> we also have a guide for pedestal+component <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a>. What we’re missing is the follow up guide re: passing dependencies to interceptors and handlers. I think a sample demonstrating that would be great</z><z id="t1495035555" t="ddeaguiar I’ve found that there are multiple approaches for this. One of the more popular ones being the approach demonstrated in [:attrs {:href &quot;/_/_/users/U1V7K1YTZ&quot;}] ’s gist https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b"><y>#</y><d>2017-05-17</d><h>15:39</h><w>ddeaguiar</w>I’ve found that there are multiple approaches for this. One of the more popular ones being the approach demonstrated in <a>@kirill.salykin</a>’s gist <a href="https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b" target="_blank">https://gist.github.com/kirillsalykin/485403344bf85e5cb820ff4c91cdae0b</a></z><z id="t1495035583" t="ddeaguiar which is very similar to Stuart Sierra’s component.pedestal approach"><y>#</y><d>2017-05-17</d><h>15:39</h><w>ddeaguiar</w>which is very similar to Stuart Sierra’s component.pedestal approach</z><z id="t1495037413" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I see that we always have an example of using pedestal + component ( or like the one you posted above ) somewhere. However, it&apos;s not easy to find for beginner. So the better approach might be gathering those examples under pedestal repo ( under examples ) or a wiki page of external examples. What do you guys think ?"><y>#</y><d>2017-05-17</d><h>16:10</h><w>jimmy</w><a>@ddeaguiar</a> I see that we always have an example of using pedestal + component ( or like the one you posted above ) somewhere. However, it&apos;s not easy to find for beginner. So the better approach might be gathering those examples under pedestal repo ( under examples ) or a wiki page of external examples. What do you guys think ?</z><z id="t1495048729" t="gerstree I need a little guidance on the use of vase. The documentation states &quot;API-specific data that is persisted in the database is owned by that API&quot;. How should I interpret this. Is Vase at all suited to make existing data in an existing schema available as per REST API? Should other applications not touch this data anymore, thus requiring a redesign of let&apos;s say an existing web application?"><y>#</y><d>2017-05-17</d><h>19:18</h><w>gerstree</w>I need a little guidance on the use of vase. The documentation states &quot;API-specific data that is persisted in the database is owned by that API&quot;. How should I interpret this. Is Vase at all suited to make existing data in an existing schema available as per REST API? Should other applications not touch this data anymore, thus requiring a redesign of let&apos;s say an existing web application?</z><z id="t1495055324" t="mtnygard [:attrs {:href &quot;/_/_/users/U0760PQKS&quot;}] That might be over-interpreting the statement. Since Datomic provides strong consistency, there shouldn’t be a problem accessing the data from a mixed API."><y>#</y><d>2017-05-17</d><h>21:08</h><w>mtnygard</w><a>@gerstree</a> That might be over-interpreting the statement. Since Datomic provides strong consistency, there shouldn’t be a problem accessing the data from a mixed API.</z><z id="t1495055387" t="mtnygard If you have an existing schema, you can definitely use Vase to set up query and transaction routes against it. The only limitation is that it’s kind of hard to use transactor functions from Vase APIs, so if you need those to make atomic changes, you’ll have to write an interceptor by hand or use the #vase/interceptor syntax."><y>#</y><d>2017-05-17</d><h>21:09</h><w>mtnygard</w>If you have an existing schema, you can definitely use Vase to set up query and transaction routes against it. The only limitation is that it’s kind of hard to use transactor functions from Vase APIs, so if you need those to make atomic changes, you’ll have to write an interceptor by hand or use the <code>#vase/interceptor</code> syntax.</z><z id="t1495055457" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] Re: pedestal + component examples… my preference would be a pull request on https://github.com/pedestal/pedestal-docs"><y>#</y><d>2017-05-17</d><h>21:10</h><w>mtnygard</w><a>@nxqd</a> Re: pedestal + component examples… my preference would be a pull request on <a href="https://github.com/pedestal/pedestal-docs" target="_blank">https://github.com/pedestal/pedestal-docs</a></z><z id="t1495055472" t="mtnygard The “Community” page is meant for collecting that type of thing."><y>#</y><d>2017-05-17</d><h>21:11</h><w>mtnygard</w>The “Community” page is meant for collecting that type of thing.</z><z id="t1495066311" t="v3ga [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] absolutely, i’ve been tearing github apart looking for an example"><y>#</y><d>2017-05-18</d><h>00:11</h><w>v3ga</w><a>@nxqd</a>  absolutely, i’ve been tearing github apart looking for an example</z><z id="t1495066361" t="v3ga [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks, that should do, i’ll take a look back at earlier posts as well. thanks"><y>#</y><d>2017-05-18</d><h>00:12</h><w>v3ga</w><a>@mtnygard</a> thanks, that should do, i’ll take a look back at earlier posts as well. thanks</z><z id="t1495107887" t="gerstree [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks, so it&apos;s definitely worth diving into Vase to provide an API for an existing application?"><y>#</y><d>2017-05-18</d><h>11:44</h><w>gerstree</w><a>@mtnygard</a> Thanks, so it&apos;s definitely worth diving into Vase to provide an API for an existing application?</z><z id="t1495112410" t="mtnygard [:attrs {:href &quot;/_/_/users/U0760PQKS&quot;}] I think so, but it will depend on how much logic is in your application. Vase is really meant to be a quick, easy way to shuttle data from HTTP into and out of Datomic. If you need more logic than Vase provides, you can use custom interceptors. The descriptor will start to get unwieldy when the chains are long."><y>#</y><d>2017-05-18</d><h>13:00</h><w>mtnygard</w><a>@gerstree</a> I think so, but it will depend on how much logic is in your application. Vase is really meant to be a quick, easy way to shuttle data from HTTP into and out of Datomic.

If you need more logic than Vase provides, you can use custom interceptors. The descriptor will start to get unwieldy when the chains are long.</z><z id="t1495112444" t="mtnygard One thing I’ve done is use Vase to describe a bunch of the “dumb” routes that pump data back and forth, but then use hand-written routes to handle the more interesting cases."><y>#</y><d>2017-05-18</d><h>13:00</h><w>mtnygard</w>One thing I’ve done is use Vase to describe a bunch of the “dumb” routes that pump data back and forth, but then use hand-written routes to handle the more interesting cases.</z><z id="t1495112488" t="mtnygard (I’ll post a gist with some bits that might come in handy for that)"><y>#</y><d>2017-05-18</d><h>13:01</h><w>mtnygard</w>(I’ll post a gist with some bits that might come in handy for that)</z><z id="t1495123476" t="jfntn I don’t have a logging setup in my project yet, if I want pedestal to print debug info I’ll have to configure logback with an xml file is that correct?"><y>#</y><d>2017-05-18</d><h>16:04</h><w>jfntn</w>I don’t have a logging setup in my project yet, if I want pedestal to print debug info I’ll have to configure logback with an xml file is that correct?</z><z id="t1495123581" t="ddeaguiar yes"><y>#</y><d>2017-05-18</d><h>16:06</h><w>ddeaguiar</w>yes</z><z id="t1495123624" t="ddeaguiar apps generated through the lein templates will have a logback config"><y>#</y><d>2017-05-18</d><h>16:07</h><w>ddeaguiar</w>apps generated through the lein templates will have a logback config</z><z id="t1495123763" t="jfntn This one? https://github.com/pedestal/pedestal/blob/701fb2c52a97c3335a57544746af05eba02f4c23/service-template/src/leiningen/new/pedestal_service/logback.xml"><y>#</y><d>2017-05-18</d><h>16:09</h><w>jfntn</w>This one? <a href="https://github.com/pedestal/pedestal/blob/701fb2c52a97c3335a57544746af05eba02f4c23/service-template/src/leiningen/new/pedestal_service/logback.xml" target="_blank">https://github.com/pedestal/pedestal/blob/701fb2c52a97c3335a57544746af05eba02f4c23/service-template/src/leiningen/new/pedestal_service/logback.xml</a></z><z id="t1495123787" t="ddeaguiar yeah"><y>#</y><d>2017-05-18</d><h>16:09</h><w>ddeaguiar</w>yeah</z><z id="t1495123868" t="jfntn thanks, will take a look"><y>#</y><d>2017-05-18</d><h>16:11</h><w>jfntn</w>thanks, will take a look</z><z id="t1495123876" t="ddeaguiar 🙂"><y>#</y><d>2017-05-18</d><h>16:11</h><w>ddeaguiar</w><b>🙂</b></z><z id="t1495124381" t="jfntn Ah that worked, thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2017-05-18</d><h>16:19</h><w>jfntn</w>Ah that worked, thanks <a>@ddeaguiar</a></z><z id="t1495124429" t="jfntn I guess I can’t ignore jvm logging libraries anymore :0"><y>#</y><d>2017-05-18</d><h>16:20</h><w>jfntn</w>I guess I can’t ignore jvm logging libraries anymore :0</z><z id="t1495124469" t="ddeaguiar Yeah. I little logback knowledge goes a long way 🙂"><y>#</y><d>2017-05-18</d><h>16:21</h><w>ddeaguiar</w>Yeah. I little logback knowledge goes a long way <b>🙂</b></z><z id="t1495124969" t="jfntn This is a sidetrack, but I’ve been logging everything as edn maps using pr-str for a while and it’s been really useful, are there any reasons why you would NOT want a custom logback appender to do that?"><y>#</y><d>2017-05-18</d><h>16:29</h><w>jfntn</w>This is a sidetrack, but I’ve been logging everything as edn maps using pr-str for a while and it’s been really useful, are there any reasons why you would NOT want a custom logback appender to do that?</z><z id="t1495125504" t="ddeaguiar So I’ve been using lnav with this config https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json"><y>#</y><d>2017-05-18</d><h>16:38</h><w>ddeaguiar</w>So I’ve been using lnav with this config <a href="https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json" target="_blank">https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json</a></z><z id="t1495125539" t="ddeaguiar I’ve not found a need to implement a custom appender thus far but I suppose it depends on the need"><y>#</y><d>2017-05-18</d><h>16:38</h><w>ddeaguiar</w>I’ve not found a need to implement a custom appender thus far but I suppose it depends on the need</z><z id="t1495125805" t="jfntn not familiar with that, does it parse the lines into data structures to make it easier to navigate them?"><y>#</y><d>2017-05-18</d><h>16:43</h><w>jfntn</w>not familiar with that, does it parse the lines into data structures to make it easier to navigate them?</z><z id="t1495126665" t="ddeaguiar yep"><y>#</y><d>2017-05-18</d><h>16:57</h><w>ddeaguiar</w>yep</z><z id="t1495126685" t="ddeaguiar well it at least pretty prints them"><y>#</y><d>2017-05-18</d><h>16:58</h><w>ddeaguiar</w>well it at least pretty prints them</z></g><g id="s7"><z id="t1495126692" t="ddeaguiar you can expand/collapse lines"><y>#</y><d>2017-05-18</d><h>16:58</h><w>ddeaguiar</w>you can expand/collapse lines</z><z id="t1495126699" t="ddeaguiar and you can query your logs"><y>#</y><d>2017-05-18</d><h>16:58</h><w>ddeaguiar</w>and you can query your logs</z><z id="t1495129422" t="jfntn Interesting, do you think you could do something like that before writing to the file or there would be too much overhead?"><y>#</y><d>2017-05-18</d><h>17:43</h><w>jfntn</w>Interesting, do you think you could do something like that before writing to the file or there would be too much overhead?</z><z id="t1495130766" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] not sure I follow"><y>#</y><d>2017-05-18</d><h>18:06</h><w>ddeaguiar</w><a>@jfntn</a> not sure I follow</z><z id="t1495132432" t="jfntn Ha sorry missing some context here. In the previous rev of our backend we wrote a very simple logger that’d take a single clojure map and write it as edn. What was great about it was that consuming the logs was simple as something like (map edn/read-string (line-seq &quot;app.log&quot;)) and then you can filter etc. What wasn’t so great was that our app logs were special snowflakes and we had to handle them separately from the logs printed by all our dependencies. I didn’t know of lnav but what I’m wondering now is could we apply the same kind of processing where a regexp gets parsed into a map, but do it before writing and turn all our libraries’ logs into edn maps."><y>#</y><d>2017-05-18</d><h>18:33</h><w>jfntn</w>Ha sorry missing some context here. In the previous rev of our backend we wrote a very simple logger that’d take a single clojure map and write it as edn. What was great about it was that consuming the logs was simple as something like <code>(map edn/read-string (line-seq &quot;app.log&quot;))</code> and then you can filter etc. What wasn’t so great was that our app logs were special snowflakes and we had to handle them separately from the logs printed by all our dependencies. I didn’t know of lnav but what I’m wondering now is could we apply the same kind of processing where a regexp gets parsed into a map, but do it before writing and turn all our libraries’ logs into edn maps.</z><z id="t1495133995" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] lnav supports different formats and provides many predefined ones. It uses the format that matches the current log file."><y>#</y><d>2017-05-18</d><h>18:59</h><w>ddeaguiar</w><a>@jfntn</a> lnav supports different formats and provides many predefined ones. It uses the format that matches the current log file.</z><z id="t1495134003" t="ddeaguiar you can get as fancy as you like"><y>#</y><d>2017-05-18</d><h>19:00</h><w>ddeaguiar</w>you can get as fancy as you like</z><z id="t1495134100" t="ddeaguiar you can also configure it to work with Papertrail although I’ve not tried that"><y>#</y><d>2017-05-18</d><h>19:01</h><w>ddeaguiar</w>you can also configure it to work with Papertrail although I’ve not tried that</z><z id="t1495144938" t="kenny I can&apos;t quite figure out why if I include io.pedestal.http/dev-interceptors , I always get a 403 Forbidden with any of my routes even though I have set ::http/allowed-origins to (constantly true) . Any ideas why this would be happening?"><y>#</y><d>2017-05-18</d><h>22:02</h><w>kenny</w>I can&apos;t quite figure out why if I include <code>io.pedestal.http/dev-interceptors</code> , I always get a 403 Forbidden with any of my routes even though I have set <code>::http/allowed-origins</code> to <code>(constantly true)</code>. Any ideas why this would be happening?</z><z id="t1495145050" t="kenny The problematic interceptor is io.pedestal.http.cors/dev-allow-origin . Though, all it is doing is setting the request origin to an empty string if it doesn&apos;t exist. I don&apos;t see how that would affect the (constantly true) function."><y>#</y><d>2017-05-18</d><h>22:04</h><w>kenny</w>The problematic interceptor is <code>io.pedestal.http.cors/dev-allow-origin</code>. Though, all it is doing is setting the request origin to an empty string if it doesn&apos;t exist. I don&apos;t see how that would affect the <code>(constantly true)</code> function.</z><z id="t1495145239" t="kenny The interceptors in the service map that causes the 403 are these: #Interceptor{:name :io.pedestal.http.impl.servlet-interceptor/exception-debug} #Interceptor{:name :io.pedestal.http.cors/dev-allow-origin} #Interceptor{:name :io.pedestal.http/log-request} #Interceptor{:name :io.pedestal.http.cors/allow-origin} #Interceptor{:name :io.pedestal.http/not-found} #Interceptor{:name :io.pedestal.http.ring-middlewares/content-type-interceptor} #Interceptor{:name :io.pedestal.http.route/query-params} #Interceptor{:name :io.pedestal.http.route/method-param} #Interceptor{:name :io.pedestal.http.secure-headers/secure-headers} #Interceptor{:name :io.pedestal.http.route/router} If I remove #Interceptor{:name :io.pedestal.http.cors/dev-allow-origin} everything works A-OK."><y>#</y><d>2017-05-18</d><h>22:07</h><w>kenny</w>The interceptors in the service map that causes the 403 are these:
<pre>#Interceptor{:name :io.pedestal.http.impl.servlet-interceptor/exception-debug}
#Interceptor{:name :io.pedestal.http.cors/dev-allow-origin}
#Interceptor{:name :io.pedestal.http/log-request}
#Interceptor{:name :io.pedestal.http.cors/allow-origin}
#Interceptor{:name :io.pedestal.http/not-found}
#Interceptor{:name :io.pedestal.http.ring-middlewares/content-type-interceptor}
#Interceptor{:name :io.pedestal.http.route/query-params}
#Interceptor{:name :io.pedestal.http.route/method-param}
#Interceptor{:name :io.pedestal.http.secure-headers/secure-headers}
#Interceptor{:name :io.pedestal.http.route/router}
</pre>
If I remove <code>#Interceptor{:name :io.pedestal.http.cors/dev-allow-origin}</code> everything works A-OK.</z><z id="t1495146633" t="kenny I figured it out... I called default-interceptors before I overrode the ::http/allow-origins key."><y>#</y><d>2017-05-18</d><h>22:30</h><w>kenny</w>I figured it out... I called <code>default-interceptors</code> before I overrode the <code>::http/allow-origins</code> key.</z><z id="t1495149418" t="bherrmann boo cant destructure …. [{:keys parama paramb} (:params request)] wont work as params are strings….."><y>#</y><d>2017-05-18</d><h>23:16</h><w>bherrmann</w>boo cant destructure ….  [{:keys parama paramb} (:params request)]  wont work as params are strings…..</z><z id="t1495149784" t="jfntn [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] you can use :strs instead of :keys"><y>#</y><d>2017-05-18</d><h>23:23</h><w>jfntn</w><a>@bherrmann</a> you can use <code>:strs</code> instead of <code>:keys</code></z><z id="t1495155133" t="jimmy jfntn: wow ! I just learn something new today 😄"><y>#</y><d>2017-05-19</d><h>00:52</h><r>jimmy</r>jfntn: wow ! I just learn something new today <b>😄</b></z><z id="t1495149870" t="bherrmann THANKS"><y>#</y><d>2017-05-18</d><h>23:24</h><w>bherrmann</w>THANKS</z><z id="t1495177699" t="gerstree [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks for the direction. I&apos;ll dive into Vase then and find out how easy it is to get data in and out of the existing schema with Vase. Your snippets show how easy it is really to mix and match with Pedestal routes as a fallback. Great!"><y>#</y><d>2017-05-19</d><h>07:08</h><w>gerstree</w><a>@mtnygard</a> Thanks for the direction. I&apos;ll dive into Vase then and find out how easy it is to get data in and out of the existing schema with Vase. Your snippets show how easy it is really to mix and match with Pedestal routes as a fallback. Great!</z><z id="t1495318525" t="jfntn What’s the best way to cancel the rest of the interceptor chain and return a response in the :enter fn of an interceptor?"><y>#</y><d>2017-05-20</d><h>22:15</h><w>jfntn</w>What’s the best way to cancel the rest of the interceptor chain and return a response in the <code>:enter</code> fn of an interceptor?</z><z id="t1495320261" t="jfntn Ha~ io.pedestal.interceptor.chain/terminate"><y>#</y><d>2017-05-20</d><h>22:44</h><w>jfntn</w>Ha~ <code>io.pedestal.interceptor.chain/terminate</code></z><z id="t1495330885" t="jfntn Confused by that comment: https://github.com/pedestal/pedestal/issues/497#issuecomment-284405795 What’s the recommended way to stream a response if core.async is discouraged? The guides don’t seem to mention that"><y>#</y><d>2017-05-21</d><h>01:41</h><w>jfntn</w>Confused by that comment: <a href="https://github.com/pedestal/pedestal/issues/497#issuecomment-284405795" target="_blank">https://github.com/pedestal/pedestal/issues/497#issuecomment-284405795</a> What’s the recommended way to stream a response if core.async is discouraged? The guides don’t seem to mention that</z><z id="t1495430534" t="julianwegkamp [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] I think I remember reading that you shouldn&apos;t use io.pedestal.interceptor.chain/terminate but instead just add a :response to the context."><y>#</y><d>2017-05-22</d><h>05:22</h><w>julianwegkamp</w><a>@jfntn</a> I think I remember reading that you shouldn&apos;t use <code>io.pedestal.interceptor.chain/terminate</code> but instead just add a :response to the context.</z><z id="t1495461948" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] [:attrs {:href &quot;/_/_/users/U051S1QM3&quot;}] When using Pedestal to build web services, you can either use terminate or attach a response. That’s because the servlet-interceptor always attaches a terminator function that looks for the response."><y>#</y><d>2017-05-22</d><h>14:05</h><w>mtnygard</w><a>@jfntn</a> <a>@julianwegkamp</a> When using Pedestal to build web services, you can either use <code>terminate</code> or attach a response.  That’s because the <code>servlet-interceptor</code> always attaches a terminator function that looks for the response.</z><z id="t1495461965" t="mtnygard But if you remove or replace that terminator function with your own custom function, you can still use terminate ."><y>#</y><d>2017-05-22</d><h>14:06</h><w>mtnygard</w>But if you remove or replace that terminator function with your own custom function, you can still use <code>terminate</code>.</z><z id="t1495462017" t="mtnygard Or, if you use interceptors for something other that web services, you can use terminate or define your own terminator functions. (I’ve got a library where I use Pedestal interceptors for Kafka messages… there’s no natural terminator function there so I use terminate when needed.)"><y>#</y><d>2017-05-22</d><h>14:06</h><w>mtnygard</w>Or, if you use interceptors for something other that web services, you can use <code>terminate</code> or define your own terminator functions. (I’ve got a library where I use Pedestal interceptors for Kafka messages… there’s no natural terminator function there so I use <code>terminate</code> when needed.)</z><z id="t1495462234" t="julianwegkamp thx [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] . Is this the Kafka library Paul mentioned in his talk and will it become publicly available?"><y>#</y><d>2017-05-22</d><h>14:10</h><w>julianwegkamp</w>thx <a>@mtnygard</a>. Is this the Kafka library Paul mentioned in his talk and will it become publicly available?</z><z id="t1495462243" t="mtnygard Yes, and yes."><y>#</y><d>2017-05-22</d><h>14:10</h><w>mtnygard</w>Yes, and yes.</z><z id="t1495462377" t="mtnygard I just don’t have any particular schedule for releasing it. It’s very raw at the moment and I don’t want to get people’s expectations up too much."><y>#</y><d>2017-05-22</d><h>14:12</h><w>mtnygard</w>I just don’t have any particular schedule for releasing it. It’s very raw at the moment and I don’t want to get people’s expectations up too much.</z><z id="t1495463534" t="mtnygard OK, well, I have a schedule now."><y>#</y><d>2017-05-22</d><h>14:32</h><w>mtnygard</w>OK, well, I have a schedule now.</z><z id="t1495463545" t="mtnygard I opened it up as a beta about 2 minutes ago."><y>#</y><d>2017-05-22</d><h>14:32</h><w>mtnygard</w>I opened it up as a beta about 2 minutes ago.</z><z id="t1495463546" t="mtnygard https://github.com/cognitect-labs/pedestal.kafka"><y>#</y><d>2017-05-22</d><h>14:32</h><w>mtnygard</w><a href="https://github.com/cognitect-labs/pedestal.kafka" target="_blank">https://github.com/cognitect-labs/pedestal.kafka</a></z><z id="t1495463559" t="mtnygard But unfortunately, I have to run so I can’t answer any questions until tomorrow."><y>#</y><d>2017-05-22</d><h>14:32</h><w>mtnygard</w>But unfortunately, I have to run so I can’t answer any questions until tomorrow.</z><z id="t1495464339" t="julianwegkamp Thx. Just looking at your code will be interesting enough I assume. Will try to make some time in the coming week..."><y>#</y><d>2017-05-22</d><h>14:45</h><w>julianwegkamp</w>Thx. Just looking at your code will be interesting enough I assume. Will try to make some time in the coming week...</z><z id="t1495465447" t="jimmy [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I opened a PR to add heroku to pedestal service template so beginner can try out new service and get it on production quickly."><y>#</y><d>2017-05-22</d><h>15:04</h><w>jimmy</w><a>@mtnygard</a> I opened a PR to add heroku to pedestal service template so beginner can try out new service and get it on production quickly.</z><z id="t1495542379" t="mtnygard [:attrs {:href &quot;/_/_/users/U051S1QM3&quot;}] I wrote a quick readme for pedestal.kafka yesterday morning. This morning I realized that I pushed it to the wrong repo. (My private fork instead of the public one.) There&apos;s now a readme that has pointers into the code."><y>#</y><d>2017-05-23</d><h>12:26</h><w>mtnygard</w><a>@julianwegkamp</a> I wrote a quick readme for pedestal.kafka yesterday morning. This morning I realized that I pushed it to the wrong repo. (My private fork instead of the public one.) There&apos;s now a readme that has pointers into the code.</z><z id="t1495542401" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I&apos;ll make sure Paul looks at that. He maintains the template."><y>#</y><d>2017-05-23</d><h>12:26</h><w>mtnygard</w><a>@nxqd</a> I&apos;ll make sure Paul looks at that. He maintains the template.</z><z id="t1495575897" t="cap10morgan Is there a way to get the :: env value from an interceptor?"><y>#</y><d>2017-05-23</d><h>21:44</h><w>cap10morgan</w>Is there a way to get the <b>::</b>env value from an interceptor?</z><z id="t1495575967" t="cap10morgan short of putting it into an atom or something"><y>#</y><d>2017-05-23</d><h>21:46</h><w>cap10morgan</w>short of putting it into an atom or something</z><z id="t1495576068" t="cap10morgan Or, in case I&apos;m going about this all wrong, how would one make an interceptor behave differently based on env?"><y>#</y><d>2017-05-23</d><h>21:47</h><w>cap10morgan</w>Or, in case I&apos;m going about this all wrong, how would one make an interceptor behave differently based on env?</z><z id="t1495585522" t="mtnygard [:attrs {:href &quot;/_/_/users/U06FS3DLH&quot;}] The env key doesn&apos;t really do anything. It&apos;s kind of a leftover from an age long ago. "><y>#</y><d>2017-05-24</d><h>00:25</h><w>mtnygard</w><a>@cap10morgan</a> The env key doesn&apos;t really do anything. It&apos;s kind of a leftover from an age long ago. </z><z id="t1495585542" t="mtnygard To make an interceptor behave differently, I&apos;d do 2 things. "><y>#</y><d>2017-05-24</d><h>00:25</h><w>mtnygard</w>To make an interceptor behave differently, I&apos;d do 2 things. 
</z><z id="t1495585592" t="mtnygard 1. Put an interceptor at the head of the chain that uses a real env value to attach a map to the context. That map would be your environment config. "><y>#</y><d>2017-05-24</d><h>00:26</h><w>mtnygard</w>1. Put an interceptor at the head of the chain that uses a real env value to attach a map to the context. That map would be your environment config. </z><z id="t1495585623" t="mtnygard 2. Have your interceptors look for specific config values rather than just &quot;what env am I in&quot;"><y>#</y><d>2017-05-24</d><h>00:27</h><w>mtnygard</w>2. Have your interceptors look for specific config values rather than just &quot;what env am I in&quot;</z><z id="t1495585660" t="mtnygard That way your choice of config mechanism is independent of how your interceptors are written. You can change either one separately. "><y>#</y><d>2017-05-24</d><h>00:27</h><w>mtnygard</w>That way your choice of config mechanism is independent of how your interceptors are written. You can change either one separately. </z><z id="t1495592796" t="cap10morgan OK, makes sense. Thanks!"><y>#</y><d>2017-05-24</d><h>02:26</h><w>cap10morgan</w>OK, makes sense. Thanks!</z><z id="t1495630969" t="manutter51 Does anybody have some good example code for using Pedestal with transit as an API back end?"><y>#</y><d>2017-05-24</d><h>13:02</h><w>manutter51</w>Does anybody have some good example code for using Pedestal with transit as an API back end?</z><z id="t1495640537" t="jfntn I have an fdef spec for an enter fn that I use in an interceptor, and for some reason it doesn’t seem to check the args when invoking the service-fn in tests with (st/instrument) on. Is there anything pedestal specific that could be causing this, or should I look somewhere else?"><y>#</y><d>2017-05-24</d><h>15:42</h><w>jfntn</w>I have an <code>fdef</code> spec for an enter fn that I use in an interceptor, and for some reason it doesn’t seem to check the args when invoking the service-fn in tests with <code>(st/instrument)</code> on. Is there anything pedestal specific that could be causing this, or should I look somewhere else?</z><z id="t1495641550" t="jfntn Hmm even s/assert doesn’t run in the enter fn, only s/assert*"><y>#</y><d>2017-05-24</d><h>15:59</h><w>jfntn</w>Hmm even <code>s/assert</code> doesn’t run in the enter fn, only <code>s/assert*</code></z><z id="t1495653038" t="souenzzo CompilerException java.lang.AssertionError: Assert failed: In row 1, there were unused elements (:extra :stuff). There is some way to specify extra info on routes? I&apos;m using &quot;#{[&quot;/foo&quot; :get [fns] :route-name :bar :extra :stuff]}&quot;"><y>#</y><d>2017-05-24</d><h>19:10</h><w>souenzzo</w><code>CompilerException java.lang.AssertionError: Assert failed: In row 1, there were unused elements (:extra :stuff).</code>
There is some way to specify extra info on routes? I&apos;m using &quot;#{[&quot;/foo&quot; :get [fns] :route-name :bar :extra :stuff]}&quot;</z><z id="t1495723510" t="jfntn I have a core.async chan of database rows I’d like to return as my response body, but the content type should be transit+json and I’m not sure if it’s possible to encode the channel properly?"><y>#</y><d>2017-05-25</d><h>14:45</h><w>jfntn</w>I have a core.async chan of database rows I’d like to return as my response body, but the content type should be transit+json and I’m not sure if it’s possible to encode the channel properly?</z><z id="t1495723591" t="mtnygard [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] Hmm… I think there are a couple of parts there. You should be able to set the Content-Type header directly in your response map."><y>#</y><d>2017-05-25</d><h>14:46</h><w>mtnygard</w><a>@jfntn</a> Hmm… I think there are a couple of parts there. You should be able to set the Content-Type header directly in your response map.</z><z id="t1495723612" t="mtnygard There’s also an interceptor that should emit the correct encoding… one sec while I look it up."><y>#</y><d>2017-05-25</d><h>14:46</h><w>mtnygard</w>There’s also an interceptor that should emit the correct encoding… one sec while I look it up.</z><z id="t1495723713" t="mtnygard io.pedestal.http/transit-json-body"><y>#</y><d>2017-05-25</d><h>14:48</h><w>mtnygard</w><code>io.pedestal.http/transit-json-body</code></z><z id="t1495723760" t="mtnygard What is the data type that the channel messages will be? You may need a transducer on the channel to turn a JDBC object into a map for the transit-json-body"><y>#</y><d>2017-05-25</d><h>14:49</h><w>mtnygard</w>What is the data type that the channel messages will be? You may need a transducer on the channel to turn a JDBC object into a map for the transit-json-body</z><z id="t1495723902" t="jfntn So the chan will contain one map per row (from cassandra through the alia library). I should have added that I was hoping I could stream the response and have it end up on the client as a vector/collection"><y>#</y><d>2017-05-25</d><h>14:51</h><w>jfntn</w>So the chan will contain one map per row (from cassandra through the alia library). I should have added that I was hoping I could stream the response and have it end up on the client as a vector/collection</z><z id="t1495723964" t="mtnygard Ah, I see. But the whole collection of rows will never be a single data structure in memory, right?"><y>#</y><d>2017-05-25</d><h>14:52</h><w>mtnygard</w>Ah, I see. But the whole collection of rows will never be a single data structure in memory, right?</z><z id="t1495723971" t="jfntn correct"><y>#</y><d>2017-05-25</d><h>14:52</h><w>jfntn</w>correct</z><z id="t1495723976" t="mtnygard That does complicate things."><y>#</y><d>2017-05-25</d><h>14:52</h><w>mtnygard</w>That does complicate things.</z><z id="t1495723982" t="jfntn ^^"><y>#</y><d>2017-05-25</d><h>14:53</h><w>jfntn</w>^^</z><z id="t1495724024" t="jfntn My first attempt was to transduce the chan with transit/write but the client ends up reading the first map only"><y>#</y><d>2017-05-25</d><h>14:53</h><w>jfntn</w>My first attempt was to transduce the chan with <code>transit/write</code> but the client ends up reading the first map only</z><z id="t1495724104" t="mtnygard I can’t think of a really clean way to do it. You might be able to cheat a bit though."><y>#</y><d>2017-05-25</d><h>14:55</h><w>mtnygard</w>I can’t think of a really clean way to do it. You might be able to cheat a bit though.</z><z id="t1495724131" t="mtnygard If your transducer emits a \[ before the first row, and a \] after the last row, then the client will think it’s got a single collection."><y>#</y><d>2017-05-25</d><h>14:55</h><w>mtnygard</w>If your transducer emits a \[ before the first row, and a \] after the last row, then the client will think it’s got a single collection.</z><z id="t1495724133" t="jfntn I could accumulate the results in memory and return a data strucute just to get it to work now, but it’d be great to know whether this could be solved in the future since our responses will get bigger over time"><y>#</y><d>2017-05-25</d><h>14:55</h><w>jfntn</w>I could accumulate the results in memory and return a data strucute just to get it to work now, but it’d be great to know whether this could be solved in the future since our responses will get bigger over time</z><z id="t1495724133" t="jimmy [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] you can map the extra information to route-name-extra map. Then you can get those extra information in any interceptor: (def route-name-extra-map {:route-name-a [...]}) "><y>#</y><d>2017-05-25</d><h>14:55</h><w>jimmy</w><a>@souenzzo</a> you can map the extra information to route-name-extra map. Then you can get those extra information in any interceptor:

<pre>(def route-name-extra-map 
  {:route-name-a [...]})
</pre></z><z id="t1495725053" t="souenzzo nxqd: I&apos;m using it. But on route will be way easier to see mistakes."><y>#</y><d>2017-05-25</d><h>15:10</h><r>souenzzo</r>nxqd: I&apos;m using it. But on route will be way easier to see mistakes.</z><z id="t1495724163" t="jfntn [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] hmm let me try that"><y>#</y><d>2017-05-25</d><h>14:56</h><w>jfntn</w><a>@mtnygard</a> hmm let me try that</z><z id="t1495725395" t="jfntn [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ah it works, but I need to interpose commas between rows"><y>#</y><d>2017-05-25</d><h>15:16</h><w>jfntn</w><a>@mtnygard</a> ah it works, but I need to interpose commas between rows</z><z id="t1495730966" t="cap10morgan Is there a way to mount a route table into another one? so, if I have a defroutes in one namespace, and I want to mount all those routes at a particular path in the master service/routes table, how would I do that?"><y>#</y><d>2017-05-25</d><h>16:49</h><w>cap10morgan</w>Is there a way to mount a route table into another one? so, if I have a <code>defroutes</code> in one namespace, and I want to mount all those routes at a particular path in the master <code>service/routes</code> table, how would I do that?</z><z id="t1495731097" t="mtnygard [:attrs {:href &quot;/_/_/users/U06FS3DLH&quot;}] You’ll have to defer expanding the routes, so just use def instead of defroutes . At that point, the route table is just data so you could update the path portion with a map and string concatenation"><y>#</y><d>2017-05-25</d><h>16:51</h><w>mtnygard</w><a>@cap10morgan</a> You’ll have to defer expanding the routes, so just use <code>def</code> instead of <code>defroutes</code>. At that point, the route table is just data so you could update the path portion with a map and string concatenation</z><z id="t1495731128" t="cap10morgan [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] OK, thanks. Will play around with that."><y>#</y><d>2017-05-25</d><h>16:52</h><w>cap10morgan</w><a>@mtnygard</a> OK, thanks. Will play around with that.</z><z id="t1495736111" t="cap10morgan [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] When I tried this, I found that the repeated &quot;/&quot; at the root of my nested routes caused a double // to be required in the URL for the route to match more deeply-nested routes in the table (using the linear-search router). It did match that nested-root route, though. Does that seem like a bug?"><y>#</y><d>2017-05-25</d><h>18:15</h><w>cap10morgan</w><a>@mtnygard</a> When I tried this, I found that the repeated &quot;/&quot; at the root of my nested routes caused a double <code>//</code> to be required in the URL for the route to match more deeply-nested routes in the table (using the linear-search router). It did match that nested-root route, though. Does that seem like a bug?</z><z id="t1495736197" t="cap10morgan And I&apos;ll add, print-routes only shows one / separating those path components, so at least that part of the system seems to consolidate them."><y>#</y><d>2017-05-25</d><h>18:16</h><w>cap10morgan</w>And I&apos;ll add, <code>print-routes</code> only shows one <code>/</code> separating those path components, so at least that part of the system seems to consolidate them.</z><z id="t1495736226" t="cap10morgan this is with 0.5.2"><y>#</y><d>2017-05-25</d><h>18:17</h><w>cap10morgan</w>this is with 0.5.2</z><z id="t1495808740" t="jfntn Is there an existing benchmark that would exercise write-body-async in the servlet-interceptor ? https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L101"><y>#</y><d>2017-05-26</d><h>14:25</h><w>jfntn</w>Is there an existing benchmark that would exercise <code>write-body-async</code> in the <code>servlet-interceptor</code> ?<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L101" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L101</a></z><z id="t1495808779" t="souenzzo where I find &quot;stage&quot; on context-map?"><y>#</y><d>2017-05-26</d><h>14:26</h><w>souenzzo</w>where I find &quot;stage&quot; on context-map?</z><z id="t1495808855" t="jfntn Was thinking of addressing some of the problems pointed out in https://github.com/pedestal/pedestal/issues/497 but I don’t know if there are existing benchmarks that could help measure before and after"><y>#</y><d>2017-05-26</d><h>14:27</h><w>jfntn</w>Was thinking of addressing some of the problems pointed out in <a href="https://github.com/pedestal/pedestal/issues/497" target="_blank">https://github.com/pedestal/pedestal/issues/497</a> but I don’t know if there are existing benchmarks that could help measure before and after</z><z id="t1495835768" t="jfntn We’re using the service-fn during tests but we’re still starting the server, is it possible to just bypass that?"><y>#</y><d>2017-05-26</d><h>21:56</h><w>jfntn</w>We’re using the service-fn during tests but we’re still starting the server, is it possible to just bypass that?</z><z id="t1496004242" t="ddeaguiar jfntn: Don’t call start on the created server. If you’re using component you can conditionally call start based on a setting or pass in start/stop fns during component creation. An example of the later can be found here: https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L87 ."><y>#</y><d>2017-05-28</d><h>20:44</h><r>ddeaguiar</r>jfntn: Don’t call <code>start</code> on the created server. If you’re using component you can conditionally call start based on a setting or pass in start/stop fns during component creation. An example of the later can be found here: <a href="https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L87" target="_blank">https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L87</a>.</z><z id="t1496004300" t="ddeaguiar I used to be a stickler about this but I’ve become less so as of late. Now I just let the server start up using a random port."><y>#</y><d>2017-05-28</d><h>20:45</h><r>ddeaguiar</r>I used to be a stickler about this but I’ve become less so as of late. Now I just let the server start up using a random port.</z><z id="t1495861789" t="bradford How do I disable secure headers? This doesn’t seem to work: (def service {:env :prod ::http/enable-csrf nil ::http/secure-headers nil ::http/allowed-origins {:creds true :allowed-origins (constantly true)} ::http/routes routes ;; Root for resource interceptor that is available by default. ::http/resource-path &quot;/public&quot; ;; Either :jetty or :tomcat (see comments in project.clj ;; to enable Tomcat) ::http/type :jetty ::http/port 8080})"><y>#</y><d>2017-05-27</d><h>05:09</h><w>bradford</w>How do I disable secure headers? This doesn’t seem to work: <pre>(def service {:env :prod
              ::http/enable-csrf nil
              ::http/secure-headers nil
              ::http/allowed-origins {:creds true :allowed-origins (constantly true)}
              ::http/routes routes
              ;; Root for resource interceptor that is available by default.
              ::http/resource-path &quot;/public&quot;
              ;; Either :jetty or :tomcat (see comments in project.clj
              ;; to enable Tomcat)
              ::http/type :jetty
              ::http/port 8080})</pre></z><z id="t1496004751" t="ddeaguiar bradford: That doesn’t work because of this https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L233 . I think your best bet is to pass in options that configure the the security headers to be less restrictive. Refer to https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L258 and https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/secure_headers.clj#L161 ."><y>#</y><d>2017-05-28</d><h>20:52</h><r>ddeaguiar</r>bradford: That doesn’t work because of this <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L233" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L233</a>. I think your best bet is to pass in options that configure the the security headers to be less restrictive. Refer to <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L258" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L258</a> and <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/secure_headers.clj#L161" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/secure_headers.clj#L161</a>.</z><z id="t1495896172" t="lilactown so I&apos;ve created a new project with the lein template, and fired up the repl with lein repl , (def serv (run-dev)) . when I make a change to server.clj, my repl isn&apos;t reloading the source."><y>#</y><d>2017-05-27</d><h>14:42</h><w>lilactown</w>so I&apos;ve created a new project with the lein template, and fired up the repl with <code>lein repl</code>, <code>(def serv (run-dev))</code>. when I make a change to server.clj, my repl isn&apos;t reloading the source.</z><z id="t1495896190" t="lilactown i&apos;m following this guide: http://pedestal.io/guides/developing-at-the-repl"><y>#</y><d>2017-05-27</d><h>14:43</h><w>lilactown</w>i&apos;m following this guide: <a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a></z><z id="t1495898598" t="lilactown OK, so I need to (require &apos;my-namespace.server :reload) . that command should be in the docs"><y>#</y><d>2017-05-27</d><h>15:23</h><w>lilactown</w>OK, so I need to <code>(require &apos;my-namespace.server :reload)</code>. that command should be in the docs</z><z id="t1496071731" t="bherrmann Humm. I’d like to add a library at start time …. is there a way to do that?"><y>#</y><d>2017-05-29</d><h>15:28</h><w>bherrmann</w>Humm.   I’d like to add a library at start time ….  is there a way to do that?</z><z id="t1496071765" t="bherrmann java -classpath mylib.jar -jar myproject.jar"><y>#</y><d>2017-05-29</d><h>15:29</h><w>bherrmann</w>java -classpath mylib.jar -jar myproject.jar</z><z id="t1496071790" t="bherrmann thats not effective, I assume it is because the internal Jetty thing uses its own classloader and ignores the JVM classloader"><y>#</y><d>2017-05-29</d><h>15:29</h><w>bherrmann</w>thats not effective, I assume it is because the internal Jetty thing uses its own classloader and ignores the JVM classloader</z><z id="t1496098050" t="mtnygard [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] According to the man page for ‘java’: &gt;When you use this option, the JAR file is the source of all user classes, and other user class path settings are ignored."><y>#</y><d>2017-05-29</d><h>22:47</h><w>mtnygard</w><a>@bherrmann</a> According to the man page for ‘java’:

&gt;When you use this option, the JAR file is the source of all user classes, and other user class path settings are ignored.</z><z id="t1496098058" t="mtnygard For -jar"><y>#</y><d>2017-05-29</d><h>22:47</h><w>mtnygard</w>For -jar</z><z id="t1496098092" t="mtnygard So you might get results by putting both jars in -classpath and using your main class as the argument"><y>#</y><d>2017-05-29</d><h>22:48</h><w>mtnygard</w>So you might get results by putting both jars in -classpath and using your main class as the argument</z><z id="t1496103081" t="bherrmann [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks, that hit the nail on the head!"><y>#</y><d>2017-05-30</d><h>00:11</h><w>bherrmann</w><a>@mtnygard</a> Thanks, that hit the nail on the head!</z><z id="t1496103177" t="bherrmann The mylib.jar is actually oracles jdbc library… which they are a pita about not sharing via maven central… so I have to include out of band instructions for oracle users."><y>#</y><d>2017-05-30</d><h>00:12</h><w>bherrmann</w>The mylib.jar is actually oracles jdbc library… which they are a pita about not sharing via maven central… so I have to include out of band instructions for oracle users.</z><z id="t1496169246" t="lellis Hi all! Its possible to use Interceptor in websocket route?"><y>#</y><d>2017-05-30</d><h>18:34</h><w>lellis</w>Hi all! Its possible to use Interceptor in websocket route?</z><z id="t1496169418" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U1E404MAR&quot;}] . You might find https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets helpful."><y>#</y><d>2017-05-30</d><h>18:36</h><w>mtnygard</w>Hi <a>@lellis</a>. You might find <a href="https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets</a> helpful.</z><z id="t1496169495" t="mtnygard You can use interceptors directly by calling http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-execute with a context that you devise."><y>#</y><d>2017-05-30</d><h>18:38</h><w>mtnygard</w>You can use interceptors directly by calling <a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-execute" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-execute</a> with a context that you devise.</z><z id="t1496169755" t="lellis Nice! Ty [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] !"><y>#</y><d>2017-05-30</d><h>18:42</h><w>lellis</w>Nice! Ty <a>@mtnygard</a> !</z><z id="t1496182212" t="pedroteixeira hello, is there some way to pass :allow-symlinks? to the interceptor that already serves files from sources ::http/resource-path ?"><y>#</y><d>2017-05-30</d><h>22:10</h><w>pedroteixeira</w>hello, is there some way to pass <code>:allow-symlinks?</code> to the interceptor that already serves files from sources <code>::http/resource-path</code> ?</z><z id="t1496182253" t="mtnygard Let me look into that [:attrs {:href &quot;/_/_/users/U4WKQ1W8Y&quot;}] ."><y>#</y><d>2017-05-30</d><h>22:10</h><w>mtnygard</w>Let me look into that  <a>@pedroteixeira</a>.</z><z id="t1496182380" t="pedroteixeira thanks, really appreaciated - don&apos;t know yet where to look this up in the code"><y>#</y><d>2017-05-30</d><h>22:13</h><w>pedroteixeira</w>thanks, really appreaciated - don&apos;t know yet where to look this up in the code</z><z id="t1496182406" t="mtnygard np."><y>#</y><d>2017-05-30</d><h>22:13</h><w>mtnygard</w>np.</z><z id="t1496182442" t="pedroteixeira I&apos;m not sure if I should create a new interceptor for this case"><y>#</y><d>2017-05-30</d><h>22:14</h><w>pedroteixeira</w>I&apos;m not sure if I should create a new interceptor for this case</z><z id="t1496182483" t="mtnygard The interceptor supports it if you call io.pedestal.http.ring-middlewares/fast-resource directly like this: (middlewares/fast-resource &quot;public&quot; {:follow-symlinks? true}) "><y>#</y><d>2017-05-30</d><h>22:14</h><w>mtnygard</w>The interceptor supports it if you call <code>io.pedestal.http.ring-middlewares/fast-resource</code> directly like this:

<pre>(middlewares/fast-resource &quot;public&quot; {:follow-symlinks? true})
</pre></z><z id="t1496182493" t="mtnygard That will return you the interceptor you want."><y>#</y><d>2017-05-30</d><h>22:14</h><w>mtnygard</w>That will return you the interceptor you want.</z><z id="t1496182504" t="mtnygard The second part is to use that instead of the default resource interceptor."><y>#</y><d>2017-05-30</d><h>22:15</h><w>mtnygard</w>The second part is to use that instead of the default resource interceptor.</z><z id="t1496182589" t="mtnygard So I suggest: 1. Leave ::http/resource as nil in your service map. 2. Construct your own interceptor. 3. Call io.pedestal.http/default-interceptors to construct the default interceptor stack. (This is normally done by create-server ) 4. Conj your interceptor into the defaults. 5. Start the server."><y>#</y><d>2017-05-30</d><h>22:16</h><w>mtnygard</w>So I suggest:
1. Leave <code>::http/resource</code> as nil in your service map.
2. Construct your own interceptor.
3. Call <code>io.pedestal.http/default-interceptors</code> to construct the default interceptor stack. (This is normally done by <code>create-server</code>)
4. Conj your interceptor into the defaults.
5. Start the server.</z><z id="t1496182611" t="mtnygard It&apos;ll probably take less than 5 lines of code. 🙂"><y>#</y><d>2017-05-30</d><h>22:16</h><w>mtnygard</w>It&apos;ll probably take less than 5 lines of code. <b>🙂</b></z><z id="t1496184651" t="souenzzo There is a standard way to use Edn on query string?"><y>#</y><d>2017-05-30</d><h>22:50</h><w>souenzzo</w>There is a standard way to use Edn on query string?</z><z id="t1496184682" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] What would be an example of such a query string?"><y>#</y><d>2017-05-30</d><h>22:51</h><w>mtnygard</w><a>@souenzzo</a> What would be an example of such a query string?</z><z id="t1496234625" t="souenzzo mtnygard: I want for example, send and UUID on query string."><y>#</y><d>2017-05-31</d><h>12:43</h><r>souenzzo</r>mtnygard: I want for example, send and UUID on query string.</z><z id="t1496267885" t="mtnygard The parameter will always arrive as a string. But you could run it through clojure.tools.reader.edn/read-string . If you wanted to do this in general, you could write an interceptor that parsed a set of query parameters (provided at construction time)."><y>#</y><d>2017-05-31</d><h>21:58</h><r>mtnygard</r>The parameter will always arrive as a string. But you could run it through <code>clojure.tools.reader.edn/read-string</code>. If you wanted to do this in general, you could write an interceptor that parsed a set of query parameters (provided at construction time).</z><z id="t1496409178" t="souenzzo So, &quot;bar&quot;} ... Obviously with attention to URL encode I&apos;m unsure if there was some default interceptor already."><y>#</y><d>2017-06-02</d><h>13:12</h><r>souenzzo</r>So, <code> &quot;bar&quot;}</code>... Obviously with attention to URL encode
I&apos;m unsure if there was some default interceptor already.</z><z id="t1496409307" t="souenzzo for path-params . may be a thing? Then I read-string on all values. It sounds like a good idea?"><y>#</y><d>2017-06-02</d><h>13:15</h><r>souenzzo</r>for <code>path-params</code>. <code></code> may be a thing? Then I <code>read-string</code> on all values. It sounds like a good idea?</z><z id="t1496186819" t="pedroteixeira [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] trying something along the lines, can you shed some light? (http/create-server (update (http/default-interceptors service-map) ::http/interceptors #(conj % (ring-middlewares/fast-resource &quot;public&quot; {:follow-symlinks? true})))) I got the code from the guide on the side that used defrecord Pedestal"><y>#</y><d>2017-05-30</d><h>23:26</h><w>pedroteixeira</w><a>@mtnygard</a> trying something along the lines, can you shed some light? <pre>(http/create-server 
   (update
     (http/default-interceptors service-map)
      ::http/interceptors
       #(conj % (ring-middlewares/fast-resource &quot;public&quot; {:follow-symlinks? true}))))
 </pre> I got the code from the guide on the side that used <code>defrecord Pedestal</code></z><z id="t1496186892" t="mtnygard Looks reasonable. Is it working?"><y>#</y><d>2017-05-30</d><h>23:28</h><w>mtnygard</w>Looks reasonable. Is it working?</z><z id="t1496186910" t="pedroteixeira I think I got something wrong cause getting exception java.nio.file.StandardOpenOption cannot be cast to [Ljava.nio.file.OpenOption_ for any GET"><y>#</y><d>2017-05-30</d><h>23:28</h><w>pedroteixeira</w>I think I got something wrong cause getting exception java.nio.file.StandardOpenOption cannot be cast to [Ljava.nio.file.OpenOption_ for any GET</z><z id="t1496186949" t="mtnygard That looks like a bug in the interceptor itself. "><y>#</y><d>2017-05-30</d><h>23:29</h><w>mtnygard</w>That looks like a bug in the interceptor itself. </z><z id="t1496186951" t="pedroteixeira I was looking for examples in ways to conj an interceptor into the default ones"><y>#</y><d>2017-05-30</d><h>23:29</h><w>pedroteixeira</w>I was looking for examples in ways to conj an interceptor into the default ones</z><z id="t1496186961" t="mtnygard Are you using Jetty?"><y>#</y><d>2017-05-30</d><h>23:29</h><w>mtnygard</w>Are you using Jetty?</z><z id="t1496186982" t="pedroteixeira yes - is it the preferred/easy option?"><y>#</y><d>2017-05-30</d><h>23:29</h><w>pedroteixeira</w>yes - is it the preferred/easy option?</z><z id="t1496187011" t="mtnygard Yes it is"><y>#</y><d>2017-05-30</d><h>23:30</h><w>mtnygard</w>Yes it is</z><z id="t1496187044" t="mtnygard The exception says that someone is passing a single OpenOption where the API requires an array of them. "><y>#</y><d>2017-05-30</d><h>23:30</h><w>mtnygard</w>The exception says that someone is passing a single OpenOption where the API requires an array of them. </z><z id="t1496187052" t="mtnygard That&apos;s not something you did. "><y>#</y><d>2017-05-30</d><h>23:30</h><w>mtnygard</w>That&apos;s not something you did. </z><z id="t1496187072" t="mtnygard It&apos;s probably a problem in the fast interceptor."><y>#</y><d>2017-05-30</d><h>23:31</h><w>mtnygard</w>It&apos;s probably a problem in the fast interceptor.</z><z id="t1496187164" t="mtnygard I&apos;m at dinner now but can take a look in about an hour. "><y>#</y><d>2017-05-30</d><h>23:32</h><w>mtnygard</w>I&apos;m at dinner now but can take a look in about an hour. </z><z id="t1496187186" t="pedroteixeira is there an easy way to use ring.util.response/resource-response as the interceptor?"><y>#</y><d>2017-05-30</d><h>23:33</h><w>pedroteixeira</w>is there an easy way to use <code>ring.util.response/resource-response</code> as the interceptor?</z><z id="t1496187202" t="pedroteixeira I see on the default interceptors, it is used instead of the fast-response"><y>#</y><d>2017-05-30</d><h>23:33</h><w>pedroteixeira</w>I see on the default interceptors, it is used instead of the fast-response</z><z id="t1496187211" t="mtnygard Yes, but it doesn&apos;t have the follow-symlinks option. "><y>#</y><d>2017-05-30</d><h>23:33</h><w>mtnygard</w>Yes, but it doesn&apos;t have the follow-symlinks option. </z><z id="t1496187255" t="pedroteixeira the ring version recently added it, I can see it on the source it now has one &gt; https://github.com/ring-clojure/ring/blob/ecf06c142ee4195756f94b780c238f3a917b3b8d/ring-core/src/ring/util/response.clj#L318"><y>#</y><d>2017-05-30</d><h>23:34</h><w>pedroteixeira</w>the ring version recently added it, I can see it on the source it now has one &gt; <a href="https://github.com/ring-clojure/ring/blob/ecf06c142ee4195756f94b780c238f3a917b3b8d/ring-core/src/ring/util/response.clj#L318" target="_blank">https://github.com/ring-clojure/ring/blob/ecf06c142ee4195756f94b780c238f3a917b3b8d/ring-core/src/ring/util/response.clj#L318</a></z><z id="t1496187359" t="mtnygard Ah, ok. I can help in a while. Or in the meantime you could copy the function that builds the regular resource interceptor. (Right above fast-resource) and modify it to use the new middleware. "><y>#</y><d>2017-05-30</d><h>23:35</h><w>mtnygard</w>Ah, ok. I can help in a while. Or in the meantime you could copy the function that builds the regular resource interceptor. (Right above fast-resource) and modify it to use the new middleware. </z><z id="t1496187431" t="pedroteixeira ok thanks for the help 👍 - I will try copying the resource/resource-request to add the new arg, if there is a better way, let me know"><y>#</y><d>2017-05-30</d><h>23:37</h><w>pedroteixeira</w>ok thanks for the help <b>👍</b> - I will try copying the <code>resource/resource-request</code> to add the new arg, if there is a better way, let me know</z><z id="t1496188502" t="pedroteixeira it worked fine but had to copy to include support for the new arg (defn resource-request &quot;If request matches a static resource, returns it in a response map. Otherwise returns nil.&quot; {:added &quot;1.2&quot;} [request root-path &amp; [{:keys [loader]}]] (if (#{:head :get} (:request-method request)) (let [path (subs (codec/url-decode (request/path-info request)) 1)] (-&gt; (response/resource-response path {:root root-path :loader loader :allow-symlinks? true}) (head/head-response request))))) "><y>#</y><d>2017-05-30</d><h>23:55</h><w>pedroteixeira</w>it worked fine but had to copy to include support for the new arg <pre>(defn resource-request
  &quot;If request matches a static resource, returns it in a response map.
  Otherwise returns nil.&quot;
  {:added &quot;1.2&quot;}
  [request root-path &amp; [{:keys [loader]}]]
  (if (#{:head :get} (:request-method request))
    (let [path (subs (codec/url-decode (request/path-info request)) 1)]
      (-&gt; (response/resource-response path {:root root-path :loader loader :allow-symlinks? true})
          (head/head-response request))))) </pre></z><z id="t1496696147" t="jfntn What’s the expand-routes syntax for a catch-all on the path?"><y>#</y><d>2017-06-05</d><h>20:55</h><w>jfntn</w>What’s the <code>expand-routes</code> syntax for a catch-all on the path?</z><z id="t1496782091" t="mike_ananev [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] hi! have some troubles with io.pedestal.log.I have custom StatsD reporter and i want to init default-recorder. As mentioned in doc&apos;s I set JVM var to &quot;-Dio.pedestal.log.defaultMetricsRecorder=verita.util.metrics/rc&quot;"><y>#</y><d>2017-06-06</d><h>20:48</h><w>mike_ananev</w><a>@mtnygard</a> hi! have some troubles with io.pedestal.log.I have custom StatsD reporter and i want to init default-recorder. As mentioned in doc&apos;s I set JVM var to &quot;-Dio.pedestal.log.defaultMetricsRecorder=verita.util.metrics/rc&quot;</z><z id="t1496782126" t="mike_ananev where rc is 0-arity fn which returns custom-recorder var"><y>#</y><d>2017-06-06</d><h>20:48</h><w>mike_ananev</w>where rc is 0-arity fn which returns custom-recorder var</z><z id="t1496782160" t="mike_ananev during repl start i&apos;ve got stacktrace"><y>#</y><d>2017-06-06</d><h>20:49</h><w>mike_ananev</w>during repl start i&apos;ve got stacktrace</z><z id="t1496782245" t="mike_ananev I can resolve ((resolve (symbol &quot;verita.util.metrics/rc&quot;)))"><y>#</y><d>2017-06-06</d><h>20:50</h><w>mike_ananev</w>I can resolve ((resolve (symbol &quot;verita.util.metrics/rc&quot;)))</z><z id="t1496782276" t="mike_ananev in other repl without init of io.pedestal.log.defaultMetricsRecorder and it returns MetricsRegistry object"><y>#</y><d>2017-06-06</d><h>20:51</h><w>mike_ananev</w>in other repl without init of io.pedestal.log.defaultMetricsRecorder and it returns MetricsRegistry object</z><z id="t1496782369" t="mike_ananev but if init, then code ((resolve (symbol ns-fn-str)))) in default-recorder is crushed"><y>#</y><d>2017-06-06</d><h>20:52</h><w>mike_ananev</w>but if init, then code  ((resolve (symbol ns-fn-str)))) in default-recorder is crushed</z><z id="t1496782580" t="mike_ananev in this example https://github.com/pedestal/pedestal/blob/master/samples/helloworld-metrics/src/helloworld_metrics/service.clj i can&apos;t find the place where io.pedestal.log.defaultMetricsRecorder is inited"><y>#</y><d>2017-06-06</d><h>20:56</h><w>mike_ananev</w>in this example <a href="https://github.com/pedestal/pedestal/blob/master/samples/helloworld-metrics/src/helloworld_metrics/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/helloworld-metrics/src/helloworld_metrics/service.clj</a> i can&apos;t find the place where io.pedestal.log.defaultMetricsRecorder is inited</z><z id="t1496949357" t="v3ga does anyone have any medium sized pedestal apps that run on top of boot?"><y>#</y><d>2017-06-08</d><h>19:15</h><w>v3ga</w>does anyone have any medium sized pedestal apps that run on top of boot?</z><z id="t1497040227" t="lxsameer hey guys, does pedestal&apos;s router supports bidirectional route resolving ? for example, can I get the url related to a specific function ?"><y>#</y><d>2017-06-09</d><h>20:30</h><w>lxsameer</w>hey guys, does pedestal&apos;s router supports bidirectional route resolving ? for example, can I get the url related to a specific function ?</z><z id="t1497041687" t="ddeaguiar @Ixsameer the handler name is used as the route name by default. This can be overridden by specifying :route-name"><y>#</y><d>2017-06-09</d><h>20:54</h><w>ddeaguiar</w>@Ixsameer the handler name is used as the route name by default. This can be overridden by specifying <code>:route-name</code></z><z id="t1497041749" t="ddeaguiar this allows you to get the url for a handler via url-for"><y>#</y><d>2017-06-09</d><h>20:55</h><w>ddeaguiar</w>this allows you to get the url for a handler via <code>url-for</code></z><z id="t1497046390" t="lxsameer thanks"><y>#</y><d>2017-06-09</d><h>22:13</h><w>lxsameer</w>thanks</z><z id="t1497131181" t="lxsameer is it ok to use components with pedestal ? or the better approach is to convert them to interceptors ?"><y>#</y><d>2017-06-10</d><h>21:46</h><w>lxsameer</w>is it ok to use components with pedestal ? or the better approach is to convert them to interceptors ?</z><z id="t1497210458" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] , if you are referring to the Stuart Sierra Component library then yes, it’s perfectly acceptable to use that with Pedestal. Refer to http://pedestal.io/guides/pedestal-with-component for details."><y>#</y><d>2017-06-11</d><h>19:47</h><w>ddeaguiar</w><a>@lxsameer</a>, if you are referring to the Stuart Sierra Component library then yes, it’s perfectly acceptable to use that with Pedestal. Refer to <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a> for details.</z><z id="t1497214205" t="lxsameer thanks"><y>#</y><d>2017-06-11</d><h>20:50</h><w>lxsameer</w>thanks</z><z id="t1497469006" t="bradford Hey, I&apos;m seeing really strange behavior from SSE channels. The time it takes for something to go from SSE-&gt;Client increases linerally with the heartbeat interval. For instance, a message will take 2 seconds, then 4, then 6, then 8... etc indefinitely. I invoke my stream with (sse/start-event-stream sse-stream-ready 1 (async/sliding-buffer 4) {:on-client-disconnect close-conn}) and put data into it with (defn add-work-item [request ip] (async/put! event-ch {:name &quot;request&quot; :data (generate-string request)} ))"><y>#</y><d>2017-06-14</d><h>19:36</h><w>bradford</w>Hey, I&apos;m seeing really strange behavior from SSE channels. The time it takes for something to go from SSE-&gt;Client increases linerally with the heartbeat interval. For instance, a message will take 2 seconds, then 4, then 6, then 8... etc indefinitely. I invoke my stream with <pre>(sse/start-event-stream sse-stream-ready 1 (async/sliding-buffer 4) {:on-client-disconnect close-conn})</pre> and put data into it with <pre>(defn add-work-item [request ip]
  (async/put! event-ch {:name &quot;request&quot; :data (generate-string request)} ))</pre></z><z id="t1497469130" t="bradford This is sending 1-2 message at a time."><y>#</y><d>2017-06-14</d><h>19:38</h><w>bradford</w>This is sending 1-2 message at a time.</z><z id="t1497469170" t="bradford Increasing the buffer size does not help."><y>#</y><d>2017-06-14</d><h>19:39</h><w>bradford</w>Increasing the buffer size does not help.</z><z id="t1497469341" t="bradford I can verify the &apos;put&apos; completes (it executes the fn1 when I add one), but &apos;flushing&apos; the buffer to the client seems to be delayed?"><y>#</y><d>2017-06-14</d><h>19:42</h><w>bradford</w>I can verify the &apos;put&apos; completes (it executes the fn1 when I add one), but &apos;flushing&apos; the buffer to the client seems to be delayed?</z><z id="t1497471272" t="ddeaguiar Hrm, [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] I can’t explain that behavior. I’m curious as to why but won’t be able to look into it any time soon 😞 . I think you should reach out in the pedestal user group as well."><y>#</y><d>2017-06-14</d><h>20:14</h><w>ddeaguiar</w>Hrm, <a>@bradford</a> I can’t explain that behavior. I’m curious as to why but won’t be able to look into it any time soon <b>😞</b>. I think you should reach out in the pedestal user group as well.</z><z id="t1497471317" t="bradford Is the Pedestal SSE implementation such that data is only sent with heartbeats? Or is it continuous?"><y>#</y><d>2017-06-14</d><h>20:15</h><w>bradford</w>Is the Pedestal SSE implementation such that data is only sent with heartbeats? Or is it continuous?</z><z id="t1497471325" t="bradford I&apos;m trying to read the code but I&apos;m not quite sure"><y>#</y><d>2017-06-14</d><h>20:15</h><w>bradford</w>I&apos;m trying to read the code but I&apos;m not quite sure</z><z id="t1497471815" t="ddeaguiar IIRC, the heartbeats are intended to keep the connection alive but it’s been a while since I’ve looked at that code"><y>#</y><d>2017-06-14</d><h>20:23</h><w>ddeaguiar</w>IIRC, the heartbeats are intended to keep the connection alive but it’s been a while since I’ve looked at that code</z><z id="t1497557561" t="jfntn I’m looking at the gzip sample for jetty and wondering if there are similar examples for immutant?"><y>#</y><d>2017-06-15</d><h>20:12</h><w>jfntn</w>I’m looking at the gzip sample for jetty and wondering if there are similar examples for immutant?</z><z id="t1497557870" t="ddeaguiar not that I’m aware of"><y>#</y><d>2017-06-15</d><h>20:17</h><w>ddeaguiar</w>not that I’m aware of</z><z id="t1497558314" t="jfntn [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] hmm would it be a bad idea to handle the codec in an interceptor as opposed to the servlet container in the jetty example?"><y>#</y><d>2017-06-15</d><h>20:25</h><w>jfntn</w><a>@ddeaguiar</a> hmm would it be a bad idea to handle the codec in an interceptor as opposed to the servlet container in the jetty example?</z><z id="t1497558950" t="ddeaguiar I can’t think of why that would be a bad idea. I think the idea is to leverage servlet filters when available"><y>#</y><d>2017-06-15</d><h>20:35</h><w>ddeaguiar</w>I can’t think of why that would be a bad idea. I think the idea is to leverage servlet filters when available</z><z id="t1497558980" t="ddeaguiar basically, don’t reinvent the wheel"><y>#</y><d>2017-06-15</d><h>20:36</h><w>ddeaguiar</w>basically, don’t reinvent the wheel</z><z id="t1497559005" t="ddeaguiar but I’m not familiar with Immutant so I don’t know what it provides"><y>#</y><d>2017-06-15</d><h>20:36</h><w>ddeaguiar</w>but I’m not familiar with Immutant so I don’t know what it provides</z><z id="t1497559347" t="ddeaguiar But it looks like Undertow has a Gzip handler. not sure how that would be wired in but I bet it’s a variation of what’s done for jetty"><y>#</y><d>2017-06-15</d><h>20:42</h><w>ddeaguiar</w>But it looks like Undertow has a Gzip handler. not sure how that would be wired in but I bet it’s a variation of what’s done for jetty</z><z id="t1497559462" t="jfntn I’m just not familiar with the container model, so I was wondering if there would be downsides to doing the work “in” the handler rather than using the container, esp. wrt threading"><y>#</y><d>2017-06-15</d><h>20:44</h><w>jfntn</w>I’m just not familiar with the container model, so I was wondering if there would be downsides to doing the work “in” the handler rather than using the container, esp. wrt threading</z><z id="t1497560084" t="shaun-mahood Has anyone hooked pedestal to Office365 for authentication? Or know any good resources to start looking at?"><y>#</y><d>2017-06-15</d><h>20:54</h><w>shaun-mahood</w>Has anyone hooked pedestal to Office365 for authentication? Or know any good resources to start looking at?</z><z id="t1497560429" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] no experience with Office365 but here are the auth/authz libs I recommend looking into https://github.com/propan/geheimtur and https://github.com/funcool/buddy"><y>#</y><d>2017-06-15</d><h>21:00</h><w>ddeaguiar</w><a>@shaun-mahood</a> no experience with Office365 but here are the auth/authz libs I recommend looking into <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a> and <a href="https://github.com/funcool/buddy" target="_blank">https://github.com/funcool/buddy</a></z><z id="t1497560461" t="ddeaguiar here’s a demo of geheimtur: https://github.com/propan/geheimtur-demo"><y>#</y><d>2017-06-15</d><h>21:01</h><w>ddeaguiar</w>here’s a demo of geheimtur: <a href="https://github.com/propan/geheimtur-demo" target="_blank">https://github.com/propan/geheimtur-demo</a></z><z id="t1497560529" t="ddeaguiar and here’s a PR that’s in review which demonstrates Pedestal + Buddy integration: https://github.com/pedestal/pedestal/pull/503"><y>#</y><d>2017-06-15</d><h>21:02</h><w>ddeaguiar</w>and here’s a PR that’s in review which demonstrates Pedestal + Buddy integration: <a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a></z><z id="t1497560620" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] : great, thanks - I&apos;ve tried buddy in the past but I don&apos;t think I&apos;m smart enough, great to know geheintur is a valid option - I found a half-dozen libraries that look like they are no longer maintained and really don&apos;t like picking poorly for security libraries :)"><y>#</y><d>2017-06-15</d><h>21:03</h><w>shaun-mahood</w><a>@ddeaguiar</a>: great, thanks - I&apos;ve tried buddy in the past but I don&apos;t think I&apos;m smart enough, great to know geheintur is a valid option - I found a half-dozen libraries that look like they are no longer maintained and really don&apos;t like picking poorly for security libraries :)</z><z id="t1497560820" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] I’ve used both and I currently prefer Buddy because it’s quite flexible"><y>#</y><d>2017-06-15</d><h>21:07</h><w>ddeaguiar</w><a>@shaun-mahood</a> I’ve used both and I currently prefer Buddy because it’s quite flexible</z><z id="t1497560826" t="ddeaguiar but it requires more setup"><y>#</y><d>2017-06-15</d><h>21:07</h><w>ddeaguiar</w>but it requires more setup</z><z id="t1497560855" t="ddeaguiar well flexible is not the right word"><y>#</y><d>2017-06-15</d><h>21:07</h><w>ddeaguiar</w>well flexible is not the right word</z><z id="t1497560865" t="ddeaguiar it just provides more utilities"><y>#</y><d>2017-06-15</d><h>21:07</h><w>ddeaguiar</w>it just provides more utilities</z><z id="t1497560869" t="ddeaguiar both are flexible"><y>#</y><d>2017-06-15</d><h>21:07</h><w>ddeaguiar</w>both are flexible</z><z id="t1497560882" t="ddeaguiar either should work for you"><y>#</y><d>2017-06-15</d><h>21:08</h><w>ddeaguiar</w>either should work for you</z><z id="t1497561122" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] : Well, I think that PR will help a lot, so thanks for that! For whatever reason securing web apps is one of those things that I always have trouble with. I&apos;ve ended up leaving a bunch of stuff in older systems when I really want it in Clojure."><y>#</y><d>2017-06-15</d><h>21:12</h><w>shaun-mahood</w><a>@ddeaguiar</a>: Well, I think that PR will help a lot, so thanks for that! For whatever reason securing web apps is one of those things that I always have trouble with. I&apos;ve ended up leaving a bunch of stuff in older systems when I really want it in Clojure.</z><z id="t1497563333" t="ddeaguiar np!"><y>#</y><d>2017-06-15</d><h>21:48</h><w>ddeaguiar</w>np!</z><z id="t1497646161" t="hlship Is there a general strategy for streaming intermittent data that&apos;s compatible with use of interceptors? I&apos;m looking for the best way to handle GraphQL subscriptions, where we want to periodically put a blob of JSON into the response (probably driven by a core.async channel). But at the point where this executes, there&apos;s a couple of other interceptors on the stack that should be involved. Looking at http://pedestal.io/reference/streaming my best bet may be to return a callback function and stream the content, but them I&apos;m duplicating a bunch of logic that (in the normal, non-subscription case) is inside a couple of interceptors .. .things like choosing a status code, and converting from Clojure data to JSON. Thoughts?"><y>#</y><d>2017-06-16</d><h>20:49</h><w>hlship</w>Is there a general strategy for streaming intermittent data that&apos;s compatible with use of interceptors?  I&apos;m looking for the best way to handle GraphQL subscriptions, where we want to periodically put a blob of JSON into the response (probably driven by a core.async channel).  But at the point where this executes, there&apos;s a couple of other interceptors on the stack that should be involved.  Looking at <a href="http://pedestal.io/reference/streaming" target="_blank">http://pedestal.io/reference/streaming</a> my best bet may be to return a callback function and stream the content, but them I&apos;m duplicating a bunch of logic that (in the normal, non-subscription case) is inside a couple of interceptors .. .things like choosing a status code, and converting from Clojure data to JSON.  Thoughts?</z><z id="t1497646215" t="hlship The SSE code would be good, but is not compatible with GraphQL clients, which simply expect the stream of JSON blobs."><y>#</y><d>2017-06-16</d><h>20:50</h><w>hlship</w>The SSE code would be good, but is not compatible with GraphQL clients, which simply expect the stream of JSON blobs.</z><z id="t1497646239" t="hlship And I also would like to know when the client closes the connection, so that we can do some cleanup."><y>#</y><d>2017-06-16</d><h>20:50</h><w>hlship</w>And I also would like to know when the client closes the connection, so that we can do some cleanup.</z><z id="t1497647571" t="hlship Digging deeper ... looks like web sockets are a valid approach for GraphQL subscriptions."><y>#</y><d>2017-06-16</d><h>21:12</h><w>hlship</w>Digging deeper ... looks like web sockets are a valid approach for GraphQL subscriptions.</z><z id="t1497998705" t="mpenet hlship: try to push for the open issue about ws to be fixed (reported in february). Atm it might allow 8 slow ws consumer or producer to exhaust/lock the async go threadpool (blocking IO in async/go blocks issues). Basically a potential DOS issue."><y>#</y><d>2017-06-20</d><h>22:45</h><r>mpenet</r>hlship: try to push for the open issue about ws to be fixed (reported in february). Atm it might allow 8 slow ws consumer or producer to exhaust/lock the async go threadpool (blocking IO in async/go blocks issues). Basically a potential DOS issue.</z><z id="t1497998896" t="mpenet I checked back today and was surprised to see it s still open"><y>#</y><d>2017-06-20</d><h>22:48</h><r>mpenet</r>I checked back today and was surprised to see it s still open</z><z id="t1498000318" t="hlship You mean this? https://github.com/pedestal/pedestal/issues/497"><y>#</y><d>2017-06-20</d><h>23:11</h><r>hlship</r>You mean this? <a href="https://github.com/pedestal/pedestal/issues/497" target="_blank">https://github.com/pedestal/pedestal/issues/497</a></z><z id="t1498025384" t="mpenet Yes"><y>#</y><d>2017-06-21</d><h>06:09</h><r>mpenet</r>Yes</z><z id="t1497998705" t="mpenet hlship: try to push for the open issue about ws to be fixed (reported in february). Atm it might allow 8 slow ws consumer or producer to exhaust/lock the async go threadpool (blocking IO in async/go blocks issues). Basically a potential DOS issue."><y>#</y><d>2017-06-20</d><h>22:45</h><w>mpenet</w>hlship: try to push for the open issue about ws to be fixed (reported in february). Atm it might allow 8 slow ws consumer or producer to exhaust/lock the async go threadpool (blocking IO in async/go blocks issues). Basically a potential DOS issue.</z><z id="t1497698381" t="henrik What’s the correct way of dealing with… Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled. …? ClojureScript seems to make Chrome go into pouty mode."><y>#</y><d>2017-06-17</d><h>11:19</h><w>henrik</w>What’s the correct way of dealing with…
<pre>Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled.</pre>
…?

ClojureScript seems to make Chrome go into pouty mode.</z><z id="t1497698486" t="henrik I assume it’s something to do with all the document.write s in app.js ."><y>#</y><d>2017-06-17</d><h>11:21</h><w>henrik</w>I assume it’s something to do with all the <code>document.write</code>s in <code>app.js</code>.</z><z id="t1497706777" t="jimmy [:attrs {:href &quot;/_/_/users/U06B8J0AJ&quot;}] check this issue https://github.com/pedestal/pedestal/issues/499"><y>#</y><d>2017-06-17</d><h>13:39</h><w>jimmy</w><a>@henrik</a> check this issue <a href="https://github.com/pedestal/pedestal/issues/499" target="_blank">https://github.com/pedestal/pedestal/issues/499</a></z><z id="t1497707124" t="henrik [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] cheers, that actually did it! Though turning it off seems like cheating. Either cljs is compiling into insecure js, or there’s something wonky with how Pedestal is serving the file."><y>#</y><d>2017-06-17</d><h>13:45</h><w>henrik</w><a>@nxqd</a> cheers, that actually did it! Though turning it off seems like cheating. Either cljs is compiling into insecure js, or there’s something wonky with how Pedestal is serving the file.</z><z id="t1497707220" t="jimmy cljs compiles insecure js in normal mode, it shouldn&apos;t have any problem with advanced compiled. You can do a little research about secure header, the default one is too strict in my opinion."><y>#</y><d>2017-06-17</d><h>13:47</h><w>jimmy</w>cljs compiles insecure js in normal mode, it shouldn&apos;t have any problem with advanced compiled. You can do a little research about secure header, the default one is too strict in my opinion.</z><z id="t1497707428" t="henrik Either way, it seems like the Leiningen template could do with an update to fix this for dev mode."><y>#</y><d>2017-06-17</d><h>13:50</h><w>henrik</w>Either way, it seems like the Leiningen template could do with an update to fix this for dev mode.</z><z id="t1497707728" t="jimmy yeah, true"><y>#</y><d>2017-06-17</d><h>13:55</h><w>jimmy</w>yeah, true</z><z id="t1497708861" t="henrik Done."><y>#</y><d>2017-06-17</d><h>14:14</h><w>henrik</w>Done.</z><z id="t1497762889" t="henrik Man, Pedestal is challenging to use."><y>#</y><d>2017-06-18</d><h>05:14</h><w>henrik</w>Man, Pedestal is challenging to use.</z><z id="t1497763967" t="henrik So, why does … (def routes `{&quot;/&quot; {:interceptors [(body-params/body-params) http/html-body] :get home-page}}) … serve the page correctly, while… (def common-interceptors [(body-params/body-params) http/html-body]) (def routes `{&quot;/&quot; {:interceptors common-interceptors :get home-page}}) … generates an exception?"><y>#</y><d>2017-06-18</d><h>05:32</h><w>henrik</w>So, why does …
<pre>(def routes `{&quot;/&quot; {:interceptors [(body-params/body-params) http/html-body]
                   :get home-page}})</pre>
… serve the page correctly, while…
<pre>(def common-interceptors [(body-params/body-params) http/html-body])

(def routes `{&quot;/&quot; {:interceptors common-interceptors
                   :get home-page}})</pre>
… generates an exception?</z><z id="t1497764740" t="henrik (working from the Lein template)"><y>#</y><d>2017-06-18</d><h>05:45</h><w>henrik</w>(working from the Lein template)</z><z id="t1497874937" t="deg [:attrs {:href &quot;/_/_/users/U06B8J0AJ&quot;}] . Looks like you&apos;ve quoted common-interceptors in the second case."><y>#</y><d>2017-06-19</d><h>12:22</h><w>deg</w><a>@henrik</a>.  Looks like you&apos;ve quoted common-interceptors in the second case.</z><z id="t1497877776" t="henrik Oh, right, so now I’ve learned about backtick."><y>#</y><d>2017-06-19</d><h>13:09</h><w>henrik</w>Oh, right, so now I’ve learned about backtick.</z><z id="t1497877828" t="henrik Why are the routes quoted to begin with? I’m working from the leiningen template. https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service"><y>#</y><d>2017-06-19</d><h>13:10</h><w>henrik</w>Why are the routes quoted to begin with? I’m working from the leiningen template. <a href="https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service" target="_blank">https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service</a></z><z id="t1497888962" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06B8J0AJ&quot;}] , I’ve not looked at the impl for map-based routes so I can’t comment on them. My preference is the tabular routing syntax. I find them much easier to grok."><y>#</y><d>2017-06-19</d><h>16:16</h><w>ddeaguiar</w><a>@henrik</a>, I’ve not looked at the impl for map-based routes so I can’t comment on them. My preference is the tabular routing syntax. I find them much easier to grok.</z><z id="t1497890038" t="henrik Fair enough. In the case of tabular routes, the back tick sits on the routing function itself. In the “hello world” guide, there’s no back tick: (def routes (route/expand-routes #{[&quot;/greet&quot; :get respond-hello :route-name :greet]})) In the template, the routing is split between service.clj : ;; Tabular routes (def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/about&quot; :get (conj common-interceptors `about-page)]}) and server.clj : (-&gt; service/service ;; start with production configuration (merge {… ::server/routes #(route/expand-routes (deref #&apos;service/routes)) …}}) What’s the deal with the back-ticks in the first file and the deref in the other? Why are they there and what do they do?"><y>#</y><d>2017-06-19</d><h>16:33</h><w>henrik</w>Fair enough. In the case of tabular routes, the back tick sits on the routing function itself. In the “hello world” guide, there’s no back tick: <pre>(def routes
  (route/expand-routes                                   
   #{[&quot;/greet&quot; :get respond-hello :route-name :greet]}))</pre>

In the template, the routing is split between <code>service.clj</code>:
<pre>;; Tabular routes
(def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)]
              [&quot;/about&quot; :get (conj common-interceptors `about-page)]})</pre>

and <code>server.clj</code>:
<pre>(-&gt; service/service ;; start with production configuration
      (merge {…
              ::server/routes #(route/expand-routes (deref #&apos;service/routes))
              …}})</pre>

What’s the deal with the back-ticks in the first file and the <code>deref</code> in the other? Why are they there and what do they do?</z><z id="t1497890322" t="ddeaguiar The backticks in service.clj lead to fully qualified symbols that get resolved here: https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L49"><y>#</y><d>2017-06-19</d><h>16:38</h><w>ddeaguiar</w>The backticks in <code>service.clj</code> lead to fully qualified symbols that get resolved here: <a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L49" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L49</a></z><z id="t1497890343" t="ddeaguiar The deref allows routes to be reloaded without having to restart the server"><y>#</y><d>2017-06-19</d><h>16:39</h><w>ddeaguiar</w>The <code>deref</code> allows routes to be reloaded without having to restart the server</z><z id="t1497890363" t="ddeaguiar you can make changes and load the service ns again"><y>#</y><d>2017-06-19</d><h>16:39</h><w>ddeaguiar</w>you can make changes and load the service ns again</z><z id="t1498070643" t="jjttjj I&apos;m having a hard time to get a clojurescript frontend working for the vase-component sample app. GET requests work fine, but i&apos;ve tried several different ways to POST a new &quot;pet&quot; to the db without any luck. I can succesfully post to the DB with clj-http, for example with (http/post &quot;&quot; {:form-params {:payload [{:pet-store.pet/id 101 :pet-store.pet/name &quot;harry&quot; :pet-store.pet/tag &quot;harry&apos;s tag&quot; }]} :content-type :json}) But I can&apos;t seem to figure out how to make this work from clojurescript after attempting with jquery and cljs-ajax, attempting to use json and edn. Are there any examples of using vase with clojurescript?"><y>#</y><d>2017-06-21</d><h>18:44</h><w>jjttjj</w>I&apos;m having a hard time to get a clojurescript frontend working for the vase-component sample app. GET requests work fine, but i&apos;ve tried several different ways to POST a new &quot;pet&quot; to the db without any luck. I can succesfully post to the DB with clj-http, for example with <pre>(http/post &quot;&quot;
               {:form-params
                {:payload [{:pet-store.pet/id 101
                            :pet-store.pet/name &quot;harry&quot;
                            :pet-store.pet/tag &quot;harry&apos;s tag&quot;
                                          }]}
                :content-type :json})</pre> But I can&apos;t seem to figure out how to make this work from clojurescript after attempting with jquery and cljs-ajax, attempting to use json and edn. Are there any examples of using vase with clojurescript?</z><z id="t1498070801" t="jjttjj here&apos;s my attempt with cljs-ajax: (ajax/POST &quot;&quot; :params {:payload [{:pet-store.pet/id 102 :pet-store.pet/name &quot;harry&quot; :pet-store.pet/tag &quot;harry&apos;s tag&quot; }]} :format :json ;(ajax-edn/edn-request-format) ;;attempt edn and json formats ) but it results in {whitelist [{}], transaction [[nil nil nil] [nil nil nil] [nil nil nil] [nil nil nil]]}"><y>#</y><d>2017-06-21</d><h>18:46</h><w>jjttjj</w>here&apos;s my attempt with cljs-ajax: <pre>(ajax/POST &quot;&quot;
             :params {:payload [{:pet-store.pet/id   102
                                 :pet-store.pet/name &quot;harry&quot;
                                 :pet-store.pet/tag  &quot;harry&apos;s tag&quot;
                                 }]}
             :format :json ;(ajax-edn/edn-request-format) ;;attempt edn and json formats
             )</pre> but it results in <code>{whitelist [{}], transaction [[nil nil nil] [nil nil nil] [nil nil nil] [nil nil nil]]}</code></z><z id="t1498070963" t="jjttjj OK I actually just got the above example working buy using string keys such as &quot;pet-store.pet/id 102&quot; so that should work for now. Is there something I have to do server-side to accept EDN? The docs seemed to suggest it should automatically be able to accept edn if the content type was correctly set"><y>#</y><d>2017-06-21</d><h>18:49</h><w>jjttjj</w>OK I actually just got the above example working buy using string keys such as <code>&quot;pet-store.pet/id 102&quot;</code> so that should work for now. Is there something I have to do server-side to accept EDN? The docs seemed to suggest it should automatically be able to accept edn if the content type was correctly set</z><z id="t1498075612" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] : I&apos;m working through the guides, and I&apos;m having some difficulty with http://pedestal.io/guides/hello-world-content-types - specifically, how to map the &apos;cond-&gt;&apos; macro portion back to the original version. I&apos;ve never actually needed to use &apos;cond-&gt;&apos; so I&apos;m happy to figure out how it works, but I think it would be worth putting a more beginner friendly version in as an intermediate step - so far it&apos;s been the only real stumbling block I&apos;ve found if I assume it&apos;s geared towards beginners."><y>#</y><d>2017-06-21</d><h>20:06</h><w>shaun-mahood</w><a>@mtnygard</a>: I&apos;m working through the guides, and I&apos;m having some difficulty with <a href="http://pedestal.io/guides/hello-world-content-types" target="_blank">http://pedestal.io/guides/hello-world-content-types</a> - specifically, how to map the &apos;cond-&gt;&apos; macro portion back to the original version. I&apos;ve never actually needed to use &apos;cond-&gt;&apos; so I&apos;m happy to figure out how it works, but I think it would be worth putting a more beginner friendly version in as an intermediate step - so far it&apos;s been the only real stumbling block I&apos;ve found if I assume it&apos;s geared towards beginners.</z><z id="t1498076513" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] : I just opened an issue on the docs site - sorry, I should have done that first!"><y>#</y><d>2017-06-21</d><h>20:21</h><r>shaun-mahood</r><a>@mtnygard</a>: I just opened an issue on the docs site - sorry, I should have done that first!</z><z id="t1498075670" t="lxsameer hey folks, I read somewhere that extending pedestal is easy because everything are protocols , right ? i yes, can you give me an quick example"><y>#</y><d>2017-06-21</d><h>20:07</h><w>lxsameer</w>hey folks, I read somewhere that extending pedestal is easy because everything are protocols , right ? i yes, can you give me an quick example</z><z id="t1498084631" t="shaun-mahood Is there any guidance on when to syntax quote interceptors? Tutorials all go without it, but the lein template uses it."><y>#</y><d>2017-06-21</d><h>22:37</h><w>shaun-mahood</w>Is there any guidance on when to syntax quote interceptors? Tutorials all go without it, but the lein template uses it.</z><z id="t1498138578" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] , I recommend using the tabular route syntax it’s more verbose but easier to grok. With that syntax you will need to syntax quote symbols which refer to your function handlers . Refer to how the IntoInterceptor protocol is extended for rationale ( https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L27 ). The guides also use expand-routes . I don’t recommend doing that in most cases. This issue explains why: https://github.com/pedestal/pedestal-docs/issues/66 ."><y>#</y><d>2017-06-22</d><h>13:36</h><w>ddeaguiar</w><a>@shaun-mahood</a>, I recommend using the tabular route syntax it’s more verbose but easier to grok. With that syntax you will need to syntax quote symbols which refer to your function handlers . Refer to how the IntoInterceptor protocol is extended for rationale (<a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L27" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L27</a>). The guides also use <code>expand-routes</code>. I don’t recommend doing that in most cases. This issue explains why: <a href="https://github.com/pedestal/pedestal-docs/issues/66" target="_blank">https://github.com/pedestal/pedestal-docs/issues/66</a>.</z><z id="t1498146074" t="shaun-mahood ddeaguiar: Thanks for the help, that clears up some of my confusion but I still have a couple questions. I created a gist with them at https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2 Would you mind taking a quick look?"><y>#</y><d>2017-06-22</d><h>15:41</h><r>shaun-mahood</r>ddeaguiar: Thanks for the help, that clears up some of my confusion but I still have a couple questions. I created a gist with them  at <a href="https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2" target="_blank">https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2</a> 
Would you mind taking a quick look?</z><z id="t1498152975" t="ddeaguiar left some comments"><y>#</y><d>2017-06-22</d><h>17:36</h><r>ddeaguiar</r>left some comments</z><z id="t1498155960" t="shaun-mahood Great, thanks - I guess http://pedestal.io/reference/table-syntax#_detailed_reference might just need updating. Any reason you would do things like Example B rather than Example A?"><y>#</y><d>2017-06-22</d><h>18:26</h><r>shaun-mahood</r>Great, thanks - I guess <a href="http://pedestal.io/reference/table-syntax#_detailed_reference" target="_blank">http://pedestal.io/reference/table-syntax#_detailed_reference</a> might just need updating.
Any reason you would do things like Example B rather than Example A?</z><z id="t1498156329" t="ddeaguiar Not that I can think of."><y>#</y><d>2017-06-22</d><h>18:32</h><r>ddeaguiar</r>Not that I can think of.</z><z id="t1498157073" t="shaun-mahood Ok, then at least I&apos;m not missing anything fundamental - thanks for the help!"><y>#</y><d>2017-06-22</d><h>18:44</h><r>shaun-mahood</r>Ok, then at least I&apos;m not missing anything fundamental - thanks for the help!</z><z id="t1498157294" t="ddeaguiar So keep in mind that the ExpandableRoutes protocol has been extended to sets ( https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L360 ) which leads to table/table-routes being called under the covers for you."><y>#</y><d>2017-06-22</d><h>18:48</h><r>ddeaguiar</r>So keep in mind that the <code>ExpandableRoutes</code> protocol has been extended to sets (<a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L360" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L360</a>) which leads to <code>table/table-routes</code> being called under the covers for you.</z><z id="t1498157371" t="ddeaguiar you need to call table/table-routes here ( https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2#file-pedestal-routing-question-clj-L13 ) because you are using a vector. The ExpandableRoutes protocol has been extended to vectors but it assumes the vectors use the terse route syntax"><y>#</y><d>2017-06-22</d><h>18:49</h><r>ddeaguiar</r>you need to call <code>table/table-routes</code> here (<a href="https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2#file-pedestal-routing-question-clj-L13" target="_blank">https://gist.github.com/smahood/d0c8e120a28bd070b739022aeeecfec2#file-pedestal-routing-question-clj-L13</a>) because you are using a vector. The <code>ExpandableRoutes</code> protocol has been extended to vectors but it assumes the vectors use the terse route syntax</z><z id="t1498157397" t="ddeaguiar TBH, I’m not the biggest fan of extending the core data structures in this way. I find it leads to confusion."><y>#</y><d>2017-06-22</d><h>18:49</h><r>ddeaguiar</r>TBH, I’m not the biggest fan of extending the core data structures in this way. I find it leads to confusion.</z><z id="t1498157436" t="ddeaguiar but it is convenient"><y>#</y><d>2017-06-22</d><h>18:50</h><r>ddeaguiar</r>but it is convenient</z><z id="t1498158790" t="shaun-mahood Ahh, that explains things a lot more clearly. Thanks again!"><y>#</y><d>2017-06-22</d><h>19:13</h><r>shaun-mahood</r>Ahh, that explains things a lot more clearly. Thanks again!</z><z id="t1498158806" t="ddeaguiar np 🙂"><y>#</y><d>2017-06-22</d><h>19:13</h><r>ddeaguiar</r>np <b>🙂</b></z><z id="t1498152851" t="mgrbyte Trying to figure out how one would use datomic&apos;s :db.fn/cas in vase; i see that if you can, it&apos;s not via #vase/transact since that will only work with :vase/assert-entity and :vase/retract-entity - can anyone point me in the right direction? thanks!"><y>#</y><d>2017-06-22</d><h>17:34</h><w>mgrbyte</w>Trying to figure out how one would use datomic&apos;s <code>:db.fn/cas</code> in vase; i see that if you can, it&apos;s not via <code>#vase/transact</code> since that will only work with <code>:vase/assert-entity</code> and <code>:vase/retract-entity</code> -  can anyone point me in the right direction? thanks!</z><z id="t1498234153" t="jjttjj Is there a way to use specs defined elsewhere in the vase edn file under :vase/specs ?"><y>#</y><d>2017-06-23</d><h>16:09</h><w>jjttjj</w>Is there a way to use specs defined elsewhere in the vase edn file under <code>:vase/specs</code>?</z><z id="t1498341488" t="lxsameer hey guys, how can I use pedestal&apos;s fast-resource ?"><y>#</y><d>2017-06-24</d><h>21:58</h><w>lxsameer</w>hey guys, how can I use pedestal&apos;s fast-resource ?</z><z id="t1498341516" t="lxsameer and what is the responsiblity of :http/resource-path ?"><y>#</y><d>2017-06-24</d><h>21:58</h><w>lxsameer</w>and what is the responsiblity of :http/resource-path ?</z><z id="t1498353420" t="bherrmann Huh. How do I build a WAR file with a pedestal project?"><y>#</y><d>2017-06-25</d><h>01:17</h><w>bherrmann</w>Huh.  How do I build a WAR file with a pedestal project?</z><z id="t1498353480" t="bherrmann ok, there is a WAR example... https://github.com/pedestal/pedestal/tree/master/samples/war-example"><y>#</y><d>2017-06-25</d><h>01:18</h><w>bherrmann</w>ok, there is a WAR example...  <a href="https://github.com/pedestal/pedestal/tree/master/samples/war-example" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/war-example</a></z><z id="t1498355660" t="bherrmann seems like making a war file is a lot of work... I&apos;m simply dropping back to compojure/ring ... for now"><y>#</y><d>2017-06-25</d><h>01:54</h><w>bherrmann</w>seems like making a war file is a lot of work... I&apos;m simply dropping back to compojure/ring ... for now</z><z id="t1498390194" t="lxsameer pedestal docs suck"><y>#</y><d>2017-06-25</d><h>11:29</h><w>lxsameer</w>pedestal docs suck</z><z id="t1498390524" t="lxsameer does any one knows how should i use fast-resource or even resource to server some static files ? how should the route be like ?"><y>#</y><d>2017-06-25</d><h>11:35</h><w>lxsameer</w>does any one knows how should i use fast-resource or even resource to server some static files ? how should the route be like ?</z><z id="t1498481995" t="mpenet the double :: look fishy"><y>#</y><d>2017-06-26</d><h>12:59</h><w>mpenet</w>the double <b>::</b> look fishy</z><z id="t1498482030" t="mpenet that would be scoped to your current ns, and I guess you (pedestal) wants :http/foo"><y>#</y><d>2017-06-26</d><h>13:00</h><w>mpenet</w>that would be scoped to your current ns, and I guess you (pedestal) wants :http/foo</z><z id="t1498482112" t="mpenet or maybe I am just wrong"><y>#</y><d>2017-06-26</d><h>13:01</h><w>mpenet</w>or maybe I am just wrong</z><z id="t1498515442" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5AEHJL5T&quot;}] did you create the main ns as described here: http://pedestal.io/guides/your-first-api#_setting_up"><y>#</y><d>2017-06-26</d><h>22:17</h><w>ddeaguiar</w><a>@felipe-campos</a> did you create the <code>main</code> ns as described here: <a href="http://pedestal.io/guides/your-first-api#_setting_up" target="_blank">http://pedestal.io/guides/your-first-api#_setting_up</a></z><z id="t1498572293" t="felipe-campos ddeaguiar: yep. but it’s allright, I’ll just check if the server atom is nil before stoppig. thank you!"><y>#</y><d>2017-06-27</d><h>14:04</h><r>felipe-campos</r>ddeaguiar: yep. but it’s allright, I’ll just check if the server atom is nil before stoppig. thank you!</z><z id="t1498569420" t="mgrbyte how to have auto-reloading of edn-resources in dev-mode? (am experimenting w/vase) ?"><y>#</y><d>2017-06-27</d><h>13:17</h><w>mgrbyte</w>how to have auto-reloading of edn-resources in dev-mode? (am experimenting w/vase) ?</z><z id="t1498570044" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] perhaps Pedestal’s service-tools watch impl could help, or at least provide inspiration. https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23"><y>#</y><d>2017-06-27</d><h>13:27</h><w>ddeaguiar</w><a>@mgrbyte</a> perhaps Pedestal’s service-tools <code>watch</code> impl could help, or at least provide inspiration. <a href="https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23</a></z><z id="t1498571231" t="mgrbyte [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks. am not sure it would/does in this case. I&apos;m wondering what the vase dev&apos;s workflow is?"><y>#</y><d>2017-06-27</d><h>13:47</h><w>mgrbyte</w><a>@ddeaguiar</a> thanks. am not sure it would/does in this case. I&apos;m wondering what the vase dev&apos;s workflow is?</z><z id="t1498571509" t="ddeaguiar So I don’t think the workflow is that different that when you work with a traditional Pedestal service. Just reload the service namespace after making any changes to the vase edn file."><y>#</y><d>2017-06-27</d><h>13:51</h><w>ddeaguiar</w>So I don’t think the workflow is that different that when you work with a traditional Pedestal service. Just reload the service namespace after making any changes to the vase edn file.</z><z id="t1498571545" t="ddeaguiar At least as long as you are running your service in dev mode (i.e., via run-dev )"><y>#</y><d>2017-06-27</d><h>13:52</h><w>ddeaguiar</w>At least as long as you are running your service in dev mode (i.e., via <code>run-dev</code>)</z><z id="t1498571750" t="mgrbyte [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] ah ok. I thought I was doing that (and have been using ns-tracker), so must be doing something stupid"><y>#</y><d>2017-06-27</d><h>13:55</h><w>mgrbyte</w><a>@ddeaguiar</a> ah ok. I thought I was doing that (and have been using ns-tracker), so must be doing something stupid</z><z id="t1498571776" t="mgrbyte thank you"><y>#</y><d>2017-06-27</d><h>13:56</h><w>mgrbyte</w>thank you</z><z id="t1498571822" t="ddeaguiar It’s been a while since I’ve worked with Vase so I’ll double check later today as well"><y>#</y><d>2017-06-27</d><h>13:57</h><w>ddeaguiar</w>It’s been a while since I’ve worked with Vase so I’ll double check later today as well</z><z id="t1498572063" t="mgrbyte can you clarify what action you&apos;re thinking of when you say &quot;reload the service namespace&quot; pls. with cider in emacs I do that by re-evaluating the form - not sure what the equiv. is in a regular repl"><y>#</y><d>2017-06-27</d><h>14:01</h><w>mgrbyte</w>can you clarify what action you&apos;re thinking of when you say &quot;reload the service namespace&quot; pls. with cider in emacs I do that by re-evaluating the form - not sure what the equiv. is in a regular repl</z><z id="t1498572750" t="mgrbyte sorry for the silly question, have gotten a v. confused :s"><y>#</y><d>2017-06-27</d><h>14:12</h><w>mgrbyte</w>sorry for the silly question, have gotten a v. confused :s</z><z id="t1498574553" t="mgrbyte [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] In the repl I do: (run-dev) , then (require &apos;[my-app.ns] :reload) after changing the edn resource file - would you expect that to reflect changes? (it doesn&apos;t currently in my setup)"><y>#</y><d>2017-06-27</d><h>14:42</h><w>mgrbyte</w><a>@ddeaguiar</a> In the repl I do:  <code>(run-dev)</code> , then <code>(require &apos;[my-app.ns] :reload)</code> after changing the edn resource file - would you expect that to reflect changes? (it doesn&apos;t currently in my setup)</z><z id="t1498574766" t="ddeaguiar So I’m typically doing this in emacs and use cider-load-buffer after making changes. I don’t recall what that does under the covers"><y>#</y><d>2017-06-27</d><h>14:46</h><w>ddeaguiar</w>So I’m typically doing this in emacs and use <code>cider-load-buffer</code> after making changes. I don’t recall what that does under the covers</z><z id="t1498574792" t="ddeaguiar cider-load-buffer is mapped to C-c C-k for me"><y>#</y><d>2017-06-27</d><h>14:46</h><w>ddeaguiar</w><code>cider-load-buffer</code> is mapped to <code>C-c C-k</code> for me</z><z id="t1498575244" t="mgrbyte I similarly run this in cider connecting (repl runing separately in the terminal). I use cider-eval-buffer will try load instead."><y>#</y><d>2017-06-27</d><h>14:54</h><w>mgrbyte</w>I similarly run this in cider connecting (repl runing separately in the terminal). I use <code>cider-eval-buffer</code> will try load instead.</z><z id="t1498575703" t="mgrbyte so I finally figure out a way. Had missed that run-dev will return the service-map and one can (server/stop service-map) and re-restart"><y>#</y><d>2017-06-27</d><h>15:01</h><w>mgrbyte</w>so I finally figure out a way. Had missed that <code>run-dev</code> will return the service-map and one can <code>(server/stop service-map)</code> and re-restart</z><z id="t1498575870" t="ddeaguiar So I just did a quick test using the vase lein template"><y>#</y><d>2017-06-27</d><h>15:04</h><w>ddeaguiar</w>So I just did a quick test using the vase lein template</z><z id="t1498575882" t="ddeaguiar you don’t even need to explicitly reload"><y>#</y><d>2017-06-27</d><h>15:04</h><w>ddeaguiar</w>you don’t even need to explicitly reload</z><z id="t1498575903" t="ddeaguiar any changes to the vase edn file will be picked up on next request"><y>#</y><d>2017-06-27</d><h>15:05</h><w>ddeaguiar</w>any changes to the vase edn file will be picked up on next request</z><z id="t1498575973" t="ddeaguiar This is because the value of ::server/routes is a fn and evaluated on every request ( https://github.com/cognitect-labs/vase/blob/master/template/src/leiningen/new/vase/server.clj#L52 )"><y>#</y><d>2017-06-27</d><h>15:06</h><w>ddeaguiar</w>This is because the value of <code>::server/routes</code> is a fn and evaluated on every request (<a href="https://github.com/cognitect-labs/vase/blob/master/template/src/leiningen/new/vase/server.clj#L52" target="_blank">https://github.com/cognitect-labs/vase/blob/master/template/src/leiningen/new/vase/server.clj#L52</a>)</z><z id="t1498576532" t="mgrbyte hmm"><y>#</y><d>2017-06-27</d><h>15:15</h><w>mgrbyte</w>hmm</z><z id="t1498576541" t="mgrbyte Not happening for me."><y>#</y><d>2017-06-27</d><h>15:15</h><w>mgrbyte</w>Not happening for me.</z><z id="t1498576706" t="mgrbyte perhaps it&apos;s because I&apos;m using the mutliple vase resource files as per the petstore-full sample?"><y>#</y><d>2017-06-27</d><h>15:18</h><w>mgrbyte</w>perhaps it&apos;s because I&apos;m using the mutliple vase resource files  as per the petstore-full sample?</z><z id="t1498577083" t="ddeaguiar hmm, I wouldn’t think so. if your service map routes value is a function, it will be executed on every request. If that function loads vase resource files, then they’ll get loaded on every request"><y>#</y><d>2017-06-27</d><h>15:24</h><w>ddeaguiar</w>hmm, I wouldn’t think so. if your service map <code>routes</code> value is a function, it will be executed on every request. If that function loads vase resource files, then they’ll get loaded on every request</z><z id="t1498577654" t="mgrbyte still no joy. I stop and restart the repl, and I see my changes (w/no errors). changing my edn resource file alone, no changes seen. 😕"><y>#</y><d>2017-06-27</d><h>15:34</h><w>mgrbyte</w>still no joy. I stop and restart the repl, and I see my changes (w/no errors). changing my edn resource file alone, no changes seen. <b>😕</b></z><z id="t1498577694" t="mgrbyte will see if I can re-produce from a clean project/template."><y>#</y><d>2017-06-27</d><h>15:34</h><w>mgrbyte</w>will see if I can re-produce from a clean project/template.</z><z id="t1498578163" t="ddeaguiar wierd"><y>#</y><d>2017-06-27</d><h>15:42</h><w>ddeaguiar</w>wierd</z><z id="t1498578242" t="mgrbyte so can confirm this doesn&apos;t work. I checked out vase, started the petstore-full sample with lein run-dev"><y>#</y><d>2017-06-27</d><h>15:44</h><w>mgrbyte</w>so can confirm this doesn&apos;t work. I checked out vase, started the petstore-full sample with <code>lein run-dev</code></z><z id="t1498578277" t="mgrbyte then edited resources/petstore-full.categories.edn to add a new route, change isn&apos;t picked up"><y>#</y><d>2017-06-27</d><h>15:44</h><w>mgrbyte</w>then edited <code>resources/petstore-full.categories.edn</code> to add a new route, change isn&apos;t picked up</z><z id="t1498578325" t="mgrbyte Used the describe-api endpoint to check that ( http://localhost:8888/api )"><y>#</y><d>2017-06-27</d><h>15:45</h><w>mgrbyte</w>Used the describe-api endpoint to check that (<a href="http://localhost:8888/api" target="_blank">http://localhost:8888/api</a>)</z><z id="t1498578445" t="ddeaguiar ok let me try that project"><y>#</y><d>2017-06-27</d><h>15:47</h><w>ddeaguiar</w>ok let me try that project</z><z id="t1498578631" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] I didn’t run that project but I can see why it won’t work the same way"><y>#</y><d>2017-06-27</d><h>15:50</h><w>ddeaguiar</w><a>@mgrbyte</a> I didn’t run that project but I can see why it won’t work the same way</z><z id="t1498578682" t="ddeaguiar The vase descriptors are only being loaded when run-dev is invoked https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/server.clj#L13"><y>#</y><d>2017-06-27</d><h>15:51</h><w>ddeaguiar</w>The vase descriptors are only being loaded when <code>run-dev</code> is invoked <a href="https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/server.clj#L13" target="_blank">https://github.com/cognitect-labs/vase/blob/master/samples/petstore-full/src/petstore_full/server.clj#L13</a></z><z id="t1498578730" t="ddeaguiar So you’d need stop the service and call run-dev again to load the descriptors"><y>#</y><d>2017-06-27</d><h>15:52</h><w>ddeaguiar</w>So you’d need stop the service and call <code>run-dev</code> again to load the descriptors</z><z id="t1498578748" t="ddeaguiar That’s a suboptimal dev experience but one could argue that was not the point of this sample"><y>#</y><d>2017-06-27</d><h>15:52</h><w>ddeaguiar</w>That’s a suboptimal dev experience but one could argue that was not the point of this sample</z><z id="t1498578769" t="mgrbyte Yah, that&apos;s was the reasoning by my server stop/start comment ~^6"><y>#</y><d>2017-06-27</d><h>15:52</h><w>mgrbyte</w>Yah, that&apos;s was the reasoning by my server stop/start comment ~^6</z><z id="t1498578771" t="ddeaguiar I would be great if the samples were consistent in this case"><y>#</y><d>2017-06-27</d><h>15:52</h><w>ddeaguiar</w>I would be great if the samples were consistent in this case</z><z id="t1498578778" t="ddeaguiar ah ic"><y>#</y><d>2017-06-27</d><h>15:52</h><w>ddeaguiar</w>ah ic</z><z id="t1498578793" t="ddeaguiar so my recommendation is to not do it this way in your application"><y>#</y><d>2017-06-27</d><h>15:53</h><w>ddeaguiar</w>so my recommendation is to not do it this way in your application</z><z id="t1498578808" t="ddeaguiar follow what’s in the lein vase template"><y>#</y><d>2017-06-27</d><h>15:53</h><w>ddeaguiar</w>follow what’s in the lein vase template</z><z id="t1498578811" t="mgrbyte I&apos;m really hoping to split up at least the schema into separate files"><y>#</y><d>2017-06-27</d><h>15:53</h><w>mgrbyte</w>I&apos;m really hoping to split up at least the schema into separate files</z><z id="t1498578817" t="ddeaguiar you can do that"><y>#</y><d>2017-06-27</d><h>15:53</h><w>ddeaguiar</w>you can do that</z><z id="t1498578827" t="ddeaguiar and still benefit from hot-reloading"><y>#</y><d>2017-06-27</d><h>15:53</h><w>ddeaguiar</w>and still benefit from hot-reloading</z><z id="t1498578872" t="ddeaguiar Just be sure to limit hot-reloading to dev because it does have a performance impact"><y>#</y><d>2017-06-27</d><h>15:54</h><w>ddeaguiar</w>Just be sure to limit hot-reloading to dev because it does have a performance impact</z><z id="t1498579002" t="mgrbyte what would be your recommended approach for that? I&apos;m a n00b at pedestal 🙂"><y>#</y><d>2017-06-27</d><h>15:56</h><w>mgrbyte</w>what would be your recommended approach for that? I&apos;m a n00b at pedestal <b>🙂</b></z><z id="t1498579271" t="mgrbyte ok, having read the code think I&apos;ve got a good idea how this will work. thanks for your help and patience [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] 🙂"><y>#</y><d>2017-06-27</d><h>16:01</h><w>mgrbyte</w>ok, having read the code think I&apos;ve got a good idea how this will work. thanks for your help and patience <a>@ddeaguiar</a>  <b>🙂</b></z><z id="t1498583548" t="ddeaguiar Glad you were able to figure things out [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] . When in doubt stick to what’s done in the Pedestal/Vase lein templates. Sometimes the examples stray from that and it’s unclear why."><y>#</y><d>2017-06-27</d><h>17:12</h><w>ddeaguiar</w>Glad you were able to figure things out <a>@mgrbyte</a>. When in doubt stick to what’s done in the Pedestal/Vase lein templates. Sometimes the examples stray from that and it’s unclear why.</z><z id="t1498598304" t="jjttjj Sorry to be asking endless vase newbie questions here. I can&apos;t tell if this is a datomic problem or a vase problem but I keep getting a back the following kind of response when I&apos;m trying to post to create new entities {&quot;whitelist&quot;:[{}],&quot;transaction&quot;:[[13194139534318,50,&quot;2017-06-27T19:46:27Z&quot;]]}"><y>#</y><d>2017-06-27</d><h>21:18</h><w>jjttjj</w>Sorry to be asking endless vase newbie questions here. I can&apos;t tell if this is a datomic problem or a vase problem but I keep getting a back the following kind of response when I&apos;m trying to post to create new entities <code>{&quot;whitelist&quot;:[{}],&quot;transaction&quot;:[[13194139534318,50,&quot;2017-06-27T19:46:27Z&quot;]]}</code></z><z id="t1498598330" t="jjttjj is that indicative of an issue with the schema?"><y>#</y><d>2017-06-27</d><h>21:18</h><w>jjttjj</w>is that indicative of an issue with the schema?</z><z id="t1498743704" t="mtnygard Hey all, I&apos;ve been away for a while, will try to catch up and answer some of the questions that have been posted here in the last couple of weeks. This is my one day in Slack before heading out on vacation until mid-July. If you post a question here and don&apos;t get an answer, I&apos;d encourage you to post to the pedestal-users list. ( https://groups.google.com/forum/#!forum/pedestal-users )"><y>#</y><d>2017-06-29</d><h>13:41</h><w>mtnygard</w>Hey all, I&apos;ve been away for a while, will try to catch up and answer some of the questions that have been posted here in the last couple of weeks.  This is my one day in Slack before heading out on vacation until mid-July. If you post a question here and don&apos;t get an answer, I&apos;d encourage you to post to the pedestal-users list. (<a href="https://groups.google.com/forum/#!forum/pedestal-users" target="_blank">https://groups.google.com/forum/#!forum/pedestal-users</a>)</z><z id="t1498744034" t="mtnygard [:attrs {:href &quot;/_/_/users/U050SC7SV&quot;}] Regarding the double-colon... without a namespace you get a keyword in the current namespace. But ::http/port uses whatever the local alias http expands to. So as long as there was a (require &apos;[io.pedestal.http :as http]) then ::http/port expands to :io.pedestal.http/port ."><y>#</y><d>2017-06-29</d><h>13:47</h><w>mtnygard</w><a>@mpenet</a> Regarding the double-colon... without a namespace you get a keyword in the current namespace. But <code>::http/port</code> uses whatever the local alias <code>http</code> expands to. So as long as there was a <code>(require &apos;[io.pedestal.http :as http])</code> then <code>::http/port</code> expands to <code>:io.pedestal.http/port</code>.</z><z id="t1498744095" t="mtnygard [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] The docs do suck, but we can make them better. I added https://github.com/pedestal/pedestal-docs/issues/78 to make sure we document resource and fast-resource."><y>#</y><d>2017-06-29</d><h>13:48</h><w>mtnygard</w><a>@lxsameer</a> The docs do suck, but we can make them better. I added <a href="https://github.com/pedestal/pedestal-docs/issues/78" target="_blank">https://github.com/pedestal/pedestal-docs/issues/78</a> to make sure we document resource and fast-resource.</z><z id="t1498744156" t="lxsameer [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] good, I&apos;m happy to help with it as much as i can"><y>#</y><d>2017-06-29</d><h>13:49</h><w>lxsameer</w><a>@mtnygard</a> good, I&apos;m happy to help with it as much as i can</z><z id="t1498744178" t="mtnygard [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] As you&apos;ve deduced, #vase/transact is limited to assert and retract. There are three ways you can go:"><y>#</y><d>2017-06-29</d><h>13:49</h><w>mtnygard</w><a>@mgrbyte</a> As you&apos;ve deduced, <code>#vase/transact</code> is limited to assert and retract. There are three ways you can go:</z><z id="t1498744215" t="mtnygard 1. Create a new reader literal in your own namespace. This is the high-effort approach but will give you something that feels native to Vase."><y>#</y><d>2017-06-29</d><h>13:50</h><w>mtnygard</w>1. Create a new reader literal in your own namespace. This is the high-effort approach but will give you something that feels native to Vase.</z><z id="t1498744252" t="mtnygard 2. Use #vase/intercept to write an interceptor directly in your Vase file. This will get a little wordy but it definitely works."><y>#</y><d>2017-06-29</d><h>13:50</h><w>mtnygard</w>2. Use <code>#vase/intercept</code> to write an interceptor directly in your Vase file. This will get a little wordy but it definitely works.</z><z id="t1498745258" t="mgrbyte mtnygard: Thanks for these pointers 👍 So, to check I understand correctly; I could write my own fn which does d/transact w :db.fn/cas and call that within #vase/intercept ?"><y>#</y><d>2017-06-29</d><h>14:07</h><r>mgrbyte</r>mtnygard: Thanks for these pointers <b>👍</b> So, to check I understand correctly;  I could write my own fn which does <code>d/transact</code> w <code>:db.fn/cas</code>  and call that within <code>#vase/intercept</code>?</z><z id="t1498745341" t="mtnygard Yes, exactly."><y>#</y><d>2017-06-29</d><h>14:09</h><r>mtnygard</r>Yes, exactly.</z><z id="t1498745362" t="mgrbyte great, thanks 🙂"><y>#</y><d>2017-06-29</d><h>14:09</h><r>mgrbyte</r>great, thanks <b>🙂</b></z><z id="t1498745847" t="mgrbyte Attempting to write a custom interceptor #vase/intercept just to test I&apos;ve got this down, I do: #vase/intercept {:name :roscoff.service/intercept :enter (fn [ctx] (roscoff.service/intercept ctx))} "><y>#</y><d>2017-06-29</d><h>14:17</h><r>mgrbyte</r>Attempting to write a custom interceptor #vase/intercept just to test I&apos;ve got this down, I do:
<pre>#vase/intercept  {:name :roscoff.service/intercept
                        :enter (fn [ctx]
                                 (roscoff.service/intercept ctx))}
</pre></z><z id="t1498745918" t="mtnygard That looks like it should work. You just need to make sure you require roscoff.service before you load the descriptor file."><y>#</y><d>2017-06-29</d><h>14:18</h><r>mtnygard</r>That looks like it should work. You just need to make sure you require roscoff.service before you load the descriptor file.</z><z id="t1498745922" t="mgrbyte which work (that &quot;intercept&quot; fn just does a println right now - but I always get &quot;Not found&quot; from the client (even tho the fn is being called as I see the prints in my repl)"><y>#</y><d>2017-06-29</d><h>14:18</h><r>mgrbyte</r>which work (that &quot;intercept&quot; fn just does a println right now - but I always get &quot;Not found&quot; from the client (even tho the fn is being called as I see the prints in my repl)</z><z id="t1498745962" t="mgrbyte I assume I&apos;m not obeying the contract/interface for vase/intercept - I assumed it should return the ctx"><y>#</y><d>2017-06-29</d><h>14:19</h><r>mgrbyte</r>I assume I&apos;m not obeying the contract/interface for vase/intercept - I assumed it should return the ctx</z><z id="t1498745992" t="mtnygard The 404 is probably because you&apos;re not supplying a response anywhere. Pedestal assumes that if no interceptor adds a response, it means the request can&apos;t be handled."><y>#</y><d>2017-06-29</d><h>14:19</h><r>mtnygard</r>The 404 is probably because you&apos;re not supplying a response anywhere. Pedestal assumes that if no interceptor adds a response, it means the request can&apos;t be handled.</z><z id="t1498746009" t="mtnygard Yes, the interceptor should definitely return the ctx"><y>#</y><d>2017-06-29</d><h>14:20</h><r>mtnygard</r>Yes, the interceptor should definitely return the ctx</z></g><g id="s8"><z id="t1498746860" t="mgrbyte hmm. So I thought: (assoc ctx :response {:my-key &quot;some data&quot;}) would be enough to add a response, but still get the not found. thanks for all your help here."><y>#</y><d>2017-06-29</d><h>14:34</h><r>mgrbyte</r>hmm. So I thought: <code>(assoc ctx :response {:my-key &quot;some data&quot;})</code> would be enough to add a response, but still get the not found. thanks for all your help here.</z><z id="t1498746888" t="mtnygard It needs a body. Try (assoc ctx :response {:body {:my-key &quot;something&quot;}})"><y>#</y><d>2017-06-29</d><h>14:34</h><r>mtnygard</r>It needs a body. Try <code>(assoc ctx :response {:body {:my-key &quot;something&quot;}})</code></z><z id="t1498747702" t="mgrbyte No idea what I&apos;ve not got right, but that work either 😕"><y>#</y><d>2017-06-29</d><h>14:48</h><r>mgrbyte</r>No idea what I&apos;ve not got right, but that work either <b>😕</b></z><z id="t1498747878" t="mgrbyte aha"><y>#</y><d>2017-06-29</d><h>14:51</h><r>mgrbyte</r>aha</z><z id="t1498747901" t="mgrbyte So I changed it to ` (assoc ctx :response (ring-resp/response &quot;{:something 1}&quot;)))`"><y>#</y><d>2017-06-29</d><h>14:51</h><r>mgrbyte</r>So I changed it to `  (assoc ctx :response
         (ring-resp/response &quot;{:something 1}&quot;)))`</z><z id="t1498747912" t="mgrbyte and that does work"><y>#</y><d>2017-06-29</d><h>14:51</h><r>mgrbyte</r>and that does work</z><z id="t1498747958" t="mtnygard Hmm. All that does is create a map with a body and a status. So I must be misremembering... Pedestal must be looking for a :status on the response too."><y>#</y><d>2017-06-29</d><h>14:52</h><r>mtnygard</r>Hmm. All that does is create a map with a body and a status. So I must be misremembering... Pedestal must be looking for a <code>:status</code> on the response too.</z><z id="t1498747986" t="mgrbyte yep - that does the trick (requries status too)"><y>#</y><d>2017-06-29</d><h>14:53</h><r>mgrbyte</r>yep - that does the trick (requries status too)</z><z id="t1498748045" t="mtnygard Sorry about that."><y>#</y><d>2017-06-29</d><h>14:54</h><r>mtnygard</r>Sorry about that.</z><z id="t1498748064" t="mgrbyte So I have :vase.api/interceptors [io.pedestal.http/json-body] and a custom #vase/intercept working now, which I think gives me the basis to not re-invent/fork vase (which I was considering!)"><y>#</y><d>2017-06-29</d><h>14:54</h><r>mgrbyte</r>So I have <code>:vase.api/interceptors [io.pedestal.http/json-body]</code> and a custom #vase/intercept working now, which I think gives me the basis to not re-invent/fork vase (which I was considering!)</z><z id="t1498748074" t="mgrbyte no, thank you! 💯 🙂"><y>#</y><d>2017-06-29</d><h>14:54</h><r>mgrbyte</r>no, thank you! <b>💯</b>  <b>🙂</b></z><z id="t1498744286" t="mtnygard 3. Write a function in your own namespace and use #vase/intercept in your Vase file to call that function."><y>#</y><d>2017-06-29</d><h>13:51</h><w>mtnygard</w>3. Write a function in your own namespace and use <code>#vase/intercept</code> in your Vase file to call that function.</z><z id="t1498744344" t="mtnygard I&apos;ve got some changes in the works that will make it easier to add new interceptors and literals, but that&apos;s still a few weeks away from landing in master. If you want a sneak peek you can check my fork at https://github.com/mtnygard/vase/tree/fern-input"><y>#</y><d>2017-06-29</d><h>13:52</h><w>mtnygard</w>I&apos;ve got some changes in the works that will make it easier to add new interceptors and literals, but that&apos;s still a few weeks away from landing in master. If you want a sneak peek you can check my fork at <a href="https://github.com/mtnygard/vase/tree/fern-input" target="_blank">https://github.com/mtnygard/vase/tree/fern-input</a></z><z id="t1498744443" t="ddeaguiar Keep in mind that troubleshooting errors with #vase/intercept defined interceptors is difficult"><y>#</y><d>2017-06-29</d><h>13:54</h><w>ddeaguiar</w>Keep in mind that troubleshooting errors with <code>#vase/intercept</code> defined interceptors is difficult</z><z id="t1498744450" t="ddeaguiar at least atm"><y>#</y><d>2017-06-29</d><h>13:54</h><w>ddeaguiar</w>at least atm</z><z id="t1498744464" t="mtnygard [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] I think you&apos;re asking if you can define specs in regular namespaces, then refer to them in Vase under the :vase/specs key. If you&apos;ve registered the specs, then you can use them in validate literals even without referring to them in the :vase/specs key."><y>#</y><d>2017-06-29</d><h>13:54</h><w>mtnygard</w><a>@jjttjj</a> I think you&apos;re asking if you can define specs in regular namespaces, then refer to them in Vase under the <code>:vase/specs</code> key. If you&apos;ve registered the specs, then you can use them in validate literals even without referring to them in the <code>:vase/specs</code> key.</z><z id="t1498744787" t="mtnygard [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] I hope the new section in the hello-world-content-types guide helped with the transition to cond-&gt; . LMK if it&apos;s still too big a jump."><y>#</y><d>2017-06-29</d><h>13:59</h><w>mtnygard</w><a>@shaun-mahood</a> I hope the new section in the hello-world-content-types guide helped with the transition to <code>cond-&gt;</code>. LMK if it&apos;s still too big a jump.</z><z id="t1498745211" t="mtnygard [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] Re: syntax quoting. You can provide a fully-qualified symbol in a route and Pedestal will assume you want to use a keyword with the same namespace and name as your route name. That&apos;s the only place it works. That&apos;s only needed if you use a &quot;handler function&quot; in the last position and let Pedestal turn it into an interceptor. Personally, I prefer to write my interceptors directly and provide a :name key in the map. It&apos;s largely a matter of style."><y>#</y><d>2017-06-29</d><h>14:06</h><w>mtnygard</w><a>@shaun-mahood</a> Re: syntax quoting. You can provide a fully-qualified symbol in a route and Pedestal will assume you want to use a keyword with the same namespace and name as your route name. That&apos;s the only place it works. That&apos;s only needed if you use a &quot;handler function&quot; in the last position and let Pedestal turn it into an interceptor.

Personally, I prefer to write my interceptors directly and provide a <code>:name</code> key in the map. It&apos;s largely a matter of style.</z><z id="t1498745231" t="mtnygard [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] I&apos;ve created https://github.com/pedestal/pedestal-docs/issues/79 about extending Pedestal via protocols."><y>#</y><d>2017-06-29</d><h>14:07</h><w>mtnygard</w><a>@lxsameer</a> I&apos;ve created <a href="https://github.com/pedestal/pedestal-docs/issues/79" target="_blank">https://github.com/pedestal/pedestal-docs/issues/79</a> about extending Pedestal via protocols.</z><z id="t1498745280" t="mtnygard [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] The short answer is: the best protocol to extend is Interceptor. The second-best is IntoInterceptor. If you&apos;re doing something fancy with routing then RouterSpecification is interesting."><y>#</y><d>2017-06-29</d><h>14:08</h><w>mtnygard</w><a>@lxsameer</a> The short answer is: the best protocol to extend is Interceptor. The second-best is IntoInterceptor. If you&apos;re doing something fancy with routing then RouterSpecification is interesting.</z><z id="t1498745325" t="mtnygard If you want to do something custom with response bodies, you can extend WriteableBody or WriteableBodyAsync to any kind of arbitrary object."><y>#</y><d>2017-06-29</d><h>14:08</h><w>mtnygard</w>If you want to do something custom with response bodies, you can extend WriteableBody or WriteableBodyAsync to any kind of arbitrary object.</z><z id="t1498745585" t="mtnygard [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] I&apos;ve added an issue for the docs about syntax-quoting. https://github.com/pedestal/pedestal-docs/issues/80"><y>#</y><d>2017-06-29</d><h>14:13</h><w>mtnygard</w><a>@shaun-mahood</a> I&apos;ve added an issue for the docs about syntax-quoting. <a href="https://github.com/pedestal/pedestal-docs/issues/80" target="_blank">https://github.com/pedestal/pedestal-docs/issues/80</a></z><z id="t1498745875" t="mtnygard [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] Re: payload for the vase-component sample. The payload must actually be json. I don&apos;t know why the docs imply that EDN works for input. I&apos;m kind of surprised that it didn&apos;t work when you used the json content-type though. Do you still have the client-side code around? If so, can you share it with me?"><y>#</y><d>2017-06-29</d><h>14:17</h><w>mtnygard</w><a>@jjttjj</a> Re: payload for the vase-component sample. The payload must actually be json. I don&apos;t know why the docs imply that EDN works for input. I&apos;m kind of surprised that it didn&apos;t work when you used the json content-type though. Do you still have the client-side code around? If so, can you share it with me?</z><z id="t1498746294" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] : Thanks, I&apos;ll take a read through and follow up on that issue if I still don&apos;t understand the syntax quoting details. The change to the cond-&gt; bit in the docs was much clearer too!"><y>#</y><d>2017-06-29</d><h>14:24</h><w>shaun-mahood</w><a>@mtnygard</a>: Thanks, I&apos;ll take a read through and follow up on that issue if I still don&apos;t understand the syntax quoting details. The change to the <code>cond-&gt;</code> bit in the docs was much clearer too!</z><z id="t1498746608" t="lxsameer [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] nice, I&apos;m trying to create a router"><y>#</y><d>2017-06-29</d><h>14:30</h><w>lxsameer</w><a>@mtnygard</a> nice, I&apos;m trying to create a router</z><z id="t1498929330" t="souenzzo There is some &quot;helper/default interceptor&quot; to create Content-Length ? My current body is a string from hiccup"><y>#</y><d>2017-07-01</d><h>17:15</h><w>souenzzo</w>There is some &quot;helper/default interceptor&quot; to create <code>Content-Length</code>? My current body is a  string from hiccup</z><z id="t1499013972" t="jjttjj [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] just wondering, in reference to https://github.com/cognitect-labs/vase/issues/78 is it by design that Vase only accepts json payloads? I do see that there&apos;s a PR related to this. I&apos;m attempting to call a vase api from a cljs app and it&apos;s possible but a bit awkward at the moment with the namespaced keys everywhere etc."><y>#</y><d>2017-07-02</d><h>16:46</h><w>jjttjj</w><a>@mtnygard</a> just wondering, in reference to <a href="https://github.com/cognitect-labs/vase/issues/78" target="_blank">https://github.com/cognitect-labs/vase/issues/78</a> is it by design that Vase only accepts json payloads? I do see that there&apos;s a PR related to this. I&apos;m attempting to call a vase api from a cljs app and it&apos;s possible but a bit awkward at the moment with the namespaced keys everywhere etc.</z><z id="t1499014137" t="jjttjj What attracts me to Vase was it&apos;s &quot;Everything as EDN data&quot; attitude so it was kind of unexpected to me to find that this doesn&apos;t extend to communication with the client"><y>#</y><d>2017-07-02</d><h>16:48</h><w>jjttjj</w>What attracts me to Vase was it&apos;s &quot;Everything as EDN data&quot; attitude so it was kind of unexpected to me to find that this doesn&apos;t extend to communication with the client</z><z id="t1499085660" t="martinklepsch If anyone feels like reviewing a simple PR: https://github.com/pedestal/pedestal/pull/526 🙂"><y>#</y><d>2017-07-03</d><h>12:41</h><w>martinklepsch</w>If anyone feels like reviewing a simple PR: <a href="https://github.com/pedestal/pedestal/pull/526" target="_blank">https://github.com/pedestal/pedestal/pull/526</a> <b>🙂</b></z><z id="t1499294356" t="shaun-mahood This seems like a dumb question, I assume I&apos;m missing something pretty basic. With my route defined as (def routes #{[&quot;/about&quot; :get `about]}) , I get a response when I go to localhost:8080/about but a not found at localhost:8080/about/ Any ideas on what I should be changing here?"><y>#</y><d>2017-07-05</d><h>22:39</h><w>shaun-mahood</w>This seems like a dumb question,  I assume I&apos;m missing something pretty basic.
With my route defined as <pre>(def routes #{[&quot;/about&quot; :get `about]})</pre>, I get a response when I go to <code>localhost:8080/about</code> but a not found at <code>localhost:8080/about/</code>
Any ideas on what I should be changing here?</z><z id="t1499294415" t="souenzzo /about , /about/ and /about/:foo are 3 different routes"><y>#</y><d>2017-07-05</d><h>22:40</h><w>souenzzo</w><code>/about</code>, <code>/about/</code> and <code>/about/:foo</code> are 3 different routes</z><z id="t1499294538" t="shaun-mahood Is there an easy way to combine /about and /about/ into one handler while still leaving /about/:foo available for something else? Or is that a bad idea for some reason?"><y>#</y><d>2017-07-05</d><h>22:42</h><w>shaun-mahood</w>Is there an easy way to combine <code>/about</code> and <code>/about/</code> into one handler while still leaving <code>/about/:foo</code> available for something else? Or is that a bad idea for some reason?</z><z id="t1499294635" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] : Also, thanks for letting me know that I&apos;m getting an expected response - I thought I was just doing something dumb as the routing library I am most accustomed to (in another language) treats those as the same thing."><y>#</y><d>2017-07-05</d><h>22:43</h><w>shaun-mahood</w><a>@souenzzo</a>: Also, thanks for letting me know that I&apos;m getting an expected response - I thought I was just doing something dumb as the routing library I am most accustomed to (in another language) treats those as the same thing.</z><z id="t1499295070" t="souenzzo I had this problem a while back. I solved it this way: #{[&quot;/foo&quot; :get foo-handler :route-name :foo-handler][&quot;/foo/*&quot; :get foo-handler :route-name :foo-handler*]}"><y>#</y><d>2017-07-05</d><h>22:51</h><w>souenzzo</w>I had this problem a while back. I solved it this way:
 <code>#{[&quot;/foo&quot; :get foo-handler :route-name :foo-handler][&quot;/foo/*&quot; :get foo-handler :route-name :foo-handler*]}</code></z><z id="t1499295749" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] : Thanks, I&apos;ll give that a try"><y>#</y><d>2017-07-05</d><h>23:02</h><w>shaun-mahood</w><a>@souenzzo</a>: Thanks, I&apos;ll give that a try</z><z id="t1499296891" t="bherrmann Humbug. I wonder what series of incantations I need to do to upload a file. http://pedestal.io/guides/uploading-files"><y>#</y><d>2017-07-05</d><h>23:21</h><w>bherrmann</w>Humbug.  I wonder what series of incantations I need to do to upload a file.   <a href="http://pedestal.io/guides/uploading-files" target="_blank">http://pedestal.io/guides/uploading-files</a></z><z id="t1499297291" t="bherrmann Humm... google for the win? https://github.com/scotthaleen/pedestal-file-upload"><y>#</y><d>2017-07-05</d><h>23:28</h><w>bherrmann</w>Humm... google for the win?   <a href="https://github.com/scotthaleen/pedestal-file-upload" target="_blank">https://github.com/scotthaleen/pedestal-file-upload</a></z><z id="t1499299270" t="danielcompton [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] I&apos;d recommend middleware to redirect from trailing to non-trailing (or vice versa if you prefer)"><y>#</y><d>2017-07-06</d><h>00:01</h><w>danielcompton</w><a>@shaun-mahood</a> I&apos;d recommend middleware to redirect from trailing to non-trailing (or vice versa if you prefer)</z><z id="t1499302346" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] : Good idea! My love for re-frame interceptors is a huge part of what drew me to pedestal :)"><y>#</y><d>2017-07-06</d><h>00:52</h><w>shaun-mahood</w><a>@danielcompton</a>: Good idea! My love for re-frame interceptors is a huge part of what drew me to pedestal :)</z><z id="t1499435347" t="skylar What is the best way to secure Pedestal REST-endpoints?"><y>#</y><d>2017-07-07</d><h>13:49</h><w>skylar</w>What is the best way to secure Pedestal REST-endpoints?</z><z id="t1499439798" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U53B44U14&quot;}] : I haven&apos;t gotten to using it yet, but https://github.com/propan/geheimtur has been recommended to me when I asked about it earlier."><y>#</y><d>2017-07-07</d><h>15:03</h><w>shaun-mahood</w><a>@skylar</a>: I haven&apos;t gotten to using it yet, but <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a> has been recommended to me when I asked about it earlier.</z><z id="t1499440255" t="shaun-mahood Are there any examples of how to use the resource ring-middleware ( https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L142 ) or any of the other ring-middleware that takes an argument? It&apos;s just different enough from the examples I can find (for both ring and pedestal) that it&apos;s giving me a bit of difficulty figuring out. I think I&apos;m almost there but not sure yet if what I&apos;m trying is just a terrible mess compared to what it could be."><y>#</y><d>2017-07-07</d><h>15:10</h><w>shaun-mahood</w>Are there any examples of how to use the resource ring-middleware (<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L142" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L142</a>) or any of the other ring-middleware that takes an argument? It&apos;s just different enough from the examples I can find (for both ring and pedestal) that it&apos;s giving me a bit of difficulty figuring out. I think I&apos;m almost there but not sure yet if what I&apos;m trying is just a terrible mess compared to what it could be.</z><z id="t1499449348" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] , the ring resource middleware is used when :io.pedestal.http/resource-path is set on the service-map. Refer to https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L256 . All the middleware adapters in the io.pedestal.http.ring-middlewares namespace are just functions which return interceptors. To use them, you would invoke the functions when building your interceptor chain. A lot of them are configured through the default-interceptors fn, though. Take a deeper look there for more details. https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L181"><y>#</y><d>2017-07-07</d><h>17:42</h><w>ddeaguiar</w><a>@shaun-mahood</a>, the ring resource middleware is used when <code>:io.pedestal.http/resource-path</code> is set on the service-map. Refer to <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L256" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L256</a>. All the middleware adapters in the <code>io.pedestal.http.ring-middlewares</code> namespace are just functions which return interceptors. To use them, you would invoke the functions when building your interceptor chain. A lot of them are configured through the <code>default-interceptors</code> fn, though. Take a deeper look there for more details. <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L181" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L181</a></z><z id="t1499449479" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U53B44U14&quot;}] another authentication option is Buddy ( https://github.com/funcool/buddy ). There’s a PR which includes an a Buddy auth integration sample project. https://github.com/pedestal/pedestal/pull/503 ."><y>#</y><d>2017-07-07</d><h>17:44</h><w>ddeaguiar</w><a>@skylar</a> another authentication option is Buddy (<a href="https://github.com/funcool/buddy" target="_blank">https://github.com/funcool/buddy</a>). There’s a PR which includes an a Buddy auth integration sample project. <a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a>.</z><z id="t1499456238" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] : Maybe I&apos;m going down the wrong path then - what I&apos;m trying to do is grab a file from the local filesystem (not in the resource-path) and serve that file. My thought was that I could use one of the existing ring-middlewares and pass in the specific file path. At this point I&apos;ve got an interceptor that grabs the info from the request and does a query to find the file-path and adds that to the context, and I want to have that file-path sent to the resource middleware (or one of the alternatives) - so for now I&apos;m trying to just wrap it with another interceptor that passes in the file-path. My first thought was to just put the argument (or the path to the context) into the interceptor chain directly, but I couldn&apos;t find a way to do that. What you posted above helps since I was making one wrong assumption already, so thanks!"><y>#</y><d>2017-07-07</d><h>19:37</h><w>shaun-mahood</w><a>@ddeaguiar</a>: Maybe I&apos;m going down the wrong path then - what I&apos;m trying to do is grab a file from the local filesystem (not in the resource-path) and serve that file. My thought was that I could use one of the existing ring-middlewares and pass in the specific file path. At this point I&apos;ve got an interceptor that grabs the info from the request and does a query to find the file-path and adds that to the context, and I want to have that file-path sent to the <code>resource</code> middleware (or one of the alternatives) - so for now I&apos;m trying to just wrap it with another interceptor that passes in the file-path. My first thought was to just put the argument (or the path to the context) into the interceptor chain directly, but I couldn&apos;t find a way to do that. What you posted above helps since I was making one wrong assumption already, so thanks!</z><z id="t1499463065" t="bherrmann Harumph... the war example seems broken.... https://github.com/pedestal/pedestal/issues/527"><y>#</y><d>2017-07-07</d><h>21:31</h><w>bherrmann</w>Harumph...  the war example seems broken....   <a href="https://github.com/pedestal/pedestal/issues/527" target="_blank">https://github.com/pedestal/pedestal/issues/527</a></z><z id="t1499463094" t="bherrmann any ideas on how to poke at this one?"><y>#</y><d>2017-07-07</d><h>21:31</h><w>bherrmann</w>any ideas on how to poke at this one?</z><z id="t1499465271" t="mtnygard [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] I&apos;ll take a look at this. I&apos;ve needed to understand how war deployment works for a while. (I never worked on that part before.) What I see at the moment looks like a missing Jar file for the servlet API."><y>#</y><d>2017-07-07</d><h>22:07</h><w>mtnygard</w><a>@bherrmann</a> I&apos;ll take a look at this. I&apos;ve needed to understand how war deployment works for a while. (I never worked on that part before.) What I see at the moment looks like a missing Jar file for the servlet API.</z><z id="t1499466063" t="mtnygard [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] OK, I figured out what was going on. In the war example, we don&apos;t have Jetty in the dependencies. That&apos;s so the war file doesn&apos;t contain a complete copy of Jetty, Tomcat, etc."><y>#</y><d>2017-07-07</d><h>22:21</h><w>mtnygard</w><a>@bherrmann</a> OK, I figured out what was going on. In the war example, we don&apos;t have Jetty in the dependencies. That&apos;s so the war file doesn&apos;t contain a complete copy of Jetty, Tomcat, etc.</z><z id="t1499466091" t="mtnygard Instead, there&apos;s a profile in project.clj that you need to add for REPL based development only."><y>#</y><d>2017-07-07</d><h>22:21</h><w>mtnygard</w>Instead, there&apos;s a profile in project.clj that you need to add for REPL based development only.</z><z id="t1499466103" t="mtnygard So if you run &apos;lein with-profile +jetty repl&apos; you get the desired behavior."><y>#</y><d>2017-07-07</d><h>22:21</h><w>mtnygard</w>So if you run &apos;lein with-profile +jetty repl&apos; you get the desired behavior.</z><z id="t1499466123" t="mtnygard I&apos;ve pushed an update to the readme that clarifies this process."><y>#</y><d>2017-07-07</d><h>22:22</h><w>mtnygard</w>I&apos;ve pushed an update to the readme that clarifies this process.</z><z id="t1499466152" t="mtnygard As an aside, one thing I&apos;d really love to have is build automation that could start up and test each of the samples during a CI build..."><y>#</y><d>2017-07-07</d><h>22:22</h><w>mtnygard</w>As an aside, one thing I&apos;d really love to have is build automation that could start up and test each of the samples during a CI build...</z><z id="t1499466844" t="souenzzo ((io.pedestal.http.route/form-action-for-routes #{[&quot;/&quot; :get (fn [_] {:status 200 :body &quot;Hello&quot;}) :route-name :main]}) :main) ExceptionInfo Route not found clojure.core/ex-info (core.clj:4617) I&apos;m missing something?"><y>#</y><d>2017-07-07</d><h>22:34</h><w>souenzzo</w><pre>((io.pedestal.http.route/form-action-for-routes
   #{[&quot;/&quot; :get (fn [_] {:status 200 :body &quot;Hello&quot;}) :route-name :main]}) :main)
</pre>
<code>ExceptionInfo Route not found  clojure.core/ex-info (core.clj:4617)</code>
I&apos;m missing something?</z><z id="t1499466955" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I think form-action-for-routes needs the fully-expanded routes. Can you try the same thing with the value of (:io.pedestal.http/routes service-map) after starting the service?"><y>#</y><d>2017-07-07</d><h>22:35</h><w>mtnygard</w><a>@souenzzo</a> I think <code>form-action-for-routes</code> needs the fully-expanded routes. Can you try the same thing with the value of <code>(:io.pedestal.http/routes service-map)</code> after starting the service?</z><z id="t1499467373" t="souenzzo (let [routes #{[&quot;/&quot; :get (fn [_] {:status 200 :body &quot;Hello&quot;}) :route-name :main]} service {::bootstrap/routes routes ::bootstrap/join? false ::bootstrap/type :jetty ::bootstrap/port 8080} server (bootstrap/create-server service)] ((io.pedestal.http.route/form-action-for-routes (::bootstrap/routes server)) :main)) ExceptionInfo Route not found clojure.core/ex-info (core.clj:4617) "><y>#</y><d>2017-07-07</d><h>22:42</h><w>souenzzo</w><pre>(let [routes #{[&quot;/&quot; :get (fn [_] {:status 200 :body &quot;Hello&quot;}) :route-name :main]}
      service {::bootstrap/routes routes
               ::bootstrap/join?  false
               ::bootstrap/type   :jetty
               ::bootstrap/port   8080}
      server (bootstrap/create-server service)]
  ((io.pedestal.http.route/form-action-for-routes (::bootstrap/routes server)) :main))

ExceptionInfo Route not found  clojure.core/ex-info (core.clj:4617)
</pre></z><z id="t1499467461" t="souenzzo #error{:cause &quot;Route not found&quot;, :data {:app-name nil, :route-name :main}, :via [{:type clojure.lang.ExceptionInfo, :message &quot;Route not found&quot;, :data {:app-name nil, :route-name :main}, :at [clojure.core$ex_info invokeStatic &quot;core.clj&quot; 4617]}], :trace [[clojure.core$ex_info invokeStatic &quot;core.clj&quot; 4617] [clojure.core$ex_info invoke &quot;core.clj&quot; 4617] [io.pedestal.http.route$find_route invokeStatic &quot;route.clj&quot; 265] [io.pedestal.http.route$find_route invoke &quot;route.clj&quot; 259] [io.pedestal.http.route$form_action_for_routes$fn__10117 doInvoke &quot;route.clj&quot; 495] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 410] [formiguinhas_service.service$eval69611 invokeStatic &quot;form-init7223753487312925116.clj&quot; 8] [formiguinhas_service.service$eval69611 invoke &quot;form-init7223753487312925116.clj&quot; 1] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 6927] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 6890] [clojure.core$eval invokeStatic &quot;core.clj&quot; 3105] [clojure.core$eval invoke &quot;core.clj&quot; 3101] [clojure.main$repl$read_eval_print__7408$fn__7411 invoke &quot;main.clj&quot; 240] [clojure.main$repl$read_eval_print__7408 invoke &quot;main.clj&quot; 240] [clojure.main$repl$fn__7417 invoke &quot;main.clj&quot; 258] [clojure.main$repl invokeStatic &quot;main.clj&quot; 258] [clojure.main$repl doInvoke &quot;main.clj&quot; 174] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 1523] [clojure.tools.nrepl.middleware.interruptible_eval$evaluate$fn__68771 invoke &quot;interruptible_eval.clj&quot; 87] [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 152] [clojure.lang.AFn applyTo &quot;AFn.java&quot; 144] [clojure.core$apply invokeStatic &quot;core.clj&quot; 646] [clojure.core$with_bindings_STAR_ invokeStatic &quot;core.clj&quot; 1881] [clojure.core$with_bindings_STAR_ doInvoke &quot;core.clj&quot; 1881] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 425] [clojure.tools.nrepl.middleware.interruptible_eval$evaluate invokeStatic &quot;interruptible_eval.clj&quot; 85] [clojure.tools.nrepl.middleware.interruptible_eval$evaluate invoke &quot;interruptible_eval.clj&quot; 55] [clojure.tools.nrepl.middleware.interruptible_eval$interruptible_eval$fn__68816$fn__68819 invoke &quot;interruptible_eval.clj&quot; 222] [clojure.tools.nrepl.middleware.interruptible_eval$run_next$fn__68811 invoke &quot;interruptible_eval.clj&quot; 190] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1142] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 617] [java.lang.Thread run &quot;Thread.java&quot; 748]]} "><y>#</y><d>2017-07-07</d><h>22:44</h><r>souenzzo</r><pre>#error{:cause &quot;Route not found&quot;,
       :data {:app-name nil, :route-name :main},
       :via [{:type clojure.lang.ExceptionInfo,
              :message &quot;Route not found&quot;,
              :data {:app-name nil, :route-name :main},
              :at [clojure.core$ex_info invokeStatic &quot;core.clj&quot; 4617]}],
       :trace [[clojure.core$ex_info invokeStatic &quot;core.clj&quot; 4617]
               [clojure.core$ex_info invoke &quot;core.clj&quot; 4617]
               [io.pedestal.http.route$find_route invokeStatic &quot;route.clj&quot; 265]
               [io.pedestal.http.route$find_route invoke &quot;route.clj&quot; 259]
               [io.pedestal.http.route$form_action_for_routes$fn__10117 doInvoke &quot;route.clj&quot; 495]
               [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 410]
               [formiguinhas_service.service$eval69611 invokeStatic &quot;form-init7223753487312925116.clj&quot; 8]
               [formiguinhas_service.service$eval69611 invoke &quot;form-init7223753487312925116.clj&quot; 1]
               [clojure.lang.Compiler eval &quot;Compiler.java&quot; 6927]
               [clojure.lang.Compiler eval &quot;Compiler.java&quot; 6890]
               [clojure.core$eval invokeStatic &quot;core.clj&quot; 3105]
               [clojure.core$eval invoke &quot;core.clj&quot; 3101]
               [clojure.main$repl$read_eval_print__7408$fn__7411 invoke &quot;main.clj&quot; 240]
               [clojure.main$repl$read_eval_print__7408 invoke &quot;main.clj&quot; 240]
               [clojure.main$repl$fn__7417 invoke &quot;main.clj&quot; 258]
               [clojure.main$repl invokeStatic &quot;main.clj&quot; 258]
               [clojure.main$repl doInvoke &quot;main.clj&quot; 174]
               [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 1523]
               [clojure.tools.nrepl.middleware.interruptible_eval$evaluate$fn__68771 invoke &quot;interruptible_eval.clj&quot; 87]
               [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 152]
               [clojure.lang.AFn applyTo &quot;AFn.java&quot; 144]
               [clojure.core$apply invokeStatic &quot;core.clj&quot; 646]
               [clojure.core$with_bindings_STAR_ invokeStatic &quot;core.clj&quot; 1881]
               [clojure.core$with_bindings_STAR_ doInvoke &quot;core.clj&quot; 1881]
               [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 425]
               [clojure.tools.nrepl.middleware.interruptible_eval$evaluate invokeStatic &quot;interruptible_eval.clj&quot; 85]
               [clojure.tools.nrepl.middleware.interruptible_eval$evaluate invoke &quot;interruptible_eval.clj&quot; 55]
               [clojure.tools.nrepl.middleware.interruptible_eval$interruptible_eval$fn__68816$fn__68819
                invoke
                &quot;interruptible_eval.clj&quot;
                222]
               [clojure.tools.nrepl.middleware.interruptible_eval$run_next$fn__68811
                invoke
                &quot;interruptible_eval.clj&quot;
                190]
               [clojure.lang.AFn run &quot;AFn.java&quot; 22]
               [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1142]
               [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 617]
               [java.lang.Thread run &quot;Thread.java&quot; 748]]}
</pre></z><z id="t1499467842" t="souenzzo Even after (-&gt; service bootstrap/default-interceptors bootstrap/create-server bootstrap/start) , the routes continue as a set"><y>#</y><d>2017-07-07</d><h>22:50</h><r>souenzzo</r>Even after <code>(-&gt; service bootstrap/default-interceptors bootstrap/create-server bootstrap/start)</code>, the routes continue as a <code>set</code></z><z id="t1499467373" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I have to head out for dinner. I&apos;ll check back in later. Let me know if that doesn&apos;t work and I can dig some more."><y>#</y><d>2017-07-07</d><h>22:42</h><w>mtnygard</w><a>@souenzzo</a> I have to head out for dinner. I&apos;ll check back in later. Let me know if that doesn&apos;t work and I can dig some more.</z><z id="t1499701422" t="souenzzo [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I still cant use form-action-for-routes 😕"><y>#</y><d>2017-07-10</d><h>15:43</h><r>souenzzo</r><a>@mtnygard</a> 
I still cant use <code>form-action-for-routes</code> <b>😕</b></z><z id="t1499467404" t="mtnygard OK, I&apos;ll try to diagnose further later."><y>#</y><d>2017-07-07</d><h>22:43</h><w>mtnygard</w>OK, I&apos;ll try to diagnose further later.</z><z id="t1499467765" t="bherrmann [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Huh. While you looked at that, I was writting up this, https://github.com/pedestal/pedestal/issues/529"><y>#</y><d>2017-07-07</d><h>22:49</h><w>bherrmann</w><a>@mtnygard</a> Huh.  While you looked at that, I was writting up this, <a href="https://github.com/pedestal/pedestal/issues/529" target="_blank">https://github.com/pedestal/pedestal/issues/529</a></z><z id="t1499467981" t="bherrmann [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Your &quot;lein with-profile +jetty repl&quot; does work for the REPL case though."><y>#</y><d>2017-07-07</d><h>22:53</h><w>bherrmann</w><a>@mtnygard</a> Your &quot;lein with-profile +jetty repl&quot; does work for the REPL case though.</z><z id="t1499468135" t="bherrmann I wonder if using a WAR file is just weird. It doesnt appear to be the path most traveled."><y>#</y><d>2017-07-07</d><h>22:55</h><w>bherrmann</w>I wonder if using a WAR file is just weird.    It doesnt appear to be the path most traveled.</z><z id="t1499564997" t="bradford Is there a way to access the underlying socket for an HTTPRequest inside an interceptor?"><y>#</y><d>2017-07-09</d><h>01:49</h><w>bradford</w>Is there a way to access the underlying socket for an HTTPRequest inside an interceptor?</z><z id="t1499617111" t="vijayakkineni How can i get access to raw http InputStream in pedestal"><y>#</y><d>2017-07-09</d><h>16:18</h><w>vijayakkineni</w>How can i get access to raw http <code>InputStream </code>  in pedestal</z><z id="t1499662178" t="skylar Thanks a lot [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] and [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] , I&apos;m glad this community is so active 🙂 . I&apos;ll try to get them work on my current project."><y>#</y><d>2017-07-10</d><h>04:49</h><w>skylar</w>Thanks a lot <a>@shaun-mahood</a> and <a>@ddeaguiar</a>, I&apos;m glad this community is so active <b>🙂</b>. I&apos;ll try to get them work on my current project.</z><z id="t1499700619" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0XCDM327&quot;}] , I’m going to assume you are using a servlet-based Pedestal implementation. There are two ways you can do this. You can either get the :body of the request map found on the context via the :request key or call getInputStream on the HttpServletRequest found on the context via the :servlet-request key. The former is more idiomatic."><y>#</y><d>2017-07-10</d><h>15:30</h><w>ddeaguiar</w><a>@vijayakkineni</a>, I’m going to assume you are using a servlet-based Pedestal implementation. There are two ways you can do this. You can either get the <code>:body</code> of the request map found on the context via the <code>:request</code> key or call  <code>getInputStream</code> on the <code>HttpServletRequest</code> found on the context via the <code>:servlet-request</code> key. The former is more idiomatic.</z><z id="t1499701376" t="vijayakkineni [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you."><y>#</y><d>2017-07-10</d><h>15:42</h><w>vijayakkineni</w><a>@ddeaguiar</a> thank you.</z><z id="t1499702203" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] I don’t have a direct answer for you but I suspect this is going to depend on the interceptor chain provider being used. I’m curious as to what your use case is? You may also want to post your question to the Pedestal user group for additional feedback."><y>#</y><d>2017-07-10</d><h>15:56</h><w>ddeaguiar</w><a>@bradford</a> I don’t have a direct answer for you but I suspect this is going to depend on the interceptor chain provider being used. I’m curious as to what your use case is? You may also want to post your question to the Pedestal user group for additional feedback.</z><z id="t1499704028" t="bradford [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I&apos;m looking to build streaming/chunked requests that are not a multipart/form-data"><y>#</y><d>2017-07-10</d><h>16:27</h><w>bradford</w><a>@ddeaguiar</a> I&apos;m looking to build streaming/chunked requests that are not a multipart/form-data</z><z id="t1499878128" t="jimmy hi guys, can we do with-redefs with response-for to unit test routes in Clojure? I tried but the function doesn’t seem seem to be redefined."><y>#</y><d>2017-07-12</d><h>16:48</h><w>jimmy</w>hi guys, can we do <code>with-redefs</code> with <code>response-for</code> to unit test routes in Clojure? I tried but the function doesn’t seem seem to be redefined.</z><z id="t1499880478" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I generally avoid with-redefs in tests as it changes the root value of a Var. One consequence of this is that it makes running tests in parallel impossible. I prefer using dynamic vars with binding . I’m guessing you are trying to stub out a function call. In that case consider your tests as feedback indicating that there’s an opportunity to explicitly introduce some abstraction and associated dependency."><y>#</y><d>2017-07-12</d><h>17:27</h><w>ddeaguiar</w><a>@nxqd</a> I generally avoid <code>with-redefs</code> in tests as it changes the root value of a Var. One consequence of this is that it makes running tests in parallel impossible. I prefer using dynamic vars with <code>binding</code>. I’m guessing you are trying to stub out a function call. In that case consider your tests as feedback indicating that there’s an opportunity to explicitly introduce some abstraction and associated dependency.</z><z id="t1499880630" t="ddeaguiar That being said, I don’t see why with-redefs would not work with response-for as long as you are targeting an application-specific var. The interceptor chain is still being executed."><y>#</y><d>2017-07-12</d><h>17:30</h><w>ddeaguiar</w>That being said, I don’t see why <code>with-redefs</code> would not work with <code>response-for</code> as long as you are targeting an application-specific var. The interceptor chain is still being executed.</z><z id="t1499908771" t="jimmy [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks a lot for the info. I would love to know how you unit test route without stubbing? Actually, in my case I use with-redefs to redefine a function."><y>#</y><d>2017-07-13</d><h>01:19</h><w>jimmy</w><a>@ddeaguiar</a> thanks a lot for the info. I would love to know how you unit test route without stubbing? Actually, in my case I use <code>with-redefs</code> to redefine a function.</z><z id="t1499953107" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] I typically test my routes in the context of an integration test. If I’m understanding your question correctly, you are trying to that your routes match incoming requests. To test route matching, you don’t need to use all the machinery provided by response-for , you can test against a router implementation directly. There are a number of ways to do this and I’ll share a gist shortly which illustrates them."><y>#</y><d>2017-07-13</d><h>13:38</h><w>ddeaguiar</w><a>@nxqd</a> I typically test my routes in the context of an integration test. If I’m understanding your question correctly, you are trying to that your routes match incoming requests. To test route matching, you don’t need to use all the machinery provided by <code>response-for</code>, you can test against a router implementation directly. There are a number of ways to do this and I’ll share a gist shortly which illustrates them.</z><z id="t1499954114" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CT59540&quot;}] https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae"><y>#</y><d>2017-07-13</d><h>13:55</h><w>ddeaguiar</w><a>@nxqd</a> <a href="https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae" target="_blank">https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae</a></z><z id="t1499973439" t="lxsameer does any one used pedestal&apos;s logging library ? is it any good ?"><y>#</y><d>2017-07-13</d><h>19:17</h><w>lxsameer</w>does any one used pedestal&apos;s logging library ? is it any good ?</z><z id="t1499973718" t="donaldball There are things I like about it and things I don’t"><y>#</y><d>2017-07-13</d><h>19:21</h><w>donaldball</w>There are things I like about it and things I don’t</z><z id="t1499973903" t="lxsameer can you share your experience with me please ?"><y>#</y><d>2017-07-13</d><h>19:25</h><w>lxsameer</w>can you share your experience with me please ?</z><z id="t1499973930" t="lxsameer I&apos;m trying to choose between timbre, pedestal.log and logback"><y>#</y><d>2017-07-13</d><h>19:25</h><w>lxsameer</w>I&apos;m trying to choose between timbre, pedestal.log and logback</z><z id="t1499974164" t="lxsameer [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] ^"><y>#</y><d>2017-07-13</d><h>19:29</h><w>lxsameer</w><a>@donaldball</a> ^</z><z id="t1499974392" t="donaldball Requiring inline keyvals for everything is a little annoying particularly if you have the log data in a map already, and configuration is always more than a little hit or miss. Given my druthers, I’ll use unilog to configure logback and call it a day, but in a pedestal project I’ll bow to convention and use its logger."><y>#</y><d>2017-07-13</d><h>19:33</h><w>donaldball</w>Requiring inline keyvals for everything is a little annoying particularly if you have the log data in a map already, and configuration is always more than a little hit or miss. Given my druthers, I’ll use unilog to configure logback and call it a day, but in a pedestal project I’ll bow to convention and use its logger.</z><z id="t1499974472" t="lxsameer [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] can i use it as slf4j backend ?"><y>#</y><d>2017-07-13</d><h>19:34</h><w>lxsameer</w><a>@donaldball</a> can i use it as slf4j backend ?</z><z id="t1500073656" t="bherrmann bah I want to do something like a &quot;flash message&quot; after a redirect. I can use a session or even a cookie to make this happen. Is there a handy example where pedestal does something like this?"><y>#</y><d>2017-07-14</d><h>23:07</h><w>bherrmann</w>bah I want to do something like a &quot;flash message&quot;  after a redirect.     I can use a session or even a cookie to make this happen.    Is there a handy example where pedestal does something like this?</z><z id="t1500074032" t="bherrmann Seems like I need to hook up some ring-middleware as per https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj"><y>#</y><d>2017-07-14</d><h>23:13</h><w>bherrmann</w>Seems like I need to hook up some ring-middleware as per <a href="https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj</a></z><z id="t1500140445" t="bradford How do I map a request path to a java servlet? is there an example?"><y>#</y><d>2017-07-15</d><h>17:40</h><w>bradford</w>How do I map a request path to a java servlet? is there an example?</z><z id="t1500206359" t="lxsameer is there any alternative for sente for pedestal ?"><y>#</y><d>2017-07-16</d><h>11:59</h><w>lxsameer</w>is there any alternative for sente for pedestal ?</z><z id="t1500206635" t="lxsameer and is it possible to use pedestals router with a ring application ?"><y>#</y><d>2017-07-16</d><h>12:03</h><w>lxsameer</w>and is it possible to use pedestals router with a ring application ?</z><z id="t1500250685" t="danielcompton [:attrs {:href &quot;/_/_/users/U085HE1PB&quot;}] I don&apos;t know much about servlets, but you can set &lt;url-pattern&gt; in web.xml to route requests to particular servlets. Is that what you were after? https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-war-deployment.md#step-two-configure-your-servlets"><y>#</y><d>2017-07-17</d><h>00:18</h><w>danielcompton</w><a>@bradford</a> I don&apos;t know much about servlets, but you can set <code>&lt;url-pattern&gt;</code> in <code>web.xml</code> to route requests to particular servlets. Is that what you were after? <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-war-deployment.md#step-two-configure-your-servlets" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-war-deployment.md#step-two-configure-your-servlets</a></z><z id="t1500299371" t="chris_johnson Is it possible to get access to the log in a Vase :query statement (e.g. to create a route like user-count-as-of that takes an #inst as a param)?"><y>#</y><d>2017-07-17</d><h>13:49</h><w>chris_johnson</w>Is it possible to get access to the log in a Vase <code>:query</code> statement (e.g. to create a route like <code>user-count-as-of</code> that takes an <code>#inst</code> as a param)?</z><z id="t1500303991" t="bradford [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] Hrm, close. We run as jetty .jars though."><y>#</y><d>2017-07-17</d><h>15:06</h><w>bradford</w><a>@danielcompton</a> Hrm, close. We run as jetty .jars though.</z><z id="t1500304052" t="mtnygard [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] Do you mean the Datomic log?"><y>#</y><d>2017-07-17</d><h>15:07</h><w>mtnygard</w><a>@chris_johnson</a> Do you mean the Datomic log?</z><z id="t1500305763" t="chris_johnson [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I do - or some way to get an asOf version of the database for a given :query"><y>#</y><d>2017-07-17</d><h>15:36</h><w>chris_johnson</w><a>@mtnygard</a> I do - or some way to get an <code>asOf</code> version of the database for a given <code>:query</code></z><z id="t1500305816" t="mtnygard There&apos;s a way, with just a little bit of trickiness."><y>#</y><d>2017-07-17</d><h>15:36</h><w>mtnygard</w>There&apos;s a way, with just a little bit of trickiness.</z><z id="t1500305820" t="chris_johnson That&apos;s fine"><y>#</y><d>2017-07-17</d><h>15:37</h><w>chris_johnson</w>That&apos;s fine</z><z id="t1500305832" t="chris_johnson I was just about to say &quot;It doesn&apos;t have to be easy&quot; hehe"><y>#</y><d>2017-07-17</d><h>15:37</h><w>chris_johnson</w>I was just about to say &quot;It doesn&apos;t have to be easy&quot; hehe</z><z id="t1500305839" t="mtnygard The #vase/query action will use whatever database is present in the context map."><y>#</y><d>2017-07-17</d><h>15:37</h><w>mtnygard</w>The <code>#vase/query</code> action will use whatever database is present in the context map.</z><z id="t1500305892" t="mtnygard A very early interceptor puts the current db value in there via something like (assoc-in ctx [:request :db] (d/db conn))"><y>#</y><d>2017-07-17</d><h>15:38</h><w>mtnygard</w>A very early interceptor puts the current db value in there via something like <code>(assoc-in ctx [:request :db] (d/db conn))</code></z><z id="t1500305916" t="mtnygard But you could add an interceptor of your own to update that key with whatever db value you want."><y>#</y><d>2017-07-17</d><h>15:38</h><w>mtnygard</w>But you could add an interceptor of your own to update that key with whatever db value you want.</z><z id="t1500306002" t="mtnygard So something like (update-in ctx [:request :db] d/as-of (get-in ctx [:request :params :when])) might do the job"><y>#</y><d>2017-07-17</d><h>15:40</h><w>mtnygard</w>So something like <code>(update-in ctx [:request :db] d/as-of (get-in ctx [:request :params :when]))</code> might do the job</z><z id="t1500306035" t="chris_johnson That is precisely the information I needed - thank you! "><y>#</y><d>2017-07-17</d><h>15:40</h><w>chris_johnson</w>That is precisely the information I needed - thank you! </z><z id="t1500306047" t="mgrbyte Is :vase/norms the right place to describe partitions and &quot;seed-data&quot; in a vase app?"><y>#</y><d>2017-07-17</d><h>15:40</h><w>mgrbyte</w>Is <code>:vase/norms</code> the right place to describe partitions and &quot;seed-data&quot; in a vase app?</z><z id="t1500306069" t="mtnygard [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] Yep. That&apos;s exactly what I&apos;ve done in another API."><y>#</y><d>2017-07-17</d><h>15:41</h><w>mtnygard</w><a>@mgrbyte</a> Yep. That&apos;s exactly what I&apos;ve done in another API.</z><z id="t1500306097" t="mgrbyte thx [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I must be messing up the syntax 😛"><y>#</y><d>2017-07-17</d><h>15:41</h><w>mgrbyte</w>thx <a>@mtnygard</a> I must be messing up the syntax <b>😛</b></z><z id="t1500306124" t="mtnygard [:attrs {:href &quot;/_/_/users/U08715BSS&quot;}] I can take a look if you&apos;re able to make a gist or paste the code in a private message."><y>#</y><d>2017-07-17</d><h>15:42</h><w>mtnygard</w><a>@mgrbyte</a> I can take a look if you&apos;re able to make a gist or paste the code in a private message.</z><z id="t1500306132" t="chris_johnson (Context for interested parties: I am building some &quot;dashboard&quot; style endpoints off an existing Datomic db that eschews keeping timestamp attributes on entities in favor of being able to just to ask for the time slice you want)"><y>#</y><d>2017-07-17</d><h>15:42</h><w>chris_johnson</w>(Context for interested parties: I am building some &quot;dashboard&quot; style endpoints off an existing Datomic db that eschews keeping timestamp attributes on entities in favor of being able to just to ask for the time slice you want)</z><z id="t1500306153" t="mtnygard [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] Nice!"><y>#</y><d>2017-07-17</d><h>15:42</h><w>mtnygard</w><a>@chris_johnson</a> Nice!</z><z id="t1500306267" t="chris_johnson I am also very interested in the mention I saw of someone working on a Lambda provider for Pedestal for this project - pull the app page out into S3, Vase service in Lambda... if I get something like that built I will certainly report back to the group. :)"><y>#</y><d>2017-07-17</d><h>15:44</h><w>chris_johnson</w>I am also very interested in the mention I saw of someone working on a Lambda provider for Pedestal for this project - pull the app page out into S3, Vase service in Lambda... if I get something like that built I will certainly report back to the group. :)</z><z id="t1500306345" t="mtnygard [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] Paul deGrandis is working on that very thing. The last time I spoke to him, he said there was something subtle that had to be done with class loaders to get Lambda to be happy with Pedestal. I think his work is going to show up in Pedestal itself some time soon(-ish)."><y>#</y><d>2017-07-17</d><h>15:45</h><w>mtnygard</w><a>@chris_johnson</a> Paul deGrandis is working on that very thing. The last time I spoke to him, he said there was something subtle that had to be done with class loaders to get Lambda to be happy with Pedestal. I think his work is going to show up in Pedestal itself some time soon(-ish).</z><z id="t1500308152" t="lxsameer pedestal&apos;s way of logging is so annoying"><y>#</y><d>2017-07-17</d><h>16:15</h><w>lxsameer</w>pedestal&apos;s way of logging is so annoying</z><z id="t1500315383" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] can you clarify?"><y>#</y><d>2017-07-17</d><h>18:16</h><w>ddeaguiar</w><a>@lxsameer</a> can you clarify?</z><z id="t1500316027" t="chris_johnson So here’s something I have trouble knowing what I did wrong with:"><y>#</y><d>2017-07-17</d><h>18:27</h><w>chris_johnson</w>So here’s something I have trouble knowing what I did wrong with:</z><z id="t1500316062" t="chris_johnson given this interceptor: #vase/intercept {:name :my-awesome-api.v1/db-as-of :entry (fn [ctx] (let [db (-&gt; ctx :request :db) as-of (datomic.api/as-of db (get-in ctx [:request :params :when]))] (update-in ctx [:request :db] as-of)))}"><y>#</y><d>2017-07-17</d><h>18:27</h><w>chris_johnson</w>given this interceptor: <pre>#vase/intercept {:name :my-awesome-api.v1/db-as-of
                                                  :entry (fn [ctx]
                                                           (let [db (-&gt; ctx :request :db)
                                                                 as-of (datomic.api/as-of db (get-in ctx [:request :params :when]))]
                                                             (update-in ctx [:request :db] as-of)))}</pre></z><z id="t1500316083" t="chris_johnson I get ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 313} clojure.lang.ExceptionInfo: Interceptor Exception: Assert failed: (valid-interceptor? %) at clojure.core$ex_info.invokeStatic(core.clj:4725) "><y>#</y><d>2017-07-17</d><h>18:28</h><w>chris_johnson</w>I get <pre>ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 313}
clojure.lang.ExceptionInfo: Interceptor Exception: Assert failed: (valid-interceptor? %)
	at clojure.core$ex_info.invokeStatic(core.clj:4725)
</pre></z><z id="t1500316093" t="mtnygard One thing I see right away is :entry should be :enter"><y>#</y><d>2017-07-17</d><h>18:28</h><w>mtnygard</w>One thing I see right away is <code>:entry</code> should be <code>:enter</code></z><z id="t1500316101" t="chris_johnson haha"><y>#</y><d>2017-07-17</d><h>18:28</h><w>chris_johnson</w>haha</z><z id="t1500316238" t="chris_johnson Indeed, and the answer was right there in the stacktrace too, if only I had been able to look right at :entry and :enter and see that they were different. Brains: really good at lots of things! But not all the things."><y>#</y><d>2017-07-17</d><h>18:30</h><w>chris_johnson</w>Indeed, and the answer was right there in the stacktrace too, if only I had been able to look right at <code>:entry</code> and <code>:enter</code> and see that they were different. Brains: really good at lots of things! But not all the things.</z><z id="t1500317468" t="ddeaguiar Hmm, I’m getting errors when using clojure version 1.9.0-alpha15 and up with Pedestal version 0.5.2 . I’m not exactly sure why"><y>#</y><d>2017-07-17</d><h>18:51</h><w>ddeaguiar</w>Hmm, I’m getting errors when using clojure version <code>1.9.0-alpha15</code>and up with Pedestal version <code>0.5.2</code>. I’m not exactly sure why</z><z id="t1500317540" t="mtnygard what kind of errors?"><y>#</y><d>2017-07-17</d><h>18:52</h><w>mtnygard</w>what kind of errors?</z><z id="t1500317592" t="mtnygard Believe it or not, I think I&apos;ve seen that before."><y>#</y><d>2017-07-17</d><h>18:53</h><w>mtnygard</w>Believe it or not, I think I&apos;ve seen that before.</z><z id="t1500317601" t="ddeaguiar the clojure spec error eludes me…"><y>#</y><d>2017-07-17</d><h>18:53</h><w>ddeaguiar</w>the clojure spec error eludes me…</z><z id="t1500317614" t="mtnygard There was a version of core.async that pulled in a library that used bad syntax in a refer-clojure clause"><y>#</y><d>2017-07-17</d><h>18:53</h><w>mtnygard</w>There was a version of core.async that pulled in a library that used bad syntax in a refer-clojure clause</z><z id="t1500317629" t="mtnygard There&apos;s a newer core.async that depends on a newer version of that library that fixes the syntax"><y>#</y><d>2017-07-17</d><h>18:53</h><w>mtnygard</w>There&apos;s a newer core.async that depends on a newer version of that library that fixes the syntax</z><z id="t1500317648" t="ddeaguiar could it be that Pedestal depends on the old version?"><y>#</y><d>2017-07-17</d><h>18:54</h><w>ddeaguiar</w>could it be that Pedestal depends on the old version?</z><z id="t1500317660" t="mtnygard Do you have a direct dependency on core.async?"><y>#</y><d>2017-07-17</d><h>18:54</h><w>mtnygard</w>Do you have a direct dependency on core.async?</z><z id="t1500317678" t="mtnygard If not, then Pedestal 0.5.2 must depend on that older version."><y>#</y><d>2017-07-17</d><h>18:54</h><w>mtnygard</w>If not, then Pedestal 0.5.2 must depend on that older version.</z><z id="t1500317685" t="ddeaguiar I do not"><y>#</y><d>2017-07-17</d><h>18:54</h><w>ddeaguiar</w>I do not</z><z id="t1500317699" t="ddeaguiar I can exclude core.async and depend on the latest version to see"><y>#</y><d>2017-07-17</d><h>18:54</h><w>ddeaguiar</w>I can exclude core.async and depend on the latest version to see</z><z id="t1500317707" t="mtnygard See https://github.com/pedestal/pedestal/issues/505"><y>#</y><d>2017-07-17</d><h>18:55</h><w>mtnygard</w>See <a href="https://github.com/pedestal/pedestal/issues/505" target="_blank">https://github.com/pedestal/pedestal/issues/505</a></z><z id="t1500317724" t="ddeaguiar hah"><y>#</y><d>2017-07-17</d><h>18:55</h><w>ddeaguiar</w>hah</z><z id="t1500317734" t="ddeaguiar I was looking for an existing issue but I didn’t check the closed ones 😕"><y>#</y><d>2017-07-17</d><h>18:55</h><w>ddeaguiar</w>I was looking for an existing issue but I didn’t check the closed ones <b>😕</b></z><z id="t1500317756" t="mtnygard I wish we had a state for issues that was &quot;fixed but not released&quot;"><y>#</y><d>2017-07-17</d><h>18:55</h><w>mtnygard</w>I wish we had a state for issues that was &quot;fixed but not released&quot;</z><z id="t1500317766" t="ddeaguiar agree"><y>#</y><d>2017-07-17</d><h>18:56</h><w>ddeaguiar</w>agree</z><z id="t1500320137" t="chris_johnson For people intrigued or horrified by my questions this morning, here is the (apparently, I still have no tests around this) working interceptor to take in a path-param specifying a date and update your Vase route’s DB to be as-of that time: #vase/intercept {:name :your-awesome-api.v1/db-as-of :doc &quot;Takes a timestamp and updates the db for this request to be `as-of` that timestamp&quot; :enter (fn [ctx] (update-in ctx [:request :db] (constantly (datomic.api/as-of (get-in ctx [:request :db]) (clojure.instant/read-instant-date (get-in ctx [:request :path-params :when]))))))} Usage then looks like "><y>#</y><d>2017-07-17</d><h>19:35</h><w>chris_johnson</w>For people intrigued or horrified by my questions this morning, here is the (apparently, I still have no tests around this) working interceptor to take in a <code>path-param</code> specifying a date and update your Vase route’s DB to be <code>as-of</code> that time: 
<pre>#vase/intercept {:name :your-awesome-api.v1/db-as-of
       :doc &quot;Takes a timestamp and updates the db for this request to be `as-of` that timestamp&quot;
       :enter (fn [ctx]
                    (update-in ctx [:request :db] (constantly (datomic.api/as-of
                    (get-in ctx [:request :db])
                    (clojure.instant/read-instant-date (get-in ctx [:request :path-params :when]))))))}</pre>
Usage then looks like <code></code></z><z id="t1500320307" t="chris_johnson (assumes your route looks like some-query-route-as-of/:when )"><y>#</y><d>2017-07-17</d><h>19:38</h><w>chris_johnson</w>(assumes your route looks like <code>some-query-route-as-of/:when</code>)</z><z id="t1500367388" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] The way pedestal logging works is annoying as a library it should provide some means to customize its logging. Also it&apos;s hard to find what you what in those huge strings"><y>#</y><d>2017-07-18</d><h>08:43</h><w>lxsameer</w><a>@ddeaguiar</a> The way pedestal logging works is annoying as a library it should provide some means to customize its logging. Also it&apos;s hard to find what you what in those huge strings</z><z id="t1500386599" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] re: log customization, the pedestal.log library is just a wrapper around the slf4j-api. Pedestal services created via the pedestal-service lein template have a dependency on logback. Logging is configurable via the logback.xml config file. Is there something specific you are having trouble configuring?"><y>#</y><d>2017-07-18</d><h>14:03</h><w>ddeaguiar</w><a>@lxsameer</a> re: log customization, the pedestal.log library is just a wrapper around the slf4j-api. Pedestal services created via the <code>pedestal-service</code> lein template have a dependency on logback. Logging is configurable via the <code>logback.xml</code> config file. Is there something specific you are having trouble configuring?</z><z id="t1500386699" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] re: viewing the logs, I recommend using lnav ( http://lnav.org/ ). I’ve created a lnav formatter based on the lnav java formatter. You may find it useful. https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json"><y>#</y><d>2017-07-18</d><h>14:04</h><w>ddeaguiar</w><a>@lxsameer</a> re: viewing the logs, I recommend using lnav (<a href="http://lnav.org/" target="_blank">http://lnav.org/</a>). I’ve created a lnav formatter based on the lnav java formatter. You may find it useful. <a href="https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json" target="_blank">https://github.com/ddeaguiar/dotfiles/blob/master/shell/.lnav-formats/pedestal_log.json</a></z><z id="t1500386794" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yeah. As a library it would be nice for pedestal to instead of logging hand the logs to the user to handle and has a default handler . I know that sl4j is a wrapper and i can use other logger backend to setup my logging"><y>#</y><d>2017-07-18</d><h>14:06</h><w>lxsameer</w><a>@ddeaguiar</a> yeah. As a library it would be nice for pedestal to instead of logging hand the logs to the user to handle and has a default handler .  I know that sl4j is a wrapper and i can use other logger backend to setup my logging</z><z id="t1500386842" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] but that&apos;s not the case , because for example for my current use case, i don&apos;t want pedestal logging, so I have to either blacklist the namespace in my logger or change the way of logging"><y>#</y><d>2017-07-18</d><h>14:07</h><w>lxsameer</w><a>@ddeaguiar</a> but that&apos;s not the case , because for example for my current use case, i don&apos;t want pedestal logging, so I have to either blacklist the namespace in my logger or change the way of logging</z><z id="t1500386884" t="lxsameer but if pedestal instead of logging directly just send the log data to a function provided by the user"><y>#</y><d>2017-07-18</d><h>14:08</h><w>lxsameer</w>but if pedestal instead of logging directly just send the log data to a function provided by the user</z><z id="t1500386890" t="ddeaguiar If I understand correctly, you don’t want to see logging for any pedestal namespace, correct?"><y>#</y><d>2017-07-18</d><h>14:08</h><w>ddeaguiar</w>If I understand correctly, you don’t want to see logging for any pedestal namespace, correct?</z><z id="t1500386893" t="lxsameer it would be much easier to handle"><y>#</y><d>2017-07-18</d><h>14:08</h><w>lxsameer</w>it would be much easier to handle</z><z id="t1500386912" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] no, just some of them"><y>#</y><d>2017-07-18</d><h>14:08</h><w>lxsameer</w><a>@ddeaguiar</a> no, just some of them</z><z id="t1500387050" t="ddeaguiar Ok, so you’ve already mentioned one option which is to update your log config to suppress logging from specific namespaces."><y>#</y><d>2017-07-18</d><h>14:10</h><w>ddeaguiar</w>Ok, so you’ve already mentioned one option which is to update your log config to suppress logging from specific namespaces.</z><z id="t1500387074" t="ddeaguiar I personally find that to be a satisfactory solution. However, there is another option"><y>#</y><d>2017-07-18</d><h>14:11</h><w>ddeaguiar</w>I personally find that to be a satisfactory solution. However, there is another option</z><z id="t1500387101" t="ddeaguiar You can create your own logging implementation and plug it into Pedestal. All you have to do is implement a protocol https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L29"><y>#</y><d>2017-07-18</d><h>14:11</h><w>ddeaguiar</w>You can create your own logging implementation and plug it into Pedestal. All you have to do is implement a protocol <a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L29" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L29</a></z><z id="t1500387468" t="ddeaguiar Check out the ns doc-string for details on how to configure that: https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L14"><y>#</y><d>2017-07-18</d><h>14:17</h><w>ddeaguiar</w>Check out the ns doc-string for details on how to configure that: <a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L14" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L14</a></z><z id="t1500387505" t="ddeaguiar I think that provides the flexibility you are looking for"><y>#</y><d>2017-07-18</d><h>14:18</h><w>ddeaguiar</w>I think that provides the flexibility you are looking for</z><z id="t1500387617" t="lxsameer yeah it does . I&apos;ll return with my idea about how pedestals logging should be as soon as i done with it, It much easier to communicate via code 🙂"><y>#</y><d>2017-07-18</d><h>14:20</h><w>lxsameer</w>yeah it does . I&apos;ll return with my idea about how pedestals logging should be as soon as i done with it, It much easier to communicate via code <b>🙂</b></z><z id="t1500387747" t="ddeaguiar Sure! Glad to help and looking forward to seeing what you come up with 🙂"><y>#</y><d>2017-07-18</d><h>14:22</h><w>ddeaguiar</w>Sure! Glad to help and looking forward to seeing what you come up with <b>🙂</b></z><z id="t1500388377" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] are you a contributor to pedestal ?"><y>#</y><d>2017-07-18</d><h>14:32</h><w>lxsameer</w><a>@ddeaguiar</a> are you a contributor to pedestal ?</z><z id="t1500388419" t="ddeaguiar I’ve contributed but I’m not a core contributor"><y>#</y><d>2017-07-18</d><h>14:33</h><w>ddeaguiar</w>I’ve contributed but I’m not a core contributor</z><z id="t1500388582" t="lxsameer cool"><y>#</y><d>2017-07-18</d><h>14:36</h><w>lxsameer</w>cool</z><z id="t1500415224" t="vijayakkineni How do i point pedestal app to an external logback.xml file?"><y>#</y><d>2017-07-18</d><h>22:00</h><w>vijayakkineni</w>How do i point pedestal app to an external logback.xml file?</z><z id="t1500415632" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0XCDM327&quot;}] the log config needs to be on the classpath. If adding the config file to the resources dir does not suit your needs, you should be able to add the file to the classpath when starting the service. I suspect this can be done via java -classpath ... but I don’t have first hand experience with it."><y>#</y><d>2017-07-18</d><h>22:07</h><w>ddeaguiar</w><a>@vijayakkineni</a> the log config needs to be on the classpath. If adding the config file to the resources dir does not suit your needs, you should be able to add the file to the classpath when starting the service. I suspect this can be done via <code>java -classpath ...</code> but I don’t have first hand experience with it.</z><z id="t1500476838" t="vijayakkineni [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you"><y>#</y><d>2017-07-19</d><h>15:07</h><w>vijayakkineni</w><a>@ddeaguiar</a> thank you</z><z id="t1500476846" t="ddeaguiar np 🙂"><y>#</y><d>2017-07-19</d><h>15:07</h><w>ddeaguiar</w>np <b>🙂</b></z><z id="t1500510596" t="pedroteixeira hi, is there any sample in github with pedestal + reloaded.repl ? tried setup pedestal as a stuartsierra.component, but (reset) in repl but don&apos;t get code reloaded 😕 - i tried following the hint to ref routes by var on the guide, but didn&apos;t help"><y>#</y><d>2017-07-20</d><h>00:29</h><w>pedroteixeira</w>hi, is there any sample in github with pedestal + <code>reloaded.repl</code>? tried setup pedestal as a stuartsierra.component, but <code>(reset)</code> in repl but don&apos;t get code reloaded <b>😕</b> - i tried following the hint to ref routes by var on the guide, but didn&apos;t help</z><z id="t1500513384" t="bherrmann [:attrs {:href &quot;/_/_/users/U4WKQ1W8Y&quot;}] I&apos;m just using a stock pedestal app. When I update functions (via emacs/cider) they take immediate effect."><y>#</y><d>2017-07-20</d><h>01:16</h><w>bherrmann</w><a>@pedroteixeira</a> I&apos;m just using a stock pedestal app.   When I update functions (via emacs/cider) they take immediate effect.</z><z id="t1500514532" t="pedroteixeira ok.. I&apos;m testing Cursive (nrepl) but something is odd here, no changes to routes get reflected to jetty server 😕 I mostly followed the tips on http://pedestal.io/guides/pedestal-with-component but I&apos;m using latest 0.5.2, will probably have to go throught it again - not sure if it&apos;s related to nrepl + intellij"><y>#</y><d>2017-07-20</d><h>01:35</h><w>pedroteixeira</w>ok.. I&apos;m testing Cursive (nrepl) but something is odd here, no changes to routes get reflected to jetty server <b>😕</b>  I mostly followed the tips on <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a>  but I&apos;m using latest 0.5.2, will probably have to go throught it again - not sure if it&apos;s related to nrepl + intellij</z><z id="t1500514650" t="pedroteixeira right now, it seems to reload only if I stop/start the server"><y>#</y><d>2017-07-20</d><h>01:37</h><w>pedroteixeira</w>right now, it seems to reload only if I stop/start the server</z><z id="t1500515215" t="bherrmann huh. thats strangel"><y>#</y><d>2017-07-20</d><h>01:46</h><w>bherrmann</w>huh.  thats strangel</z><z id="t1500515244" t="bherrmann I&apos;d wonder if you simply did &quot;lein repl&apos; then did (run-dev)"><y>#</y><d>2017-07-20</d><h>01:47</h><w>bherrmann</w>I&apos;d wonder if you simply did &quot;lein repl&apos;  then did (run-dev)</z><z id="t1500515255" t="bherrmann you should see your service start"><y>#</y><d>2017-07-20</d><h>01:47</h><w>bherrmann</w>you should see your service start</z><z id="t1500515293" t="bherrmann then copy/paste in the cljs file that you have tweaked a function in... you should see that change."><y>#</y><d>2017-07-20</d><h>01:48</h><w>bherrmann</w>then copy/paste in the cljs file that you have tweaked a function in...  you should see that change.</z><z id="t1500515373" t="bherrmann I&apos;ve gone on this recent crusade that if you aren&apos;t REPLing changes to immediate effect, than you arent really doing clojure. A forcing function for me to use the REPL."><y>#</y><d>2017-07-20</d><h>01:49</h><w>bherrmann</w>I&apos;ve gone on this recent crusade that if you aren&apos;t REPLing changes to immediate effect, than you arent really doing clojure.     A forcing function for me to use the REPL.</z><z id="t1500515406" t="bherrmann Stu&apos;s recent presentation on this topic was interesting. He never leaves the repl... like for years.... https://vimeo.com/223309989"><y>#</y><d>2017-07-20</d><h>01:50</h><w>bherrmann</w>Stu&apos;s recent presentation on this topic was interesting.   He never leaves the repl... like for years....     <a href="https://vimeo.com/223309989" target="_blank">https://vimeo.com/223309989</a></z><z id="t1500532437" t="jimmy Thanks for the link. Enjoy every single talk from Stu"><y>#</y><d>2017-07-20</d><h>06:33</h><r>jimmy</r>Thanks for the link. Enjoy every single talk from Stu</z><z id="t1500647010" t="mtnygard Interested in a preview of Pedestal for Lambda? https://github.com/pedestal/pedestal/tree/aws-lambda"><y>#</y><d>2017-07-21</d><h>14:23</h><w>mtnygard</w>Interested in a preview of Pedestal for Lambda? <a href="https://github.com/pedestal/pedestal/tree/aws-lambda" target="_blank">https://github.com/pedestal/pedestal/tree/aws-lambda</a></z><z id="t1500647028" t="mtnygard Alpha-level for API stability, but it works and has a sample app"><y>#</y><d>2017-07-21</d><h>14:23</h><w>mtnygard</w>Alpha-level for API stability, but it works and has a sample app</z><z id="t1500647329" t="mtnygard Oops... sample app not pushed quite yet... will be there around noon Eastern Time in the US"><y>#</y><d>2017-07-21</d><h>14:28</h><w>mtnygard</w>Oops... sample app not pushed quite yet... will be there around noon Eastern Time in the US</z><z id="t1500649825" t="lxsameer has any one used immutant websocket and pedestal together ?"><y>#</y><d>2017-07-21</d><h>15:10</h><w>lxsameer</w>has any one used immutant websocket and pedestal together ?</z><z id="t1500651212" t="mtnygard Here&apos;s that sample: https://github.com/pedestal/pedestal/tree/aws-lambda/samples/aws-codestar-lambda Should work on CodeStar right out of the box"><y>#</y><d>2017-07-21</d><h>15:33</h><w>mtnygard</w>Here&apos;s that sample: <a href="https://github.com/pedestal/pedestal/tree/aws-lambda/samples/aws-codestar-lambda" target="_blank">https://github.com/pedestal/pedestal/tree/aws-lambda/samples/aws-codestar-lambda</a>

Should work on CodeStar right out of the box</z><z id="t1500651465" t="lxsameer this examples uses jetty right ? I&apos;m looking for an Immutant example, are their interface the same ?"><y>#</y><d>2017-07-21</d><h>15:37</h><w>lxsameer</w>this examples uses jetty right ? I&apos;m looking for an Immutant example, are their interface the same ?</z><z id="t1500652673" t="mtnygard [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] I was continuing my earlier message about Pedestal for Lamdba. Wasn&apos;t responding to you about Immutant, WS, and Pedestal. (I don&apos;t have such a sample.)"><y>#</y><d>2017-07-21</d><h>15:57</h><w>mtnygard</w><a>@lxsameer</a> I was continuing my earlier message about Pedestal for Lamdba. Wasn&apos;t responding to you about Immutant, WS, and Pedestal. (I don&apos;t have such a sample.)</z><z id="t1500653006" t="lxsameer Ow sorry man, my bad I should read the context 😛"><y>#</y><d>2017-07-21</d><h>16:03</h><w>lxsameer</w>Ow sorry man, my bad I should read the context <b>😛</b></z><z id="t1500669382" t="mitchelkuijpers Damn that is cool [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] so basically this makes lambda&apos;s locally available during development time and then you can deploy to aws lambda?"><y>#</y><d>2017-07-21</d><h>20:36</h><w>mitchelkuijpers</w>Damn that is cool <a>@mtnygard</a> so basically this makes lambda&apos;s locally available during development time and then you can deploy to aws lambda?</z><z id="t1500669493" t="mitchelkuijpers Does anyone here knows how to get timbre to log to logback via pedestal? (I am using a library that uses timbre) but it only logs empty strings"><y>#</y><d>2017-07-21</d><h>20:38</h><w>mitchelkuijpers</w>Does anyone here knows how to get timbre to log to logback via pedestal? (I am using a library that uses timbre) but it only logs empty strings</z><z id="t1500670675" t="mtnygard [:attrs {:href &quot;/_/_/users/U060GQK8U&quot;}] We don&apos;t guarantee that local dev will match real lambdas exactly, but that&apos;s the main idea. We&apos;re also looking at ways to streamline Pedestal apps on Lamdba for better performance/cost ratio."><y>#</y><d>2017-07-21</d><h>20:57</h><w>mtnygard</w><a>@mitchelkuijpers</a> We don&apos;t guarantee that local dev will match real lambdas exactly, but that&apos;s the main idea. We&apos;re also looking at ways to streamline Pedestal apps on Lamdba for better performance/cost ratio.</z><z id="t1500670700" t="mtnygard And it works with CodeStar so you can do everything really cloud native if you like."><y>#</y><d>2017-07-21</d><h>20:58</h><w>mtnygard</w>And it works with CodeStar so you can do everything really cloud native if you like.</z><z id="t1500673130" t="mitchelkuijpers Yeah we use cloudformation ourselves but it has some support for it? Not really sure what codestar is"><y>#</y><d>2017-07-21</d><h>21:38</h><w>mitchelkuijpers</w>Yeah we use cloudformation ourselves but it has some support for it? Not really sure what codestar is</z><z id="t1500673141" t="mitchelkuijpers Seems like an abstraction on top of it"><y>#</y><d>2017-07-21</d><h>21:39</h><w>mitchelkuijpers</w>Seems like an abstraction on top of it</z><z id="t1500673192" t="mtnygard CodeStar is https://aws.amazon.com/codestar/"><y>#</y><d>2017-07-21</d><h>21:39</h><w>mtnygard</w>CodeStar is <a href="https://aws.amazon.com/codestar/" target="_blank">https://aws.amazon.com/codestar/</a></z><z id="t1500673211" t="mtnygard Web driven IDE for AWS applications"><y>#</y><d>2017-07-21</d><h>21:40</h><w>mtnygard</w>Web driven IDE for AWS applications</z><z id="t1500673321" t="mitchelkuijpers Ah ok, is it very tied to codestar or is it just used for the example?"><y>#</y><d>2017-07-21</d><h>21:42</h><w>mitchelkuijpers</w>Ah ok, is it very tied to codestar or is it just used for the example?</z><z id="t1500673375" t="mtnygard Not tied. The new sample aims at AWS Lamdba. You can do local dev in your preferred IDE. You also have the option to use CodeStar."><y>#</y><d>2017-07-21</d><h>21:42</h><w>mtnygard</w>Not tied. The new sample aims at AWS Lamdba. You can do local dev in your preferred IDE. You also have the option to use CodeStar.</z><z id="t1500673397" t="mitchelkuijpers Ah cool"><y>#</y><d>2017-07-21</d><h>21:43</h><w>mitchelkuijpers</w>Ah cool</z><z id="t1500673419" t="mitchelkuijpers This was our main concern when looking at lambda, fixing the development flow"><y>#</y><d>2017-07-21</d><h>21:43</h><w>mitchelkuijpers</w>This was our main concern when looking at lambda, fixing the development flow</z><z id="t1500725643" t="souenzzo We can also do a response-for on pedestal with a lambda-like env, right?"><y>#</y><d>2017-07-22</d><h>12:14</h><w>souenzzo</w>We can also do a response-for on pedestal with a lambda-like env, right?</z><z id="t1500907935" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] If I’m reading your question correctly, then yes. Paul does all his dev locally in a REPL using response-for. Then he packages and deploys it as a lambda."><y>#</y><d>2017-07-24</d><h>14:52</h><w>mtnygard</w><a>@souenzzo</a> If I’m reading your question correctly, then yes. Paul does all his dev locally in a REPL using response-for. Then he packages and deploys it as a lambda.</z><z id="t1500944900" t="hlship I don&apos;t get the AWS Lambda idea ... doesn&apos;t Lambda start up a new container for each request? Or run a new command for each? Isn&apos;t that the worst possible thing with Clojure for JVM?"><y>#</y><d>2017-07-25</d><h>01:08</h><w>hlship</w>I don&apos;t get the AWS Lambda idea ... doesn&apos;t Lambda start up a new container for each request?  Or run a new command for each?  Isn&apos;t that the worst possible thing with Clojure for JVM?</z><z id="t1500944935" t="hlship Hopefully I&apos;m just unaware of some Lambda features."><y>#</y><d>2017-07-25</d><h>01:08</h><w>hlship</w>Hopefully I&apos;m just unaware of some Lambda features.</z><z id="t1500945070" t="hlship Ok, dived into the docs and now understand it a bit better. The container instance may stick around for a bit, but should still be stateless."><y>#</y><d>2017-07-25</d><h>01:11</h><w>hlship</w>Ok, dived into the docs and now understand it a bit better. The container instance may stick around for a bit, but should still be stateless.</z><z id="t1500945153" t="hlship http://docs.aws.amazon.com/lambda/latest/dg/lambda-introduction.html"><y>#</y><d>2017-07-25</d><h>01:12</h><w>hlship</w><a href="http://docs.aws.amazon.com/lambda/latest/dg/lambda-introduction.html" target="_blank">http://docs.aws.amazon.com/lambda/latest/dg/lambda-introduction.html</a></z><z id="t1500949567" t="danielcompton [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] yeah it sticks around for a while, depending on request rate"><y>#</y><d>2017-07-25</d><h>02:26</h><w>danielcompton</w><a>@hlship</a> yeah it sticks around for a while, depending on request rate</z><z id="t1500949658" t="danielcompton You&apos;d still be quite vulnerable to high startup latency"><y>#</y><d>2017-07-25</d><h>02:27</h><w>danielcompton</w>You&apos;d still be quite vulnerable to high startup latency</z><z id="t1500949711" t="danielcompton Also, AFAICT each request runs in a separate container, so if you have spikes in concurrency, they will either wait in line, or fire up another container https://stackoverflow.com/questions/38016683/aws-lambda-and-java-concurrency"><y>#</y><d>2017-07-25</d><h>02:28</h><w>danielcompton</w>Also, AFAICT each request runs in a separate container, so if you have spikes in concurrency, they will either wait in line, or fire up another container <a href="https://stackoverflow.com/questions/38016683/aws-lambda-and-java-concurrency" target="_blank">https://stackoverflow.com/questions/38016683/aws-lambda-and-java-concurrency</a></z><z id="t1500951004" t="andrewhr [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] if you have some time, I recently watched this talk[1] and found it quite informative. The TL;DR is that containers are snapshot and are long-lived, a [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] said, and can be reclaimed and restarted after some time - no matter what. [1]: https://www.youtube.com/watch?v=GINI0T8FPD4"><y>#</y><d>2017-07-25</d><h>02:50</h><w>andrewhr</w><a>@hlship</a> if you have some time, I recently watched this talk[1] and found it quite informative. The TL;DR is that containers are snapshot and are long-lived, a <a>@danielcompton</a> said, and can be reclaimed and restarted after some time - no matter what.

[1]: <a href="https://www.youtube.com/watch?v=GINI0T8FPD4" target="_blank">https://www.youtube.com/watch?v=GINI0T8FPD4</a></z><z id="t1501001473" t="mtnygard [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] [:attrs {:href &quot;/_/_/users/U051EUEUM&quot;}] [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] We will soon be able to choose Pedestal in CLJ or CLJS. Using CLJ on Lambda does suffer from startup time but throughput under load is better. CLJS starts up fast but doesn’t handle the same volume."><y>#</y><d>2017-07-25</d><h>16:51</h><w>mtnygard</w><a>@hlship</a> <a>@andrewhr</a> <a>@danielcompton</a>  We will soon be able to choose Pedestal in CLJ or CLJS. Using CLJ on Lambda does suffer from startup time but throughput under load is better. CLJS starts up fast but doesn’t handle the same volume.</z><z id="t1501001517" t="mtnygard So for bursty workload or low-volume apps, CLJS is going to be better. For continuous workload CLJ will be more cost effective and have higher throughput."><y>#</y><d>2017-07-25</d><h>16:51</h><w>mtnygard</w>So for bursty workload or low-volume apps, CLJS is going to be better. For continuous workload CLJ will be more cost effective and have higher throughput.</z><z id="t1501005471" t="mitchelkuijpers https://github.com/cognitect-labs/vase/pull/76 Is there any reason this is not merged? This currently prevents me from using vase 😞"><y>#</y><d>2017-07-25</d><h>17:57</h><w>mitchelkuijpers</w><a href="https://github.com/cognitect-labs/vase/pull/76" target="_blank">https://github.com/cognitect-labs/vase/pull/76</a> Is there any reason this is not merged? This currently prevents me from using vase <b>😞</b></z><z id="t1501013935" t="lxsameer apparently websocket support is not good enough, does any one know how can I get the session in the on-text callback ?"><y>#</y><d>2017-07-25</d><h>20:18</h><w>lxsameer</w>apparently websocket support is not good enough, does any one know how can I get the session in the <code>on-text</code> callback  ?</z><z id="t1501018605" t="hlship I hit some similar problems w.r.t. the way you set up web sockets. I hope to submit a PR that opens it up a bit for approaches that don&apos;t quite match what the current code supports. See https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal.clj#L390 and https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L359 for my approach."><y>#</y><d>2017-07-25</d><h>21:36</h><w>hlship</w>I hit some similar problems w.r.t. the way you set up web sockets.  I hope to submit a PR that opens it up a bit for approaches that don&apos;t quite match what the current code supports.  See <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal.clj#L390" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal.clj#L390</a> and <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L359" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/4b92d5caeb0289677d74c128ceb9445509da7733/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L359</a> for my approach.</z><z id="t1501018738" t="lxsameer Can I use pedestal router with a pure ring application ?"><y>#</y><d>2017-07-25</d><h>21:38</h><w>lxsameer</w>Can I use pedestal router with a pure ring application ?</z><z id="t1501077845" t="julianwegkamp [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] You can implement a custom WebSocketListener to get the context in ws callback"><y>#</y><d>2017-07-26</d><h>14:04</h><w>julianwegkamp</w><a>@lxsameer</a> You can implement a custom WebSocketListener to get the context in ws callback</z><z id="t1501096206" t="lxsameer is it easy to use Pedestal router in a pure ring application ?"><y>#</y><d>2017-07-26</d><h>19:10</h><w>lxsameer</w>is it easy to use Pedestal router in a pure ring application ?</z><z id="t1501096871" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] Pedestal exposes a router through an interceptor, which has different properties as compared to a middleware fn. There are a number of router implementations in the Pedestal code base and they all implement the Router protocol ( https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/router.clj#L15 ). However, the router implementations have certain expectations. Firstly, they take a collection of expanded routes. Secondly, find-route is executed against a request map that has, at minimum, a :path-info and :request-method key. I don’t think :path-info is a standard ring request key."><y>#</y><d>2017-07-26</d><h>19:21</h><w>ddeaguiar</w><a>@lxsameer</a> Pedestal exposes a router through an interceptor, which has different properties as compared to a middleware fn. There are a number of router implementations in the Pedestal code base and they all implement the <code>Router</code> protocol (<a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/router.clj#L15" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/router.clj#L15</a>). However, the router implementations have certain expectations. Firstly, they take a collection of expanded routes. Secondly, <code>find-route</code> is executed against a request map that has, at minimum, a <code>:path-info</code> and <code>:request-method</code> key. I don’t think <code>:path-info</code> is a standard ring request key.</z><z id="t1501096921" t="ddeaguiar The result of find-route is the matched route. It’s the responsibility of the caller to then execute the interceptor chain associated with it."><y>#</y><d>2017-07-26</d><h>19:22</h><w>ddeaguiar</w>The result of <code>find-route</code> is the matched route. It’s the responsibility of the caller to then execute the interceptor chain associated with it.</z><z id="t1501097015" t="ddeaguiar Pedestal’s router interceptor impl actually enqueues the interceptors from the matched route"><y>#</y><d>2017-07-26</d><h>19:23</h><w>ddeaguiar</w>Pedestal’s router interceptor impl actually enqueues the interceptors from the matched route</z><z id="t1501097081" t="ddeaguiar Given that, it may be possible to leverage a router implementation directly for it’s route matching capabilities"><y>#</y><d>2017-07-26</d><h>19:24</h><w>ddeaguiar</w>Given that, it may be possible to leverage a router implementation directly for it’s route matching capabilities</z><z id="t1501097129" t="lxsameer thanks"><y>#</y><d>2017-07-26</d><h>19:25</h><w>lxsameer</w>thanks</z><z id="t1501097139" t="ddeaguiar What’s really required for route matching from the expanded route is the :path key"><y>#</y><d>2017-07-26</d><h>19:25</h><w>ddeaguiar</w>What’s really required for route matching from the expanded route is the <code>:path</code> key</z><z id="t1501097153" t="lxsameer Apparently I have to give up on Pedestal and use ring instead"><y>#</y><d>2017-07-26</d><h>19:25</h><w>lxsameer</w>Apparently I have to give up on Pedestal and use ring instead</z><z id="t1501097163" t="ddeaguiar but you would still need to do some request map xform to create the add the :path-info key"><y>#</y><d>2017-07-26</d><h>19:26</h><w>ddeaguiar</w>but you would still need to do some request map xform to create the add the <code>:path-info</code> key</z><z id="t1501097247" t="ddeaguiar Here’s a snipped which captures the minimum requirements for route matching. I posted this sometime ago in response to a route testing inquiry https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae#file-route_testing-clj-L30 ."><y>#</y><d>2017-07-26</d><h>19:27</h><w>ddeaguiar</w>Here’s a snipped which captures the minimum requirements for route matching. I posted this sometime ago in response to a route testing inquiry <a href="https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae#file-route_testing-clj-L30" target="_blank">https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae#file-route_testing-clj-L30</a>.</z><z id="t1501097318" t="ddeaguiar I prefer Pedestal’s interceptor semantics over traditional middleware and found it fairly easy to port exiting middleware to interceptors"><y>#</y><d>2017-07-26</d><h>19:28</h><w>ddeaguiar</w>I prefer Pedestal’s interceptor semantics over traditional middleware and found it fairly easy to port exiting middleware to interceptors</z><z id="t1501097365" t="ddeaguiar I’ve also found that I’ve been able to use libraries in Pedestal that were built with ring in mind. Take Liberator as an example"><y>#</y><d>2017-07-26</d><h>19:29</h><w>ddeaguiar</w>I’ve also found that I’ve been able to use libraries in Pedestal that were built with ring in mind. Take Liberator as an example</z><z id="t1501097459" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks"><y>#</y><d>2017-07-26</d><h>19:30</h><w>lxsameer</w><a>@ddeaguiar</a> thanks</z><z id="t1501097481" t="ddeaguiar But I wouldn’t recommend mixing interceptors and middleware in an app because it would detract from the conceptual integrity of the system"><y>#</y><d>2017-07-26</d><h>19:31</h><w>ddeaguiar</w>But I wouldn’t recommend mixing interceptors and middleware in an app because it would detract from the conceptual integrity of the system</z><z id="t1501097485" t="ddeaguiar np"><y>#</y><d>2017-07-26</d><h>19:31</h><w>ddeaguiar</w>np</z><z id="t1501097486" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I think Pedestal is really cool, but there are several problems which really bother me"><y>#</y><d>2017-07-26</d><h>19:31</h><w>lxsameer</w><a>@ddeaguiar</a> I think Pedestal is really cool, but there are several problems which really bother me</z><z id="t1501097524" t="lxsameer for example websocket support is really awful at the moment, I ended up writing lots of enhancement to make it work as i want"><y>#</y><d>2017-07-26</d><h>19:32</h><w>lxsameer</w>for example websocket support is really awful at the moment, I ended up writing lots of enhancement to make it work as i want</z><z id="t1501097531" t="lxsameer documentation is not good"><y>#</y><d>2017-07-26</d><h>19:32</h><w>lxsameer</w>documentation is not good</z><z id="t1501097554" t="ddeaguiar I definitely recommend raising them and it would be best to do so in the Pedestal user group as commentary there is durable"><y>#</y><d>2017-07-26</d><h>19:32</h><w>ddeaguiar</w>I definitely recommend raising them and it would be best to do so in the Pedestal user group as commentary there is durable</z><z id="t1501097555" t="lxsameer But it&apos;s a really good choice to create a traditional web service"><y>#</y><d>2017-07-26</d><h>19:32</h><w>lxsameer</w>But it&apos;s a really good choice to create a traditional web service</z><z id="t1501097590" t="ddeaguiar Yes, documentation can definitely be improved and is something that I’ve been trying to help with. It’s just a bandwidth issue"><y>#</y><d>2017-07-26</d><h>19:33</h><w>ddeaguiar</w>Yes, documentation can definitely be improved and is something that I’ve been trying to help with. It’s just a bandwidth issue</z><z id="t1501097634" t="ddeaguiar I’ve not done much with the websocket implementation to develop an opinion just yet."><y>#</y><d>2017-07-26</d><h>19:33</h><w>ddeaguiar</w>I’ve not done much with the websocket implementation to develop an opinion just yet.</z><z id="t1501097732" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] , out of curiosity, do you have a websocket implementation you prefer which you can provide for comparison purposes?"><y>#</y><d>2017-07-26</d><h>19:35</h><w>ddeaguiar</w><a>@lxsameer</a>, out of curiosity, do you have a websocket implementation you prefer which you can provide for comparison purposes?</z><z id="t1501097836" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Immutant and jetty supports websocket but to be honest those are just some implementation which are low level . But as a cool tool I suggest Sente which is more like a higher level tool and"><y>#</y><d>2017-07-26</d><h>19:37</h><w>lxsameer</w><a>@ddeaguiar</a> Immutant and jetty supports websocket but to be honest those are just some implementation which are low level . But as a cool tool I suggest <code>Sente</code> which is more like a higher level tool and</z><z id="t1501097863" t="lxsameer supports several backends like immutant , http-kit, aleph and several others"><y>#</y><d>2017-07-26</d><h>19:37</h><w>lxsameer</w>supports several backends like immutant , http-kit, aleph and several others</z><z id="t1501097877" t="ddeaguiar I’ve heard of Sente. I’ll check it out, thanks"><y>#</y><d>2017-07-26</d><h>19:37</h><w>ddeaguiar</w>I’ve heard of Sente. I’ll check it out, thanks</z><z id="t1501097962" t="lxsameer 😉"><y>#</y><d>2017-07-26</d><h>19:39</h><w>lxsameer</w><b>😉</b></z><z id="t1501324132" t="andrea.crotti how do I actually get code reloading to work in Pedestal?"><y>#</y><d>2017-07-29</d><h>10:28</h><w>andrea.crotti</w>how do I actually get code reloading to work in Pedestal?</z><z id="t1501324153" t="andrea.crotti I just used the default template and used run-dev"><y>#</y><d>2017-07-29</d><h>10:29</h><w>andrea.crotti</w>I just used the default template and used <code>run-dev</code></z><z id="t1501324159" t="andrea.crotti (defn run-dev &quot;The entry-point for &apos;lein run-dev&apos;&quot; [&amp; args] (println &quot;\nCreating your [DEV] server...&quot;) (-&gt; service/service ;; start with production configuration (merge {:env :dev ;; do not block thread that starts web server ::server/join? false ;; Routes can be a function that resolve routes, ;; we can use this to set the routes to be reloadable ::server/routes #(route/expand-routes (deref #&apos;service/routes)) ;; all origins are allowed in dev mode ::server/allowed-origins {:creds true :allowed-origins (constantly true)}}) ;; Wire up interceptor chains server/default-interceptors server/dev-interceptors server/create-server server/start)) "><y>#</y><d>2017-07-29</d><h>10:29</h><w>andrea.crotti</w><pre>(defn run-dev
  &quot;The entry-point for &apos;lein run-dev&apos;&quot;
  [&amp; args]
  (println &quot;\nCreating your [DEV] server...&quot;)
  (-&gt; service/service ;; start with production configuration
      (merge {:env :dev
              ;; do not block thread that starts web server
              ::server/join? false
              ;; Routes can be a function that resolve routes,
              ;;  we can use this to set the routes to be reloadable
              ::server/routes #(route/expand-routes (deref #&apos;service/routes))
              ;; all origins are allowed in dev mode
              ::server/allowed-origins {:creds true :allowed-origins (constantly true)}})
      ;; Wire up interceptor chains
      server/default-interceptors
      server/dev-interceptors
      server/create-server
      server/start))
</pre></z><z id="t1501324172" t="andrea.crotti but it doesn&apos;t seem to be reload the code no matter what I do"><y>#</y><d>2017-07-29</d><h>10:29</h><w>andrea.crotti</w>but it doesn&apos;t seem to be reload the code no matter what I do</z><z id="t1501324234" t="andrea.crotti I&apos;m actually running the server in the terminal and use Emacs+cider, so the two things are not actually linked up, but I thought it would still reload when some code changes anyway"><y>#</y><d>2017-07-29</d><h>10:30</h><w>andrea.crotti</w>I&apos;m actually running the server in the terminal and use Emacs+cider, so the two things are not actually linked up, but I thought it would still reload when some code changes anyway</z><z id="t1501349775" t="ikitommi hmm… pedestal doesn’t work with the latest clojure.spec ? 0.5.2 fails with [org.clojure/clojure &quot;1.9.0-alpha17&quot;] due to a broken ns-form."><y>#</y><d>2017-07-29</d><h>17:36</h><w>ikitommi</w>hmm…  pedestal doesn’t work with the latest <code>clojure.spec</code>? <code>0.5.2</code> fails with <code>[org.clojure/clojure &quot;1.9.0-alpha17&quot;]</code> due to a broken ns-form.</z><z id="t1501353859" t="lxsameer are you sure? I&apos;m using it with the same version"><y>#</y><d>2017-07-29</d><h>18:44</h><w>lxsameer</w>are you sure? I&apos;m using it with the same version</z><z id="t1501353866" t="lxsameer what&apos;s the error message ?"><y>#</y><d>2017-07-29</d><h>18:44</h><w>lxsameer</w>what&apos;s the error message ?</z><z id="t1501368756" t="bherrmann [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] 1. Start emacs, 2. cider-jack-in 3. from in emacs from the cider-repl do (dev-run)"><y>#</y><d>2017-07-29</d><h>22:52</h><w>bherrmann</w><a>@andrea.crotti</a> 1. Start emacs, 2. cider-jack-in 3. from in emacs from the cider-repl do (dev-run)</z><z id="t1501436766" t="andrea.crotti ok thanks [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}]"><y>#</y><d>2017-07-30</d><h>17:46</h><w>andrea.crotti</w>ok thanks <a>@bherrmann</a></z><z id="t1501439105" t="ikitommi seems to come from the incubator project."><y>#</y><d>2017-07-30</d><h>18:25</h><w>ikitommi</w>seems to come from the incubator project.</z><z id="t1501508390" t="ikitommi [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] oh, too long stack trace, there is was… and works with the latest core.async, thanks!"><y>#</y><d>2017-07-31</d><h>13:39</h><w>ikitommi</w><a>@souenzzo</a> oh, too long stack trace, there is was… and works with the latest core.async, thanks!</z><z id="t1501508519" t="chris_johnson So, the Pedestal/AWS Lambda example ...how is one meant to run that with Datomic Pro, exactly? I have tried everything I can think of to make CodeStar aware of the Datomic repo and my login/pw for it and so far all my builds have failed at the step where the datomic-pro-&lt;ver&gt; jar is sought."><y>#</y><d>2017-07-31</d><h>13:41</h><w>chris_johnson</w>So, the Pedestal/AWS Lambda example ...how is one meant to run that with Datomic Pro, exactly? I have tried everything I can think of to make CodeStar aware of the Datomic repo and my login/pw for it and so far all my builds have failed at the step where the <code>datomic-pro-&lt;ver&gt;</code> jar is sought.</z><z id="t1501508571" t="chris_johnson Is it kosher to push that up in the repo and just copy it into /root/.m2/repository in an install step? Is there a working example of a combination of settings.xml and some project file (Boot or Lein) that is known to work? "><y>#</y><d>2017-07-31</d><h>13:42</h><w>chris_johnson</w>Is it kosher to push that up in the repo and just copy it into <code>/root/.m2/repository</code> in an <code>install</code> step? Is there a working example of a combination of <code>settings.xml</code> and some project file (Boot or Lein) that is known to work? </z><z id="t1501508600" t="chris_johnson I really want to have a production-ready Lambda service and this last step is killing me 😄 "><y>#</y><d>2017-07-31</d><h>13:43</h><w>chris_johnson</w>I really want to have a production-ready Lambda service and this last step is killing me <b>😄</b> </z><z id="t1501535899" t="johnj Is the pedestal&apos;s ring dependency just used for reusing ring middleware or is there more to it?"><y>#</y><d>2017-07-31</d><h>21:18</h><w>johnj</w>Is the pedestal&apos;s ring dependency just used for reusing ring middleware or is there more to it?</z><z id="t1501684095" t="mtnygard [:attrs {:href &quot;/_/_/users/U4R5K5M0A&quot;}] It&apos;s just for the middleware."><y>#</y><d>2017-08-02</d><h>14:28</h><w>mtnygard</w><a>@lockdown-</a> It&apos;s just for the middleware.</z><z id="t1501684129" t="mtnygard [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] I can&apos;t answer those questions, but if you post them to the pedestal-users mailing list, Paul will be able to answer them."><y>#</y><d>2017-08-02</d><h>14:28</h><w>mtnygard</w><a>@chris_johnson</a> I can&apos;t answer those questions, but if you post them to the pedestal-users mailing list, Paul will be able to answer them.</z><z id="t1501684841" t="chris_johnson [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I think I sorted it out, but I want to get my fully-operational thing operational before I come back with &quot;I did it!&quot; There are definitely some tweaks needed to the infrastructure files in the example. I will post to the mailing list once I am certain I&apos;ve actually got the problem surrounded. Thanks for the pointer!"><y>#</y><d>2017-08-02</d><h>14:40</h><w>chris_johnson</w><a>@mtnygard</a> I think I sorted it out, but I want to get my fully-operational thing operational before I come back with &quot;I did it!&quot; There are definitely some tweaks needed to the infrastructure files in the example. I will post to the mailing list once I am certain I&apos;ve actually got the problem surrounded. Thanks for the pointer!</z><z id="t1501822474" t="v3ga does anyone here have any pedestal examples on github? like a full out blog or some other web app with persistent backing? postgres?"><y>#</y><d>2017-08-04</d><h>04:54</h><w>v3ga</w>does anyone here have any pedestal examples on github? like a full out blog or some other web app with persistent backing? postgres?</z><z id="t1501841156" t="thegeez [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] This uses pedestal with postgres: http://thegeez.net/2016/09/22/trello_clone_clone_in_clojure.html (disclaimer: my own blog)"><y>#</y><d>2017-08-04</d><h>10:05</h><w>thegeez</w><a>@decim</a> This uses pedestal with postgres: <a href="http://thegeez.net/2016/09/22/trello_clone_clone_in_clojure.html" target="_blank">http://thegeez.net/2016/09/22/trello_clone_clone_in_clojure.html</a> (disclaimer: my own blog)</z><z id="t1502060358" t="v3ga thanks!"><y>#</y><d>2017-08-06</d><h>22:59</h><r>v3ga</r>thanks!</z><z id="t1502400784" t="v3ga anyone willing to help/guide a pedestal/clojure newbie in getting a basic html page via hiccup “or inline” served? I’m pretty sure i’m going completely in the wrong direction. https://gist.github.com/anonymous/c4de71f08f3993143c67cbee3e0205d7"><y>#</y><d>2017-08-10</d><h>21:33</h><w>v3ga</w>anyone willing to help/guide a pedestal/clojure newbie in getting a basic html page via hiccup “or inline” served? I’m pretty sure i’m going completely in the wrong direction. <a href="https://gist.github.com/anonymous/c4de71f08f3993143c67cbee3e0205d7" target="_blank">https://gist.github.com/anonymous/c4de71f08f3993143c67cbee3e0205d7</a></z><z id="t1502460192" t="souenzzo You may use interceptors http://pedestal.io/reference/interceptors For example [&quot;/&quot; :get [hiccup-&gt;html homapage] :route-name ::homepage]] Where: (def hiccup-&gt;html {:name ::hiccup-&gt;html :leave (fn [ctx] (update-in [:response :body] the-hiccup-fn))}) And homepage returns just the [:div &quot;hiccup&quot;] divs"><y>#</y><d>2017-08-11</d><h>14:03</h><w>souenzzo</w>You may use interceptors
<a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a>
For example
<code>[&quot;/&quot; :get [hiccup-&gt;html homapage] :route-name ::homepage]]</code>
Where:
<code>(def hiccup-&gt;html {:name ::hiccup-&gt;html :leave (fn [ctx] (update-in [:response :body] the-hiccup-fn))})</code>
And <code>homepage</code> returns just the <code>[:div &quot;hiccup&quot;]</code> divs</z><z id="t1502631897" t="andrea.crotti I just switched from ring to pedestal"><y>#</y><d>2017-08-13</d><h>13:44</h><w>andrea.crotti</w>I just switched from ring to pedestal</z><z id="t1502631922" t="andrea.crotti and realised that doing so I lost my sentry integration which was done with this https://github.com/sethtrain/raven-clj"><y>#</y><d>2017-08-13</d><h>13:45</h><w>andrea.crotti</w>and realised that doing so I lost my sentry integration which was done with this <a href="https://github.com/sethtrain/raven-clj" target="_blank">https://github.com/sethtrain/raven-clj</a></z><z id="t1502631937" t="andrea.crotti is it possible to use the same wrap-sentry logic somehow?"><y>#</y><d>2017-08-13</d><h>13:45</h><w>andrea.crotti</w>is it possible to use the same <code>wrap-sentry</code> logic somehow?</z><z id="t1502907939" t="souenzzo there is somehow to get a now /`instant` from context? (maybe from servlet)."><y>#</y><d>2017-08-16</d><h>18:25</h><w>souenzzo</w>there is somehow to get a <code>now</code>/`instant` from context? (maybe from servlet).</z><z id="t1502917433" t="bherrmann user=&gt; (System/currentTimeMillis) 1502917425089"><y>#</y><d>2017-08-16</d><h>21:03</h><w>bherrmann</w>user=&gt; (System/currentTimeMillis)
1502917425089</z><z id="t1502932052" t="souenzzo is possible to get the same value that is used on Date: header?"><y>#</y><d>2017-08-17</d><h>01:07</h><r>souenzzo</r>is possible to get the same value that is used on <code>Date:</code> header?</z><z id="t1502974704" t="bherrmann I&apos;m not sure what you are asking. You mean you want it (the instance) formatted like,"><y>#</y><d>2017-08-17</d><h>12:58</h><r>bherrmann</r>I&apos;m not sure what you are asking.    You mean you want it (the instance) formatted like,</z><z id="t1502974705" t="bherrmann Date: Wed, 15 Nov 1995 06:25:24 GMT"><y>#</y><d>2017-08-17</d><h>12:58</h><r>bherrmann</r>Date: Wed, 15 Nov 1995 06:25:24 GMT</z><z id="t1502974786" t="bherrmann Humm ... for java 8 stack overflow says,"><y>#</y><d>2017-08-17</d><h>12:59</h><r>bherrmann</r>Humm ... for java 8 stack overflow says,</z><z id="t1502974787" t="bherrmann Instant instant = Instant.now(); String formatted = DateTimeFormatter.RFC_1123_DATE_TIME .withZone(ZoneOffset.UTC) .format(instant); System.out.println(formatted);"><y>#</y><d>2017-08-17</d><h>12:59</h><r>bherrmann</r>Instant instant = Instant.now();
String formatted = DateTimeFormatter.RFC_1123_DATE_TIME
        .withZone(ZoneOffset.UTC)
        .format(instant);
System.out.println(formatted);</z><z id="t1502974794" t="bherrmann https://stackoverflow.com/questions/7707555/getting-date-in-http-format-in-java"><y>#</y><d>2017-08-17</d><h>12:59</h><r>bherrmann</r><a href="https://stackoverflow.com/questions/7707555/getting-date-in-http-format-in-java" target="_blank">https://stackoverflow.com/questions/7707555/getting-date-in-http-format-in-java</a></z><z id="t1502977775" t="souenzzo Nooo. I want the same instant. Same var. My actual code (assoc-in ctx [:request :inst] (time/now)) . I want to know if is possible to do: (assoc-in ctx [:request :inst] (.getTime servlet)) . Just to audit the same time as used in jetty/http. But I&apos;m not sure if it&apos;s generated after or before my interceptor chain, nor where it &quot;stored&quot;."><y>#</y><d>2017-08-17</d><h>13:49</h><r>souenzzo</r>Nooo. I want the same instant. Same var. My actual code <code>(assoc-in ctx [:request :inst] (time/now))</code>. I want to know if is possible to do: <code>(assoc-in ctx [:request :inst] (.getTime servlet))</code>. Just to audit the same time as used in jetty/http. But I&apos;m not sure if it&apos;s generated after or before my interceptor chain, nor where it &quot;stored&quot;.</z><z id="t1503066175" t="bherrmann I would view the jar and see if the files are included in the jar"><y>#</y><d>2017-08-18</d><h>14:22</h><w>bherrmann</w>I would view the jar and see if the files are included in the jar</z><z id="t1503066195" t="bherrmann Then I might look at how to access the data (via a classloader) when running from in the jar"><y>#</y><d>2017-08-18</d><h>14:23</h><w>bherrmann</w>Then I might look at how to access the data (via a classloader) when running from in the jar</z><z id="t1503066257" t="bherrmann [:attrs {:href &quot;/_/_/users/U0BLKQC3Y&quot;}] probably something like: (slurp ( http://clojure.java.io/resource &quot;META-INF/MANIFEST.MF&quot;))"><y>#</y><d>2017-08-18</d><h>14:24</h><w>bherrmann</w><a>@dsapoetra</a> probably something like: (slurp (<a href="http://clojure.java.io/resource" target="_blank">http://clojure.java.io/resource</a> &quot;META-INF/MANIFEST.MF&quot;))</z><z id="t1503207680" t="ikitommi Morning. I’m comparing routing libraries, bumped into this in my test data. Surely a bad practise, but I believe it should still work. Bug or intentional? (require &apos;[io.pedestal.http.route.definition.table :as table]) (require &apos;[io.pedestal.http.route.map-tree :as map-tree]) (require &apos;[io.pedestal.http.route.router :as router]) (router/find-route (map-tree/router (table/table-routes [[&quot;/:a&quot; :get (constantly &quot;&quot;) :route-name ::ping] [&quot;/evil/ping&quot; :get (constantly &quot;&quot;) :route-name ::evil-ping]])) {:path-info &quot;/evil/ping&quot; :request-method :get}) ; nil "><y>#</y><d>2017-08-20</d><h>05:41</h><w>ikitommi</w>Morning. I’m comparing routing libraries, bumped into this in my test data. Surely a bad practise, but I believe it should still work. Bug or intentional?
<pre>(require &apos;[io.pedestal.http.route.definition.table :as table])
(require &apos;[io.pedestal.http.route.map-tree :as map-tree])
(require &apos;[io.pedestal.http.route.router :as router])

(router/find-route
  (map-tree/router
    (table/table-routes
      [[&quot;/:a&quot; :get (constantly &quot;&quot;) :route-name ::ping]
       [&quot;/evil/ping&quot; :get (constantly &quot;&quot;) :route-name ::evil-ping]]))
  {:path-info &quot;/evil/ping&quot; :request-method :get})
; nil
</pre></z><z id="t1503492485" t="pwrflx hi! anyone has an example of using figwheel together with pedestal? My specific problem is, that in the project.clj there is the key :ring-handler, which I&apos;m not sure how to set up in case of pedestal.. I guess somehow it should be wired to the router, similar in case of ring/compojure"><y>#</y><d>2017-08-23</d><h>12:48</h><w>pwrflx</w>hi! anyone has an example of using figwheel together with pedestal? My specific problem is, that in the project.clj there is the key :ring-handler, which I&apos;m not sure how to set up in case of pedestal.. I guess somehow it should be wired to the router, similar in case of ring/compojure</z><z id="t1503513378" t="thegeez [:attrs {:href &quot;/_/_/users/U4AH3T9QA&quot;}] I use figwheel with pedestal, but I don&apos;t run lein figwheel . I run cljs-repl and cljs-start in the repl to start figwheel. And with (go) / (reset) etc I start pedestal with a component system: https://github.com/thegeez/clj-board/blob/master/dev/clj/user.clj"><y>#</y><d>2017-08-23</d><h>18:36</h><w>thegeez</w><a>@pwrflx</a> I use figwheel with pedestal, but I don&apos;t run <code>lein figwheel</code>. I run <code>cljs-repl</code> and <code>cljs-start</code> in the repl to start figwheel. And with <code>(go) / (reset)</code> etc I start pedestal with a component system: <a href="https://github.com/thegeez/clj-board/blob/master/dev/clj/user.clj" target="_blank">https://github.com/thegeez/clj-board/blob/master/dev/clj/user.clj</a></z><z id="t1503565323" t="pwrflx [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] I see, so you are bringing up your own jetty and then make figwheel work on that, instead of asking figwheel to bring up it&apos;s own jetty and configure your routes in addition to what figwheel needs. Right?"><y>#</y><d>2017-08-24</d><h>09:02</h><w>pwrflx</w><a>@thegeez</a> I see, so you are bringing up your own jetty and then make figwheel work on that, instead of asking figwheel to bring up it&apos;s own jetty and configure your routes in addition to what figwheel needs. Right?</z><z id="t1503569478" t="thegeez [:attrs {:href &quot;/_/_/users/U4AH3T9QA&quot;}] no, figwheel start its own jetty and the pedestal app also starts its own jetty. No routes/handlers from the pedestal app are served by figwheel in my setup"><y>#</y><d>2017-08-24</d><h>10:11</h><w>thegeez</w><a>@pwrflx</a> no, figwheel start its own jetty and the pedestal app also starts its own jetty. No routes/handlers from the pedestal app are served by figwheel in my setup</z><z id="t1503569622" t="pwrflx [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] Didn&apos;t you constantly run into cross-origin issues with that? I mean the javascript running will need to use the API provided by pedestal that&apos;s on a different origin (in practice it&apos;s both localhost but the port number is different, which was enough to trigger cross-origin issues for me..)"><y>#</y><d>2017-08-24</d><h>10:13</h><w>pwrflx</w><a>@thegeez</a> Didn&apos;t you constantly run into cross-origin issues with that? I mean the javascript running will need to use the API provided by pedestal that&apos;s on a different origin (in practice it&apos;s both localhost but the port number is different, which was enough to trigger cross-origin issues for me..)</z><z id="t1503570146" t="thegeez I see no warning/error about that in chrome. Also figwheel only sends messages to reload js sources. Any calls in those js sources are to the same app origin (port 8080 for the app in dev). figwheel uses port 3449"><y>#</y><d>2017-08-24</d><h>10:22</h><w>thegeez</w>I see no warning/error about that in chrome. Also figwheel only sends messages to reload js sources. Any calls in those js sources are to the same app origin (port 8080 for the app in dev). figwheel uses port 3449</z><z id="t1503570342" t="pwrflx [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] ah ok I start to get it now. You&apos;re using pedestal&apos;s Jetty to both server the API and all javascript resources. Figwheel&apos;s jetty is just used to have the connection to the repl and notify the browser to reload the javascript (and that reloading I guess also takes place on 8080)"><y>#</y><d>2017-08-24</d><h>10:25</h><w>pwrflx</w><a>@thegeez</a> ah ok I start to get it now. You&apos;re using pedestal&apos;s Jetty to both server the API and all javascript resources. Figwheel&apos;s jetty is just used to have the connection to the repl and notify the browser to reload the javascript (and that reloading I guess also takes place on 8080)</z><z id="t1503570493" t="thegeez yes"><y>#</y><d>2017-08-24</d><h>10:28</h><w>thegeez</w>yes</z><z id="t1503572634" t="pwrflx [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] this sounds cool. Will give it a try! thanks!"><y>#</y><d>2017-08-24</d><h>11:03</h><w>pwrflx</w><a>@thegeez</a>  this sounds cool. Will give it a try! thanks!</z><z id="t1503646730" t="andrea.crotti I was trying to use webjars in my pedestal project"><y>#</y><d>2017-08-25</d><h>07:38</h><w>andrea.crotti</w>I was trying to use webjars in my pedestal project</z><z id="t1503646738" t="andrea.crotti following an example luminus project which does that"><y>#</y><d>2017-08-25</d><h>07:38</h><w>andrea.crotti</w>following an example luminus project which does that</z><z id="t1503646750" t="andrea.crotti but then I realised it also needs ring-webjar to get it working"><y>#</y><d>2017-08-25</d><h>07:39</h><w>andrea.crotti</w>but then I realised it also needs ring-webjar to get it working</z><z id="t1503646767" t="andrea.crotti can I still use the same thing also with pedestal?"><y>#</y><d>2017-08-25</d><h>07:39</h><w>andrea.crotti</w>can I still use the same thing also with pedestal?</z><z id="t1503651769" t="thegeez [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] this is how I use webjars with pedestal: https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/service.clj#L73 and the lines below"><y>#</y><d>2017-08-25</d><h>09:02</h><w>thegeez</w><a>@andrea.crotti</a> this is how I use webjars with pedestal: <a href="https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/service.clj#L73" target="_blank">https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/service.clj#L73</a> and the lines below</z><z id="t1503652209" t="andrea.crotti Ah nice and easy"><y>#</y><d>2017-08-25</d><h>09:10</h><w>andrea.crotti</w>Ah nice and easy</z><z id="t1504030352" t="slpssm Sorry if this is a FAQ, I just can’t find and answer. Is there a way to set a base path for the router? So if I set up a base route of /foo , and define a route in a router table /bar , the final route is /foo/bar ?"><y>#</y><d>2017-08-29</d><h>18:12</h><w>slpssm</w>Sorry if this is a FAQ, I just can’t find and answer. Is there a way to set a base path for the router? So if I set up a base route of <code>/foo</code>, and define a route in a router table <code>/bar</code>, the final route is <code>/foo/bar</code>?</z><z id="t1504030476" t="slpssm I should mention that I’m new to pedestal. I should also say I’m actually trying to set a base path for lacinia-pedestal. I’d like to use /s/graphql rather than /graphql as the exposed endpoint."><y>#</y><d>2017-08-29</d><h>18:14</h><w>slpssm</w>I should mention that I’m new to pedestal. I should also say I’m actually trying to set a base path for lacinia-pedestal. I’d like to use <code>/s/graphql</code> rather than <code>/graphql</code> as the exposed endpoint.</z><z id="t1504036260" t="slpssm I think this is going to take a pull request to lacinia-pedestal since the javascript is hard coded to /graphql"><y>#</y><d>2017-08-29</d><h>19:51</h><w>slpssm</w>I think this is going to take a pull request to lacinia-pedestal since the javascript is hard coded to <code>/graphql</code></z><z id="t1504097031" t="slpssm Actually, I wouldn’t mind knowing the answer to this. Is it possible to set a base path?"><y>#</y><d>2017-08-30</d><h>12:43</h><w>slpssm</w>Actually, I wouldn’t mind knowing the answer to this. Is it possible to set a base path?</z><z id="t1504110073" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U553KK0QH&quot;}] . It’s not possible to set a base path directly, in the way that you’re asking. But, if you can get to the route data structure before creating the server (or calling expand-routes directly) then you can use ordinary Clojure data functions to manipulate the routes."><y>#</y><d>2017-08-30</d><h>16:21</h><w>mtnygard</w>Hi <a>@slpssm</a>. It’s not possible to set a base path directly, in the way that you’re asking. But, if you can get to the route data structure before creating the server (or calling expand-routes directly) then you can use ordinary Clojure data functions to manipulate the routes.</z><z id="t1504110146" t="mtnygard For example, with table route syntax, the path is the first part of every route so you could map (update 0 #(str base %)) across the table."><y>#</y><d>2017-08-30</d><h>16:22</h><w>mtnygard</w>For example, with table route syntax, the path is the first part of every route so you could map <code>(update 0 #(str base %))</code> across the table.</z><z id="t1504118599" t="slpssm [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Yup! That’s exactly what I did. 🙂"><y>#</y><d>2017-08-30</d><h>18:43</h><w>slpssm</w><a>@mtnygard</a> Yup! That’s exactly what I did. <b>🙂</b></z><z id="t1504489668" t="eoliphant Hi, I’,m just getting into vase and I’m wondering how schema updates are managed. It looks like conformity is being used to manage transacting in the norms. So, now if I add some new attributes to :myservice/my-schema they aren’t transacted in"><y>#</y><d>2017-09-04</d><h>01:47</h><w>eoliphant</w>Hi, I’,m just getting into vase and I’m wondering how schema updates are managed.  It looks like conformity is being used to manage transacting in the norms.  So,  now if I add some new attributes to <code>:myservice/my-schema</code> they aren’t transacted in</z><z id="t1504525247" t="andrzejsliwa Hey, I wonder if there is any debugging interceptor/middleware for pedestal? I mean showing always request body, params, headers etc?"><y>#</y><d>2017-09-04</d><h>11:40</h><w>andrzejsliwa</w>Hey, I wonder if there is any debugging interceptor/middleware for pedestal? I mean showing always request body, params, headers etc?</z><z id="t1504525294" t="andrzejsliwa + status, timing, method etc"><y>#</y><d>2017-09-04</d><h>11:41</h><w>andrzejsliwa</w>+ status, timing, method etc</z><z id="t1504525418" t="andrzejsliwa should i just make intereceptor which will print request value?"><y>#</y><d>2017-09-04</d><h>11:43</h><w>andrzejsliwa</w>should i just make intereceptor which will print request value?</z></g><g id="s9"><z id="t1504550125" t="andrewhr The default log-request ( https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L80 ) could maybe have a debug or trace clause to spit the whole request data. Maybe it doesn’t to avoid leaking sensitive information on misconfigured services?"><y>#</y><d>2017-09-04</d><h>18:35</h><w>andrewhr</w>The default <code>log-request</code> (<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L80" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L80</a>) could maybe have a debug or trace clause to spit the whole request data. Maybe it doesn’t to avoid leaking sensitive information on misconfigured services?</z><z id="t1504557383" t="souenzzo It &quot;safe&quot;/usual use (binding [config/*conn* conn] (response-for ...)) (not sure if all respose-for will be in the same &quot;thread stack&quot;)"><y>#</y><d>2017-09-04</d><h>20:36</h><w>souenzzo</w>It &quot;safe&quot;/usual use <code>(binding [config/*conn* conn] (response-for ...))</code> (not sure if all respose-for will be in the same &quot;thread stack&quot;)</z><z id="t1504626059" t="souenzzo Up 😞"><y>#</y><d>2017-09-05</d><h>15:40</h><r>souenzzo</r>Up <b>😞</b></z><z id="t1504626059" t="souenzzo Up 😞"><y>#</y><d>2017-09-05</d><h>15:40</h><w>souenzzo</w>Up <b>😞</b></z><z id="t1504863556" t="mitchelkuijpers Does anyone know if there is a clojurescript counterpart or a cljc implementation somewhere of the route matching from pedestal? I would like to reuse routes on client and server"><y>#</y><d>2017-09-08</d><h>09:39</h><w>mitchelkuijpers</w>Does anyone know if there is a clojurescript counterpart or a cljc implementation somewhere of the route matching from pedestal? I would like to reuse routes on client and server</z><z id="t1504873192" t="bherrmann My understanding is that pedestal is being made to run on all clojurescript. So that work is happening somewhere."><y>#</y><d>2017-09-08</d><h>12:19</h><w>bherrmann</w>My understanding is that pedestal is being made to run on all clojurescript.   So that work is happening somewhere.</z><z id="t1504874058" t="ikitommi the whole pedestal stack or just the routing? e.g. node &amp;/ the browser?"><y>#</y><d>2017-09-08</d><h>12:34</h><w>ikitommi</w>the whole pedestal stack or just the routing? e.g. node &amp;/ the browser?</z><z id="t1504877063" t="bherrmann My understanding is you will be able to deploy a pedestal app to AWS lambda, and choose the Java or Javascript edition of lambda"><y>#</y><d>2017-09-08</d><h>13:24</h><w>bherrmann</w>My understanding is you will be able to deploy a pedestal app to AWS lambda, and choose the Java or Javascript edition of lambda</z><z id="t1504964636" t="martinklepsch I know that at least Interceptors (which routing is also built on top of) are not .cljc yet. [:attrs {:href &quot;/_/_/users/U060GQK8U&quot;}]"><y>#</y><d>2017-09-09</d><h>13:43</h><w>martinklepsch</w>I know that at least Interceptors (which routing is also built on top of) are not .cljc yet. <a>@mitchelkuijpers</a></z><z id="t1504975991" t="mitchelkuijpers Thnx [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I found bide which kind of has the same routine syntax so I can share some routes between client and server"><y>#</y><d>2017-09-09</d><h>16:53</h><w>mitchelkuijpers</w>Thnx <a>@martinklepsch</a>  I found bide which kind of has the same routine syntax so I can share some routes between client and server</z><z id="t1505386207" t="kommen I have a rather basic question regarding interceptors:"><y>#</y><d>2017-09-14</d><h>10:50</h><w>kommen</w>I have a rather basic question regarding interceptors:</z><z id="t1505386212" t="kommen (defn attach-database [uri] (let [conn (db/connect uri)] {:name ::attach-database :enter #(assoc % ::connection conn ::db (d/db conn))}))"><y>#</y><d>2017-09-14</d><h>10:50</h><w>kommen</w><pre>(defn attach-database [uri]
  (let [conn (db/connect uri)]
    {:name ::attach-database
     :enter #(assoc % ::connection conn ::db (d/db conn))}))</pre></z><z id="t1505386216" t="kommen as per http://pedestal.io/reference/interceptors"><y>#</y><d>2017-09-14</d><h>10:50</h><w>kommen</w>as per <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1505386227" t="kommen but later:"><y>#</y><d>2017-09-14</d><h>10:50</h><w>kommen</w>but later:</z><z id="t1505386228" t="kommen &gt; A handler does not have access to the full execution context. Therefore, it cannot manipulate the interceptor queue or stack."><y>#</y><d>2017-09-14</d><h>10:50</h><w>kommen</w>&gt; A handler does not have access to the full execution context. Therefore, it cannot manipulate the interceptor queue or stack.</z><z id="t1505386354" t="kommen so how is the handler supposed to use the database? the way I’d do it would be to then just to assoc the db onto the request instead of the context, but I was wondering what’s best practice for this"><y>#</y><d>2017-09-14</d><h>10:52</h><w>kommen</w>so how is the handler supposed to use the database? the way I’d do it would be to then just to assoc the db onto the request instead of the context, but I was wondering what’s best practice for this</z><z id="t1505387476" t="martinklepsch [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] hey 🙂 I haven’t used Interceptors for HTTP much but the request is just part of the context. When you define your handler, can you tell where the :request is taken out/put back in?"><y>#</y><d>2017-09-14</d><h>11:11</h><w>martinklepsch</w><a>@kommen</a> hey <b>🙂</b> I haven’t used Interceptors for HTTP much but the request is just part of the context. When you define your handler, can you tell where the <code>:request</code> is taken out/put back in?</z><z id="t1505387679" t="martinklepsch [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] I skimmed the docs for a bit but couldn’t find any places where this was done implicitly"><y>#</y><d>2017-09-14</d><h>11:14</h><w>martinklepsch</w><a>@kommen</a> I skimmed the docs for a bit but couldn’t find any places where this was done implicitly</z><z id="t1505387694" t="martinklepsch [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] here are some examples of injecting a db-connection also http://pedestal.io/guides/your-first-api"><y>#</y><d>2017-09-14</d><h>11:14</h><w>martinklepsch</w><a>@kommen</a> here are some examples of injecting a db-connection also <a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a></z><z id="t1505389042" t="kommen [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] yes, the request is just part of the context, but I was wondering because of the example above if adding it there is considered good practice"><y>#</y><d>2017-09-14</d><h>11:37</h><w>kommen</w><a>@martinklepsch</a> yes, the request is just part of the context, but I was wondering because of the example above if adding it there is considered good practice</z><z id="t1505389096" t="martinklepsch [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] I don’t thing there’s anything inherently wrong with it but you may want to restrict handlers to only receive the request so that they cannot meddle with the queue/stack"><y>#</y><d>2017-09-14</d><h>11:38</h><w>martinklepsch</w><a>@kommen</a> I don’t thing there’s anything inherently wrong with it but you may want to restrict handlers to only receive the request so that they cannot meddle with the queue/stack</z><z id="t1505389150" t="kommen doing all the processing in the interceptors as in the your-first-api example is interesting, but really doesn’t sit right for me as it seems it loads the routes table with a lot of logic"><y>#</y><d>2017-09-14</d><h>11:39</h><w>kommen</w>doing all the processing in the interceptors as in the your-first-api example is interesting, but really doesn’t sit right for me as it seems it loads the routes table with a lot of logic</z><z id="t1505389243" t="kommen [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] ok, thanks a lot for your opinion!"><y>#</y><d>2017-09-14</d><h>11:40</h><w>kommen</w><a>@martinklepsch</a> ok, thanks a lot for your opinion!</z><z id="t1505389320" t="martinklepsch &gt; it loads the routes table with a lot of logic not sure I understand - the table is still just data but the processing of requests is done with interceptors, right?"><y>#</y><d>2017-09-14</d><h>11:42</h><w>martinklepsch</w>&gt; it loads the routes table with a lot of logic
 not sure I understand - the table is still just data but the processing of requests is done with interceptors, right?</z><z id="t1505389419" t="martinklepsch as far as I understand all “processing” is done via interceptors — unlike with middleware there isn’t really this one function at the center of things"><y>#</y><d>2017-09-14</d><h>11:43</h><w>martinklepsch</w>as far as I understand all “processing” is done via interceptors — unlike with middleware there isn’t really this one function at the center of things</z><z id="t1505389575" t="kommen I meant that routes end up like this:"><y>#</y><d>2017-09-14</d><h>11:46</h><w>kommen</w>I meant that routes end up like this:</z><z id="t1505389579" t="kommen [&quot;/todo/:list-id&quot; :get [entity-render db-interceptor list-view]] [&quot;/todo/:list-id&quot; :post [entity-render list-item-view db-interceptor list-item-create]] [&quot;/todo/:list-id/:item-id&quot; :get [entity-render list-item-view db-interceptor]]"><y>#</y><d>2017-09-14</d><h>11:46</h><w>kommen</w><pre>[&quot;/todo/:list-id&quot;           :get    [entity-render db-interceptor list-view]]
     [&quot;/todo/:list-id&quot;           :post   [entity-render list-item-view db-interceptor list-item-create]]
     [&quot;/todo/:list-id/:item-id&quot;  :get    [entity-render list-item-view db-interceptor]]</pre></z><z id="t1505389698" t="kommen which seems to me it will be easy to miss stuff here. but I might also be missing something still"><y>#</y><d>2017-09-14</d><h>11:48</h><w>kommen</w>which seems to me it will be easy to miss stuff here. but I might also be missing something still</z><z id="t1505390581" t="martinklepsch [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] I’d expect there to be ways to add interceptors to a selection of routes but even if not you still can use functions to provide the list of interceptors"><y>#</y><d>2017-09-14</d><h>12:03</h><w>martinklepsch</w><a>@kommen</a> I’d expect there to be ways to add interceptors to a selection of routes but even if not you still can use functions to provide the list of interceptors</z><z id="t1505488134" t="mtnygard [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] If you&apos;re using handlers, then it is totally fine to assoc the DB and connection onto the request."><y>#</y><d>2017-09-15</d><h>15:08</h><w>mtnygard</w><a>@kommen</a> If you&apos;re using handlers, then it is totally fine to assoc the DB and connection onto the request.</z><z id="t1505488152" t="mtnygard We support handler functions because they&apos;re familiar to people who come from Ring or Rack"><y>#</y><d>2017-09-15</d><h>15:09</h><w>mtnygard</w>We support handler functions because they&apos;re familiar to people who come from Ring or Rack</z><z id="t1505488194" t="mtnygard But a handler function really just gets wrapped into an interceptor that passes the request to the handler and assoc&apos;s the return as the response. In other words, it&apos;s purely a convenience."><y>#</y><d>2017-09-15</d><h>15:09</h><w>mtnygard</w>But a handler function really just gets wrapped into an interceptor that passes the request to the handler and assoc&apos;s the return as the response. In other words, it&apos;s purely a convenience.</z><z id="t1505488231" t="mtnygard In my own apps, I don&apos;t use handlers. I just write everything as interceptors. I find that gives me more opportunities to make small interceptors that I can recompose for different routes. (That&apos;s what the example in your-first-api does.)"><y>#</y><d>2017-09-15</d><h>15:10</h><w>mtnygard</w>In my own apps, I don&apos;t use handlers. I just write everything as interceptors. I find that gives me more opportunities to make small interceptors that I can recompose for different routes. (That&apos;s what the example in your-first-api does.)</z><z id="t1505555494" t="kommen [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks a lot!"><y>#</y><d>2017-09-16</d><h>09:51</h><w>kommen</w><a>@mtnygard</a> thanks a lot!</z><z id="t1505785426" t="cap10morgan Is there a way to plug a pedestal service (routes and all) into lein-figwheel&apos;s ring-handler?"><y>#</y><d>2017-09-19</d><h>01:43</h><w>cap10morgan</w>Is there a way to plug a pedestal service (routes and all) into lein-figwheel&apos;s ring-handler?</z><z id="t1505824321" t="mtnygard [:attrs {:href &quot;/_/_/users/U06FS3DLH&quot;}] I&apos;m not sure what that means. I&apos;ve used lein-figwheel, but just for serving up the CLJS app. I normally run the back end (with Pedestal) in a separate process."><y>#</y><d>2017-09-19</d><h>12:32</h><w>mtnygard</w><a>@cap10morgan</a> I&apos;m not sure what that means. I&apos;ve used lein-figwheel, but just for serving up the CLJS app. I normally run the back end (with Pedestal) in a separate process.</z><z id="t1505831253" t="cap10morgan [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Yeah, that&apos;s what I&apos;m trying to avoid (the separate process). lein-figwheel has a :ring-handler value you can set in project.clj, but I&apos;d love to have it go through my pedestal routes, etc. rather than having to plug it into the ring-handler-esque guts of an interceptor (i.e. just the fn of a request that returns a response). My goal is to keep things simple for my team. The more I can give them one command to run (ideally the one that everyone else&apos;s examples online also run) to spin up their dev environments, the better. So if lein figwheel could be made to interact with the pedestal service w/o needing to run a separate command, that would be great (even if it&apos;s not via :ring-handler )."><y>#</y><d>2017-09-19</d><h>14:27</h><w>cap10morgan</w><a>@mtnygard</a> Yeah, that&apos;s what I&apos;m trying to avoid (the separate process). lein-figwheel has a <code>:ring-handler</code> value you can set in project.clj, but I&apos;d love to have it go through my pedestal routes, etc. rather than having to plug it into the ring-handler-esque guts of an interceptor (i.e. just the fn of a request that returns a response). My goal is to keep things simple for my team. The more I can give them one command to run (ideally the one that everyone else&apos;s examples online also run) to spin up their dev environments, the better. So if <code>lein figwheel</code> could be made to interact with the pedestal service w/o needing to run a separate command, that would be great (even if it&apos;s not via <code>:ring-handler</code>).</z><z id="t1505831473" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06FS3DLH&quot;}] here’s the link I meant to post re: Figwheel + Component: https://github.com/bhauman/lein-figwheel#scripting-with-component"><y>#</y><d>2017-09-19</d><h>14:31</h><w>ddeaguiar</w><a>@cap10morgan</a> here’s the link I meant to post re: Figwheel + Component: <a href="https://github.com/bhauman/lein-figwheel#scripting-with-component" target="_blank">https://github.com/bhauman/lein-figwheel#scripting-with-component</a></z><z id="t1505831484" t="ddeaguiar That may be useful to you"><y>#</y><d>2017-09-19</d><h>14:31</h><w>ddeaguiar</w>That may be useful to you</z><z id="t1505831549" t="cap10morgan [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks I&apos;ll check it out"><y>#</y><d>2017-09-19</d><h>14:32</h><w>cap10morgan</w><a>@ddeaguiar</a> thanks I&apos;ll check it out</z><z id="t1505831700" t="cap10morgan The message I&apos;m getting is that neither pedestal nor (lein-)figwheel are going to help me do this. 🙂 This is a helpful starting point for achieving a similar goal though, so thanks."><y>#</y><d>2017-09-19</d><h>14:35</h><w>cap10morgan</w>The message I&apos;m getting is that neither pedestal nor (lein-)figwheel are going to help me do this. <b>🙂</b> This is a helpful starting point for achieving a similar goal though, so thanks.</z><z id="t1505849819" t="john I&apos;m using ring-redis-session ( https://github.com/clojusc/ring-redis-session ) with pedestal and the :session/key of the request parameter does not appear to be accessible anywhere (that I can find) until a second request comes through. Has anyone experienced anything like that?"><y>#</y><d>2017-09-19</d><h>19:36</h><w>john</w>I&apos;m using ring-redis-session (<a href="https://github.com/clojusc/ring-redis-session" target="_blank">https://github.com/clojusc/ring-redis-session</a>) with pedestal and the <code>:session/key</code>of the request parameter does not appear to be accessible anywhere (that I can find) until a second request comes through. Has anyone experienced anything like that?</z><z id="t1505849997" t="mtnygard [:attrs {:href &quot;/_/_/users/U050PJ2EU&quot;}] That sounds very strange. How is the client sending that parameter?"><y>#</y><d>2017-09-19</d><h>19:39</h><w>mtnygard</w><a>@john</a> That sounds very strange. How is the client sending that parameter?</z><z id="t1505850220" t="john [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I thought the ring-redis-session middleware was attaching the session key to :session/key in :request on the server side."><y>#</y><d>2017-09-19</d><h>19:43</h><w>john</w><a>@mtnygard</a> I thought the ring-redis-session middleware was attaching the session key to <code>:session/key</code> in <code>:request</code> on the server side.</z><z id="t1505850245" t="mtnygard Hmm. OK, let me look at the source for that library for a second."><y>#</y><d>2017-09-19</d><h>19:44</h><w>mtnygard</w>Hmm. OK, let me look at the source for that library for a second.</z><z id="t1505850336" t="john Thanks! One more strange aspect: the :session/key always remains nil unless I add some content to :request :session in some interceptor"><y>#</y><d>2017-09-19</d><h>19:45</h><w>john</w>Thanks! One more strange aspect: the <code>:session/key</code> always remains <code>nil</code> unless I add some content to <code>:request :session</code> in some interceptor</z><z id="t1505850449" t="mtnygard I’m looking https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L24 at ring-sesison"><y>#</y><d>2017-09-19</d><h>19:47</h><w>mtnygard</w>I’m looking <a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L24" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L24</a> at ring-sesison</z><z id="t1505850481" t="mtnygard In bare-session-request, it only attaches the :session/key if an existing session was found."><y>#</y><d>2017-09-19</d><h>19:48</h><w>mtnygard</w>In bare-session-request, it only attaches the :session/key if an existing session was found.</z><z id="t1505850487" t="john It could be that the initial request is required so that my dummy data in the :session key gets placed. Then the second request succeeds. However, if I try to put data in the :session key very early in the interceptor chain, that does not suffice."><y>#</y><d>2017-09-19</d><h>19:48</h><w>john</w>It could be that the initial request is required so that my dummy data in the <code>:session</code> key gets placed. Then the second request succeeds. However, if I try to put data in the <code>:session</code> key very early in the interceptor chain, that does not suffice.</z><z id="t1505850489" t="mtnygard So on the first request, there isn’t a session yet"><y>#</y><d>2017-09-19</d><h>19:48</h><w>mtnygard</w>So on the first request, there isn’t a session yet</z><z id="t1505850496" t="john ah"><y>#</y><d>2017-09-19</d><h>19:48</h><w>john</w>ah</z><z id="t1505850517" t="mtnygard Your handler can return a response with a session, at which point ring-session will send that cookie down. The client returns it on the next request and bare-session-handler finds the existing session for you"><y>#</y><d>2017-09-19</d><h>19:48</h><w>mtnygard</w>Your handler can return a response with a session, at which point ring-session will send that cookie down. The client returns it on the next request and bare-session-handler finds the existing session for you</z><z id="t1505850539" t="mtnygard A caution: if you ever return a response with no session, then any existing session gets deleted!"><y>#</y><d>2017-09-19</d><h>19:48</h><w>mtnygard</w>A caution: if you ever return a response with no session, then any existing session gets deleted!</z><z id="t1505850553" t="john understood"><y>#</y><d>2017-09-19</d><h>19:49</h><w>john</w>understood</z><z id="t1505850763" t="john Thanks!"><y>#</y><d>2017-09-19</d><h>19:52</h><w>john</w>Thanks!</z><z id="t1505850775" t="mtnygard yw"><y>#</y><d>2017-09-19</d><h>19:52</h><w>mtnygard</w>yw</z><z id="t1505908238" t="souenzzo There is some cljs alternative for pedestal?"><y>#</y><d>2017-09-20</d><h>11:50</h><w>souenzzo</w>There is some cljs alternative for pedestal?</z><z id="t1505911221" t="andrewhr I only know about https://github.com/frankiesardo/tripod . Never used, though - just a thing on my radar"><y>#</y><d>2017-09-20</d><h>12:40</h><w>andrewhr</w>I only know about <a href="https://github.com/frankiesardo/tripod" target="_blank">https://github.com/frankiesardo/tripod</a>. Never used, though - just a thing on my radar</z><z id="t1505920299" t="souenzzo tnks!"><y>#</y><d>2017-09-20</d><h>15:11</h><r>souenzzo</r>tnks!</z><z id="t1505980623" t="mitchelkuijpers wow thank you [:attrs {:href &quot;/_/_/users/U051EUEUM&quot;}] this was exactly what I was looking for"><y>#</y><d>2017-09-21</d><h>07:57</h><w>mitchelkuijpers</w>wow thank you <a>@andrewhr</a> this was exactly what I was looking for</z><z id="t1506000102" t="souenzzo You&apos;re using it for what? &quot;mock&quot; a server?"><y>#</y><d>2017-09-21</d><h>13:21</h><r>souenzzo</r>You&apos;re using it for what?
&quot;mock&quot; a server?</z><z id="t1506466342" t="kenny Is there a way to set cookies when using io.pedestal.test/response-for ?"><y>#</y><d>2017-09-26</d><h>22:52</h><w>kenny</w>Is there a way to set cookies when using <code>io.pedestal.test/response-for</code>?</z><z id="t1506466759" t="kenny Looks like it&apos;s possible by reversing https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L54 though that&apos;ll be a bit of a pain."><y>#</y><d>2017-09-26</d><h>22:59</h><w>kenny</w>Looks like it&apos;s possible by reversing <a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L54" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L54</a> though that&apos;ll be a bit of a pain.</z><z id="t1506466903" t="danielcompton [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] I&apos;ve done some similar reverse engineering with Yada"><y>#</y><d>2017-09-26</d><h>23:01</h><w>danielcompton</w><a>@kenny</a> I&apos;ve done some similar reverse engineering with Yada</z><z id="t1506466914" t="danielcompton another option possibly for integration testing is kerodon/peridot"><y>#</y><d>2017-09-26</d><h>23:01</h><w>danielcompton</w>another option possibly for integration testing is kerodon/peridot</z><z id="t1506466985" t="kenny Not at integration testing yet 😉"><y>#</y><d>2017-09-26</d><h>23:03</h><w>kenny</w>Not at integration testing yet <b>😉</b></z><z id="t1506467819" t="kenny For those curious, it&apos;s pretty simple: (test/response-for service :post &quot;/command&quot; :headers {&quot;cookie&quot; &quot;access-token=compute.test.jwt&quot;}) "><y>#</y><d>2017-09-26</d><h>23:16</h><w>kenny</w>For those curious, it&apos;s pretty simple: 
<pre>(test/response-for service :post &quot;/command&quot; :headers {&quot;cookie&quot; &quot;access-token=compute.test.jwt&quot;})
</pre></z><z id="t1506468777" t="kenny And a handy function for creating such headers: (defn cookie-header [cookie-map] {&quot;cookie&quot; (str/join &quot;;&quot; (map (partial str/join &quot;=&quot;) cookie-map))}) "><y>#</y><d>2017-09-26</d><h>23:32</h><w>kenny</w>And a handy function for creating such headers: 
<pre>(defn cookie-header
  [cookie-map]
  {&quot;cookie&quot; (str/join &quot;;&quot; (map (partial str/join &quot;=&quot;) cookie-map))})
</pre></z><z id="t1506524056" t="mtnygard I often end up creating a double handful of functions to build various kinds of requests."><y>#</y><d>2017-09-27</d><h>14:54</h><w>mtnygard</w>I often end up creating a double handful of functions to build various kinds of requests.</z><z id="t1506524075" t="mtnygard Cookies, different content types, auth headers, etc."><y>#</y><d>2017-09-27</d><h>14:54</h><w>mtnygard</w>Cookies, different content types, auth headers, etc.</z><z id="t1506718785" t="viniciushana Hey, quick one but I feel like I&apos;m missing something terribly obvious: I&apos;m defining routes using table syntax, but I&apos;m a pickle trying to make Pedestal find out route names by the handlers. A simple sample is: (defn current-version [{{config :config} :components}] {:status 200 :body {:version (config/version config)}}) ... [&quot;/api/version&quot; :get (conj public-interceptors current-version)] Above code breaks that the last interceptor had no name and there is no explicit :route-name . What could be done differently on the handler function to allow Pedestal to infer the route name? I was under the impression that it used the symbol&apos;s name but that doesn&apos;t seem to be the case."><y>#</y><d>2017-09-29</d><h>20:59</h><w>viniciushana</w>Hey, quick one but I feel like I&apos;m missing something terribly obvious: I&apos;m defining routes using table syntax, but I&apos;m a pickle trying to make Pedestal find out route names by the handlers. A simple sample is:
 <pre>(defn current-version
  [{{config :config} :components}]
  {:status 200 :body {:version (config/version config)}})

...
 
[&quot;/api/version&quot; :get (conj public-interceptors current-version)]
</pre>

Above code breaks that the last interceptor had no name and there is no explicit <code>:route-name</code>.
What could be done differently on the handler function to allow Pedestal to infer the route name? I was under the impression that it used the symbol&apos;s name but that doesn&apos;t seem to be the case.</z><z id="t1506720698" t="viniciushana Got it: I gotta provide the handler fn as a symbol (with a backquote), then it works."><y>#</y><d>2017-09-29</d><h>21:31</h><w>viniciushana</w>Got it: I gotta provide the handler fn as a symbol (with a backquote), then it works.</z><z id="t1506720730" t="viniciushana [&quot;/api/version&quot; :get (conj public-interceptors `current-version)] "><y>#</y><d>2017-09-29</d><h>21:32</h><w>viniciushana</w><pre>[&quot;/api/version&quot; :get (conj public-interceptors `current-version)]
</pre></z><z id="t1506955451" t="zclj Does anyone have information of how content-security-policy in pedestal should be configured to allow for an om-next SPA to run?"><y>#</y><d>2017-10-02</d><h>14:44</h><w>zclj</w>Does anyone have information of how content-security-policy in pedestal should be configured to allow for an om-next SPA to run?</z><z id="t1506955523" t="mtnygard [:attrs {:href &quot;/_/_/users/U1G8B7ZD3&quot;}] I don’t, but I’m checking with Paul."><y>#</y><d>2017-10-02</d><h>14:45</h><w>mtnygard</w><a>@zclj</a> I don’t, but I’m checking with Paul.</z><z id="t1506955756" t="mtnygard Paul does have an answer. I’ll relay it once he’s done with a client call."><y>#</y><d>2017-10-02</d><h>14:49</h><w>mtnygard</w>Paul does have an answer. I’ll relay it once he’s done with a client call.</z><z id="t1506956096" t="zclj [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] ok, thanks!"><y>#</y><d>2017-10-02</d><h>14:54</h><w>zclj</w><a>@mtnygard</a> ok, thanks!</z><z id="t1506961776" t="mtnygard [:attrs {:href &quot;/_/_/users/U1G8B7ZD3&quot;}] From Paul deGrandis: Ultimately, you’ll want to tailor the CSP policy to your application (Only expose what you’re using).  You can start with the most general policy as mentioned here: https://github.com/pedestal/pedestal/issues/499 On master, the dev-mode setup for CSP is much more relaxed than when running in “Prod” mode, as mentioned on this issue: https://github.com/pedestal/pedestal/pull/522 The new Service Template makes suggestions about in the service map around common options"><y>#</y><d>2017-10-02</d><h>16:29</h><w>mtnygard</w><a>@zclj</a> From Paul deGrandis: Ultimately, you’ll want to tailor the CSP policy to your application (Only expose what you’re using).  You can start with the most general policy as mentioned here: <a href="https://github.com/pedestal/pedestal/issues/499" target="_blank">https://github.com/pedestal/pedestal/issues/499</a>

On master, the dev-mode setup for CSP is much more relaxed than when running in “Prod” mode, as mentioned on this issue: <a href="https://github.com/pedestal/pedestal/pull/522" target="_blank">https://github.com/pedestal/pedestal/pull/522</a>

The new Service Template makes suggestions about in the service map around common options</z><z id="t1506968257" t="zclj [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thanks to you and Paul for the resources, I will dig into them and learn more"><y>#</y><d>2017-10-02</d><h>18:17</h><w>zclj</w><a>@mtnygard</a> Thanks to you and Paul for the resources, I will dig into them and learn more</z><z id="t1507042056" t="mtnygard Pedestal 0.5.3 is released"><y>#</y><d>2017-10-03</d><h>14:47</h><w>mtnygard</w>Pedestal 0.5.3 is released</z><z id="t1507054859" t="schmudde I’m new to Pedestal and finding this section on http://pedestal.io , Connecting to a Running Application ( http://pedestal.io/guides/developing-at-the-repl#_connecting_to_a_running_application ), a little empty-ish. Any recommendations on alternative tutorials? I’m not seeing much satisfactory via the Googles."><y>#</y><d>2017-10-03</d><h>18:20</h><w>schmudde</w>I’m new to Pedestal and finding this section on <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>, Connecting to a Running Application (<a href="http://pedestal.io/guides/developing-at-the-repl#_connecting_to_a_running_application" target="_blank">http://pedestal.io/guides/developing-at-the-repl#_connecting_to_a_running_application</a>), a little empty-ish. Any recommendations on alternative tutorials? I’m not seeing much satisfactory via the Googles.</z><z id="t1507056424" t="bherrmann [:attrs {:href &quot;/_/_/users/U0EKLAMGW&quot;}] I use emacs/cider with pedestal... works great."><y>#</y><d>2017-10-03</d><h>18:47</h><w>bherrmann</w><a>@schmudde</a> I use emacs/cider with pedestal... works great.</z><z id="t1507056564" t="schmudde [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] - that’s what I’m doing, and I got through the rest of the tutorial, works great! But, when trying to use it with an existing codebase/running application, I’m having a little trouble. For example, do you ever use response-for ?"><y>#</y><d>2017-10-03</d><h>18:49</h><w>schmudde</w><a>@bherrmann</a> - that’s what I’m doing, and I got through the rest of the tutorial, works great! But, when trying to use it with an existing codebase/running application, I’m having a little trouble. For example, do you ever use <code>response-for</code>?</z><z id="t1507056602" t="bherrmann [:attrs {:href &quot;/_/_/users/U0EKLAMGW&quot;}] no, I&apos;ve simply used ^C^C to reload the current expression, then I reload in the browser to see effects."><y>#</y><d>2017-10-03</d><h>18:50</h><w>bherrmann</w><a>@schmudde</a> no, I&apos;ve simply used ^C^C to reload the current expression, then I reload in the browser to see effects.</z><z id="t1507056604" t="schmudde I’d love to point it at my localhost and get a response."><y>#</y><d>2017-10-03</d><h>18:50</h><w>schmudde</w>I’d love to point it at my <code>localhost</code> and get a response.</z><z id="t1507056611" t="schmudde I see."><y>#</y><d>2017-10-03</d><h>18:50</h><w>schmudde</w>I see.</z><z id="t1507056622" t="schmudde So you’re looking at the response in the browser."><y>#</y><d>2017-10-03</d><h>18:50</h><w>schmudde</w>So you’re looking at the response in the browser.</z><z id="t1507056626" t="bherrmann yes."><y>#</y><d>2017-10-03</d><h>18:50</h><w>bherrmann</w>yes.</z><z id="t1507056628" t="schmudde exclusively."><y>#</y><d>2017-10-03</d><h>18:50</h><w>schmudde</w>exclusively.</z><z id="t1507056693" t="schmudde Sometimes I’d like to get the response, and see the context in my REPL — so I can actually see how the data is structured (I didn’t write these data structures so I need some visibility). Any advice?"><y>#</y><d>2017-10-03</d><h>18:51</h><w>schmudde</w>Sometimes I’d like to get the response, and see the context in my REPL — so I can actually see how the data is structured (I didn’t write these data structures so I need some visibility). Any advice?</z><z id="t1507056713" t="bherrmann yes, I ocasionally test an expression from the repl, but typically something small like ... (camelcase-my-string &quot;fluffy&quot;)"><y>#</y><d>2017-10-03</d><h>18:51</h><w>bherrmann</w>yes, I ocasionally test an expression from the repl, but typically something small like ...  (camelcase-my-string &quot;fluffy&quot;)</z><z id="t1507056749" t="bherrmann Its old school, put I just toss in a println/ppr on the function / and reload... then copy paste the output where i need it"><y>#</y><d>2017-10-03</d><h>18:52</h><w>bherrmann</w>Its old school, put I just toss in a println/ppr on the function / and reload... then copy paste the output where i need it</z><z id="t1507056799" t="schmudde What about testing what interceptors give back? You just test within the interceptor’s namespace?"><y>#</y><d>2017-10-03</d><h>18:53</h><w>schmudde</w>What about testing what interceptors give back? You just test within the interceptor’s namespace?</z><z id="t1507056889" t="schmudde That’s probably really what I’m asking. Interceptors often require context like user login. I’d love to deliver the context and see what data comes out the other side."><y>#</y><d>2017-10-03</d><h>18:54</h><w>schmudde</w>That’s probably really what I’m asking. Interceptors often require context like user login. I’d love to deliver the context and see what data comes out the other side.</z><z id="t1507056919" t="bherrmann I&apos;m pretty much a println wheel... take a look at my &quot;check-auth-interceptor&quot; https://github.com/bherrmann7/podcastmaker/blob/master/src/podcastmaker/service.clj"><y>#</y><d>2017-10-03</d><h>18:55</h><w>bherrmann</w>I&apos;m pretty much a println wheel... take a look at my &quot;check-auth-interceptor&quot;   <a href="https://github.com/bherrmann7/podcastmaker/blob/master/src/podcastmaker/service.clj" target="_blank">https://github.com/bherrmann7/podcastmaker/blob/master/src/podcastmaker/service.clj</a></z><z id="t1507056956" t="schmudde Super. Thank you, [:attrs {:href &quot;/_/_/users/U0502D2GL&quot;}] ! All guidance is helpful at this point!"><y>#</y><d>2017-10-03</d><h>18:55</h><w>schmudde</w>Super. Thank you, <a>@bherrmann</a>! All guidance is helpful at this point!</z><z id="t1507057454" t="zclj Is there any best practice on the project structure of a pedestal server that will ha a SPA client? Should they be in the same project and share project.clj since the client has no meaningful existence on its own or should they have their own projects for separation of concerns?"><y>#</y><d>2017-10-03</d><h>19:04</h><w>zclj</w>Is there any best practice on the project structure of a pedestal server that will ha a SPA client? Should they be in the same project and share project.clj since the client has no meaningful existence on its own or should they have their own projects for separation of concerns?</z><z id="t1507059794" t="mtnygard [:attrs {:href &quot;/_/_/users/U1G8B7ZD3&quot;}] I match the team structure. If it’s one team, then I keep front end and back end in the same project. If it’s two teams, then two projects."><y>#</y><d>2017-10-03</d><h>19:43</h><w>mtnygard</w><a>@zclj</a> I match the team structure. If it’s one team, then I keep front end and back end in the same project. If it’s two teams, then two projects.</z><z id="t1507125200" t="zallin hey everyone. does pedestal out of the box support interceptors scoped by request method and not by verb map ? cant find anything in docs on that regard .."><y>#</y><d>2017-10-04</d><h>13:53</h><w>zallin</w>hey everyone. does pedestal out of the box support interceptors scoped by request method and not by verb map ? cant find anything in docs on that regard ..</z><z id="t1507125270" t="zallin [&quot;/:id&quot; ^{:interceptors [load-order-from-db]} {:get view-order :put update-order}]"><y>#</y><d>2017-10-04</d><h>13:54</h><w>zallin</w>[&quot;/:id&quot; ^{:interceptors [load-order-from-db]}
           {:get view-order
            :put update-order}]</z><z id="t1507125302" t="zallin here interceptors will be invoked for both get and put methods"><y>#</y><d>2017-10-04</d><h>13:55</h><w>zallin</w>here interceptors will be invoked for both get and put methods</z><z id="t1507125332" t="zallin what if i want to create interceptor that only works for put method for instance ?"><y>#</y><d>2017-10-04</d><h>13:55</h><w>zallin</w>what if i want to create interceptor that only works for put method for instance ?</z><z id="t1507125366" t="mtnygard [:attrs {:href &quot;/_/_/users/U2AAZAY11&quot;}] You can definitely do that."><y>#</y><d>2017-10-04</d><h>13:56</h><w>mtnygard</w><a>@zallin</a> You can definitely do that.</z><z id="t1507125369" t="mtnygard It would look like this:"><y>#</y><d>2017-10-04</d><h>13:56</h><w>mtnygard</w>It would look like this:</z><z id="t1507125388" t="mtnygard [&quot;/:id&quot; ^{:interceptors [load-order-from-db]} {:get view-order :put [put-only-intc update-order]}] "><y>#</y><d>2017-10-04</d><h>13:56</h><w>mtnygard</w><pre>[&quot;/:id&quot; ^{:interceptors [load-order-from-db]}
           {:get view-order
            :put [put-only-intc update-order]}]
</pre></z><z id="t1507125403" t="mtnygard It’s much easier to express in table routing syntax."><y>#</y><d>2017-10-04</d><h>13:56</h><w>mtnygard</w>It’s much easier to express in table routing syntax.</z><z id="t1507125437" t="zallin ok thanks ! will try that"><y>#</y><d>2017-10-04</d><h>13:57</h><w>zallin</w>ok thanks ! will try that</z><z id="t1507125438" t="mtnygard [&quot;/:id&quot; :get [load-order-from-db view-order]] [&quot;/:id&quot; :put [load-order-from-db put-only-intc update-order]] "><y>#</y><d>2017-10-04</d><h>13:57</h><w>mtnygard</w><pre>[&quot;/:id&quot; :get [load-order-from-db view-order]]
[&quot;/:id&quot; :put [load-order-from-db put-only-intc update-order]]
</pre></z><z id="t1507125604" t="zallin and also can i provide handlers as vars so they are resolved dynamically and i need not to restart pedestal each time i change logic inside of a handler ?"><y>#</y><d>2017-10-04</d><h>14:00</h><w>zallin</w>and also can i provide handlers as vars so they are resolved dynamically and i need not to restart pedestal each time i change logic inside of a handler ?</z><z id="t1507125649" t="mtnygard The usual way to do that is by providing the route table as a var, not just the handlers. One sec &amp; I can find a link."><y>#</y><d>2017-10-04</d><h>14:00</h><w>mtnygard</w>The usual way to do that is by providing the route table as a var, not just the handlers. One sec &amp; I can find a link.</z><z id="t1507125789" t="mtnygard https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L11"><y>#</y><d>2017-10-04</d><h>14:03</h><w>mtnygard</w><a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L11" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L11</a></z><z id="t1507125806" t="mtnygard That’s from the leiningen template for the server."><y>#</y><d>2017-10-04</d><h>14:03</h><w>mtnygard</w>That’s from the leiningen template for the server.</z><z id="t1507125835" t="mtnygard Line 21 shows how the :io.pedestal.http/routes key can have a function instead of just a value."><y>#</y><d>2017-10-04</d><h>14:03</h><w>mtnygard</w>Line 21 shows how the <code>:io.pedestal.http/routes</code> key can have a function instead of just a value.</z><z id="t1507125907" t="zallin ok I see thanks for your help !"><y>#</y><d>2017-10-04</d><h>14:05</h><w>zallin</w>ok I see thanks for your help !</z><z id="t1507125917" t="mtnygard yw"><y>#</y><d>2017-10-04</d><h>14:05</h><w>mtnygard</w>yw</z><z id="t1507241867" t="souenzzo Someone is catching datomic.api/q exceptions with pedestal&apos;s error handler?"><y>#</y><d>2017-10-05</d><h>22:17</h><w>souenzzo</w>Someone is catching <code>datomic.api/q</code> exceptions with pedestal&apos;s error handler?</z><z id="t1507241911" t="souenzzo d/q thows a really generic :java.lang.Exception and I&apos;m unsure how to catch it."><y>#</y><d>2017-10-05</d><h>22:18</h><w>souenzzo</w><code>d/q</code> thows a really generic <code>:java.lang.Exception</code> and I&apos;m unsure how to catch it.</z><z id="t1507245994" t="mtnygard [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Sorry, I haven’t tried that. I don’t know if this helps, but you can also match on the interceptor that threw the exception."><y>#</y><d>2017-10-05</d><h>23:26</h><w>mtnygard</w><a>@souenzzo</a> Sorry, I haven’t tried that. I don’t know if this helps, but you can also match on the interceptor that threw the exception.</z><z id="t1507246255" t="souenzzo The project (still) using hander (and 100% is the queries are there) I will try to use #dire"><y>#</y><d>2017-10-05</d><h>23:30</h><w>souenzzo</w>The project (still) using hander (and 100% is the queries are there)
I will try to use #dire</z><z id="t1507543916" t="zallin how can multimethods serve as handlers ? annoyed wrapping them in functions 😣"><y>#</y><d>2017-10-09</d><h>10:11</h><w>zallin</w>how can multimethods serve as handlers ? annoyed wrapping them in functions <b>😣</b></z><z id="t1507554212" t="souenzzo Multimethods are simple clojure functions, so yes, you can, but it need to receive request and return response"><y>#</y><d>2017-10-09</d><h>13:03</h><w>souenzzo</w>Multimethods are simple clojure functions, so yes, you can, but it need to receive request and return response</z><z id="t1507554249" t="souenzzo And you may need to make some routes to it [&quot;/foo&quot; :get my-mm :route-name ::mm] [&quot;/bar&quot; :get my-mm :route-name ::mm*]"><y>#</y><d>2017-10-09</d><h>13:04</h><w>souenzzo</w>And you may need to make some routes to it
<code>[&quot;/foo&quot; :get my-mm :route-name ::mm]</code>
<code>[&quot;/bar&quot; :get my-mm :route-name ::mm*]</code></z><z id="t1507554986" t="mtnygard @zallin You probably have to supply a route name in order to make the routes unique, too. "><y>#</y><d>2017-10-09</d><h>13:16</h><w>mtnygard</w>@zallin You probably have to supply a route name in order to make the routes unique, too. </z><z id="t1507555247" t="zallin when using mm as handler i get an error &quot;You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?&quot;"><y>#</y><d>2017-10-09</d><h>13:20</h><w>zallin</w>when using mm as handler i get an error &quot;You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?&quot;</z><z id="t1507555296" t="mtnygard Oh! That&apos;s interesting. I&apos;d call that a bug. Would you be willing to file an issue?"><y>#</y><d>2017-10-09</d><h>13:21</h><w>mtnygard</w>Oh! That&apos;s interesting. I&apos;d call that a bug. Would you be willing to file an issue?</z><z id="t1507555324" t="zallin yes no problem"><y>#</y><d>2017-10-09</d><h>13:22</h><w>zallin</w>yes no problem</z><z id="t1507555352" t="zallin will do later this evening"><y>#</y><d>2017-10-09</d><h>13:22</h><w>zallin</w>will do later this evening</z><z id="t1507555370" t="mtnygard Thank you. "><y>#</y><d>2017-10-09</d><h>13:22</h><w>mtnygard</w>
Thank you. </z><z id="t1507559901" t="mpenet is it possible to combine router instances? ex have a router based on map tree that contains a leaf with linear and another branch at some level using map tree?"><y>#</y><d>2017-10-09</d><h>14:38</h><w>mpenet</w>is it possible to combine router instances? ex have a router based on map tree that contains a leaf with linear and another branch at some level using map tree?</z><z id="t1507559928" t="mtnygard Yes!"><y>#</y><d>2017-10-09</d><h>14:38</h><w>mtnygard</w>Yes!</z><z id="t1507559929" t="mpenet just wondering, I don&apos;t really need this but I could see it used"><y>#</y><d>2017-10-09</d><h>14:38</h><w>mpenet</w>just wondering, I don&apos;t really need this but I could see it used</z><z id="t1507559933" t="mpenet woa"><y>#</y><d>2017-10-09</d><h>14:38</h><w>mpenet</w>woa</z><z id="t1507559939" t="mtnygard Routers are just interceptors"><y>#</y><d>2017-10-09</d><h>14:38</h><w>mtnygard</w>Routers are just interceptors</z><z id="t1507559951" t="mtnygard So you can create a router then use it as an interceptor on another route"><y>#</y><d>2017-10-09</d><h>14:39</h><w>mtnygard</w>So you can create a router then use it as an interceptor on another route</z><z id="t1507559969" t="mpenet that&apos;s super cool"><y>#</y><d>2017-10-09</d><h>14:39</h><w>mpenet</w>that&apos;s super cool</z><z id="t1507560008" t="mtnygard I just wrote a bit about that in a new guide: http://pedestal.io/guides/what-is-an-interceptor#_some_practical_applications"><y>#</y><d>2017-10-09</d><h>14:40</h><w>mtnygard</w>I just wrote a bit about that in a new guide: <a href="http://pedestal.io/guides/what-is-an-interceptor#_some_practical_applications" target="_blank">http://pedestal.io/guides/what-is-an-interceptor#_some_practical_applications</a></z><z id="t1507560046" t="mpenet I must say that route lib is really impressive, probably deserves more attention"><y>#</y><d>2017-10-09</d><h>14:40</h><w>mpenet</w>I must say that route lib is really impressive, probably deserves more attention</z><z id="t1507560213" t="mpenet actually I have a use case for it now that I think of it: i might have to switch to linear router on some cases where there is ambiguity with other routers: ex /foo/:id/ followed by a /foo/bar/ route"><y>#</y><d>2017-10-09</d><h>14:43</h><w>mpenet</w>actually I have a use case for it now that I think of it: i might have to switch to linear router on some cases where there is ambiguity with other routers: ex /foo/:id/ followed by a /foo/bar/ route</z><z id="t1507560242" t="mpenet trying to see if I can port what we have now over to pedestal/route"><y>#</y><d>2017-10-09</d><h>14:44</h><w>mpenet</w>trying to see if I can port what we have now over to pedestal/route</z><z id="t1507560274" t="mtnygard Yeah, I’ve got a similar case. The API was defined and released long ago. So we’re kind of stuck with the linear router"><y>#</y><d>2017-10-09</d><h>14:44</h><w>mtnygard</w>Yeah, I’ve got a similar case. The API was defined and released long ago. So we’re kind of stuck with the linear router</z><z id="t1507560288" t="mtnygard But so far the performance has been good enough that we didn’t get fancy"><y>#</y><d>2017-10-09</d><h>14:44</h><w>mtnygard</w>But so far the performance has been good enough that we didn’t get fancy</z><z id="t1507560355" t="mpenet and to make it more difficult it&apos;s not on pedestal, we do use interceptors tho"><y>#</y><d>2017-10-09</d><h>14:45</h><w>mpenet</w>and to make it more difficult it&apos;s not on pedestal, we do use interceptors tho</z><z id="t1507560408" t="mpenet another gem of a lib"><y>#</y><d>2017-10-09</d><h>14:46</h><w>mpenet</w>another gem of a lib</z><z id="t1507560409" t="mtnygard That’s interesting. I haven’t heard of anyone doing that before. What are you using to accept HTTP requests? And what are you using for routing now?"><y>#</y><d>2017-10-09</d><h>14:46</h><w>mtnygard</w>That’s interesting. I haven’t heard of anyone doing that before. What are you using to accept HTTP requests? And what are you using for routing now?</z><z id="t1507560439" t="mpenet jetty 9 but we have a lot of internals that rely on old tricks and we do things differently with ws"><y>#</y><d>2017-10-09</d><h>14:47</h><w>mpenet</w>jetty 9 but we have a lot of internals that rely on old tricks and we do things differently with ws</z><z id="t1507560454" t="mpenet ahh for routing: moved from clout to bidi recently"><y>#</y><d>2017-10-09</d><h>14:47</h><w>mpenet</w>ahh for routing: moved from clout to bidi recently</z><z id="t1507560473" t="mpenet but bidi is a bit resource hungry it seems"><y>#</y><d>2017-10-09</d><h>14:47</h><w>mpenet</w>but bidi is a bit resource hungry it seems</z><z id="t1507560487" t="mpenet and there are some bits I d prefer different"><y>#</y><d>2017-10-09</d><h>14:48</h><w>mpenet</w>and there are some bits I d prefer different</z><z id="t1507560523" t="mtnygard So you write bidi handlers that call interceptor chains?"><y>#</y><d>2017-10-09</d><h>14:48</h><w>mtnygard</w>So you write bidi handlers that call interceptor chains?</z><z id="t1507560563" t="mpenet yes more or less. we have a resource abstraction that can load an interceptor chain and use it"><y>#</y><d>2017-10-09</d><h>14:49</h><w>mpenet</w>yes more or less. we have a resource abstraction that can load an interceptor chain and use it</z><z id="t1507560573" t="mpenet we have doc &amp; specs on top of it"><y>#</y><d>2017-10-09</d><h>14:49</h><w>mpenet</w>we have doc &amp; specs on top of it</z><z id="t1507560581" t="mtnygard Nice"><y>#</y><d>2017-10-09</d><h>14:49</h><w>mtnygard</w>Nice</z><z id="t1507560583" t="mpenet a bit like yada, but somewhat different"><y>#</y><d>2017-10-09</d><h>14:49</h><w>mpenet</w>a bit like yada, but somewhat different</z><z id="t1507560595" t="mpenet response spec, request spec etc"><y>#</y><d>2017-10-09</d><h>14:49</h><w>mpenet</w>response spec, request spec etc</z><z id="t1507560715" t="mpenet I will have to play with the route mixing tomorrow, I hope this can be written in a somewhat declarative way without having to mess with interceptors too much"><y>#</y><d>2017-10-09</d><h>14:51</h><w>mpenet</w>I will have to play with the route mixing tomorrow, I hope this can be written in a somewhat declarative way without having to mess with interceptors too much</z><z id="t1507560829" t="mtnygard Good luck. Let us know how it turns out"><y>#</y><d>2017-10-09</d><h>14:53</h><w>mtnygard</w>Good luck. Let us know how it turns out</z><z id="t1507560842" t="mpenet will do"><y>#</y><d>2017-10-09</d><h>14:54</h><w>mpenet</w>will do</z><z id="t1507561189" t="mpenet now that I think of it I could cheat with nginx"><y>#</y><d>2017-10-09</d><h>14:59</h><w>mpenet</w>now that I think of it I could cheat with nginx</z><z id="t1507561256" t="mpenet probably easier than nesting routers and whatnot. I would just rewrite/proxy the ambiguous routes to other paths that are resolvable with non linear routers without relying on ordering"><y>#</y><d>2017-10-09</d><h>15:00</h><w>mpenet</w>probably easier than nesting routers and whatnot. I would just rewrite/proxy the ambiguous routes to other paths that are resolvable with non linear routers without relying on ordering</z><z id="t1507646393" t="zallin hey [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] , regarding advice you gave me about http method specific interceptors"><y>#</y><d>2017-10-10</d><h>14:39</h><w>zallin</w>hey <a>@mtnygard</a> , regarding advice you gave me about http method specific interceptors</z><z id="t1507646441" t="zallin in terse syntax I get assertion error Caused by: java.lang.AssertionError: Assert failed: This vector for the verb map has extra elements. The leftover elements are (my-ped.service/home-page) from the original data [my-ped.service/identity-ic my-ped.service/home-page]"><y>#</y><d>2017-10-10</d><h>14:40</h><w>zallin</w>in terse syntax I get assertion error <pre>Caused by: java.lang.AssertionError: Assert failed: This vector for the verb map has extra elements. The leftover elements are (my-ped.service/home-page) from the original data [my-ped.service/identity-ic my-ped.service/home-page]</pre></z><z id="t1507646452" t="zallin while it works fine in table syntax"><y>#</y><d>2017-10-10</d><h>14:40</h><w>zallin</w>while it works fine in table syntax</z><z id="t1507646539" t="mtnygard Terse syntax usually trips me up somewhere or other."><y>#</y><d>2017-10-10</d><h>14:42</h><w>mtnygard</w>Terse syntax usually trips me up somewhere or other.</z><z id="t1507646558" t="mtnygard I think it will work if you do this:"><y>#</y><d>2017-10-10</d><h>14:42</h><w>mtnygard</w>I think it will work if you do this:</z><z id="t1507646590" t="mtnygard {:get ^interceptors [other-interceptor] [:unique-route-name handler]} "><y>#</y><d>2017-10-10</d><h>14:43</h><w>mtnygard</w><pre>{:get ^interceptors [other-interceptor] [:unique-route-name handler]}
</pre></z><z id="t1507646605" t="mtnygard But it might have to be like this:"><y>#</y><d>2017-10-10</d><h>14:43</h><w>mtnygard</w>But it might have to be like this:</z><z id="t1507646621" t="mtnygard {:get ^{:interceptors [other-interceptor]} [:unique-route-name handler]} "><y>#</y><d>2017-10-10</d><h>14:43</h><w>mtnygard</w><pre>{:get ^{:interceptors [other-interceptor]} [:unique-route-name handler]}
</pre></z><z id="t1507646667" t="zallin and as for using multimethods as handlers Paul has closed my ticket saying that this behavior is not supported by design :robot_face:"><y>#</y><d>2017-10-10</d><h>14:44</h><w>zallin</w>and as for using multimethods as handlers Paul has closed my ticket saying that this behavior is not supported by design <b>:robot_face:</b></z><z id="t1507646690" t="zallin https://github.com/pedestal/pedestal/issues/537"><y>#</y><d>2017-10-10</d><h>14:44</h><w>zallin</w><a href="https://github.com/pedestal/pedestal/issues/537" target="_blank">https://github.com/pedestal/pedestal/issues/537</a></z><z id="t1507646793" t="zallin as far as i remember i tried first version and it was syntax error"><y>#</y><d>2017-10-10</d><h>14:46</h><w>zallin</w>as far as i remember i tried first version and it was syntax error</z><z id="t1507646833" t="mtnygard I don’t agree with Paul on that one. I’ve added a comment to the issue explaining my reasoning."><y>#</y><d>2017-10-10</d><h>14:47</h><w>mtnygard</w>I don’t agree with Paul on that one. I’ve added a comment to the issue explaining my reasoning.</z><z id="t1507646859" t="zallin second works thx !"><y>#</y><d>2017-10-10</d><h>14:47</h><w>zallin</w>second works thx !</z><z id="t1507646874" t="mtnygard Glad it worked."><y>#</y><d>2017-10-10</d><h>14:47</h><w>mtnygard</w>Glad it worked.</z><z id="t1507646874" t="zallin but I do not really understand the difference .."><y>#</y><d>2017-10-10</d><h>14:47</h><w>zallin</w>but I do not really understand the difference ..</z><z id="t1507646913" t="mtnygard I probably should have use ^:interceptors in the first one instead of ^interceptors ."><y>#</y><d>2017-10-10</d><h>14:48</h><w>mtnygard</w>I probably should have use <code>^:interceptors</code> in the first one instead of <code>^interceptors</code>.</z><z id="t1507646935" t="mtnygard But that’s the old, somewhat out-of-style way of writing metadata anyway"><y>#</y><d>2017-10-10</d><h>14:48</h><w>mtnygard</w>But that’s the old, somewhat out-of-style way of writing metadata anyway</z><z id="t1507647090" t="zallin it seems that ^:key just sets key to true in meta"><y>#</y><d>2017-10-10</d><h>14:51</h><w>zallin</w>it seems that <pre>^:key</pre> just sets key to true in meta</z><z id="t1507647438" t="zallin I think this case we ve worked out should be reflected in doc , because now it says &quot;The value of each key is either a handler function or a list of interceptors.&quot;"><y>#</y><d>2017-10-10</d><h>14:57</h><w>zallin</w>I think this case we ve worked out should be reflected in doc , because now it says &quot;The value of each key is either a handler function or a list of interceptors.&quot;</z><z id="t1507647439" t="zallin http://pedestal.io/reference/routing-quick-reference#_terse_syntax"><y>#</y><d>2017-10-10</d><h>14:57</h><w>zallin</w><a href="http://pedestal.io/reference/routing-quick-reference#_terse_syntax" target="_blank">http://pedestal.io/reference/routing-quick-reference#_terse_syntax</a></z><z id="t1507647486" t="mtnygard What happens if you try a vector like [:unique-route-name interceptor interceptor handler] ?"><y>#</y><d>2017-10-10</d><h>14:58</h><w>mtnygard</w>What happens if you try a vector like <code>[:unique-route-name interceptor interceptor handler]</code>?</z><z id="t1507647500" t="mtnygard Maybe the problem was just missing the route name at the beginning…"><y>#</y><d>2017-10-10</d><h>14:58</h><w>mtnygard</w>Maybe the problem was just missing the route name at the beginning…</z><z id="t1507647539" t="zallin let me try"><y>#</y><d>2017-10-10</d><h>14:58</h><w>zallin</w>let me try</z><z id="t1507647649" t="zallin no it is the same assertion error"><y>#</y><d>2017-10-10</d><h>15:00</h><w>zallin</w>no it is the same assertion error</z><z id="t1507647831" t="mtnygard Thanks for trying those variations out. I added a docs issue: https://github.com/pedestal/pedestal-docs/issues/91"><y>#</y><d>2017-10-10</d><h>15:03</h><w>mtnygard</w>Thanks for trying those variations out. I added a docs issue: <a href="https://github.com/pedestal/pedestal-docs/issues/91" target="_blank">https://github.com/pedestal/pedestal-docs/issues/91</a></z><z id="t1507647971" t="zallin ok thank you"><y>#</y><d>2017-10-10</d><h>15:06</h><w>zallin</w>ok thank you</z><z id="t1507649508" t="zallin [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] you know what? even using (def routes `[[[&quot;/&quot; {:get ^{:interceptors [identity-ic]} [:my-route home-page]} ^:interceptors [(body-params/body-params) http/html-body] [&quot;/about&quot; {:get about-page}]]]]) identity-ic is not added into interceptors vector, checked it via expand-routes."><y>#</y><d>2017-10-10</d><h>15:31</h><w>zallin</w><a>@mtnygard</a> you know what? even using <pre>(def routes
  `[[[&quot;/&quot; {:get ^{:interceptors [identity-ic]} [:my-route home-page]}
      ^:interceptors [(body-params/body-params) http/html-body]
    [&quot;/about&quot; {:get about-page}]]]])</pre> identity-ic is not added into interceptors vector, checked it via expand-routes.</z><z id="t1507649532" t="zallin :face_with_rolling_eyes:"><y>#</y><d>2017-10-10</d><h>15:32</h><w>zallin</w><b>:face_with_rolling_eyes:</b></z><z id="t1507649554" t="mtnygard OK. It’s time for me to consult the source instead of working from memory."><y>#</y><d>2017-10-10</d><h>15:32</h><w>mtnygard</w>OK. It’s time for me to consult the source instead of working from memory.</z><z id="t1507649753" t="mtnygard Here’s the syntax straight from the tests:"><y>#</y><d>2017-10-10</d><h>15:35</h><w>mtnygard</w>Here’s the syntax straight from the tests:</z><z id="t1507649755" t="mtnygard `clojure"><y>#</y><d>2017-10-10</d><h>15:35</h><w>mtnygard</w><code></code>`clojure</z><z id="t1507649781" t="mtnygard {:get [:terminal-intercepted ^:interceptors [interceptor-1 interceptor-2] request-inspection]} "><y>#</y><d>2017-10-10</d><h>15:36</h><w>mtnygard</w><pre>{:get [:terminal-intercepted ^:interceptors [interceptor-1 interceptor-2] request-inspection]}
</pre></z><z id="t1507649826" t="mtnygard So it’s a boolean metadata flag for :interceptors attached to an ordinary vector, nested inside the verb’s action vector"><y>#</y><d>2017-10-10</d><h>15:37</h><w>mtnygard</w>So it’s a boolean metadata flag for <code>:interceptors</code> attached to an ordinary vector, nested inside the verb’s action vector</z><z id="t1507649830" t="mtnygard (sheesh)"><y>#</y><d>2017-10-10</d><h>15:37</h><w>mtnygard</w>(sheesh)</z><z id="t1507649835" t="zallin omg"><y>#</y><d>2017-10-10</d><h>15:37</h><w>zallin</w>omg</z><z id="t1507649838" t="mtnygard See, this is why I made the table syntax!"><y>#</y><d>2017-10-10</d><h>15:37</h><w>mtnygard</w>See, this is why I made the table syntax!</z><z id="t1507649871" t="mtnygard I can never remember how to put the terse syntax together."><y>#</y><d>2017-10-10</d><h>15:37</h><w>mtnygard</w>I can never remember how to put the terse syntax together.</z><z id="t1507650016" t="zallin I will try to use table syntax for a while, it is clearly more obvious but also quite verbose"><y>#</y><d>2017-10-10</d><h>15:40</h><w>zallin</w>I will try to use table syntax for a while, it is clearly more obvious but also quite verbose</z><z id="t1507650406" t="mtnygard This sounds sarcastic when written in text, but I mean it sincerely. We’re always interested in better ways to use data to describe configuration like routes. If you are able to find a representation that reduces duplication but doesn’t create the confusing overloaded syntax of the terse format, please let me know. We can plug new routing parsers in pretty easily."><y>#</y><d>2017-10-10</d><h>15:46</h><w>mtnygard</w>This sounds sarcastic when written in text, but I mean it sincerely. We’re always interested in better ways to use data to describe configuration like routes. If you are able to find a representation that reduces duplication but doesn’t create the confusing overloaded syntax of the terse format, please let me know. We can plug new routing parsers in pretty easily.</z><z id="t1507650572" t="mpenet still working on the use of the router standalone: I am stuck on a weird thing that seems somehow intentional, it seems that a route defined for /foo/bar/ will only match /foo/bar (notice the missing trailing slash)?"><y>#</y><d>2017-10-10</d><h>15:49</h><w>mpenet</w>still working on the use of the router standalone: I am stuck on a weird thing that seems somehow intentional, it seems that a route defined for /foo/bar/ will only match /foo/bar (notice the missing trailing slash)?</z><z id="t1507650602" t="mpenet it uses this regex internally apparently #&quot;/\Qfoo\E/\Qbar\E&quot;"><y>#</y><d>2017-10-10</d><h>15:50</h><w>mpenet</w>it uses this regex internally apparently #&quot;/\Qfoo\E/\Qbar\E&quot;</z><z id="t1507650619" t="mtnygard I wouldn’t call it intentional, necessarily, but it is for real."><y>#</y><d>2017-10-10</d><h>15:50</h><w>mtnygard</w>I wouldn’t call it intentional, necessarily, but it is for real.</z><z id="t1507650640" t="mtnygard /foo/bar is a different resource than /foo/bar/baz"><y>#</y><d>2017-10-10</d><h>15:50</h><w>mtnygard</w>/foo/bar is a different resource than /foo/bar/baz</z><z id="t1507650651" t="mpenet it&apos;s odd to say the least"><y>#</y><d>2017-10-10</d><h>15:50</h><w>mpenet</w>it&apos;s odd to say the least</z><z id="t1507650657" t="mtnygard Oddly, specs differ in their opinion about /foo/bar/"><y>#</y><d>2017-10-10</d><h>15:50</h><w>mtnygard</w>Oddly, specs differ in their opinion about /foo/bar/</z><z id="t1507650676" t="zallin well we at http://health-samurai.io often use https://github.com/niquola/route-map"><y>#</y><d>2017-10-10</d><h>15:51</h><w>zallin</w>well we at <a href="http://health-samurai.io" target="_blank">http://health-samurai.io</a> often use <a href="https://github.com/niquola/route-map" target="_blank">https://github.com/niquola/route-map</a></z><z id="t1507650683" t="mpenet the route is super clear/simple"><y>#</y><d>2017-10-10</d><h>15:51</h><w>mpenet</w>the route is super clear/simple</z><z id="t1507650684" t="mtnygard Web servers historically treat that as an alias for some subordinate like /foo/bar/index.html"><y>#</y><d>2017-10-10</d><h>15:51</h><w>mtnygard</w>Web servers historically treat that as an alias for some subordinate like /foo/bar/index.html</z><z id="t1507650738" t="mpenet well our proxy rewrite reqs when they are missing the trailing /, that makes it tricky to use"><y>#</y><d>2017-10-10</d><h>15:52</h><w>mpenet</w>well our proxy rewrite reqs when they are missing the trailing /, that makes it tricky to use</z><z id="t1507650742" t="mtnygard But for an API, it’s not clear whether “/foo/bar/” should mean “/foo/bar” or “/foo/bar/some-default”"><y>#</y><d>2017-10-10</d><h>15:52</h><w>mtnygard</w>But for an API, it’s not clear whether “/foo/bar/” should mean “/foo/bar” or “/foo/bar/some-default”</z><z id="t1507650767" t="mpenet in a pure routing context, if the route is defined for /foo/bar/ it should match /foo/bar/"><y>#</y><d>2017-10-10</d><h>15:52</h><w>mpenet</w>in a pure routing context, if the route is defined for /foo/bar/ it should match /foo/bar/</z><z id="t1507650773" t="mpenet http or else"><y>#</y><d>2017-10-10</d><h>15:52</h><w>mpenet</w>http or else</z><z id="t1507650783" t="mpenet imo"><y>#</y><d>2017-10-10</d><h>15:53</h><w>mpenet</w>imo</z><z id="t1507650830" t="mtnygard Hmm… I found this issue that claims trailing slashes should be supported now. https://github.com/pedestal/pedestal/issues/477"><y>#</y><d>2017-10-10</d><h>15:53</h><w>mtnygard</w>Hmm… I found this issue that claims trailing slashes should be supported now. <a href="https://github.com/pedestal/pedestal/issues/477" target="_blank">https://github.com/pedestal/pedestal/issues/477</a></z><z id="t1507650886" t="mpenet maybe there&apos;s some sanitizing done at a lower level in the http bits, but the router does not support it"><y>#</y><d>2017-10-10</d><h>15:54</h><w>mpenet</w>maybe there&apos;s some sanitizing done at a lower level in the http bits, but the router does not support it</z><z id="t1507650910" t="mtnygard [:attrs {:href &quot;/_/_/users/U050SC7SV&quot;}] Which router are you using?"><y>#</y><d>2017-10-10</d><h>15:55</h><w>mtnygard</w><a>@mpenet</a> Which router are you using?</z><z id="t1507650916" t="mpenet linear for now"><y>#</y><d>2017-10-10</d><h>15:55</h><w>mpenet</w>linear for now</z><z id="t1507650931" t="mpenet but they all compile to the same regex I believe"><y>#</y><d>2017-10-10</d><h>15:55</h><w>mpenet</w>but they all compile to the same regex I believe</z><z id="t1507650975" t="mtnygard I’m looking at the source now to figure out why Paul’s comment doesn’t match the behavior you’re seeing."><y>#</y><d>2017-10-10</d><h>15:56</h><w>mtnygard</w>I’m looking at the source now to figure out why Paul’s comment doesn’t match the behavior you’re seeing.</z><z id="t1507651076" t="mtnygard OK, it looks like that issue doesn’t really apply. It talks about routes defined with a trailing slash, but requests that don’t have it."><y>#</y><d>2017-10-10</d><h>15:57</h><w>mtnygard</w>OK, it looks like that issue doesn’t really apply. It talks about routes defined with a trailing slash, but requests that don’t have it.</z><z id="t1507651171" t="mpenet the trailing / or not imho should be a user level concern, you design your routes in one way and let either a proxy or middleware deal with it"><y>#</y><d>2017-10-10</d><h>15:59</h><w>mpenet</w>the trailing / or not imho should be a user level concern, you design your routes in one way and let either a proxy or middleware deal with it</z><z id="t1507651195" t="mtnygard I understand what you’re saying."><y>#</y><d>2017-10-10</d><h>15:59</h><w>mtnygard</w>I understand what you’re saying.</z><z id="t1507703400" t="mpenet should I open an issue about this?"><y>#</y><d>2017-10-11</d><h>06:30</h><w>mpenet</w>should I open an issue about this?</z><z id="t1507703472" t="mpenet the issue you mentioned makes it look like it could be by design tho"><y>#</y><d>2017-10-11</d><h>06:31</h><w>mpenet</w>the issue you mentioned makes it look like it could be by design tho</z><z id="t1507704091" t="mpenet actually it does work with the map tree router, but not the linear"><y>#</y><d>2017-10-11</d><h>06:41</h><w>mpenet</w>actually it does work with the map tree router, but not the linear</z><z id="t1507704109" t="mpenet I guess it deserves an issue then"><y>#</y><d>2017-10-11</d><h>06:41</h><w>mpenet</w>I guess it deserves an issue then</z><z id="t1507704795" t="mpenet [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] fyi https://github.com/pedestal/pedestal/issues/538"><y>#</y><d>2017-10-11</d><h>06:53</h><w>mpenet</w><a>@mtnygard</a> fyi <a href="https://github.com/pedestal/pedestal/issues/538" target="_blank">https://github.com/pedestal/pedestal/issues/538</a></z><z id="t1507894612" t="kuzmin_m Hi! I have a interceptor A and a interceptor B. These interceptors defined as maps. I want to make interceptor C as composition of A and B. How can I do this?"><y>#</y><d>2017-10-13</d><h>11:36</h><w>kuzmin_m</w>Hi!
I have a interceptor A and a interceptor B.
These interceptors defined as maps.
I want to make interceptor C as composition of A and B.
How can I do this?</z><z id="t1508156581" t="dazld would (merge A B) not work?"><y>#</y><d>2017-10-16</d><h>12:23</h><w>dazld</w>would <code>(merge A B)</code> not work?</z><z id="t1508156594" t="dazld oh, that was friday"><y>#</y><d>2017-10-16</d><h>12:23</h><w>dazld</w>oh, that was friday</z><z id="t1508156764" t="dazld i guess it wouldn&apos;t too.."><y>#</y><d>2017-10-16</d><h>12:26</h><w>dazld</w>i guess it wouldn&apos;t too..</z><z id="t1508157047" t="ddeaguiar You don’t compose interceptors in this way. It’s idiomatic to chain them."><y>#</y><d>2017-10-16</d><h>12:30</h><w>ddeaguiar</w>You don’t compose interceptors in this way. It’s idiomatic to chain them.</z><z id="t1508157931" t="kuzmin_m Can I create interceptor C that enqueue A and B before next interceptor? chain before: X Y chain after: C X Y chain at runtime: A B X Y"><y>#</y><d>2017-10-16</d><h>12:45</h><w>kuzmin_m</w>Can I create interceptor C that enqueue A and B before next interceptor?
chain before:  X Y
chain after: C X Y
chain at runtime: A B X Y</z><z id="t1508158009" t="kuzmin_m Must I manually create a new interceptors queue? 😃"><y>#</y><d>2017-10-16</d><h>12:46</h><w>kuzmin_m</w>Must I manually create a new interceptors queue? <b>😃</b></z><z id="t1508158549" t="ddeaguiar You can manipulate the interceptor queue from within an interceptor"><y>#</y><d>2017-10-16</d><h>12:55</h><w>ddeaguiar</w>You can manipulate the interceptor queue from within an interceptor</z><z id="t1508158578" t="ddeaguiar so you can decide to enqueue additional interceptors based on some condition"><y>#</y><d>2017-10-16</d><h>12:56</h><w>ddeaguiar</w>so you can decide to enqueue additional interceptors based on some condition</z><z id="t1508158592" t="ddeaguiar The interceptor queue is accessible through the context map"><y>#</y><d>2017-10-16</d><h>12:56</h><w>ddeaguiar</w>The interceptor queue is accessible through the context map</z><z id="t1508159126" t="kuzmin_m http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html enqueue (enqueue context interceptors) Adds interceptors to the end of context&apos;s execution queue. Creates the queue if necessary. Returns updated context. It&apos;s queue. I can&apos;t push items to begin of queue. I can only create new one."><y>#</y><d>2017-10-16</d><h>13:05</h><w>kuzmin_m</w><a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html</a> 
<pre>enqueue
(enqueue context interceptors)
Adds interceptors to the end of context&apos;s execution queue. Creates
the queue if necessary. Returns updated context.
</pre>

It&apos;s queue. I can&apos;t push items to begin of queue.
I can only create new one.</z><z id="t1508296181" t="chris_johnson kuzmin_m I don’t think ddeguiar is suggesting that you call enqueue , but rather that you fetch the “current” interceptor queue out of the context map and do side-effecty things to it"><y>#</y><d>2017-10-18</d><h>03:09</h><w>chris_johnson</w>kuzmin_m I don’t think ddeguiar is suggesting that you call <code>enqueue</code>, but rather that you fetch the “current” interceptor queue out of the context map and do side-effecty things to it</z><z id="t1508296276" t="chris_johnson This is something I’ve done working with Vase, to allow for really, really inefficient time-series REST endpoints by taking in a time param from an endpoint and reaching into the context map of the Vase route to replace the Datomic db with an d/as-of d DB value"><y>#</y><d>2017-10-18</d><h>03:11</h><w>chris_johnson</w>This is something I’ve done working with Vase, to allow for really, really inefficient time-series REST endpoints by taking in a <code>time</code> param from an endpoint and reaching into the context map of the Vase route to replace the Datomic <code>db</code> with an <code>d/as-of</code>d DB value</z><z id="t1508518033" t="Cesco Hi guys, I’m new here 😄 I have a question about the short-circuit logic. It seems to be not working in the way I understand it. I’m on 0.5.3 and if I try to return a response from any interceptor, the next one is called and ends up overriding the already set response."><y>#</y><d>2017-10-20</d><h>16:47</h><w>Cesco</w>Hi guys, I’m new here <b>😄</b> I have a question about the short-circuit logic. It seems to be not working in the way I understand it. I’m on 0.5.3 and if I try to return a response from any interceptor, the next one is called and ends up overriding the already set response.</z><z id="t1508518097" t="Cesco Is there anything that needs to be enabled in order to make it work as it’s written on the docs? I already spent few hours on this without finding a solution"><y>#</y><d>2017-10-20</d><h>16:48</h><w>Cesco</w>Is there anything that needs to be enabled in order to make it work as it’s written on the docs? I already spent few hours on this without finding a solution</z><z id="t1508520524" t="jjttjj [:attrs {:href &quot;/_/_/users/U7MGK7ZDY&quot;}] are you calling io.pedestal.interceptor.chain/terminate prior to providing the response? Like this: (if-not (= id expected-id) (-&gt; context io.pedestal.interceptor.chain/terminate (assoc :response {:status 401 :body {:message &quot;Unauthorized&quot;}})))"><y>#</y><d>2017-10-20</d><h>17:28</h><w>jjttjj</w><a>@francesco686</a> are you calling io.pedestal.interceptor.chain/terminate prior to providing the response? Like this: <pre>(if-not (= id expected-id)
  (-&gt; context
      io.pedestal.interceptor.chain/terminate
      (assoc :response {:status 401 :body {:message &quot;Unauthorized&quot;}})))</pre></z><z id="t1508527634" t="Cesco [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] no, I thought this step was not need. Also going back to the 24th of March, some guys in this channel were actually saying it was not needed. Link: https://clojurians-log.clojureverse.org/pedestal/2017-03-24.html"><y>#</y><d>2017-10-20</d><h>19:27</h><w>Cesco</w><a>@jjttjj</a> no, I thought this step was not need. Also going back to the 24th of March, some guys in this channel were actually saying it was not needed. Link: <a href="https://clojurians-log.clojureverse.org/pedestal/2017-03-24.html" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2017-03-24.html</a></z><z id="t1508528756" t="Cesco ah, found out, I was missing the :headers key on the response object. Without that, the terminator interceptor is not injected."><y>#</y><d>2017-10-20</d><h>19:45</h><w>Cesco</w>ah, found out, I was missing the <code>:headers</code> key on the response object. Without that, the terminator interceptor is not injected.</z><z id="t1508528826" t="Cesco unfortunately also this one fails. https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/content_negotiation.clj#L172 I’m gonna open a PR now…"><y>#</y><d>2017-10-20</d><h>19:47</h><w>Cesco</w>unfortunately also this one fails. <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/content_negotiation.clj#L172" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/content_negotiation.clj#L172</a> I’m gonna open a PR now…</z><z id="t1508530194" t="Cesco https://github.com/pedestal/pedestal/pull/540 here we go 🙂"><y>#</y><d>2017-10-20</d><h>20:09</h><w>Cesco</w><a href="https://github.com/pedestal/pedestal/pull/540" target="_blank">https://github.com/pedestal/pedestal/pull/540</a> here we go <b>🙂</b></z><z id="t1508767431" t="souenzzo [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] I use this https://funcool.github.io/buddy-sign/latest/#signing-data + a custom/simple interceptor that take a token on enter and write the user-id on :request , and update/write it back on headers on leave. after this authentication , I have another authorization interceptor that get user-id + route from context, and &quot;do a complex stuff&quot;"><y>#</y><d>2017-10-23</d><h>14:03</h><w>souenzzo</w><a>@jjttjj</a> I use this <a href="https://funcool.github.io/buddy-sign/latest/#signing-data" target="_blank">https://funcool.github.io/buddy-sign/latest/#signing-data</a> + a custom/simple interceptor that take a token on enter and write the user-id on <code>:request</code>, and update/write it back on headers on leave.
after this <code>authentication</code>, I have another <code>authorization</code> interceptor that get <code>user-id</code> + <code>route</code> from context, and &quot;do a complex stuff&quot;</z><z id="t1508774321" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] , I’ve got a PR open with Pedestal that adds a Buddy Auth example ( https://github.com/pedestal/pedestal/pull/503 ). You may find it useful."><y>#</y><d>2017-10-23</d><h>15:58</h><w>ddeaguiar</w><a>@jjttjj</a>, I’ve got a PR open with Pedestal that adds a Buddy Auth example (<a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a>). You may find it useful.</z><z id="t1508776369" t="jjttjj Great thank you both!"><y>#</y><d>2017-10-23</d><h>16:32</h><w>jjttjj</w>Great thank you both!</z><z id="t1508826677" t="ddeaguiar np 🙂"><y>#</y><d>2017-10-24</d><h>06:31</h><w>ddeaguiar</w>np <b>🙂</b></z><z id="t1508952228" t="souenzzo"><y>#</y><d>2017-10-25</d><h>17:23</h><w>souenzzo</w></z><z id="t1508952283" t="mtnygard Thanks for the poke. I just merged it."><y>#</y><d>2017-10-25</d><h>17:24</h><w>mtnygard</w>Thanks for the poke. I just merged it.</z><z id="t1508952349" t="mtnygard BTW, this is the first time I ever heard of a #vase channel."><y>#</y><d>2017-10-25</d><h>17:25</h><w>mtnygard</w>BTW, this is the first time I ever heard of a #vase channel.</z><z id="t1508953658" t="mitchelkuijpers Awesome [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] !"><y>#</y><d>2017-10-25</d><h>17:47</h><w>mitchelkuijpers</w>Awesome <a>@mtnygard</a>!</z><z id="t1508966291" t="mtnygard ANN: Released version 0.9.2 of Vase to Clojars. Mostly about version updating. Now uses Clojure 1.9.0-beta3"><y>#</y><d>2017-10-25</d><h>21:18</h><w>mtnygard</w>ANN: Released version 0.9.2 of Vase to Clojars. Mostly about version updating. Now uses Clojure 1.9.0-beta3</z><z id="t1509147236" t="thosmos I&apos;m having some trouble with CSP errors in running lacinia-pedestal in a generic pedestal 0.5.3 service. I&apos;ve attempted to add a CSP policy like ::http/secure-headers {:content-security-policy-settings {:script-src &quot;*&quot;}} into the service config, but I&apos;m still getting errors about the policy being too restrictive: Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled. Any suggestions?"><y>#</y><d>2017-10-27</d><h>23:33</h><w>thosmos</w>I&apos;m having some trouble with CSP errors in running lacinia-pedestal in a generic pedestal 0.5.3 service.  I&apos;ve attempted to add a CSP policy like <code>::http/secure-headers {:content-security-policy-settings {:script-src &quot;*&quot;}}</code> into the service config, but I&apos;m still getting errors about the policy being too restrictive: <code>Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled.</code>  Any suggestions?</z><z id="t1509148650" t="thosmos I figured it out: I was using lacinia-pedestal&apos;s provided pedestal-service function to generate the service map which already ran ::http/create-server on it using the default pedestal CSP, and apparently, the service config needs to be altered before that step even though the output of that is still just a map..."><y>#</y><d>2017-10-27</d><h>23:57</h><w>thosmos</w>I figured it out: I was using lacinia-pedestal&apos;s provided <code>pedestal-service</code> function to generate the service map which already ran <code>::http/create-server</code> on it using the default pedestal CSP, and apparently, the service config needs to be altered before that step even though the output of that is still just a map...</z><z id="t1509470790" t="hlship In retrospect, it shouldn&apos;t do the http/create-server call. What do you think about adding an option (to lacinia-pedestal) to turn that off?"><y>#</y><d>2017-10-31</d><h>17:26</h><r>hlship</r>In retrospect, it shouldn&apos;t do the http/create-server call.  What do you think about adding an option (to lacinia-pedestal) to turn that off?</z><z id="t1509470863" t="hlship Alternately ... we&apos;re still alpha, an incompatible change would be to just drop the http/create-server step entirely, leave that the caller&apos;s responsibility."><y>#</y><d>2017-10-31</d><h>17:27</h><r>hlship</r>Alternately ... we&apos;re still alpha, an incompatible change would be to just drop the http/create-server step entirely, leave that the caller&apos;s responsibility.</z><z id="t1510347574" t="bill I’m using a body-params interceptor to populate the request’s :json-params . ✓ (I’m a noob) What if I want to get at the request’s :body as a String ? I see the :body isa HttpInputOverHTTP : https://www.eclipse.org/jetty/javadoc/current/org/eclipse/jetty/server/HttpInputOverHTTP.html But I don’t know out to get a String or a Reader out of that thing. Rather than digging directly into the Java stuff, I wondered if there was some interceptor or helper type fn to do that… (I realize that in general, I may be dealing with a MIME multi-part request and oy I just don’t want that complication, but I do, nevertheless need the content of the first part, as a String )"><y>#</y><d>2017-11-10</d><h>20:59</h><w>bill</w>I’m using a <code>body-params</code> interceptor to populate the request’s <code>:json-params</code>. ✓ (I’m a noob)

What if I want to get at the request’s <code>:body</code> as a <code>String</code>? I see the <code>:body</code> isa <code>HttpInputOverHTTP</code>:

<a href="https://www.eclipse.org/jetty/javadoc/current/org/eclipse/jetty/server/HttpInputOverHTTP.html" target="_blank">https://www.eclipse.org/jetty/javadoc/current/org/eclipse/jetty/server/HttpInputOverHTTP.html</a>

But I don’t know out to get a <code>String</code> or a <code>Reader</code> out of that thing.

Rather than digging directly into the Java stuff, I wondered if there was some interceptor or helper type fn to do that…

(I realize that in general, I may be dealing with a MIME multi-part request and oy I just don’t want that complication, but I do, nevertheless need the content of the first part, as a <code>String</code>)</z><z id="t1510347943" t="bill I’ve seen the “echo” handler but it punts on the issue: http://pedestal.io/guides/your-first-api"><y>#</y><d>2017-11-10</d><h>21:05</h><w>bill</w>I’ve seen the “echo” handler but it punts on the issue: <a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a></z><z id="t1510348147" t="bill hmm HttpInputOverHTTP isa InputStream …"><y>#</y><d>2017-11-10</d><h>21:09</h><w>bill</w>hmm <code>HttpInputOverHTTP</code> isa <code>InputStream</code>…</z><z id="t1510356804" t="kenny I have a route that looks like this: [&quot;/subscribe&quot; :get [(http-sse/start-event-stream stream-ready)] :route-name :subscribe] where stream-ready is defined like this: (require &apos;[clojure.core.async :as async]) (require &apos;[io.pedestal.http.sse :as sse]) (defn stream-ready [event-chan ctx] (async/go-loop [] (async/&lt;! (async/timeout 1000)) (sse/send-event event-chan &quot;example&quot; &quot;test&quot;) (recur))) In the browser I created an EventSource object and set the onmessage handler to just print out the event result. I get a new event message once per second. The event data looks something like this &quot;[B@100394d9&quot; , however. That looks a whole lot like how Clojure prints out Byte arrays. I&apos;m wondering if Pedestal is incorrectly serializing SSE messages. These are the Pedestal dependencies that I have: [io.pedestal/pedestal.service &quot;0.5.3&quot;] [io.pedestal/pedestal.route &quot;0.5.3&quot;] [io.pedestal/pedestal.jetty &quot;0.5.3&quot;] "><y>#</y><d>2017-11-10</d><h>23:33</h><w>kenny</w>I have a route that looks like this: 
<pre>[&quot;/subscribe&quot; :get [(http-sse/start-event-stream stream-ready)] :route-name :subscribe]
</pre>
where <code>stream-ready</code> is defined like this: 
<pre>(require &apos;[clojure.core.async :as async])
(require &apos;[io.pedestal.http.sse :as sse])

(defn stream-ready
  [event-chan ctx]
  (async/go-loop []
    (async/&lt;! (async/timeout 1000))
    (sse/send-event event-chan &quot;example&quot; &quot;test&quot;)
    (recur)))
</pre>
In the browser I created an <code>EventSource</code> object and set the <code>onmessage</code> handler to just print out the event result. I get a new event message once per second. The event <code>data</code> looks something like this <code>&quot;[B@100394d9&quot;</code>, however. That looks a whole lot like how Clojure prints out Byte arrays. I&apos;m wondering if Pedestal is incorrectly serializing SSE messages. 

These are the Pedestal dependencies that I have: 
<pre>[io.pedestal/pedestal.service &quot;0.5.3&quot;]
[io.pedestal/pedestal.route &quot;0.5.3&quot;]
[io.pedestal/pedestal.jetty &quot;0.5.3&quot;]
</pre></z><z id="t1510370666" t="eduardo morango Hello guys, can anyone help me, I&apos;m trying to setup a auto reload(like nodemon) for pedestal, I&apos;m following this article http://pedestal.io/guides/developing-at-the-repl but when I reload my route the auto reload doesn&apos;t work."><y>#</y><d>2017-11-11</d><h>03:24</h><w>eduardo morango</w>Hello guys, can anyone help me, I&apos;m trying to setup a auto reload(like nodemon) for pedestal, I&apos;m following this article <a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a> but when I reload my route the auto reload doesn&apos;t work.</z><z id="t1510435804" t="souenzzo [:attrs {:href &quot;/_/_/users/U7Y569509&quot;}] try to make your &quot;routes&quot; a function ::http/routes my-routes =&gt; ::http/routes #(my-routes)"><y>#</y><d>2017-11-11</d><h>21:30</h><w>souenzzo</w><a>@edvmorango</a> try to make your &quot;routes&quot; a function
 <code>::http/routes my-routes</code> =&gt; <code>::http/routes #(my-routes)</code></z><z id="t1510448366" t="eduardo morango [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] thank you, I found a alternative I&apos;m using midje (autotest)"><y>#</y><d>2017-11-12</d><h>00:59</h><w>eduardo morango</w><a>@souenzzo</a> thank you, I found a alternative I&apos;m using  midje (autotest)</z><z id="t1510623024" t="kenny Does anyone know of a way to access the Pedestal context from a Websocket handler?"><y>#</y><d>2017-11-14</d><h>01:30</h><w>kenny</w>Does anyone know of a way to access the Pedestal context from a Websocket handler?</z><z id="t1510756803" t="jfntn I’m trying to use io.pedestal.interceptor.chain directly to execute a chain over values taken from a core.async channel. With synchronous interceptors it’s trivial, but I’m not sure what I need to do support channel-returning interceptors?"><y>#</y><d>2017-11-15</d><h>14:40</h><w>jfntn</w>I’m trying to use <code>io.pedestal.interceptor.chain</code> directly to execute a chain over values taken from a core.async channel. With synchronous interceptors it’s trivial, but I’m not sure what I need to do support channel-returning interceptors?</z><z id="t1510756831" t="jfntn Is a full blown chain provider required for that? Would it work using a chan as a source of events?"><y>#</y><d>2017-11-15</d><h>14:40</h><w>jfntn</w>Is a full blown chain provider required for that? Would it work using a chan as a source of events?</z><z id="t1510828714" t="kirill.salykin Hi all, I created an issue to reorganize interceptor and ring-middleware namespaces. https://github.com/pedestal/pedestal/issues/542 I’d like to hear what you think about proposed changes. Thanks!"><y>#</y><d>2017-11-16</d><h>10:38</h><w>kirill.salykin</w>Hi all,

I created an issue to reorganize interceptor and ring-middleware namespaces.
<a href="https://github.com/pedestal/pedestal/issues/542" target="_blank">https://github.com/pedestal/pedestal/issues/542</a>

I’d like to hear what you think about proposed changes.

Thanks!</z><z id="t1511168473" t="nblumoe Hey, the Jetty websocket implementation passes the message payload as the only argument to the :on-text handler. This means that identifying the client which sent this message depends on the payload: https://github.com/pedestal/pedestal/blob/e9230c3a49b7036b195267c7c24b0c4881c941b5/jetty/src/io/pedestal/http/jetty/websockets.clj#L74 Instead this could also be done by passing the Session to the handler, too. Is there a good reason why this wasn’t done in the implementation? Would you be open for a PR adding this?"><y>#</y><d>2017-11-20</d><h>09:01</h><w>nblumoe</w>Hey, the Jetty websocket implementation passes the message payload as the only argument to the <code>:on-text</code> handler. This means that identifying the client which sent this message depends on the payload: <a href="https://github.com/pedestal/pedestal/blob/e9230c3a49b7036b195267c7c24b0c4881c941b5/jetty/src/io/pedestal/http/jetty/websockets.clj#L74" target="_blank">https://github.com/pedestal/pedestal/blob/e9230c3a49b7036b195267c7c24b0c4881c941b5/jetty/src/io/pedestal/http/jetty/websockets.clj#L74</a> Instead this could also be done by passing the <code>Session</code> to the handler, too. Is there a good reason why this wasn’t done in the implementation? Would you be open for a PR adding this?</z><z id="t1511188908" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U066HBF6J&quot;}] I think the best place for this question is the Pedestal User email group. Paul DeGrandis would be the best person to answer it."><y>#</y><d>2017-11-20</d><h>14:41</h><w>ddeaguiar</w><a>@nblumoe</a> I think the best place for this question is the Pedestal User email group. Paul DeGrandis would be the best person to answer it.</z><z id="t1511188958" t="nblumoe Great, thanks. Will give it a try there."><y>#</y><d>2017-11-20</d><h>14:42</h><w>nblumoe</w>Great, thanks. Will give it a try there.</z><z id="t1511189142" t="nblumoe It actually got already covered (kind of) here: https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/QmMe1iBBAQAJ"><y>#</y><d>2017-11-20</d><h>14:45</h><w>nblumoe</w>It actually got already covered (kind of) here: <a href="https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/QmMe1iBBAQAJ" target="_blank">https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/QmMe1iBBAQAJ</a></z><z id="t1511202583" t="rauh [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Left a note at this commit: https://github.com/pedestal/pedestal/commit/0f242071c7af09c344cc98bfcb688b42b16231e1"><y>#</y><d>2017-11-20</d><h>18:29</h><w>rauh</w><a>@mtnygard</a> Left a note at this commit: <a href="https://github.com/pedestal/pedestal/commit/0f242071c7af09c344cc98bfcb688b42b16231e1" target="_blank">https://github.com/pedestal/pedestal/commit/0f242071c7af09c344cc98bfcb688b42b16231e1</a></z><z id="t1511555392" t="amilner42 Hey everyone, I&apos;m super new to clojure, trying to set up a super basic graphql server with lacinia and lacinia-pedestal but I&apos;m getting CORs errors, anyone have any experience getting cors working with lacinia-pedestal?"><y>#</y><d>2017-11-24</d><h>20:29</h><w>amilner42</w>Hey everyone, I&apos;m super new to clojure, trying to set up a super basic graphql server with lacinia and lacinia-pedestal but I&apos;m getting CORs errors, anyone have any experience getting cors working with lacinia-pedestal?</z><z id="t1511555506" t="amilner42 (ns user &quot;The user gets loaded by the repl by default, just helps with testing queries out...&quot; (:require [api.schema :as s] [com.walmartlabs.lacinia :as lacinia] [com.walmartlabs.lacinia.pedestal :as lp] [io.pedestal.http :as http] [clojure.walk :as walk]) (:import (clojure.lang IPersistentMap))) ... (defn start-server [_] (-&gt; schema (lp/pedestal-service {:graphiql true}) http/create-server http/start)) I&apos;ve tried doing something like: (defn start-server [_] ( as-&gt; schema pipe-val (lp/pedestal-service pipe-val {:graphiql true}) (merge pipe-val { ::http/allowed-origins { :allowed-origins (constantly true)}}) (http/create-server pipe-val) (http/start pipe-val))) And it doesn&apos;t seem to work"><y>#</y><d>2017-11-24</d><h>20:31</h><w>amilner42</w><pre>(ns user
  &quot;The user gets loaded by the repl by default, just helps with testing queries out...&quot;
  (:require [api.schema :as s]
            [com.walmartlabs.lacinia :as lacinia]
            [com.walmartlabs.lacinia.pedestal :as lp]
            [io.pedestal.http :as http]
            [clojure.walk :as walk])
  (:import (clojure.lang IPersistentMap)))

...

(defn start-server
  [_]
  (-&gt; schema
      (lp/pedestal-service {:graphiql true})
      http/create-server
      http/start))
</pre>
I&apos;ve tried doing something like:

<pre>(defn start-server
  [_]
  ( as-&gt; schema pipe-val
      (lp/pedestal-service pipe-val {:graphiql true})
      (merge  pipe-val { ::http/allowed-origins { :allowed-origins (constantly true)}})
      (http/create-server pipe-val)
      (http/start pipe-val)))
</pre>

And it doesn&apos;t seem to work</z><z id="t1511555806" t="luskwater [:attrs {:href &quot;/_/_/users/U856C9MJP&quot;}] You may have already looked at this, but if not… https://github.com/pedestal/pedestal/tree/master/samples/cors"><y>#</y><d>2017-11-24</d><h>20:36</h><w>luskwater</w><a>@amilner42</a>  You may have already looked at this, but if not…
<a href="https://github.com/pedestal/pedestal/tree/master/samples/cors" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/cors</a></z><z id="t1511555916" t="amilner42 That was how I came up with what I tried :S … This is the first code I ever wrote in clojure so I’m kinda learning as I go…"><y>#</y><d>2017-11-24</d><h>20:38</h><w>amilner42</w>That was how I came up with what I tried :S … This is the first code I ever wrote in clojure so I’m kinda learning as I go…</z><z id="t1511556000" t="amilner42 Based on: https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L34"><y>#</y><d>2017-11-24</d><h>20:40</h><w>amilner42</w>Based on: <a href="https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L34" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L34</a></z><z id="t1511556277" t="luskwater [:attrs {:href &quot;/_/_/users/U856C9MJP&quot;}] Can&apos;t do much for you at the moment: I&apos;m sitting in a general store near Lancaster, PA, waiting for my wife. I recall a CORS setting or interceptor in code generated by lein vase for a Vase project. Might be worth looking at it. "><y>#</y><d>2017-11-24</d><h>20:44</h><w>luskwater</w><a>@amilner42</a> Can&apos;t do much for you at the moment: I&apos;m sitting in a general store near Lancaster, PA, waiting for my wife. I recall a CORS setting or interceptor in code generated by <code>lein vase</code> for a Vase project. Might be worth looking at it. </z><z id="t1511556327" t="amilner42 Ok no worries, thanks. I’ll generate that and see if it helps"><y>#</y><d>2017-11-24</d><h>20:45</h><w>amilner42</w>Ok no worries, thanks. I’ll generate that and see if it helps</z><z id="t1511556474" t="amilner42 Ya they seem to do the same thing in the Vase template"><y>#</y><d>2017-11-24</d><h>20:47</h><w>amilner42</w>Ya they seem to do the same thing in the Vase template</z><z id="t1511557605" t="amilner42 Oh I think this worked: (defn start-server [_] (-&gt; schema (lp/service-map {:graphiql true}) (merge { ::http/allowed-origins {:creds true :allowed-origins (constantly true)}}) http/create-server http/start)) It looks like lp/pedestal-service was calling create-server , so that’s why it wasn’t working…"><y>#</y><d>2017-11-24</d><h>21:06</h><w>amilner42</w>Oh I think this worked:

<pre>(defn start-server
  [_]
  (-&gt; schema
      (lp/service-map {:graphiql true})
      (merge { ::http/allowed-origins {:creds true :allowed-origins (constantly true)}})
      http/create-server
      http/start))</pre>

It looks like <code>lp/pedestal-service</code> was calling <code>create-server</code>, so that’s why it wasn’t working…</z><z id="t1511557639" t="luskwater 👍 "><y>#</y><d>2017-11-24</d><h>21:07</h><w>luskwater</w><b>👍</b> </z><z id="t1511558741" t="amilner42 Ya that was it…ugh so dumb. Thanks"><y>#</y><d>2017-11-24</d><h>21:25</h><w>amilner42</w>Ya that was it…ugh so dumb. Thanks</z><z id="t1511701678" t="michael zhou A strange error, anyone knows about the error? Thanks."><y>#</y><d>2017-11-26</d><h>13:07</h><w>michael zhou</w>A strange error, anyone knows about the error? Thanks.</z><z id="t1511796201" t="mtnygard Hi [:attrs {:href &quot;/_/_/users/U3GA4EXA9&quot;}] . That is a strange error. Are you using the same JVM version on Mac and Windows?"><y>#</y><d>2017-11-27</d><h>15:23</h><w>mtnygard</w>Hi <a>@zhoumin79</a>. That is a strange error. Are you using the same JVM version on Mac and Windows?</z><z id="t1511874294" t="michael zhou [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Yes.All use JDK1.8."><y>#</y><d>2017-11-28</d><h>13:04</h><w>michael zhou</w><a>@mtnygard</a> Yes.All use JDK1.8.</z><z id="t1512161756" t="luskwater All of the attempts generate “Not found”"><y>#</y><d>2017-12-01</d><h>20:55</h><w>luskwater</w>All of the attempts generate “Not found”</z><z id="t1512163945" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0AQHH2MB&quot;}] the describe-api route should be something like this /[api root]/version . If you use lein new vase foo to create your service, then the describe-api route will be available as /api/foo/v1 . The relevant code for this is found https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L95 and https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L80 . Hope this helps!"><y>#</y><d>2017-12-01</d><h>21:32</h><w>ddeaguiar</w><a>@luskwater</a> the <code>describe-api</code> route should be something like this <code>/[api root]/version</code>. If you use <code>lein new vase foo</code> to create your service, then the <code>describe-api</code> route will be available as <code>/api/foo/v1</code>. The relevant code for this is found <a href="https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L95" target="_blank">https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L95</a> and <a href="https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L80" target="_blank">https://github.com/cognitect-labs/vase/blob/master/src/com/cognitect/vase/routes.clj#L80</a>. Hope this helps!</z><z id="t1512164045" t="luskwater So it&apos;s just the bare root, w/o /describe-api . Excellent, thank you"><y>#</y><d>2017-12-01</d><h>21:34</h><w>luskwater</w>So it&apos;s just the bare root, w/o <code>/describe-api</code>. Excellent, thank you</z><z id="t1512164577" t="ddeaguiar np"><y>#</y><d>2017-12-01</d><h>21:42</h><w>ddeaguiar</w>np</z><z id="t1512592728" t="admay Anyone on here using lacinia-pedestal?"><y>#</y><d>2017-12-06</d><h>20:38</h><w>admay</w>Anyone on here using lacinia-pedestal?</z><z id="t1513102817" t="souenzzo https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58 How to know the ws-session or send-ch on on-text ?? https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L69 on-text should receive 2 args, this and txt , not?"><y>#</y><d>2017-12-12</d><h>18:20</h><w>souenzzo</w><a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58</a>
How to know the <code>ws-session</code> or <code>send-ch</code> on <code>on-text</code>?? 
<a href="https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L69" target="_blank">https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L69</a>
<code>on-text</code> should receive 2 args, <code>this</code> and <code>txt</code>, not?</z><z id="t1513258650" t="souenzzo Bump!"><y>#</y><d>2017-12-14</d><h>13:37</h><r>souenzzo</r>Bump!</z><z id="t1513261488" t="thegeez FWIW, I agree, and wrote another websocket listener that calls a callback on on-text with a connection-id: https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/system/websocket.clj#L49"><y>#</y><d>2017-12-14</d><h>14:24</h><r>thegeez</r>FWIW, I agree, and wrote another websocket listener that calls a callback on <code>on-text</code> with a connection-id: <a href="https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/system/websocket.clj#L49" target="_blank">https://github.com/thegeez/clj-board/blob/master/src/clj/net/thegeez/clj_board/system/websocket.clj#L49</a></z><z id="t1513258650" t="souenzzo Bump!"><y>#</y><d>2017-12-14</d><h>13:37</h><w>souenzzo</w>Bump!</z><z id="t1513168712" t="pasi hey guys. Is there an up-to-date guide for automatically reloading code? The auto reload server example is from 2013"><y>#</y><d>2017-12-13</d><h>12:38</h><w>pasi</w>hey guys. Is there an up-to-date guide for automatically reloading code? The auto reload server example is from 2013</z><z id="t1513169743" t="souenzzo just turn your ::http/routes into a function [:attrs {:href &quot;/_/_/users/U5KHPCJ7R&quot;}]"><y>#</y><d>2017-12-13</d><h>12:55</h><w>souenzzo</w>just turn your <code>::http/routes</code> into a function <a>@pasi</a></z></g><g id="s10"><z id="t1513170415" t="pasi hm, good idea. I guess in my case I&apos;ll just turn this into a function: (def service (lacinia/service-map schema {:graphiql true}))"><y>#</y><d>2017-12-13</d><h>13:06</h><w>pasi</w>hm, good idea. I guess in my case I&apos;ll just turn this into a function: <code>(def service (lacinia/service-map schema {:graphiql true}))</code></z><z id="t1513170448" t="souenzzo ::http/routes my-routes -&gt; ::http/routes #(my-routes) lacinia has own docs about hot reload."><y>#</y><d>2017-12-13</d><h>13:07</h><w>souenzzo</w><code>::http/routes my-routes</code> -&gt; <code>::http/routes #(my-routes)</code>
lacinia has own docs about hot reload.</z><z id="t1513170529" t="souenzzo https://github.com/walmartlabs/lacinia-pedestal#development-mode (def service (lacinia/service-map hello-schema {:graphiql true})) -&gt; (def service (lacinia/service-map #(hello-schema) {:graphiql true}))"><y>#</y><d>2017-12-13</d><h>13:08</h><w>souenzzo</w><a href="https://github.com/walmartlabs/lacinia-pedestal#development-mode" target="_blank">https://github.com/walmartlabs/lacinia-pedestal#development-mode</a>
<code>(def service (lacinia/service-map hello-schema {:graphiql true}))</code> -&gt; <code>(def service (lacinia/service-map #(hello-schema) {:graphiql true}))</code></z><z id="t1513170647" t="pasi nod, cheers"><y>#</y><d>2017-12-13</d><h>13:10</h><w>pasi</w>nod, cheers</z><z id="t1513256775" t="fmind Hi, I was wondering about the state of pedestal"><y>#</y><d>2017-12-14</d><h>13:06</h><w>fmind</w>Hi, I was wondering about the state of pedestal</z><z id="t1513256804" t="fmind the architecture is really nice, and there is many libraries available to enrich pedestal already"><y>#</y><d>2017-12-14</d><h>13:06</h><w>fmind</w>the architecture is really nice, and there is many libraries available to enrich pedestal already</z><z id="t1513256841" t="fmind but as I checked on http://pedestal.io , the documentation is really poor compared to the quality of framework"><y>#</y><d>2017-12-14</d><h>13:07</h><w>fmind</w>but as I checked on <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>, the documentation is really poor compared to the quality of framework</z><z id="t1513256901" t="fmind moreover, it&apos;s difficult to assess the momentum of pedestal. Ring seems more popular, but companies seems to prefer pedestal"><y>#</y><d>2017-12-14</d><h>13:08</h><w>fmind</w>moreover, it&apos;s difficult to assess the momentum of pedestal. Ring seems more popular, but companies seems to prefer pedestal</z><z id="t1513256921" t="luskwater I know there’s ongoing work in the docs; how much, I don’t know (other than contributing a few small fixes/clarifications)"><y>#</y><d>2017-12-14</d><h>13:08</h><w>luskwater</w>I know there’s ongoing work in the docs; how much, I don’t know (other than contributing a few small fixes/clarifications)</z><z id="t1513256966" t="fmind I plan to create a small template for my web project. I started with Ring, but the architecture of pedestal seems more compelling to me"><y>#</y><d>2017-12-14</d><h>13:09</h><w>fmind</w>I plan to create a small template for my web project. I started with Ring, but the architecture of pedestal seems more compelling to me</z><z id="t1513256979" t="fmind and if it works, I&apos;ll try to contribute to the documention"><y>#</y><d>2017-12-14</d><h>13:09</h><w>fmind</w>and if it works, I&apos;ll try to contribute to the documention</z><z id="t1513257063" t="fmind but it really bothers me. Pedestal seems to be a nice framework, but the ecosystem is lacking (template, documentation, guides ...)"><y>#</y><d>2017-12-14</d><h>13:11</h><w>fmind</w>but it really bothers me. Pedestal seems to be a nice framework, but the ecosystem is lacking (template, documentation, guides ...)</z><z id="t1513257118" t="luskwater Yes: topics, but not links to anything. Granted"><y>#</y><d>2017-12-14</d><h>13:11</h><w>luskwater</w>Yes: topics, but not links to anything. Granted</z><z id="t1513258814" t="mpenet I dont think so: https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L75"><y>#</y><d>2017-12-14</d><h>13:40</h><w>mpenet</w>I dont think so: <a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L75" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L75</a></z><z id="t1513260314" t="oconn Hey all. I’ve been fighting with route matching for a bit and I’m sure I’m missing something pretty simple. I have the following two routes; [&quot;/v1/org/self&quot; :get (conj common (xpa-org/get-organizations-self))] [&quot;/v1/org/:org-id&quot; :get (conj common (xpa-org/get-organization)) :constraints {:org-id uuid-constraint}] When I make a request to /v1/org/self it always appears to only want to match the second route (`/v1/org/:org-id`). I believe I could turn /v1/org/self into /v1/org/self/orgs and it would work, but I’m trying to figure out if the above is possible without changing the structure of my routes. The expanded routes do include both."><y>#</y><d>2017-12-14</d><h>14:05</h><w>oconn</w>Hey all. I’ve been fighting with route matching for a bit and I’m sure I’m missing something pretty simple. I have the following two routes;

<pre>[&quot;/v1/org/self&quot;    :get (conj common (xpa-org/get-organizations-self))]
[&quot;/v1/org/:org-id&quot; :get (conj common (xpa-org/get-organization)) :constraints {:org-id uuid-constraint}]
</pre>
When I make a request to <code>/v1/org/self</code> it always appears to only want to match the second route (`/v1/org/:org-id`). I believe I could turn <code>/v1/org/self</code> into <code>/v1/org/self/orgs</code> and it would work, but I’m trying to figure out if the above is possible without changing the structure of my routes. The expanded routes do include both.</z><z id="t1513266271" t="ikitommi [:attrs {:href &quot;/_/_/users/U1APR44RE&quot;}] wildcards always override others, by design, but not with linear-router. Agree that it&apos;s not right."><y>#</y><d>2017-12-14</d><h>15:44</h><w>ikitommi</w><a>@oconn</a> wildcards always override others, by design, but not with linear-router. Agree that it&apos;s not right.</z><z id="t1513266453" t="oconn Ok cool, thanks for the insight"><y>#</y><d>2017-12-14</d><h>15:47</h><w>oconn</w>Ok cool, thanks for the insight</z><z id="t1513266553" t="ikitommi I think it woudn&apos;t with either /v1/orgs/self/orgs either. Wildcards are REALLY greedy."><y>#</y><d>2017-12-14</d><h>15:49</h><w>ikitommi</w>I think it woudn&apos;t with either <code>/v1/orgs/self/orgs</code> either. Wildcards are REALLY greedy.</z><z id="t1513266645" t="donaldball There is the :constraints metadata"><y>#</y><d>2017-12-14</d><h>15:50</h><w>donaldball</w>There is the <code>:constraints</code> metadata</z><z id="t1513266651" t="oconn yeah I think I’m going to go with /v1/orgs/self/orgs but it would be nice to weight them somehow"><y>#</y><d>2017-12-14</d><h>15:50</h><w>oconn</w>yeah I think I’m going to go with <code>/v1/orgs/self/orgs</code> but it would be nice to weight them somehow</z><z id="t1513266675" t="oconn Yeah so above I am using constraints but it returns a 404"><y>#</y><d>2017-12-14</d><h>15:51</h><w>oconn</w>Yeah so above I am using constraints but it returns a <code>404</code></z><z id="t1513266689" t="oconn after failing the constraint on :org-id"><y>#</y><d>2017-12-14</d><h>15:51</h><w>oconn</w>after failing the constraint on <code>:org-id</code></z><z id="t1513266697" t="donaldball https://github.com/pedestal/pedestal/blob/master/guides/documentation/routing-terse-syntax.md#constraints"><y>#</y><d>2017-12-14</d><h>15:51</h><w>donaldball</w><a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/routing-terse-syntax.md#constraints" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/routing-terse-syntax.md#constraints</a></z><z id="t1513266705" t="donaldball What’re your constraints?"><y>#</y><d>2017-12-14</d><h>15:51</h><w>donaldball</w>What’re your constraints?</z><z id="t1513266716" t="oconn :constraints {:org-id uuid-constraint}"><y>#</y><d>2017-12-14</d><h>15:51</h><w>oconn</w><code>:constraints {:org-id uuid-constraint}</code></z><z id="t1513266720" t="oconn which is…"><y>#</y><d>2017-12-14</d><h>15:52</h><w>oconn</w>which is…</z><z id="t1513266721" t="donaldball oh, hah, sorry, too early 😛"><y>#</y><d>2017-12-14</d><h>15:52</h><w>donaldball</w>oh, hah, sorry, too early <b>😛</b></z><z id="t1513266773" t="oconn #&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;"><y>#</y><d>2017-12-14</d><h>15:52</h><w>oconn</w><code>#&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;</code></z><z id="t1513266819" t="donaldball FWIW that’s not specified as metadata, no idea if it will actually work in that form"><y>#</y><d>2017-12-14</d><h>15:53</h><w>donaldball</w>FWIW that’s not specified as metadata, no idea if it will actually work in that form</z><z id="t1513266960" t="oconn I believe the constraint is being applied. When I remove it and make a request to /v1/org/self the request is routed through the /org/:org-id handler. Then when I add it I end up receiving a 404"><y>#</y><d>2017-12-14</d><h>15:56</h><w>oconn</w>I believe the constraint is being applied. When I remove it and make a request to <code>/v1/org/self</code> the request is routed through the <code>/org/:org-id</code> handler. Then when I add it I end up receiving a <code>404</code></z><z id="t1513267004" t="ikitommi If there is a wild route, it masks all static routes."><y>#</y><d>2017-12-14</d><h>15:56</h><w>ikitommi</w>If there is a wild route, it masks all static routes.</z><z id="t1513267016" t="luskwater [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] I think that is a legitimate “constraint clause” as mentioned in the docs somewhere (just read it): http://pedestal.io/reference/routing-quick-reference#_table_syntax"><y>#</y><d>2017-12-14</d><h>15:56</h><w>luskwater</w><a>@donaldball</a> I think that is a legitimate “constraint clause” as mentioned in the docs somewhere (just read it): 
<a href="http://pedestal.io/reference/routing-quick-reference#_table_syntax" target="_blank">http://pedestal.io/reference/routing-quick-reference#_table_syntax</a></z><z id="t1513267037" t="ikitommi even If the static path has more segments."><y>#</y><d>2017-12-14</d><h>15:57</h><w>ikitommi</w>even If the static path has more segments.</z><z id="t1513267066" t="luskwater It would mask the static routes unless you use {:io.pedestal.http/router :linear-search} I think"><y>#</y><d>2017-12-14</d><h>15:57</h><w>luskwater</w>It would mask the static routes unless you use <code>{:io.pedestal.http/router :linear-search}</code> I think</z><z id="t1513267080" t="ikitommi yes, https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362"><y>#</y><d>2017-12-14</d><h>15:58</h><w>ikitommi</w>yes, <a href="https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362" target="_blank">https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362</a></z><z id="t1513267094" t="luskwater and the non-wild route precedes the wild one"><y>#</y><d>2017-12-14</d><h>15:58</h><w>luskwater</w>and the non-wild route precedes the wild one</z><z id="t1513267097" t="donaldball Ha ha wow. I guess you could put the switch in your route handler for the “self” case"><y>#</y><d>2017-12-14</d><h>15:58</h><w>donaldball</w>Ha ha wow. I guess you could put the switch in your route handler for the “self” case</z><z id="t1513267106" t="donaldball if you added it to your regex"><y>#</y><d>2017-12-14</d><h>15:58</h><w>donaldball</w>if you added it to your regex</z><z id="t1513270797" t="shaun-mahood Is anyone aware of any existing projects to get pedestal interceptors into ring?"><y>#</y><d>2017-12-14</d><h>16:59</h><w>shaun-mahood</w>Is anyone aware of any existing projects to get pedestal interceptors into ring?</z><z id="t1513271257" t="mpenet We use the interceptor lib with a custom jetty adapter here"><y>#</y><d>2017-12-14</d><h>17:07</h><w>mpenet</w>We use the interceptor lib with a custom jetty adapter here</z><z id="t1513271288" t="mpenet We dont use specific interceptor &quot;instances&quot; from pedestal tho"><y>#</y><d>2017-12-14</d><h>17:08</h><w>mpenet</w>We dont use specific interceptor &quot;instances&quot;  from pedestal tho</z><z id="t1513273864" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U050SC7SV&quot;}] : Are you using it with a bunch of existing ring middleware, or is everything custom interceptors?"><y>#</y><d>2017-12-14</d><h>17:51</h><w>shaun-mahood</w><a>@mpenet</a>: Are you using it with a bunch of existing ring middleware, or is everything custom interceptors?</z><z id="t1513276353" t="ikitommi how would interceptors work with ring? I think middleware is the equivalent to interceptor, but fundamentally different. But it&apos;s relatively easy to write code that could be used as either one."><y>#</y><d>2017-12-14</d><h>18:32</h><w>ikitommi</w>how would interceptors work with ring? I think middleware is the equivalent to interceptor, but fundamentally different. But it&apos;s relatively easy to write code that could be used as either one.</z><z id="t1513276384" t="ikitommi I think Pedestal = Interceptors."><y>#</y><d>2017-12-14</d><h>18:33</h><w>ikitommi</w>I think Pedestal = Interceptors.</z><z id="t1513276621" t="fmind Pedestal is data oriented. Fundamentally, interceptors are hash map with an :enter and :leave keys that point to functions. It&apos;s up to pedestal to combine and execute these interceptors. One nice thing is thar pedestal works with core.async. And if tomorrow, we find a better way that core async, we could replace the execution engine without changing interceptor descriptions."><y>#</y><d>2017-12-14</d><h>18:37</h><w>fmind</w>Pedestal is data oriented. Fundamentally, interceptors are hash map with an :enter and :leave keys that point to functions. It&apos;s up to pedestal to combine and execute these interceptors. One nice thing is thar pedestal works with core.async. And if tomorrow, we find a better way that core async, we could replace the execution engine without changing interceptor descriptions.</z><z id="t1513276695" t="fmind On ring, middleware are simple functions. They take the next handler as a parameter, and execute it when they want. They can perform task before our after the next function execution."><y>#</y><d>2017-12-14</d><h>18:38</h><w>fmind</w>On ring, middleware are simple functions. They take the next handler as a parameter, and execute it when they want. They can perform task before our after the next function execution.</z><z id="t1513276707" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] : The main issue I have with ring middleware is how understandable/visible it is - every time I have tried to set add new middleware to a ring project I end up spending a bunch of time moving things around so that things are applied in the right order, or enabling/disabling middleware until things work. It&apos;s difficult to know what is actually happening without diving into the code, and I&apos;ve found it painful to figure out where and how I want to log things related to them."><y>#</y><d>2017-12-14</d><h>18:38</h><w>shaun-mahood</w><a>@ikitommi</a>: The main issue I have with ring middleware is how understandable/visible it is - every time I have tried to set add new middleware to a ring project I end up spending a bunch of time moving things around so that things are applied in the right order, or enabling/disabling middleware until things work. It&apos;s difficult to know what is actually happening without diving into the code, and I&apos;ve found it painful to figure out where and how I want to log things related to them.</z><z id="t1513276775" t="fmind But by doing so, you cannot control the execution. Ring start the first handler through a simple functions call. You can&apos;t plug something like core.async easily "><y>#</y><d>2017-12-14</d><h>18:39</h><w>fmind</w>But by doing so, you cannot control the execution. Ring start the first handler through a simple functions call. You can&apos;t plug something like core.async easily
</z><z id="t1513276802" t="shaun-mahood I want to be able to inspect the stack of earlier interceptors to see how my data has changed, and see what is still remaining to be run."><y>#</y><d>2017-12-14</d><h>18:40</h><w>shaun-mahood</w>I want to be able to inspect the stack of earlier interceptors to see how my data has changed, and see what is still remaining to be run.</z><z id="t1513276932" t="ikitommi i agree, but If you take Interceptors instead If mw, is it Ring anymore? (your original question)"><y>#</y><d>2017-12-14</d><h>18:42</h><w>ikitommi</w>i agree, but If you take Interceptors instead If mw, is it Ring anymore? (your original question)</z><z id="t1513276962" t="ikitommi I&apos;m using both, depending on a project."><y>#</y><d>2017-12-14</d><h>18:42</h><w>ikitommi</w>I&apos;m using both, depending on a project.</z><z id="t1513276978" t="ikitommi and writing libs that support both styles."><y>#</y><d>2017-12-14</d><h>18:42</h><w>ikitommi</w>and writing libs that support both styles.</z><z id="t1513277152" t="ikitommi and you can inspect &amp; reorder mw-chains too, but only before the chain is created. Once it&apos;s chained, it&apos;s just a fn."><y>#</y><d>2017-12-14</d><h>18:45</h><w>ikitommi</w>and you can inspect &amp; reorder mw-chains too, but only before the chain is created. Once it&apos;s chained, it&apos;s just a fn.</z><z id="t1513281226" t="fmind I started to learn Pedestal and I&apos;m a bit confuse about some Clojure librairies"><y>#</y><d>2017-12-14</d><h>19:53</h><w>fmind</w>I started to learn Pedestal and I&apos;m a bit confuse about some Clojure librairies</z><z id="t1513281259" t="fmind I want to develop an API oriented web stack, and I think Pedestal is a good start for that purpose"><y>#</y><d>2017-12-14</d><h>19:54</h><w>fmind</w>I want to develop an API oriented web stack, and I think Pedestal is a good start for that purpose</z><z id="t1513281298" t="fmind but then, there is many librairies like liberator, vase and lacinia. I don&apos;t know which one to integrate, and I can&apos;t find pros and cons on the internet"><y>#</y><d>2017-12-14</d><h>19:54</h><w>fmind</w>but then, there is many librairies like liberator, vase and lacinia. I don&apos;t know which one to integrate, and I can&apos;t find pros and cons on the internet</z><z id="t1513281334" t="fmind is vase compatible with lacinia ? is there a way to switch to another DB than datomic ?"><y>#</y><d>2017-12-14</d><h>19:55</h><w>fmind</w>is vase compatible with lacinia ? is there a way to switch to another DB than datomic ?</z><z id="t1513281358" t="fmind and on the client side, what is the quickest way to integrate with Clojurescript ? om.next ? fulcro ?"><y>#</y><d>2017-12-14</d><h>19:55</h><w>fmind</w>and on the client side, what is the quickest way to integrate with Clojurescript ? om.next ? fulcro ?</z><z id="t1513281385" t="fmind do you know some templates that combine these tools ?"><y>#</y><d>2017-12-14</d><h>19:56</h><w>fmind</w>do you know some templates that combine these tools ?</z><z id="t1513281426" t="mtnygard [:attrs {:href &quot;/_/_/users/U1AGP1RD5&quot;}] I sympathize. There are a plethora of options and not a lot of &quot;stacks&quot; that offer pre-integrated components."><y>#</y><d>2017-12-14</d><h>19:57</h><w>mtnygard</w><a>@fmind</a> I sympathize. There are a plethora of options and not a lot of &quot;stacks&quot; that offer pre-integrated components.</z><z id="t1513281463" t="mtnygard I&apos;m one of the maintainers of Vase &amp; Pedestal, so I have a personal preference toward those. Vase is quite tied to Datomic in its current state, though."><y>#</y><d>2017-12-14</d><h>19:57</h><w>mtnygard</w>I&apos;m one of the maintainers of Vase &amp; Pedestal, so I have a personal preference toward those. Vase is quite tied to Datomic in its current state, though.</z><z id="t1513281478" t="fmind yes ... the Clojure community takes modularity to hearth, but it&apos;s not the most productive option for quick development"><y>#</y><d>2017-12-14</d><h>19:57</h><w>fmind</w>yes ... the Clojure community takes modularity to hearth, but it&apos;s not the most productive option for quick development</z><z id="t1513281512" t="fmind and there is a lot of back-up from experienced programmers who met the problem these technologies try to address"><y>#</y><d>2017-12-14</d><h>19:58</h><w>fmind</w>and there is a lot of back-up from experienced programmers who met the problem these technologies try to address</z><z id="t1513281556" t="luskwater Nothing prevents you from - creating your own data-readers so you can have #fmind/jdbc action literals (or the like) - adding an interceptor that hangs a pooled Connection on the context and takes it back on the way out - don’t know about quickest way: I was hoping to use Vase, but find that my client’s standard server framework (Java) is heavy and burdensome, but perhaps must be used"><y>#</y><d>2017-12-14</d><h>19:59</h><w>luskwater</w>Nothing prevents you from 
- creating your own data-readers so you can have <code>#fmind/jdbc</code> action literals (or the like)
- adding an interceptor that hangs a pooled <code>Connection</code> on the context and takes it back on the way out
- don’t know about quickest way: I was hoping to use Vase, but find that my client’s standard server framework (Java) is heavy and burdensome, but perhaps must be used</z><z id="t1513281603" t="fmind I like the design of vase, but I&apos;m afraid that the dependence to REST and Datomic will bite me on the long term"><y>#</y><d>2017-12-14</d><h>20:00</h><w>fmind</w>I like the design of vase, but I&apos;m afraid that the dependence to REST and Datomic will bite me on the long term</z><z id="t1513281641" t="mtnygard [:attrs {:href &quot;/_/_/users/U1AGP1RD5&quot;}] I understand. What are your technology constraints? (E.g., are you restricted to certain DB?)"><y>#</y><d>2017-12-14</d><h>20:00</h><w>mtnygard</w><a>@fmind</a> I understand. What are your technology constraints? (E.g., are you restricted to certain DB?)</z><z id="t1513281746" t="fmind I work in a research environment and I have few tech constraints. I&apos;m quite found of Datomic, but we can&apos;t pay the price for Datomic pro"><y>#</y><d>2017-12-14</d><h>20:02</h><w>fmind</w>I work in a research environment and I have few tech constraints. I&apos;m quite found of Datomic, but we can&apos;t pay the price for Datomic pro</z><z id="t1513281775" t="ordnungswidrig Liberator maintainer here, just keep in mind that liberator (and anything that runs on the ring model) works perfectly fine with pedestal. You’ll lose some of the async / non-blocking properties of pedestal, though."><y>#</y><d>2017-12-14</d><h>20:02</h><w>ordnungswidrig</w>Liberator maintainer here, just keep in mind that liberator (and anything that runs on the ring model) works perfectly fine with pedestal. You’ll lose some of the async / non-blocking properties of pedestal, though.</z><z id="t1513281817" t="mtnygard I&apos;ve been working on an evolution of Vase that makes it easier to add new actions that go beyond Datomic. That&apos;s at https://github.com/mtnygard/vase/tree/fern-input"><y>#</y><d>2017-12-14</d><h>20:03</h><w>mtnygard</w>I&apos;ve been working on an evolution of Vase that makes it easier to add new actions that go beyond Datomic. That&apos;s at <a href="https://github.com/mtnygard/vase/tree/fern-input" target="_blank">https://github.com/mtnygard/vase/tree/fern-input</a></z><z id="t1513281825" t="mtnygard Not released yet, but in a usable state."><y>#</y><d>2017-12-14</d><h>20:03</h><w>mtnygard</w>Not released yet, but in a usable state.</z><z id="t1513281836" t="fmind [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] [:attrs {:href &quot;/_/_/users/U054UD60U&quot;}] thanks for your feedbacks"><y>#</y><d>2017-12-14</d><h>20:03</h><w>fmind</w><a>@mtnygard</a> <a>@ordnungswidrig</a> thanks for your feedbacks</z><z id="t1513281867" t="fmind I want to start small with a small web app that provides both REST and GraphQL end points."><y>#</y><d>2017-12-14</d><h>20:04</h><w>fmind</w>I want to start small with a small web app that provides both REST and GraphQL end points.</z><z id="t1513281914" t="fmind my plan was to start with Pedestal + Lacinia and see which of vase liberator would be the best fit"><y>#</y><d>2017-12-14</d><h>20:05</h><w>fmind</w>my plan was to start with Pedestal + Lacinia and see which of vase liberator would be the best fit</z><z id="t1513281929" t="ordnungswidrig [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] vase-fern looks very promising. I will dig into that very likely."><y>#</y><d>2017-12-14</d><h>20:05</h><w>ordnungswidrig</w><a>@mtnygard</a> vase-fern looks very promising. I will dig into that very likely.</z><z id="t1513282007" t="ordnungswidrig [:attrs {:href &quot;/_/_/users/U1AGP1RD5&quot;}] I’m thinking for a while now how to bring the niceness of liberator to the pedestal world but I’ve yet to hit a sweet spot. Maybe I’ll have a bright moment over the holidays 😛"><y>#</y><d>2017-12-14</d><h>20:06</h><w>ordnungswidrig</w><a>@fmind</a> I’m thinking for a while now how to bring the niceness of liberator to the pedestal world but I’ve yet to hit a sweet spot. Maybe I’ll have a bright moment over the holidays <b>😛</b></z><z id="t1513282083" t="mtnygard [:attrs {:href &quot;/_/_/users/U054UD60U&quot;}] If you want to chat about it, hit me up. I like what Liberator brings!"><y>#</y><d>2017-12-14</d><h>20:08</h><w>mtnygard</w><a>@ordnungswidrig</a> If you want to chat about it, hit me up. I like what Liberator brings!</z><z id="t1513282123" t="fmind The good thing with Clojure is that it&apos;s easy to test stuff. I will try to use both lib and see what is the best fit"><y>#</y><d>2017-12-14</d><h>20:08</h><w>fmind</w>The good thing with Clojure is that it&apos;s easy to test stuff. I will try to use both lib and see what is the best fit</z><z id="t1513336193" t="souenzzo https://youtu.be/qijWBPYkRAQ"><y>#</y><d>2017-12-15</d><h>11:09</h><r>souenzzo</r><a href="https://youtu.be/qijWBPYkRAQ" target="_blank">https://youtu.be/qijWBPYkRAQ</a></z><z id="t1513282152" t="fmind Would you have any recommandation for the client side with Clojure script ?"><y>#</y><d>2017-12-14</d><h>20:09</h><w>fmind</w>Would you have any recommandation for the client side with Clojure script ?</z><z id="t1513306918" t="imetallica [:attrs {:href &quot;/_/_/users/U1AGP1RD5&quot;}] reagent + re-frame"><y>#</y><d>2017-12-15</d><h>03:01</h><w>imetallica</w><a>@fmind</a> reagent + re-frame</z><z id="t1513318459" t="fmind [:attrs {:href &quot;/_/_/users/U0XE11ZRB&quot;}] what&apos;s your opinion on om.next and fulcro ?"><y>#</y><d>2017-12-15</d><h>06:14</h><w>fmind</w><a>@imetallica</a> what&apos;s your opinion on om.next and fulcro ?</z><z id="t1513337641" t="imetallica @fmind I don’t have an opinion, I’ve never used them."><y>#</y><d>2017-12-15</d><h>11:34</h><w>imetallica</w>@fmind I don’t have an opinion, I’ve never used them.</z><z id="t1513394578" t="chris_johnson [:attrs {:href &quot;/_/_/users/U1AGP1RD5&quot;}] The second- and third- most recent episodes of the defn podcast ( https://defn.audio ) are interviews with David Nolen (one of the main contributors to om.next) and Tony Kay (author and maintainer of fulcro), respectively. Having listened to both, I think you would be really well-served to hear each of their takes on pros, cons, and most critically what problems each library is trying to solve and what tradeoffs their authors chose to make in building them."><y>#</y><d>2017-12-16</d><h>03:22</h><w>chris_johnson</w><a>@fmind</a> The second- and third- most recent episodes of the defn podcast (<a href="https://defn.audio" target="_blank">https://defn.audio</a>) are interviews with David Nolen (one of the main contributors to om.next) and Tony Kay (author and maintainer of fulcro), respectively. Having listened to both, I think you would be really well-served to hear each of their takes on pros, cons, and most critically what problems each library is trying to solve and what tradeoffs their authors chose to make in building them.</z><z id="t1513394887" t="chris_johnson It’s not “just use Rails, mang” as simplicity of answers go, but I really do feel that one of the really important benefits of working in and with the Clojure community is that you have both access to the really powerful and generous minds that build the tools we use, and the leisure time - thanks to the quick work our sharp tools make of most mundane programming tasks- to really dig into the hows and whys of the tools you choose to add to your personal arsenal. Very, very few communities of working engineers in this era of technology have anything akin to what’s available to the working Clojurist; you owe it to yourself to at least once arrive at a decision about using library B over library A because you understand both and not because Google PageRank or a co-worker pointed you to one or the other. 😇"><y>#</y><d>2017-12-16</d><h>03:28</h><w>chris_johnson</w>It’s not “just use Rails, mang” as simplicity of answers go, but I really do feel that one of the really important benefits of working in and with the Clojure community is that you have both access to the really powerful and generous minds that build the tools we use, and the leisure time - thanks to the quick work our sharp tools make of most mundane programming tasks- to really dig into the hows and whys of the tools you choose to add to your personal arsenal. Very, very few communities of working engineers in this era of technology have anything akin to what’s available to the working Clojurist; you owe it to yourself to at least once arrive at a decision about using library <code>B</code> over library <code>A</code> because you understand both  and not because Google PageRank or a co-worker pointed you to one or the other. <b>😇</b></z><z id="t1513398502" t="donaldball I have written some in om.next and always have the experience where I read the docs and think I get it, then switch over to the code and have no idea what to do. The fundamental ideas are very good but I am not at all sure about the api tbh."><y>#</y><d>2017-12-16</d><h>04:28</h><w>donaldball</w>I have written some in om.next and always have the experience where I read the docs and think I get it, then switch over to the code and have no idea what to do. The fundamental ideas are very good but I am not at all sure about the api tbh.</z><z id="t1513411253" t="fmind [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] I think the core principles of the Clojure community are wonderful: simplicity, modularity, innovation. The community managed to create both mature language and a nice lab to test new ideas"><y>#</y><d>2017-12-16</d><h>08:00</h><w>fmind</w><a>@chris_johnson</a> I think the core principles of the Clojure community are wonderful: simplicity, modularity, innovation. The community managed to create both mature language and a nice lab to test new ideas</z><z id="t1513411309" t="fmind In the area of web development, the community pushed some nice ideas: the react architecture, query on the client side, management of state ..."><y>#</y><d>2017-12-16</d><h>08:01</h><w>fmind</w>In the area of web development, the community pushed some nice ideas: the react architecture, query on the client side, management of state ...</z><z id="t1513411450" t="fmind it takes time and efforts to appreciate all these innovations. I do it during my free time, and I enjoyed learning through projects like Pedestal and om.next"><y>#</y><d>2017-12-16</d><h>08:04</h><w>fmind</w>it takes time and efforts to appreciate all these innovations. I do it during my free time, and I enjoyed learning through projects like Pedestal and om.next</z><z id="t1513411722" t="fmind but in term of productivity, I would love to have some sane defaults I could use in my projects"><y>#</y><d>2017-12-16</d><h>08:08</h><w>fmind</w>but in term of productivity, I would love to have some sane defaults I could use in my projects</z><z id="t1513411773" t="fmind that&apos;s why I appreciate the feedback from experienced developers on their tech choice"><y>#</y><d>2017-12-16</d><h>08:09</h><w>fmind</w>that&apos;s why I appreciate the feedback from experienced developers on their tech choice</z><z id="t1513415153" t="ikitommi Hi. Would it be a good idea to lift Interceptors out of Pedestal into a more common concept for Clojure? Like Ring, which defines just a spec that different libs could use - and produce Interceptors that can be used with other libs - like Ring. Currently, I know at least 5 different interceptor runners, inspired by Pedestal, but bit different. I don’t think this helps in the big pic. There are :before and :after s, :in &amp; :out s, different keys for errors, queues, stacks etc."><y>#</y><d>2017-12-16</d><h>09:05</h><w>ikitommi</w>Hi. Would it be a good idea to lift Interceptors out of Pedestal into a more common concept for Clojure? Like Ring, which defines just a spec that different libs could use - and produce Interceptors that can be used with other libs - like Ring. Currently, I know at least 5 different interceptor runners, inspired by Pedestal, but bit different. I don’t think this helps in the big pic. There are <code>:before</code> and <code>:after</code>s, <code>:in</code> &amp; <code>:out</code>s, different keys for errors, queues, stacks etc.</z><z id="t1513415319" t="ikitommi The interceptors are a separate module, but still it has deps to things like core.async , pedestal.log etc. which are opinions that not everyone agrees. Also, the keys are namespaced to Pedestal (`:io.pedestal.interceptor.chain/error` etc.)"><y>#</y><d>2017-12-16</d><h>09:08</h><w>ikitommi</w>The interceptors are a separate module, but still it has deps to things like <code>core.async</code>, <code>pedestal.log</code> etc. which are opinions that not everyone agrees. Also, the keys are namespaced to Pedestal (`:io.pedestal.interceptor.chain/error` etc.)</z><z id="t1513422734" t="souenzzo [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] checkout io.pedestal.interceptors.chain/execute"><y>#</y><d>2017-12-16</d><h>11:12</h><w>souenzzo</w><a>@ikitommi</a> checkout io.pedestal.interceptors.chain/execute</z><z id="t1513425689" t="ikitommi [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] thanks for the pointer! It nicely describes the how the interceptor should look like, but not the context. Context has things like ::queue , ::error and ::stack . Re-frame has :queue and :stack etc. Writing a portable interceptor that does error-handling requires to access the ::error ."><y>#</y><d>2017-12-16</d><h>12:01</h><w>ikitommi</w><a>@souenzzo</a> thanks for the pointer! It nicely describes the how the interceptor should look like, but not the context. Context has things like <code>::queue</code>, <code>::error</code> and <code>::stack</code>. Re-frame has <code>:queue</code> and <code>:stack</code> etc. Writing a portable interceptor that does error-handling requires to access the <code>::error</code>.</z><z id="t1513425963" t="souenzzo the also this issue https://github.com/pedestal/pedestal/issues/487"><y>#</y><d>2017-12-16</d><h>12:06</h><r>souenzzo</r>the also this issue
<a href="https://github.com/pedestal/pedestal/issues/487" target="_blank">https://github.com/pedestal/pedestal/issues/487</a></z><z id="t1513426047" t="ikitommi thanks!!"><y>#</y><d>2017-12-16</d><h>12:07</h><r>ikitommi</r>thanks!!</z><z id="t1513425792" t="ikitommi I think programming against a contract (like https://github.com/ring-clojure/ring/blob/master/SPEC ) instead of a helper api makes things more portable."><y>#</y><d>2017-12-16</d><h>12:03</h><w>ikitommi</w>I think programming against a contract (like <a href="https://github.com/ring-clojure/ring/blob/master/SPEC" target="_blank">https://github.com/ring-clojure/ring/blob/master/SPEC</a>) instead of a helper api makes things more portable.</z><z id="t1513425986" t="ikitommi My 2 cents would be to use non-qualified keys for the context (`:queue`, :stack , :error etc.) like Ring does. This also enables perf optimizations as the context could be a Record with fast access to that info. Re-reading via a hash-lookup makes the chain execution much slower."><y>#</y><d>2017-12-16</d><h>12:06</h><w>ikitommi</w>My 2 cents would be to use non-qualified keys for the context (`:queue`, <code>:stack</code>, <code>:error</code> etc.) like Ring does. This also enables perf optimizations as the context could be a Record with fast access to that info. Re-reading via a hash-lookup makes the chain execution much slower.</z><z id="t1513426217" t="souenzzo P.S.: I&apos;m using the ctx /`chain` concept in various/non-http context in my app."><y>#</y><d>2017-12-16</d><h>12:10</h><w>souenzzo</w>P.S.: I&apos;m using the <code>ctx</code>/`chain` concept in various/non-http context in my app.</z><z id="t1513426242" t="ikitommi cool. the pedestal chain or just the concept?"><y>#</y><d>2017-12-16</d><h>12:10</h><w>ikitommi</w>cool. the pedestal chain or just the concept?</z><z id="t1513426712" t="souenzzo one &quot;own&quot; chain, to interact with #datomic (when I implemented, I did not know that pedestal chain was easy to use), and a websocket chain, using chan/execute ."><y>#</y><d>2017-12-16</d><h>12:18</h><w>souenzzo</w>one &quot;own&quot; chain, to interact with #datomic (when I implemented, I did not know that pedestal chain was easy to use), and a websocket chain, using <code>chan/execute</code>.</z><z id="t1513622138" t="souenzzo There is some standard approach to instrumentation/spec validation on context?"><y>#</y><d>2017-12-18</d><h>18:35</h><w>souenzzo</w>There is some standard approach to instrumentation/spec validation on context?</z><z id="t1513625253" t="luskwater Question: I’m trying to lein uberjar a project created with lein new vase ... : I’ve changed the Datomic URL in the .edn definition to use a transactor running in another process. lein uberjar connects to Datomic and it never finishes the task. (Change the URL back to an in-memory DB, and it starts and then exits and generates an Uberjar.) Would anyone be able to help me generate the Uberjar?"><y>#</y><d>2017-12-18</d><h>19:27</h><w>luskwater</w>Question: I’m trying to <code>lein uberjar</code> a project created with <code>lein new vase ...</code>: I’ve changed the Datomic URL in the <code>.edn</code> definition to use a transactor running in another process.  <code>lein uberjar</code> connects to Datomic and it never finishes the task. (Change the URL back to an in-memory DB, and it starts and then exits and generates an Uberjar.)
Would anyone be able to help me generate the Uberjar?</z><z id="t1513626827" t="ikitommi [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] request &amp; response validation or context keys in general?"><y>#</y><d>2017-12-18</d><h>19:53</h><w>ikitommi</w><a>@souenzzo</a> request &amp; response validation or context keys in general?</z><z id="t1513627046" t="souenzzo when instrumentation is on, check/valid/exception keys based on a spec."><y>#</y><d>2017-12-18</d><h>19:57</h><r>souenzzo</r>when instrumentation is on, check/valid/exception keys based on a spec.</z><z id="t1515542446" t="hlship A question about"><y>#</y><d>2018-01-10</d><h>00:00</h><w>hlship</w>A question about</z><z id="t1515542601" t="hlship Pedestal routing. One of my handlers is not getting invoked. Here&apos;s (mapv #(take 2 %)) of my routes (a set, in table format): [(&quot;/assets/graphiql/*path&quot; :head) (&quot;/graphql&quot; :post) (&quot;/assets/graphiql/*path&quot; :get) (&quot;/graphql&quot; :get) (&quot;/&quot; :get)] But when I have a client GET /assets/graphiql/graphiql.css, I get a 404, as in, it&apos;s not matching."><y>#</y><d>2018-01-10</d><h>00:03</h><w>hlship</w>Pedestal routing.  One of my handlers is not getting invoked.  Here&apos;s (mapv #(take 2 %)) of my routes (a set, in table format):

<pre>[(&quot;/assets/graphiql/*path&quot; :head)
 (&quot;/graphql&quot; :post)
 (&quot;/assets/graphiql/*path&quot; :get)
 (&quot;/graphql&quot; :get)
 (&quot;/&quot; :get)]
</pre>

But when I have a client GET /assets/graphiql/graphiql.css, I get a 404, as in, it&apos;s not matching.</z><z id="t1515542623" t="hlship If I pprint out the expanded route: {:path &quot;/assets/graphiql/*path&quot;, :method :get, :path-constraints {:path &quot;(.*)&quot;}, :path-re #&quot;/\Qassets\E/\Qgraphiql\E/(.*)&quot;, :path-parts [&quot;assets&quot; &quot;graphiql&quot; :path], :interceptors [{:name nil, :enter #object[io.pedestal.interceptor$eval21530$fn__21531$fn__21532 0x277af0a3 &quot;io.pedestal.interceptor$eval21530$fn__21531$fn__21532@277af0a3&quot;], :leave nil, :error nil}], :route-name :com.walmartlabs.lacinia.pedestal/graphiql-get-assets, :path-params [:path]} (that&apos;s just the key entry)"><y>#</y><d>2018-01-10</d><h>00:03</h><w>hlship</w>If I pprint out the expanded route:

<pre>{:path &quot;/assets/graphiql/*path&quot;,
  :method :get,
  :path-constraints {:path &quot;(.*)&quot;},
  :path-re #&quot;/\Qassets\E/\Qgraphiql\E/(.*)&quot;,
  :path-parts [&quot;assets&quot; &quot;graphiql&quot; :path],
  :interceptors
  [{:name nil,
    :enter
    #object[io.pedestal.interceptor$eval21530$fn__21531$fn__21532 0x277af0a3 &quot;io.pedestal.interceptor$eval21530$fn__21531$fn__21532@277af0a3&quot;],
    :leave nil,
    :error nil}],
  :route-name :com.walmartlabs.lacinia.pedestal/graphiql-get-assets,
  :path-params [:path]}
</pre>

(that&apos;s just the key entry)</z><z id="t1515542725" t="hlship All my other routes work fine."><y>#</y><d>2018-01-10</d><h>00:05</h><w>hlship</w>All my other routes work fine.</z><z id="t1515542918" t="hlship Ok, I don&apos;t think this is a Pedestal problem. I think some part of my app is overriding the route hash I generate."><y>#</y><d>2018-01-10</d><h>00:08</h><w>hlship</w>Ok, I don&apos;t think this is a Pedestal problem.  I think some part of my app is overriding the route hash I generate.</z><z id="t1515543321" t="hlship It was two different things in my application; Pedestal is working fine, of course."><y>#</y><d>2018-01-10</d><h>00:15</h><w>hlship</w>It was two different things in my application; Pedestal is working fine, of course.</z><z id="t1515635018" t="caleb.macdonaldblack http://pedestal.io/reference/servlet-interceptor Says this: Before invoking the :enter functions, the servlet interceptor sets up a “terminator” predicate on the context. It terminates the interceptor chain when the context map returned by an interceptor has a response map attached. My server has this: (ns wp-server.server (:gen-class) ; for -main method in uberjar (:require [io.pedestal.http :as server] [io.pedestal.http.route :as route] [wp-server.service :as service] [wp-server.datomic :as datomic])) (defonce runnable-service (atom nil)) (defn -main &quot;The entry-point for &apos;lein run&apos;&quot; [&amp; args] (println &quot;/nConnecting to datomic...&quot;) (datomic/connect!) (println &quot;\nCreating your server...&quot;) (reset! runnable-service (server/create-servlet service/service)) (server/start runnable-service)) (defn create-runnable-dev-service &quot;The entry-point for &apos;lein run-dev&apos;&quot; [&amp; args] (println &quot;\nConnecting to [DEV] database...&quot;) (datomic/connect-dev!) (println &quot;\nCreating your [DEV] server...&quot;) (-&gt; service/service (merge {:env :dev ::server/join? false ::server/routes #(route/expand-routes (deref #&apos;service/routes)) ::server/allowed-origins {:creds true :allowed-origins (constantly true)} ::server/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}}}) server/default-interceptors server/dev-interceptors server/create-servlet)) My service looks like this: (ns wp-server.service (:require [datomic.api :as d] [io.pedestal.http :as http] [io.pedestal.http.body-params :as body-params] [io.pedestal.http.route :as route] [ring.util.response :as ring-resp] [wp-server.datomic :as datomic] [wp-common.client :as wp-common-client] [wp-common.core :as wp-common-core] [clojure.spec.alpha :as s] [ring.util.response :as ring-response])) (def home-page {:name :home-page :enter (fn [context] (prn &quot;TWO&quot;) (assoc context :response {:status 200 :body &quot;Hello, world!&quot;}))}) (def common-interceptors [datomic/db-interceptor (body-params/body-params) http/html-body]) (defn create-spec-validator [spec] {:name :validate-spec :enter (fn [{{:keys [:edn-params]} :request :as context}] (prn &quot;ONE&quot;) (if-let [explained (s/explain-data spec edn-params)] (assoc context :response {:status 400 :body explained})))}) (def routes #{ ;[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/clients&quot; :post (conj common-interceptors (create-spec-validator ::wp-common-client/schema) home-page)] [&quot;/db-test&quot; :get (conj common-interceptors `db-test-page)] [&quot;/about&quot; :get (conj common-interceptors `about-page)]}) (def service {:env :prod ::http/routes routes ::http/type :jetty ::http/port 5000 ::http/container-options {:h2c? true :h2? false :ssl? false}}) When sending a request to localhost:5000/clients with a body that does not pass spec, the create-spec-validator interceptor adds a response to the context. I have confirmed this by logging the context in the home-page interceptor. I would expect the home-page interceptor to be skipped as per documentation. This does not happen. Instead the :enter function of the home-page interceptor is called and the response overwritten. Why isn’t the home-page interceptor being skipped when the create-spec-validator prior to it is returning context with a response?"><y>#</y><d>2018-01-11</d><h>01:43</h><w>caleb.macdonaldblack</w><a href="http://pedestal.io/reference/servlet-interceptor" target="_blank">http://pedestal.io/reference/servlet-interceptor</a> Says this:
Before invoking the :enter functions, the servlet interceptor sets up a “terminator” predicate on the context. It terminates the interceptor chain when the context map returned by an interceptor has a response map attached.

My server has this:
<pre>(ns wp-server.server
  (:gen-class)                                              ; for -main method in uberjar
  (:require
    [io.pedestal.http :as server]
    [io.pedestal.http.route :as route]
    [wp-server.service :as service]
    [wp-server.datomic :as datomic]))

(defonce runnable-service (atom nil))

(defn -main
  &quot;The entry-point for &apos;lein run&apos;&quot;
  [&amp; args]
  (println &quot;/nConnecting to datomic...&quot;)
  (datomic/connect!)
  (println &quot;\nCreating your server...&quot;)
  (reset! runnable-service (server/create-servlet service/service))
  (server/start runnable-service))

(defn create-runnable-dev-service
  &quot;The entry-point for &apos;lein run-dev&apos;&quot;
  [&amp; args]
  (println &quot;\nConnecting to [DEV] database...&quot;)
  (datomic/connect-dev!)
  (println &quot;\nCreating your [DEV] server...&quot;)
  (-&gt; service/service
      (merge {:env                     :dev
              ::server/join?           false
              ::server/routes          #(route/expand-routes (deref #&apos;service/routes))
              ::server/allowed-origins {:creds true :allowed-origins (constantly true)}
              ::server/secure-headers  {:content-security-policy-settings {:object-src &quot;none&quot;}}})
      server/default-interceptors
      server/dev-interceptors
      server/create-servlet))
</pre>

My service looks like this:

<pre>(ns wp-server.service
  (:require
    [datomic.api :as d]
    [io.pedestal.http :as http]
    [io.pedestal.http.body-params :as body-params]
    [io.pedestal.http.route :as route]
    [ring.util.response :as ring-resp]
    [wp-server.datomic :as datomic]
    [wp-common.client :as wp-common-client]
    [wp-common.core :as wp-common-core]
    [clojure.spec.alpha :as s]
    [ring.util.response :as ring-response]))

(def home-page
  {:name  :home-page
   :enter (fn [context]
            (prn &quot;TWO&quot;)
            (assoc context :response {:status 200 :body &quot;Hello, world!&quot;}))})

(def common-interceptors [datomic/db-interceptor (body-params/body-params) http/html-body])

(defn create-spec-validator
  [spec]
  {:name :validate-spec
   :enter
         (fn [{{:keys [:edn-params]} :request :as context}]
           (prn &quot;ONE&quot;)
           (if-let [explained (s/explain-data spec edn-params)]
             (assoc context
               :response {:status 400 :body explained})))})


(def routes #{
              ;[&quot;/&quot; :get (conj common-interceptors `home-page)]
              [&quot;/clients&quot; :post (conj common-interceptors (create-spec-validator ::wp-common-client/schema) home-page)]
              [&quot;/db-test&quot; :get (conj common-interceptors `db-test-page)]
              [&quot;/about&quot; :get (conj common-interceptors `about-page)]})

(def service {:env                     :prod
              ::http/routes            routes
              ::http/type              :jetty
              ::http/port              5000
              ::http/container-options {:h2c? true
                                        :h2?  false
                                        :ssl? false}})
</pre>
                                        
When sending a request to localhost:5000/clients with a body that does not pass spec, the create-spec-validator interceptor adds a response to the context. I have confirmed this by logging the context in the home-page interceptor. I would expect the home-page interceptor to be skipped as per documentation. This does not happen. Instead the :enter function of the home-page interceptor is called and the response overwritten.

Why isn’t the home-page interceptor being skipped when the create-spec-validator prior to it is returning context with a response?</z><z id="t1515636756" t="caleb.macdonaldblack the SO post for this is https://stackoverflow.com/questions/48198671/pedestal-early-termination-is-not-working"><y>#</y><d>2018-01-11</d><h>02:12</h><w>caleb.macdonaldblack</w>the SO post for this is <a href="https://stackoverflow.com/questions/48198671/pedestal-early-termination-is-not-working" target="_blank">https://stackoverflow.com/questions/48198671/pedestal-early-termination-is-not-working</a></z><z id="t1515637684" t="caleb.macdonaldblack I need to use io.pedestal.interceptor.chain/terminate. We believe those docs are out of data"><y>#</y><d>2018-01-11</d><h>02:28</h><w>caleb.macdonaldblack</w>I need to use io.pedestal.interceptor.chain/terminate. We believe those docs are out of data</z><z id="t1515637938" t="luskwater [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] Might not be an issue here, but your :validate-spec interceptor does not return the context on a successful validation. If you return nil , does Pedestal assume the unmodified context?"><y>#</y><d>2018-01-11</d><h>02:32</h><w>luskwater</w><a>@caleb.macdonaldblack</a> Might not be an issue here, but your <code>:validate-spec</code> interceptor does not return the <code>context</code> on a successful validation. If you return <code>nil</code>, does Pedestal assume the unmodified context?</z><z id="t1515638716" t="luskwater [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] Here you go: the :response has to be a valid response according to ring.util.response/response? , so it needs to be a map with :status and :headers : (defn response? &quot;True if the supplied value is a valid response map.&quot; {:added &quot;1.1&quot;} [resp] (and (map? resp) (integer? (:status resp)) (map? (:headers resp))))"><y>#</y><d>2018-01-11</d><h>02:45</h><w>luskwater</w><a>@caleb.macdonaldblack</a> Here you go: the <code>:response</code> has to be a valid response according to <code>ring.util.response/response?</code>, so it needs to be a map with <code>:status</code> and <code>:headers</code>: <pre>(defn response?
  &quot;True if the supplied value is a valid response map.&quot;
  {:added &quot;1.1&quot;}
  [resp]
  (and (map? resp)
       (integer? (:status resp))
       (map? (:headers resp))))</pre></z><z id="t1515776936" t="hlship I&apos;ve gotten tripped up before by omitting the :headers key. It&apos;s easy to miss if you don&apos;t start with ring.util.response/response."><y>#</y><d>2018-01-12</d><h>17:08</h><w>hlship</w>I&apos;ve gotten tripped up before by omitting the :headers key.  It&apos;s easy to miss if you don&apos;t start with ring.util.response/response.</z><z id="t1516881788" t="nblumoe Is there a way to add interceptors to the websocket route with an implementation like https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj ?"><y>#</y><d>2018-01-25</d><h>12:03</h><w>nblumoe</w>Is there a way to add interceptors to the websocket route with an implementation like <a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj</a> ?</z><z id="t1516885985" t="souenzzo [:attrs {:href &quot;/_/_/users/U066HBF6J&quot;}] it&apos;s very easy to use io.pedestal.interceptor.chain/execute for ANY propose. just (let [initial-ctx {....}] (chain/execute initial-ctx [inter1 inter2]))"><y>#</y><d>2018-01-25</d><h>13:13</h><w>souenzzo</w><a>@nblumoe</a> it&apos;s very easy to use <code>io.pedestal.interceptor.chain/execute</code> for ANY propose.
just <code>(let [initial-ctx {....}] (chain/execute initial-ctx [inter1 inter2]))</code></z><z id="t1516887278" t="nblumoe Hm, right. I guess I actually rather have the problem of getting the correct context there. 😄"><y>#</y><d>2018-01-25</d><h>13:34</h><r>nblumoe</r>Hm, right. I guess I actually rather have the problem of getting the correct context there. <b>😄</b></z><z id="t1516887692" t="nblumoe I would like to use an interceptor-chain which has access to my system map (using integrant). But when ws-path is defined, the system hasn’t been initialized yet."><y>#</y><d>2018-01-25</d><h>13:41</h><r>nblumoe</r>I would like to use an interceptor-chain which has access to my <code>system</code> map (using integrant). But when <code>ws-path</code> is defined, the system hasn’t been initialized yet.</z><z id="t1518561058" t="hlship I&apos;m trying to do something pretty tricky with pedestal routers and interceptors. Essentially, part of my application is routed based on stateful data that can change at any time."><y>#</y><d>2018-02-13</d><h>22:30</h><w>hlship</w>I&apos;m trying to do something pretty tricky with pedestal routers and interceptors.  Essentially, part of my application is routed based on stateful data that can change at any time.</z><z id="t1518561103" t="hlship So I have a traditional (static) router, then an interceptor that builds (as needed) another router and adds it via io.pedestal.interceptor.chain/enqueue"><y>#</y><d>2018-02-13</d><h>22:31</h><w>hlship</w>So I have a traditional (static) router, then an interceptor that builds (as needed) another router and adds it via io.pedestal.interceptor.chain/enqueue</z><z id="t1518561151" t="hlship But I&apos;m seeing that execution doesn&apos;t match my expectations."><y>#</y><d>2018-02-13</d><h>22:32</h><w>hlship</w>But I&apos;m seeing that execution doesn&apos;t match my expectations.</z><z id="t1518561247" t="hlship What I see is execution of the router, then execution of my interceptor, then execution of interceptors in a route matched by the router."><y>#</y><d>2018-02-13</d><h>22:34</h><w>hlship</w>What I see is execution of the router, then execution of my interceptor, then execution of interceptors in a route matched by the router.</z><z id="t1518561371" t="hlship That&apos;s a lot to process;"><y>#</y><d>2018-02-13</d><h>22:36</h><w>hlship</w>That&apos;s a lot to process;</z><z id="t1518561391" t="hlship BUT line 7 shows the router :enter step"><y>#</y><d>2018-02-13</d><h>22:36</h><w>hlship</w>BUT line 7 shows the router :enter step</z><z id="t1518561422" t="hlship And that&apos;s where I&apos;d expect the router to match paths and choose a route, and add that route&apos;s interceptors/handler to the execution chain."><y>#</y><d>2018-02-13</d><h>22:37</h><w>hlship</w>And that&apos;s where I&apos;d expect the router to match paths and choose a route, and add that route&apos;s interceptors/handler to the execution chain.</z><z id="t1518561490" t="hlship And those interceptors will put a :response into the context, which should trigger an unwind through the :leave events of all the interceptors so far."><y>#</y><d>2018-02-13</d><h>22:38</h><w>hlship</w>And those interceptors will put a :response into the context, which should trigger an unwind through the :leave events of all the interceptors so far.</z><z id="t1518561530" t="hlship But then on line 9, we see app-router enter stage, which to mind mind shouldn&apos;t take place."><y>#</y><d>2018-02-13</d><h>22:38</h><w>hlship</w>But then on line 9, we see app-router enter stage, which to mind mind shouldn&apos;t take place.</z><z id="t1518561561" t="hlship Then on line 11 we start to see the interceptors chosen by the router start to execute."><y>#</y><d>2018-02-13</d><h>22:39</h><w>hlship</w>Then on line 11 we start to see the interceptors chosen by the router start to execute.</z><z id="t1518561772" t="hlship ... and now I&apos;m reading the code for chain and answering some of my own questions."><y>#</y><d>2018-02-13</d><h>22:42</h><w>hlship</w>... and now I&apos;m reading the code for <code>chain</code> and answering some of my own questions.</z><z id="t1518562110" t="hlship So I think what happens is that the router and the app-dispatcher are enqueued initially. The router executes, matches a route, and adds its interceptors to the execution chain after the other app-dispatcher interceptor. app-dispatcher executes it&apos;s :enter stage, but does nothing THEN the route interceptors hits their :enter stage."><y>#</y><d>2018-02-13</d><h>22:48</h><w>hlship</w>So I think what happens is that the router and the app-dispatcher are enqueued initially.  The router executes, matches a route, and adds its interceptors to the execution chain after the other app-dispatcher interceptor.  app-dispatcher executes it&apos;s :enter stage, but does nothing THEN the route interceptors hits their :enter stage.</z><z id="t1518562140" t="hlship So I think I can get what I want by moving some logic in app-dispatcher to a :leave step instead, and only if there&apos;s no :request already."><y>#</y><d>2018-02-13</d><h>22:49</h><w>hlship</w>So I think I can get what I want by moving some logic in app-dispatcher to a :leave step instead, and only if there&apos;s no :request already.</z><z id="t1518562420" t="hlship Ah, I think I can stay in the :enter phase, but check to see if there&apos;s already a matched route."><y>#</y><d>2018-02-13</d><h>22:53</h><w>hlship</w>Ah, I think I can stay in the :enter phase, but check to see if there&apos;s already a matched route.</z><z id="t1518563540" t="hlship Yep, that&apos;s working nicely."><y>#</y><d>2018-02-13</d><h>23:12</h><w>hlship</w>Yep, that&apos;s working nicely.</z><z id="t1518576881" t="chris_johnson Now I really wish I wasn’t Slackin’ on iOS where it is a giant pain to copy a wall of text off and DM it to myself."><y>#</y><d>2018-02-14</d><h>02:54</h><w>chris_johnson</w>Now I really wish I wasn’t Slackin’ on iOS where it is a giant pain to copy a wall of text off and DM it to myself.</z><z id="t1518576950" t="chris_johnson I might never need that capability, but if I ever do I’m going to remember reading this whole tale start to finish and not remember the magic bit at the end."><y>#</y><d>2018-02-14</d><h>02:55</h><w>chris_johnson</w>I might never need that capability, but if I ever do I’m going to remember reading this whole tale start to finish and not remember the magic bit at the end.</z><z id="t1518630044" t="hlship Slack is the ultimate rubber duck 🦆"><y>#</y><d>2018-02-14</d><h>17:40</h><r>hlship</r>Slack is the ultimate rubber duck <b>🦆</b></z><z id="t1518620403" t="logistark Hi all, is Pedestal still under development?"><y>#</y><d>2018-02-14</d><h>15:00</h><w>logistark</w>Hi all, is Pedestal still under development?</z><z id="t1518630071" t="hlship Any notes on the site generation tools for Pedestal? I just contributed a trivial documentation PR but am in a mood to write some more."><y>#</y><d>2018-02-14</d><h>17:41</h><w>hlship</w>Any notes on the site generation tools for Pedestal? I just contributed a trivial documentation PR but am in a mood to write some more.</z><z id="t1518630556" t="hlship Ugh. Turns out I was contributing docs to the wrong repo."><y>#</y><d>2018-02-14</d><h>17:49</h><w>hlship</w>Ugh.  Turns out I was contributing docs to the wrong repo.</z><z id="t1518634543" t="hlship https://github.com/pedestal/pedestal-docs/pull/101"><y>#</y><d>2018-02-14</d><h>18:55</h><w>hlship</w><a href="https://github.com/pedestal/pedestal-docs/pull/101" target="_blank">https://github.com/pedestal/pedestal-docs/pull/101</a></z><z id="t1518802406" t="chris_johnson [:attrs {:href &quot;/_/_/users/U0ARQ14BA&quot;}] I believe (constantly true) will do what you want there"><y>#</y><d>2018-02-16</d><h>17:33</h><w>chris_johnson</w><a>@nooga</a> I believe <code>(constantly true)</code> will do what you want there</z><z id="t1518802448" t="nooga I&apos;ll try that! Thanks!"><y>#</y><d>2018-02-16</d><h>17:34</h><w>nooga</w>I&apos;ll try that! Thanks!</z><z id="t1518905604" t="nooga [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] but then I need to add the header manually right?"><y>#</y><d>2018-02-17</d><h>22:13</h><w>nooga</w><a>@chris_johnson</a> but then I need to add the header manually right?</z><z id="t1518905646" t="chris_johnson Hm, I might be thinking of the wrong key, hang on a second"><y>#</y><d>2018-02-17</d><h>22:14</h><w>chris_johnson</w>Hm, I might be thinking of the wrong key, hang on a second</z><z id="t1518905728" t="chris_johnson Are you sure you’re looking at ::http/allow-origins and not ::http/allowed-origins ?"><y>#</y><d>2018-02-17</d><h>22:15</h><w>chris_johnson</w>Are you sure you’re looking at <code>::http/allow-origins</code> and not <code>::http/allowed-origins</code>?</z><z id="t1518905773" t="chris_johnson Here’s a service map from a very simple Pedestal server (actually just the Pedestal endpoint shim from a Vase project) that illustrates the idea I’m thinking of:"><y>#</y><d>2018-02-17</d><h>22:16</h><w>chris_johnson</w>Here’s a service map from a very simple Pedestal server (actually just the Pedestal endpoint shim from a Vase project) that illustrates the idea I’m thinking of:</z><z id="t1518905776" t="chris_johnson (defn service-map &quot;Returns initial service map for the Pedestal server.&quot; [] {::http/type :jetty ::http/port 8080 ::http/join? false ::http/allowed-origins (constantly true)}) "><y>#</y><d>2018-02-17</d><h>22:16</h><w>chris_johnson</w><pre>(defn service-map
  &quot;Returns initial service map for the Pedestal server.&quot;
  []
  {::http/type   :jetty
   ::http/port   8080
   ::http/join?  false
   ::http/allowed-origins (constantly true)})
</pre></z><z id="t1518905861" t="chris_johnson ^^ that service allows any CORS origin and the server sends the appropriate headers to all callers, at least as far as it’s been tested"><y>#</y><d>2018-02-17</d><h>22:17</h><w>chris_johnson</w>^^ that service allows any CORS origin and the server sends the appropriate headers to all callers, at least as far as it’s been tested</z><z id="t1518905974" t="nooga of course I meant ::http/allowed-origins"><y>#</y><d>2018-02-17</d><h>22:19</h><w>nooga</w>of course I meant <code>::http/allowed-origins</code></z><z id="t1518906132" t="nooga how does it know to set the headers based on that (constantly true) ?"><y>#</y><d>2018-02-17</d><h>22:22</h><w>nooga</w>how does it know to set the headers based on that <code>(constantly true)</code>?</z><z id="t1518907103" t="chris_johnson If you look at cors.clj : https://github.com/pedestal/pedestal/blob/7d3895d0ed06f47555644ed560a49b1ab311d7ab/service/src/io/pedestal/http/cors.clj#L48"><y>#</y><d>2018-02-17</d><h>22:38</h><w>chris_johnson</w>If you look at <code>cors.clj</code> : <a href="https://github.com/pedestal/pedestal/blob/7d3895d0ed06f47555644ed560a49b1ab311d7ab/service/src/io/pedestal/http/cors.clj#L48" target="_blank">https://github.com/pedestal/pedestal/blob/7d3895d0ed06f47555644ed560a49b1ab311d7ab/service/src/io/pedestal/http/cors.clj#L48</a></z><z id="t1518907203" t="chris_johnson What happens is the value of allowed-origins gets passed through normalize-args , which if you pass it a sequence of strings, creates you a fn that checks for membership in that sequence: (fn [origin] (some #(= % origin) (seq arg))))"><y>#</y><d>2018-02-17</d><h>22:40</h><w>chris_johnson</w>What happens is the value of <code>allowed-origins</code> gets passed through <code>normalize-args</code>, which if you pass it a sequence of strings, creates you a <code>fn</code> that checks for membership in that sequence: <code>(fn [origin] (some #(= % origin) (seq arg))))</code></z><z id="t1518907251" t="chris_johnson but if you pass it instead a fn , that fn gets called with the origin in question and the truthiness of its return value determines whether the origin is allowed"><y>#</y><d>2018-02-17</d><h>22:40</h><w>chris_johnson</w>but if you pass it instead a <code>fn</code>, that <code>fn</code> gets called with the origin in question and the truthiness of its return value determines whether the origin is allowed</z><z id="t1518907281" t="chris_johnson so (constantly true) means “I don’t even care anymore, anyone can come in, fine” (or more charitably, “this is a dev server, let’s worry about security later”) 😄"><y>#</y><d>2018-02-17</d><h>22:41</h><w>chris_johnson</w>so <code>(constantly true)</code> means “I don’t even care anymore, anyone can come in, fine” (or more charitably, “this is a dev server, let’s worry about security later”) <b>😄</b></z><z id="t1518907348" t="chris_johnson You could also, I imagine, take advantage of this to have your CORS header check do something dynamic, if you were willing to eat the overhead of a dynamic call of some kind for every network request"><y>#</y><d>2018-02-17</d><h>22:42</h><w>chris_johnson</w>You could also, I imagine, take advantage of this to have your CORS header check do something dynamic, if you were willing to eat the overhead of a dynamic call of some kind for every network request</z><z id="t1518907455" t="nooga ah, I see"><y>#</y><d>2018-02-17</d><h>22:44</h><w>nooga</w>ah, I see</z><z id="t1518907457" t="nooga awesome"><y>#</y><d>2018-02-17</d><h>22:44</h><w>nooga</w>awesome</z><z id="t1518907458" t="nooga !"><y>#</y><d>2018-02-17</d><h>22:44</h><w>nooga</w>!</z><z id="t1519156914" t="nooga how can I get request body as a string in pedestal?"><y>#</y><d>2018-02-20</d><h>20:01</h><w>nooga</w>how can I get request body as a string in pedestal?</z><z id="t1519156921" t="nooga I see body-params"><y>#</y><d>2018-02-20</d><h>20:02</h><w>nooga</w>I see body-params</z><z id="t1519156941" t="nooga but there’s no text “parser” there"><y>#</y><d>2018-02-20</d><h>20:02</h><w>nooga</w>but there’s no text “parser” there</z><z id="t1519159835" t="nooga lol, nevermind, it’s slurp"><y>#</y><d>2018-02-20</d><h>20:50</h><w>nooga</w>lol, nevermind, it’s <code>slurp</code></z><z id="t1519169828" t="dadair Does anyone know of any resources for handling websocket-sessions in pedestal? I’ve followed the jetty-websockets sample, but it does not cover tying websocket handlers (`:on-text`, :on-close , etc) to a particular session (only :on-connect ). For instance, how to identify the client that caused :on-close to fire due to an idleTimeout (to allow for session cleanup, etc)?"><y>#</y><d>2018-02-20</d><h>23:37</h><w>dadair</w>Does anyone know of any resources for handling websocket-sessions in pedestal? I’ve followed the jetty-websockets sample, but it does not cover tying websocket handlers (`:on-text`, <code>:on-close</code>, etc) to a particular session (only <code>:on-connect</code>). For instance, how to identify the client that caused <code>:on-close</code> to fire due to an <code>idleTimeout</code> (to allow for session cleanup, etc)?</z><z id="t1519170055" t="dadair I’ve found https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/6ga8vcTiAgAJ , but not sure how one would go about implementing a custom listener to track the session"><y>#</y><d>2018-02-20</d><h>23:40</h><w>dadair</w>I’ve found <a href="https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/6ga8vcTiAgAJ" target="_blank">https://groups.google.com/forum/#!searchin/pedestal-users/websocket%7Csort:date/pedestal-users/IOc-WKkTFLM/6ga8vcTiAgAJ</a>, but not sure how one would go about implementing a custom listener to track the session</z><z id="t1519173585" t="souenzzo Lacinia-pedestal do websocket, with code reuse with pedestal interceptors. "><y>#</y><d>2018-02-21</d><h>00:39</h><w>souenzzo</w>Lacinia-pedestal do websocket, with code reuse with pedestal interceptors. </z><z id="t1519175210" t="dadair thanks! taking a look at that now"><y>#</y><d>2018-02-21</d><h>01:06</h><r>dadair</r>thanks! taking a look at that now</z><z id="t1519241300" t="hlship It seems like the Pedestal implementation is built around a somewhat specific use case, but it was reasonable to work around it."><y>#</y><d>2018-02-21</d><h>19:28</h><r>hlship</r>It seems like the Pedestal implementation is built around a somewhat specific use case, but it was reasonable to work around it.</z><z id="t1519241399" t="hlship I&apos;ve been embracing io.pedestal.log for a new project and really like the idea of logging as pure data ... there&apos;s a freedom that comes from not thinking in terms of user-readable messages, but instead, machine-interpretable events. Anyway, one thing I find missing in io.pedestal.log is support for a MDC (message diagnostic context)."><y>#</y><d>2018-02-21</d><h>19:29</h><w>hlship</w>I&apos;ve been embracing io.pedestal.log for a new project and really like the idea of logging as pure data ... there&apos;s a freedom that comes from not thinking in terms of user-readable messages, but instead, machine-interpretable events.  Anyway, one thing I find missing in io.pedestal.log is support for a MDC (message diagnostic context).</z><z id="t1519329752" t="mitchelkuijpers Have you tried Cambium for this? We use this exactly for data based logging"><y>#</y><d>2018-02-22</d><h>20:02</h><r>mitchelkuijpers</r>Have you tried Cambium for this? We use this exactly for data based logging</z><z id="t1519241425" t="hlship I would love to see a dynamic var containing a map of event keys/values that would be merged with those supplied by the call to log/debug and friends."><y>#</y><d>2018-02-21</d><h>19:30</h><w>hlship</w>I would love to see a dynamic var containing a map of event keys/values that would be merged with those supplied by the call to log/debug and friends.</z><z id="t1519241482" t="hlship Use case is primarily a request correlation id; I would like to set a rid at request inception and be able to see what rid across all logged events (many of which are asynchronous)."><y>#</y><d>2018-02-21</d><h>19:31</h><w>hlship</w>Use case is primarily a request correlation id; I would like to set a rid at request inception and be able to see what rid across all logged events (many of which are asynchronous).</z><z id="t1519241512" t="hlship I have cycles to put together a PR, but would love to hear from the gate keepers first."><y>#</y><d>2018-02-21</d><h>19:31</h><w>hlship</w>I have cycles to put together a PR, but would love to hear from the gate keepers first.</z><z id="t1519241637" t="hlship Also, even a simple map may not be perfect, in some ways I&apos;d prefer a delegate function that could be passed the event map and could return a modified event map prior to pr-str and passing it off to SLF4J."><y>#</y><d>2018-02-21</d><h>19:33</h><w>hlship</w>Also, even a simple map may not be perfect, in some ways I&apos;d prefer a delegate function that could be passed the event map and could return a modified event map prior to <code>pr-str</code> and passing it off to SLF4J.</z><z id="t1519241726" t="hlship In the past, I&apos;ve tried to hack this kind of thing using Logback&apos;s MDC support, but it ends up being a battle of the thread-locals (Clojure dynamic bindings vs. Java thread locals used to store the MDC)."><y>#</y><d>2018-02-21</d><h>19:35</h><w>hlship</w>In the past, I&apos;ve tried to hack this kind of thing using Logback&apos;s MDC support, but it ends up being a battle of the thread-locals (Clojure dynamic bindings vs. Java thread locals used to store the MDC).</z><z id="t1519321973" t="polymeris Hi"><y>#</y><d>2018-02-22</d><h>17:52</h><w>polymeris</w>Hi</z><z id="t1519321988" t="polymeris How did you get started with Pedestal?"><y>#</y><d>2018-02-22</d><h>17:53</h><w>polymeris</w>How did you get started with Pedestal?</z><z id="t1519321996" t="polymeris Documentation seems kind of poor http://pedestal.io/guides/crash-course"><y>#</y><d>2018-02-22</d><h>17:53</h><w>polymeris</w>Documentation seems kind of poor <a href="http://pedestal.io/guides/crash-course" target="_blank">http://pedestal.io/guides/crash-course</a></z><z id="t1519322051" t="polymeris I see the Microservices with Clojure has one chapter about pedestal, but it seems overkill to buy the book just for that"><y>#</y><d>2018-02-22</d><h>17:54</h><w>polymeris</w>I see the Microservices with Clojure has one chapter about pedestal, but it seems overkill to buy the book just for that</z><z id="t1519322729" t="dadair [:attrs {:href &quot;/_/_/users/U0FTV149X&quot;}] the guides/samples have been my go-to as I learn pedestal http://pedestal.io/guides/your-first-api http://pedestal.io/samples/index . I agree that the placeholder guides are annoying to run into, but I hope to be able to contribute back by writing some as I learn more"><y>#</y><d>2018-02-22</d><h>18:05</h><w>dadair</w><a>@polymeris</a> the guides/samples have been my go-to as I learn pedestal <a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a> <a href="http://pedestal.io/samples/index" target="_blank">http://pedestal.io/samples/index</a>. I agree that the placeholder guides are annoying to run into, but I hope to be able to contribute back by writing some as I learn more</z><z id="t1519322770" t="dadair I looked into the Microservices with Clojure book, and it seems to use almost identical text/examples as the pedestal guides, so I don’t think it’s worth it (although that is just my opinion from skimming the preview of it)"><y>#</y><d>2018-02-22</d><h>18:06</h><w>dadair</w>I looked into the Microservices with Clojure book, and it seems to use almost identical text/examples as the pedestal guides, so I don’t think it’s worth it (although that is just my opinion from skimming the preview of it)</z><z id="t1519322818" t="dadair Videos like this https://www.youtube.com/watch?v=_Cf-STRvFy8 (at least the first half) and https://www.youtube.com/watch?v=9L5NrCciSDU have been helpful for understanding the core concepts"><y>#</y><d>2018-02-22</d><h>18:06</h><w>dadair</w>Videos like this <a href="https://www.youtube.com/watch?v=_Cf-STRvFy8" target="_blank">https://www.youtube.com/watch?v=_Cf-STRvFy8</a> (at least the first half) and <a href="https://www.youtube.com/watch?v=9L5NrCciSDU" target="_blank">https://www.youtube.com/watch?v=9L5NrCciSDU</a> have been helpful for understanding the core concepts</z><z id="t1519323005" t="polymeris Thanks! That &quot;First API&quot; guide looks useful, except it seems to be missing an explanation of core concepts. I&apos;ll try the videos first"><y>#</y><d>2018-02-22</d><h>18:10</h><w>polymeris</w>Thanks! That &quot;First API&quot; guide looks useful, except it seems to be missing an explanation of core concepts. I&apos;ll try the videos first</z><z id="t1519323412" t="dadair Core concepts are here http://pedestal.io/reference/index"><y>#</y><d>2018-02-22</d><h>18:16</h><w>dadair</w>Core concepts are here <a href="http://pedestal.io/reference/index" target="_blank">http://pedestal.io/reference/index</a></z><z id="t1519323466" t="dadair Particularly, http://pedestal.io/reference/interceptors http://pedestal.io/reference/architecture-overview http://pedestal.io/reference/chain-providers http://pedestal.io/reference/error-handling"><y>#</y><d>2018-02-22</d><h>18:17</h><w>dadair</w>Particularly, <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a> <a href="http://pedestal.io/reference/architecture-overview" target="_blank">http://pedestal.io/reference/architecture-overview</a> <a href="http://pedestal.io/reference/chain-providers" target="_blank">http://pedestal.io/reference/chain-providers</a> <a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a></z><z id="t1519323486" t="dadair http://pedestal.io/reference/context-map"><y>#</y><d>2018-02-22</d><h>18:18</h><w>dadair</w><a href="http://pedestal.io/reference/context-map" target="_blank">http://pedestal.io/reference/context-map</a></z><z id="t1519323575" t="polymeris oh, great"><y>#</y><d>2018-02-22</d><h>18:19</h><w>polymeris</w>oh, great</z><z id="t1519323597" t="polymeris Yes, that&apos;s exactly what I need to get started"><y>#</y><d>2018-02-22</d><h>18:19</h><w>polymeris</w>Yes, that&apos;s exactly what I need to get started</z><z id="t1519323600" t="polymeris Thanks a lot"><y>#</y><d>2018-02-22</d><h>18:20</h><w>polymeris</w>Thanks a lot</z><z id="t1519842780" t="souenzzo Can I get from context map the name of the &quot;actual&quot; interceptor?"><y>#</y><d>2018-02-28</d><h>18:33</h><w>souenzzo</w>Can I get from <code>context</code> map the name of the &quot;actual&quot; interceptor?</z><z id="t1519844127" t="andrzejsliwa any idea how to override logback in tests?"><y>#</y><d>2018-02-28</d><h>18:55</h><w>andrzejsliwa</w>any idea how to override logback in tests?</z><z id="t1519864250" t="hlship If logback finds a logback-test.xml on the classpath, it uses that instead of logback.xml . So put a copy in dev-resources . I start with this: &lt;configuration scan=&quot;true&quot; scanPeriod=&quot;1 seconds&quot;&gt; &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;%-5level %logger - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;root level=&quot;warn&quot;&gt; &lt;appender-ref ref=&quot;STDOUT&quot;/&gt; &lt;/root&gt; &lt;/configuration&gt; "><y>#</y><d>2018-03-01</d><h>00:30</h><r>hlship</r>If logback finds a <code>logback-test.xml</code> on the classpath, it uses that instead of <code>logback.xml</code>.  So put a copy in <code>dev-resources</code>.

I start with this:

<pre>&lt;configuration scan=&quot;true&quot; scanPeriod=&quot;1 seconds&quot;&gt;

    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%-5level %logger - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;root level=&quot;warn&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
    &lt;/root&gt;

&lt;/configuration&gt;
</pre></z><z id="t1520000996" t="andrzejsliwa Thx!"><y>#</y><d>2018-03-02</d><h>14:29</h><r>andrzejsliwa</r>Thx!</z><z id="t1519844628" t="andrzejsliwa ok I found it"><y>#</y><d>2018-02-28</d><h>19:03</h><w>andrzejsliwa</w>ok I found it</z><z id="t1519844651" t="andrzejsliwa {:profiles {:test {:jvm-opts [&quot;-Dlogback.configurationFile=test-logback.xml&quot;]}} just switched to different config"><y>#</y><d>2018-02-28</d><h>19:04</h><w>andrzejsliwa</w>{:profiles {:test {:jvm-opts [&quot;-Dlogback.configurationFile=test-logback.xml&quot;]}} just switched to different config</z><z id="t1519858628" t="dadair [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] yes, see the print out of the context in the following example: dev&gt; (require &apos;[io.pedestal.interceptor.chain :as chain]) nil dev&gt; (def a {:name :a :enter (fn [ctx] (clojure.pprint/pprint ctx) ctx)}) #&apos;dev/a dev&gt; (def b {:name :b :enter identity}) #&apos;dev/b dev&gt; (chain/execute (chain/enqueue {} [b a])) #:io.pedestal.interceptor.chain{:queue &lt;-()-&lt;, :execution-id 114, :stack ({:name :a, :enter #function[dev/fn--47949]} {:name :b, :enter #function[clojure.core/identity]})} {} dev&gt; (chain/execute (chain/enqueue {} [a b])) #:io.pedestal.interceptor.chain{:queue &lt;-({:name :b, :enter #function[clojure.core/identity]})-&lt;, :execution-id 115, :stack ({:name :a, :enter #function[dev/fn--47949]})} {} dev&gt; "><y>#</y><d>2018-02-28</d><h>22:57</h><w>dadair</w><a>@souenzzo</a> yes, see the print out of the context in the following example:
<pre>dev&gt; (require &apos;[io.pedestal.interceptor.chain :as chain])
nil
dev&gt; (def a {:name :a :enter (fn [ctx] (clojure.pprint/pprint ctx) ctx)})
#&apos;dev/a
dev&gt; (def b {:name :b :enter identity})
#&apos;dev/b
dev&gt; (chain/execute (chain/enqueue {} [b a]))
#:io.pedestal.interceptor.chain{:queue &lt;-()-&lt;,
                                :execution-id 114,
                                :stack
                                ({:name :a,
                                  :enter #function[dev/fn--47949]}
                                 {:name :b,
                                  :enter
                                  #function[clojure.core/identity]})}
{}
dev&gt; (chain/execute (chain/enqueue {} [a b]))
#:io.pedestal.interceptor.chain{:queue
                                &lt;-({:name :b,
                                    :enter
                                    #function[clojure.core/identity]})-&lt;,
                                :execution-id 115,
                                :stack
                                ({:name :a,
                                  :enter #function[dev/fn--47949]})}
{}
dev&gt; 
</pre></z><z id="t1519863816" t="souenzzo I&apos;m already picking up from the stack. Just digging about a more &quot;standard/clean&quot; way to do 🙂 tkx"><y>#</y><d>2018-03-01</d><h>00:23</h><w>souenzzo</w>I&apos;m already picking up from the stack. Just digging about a more &quot;standard/clean&quot; way to do <b>🙂</b> tkx</z><z id="t1519924495" t="eraserhd Is there a way to filter pedestal exceptions when running tests? Mine are currently about 8000 lines long, I think."><y>#</y><d>2018-03-01</d><h>17:14</h><w>eraserhd</w>Is there a way to filter pedestal exceptions when running tests?  Mine are currently about 8000 lines long, I think.</z><z id="t1519930952" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0ECYL0ET&quot;}] you’ll need to dynamically change the logging level during your test runs. You can even do it at a per-test level but you’ll need to write code for that either way"><y>#</y><d>2018-03-01</d><h>19:02</h><w>ddeaguiar</w><a>@eraserhd</a> you’ll need to dynamically change the logging level during your test runs. You can even do it at a per-test level but you’ll need to write code for that either way</z><z id="t1519931060" t="ddeaguiar I’ve typically done this through a with-log-level macro"><y>#</y><d>2018-03-01</d><h>19:04</h><w>ddeaguiar</w>I’ve typically done this through a <code>with-log-level</code> macro</z><z id="t1519931683" t="eraserhd This is for the exceptions shown as test results?"><y>#</y><d>2018-03-01</d><h>19:14</h><w>eraserhd</w>This is for the exceptions shown as test results?</z><z id="t1519931764" t="eraserhd As in, &quot;expected: 42, got: #error { ... 8000 lines ... }&quot;?"><y>#</y><d>2018-03-01</d><h>19:16</h><w>eraserhd</w>As in, &quot;expected: 42, got: #error { ... 8000 lines ... }&quot;?</z><z id="t1519932922" t="ddeaguiar you got the error as a response body?"><y>#</y><d>2018-03-01</d><h>19:35</h><w>ddeaguiar</w>you got the error as a response body?</z><z id="t1519932931" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0ECYL0ET&quot;}] ^^"><y>#</y><d>2018-03-01</d><h>19:35</h><w>ddeaguiar</w><a>@eraserhd</a> ^^</z><z id="t1519932940" t="ddeaguiar my comment was about log file noise"><y>#</y><d>2018-03-01</d><h>19:35</h><w>ddeaguiar</w>my comment was about log file noise</z><z id="t1519932967" t="eraserhd Yeah, I&apos;m not looking at the logs. The error is an exception thrown from io.pedestal.test/response-for"><y>#</y><d>2018-03-01</d><h>19:36</h><w>eraserhd</w>Yeah, I&apos;m not looking at the logs.  The error is an exception thrown from io.pedestal.test/response-for</z><z id="t1519932993" t="eraserhd The test runner prints it at the REPL, which is painful."><y>#</y><d>2018-03-01</d><h>19:36</h><w>eraserhd</w>The test runner prints it at the REPL, which is painful.</z><z id="t1519933032" t="ddeaguiar ah hmm"><y>#</y><d>2018-03-01</d><h>19:37</h><w>ddeaguiar</w>ah hmm</z><z id="t1519933986" t="ddeaguiar I’m not sure of what the best solution is there other than setting the max stack trace depth at jvm startup"><y>#</y><d>2018-03-01</d><h>19:53</h><w>ddeaguiar</w>I’m not sure of what the best solution is there other than setting the max stack trace depth at jvm startup</z><z id="t1520599986" t="urzds Hi! Is this the right place to ask questions about Lacinia?"><y>#</y><d>2018-03-09</d><h>12:53</h><w>urzds</w>Hi! Is this the right place to ask questions about Lacinia?</z><z id="t1520600156" t="urzds Specifically, I am wondering why resolver-map is a function, in https://lacinia.readthedocs.io/en/latest/tutorial/init-schema.html#schema-namespace It appears it is rather static, i.e. not requiring to be executed at run time."><y>#</y><d>2018-03-09</d><h>12:55</h><w>urzds</w>Specifically, I am wondering why <code>resolver-map</code> is a function, in <a href="https://lacinia.readthedocs.io/en/latest/tutorial/init-schema.html#schema-namespace" target="_blank">https://lacinia.readthedocs.io/en/latest/tutorial/init-schema.html#schema-namespace</a>
It appears it is rather static, i.e. not requiring to be executed at run time.</z><z id="t1520601441" t="souenzzo [:attrs {:href &quot;/_/_/users/U37339DBP&quot;}] it&apos;s a lacinia question. I think that #graphql is the right channel yes, it&apos;s &quot;static&quot; in this example"><y>#</y><d>2018-03-09</d><h>13:17</h><w>souenzzo</w><a>@urzds</a> it&apos;s a lacinia question. I think that #graphql is the right channel
yes, it&apos;s &quot;static&quot; in this example</z><z id="t1520601970" t="urzds [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Thanks!"><y>#</y><d>2018-03-09</d><h>13:26</h><w>urzds</w><a>@souenzzo</a> Thanks!</z><z id="t1520888558" t="nooga I’m writing a defbefore that uses a component, what’s the best way to pass the component inside?"><y>#</y><d>2018-03-12</d><h>21:02</h><w>nooga</w>I’m writing a <code>defbefore</code> that uses a component, what’s the best way to pass the component inside?</z><z id="t1520888700" t="mtnygard [:attrs {:href &quot;/_/_/users/U0ARQ14BA&quot;}] Something I usually end up doing is write an interceptor to attach the whole system map to the context."><y>#</y><d>2018-03-12</d><h>21:05</h><w>mtnygard</w><a>@nooga</a> Something I usually end up doing is write an interceptor to attach the whole system map to the context.</z><z id="t1520888768" t="mtnygard (defn attach-system [system-map] {:enter (fn [context] (assoc context :system system-map))})"><y>#</y><d>2018-03-12</d><h>21:06</h><w>mtnygard</w>(defn attach-system [system-map]
  {:enter (fn [context] (assoc context :system system-map))})</z><z id="t1520888771" t="mtnygard Something like that."><y>#</y><d>2018-03-12</d><h>21:06</h><w>mtnygard</w>Something like that.</z><z id="t1520888792" t="mtnygard Then it goes at the front of the interceptors for every route"><y>#</y><d>2018-03-12</d><h>21:06</h><w>mtnygard</w>Then it goes at the front of the interceptors for every route</z><z id="t1520888977" t="nooga gotcha"><y>#</y><d>2018-03-12</d><h>21:09</h><w>nooga</w>gotcha</z><z id="t1521038891" t="dadair As an example with non-component systems, I’ve adopted the following pattern using Integrant: (defmethod ig/init-key ::inject-bus [_ {:keys [bus]}] {:name ::inject-bus :enter (fn [ctx] (assoc ctx :bypass.events/bus bus))}) then I can pass that interceptor around the system map as needed"><y>#</y><d>2018-03-14</d><h>14:48</h><r>dadair</r>As an example with non-component systems, I’ve adopted the following pattern using Integrant:
<pre>(defmethod ig/init-key ::inject-bus [_ {:keys [bus]}]
  {:name ::inject-bus
   :enter (fn [ctx] (assoc ctx :bypass.events/bus bus))})
</pre>
then I can pass that interceptor around the system map as needed</z><z id="t1521038936" t="dadair so the bus component is closed over in the interceptor creator, which will inject the component into the context map when entered"><y>#</y><d>2018-03-14</d><h>14:48</h><r>dadair</r>so the <code>bus</code> component is closed over in the interceptor creator, which will inject the component into the context map when entered</z><z id="t1520889039" t="nooga the other would be to capture the component (defn my-before [component] (helper/before (fn [context] ... component ...))"><y>#</y><d>2018-03-12</d><h>21:10</h><w>nooga</w>the other would be to capture the component <code>(defn my-before [component] (helper/before (fn [context] ... component ...))</code></z><z id="t1520889053" t="mtnygard Yes"><y>#</y><d>2018-03-12</d><h>21:10</h><w>mtnygard</w>Yes</z><z id="t1520889073" t="mtnygard Basically the same idea. You can decide how much to close over when creating the interceptor."><y>#</y><d>2018-03-12</d><h>21:11</h><w>mtnygard</w>Basically the same idea. You can decide how much to close over when creating the interceptor.</z><z id="t1520889107" t="mtnygard FWIW, the &quot;helpers&quot; are kind of discouraged now. They really obscured the fact that interceptors can be just plain, simple maps."><y>#</y><d>2018-03-12</d><h>21:11</h><w>mtnygard</w>FWIW, the &quot;helpers&quot; are kind of discouraged now. They really obscured the fact that interceptors can be just plain, simple maps.</z><z id="t1520889304" t="nooga to be honest I just snatched some random example and now I’m trying to make it work 😄"><y>#</y><d>2018-03-12</d><h>21:15</h><w>nooga</w>to be honest I just snatched some random example and now I’m trying to make it work <b>😄</b></z><z id="t1520889311" t="nooga it might be an old example"><y>#</y><d>2018-03-12</d><h>21:15</h><w>nooga</w>it might be an old example</z><z id="t1520889347" t="mtnygard Very likely. It&apos;s hard to out SEO the older blog posts."><y>#</y><d>2018-03-12</d><h>21:15</h><w>mtnygard</w>Very likely. It&apos;s hard to out SEO the older blog posts.</z><z id="t1521548976" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U623NFZ17&quot;}] , FWIW, I find it easiest to deploy Pedestal services to ElasticBeanstalk in a Docker container."><y>#</y><d>2018-03-20</d><h>12:29</h><w>ddeaguiar</w><a>@amarjeet</a>, FWIW, I find it easiest to deploy Pedestal services to ElasticBeanstalk in a Docker container.</z><z id="t1521550071" t="amarjeet [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I think I can try that"><y>#</y><d>2018-03-20</d><h>12:47</h><w>amarjeet</w><a>@ddeaguiar</a> I think I can try that</z><z id="t1521550073" t="amarjeet thanks"><y>#</y><d>2018-03-20</d><h>12:47</h><w>amarjeet</w>thanks</z><z id="t1521553546" t="ddeaguiar The lein pedestal-service template creates a Dockerfile which should be suitable for most cases. Keep in mind that EB uses nginx to proxy all requests to your container so you may need to create an nginx config file if you need control over that."><y>#</y><d>2018-03-20</d><h>13:45</h><w>ddeaguiar</w>The lein pedestal-service template creates a Dockerfile which should be suitable for most cases. Keep in mind that EB uses nginx to proxy all requests to your container so you may need to create an nginx config file if you need control over that.</z><z id="t1521555335" t="amarjeet okay, just started with this. lets see if I can make it work"><y>#</y><d>2018-03-20</d><h>14:15</h><w>amarjeet</w>okay, just started with this. lets see if I can make it work</z><z id="t1521557252" t="ddeaguiar It should be straight forward. You’ll just need to create a Dockerrun.aws.json file. I recommend using the eb cli for pushing change to you environment."><y>#</y><d>2018-03-20</d><h>14:47</h><w>ddeaguiar</w>It should be straight forward. You’ll just need to create a Dockerrun.aws.json file. I recommend using the eb cli for pushing change to you environment.</z><z id="t1521557480" t="amarjeet tried building docker image, its not been able to build. Error: `Get https://registry-1.docker.io/v2/ : dial tcp: lookup http://registry-1.docker.io on 192.168.65.1:53: read udp 192.168.65.2:45426-&gt;192.168.65.1:53: i/o timeout Docker image could not be built.`"><y>#</y><d>2018-03-20</d><h>14:51</h><w>amarjeet</w>tried building docker image, its not been able to build. Error: `Get <a href="https://registry-1.docker.io/v2/" target="_blank">https://registry-1.docker.io/v2/</a>: dial tcp: lookup <a href="http://registry-1.docker.io" target="_blank">http://registry-1.docker.io</a> on 192.168.65.1:53: read udp 192.168.65.2:45426-&gt;192.168.65.1:53: i/o timeout
Docker image could not be built.`</z><z id="t1521557625" t="amarjeet m updating docker - lets see"><y>#</y><d>2018-03-20</d><h>14:53</h><w>amarjeet</w>m updating docker - lets see</z><z id="t1521558231" t="amarjeet [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] any clear way to create a jar build? I am getting this error - javax/servlet/http/HttpServletRequest"><y>#</y><d>2018-03-20</d><h>15:03</h><w>amarjeet</w><a>@ddeaguiar</a> any clear way to create a jar build? I am getting this error - <code>javax/servlet/http/HttpServletRequest</code></z><z id="t1521558251" t="amarjeet i tried lein uberjar"><y>#</y><d>2018-03-20</d><h>15:04</h><w>amarjeet</w>i tried lein uberjar</z><z id="t1521558950" t="ddeaguiar Creating an uberjar should just work. You need to undo the changes you made to create a war file"><y>#</y><d>2018-03-20</d><h>15:15</h><w>ddeaguiar</w>Creating an uberjar should just work. You need to undo the changes you made to create a war file</z><z id="t1521559173" t="amarjeet I will try by creating a fresh pedestal service app"><y>#</y><d>2018-03-20</d><h>15:19</h><w>amarjeet</w>I will try by creating a fresh pedestal service app</z><z id="t1521563911" t="amarjeet Are both the situations incorrect, in terms of config?"><y>#</y><d>2018-03-20</d><h>16:38</h><w>amarjeet</w>Are both the situations incorrect, in terms of config?</z><z id="t1521565848" t="amarjeet Uberjar issue resolved"><y>#</y><d>2018-03-20</d><h>17:10</h><w>amarjeet</w>Uberjar issue resolved</z><z id="t1521567636" t="amarjeet Hey [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I am able to run the docker image locally, but the beanstalk is not recognizing Dockerfile when I am deploying standalone.jar"><y>#</y><d>2018-03-20</d><h>17:40</h><w>amarjeet</w>Hey <a>@ddeaguiar</a>  I am able to run the docker image locally, but the beanstalk is not recognizing Dockerfile when I am deploying standalone.jar</z><z id="t1521567645" t="amarjeet I am doing it via the beanstalk consol"><y>#</y><d>2018-03-20</d><h>17:40</h><w>amarjeet</w>I am doing it via the beanstalk consol</z><z id="t1521568223" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U623NFZ17&quot;}] did you create a Dockerrun.aws.json file?"><y>#</y><d>2018-03-20</d><h>17:50</h><w>ddeaguiar</w><a>@amarjeet</a> did you create a Dockerrun.aws.json file?</z><z id="t1521568322" t="amarjeet no, i thought Dockerfile would work"><y>#</y><d>2018-03-20</d><h>17:52</h><w>amarjeet</w>no, i thought Dockerfile would work</z><z id="t1521568332" t="ddeaguiar nope, you need one more piece"><y>#</y><d>2018-03-20</d><h>17:52</h><w>ddeaguiar</w>nope, you need one more piece</z><z id="t1521568342" t="ddeaguiar https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker_image.html"><y>#</y><d>2018-03-20</d><h>17:52</h><w>ddeaguiar</w><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker_image.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker_image.html</a></z><z id="t1521568384" t="ddeaguiar You can provide Elastic Beanstalk with only the Dockerrun.aws.json file, or with a .zip archive containing both the Dockerrun.aws.json and Dockerfile files. When you provide both files, the Dockerfile describes the Docker image and the Dockerrun.aws.json file provides additional information for deployment as described later in this section. "><y>#</y><d>2018-03-20</d><h>17:53</h><w>ddeaguiar</w><pre>You can provide Elastic Beanstalk with only the Dockerrun.aws.json file, or with a .zip archive containing both the Dockerrun.aws.json and Dockerfile files. When you provide both files, the Dockerfile describes the Docker image and the Dockerrun.aws.json file provides additional information for deployment as described later in this section.
</pre></z><z id="t1521568428" t="ddeaguiar so there are a couple ways to do this, you can deploy your docker image to an ecs registry repo or build the image at deployment time"><y>#</y><d>2018-03-20</d><h>17:53</h><w>ddeaguiar</w>so there are a couple ways to do this, you can deploy your docker image to an ecs registry repo or build the image at deployment time</z><z id="t1521568438" t="ddeaguiar I do the later when working with EB"><y>#</y><d>2018-03-20</d><h>17:53</h><w>ddeaguiar</w>I do the later when working with EB</z><z id="t1521568444" t="amarjeet so, it seems like the configs in this file are created when I was creating the beanstalk environment, so any specific part of the config should I mention (thats is mandatory) in the .json file"><y>#</y><d>2018-03-20</d><h>17:54</h><w>amarjeet</w>so, it seems like the configs in this file are created when I was creating the beanstalk environment, so any specific part of the config should I mention (thats is mandatory) in the .json file</z><z id="t1521568477" t="ddeaguiar The config you need in that file is minimal"><y>#</y><d>2018-03-20</d><h>17:54</h><w>ddeaguiar</w>The config you need in that file is minimal</z><z id="t1521568524" t="ddeaguiar it will amount to environment variable mappings (if any), port mappings, memory settings and log mount points"><y>#</y><d>2018-03-20</d><h>17:55</h><w>ddeaguiar</w>it will amount to environment variable mappings (if any), port mappings, memory settings and log mount points</z><z id="t1521568536" t="amarjeet hmm, okay"><y>#</y><d>2018-03-20</d><h>17:55</h><w>amarjeet</w>hmm, okay</z><z id="t1521568539" t="amarjeet will just try"><y>#</y><d>2018-03-20</d><h>17:55</h><w>amarjeet</w>will just try</z><z id="t1521568551" t="ddeaguiar my recommendation is to just first deploy a vanilla pedestal-service"><y>#</y><d>2018-03-20</d><h>17:55</h><w>ddeaguiar</w>my recommendation is to just first deploy a vanilla pedestal-service</z><z id="t1521568572" t="ddeaguiar once you have that working, then deploy your app which can have external dependencies"><y>#</y><d>2018-03-20</d><h>17:56</h><w>ddeaguiar</w>once you have that working, then deploy your app which can have external dependencies</z><z id="t1521568584" t="amarjeet make sense"><y>#</y><d>2018-03-20</d><h>17:56</h><w>amarjeet</w>make sense</z><z id="t1521568602" t="ddeaguiar you can then tailor your eb config to create the roles required to access aws services, etc"><y>#</y><d>2018-03-20</d><h>17:56</h><w>ddeaguiar</w>you can then tailor your eb config to create the roles required to access aws services, etc</z><z id="t1521568615" t="amarjeet hmm, yeah"><y>#</y><d>2018-03-20</d><h>17:56</h><w>amarjeet</w>hmm, yeah</z><z id="t1521568621" t="amarjeet gonna try this"><y>#</y><d>2018-03-20</d><h>17:57</h><w>amarjeet</w>gonna try this</z><z id="t1521669107" t="mv Is there a good example of implementing auth{oriz|entic}ation in pedestal apps?"><y>#</y><d>2018-03-21</d><h>21:51</h><w>mv</w>Is there a good example of implementing auth{oriz|entic}ation in pedestal apps?</z><z id="t1521709299" t="ouvasam [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] Hi, I did found this post, but not sure if it is the best way... https://juxt.pro/blog/posts/securing-your-clojurescript-app.html"><y>#</y><d>2018-03-22</d><h>09:01</h><w>ouvasam</w><a>@mv</a> Hi, I did found this post, but not sure if it is the best way... <a href="https://juxt.pro/blog/posts/securing-your-clojurescript-app.html" target="_blank">https://juxt.pro/blog/posts/securing-your-clojurescript-app.html</a></z><z id="t1521724274" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] some time ago I created a PR for with an auth example: https://github.com/pedestal/pedestal/pull/503"><y>#</y><d>2018-03-22</d><h>13:11</h><w>ddeaguiar</w><a>@mv</a> some time ago I created a PR for with an auth example: <a href="https://github.com/pedestal/pedestal/pull/503" target="_blank">https://github.com/pedestal/pedestal/pull/503</a></z><z id="t1521724335" t="ddeaguiar I also suggest checking out https://github.com/propan/geheimtur"><y>#</y><d>2018-03-22</d><h>13:12</h><w>ddeaguiar</w>I also suggest checking out <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a></z><z id="t1521949484" t="souenzzo My pedestal@jetty gives 404 for every OPTIONS . There is how &quot;enable&quot; the OPTIONS response?"><y>#</y><d>2018-03-25</d><h>03:44</h><w>souenzzo</w>My pedestal@jetty gives 404 for every <code>OPTIONS</code>. There is how &quot;enable&quot; the <code>OPTIONS</code> response?</z><z id="t1521951023" t="souenzzo I find the io.pedestal.http.cors namespace then the dev-interceptors that use it. Fixed 🙂"><y>#</y><d>2018-03-25</d><h>04:10</h><r>souenzzo</r>I find the <code>io.pedestal.http.cors</code> namespace then the <code>dev-interceptors</code> that use it. Fixed <b>🙂</b></z><z id="t1522179885" t="Travis Anyone know how to properly use pedestal-api in combination with testing using response-for ? I am unclear on how to properly implement url-for ?"><y>#</y><d>2018-03-27</d><h>19:44</h><w>Travis</w>Anyone know how to properly use pedestal-api in combination with testing using response-for ?  I am unclear on how to properly implement url-for ?</z><z id="t1522329600" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U096GDTLL&quot;}] I’ve not used pedestal-api but as long as you have routes you should be able to generate a url-for test helper"><y>#</y><d>2018-03-29</d><h>13:20</h><w>ddeaguiar</w><a>@camechis</a> I’ve not used pedestal-api but as long as you have routes you should be able to generate a url-for test helper</z><z id="t1522329642" t="Travis Thnx, I think I got past it"><y>#</y><d>2018-03-29</d><h>13:20</h><w>Travis</w>Thnx, I think I got past it</z><z id="t1522329651" t="ddeaguiar ok, cool"><y>#</y><d>2018-03-29</d><h>13:20</h><w>ddeaguiar</w>ok, cool</z><z id="t1522416169" t="mtnygard I&apos;ve just release Vase 0.9.3 to Clojars. It bumps the Clojure version to 1.9 and moves us to the newly release Datomic free version that closes a security bug."><y>#</y><d>2018-03-30</d><h>13:22</h><w>mtnygard</w>I&apos;ve just release Vase 0.9.3 to Clojars. It bumps the Clojure version to 1.9 and moves us to the newly release Datomic free version that closes a security bug.</z><z id="t1522443419" t="mv Seeing some issues with clojure spec when moving up to 0.9.3, is there anything specific I need to do?"><y>#</y><d>2018-03-30</d><h>20:56</h><r>mv</r>Seeing some issues with clojure spec when moving up to 0.9.3, is there anything specific I need to do?</z><z id="t1522936539" t="pithyless I’m trying to use io.pedestal.interceptor.chain/execute to define a pipeline of sync/async actions (outside of a regular web request). If I have a catch-all error interceptor (`{:error (fn [ctx ex] ..)}`), it works fine when I throw an exception in :enter or :leave , unless the enter/leave handler is async (returns a go chan ). Should it work? Or do I need a different error-handling approach for async?"><y>#</y><d>2018-04-05</d><h>13:55</h><w>pithyless</w>I’m trying to use <code>io.pedestal.interceptor.chain/execute</code> to define a pipeline of sync/async actions (outside of a regular web request). If I have a catch-all error interceptor (`{:error (fn [ctx ex] ..)}`), it works fine when I throw an exception in <code>:enter</code> or <code>:leave</code>, unless the enter/leave handler is async (returns a go <code>chan</code>). Should it work? Or do I need a different error-handling approach for async?</z><z id="t1522937421" t="pithyless I can do it explicitly with a try/catch inside the async/go block, but is there a better way?"><y>#</y><d>2018-04-05</d><h>14:10</h><w>pithyless</w>I can do it explicitly with a <code>try/catch</code> inside the <code>async/go</code> block, but is there a better way?</z><z id="t1522937452" t="pithyless :enter (fn [ctx] (let [ch (async/chan)] (async/go (try+ (async/&gt;! ch (do-some-async-work ctx)) (catch Object err (async/&gt;! ch (assoc ctx :io.pedestal.interceptor.chain/error (ex-info &quot;Async Error&quot; err)))))) ch))"><y>#</y><d>2018-04-05</d><h>14:10</h><w>pithyless</w><pre>:enter (fn [ctx]
            (let [ch (async/chan)]
              (async/go
                (try+
                 (async/&gt;! ch (do-some-async-work ctx))
                 (catch Object err
                   (async/&gt;! ch (assoc ctx :io.pedestal.interceptor.chain/error
                                       (ex-info &quot;Async Error&quot; err))))))
              ch))</pre></z><z id="t1522957098" t="mtnygard [:attrs {:href &quot;/_/_/users/U05476190&quot;}] It&apos;s supposed to use the same error handling whether you return a channel or a context. Can you share a repro case?"><y>#</y><d>2018-04-05</d><h>19:38</h><w>mtnygard</w><a>@pithyless</a> It&apos;s supposed to use the same error handling whether you return a channel or a context. Can you share a repro case?</z><z id="t1523020111" t="pithyless [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Does this suffice? https://gist.github.com/pithyless/51897363f5b6171a6d8e6368c60ab085"><y>#</y><d>2018-04-06</d><h>13:08</h><w>pithyless</w><a>@mtnygard</a> Does this suffice? <a href="https://gist.github.com/pithyless/51897363f5b6171a6d8e6368c60ab085" target="_blank">https://gist.github.com/pithyless/51897363f5b6171a6d8e6368c60ab085</a></z><z id="t1523020193" t="mtnygard [:attrs {:href &quot;/_/_/users/U05476190&quot;}] Thank you, this is excellent. I will look into it later today."><y>#</y><d>2018-04-06</d><h>13:09</h><w>mtnygard</w><a>@pithyless</a> Thank you, this is excellent. I will look into it later today.</z><z id="t1523032870" t="dadair [:attrs {:href &quot;/_/_/users/U05476190&quot;}] I could be wrong, but don’t you just want to return the channel returned from the go ? not provide an explicit extra channel?"><y>#</y><d>2018-04-06</d><h>16:41</h><w>dadair</w><a>@pithyless</a> I could be wrong, but don’t you just want to return the channel returned from the <code>go</code>? not provide an explicit extra channel?</z><z id="t1523032923" t="dadair e.g., (def do-work-async {:name :do-work-async :enter (fn [ctx] (let [ch (async/chan)] (async/go (async/&gt;! ch (if (:async-error ctx) (assert nil &quot;Async error&quot;) (assoc ctx :async :ok)))) ch))}) should be (def do-work-async {:name :do-work-async :enter (fn [ctx] (async/go (if (:async-error ctx) (assert nil &quot;Async error&quot;) (assoc ctx :async :ok))))}) I haven’t tested and edited the code in slack so parens are probably wrong"><y>#</y><d>2018-04-06</d><h>16:42</h><w>dadair</w>e.g.,
<pre>(def do-work-async
  {:name :do-work-async
   :enter (fn [ctx]
            (let [ch (async/chan)]
              (async/go
                (async/&gt;! ch
                          (if (:async-error ctx)
                            (assert nil &quot;Async error&quot;)
                            (assoc ctx :async :ok))))
              ch))})
</pre>
should be
<pre>(def do-work-async
  {:name :do-work-async
   :enter (fn [ctx]
            (async/go
                (if (:async-error ctx)
                    (assert nil &quot;Async error&quot;)
                    (assoc ctx :async :ok))))})
</pre>
I haven’t tested and edited the code in slack so parens are probably wrong</z><z id="t1523032970" t="dadair from the pedestal reference guide: http://pedestal.io/reference/interceptors#_interceptor_return_values"><y>#</y><d>2018-04-06</d><h>16:42</h><w>dadair</w>from the pedestal reference guide: <a href="http://pedestal.io/reference/interceptors#_interceptor_return_values" target="_blank">http://pedestal.io/reference/interceptors#_interceptor_return_values</a></z><z id="t1523033016" t="dadair (def third-party-auth {:name ::third-party-auth :enter (fn [context] (if (:session context) context (go (assoc context :auth-response (call-auth-system context))))}) they implicitly return a channel because the (go ..) returns a channel"><y>#</y><d>2018-04-06</d><h>16:43</h><w>dadair</w><pre>(def third-party-auth
  {:name ::third-party-auth
   :enter (fn [context]
            (if (:session context)
              context
              (go
                (assoc context :auth-response (call-auth-system context))))})
</pre>
they implicitly return a channel because the <code>(go ..)</code> returns a channel</z><z id="t1523033063" t="pithyless [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] in this case, having the async/go return would be sufficient; but it makes no difference - error is the same"><y>#</y><d>2018-04-06</d><h>16:44</h><w>pithyless</w><a>@dadair</a> in this case, having the <code>async/go</code> return would be sufficient; but it makes no difference - error is the same</z><z id="t1523033130" t="mtnygard [:attrs {:href &quot;/_/_/users/U05476190&quot;}] There could be another difference. The assert is going to throw an exception that will be silently swallowed by the inner go . Nothing at all is going to come out of the channel if that happens."><y>#</y><d>2018-04-06</d><h>16:45</h><w>mtnygard</w><a>@pithyless</a> There could be another difference. The <code>assert</code> is going to throw an exception that will be silently swallowed by the inner <code>go</code>. Nothing at all is going to come out of the channel if that happens.</z><z id="t1523033208" t="mtnygard But now that I look at it... I&apos;m not sure how the assert would get caught outside any go block. I will have to take a fresh look at the Pedestal source to understand."><y>#</y><d>2018-04-06</d><h>16:46</h><w>mtnygard</w>But now that I look at it... I&apos;m not sure how the assert would get caught outside any go block. I will have to take a fresh look at the Pedestal source to understand.</z><z id="t1523033293" t="pithyless [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] so without the explicit channel, just returning an implicit async/go channel, we see something like this:"><y>#</y><d>2018-04-06</d><h>16:48</h><w>pithyless</w><a>@mtnygard</a> <a>@dadair</a> so without the explicit channel, just returning an implicit <code>async/go</code> channel, we see something like this:</z><z id="t1523033333" t="pithyless Async error... Exception in thread &quot;async-dispatch-5&quot; java.lang.AssertionError: Assert failed: Async error nil [OK] Handling error. clojure.lang.ExceptionInfo: Async Interceptor closed Context Channel before delivering a Context at clojure.core$ex_info.invokeStatic (core.clj:4739) clojure.core$ex_info.invoke (core.clj:4739)"><y>#</y><d>2018-04-06</d><h>16:48</h><w>pithyless</w><pre>Async error...
Exception in thread &quot;async-dispatch-5&quot; java.lang.AssertionError: Assert failed: Async error
nil
[OK] Handling error.
clojure.lang.ExceptionInfo: Async Interceptor closed Context Channel before delivering a Context
 at clojure.core$ex_info.invokeStatic (core.clj:4739)
    clojure.core$ex_info.invoke (core.clj:4739)</pre></z><z id="t1523033420" t="mtnygard I was just looking at the line of source that throws that exception. 🙂"><y>#</y><d>2018-04-06</d><h>16:50</h><w>mtnygard</w>I was just looking at the line of source that throws that exception. <b>🙂</b></z><z id="t1523033481" t="mtnygard If you want the exception to be processed with Pedestal&apos;s error handling, I guess you need to catch Throwable and attach it to the context map before putting the context map into the channel."><y>#</y><d>2018-04-06</d><h>16:51</h><w>mtnygard</w>If you want the exception to be processed with Pedestal&apos;s error handling, I guess you need to <code>catch Throwable</code> and attach it to the context map before putting the context map into the channel.</z><z id="t1523033490" t="mtnygard I don&apos;t think we have that documented very well. 😞"><y>#</y><d>2018-04-06</d><h>16:51</h><w>mtnygard</w>I don&apos;t think we have that documented very well. <b>😞</b></z><z id="t1523033556" t="pithyless Do you mean, the way I wrote about it yesterday? https://clojurians.slack.com/archives/C0K65B20P/p1522937421000780"><y>#</y><d>2018-04-06</d><h>16:52</h><w>pithyless</w>Do you mean, the way I wrote about it yesterday? <a href="https://clojurians.slack.com/archives/C0K65B20P/p1522937421000780" target="_blank">https://clojurians.slack.com/archives/C0K65B20P/p1522937421000780</a></z><z id="t1523033580" t="mtnygard Yes, but without the extra channel."><y>#</y><d>2018-04-06</d><h>16:53</h><w>mtnygard</w>Yes, but without the extra channel.</z><z id="t1523033599" t="pithyless right, fair enough"><y>#</y><d>2018-04-06</d><h>16:53</h><w>pithyless</w>right, fair enough</z><z id="t1523033646" t="pithyless so yeah… that’s not obvious from the documentation as it’s written now :]"><y>#</y><d>2018-04-06</d><h>16:54</h><w>pithyless</w>so yeah… that’s not obvious from the documentation as it’s written now :]</z><z id="t1523033655" t="mtnygard This part really doesn&apos;t behave the way I&apos;d expect it to. And the docs are definitely misleading."><y>#</y><d>2018-04-06</d><h>16:54</h><w>mtnygard</w>This part really doesn&apos;t behave the way I&apos;d expect it to. And the docs are definitely misleading.</z><z id="t1523033662" t="mtnygard Sorry you had to struggle with this."><y>#</y><d>2018-04-06</d><h>16:54</h><w>mtnygard</w>Sorry you had to struggle with this.</z></g><g id="s11"><z id="t1523033672" t="mtnygard We&apos;ll try to make it better."><y>#</y><d>2018-04-06</d><h>16:54</h><w>mtnygard</w>We&apos;ll try to make it better.</z><z id="t1523033701" t="pithyless no problem; I just assumed I was doing something wrong 🙂"><y>#</y><d>2018-04-06</d><h>16:55</h><w>pithyless</w>no problem; I just assumed I was doing something wrong  <b>🙂</b></z><z id="t1523033722" t="mtnygard I&apos;ve got to run. Feel free to send me a DM if you run into more trouble."><y>#</y><d>2018-04-06</d><h>16:55</h><w>mtnygard</w>I&apos;ve got to run. Feel free to send me a DM if you run into more trouble.</z><z id="t1523033793" t="pithyless [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] thanks for your help! interceptor.chain/execute is still a really nice way to decomplect a workflow 🙂"><y>#</y><d>2018-04-06</d><h>16:56</h><w>pithyless</w><a>@mtnygard</a> thanks for your help! <code>interceptor.chain/execute</code> is still a really nice way to decomplect a workflow <b>🙂</b></z><z id="t1523305670" t="hlship So ... no commits since Oct 2017, what&apos;s up?"><y>#</y><d>2018-04-09</d><h>20:27</h><w>hlship</w>So ... no commits since Oct 2017, what&apos;s up?</z><z id="t1523312596" t="dadair And is there anything we can do to help?"><y>#</y><d>2018-04-09</d><h>22:23</h><w>dadair</w>And is there anything we can do to help?</z><z id="t1523452853" t="mtnygard [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] Mainly just that Paul (the primary steward until now) has to devote his time to personal life for the foreseeable. I&apos;m the maintainer at the moment with a pretty full plate."><y>#</y><d>2018-04-11</d><h>13:20</h><w>mtnygard</w><a>@hlship</a> Mainly just that Paul (the primary steward until now) has to devote his time to personal life for the foreseeable. I&apos;m the maintainer at the moment with a pretty full plate.</z><z id="t1523452875" t="mtnygard But I sincerely appreciate the prodding. No sarcasm!"><y>#</y><d>2018-04-11</d><h>13:21</h><w>mtnygard</w>But I sincerely appreciate the prodding. No sarcasm!</z><z id="t1523452945" t="mtnygard I&apos;d love to hear from @channel what they need from Pedestal. IMO, the foundation is strong so I don&apos;t see a lot of pending work in the core. So post your wishlist and we can start to build a roadmap together."><y>#</y><d>2018-04-11</d><h>13:22</h><w>mtnygard</w>I&apos;d love to hear from @channel what they need from Pedestal. IMO, the foundation is strong so I don&apos;t see a lot of pending work in the core. So post your wishlist and we can start to build a roadmap together.</z><z id="t1523463503" t="hlship Did you notice this PR? https://github.com/pedestal/pedestal/pull/551"><y>#</y><d>2018-04-11</d><h>16:18</h><r>hlship</r>Did you notice this PR? <a href="https://github.com/pedestal/pedestal/pull/551" target="_blank">https://github.com/pedestal/pedestal/pull/551</a></z><z id="t1523463617" t="mtnygard Yep. I&apos;ve just had zero time for any open source work the last few weeks."><y>#</y><d>2018-04-11</d><h>16:20</h><r>mtnygard</r>Yep. I&apos;ve just had zero time for any open source work the last few weeks.</z><z id="t1523454656" t="dadair [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] one of the things I’d like to help with is fleshing out the guides more. It can be frustrating when learning pedestal to click on a guide link only to see a placeholder template. I’ve thought about contributing some but notice that PRs seem to stagnate, so haven’t put in the time yet."><y>#</y><d>2018-04-11</d><h>13:50</h><w>dadair</w><a>@mtnygard</a> one of the things I’d like to help with is fleshing out the guides more. It can be frustrating when learning pedestal to click on a guide link only to see a placeholder template. I’ve thought about contributing some but notice that PRs seem to stagnate, so haven’t put in the time yet.</z><z id="t1523454687" t="mtnygard I would love help with the guides."><y>#</y><d>2018-04-11</d><h>13:51</h><w>mtnygard</w>I would love help with the guides.</z><z id="t1523455015" t="dadair Great! I’ll see where I can help and will work on some PRs over the next few weeks. Would you be open to a PR that removes any link to a guide that does not yet exist (to remove the tease) for the time being?"><y>#</y><d>2018-04-11</d><h>13:56</h><r>dadair</r>Great! I’ll see where I can help and will work on some PRs over the next few weeks. Would you be open to a PR that removes any link to a guide that does not yet exist (to remove the tease) for the time being?</z><z id="t1523455058" t="mtnygard Well, I did put in the placeholders to encourage contributions, not just to tease people."><y>#</y><d>2018-04-11</d><h>13:57</h><r>mtnygard</r>Well, I did put in the placeholders to encourage contributions, not just to tease people.</z><z id="t1523455126" t="mtnygard But if your experience is that they&apos;re discouraging, then go ahead and send that PR."><y>#</y><d>2018-04-11</d><h>13:58</h><r>mtnygard</r>But if your experience is that they&apos;re discouraging, then go ahead and send that PR.</z><z id="t1523455170" t="dadair What if a general call to action was put at the top of the guide list?"><y>#</y><d>2018-04-11</d><h>13:59</h><r>dadair</r>What if a general call to action was put at the top of the guide list?</z><z id="t1523455183" t="mtnygard I like that"><y>#</y><d>2018-04-11</d><h>13:59</h><r>mtnygard</r>I like that</z><z id="t1523455195" t="dadair The list would then act also like a todo list for contributors"><y>#</y><d>2018-04-11</d><h>13:59</h><r>dadair</r>The list would then act also like a todo list for contributors</z><z id="t1523454727" t="ikitommi I would like to see the interceptor model extracted into a specification, like Ring: no pedestal-based keys, pluggable async and support for ClojureScript."><y>#</y><d>2018-04-11</d><h>13:52</h><w>ikitommi</w>I would like to see the interceptor model extracted into a specification, like Ring: no pedestal-based keys, pluggable async and support for ClojureScript.</z><z id="t1523547326" t="souenzzo +1 to cljs/spec support"><y>#</y><d>2018-04-12</d><h>15:35</h><r>souenzzo</r>+1 to cljs/spec support</z><z id="t1523454837" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] Are you more interested in using interceptors in front-end apps or in back-end CLJS? Just curious."><y>#</y><d>2018-04-11</d><h>13:53</h><w>mtnygard</w><a>@ikitommi</a> Are you more interested in using interceptors in front-end apps or in back-end CLJS? Just curious.</z><z id="t1523454998" t="ikitommi both. re-frame has interceptors, but bit different, (`:before` and :after and with bit different semantics) and would be great for Clojure/Script story to be able to run ~same web apps on both server targets."><y>#</y><d>2018-04-11</d><h>13:56</h><w>ikitommi</w>both. re-frame has interceptors, but bit different, (`:before` and <code>:after</code> and with bit different semantics) and would  be great for Clojure/Script story to be able to run ~same web apps on both server targets.</z><z id="t1523455033" t="ikitommi There are at least two ports of pedestal interceptors, just bit different."><y>#</y><d>2018-04-11</d><h>13:57</h><w>ikitommi</w>There are at least two ports of pedestal interceptors, just bit different.</z><z id="t1523455127" t="ikitommi we have some libs that suppot both ring and “Pedestal-style intereptors”."><y>#</y><d>2018-04-11</d><h>13:58</h><w>ikitommi</w>we have some libs that suppot both ring and “Pedestal-style intereptors”.</z><z id="t1523463737" t="hlship I found that, when implementing GraphQL subscriptions for Lacinia, using Pedestal web sockets, there existing API was quite opinionated and I had to do a kind of &quot;end run&quot; around the preconceptions: https://github.com/walmartlabs/lacinia-pedestal/blob/5fa4c02be0c9fb97ebfb288e3dd5eda12d09f07e/src/com/walmartlabs/lacinia/pedestal.clj#L608"><y>#</y><d>2018-04-11</d><h>16:22</h><w>hlship</w>I found that, when implementing GraphQL subscriptions for Lacinia, using Pedestal web sockets, there existing API was quite opinionated and I had to do a kind of &quot;end run&quot; around the preconceptions: <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/5fa4c02be0c9fb97ebfb288e3dd5eda12d09f07e/src/com/walmartlabs/lacinia/pedestal.clj#L608" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/5fa4c02be0c9fb97ebfb288e3dd5eda12d09f07e/src/com/walmartlabs/lacinia/pedestal.clj#L608</a></z><z id="t1523463762" t="hlship It feels like there&apos;s a simpler API buried in there, and the current API should be a convenience layer on top of that."><y>#</y><d>2018-04-11</d><h>16:22</h><w>hlship</w>It feels like there&apos;s a simpler API buried in there, and the current API should be a convenience layer on top of that.</z><z id="t1523547326" t="souenzzo +1 to cljs/spec support"><y>#</y><d>2018-04-12</d><h>15:35</h><w>souenzzo</w>+1 to cljs/spec support</z><z id="t1523503423" t="dadair I agree with [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] re: websockets. I actually only eventually figured out how to do it by replicating most of his Lacinia pedestal ws code, otherwise beforehand I was pretty lost on how to implement stateful WS connections"><y>#</y><d>2018-04-12</d><h>03:23</h><w>dadair</w>I agree with <a>@hlship</a> re: websockets. I actually only eventually figured out how to do it by replicating most of his Lacinia pedestal ws code, otherwise beforehand I was pretty lost on how to implement stateful WS connections</z><z id="t1523839338" t="caleb.macdonaldblack We are testing against our routes and test logs are being bloated by http request logs. Is there any way to disable logging in pedestal for tests?"><y>#</y><d>2018-04-16</d><h>00:42</h><w>caleb.macdonaldblack</w>We are testing against our routes and test logs are being bloated by http request logs. Is there any way to disable logging in pedestal for tests?</z><z id="t1523845836" t="mv Are there any popular examples of a pedestal application with a cljs frontend in the same codebase?"><y>#</y><d>2018-04-16</d><h>02:30</h><w>mv</w>Are there any popular examples of a pedestal application with a cljs frontend in the same codebase?</z><z id="t1523948825" t="joost-diepenmaat [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] you should be able to disable logging for particular namespaces in logback.xml"><y>#</y><d>2018-04-17</d><h>07:07</h><w>joost-diepenmaat</w><a>@caleb.macdonaldblack</a> you should be able to disable logging for particular namespaces in logback.xml</z><z id="t1523948923" t="joost-diepenmaat if you want to do that only for test, what you can do is configure a separate test-resources dir containing a different logback.xml, and include that test-resources dir in your resources config for the “test” profile (that’s assuming you’re using leiningen - boot and tools.deps should allow similar strategies)"><y>#</y><d>2018-04-17</d><h>07:08</h><w>joost-diepenmaat</w>if you want to do that only for test, what you can do is configure a separate test-resources dir containing a different logback.xml, and include that test-resources dir in your resources config for the “test” profile (that’s assuming you’re using leiningen - boot and tools.deps should allow similar strategies)</z><z id="t1523949032" t="joost-diepenmaat alternatively, log requests to a different log file that you can ignore 🙂"><y>#</y><d>2018-04-17</d><h>07:10</h><w>joost-diepenmaat</w>alternatively, log requests to a different log file that you can ignore <b>🙂</b></z><z id="t1523950732" t="caleb.macdonaldblack [:attrs {:href &quot;/_/_/users/U09N5N31T&quot;}] Thanks. I think that’s what I was looking for. 🙂"><y>#</y><d>2018-04-17</d><h>07:38</h><w>caleb.macdonaldblack</w><a>@joost-diepenmaat</a> Thanks. I think that’s what I was looking for. <b>🙂</b></z><z id="t1523969886" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] you can also do this on a per test level using something like this: https://gist.github.com/ddeaguiar/ebe46de1215134c28c59"><y>#</y><d>2018-04-17</d><h>12:58</h><w>ddeaguiar</w><a>@caleb.macdonaldblack</a> you can also do this on a per test level using something like this: <a href="https://gist.github.com/ddeaguiar/ebe46de1215134c28c59" target="_blank">https://gist.github.com/ddeaguiar/ebe46de1215134c28c59</a></z><z id="t1523969942" t="ddeaguiar this is useful to squelch logging for tests that verify errors."><y>#</y><d>2018-04-17</d><h>12:59</h><w>ddeaguiar</w>this is useful to squelch logging for tests that verify errors.</z><z id="t1523973237" t="caleb.macdonaldblack [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Oh wow thanks. I’ll check it out"><y>#</y><d>2018-04-17</d><h>13:53</h><w>caleb.macdonaldblack</w><a>@ddeaguiar</a> Oh wow thanks. I’ll check it out</z><z id="t1523973520" t="ddeaguiar np! It’s one of the test utils I typically bring into a project"><y>#</y><d>2018-04-17</d><h>13:58</h><w>ddeaguiar</w>np! It’s one of the test utils I typically bring into a project</z><z id="t1524115985" t="mv Has anyone gotten figwheel working with pedestal? I haven’t found any examples"><y>#</y><d>2018-04-19</d><h>05:33</h><w>mv</w>Has anyone gotten figwheel working with pedestal? I haven’t found any examples</z><z id="t1524124750" t="joost-diepenmaat do you mean pedestal-app or pedestal server?"><y>#</y><d>2018-04-19</d><h>07:59</h><w>joost-diepenmaat</w>do you mean pedestal-app or pedestal server?</z><z id="t1524125261" t="joost-diepenmaat [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] as far as I know pedestal-app is not really maintained anymore, for server side stuff with a clojurescript frontend I’ve found it easiest to set up 2 different projects where the frontend code has its own figwheel server and the “custom” server stuff is on another process."><y>#</y><d>2018-04-19</d><h>08:07</h><w>joost-diepenmaat</w><a>@mv</a> as far as I know pedestal-app is not really maintained anymore, for server side stuff with a clojurescript frontend I’ve found it easiest to set up 2 different projects where the frontend code has its own figwheel server and the “custom” server stuff is on another process.</z><z id="t1524125344" t="joost-diepenmaat In production it turns out that usually you’d deploy the frontend app on some other server than the backend service (app on S3, with caching/CDN) so you need to make sure that that works anyway."><y>#</y><d>2018-04-19</d><h>08:09</h><w>joost-diepenmaat</w>In production it turns out that usually you’d deploy the frontend app on some other server than the backend service (app on S3, with caching/CDN) so you need to make sure that that works anyway.</z><z id="t1524127646" t="thegeez [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] this project uses pedestal (server) and figwheel: https://github.com/thegeez/clj-board where figwheel is started from the repl (see dev/clj/user/clj), instead of through lein fighweel"><y>#</y><d>2018-04-19</d><h>08:47</h><w>thegeez</w><a>@mv</a> this project uses pedestal (server) and figwheel: <a href="https://github.com/thegeez/clj-board" target="_blank">https://github.com/thegeez/clj-board</a> where figwheel is started from the repl (see dev/clj/user/clj), instead of through <code>lein fighweel</code></z><z id="t1524142846" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U09N5N31T&quot;}] yep, pedestal-app is no longer maintained. I’ve also found the two project approach (front end, service) to be the preferred approach as well. /cc [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}]"><y>#</y><d>2018-04-19</d><h>13:00</h><w>ddeaguiar</w><a>@joost-diepenmaat</a> yep, pedestal-app is no longer maintained. I’ve also found the two project approach (front end, service) to be the preferred approach as well. /cc <a>@mv</a></z><z id="t1524157251" t="mv Thanks all!"><y>#</y><d>2018-04-19</d><h>17:00</h><w>mv</w>Thanks all!</z><z id="t1524157492" t="mv [:attrs {:href &quot;/_/_/users/U09N5N31T&quot;}] in case of a split codebase, have you ever experienced that you wanted shared code, and how did you deal with that?"><y>#</y><d>2018-04-19</d><h>17:04</h><w>mv</w><a>@joost-diepenmaat</a> in case of a split codebase, have you ever experienced that you wanted shared code, and how did you deal with that?</z><z id="t1524197499" t="joost-diepenmaat [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] Yeah I have. What I like is to have 2 Leiningen projects in the same code repo and then there are multiple ways to share code. You can symlink shared files/dirs or include a shared src tree in your src paths. Alternatively you can set up a common dependency project but I don’t like the extra hassle when you’re not releasing the common code. "><y>#</y><d>2018-04-20</d><h>04:11</h><w>joost-diepenmaat</w><a>@mv</a> Yeah I have. What I like is to have 2 Leiningen projects in the same code repo and then there are multiple ways to share code. You can symlink shared files/dirs or include a shared src tree in your src paths. Alternatively you can set up a common dependency project but I don’t like the extra hassle when you’re not releasing the common code. </z><z id="t1524197523" t="mv That makes sense"><y>#</y><d>2018-04-20</d><h>04:12</h><w>mv</w>That makes sense</z><z id="t1524338262" t="mtnygard ANNOUNCEMENT: [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] recently joined Cognitect and is now a core contributor to Pedestal! He&apos;s been a great member of the Pedestal community for a long time, so I&apos;m thrilled that he&apos;s taking a strong role here."><y>#</y><d>2018-04-21</d><h>19:17</h><w>mtnygard</w>ANNOUNCEMENT: <a>@ddeaguiar</a> recently joined Cognitect and is now a core contributor to Pedestal! He&apos;s been a great member of the Pedestal community for a long time, so I&apos;m thrilled that he&apos;s taking a strong role here.</z><z id="t1524351760" t="ddeaguiar Thanks [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] 🙂"><y>#</y><d>2018-04-21</d><h>23:02</h><w>ddeaguiar</w>Thanks <a>@mtnygard</a> <b>🙂</b></z><z id="t1524547309" t="ikitommi what is the use case for io.pedestal.http.ring-middlewares/fast-resource ? It seems to expect that the resources are in a file system, so it doesn’t work from uberjar?"><y>#</y><d>2018-04-24</d><h>05:21</h><w>ikitommi</w>what is the use case for <code>io.pedestal.http.ring-middlewares/fast-resource</code>? It seems to expect that the resources are in a file system, so it doesn’t work from uberjar?</z><z id="t1524588097" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] I’ll follow up on this but my understanding is that fast-resource is intended to target large files which, by definition, should probably not be in your jar file."><y>#</y><d>2018-04-24</d><h>16:41</h><w>ddeaguiar</w><a>@ikitommi</a> I’ll follow up on this but my understanding is that <code>fast-resource</code> is intended to target large files which, by definition, should probably not be in your jar file.</z><z id="t1524677747" t="kenny Does anyone have any idea about this exception? java.lang.NullPointerException in Interceptor :io.pedestal.http.impl.servlet-interceptor/stylobate I have never seen that interceptor. Full stack trace: https://pastebin.com/W9BuQv6A"><y>#</y><d>2018-04-25</d><h>17:35</h><w>kenny</w>Does anyone have any idea about this exception? 
<pre>java.lang.NullPointerException in Interceptor :io.pedestal.http.impl.servlet-interceptor/stylobate
</pre>
I have never seen that interceptor. Full stack trace: <a href="https://pastebin.com/W9BuQv6A" target="_blank">https://pastebin.com/W9BuQv6A</a></z><z id="t1524679646" t="kenny This exception has something to do with the elements array passed to String/join being null . https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/request.clj#L27 (enumeration-seq (.getHeaders servlet-req key)) is null."><y>#</y><d>2018-04-25</d><h>18:07</h><w>kenny</w>This exception has something to do with the elements array passed to <code>String/join</code> being <code>null</code>.
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/request.clj#L27" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/request.clj#L27</a> <code>(enumeration-seq (.getHeaders servlet-req key))</code> is null.</z><z id="t1525189137" t="mtnygard [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] Checking in late here, but that exception seems like a bug. Would you be willing to submit an issue on Github?"><y>#</y><d>2018-05-01</d><h>15:38</h><w>mtnygard</w><a>@kenny</a> Checking in late here, but that exception seems like a bug. Would you be willing to submit an issue on Github?</z><z id="t1525189239" t="kenny Sure."><y>#</y><d>2018-05-01</d><h>15:40</h><w>kenny</w>Sure.</z><z id="t1525189269" t="kenny I think it happens when you use response-for with a header value set as nil ."><y>#</y><d>2018-05-01</d><h>15:41</h><w>kenny</w>I think it happens when you use <code>response-for</code> with a header value set as <code>nil</code>.</z><z id="t1525190423" t="kenny https://github.com/pedestal/pedestal/issues/554"><y>#</y><d>2018-05-01</d><h>16:00</h><w>kenny</w><a href="https://github.com/pedestal/pedestal/issues/554" target="_blank">https://github.com/pedestal/pedestal/issues/554</a></z><z id="t1525363901" t="tianshu I&apos;m very interest in pedestal, I want to write a web server with core.async. is there any examples for pedestal with core.async? also, i&apos;m curious about how to deal with jdbc with core.async."><y>#</y><d>2018-05-03</d><h>16:11</h><w>tianshu</w>I&apos;m very interest in pedestal, I want to write a web server with core.async. is there any examples for pedestal with core.async? also, i&apos;m curious about how to deal with jdbc with core.async.</z><z id="t1525363917" t="tianshu thanks for any help."><y>#</y><d>2018-05-03</d><h>16:11</h><w>tianshu</w>thanks for any help.</z><z id="t1525365647" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U0NBGRGD6&quot;}] , I’m glad to hear about your interest in Pedestal! I recommend reading through the Pedestal documentation, in particular the section on interceptor return values ( http://pedestal.io/reference/interceptors#_interceptor_return_values ). Unfortunately, I don’t have a sample project to point you to but I just created an issue ( https://github.com/pedestal/pedestal-docs/issues/104 ) to track getting that done."><y>#</y><d>2018-05-03</d><h>16:40</h><w>ddeaguiar</w>Hi <a>@doglooksgood</a>, I’m glad to hear about your interest in Pedestal! I recommend reading through the Pedestal documentation, in particular the section on interceptor return values (<a href="http://pedestal.io/reference/interceptors#_interceptor_return_values" target="_blank">http://pedestal.io/reference/interceptors#_interceptor_return_values</a>). Unfortunately, I don’t have a sample project to point you to but I just created an issue (<a href="https://github.com/pedestal/pedestal-docs/issues/104" target="_blank">https://github.com/pedestal/pedestal-docs/issues/104</a>) to track getting that done.</z><z id="t1525365923" t="ddeaguiar In a nutshell, Pedestal interceptors support going async. You just need to return a core.async channel which will yield an updated context"><y>#</y><d>2018-05-03</d><h>16:45</h><w>ddeaguiar</w>In a nutshell, Pedestal interceptors support going async. You just need to return a core.async channel which will yield an updated context</z><z id="t1525365964" t="tianshu that&apos;s great, if I understand correct, pedestal can use core.async channel as a response. so basically i can use a go in handler and do everything I want?"><y>#</y><d>2018-05-03</d><h>16:46</h><w>tianshu</w>that&apos;s great, if I understand correct, pedestal can use core.async channel as a response. so basically i can use a <code>go</code> in handler and do everything I want?</z><z id="t1525366000" t="tianshu I found on the document that I can return channel in interceptors"><y>#</y><d>2018-05-03</d><h>16:46</h><w>tianshu</w>I found on the document that I can return channel in interceptors</z><z id="t1525366528" t="ddeaguiar To be clear, you cannot return a channel as a response."><y>#</y><d>2018-05-03</d><h>16:55</h><w>ddeaguiar</w>To be clear, you cannot return a channel as a response.</z><z id="t1525366542" t="ddeaguiar in other words"><y>#</y><d>2018-05-03</d><h>16:55</h><w>ddeaguiar</w>in other words</z><z id="t1525366587" t="ddeaguiar If you have a handler function, it can’t return a channel. But an interceptor can return a channel which will return a context map at some point"><y>#</y><d>2018-05-03</d><h>16:56</h><w>ddeaguiar</w>If you have a handler function, it can’t return a channel. But an interceptor can return a channel which will return a context map at some point</z><z id="t1525366637" t="tianshu http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response this part looks confusing"><y>#</y><d>2018-05-03</d><h>16:57</h><w>tianshu</w><a href="http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response" target="_blank">http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response</a>
this part looks confusing</z><z id="t1525366698" t="ddeaguiar Hm, I need to look into that because the following does not work (defn home-page [request] (async/go (ring-resp/response &quot;Hello World!&quot;))) "><y>#</y><d>2018-05-03</d><h>16:58</h><w>ddeaguiar</w>Hm, I need to look into that because the following does not work
<pre>(defn home-page
  [request]
  (async/go
    (ring-resp/response &quot;Hello World!&quot;)))
</pre></z><z id="t1525366717" t="ddeaguiar while this does (def home-page (i/interceptor {:name ::home-page :enter (fn [ctx] (async/go (assoc ctx :response (ring-resp/response &quot;Hello World!&quot;))))})) "><y>#</y><d>2018-05-03</d><h>16:58</h><w>ddeaguiar</w>while this does
<pre>(def home-page
  (i/interceptor
   {:name ::home-page
    :enter (fn [ctx]
             (async/go
               (assoc ctx :response (ring-resp/response &quot;Hello World!&quot;))))}))
</pre></z><z id="t1525366737" t="ddeaguiar but I will follow up"><y>#</y><d>2018-05-03</d><h>16:58</h><w>ddeaguiar</w>but I will follow up</z><z id="t1525366857" t="ddeaguiar ah"><y>#</y><d>2018-05-03</d><h>17:00</h><w>ddeaguiar</w>ah</z><z id="t1525367022" t="tianshu okay, I&apos;ll take a look"><y>#</y><d>2018-05-03</d><h>17:03</h><w>tianshu</w>okay, I&apos;ll take a look</z><z id="t1525367090" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0NBGRGD6&quot;}] I’m mistaken, when working with servlets you can return a channel as the response body"><y>#</y><d>2018-05-03</d><h>17:04</h><w>ddeaguiar</w><a>@doglooksgood</a> I’m mistaken, when working with servlets you can return a channel as the response body</z><z id="t1525367097" t="ddeaguiar but not as the response"><y>#</y><d>2018-05-03</d><h>17:04</h><w>ddeaguiar</w>but not as the response</z><z id="t1525367173" t="ddeaguiar So this works (defn home-page [request] (-&gt; (async/go &quot;Hello World!&quot;) ring-resp/response (ring-resp/content-type &quot;text/html&quot;))) "><y>#</y><d>2018-05-03</d><h>17:06</h><w>ddeaguiar</w>So this works
<pre>(defn home-page
  [request]
  (-&gt; (async/go &quot;Hello World!&quot;)
      ring-resp/response
      (ring-resp/content-type &quot;text/html&quot;)))
</pre></z><z id="t1525367212" t="ddeaguiar But this behavior is specific to servlet interceptor chain providers"><y>#</y><d>2018-05-03</d><h>17:06</h><w>ddeaguiar</w>But this behavior is specific to servlet interceptor chain providers</z><z id="t1525367253" t="ddeaguiar But I tend to use interceptors in these cases as opposed to handler functions"><y>#</y><d>2018-05-03</d><h>17:07</h><w>ddeaguiar</w>But I tend to use interceptors in these cases as opposed to handler functions</z><z id="t1525367292" t="tianshu what does servlet means here?"><y>#</y><d>2018-05-03</d><h>17:08</h><w>tianshu</w>what does <code>servlet</code> means here?</z><z id="t1525367308" t="tianshu use with some container like tomcat?"><y>#</y><d>2018-05-03</d><h>17:08</h><w>tianshu</w>use with some container like tomcat?</z><z id="t1525367321" t="ddeaguiar basically if you use jetty, tomcat or immutant to host your pedestal app"><y>#</y><d>2018-05-03</d><h>17:08</h><w>ddeaguiar</w>basically if you use jetty, tomcat or immutant to host your pedestal app</z><z id="t1525367371" t="ddeaguiar You don’t need to deploy your app as a war. You can start up a container to run it. Jetty is the popular choice and the default"><y>#</y><d>2018-05-03</d><h>17:09</h><w>ddeaguiar</w>You don’t need to deploy your app as a war. You can start up a container to run it. Jetty is the popular choice and the default</z><z id="t1525367408" t="tianshu (defn index [request] {:status 200 :body (go &quot;hello&quot;)}) (def routes (route/expand-routes #{[&quot;/index&quot; :get index :route-name :index]})) (def service-map (-&gt; {::http/routes routes ::http/type :immutant ::http/port 8890} http/default-interceptors http/dev-interceptors http/create-server)) (mount/defstate server :start (http/start service-map) :stop (http/stop server)) (comment (mount/start #&apos;server)) I just tried with this, but it failed. the error is Caused by: java.lang.IllegalArgumentException: No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: clojure.core.async.impl.channels.ManyToManyChannel"><y>#</y><d>2018-05-03</d><h>17:10</h><w>tianshu</w><pre>(defn index [request]
  {:status 200
   :body (go &quot;hello&quot;)})

(def routes
  (route/expand-routes
   #{[&quot;/index&quot; :get index :route-name :index]}))

(def service-map
  (-&gt; {::http/routes routes
       ::http/type :immutant
       ::http/port 8890}
      http/default-interceptors
      http/dev-interceptors
      http/create-server))

(mount/defstate server
  :start
  (http/start service-map)
  :stop
  (http/stop server))

(comment
  (mount/start #&apos;server))
</pre>
I just tried with this, but it failed. 
the error is 
<code>Caused by: java.lang.IllegalArgumentException: No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: clojure.core.async.impl.channels.ManyToManyChannel</code></z><z id="t1525367522" t="ddeaguiar Hmm, change :immutant to :jetty"><y>#</y><d>2018-05-03</d><h>17:12</h><w>ddeaguiar</w>Hmm, change <code>:immutant</code> to <code>:jetty</code></z><z id="t1525367557" t="tianshu let me have a try"><y>#</y><d>2018-05-03</d><h>17:12</h><w>tianshu</w>let me have a try</z><z id="t1525367565" t="ddeaguiar it should still fail"><y>#</y><d>2018-05-03</d><h>17:12</h><w>ddeaguiar</w>it should still fail</z><z id="t1525367949" t="tianshu yes, I can&apos;t start when use jetty"><y>#</y><d>2018-05-03</d><h>17:19</h><w>tianshu</w>yes, I can&apos;t start when use jetty</z><z id="t1525368022" t="tianshu very strange"><y>#</y><d>2018-05-03</d><h>17:20</h><w>tianshu</w>very strange</z><z id="t1525368252" t="ddeaguiar That’s strange. I expect immutant to use the same servlet code as jetty in this case"><y>#</y><d>2018-05-03</d><h>17:24</h><w>ddeaguiar</w>That’s strange. I expect immutant to use the same servlet code as jetty in this case</z><z id="t1525368460" t="ddeaguiar hrm, it works for me though"><y>#</y><d>2018-05-03</d><h>17:27</h><w>ddeaguiar</w>hrm, it works for me though</z><z id="t1525368551" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0NBGRGD6&quot;}] https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918"><y>#</y><d>2018-05-03</d><h>17:29</h><w>ddeaguiar</w><a>@doglooksgood</a> <a href="https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918" target="_blank">https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918</a></z><z id="t1525368559" t="ddeaguiar async response with immutant"><y>#</y><d>2018-05-03</d><h>17:29</h><w>ddeaguiar</w>async response with immutant</z><z id="t1525368740" t="tianshu thanks!"><y>#</y><d>2018-05-03</d><h>17:32</h><w>tianshu</w>thanks!</z><z id="t1525368749" t="ddeaguiar np!"><y>#</y><d>2018-05-03</d><h>17:32</h><w>ddeaguiar</w>np!</z><z id="t1525368808" t="tianshu I&apos;m afraid I can&apos;t find where is the key point?"><y>#</y><d>2018-05-03</d><h>17:33</h><w>tianshu</w>I&apos;m afraid I can&apos;t find where is the key point?</z><z id="t1525368973" t="ddeaguiar async handler: https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L15-L19"><y>#</y><d>2018-05-03</d><h>17:36</h><w>ddeaguiar</w>async handler: <a href="https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L15-L19" target="_blank">https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L15-L19</a></z><z id="t1525368989" t="ddeaguiar app served by immutant https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L74"><y>#</y><d>2018-05-03</d><h>17:36</h><w>ddeaguiar</w>app served by immutant <a href="https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L74" target="_blank">https://gist.github.com/ddeaguiar/9172555a94d75c749e4a059af6942918#file-gistfile1-txt-L74</a></z><z id="t1525369007" t="ddeaguiar that works for me"><y>#</y><d>2018-05-03</d><h>17:36</h><w>ddeaguiar</w>that works for me</z><z id="t1525369568" t="tianshu thank you very much"><y>#</y><d>2018-05-03</d><h>17:46</h><w>tianshu</w>thank you very much</z><z id="t1525369574" t="tianshu 👍"><y>#</y><d>2018-05-03</d><h>17:46</h><w>tianshu</w><b>👍</b></z><z id="t1525369727" t="ddeaguiar np!"><y>#</y><d>2018-05-03</d><h>17:48</h><w>ddeaguiar</w>np!</z><z id="t1525392730" t="frankitox Hello everyone! I hope somebody can give me a hint about this thought. I&apos;m thinking about using Pedestal in AWS Lambda, this is a service that allows you to execute arbitrary code but not as a daemon, so it should eventually end. I guess the approach should be to build the request map and execute all the interceptors (such as the router)?"><y>#</y><d>2018-05-04</d><h>00:12</h><w>frankitox</w>Hello everyone! I hope somebody can give me a hint about this thought. I&apos;m thinking about using Pedestal in AWS Lambda, this is a service that allows you to execute arbitrary code but not as a daemon, so it should eventually end. I guess the approach should be to build the request map and execute all the interceptors (such as the router)?</z><z id="t1525429333" t="bherrmann [:attrs {:href &quot;/_/_/users/U3UFFB420&quot;}] I’ve not used it but I heard about some pedestal and lambda stuff … https://github.com/pedestal/pedestal/tree/aws-lambda/lambda/src/io/pedestal/http"><y>#</y><d>2018-05-04</d><h>10:22</h><w>bherrmann</w><a>@franquito</a> I’ve not used it but I heard about some pedestal and lambda stuff … <a href="https://github.com/pedestal/pedestal/tree/aws-lambda/lambda/src/io/pedestal/http" target="_blank">https://github.com/pedestal/pedestal/tree/aws-lambda/lambda/src/io/pedestal/http</a></z><z id="t1525432755" t="frankitox Hey! I managed to do it, I can&apos;t believe I missed that branch while browsing the repo haha. I&apos;ll give it a look, thanks!"><y>#</y><d>2018-05-04</d><h>11:19</h><r>frankitox</r>Hey! I managed to do it, I can&apos;t believe I missed that branch while browsing the repo haha. I&apos;ll give it a look, thanks!</z><z id="t1525696845" t="ddeaguiar We’re working on releasing AWS Lambda support. That branch is a wip but Paul is not actively working on it atm. As of now it’s unclear when it’s going to be picked up again but it’s on the todo list!"><y>#</y><d>2018-05-07</d><h>12:40</h><r>ddeaguiar</r>We’re working on releasing AWS Lambda support. That branch is a wip but Paul is not actively working on it atm. As of now it’s unclear when it’s going to be picked up again but it’s on the todo list!</z><z id="t1526196536" t="vaedasynapse Does anyone here have experience with multipart param post handlers and dealing with processing such?"><y>#</y><d>2018-05-13</d><h>07:28</h><w>vaedasynapse</w>Does anyone here have experience with multipart param post handlers and dealing with processing such?</z><z id="t1526331286" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CLF10KG&quot;}] yes. What information are you looking for?"><y>#</y><d>2018-05-14</d><h>20:54</h><w>ddeaguiar</w><a>@vaedasynapse</a> yes. What information are you looking for?</z><z id="t1526331364" t="ddeaguiar Let’s start with http://pedestal.io/reference/parameters#_file_upload"><y>#</y><d>2018-05-14</d><h>20:56</h><w>ddeaguiar</w>Let’s start with <a href="http://pedestal.io/reference/parameters#_file_upload" target="_blank">http://pedestal.io/reference/parameters#_file_upload</a></z><z id="t1526331756" t="vaedasynapse I actually finally figured out what I was doing wrong. But thanks. It actually was nothing to do with pedestal, though I did find a repo on github that helped as well."><y>#</y><d>2018-05-14</d><h>21:02</h><w>vaedasynapse</w>I actually finally figured out what I was doing wrong. But thanks. It actually was nothing to do with pedestal, though I did find a repo on github that helped as well.</z><z id="t1526331789" t="ddeaguiar Ok, glad you were able to figure it out!"><y>#</y><d>2018-05-14</d><h>21:03</h><w>ddeaguiar</w>Ok, glad you were able to figure it out!</z><z id="t1526336155" t="vaedasynapse Me too :) Pedestal is pretty neat"><y>#</y><d>2018-05-14</d><h>22:15</h><w>vaedasynapse</w>Me too :) Pedestal is pretty neat</z><z id="t1526355602" t="souenzzo There is no test&apos;s for pedestal chains? test&apos;s are welcome?"><y>#</y><d>2018-05-15</d><h>03:40</h><w>souenzzo</w>There is no test&apos;s for pedestal chains? test&apos;s are welcome?</z><z id="t1526392388" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] their should be tests in the service project."><y>#</y><d>2018-05-15</d><h>13:53</h><w>ddeaguiar</w><a>@souenzzo</a> their should be tests in the service project.</z><z id="t1526401708" t="souenzzo I will try to port to cljs."><y>#</y><d>2018-05-15</d><h>16:28</h><w>souenzzo</w>I will try to port to cljs.</z><z id="t1526402421" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] that would be great. Check out this issue if you’ve not seen it https://github.com/pedestal/pedestal/issues/487"><y>#</y><d>2018-05-15</d><h>16:40</h><w>ddeaguiar</w><a>@souenzzo</a> that would be great. Check out this issue if you’ve not seen it <a href="https://github.com/pedestal/pedestal/issues/487" target="_blank">https://github.com/pedestal/pedestal/issues/487</a></z><z id="t1526404747" t="ikitommi would this be a good time to make the generic “interceptor spec” and make pedestal just (the reference) implementation of the spec? e.g. figure out non-pedestal specific names for everything (error, chain etc. keys)"><y>#</y><d>2018-05-15</d><h>17:19</h><w>ikitommi</w>would this be a good time to make the generic “interceptor spec” and make pedestal just (the reference) implementation of the spec? e.g. figure out non-pedestal specific names for everything (error, chain etc. keys)</z><z id="t1526411405" t="souenzzo I don&apos;t like to use spec at runtime, but yes, I think we instrument the functions"><y>#</y><d>2018-05-15</d><h>19:10</h><w>souenzzo</w>I don&apos;t like to use spec at runtime, but yes, I think we instrument the functions</z><z id="t1526455982" t="ikitommi oh, I should have more verbose. Didn’t mean clojure.spec , but a spesification, like the “ring spec”. to define what keys are in interceptors, how errors are managed etc. current interceptors have pedestal-specific keys for ::chain and ::errors . could be just :errors and :chain ?"><y>#</y><d>2018-05-16</d><h>07:33</h><w>ikitommi</w>oh, I should have more verbose. Didn’t mean <code>clojure.spec</code>, but a spesification, like the “ring spec”. to define what keys are in interceptors, how errors are managed etc. current interceptors have pedestal-specific keys for <code>::chain</code> and <code>::errors</code>. could be just <code>:errors</code> and <code>:chain</code>?</z><z id="t1527620409" t="souenzzo Hello. I&apos;m trying to enable HTTP2. I put ::http/container-options {:h2c? true} on my service, but when I use curl, I get HTTP1.1 101 + HTTP2 on response. Other servers &quot;from web&quot; with the same curl params responds just with HTTP2 . I&apos;m doing something wrong?"><y>#</y><d>2018-05-29</d><h>19:00</h><w>souenzzo</w>Hello. I&apos;m trying to enable HTTP2. I put <code>::http/container-options {:h2c? true}</code> on my service, but when I use curl, I get <code>HTTP1.1 101 + HTTP2</code> on response. Other servers &quot;from web&quot; with the same curl params responds just with <code>HTTP2</code>. I&apos;m doing something wrong?</z><z id="t1527620829" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Have you looked at these samples? https://github.com/pedestal/pedestal/tree/master/samples/http2 &amp; https://github.com/pedestal/pedestal/tree/master/samples/http2-conscrypt"><y>#</y><d>2018-05-29</d><h>19:07</h><w>ddeaguiar</w><a>@souenzzo</a> Have you looked at these samples? <a href="https://github.com/pedestal/pedestal/tree/master/samples/http2" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/http2</a> &amp; <a href="https://github.com/pedestal/pedestal/tree/master/samples/http2-conscrypt" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/http2-conscrypt</a></z><z id="t1527620862" t="ddeaguiar the first one seems out of date. I’ll try to update that when I’ve got time"><y>#</y><d>2018-05-29</d><h>19:07</h><w>ddeaguiar</w>the first one seems out of date. I’ll try to update that when I’ve got time</z><z id="t1527620866" t="ddeaguiar the later seems updated"><y>#</y><d>2018-05-29</d><h>19:07</h><w>ddeaguiar</w>the later seems updated</z><z id="t1527620909" t="souenzzo Yep. With just curl --http2 i get 101 + 2.0. with curl --http2 --http2-prior-knowledge I get just 2.0 I think that everything is ok. I will send to dev env and check if works with apache/browser."><y>#</y><d>2018-05-29</d><h>19:08</h><w>souenzzo</w>Yep. With just <code>curl --http2</code> i get 101 + 2.0. with <code>curl --http2 --http2-prior-knowledge</code> I get just <code>2.0</code>
I think that everything is ok. I will send to dev env and check if works with apache/browser.</z><z id="t1527621270" t="ddeaguiar ok"><y>#</y><d>2018-05-29</d><h>19:14</h><w>ddeaguiar</w>ok</z><z id="t1527695885" t="firstclassfunc so is vase still under active development?"><y>#</y><d>2018-05-30</d><h>15:58</h><w>firstclassfunc</w>so is <code>vase</code> still under active development?</z><z id="t1527698673" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0JEGHL8M&quot;}] yes. We’ve just not released an update in a while. Work is being done to get the next Pedestal release out the door. I anticipate we’ll be focusing on updating Vase after that"><y>#</y><d>2018-05-30</d><h>16:44</h><w>ddeaguiar</w><a>@firstclassfunc</a> yes. We’ve just not released an update in a while. Work is being done to get the next Pedestal release out the door. I anticipate we’ll be focusing on updating Vase after that</z><z id="t1527731835" t="hagmonk You guys added OpenTracing support! Now I don&apos;t have to do it myself! \o/"><y>#</y><d>2018-05-31</d><h>01:57</h><w>hagmonk</w>You guys added OpenTracing support! Now I don&apos;t have to do it myself! \o/</z><z id="t1527732194" t="hagmonk What? You added metrics support in there too? … get out of my head, Charles! I&apos;ve had half-baked versions of all these things floating around in work repos for a long time now"><y>#</y><d>2018-05-31</d><h>02:03</h><w>hagmonk</w>What? You added metrics support in there too? … get out of my head, Charles! I&apos;ve had half-baked versions of all these things floating around in work repos for a long time now</z><z id="t1527781275" t="martinklepsch I’m currently using Yada + Bidi for some project but am considering switching to pedestal for it’s simpler foundations. One reason I haven’t jumped yet is that I’d like to keep the possibility open of using the routes table in cljs. I assume this is not possible with Pedestal right? Is anyone here familiar with workarounds for this?"><y>#</y><d>2018-05-31</d><h>15:41</h><w>martinklepsch</w>I’m currently using Yada + Bidi for some project but am considering switching to pedestal for it’s simpler foundations. One reason I haven’t jumped yet is that I’d like to keep the possibility open of using the routes table in cljs. I assume this is not possible with Pedestal right? Is anyone here familiar with workarounds for this?</z><z id="t1527786021" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] , I think opening up cljs usage of routes would require cljs support for interceptors. The later is a high priority and something I’m keen to tackle next. I know you have been involved in the conversations around that issue ( https://github.com/pedestal/pedestal/issues/487 ). I’m sorry it’s taking so long to get to it."><y>#</y><d>2018-05-31</d><h>17:00</h><w>ddeaguiar</w><a>@martinklepsch</a>, I think opening up cljs usage of routes would require cljs support for interceptors. The later is a high priority and something I’m keen to tackle next. I know you have been involved in the conversations around that issue (<a href="https://github.com/pedestal/pedestal/issues/487" target="_blank">https://github.com/pedestal/pedestal/issues/487</a>). I’m sorry it’s taking so long to get to it.</z><z id="t1528112827" t="martinklepsch Actually what I’d be most interested in is building route strings from the pedestal routes table. Matching is less important. Looking at the output of expand-routes this should be possible one way or the other 🙂"><y>#</y><d>2018-06-04</d><h>11:47</h><r>martinklepsch</r>Actually what I’d be most interested in is building route strings from the pedestal routes table. Matching is less important. Looking at the output of <code>expand-routes</code> this should be possible one way or the other <b>🙂</b></z><z id="t1527865201" t="martinklepsch This guide suggests depending on .service and .route but in 0.5.3 .route is a transitive dep of .service: http://pedestal.io/guides/hello-world"><y>#</y><d>2018-06-01</d><h>15:00</h><w>martinklepsch</w>This guide suggests depending on .service and .route but in 0.5.3 .route is a transitive dep of .service: <a href="http://pedestal.io/guides/hello-world" target="_blank">http://pedestal.io/guides/hello-world</a></z><z id="t1527870459" t="martinklepsch is the route-name inserted into the context? could swear I saw it but now I can’t find it anymore"><y>#</y><d>2018-06-01</d><h>16:27</h><w>martinklepsch</w>is the <code>route-name</code> inserted into the context? could swear I saw it but now I can’t find it anymore</z><z id="t1527872366" t="martinklepsch And can the root exception handler be customized somehow? My context is getting pretty large and printing all of it makes the logs hard to read. Skimmed the http/server namespaces but nothing stood out…"><y>#</y><d>2018-06-01</d><h>16:59</h><w>martinklepsch</w>And can the root exception handler be customized somehow? My context is getting pretty large and printing all of it makes the logs hard to read. Skimmed the http/server namespaces but nothing stood out…</z><z id="t1527954005" t="jimmy [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] it should be in (get-in context [:route :route-name])"><y>#</y><d>2018-06-02</d><h>15:40</h><w>jimmy</w><a>@martinklepsch</a> it should be in
(get-in context [:route :route-name])</z><z id="t1527955858" t="ghaskins Is there any specific reason pedestal would not work from test context?"><y>#</y><d>2018-06-02</d><h>16:10</h><w>ghaskins</w>Is there any specific reason pedestal would not work from test context?</z><z id="t1527955879" t="ghaskins I am seeing something strange, im sure its me, but I cant see what it is"><y>#</y><d>2018-06-02</d><h>16:11</h><w>ghaskins</w>I am seeing something strange, im sure its me, but I cant see what it is</z><z id="t1527955973" t="ghaskins im trying to set up a mock chain-provider, but for reasons that escape me, any time I try to create the server, I get all kind of inexplicable valid-interceptor? assertions on core pedestal interceptors (e.g. log-request)"><y>#</y><d>2018-06-02</d><h>16:12</h><w>ghaskins</w>im trying to set up a mock chain-provider, but for reasons that escape me, any time I try to create the server, I get all kind of inexplicable valid-interceptor? assertions on core pedestal interceptors (e.g. log-request)</z><z id="t1527959222" t="ghaskins nevermind, i just discovered the io.pedestal.test ns, sorry for the noise"><y>#</y><d>2018-06-02</d><h>17:07</h><w>ghaskins</w>nevermind, i just discovered the io.pedestal.test ns, sorry for the noise</z><z id="t1527991758" t="ghaskins same problem even when doing io.pedestal.test type things"><y>#</y><d>2018-06-03</d><h>02:09</h><w>ghaskins</w>same problem even when doing io.pedestal.test type things</z><z id="t1528112769" t="martinklepsch Having some issues with io.pedestal.test : For some reason (pdt/response-for (service-fn s) :get &quot;/&quot;) returns 404 but using curl to load the page returns 200 + proper body (same server instance/port) — any ideas why that could be?"><y>#</y><d>2018-06-04</d><h>11:46</h><w>martinklepsch</w>Having some issues with <code>io.pedestal.test</code>: For some reason <code>(pdt/response-for (service-fn s) :get &quot;/&quot;)</code> returns 404 but using <code>curl</code> to load the page returns 200 + proper body (same server instance/port) — any ideas why that could be?</z><z id="t1528113137" t="martinklepsch Ok. Found the source of this: expand-routes takes this additional map with :host and :port keys. If I pass it I see the aforementioned issue. If it’s not passed everything works as expected."><y>#</y><d>2018-06-04</d><h>11:52</h><r>martinklepsch</r>Ok. Found the source of this: <code>expand-routes</code> takes this additional map with <code>:host</code> and  <code>:port</code> keys. If I pass it I see the aforementioned issue. If it’s not passed everything works as expected.</z><z id="t1528113290" t="martinklepsch Specifying the host and port as part of the URL does not seem to fix this"><y>#</y><d>2018-06-04</d><h>11:54</h><r>martinklepsch</r>Specifying the host and port as part of the URL does not seem to fix this</z><z id="t1528113872" t="martinklepsch (pdt/parse-url “localhost:8888/“) ;; {:scheme nil, :host “localhost:8888”, :path “”, :query-string nil} "><y>#</y><d>2018-06-04</d><h>12:04</h><r>martinklepsch</r><pre>(pdt/parse-url “localhost:8888/“)
;; {:scheme nil, :host “localhost:8888”, :path “”, :query-string nil}
</pre></z><z id="t1528113936" t="martinklepsch So the hostname in test-servlet-response includes the port if provided. And the port is always set to -1 : https://github.com/pedestal/pedestal/blob/6b2faef808c66573e1fde564017ab1dbde1018c8/service/src/io/pedestal/test.clj#L109-L110"><y>#</y><d>2018-06-04</d><h>12:05</h><r>martinklepsch</r>So the hostname in <code>test-servlet-response</code> includes the port if provided. And the port is always set to <code>-1</code>: <a href="https://github.com/pedestal/pedestal/blob/6b2faef808c66573e1fde564017ab1dbde1018c8/service/src/io/pedestal/test.clj#L109-L110" target="_blank">https://github.com/pedestal/pedestal/blob/6b2faef808c66573e1fde564017ab1dbde1018c8/service/src/io/pedestal/test.clj#L109-L110</a></z><z id="t1528114692" t="martinklepsch Patch 👇 https://gist.github.com/martinklepsch/9314308cfed88dcdd5a5429265df487d"><y>#</y><d>2018-06-04</d><h>12:18</h><r>martinklepsch</r>Patch <b>👇</b> <a href="https://gist.github.com/martinklepsch/9314308cfed88dcdd5a5429265df487d" target="_blank">https://gist.github.com/martinklepsch/9314308cfed88dcdd5a5429265df487d</a></z><z id="t1528114768" t="martinklepsch I don’t know if this should be added but it works. I’ll probably just not pass the {:host ,,, :port ,,, :scheme ,,,} map in testing environments"><y>#</y><d>2018-06-04</d><h>12:19</h><r>martinklepsch</r>I don’t know if this should be added but it works. I’ll probably just not pass the <code>{:host ,,, :port ,,, :scheme ,,,}</code> map in testing environments</z><z id="t1528115070" t="martinklepsch (because otherwise I’d also have to specify host/port for test requests and I don’t want to bother for now)"><y>#</y><d>2018-06-04</d><h>12:24</h><r>martinklepsch</r>(because otherwise I’d also have to specify host/port for test requests and I don’t want to bother for now)</z><z id="t1528121288" t="martinklepsch Opened an issue here: https://github.com/pedestal/pedestal/issues/570 included a link to a patch but not sure if it’s the right thing to do."><y>#</y><d>2018-06-04</d><h>14:08</h><r>martinklepsch</r>Opened an issue here: <a href="https://github.com/pedestal/pedestal/issues/570" target="_blank">https://github.com/pedestal/pedestal/issues/570</a> included a link to a patch but not sure if it’s the right thing to do.</z><z id="t1528113098" t="souenzzo [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] reload &quot;all&quot; your namespaces"><y>#</y><d>2018-06-04</d><h>11:51</h><w>souenzzo</w><a>@martinklepsch</a> reload &quot;all&quot; your namespaces</z><z id="t1528118760" t="martinklepsch Another thing I stumbled upon: The default terminator is ring-response/response which checks for a :status key and a :headers key. Is there a particular reason setting headers is required for termination?"><y>#</y><d>2018-06-04</d><h>13:26</h><w>martinklepsch</w>Another thing I stumbled upon: The default terminator is <code>ring-response/response</code> which checks for a <code>:status</code> key and a <code>:headers</code> key. Is there a particular reason setting headers is required for termination?</z><z id="t1528121288" t="martinklepsch Opened an issue here: https://github.com/pedestal/pedestal/issues/570 included a link to a patch but not sure if it’s the right thing to do."><y>#</y><d>2018-06-04</d><h>14:08</h><w>martinklepsch</w>Opened an issue here: <a href="https://github.com/pedestal/pedestal/issues/570" target="_blank">https://github.com/pedestal/pedestal/issues/570</a> included a link to a patch but not sure if it’s the right thing to do.</z><z id="t1528123120" t="martinklepsch Is it intended that url-for doesn’t throw if the supplied params are lacking some? (url-for :artifact/version :path-params {:group-id “x”}) ; “/d/x/:artifact-id/:version” "><y>#</y><d>2018-06-04</d><h>14:38</h><w>martinklepsch</w>Is it intended that <code>url-for</code> doesn’t throw if the supplied params are lacking some?
<pre>(url-for :artifact/version :path-params {:group-id “x”})
; “/d/x/:artifact-id/:version”
</pre></z><z id="t1528125119" t="martinklepsch I’m not sure in what situation you’d want this behavior. Very confused that this is the default."><y>#</y><d>2018-06-04</d><h>15:11</h><r>martinklepsch</r>I’m not sure in what situation you’d want this behavior. Very confused that this is the default.</z><z id="t1528296121" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Do you know if this is intentional? Do you think a PR to either be strict by default or at least make that configurable would be welome?"><y>#</y><d>2018-06-06</d><h>14:42</h><r>martinklepsch</r><a>@U0FL657GR</a> Do you know if this is intentional? Do you think a PR to either be strict by default or at least make that configurable would be welome?</z><z id="t1528301541" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I can’t say if that’s intentional or not but I can’t see why we’d want that. Can you open an issue? I’d wait for further feedback before opening a PR. In general, when there are doubts I’d recommend opening an issue before starting a PR."><y>#</y><d>2018-06-06</d><h>16:12</h><r>ddeaguiar</r><a>@martinklepsch</a> I can’t say if that’s intentional or not but I can’t see why we’d want that. Can you open an issue? I’d wait for further feedback before opening a PR. In general, when there are doubts I’d recommend opening an issue before starting a PR.</z><z id="t1528301868" t="ddeaguiar Actually"><y>#</y><d>2018-06-06</d><h>16:17</h><r>ddeaguiar</r>Actually</z><z id="t1528301877" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I bet this is by design"><y>#</y><d>2018-06-06</d><h>16:17</h><r>ddeaguiar</r><a>@martinklepsch</a> I bet this is by design</z><z id="t1528301891" t="ddeaguiar pretty sure this is the code https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L252"><y>#</y><d>2018-06-06</d><h>16:18</h><r>ddeaguiar</r>pretty sure this is the code <a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L252" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L252</a></z><z id="t1528301926" t="ddeaguiar and : is a valid character in a path segment (refer to https://tools.ietf.org/html/rfc3986#section-3.3 )"><y>#</y><d>2018-06-06</d><h>16:18</h><r>ddeaguiar</r>and <code>:</code> is a valid character in a path segment (refer to <a href="https://tools.ietf.org/html/rfc3986#section-3.3" target="_blank">https://tools.ietf.org/html/rfc3986#section-3.3</a>)</z><z id="t1528301952" t="ddeaguiar so there’s no way for Pedestal to know if that is a param or part of the path segment"><y>#</y><d>2018-06-06</d><h>16:19</h><r>ddeaguiar</r>so there’s no way for Pedestal to know if that is a param or part of the path segment</z><z id="t1528302364" t="martinklepsch but path-params are passed as a map so there is a way to tell if a given param has been supplied or not."><y>#</y><d>2018-06-06</d><h>16:26</h><r>martinklepsch</r>but path-params are passed as a map so there is a way to tell if a given param has been supplied or not.</z><z id="t1528302507" t="martinklepsch you can pass a value with a colon and it will be regarded as a path param."><y>#</y><d>2018-06-06</d><h>16:28</h><r>martinklepsch</r>you can pass a value with a colon and it will be regarded as a path param.</z><z id="t1528302526" t="martinklepsch What’s done now is just using the key as the value which just seems wrong to me :thinking_face:"><y>#</y><d>2018-06-06</d><h>16:28</h><r>martinklepsch</r>What’s done now is just using the key as the value which just seems wrong to me <b>:thinking_face:</b></z><z id="t1528302569" t="martinklepsch and yes that code you found is the right one, the (get path-params % %) being the culprit of the whole thing"><y>#</y><d>2018-06-06</d><h>16:29</h><r>martinklepsch</r>and yes that code you found is the right one, the <code>(get path-params % %)</code> being the culprit of the whole thing</z><z id="t1528302855" t="martinklepsch consider this: ((route/url-for-routes (route/expand-routes #{[&quot;/thing/:id&quot; :get nop :route-name :thing :constraints {:id #&quot;[0-9]+&quot;} ]})) :thing :path-params {:foo :bar}) the constraint says digits only but since it’s just using (str :id) it returns a url as if everything worked as intended"><y>#</y><d>2018-06-06</d><h>16:34</h><r>martinklepsch</r>consider this:
<pre>((route/url-for-routes (route/expand-routes #{[&quot;/thing/:id&quot; :get nop :route-name :thing :constraints {:id #&quot;[0-9]+&quot;} ]}))
   :thing :path-params {:foo :bar})
</pre>
the constraint says digits only but since it’s just using <code>(str :id)</code> it returns a url as if everything worked as intended</z><z id="t1528326831" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] while using the key as a value may seem wrong to you it’s consistent with what’s contained in the :path-params collection once the route is expanded. Your example does contain additional information which could be used by Pedestal to infer that :id is a path param and is numeric. This information could be used during url generation to let the user know information was missing. Outside of such information I think the current implementation makes a reasonable compromise. I think you should open an issue so that we can solicit additional feedback."><y>#</y><d>2018-06-06</d><h>23:13</h><r>ddeaguiar</r><a>@martinklepsch</a> while using the key as a value may seem wrong to you it’s consistent with what’s contained in the <code>:path-params</code> collection once the route is expanded. Your example does contain additional information which could be used by Pedestal to infer that <code>:id</code> is a path param and is numeric. This information could be used during url generation to let the user know information was missing. Outside of such information I think the current implementation makes a reasonable compromise.

I think you should open an issue so that we can solicit additional feedback.</z><z id="t1528358115" t="martinklepsch Opened an issue: https://github.com/pedestal/pedestal/issues/572"><y>#</y><d>2018-06-07</d><h>07:55</h><r>martinklepsch</r>Opened an issue: <a href="https://github.com/pedestal/pedestal/issues/572" target="_blank">https://github.com/pedestal/pedestal/issues/572</a></z><z id="t1528377812" t="ddeaguiar :thumbsup:"><y>#</y><d>2018-06-07</d><h>13:23</h><r>ddeaguiar</r><b>:thumbsup:</b></z><z id="t1528123189" t="willier Hi, the documentation for request-map ( http://pedestal.io/reference/request-map ) says that :params is “Always Present”"><y>#</y><d>2018-06-04</d><h>14:39</h><w>willier</w>Hi, the documentation for request-map (<a href="http://pedestal.io/reference/request-map" target="_blank">http://pedestal.io/reference/request-map</a>) says that :params is “Always Present”</z><z id="t1528123215" t="willier However, (:params request) returns nil"><y>#</y><d>2018-06-04</d><h>14:40</h><w>willier</w>However, <code>(:params request)</code> returns nil</z><z id="t1528123310" t="willier I am using the body-params interceptor and passing application/json and can see (:json-params request) just fine"><y>#</y><d>2018-06-04</d><h>14:41</h><w>willier</w>I am using the <code>body-params</code> interceptor and passing <code>application/json</code> and can see <code>(:json-params request)</code> just fine</z><z id="t1528123396" t="willier How can I work with params in a content-type agnostic way?"><y>#</y><d>2018-06-04</d><h>14:43</h><w>willier</w>How can I work with params in a content-type agnostic way?</z><z id="t1528123659" t="martinklepsch I’m not sure I fully understand the docs for :params but if you want to work with params in content type agnostic way you have a few options: 1) define a simple get-params function that gets all parameter maps you care about and merges them 2) define an interceptor that does the same and stores the result somewhere in the context"><y>#</y><d>2018-06-04</d><h>14:47</h><r>martinklepsch</r>I’m not sure I fully understand the docs for <code>:params</code> but if you want to work with params in content type agnostic way you have a few options:

1) define a simple <code>get-params</code> function that gets all parameter maps you care about and merges them
2) define an interceptor that does the same and stores the result somewhere in the context</z><z id="t1528123829" t="willier yea i was hoping that the :params key would provide 1)"><y>#</y><d>2018-06-04</d><h>14:50</h><r>willier</r>yea i was hoping that the <code>:params</code> key would provide 1)</z><z id="t1528123883" t="willier Merged map of path, query, and request parameters. seems to suggest so"><y>#</y><d>2018-06-04</d><h>14:51</h><r>willier</r><pre>Merged map of path, query, and request parameters.</pre> seems to suggest so</z><z id="t1528124018" t="martinklepsch Yeah, understand your confusion, the docs could use some love there I guess"><y>#</y><d>2018-06-04</d><h>14:53</h><r>martinklepsch</r>Yeah, understand your confusion, the docs could use some love there I guess</z><z id="t1528124165" t="willier i will play around with it a bit more and hopefully not have to resort to writing my own function…"><y>#</y><d>2018-06-04</d><h>14:56</h><r>willier</r>i will play around with it a bit more and hopefully not have to resort to writing my own function…</z><z id="t1528124188" t="willier thanks"><y>#</y><d>2018-06-04</d><h>14:56</h><r>willier</r>thanks</z><z id="t1528124440" t="martinklepsch writing your own function shouldn’t be so bad 🙂"><y>#</y><d>2018-06-04</d><h>15:00</h><r>martinklepsch</r>writing your own function shouldn’t be so bad <b>🙂</b></z><z id="t1528140720" t="martinklepsch Was a little bit bugged by coupling my routes to the server namespace as that quickly led to cyclic deps. Ended up with this, which I’m liking so far: https://github.com/martinklepsch/cljdoc/commit/089b5fc20065607327b36d2dc570ee4702bb90a3#diff-2b617a32cb2ee893338f526bde351be6 🙂"><y>#</y><d>2018-06-04</d><h>19:32</h><w>martinklepsch</w>Was a little bit bugged by coupling my routes to the server namespace as that quickly led to cyclic deps. Ended up with this, which I’m liking so far: <a href="https://github.com/martinklepsch/cljdoc/commit/089b5fc20065607327b36d2dc570ee4702bb90a3#diff-2b617a32cb2ee893338f526bde351be6" target="_blank">https://github.com/martinklepsch/cljdoc/commit/089b5fc20065607327b36d2dc570ee4702bb90a3#diff-2b617a32cb2ee893338f526bde351be6</a> <b>🙂</b></z><z id="t1528197248" t="vemv Hi! I can connect emacs to an external lein repl session, enjoy the &apos;reloaded workflow&apos; and see my API working. however if I opt to launch my Pedestal project within emacs, API requests will hang forever, logging some strange messages as well (see by the middle and bottom): https://gist.githubusercontent.com/vemv/446393f15ea4ae472ed47d6536ba3145/raw/b3592a82a531a3336565c7478d7e1b962d3d39b4/gistfile1.txt Does it sound familiar?"><y>#</y><d>2018-06-05</d><h>11:14</h><w>vemv</w>Hi!

I can connect emacs to an external <code>lein repl</code> session, enjoy the &apos;reloaded workflow&apos; and see my API working.

however if I opt to launch my Pedestal project within emacs, API requests will hang forever, logging some strange messages as well (see by the middle and bottom):

<a href="https://gist.githubusercontent.com/vemv/446393f15ea4ae472ed47d6536ba3145/raw/b3592a82a531a3336565c7478d7e1b962d3d39b4/gistfile1.txt" target="_blank">https://gist.githubusercontent.com/vemv/446393f15ea4ae472ed47d6536ba3145/raw/b3592a82a531a3336565c7478d7e1b962d3d39b4/gistfile1.txt</a>

Does it sound familiar?</z><z id="t1528197773" t="vemv also strange that logging is so verbose if running from emacs. If running terminal, my logback.xml is honored"><y>#</y><d>2018-06-05</d><h>11:22</h><r>vemv</r>also strange that logging is so verbose if running from emacs. If running terminal, my logback.xml is honored</z><z id="t1528212163" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U45T93RA6&quot;}] I don’t experience that"><y>#</y><d>2018-06-05</d><h>15:22</h><r>ddeaguiar</r><a>@U45T93RA6</a> I don’t experience that</z><z id="t1528212216" t="vemv Thanks for the input, yeah I guess that something is off."><y>#</y><d>2018-06-05</d><h>15:23</h><r>vemv</r>Thanks for the input, yeah I guess that something is off.</z><z id="t1528284197" t="vemv My issue was that [com.fzakaria/slf4j-timbre &quot;0.3.4&quot;] (a transitive dependency) was not only hijacking the logger, but also breaking http for some reason. Cannot reproduce in a clean project sadly."><y>#</y><d>2018-06-06</d><h>11:23</h><r>vemv</r>My issue was that <code>[com.fzakaria/slf4j-timbre &quot;0.3.4&quot;]</code> (a transitive dependency) was not only hijacking the logger, but also breaking http for some reason. Cannot reproduce in a clean project sadly.</z><z id="t1528293872" t="ddeaguiar Ah good to know. Glad you find it."><y>#</y><d>2018-06-06</d><h>14:04</h><r>ddeaguiar</r>Ah good to know. Glad you find it.</z><z id="t1528292748" t="souenzzo about jetty / ws example https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61 When the server receives a on-close , how it know the &quot;origin&quot; of this message (to remove it from ws-clients atom)????"><y>#</y><d>2018-06-06</d><h>13:45</h><w>souenzzo</w>about <code>jetty</code> / <code>ws</code> example
<a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61</a>
When the server receives a <code>on-close</code>, how it know the &quot;origin&quot; of this message (to remove it from <code>ws-clients</code> atom)????</z><z id="t1528292939" t="souenzzo I think that in there https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L68 Should be (f this status-code reason)"><y>#</y><d>2018-06-06</d><h>13:48</h><w>souenzzo</w>I think that in there
<a href="https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L68" target="_blank">https://github.com/pedestal/pedestal/blob/3a3c1a27235b8aac16538fc411f360b92af1f524/jetty/src/io/pedestal/http/jetty/websockets.clj#L68</a>
Should be <code>(f this status-code reason)</code></z><z id="t1528302554" t="dadair [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] You basically need to close over your own machinery, [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] has a good example in his lacinia-pedestal project that I was able to emulate for my own project, see here https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L414"><y>#</y><d>2018-06-06</d><h>16:29</h><w>dadair</w><a>@souenzzo</a> You basically need to close over your own machinery, <a>@hlship</a> has a good example in his lacinia-pedestal project that I was able to emulate for my own project, see here <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L414" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal/subscriptions.clj#L414</a></z><z id="t1528303002" t="dadair Here’s an example from my own project: (defn socket-listener &quot;Core listening function for websocket connections/requests.&quot; [logger idle-timeout auth raw-input-queue sockets {:keys [pub!]}] (fn [req resp _] (let [[claims jwt-token] (user/authenticated? req auth) socket-id (transport/new-socket-id) socket-in-ch (async/chan) socket-out-ch (async/chan 10) socket-kill-ch (async/chan) skt (transport/make-socket socket-id (user/parse-claims claims) socket-out-ch jwt-token) on-connect (fn [session send-ch] (let [remote-addr (.getRemoteAddress ^WebSocketSession session) extra-time 60 timeout-ms (utils/s-&gt;ms (+ idle-timeout extra-time))] (logger/log logger :report ::connect {:remote remote-addr}) (.setIdleTimeout ^WebSocketSession session timeout-ms)) (sockets/socket-sender socket-out-ch send-ch socket-kill-ch) (sockets/socket-receiver socket-in-ch socket-out-ch raw-input-queue socket-kill-ch send-ch {:idle-timeout idle-timeout :socket-id socket-id}) (if claims (let [system-topic (transport/make-topic &quot;bypass/system&quot; {})] (swap! sockets sockets/register-socket skt [system-topic])) (do (async/put! socket-out-ch (transport/envelope-unauthorized)) (async/&lt;!! (async/timeout 1000)) (async/close! send-ch))))] (ws/make-ws-listener {:on-connect (ws/start-ws-connection on-connect) :on-text (fn [raw] (logger/log logger :info ::received {:message raw}) (async/put! socket-in-ch [raw socket-id])) :on-error (fn [cause] (logger/log logger :warn ::error {:cause cause})) :on-close (fn [code reason] (logger/log logger :report ::closed {:code code :reason reason}) (let [topics (get-in @sockets [:socket-id-&gt;topics (:id skt)])] (swap! sockets sockets/unregister-socket skt) (async/put! socket-kill-ch :kill) (run! async/close! [socket-kill-ch socket-in-ch socket-out-ch]) (pub! (socket-closed-evt skt topics))))})))) "><y>#</y><d>2018-06-06</d><h>16:36</h><w>dadair</w>Here’s an example from my own project:
<pre>(defn socket-listener
  &quot;Core listening function for websocket connections/requests.&quot;
  [logger idle-timeout auth raw-input-queue sockets {:keys [pub!]}]
  (fn [req resp _]
    (let [[claims jwt-token] (user/authenticated? req auth)
          socket-id (transport/new-socket-id)
          socket-in-ch (async/chan)
          socket-out-ch (async/chan 10)
          socket-kill-ch (async/chan)
          skt (transport/make-socket
               socket-id
               (user/parse-claims claims)
               socket-out-ch
               jwt-token)
          on-connect (fn [session send-ch]
                       (let [remote-addr (.getRemoteAddress ^WebSocketSession session)
                             extra-time 60
                             timeout-ms (utils/s-&gt;ms (+ idle-timeout extra-time))]
                         (logger/log logger :report ::connect {:remote remote-addr})
                         (.setIdleTimeout ^WebSocketSession session timeout-ms))
                       (sockets/socket-sender socket-out-ch send-ch socket-kill-ch)
                       (sockets/socket-receiver socket-in-ch
                                                socket-out-ch
                                                raw-input-queue
                                                socket-kill-ch
                                                send-ch
                                                {:idle-timeout idle-timeout
                                                 :socket-id socket-id})
                       (if claims
                         (let [system-topic (transport/make-topic &quot;bypass/system&quot; {})]
                           (swap! sockets sockets/register-socket skt [system-topic]))
                         (do
                           (async/put! socket-out-ch (transport/envelope-unauthorized))
                           (async/&lt;!! (async/timeout 1000))
                           (async/close! send-ch))))]
      (ws/make-ws-listener
       {:on-connect (ws/start-ws-connection on-connect)
        :on-text (fn [raw]
                   (logger/log logger :info ::received {:message raw})
                   (async/put! socket-in-ch [raw socket-id]))
        :on-error (fn [cause]
                    (logger/log logger :warn ::error {:cause cause}))
        :on-close (fn [code reason]
                    (logger/log logger :report ::closed {:code code :reason reason})
                    (let [topics (get-in @sockets [:socket-id-&gt;topics (:id skt)])]
                      (swap! sockets sockets/unregister-socket skt)
                      (async/put! socket-kill-ch :kill)
                      (run! async/close! [socket-kill-ch socket-in-ch socket-out-ch])
                      (pub! (socket-closed-evt skt topics))))}))))
</pre></z><z id="t1528403038" t="hagmonk are there any plans for a pedestal deps.edn file so I can consume the current work-in-progress stuff? Should I file an issue?"><y>#</y><d>2018-06-07</d><h>20:23</h><w>hagmonk</w>are there any plans for a pedestal <code>deps.edn</code> file so I can consume the current work-in-progress stuff? Should I file an issue?</z><z id="t1528406883" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0R92J961&quot;}] IMO yes but I’ve not talked to Paul or Mike about this. I think you should file an issue in order to broadcast the desire."><y>#</y><d>2018-06-07</d><h>21:28</h><w>ddeaguiar</w><a>@hagmonk</a> IMO yes but I’ve not talked to Paul or Mike about this. I think you should file an issue in order to broadcast the desire.</z><z id="t1528406974" t="ddeaguiar It will also be required to build interceptor chain provider for Datomic Ions"><y>#</y><d>2018-06-07</d><h>21:29</h><w>ddeaguiar</w>It will also be required to build interceptor chain provider for Datomic Ions</z><z id="t1528407014" t="ddeaguiar I’ve spiked that work but need to flesh it out further before creating a pr"><y>#</y><d>2018-06-07</d><h>21:30</h><w>ddeaguiar</w>I’ve spiked that work but need to flesh it out further before creating a pr</z><z id="t1528433997" t="Joe Lane I’m incredibly stoked for the potential of vase + ions. I’ve tried (multiple times if I’m being honest) to get vase + datomic cloud to work before, but to no avail. Is there any discussion happening about combining vase + ions?"><y>#</y><d>2018-06-08</d><h>04:59</h><w>Joe Lane</w>I’m incredibly stoked for the potential of vase + ions. I’ve tried (multiple times if I’m being honest) to get vase + datomic cloud to work before, but to no avail. Is there any discussion happening about combining vase + ions?</z><z id="t1528463145" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] nothing concrete but I’m sure it will happen. I’ll keep folks posted here once I have more information."><y>#</y><d>2018-06-08</d><h>13:05</h><w>ddeaguiar</w><a>@lanejo01</a> nothing concrete but I’m sure it will happen. I’ll keep folks posted here once I have more information.</z><z id="t1528485926" t="twashing Does anyone know how to turn off the Content-Security-Policy header?"><y>#</y><d>2018-06-08</d><h>19:25</h><w>twashing</w>Does anyone know how to turn off the <code>Content-Security-Policy</code> header?</z><z id="t1528485978" t="twashing Interceptors I took from an example are io.pedestal.http.body-params/body-params and io.pedestal.http/html-body ."><y>#</y><d>2018-06-08</d><h>19:26</h><w>twashing</w>Interceptors I took from an example are <code>io.pedestal.http.body-params/body-params</code> and <code>io.pedestal.http/html-body</code>.</z><z id="t1528486018" t="twashing But my response header still includes Content-Security-Policy: object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:; ."><y>#</y><d>2018-06-08</d><h>19:26</h><w>twashing</w>But my response header still includes <code>Content-Security-Policy: object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:;</code>.</z><z id="t1528486609" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0TU2M47R&quot;}] you can pass ::http/secure-headers {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}} or similar in the service map"><y>#</y><d>2018-06-08</d><h>19:36</h><w>martinklepsch</w><a>@twashing</a> you can pass <code>::http/secure-headers {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}}</code> or similar in the service map</z><z id="t1528486822" t="twashing Hmm, that doesn’t quite work. But I think it’s close… Now I can’t find any reference in the docs. http://pedestal.io/reference/index#_securing_a_pedestal_application"><y>#</y><d>2018-06-08</d><h>19:40</h><w>twashing</w>Hmm, that doesn’t quite work. But I think it’s close… Now I can’t find any reference in the docs.
<a href="http://pedestal.io/reference/index#_securing_a_pedestal_application" target="_blank">http://pedestal.io/reference/index#_securing_a_pedestal_application</a></z><z id="t1528486836" t="twashing Did you just dig through the code?"><y>#</y><d>2018-06-08</d><h>19:40</h><w>twashing</w>Did you just dig through the code?</z><z id="t1528486853" t="twashing [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] Thanks btw :)"><y>#</y><d>2018-06-08</d><h>19:40</h><w>twashing</w><a>@martinklepsch</a> Thanks btw :)</z><z id="t1528486883" t="martinklepsch some of it is documented here: http://pedestal.io/reference/service-map"><y>#</y><d>2018-06-08</d><h>19:41</h><w>martinklepsch</w>some of it is documented here: <a href="http://pedestal.io/reference/service-map" target="_blank">http://pedestal.io/reference/service-map</a></z><z id="t1528486897" t="martinklepsch Some other I dug out of this mailing list thread: https://groups.google.com/forum/#!topic/pedestal-users/caRnQyUOHWA"><y>#</y><d>2018-06-08</d><h>19:41</h><w>martinklepsch</w>Some other I dug out of this mailing list thread: <a href="https://groups.google.com/forum/#!topic/pedestal-users/caRnQyUOHWA" target="_blank">https://groups.google.com/forum/#!topic/pedestal-users/caRnQyUOHWA</a></z><z id="t1528486916" t="twashing Ah ha"><y>#</y><d>2018-06-08</d><h>19:41</h><w>twashing</w>Ah ha</z><z id="t1528487362" t="twashing [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] Did the trick. Thanks mate!"><y>#</y><d>2018-06-08</d><h>19:49</h><w>twashing</w><a>@martinklepsch</a> Did the trick. Thanks mate!</z><z id="t1528487395" t="martinklepsch np 🙂"><y>#</y><d>2018-06-08</d><h>19:49</h><w>martinklepsch</w>np <b>🙂</b></z><z id="t1528565266" t="ikitommi could someone explain the :bindings in the context map? what is the use case for them?"><y>#</y><d>2018-06-09</d><h>17:27</h><w>ikitommi</w>could someone explain the <code>:bindings</code> in the context map? what is the use case for them?</z><z id="t1528565274" t="ikitommi &gt; As accepted by clojure.core/with-bindings. Prior to delegating execution to any interceptor, the interceptor framework will ensure that the bindings specified in this map are installed using clojure.core/with-bindings. If this map is altered and included in the returned context from an interceptor, the new bindings in the map will be installed as thread local bindings prior to another interceptor’s execution."><y>#</y><d>2018-06-09</d><h>17:27</h><w>ikitommi</w>&gt; As accepted by clojure.core/with-bindings. Prior to delegating execution to any interceptor, the interceptor framework will ensure that the bindings specified in this map are installed using clojure.core/with-bindings. If this map is altered and included in the returned context from an interceptor, the new bindings in the map will be installed as thread local bindings prior to another interceptor’s execution.</z><z id="t1528566802" t="souenzzo if you do (bindings [db (get-db)] (run-query)) then you can create a chain like [interceptor-get-db handler-run-query]"><y>#</y><d>2018-06-09</d><h>17:53</h><w>souenzzo</w>if you do <code>(bindings [db (get-db)] (run-query))</code> then you can create a chain like <code>[interceptor-get-db handler-run-query]</code></z><z id="t1528570260" t="ikitommi thanks. Is there a case where that is better/recommended over to just assoccing in the db-con into context and thus making the binding explicit? Thread locals are really slow both to read &amp; write."><y>#</y><d>2018-06-09</d><h>18:51</h><w>ikitommi</w>thanks. Is there a case where that is better/recommended over to just assoccing in the db-con into context and thus making the binding explicit? Thread locals are really slow both to read &amp; write.</z><z id="t1528666540" t="twashing Is there an example of Pedestal websockets with transit? https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets"><y>#</y><d>2018-06-10</d><h>21:35</h><w>twashing</w>Is there an example of Pedestal websockets with transit? 
<a href="https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/jetty-web-sockets</a></z><z id="t1528666557" t="twashing The out-of-the-box one, only accepts Strings and ByteBuffers. https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L19"><y>#</y><d>2018-06-10</d><h>21:35</h><w>twashing</w>The out-of-the-box one, only accepts Strings and ByteBuffers.
<a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L19" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L19</a></z><z id="t1528675157" t="twashing ^^^ All good. I just stiched something together with https://github.com/cognitect/transit-clj ."><y>#</y><d>2018-06-10</d><h>23:59</h><w>twashing</w>^^^ All good. I just stiched something together with <a href="https://github.com/cognitect/transit-clj" target="_blank">https://github.com/cognitect/transit-clj</a> .</z><z id="t1528959396" t="mkvlr does anybody have a recommendation for logging requests using pedestal? Should we do that through jetty or pedestal with log-request ? With rails we’ve used and liked https://github.com/roidrage/lograge"><y>#</y><d>2018-06-14</d><h>06:56</h><w>mkvlr</w>does anybody have a recommendation for logging requests using pedestal? Should we do that through jetty or pedestal with <code>log-request</code>? With rails we’ve used and liked <a href="https://github.com/roidrage/lograge" target="_blank">https://github.com/roidrage/lograge</a></z><z id="t1529069538" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] if you are not setting :io.pedestal.http/interceptors in your app’s service map, you will by default use log-request for request logging. This is set when default-interceptors is called during service startup (see here https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206 ). You also have the opportunity to override the request logger."><y>#</y><d>2018-06-15</d><h>13:32</h><w>ddeaguiar</w><a>@mkvlr</a> if you are not setting <code>:io.pedestal.http/interceptors</code> in your app’s service map, you will by default use <code>log-request</code> for request logging. This is set when <code>default-interceptors</code> is called during service startup (see here <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206</a>). You also have the opportunity to override the request logger.</z><z id="t1529074703" t="mkvlr [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yep, so far we’re using that but it doesn’t log request time, ip etc."><y>#</y><d>2018-06-15</d><h>14:58</h><w>mkvlr</w><a>@ddeaguiar</a> yep, so far we’re using that but it doesn’t log request time, ip etc.</z><z id="t1529074859" t="mkvlr might be nice to have that included by default"><y>#</y><d>2018-06-15</d><h>15:00</h><w>mkvlr</w>might be nice to have that included by default</z><z id="t1529075118" t="ddeaguiar I was going to suggest opening an issue for this request but I think you should bring it up on the Pedestal user group first. Can you do that? Paul monitors that channel and he should chime in there."><y>#</y><d>2018-06-15</d><h>15:05</h><w>ddeaguiar</w>I was going to suggest opening an issue for this request but I think you should bring it up on the Pedestal user group first. Can you do that? Paul monitors that channel and he should chime in there.</z><z id="t1529075167" t="mkvlr sure, will do. Thanks and have a good weekend!"><y>#</y><d>2018-06-15</d><h>15:06</h><w>mkvlr</w>sure, will do. Thanks and have a good weekend!</z><z id="t1529075418" t="ddeaguiar you too!"><y>#</y><d>2018-06-15</d><h>15:10</h><w>ddeaguiar</w>you too!</z><z id="t1529626563" t="hlship I kind of remember seeing an issue that an async interceptor that adds a :response to the context doesn&apos;t trigger the leave state; I&apos;m seeing this, where interceptor #1 adds a valid :response key to the context inside a go block, and interceptor #2 still executes normally (causing big problems for my app)."><y>#</y><d>2018-06-22</d><h>00:16</h><w>hlship</w>I kind of remember seeing an issue that an async interceptor that adds a :response to the context doesn&apos;t trigger the <code>leave</code> state; I&apos;m seeing this, where interceptor #1 adds a valid :response key to the context inside a go block, and interceptor #2 still executes normally (causing big problems for my app).</z><z id="t1529626721" t="hlship I&apos;ve added more logging, and in the enter of my second interceptor: :parse-query :response {:status 400, :headers {}, :body {:errors [{:message &quot;Stored query not found.&quot;}]}} So my first interceptor is terminating correctly, by adding a valid :response key, but my second interceptor is still executing."><y>#</y><d>2018-06-22</d><h>00:18</h><w>hlship</w>I&apos;ve added more logging, and in the <code>enter</code> of my second interceptor:

<pre>:parse-query :response {:status 400, :headers {}, :body {:errors [{:message &quot;Stored query not found.&quot;}]}}
</pre>

So my first interceptor is terminating correctly, by adding a valid :response key, but my second interceptor is still executing.</z><z id="t1529626864" t="hlship With more logging: 05.558 DEBUG io.pedestal.interceptor.chain - {:interceptor :com.walmartlabs.lacinia.pedestal/query-source, :stage :enter, :execution-id 11, :fn #object[com.walmartlabs.lacinia.pedestal$pass_query_through_query_source$fn__26193 0x3fff323d &quot;com.walmartlabs.lacinia.pedestal$pass_query_through_query_source$fn__26193@3fff323d&quot;], :line 50} :store-result #object[clojure.core.async.impl.channels.ManyToManyChannel 0x6778b666 &quot;clojure.core.async.impl.channels.ManyToManyChannel@6778b666&quot;] :assoc-bad-request-response 05.559 DEBUG io.pedestal.interceptor.chain - {:in process-all, :handling :enter, :execution-id 11, :line 154} 05.560 DEBUG io.pedestal.interceptor.chain - {:interceptor :com.walmartlabs.lacinia.pedestal/query-parser, :stage :enter, :execution-id 11, :fn #object[com.walmartlabs.lacinia.pedestal$query_parser_interceptor$fn__26164 0x310e7b84 &quot;com.walmartlabs.lacinia.pedestal$query_parser_interceptor$fn__26164@310e7b84&quot;], :line 50} :parse-query :response {:status 400, :headers {}, :body {:errors [{:message &quot;Stored query not found.&quot;}]}} 05.561 DEBUG io.pedestal.interceptor.chain - {:in check-terminators, :terminate? true, :execution-id 11, :line 96} 05.561 DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 11, :line 241} I&apos;d expect the :in check-temrinators to occur after the query-source interceptor, but it get delayed until the query-parser interceptor. The first is async, the second is standard."><y>#</y><d>2018-06-22</d><h>00:21</h><w>hlship</w>With more logging:

<pre>05.558 DEBUG io.pedestal.interceptor.chain - {:interceptor :com.walmartlabs.lacinia.pedestal/query-source, :stage :enter, :execution-id 11, :fn #object[com.walmartlabs.lacinia.pedestal$pass_query_through_query_source$fn__26193 0x3fff323d &quot;com.walmartlabs.lacinia.pedestal$pass_query_through_query_source$fn__26193@3fff323d&quot;], :line 50}
:store-result #object[clojure.core.async.impl.channels.ManyToManyChannel 0x6778b666 &quot;clojure.core.async.impl.channels.ManyToManyChannel@6778b666&quot;]
:assoc-bad-request-response
05.559 DEBUG io.pedestal.interceptor.chain - {:in process-all, :handling :enter, :execution-id 11, :line 154}
05.560 DEBUG io.pedestal.interceptor.chain - {:interceptor :com.walmartlabs.lacinia.pedestal/query-parser, :stage :enter, :execution-id 11, :fn #object[com.walmartlabs.lacinia.pedestal$query_parser_interceptor$fn__26164 0x310e7b84 &quot;com.walmartlabs.lacinia.pedestal$query_parser_interceptor$fn__26164@310e7b84&quot;], :line 50}
:parse-query :response {:status 400, :headers {}, :body {:errors [{:message &quot;Stored query not found.&quot;}]}}
05.561 DEBUG io.pedestal.interceptor.chain - {:in check-terminators, :terminate? true, :execution-id 11, :line 96}
05.561 DEBUG io.pedestal.interceptor.chain - {:in leave-all, :execution-id 11, :line 241}
</pre>

I&apos;d expect the <code>:in check-temrinators</code> to occur after the query-source interceptor, but it get delayed until the query-parser interceptor.  The first is async, the second is standard.</z><z id="t1529627255" t="hlship Note: this is in 0.5.3, I&apos;m checking 0.5.4 now."><y>#</y><d>2018-06-22</d><h>00:27</h><w>hlship</w>Note: this is in 0.5.3, I&apos;m checking 0.5.4 now.</z><z id="t1529634483" t="hlship Seems to be present in 0.5.4"><y>#</y><d>2018-06-22</d><h>02:28</h><w>hlship</w>Seems to be present in 0.5.4</z><z id="t1530018535" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] sorry for the delayed response but I’ve been traveling. Not sure if you’ve opened a defect yet but I’ll try to reproduce later today. Thanks for posting the details of the issue!"><y>#</y><d>2018-06-26</d><h>13:08</h><r>ddeaguiar</r><a>@U04VDKC4G</a> sorry for the delayed response but I’ve been traveling. Not sure if you’ve opened a defect yet but I’ll try to reproduce later today. Thanks for posting the details of the issue!</z><z id="t1530029308" t="hlship I&apos;ve added an issue with the same detail, and more ... but I still could have sworn I saw a mention of this problem elsewhere. Maybe a new form of Deja Vue?"><y>#</y><d>2018-06-26</d><h>16:08</h><r>hlship</r>I&apos;ve added an issue with the same detail, and more ... but I still could have sworn I saw a mention of this problem elsewhere. Maybe a new form of Deja Vue?</z><z id="t1529838391" t="Gavin Hi guys, I am getting a No matching ctor found for class clojure.lang.AFunction$1 error when I run cloverage against pedestal 0.5.4. Plain lein test won&apos;t trigger the error. Moreover, the error will occur for both Jetty and Immutant container."><y>#</y><d>2018-06-24</d><h>11:06</h><w>Gavin</w>Hi guys, I am getting a <code>No matching ctor found for class clojure.lang.AFunction$1</code> error when I run cloverage against pedestal 0.5.4.
Plain <code>lein test</code> won&apos;t trigger the error. Moreover, the error will occur for both Jetty and Immutant container.</z><z id="t1529838411" t="Gavin It won&apos;t happen for pedestal 0.5.3. Anybody has an idea?"><y>#</y><d>2018-06-24</d><h>11:06</h><w>Gavin</w>It won&apos;t happen for pedestal 0.5.3. Anybody has an idea?</z><z id="t1529838447" t="Gavin Full build: https://circleci.com/gh/gavinkflam/tabula-api/59"><y>#</y><d>2018-06-24</d><h>11:07</h><w>Gavin</w>Full build: <a href="https://circleci.com/gh/gavinkflam/tabula-api/59" target="_blank">https://circleci.com/gh/gavinkflam/tabula-api/59</a></z><z id="t1530018788" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UB2H4PVS9&quot;}] , this sounds like an defect, can you open an issue on the pedestal project?"><y>#</y><d>2018-06-26</d><h>13:13</h><r>ddeaguiar</r><a>@UB2H4PVS9</a>, this sounds like an defect, can you open an issue on the pedestal project?</z><z id="t1530024041" t="Gavin [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thanks! I shall produce a minimal project that can reproduce the issue and report afterwards."><y>#</y><d>2018-06-26</d><h>14:40</h><r>Gavin</r><a>@U0FL657GR</a> Thanks! I shall produce a minimal project that can reproduce the issue and report afterwards.</z><z id="t1530024071" t="ddeaguiar Great, much appreciated!"><y>#</y><d>2018-06-26</d><h>14:41</h><r>ddeaguiar</r>Great, much appreciated!</z><z id="t1530093621" t="danbunea Hi Guys,"><y>#</y><d>2018-06-27</d><h>10:00</h><w>danbunea</w>Hi Guys,</z><z id="t1530093638" t="danbunea I&apos;m a newbie with pedestal and I am trying to proxy all the requests I get from a browser, except a few specific ones which need some extra interceptors. These are my routes: (def routes #{ [&quot;/*proxy&quot; :any [(proxy-handler (server :dan-server))]] [&quot;/service/storyboard/StoryboardLayer/auto&quot; :post [dummy-interceptor (proxy-handler (server :dan-server))] :route-name :save-layer-route] }) However I never get the dummy-interceptor called. How should these be combined?"><y>#</y><d>2018-06-27</d><h>10:00</h><w>danbunea</w>I&apos;m a newbie with pedestal and I am trying to proxy all the requests I get from a browser, except a few specific ones which need some extra interceptors. These are my routes:

(def routes #{
           [&quot;/*proxy&quot; :any [(proxy-handler (server :dan-server))]]
           [&quot;/service/storyboard/StoryboardLayer/auto&quot; :post [dummy-interceptor (proxy-handler (server :dan-server))] :route-name :save-layer-route]
           })
However I never get the dummy-interceptor called. How should these be combined?</z><z id="t1530103875" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0GE6JTKK&quot;}] your wildcard route is too greedy and matches all incoming requests"><y>#</y><d>2018-06-27</d><h>12:51</h><w>ddeaguiar</w><a>@danbunea</a> your wildcard route is too greedy and matches all incoming requests</z><z id="t1530103899" t="danbunea Yes, that&apos;s the problem!"><y>#</y><d>2018-06-27</d><h>12:51</h><w>danbunea</w>Yes, that&apos;s the problem!</z><z id="t1530103912" t="danbunea 🙂"><y>#</y><d>2018-06-27</d><h>12:51</h><w>danbunea</w><b>🙂</b></z><z id="t1530104609" t="ikitommi There is a good explanation in https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362"><y>#</y><d>2018-06-27</d><h>13:03</h><w>ikitommi</w>There is a good explanation in <a href="https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362" target="_blank">https://github.com/pedestal/pedestal/issues/532#issuecomment-324881362</a></z><z id="t1530104683" t="danbunea Thanks, I will check it out now! 🙂"><y>#</y><d>2018-06-27</d><h>13:04</h><w>danbunea</w>Thanks, I will check it out now! <b>🙂</b></z><z id="t1530285540" t="ddeaguiar FYI, version 0.5.4 of Pedestal was cut last week. Refer to the release notes for details https://github.com/pedestal/pedestal/releases/tag/0.5.4"><y>#</y><d>2018-06-29</d><h>15:19</h><w>ddeaguiar</w>FYI, version 0.5.4 of Pedestal was cut last week. Refer to the release notes for details <a href="https://github.com/pedestal/pedestal/releases/tag/0.5.4" target="_blank">https://github.com/pedestal/pedestal/releases/tag/0.5.4</a></z><z id="t1530542119" t="martinklepsch Is there a function in pedestal (or any of it’s dependencies) that will return the path part of a given URL?"><y>#</y><d>2018-07-02</d><h>14:35</h><w>martinklepsch</w>Is there a function in pedestal (or any of it’s dependencies) that will return the path part of a given URL?</z><z id="t1530543279" t="martinklepsch To step back a bit: I’m trying to see if the referer url matches any of my defined routes. Any suggestions welcome 🙂"><y>#</y><d>2018-07-02</d><h>14:54</h><w>martinklepsch</w>To step back a bit: I’m trying to see if the referer url matches any of my defined routes. Any suggestions welcome <b>🙂</b></z><z id="t1530543544" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] the key :path-info should be on the request map. I think that’s what you are looking for."><y>#</y><d>2018-07-02</d><h>14:59</h><w>ddeaguiar</w><a>@martinklepsch</a> the key <code>:path-info</code> should be on the request map. I think that’s what you are looking for.</z><z id="t1530543579" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] that works for the current incoming request but i’m interested in operating on the referer of the request"><y>#</y><d>2018-07-02</d><h>14:59</h><w>martinklepsch</w><a>@ddeaguiar</a> that works for the current incoming request but i’m interested in operating on the <code>referer</code> of the request</z><z id="t1530543662" t="ddeaguiar as in the Referer header?"><y>#</y><d>2018-07-02</d><h>15:01</h><w>ddeaguiar</w>as in the <code>Referer</code> header?</z><z id="t1530543675" t="martinklepsch yes"><y>#</y><d>2018-07-02</d><h>15:01</h><w>martinklepsch</w>yes</z><z id="t1530543698" t="ddeaguiar AFAIK you’ll have to pull that header value directly"><y>#</y><d>2018-07-02</d><h>15:01</h><w>ddeaguiar</w>AFAIK you’ll have to pull that header value directly</z><z id="t1530543727" t="ddeaguiar ah"><y>#</y><d>2018-07-02</d><h>15:02</h><w>ddeaguiar</w>ah</z><z id="t1530543728" t="ddeaguiar ok"><y>#</y><d>2018-07-02</d><h>15:02</h><w>ddeaguiar</w>ok</z><z id="t1530543734" t="ddeaguiar i understand what you want"><y>#</y><d>2018-07-02</d><h>15:02</h><w>ddeaguiar</w>i understand what you want</z><z id="t1530543743" t="ddeaguiar sorry, you want to take a url and get the path-info essentially"><y>#</y><d>2018-07-02</d><h>15:02</h><w>ddeaguiar</w>sorry, you want to take a url and get the path-info essentially</z><z id="t1530543746" t="martinklepsch more general problem to give some context: I want to allow users to use URLs like /some/thing/CURRENT where CURRENT is resolved based on the referer and a redirect to the actual “current” thing is returned"><y>#</y><d>2018-07-02</d><h>15:02</h><w>martinklepsch</w>more general problem to give some context:

I want to allow users to use URLs like <code>/some/thing/CURRENT</code> where <code>CURRENT</code> is resolved based on the referer and a redirect to the actual “current” thing is returned</z><z id="t1530543769" t="martinklepsch hope that makes some sense"><y>#</y><d>2018-07-02</d><h>15:02</h><w>martinklepsch</w>hope that makes some sense</z><z id="t1530543839" t="martinklepsch &gt; sorry, you want to take a url and get the path-info essentially yeah, and that’s the simpest part of it I guess, I duct-taped it with some regexes now but thought there’s probably something built in"><y>#</y><d>2018-07-02</d><h>15:03</h><w>martinklepsch</w>&gt; sorry, you want to take a url and get the path-info essentially

yeah, and that’s the simpest part of it I guess, I duct-taped it with some regexes now but thought there’s probably something built in</z><z id="t1530543854" t="ddeaguiar Path info is calculated on a per-container basis. There’s a ContainerRequest protocol which is implemented for servlet containers"><y>#</y><d>2018-07-02</d><h>15:04</h><w>ddeaguiar</w>Path info is calculated on a per-container basis. There’s a ContainerRequest protocol which is implemented for servlet containers</z><z id="t1530543875" t="ddeaguiar so for example, here’s the impl for servlets https://github.com/pedestal/pedestal/blob/23b2144e72f122793531192ee2079c095de71002/service/src/io/pedestal/http/request/servlet_support.clj#L26-L31"><y>#</y><d>2018-07-02</d><h>15:04</h><w>ddeaguiar</w>so for example, here’s the impl for servlets <a href="https://github.com/pedestal/pedestal/blob/23b2144e72f122793531192ee2079c095de71002/service/src/io/pedestal/http/request/servlet_support.clj#L26-L31" target="_blank">https://github.com/pedestal/pedestal/blob/23b2144e72f122793531192ee2079c095de71002/service/src/io/pedestal/http/request/servlet_support.clj#L26-L31</a></z><z id="t1530544008" t="ddeaguiar Essentially you’d need to know what the context path is for the referrer to do a similar thing"><y>#</y><d>2018-07-02</d><h>15:06</h><w>ddeaguiar</w>Essentially you’d need to know what the context path is for the referrer to do a similar thing</z><z id="t1530544289" t="martinklepsch Ended up with this now which feels somewhat hacky but at least it gives me back a map with info about the parsed route: (route/try-routing-for (routes identity {}) :map-tree &quot;/d/reagent/reagent/0.8.1&quot; :get) "><y>#</y><d>2018-07-02</d><h>15:11</h><w>martinklepsch</w>Ended up with this now which feels somewhat hacky but at least it gives me back a map with info about the parsed route: 
<pre>(route/try-routing-for (routes identity {}) :map-tree &quot;/d/reagent/reagent/0.8.1&quot; :get)
</pre></z><z id="t1530567110" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] you may find parse-path to be helpful https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route/path.clj#L35 ."><y>#</y><d>2018-07-02</d><h>21:31</h><r>ddeaguiar</r><a>@martinklepsch</a> you may find <code>parse-path</code> to be helpful <a href="https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route/path.clj#L35" target="_blank">https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route/path.clj#L35</a>.</z><z id="t1530567124" t="ddeaguiar sample usage (require &apos;[io.pedestal.http.route.path :as route.path]) (def parsed-path (route.path/parse-path &quot;/foo/:id/:baz&quot;)) ;; {:path-constraints {:baz &quot;([^/]+)&quot;, :id &quot;([^/]+)&quot;}, ;; :path-params [:id :baz], ;; :path-parts [&quot;foo&quot; :id :baz]} (route.path/path-regex parsed-path) ;; #&quot;/\Qfoo\E/([^/]+)/([^/]+)&quot; "><y>#</y><d>2018-07-02</d><h>21:32</h><r>ddeaguiar</r>sample usage
<pre>(require &apos;[io.pedestal.http.route.path :as route.path])

 (def parsed-path (route.path/parse-path &quot;/foo/:id/:baz&quot;))
 ;; {:path-constraints {:baz &quot;([^/]+)&quot;, :id &quot;([^/]+)&quot;},
 ;;  :path-params      [:id :baz],
 ;;  :path-parts       [&quot;foo&quot; :id :baz]}

 (route.path/path-regex parsed-path)
 ;; #&quot;/\Qfoo\E/([^/]+)/([^/]+)&quot;
</pre></z><z id="t1530567313" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Interesting, are you suggesting to build my own match-route based on my route information and that function?"><y>#</y><d>2018-07-02</d><h>21:35</h><r>martinklepsch</r><a>@ddeaguiar</a> Interesting, are you suggesting to build my own <code>match-route</code> based on my route information and that function?</z><z id="t1530567336" t="martinklepsch In case you haven’t seen this message: https://clojurians.slack.com/archives/C0K65B20P/p1530544463000434"><y>#</y><d>2018-07-02</d><h>21:35</h><r>martinklepsch</r>In case you haven’t seen this message: <a href="https://clojurians.slack.com/archives/C0K65B20P/p1530544463000434" target="_blank">https://clojurians.slack.com/archives/C0K65B20P/p1530544463000434</a></z><z id="t1530567352" t="ddeaguiar preferably this would be easier to do. I’m looking into that now"><y>#</y><d>2018-07-02</d><h>21:35</h><r>ddeaguiar</r>preferably this would be easier to do. I’m looking into that now</z><z id="t1530567363" t="ddeaguiar this fn gets you part of the way there"><y>#</y><d>2018-07-02</d><h>21:36</h><r>ddeaguiar</r>this fn gets you part of the way there</z><z id="t1530567404" t="ddeaguiar to match routes you need a route specification"><y>#</y><d>2018-07-02</d><h>21:36</h><r>ddeaguiar</r>to match routes you need a route specification</z><z id="t1530567412" t="ddeaguiar both in bidi and in pedestal"><y>#</y><d>2018-07-02</d><h>21:36</h><r>ddeaguiar</r>both in bidi and in pedestal</z><z id="t1530567450" t="ddeaguiar but I think in your case you are dealing with referer urls right? These are not routes in your app, correct?"><y>#</y><d>2018-07-02</d><h>21:37</h><r>ddeaguiar</r>but I think in your case you are dealing with referer urls right? These are not routes in your app, correct?</z><z id="t1530567593" t="martinklepsch they might not be but I’m specifically trying to handle the case that they are part of my app (for which I need to match them against my route table"><y>#</y><d>2018-07-02</d><h>21:39</h><r>martinklepsch</r>they might not be but I’m specifically trying to handle the case that they are part of my app (for which I need to match them against my route table</z><z id="t1530567619" t="ddeaguiar I brought up these fns as an option for parsing paths arbitrarily."><y>#</y><d>2018-07-02</d><h>21:40</h><r>ddeaguiar</r>I brought up these fns as an option for parsing paths arbitrarily.</z><z id="t1530567668" t="ddeaguiar I’m unclear as to what the route fn is in your example: (route/try-routing-for (routes identity {}) :map-tree &quot;/d/reagent/reagent/0.8.1&quot; :get) "><y>#</y><d>2018-07-02</d><h>21:41</h><r>ddeaguiar</r>I’m unclear as to what the <code>route</code> fn is in your example:
<pre>(route/try-routing-for (routes identity {}) :map-tree &quot;/d/reagent/reagent/0.8.1&quot; :get)
</pre></z><z id="t1530567669" t="martinklepsch I ended up with this now, which is OK but it seems that this could be made easier: https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R84"><y>#</y><d>2018-07-02</d><h>21:41</h><r>martinklepsch</r>I ended up with this now, which is OK but it seems that this could be made easier: <a href="https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R84" target="_blank">https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R84</a></z><z id="t1530567717" t="martinklepsch routes returns whatever expand-routes returns"><y>#</y><d>2018-07-02</d><h>21:41</h><r>martinklepsch</r><code>routes</code> returns whatever <code>expand-routes</code> returns</z><z id="t1530567724" t="ddeaguiar I see that now"><y>#</y><d>2018-07-02</d><h>21:42</h><r>ddeaguiar</r>I see that now</z><z id="t1530567732" t="martinklepsch https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R44"><y>#</y><d>2018-07-02</d><h>21:42</h><r>martinklepsch</r><a href="https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R44" target="_blank">https://github.com/martinklepsch/cljdoc/commit/8a369e546d6b4fb6df979ee1ba71126e6e0d967a#diff-2b617a32cb2ee893338f526bde351be6R44</a></z><z id="t1530567801" t="ddeaguiar why do you need match-routes again? You can leverage a specific routing impl directly"><y>#</y><d>2018-07-02</d><h>21:43</h><r>ddeaguiar</r>why do you need <code>match-routes</code> again? You can leverage a specific routing impl directly</z><z id="t1530567805" t="martinklepsch I’m using that little indirection of passing a resolver to decouple the definition of the routes table from the actual handlers"><y>#</y><d>2018-07-02</d><h>21:43</h><r>martinklepsch</r>I’m using that little indirection of passing a <code>resolver</code> to decouple the definition of the routes table from the actual handlers</z><z id="t1530567862" t="ddeaguiar If you look at what try-routing-for does, it creates a router of a specific type and invokes the :enter impl"><y>#</y><d>2018-07-02</d><h>21:44</h><r>ddeaguiar</r>If you look at what <code>try-routing-for</code> does, it creates a router of a specific type and invokes the <code>:enter</code> impl</z><z id="t1530567863" t="martinklepsch I need it because I want to determine route-name and path-params for an arbitrary path-info string like &quot;/some/uri&quot;"><y>#</y><d>2018-07-02</d><h>21:44</h><r>martinklepsch</r>I need it because I want to determine <code>route-name</code> and <code>path-params</code> for an arbitrary <code>path-info</code> string like <code>&quot;/some/uri&quot;</code></z><z id="t1530567863" t="ddeaguiar https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route.clj#L501-L506"><y>#</y><d>2018-07-02</d><h>21:44</h><r>ddeaguiar</r><a href="https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route.clj#L501-L506" target="_blank">https://github.com/pedestal/pedestal/blob/f89d0abe244d0e8385d66a697724ef56180a00e5/route/src/io/pedestal/http/route.clj#L501-L506</a></z><z id="t1530567894" t="martinklepsch yes that’s what I ended up using 😄"><y>#</y><d>2018-07-02</d><h>21:44</h><r>martinklepsch</r>yes that’s what I ended up using <b>😄</b></z><z id="t1530568007" t="martinklepsch It does what I need but it seems undocumented and that ;;; Help for debugging comment makes me think that I might be abusing it for things it wasn’t intended for"><y>#</y><d>2018-07-02</d><h>21:46</h><r>martinklepsch</r>It does what I need but it seems undocumented and that <code>;;; Help for debugging</code> comment makes me think that I might be abusing it for things it wasn’t intended for</z><z id="t1530568041" t="ddeaguiar I think it’s perfectly acceptable to use a router directly. I don’t think you need to bother with try-routing-for"><y>#</y><d>2018-07-02</d><h>21:47</h><r>ddeaguiar</r>I think it’s perfectly acceptable to use a router directly. I don’t think you need to bother with <code>try-routing-for</code></z><z id="t1530568053" t="ddeaguiar one sec, let me experiment"><y>#</y><d>2018-07-02</d><h>21:47</h><r>ddeaguiar</r>one sec, let me experiment</z><z id="t1530568158" t="martinklepsch I’ll head to bed but thanks for looking into this. Maybe something along those lines would be a good addition to the API."><y>#</y><d>2018-07-02</d><h>21:49</h><r>martinklepsch</r>I’ll head to bed but thanks for looking into this. Maybe something along those lines would be a good addition to the API.</z><z id="t1530568171" t="ddeaguiar k, I’ll leave comments here"><y>#</y><d>2018-07-02</d><h>21:49</h><r>ddeaguiar</r>k, I’ll leave comments here</z><z id="t1530569921" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] you can create the router of your choice using the relevant constructor and then use the io.pedestal.http.route.router/find-route impl on the router to match routes"><y>#</y><d>2018-07-02</d><h>22:18</h><r>ddeaguiar</r><a>@martinklepsch</a> you can create the router of your choice using the relevant constructor and then use the <code>io.pedestal.http.route.router/find-route</code> impl on the router to match routes</z><z id="t1530570121" t="ddeaguiar example https://gist.github.com/ddeaguiar/dfcf6be6df14c14df0f868c6f420ee92"><y>#</y><d>2018-07-02</d><h>22:22</h><r>ddeaguiar</r>example <a href="https://gist.github.com/ddeaguiar/dfcf6be6df14c14df0f868c6f420ee92" target="_blank">https://gist.github.com/ddeaguiar/dfcf6be6df14c14df0f868c6f420ee92</a></z><z id="t1530570255" t="ddeaguiar The simplest form of router usage can be found here: https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/prefix_tree.clj#L497-L508"><y>#</y><d>2018-07-02</d><h>22:24</h><r>ddeaguiar</r>The simplest form of router usage can be found here: <a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/prefix_tree.clj#L497-L508" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route/prefix_tree.clj#L497-L508</a></z><z id="t1530544415" t="martinklepsch Considered creating a “container” thing to get the path info but some regex is doing the job fine for now…"><y>#</y><d>2018-07-02</d><h>15:13</h><w>martinklepsch</w>Considered creating a “container” thing to get the path info but some regex is doing the job fine for now…</z><z id="t1530544463" t="martinklepsch (Looking for something akin to Bidi’s match-route I guess: https://github.com/juxt/bidi#route-patterns )"><y>#</y><d>2018-07-02</d><h>15:14</h><w>martinklepsch</w>(Looking for something akin to Bidi’s <code>match-route</code> I guess: <a href="https://github.com/juxt/bidi#route-patterns" target="_blank">https://github.com/juxt/bidi#route-patterns</a>)</z><z id="t1530557152" t="orestis Hi, is there any example on how to ensure an explicit content encoding (ie I want to be sure I always encode the body as utf-8), while also setting the correct content-length header? "><y>#</y><d>2018-07-02</d><h>18:45</h><w>orestis</w>Hi, is there any example on how to ensure an explicit content encoding (ie I want to be sure I always encode the body as utf-8), while also setting the correct content-length header? </z><z id="t1530557229" t="orestis I have made a custom interceptor that encodes JSON via Cheshire, and I use (count (.getBytes s)) to get length in bytes, but I’d like to be 100% sure it does the right thing. "><y>#</y><d>2018-07-02</d><h>18:47</h><w>orestis</w>I have made a custom interceptor that encodes JSON via Cheshire, and I use <code>(count (.getBytes s))</code> to get length in bytes, but I’d like to be 100% sure it does the right thing. </z><z id="t1530558002" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] you may want to consider using the built-in json-body interceptor instead."><y>#</y><d>2018-07-02</d><h>19:00</h><w>ddeaguiar</w><a>@orestis</a> you may want to consider using the built-in <code>json-body</code> interceptor instead.</z><z id="t1530558005" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L115-L127"><y>#</y><d>2018-07-02</d><h>19:00</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L115-L127" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L115-L127</a></z><z id="t1530558077" t="ddeaguiar I don’t think pedestal sets the content-length header but it does support updating the servlet response if it’s set."><y>#</y><d>2018-07-02</d><h>19:01</h><w>ddeaguiar</w>I don’t think pedestal sets the content-length header but it does support updating the servlet response if it’s set.</z></g><g id="s12"><z id="t1530558122" t="ddeaguiar https://github.com/pedestal/pedestal/blob/fdb79ee8c473ec7a222a212fd8e8538f2d0cc592/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L143"><y>#</y><d>2018-07-02</d><h>19:02</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/fdb79ee8c473ec7a222a212fd8e8538f2d0cc592/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L143" target="_blank">https://github.com/pedestal/pedestal/blob/fdb79ee8c473ec7a222a212fd8e8538f2d0cc592/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L143</a></z><z id="t1530558329" t="orestis Thanks! Already I see a bunch of functionality I can use to change my interceptor. I need some more fine grained control so I can’t use the built in one. "><y>#</y><d>2018-07-02</d><h>19:05</h><w>orestis</w>Thanks! Already I see a bunch of functionality I can use to change my interceptor. I need some more fine grained control so I can’t use the built in one. </z><z id="t1530558426" t="orestis Any idea about bytes/encoding etc? I guess this is a more generic thing, but in other languages I’d have to explicitly encode a string to utf-8, so passing strings around makes me worried. Though now I see that I can also use a function that will write to the stream. I might have to dig a little bit deeper there to see how it works. "><y>#</y><d>2018-07-02</d><h>19:07</h><w>orestis</w>Any idea about bytes/encoding etc? I guess this is a more generic thing, but in other languages I’d have to explicitly encode a string to utf-8, so passing strings around makes me worried. Though now I see that I can also use a function that will write to the stream. I might have to dig a little bit deeper there to see how it works. </z><z id="t1530558990" t="orestis Aha, I have to use getBytes(Charset.UTF-8) , then presumably count that as well. "><y>#</y><d>2018-07-02</d><h>19:16</h><w>orestis</w>Aha, I have to use <code>getBytes(Charset.UTF-8)</code>, then presumably count that as well. </z><z id="t1530559036" t="orestis I might file an issue for this for further discussion, if that’s OK? I was half expecting for this to work out of the box. "><y>#</y><d>2018-07-02</d><h>19:17</h><w>orestis</w>I might file an issue for this for further discussion, if that’s OK? I was half expecting for this to work out of the box. </z><z id="t1530559045" t="orestis Thanks for the help!"><y>#</y><d>2018-07-02</d><h>19:17</h><w>orestis</w>Thanks for the help!</z><z id="t1530559107" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] np. Filing an issue is definitely ok. Paul will see that and may have additional input."><y>#</y><d>2018-07-02</d><h>19:18</h><w>ddeaguiar</w><a>@orestis</a> np. Filing an issue is definitely ok. Paul will see that and may have additional input.</z><z id="t1530559308" t="orestis Thanks, I’ll do it tomorrow from the office. "><y>#</y><d>2018-07-02</d><h>19:21</h><w>orestis</w>Thanks, I’ll do it tomorrow from the office. </z><z id="t1530604636" t="orestis Filed this: https://github.com/pedestal/pedestal/issues/582 — thanks again for the sympathetic ears."><y>#</y><d>2018-07-03</d><h>07:57</h><w>orestis</w>Filed this: <a href="https://github.com/pedestal/pedestal/issues/582" target="_blank">https://github.com/pedestal/pedestal/issues/582</a> — thanks again for the sympathetic ears.</z><z id="t1530608417" t="mkvlr https://github.com/pedestal/pedestal/issues/582#issuecomment-402065147"><y>#</y><d>2018-07-03</d><h>09:00</h><r>mkvlr</r><a href="https://github.com/pedestal/pedestal/issues/582#issuecomment-402065147" target="_blank">https://github.com/pedestal/pedestal/issues/582#issuecomment-402065147</a></z><z id="t1531031619" t="alice I&apos;m really confused by pedestal right now. I&apos;m trying to generate a url for a route, I&apos;ve defined url for with (route/url-for-routes routes), and when I expand the routes I can see the name for the route I want, :route-name :user , but when I go to (url-for :user) it says ExceptionInfo Route not found clojure.core/ex-info (core.clj:4739)"><y>#</y><d>2018-07-08</d><h>06:33</h><w>alice</w>I&apos;m really confused by pedestal right now.

I&apos;m trying to generate a url for a route, I&apos;ve defined url for with (route/url-for-routes routes), and when I expand the routes I can see the name for the route I want, <code>:route-name :user</code>, but when I go to (url-for :user) it says 
ExceptionInfo Route not found  clojure.core/ex-info (core.clj:4739)</z><z id="t1531031637" t="alice If I curl the route it exists and works, but I can&apos;t generate urls and I&apos;m totally stumped"><y>#</y><d>2018-07-08</d><h>06:33</h><w>alice</w>If I curl the route it exists and works, but I can&apos;t generate urls and I&apos;m totally stumped</z><z id="t1531034918" t="martinklepsch [:attrs {:href &quot;/_/_/users/U5Z4ECHCM&quot;}] url-for uses a dynamic vat that is only bound when handling requests I believe. Are you trying to generate a URL in a REPL by any chance?"><y>#</y><d>2018-07-08</d><h>07:28</h><w>martinklepsch</w><a>@alice</a> url-for uses a dynamic vat that is only bound when handling requests I believe. Are you trying to generate a URL in a REPL by any chance?</z><z id="t1531035586" t="alice Yes I am. but I&apos;m also defining my own url-for (def url-for (route/url-for-routes routes)) And using that as the function as described here http://pedestal.github.io/pedestal/io.pedestal.http.route.html#var-url-for-routes"><y>#</y><d>2018-07-08</d><h>07:39</h><w>alice</w>Yes I am. but I&apos;m also defining my own url-for
<pre>(def url-for (route/url-for-routes routes))</pre>
And using that as the function as described here
<a href="http://pedestal.github.io/pedestal/io.pedestal.http.route.html#var-url-for-routes" target="_blank">http://pedestal.github.io/pedestal/io.pedestal.http.route.html#var-url-for-routes</a></z><z id="t1531068898" t="martinklepsch And that is not working?"><y>#</y><d>2018-07-08</d><h>16:54</h><w>martinklepsch</w>And that is not working?</z><z id="t1531120183" t="alice No, I had to expand-routes before calling url-for-routes and I didn&apos;t catch it."><y>#</y><d>2018-07-09</d><h>07:09</h><w>alice</w>No, I had to expand-routes before calling url-for-routes and I didn&apos;t catch it.</z><z id="t1531140358" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5Z4ECHCM&quot;}] sorry to hear you were confused re: url-for . There are some docs about it’s usage on http://pedestal.io ( http://pedestal.io/guides/defining-routes#_generating_urls ). The key is, as you found out, that the routes must be expanded to the verbose format."><y>#</y><d>2018-07-09</d><h>12:45</h><r>ddeaguiar</r><a>@alice</a> sorry to hear you were confused re: <code>url-for</code>.  There are some docs about it’s usage  on <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> (<a href="http://pedestal.io/guides/defining-routes#_generating_urls" target="_blank">http://pedestal.io/guides/defining-routes#_generating_urls</a>). The key is, as you found out, that the routes must be expanded to the verbose format.</z><z id="t1531120211" t="alice Does anyone have any examples of sessions using cookies in pedestal? I can&apos;t really find anything complete."><y>#</y><d>2018-07-09</d><h>07:10</h><w>alice</w>Does anyone have any examples of sessions using cookies in pedestal? I can&apos;t really find anything complete.</z><z id="t1531140659" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5Z4ECHCM&quot;}] Pedestal wraps the ring session middleware in an interceptor. You can find out more about ring sessions by reading the docs ( https://github.com/ring-clojure/ring/wiki/Sessions ). That should answer your questions."><y>#</y><d>2018-07-09</d><h>12:50</h><w>ddeaguiar</w><a>@alice</a> Pedestal wraps the ring session middleware in an interceptor. You can find out more  about ring sessions by reading the docs (<a href="https://github.com/ring-clojure/ring/wiki/Sessions" target="_blank">https://github.com/ring-clojure/ring/wiki/Sessions</a>). That should answer your questions.</z><z id="t1531301291" t="Lightlight When using websockets with pedestal and jetty, any tips on keeping track of sessions so I can send message to a specific connection? Not sure how to use ServletUpgradeRequest/Response with my own listener function to achieve this."><y>#</y><d>2018-07-11</d><h>09:28</h><w>Lightlight</w>When using websockets with pedestal and jetty, any tips on keeping track of sessions so I can send message to a specific connection? Not sure how to use ServletUpgradeRequest/Response with my own listener function to achieve this.</z><z id="t1531307239" t="mitchelkuijpers You could create a atom to store the connections"><y>#</y><d>2018-07-11</d><h>11:07</h><w>mitchelkuijpers</w>You could create a atom to store the connections</z><z id="t1531307473" t="Lightlight yes, but i cannot distinguish between connections on incoming messages."><y>#</y><d>2018-07-11</d><h>11:11</h><w>Lightlight</w>yes, but i cannot distinguish between connections on incoming messages.</z><z id="t1531311282" t="mitchelkuijpers Ah then you need to send a id or something to distinguish this"><y>#</y><d>2018-07-11</d><h>12:14</h><w>mitchelkuijpers</w>Ah then you need to send a id or something to distinguish this</z><z id="t1531387108" t="david_clojurian Hello, I&apos;m trying to use response_for for my test. When I&apos;m running the server with lein run und call the endpoint with curl everything is working fine. But when I&apos;m using response_for the :edn-params isn&apos;t filled. Any ideas?"><y>#</y><d>2018-07-12</d><h>09:18</h><w>david_clojurian</w>Hello,
I&apos;m trying to use <code>response_for</code> for my test. When I&apos;m running the server with <code>lein run</code> und call the endpoint with curl everything is working fine. But when I&apos;m using <code>response_for</code> the <code>:edn-params</code> isn&apos;t filled.
Any ideas?</z><z id="t1531397188" t="jcf [:attrs {:href &quot;/_/_/users/U1VJM1NGK&quot;}] one thing to look out for when using response-for is the request map is different to the one you&apos;d get from a &apos;real&apos; request. If you&apos;re using things like Accept/Host headers etc. in your code that may cause issues."><y>#</y><d>2018-07-12</d><h>12:06</h><w>jcf</w><a>@david_clojurian</a> one thing to look out for when using <code>response-for</code> is the request map is different to the one you&apos;d get from a &apos;real&apos; request. If you&apos;re using things like Accept/Host headers etc. in your code that may cause issues.</z><z id="t1531398647" t="david_clojurian [:attrs {:href &quot;/_/_/users/U06FTAZV3&quot;}] The body is empty. When I&apos;m looking at the code of pedestal io.pedestal.test/servlet-response-for I&apos;m not sure that the body is processed at all. response_for isn&apos;t working for me when I want to do a POST with a body."><y>#</y><d>2018-07-12</d><h>12:30</h><w>david_clojurian</w><a>@jcf</a> The body is empty. When I&apos;m looking at the code of pedestal <code>io.pedestal.test/servlet-response-for</code> I&apos;m not sure that the body is processed at all. <code>response_for</code> isn&apos;t working for me when I want to do a POST with a body.</z><z id="t1531398693" t="jcf What does your test code look like?"><y>#</y><d>2018-07-12</d><h>12:31</h><w>jcf</w>What does your test code look like?</z><z id="t1531398712" t="jcf (io.pedestal.test/response-for app :body &quot;foo&quot;) "><y>#</y><d>2018-07-12</d><h>12:31</h><w>jcf</w><pre>(io.pedestal.test/response-for app :body &quot;foo&quot;)
</pre></z><z id="t1531398714" t="jcf Something like that?"><y>#</y><d>2018-07-12</d><h>12:31</h><w>jcf</w>Something like that?</z><z id="t1531398776" t="david_clojurian (let [r (response-for service :post &quot;/test-suites&quot; :body &quot;{:test-suite/name \&quot;Suite-Name\&quot;}&quot; :headers {&quot;content-type&quot; &quot;application/edn&quot;}) uri (str &quot;/test-suites/&quot; (-&gt; r :body (edn/read-string)))] (-&gt; r :status (= 200) (is (-&gt; r :body))))"><y>#</y><d>2018-07-12</d><h>12:32</h><w>david_clojurian</w><pre>(let [r (response-for service :post &quot;/test-suites&quot;
                          :body &quot;{:test-suite/name        \&quot;Suite-Name\&quot;}&quot;
                          :headers {&quot;content-type&quot; &quot;application/edn&quot;})
          uri (str &quot;/test-suites/&quot; (-&gt; r
                                       :body
                                       (edn/read-string)))]
      (-&gt; r
          :status
          (= 200)
          (is (-&gt; r :body))))</pre></z><z id="t1531398843" t="jcf (is (= 200 (:status r))) (is (= &apos;foo (:body r))) "><y>#</y><d>2018-07-12</d><h>12:34</h><w>jcf</w><pre>(is (= 200 (:status r)))
(is (= &apos;foo (:body r)))
</pre></z><z id="t1531398880" t="jcf If you haven&apos;t already, add some logging to your code inside your route/interceptor that logs the context . Let&apos;s see what&apos;s there."><y>#</y><d>2018-07-12</d><h>12:34</h><w>jcf</w>If you haven&apos;t already, add some logging to your code inside your route/interceptor that logs the <code>context</code>. Let&apos;s see what&apos;s there.</z><z id="t1531398934" t="jcf (def log-context-interceptor {:name ::log-context-interceptor :enter (fn [context] (log/debug :context context) context)}) "><y>#</y><d>2018-07-12</d><h>12:35</h><w>jcf</w><pre>(def log-context-interceptor
  {:name ::log-context-interceptor
   :enter (fn [context] (log/debug :context context) context)})
</pre></z><z id="t1531398962" t="jcf Something like that&apos;ll if you don&apos;t have somewhere to add the logging already. Then you can add that to your interceptor chain."><y>#</y><d>2018-07-12</d><h>12:36</h><w>jcf</w>Something like that&apos;ll if you don&apos;t have somewhere to add the logging already. Then you can add that to your interceptor chain.</z><z id="t1531399075" t="jcf BTW, if you want to short-circuit tests when the status isn&apos;t 200 etc. this pattern can work quite well: (when (is (= 200 (:status response)) (with-out-str (clojure.pprint/pprint response))) ;; These test assertions won&apos;t be executed if the status isn&apos;t 200. (is (= &apos;foo (:body response)))) "><y>#</y><d>2018-07-12</d><h>12:37</h><w>jcf</w>BTW, if you want to short-circuit tests when the status isn&apos;t 200 etc. this pattern can work quite well:

<pre>(when (is (= 200 (:status response))
          (with-out-str (clojure.pprint/pprint response)))
  ;; These test assertions won&apos;t be executed if the status isn&apos;t 200.
  (is (= &apos;foo (:body response))))
</pre></z><z id="t1531399096" t="jcf Useful if you&apos;ve got loads of assertions you don&apos;t need to check if things are utterly broken. 🙂"><y>#</y><d>2018-07-12</d><h>12:38</h><w>jcf</w>Useful if you&apos;ve got loads of assertions you don&apos;t need to check if things are utterly broken. <b>🙂</b></z><z id="t1531399276" t="jcf [:attrs {:href &quot;/_/_/users/U1VJM1NGK&quot;}] the Content-Type header in that response map is &quot;&quot; ."><y>#</y><d>2018-07-12</d><h>12:41</h><w>jcf</w><a>@david_clojurian</a> the <code>Content-Type</code> header in that response map is <code>&quot;&quot;</code>.</z><z id="t1531399310" t="jcf Empty string in both the request and the response from the looks of it."><y>#</y><d>2018-07-12</d><h>12:41</h><w>jcf</w>Empty string in both the request and the response from the looks of it.</z><z id="t1531399311" t="david_clojurian But I set it"><y>#</y><d>2018-07-12</d><h>12:41</h><w>david_clojurian</w>But I set it</z><z id="t1531399335" t="david_clojurian As you saw before"><y>#</y><d>2018-07-12</d><h>12:42</h><w>david_clojurian</w>As you saw before</z><z id="t1531399353" t="jcf Try it with the &quot;Content-Type&quot; capitalisation just to make sure that&apos;s not it."><y>#</y><d>2018-07-12</d><h>12:42</h><w>jcf</w>Try it with the <code>&quot;Content-Type&quot;</code> capitalisation just to make sure that&apos;s not it.</z><z id="t1531399376" t="jcf Ring always lowercases things but either Aleph and/or Pedestal sometimes don&apos;t."><y>#</y><d>2018-07-12</d><h>12:42</h><w>jcf</w>Ring always lowercases things but either Aleph and/or Pedestal sometimes don&apos;t.</z><z id="t1531399432" t="jcf (def ^:private secure-headers {&quot;Content-Security-Policy&quot; &quot;object-src &apos;none&apos;&quot; &quot;Strict-Transport-Security&quot; &quot;max-age=31536000; includeSubdomains&quot; &quot;X-Content-Type-Options&quot; &quot;nosniff&quot; &quot;X-Download-Options&quot; &quot;noopen&quot; &quot;X-Frame-Options&quot; &quot;DENY&quot; &quot;X-Permitted-Cross-Domain-Policies&quot; &quot;none&quot; &quot;X-XSS-Protection&quot; &quot;1; mode=block&quot;}) (def ^:const ^:private html+utf8 &quot;text/html;charset=UTF-8&quot;) (deftest hello-world (t/with-system [{:keys [service]} (t/system)] (let [response (t/response-for service :get &quot;/fmt&quot;)] (when (is (= 200 (:status response)) (t/pprint-str response)) (is (= (assoc secure-headers &quot;Content-Type&quot; html+utf8) (:headers response))))))) (deftest about (t/with-system [{:keys [service]} (t/system)] (let [response (t/response-for service :get &quot;/api/site/v1/about&quot;)] (is (= 200 (:status response))) (is (= (assoc secure-headers &quot;Content-Type&quot; &quot;text/plain&quot;) (dissoc (:headers response) &quot;vaserequest-id&quot;))) (is (= &quot;This came from site.edn!&quot; (:body response)))))) "><y>#</y><d>2018-07-12</d><h>12:43</h><w>jcf</w><pre>(def ^:private secure-headers
  {&quot;Content-Security-Policy&quot; &quot;object-src &apos;none&apos;&quot;
   &quot;Strict-Transport-Security&quot; &quot;max-age=31536000; includeSubdomains&quot;
   &quot;X-Content-Type-Options&quot; &quot;nosniff&quot;
   &quot;X-Download-Options&quot; &quot;noopen&quot;
   &quot;X-Frame-Options&quot; &quot;DENY&quot;
   &quot;X-Permitted-Cross-Domain-Policies&quot; &quot;none&quot;
   &quot;X-XSS-Protection&quot; &quot;1; mode=block&quot;})

(def ^:const ^:private html+utf8 &quot;text/html;charset=UTF-8&quot;)

(deftest hello-world
  (t/with-system [{:keys [service]} (t/system)]
    (let [response (t/response-for service :get &quot;/fmt&quot;)]
      (when (is (= 200 (:status response))
                (t/pprint-str response))
        (is (= (assoc secure-headers &quot;Content-Type&quot; html+utf8)
               (:headers response)))))))

(deftest about
  (t/with-system [{:keys [service]} (t/system)]
    (let [response (t/response-for service :get &quot;/api/site/v1/about&quot;)]
      (is (= 200 (:status response)))
      (is (= (assoc secure-headers &quot;Content-Type&quot; &quot;text/plain&quot;)
             (dissoc (:headers response) &quot;vaserequest-id&quot;)))
      (is (= &quot;This came from site.edn!&quot;
             (:body response))))))
</pre></z><z id="t1531399455" t="jcf That&apos;s some test code in one of my personal projects. I&apos;m using the HTTP header capitalisation, and those tests pass."><y>#</y><d>2018-07-12</d><h>12:44</h><w>jcf</w>That&apos;s some test code in one of my personal projects. I&apos;m using the HTTP header capitalisation, and those tests pass.</z><z id="t1531399509" t="jcf I wrap response-for to make it take a proper map because kvs are not very nice to work with."><y>#</y><d>2018-07-12</d><h>12:45</h><w>jcf</w>I wrap <code>response-for</code> to make it take a proper map because kvs are not very nice to work with.</z><z id="t1531399591" t="david_clojurian With capitalisation everthing works fine! Thank you very much. 😀"><y>#</y><d>2018-07-12</d><h>12:46</h><w>david_clojurian</w>With capitalisation everthing works fine! Thank you very much. <b>😀</b></z><z id="t1531399598" t="jcf You&apos;re welcome!"><y>#</y><d>2018-07-12</d><h>12:46</h><w>jcf</w>You&apos;re welcome!</z><z id="t1531399618" t="jcf Hope you have fun with Pedestal. It&apos;s a great piece of software."><y>#</y><d>2018-07-12</d><h>12:46</h><w>jcf</w>Hope you have fun with Pedestal. It&apos;s a great piece of software.</z><z id="t1531399686" t="david_clojurian Yes it is. I love the simplicity of the serverside events. Very impressive."><y>#</y><d>2018-07-12</d><h>12:48</h><w>david_clojurian</w>Yes it is. I love the simplicity of the serverside events. Very impressive.</z><z id="t1531821741" t="jose I have one route where I want to skip the secure-headers default interceptor, but for all the others, I want to use the default interceptors. is it possible for an interceptor to remove another interceptor from the execution queue? (or in this case, just the :leave function)"><y>#</y><d>2018-07-17</d><h>10:02</h><w>jose</w>I have one route where I want to skip the <code>secure-headers</code> default interceptor, but for all the others, I want to use the default interceptors.
is it possible for an interceptor to remove another interceptor from the execution queue? (or in this case, just the <code>:leave</code> function)</z><z id="t1531837689" t="michael zhou Hi all, what might cause the error?"><y>#</y><d>2018-07-17</d><h>14:28</h><w>michael zhou</w>Hi all, what might cause the error?</z><z id="t1531837694" t="michael zhou clojure.lang.ExceptionInfo: java.lang.ClassCastException in Interceptor :io.pedestal.http.secure-headers/secure-headers - java.lang.Integer cannot be cast to clojure.lang.Associative at clojure.core$ex_info.invokeStatic(core.clj:4739) at clojure.core$ex_info.invoke(core.clj:4739) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32) at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57) at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44) at io.pedestal.interceptor.chain$leave_all_with_binding.invokeStatic(chain.clj:254) at io.pedestal.interceptor.chain$leave_all_with_binding.invoke(chain.clj:237) at io.pedestal.interceptor.chain$leave_all$fn__10637.invoke(chain.clj:268) at clojure.lang.AFn.applyToHelper(AFn.java:152) at clojure.lang.AFn.applyTo(AFn.java:144)"><y>#</y><d>2018-07-17</d><h>14:28</h><w>michael zhou</w>clojure.lang.ExceptionInfo: java.lang.ClassCastException in Interceptor :io.pedestal.http.secure-headers/secure-headers - java.lang.Integer cannot be cast to clojure.lang.Associative
	at clojure.core$ex_info.invokeStatic(core.clj:4739)
	at clojure.core$ex_info.invoke(core.clj:4739)
	at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35)
	at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)
	at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)
	at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)
	at io.pedestal.interceptor.chain$leave_all_with_binding.invokeStatic(chain.clj:254)
	at io.pedestal.interceptor.chain$leave_all_with_binding.invoke(chain.clj:237)
	at io.pedestal.interceptor.chain$leave_all$fn__10637.invoke(chain.clj:268)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.AFn.applyTo(AFn.java:144)</z><z id="t1531837736" t="Joe Lane [:attrs {:href &quot;/_/_/users/UAHPMC0TG&quot;}] If you just need uni-directional data flow from server =&gt; client and can settle for http posts on client =&gt; server then the SSE work done with pedestal is REALLY high quality. It even lets you pick up where you left off if you’re streaming ordered data by providing an identifier for the last payload you received."><y>#</y><d>2018-07-17</d><h>14:28</h><w>Joe Lane</w><a>@jm301</a> If you just need uni-directional data flow from server =&gt; client and can settle for http posts on  client =&gt; server then the SSE work done with pedestal is REALLY high quality. It even lets you pick up where you left off if you’re streaming ordered data by providing an identifier for the last payload you received.</z><z id="t1531837767" t="Joe Lane [:attrs {:href &quot;/_/_/users/U3GA4EXA9&quot;}] Looks like you’re using an integer somewhere that secure-headers is expecting a hashmap"><y>#</y><d>2018-07-17</d><h>14:29</h><w>Joe Lane</w><a>@zhoumin79</a> Looks like you’re using an integer somewhere that secure-headers is expecting a hashmap</z><z id="t1531837823" t="michael zhou (def csp-header (sec-headers/content-security-policy-header {:default-src “‘self’” :font-src “‘self’ https://at.alicdn.com ” :connect-src “‘self’ &lt;ws://localhost:3449/&gt;” :style-src “‘self’ ‘unsafe-inline’” :object-src “‘none’” :script-src “‘self’ ‘unsafe-inline’ ‘unsafe-eval’ https: http:“})) ;; Consumed by xlight.server/create-server ;; See http/default-interceptors for additional options you can configure (def service {:env :prod :: http/routes routes :: http/type :jetty :: http/port 8080 :: http/resource-path “/public” ; :: http/allowed-origins {:creds true :allowed-origins (constantly true)} ; :: http/allowed-origins [“*”] ;; Content Security Policy (CSP) is mostly turned off in dev mode :: http/secure-headers {:content-security-policy-settings csp-header} :: http/container-options {:h2c? true :h2? false :read-only? false ;:keystore “test/hp/keystore.jks” ;:key-password “password” ;:ssl-port 8443 :ssl? false} })"><y>#</y><d>2018-07-17</d><h>14:30</h><w>michael zhou</w>(def csp-header
  (sec-headers/content-security-policy-header
   {:default-src “‘self’”
    :font-src “‘self’ <a href="https://at.alicdn.com" target="_blank">https://at.alicdn.com</a>”
    :connect-src “‘self’ &lt;ws://localhost:3449/&gt;”
    :style-src   “‘self’ ‘unsafe-inline’”
    :object-src  “‘none’”
    :script-src  “‘self’ ‘unsafe-inline’ ‘unsafe-eval’ https: http:“}))

;; Consumed by xlight.server/create-server
;; See http/default-interceptors for additional options you can configure
(def service {:env :prod
              <b>::</b>http/routes routes
              <b>::</b>http/type :jetty
              <b>::</b>http/port 8080
              <b>::</b>http/resource-path “/public”
              ;<b>::</b>http/allowed-origins {:creds true :allowed-origins (constantly true)}
              ;<b>::</b>http/allowed-origins [“*”]
              ;; Content Security Policy (CSP) is mostly turned off in dev mode
              <b>::</b>http/secure-headers {:content-security-policy-settings csp-header}
              <b>::</b>http/container-options {:h2c? true
                                        :h2? false
                                        :read-only? false
                                        ;:keystore “test/hp/keystore.jks”
                                        ;:key-password “password”
                                        ;:ssl-port 8443
                                        :ssl? false}
              })</z><z id="t1531837917" t="michael zhou [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] my secure-headers config, when I delete an item,it triggers this error. Wrong config?"><y>#</y><d>2018-07-17</d><h>14:31</h><w>michael zhou</w><a>@lanejo01</a> my secure-headers config, when I delete an item,it triggers this error. Wrong config?</z><z id="t1531838000" t="michael zhou (reg-event-fx :delete-user (fn [ [ user-id]] {:http {:method DELETE :url (str “/users/” (clj-&gt;js user-id)) :ignore-response-body true :success-event [:navigate-to-home-page]}}))"><y>#</y><d>2018-07-17</d><h>14:33</h><w>michael zhou</w>(reg-event-fx
 :delete-user
 (fn [ [ user-id]]
  {:http {:method DELETE
           :url (str “/users/” (clj-&gt;js user-id))
           :ignore-response-body true
           :success-event [:navigate-to-home-page]}}))</z><z id="t1531838080" t="michael zhou The user deleted.But it shows the above error and this"><y>#</y><d>2018-07-17</d><h>14:34</h><w>michael zhou</w>The user deleted.But it shows the above error and this</z><z id="t1531838082" t="michael zhou INFO i.p.http.impl.servlet-interceptor - {:msg “sending error”, :message “Internal server error: exception”, :line 215}"><y>#</y><d>2018-07-17</d><h>14:34</h><w>michael zhou</w>INFO  i.p.http.impl.servlet-interceptor - {:msg “sending error”, :message “Internal server error: exception”, :line 215}</z><z id="t1531838197" t="michael zhou ;(db/delete-user {:userid 778}) (defn delete-user [request] (let [id (get-in request [:path-params :id])] (db/delete-user {:userid (Integer/parseInt id)})))"><y>#</y><d>2018-07-17</d><h>14:36</h><w>michael zhou</w>;(db/delete-user {:userid 778})
(defn delete-user [request]
  (let [id (get-in request [:path-params :id])]
    (db/delete-user {:userid (Integer/parseInt id)})))</z><z id="t1531838495" t="michael zhou Do anyone have a clue？ Thanks."><y>#</y><d>2018-07-17</d><h>14:41</h><w>michael zhou</w>Do anyone have a clue？ Thanks.</z><z id="t1531838837" t="Joe Lane Which version of pedestal are you running?"><y>#</y><d>2018-07-17</d><h>14:47</h><w>Joe Lane</w>Which version of pedestal are you running?</z><z id="t1531838863" t="michael zhou [io.pedestal/pedestal.service “0.5.4”] [io.pedestal/pedestal.jetty “0.5.4&quot;]"><y>#</y><d>2018-07-17</d><h>14:47</h><w>michael zhou</w>[io.pedestal/pedestal.service “0.5.4”]
                 [io.pedestal/pedestal.jetty “0.5.4&quot;]</z><z id="t1531838909" t="Joe Lane Are you running the dev server or in production mode?"><y>#</y><d>2018-07-17</d><h>14:48</h><w>Joe Lane</w>Are you running the dev server or in production mode?</z><z id="t1531838968" t="michael zhou lein run--- prod mode"><y>#</y><d>2018-07-17</d><h>14:49</h><w>michael zhou</w>lein run--- prod mode</z><z id="t1531839203" t="Joe Lane The result from your delete-user function is likely the number of rows affected as a count correct? The result from delete-user must be a map."><y>#</y><d>2018-07-17</d><h>14:53</h><w>Joe Lane</w>The result from your <code>delete-user</code> function is likely the number of rows affected as a count correct? The result from <code>delete-user</code> must be a map.</z><z id="t1531839231" t="Joe Lane Its getting mad because the csp leave handler happens to be trying to call functions on the result of delete-user, which is an integer."><y>#</y><d>2018-07-17</d><h>14:53</h><w>Joe Lane</w>Its getting mad because the csp leave handler happens to be trying to call functions on the result of delete-user, which is an integer.</z><z id="t1531839270" t="Joe Lane delete-user in this scenario is a handler"><y>#</y><d>2018-07-17</d><h>14:54</h><w>Joe Lane</w><code>delete-user</code> in this scenario is a <code>handler</code></z><z id="t1531839276" t="Joe Lane in pedestal terminology"><y>#</y><d>2018-07-17</d><h>14:54</h><w>Joe Lane</w>in pedestal terminology</z><z id="t1531839349" t="Joe Lane So I looked at a sample project"><y>#</y><d>2018-07-17</d><h>14:55</h><w>Joe Lane</w>So I looked at a sample project</z><z id="t1531839374" t="Joe Lane the result of delete-user needs to be a response object, like from the ring project"><y>#</y><d>2018-07-17</d><h>14:56</h><w>Joe Lane</w>the result of <code>delete-user</code> needs to be a response object, like from the ring project</z><z id="t1531839385" t="Joe Lane See here https://github.com/pedestal/pedestal/blob/master/samples/tracing-interceptor/src/tracing_interceptor/service.clj"><y>#</y><d>2018-07-17</d><h>14:56</h><w>Joe Lane</w>See here <a href="https://github.com/pedestal/pedestal/blob/master/samples/tracing-interceptor/src/tracing_interceptor/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/tracing-interceptor/src/tracing_interceptor/service.clj</a></z><z id="t1531839421" t="Joe Lane You’ve almost got it, you just need to return the right thing from delete-user"><y>#</y><d>2018-07-17</d><h>14:57</h><w>Joe Lane</w>You’ve almost got it, you just need to return the right thing from <code>delete-user</code></z><z id="t1531839660" t="michael zhou [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] thank you very much. I see."><y>#</y><d>2018-07-17</d><h>15:01</h><w>michael zhou</w><a>@lanejo01</a> thank you very much. I see.</z><z id="t1531839662" t="michael zhou (http/json-response (db/delete-user {:userid id}))"><y>#</y><d>2018-07-17</d><h>15:01</h><w>michael zhou</w>(http/json-response (db/delete-user {:userid  id}))</z><z id="t1531839785" t="Joe Lane Did that end up workin for you [:attrs {:href &quot;/_/_/users/U3GA4EXA9&quot;}] ?"><y>#</y><d>2018-07-17</d><h>15:03</h><w>Joe Lane</w>Did that end up workin for you <a>@zhoumin79</a>?</z><z id="t1531839984" t="michael zhou Yes.Thanks."><y>#</y><d>2018-07-17</d><h>15:06</h><w>michael zhou</w>Yes.Thanks.</z><z id="t1532380222" t="dadair I’m trying to serve three separately defined pedestal services on a single server, but each service should be on a unique port (e.g., 8001 for service1, 8002 for service2, 8003 for service3, etc). Is this possible with the standard server-construction helpers?"><y>#</y><d>2018-07-23</d><h>21:10</h><w>dadair</w>I’m trying to serve three separately defined pedestal services on a single server, but each service should be on a unique port (e.g., 8001 for service1, 8002 for service2, 8003 for service3, etc). Is this possible with the standard server-construction helpers?</z><z id="t1532380601" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] nope, Pedestal does provide an escape hatch to specify Jetty configuration. You can possibly do it that way. I’ve never had the need to do this so unfortunately I can’t give more details"><y>#</y><d>2018-07-23</d><h>21:16</h><w>ddeaguiar</w><a>@dadair</a> nope, Pedestal does provide an escape hatch to specify Jetty configuration. You can possibly do it that way. I’ve never had the need to do this so unfortunately I can’t give more details</z><z id="t1532450887" t="kenny I have an async interceptor that returns a channel. For example: (def my-async-interceptor {:enter (fn [context] (println &quot;start processing&quot;) (async/go (println &quot;inside go block&quot;) ;; imitate some time consuming process (async/&lt;! (async/timeout 10000)) (assoc context :response {:status 200 :body &quot;ok&quot; :headers {}})))}) If I get a bunch of these request piled up (the go block takes some time to return), then the println inside the go no longer prints &quot;inside go block&quot; but &quot;start processing&quot; is still printed. Any idea why this would happen?"><y>#</y><d>2018-07-24</d><h>16:48</h><w>kenny</w>I have an async interceptor that returns a channel. For example: 
<pre>(def my-async-interceptor
  {:enter
   (fn [context]
     (println &quot;start processing&quot;)
     (async/go
       (println &quot;inside go block&quot;)
       ;; imitate some time consuming process
       (async/&lt;! (async/timeout 10000))
       (assoc context :response {:status  200
                                 :body    &quot;ok&quot;
                                 :headers {}})))})
</pre>
If I get a bunch of these request piled up (the go block takes some time to return), then the <code>println</code> inside the <code>go</code> no longer prints <code>&quot;inside go block&quot;</code> but <code>&quot;start processing&quot;</code> is still printed. Any idea why this would happen?</z><z id="t1532454691" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] the backing threadpool for go is small. I suggest using thread with io-bound operations. Keep in mind that once you go async, the remaining interceptors are processed on a go thread once your async interceptor returns."><y>#</y><d>2018-07-24</d><h>17:51</h><w>ddeaguiar</w><a>@kenny</a> the backing threadpool for <code>go</code> is small. I suggest using <code>thread</code> with io-bound operations. Keep in mind that once you go async, the remaining interceptors are processed on a <code>go</code> thread once your async interceptor returns.</z><z id="t1532457803" t="kenny [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Do you recommend for handlers that could have lots of longish (~10s) requests pending to simply be &quot;synchronous&quot;? i.e. no go block?"><y>#</y><d>2018-07-24</d><h>18:43</h><w>kenny</w><a>@ddeaguiar</a> Do you recommend for handlers that could have lots of longish (~10s) requests pending to simply be &quot;synchronous&quot;? i.e. no <code>go</code> block?</z><z id="t1532459034" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] no, I’d move those off the servlet thread. I typically perform any heavy-lifting/integration in interceptors and limit the final handler to response handling"><y>#</y><d>2018-07-24</d><h>19:03</h><w>ddeaguiar</w><a>@kenny</a> no, I’d move those off the servlet thread. I typically perform any heavy-lifting/integration in interceptors and limit the final handler to response handling</z><z id="t1532459162" t="ddeaguiar if you have longish operations, you can use thread instead."><y>#</y><d>2018-07-24</d><h>19:06</h><w>ddeaguiar</w>if you have longish operations, you can use <code>thread</code> instead.</z><z id="t1532459219" t="kenny Not sure I totally understand what you mean. In my case my handler sends a message to an external service that processes the request. The handler then takes the response from the external service and constructs a HTTP response. All of that is happening in the final handler in the interceptor chain."><y>#</y><d>2018-07-24</d><h>19:06</h><w>kenny</w>Not sure I totally understand what you mean. In my case my handler sends a message to an external service that processes the request. The handler then takes the response from the external service and constructs a HTTP response. All of that is happening in the final handler in the interceptor chain.</z><z id="t1532459258" t="ddeaguiar so you can move the integration piece to an interceptor and leave the response processing to the handler"><y>#</y><d>2018-07-24</d><h>19:07</h><w>ddeaguiar</w>so you can move the integration piece to an interceptor and leave the response processing to the handler</z><z id="t1532459271" t="kenny Why would that make a difference?"><y>#</y><d>2018-07-24</d><h>19:07</h><w>kenny</w>Why would that make a difference?</z><z id="t1532459328" t="ddeaguiar Just communicating how I normally split up work. Either way, use thread not go"><y>#</y><d>2018-07-24</d><h>19:08</h><w>ddeaguiar</w>Just communicating how I normally split up work. Either way, use <code>thread</code> not <code>go</code></z><z id="t1532459331" t="ddeaguiar caveat is this"><y>#</y><d>2018-07-24</d><h>19:08</h><w>ddeaguiar</w>caveat is this</z><z id="t1532459349" t="ddeaguiar if your handler returns a channel then that channel is expected to return a response body"><y>#</y><d>2018-07-24</d><h>19:09</h><w>ddeaguiar</w>if your handler returns a channel then that channel is expected to return a response body</z><z id="t1532459382" t="ddeaguiar if an interceptor returns a channel, then that channel is expected to return a context map"><y>#</y><d>2018-07-24</d><h>19:09</h><w>ddeaguiar</w>if an interceptor returns a channel, then that channel is expected to return a context map</z><z id="t1532459415" t="ddeaguiar I tend to avoid io-bound operations on the serving thread and go blocks"><y>#</y><d>2018-07-24</d><h>19:10</h><w>ddeaguiar</w>I tend to avoid io-bound operations on the serving thread and go blocks</z><z id="t1532459422" t="ddeaguiar best to keep those free"><y>#</y><d>2018-07-24</d><h>19:10</h><w>ddeaguiar</w>best to keep those free</z><z id="t1532459506" t="ddeaguiar particularly if integrations take ~10s"><y>#</y><d>2018-07-24</d><h>19:11</h><w>ddeaguiar</w>particularly if integrations take ~10s</z><z id="t1532459533" t="kenny Most often they will take a much shorter time 0-2s but sometimes it may take ~10s."><y>#</y><d>2018-07-24</d><h>19:12</h><w>kenny</w>Most often they will take a much shorter time 0-2s but sometimes it may take ~10s.</z><z id="t1532459594" t="ddeaguiar still 2s is a long time"><y>#</y><d>2018-07-24</d><h>19:13</h><w>ddeaguiar</w>still 2s is a long time</z><z id="t1532459603" t="ddeaguiar I’d also consider introducing a circuit-breaker"><y>#</y><d>2018-07-24</d><h>19:13</h><w>ddeaguiar</w>I’d also consider introducing a circuit-breaker</z><z id="t1532459649" t="kenny Is that more than a simple timeout?"><y>#</y><d>2018-07-24</d><h>19:14</h><w>kenny</w>Is that more than a simple timeout?</z><z id="t1532459692" t="ddeaguiar the pattern is more than that but a timeout is a good start"><y>#</y><d>2018-07-24</d><h>19:14</h><w>ddeaguiar</w>the pattern is more than that but a timeout is a good start</z><z id="t1532459757" t="ddeaguiar That may be enough though. It depends on what your needs are"><y>#</y><d>2018-07-24</d><h>19:15</h><w>ddeaguiar</w>That may be enough though. It depends on what your needs are</z><z id="t1532459799" t="kenny The way it is written now is it waits for a response from the external service for up to 10s, if no response is returned when 10s is hit then an error response is returned."><y>#</y><d>2018-07-24</d><h>19:16</h><w>kenny</w>The way it is written now is it waits for a response from the external service for up to 10s, if no response is returned when 10s is hit then an error response is returned.</z><z id="t1532459856" t="ddeaguiar Depending on what type of system you are building and the traffic you expect, you can end up exhausting your thread pool"><y>#</y><d>2018-07-24</d><h>19:17</h><w>ddeaguiar</w>Depending on what type of system you are building and the traffic you expect, you can end up exhausting your thread pool</z><z id="t1532459883" t="ddeaguiar if, for example, the system you are integrating with goes down for a long period of time"><y>#</y><d>2018-07-24</d><h>19:18</h><w>ddeaguiar</w>if, for example, the system you are integrating with goes down for a long period of time</z><z id="t1532459912" t="ddeaguiar with a circuit breaker you can detect errors and trip the breaker causing additional requests to fail fast"><y>#</y><d>2018-07-24</d><h>19:18</h><w>ddeaguiar</w>with a circuit breaker you can detect errors and trip the breaker causing additional requests to fail fast</z><z id="t1532459938" t="ddeaguiar then you can test some requests to see if the situation has been resolved"><y>#</y><d>2018-07-24</d><h>19:18</h><w>ddeaguiar</w>then you can test some requests to see if the situation has been resolved</z><z id="t1532459953" t="ddeaguiar and either close the breaker or leave it tripped"><y>#</y><d>2018-07-24</d><h>19:19</h><w>ddeaguiar</w>and either close the breaker or leave it tripped</z><z id="t1532459971" t="ddeaguiar Hystrix is commonly used here https://github.com/Netflix/Hystrix/wiki"><y>#</y><d>2018-07-24</d><h>19:19</h><w>ddeaguiar</w>Hystrix is commonly used here <a href="https://github.com/Netflix/Hystrix/wiki" target="_blank">https://github.com/Netflix/Hystrix/wiki</a></z><z id="t1532460011" t="ddeaguiar but there’s a bit of ceremony involved so you’d use something like this if you really need it"><y>#</y><d>2018-07-24</d><h>19:20</h><w>ddeaguiar</w>but there’s a bit of ceremony involved so you’d use something like this if you really need it</z><z id="t1532460096" t="kenny If the threadpool gets exhausted, what happens to additional requests that come in?"><y>#</y><d>2018-07-24</d><h>19:21</h><w>kenny</w>If the threadpool gets exhausted, what happens to additional requests that come in?</z><z id="t1532460181" t="ddeaguiar I suppose you’ll see some form of queueing. You’ll see response times go up."><y>#</y><d>2018-07-24</d><h>19:23</h><w>ddeaguiar</w>I suppose you’ll see some form of queueing. You’ll see response times go up.</z><z id="t1532460291" t="kenny Hmm. Any idea how easy it&apos;d be to exhaust the thread pool?"><y>#</y><d>2018-07-24</d><h>19:24</h><w>kenny</w>Hmm. Any idea how easy it&apos;d be to exhaust the thread pool?</z><z id="t1532460322" t="ddeaguiar If you use go , pretty easy since it’s small (like 8ish threads)"><y>#</y><d>2018-07-24</d><h>19:25</h><w>ddeaguiar</w>If you use <code>go</code>, pretty easy since it’s small (like 8ish threads)</z><z id="t1532460341" t="ddeaguiar AFAIK, thread is unbounded so you are limited by your system"><y>#</y><d>2018-07-24</d><h>19:25</h><w>ddeaguiar</w>AFAIK, <code>thread</code> is unbounded so you are limited by your system</z><z id="t1532460484" t="ddeaguiar you can change the pool size for go"><y>#</y><d>2018-07-24</d><h>19:28</h><w>ddeaguiar</w>you can change the pool size for go</z><z id="t1532460498" t="kenny It sounds like thread is the right approach here."><y>#</y><d>2018-07-24</d><h>19:28</h><w>kenny</w>It sounds like <code>thread</code> is the right approach here.</z><z id="t1532460514" t="ddeaguiar I’ve never worked outside of the defaults here"><y>#</y><d>2018-07-24</d><h>19:28</h><w>ddeaguiar</w>I’ve never worked outside of the defaults here</z><z id="t1532460526" t="kenny What do you mean?"><y>#</y><d>2018-07-24</d><h>19:28</h><w>kenny</w>What do you mean?</z><z id="t1532460548" t="ddeaguiar I’ve never changed the default threadpool size in core.async"><y>#</y><d>2018-07-24</d><h>19:29</h><w>ddeaguiar</w>I’ve never changed the default threadpool size in core.async</z><z id="t1532460566" t="ddeaguiar but you can http://clojure.github.io/core.async/#clojure.core.async/"><y>#</y><d>2018-07-24</d><h>19:29</h><w>ddeaguiar</w>but you can <a href="http://clojure.github.io/core.async/#clojure.core.async/" target="_blank">http://clojure.github.io/core.async/#clojure.core.async/</a></z><z id="t1532460582" t="ddeaguiar go blocks are dispatched over an internal thread pool, which defaults to 8 threads. The size of this pool can be modified using the Java system property `clojure.core.async.pool-size`. "><y>#</y><d>2018-07-24</d><h>19:29</h><w>ddeaguiar</w><pre>go blocks are dispatched over an internal thread pool, which
defaults to 8 threads. The size of this pool can be modified using
the Java system property `clojure.core.async.pool-size`.

</pre></z><z id="t1532460603" t="kenny Oh. Why would I want to do that over using thread ?"><y>#</y><d>2018-07-24</d><h>19:30</h><w>kenny</w>Oh. Why would I want to do that over using <code>thread</code>?</z><z id="t1532460633" t="ddeaguiar Just pointing out it’s possible. I wouldn’t"><y>#</y><d>2018-07-24</d><h>19:30</h><w>ddeaguiar</w>Just pointing out it’s possible. I wouldn’t</z><z id="t1532460700" t="ddeaguiar the heuristic I use for choosing between go and thread are: cpu-bound -&gt; go , io-bound -&gt; thread"><y>#</y><d>2018-07-24</d><h>19:31</h><w>ddeaguiar</w>the heuristic I use for choosing between <code>go</code> and <code>thread</code> are:
cpu-bound -&gt; <code>go</code>, io-bound -&gt; <code>thread</code></z><z id="t1532460757" t="kenny That&apos;s quite useful! I&apos;ll change to thread for IO ops. Thanks."><y>#</y><d>2018-07-24</d><h>19:32</h><w>kenny</w>That&apos;s quite useful! I&apos;ll change to <code>thread</code> for IO ops. Thanks.</z><z id="t1532460767" t="ddeaguiar np!"><y>#</y><d>2018-07-24</d><h>19:32</h><w>ddeaguiar</w>np!</z><z id="t1532705131" t="curtosis odd pedestal behavior: I have one version that starts up and binds to :&amp;lt;port&amp;gt;. My current version starts up and *only binds to localhost:&lt;port&gt;. I can’t see where I’m doing anything different between the two — I never set :: http/host explicitly."><y>#</y><d>2018-07-27</d><h>15:25</h><w>curtosis</w>odd pedestal behavior: I have one version that starts up and binds to :&amp;lt;port&amp;gt;. My current version starts  up and *only binds to localhost:&lt;port&gt;. I can’t see where I’m doing anything different between the two — I never set <b>::</b>http/host explicitly.</z><z id="t1532705136" t="curtosis Any clues where to look?"><y>#</y><d>2018-07-27</d><h>15:25</h><w>curtosis</w>Any clues where to look?</z><z id="t1532706942" t="curtosis obviously can work around it by passing in 0.0.0.0, but I’m curious why it worked before and doesn’t now."><y>#</y><d>2018-07-27</d><h>15:55</h><w>curtosis</w>obviously can work around it by passing in 0.0.0.0, but I’m curious why it worked before and doesn’t now.</z><z id="t1532714916" t="bherrmann maybe different profiles?"><y>#</y><d>2018-07-27</d><h>18:08</h><w>bherrmann</w>maybe different profiles?</z><z id="t1532715271" t="curtosis I looked at those, but I really didn’t touch those that I could see."><y>#</y><d>2018-07-27</d><h>18:14</h><w>curtosis</w>I looked at those, but I really didn’t touch those that I could see.</z><z id="t1532715292" t="curtosis I should dig through the uberjars and see what got included differently"><y>#</y><d>2018-07-27</d><h>18:14</h><w>curtosis</w>I should dig through the uberjars and see what got included differently</z><z id="t1532715890" t="jonahbenton [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] check this commit: https://github.com/pedestal/pedestal/commit/6270df0e07aefa93a5aa9987aad749e508723c10"><y>#</y><d>2018-07-27</d><h>18:24</h><w>jonahbenton</w><a>@curtosis</a> check this commit: <a href="https://github.com/pedestal/pedestal/commit/6270df0e07aefa93a5aa9987aad749e508723c10" target="_blank">https://github.com/pedestal/pedestal/commit/6270df0e07aefa93a5aa9987aad749e508723c10</a></z><z id="t1532715954" t="curtosis that would be the right place, but I wasn’t specifying host explicitly anywhere (that’s how I fixed it)"><y>#</y><d>2018-07-27</d><h>18:25</h><w>curtosis</w>that would be the right place, but I wasn’t specifying host explicitly anywhere (that’s how I fixed it)</z><z id="t1533152948" t="skrat I&apos;m kind of lost in interceptors, I would like to log response status code and duration, how can I do that?"><y>#</y><d>2018-08-01</d><h>19:49</h><w>skrat</w>I&apos;m kind of lost in interceptors, I would like to log response status code and duration, how can I do that?</z><z id="t1533153085" t="ddeaguiar You can create an interceptor with an :enter and :leave implementation which, on enter, appends a timestamp to the context and, on leave, calculates the difference and logs it as well as the status code"><y>#</y><d>2018-08-01</d><h>19:51</h><w>ddeaguiar</w>You can create an interceptor with an <code>:enter</code> and <code>:leave</code> implementation which, on enter, appends a timestamp to the context and, on leave, calculates the difference and logs it as well as the status code</z><z id="t1533153134" t="ddeaguiar Unfortunately response timings are not available out of the box"><y>#</y><d>2018-08-01</d><h>19:52</h><w>ddeaguiar</w>Unfortunately response timings are not available out of the box</z><z id="t1533153140" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0662SCKU&quot;}] ^^"><y>#</y><d>2018-08-01</d><h>19:52</h><w>ddeaguiar</w><a>@skrat</a> ^^</z><z id="t1533153181" t="skrat [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] excellent answer, I&apos;ll give it a try"><y>#</y><d>2018-08-01</d><h>19:53</h><w>skrat</w><a>@ddeaguiar</a> excellent answer, I&apos;ll give it a try</z><z id="t1533153925" t="souenzzo You can add some headers then it will appear on chrome/firefox network tab (def http-timming-header {:name ::http-timming-header :enter (fn [ctx] (assoc-in ctx [:request :inst] (new Date))) :leave (fn [{{:keys [inst]} :request :as ctx}] (let [diff (-&gt; (time.coerce/to-date-time inst) (time/interval (time/now)) (time/in-millis))] (assoc-in ctx [:response :headers &quot;Server-Timing&quot;] (format &quot;app=%s; \&quot;My App\&quot;&quot; diff))))}) "><y>#</y><d>2018-08-01</d><h>20:05</h><r>souenzzo</r>You can add some headers then it will appear on chrome/firefox network tab
<pre>(def http-timming-header
  {:name  ::http-timming-header
   :enter (fn [ctx] (assoc-in ctx [:request :inst] (new Date)))
   :leave (fn [{{:keys [inst]} :request
                :as            ctx}]
            (let [diff (-&gt; (time.coerce/to-date-time inst)
                           (time/interval (time/now))
                           (time/in-millis))]
              (assoc-in ctx [:response :headers &quot;Server-Timing&quot;]
                        (format &quot;app=%s; \&quot;My App\&quot;&quot; diff))))})
</pre></z><z id="t1533153190" t="ddeaguiar 🙂"><y>#</y><d>2018-08-01</d><h>19:53</h><w>ddeaguiar</w><b>🙂</b></z><z id="t1533156534" t="martinklepsch I wonder what approaches are there if you want to measure the time taken for every interceptor individually."><y>#</y><d>2018-08-01</d><h>20:48</h><w>martinklepsch</w>I wonder what approaches are there if you want to measure the time taken for every interceptor individually.</z><z id="t1533156590" t="martinklepsch Interleave :chain with appropriate interceptors? Update :enter &amp; :leave handlers of interceptors to include this?"><y>#</y><d>2018-08-01</d><h>20:49</h><w>martinklepsch</w>Interleave <code>:chain</code> with appropriate interceptors? Update <code>:enter</code> &amp; <code>:leave</code> handlers of interceptors to include this?</z><z id="t1533157410" t="ddeaguiar I suppose you can do that. The interceptors I’d be must interested in instrumenting are the ones I created. If anything, I’d create an interceptor helper fn which allowed me to create instrumented interceptors but personally I’ve never had the need for anything like that."><y>#</y><d>2018-08-01</d><h>21:03</h><w>ddeaguiar</w>I suppose you can do that. The interceptors I’d be must interested in instrumenting are the ones I created. If anything, I’d create an interceptor helper fn which allowed me to create instrumented interceptors but personally I’ve never had the need for anything like that.</z><z id="t1533157525" t="skrat I don&apos;t see any use cases for that, for performance tuning you can use profiler"><y>#</y><d>2018-08-01</d><h>21:05</h><w>skrat</w>I don&apos;t see any use cases for that, for performance tuning you can use profiler</z><z id="t1533157659" t="ddeaguiar yep"><y>#</y><d>2018-08-01</d><h>21:07</h><w>ddeaguiar</w>yep</z><z id="t1533218329" t="dadair I’m having an issue getting CORS working; I’ve followed the guides and the service map has ‘:io.pedestal.http/allowed-origins {:creds true :allowed-origins (constantly true)}’, but I get a 404 on browser OPTION pre-flight"><y>#</y><d>2018-08-02</d><h>13:58</h><w>dadair</w>I’m having an issue getting CORS working; I’ve followed the guides and the service map has ‘:io.pedestal.http/allowed-origins {:creds true :allowed-origins (constantly true)}’, but I get a 404 on browser OPTION pre-flight</z><z id="t1533218351" t="dadair Not sure where I’m going wrong here"><y>#</y><d>2018-08-02</d><h>13:59</h><w>dadair</w>Not sure where I’m going wrong here</z><z id="t1533227196" t="curtosis [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] I saw that with pedestal-lacinia. IIRC pre-flight means the browser is rejecting it before sending it along. In my case it was sending a query that didn’t match the API spec. Maybe that helps you narrow down the problem point?"><y>#</y><d>2018-08-02</d><h>16:26</h><w>curtosis</w><a>@dadair</a> I saw that with pedestal-lacinia. IIRC pre-flight means the browser is rejecting it before sending it along. In my case it was sending a query that didn’t match the API spec. Maybe that helps you narrow down the problem point?</z><z id="t1533228479" t="dadair Do I need to define a catch-all :option route? From looking at the pedestal CORS code, I thought it handles all of this in interceptors that are pre-router"><y>#</y><d>2018-08-02</d><h>16:47</h><w>dadair</w>Do I need to define a catch-all :option route? From looking at the pedestal CORS code, I thought it handles all of this in interceptors that are pre-router</z><z id="t1533231304" t="dadair Found the problem(s): 1. I was setting the ::http/allowed-origins key after applying the default interceptors function (which relies on the presence of the key to add the appropriate interceptor) 2. I was providing my own :interceptors [] key, which was preventing default-interceptors from defining the defaults to begin-with (I thought this would add, rather than prevent)"><y>#</y><d>2018-08-02</d><h>17:35</h><w>dadair</w>Found the problem(s):
1. I was setting the <code>::http/allowed-origins</code> key after applying the default interceptors function (which relies on the presence of the key to add the appropriate interceptor)
2. I was providing my own <code>:interceptors []</code> key, which was preventing <code>default-interceptors</code> from defining the defaults to begin-with (I thought this would add, rather than prevent)</z><z id="t1533245111" t="dadair Are there any unexpected consequences one should be aware of when running multiple pedestal-jetty servers (different ports) in a single JVM? Outside of general performance considerations."><y>#</y><d>2018-08-02</d><h>21:25</h><w>dadair</w>Are there any unexpected consequences one should be aware of when running multiple pedestal-jetty servers (different ports) in a single JVM? Outside of general performance considerations.</z><z id="t1533245202" t="dadair We’re trying to trim our proliferation of services by combining services into a single/less JVMs (we don’t expect huge load). I have multiple servers running, and everything seems to be fine, just wanted to make sure there wasn’t going to be anything biting us in the butt later"><y>#</y><d>2018-08-02</d><h>21:26</h><w>dadair</w>We’re trying to trim our proliferation of services by combining services into a single/less JVMs (we don’t expect huge load). I have multiple servers running, and everything seems to be fine, just wanted to make sure there wasn’t going to be anything biting us in the butt later</z><z id="t1533247068" t="jonahbenton You can have as many or as few ports open as you want, and certainly webapp containers usually host many services at once- but logically services can have lots of singleton resources- connection pools, caches, etc- and distinct lifecycles- before this/after that- and dependencies. Obviously there&apos;s additional context but my knee jerk would be to make them really one service- one port, one lifecycle, etc, easing the transition pain with a load balancer or proxy if need be- or fitting into the war-container pattern. Two microservices on two ports in one jvm- again absent additional context- feels like a doesn&apos;t end well situation to me."><y>#</y><d>2018-08-02</d><h>21:57</h><w>jonahbenton</w>You can have as many or as few ports open as you want, and certainly webapp containers usually host many services at once- but logically services can have lots of singleton resources- connection pools, caches, etc- and distinct lifecycles- before this/after that- and dependencies. Obviously there&apos;s additional context but my knee jerk would be to make them really one service- one port, one lifecycle, etc, easing the transition pain with a load balancer or proxy if need be- or fitting into the war-container pattern. Two microservices on two ports in one jvm- again absent additional context- feels like a doesn&apos;t end well situation to me.</z><z id="t1533255324" t="dadair Duct/integrant seems to be keeping the singletons/lifecycle management manageable, so I’ll keep pushing it and see how it goes. Worst case I could combine the routes into a single server and prefix each service with a path prefix."><y>#</y><d>2018-08-03</d><h>00:15</h><w>dadair</w>Duct/integrant seems to be keeping the singletons/lifecycle management manageable, so I’ll keep pushing it and see how it goes. Worst case I could combine the routes into a single server and prefix each service with a path prefix.</z><z id="t1533487070" t="skrat Is there a way I can get a ring handler fn from pedestal service-map?"><y>#</y><d>2018-08-05</d><h>16:37</h><w>skrat</w>Is there a way I can get a ring handler fn from pedestal service-map?</z><z id="t1533578937" t="mtnygard [:attrs {:href &quot;/_/_/users/U0662SCKU&quot;}] I think the :service-fn key might have the value you&apos;re looking for."><y>#</y><d>2018-08-06</d><h>18:08</h><w>mtnygard</w><a>@skrat</a> I think the :service-fn key might have the value you&apos;re looking for.</z><z id="t1533578946" t="mtnygard But I haven&apos;t tried it... that&apos;s off the top of my head."><y>#</y><d>2018-08-06</d><h>18:09</h><w>mtnygard</w>But I haven&apos;t tried it... that&apos;s off the top of my head.</z><z id="t1533590232" t="ddeaguiar The ::io.pedestal.http/service-fn is an implementation of the Servlet.service method. I think you’ll need to write your own interceptor chain provider to support a pedestal service as a ring handler."><y>#</y><d>2018-08-06</d><h>21:17</h><w>ddeaguiar</w>The <code>::io.pedestal.http/service-fn</code> is an implementation of the Servlet.service method. I think you’ll need to write your own interceptor chain provider to support a pedestal service as a ring handler.</z><z id="t1533820012" t="jmayaalv HI, i am trying to pack a pedestal app that uses deps.edn and keep getting: Exception in thread &quot;main&quot; org.eclipse.aether.resolution.ArtifactDescriptorException: Failed to read artifact descriptor for com.fasterxml.jackson.core:jackson-core:jar:2.9.6 at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:329)"><y>#</y><d>2018-08-09</d><h>13:06</h><w>jmayaalv</w>HI, i am trying to pack a pedestal app that uses deps.edn and keep getting:
<pre>Exception in thread &quot;main&quot; org.eclipse.aether.resolution.ArtifactDescriptorException: Failed to read artifact descriptor for com.fasterxml.jackson.core:jackson-core:jar:2.9.6
	at org.apache.maven.repository.internal.DefaultArtifactDescriptorReader.loadPom(DefaultArtifactDescriptorReader.java:329)</pre></z><z id="t1533820027" t="jmayaalv lein uberjar works fine. is there a known workaround for this? haven’t been able to find anything 😕"><y>#</y><d>2018-08-09</d><h>13:07</h><w>jmayaalv</w><code>lein uberjar</code> works fine. is there a known workaround for this? haven’t been able to find anything <b>😕</b></z><z id="t1534257856" t="souenzzo There is some library that helps to implement a cursor"><y>#</y><d>2018-08-14</d><h>14:44</h><w>souenzzo</w>There is some library that helps to implement a <code>cursor</code></z><z id="t1534257857" t="souenzzo ?"><y>#</y><d>2018-08-14</d><h>14:44</h><w>souenzzo</w>?</z><z id="t1534313204" t="dadair Trying to debug a production issue and trying to locate where the issue is originating; I am using websockets with pedestal through the jetty websocket configurator, and I’m seeing a repeating log for :on-close firing with {:code 1006, :reason &quot;WebSocket Read EOF&quot;} . I’m not super familiar with low-level websocket details, and I’m wondering if someone can help me determine if this is the pedestal server’s issue, or if it’s just closing the connection in response to a problem from the other side?"><y>#</y><d>2018-08-15</d><h>06:06</h><w>dadair</w>Trying to debug a production issue and trying to locate where the issue is originating; I am using websockets with pedestal through the jetty websocket configurator, and I’m seeing a repeating log for <code>:on-close</code> firing with <code>{:code 1006, :reason &quot;WebSocket Read EOF&quot;}</code>. I’m not super familiar with low-level websocket details, and I’m wondering if someone can help me determine if this is the pedestal server’s issue, or if it’s just closing the connection in response to a problem from the other side?</z><z id="t1534359406" t="souenzzo [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] do you have a ping method on your websocket? I dont remember if it&apos;s the 1006, but I fixed some &quot;EOF error&quot; doing a ping every minute"><y>#</y><d>2018-08-15</d><h>18:56</h><w>souenzzo</w><a>@dadair</a> do you have a ping method on your websocket? I dont remember if it&apos;s the 1006, but I fixed some &quot;EOF error&quot; doing a ping every minute</z><z id="t1534359541" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] the pedestal user group has broader reach. You can try asking there as well."><y>#</y><d>2018-08-15</d><h>18:59</h><w>ddeaguiar</w><a>@dadair</a> the pedestal user group has broader reach. You can try asking there as well.</z><z id="t1534362534" t="dadair [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] we have a ping mechanism set up, the issue appears to be related somehow to our nginx proxy “degrading” when deployed in kubenetes; seems a proxy reset fixed the issue /shrug"><y>#</y><d>2018-08-15</d><h>19:48</h><w>dadair</w><a>@souenzzo</a> we have a ping mechanism set up, the issue appears to be related somehow to our nginx proxy “degrading” when deployed in kubenetes; seems a proxy reset fixed the issue /shrug</z><z id="t1534789276" t="souenzzo Hello; I updated my pedestal from 5.3 to 5.4 and now when I try to access it &quot;from outside&quot;, it&apos;s return curl: (7) Failed to connect to 10.0.0.111 port 8000: Connection refused . From localhost, everything works"><y>#</y><d>2018-08-20</d><h>18:21</h><w>souenzzo</w>Hello; I updated my pedestal from 5.3 to 5.4 and now when I try to access it &quot;from outside&quot;, it&apos;s return <code>curl: (7) Failed to connect to 10.0.0.111 port 8000: Connection refused</code>. From localhost, everything works</z><z id="t1534865205" t="souenzzo Bump! There is no changelog for 5.4 😕 https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md"><y>#</y><d>2018-08-21</d><h>15:26</h><r>souenzzo</r>Bump!
There is no changelog for 5.4 <b>😕</b>
<a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md</a></z><z id="t1534789335" t="souenzzo I&apos;m using (-&gt; service/service server/default-interceptors server/create-server server/start)"><y>#</y><d>2018-08-20</d><h>18:22</h><w>souenzzo</w>I&apos;m using <code>(-&gt; service/service server/default-interceptors server/create-server server/start)</code></z><z id="t1534789432" t="souenzzo there is no error nor logs"><y>#</y><d>2018-08-20</d><h>18:23</h><w>souenzzo</w>there is no error nor logs</z><z id="t1534865205" t="souenzzo Bump! There is no changelog for 5.4 😕 https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md"><y>#</y><d>2018-08-21</d><h>15:26</h><w>souenzzo</w>Bump!
There is no changelog for 5.4 <b>😕</b>
<a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md</a></z><z id="t1534839158" t="ikitommi how can one test interceptor chains which have async steps?"><y>#</y><d>2018-08-21</d><h>08:12</h><w>ikitommi</w>how can one test interceptor chains which have async steps?</z><z id="t1534853777" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] you can use response-for with async interceptors. Refer to https://github.com/pedestal/pedestal/blob/270a9e49e556b0f2af0bb58ec7a422873c3d065c/service/test/io/pedestal/http_test.clj#L306-L326"><y>#</y><d>2018-08-21</d><h>12:16</h><w>ddeaguiar</w><a>@ikitommi</a> you can use <code>response-for</code> with async interceptors. Refer to <a href="https://github.com/pedestal/pedestal/blob/270a9e49e556b0f2af0bb58ec7a422873c3d065c/service/test/io/pedestal/http_test.clj#L306-L326" target="_blank">https://github.com/pedestal/pedestal/blob/270a9e49e556b0f2af0bb58ec7a422873c3d065c/service/test/io/pedestal/http_test.clj#L306-L326</a></z><z id="t1534869177" t="ddeaguiar ah that’s my fault. You can find release notes here: https://github.com/pedestal/pedestal/releases/tag/0.5.4"><y>#</y><d>2018-08-21</d><h>16:32</h><w>ddeaguiar</w>ah that’s my fault. You can find release notes here: <a href="https://github.com/pedestal/pedestal/releases/tag/0.5.4" target="_blank">https://github.com/pedestal/pedestal/releases/tag/0.5.4</a></z><z id="t1534873395" t="souenzzo Maybe a warning in #557 once it is potentially breaking"><y>#</y><d>2018-08-21</d><h>17:43</h><r>souenzzo</r>Maybe a warning in  #557 once it is potentially breaking</z><z id="t1534875061" t="ddeaguiar Updated the release notes to be more explicit about this. Thanks!"><y>#</y><d>2018-08-21</d><h>18:11</h><r>ddeaguiar</r>Updated the release notes to be more explicit about this. Thanks!</z><z id="t1534875064" t="ddeaguiar and sorry!"><y>#</y><d>2018-08-21</d><h>18:11</h><r>ddeaguiar</r>and sorry!</z><z id="t1534869182" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ^^"><y>#</y><d>2018-08-21</d><h>16:33</h><w>ddeaguiar</w><a>@souenzzo</a> ^^</z><z id="t1534869191" t="ddeaguiar I will look to update the changelog as well"><y>#</y><d>2018-08-21</d><h>16:33</h><w>ddeaguiar</w>I will look to update the changelog as well</z><z id="t1534870546" t="ikitommi [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks. But I’m poiking with the interceptor chain directly."><y>#</y><d>2018-08-21</d><h>16:55</h><w>ikitommi</w><a>@ddeaguiar</a> thanks. But I’m poiking with the interceptor chain directly.</z><z id="t1534870562" t="ikitommi (require &apos;[io.pedestal.interceptor.chain :as pc]) (require &apos;[io.pedestal.interceptor :as pi]) (require &apos;[clojure.core.async :as a]) (-&gt; {:kikka &quot;kukka&quot;} (pc/enqueue [(pi/interceptor {:enter identity})]) (pc/execute)) ;=&gt; {:kikka &quot;kukka&quot;} (-&gt; {:kikka &quot;kukka&quot;} (pc/enqueue [(pi/interceptor {:enter (fn [ctx] (a/go ctx))})]) (pc/execute)) ;=&gt; nil "><y>#</y><d>2018-08-21</d><h>16:56</h><w>ikitommi</w><pre>(require &apos;[io.pedestal.interceptor.chain :as pc])
(require &apos;[io.pedestal.interceptor :as pi])
(require &apos;[clojure.core.async :as a])

(-&gt; {:kikka &quot;kukka&quot;}
    (pc/enqueue [(pi/interceptor {:enter identity})])
    (pc/execute))
;=&gt; {:kikka &quot;kukka&quot;}

(-&gt; {:kikka &quot;kukka&quot;}
    (pc/enqueue [(pi/interceptor {:enter (fn [ctx] (a/go ctx))})])
    (pc/execute))
;=&gt; nil
</pre></z><z id="t1534870663" t="ikitommi It works if I add a custom interceptor as first into the queue and write the value into a promise which i deref outside of the chain, but looking for a better way."><y>#</y><d>2018-08-21</d><h>16:57</h><w>ikitommi</w>It works if I add a custom interceptor as first into the queue and write the value into a promise which i deref outside of the chain, but looking for a better way.</z><z id="t1534870946" t="ddeaguiar IC, I recall having a workaround for testing requests satisfied by async interceptors before response-for handled them but it eludes me atm. I’ll try and remember"><y>#</y><d>2018-08-21</d><h>17:02</h><w>ddeaguiar</w>IC, I recall having a workaround for testing requests satisfied by async interceptors before response-for handled them but it eludes me atm. I’ll try and remember</z><z id="t1534871263" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] here’s what I did in the past. I tend to avoid with-redefs but I found this useful. I’m sure there are better ways, though."><y>#</y><d>2018-08-21</d><h>17:07</h><w>ddeaguiar</w><a>@ikitommi</a> here’s what I did in the past. I tend to avoid <code>with-redefs</code> but I found this useful. I’m sure there are better ways, though.</z><z id="t1534871389" t="ddeaguiar it’s tightly coupled with the Pedestal’s underlying impl so that’s gross"><y>#</y><d>2018-08-21</d><h>17:09</h><w>ddeaguiar</w>it’s tightly coupled with the Pedestal’s underlying impl so that’s gross</z><z id="t1534871399" t="ddeaguiar but hey, I was in a pinch 🙂"><y>#</y><d>2018-08-21</d><h>17:09</h><w>ddeaguiar</w>but hey, I was in a pinch <b>🙂</b></z><z id="t1534871409" t="ikitommi yes it’s bad 🙂"><y>#</y><d>2018-08-21</d><h>17:10</h><w>ikitommi</w>yes it’s bad <b>🙂</b></z><z id="t1534871448" t="ikitommi I think that could be interesting outside of tests too, as the interceptor chain can be run as standalone too."><y>#</y><d>2018-08-21</d><h>17:10</h><w>ikitommi</w>I think that could be interesting outside of tests too, as the interceptor chain can be run as standalone too.</z><z id="t1534871501" t="ikitommi One solution would be to add a second arity to execute with a second argument which is a callback called when all done."><y>#</y><d>2018-08-21</d><h>17:11</h><w>ikitommi</w>One solution would be to add a second arity to execute with a second argument which is a callback called when all done.</z><z id="t1534871558" t="ikitommi (let [on-complete (promise)] (-&gt; {:kikka &quot;kukka&quot;} (pc/enqueue [(pi/interceptor {:enter (fn [ctx] (a/go ctx))})]) (pc/execute on-complete) (deref on-complete 1000 ::timeout)) "><y>#</y><d>2018-08-21</d><h>17:12</h><w>ikitommi</w><pre>(let [on-complete (promise)]
  (-&gt; {:kikka &quot;kukka&quot;}
      (pc/enqueue [(pi/interceptor {:enter (fn [ctx] (a/go ctx))})])
      (pc/execute on-complete)
  (deref on-complete 1000 ::timeout))
</pre></z><z id="t1534871617" t="ddeaguiar I need to go back and better understand the change made to support async response-for testing"><y>#</y><d>2018-08-21</d><h>17:13</h><w>ddeaguiar</w>I need to go back and better understand the change made to support async <code>response-for</code> testing</z><z id="t1534871617" t="ikitommi but, just wondering how it’s intended to be used, not needing this feature."><y>#</y><d>2018-08-21</d><h>17:13</h><w>ikitommi</w>but, just wondering how it’s intended to be used, not needing this feature.</z><z id="t1534871858" t="ddeaguiar because the solution is going to be around stubbing the async context"><y>#</y><d>2018-08-21</d><h>17:17</h><w>ddeaguiar</w>because the solution is going to be around stubbing the async context</z><z id="t1534961850" t="jaihindhreddy-duplicate Hi all, can I connect to a MySQL database asynchronously in an interceptor?"><y>#</y><d>2018-08-22</d><h>18:17</h><w>jaihindhreddy-duplicate</w>Hi all, can I connect to a MySQL database asynchronously in an interceptor?</z><z id="t1534965001" t="hlship Something I noticed when upgrading from 0.5.3 to 0.5.4 was that Pedestal is now intolerant of nils in the interceptor list; previously it would skip over the nils, but now it fails. I had to change some setup code, that had some conditional parts in it, to filter out the nils before passing them to io.pedestal.http/create-server."><y>#</y><d>2018-08-22</d><h>19:10</h><w>hlship</w>Something I noticed when upgrading from 0.5.3 to 0.5.4 was that Pedestal is now intolerant of nils in the interceptor list; previously it would skip over the nils, but now it fails.  I had to change some setup code, that had some conditional parts in it, to filter out the nils before passing them to io.pedestal.http/create-server.</z><z id="t1535306911" t="lxsameer hey folks, how can I provide a list of default interceptors for all the handlers which gets merge with what ever interceptors list that handler provides ?"><y>#</y><d>2018-08-26</d><h>18:08</h><w>lxsameer</w>hey folks, how can I provide a list of default interceptors for all the handlers which gets merge with what ever interceptors list that handler provides ?</z><z id="t1535310020" t="hlship I&apos;d say that kind of thing is out of Pedestal&apos;s set of responsibilities. This kind of thing is typically solved in code: write a function that returns the routes, pass the default interceptors into that function, build the routes w/ those interceptors and your handlers."><y>#</y><d>2018-08-26</d><h>19:00</h><r>hlship</r>I&apos;d say that kind of thing is out of Pedestal&apos;s set of responsibilities.  This kind of thing is typically solved in code: write a function that returns the routes, pass the default interceptors into that function, build the routes w/ those interceptors and your handlers.</z><z id="t1535310155" t="hlship Alternately, you could start with the routes and write code that walks the set and modifies the entries to add the interceptors but that will be much more clumsy than just building the data structure right the first time."><y>#</y><d>2018-08-26</d><h>19:02</h><r>hlship</r>Alternately, you could start with the routes and write code that walks the set and modifies the entries to add the interceptors but that will be much more clumsy than just building the data structure right the first time.</z><z id="t1535312076" t="lxsameer thanks"><y>#</y><d>2018-08-26</d><h>19:34</h><r>lxsameer</r>thanks</z><z id="t1535356281" t="martinklepsch Might misunderstand but there is a default-interceptors option IIRC. Maybe that’s what you’re looking for? "><y>#</y><d>2018-08-27</d><h>07:51</h><r>martinklepsch</r>Might misunderstand but there is a default-interceptors option IIRC. Maybe that’s what you’re looking for? </z><z id="t1535374719" t="ddeaguiar Following up on what [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] said, while Pedestal does provide default interceptors, you can override those default interceptors by specifying your own ‘default’ interceptors by assoc’ing them to the service map via the io.pedestal.http/interceptors key."><y>#</y><d>2018-08-27</d><h>12:58</h><r>ddeaguiar</r>Following up on what <a>@U050TNB9F</a> said, while Pedestal does provide default interceptors, you can override those default interceptors by specifying your own ‘default’ interceptors by assoc’ing them to the service map via the <code>io.pedestal.http/interceptors</code> key.</z><z id="t1535382083" t="hlship To hopefully clarify: the default interceptors carry request processing through some initial steps, and ends with the router; the router takes it from there to find a specific route, and each route can have its own customized interceptor stack, terminating with a handler."><y>#</y><d>2018-08-27</d><h>15:01</h><r>hlship</r>To hopefully clarify: the default interceptors carry request processing through some initial steps, and ends with the router; the router takes it from there to find a specific route, and each route can have its own customized interceptor stack, terminating with a handler.</z><z id="t1535392270" t="souenzzo Hey. When I do ?foo[]=33&amp;foo[]=55 pedestal generates :query-params {:foo[] [33 55]} (brackets are part of foo keyword) Is it a bug or a feature? A PR allowing rails vec-strategy on query params (as a opt-in) will be welcome? https://github.com/JulianBirch/cljs-ajax#get-specific-settings"><y>#</y><d>2018-08-27</d><h>17:51</h><w>souenzzo</w>Hey. When I do <code>?foo[]=33&amp;foo[]=55</code> pedestal generates <code>:query-params {:foo[] [33 55]}</code> (brackets are part of <code>foo</code> keyword)
Is it a bug or a feature? A PR allowing <code>rails vec-strategy</code> on query params (as a opt-in) will be welcome?
<a href="https://github.com/JulianBirch/cljs-ajax#get-specific-settings" target="_blank">https://github.com/JulianBirch/cljs-ajax#get-specific-settings</a></z><z id="t1535529496" t="lxsameer hey folks, i’m using pedestal router only. how can I use middleware/fast-resource with it. do I need to add a new route for resources ?"><y>#</y><d>2018-08-29</d><h>07:58</h><w>lxsameer</w>hey folks, i’m using pedestal router only. how can I use middleware/fast-resource with it. do I need to add a new route for resources ?</z><z id="t1535577909" t="ddeaguiar No but the fast-resource interceptor needs to come before the router interceptor"><y>#</y><d>2018-08-29</d><h>21:25</h><w>ddeaguiar</w>No but the fast-resource interceptor needs to come before the router interceptor</z><z id="t1535577913" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] ^^"><y>#</y><d>2018-08-29</d><h>21:25</h><w>ddeaguiar</w><a>@lxsameer</a> ^^</z><z id="t1535577938" t="ddeaguiar otherwise the router interceptor will try and match the request and return a 404"><y>#</y><d>2018-08-29</d><h>21:25</h><w>ddeaguiar</w>otherwise the router interceptor will try and match the request and return a 404</z><z id="t1535578133" t="ddeaguiar Just to add more context, the presence of :io.pedestal.http/resource-path in the service map leads to the resource interceptor to be conj’d onto the interceptor coll when io.pedestal.default-interceptors is invoked and :io.pedestal.http/interceptors is not present."><y>#</y><d>2018-08-29</d><h>21:28</h><w>ddeaguiar</w>Just to add more context, the presence of <code>:io.pedestal.http/resource-path</code> in the service map leads to the resource interceptor to be conj’d onto the interceptor coll when <code>io.pedestal.default-interceptors</code> is invoked and <code>:io.pedestal.http/interceptors</code> is not present.</z><z id="t1535578218" t="ddeaguiar The value of :io.pedestal.http/resource-path is used to create the resource interceptor as follows: (middlewares/resource resource-path)"><y>#</y><d>2018-08-29</d><h>21:30</h><w>ddeaguiar</w>The value of <code>:io.pedestal.http/resource-path</code> is used to create the resource interceptor as follows: <code>(middlewares/resource resource-path)</code></z><z id="t1535578270" t="ddeaguiar so you can essentially do the same thing but using io.pedestal.http.ring-middlewares/fast-resource"><y>#</y><d>2018-08-29</d><h>21:31</h><w>ddeaguiar</w>so you can essentially do the same thing but using <code>io.pedestal.http.ring-middlewares/fast-resource</code></z><z id="t1535578308" t="ddeaguiar Your container needs to support async NIO responses"><y>#</y><d>2018-08-29</d><h>21:31</h><w>ddeaguiar</w>Your container needs to support async NIO responses</z><z id="t1535578562" t="hlship We&apos;ve noticed that a route that&apos;s a handler function, where the handler returns nil, results in a 404 response. That&apos;s just what we want BUT are curious if that is intentional behavior."><y>#</y><d>2018-08-29</d><h>21:36</h><w>hlship</w>We&apos;ve noticed that a route that&apos;s a handler function, where the handler returns nil, results in a 404 response. That&apos;s just what we want BUT are curious if that is intentional behavior.</z><z id="t1535634734" t="ddeaguiar The default not-found interceptor will return a 404 response if a valid response is not found on the context. This is by design. A valid response is a map with a :status . I think the doc-string for the default not-found interceptor can be improved since &quot;An interceptor that returns a 404 when routing failed to resolve a route.&quot; does not fully capture this behavior."><y>#</y><d>2018-08-30</d><h>13:12</h><w>ddeaguiar</w>The default <code>not-found</code> interceptor will return a <code>404</code> response if a valid response is not found on the context. This is by design. A valid response is a map with a <code>:status</code>.  I think the doc-string for the default <code>not-found</code> interceptor can be improved since <code>  &quot;An interceptor that returns a 404 when routing failed to resolve a route.&quot;</code> does not fully capture this behavior.</z><z id="t1535648523" t="ikitommi Are there any examples of writing an alternative router impl for Pedestal?"><y>#</y><d>2018-08-30</d><h>17:02</h><w>ikitommi</w>Are there any examples of writing an alternative router impl for Pedestal?</z><z id="t1535648553" t="ikitommi the default router says: (defprotocol RouterSpecification (router-spec [specification router-ctor] &quot;Returns an interceptor which attempts to match each route against a :request in context. For the first route that matches, it will: - enqueue the matched route&apos;s interceptors - associate the route into the context at :route - associate a map of :path-params into the :request If no route matches, returns context with :route nil.&quot;)) "><y>#</y><d>2018-08-30</d><h>17:02</h><w>ikitommi</w>the default router says:
<pre>(defprotocol RouterSpecification
  (router-spec [specification router-ctor]
    &quot;Returns an interceptor which attempts to match each route against
    a :request in context. For the first route that matches, it will:
    - enqueue the matched route&apos;s interceptors
    - associate the route into the context at :route
    - associate a map of :path-params into the :request
  If no route matches, returns context with :route nil.&quot;))
</pre></z><z id="t1535648617" t="ikitommi how is the :route used by other components? I don’t think I would have anything like that (or at least in a format pedestal would understand). Is it ok just to push :path-params and enqueue the interceptors?"><y>#</y><d>2018-08-30</d><h>17:03</h><w>ikitommi</w>how is the <code>:route</code> used by other components? I don’t think I would have anything like that (or at least in a format pedestal would understand). Is it ok just to push <code>:path-params</code> and enqueue the interceptors?</z><z id="t1535651782" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] I don’t have the answers to this question. Try asking in the Pedestal Users group as well?"><y>#</y><d>2018-08-30</d><h>17:56</h><r>ddeaguiar</r><a>@U055NJ5CC</a> I don’t have the answers to this question. Try asking in the Pedestal Users group as well?</z><z id="t1535652210" t="ikitommi ok, thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] "><y>#</y><d>2018-08-30</d><h>18:03</h><r>ikitommi</r>ok, thanks <a>@U0FL657GR</a> </z><z id="t1535649892" t="ikitommi also, if a route is matched, but a handler returns nil ,. do I check this in the :leave by checking that there is a :response and it&apos;s nil , right?"><y>#</y><d>2018-08-30</d><h>17:24</h><w>ikitommi</w>also, if a route is matched, but a handler returns <code>nil</code>,. do I check this in the <code>:leave</code> by checking that there is a <code>:response</code> and it&apos;s <code>nil</code>, right?</z><z id="t1535650906" t="ikitommi seems so, by looking at the not-found mentioned here"><y>#</y><d>2018-08-30</d><h>17:41</h><r>ikitommi</r>seems so, by looking at the <code>not-found</code> mentioned here</z><z id="t1535658999" t="lxsameer hey folks what&apos;s the correct way to merge to vector of interceptors ? is there any helper function ?"><y>#</y><d>2018-08-30</d><h>19:56</h><w>lxsameer</w>hey folks what&apos;s the correct way to merge to vector of interceptors ? is there any helper function ?</z><z id="t1535659173" t="ddeaguiar into ?"><y>#</y><d>2018-08-30</d><h>19:59</h><w>ddeaguiar</w><code>into</code>?</z><z id="t1535659367" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] I’ve found the core collection fns to be sufficient. It’s just data"><y>#</y><d>2018-08-30</d><h>20:02</h><w>ddeaguiar</w><a>@lxsameer</a> I’ve found the core collection fns to be sufficient. It’s just data</z><z id="t1535659447" t="lxsameer but it&apos;s not gonna eliminate the duplicates , is it ?"><y>#</y><d>2018-08-30</d><h>20:04</h><w>lxsameer</w>but it&apos;s not gonna eliminate the duplicates , is it ?</z><z id="t1535659541" t="ddeaguiar nope, you do need to write that. There are no helpers that I know of"><y>#</y><d>2018-08-30</d><h>20:05</h><w>ddeaguiar</w>nope, you do need to write that. There are no helpers that I know of</z><z id="t1535659611" t="lxsameer thanks buddy"><y>#</y><d>2018-08-30</d><h>20:06</h><w>lxsameer</w>thanks buddy</z><z id="t1535659635" t="ddeaguiar np!"><y>#</y><d>2018-08-30</d><h>20:07</h><w>ddeaguiar</w>np!</z><z id="t1535702491" t="ikitommi Is there a reason why handler can’t return a core.async channel?"><y>#</y><d>2018-08-31</d><h>08:01</h><w>ikitommi</w>Is there a reason why handler can’t return a core.async channel?</z><z id="t1535721153" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] you can return a core.async channel as the response body in your handler if the container implementation implements the WriteNIOByteBody protocol. See http://pedestal.io/reference/response-bodies ."><y>#</y><d>2018-08-31</d><h>13:12</h><w>ddeaguiar</w><a>@ikitommi</a> you can return a core.async channel as the response body in your handler if the container implementation implements the <code>WriteNIOByteBody</code> protocol. See <a href="http://pedestal.io/reference/response-bodies" target="_blank">http://pedestal.io/reference/response-bodies</a>.</z><z id="t1535721168" t="ddeaguiar Jetty and Immutant do"><y>#</y><d>2018-08-31</d><h>13:12</h><w>ddeaguiar</w>Jetty and Immutant do</z><z id="t1535722121" t="ikitommi thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I think there are three async-cases: 1) interceptor returns a async context =&gt; works 2) handler function returns a async response =&gt; doesn’t 3) response has a async body =&gt; works (didn’t test thou)"><y>#</y><d>2018-08-31</d><h>13:28</h><w>ikitommi</w>thanks <a>@ddeaguiar</a> I think there are three async-cases:
1) interceptor returns a async context =&gt; works
2) handler function returns a async response =&gt; doesn’t
3) response has a async body =&gt; works (didn’t test thou)</z><z id="t1535722150" t="ddeaguiar only 1 and 3"><y>#</y><d>2018-08-31</d><h>13:29</h><w>ddeaguiar</w>only 1 and 3</z><z id="t1535722544" t="ikitommi ok, thanks."><y>#</y><d>2018-08-31</d><h>13:35</h><w>ikitommi</w>ok, thanks.</z><z id="t1535722603" t="ddeaguiar np!"><y>#</y><d>2018-08-31</d><h>13:36</h><w>ddeaguiar</w>np!</z><z id="t1535892111" t="lxsameer is there any way to debug the router interceptor ? to see why it does not match any routes ?"><y>#</y><d>2018-09-02</d><h>12:41</h><w>lxsameer</w>is there any way to debug the router interceptor ? to see why it does not match any routes ?</z><z id="t1535968307" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U28TJ0DDZ&quot;}] I put together a gist sometime ago describing various ways to test routes. https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae . I think you’ll have to step through processing to get insight as to why routes are not matching."><y>#</y><d>2018-09-03</d><h>09:51</h><w>ddeaguiar</w><a>@lxsameer</a> I put together a gist sometime ago describing various ways to test routes. <a href="https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae" target="_blank">https://gist.github.com/ddeaguiar/bed92b8f34b7e93f15cd0e5548d783ae</a>. I think you’ll have to step through processing to get insight as to why routes are  not matching.</z><z id="t1535968308" t="ddeaguiar"><y>#</y><d>2018-09-03</d><h>09:51</h><w>ddeaguiar</w></z><z id="t1535972626" t="lxsameer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] awesome, thanks man"><y>#</y><d>2018-09-03</d><h>11:03</h><w>lxsameer</w><a>@ddeaguiar</a> awesome, thanks man</z><z id="t1535973794" t="ddeaguiar np!"><y>#</y><d>2018-09-03</d><h>11:23</h><w>ddeaguiar</w>np!</z><z id="t1536091046" t="dadair Is there a particular reason the default content negotiation interceptors use content-type specific params keys (e.g., :json-params ), instead of using a standard :params key, so that later code doesn’t need to know where the content was placed?"><y>#</y><d>2018-09-04</d><h>19:57</h><w>dadair</w>Is there a particular reason the default content negotiation interceptors use content-type specific params keys (e.g., <code>:json-params</code>), instead of using a standard <code>:params</code> key, so that later code doesn’t need to know where the content was placed?</z><z id="t1536136874" t="ddeaguiar I think part of the answer is going to be about avoiding parameter collisions. For example, what to do if both query and post params are submitted. Pedestal’s position is to leave merging of params up to the user through the creation of an interceptor if that capability is desired."><y>#</y><d>2018-09-05</d><h>08:41</h><w>ddeaguiar</w>I think part of the answer is going to be about avoiding parameter collisions. For example, what to do if both query and post params are submitted. Pedestal’s position is to leave merging of params up to the user through the creation of an interceptor if that capability is desired.</z><z id="t1536266718" t="cap10morgan Has anyone published metrics from pedestal (like connection count) to Prometheus?"><y>#</y><d>2018-09-06</d><h>20:45</h><w>cap10morgan</w>Has anyone published metrics from pedestal (like connection count) to Prometheus?</z><z id="t1536313513" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06FS3DLH&quot;}] I have not but you may be interested in https://github.com/pedestal/pedestal/issues/568"><y>#</y><d>2018-09-07</d><h>09:45</h><w>ddeaguiar</w><a>@cap10morgan</a> I have not but you may be interested in <a href="https://github.com/pedestal/pedestal/issues/568" target="_blank">https://github.com/pedestal/pedestal/issues/568</a></z><z id="t1536326560" t="orestis I’m seeing some really weird behaviour with io.pedestal.http/transit-json-body and family of interceptors: &lt; Content-Type: application/transit+json;charset=UTF-8 &lt; Transfer-Encoding: chunked &lt; * Connection #0 to host localhost left intact [&quot;~#list&quot;,[[&quot;^ &quot;,&quot;~:_created&quot;,&quot;~m1421289895000&quot;,&quot;~:_id&quot;⏎"><y>#</y><d>2018-09-07</d><h>13:22</h><w>orestis</w>I’m seeing some really weird behaviour with <code>io.pedestal.http/transit-json-body</code> and family of interceptors: <pre>&lt; Content-Type: application/transit+json;charset=UTF-8
&lt; Transfer-Encoding: chunked
&lt;
* Connection #0 to host localhost left intact
[&quot;~#list&quot;,[[&quot;^ &quot;,&quot;~:_created&quot;,&quot;~m1421289895000&quot;,&quot;~:_id&quot;⏎</pre></z><z id="t1536326586" t="orestis The response should be around 250 entries, but instead it seems like the transit encoder stops after a few bytes."><y>#</y><d>2018-09-07</d><h>13:23</h><w>orestis</w>The response should be around 250 entries, but instead it seems like the transit encoder stops after a few bytes.</z><z id="t1536326650" t="orestis This is the handler: (defn get-sites [req] (let [db (database/get-connection) sites (mc/find-maps db &quot;sites&quot;)] (ring-resp/response sites))) — I can verify that sites contains all the data, and if I use instead edn-response I get everything."><y>#</y><d>2018-09-07</d><h>13:24</h><w>orestis</w>This is the handler: <pre>(defn get-sites [req]
  (let [db (database/get-connection)
        sites (mc/find-maps db &quot;sites&quot;)]
    (ring-resp/response sites)))
</pre> — I can verify that <code>sites</code> contains all the data, and if I use instead <code>edn-response</code> I get everything.</z><z id="t1536326676" t="orestis The route is composed this way: [&quot;/sites&quot; :get (conj [http/transit-json-body] `get-sites) :route-name :sites-get] "><y>#</y><d>2018-09-07</d><h>13:24</h><w>orestis</w>The route is composed this way:
<pre>[&quot;/sites&quot; :get (conj [http/transit-json-body] `get-sites) :route-name :sites-get]
</pre></z><z id="t1536326734" t="orestis I thought it might be some lazy thing since monger returns a lazy-seq, but even wrapping it with vec makes no difference."><y>#</y><d>2018-09-07</d><h>13:25</h><w>orestis</w>I thought it might be some lazy thing since monger returns a lazy-seq, but even wrapping it with <code>vec</code> makes no difference.</z><z id="t1536327018" t="orestis Ooh I have to extend json/transit to handle mongo’s ObjectIds. Hmmm"><y>#</y><d>2018-09-07</d><h>13:30</h><w>orestis</w>Ooh I have to extend json/transit to handle mongo’s ObjectIds. Hmmm</z><z id="t1536394787" t="ikitommi Built a demo of using reitit-router (with all the add-ons) with Pedestal: https://github.com/ikitommi/reitit-pedestal-swagger"><y>#</y><d>2018-09-08</d><h>08:19</h><w>ikitommi</w>Built a demo of using reitit-router (with all the add-ons) with Pedestal: <a href="https://github.com/ikitommi/reitit-pedestal-swagger" target="_blank">https://github.com/ikitommi/reitit-pedestal-swagger</a></z><z id="t1536394839" t="ikitommi Not sure if that’s the best way to swap the default router, comments welcome."><y>#</y><d>2018-09-08</d><h>08:20</h><w>ikitommi</w>Not sure if that’s the best way to swap the default router, comments welcome.</z><z id="t1536394925" t="ikitommi e.g. used the default-interceptor chain with empty routes and replaced the last interceptor in the chain (the router) with a custom one. Feels bit hacky."><y>#</y><d>2018-09-08</d><h>08:22</h><w>ikitommi</w>e.g. used the default-interceptor chain with empty routes and replaced the last interceptor in the chain (the router) with a custom one. Feels bit hacky.</z><z id="t1536420264" t="dadair Does the router interceptor have a qualified name? Could search for the router in the interceptor list and swap it, instead of assuming last position?"><y>#</y><d>2018-09-08</d><h>15:24</h><w>dadair</w>Does the router interceptor have a qualified name? Could search for the router in the interceptor list and swap it, instead of assuming last position?</z><z id="t1536422205" t="ikitommi [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] sounds like a good idea, it seems to have a name :io.pedestal.http.route/router . Easy to do, but are there any existing helpers to swap a interceptor by name?"><y>#</y><d>2018-09-08</d><h>15:56</h><w>ikitommi</w><a>@dadair</a> sounds like a good idea, it seems to have a name <code>:io.pedestal.http.route/router</code>. Easy to do, but are there any existing helpers to swap a interceptor by name?</z><z id="t1536422411" t="dadair Looking at the codex I don’t think so, and I’d doubt it given that it’s a pure data transformation."><y>#</y><d>2018-09-08</d><h>16:00</h><w>dadair</w>Looking at the codex I don’t think so, and I’d doubt it given that it’s a pure data transformation.</z><z id="t1536434796" t="ikitommi thanks [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] , much better ( https://github.com/ikitommi/reitit-pedestal-swagger/blob/master/src/example/router.clj#L34-L36 )"><y>#</y><d>2018-09-08</d><h>19:26</h><w>ikitommi</w>thanks <a>@dadair</a>, much better (<a href="https://github.com/ikitommi/reitit-pedestal-swagger/blob/master/src/example/router.clj#L34-L36" target="_blank">https://github.com/ikitommi/reitit-pedestal-swagger/blob/master/src/example/router.clj#L34-L36</a>)</z><z id="t1536435718" t="dadair btw I recently swapped out my content-negotiation interceptors with muuntaja, works great! Thanks for all of Metosin’s great libs!"><y>#</y><d>2018-09-08</d><h>19:41</h><r>dadair</r>btw I recently swapped out my content-negotiation interceptors with muuntaja, works great! Thanks for all of Metosin’s great libs!</z><z id="t1536478319" t="ikitommi cool, thanks!"><y>#</y><d>2018-09-09</d><h>07:31</h><r>ikitommi</r>cool, thanks!</z><z id="t1536498175" t="martinklepsch Is there anything special that needs to be done to get path params as UTF-8 strings? i.e. I&apos;m getting io.pedestal.http {:msg &quot;GET /d/lambdaisland/kaocha/0.0-118/doc/01-kaocha-%E8%80%83%E5%AF%9F&quot;, :line 80} but want /d/lambdaisland/kaocha/0.0-118/doc/01-kaocha-考察 "><y>#</y><d>2018-09-09</d><h>13:02</h><w>martinklepsch</w>Is there anything special that needs to be done to get path params as UTF-8 strings? i.e. I&apos;m getting
<pre>io.pedestal.http {:msg &quot;GET /d/lambdaisland/kaocha/0.0-118/doc/01-kaocha-%E8%80%83%E5%AF%9F&quot;, :line 80}
</pre>
but want
<pre>/d/lambdaisland/kaocha/0.0-118/doc/01-kaocha-考察
</pre></z><z id="t1536505508" t="martinklepsch https://github.com/cljdoc/cljdoc/issues/113"><y>#</y><d>2018-09-09</d><h>15:05</h><w>martinklepsch</w><a href="https://github.com/cljdoc/cljdoc/issues/113" target="_blank">https://github.com/cljdoc/cljdoc/issues/113</a></z><z id="t1536505524" t="martinklepsch Some more details regarding the UTF-8 question above"><y>#</y><d>2018-09-09</d><h>15:05</h><w>martinklepsch</w>Some more details regarding the UTF-8 question above</z><z id="t1536676046" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I think this issue is related to what you are observing. https://github.com/pedestal/pedestal/issues/588"><y>#</y><d>2018-09-11</d><h>14:27</h><w>ddeaguiar</w><a>@martinklepsch</a> I think this issue is related to what you are observing. <a href="https://github.com/pedestal/pedestal/issues/588" target="_blank">https://github.com/pedestal/pedestal/issues/588</a></z><z id="t1536676113" t="martinklepsch oh yeah, that does look like it could be the issue"><y>#</y><d>2018-09-11</d><h>14:28</h><w>martinklepsch</w>oh yeah, that does look like it could be the issue</z><z id="t1536676236" t="martinklepsch should level-up my github search fu 😄"><y>#</y><d>2018-09-11</d><h>14:30</h><w>martinklepsch</w>should level-up my github search fu <b>😄</b></z><z id="t1536676397" t="ddeaguiar np, I ran into that a few weeks ago as well"><y>#</y><d>2018-09-11</d><h>14:33</h><w>ddeaguiar</w>np, I ran into that a few weeks ago as well</z><z id="t1536792742" t="hlship So there are still not any release notes for 0.5.4 that I can find. CHANGES.MD doesn&apos;t have anything on 0.5.4."><y>#</y><d>2018-09-12</d><h>22:52</h><w>hlship</w>So there are still not any release notes for 0.5.4 that I can find.  CHANGES.MD doesn&apos;t have anything on 0.5.4.</z><z id="t1536793907" t="hlship Just got burned by https://github.com/pedestal/pedestal/issues/557"><y>#</y><d>2018-09-12</d><h>23:11</h><w>hlship</w>Just got burned by <a href="https://github.com/pedestal/pedestal/issues/557" target="_blank">https://github.com/pedestal/pedestal/issues/557</a></z><z id="t1536794012" t="hlship Maybe update CHANGES.md ? Or change it to a link to the real change notes?"><y>#</y><d>2018-09-12</d><h>23:13</h><w>hlship</w>Maybe update CHANGES.md ?  Or change it to a link to the real change notes?</z><z id="t1536845805" t="ddeaguiar Thanks [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] . I’ve created a PR which updates the changelog. More detailed release notes can be found here: https://github.com/pedestal/pedestal/releases/tag/0.5.4 . I’ll make sure to keep the changelog up to date in the future."><y>#</y><d>2018-09-13</d><h>13:36</h><w>ddeaguiar</w>Thanks <a>@hlship</a>. I’ve created a PR which updates the changelog. More detailed release notes can be found here: <a href="https://github.com/pedestal/pedestal/releases/tag/0.5.4" target="_blank">https://github.com/pedestal/pedestal/releases/tag/0.5.4</a>. I’ll make sure to keep the changelog up to date in the future.</z><z id="t1536845829" t="ddeaguiar Sorry you got burned by this issue and the lack of communication around the breaking change."><y>#</y><d>2018-09-13</d><h>13:37</h><w>ddeaguiar</w>Sorry you got burned by this issue and the lack of communication around the breaking change.</z><z id="t1536875694" t="hlship Sorry I was a bit terse there yesterday, I was really under the gun. Fortunately, caught in our QA environment."><y>#</y><d>2018-09-13</d><h>21:54</h><w>hlship</w>Sorry I was a bit terse there yesterday, I was really under the gun. Fortunately, caught in our QA environment.</z><z id="t1536920174" t="deadghost are there any OPTIONS interceptors or do I need to write my own?"><y>#</y><d>2018-09-14</d><h>10:16</h><w>deadghost</w>are there any OPTIONS interceptors or do I need to write my own?</z><z id="t1536926256" t="souenzzo [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] default-interceptors should do that. I don&apos;t have any code about options and it&apos;s handled in my app You may need ::http/secure-headers {:content-security-policy-settings ...} in your service map and maybe ::http/allowed-origins"><y>#</y><d>2018-09-14</d><h>11:57</h><w>souenzzo</w><a>@deadghost</a>
<code>default-interceptors</code> should do that. I don&apos;t have any code about options and it&apos;s handled in my app
You may need <code>::http/secure-headers    {:content-security-policy-settings ...}</code> in your service map and maybe <code>::http/allowed-origins</code></z><z id="t1536997469" t="deadghost thanks, not exactly sure what changed but it&apos;s working now"><y>#</y><d>2018-09-15</d><h>07:44</h><w>deadghost</w>thanks, not exactly sure what changed but it&apos;s working now</z><z id="t1537017012" t="dadair Note that if you use default-interceptors, if you have provided your own interceptors at :: http/interceptors before default-interceptors gets called, then the function does not add any default interceptors. If you had set the interceptors directly then default-interceptors may have not added the CORS interceptors?"><y>#</y><d>2018-09-15</d><h>13:10</h><w>dadair</w>Note that if you use default-interceptors, if you have provided your own interceptors at <b>::</b>http/interceptors before default-interceptors gets called, then the function does not add any default interceptors. If you had set the interceptors directly then default-interceptors may have not added the CORS interceptors?</z><z id="t1537209711" t="deadghost any interceptors to keyify request headers?"><y>#</y><d>2018-09-17</d><h>18:41</h><w>deadghost</w>any interceptors to keyify request headers?</z><z id="t1537211196" t="deadghost particularly cookies because it&apos;s in some-key=some-value; format"><y>#</y><d>2018-09-17</d><h>19:06</h><w>deadghost</w>particularly cookies because it&apos;s in <code>some-key=some-value;</code> format</z><z id="t1537211219" t="deadghost don&apos;t want to be reinventing wheels when this almost 100% is already written somewhere"><y>#</y><d>2018-09-17</d><h>19:06</h><w>deadghost</w>don&apos;t want to be reinventing wheels when this almost 100% is already written somewhere</z><z id="t1537211260" t="deadghost I looked through the default interceptors stack and don&apos;t see any that would apply"><y>#</y><d>2018-09-17</d><h>19:07</h><w>deadghost</w>I looked through the default interceptors stack and don&apos;t see any that would apply</z><z id="t1537211282" t="deadghost would be great if there&apos;s a supplementary list of often used interceptors"><y>#</y><d>2018-09-17</d><h>19:08</h><w>deadghost</w>would be great if there&apos;s a supplementary list of often used interceptors</z><z id="t1537213402" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] you’ll have to write your own interceptor to keyify headers in general but you’ll be interested in the cookies interceptor. https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78"><y>#</y><d>2018-09-17</d><h>19:43</h><w>ddeaguiar</w><a>@deadghost</a> you’ll have to write your own interceptor to keyify headers in general but you’ll be interested in the <code>cookies</code> interceptor. <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78</a></z><z id="t1537213421" t="ddeaguiar It just wraps the rings cookie middleware"><y>#</y><d>2018-09-17</d><h>19:43</h><w>ddeaguiar</w>It just wraps the rings cookie middleware</z><z id="t1537213456" t="ddeaguiar There are other useful interceptors in the io.pedestal.http/ring_middlewares ns as well. http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html"><y>#</y><d>2018-09-17</d><h>19:44</h><w>ddeaguiar</w>There are other useful interceptors in the <code>io.pedestal.http/ring_middlewares</code> ns as well. <a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.ring-middlewares.html</a></z><z id="t1537260879" t="deadghost yeah thanks, got cookies working"><y>#</y><d>2018-09-18</d><h>08:54</h><w>deadghost</w>yeah thanks, got cookies working</z><z id="t1537331709" t="caleb.macdonaldblack Can I run pedestal behind something other than a http server, such as an AWS lambda or a cli tool? I’m mainly interested in using pedestals routing and interceptor chain"><y>#</y><d>2018-09-19</d><h>04:35</h><w>caleb.macdonaldblack</w>Can I run pedestal behind something other than a http server, such as an AWS lambda or a cli tool? I’m mainly interested in using pedestals routing and interceptor chain</z><z id="t1537332244" t="dadair Routing and chain can be used/run independently as libraries "><y>#</y><d>2018-09-19</d><h>04:44</h><w>dadair</w>Routing and chain can be used/run independently as libraries </z><z id="t1537361484" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] Pedestal provides an interceptor chain provider for AWS API Gateway + Lambda. Check out the sample app: https://github.com/pedestal/pedestal/tree/master/samples/aws-codestar-lambda"><y>#</y><d>2018-09-19</d><h>12:51</h><w>ddeaguiar</w><a>@caleb.macdonaldblack</a> Pedestal provides an interceptor chain provider for AWS API Gateway + Lambda. Check out the sample app: <a href="https://github.com/pedestal/pedestal/tree/master/samples/aws-codestar-lambda" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/aws-codestar-lambda</a></z><z id="t1537361689" t="caleb.macdonaldblack [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks! "><y>#</y><d>2018-09-19</d><h>12:54</h><w>caleb.macdonaldblack</w><a>@dadair</a> <a>@ddeaguiar</a> thanks! </z><z id="t1537361708" t="ddeaguiar np!"><y>#</y><d>2018-09-19</d><h>12:55</h><w>ddeaguiar</w>np!</z><z id="t1537433978" t="mavbozo in http://pedestal.io/reference/interceptors#_example , a sample interceptor is like this"><y>#</y><d>2018-09-20</d><h>08:59</h><w>mavbozo</w>in <a href="http://pedestal.io/reference/interceptors#_example" target="_blank">http://pedestal.io/reference/interceptors#_example</a> , a sample interceptor is like this</z><z id="t1537433999" t="mavbozo"><y>#</y><d>2018-09-20</d><h>08:59</h><w>mavbozo</w></z><z id="t1537434039" t="mavbozo but io.pedestal.interceptor/interceptor? returns false for interceptor like above"><y>#</y><d>2018-09-20</d><h>09:00</h><w>mavbozo</w>but  io.pedestal.interceptor/interceptor? returns false for interceptor like above</z><z id="t1537434086" t="mavbozo"><y>#</y><d>2018-09-20</d><h>09:01</h><w>mavbozo</w></z><z id="t1537434144" t="orestis interceptor? only checks for the type: (defn interceptor? [o] (= (type o) Interceptor))"><y>#</y><d>2018-09-20</d><h>09:02</h><w>orestis</w><code>interceptor?</code> only checks for the type: <pre>(defn interceptor?
  [o]
  (= (type o) Interceptor))</pre></z><z id="t1537434195" t="orestis You might want to use (satisfies? IntoInterceptor t) which is what io.pedestal.interceptor/interceptor uses to as a pre-condition."><y>#</y><d>2018-09-20</d><h>09:03</h><w>orestis</w>You might want to use <code>(satisfies? IntoInterceptor t)</code> which is what <code>io.pedestal.interceptor/interceptor</code> uses to as a pre-condition.</z><z id="t1537434202" t="orestis https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L78"><y>#</y><d>2018-09-20</d><h>09:03</h><w>orestis</w><a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L78" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor.clj#L78</a></z><z id="t1537434391" t="mavbozo i tried to update to pedestal 0.5.4 from 0.5.3 and io.pedestal.interceptor.chain/enqueue threw AssertionError in my codebase because I enqueue hash-map based interceptor like my hello-world example above"><y>#</y><d>2018-09-20</d><h>09:06</h><w>mavbozo</w>i tried to update to pedestal 0.5.4 from 0.5.3 and <code>io.pedestal.interceptor.chain/enqueue</code> threw AssertionError in my codebase because I enqueue hash-map based interceptor like my <code>hello-world</code> example above</z><z id="t1537434469" t="mavbozo"><y>#</y><d>2018-09-20</d><h>09:07</h><w>mavbozo</w></z><z id="t1537434476" t="orestis I guess you have to wrap attach-guid with a call to interceptor ."><y>#</y><d>2018-09-20</d><h>09:07</h><w>orestis</w>I guess you have to wrap <code>attach-guid</code> with a call to <code>interceptor</code>.</z><z id="t1537434565" t="orestis so sth like (io.pedestal.interceptor.chain/enqueue ctx [(io.pedestal.interceptor/interceptor hello-world)])"><y>#</y><d>2018-09-20</d><h>09:09</h><w>orestis</w>so sth like <code>(io.pedestal.interceptor.chain/enqueue ctx [(io.pedestal.interceptor/interceptor hello-world)])</code></z></g><g id="s13"><z id="t1537434580" t="orestis NB: I’m just looking at the source, I haven’t actually tried any of this 🙂"><y>#</y><d>2018-09-20</d><h>09:09</h><w>orestis</w>NB: I’m just looking at the source, I haven’t actually tried any of this <b>🙂</b></z><z id="t1537434619" t="mavbozo yup, wrapping my hash-map based interceptor with i.p.i/interceptor works"><y>#</y><d>2018-09-20</d><h>09:10</h><w>mavbozo</w>yup, wrapping my hash-map based interceptor with <code>i.p.i/interceptor</code> works</z><z id="t1537434699" t="mavbozo it&apos;s because in pedestal 0.5.3 the pre assertion doesn&apos;t work https://github.com/pedestal/pedestal/blob/0.5.3/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281"><y>#</y><d>2018-09-20</d><h>09:11</h><w>mavbozo</w>it&apos;s because in pedestal 0.5.3 the pre assertion doesn&apos;t work <a href="https://github.com/pedestal/pedestal/blob/0.5.3/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.3/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281</a></z><z id="t1537434775" t="mavbozo it&apos;s fixed in 0.5.4 which throw assertion errors in my codebase https://github.com/pedestal/pedestal/blob/0.5.4/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281"><y>#</y><d>2018-09-20</d><h>09:12</h><w>mavbozo</w>it&apos;s fixed in 0.5.4 which throw assertion errors in my codebase <a href="https://github.com/pedestal/pedestal/blob/0.5.4/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.4/interceptor/src/io/pedestal/interceptor/chain.clj#L273-L281</a></z><z id="t1537435414" t="mavbozo should we change io.pedestal.interceptor/interceptor? implementation to using (satisfies? IntoInterceptor t) so that the implementation correctly satisifies pedestal interceptor reference?"><y>#</y><d>2018-09-20</d><h>09:23</h><w>mavbozo</w>should we change <code>io.pedestal.interceptor/interceptor?</code> implementation to using <code>(satisfies? IntoInterceptor t)</code> so that the implementation correctly satisifies pedestal interceptor reference?</z><z id="t1537553036" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] the underlying implementation is intended to work with an Interceptor record as opposed to implementations that satisfy IntoInterceptor . The intent is to minimize checks at the time of execution. I consider the ability to enqueue things that implement IntoInterceptor but are not an Interceptor record to be unintended. It’s appropriate to use the io.pedestal.interceptor/interceptor constructor when creating interceptors."><y>#</y><d>2018-09-21</d><h>18:03</h><w>ddeaguiar</w><a>@mavbozo</a> the underlying implementation is intended to work with an <code>Interceptor</code> record as opposed to implementations that satisfy <code>IntoInterceptor</code>. The intent is to minimize checks at the time of execution. I consider the ability to enqueue things that implement <code>IntoInterceptor</code> but are not an <code>Interceptor</code> record to be unintended. It’s appropriate to use the <code>io.pedestal.interceptor/interceptor</code> constructor when creating interceptors.</z><z id="t1537683054" t="jaihindhreddy-duplicate What&apos;s the idiomatic way to think about side effects (talking to the database, and others over the network) when organizing code with interceptors?"><y>#</y><d>2018-09-23</d><h>06:10</h><w>jaihindhreddy-duplicate</w>What&apos;s the idiomatic way to think about side effects (talking to the database, and others over the network) when organizing code with interceptors?</z><z id="t1537705040" t="mavbozo [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you for the explanation"><y>#</y><d>2018-09-23</d><h>12:17</h><w>mavbozo</w><a>@ddeaguiar</a> thank you for the explanation</z><z id="t1537705541" t="mavbozo [:attrs {:href &quot;/_/_/users/UBU6QCSJH&quot;}] i find making smaller interceptors that do side-effects and naming the interceptors by what side effects they do helps, like get-user-from-db , send-welcome-email"><y>#</y><d>2018-09-23</d><h>12:25</h><w>mavbozo</w><a>@jaihindh.reddy</a> i find making smaller interceptors that do side-effects and naming the interceptors by what side effects they do helps, like <code>get-user-from-db</code> , <code>send-welcome-email</code></z><z id="t1537727442" t="deadghost https://gist.github.com/deadghost/fc8ef2ab52d0946fc09a6402497cbad4"><y>#</y><d>2018-09-23</d><h>18:30</h><w>deadghost</w><a href="https://gist.github.com/deadghost/fc8ef2ab52d0946fc09a6402497cbad4" target="_blank">https://gist.github.com/deadghost/fc8ef2ab52d0946fc09a6402497cbad4</a></z><z id="t1537727470" t="deadghost I tried moving interceptors from my route handlers to my defaults"><y>#</y><d>2018-09-23</d><h>18:31</h><w>deadghost</w>I tried moving interceptors from my route handlers to my defaults</z><z id="t1537727642" t="deadghost response gives application/edn Content-Type header"><y>#</y><d>2018-09-23</d><h>18:34</h><w>deadghost</w>response gives application/edn Content-Type header</z><z id="t1537727649" t="deadghost when the request was for json"><y>#</y><d>2018-09-23</d><h>18:34</h><w>deadghost</w>when the request was for json</z><z id="t1537727677" t="deadghost and the body is a hashed up string"><y>#</y><d>2018-09-23</d><h>18:34</h><w>deadghost</w>and the body is a hashed up string</z><z id="t1537727751" t="deadghost my print in coerce-body doesn&apos;t trigger so it doesn&apos;t even seem to get called"><y>#</y><d>2018-09-23</d><h>18:35</h><w>deadghost</w>my print in coerce-body doesn&apos;t trigger so it doesn&apos;t even seem to get called</z><z id="t1537727828" t="deadghost both content-negotiate and coerce-body are from doc examples"><y>#</y><d>2018-09-23</d><h>18:37</h><w>deadghost</w>both content-negotiate and coerce-body are from doc examples</z><z id="t1537727841" t="deadghost and work fine if used in a route stack"><y>#</y><d>2018-09-23</d><h>18:37</h><w>deadghost</w>and work fine if used in a route stack</z><z id="t1537769149" t="mavbozo [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] you put those 3 interceptors at the end of interceptor chain, ex: ::http/interceptors becomes [... your-interceptors ... mw-cookies intc/content-negotiate intc/coerce-body] ."><y>#</y><d>2018-09-24</d><h>06:05</h><w>mavbozo</w><a>@deadghost</a> you put those 3 interceptors at the end of interceptor chain, ex: <code>::http/interceptors</code> becomes <code>[... your-interceptors ... mw-cookies intc/content-negotiate intc/coerce-body]</code>.</z><z id="t1537769272" t="mavbozo https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http.clj#L272-L277"><y>#</y><d>2018-09-24</d><h>06:07</h><w>mavbozo</w><a href="https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http.clj#L272-L277" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http.clj#L272-L277</a></z><z id="t1537769330" t="mavbozo above contain example to add interceptor(s) to the service map after default-interceptors applied to service map"><y>#</y><d>2018-09-24</d><h>06:08</h><w>mavbozo</w>above contain example to add interceptor(s) to the service map after <code>default-interceptors</code> applied to service map</z><z id="t1537789502" t="deadghost [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] thanks for the tip, still not working after several reorder tries"><y>#</y><d>2018-09-24</d><h>11:45</h><w>deadghost</w><a>@mavbozo</a> thanks for the tip, still not working after several reorder tries</z><z id="t1537810014" t="deadghost default interceptors get run before route specific interceptors right?"><y>#</y><d>2018-09-24</d><h>17:26</h><w>deadghost</w>default interceptors get run before route specific interceptors right?</z><z id="t1537810637" t="mavbozo [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] yep"><y>#</y><d>2018-09-24</d><h>17:37</h><w>mavbozo</w><a>@deadghost</a> yep</z><z id="t1537810923" t="mavbozo it is more precise to say that io.pedestal.http/default-interceptors creates interceptors based on the options given then creates routing interceptor and finally conj those interceptors to :io.pedestal.http/interceptors key in the service map"><y>#</y><d>2018-09-24</d><h>17:42</h><w>mavbozo</w>it is more precise to say that <code>io.pedestal.http/default-interceptors</code> creates interceptors based on the options given then creates routing interceptor and finally conj those interceptors to <code>:io.pedestal.http/interceptors</code> key in the service map</z><z id="t1537818078" t="deadghost ended up getting content-negotiate working as a default interceptor"><y>#</y><d>2018-09-24</d><h>19:41</h><w>deadghost</w>ended up getting <code>content-negotiate</code> working as a default interceptor</z><z id="t1537818102" t="deadghost no idea why I can&apos;t get it working with coerce-body"><y>#</y><d>2018-09-24</d><h>19:41</h><w>deadghost</w>no idea why I can&apos;t get it working with <code>coerce-body</code></z><z id="t1537818335" t="deadghost I thought it&apos;d be fine to have it at the top of the default interceptor stack because then it will 100% be registered before a :response short circuits the thing, and as it is at the top it should be the last interceptor to be applied"><y>#</y><d>2018-09-24</d><h>19:45</h><w>deadghost</w>I thought it&apos;d be fine to have it at the top of the default interceptor stack because then it will 100% be registered before a <code>:response</code> short circuits the thing, and as it is at the top it should be the last interceptor to be applied</z><z id="t1537818389" t="deadghost I have a print in coerce-body which prints as a route interceptor but not a default interceptor meaning it&apos;s highly likely it&apos;s just not being called for some reason"><y>#</y><d>2018-09-24</d><h>19:46</h><w>deadghost</w>I have a print in <code>coerce-body</code> which prints as a route interceptor but not a default interceptor meaning it&apos;s highly likely it&apos;s just not being called for some reason</z><z id="t1537819207" t="deadghost I see the default interceptors I have working are of type io.pedestal.interceptor.Interceptor while the one I&apos;m having issue with is an interceptor spec of type clojure.lang.PersistentArrayMap"><y>#</y><d>2018-09-24</d><h>20:00</h><w>deadghost</w>I see the default interceptors I have working are of type <code>io.pedestal.interceptor.Interceptor</code> while the one I&apos;m having issue with is an interceptor spec of type <code>clojure.lang.PersistentArrayMap</code></z><z id="t1537819232" t="deadghost do I need to take an additional step to convert the map into an Interceptor?"><y>#</y><d>2018-09-24</d><h>20:00</h><w>deadghost</w>do I need to take an additional step to convert the map into an Interceptor?</z><z id="t1537820438" t="ddeaguiar yes, use the io.pedestal.interceptor/interceptor function to create your interceptor."><y>#</y><d>2018-09-24</d><h>20:20</h><w>ddeaguiar</w>yes, use the <code>io.pedestal.interceptor/interceptor</code> function to create your interceptor.</z><z id="t1537820455" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] ^^"><y>#</y><d>2018-09-24</d><h>20:20</h><w>ddeaguiar</w><a>@deadghost</a> ^^</z><z id="t1537864065" t="deadghost nope, still not working"><y>#</y><d>2018-09-25</d><h>08:27</h><w>deadghost</w>nope, still not working</z><z id="t1537864133" t="deadghost my coerce-body just seems to get skipped over no matter where I put it in the default interceptors stack"><y>#</y><d>2018-09-25</d><h>08:28</h><w>deadghost</w>my <code>coerce-body</code> just seems to get skipped over no matter where I put it in the default interceptors stack</z><z id="t1537864712" t="orestis Is it a :leave or an :enter concern?"><y>#</y><d>2018-09-25</d><h>08:38</h><w>orestis</w>Is it a <code>:leave</code> or an <code>:enter</code> concern?</z><z id="t1537864780" t="deadghost :leave"><y>#</y><d>2018-09-25</d><h>08:39</h><w>deadghost</w><code>:leave</code></z><z id="t1537864843" t="orestis If you paste a relevant snippet I might be able to help more — it seems like it should work if it is at the top of the stack, after all the default interceptors. I’ve done this in my own experiments with minimal fuss."><y>#</y><d>2018-09-25</d><h>08:40</h><w>orestis</w>If you paste a relevant snippet I might be able to help more — it seems like it should work if it is at the top of the stack, after all the default interceptors. I’ve done this in my own experiments with minimal fuss.</z><z id="t1537864910" t="deadghost [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] https://gist.github.com/deadghost/92915712227882f7bfe7d3af42988951"><y>#</y><d>2018-09-25</d><h>08:41</h><w>deadghost</w><a>@orestis</a> <a href="https://gist.github.com/deadghost/92915712227882f7bfe7d3af42988951" target="_blank">https://gist.github.com/deadghost/92915712227882f7bfe7d3af42988951</a></z><z id="t1537864924" t="deadghost pretty much 1:1 with pedestal guide example"><y>#</y><d>2018-09-25</d><h>08:42</h><w>deadghost</w>pretty much 1:1 with pedestal guide example</z><z id="t1537864938" t="deadghost works in route interceptor stack"><y>#</y><d>2018-09-25</d><h>08:42</h><w>deadghost</w>works in route interceptor stack</z><z id="t1537864948" t="deadghost doesn&apos;t work when I put it into the default stack"><y>#</y><d>2018-09-25</d><h>08:42</h><w>deadghost</w>doesn&apos;t work when I put it into the default stack</z><z id="t1537865056" t="deadghost https://gist.github.com/deadghost/bee98e65d29bf242c7428d880680470d default stack snippet"><y>#</y><d>2018-09-25</d><h>08:44</h><w>deadghost</w><a href="https://gist.github.com/deadghost/bee98e65d29bf242c7428d880680470d" target="_blank">https://gist.github.com/deadghost/bee98e65d29bf242c7428d880680470d</a> default stack snippet</z><z id="t1537865180" t="orestis Hm, I missed the default stack issue. All I can suggest is, try putting an enter interceptor there as well that prints the interceptor queue? Or perhaps some other interceptor there is calling terminate early so your interceptor is never running?"><y>#</y><d>2018-09-25</d><h>08:46</h><w>orestis</w>Hm, I missed the default stack issue. All I can suggest is, try putting an <code>enter</code> interceptor there as well that prints the interceptor queue? Or perhaps some other interceptor there is calling <code>terminate</code> early so your interceptor is never running?</z><z id="t1537865230" t="deadghost I&apos;ll try your enter suggestion"><y>#</y><d>2018-09-25</d><h>08:47</h><w>deadghost</w>I&apos;ll try your <code>enter</code> suggestion</z><z id="t1537865232" t="orestis I’m not 100% sure what’s going on if you call terminate on the way out."><y>#</y><d>2018-09-25</d><h>08:47</h><w>orestis</w>I’m not 100% sure what’s going on if you call terminate on the way out.</z><z id="t1537865262" t="orestis Are proute and mw your own dependencies or pedestal’s defaults?"><y>#</y><d>2018-09-25</d><h>08:47</h><w>orestis</w>Are <code>proute</code> and <code>mw</code> your own dependencies or pedestal’s defaults?</z><z id="t1537865266" t="deadghost defaults"><y>#</y><d>2018-09-25</d><h>08:47</h><w>deadghost</w>defaults</z><z id="t1537865288" t="deadghost was tired of conj, cons, whatever to pedestal&apos;s defaults"><y>#</y><d>2018-09-25</d><h>08:48</h><w>deadghost</w>was tired of conj, cons, whatever to pedestal&apos;s defaults</z><z id="t1537865304" t="deadghost easier to see the full stack if I just put it all in a vector"><y>#</y><d>2018-09-25</d><h>08:48</h><w>deadghost</w>easier to see the full stack if I just put it all in a vector</z><z id="t1537865317" t="deadghost and no it doesn&apos;t work any better when I call the defaults fn"><y>#</y><d>2018-09-25</d><h>08:48</h><w>deadghost</w>and no it doesn&apos;t work any better when I call the defaults fn</z><z id="t1537865354" t="orestis Would ::http/routes have any effect on the router there? I vaguely remember that all this configuration is only needed to create the default interceptor stack, otherwise you’re on your own."><y>#</y><d>2018-09-25</d><h>08:49</h><w>orestis</w>Would <code>::http/routes</code> have any effect on the router there? I vaguely remember that all this configuration is only needed to create the default interceptor stack, otherwise you’re on your own.</z><z id="t1537865416" t="orestis At this point I’d break out the debugger, if you can."><y>#</y><d>2018-09-25</d><h>08:50</h><w>orestis</w>At this point I’d break out the debugger, if you can.</z><z id="t1537871059" t="deadghost https://gist.github.com/deadghost/cbf49f2faa50ba56e8a43cda3326538b"><y>#</y><d>2018-09-25</d><h>10:24</h><w>deadghost</w><a href="https://gist.github.com/deadghost/cbf49f2faa50ba56e8a43cda3326538b" target="_blank">https://gist.github.com/deadghost/cbf49f2faa50ba56e8a43cda3326538b</a></z><z id="t1537871070" t="deadghost I must be doing something fundamentally wrong"><y>#</y><d>2018-09-25</d><h>10:24</h><w>deadghost</w>I must be doing something fundamentally wrong</z><z id="t1537871106" t="deadghost because with just that inspect interceptor and the router interceptor`"><y>#</y><d>2018-09-25</d><h>10:25</h><w>deadghost</w>because with just that <code>inspect</code> interceptor and the <code>router</code> interceptor`</z><z id="t1537871116" t="deadghost nothing gets printed"><y>#</y><d>2018-09-25</d><h>10:25</h><w>deadghost</w>nothing gets printed</z><z id="t1537871131" t="deadghost inspect works as a route interceptor as well"><y>#</y><d>2018-09-25</d><h>10:25</h><w>deadghost</w><code>inspect</code> works as a route interceptor as well</z><z id="t1537871137" t="deadghost but not as a default interceptor"><y>#</y><d>2018-09-25</d><h>10:25</h><w>deadghost</w>but not as a default interceptor</z><z id="t1537875462" t="orestis I suspect that the issue is the way you create your default interceptor/servlet stack."><y>#</y><d>2018-09-25</d><h>11:37</h><w>orestis</w>I suspect that the issue is the way you create your default interceptor/servlet stack.</z><z id="t1537875596" t="orestis Looking at https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L254 , it seems that some of those interceptors are wrapped with interceptor , some are passed extra arguments, etc. It’s not clear in your server snippet what are you passing in."><y>#</y><d>2018-09-25</d><h>11:39</h><w>orestis</w>Looking at <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L254" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L254</a>, it seems that some of those interceptors are wrapped with <code>interceptor</code>, some are passed extra arguments, etc. It’s not clear in your server snippet what are you passing in.</z><z id="t1537875792" t="orestis I’m not an expert in pedestal and this part of the code seems quite hairy to me, so I can’t help any further there — other than to suggest that it might make sense to adopt the official way to do things?"><y>#</y><d>2018-09-25</d><h>11:43</h><w>orestis</w>I’m not an expert in pedestal and this part of the code seems quite hairy to me, so I can’t help any further there — other than to suggest that it might make sense to adopt the official way to do things?</z><z id="t1537876155" t="deadghost [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] found the problem"><y>#</y><d>2018-09-25</d><h>11:49</h><w>deadghost</w><a>@orestis</a> found the problem</z><z id="t1537876163" t="deadghost it&apos;s a really stupid mistake"><y>#</y><d>2018-09-25</d><h>11:49</h><w>deadghost</w>it&apos;s a really stupid mistake</z><z id="t1537876201" t="deadghost I&apos;ve been editing the production interceptors instead of the dev"><y>#</y><d>2018-09-25</d><h>11:50</h><w>deadghost</w>I&apos;ve been editing the production interceptors instead of the dev</z><z id="t1537876239" t="deadghost what a waste of two days"><y>#</y><d>2018-09-25</d><h>11:50</h><w>deadghost</w>what a waste of two days</z><z id="t1537876707" t="orestis We’ve all been there 🙂"><y>#</y><d>2018-09-25</d><h>11:58</h><w>orestis</w>We’ve all been there <b>🙂</b></z><z id="t1537879566" t="mavbozo 😅 my recent stupid mistake was I wasn&apos;t aware that servlet-interceptor terminates chain execution when it encounters valid ring-response in context&apos;s :response , the executors removes the rest of the :queue from the context and starts processing :leave stages. I should have properly read servlet-interceptor reference here http://pedestal.io/reference/servlet-interceptor"><y>#</y><d>2018-09-25</d><h>12:46</h><w>mavbozo</w><b>😅</b> my recent stupid mistake was I wasn&apos;t aware that servlet-interceptor terminates chain execution when it encounters valid ring-response in context&apos;s <code>:response</code>, the executors removes the rest of the <code>:queue</code> from the context and starts processing <code>:leave</code> stages. I should have properly read servlet-interceptor reference here <a href="http://pedestal.io/reference/servlet-interceptor" target="_blank">http://pedestal.io/reference/servlet-interceptor</a></z><z id="t1537879626" t="deadghost [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] my current issue is I have an authentication interceptor that does attach a non-nil :response but it doesn&apos;t appear to short-circuit"><y>#</y><d>2018-09-25</d><h>12:47</h><w>deadghost</w><a>@mavbozo</a> my current issue is I have an <code>authentication</code> interceptor that does attach a non-nil <code>:response</code> but it doesn&apos;t appear to short-circuit</z><z id="t1537880033" t="mavbozo [:attrs {:href &quot;/_/_/users/U4QFG68K1&quot;}] woops.. I made mistake above. by reading the servlet-interceptor codes I found that servlet-interceptor terminates when it encounters valid ring-response in the context&apos;s :response . I&apos;ve edited my message above."><y>#</y><d>2018-09-25</d><h>12:53</h><w>mavbozo</w><a>@deadghost</a> woops.. I made mistake above. by reading the servlet-interceptor codes I found that servlet-interceptor terminates when it encounters valid ring-response in the context&apos;s <code>:response</code>. I&apos;ve edited my message above.</z><z id="t1537880123" t="mavbozo this is the relevant code https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L232-L234"><y>#</y><d>2018-09-25</d><h>12:55</h><w>mavbozo</w>this is the relevant code <a href="https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L232-L234" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.4/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L232-L234</a></z><z id="t1537880432" t="deadghost [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] huh thanks for the tip"><y>#</y><d>2018-09-25</d><h>13:00</h><w>deadghost</w><a>@mavbozo</a> huh thanks for the tip</z><z id="t1537880450" t="deadghost apparently my response doesn&apos;t pass ring-response/response?"><y>#</y><d>2018-09-25</d><h>13:00</h><w>deadghost</w>apparently my response doesn&apos;t pass <code>ring-response/response?</code></z><z id="t1537880569" t="deadghost yeah my :headers can&apos;t be nil"><y>#</y><d>2018-09-25</d><h>13:02</h><w>deadghost</w>yeah my <code>:headers</code> can&apos;t be nil</z><z id="t1537880805" t="deadghost ok finally got pedestal reasonably set up"><y>#</y><d>2018-09-25</d><h>13:06</h><w>deadghost</w>ok finally got pedestal reasonably set up</z><z id="t1537880874" t="deadghost I can finally close like 20 pedestal tabs"><y>#</y><d>2018-09-25</d><h>13:07</h><w>deadghost</w>I can finally close like 20 pedestal tabs</z><z id="t1537886728" t="stathissideris is there any compelling reason to keep body params named after their content type? I’m tempted to add an interceptor that will just rename everything to :body-params so that I can have an API that will serve both edn and json requests through the same code"><y>#</y><d>2018-09-25</d><h>14:45</h><w>stathissideris</w>is there any compelling reason to keep body params named after their content type? I’m tempted to add an interceptor that will just rename everything to <code>:body-params</code> so that I can have an API that will serve both edn and json requests through the same code</z><z id="t1537887138" t="ikitommi [:attrs {:href &quot;/_/_/users/U050AACJB&quot;}] if you are interested in 3rd party addons, there is a pedestal-compatible interceptor doing just that in Muuntaja library, muuntaja.interceptor.format-interceptor"><y>#</y><d>2018-09-25</d><h>14:52</h><w>ikitommi</w><a>@stathissideris</a> if you are interested in 3rd party addons, there is a pedestal-compatible interceptor doing just that in Muuntaja library, <code>muuntaja.interceptor.format-interceptor</code></z><z id="t1537887155" t="ikitommi https://github.com/metosin/muuntaja/blob/master/modules/muuntaja/src/muuntaja/interceptor.clj"><y>#</y><d>2018-09-25</d><h>14:52</h><r>ikitommi</r><a href="https://github.com/metosin/muuntaja/blob/master/modules/muuntaja/src/muuntaja/interceptor.clj" target="_blank">https://github.com/metosin/muuntaja/blob/master/modules/muuntaja/src/muuntaja/interceptor.clj</a></z><z id="t1537890156" t="stathissideris Thanks, I’m interested in 3rd party party interceptors, even if it’s just as an example!"><y>#</y><d>2018-09-25</d><h>15:42</h><r>stathissideris</r>Thanks, I’m interested in 3rd party party interceptors, even if it’s just as an example!</z><z id="t1537887256" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050AACJB&quot;}] the Pedestal philosophy around this sort of thing is: If something is separate, keep it separate. If something can be customized via an interceptor, keep the base code as basic as possible . So adding an interceptor which does what you’ve stated is perfectly acceptable. There has been some back-and-forth internally as to whether such helpers should be included in Pedestal core. As of now they won’t."><y>#</y><d>2018-09-25</d><h>14:54</h><w>ddeaguiar</w><a>@stathissideris</a> the Pedestal philosophy around this sort of thing is:

<code>If something is separate, keep it separate. If something can be customized via an interceptor, keep the base code as basic as possible</code>.

So adding an interceptor which does what you’ve stated is perfectly acceptable. There has been some back-and-forth internally as to whether such helpers should be included in Pedestal core. As of now they won’t.</z><z id="t1537890053" t="dadair [:attrs {:href &quot;/_/_/users/U050AACJB&quot;}] I had the same problem and for a while had my own helper interceptors to consolidate it. Ive since moved to muuntaja as [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] referenced and Ive been very happy with it."><y>#</y><d>2018-09-25</d><h>15:40</h><w>dadair</w><a>@stathissideris</a> I had the same problem and for a while had my own helper interceptors to consolidate it. Ive since moved to muuntaja as <a>@ikitommi</a> referenced and Ive been very happy with it.</z><z id="t1537890303" t="stathissideris [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks, that makes sense, it’s trivial to add a basic interceptor to achieve it anyway. I like the design decision. I just wanted to make sure I wasn’t missing something "><y>#</y><d>2018-09-25</d><h>15:45</h><w>stathissideris</w><a>@ddeaguiar</a> thanks, that makes sense, it’s trivial to add a basic interceptor to achieve it anyway. I like the design decision. I just wanted to make sure I wasn’t missing something </z><z id="t1537908287" t="deadghost yeah I was also wondering about the content type body params thing"><y>#</y><d>2018-09-25</d><h>20:44</h><w>deadghost</w>yeah I was also wondering about the content type body params thing</z><z id="t1537908383" t="deadghost third party interceptors haven&apos;t been easy for me to discover"><y>#</y><d>2018-09-25</d><h>20:46</h><w>deadghost</w>third party interceptors haven&apos;t been easy for me to discover</z><z id="t1537946133" t="stathissideris maybe there aren’t that many in circulation 🙂"><y>#</y><d>2018-09-26</d><h>07:15</h><w>stathissideris</w>maybe there aren’t that many in circulation <b>🙂</b></z><z id="t1537949334" t="ikitommi maybe they should be listed in http://pedestal.io/community/index ?"><y>#</y><d>2018-09-26</d><h>08:08</h><w>ikitommi</w>maybe they should be listed in <a href="http://pedestal.io/community/index" target="_blank">http://pedestal.io/community/index</a>?</z><z id="t1537949869" t="ikitommi https://github.com/pedestal/pedestal-docs/pull/116/files"><y>#</y><d>2018-09-26</d><h>08:17</h><w>ikitommi</w><a href="https://github.com/pedestal/pedestal-docs/pull/116/files" target="_blank">https://github.com/pedestal/pedestal-docs/pull/116/files</a></z><z id="t1537972707" t="ddeaguiar merged. Thanks!"><y>#</y><d>2018-09-26</d><h>14:38</h><r>ddeaguiar</r>merged. Thanks!</z><z id="t1537958257" t="orestis So cool. I never knew all those things. Thanks!"><y>#</y><d>2018-09-26</d><h>10:37</h><w>orestis</w>So cool. I never knew all those things. Thanks!</z><z id="t1537985951" t="dadair How are people using async-interceptors? What use cases? I’ve yet to use any and I’m curious if any parts of my system could be improved through their use."><y>#</y><d>2018-09-26</d><h>18:19</h><w>dadair</w>How are people using async-interceptors? What use cases? I’ve yet to use any and I’m curious if any parts of my system could be improved through their use.</z><z id="t1537988978" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] for long running operations. When these are io bound prefer going async via thread instead of a go block. So take integrating with a 3rd party service as an example that has a high response time. You don’t want to block your main request processing threads with this work. Integrate with this service in an interceptor that goes async via thread and return a channel as the context. At some point that interceptor will complete and push an updated context, presumably with some information it collected from the service, to the channel. Processing will continue. Keep in mind that all downstream processing once you go async happens on a thread from the go thread pool."><y>#</y><d>2018-09-26</d><h>19:09</h><w>ddeaguiar</w><a>@dadair</a> for long running operations. When these are io bound prefer going async via <code>thread</code> instead of a <code>go</code> block. So take integrating with a 3rd party service as an example that has a high response time. You don’t want to block your main request processing threads with this work. Integrate with this service in an interceptor that goes async via <code>thread</code> and return a channel as the context. At some point that interceptor will complete and push an updated context, presumably with some information it collected from the service, to the channel. Processing will continue. Keep in mind that all downstream processing once you go async happens on a thread from the <code>go</code> thread pool.</z><z id="t1537989206" t="dadair great thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2018-09-26</d><h>19:13</h><w>dadair</w>great thanks <a>@ddeaguiar</a></z><z id="t1537989256" t="ddeaguiar np!"><y>#</y><d>2018-09-26</d><h>19:14</h><w>ddeaguiar</w>np!</z><z id="t1537990055" t="ikitommi how is backpressure handled in the thread case? how is it handled in the go case? with thread - 100req/sec coming in and 1 thread taking 1sec to complete, there will be soon thousands of threads causing the system to crash?"><y>#</y><d>2018-09-26</d><h>19:27</h><w>ikitommi</w>how is backpressure handled in the <code>thread</code> case? how is it handled in the <code>go</code> case? with <code>thread</code> -  100req/sec coming in and 1 thread taking 1sec to complete, there will be soon thousands of threads causing the system to crash?</z><z id="t1537991371" t="ddeaguiar Pedestal just provides a mechanism for going async. The situation you described by [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] , is possible. So I suppose the answer is more nuanced. Leverage timeouts to avoid waiting an unreasonable amount of time (this is app specific). Depending on the service you are implementing you may need to layer on some form of back pressure to avoid running of threads."><y>#</y><d>2018-09-26</d><h>19:49</h><w>ddeaguiar</w>Pedestal just provides a mechanism for going async. The situation you described by <a>@ikitommi</a>, is possible. So I suppose the answer is more nuanced. Leverage timeouts to avoid waiting an unreasonable amount of time (this is app specific). Depending on the service you are implementing you may need to layer on some form of back pressure to avoid running of threads.</z><z id="t1537991418" t="ddeaguiar Taking additional precautions, like leveraging circuit breakers, would be a good idea as well"><y>#</y><d>2018-09-26</d><h>19:50</h><w>ddeaguiar</w>Taking additional precautions, like leveraging circuit breakers, would be a good idea as well</z><z id="t1538027219" t="ikitommi thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] for the detailed description. I think for 99% apps, this is not a problem, but still -not having a out-of-the-box solution / guide for this is not good for the clojure + web story in general - many non-clojure solutions have this inbuit. In Clojure, at least Aleph &amp; Catacumba claim to have this."><y>#</y><d>2018-09-27</d><h>05:46</h><w>ikitommi</w>thanks <a>@ddeaguiar</a> for the detailed description. I think for 99% apps, this is not a problem, but still -not having a out-of-the-box solution / guide for this is not good for the clojure + web story in general - many non-clojure solutions have this inbuit. In Clojure, at least Aleph &amp; Catacumba claim to have this.</z><z id="t1538027987" t="stathissideris [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] I’m not entirely certain, but I think yada provides back-pressure out of the box"><y>#</y><d>2018-09-27</d><h>05:59</h><w>stathissideris</w><a>@ikitommi</a> I’m not entirely certain, but I think yada provides back-pressure out of the box</z><z id="t1538028047" t="ikitommi I believe it’s the Aleph, that it’s built on."><y>#</y><d>2018-09-27</d><h>06:00</h><w>ikitommi</w>I believe it’s the Aleph, that it’s built on.</z><z id="t1538028882" t="stathissideris yeah, that’s how I remember it as well"><y>#</y><d>2018-09-27</d><h>06:14</h><w>stathissideris</w>yeah, that’s how I remember it as well</z><z id="t1538053289" t="stathissideris so what’s the preferred method for defining default interceptors? I dislike the terse syntax, so I guess I should define them at the service level?"><y>#</y><d>2018-09-27</d><h>13:01</h><w>stathissideris</w>so what’s the preferred method for defining default interceptors? I dislike the terse syntax, so I guess I should define them at the service level?</z><z id="t1538061442" t="dadair I conj onto :: http/interceptors in the service map after I have already called (default-interceptors)"><y>#</y><d>2018-09-27</d><h>15:17</h><w>dadair</w>I conj onto <b>::</b>http/interceptors in the service map after I have already called (default-interceptors)</z><z id="t1538137330" t="stathissideris so the terse syntax is not very readable (imho) and has the whole weirdness with symbols etc. On the other hand the table syntax does not allow for hierarchical paths and for applying interceptors to groups of endpoints. I came up with something that may be a good compromise between the two, what do you think? (untested code) https://gist.github.com/stathissideris/179181223988eab1eaeb469461e0da79"><y>#</y><d>2018-09-28</d><h>12:22</h><w>stathissideris</w>so the terse syntax is not very readable (imho) and has the whole weirdness with symbols etc. On the other hand the table syntax does not allow for hierarchical paths and for applying interceptors to groups of endpoints. I came up with something that may be a good compromise between the two, what do you think? (untested code) <a href="https://gist.github.com/stathissideris/179181223988eab1eaeb469461e0da79" target="_blank">https://gist.github.com/stathissideris/179181223988eab1eaeb469461e0da79</a></z><z id="t1538137388" t="stathissideris also, no macros, yay for data!"><y>#</y><d>2018-09-28</d><h>12:23</h><w>stathissideris</w>also, no macros, yay for data!</z><z id="t1538141055" t="mavbozo [:attrs {:href &quot;/_/_/users/U050AACJB&quot;}] the mechanism is quite similar to what I do: traversing all the routes and adding common interceptors to them. Data For the Win!!!"><y>#</y><d>2018-09-28</d><h>13:24</h><w>mavbozo</w><a>@stathissideris</a> the mechanism is quite similar to what I do: traversing all the routes and adding common interceptors to them. Data For the Win!!!</z><z id="t1538141077" t="stathissideris :thumbsup:"><y>#</y><d>2018-09-28</d><h>13:24</h><w>stathissideris</w><b>:thumbsup:</b></z><z id="t1538841886" t="lxsameer hey folks how can i debug a router ?"><y>#</y><d>2018-10-06</d><h>16:04</h><w>lxsameer</w>hey folks how can i debug a router ?</z><z id="t1538846662" t="jvtrigueros What do you mean by debug a router? Is your route not being hit?"><y>#</y><d>2018-10-06</d><h>17:24</h><w>jvtrigueros</w>What do you mean by debug a router? Is your route not being hit?</z><z id="t1538848097" t="lxsameer yes"><y>#</y><d>2018-10-06</d><h>17:48</h><w>lxsameer</w>yes</z><z id="t1538848465" t="jvtrigueros Well, since that&apos;s all that info we have, is any route being hit?"><y>#</y><d>2018-10-06</d><h>17:54</h><w>jvtrigueros</w>Well, since that&apos;s all that info we have, is any route being hit?</z><z id="t1538848576" t="lxsameer no, I can use url-for to get the routes and stuff like that but an actual request does not hit any route"><y>#</y><d>2018-10-06</d><h>17:56</h><w>lxsameer</w>no, I can use <code>url-for</code> to get the routes and stuff like that but an actual request does not hit any route</z><z id="t1538849597" t="jvtrigueros I would advise to start with the simplest example, and see if that works. Without seeing your code, it&apos;s pretty much a game of 20 questions 🙂"><y>#</y><d>2018-10-06</d><h>18:13</h><w>jvtrigueros</w>I would advise to start with the simplest example, and see if that works. Without seeing your code, it&apos;s pretty much a game of 20 questions <b>🙂</b></z><z id="t1538876445" t="dadair If you post how you are building your service map that will likely lead to us identifying the issue"><y>#</y><d>2018-10-07</d><h>01:40</h><w>dadair</w>If you post how you are building your service map that will likely lead to us identifying the issue</z><z id="t1538986578" t="kommen so, what’s the way to go to use pedestal with clojure 1.10-beta1?"><y>#</y><d>2018-10-08</d><h>08:16</h><w>kommen</w>so, what’s the way to go to use pedestal with clojure 1.10-beta1?</z><z id="t1538986624" t="kommen it looks like we’d need a version containing https://github.com/pedestal/pedestal/commit/64b8f877590c8bb66341544728da576d8e33124f"><y>#</y><d>2018-10-08</d><h>08:17</h><w>kommen</w>it looks like we’d need a version containing <a href="https://github.com/pedestal/pedestal/commit/64b8f877590c8bb66341544728da576d8e33124f" target="_blank">https://github.com/pedestal/pedestal/commit/64b8f877590c8bb66341544728da576d8e33124f</a></z><z id="t1538986722" t="kommen but there doesn’t seem to be a “0.5.5-SNAPSHOT” published and pedestal lacks deps.edn files to we could use the version from git master"><y>#</y><d>2018-10-08</d><h>08:18</h><w>kommen</w>but there doesn’t seem to be a “0.5.5-SNAPSHOT” published and pedestal lacks deps.edn files to we could use the version from git master</z><z id="t1539057481" t="jvtrigueros You could try using JitPack: https://jitpack.io/#pedestal/pedestal"><y>#</y><d>2018-10-09</d><h>03:58</h><w>jvtrigueros</w>You could try using JitPack: <a href="https://jitpack.io/#pedestal/pedestal" target="_blank">https://jitpack.io/#pedestal/pedestal</a></z><z id="t1539066029" t="jimmy If you just need it for local testing and build, you just need to clone and build locally. "><y>#</y><d>2018-10-09</d><h>06:20</h><w>jimmy</w>If you just need it for local testing and build, you just need to clone and build locally. </z><z id="t1539069261" t="kommen no, I’d like to deploy it to staging or even to production"><y>#</y><d>2018-10-09</d><h>07:14</h><w>kommen</w>no, I’d like to deploy it to staging or even to production</z><z id="t1539074458" t="kommen I’ll give jitpack a shot, thx [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}]"><y>#</y><d>2018-10-09</d><h>08:40</h><w>kommen</w>I’ll give jitpack a shot, thx <a>@jvtrigueros</a></z><z id="t1539111655" t="jvtrigueros [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] Yeah sure, no problem, that&apos;s how I get around libraries that have merged the code to master but haven&apos;t released a version yet. JitPack is great!"><y>#</y><d>2018-10-09</d><h>19:00</h><w>jvtrigueros</w><a>@kommen</a> Yeah sure, no problem, that&apos;s how I get around libraries that have merged the code to <code>master</code> but haven&apos;t released a version yet. JitPack is great!</z><z id="t1539269055" t="martinklepsch What’s the right way to add one interceptor globally without replicating default-interceptors in a codebase? "><y>#</y><d>2018-10-11</d><h>14:44</h><w>martinklepsch</w>What’s the right way to add one interceptor globally without replicating default-interceptors in a codebase? </z><z id="t1539270312" t="ddeaguiar call io.pedestal.http/default-interceptors before io.pedestal.http/create-server and manipulate the io.pedestal.http/interceptors collection in between"><y>#</y><d>2018-10-11</d><h>15:05</h><w>ddeaguiar</w>call <code>io.pedestal.http/default-interceptors</code> before <code>io.pedestal.http/create-server</code> and manipulate the <code>io.pedestal.http/interceptors</code> collection in between</z><z id="t1539270338" t="ddeaguiar The router is the terminal interceptor so add your interceptor(s) before that"><y>#</y><d>2018-10-11</d><h>15:05</h><w>ddeaguiar</w>The router is the terminal interceptor so add your interceptor(s) before that</z><z id="t1539270347" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] ^^"><y>#</y><d>2018-10-11</d><h>15:05</h><w>ddeaguiar</w><a>@martinklepsch</a> ^^</z><z id="t1539270402" t="ddeaguiar This is how dev-interceptors are added in the pedestal-service template https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27-L28"><y>#</y><d>2018-10-11</d><h>15:06</h><w>ddeaguiar</w>This is how dev-interceptors are added in the pedestal-service template <a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27-L28" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27-L28</a></z><z id="t1539272152" t="mkvlr [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] do you have plans to push a release with the fixes for Clojure 1.10 soon? Looks like RC-1 is now out."><y>#</y><d>2018-10-11</d><h>15:35</h><w>mkvlr</w><a>@ddeaguiar</a> do you have plans to push a release with the fixes for Clojure 1.10 soon? Looks like RC-1 is now out.</z><z id="t1539272165" t="mkvlr Having trouble to import pedestal through JitPack…"><y>#</y><d>2018-10-11</d><h>15:36</h><w>mkvlr</w>Having trouble to import pedestal through JitPack…</z><z id="t1539272222" t="ddeaguiar Nothing concrete yet. Let me bring that up internally and report back here."><y>#</y><d>2018-10-11</d><h>15:37</h><w>ddeaguiar</w>Nothing concrete yet. Let me bring that up internally and report back here.</z><z id="t1539272279" t="mkvlr [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] do you happen to know how I can just import pedestal.log from JitPack?"><y>#</y><d>2018-10-11</d><h>15:37</h><w>mkvlr</w><a>@jvtrigueros</a> do you happen to know how I can just import pedestal.log from JitPack?</z><z id="t1539272291" t="mkvlr I currently have com.github.pedestal/pedestal {:mvn/version &quot;e6b6286c6b&quot;} in my deps.edn"><y>#</y><d>2018-10-11</d><h>15:38</h><w>mkvlr</w>I currently have <code>com.github.pedestal/pedestal {:mvn/version &quot;e6b6286c6b&quot;}</code> in my <code>deps.edn</code></z><z id="t1539272387" t="mkvlr trying to replace io.pedestal/pedestal.log {:mvn/version &quot;0.5.4&quot;} with a version from git"><y>#</y><d>2018-10-11</d><h>15:39</h><w>mkvlr</w>trying to replace <code>io.pedestal/pedestal.log {:mvn/version &quot;0.5.4&quot;}</code> with a version from git</z><z id="t1539272394" t="jvtrigueros [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] I&apos;ve only used JitPack with Leiningen. I don&apos;t know if works with clj deps, I&apos;ve never used it before, does it allow you to add custom repositories?"><y>#</y><d>2018-10-11</d><h>15:39</h><w>jvtrigueros</w><a>@mkvlr</a> I&apos;ve only used JitPack with Leiningen. I don&apos;t know if works with clj deps, I&apos;ve never used it before, does it allow you to add custom repositories?</z><z id="t1539272407" t="mkvlr yeah, I have that working"><y>#</y><d>2018-10-11</d><h>15:40</h><w>mkvlr</w>yeah, I have that working</z><z id="t1539272450" t="mkvlr but I’m not sure it works for repositories where the file is in a subpath, i.e. https://github.com/pedestal/pedestal/tree/master/log"><y>#</y><d>2018-10-11</d><h>15:40</h><w>mkvlr</w>but I’m not sure it works for repositories where the file is in a subpath, i.e. <a href="https://github.com/pedestal/pedestal/tree/master/log" target="_blank">https://github.com/pedestal/pedestal/tree/master/log</a></z><z id="t1539272465" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] if you are using deps.edn why not specify a pedestal git-sha1 directly?"><y>#</y><d>2018-10-11</d><h>15:41</h><w>ddeaguiar</w><a>@mkvlr</a> if you are using <code>deps.edn</code> why not specify a pedestal git-sha1 directly?</z><z id="t1539272475" t="ddeaguiar no need to use JitPack"><y>#</y><d>2018-10-11</d><h>15:41</h><w>ddeaguiar</w>no need to use JitPack</z><z id="t1539272559" t="mkvlr [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] wouldn’t the have to be a pom.xml or deps.edn in the pedestal repo for that to work?"><y>#</y><d>2018-10-11</d><h>15:42</h><w>mkvlr</w><a>@ddeaguiar</a> wouldn’t the have to be a <code>pom.xml</code> or <code>deps.edn</code> in the pedestal repo for that to work?</z><z id="t1539272595" t="ddeaguiar ah yeah, right."><y>#</y><d>2018-10-11</d><h>15:43</h><w>ddeaguiar</w>ah yeah, right.</z><z id="t1539272601" t="ddeaguiar well here’s an alternative"><y>#</y><d>2018-10-11</d><h>15:43</h><w>ddeaguiar</w>well here’s an alternative</z><z id="t1539272616" t="ddeaguiar create a fork and add a deps.edn"><y>#</y><d>2018-10-11</d><h>15:43</h><w>ddeaguiar</w>create a fork and add a deps.edn</z><z id="t1539272630" t="mkvlr right! forgot about that"><y>#</y><d>2018-10-11</d><h>15:43</h><w>mkvlr</w>right! forgot about that</z><z id="t1539272658" t="ddeaguiar In the meantime I’ll discuss cutting a release internally"><y>#</y><d>2018-10-11</d><h>15:44</h><w>ddeaguiar</w>In the meantime I’ll discuss cutting a release internally</z><z id="t1539272672" t="mkvlr great, thank you!"><y>#</y><d>2018-10-11</d><h>15:44</h><w>mkvlr</w>great, thank you!</z><z id="t1539272785" t="ddeaguiar np!"><y>#</y><d>2018-10-11</d><h>15:46</h><w>ddeaguiar</w>np!</z><z id="t1539273265" t="mkvlr io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;} if someone else wants to use it"><y>#</y><d>2018-10-11</d><h>15:54</h><w>mkvlr</w><code>io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;}</code> if someone else wants to use it</z><z id="t1539273526" t="orestis Committing a deps.edn directly in pedestal doesn’t need a release, right? Would such a PR be accepted?"><y>#</y><d>2018-10-11</d><h>15:58</h><w>orestis</w>Committing a deps.edn directly in pedestal doesn’t need a release, right? Would such a PR be accepted?</z><z id="t1539276847" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] possibly but I recommend opening an issue first"><y>#</y><d>2018-10-11</d><h>16:54</h><r>ddeaguiar</r><a>@U7PBP4UVA</a> possibly but I recommend opening an issue first</z><z id="t1539273699" t="jvtrigueros [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] FWIW here&apos;s what you would need if you wanted to make it work with JitPack: {:deps {com.github.pedestal/pedestal {:mvn/version &quot;e6b6286c6b&quot;}} :mvn/repos {&quot;jitpack&quot; {:url &quot;&quot;}}} "><y>#</y><d>2018-10-11</d><h>16:01</h><w>jvtrigueros</w><a>@mkvlr</a> FWIW here&apos;s what you would need if you wanted to make it work with JitPack:
<pre>{:deps      {com.github.pedestal/pedestal {:mvn/version &quot;e6b6286c6b&quot;}}
 :mvn/repos {&quot;jitpack&quot; {:url &quot;&quot;}}}
</pre></z><z id="t1539273742" t="mkvlr [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] I did have it running so far, but I only want the log app, not everything…"><y>#</y><d>2018-10-11</d><h>16:02</h><w>mkvlr</w><a>@jvtrigueros</a> I did have it running so far, but I only want the log app, not everything…</z><z id="t1539273749" t="jvtrigueros Ah I se"><y>#</y><d>2018-10-11</d><h>16:02</h><w>jvtrigueros</w>Ah I se</z><z id="t1539273751" t="jvtrigueros see*"><y>#</y><d>2018-10-11</d><h>16:02</h><w>jvtrigueros</w>see*</z><z id="t1539273827" t="jvtrigueros I&apos;ve never used JitPack that way, sounds like you&apos;ve worked it out though!"><y>#</y><d>2018-10-11</d><h>16:03</h><w>jvtrigueros</w>I&apos;ve never used JitPack that way, sounds like you&apos;ve worked it out though!</z><z id="t1539305523" t="dfcarpenter I&apos;m trying to get pedestal installed using the &quot;Getting Started&quot; instructions from the github repo but I keep getting the error Failed to resolve version for pedestal-service:lein-template:jar:RELEASE: Could not find metadata pedestal-service:lein-template/maven-metadata.xml in local (/Users/dan/.m2/repository)"><y>#</y><d>2018-10-12</d><h>00:52</h><w>dfcarpenter</w>I&apos;m trying to get pedestal installed using the &quot;Getting Started&quot; instructions from the github repo but I keep getting the error <code>Failed to resolve version for pedestal-service:lein-template:jar:RELEASE: Could not find metadata pedestal-service:lein-template/maven-metadata.xml in local (/Users/dan/.m2/repository)</code></z><z id="t1540861414" t="rakyi hi, how can I get raw POST body as a string in :enter in interceptor, pls? I tried this, but body is nil (body is only a single line payload)"><y>#</y><d>2018-10-30</d><h>01:03</h><w>rakyi</w>hi, how can I get raw POST body as a string in :enter in interceptor, pls? I tried this, but <code>body</code> is nil (body is only a single line payload)</z><z id="t1540861510" t="rakyi I’m trying to verify requests from Slack https://api.slack.com/docs/verifying-requests-from-slack"><y>#</y><d>2018-10-30</d><h>01:05</h><w>rakyi</w>I’m trying to verify requests from Slack <a href="https://api.slack.com/docs/verifying-requests-from-slack" target="_blank">https://api.slack.com/docs/verifying-requests-from-slack</a></z><z id="t1540866346" t="rakyi to answer my own question body-params intercepter was reading the InputStream first so it couldn’t be read again in further interceptors"><y>#</y><d>2018-10-30</d><h>02:25</h><w>rakyi</w>to answer my own question body-params intercepter was reading the InputStream first so it couldn’t be read again in further interceptors</z><z id="t1541188736" t="ccann just started learning pedestal and it looks awesome, I wish I had known about it sooner 🙂 metal"><y>#</y><d>2018-11-02</d><h>19:58</h><w>ccann</w>just started learning pedestal and it looks awesome, I wish I had known about it sooner <b>🙂</b> <b>metal</b></z><z id="t1541188794" t="ccann thank you [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] for the awesome Your First API tutorial"><y>#</y><d>2018-11-02</d><h>19:59</h><w>ccann</w>thank you <a>@mtnygard</a> for the awesome <code>Your First API</code> tutorial</z><z id="t1541350765" t="mtnygard [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] You&apos;re welcome!"><y>#</y><d>2018-11-04</d><h>16:59</h><w>mtnygard</w><a>@ccann</a> You&apos;re welcome!</z><z id="t1541350810" t="mtnygard BTW, I&apos;d love to hear about your learning experience. Especially anything you struggle with or wish you had known earlier."><y>#</y><d>2018-11-04</d><h>17:00</h><w>mtnygard</w>BTW, I&apos;d love to hear about your learning experience. Especially anything you struggle with or wish you had known earlier.</z><z id="t1541350832" t="mtnygard You can post thoughts here, as issues on the doc repo, or email me at &lt;mailto: /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt;"><y>#</y><d>2018-11-04</d><h>17:00</h><w>mtnygard</w>You can post thoughts here, as issues on the doc repo, or email me at &lt;mailto:<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;</z><z id="t1541431276" t="ccann will do"><y>#</y><d>2018-11-05</d><h>15:21</h><r>ccann</r>will do</z><z id="t1541406562" t="orestis Is there a guide somewhere on how to create new adapters? I wonder how hard would it be to get Pedestal running on Aleph."><y>#</y><d>2018-11-05</d><h>08:29</h><w>orestis</w>Is there a guide somewhere on how to create new adapters? I wonder how hard would it be to get Pedestal running on Aleph.</z><z id="t1541466739" t="mtnygard I don’t have a guide, but there are examples for Tomcat, Jetty, and Immutant. "><y>#</y><d>2018-11-06</d><h>01:12</h><r>mtnygard</r>I don’t have a guide, but there are examples for Tomcat, Jetty, and Immutant. </z><z id="t1541457702" t="ccann i’m trying to figure out the best way to test my API with pedestal. I see the io.pedestal.test/response-for function for mocking requests to the server. Is there a way to use ring.mock? or a way to pass headers to response-for ?"><y>#</y><d>2018-11-05</d><h>22:41</h><w>ccann</w>i’m trying to figure out the best way to test my API with pedestal. I see the <code>io.pedestal.test/response-for</code> function for mocking requests to the server. Is there a way to use ring.mock? or a way to pass headers to <code>response-for</code>?</z><z id="t1541458001" t="ccann ah, I see you can pass :headers as the last argument"><y>#</y><d>2018-11-05</d><h>22:46</h><w>ccann</w>ah, I see you can pass <code>:headers</code> as the last argument</z><z id="t1541515684" t="eraserhd Header names are case sensitive when you use response-for, which is easy enough to work around but a potential surprise."><y>#</y><d>2018-11-06</d><h>14:48</h><w>eraserhd</w>Header names are case sensitive when you use response-for, which is easy enough to work around but a potential surprise.</z><z id="t1541515688" t="eraserhd [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] ^^"><y>#</y><d>2018-11-06</d><h>14:48</h><w>eraserhd</w><a>@ccann</a> ^^</z><z id="t1541519821" t="ccann thanks [:attrs {:href &quot;/_/_/users/U0ECYL0ET&quot;}] , I did pick up on that pretty quickly 🙂"><y>#</y><d>2018-11-06</d><h>15:57</h><w>ccann</w>thanks <a>@eraserhd</a>, I did pick up on that pretty quickly <b>🙂</b></z><z id="t1541520089" t="ccann One thing that was surprising was how to define interceptors. I wrote an interceptor that looked something like this: (def logger {:name :logger :enter (fn [context] (with-out-str (clojure.pprint/pprint (:request context))) context)}) and added it to my interceptor chain in the server map configuration. But pedestal threw an assertion error saying one of the interceptors in the chain wasn’t an interceptor. Indeed the others are records and mine is a map, but what I absorbed from the docs was that you can write interceptors with maps as such. I ended up finding the io.pedestal.interceptors.helpers namespace in the source and the macros looked pretty nifty, so I rewrote my logging interceptor (I know there is one of these already available) with defbefore and my handlers with defhandler . Now I’m wondering if it makes more sense to use the macros in general vs just maps vs before , after , etc. I’m not sure what’s the most idiomatic"><y>#</y><d>2018-11-06</d><h>16:01</h><w>ccann</w>One thing that was surprising was how to define interceptors. I wrote an interceptor that looked something like this:
<pre>(def logger
  {:name :logger
   :enter (fn [context]
            (with-out-str (clojure.pprint/pprint (:request context)))
            context)})</pre>
and added it to my interceptor chain in the server map configuration. But pedestal threw an assertion error saying one of the interceptors in the chain wasn’t an interceptor. Indeed the others are records and mine is a map, but what I absorbed from the docs was that you can write interceptors with maps as such.

I ended up finding the <code>io.pedestal.interceptors.helpers</code> namespace in the source and the macros looked pretty nifty, so I rewrote my logging interceptor (I know there is one of these already available) with <code>defbefore</code> and my handlers with <code>defhandler</code>. Now I’m wondering if it makes more sense to use the macros in general vs just maps vs <code>before</code>, <code>after</code>, etc. I’m not sure what’s the most idiomatic</z><z id="t1541520170" t="mtnygard [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] Do you still have the code around from when the map didn&apos;t work in your interceptor chain?"><y>#</y><d>2018-11-06</d><h>16:02</h><w>mtnygard</w><a>@ccann</a> Do you still have the code around from when the map didn&apos;t work in your interceptor chain?</z><z id="t1541520214" t="mtnygard The best way to turn a map into an interceptor is by calling io.pedestal.interceptor/interceptor on it. Anything that is in a route&apos;s interceptor vector has that done automatically. But I wonder if there are places where we aren&apos;t doing that."><y>#</y><d>2018-11-06</d><h>16:03</h><w>mtnygard</w>The best way to turn a map into an interceptor is by calling <code>io.pedestal.interceptor/interceptor</code> on it. Anything that is in a route&apos;s interceptor vector has that done automatically. But I wonder if there are places where we aren&apos;t doing that.</z><z id="t1541520258" t="mtnygard IOW, I&apos;d like it to &quot;just work&quot; without using the (mildly deprecated) macros in helpers"><y>#</y><d>2018-11-06</d><h>16:04</h><w>mtnygard</w>IOW, I&apos;d like it to &quot;just work&quot; without using the (mildly deprecated) macros in <code>helpers</code></z><z id="t1541520684" t="ccann [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I do! it’s basically just (-&gt; service-map http/default-interceptors http/dev-interceptors (update ::http/interceptors into routes/interceptors)) where routes/interceptors is a vector of [log-request (body-params) json-body] the first being my logger, the actual implementation of which was: (def log-request {:name :log-req :enter (fn [context] (log/info ::log-request) (log/info (with-out-str (clojure.pprint/pprint (:request context)))) context)}) "><y>#</y><d>2018-11-06</d><h>16:11</h><w>ccann</w><a>@mtnygard</a> I do! it’s basically just

<pre>(-&gt; service-map
          http/default-interceptors
          http/dev-interceptors
          (update ::http/interceptors into routes/interceptors))</pre>

where <code>routes/interceptors</code> is a vector of  <code>[log-request (body-params) json-body]</code> the first being my logger, the actual implementation of which was:

<pre>(def log-request
  {:name :log-req
   :enter
   (fn [context]
     (log/info ::log-request)
     (log/info (with-out-str (clojure.pprint/pprint (:request context))))
     context)})
</pre></z><z id="t1541520762" t="mtnygard Thanks."><y>#</y><d>2018-11-06</d><h>16:12</h><w>mtnygard</w>Thanks.</z><z id="t1541521074" t="mtnygard I can confirm that don&apos;t automatically call io.pedestal.interceptor/interceptor on that key in the service map."><y>#</y><d>2018-11-06</d><h>16:17</h><w>mtnygard</w>I can confirm that don&apos;t automatically call <code>io.pedestal.interceptor/interceptor</code> on that key in the service map.</z><z id="t1541521086" t="mtnygard Sorry for the confusion, and I&apos;m adding an issue to the docs repo so we can clarify."><y>#</y><d>2018-11-06</d><h>16:18</h><w>mtnygard</w>Sorry for the confusion, and I&apos;m adding an issue to the docs repo so we can clarify.</z><z id="t1541521195" t="mtnygard https://github.com/pedestal/pedestal-docs/issues/117"><y>#</y><d>2018-11-06</d><h>16:19</h><w>mtnygard</w><a href="https://github.com/pedestal/pedestal-docs/issues/117" target="_blank">https://github.com/pedestal/pedestal-docs/issues/117</a></z><z id="t1541522298" t="ccann awesome thanks!"><y>#</y><d>2018-11-06</d><h>16:38</h><w>ccann</w>awesome thanks!</z><z id="t1541522349" t="mtnygard LMK if you run into anything else. I travel a lot so I&apos;m not usually this quick to respond, but I&apos;ll see it eventually. 🙂"><y>#</y><d>2018-11-06</d><h>16:39</h><w>mtnygard</w>LMK if you run into anything else. I travel a lot so I&apos;m not usually this quick to respond, but I&apos;ll see it eventually. <b>🙂</b></z><z id="t1541522370" t="ccann it also looks like the before , after etc. functions have two arities [f] and [f &amp; args] but then in the source code you can use it like so (interceptors/before ::foo-bar (fn [ctx]..."><y>#</y><d>2018-11-06</d><h>16:39</h><w>ccann</w>it also looks like the <code>before</code>, <code>after</code> etc. functions have two arities <code>[f]</code> and <code>[f &amp; args]</code> but then in the source code you can use it like so <code>(interceptors/before ::foo-bar (fn [ctx]...</code></z><z id="t1541522554" t="mtnygard The second arity tries to be too clever. If f is not a function, then the macro uses it as the name. Then it deconstructs args to use as an existing function name and additional arguments to that function."><y>#</y><d>2018-11-06</d><h>16:42</h><w>mtnygard</w>The second arity tries to be too clever. If <code>f</code> is not a function, then the macro uses it as the name. Then it deconstructs args to use as an existing function name and additional arguments to that function.</z><z id="t1541522562" t="mtnygard It was not a good idea, and I&apos;d recommend avoiding it."><y>#</y><d>2018-11-06</d><h>16:42</h><w>mtnygard</w>It was not a good idea, and I&apos;d recommend avoiding it.</z><z id="t1541544852" t="ccann this might just be demonstrating my lack of mature docker / networking knowledge, but I couldn’t get my pedestal app to respond when running in a docker container with ports mapped appropriately and hitting it with curl. e.g.: docker run -it -p 3080:3080 008940197b83 then curl --request GET \ --url "><y>#</y><d>2018-11-06</d><h>22:54</h><w>ccann</w>this might just be demonstrating my lack of mature docker / networking knowledge, but I couldn’t get my pedestal app to respond when running in a docker container with ports mapped appropriately and hitting it with curl. e.g.:
<pre>docker run -it -p 3080:3080 008940197b83</pre>
then
<pre>curl --request GET \
           --url </pre></z><z id="t1541544886" t="ccann until I added ::http/host &quot;0.0.0.0&quot; to my service map, curl would just report curl: (52) Empty reply from server . but running outside a docker container I don’t need that key."><y>#</y><d>2018-11-06</d><h>22:54</h><w>ccann</w>until I added <code>::http/host &quot;0.0.0.0&quot;</code> to my service map, curl would just report <code>curl: (52) Empty reply from server</code>. but running outside a docker container I don’t need that key.</z><z id="t1541544907" t="jvtrigueros Ah yes, this bit me once! I opened a PR to updates docs."><y>#</y><d>2018-11-06</d><h>22:55</h><w>jvtrigueros</w>Ah yes, this bit me once! I opened a PR to updates docs.</z><z id="t1541544926" t="jvtrigueros It&apos;s a safer default, but needs to be documented."><y>#</y><d>2018-11-06</d><h>22:55</h><w>jvtrigueros</w>It&apos;s a safer default, but needs to be documented.</z><z id="t1541544937" t="ccann what’s going on exactly?"><y>#</y><d>2018-11-06</d><h>22:55</h><w>ccann</w>what’s going on exactly?</z><z id="t1541544969" t="jvtrigueros If I understand correctly, only hosts calling from localhost are allowed to connect to the server."><y>#</y><d>2018-11-06</d><h>22:56</h><w>jvtrigueros</w>If I understand correctly, only hosts calling from <code>localhost</code> are allowed to connect to the server.</z><z id="t1541544986" t="jvtrigueros How are you routing traffic the service in Docker?"><y>#</y><d>2018-11-06</d><h>22:56</h><w>jvtrigueros</w>How are you routing traffic the service in Docker?</z><z id="t1541545035" t="ccann ohhh. uhh, I’m just running java -jar server.jar in my container. and running with docker run as above not sure if that answered your question"><y>#</y><d>2018-11-06</d><h>22:57</h><w>ccann</w>ohhh. uhh, I’m just running <code>java -jar server.jar</code> in my container. and running with docker run as above
not sure if that answered your question</z><z id="t1541545121" t="jvtrigueros Yeah so when you do java -jar server.jar on your physical machine, you are localhost, so executing the curl command works."><y>#</y><d>2018-11-06</d><h>22:58</h><w>jvtrigueros</w>Yeah so when you do <code>java -jar server.jar</code> on your physical machine, you are localhost, so executing the curl command works.</z><z id="t1541545140" t="jvtrigueros When running inside the Docker container, the app sees you as not localhost but some other host."><y>#</y><d>2018-11-06</d><h>22:59</h><w>jvtrigueros</w>When running inside the Docker container, the app sees you as not localhost but some other host.</z><z id="t1541545166" t="ccann okay, great. thanks!"><y>#</y><d>2018-11-06</d><h>22:59</h><w>ccann</w>okay, great. thanks!</z><z id="t1541545180" t="ccann I’ll upvote that PR"><y>#</y><d>2018-11-06</d><h>22:59</h><w>ccann</w>I’ll upvote that PR</z><z id="t1541545186" t="jvtrigueros 👍"><y>#</y><d>2018-11-06</d><h>22:59</h><w>jvtrigueros</w><b>👍</b></z><z id="t1541545206" t="ccann do you have a link to it?"><y>#</y><d>2018-11-06</d><h>23:00</h><w>ccann</w>do you have a link to it?</z><z id="t1541545228" t="jvtrigueros https://github.com/pedestal/pedestal-docs/pull/115"><y>#</y><d>2018-11-06</d><h>23:00</h><w>jvtrigueros</w><a href="https://github.com/pedestal/pedestal-docs/pull/115" target="_blank">https://github.com/pedestal/pedestal-docs/pull/115</a></z><z id="t1541686789" t="souenzzo TIP: You can force [org.clojure/core.specs.alpha &quot;0.2.36&quot;] to use io.pedestal with clojure 1.10-betaX"><y>#</y><d>2018-11-08</d><h>14:19</h><w>souenzzo</w>TIP: You can force <code>[org.clojure/core.specs.alpha &quot;0.2.36&quot;]</code> to use <code>io.pedestal</code> with <code>clojure 1.10-betaX</code></z><z id="t1541863416" t="orestis Any tips on how to determine how large a Jetty thread pool should be? I vaguely remember seeing simulation software to model database latency and so on, slow clients etc etc. "><y>#</y><d>2018-11-10</d><h>15:23</h><w>orestis</w>Any tips on how to determine how large a Jetty thread pool should be? I vaguely remember seeing simulation software to model database latency and so on, slow clients etc etc. </z><z id="t1542031596" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I don’t have the answer to that. Perhaps raise your question to the pedestal user group?"><y>#</y><d>2018-11-12</d><h>14:06</h><w>ddeaguiar</w><a>@orestis</a> I don’t have the answer to that. Perhaps raise your question to the pedestal user group?</z><z id="t1542033563" t="orestis Thanks!"><y>#</y><d>2018-11-12</d><h>14:39</h><w>orestis</w>Thanks!</z><z id="t1542035952" t="ddeaguiar For those interested in Datomic Ions, we’ve recently released pedestal.ions ( https://github.com/pedestal/pedestal.ions )."><y>#</y><d>2018-11-12</d><h>15:19</h><w>ddeaguiar</w>For those interested in Datomic Ions, we’ve recently released pedestal.ions (<a href="https://github.com/pedestal/pedestal.ions" target="_blank">https://github.com/pedestal/pedestal.ions</a>).</z><z id="t1542054042" t="Joe Lane This is super cool, thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2018-11-12</d><h>20:20</h><w>Joe Lane</w>This is super cool, thanks <a>@ddeaguiar</a>!</z><z id="t1542149284" t="ccann anyone using https://github.com/AvisoNovate/rook that has some feedback on it?"><y>#</y><d>2018-11-13</d><h>22:48</h><w>ccann</w>anyone using <a href="https://github.com/AvisoNovate/rook" target="_blank">https://github.com/AvisoNovate/rook</a> that has some feedback on it?</z><z id="t1542149355" t="ccann not to ask the dreaded question, but I do wonder if it’s stable or abandoned I think it looks pretty useful, as I found myself building something like it, but more ad-hoc"><y>#</y><d>2018-11-13</d><h>22:49</h><w>ccann</w>not to ask the dreaded question, but I do wonder if it’s stable or abandoned
I think it looks pretty useful, as I found myself building something like it, but more ad-hoc</z><z id="t1542160033" t="emccue A decent amount of downloads on an older version"><y>#</y><d>2018-11-14</d><h>01:47</h><w>emccue</w>A decent amount of downloads on an older version</z><z id="t1542160037" t="emccue https://clojars.org/io.aviso/rook/versions/0.1.39"><y>#</y><d>2018-11-14</d><h>01:47</h><w>emccue</w><a href="https://clojars.org/io.aviso/rook/versions/0.1.39" target="_blank">https://clojars.org/io.aviso/rook/versions/0.1.39</a></z><z id="t1542160054" t="emccue but not so many on recent ones"><y>#</y><d>2018-11-14</d><h>01:47</h><w>emccue</w>but not so many on recent ones</z><z id="t1542208916" t="souenzzo Can I use io.pedestal.test without explicitly use jetty or immutant?"><y>#</y><d>2018-11-14</d><h>15:21</h><w>souenzzo</w>Can I use io.pedestal.test without explicitly use jetty or immutant?</z><z id="t1542209891" t="Twan We were able to do that"><y>#</y><d>2018-11-14</d><h>15:38</h><w>Twan</w>We were able to do that</z><z id="t1542210718" t="souenzzo [:attrs {:href &quot;/_/_/users/U9M6WJ9PV&quot;}] When I try to (def service-fn (-&gt; {::http/routes routes #_#_::http/type :jetty ::http/port 8080 ::http/join? false} http/default-interceptors http/dev-interceptors http/create-server ::http/service-fn)) I get: CompilerException java.lang.NoClassDefFoundError: javax/servlet/http/HttpServletRequest, compiling:(ring/middleware/multipart_params.clj:53:20)"><y>#</y><d>2018-11-14</d><h>15:51</h><w>souenzzo</w><a>@twan</a> When I try to
<pre>(def service-fn
  (-&gt; {::http/routes routes
       #_#_::http/type :jetty
       ::http/port   8080
       ::http/join?  false}
      http/default-interceptors
      http/dev-interceptors
      http/create-server
      ::http/service-fn))
</pre>
I get:
<code>CompilerException java.lang.NoClassDefFoundError: javax/servlet/http/HttpServletRequest, compiling:(ring/middleware/multipart_params.clj:53:20)</code></z><z id="t1542210971" t="Twan Ah, I see that I must be sorry. The (default) service-map that I use returns a :jetty server according to the docs"><y>#</y><d>2018-11-14</d><h>15:56</h><r>Twan</r>Ah, I see that I must be sorry. The (default) service-map that I use returns a <code>:jetty</code> server according to the docs</z><z id="t1542210991" t="Twan It is not explicitly set by ourselves, but internally it does"><y>#</y><d>2018-11-14</d><h>15:56</h><r>Twan</r>It is not explicitly set by ourselves, but internally it does</z><z id="t1542211136" t="Twan In particular, I meant this piece https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L602"><y>#</y><d>2018-11-14</d><h>15:58</h><r>Twan</r>In particular, I meant this piece <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L602" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/master/src/com/walmartlabs/lacinia/pedestal.clj#L602</a></z><z id="t1542211194" t="souenzzo With [javax.servlet/javax.servlet-api &quot;4.0.1&quot;] I get different error CompilerException java.lang.IllegalArgumentException: There was no provider or server type specified. (that is a pedetal error) now I&apos;m digging into ::http/chain-provider"><y>#</y><d>2018-11-14</d><h>15:59</h><r>souenzzo</r>With <code>[javax.servlet/javax.servlet-api &quot;4.0.1&quot;]</code> I get different error
<code>CompilerException java.lang.IllegalArgumentException: There was no provider or server type specified.</code>
(that is a pedetal error)
now I&apos;m digging into <code>::http/chain-provider</code></z><z id="t1542211415" t="souenzzo I&apos;m using pedestal to mock some http requests (as a client only) as a library, I think that avoid deps is a good thing 😄 https://github.com/souenzzo/pathom-pedestal-driver"><y>#</y><d>2018-11-14</d><h>16:03</h><r>souenzzo</r>I&apos;m using pedestal to mock some http requests (as a client only)
as a library, I think that avoid deps is a good thing <b>😄</b>
<a href="https://github.com/souenzzo/pathom-pedestal-driver" target="_blank">https://github.com/souenzzo/pathom-pedestal-driver</a></z><z id="t1542278548" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , I think you figured this out but the dependency you need is the servlet-api. I’d use the same version that pedestal uses."><y>#</y><d>2018-11-15</d><h>10:42</h><r>ddeaguiar</r><a>@U2J4FRT2T</a>, I think you figured this out but the dependency you need is the servlet-api. I’d use the same version that pedestal uses.</z><z id="t1542742822" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thanks for https://github.com/pedestal/pedestal/issues/602 👍"><y>#</y><d>2018-11-20</d><h>19:40</h><w>martinklepsch</w><a>@ddeaguiar</a> thanks for <a href="https://github.com/pedestal/pedestal/issues/602" target="_blank">https://github.com/pedestal/pedestal/issues/602</a> <b>👍</b></z><z id="t1543234344" t="ddeaguiar np!"><y>#</y><d>2018-11-26</d><h>12:12</h><r>ddeaguiar</r>np!</z><z id="t1543343956" t="ccann a couple quick takeaways on my beginner experience with pedestal (not with clojure, just pedestal) - I found it hard to debug constraints. When my request 404&apos;ed because a query param constraint in a parent route (using terse syntax) didn’t match for a child route that doesn’t use that query param I was confused. I understand how they work now. I ended up pretty printing the routes in full form to see the constraints on the route and it clicked. - as mentioned previously, the :io.pedestal.http/host key defaulting to something more restrictive than 0.0.0.0 was surprising coming from having used jetty before with compojure - It took me a bit to find a doc that said defroutes is preferred over expand-routes except in the case where you need to dynamically create routes - I’m not entirely sure what the scheme, host, port etc. optional args in the route syntax do and how they interact with the server config - it wasn’t immediately obvious to me that you can use a ring handler as an interceptor without explicitly using interceptor or the map form"><y>#</y><d>2018-11-27</d><h>18:39</h><w>ccann</w>a couple quick takeaways on my beginner experience with pedestal (not with clojure, just pedestal)
- I found it hard to debug constraints. When my request 404&apos;ed because a query param constraint in a parent route (using terse syntax) didn’t match for a child route that doesn’t use that query param I was confused. I understand how they work now. I ended up pretty printing the routes in full form to see the constraints on the route and it clicked.
- as mentioned previously, the <code>:io.pedestal.http/host</code> key defaulting to something more restrictive than <code>0.0.0.0</code> was surprising coming from having used jetty before with compojure
- It took me a bit to find a doc that said <code>defroutes</code> is preferred over <code>expand-routes</code> except in the case where you need to dynamically create routes
- I’m not entirely sure what the scheme, host, port etc. optional args in the route syntax do and how they interact with the server config
- it wasn’t immediately obvious to me that you can use a ring handler as an interceptor without explicitly using <code>interceptor</code> or the map form</z><z id="t1543520262" t="jvtrigueros Thanks for the summary, I had a very similar experience to yours. I&apos;ve been using Clojure for a while, but recent user of Pedestal."><y>#</y><d>2018-11-29</d><h>19:37</h><r>jvtrigueros</r>Thanks for the summary, I had a very similar experience to yours. I&apos;ve been using Clojure for a while, but recent user of Pedestal.</z><z id="t1543424906" t="johnj what&apos;s the verdict? ring or pedestal? 😉"><y>#</y><d>2018-11-28</d><h>17:08</h><w>johnj</w>what&apos;s the verdict? ring or pedestal? <b>😉</b></z><z id="t1543424918" t="Joe Lane pedestal"><y>#</y><d>2018-11-28</d><h>17:08</h><w>Joe Lane</w>pedestal</z><z id="t1543424929" t="johnj can pedestal do sync only too?"><y>#</y><d>2018-11-28</d><h>17:08</h><w>johnj</w>can pedestal do sync only too?</z><z id="t1543424945" t="Joe Lane what do you mean?"><y>#</y><d>2018-11-28</d><h>17:09</h><w>Joe Lane</w>what do you mean?</z><z id="t1543425045" t="johnj requests are handled asynchronous (multiple requests per thread in an event loop) or one thread per request (synchronous) ?"><y>#</y><d>2018-11-28</d><h>17:10</h><w>johnj</w>requests are handled asynchronous (multiple requests per thread in an event loop) or one thread per request (synchronous) ?</z><z id="t1543425070" t="johnj I know its async, but wondering if it can do sync only too"><y>#</y><d>2018-11-28</d><h>17:11</h><w>johnj</w>I know its async, but wondering if it can do sync only too</z><z id="t1543425089" t="Joe Lane your choice"><y>#</y><d>2018-11-28</d><h>17:11</h><w>Joe Lane</w>your choice</z><z id="t1543425092" t="Joe Lane it does either."><y>#</y><d>2018-11-28</d><h>17:11</h><w>Joe Lane</w>it does either.</z><z id="t1543425129" t="johnj good"><y>#</y><d>2018-11-28</d><h>17:12</h><w>johnj</w>good</z><z id="t1543425174" t="Joe Lane It also streams back SSE with resumable checkpoints."><y>#</y><d>2018-11-28</d><h>17:12</h><w>Joe Lane</w>It also streams back SSE with resumable checkpoints.</z><z id="t1543425675" t="johnj thanks, that might come in handy"><y>#</y><d>2018-11-28</d><h>17:21</h><w>johnj</w>thanks, that might come in handy</z><z id="t1543425762" t="johnj The ability to utilize Ring Middleware as Pedestal Interceptors"><y>#</y><d>2018-11-28</d><h>17:22</h><w>johnj</w>The ability to utilize Ring Middleware as Pedestal Interceptors</z><z id="t1543425777" t="johnj is that done much in practice? utilizing ring middleware?"><y>#</y><d>2018-11-28</d><h>17:22</h><w>johnj</w>is that done much in practice? utilizing ring middleware?</z><z id="t1543425911" t="orestis All the time, sometimes even by pedestal core. "><y>#</y><d>2018-11-28</d><h>17:25</h><w>orestis</w>All the time, sometimes even by pedestal core. </z><z id="t1543425942" t="johnj ok"><y>#</y><d>2018-11-28</d><h>17:25</h><w>johnj</w>ok</z><z id="t1543426078" t="orestis And a lot of the time simple routes will be ring-style handlers (get called with a map, return a response map)"><y>#</y><d>2018-11-28</d><h>17:27</h><w>orestis</w>And a lot of the time simple routes will be ring-style handlers (get called with a map, return a response map)</z><z id="t1543445089" t="ccann I sometimes get caught up debating if something is complex enough to warrant splitting into interceptors vs a ring-handler. It’s been an interesting forcing function for ensuring my code pipelines effectively"><y>#</y><d>2018-11-28</d><h>22:44</h><w>ccann</w>I sometimes get caught up debating if something is complex enough to warrant splitting into interceptors vs a ring-handler. It’s been an interesting forcing function for ensuring my code pipelines effectively</z><z id="t1543583912" t="urzds Hi! How do I mount a file server with document root &quot;/foo/bar&quot; onto &quot;/the/route&quot;, so that browsing /the/route will show me the files in /foo/bar?"><y>#</y><d>2018-11-30</d><h>13:18</h><w>urzds</w>Hi! How do I mount a file server with document root &quot;/foo/bar&quot; onto &quot;/the/route&quot;, so that browsing /the/route will show me the files in /foo/bar?</z><z id="t1543583967" t="urzds I assume it involves io.pedestal.http.ring-middlewares/file and some URL rewriting, but I couldn&apos;t figure out how to do that."><y>#</y><d>2018-11-30</d><h>13:19</h><w>urzds</w>I assume it involves <code>io.pedestal.http.ring-middlewares/file</code> and some URL rewriting, but I couldn&apos;t figure out how to do that.</z><z id="t1543608833" t="jaihindhreddy-duplicate I can&apos;t get the pedestal hello world running with deps.edn"><y>#</y><d>2018-11-30</d><h>20:13</h><w>jaihindhreddy-duplicate</w>I can&apos;t get the pedestal hello world running with deps.edn</z><z id="t1543608852" t="jaihindhreddy-duplicate (require &apos;hello) Syntax error macroexpanding clojure.core/ns at (log.clj:13:1). () - failed: Insufficient input at: [:ns-clauses :import :classes :package-list :classes] spec: :clojure.core.specs.alpha/package-list (io.opentracing.log.Fields) - failed: simple-symbol? at: [:ns-clauses :import :classes :class] spec: :clojure.core.specs.alpha/ns-import :import - failed: #{:refer-clojure} at: [:ns-clauses :refer-clojure :clause] spec: :clojure.core.specs.alpha/ns-refer-clojure :import - failed: #{:require} at: [:ns-clauses :require :clause] spec: :clojure.core.specs.alpha/ns-require :import - failed: #{:use} at: [:ns-clauses :use :clause] spec: :clojure.core.specs.alpha/ns-use :import - failed: #{:refer} at: [:ns-clauses :refer :clause] spec: :clojure.core.specs.alpha/ns-refer :import - failed: #{:load} at: [:ns-clauses :load :clause] spec: :clojure.core.specs.alpha/ns-load :import - failed: #{:gen-class} at: [:ns-clauses :gen-class :clause] spec: :clojure.core.specs.alpha/ns-gen-class user=&gt; "><y>#</y><d>2018-11-30</d><h>20:14</h><w>jaihindhreddy-duplicate</w><pre>(require &apos;hello)
Syntax error macroexpanding clojure.core/ns at (log.clj:13:1).
() - failed: Insufficient input at: [:ns-clauses :import :classes :package-list :classes] spec: :clojure.core.specs.alpha/package-list
(io.opentracing.log.Fields) - failed: simple-symbol? at: [:ns-clauses :import :classes :class] spec: :clojure.core.specs.alpha/ns-import
:import - failed: #{:refer-clojure} at: [:ns-clauses :refer-clojure :clause] spec: :clojure.core.specs.alpha/ns-refer-clojure
:import - failed: #{:require} at: [:ns-clauses :require :clause] spec: :clojure.core.specs.alpha/ns-require
:import - failed: #{:use} at: [:ns-clauses :use :clause] spec: :clojure.core.specs.alpha/ns-use
:import - failed: #{:refer} at: [:ns-clauses :refer :clause] spec: :clojure.core.specs.alpha/ns-refer
:import - failed: #{:load} at: [:ns-clauses :load :clause] spec: :clojure.core.specs.alpha/ns-load
:import - failed: #{:gen-class} at: [:ns-clauses :gen-class :clause] spec: :clojure.core.specs.alpha/ns-gen-class
user=&gt; </pre></z><z id="t1543609120" t="jaihindhreddy-duplicate I think spec is complaining about this: (ns io.pedestal.log &quot;Logging via slf4j. Each logging level is a macro: trace, debug, info, warn, and error. Each namespace gets its own Logger. Arguments are key-value pairs, which will be printed as with &apos;pr&apos;. The special key :exception should have a java.lang.Throwable as its value, and will be passed separately to the underlying logging API. One can override the logger via JVM or ENVAR settings.&quot; (:require clojure.string) (:import (org.slf4j Logger LoggerFactory MDC) (org.slf4j.spi MDCAdapter) (com.codahale.metrics MetricRegistry Gauge Counter Histogram Meter Slf4jReporter) (com.codahale.metrics.jmx JmxReporter) (io.opentracing Scope Span SpanContext Tracer Tracer$SpanBuilder) io.opentracing.log.Fields (io.opentracing.util GlobalTracer) (java.util Map) (java.util.concurrent TimeUnit) (clojure.lang IFn))) Got it from "><y>#</y><d>2018-11-30</d><h>20:18</h><w>jaihindhreddy-duplicate</w>I think spec is complaining about this:<pre>(ns io.pedestal.log
  &quot;Logging via slf4j. Each logging level is a macro: trace, debug,
  info, warn, and error. Each namespace gets its own Logger. Arguments
  are key-value pairs, which will be printed as with &apos;pr&apos;. The special
  key :exception should have a java.lang.Throwable as its value, and
  will be passed separately to the underlying logging API.
  One can override the logger via JVM or ENVAR settings.&quot;
  (:require clojure.string)
  (:import (org.slf4j Logger
                      LoggerFactory
                      MDC)
           (org.slf4j.spi MDCAdapter)
           (com.codahale.metrics MetricRegistry
                                 Gauge Counter Histogram Meter
                                 Slf4jReporter)
           (com.codahale.metrics.jmx JmxReporter)
           (io.opentracing Scope
                           Span
                           SpanContext
                           Tracer
                           Tracer$SpanBuilder)
           io.opentracing.log.Fields
           (io.opentracing.util GlobalTracer)
           (java.util Map)
           (java.util.concurrent TimeUnit)
           (clojure.lang IFn)))</pre>
Got it from <code></code></z><z id="t1543609663" t="jaihindhreddy-duplicate Alright, it seems to work with the versions in the guide"><y>#</y><d>2018-11-30</d><h>20:27</h><w>jaihindhreddy-duplicate</w>Alright, it seems to work with the versions in the guide</z><z id="t1543609672" t="mkvlr [:attrs {:href &quot;/_/_/users/UBU6QCSJH&quot;}] are you using Clojure 1.10?"><y>#</y><d>2018-11-30</d><h>20:27</h><w>mkvlr</w>
<a>@jaihindh.reddy</a> are you using Clojure 1.10?</z><z id="t1543609691" t="jaihindhreddy-duplicate This works: {:paths [&quot;src&quot;] :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;} org.clojure/core.async {:mvn/version &quot;0.4.490&quot;} io.pedestal/pedestal.service {:mvn/version &quot;0.5.1&quot;} io.pedestal/pedestal.route {:mvn/version &quot;0.5.1&quot;} io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.1&quot;} org.slf4j/slf4j-simple {:mvn/version &quot;1.7.21&quot;}}}"><y>#</y><d>2018-11-30</d><h>20:28</h><w>jaihindhreddy-duplicate</w>This works: <pre>{:paths [&quot;src&quot;]
 :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;}
        org.clojure/core.async {:mvn/version &quot;0.4.490&quot;}
        io.pedestal/pedestal.service {:mvn/version &quot;0.5.1&quot;}
        io.pedestal/pedestal.route {:mvn/version &quot;0.5.1&quot;}
        io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.1&quot;}
        org.slf4j/slf4j-simple {:mvn/version &quot;1.7.21&quot;}}}</pre></z><z id="t1543609715" t="jaihindhreddy-duplicate This doesn&apos;t: {:paths [&quot;src&quot;] :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;} org.clojure/core.async {:mvn/version &quot;0.4.490&quot;} io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;} org.slf4j/slf4j-simple {:mvn/version &quot;1.7.25&quot;}}}"><y>#</y><d>2018-11-30</d><h>20:28</h><w>jaihindhreddy-duplicate</w>This doesn&apos;t:<pre>{:paths [&quot;src&quot;]
 :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;}
        org.clojure/core.async {:mvn/version &quot;0.4.490&quot;}
        io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;}
        io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;}
        io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;}
        org.slf4j/slf4j-simple {:mvn/version &quot;1.7.25&quot;}}}</pre></z><z id="t1543609726" t="jaihindhreddy-duplicate Even this doesn&apos;t {:paths [&quot;src&quot;] :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;} org.clojure/core.async {:mvn/version &quot;0.4.490&quot;} io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;} org.slf4j/slf4j-simple {:mvn/version &quot;1.7.21&quot;}}}"><y>#</y><d>2018-11-30</d><h>20:28</h><w>jaihindhreddy-duplicate</w>Even this doesn&apos;t <pre>{:paths [&quot;src&quot;]
 :deps {org.clojure/clojure {:mvn/version &quot;1.10.0-RC2&quot;}
        org.clojure/core.async {:mvn/version &quot;0.4.490&quot;}
        io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;}
        io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;}
        io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;}
        org.slf4j/slf4j-simple {:mvn/version &quot;1.7.21&quot;}}}</pre></z><z id="t1543609779" t="jaihindhreddy-duplicate ^^ Yeah"><y>#</y><d>2018-11-30</d><h>20:29</h><w>jaihindhreddy-duplicate</w>^^ Yeah</z><z id="t1543609821" t="mkvlr io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;} io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;} io.pedestal/pedestal.service-tools {:mvn/version &quot;0.5.4&quot;} "><y>#</y><d>2018-11-30</d><h>20:30</h><w>mkvlr</w><pre>io.pedestal/pedestal.route {:mvn/version &quot;0.5.4&quot;}
  io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.4&quot;}
  io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;}
  io.pedestal/pedestal.service {:mvn/version &quot;0.5.4&quot;}
  io.pedestal/pedestal.service-tools {:mvn/version &quot;0.5.4&quot;}
</pre></z><z id="t1543609827" t="mkvlr try this"><y>#</y><d>2018-11-30</d><h>20:30</h><w>mkvlr</w>try this</z><z id="t1543609895" t="mkvlr current stable doesn&apos;t work with 1.10 because https://github.com/pedestal/pedestal/pull/591 and https://github.com/pedestal/pedestal/pull/592 hasn&apos;t been released yet"><y>#</y><d>2018-11-30</d><h>20:31</h><w>mkvlr</w>current stable doesn&apos;t work with 1.10 because <a href="https://github.com/pedestal/pedestal/pull/591" target="_blank">https://github.com/pedestal/pedestal/pull/591</a> and <a href="https://github.com/pedestal/pedestal/pull/592" target="_blank">https://github.com/pedestal/pedestal/pull/592</a> hasn&apos;t been released yet</z><z id="t1543609924" t="mkvlr we work around this by importing pedestal.log via deps.edn as seen above"><y>#</y><d>2018-11-30</d><h>20:32</h><w>mkvlr</w>we work around this by importing pedestal.log via deps.edn as seen above</z><z id="t1543610084" t="jaihindhreddy-duplicate works. Thank you sir. Should have looked at the Github issue tracker picard-facepalm"><y>#</y><d>2018-11-30</d><h>20:34</h><w>jaihindhreddy-duplicate</w>works. Thank you sir.
Should have looked at the Github issue tracker <b>picard-facepalm</b></z><z id="t1543610128" t="mkvlr glad to hear"><y>#</y><d>2018-11-30</d><h>20:35</h><w>mkvlr</w>glad to hear</z><z id="t1543779875" t="devurandom Is there an interceptor which can turn the path /foo/bar into /bar and /foo/bar/baz into /bar/baz and so on? Basically strip a static part of the path off?"><y>#</y><d>2018-12-02</d><h>19:44</h><w>devurandom</w>Is there an interceptor which can turn the path /foo/bar into /bar and /foo/bar/baz into /bar/baz and so on? Basically strip a static part of the path off?</z><z id="t1543934209" t="ddeaguiar AFAIK, the only interceptor that does this is for serving resources."><y>#</y><d>2018-12-04</d><h>14:36</h><r>ddeaguiar</r>AFAIK, the only interceptor that does this is for serving resources.</z><z id="t1543974139" t="devurandom Which one does it? (ring-middlewares/resource document-root) ?"><y>#</y><d>2018-12-05</d><h>01:42</h><r>devurandom</r>Which one does it? <code>(ring-middlewares/resource document-root)</code>?</z><z id="t1544019167" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U368JQA01&quot;}] it’s based on the bits of ring’s resource middleware. When :io.pedestal.http/resource-path is present in the service map, the value is used as the resource path root."><y>#</y><d>2018-12-05</d><h>14:12</h><r>ddeaguiar</r><a>@U368JQA01</a> it’s based on the bits of ring’s resource middleware. When <code>:io.pedestal.http/resource-path</code> is present in the service map, the value is used as the resource path root.</z><z id="t1544056350" t="devurandom i.e. the resources are mounted into the route at :io.pedestal.http/resource-path ? And hence the middleware treats every path it sees in the route as relative to that resource-path ?"><y>#</y><d>2018-12-06</d><h>00:32</h><r>devurandom</r>i.e. the resources are mounted into the route at <code>:io.pedestal.http/resource-path</code>? And hence the middleware treats every path it sees in the route as relative to that <code>resource-path</code>?</z><z id="t1544056440" t="devurandom i.e. with a route containing &quot;/my/resources/&quot; -&amp;gt; resource-middleware and resource-path=/my, the resource-middleware would look for &quot;/resources/&quot; in the resource directory / classpath?"><y>#</y><d>2018-12-06</d><h>00:34</h><r>devurandom</r>i.e. with a route containing &quot;/my/resources/&quot; -&amp;gt; resource-middleware and resource-path=/my, the resource-middleware would look for &quot;/resources/&quot; in the resource directory / classpath?</z><z id="t1543885961" t="mv That seems like a routing issue, no?"><y>#</y><d>2018-12-04</d><h>01:12</h><w>mv</w>That seems like a routing issue, no?</z><z id="t1543974084" t="devurandom [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] : Possible. I have a /staticpart/*file route and I mount a (ring-middlewares/file document-root) interceptor there. From experience it appears that this interceptor will use the full path, including the /staticpart to locate files on the filesystem. I mitigate that using string/replace on the :path-info ."><y>#</y><d>2018-12-05</d><h>01:41</h><w>devurandom</w><a>@mv</a>: Possible. I have a <code>/staticpart/*file</code> route and I mount a <code>(ring-middlewares/file document-root)</code> interceptor there. From experience it appears that this interceptor will use the full path, including the <code>/staticpart</code> to locate files on the filesystem. I mitigate that using <code>string/replace</code> on the <code>:path-info</code>.</z><z id="t1544050355" t="martinklepsch is anyone using io.pedestal.http.ring-middlewares/not-modified ? I&apos;m noticing that it doesn&apos;t return 304 responses when the following interceptor does: (def test-interceptor {:name ::test :leave (ring-middlewares/response-fn-adapter (fn [response request] (not-modified/not-modified-response response request)))}) "><y>#</y><d>2018-12-05</d><h>22:52</h><w>martinklepsch</w>is anyone using <code>io.pedestal.http.ring-middlewares/not-modified</code>? I&apos;m noticing that it doesn&apos;t return 304 responses when the following interceptor does:
<pre>(def test-interceptor
  {:name ::test
   :leave (ring-middlewares/response-fn-adapter
           (fn [response request]
             (not-modified/not-modified-response response request)))})
</pre></z><z id="t1544052189" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] weird. I’m not using it anywhere but it’s based on the ring not-modified middleware. There’s also a test for it here: https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/test/io/pedestal/http/ring_middlewares_test.clj#L140-L150"><y>#</y><d>2018-12-05</d><h>23:23</h><r>ddeaguiar</r><a>@U050TNB9F</a> weird. I’m not using it anywhere but it’s based on the ring not-modified middleware. There’s also a test for it here: <a href="https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/test/io/pedestal/http/ring_middlewares_test.clj#L140-L150" target="_blank">https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/test/io/pedestal/http/ring_middlewares_test.clj#L140-L150</a></z><z id="t1544052970" t="martinklepsch Thanks, I guess I’ll keep digging then :)"><y>#</y><d>2018-12-05</d><h>23:36</h><r>martinklepsch</r>Thanks, I guess I’ll keep digging then :)</z><z id="t1544089857" t="schmee what’s a good pattern to make requests in parallel in an interceptor chain?"><y>#</y><d>2018-12-06</d><h>09:50</h><w>schmee</w>what’s a good pattern to make requests in parallel in an interceptor chain?</z><z id="t1544089885" t="schmee right now I have two interceptors that make outbound requests by attaching a future to the context and then returning immediately, but I’m wondering if there is a more idiomatic way"><y>#</y><d>2018-12-06</d><h>09:51</h><w>schmee</w>right now I have two interceptors that make outbound requests by attaching a future to the context and then returning immediately, but I’m wondering if there is a more idiomatic way</z><z id="t1544090047" t="schmee does returning an asynchronous context help? my understanding is that even if the first interceptor returns an async context, the second one will still block until the first one is done"><y>#</y><d>2018-12-06</d><h>09:54</h><w>schmee</w>does returning an asynchronous context help? my understanding is that even if the first interceptor returns an async context, the second one will still block until the first one is done</z><z id="t1544112685" t="jaihindhreddy-duplicate ^ Using core.async perhaps?"><y>#</y><d>2018-12-06</d><h>16:11</h><w>jaihindhreddy-duplicate</w>^ Using <code>core.async</code> perhaps?</z><z id="t1544115953" t="martinklepsch Alright, classic middleware issue: at first I didn&apos;t call not-modified and somehow added the interceptor constructor function as an interceptor to the chain. Fixing that didn&apos;t immediately work but I then realized that the interceptor order was wrong, the etag was only set after the not-modified interceptor ran. 🙂"><y>#</y><d>2018-12-06</d><h>17:05</h><w>martinklepsch</w>Alright, classic middleware issue: at first I didn&apos;t call <code>not-modified</code> and somehow added the interceptor constructor function as an interceptor to the chain. Fixing that didn&apos;t immediately work but I then realized that the interceptor order was wrong, the etag was only set after the <code>not-modified</code> interceptor ran. <b>🙂</b></z><z id="t1544115957" t="martinklepsch Problem solved 🙂"><y>#</y><d>2018-12-06</d><h>17:05</h><w>martinklepsch</w>Problem solved <b>🙂</b></z><z id="t1544124592" t="ccann has anyone ever gotten pedestal’s response-for to work with multipart-params? (ring-mw/multipart-params) as an interceptor doesn’t add the :form-params when using response-for to test, but works when actually hitting the server"><y>#</y><d>2018-12-06</d><h>19:29</h><w>ccann</w>has anyone ever gotten pedestal’s <code>response-for</code> to work with multipart-params?
<code>(ring-mw/multipart-params)</code> as an interceptor doesn’t add the :form-params when using <code>response-for</code> to test, but works when actually hitting the server</z><z id="t1544125411" t="ccann i’m not 100% sure but it almost looks like the content type gets explicitly overridden? https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L141"><y>#</y><d>2018-12-06</d><h>19:43</h><w>ccann</w>i’m not 100% sure but it almost looks like the content type gets explicitly overridden? <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L141" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/test.clj#L141</a></z><z id="t1544203555" t="souenzzo There is a helper to make {:foo &quot;bar&quot;} =&gt; foo=bar to turn form-params into a &quot;body string&quot;?"><y>#</y><d>2018-12-07</d><h>17:25</h><w>souenzzo</w>There is a helper to make <code>{:foo &quot;bar&quot;}</code> =&gt; <code>foo=bar</code> to turn <code>form-params</code> into a &quot;body string&quot;?</z><z id="t1544204149" t="souenzzo I think that I need a example of pedestal.test/response-for doing a HTTP POST with form-params"><y>#</y><d>2018-12-07</d><h>17:35</h><w>souenzzo</w>I think that I need a example of <code>pedestal.test/response-for</code> doing a HTTP POST with form-params</z><z id="t1544213864" t="ccann here’s my rough example using peridot to construct the multipart headers and body (require &apos;[peridot.multipart :as multipart]) (let [{:keys [body headers]} (multipart/build {:graphic (io/file &quot;foo.bar&quot;) :user-id 1}) {:keys [status body headers]} (-&gt; (::http/service-fn (http/create-servlet server/config)) (response-for :post &quot;/notes&quot; :body body :headers headers) (decode))] (is (= 201 status)) (is (= foo body)))"><y>#</y><d>2018-12-07</d><h>20:17</h><w>ccann</w>here’s my rough example using peridot to construct the multipart headers and body
<pre>(require &apos;[peridot.multipart :as multipart])


(let [{:keys [body headers]}        (multipart/build {:graphic (io/file &quot;foo.bar&quot;)
                                                      :user-id 1})
      {:keys [status body headers]} (-&gt; (::http/service-fn (http/create-servlet server/config))
                                        (response-for :post &quot;/notes&quot;
                                                      :body body
                                                      :headers headers)
                                        (decode))]
  (is (= 201 status))
  (is (= foo body)))</pre></z><z id="t1544810646" t="ccann anyone else have issues with response-for not behaving the same way as the server does outside of the test environment? e.g. my buddy authorization middleware doesn’t add the identity to the request e.g. my multipart params middleware doesn’t add the params to the request the interceptors are in the chain, and they run, but downstream the data is missing edit: the authentication works"><y>#</y><d>2018-12-14</d><h>18:04</h><w>ccann</w>anyone else have issues with <code>response-for</code> not behaving the same way as the server does outside of the test environment?
e.g. my buddy authorization middleware doesn’t add the identity to the request
e.g. my multipart params middleware doesn’t add the params to the request
the interceptors are in the chain, and they run, but downstream the data is missing

edit: the authentication works</z><z id="t1544812159" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] not as far as I know"><y>#</y><d>2018-12-14</d><h>18:29</h><w>ddeaguiar</w><a>@ccann</a> not as far as I know</z><z id="t1544812196" t="ccann okay, I will file a ticket for the multipart issue when I find the time!"><y>#</y><d>2018-12-14</d><h>18:29</h><w>ccann</w>okay, I will file a ticket for the multipart issue when I find the time!</z><z id="t1544911987" t="yefoakira Hello, just starting with pedestal. I have the hello-world example. When I use from my terminal lein run-dev I get the expected answer. I have added a Dockerfile and a docker-compose.yml running the same command. The jetty server starts inside the container, but I get a connection was reset when navigating to the correct port. I&apos;m using (constantly true) for :allowed-origins . Does anyone know what I am missing?"><y>#</y><d>2018-12-15</d><h>22:13</h><w>yefoakira</w>Hello, just starting with pedestal. I have the hello-world example. When I use from my terminal <code>lein run-dev</code> I get the expected answer. I have added a <code>Dockerfile</code> and a <code>docker-compose.yml</code> running the same command. The jetty server starts inside the container, but I get a <code>connection was reset</code> when navigating to the correct port. I&apos;m using <code>(constantly true)</code> for <code>:allowed-origins</code>. Does anyone know what I am missing?</z><z id="t1544912031" t="mtnygard [:attrs {:href &quot;/_/_/users/U1JMYL324&quot;}] Can you share your Dockerfile and docker-compose.yml here?"><y>#</y><d>2018-12-15</d><h>22:13</h><w>mtnygard</w><a>@yefoakira</a> Can you share your Dockerfile and docker-compose.yml here?</z><z id="t1544912070" t="yefoakira Sure Dockerfile: FROM clojure:lein RUN mkdir -p /usr/src/app WORKDIR /usr/src/app COPY project.clj /usr/src/app RUN lein deps EXPOSE 8080"><y>#</y><d>2018-12-15</d><h>22:14</h><w>yefoakira</w>Sure
Dockerfile:
<pre>FROM clojure:lein
RUN mkdir -p /usr/src/app
WORKDIR /usr/src/app
COPY project.clj /usr/src/app
RUN lein deps
EXPOSE 8080</pre></z><z id="t1544912095" t="yefoakira docker-compose.yml version: &apos;3&apos; services: web: build: . ports: - &quot;4001:8080&quot; volumes: - .:/usr/src/app command: lein run-dev "><y>#</y><d>2018-12-15</d><h>22:14</h><w>yefoakira</w>docker-compose.yml
<pre>version: &apos;3&apos;
services:
  web:
    build: .
    ports:
      - &quot;4001:8080&quot;
    volumes:
      - .:/usr/src/app
    command: lein run-dev
</pre></z><z id="t1544912200" t="mtnygard I see that your Dockerfile copies the project.clj into the container, but I don&apos;t see how your application source gets copied."><y>#</y><d>2018-12-15</d><h>22:16</h><w>mtnygard</w>I see that your Dockerfile copies the project.clj into the container, but I don&apos;t see how your application source gets copied.</z><z id="t1544912275" t="yefoakira volumes: on docker-compose links my folder with my source into /usr/src/app"><y>#</y><d>2018-12-15</d><h>22:17</h><w>yefoakira</w><code>volumes:</code> on <code>docker-compose</code> links my folder with my source into <code>/usr/src/app</code></z><z id="t1544912293" t="mtnygard Oh, right."><y>#</y><d>2018-12-15</d><h>22:18</h><w>mtnygard</w>Oh, right.</z><z id="t1544912309" t="mtnygard What do you see in the logs from docker-compose?"><y>#</y><d>2018-12-15</d><h>22:18</h><w>mtnygard</w>What do you see in the logs from docker-compose?</z><z id="t1544912377" t="yefoakira last lines are: web_1 | 22:11:32.242 [main] INFO org.eclipse.jetty.server.Server - Started @2471ms web_1 | 22:11:32.242 [qtp1315795813-24] DEBUG org.eclipse.jetty.util.thread.QueuedThreadPool - run acceptor-1@408a247c web_1 | 22:11:32.242 [main] DEBUG org.eclipse.jetty.util.component.AbstractLifeCycle - STARTED @2471ms org.eclipse.jetty.server.Server@7c0da600[9.4.10.v20180503] And nothing comes out when I go the url location."><y>#</y><d>2018-12-15</d><h>22:19</h><w>yefoakira</w>last lines are:
<pre>web_1  | 22:11:32.242 [main] INFO org.eclipse.jetty.server.Server - Started @2471ms
web_1  | 22:11:32.242 [qtp1315795813-24] DEBUG org.eclipse.jetty.util.thread.QueuedThreadPool - run acceptor-1@408a247c
web_1  | 22:11:32.242 [main] DEBUG org.eclipse.jetty.util.component.AbstractLifeCycle - STARTED @2471ms org.eclipse.jetty.server.Server@7c0da600[9.4.10.v20180503]
</pre>
And nothing comes out when I go the url location.</z><z id="t1544912404" t="mtnygard URL being something like http://localhost:4001/ ?"><y>#</y><d>2018-12-15</d><h>22:20</h><w>mtnygard</w>URL being something like <a href="http://localhost:4001/" target="_blank">http://localhost:4001/</a> ?</z><z id="t1544912483" t="yefoakira yep"><y>#</y><d>2018-12-15</d><h>22:21</h><w>yefoakira</w>yep</z><z id="t1544912552" t="mtnygard Well, that was the obvious stuff. Give me a minute to try to replicate the problem."><y>#</y><d>2018-12-15</d><h>22:22</h><w>mtnygard</w>Well, that was the obvious stuff. Give me a minute to try to replicate the problem.</z><z id="t1544912560" t="mtnygard What OS are you on?"><y>#</y><d>2018-12-15</d><h>22:22</h><w>mtnygard</w>What OS are you on?</z><z id="t1544912670" t="mtnygard Is your project.clj straight from the leiningen template?"><y>#</y><d>2018-12-15</d><h>22:24</h><w>mtnygard</w>Is your project.clj straight from the leiningen template?</z><z id="t1544912790" t="yefoakira Linux Mint. Other than adding midje, yep."><y>#</y><d>2018-12-15</d><h>22:26</h><w>yefoakira</w>Linux Mint. Other than adding midje, yep.</z><z id="t1544913198" t="mtnygard I&apos;ve more or less reproduced the problem."><y>#</y><d>2018-12-15</d><h>22:33</h><w>mtnygard</w>I&apos;ve more or less reproduced the problem.</z><z id="t1544913210" t="mtnygard I&apos;m on Windows with WSL rather than Linux, so there&apos;s bound to be a little variation."><y>#</y><d>2018-12-15</d><h>22:33</h><w>mtnygard</w>I&apos;m on Windows with WSL rather than Linux, so there&apos;s bound to be a little variation.</z><z id="t1544913217" t="mtnygard Instead of connection reset, I get an empty response."><y>#</y><d>2018-12-15</d><h>22:33</h><w>mtnygard</w>Instead of connection reset, I get an empty response.</z></g><g id="s14"><z id="t1544913270" t="mtnygard The issue is that Jetty only binds to a server socket on &quot;localhost&quot;."><y>#</y><d>2018-12-15</d><h>22:34</h><w>mtnygard</w>The issue is that Jetty only binds to a server socket on &quot;localhost&quot;.</z><z id="t1544913296" t="mtnygard To get it to listen for connections on any other IP address than 127.0.0.1, you can set the :: http/host key to &quot;0.0.0.0&quot; in service.clj"><y>#</y><d>2018-12-15</d><h>22:34</h><w>mtnygard</w>To get it to listen for connections on any other IP address than 127.0.0.1, you can set the <b>::</b>http/host key to &quot;0.0.0.0&quot; in service.clj</z><z id="t1544913312" t="mtnygard With that, I&apos;m able to get a good response from the host."><y>#</y><d>2018-12-15</d><h>22:35</h><w>mtnygard</w>With that, I&apos;m able to get a good response from the host.</z><z id="t1544913748" t="yefoakira Oooooohhh. Completely missed that. Thanks 😊"><y>#</y><d>2018-12-15</d><h>22:42</h><w>yefoakira</w>Oooooohhh. Completely missed that. Thanks <b>😊</b></z><z id="t1544913757" t="mtnygard yw"><y>#</y><d>2018-12-15</d><h>22:42</h><w>mtnygard</w>yw</z><z id="t1544995205" t="bobcalco I am using pedestal for API with a front end in re-frame/reagent. I need to have different layout for the landing page and the logged in &quot;admin&quot; console. I am using for routing in the front end and struggling to get its routing to play nice with pedestal&apos;s. The desired behavior is: &quot;/&quot; goes to a static landing page written in plain ol HTML; &quot;/admin&quot; goes to the portal front-end in re-frame using bidi; /api/ do what you expect. When I used the re-frame-starter project at github, it was wired to route / to the SPA, and everything that didn&apos;t start with /api was routing to the correct bidi routers. now that my app is off /admin, I can&apos;t get the :homepage route to render - just goes to Not Found, and any sub-path off /admin goes to pedestal&apos;s &quot;not found&quot; handler. I am not sure how to get pedestal to ignore anything off the /admin root, or to get bidi to recognize it&apos;s proper &quot;base&quot; url. Examples at its README all show hard-coding the whole domain root, which is not practical at all. Ideally, I&apos;d like to use pedestal as a back end to multiple front-end SPAs so really the question is, how best to do that? I know pedestal was designed for API back ends but surely other people have gotten this to work. Any help/thoughts appreciated."><y>#</y><d>2018-12-16</d><h>21:20</h><w>bobcalco</w>I am using pedestal for API with a front end in re-frame/reagent. I need to have different layout for the landing page and the logged in &quot;admin&quot; console. I am using for routing in the front end and struggling to get its routing to play nice with pedestal&apos;s. The desired behavior is: &quot;/&quot; goes to a static landing page written in plain ol HTML; &quot;/admin&quot; goes to the portal front-end in re-frame using bidi; /api/ do what you expect. When I used the re-frame-starter project at github, it was wired to route / to the SPA, and everything that didn&apos;t start with /api was routing to the correct bidi routers. now that my app is off /admin, I can&apos;t get the :homepage route to render - just goes to Not Found, and any sub-path off /admin goes to pedestal&apos;s &quot;not found&quot; handler. I am not sure how to get pedestal to ignore anything off the /admin root, or to get bidi to recognize it&apos;s proper &quot;base&quot; url. Examples at its README all show hard-coding the whole domain root, which is not practical at all. Ideally, I&apos;d like to use pedestal as a back end to multiple front-end SPAs so really the question is, how best to do that? I know pedestal was designed for API back ends but surely other people have gotten this to work. Any help/thoughts appreciated.</z><z id="t1544997688" t="mtnygard [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] Hi Bob. A lot of detail there... a bit hard to build the mental model from text. Are you able to pull out the routing portion into a repro case that I could look at?"><y>#</y><d>2018-12-16</d><h>22:01</h><w>mtnygard</w><a>@bob592</a> Hi Bob. A lot of detail there... a bit hard to build the mental model from text. Are you able to pull out the routing portion into a repro case that I could look at?</z><z id="t1545012468" t="bobcalco [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Let me try first more simply to describe what I want: A static &quot;landing&quot; page at &quot;/&quot;, an api root of /api/* which is handled server side, and an admin console at /admin that itself has many logical sub-&quot;routes&quot; using bidi with re-frame. The static page at &quot;/&quot; has different style completely from the admin console at &quot;/admin&quot; (which is a SPA). Currently I&apos;m slurping up two different starter index.html files, but I&apos;d rather make the entire page rendering dynamic (looking at rum for that). I have not changed the code much from what you find at https://github.com/pdlug/re-frame-starter . Anyway.... the abstract question is, how to get pedestal routes to play nice with bidi routes in the case where the SPA is not being created off root &quot;/&quot; but rather off &quot;/admin&quot; (for example). I am refactoring things a bit right now so code posts aren&apos;t practical at this precise moment. I&apos;m trying to think differently about my problem and see if I can&apos;t find a solution that doesn&apos;t fight the frameworks expected behavior. For example: I&apos;d be happy putting every page in the SPA if I could render entirely different CSS styling/JS for logged in vs not logged in scenarios. This is why I separated them in the first place - the need to have different stuff in the &lt;head&gt; and different JS at the bottom."><y>#</y><d>2018-12-17</d><h>02:07</h><w>bobcalco</w><a>@mtnygard</a> Let me try first more simply to describe what I want: A static &quot;landing&quot; page at &quot;/&quot;, an api root of /api/* which is handled server side, and an admin console at /admin that itself has many logical sub-&quot;routes&quot; using bidi with re-frame. The static page at &quot;/&quot; has different style completely from the admin console at &quot;/admin&quot; (which is a SPA). Currently I&apos;m slurping up two different starter index.html files, but I&apos;d rather make the entire page rendering dynamic (looking at rum for that). I have not changed the code much from what you find at <a href="https://github.com/pdlug/re-frame-starter" target="_blank">https://github.com/pdlug/re-frame-starter</a>. Anyway.... the abstract question is, how to get pedestal routes to play nice with bidi routes in the case where the SPA is not being created off root &quot;/&quot; but rather off &quot;/admin&quot; (for example). I am refactoring things a bit right now so code posts aren&apos;t practical at this precise moment. I&apos;m trying to think differently about my problem and see if I can&apos;t find a solution that doesn&apos;t fight the frameworks expected behavior. For example: I&apos;d be happy putting every page in the SPA if I could render entirely different CSS styling/JS for logged in vs not logged in scenarios. This is why I separated them in the first place - the need to have different stuff in the &lt;head&gt; and different JS at the bottom.</z><z id="t1545017131" t="mtnygard [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] I see. I just took a look at bidi’s code. They don’t directly support Pedestal, but I think you could make a very simple interceptor to glue a Pedestal route to the bidi router. That would be the sole interceptor on ‘/admin’. Then that interceptor would call the bidi router directly and pass it the request map from the context."><y>#</y><d>2018-12-17</d><h>03:25</h><w>mtnygard</w><a>@bob592</a> I see. I just took a look at bidi’s code. They don’t directly support Pedestal, but I think you could make a very simple interceptor to glue a Pedestal route to the bidi router. That would be the sole interceptor on ‘/admin’. Then that interceptor would call the bidi router directly and pass it the request map from the context.</z><z id="t1545049150" t="bobcalco [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Thing is, I don&apos;t want the admin console SPA reloaded every time Pedestal detects a route that &quot;belongs&quot; to it, as it would be harder (if not impossible or in any case highly non-performant) to maintain application state. Might as well do MVC post-backs (ahem). The request shouldn&apos;t even be making it to the server if bidi has it &quot;covered,&quot; no? Maybe I should just use a different routing engine. The more interesting problem is, how do I support more than one CSS theme/design? I&apos;m coming to the conclusion that I should just run two separate instances of pedestal - one HTTP and the other (once in production) HTTPS. Usually routing could split those hairs with interceptors but I don&apos;t know a way to generate the CSS I need in the &lt;head&gt; on the fly, as reagent is mounting the &quot;app&quot; div in the &lt;body&gt;, although I can probably do it by generating my own &lt;link&gt; tags since hiccups doesn&apos;t. A flask of Rum is sounding good perhaps for this. Alas, frameworks are as much a source of incidental complexity as language syntax..."><y>#</y><d>2018-12-17</d><h>12:19</h><w>bobcalco</w><a>@mtnygard</a> Thing is, I don&apos;t want the admin console SPA reloaded every time Pedestal detects a route that &quot;belongs&quot; to it, as it would be harder (if not impossible or in any case highly non-performant) to maintain application state. Might as well do MVC post-backs (ahem). The request shouldn&apos;t even be making it to the server if bidi has it &quot;covered,&quot; no? Maybe I should just use a different routing engine. The more interesting problem is, how do I support more than one CSS theme/design? I&apos;m coming to the conclusion that I should just run two separate instances of pedestal - one HTTP and the other (once in production) HTTPS. Usually routing could split those hairs with interceptors but I don&apos;t know a way to generate the CSS I need in the &lt;head&gt; on the fly, as reagent is mounting the &quot;app&quot; div in the &lt;body&gt;, although I can probably do it by generating my own &lt;link&gt; tags since hiccups doesn&apos;t. A flask of Rum is sounding good  perhaps for this. Alas, frameworks are as much a source of incidental complexity as language syntax...</z><z id="t1545070001" t="mtnygard [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] I&apos;m lost. How does bidi affect your SPA state at all? I thought it was a back end routing framework."><y>#</y><d>2018-12-17</d><h>18:06</h><w>mtnygard</w><a>@bob592</a> I&apos;m lost. How does bidi affect your SPA state at all? I thought it was a back end routing framework.</z><z id="t1545070896" t="bobcalco [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] It&apos;s a front-end routing library AFAIK, and on the #re-frame channel I&apos;m getting some help that seems to be on point by [:attrs {:href &quot;/_/_/users/UE5E056D7&quot;}] ... he recommends I combine bidi with pushy on the client. Apparently it can prevent the call to the server for subroutes but I&apos;m still not entirely clear myself how it is supposed to play nice with pedestal&apos;s server-side routing. The link the the article he pointed me to talks only about compojure. However, if it does require server side cooperation, your original idea about an interceptor for /admin may be the key after all. I still feel like I need more fundamentally to rethink what I&apos;m trying to do. The motivation for all of this is simply to have different styling for a not-logged-in landing page, and a separate styling for the logged-in admin SPA."><y>#</y><d>2018-12-17</d><h>18:21</h><w>bobcalco</w><a>@mtnygard</a> It&apos;s a front-end routing library AFAIK, and on the #re-frame channel I&apos;m getting some help that seems to be on point by <a>@mateus.pimentel.w</a>... he recommends I combine bidi with pushy on the client. Apparently it can prevent the call to the server for subroutes but I&apos;m still not entirely clear myself how it is supposed to play nice with pedestal&apos;s server-side routing. The link the the article he pointed me to talks only about compojure. However, if it does require server side cooperation, your original idea about an interceptor for /admin may be the key after all. I still feel like I need more fundamentally to rethink what I&apos;m trying to do. The motivation for all of this is simply to have different styling for a not-logged-in landing page, and a separate styling for the logged-in admin SPA.</z><z id="t1545071594" t="madstap Bidi is portable between clj/cljs and only cares about translating string paths to/from data structures."><y>#</y><d>2018-12-17</d><h>18:33</h><w>madstap</w>Bidi is portable between clj/cljs and only cares about translating string paths to/from data structures.</z><z id="t1545071670" t="madstap Both using it on the backend with pedestal and on the frontend with pushy make sense, but are different things."><y>#</y><d>2018-12-17</d><h>18:34</h><w>madstap</w>Both using it on the backend with pedestal and on the frontend with pushy make sense, but are different things.</z><z id="t1545071726" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] ! I think it’s best to distinguish between front-end and service api here. There will be some endpoints provided by your service api to satisfy app needs. How you coordinate that interaction is an orthogonal issue."><y>#</y><d>2018-12-17</d><h>18:35</h><w>ddeaguiar</w>Hi <a>@bob592</a>! I think it’s best to distinguish between front-end and service api here. There will be some endpoints provided by your service api to satisfy app needs. How you coordinate that interaction is an orthogonal issue.</z><z id="t1545071787" t="bobcalco [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Yes, I&apos;m trying to think that through. As usual, starter projects and templates create more headaches than starting from first principles."><y>#</y><d>2018-12-17</d><h>18:36</h><w>bobcalco</w><a>@ddeaguiar</a> Yes, I&apos;m trying to think that through. As usual, starter projects and templates create more headaches than starting from first principles.</z><z id="t1545071826" t="ddeaguiar yeah, we don’t have starter projects which dive into this area"><y>#</y><d>2018-12-17</d><h>18:37</h><w>ddeaguiar</w>yeah, we don’t have starter projects which dive into this area</z><z id="t1545071830" t="bobcalco they only save you time if your app requirements are of the &quot;hello, world&quot; variety."><y>#</y><d>2018-12-17</d><h>18:37</h><w>bobcalco</w>they only save you time if your app requirements are of the &quot;hello, world&quot; variety.</z><z id="t1545071869" t="ddeaguiar I recommend two different projects for front-end and service api"><y>#</y><d>2018-12-17</d><h>18:37</h><w>ddeaguiar</w>I recommend two different projects for front-end and service api</z><z id="t1545071882" t="ddeaguiar they can be in the same repo if you want but I think the separation is useful"><y>#</y><d>2018-12-17</d><h>18:38</h><w>ddeaguiar</w>they can be in the same repo if you want but I think the separation is useful</z><z id="t1545071913" t="ddeaguiar I’d also consider implementing a mechanism to stub out service api interactions in the front-end code"><y>#</y><d>2018-12-17</d><h>18:38</h><w>ddeaguiar</w>I’d also consider implementing a mechanism to stub out service api interactions in the front-end code</z><z id="t1545072299" t="Whiskas [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] My provisory solution is to return index.html for everything but resources/files and let pushy to change the route for me with the help of bidi"><y>#</y><d>2018-12-17</d><h>18:44</h><w>Whiskas</w><a>@bob592</a> My provisory solution is to return index.html for everything but resources/files and let pushy to change the route for me with the help of bidi</z><z id="t1545072332" t="Whiskas but the ideal solution would be to use the same routes you set on client, on the server, returning index for them"><y>#</y><d>2018-12-17</d><h>18:45</h><w>Whiskas</w>but the ideal solution would be to use the same routes you set on client, on the server, returning index for them</z><z id="t1545072379" t="Whiskas since you are doing full stack clojure i think this should not be hard since the route definition can be done in a shared file and transformed into the appropriate format for the server"><y>#</y><d>2018-12-17</d><h>18:46</h><w>Whiskas</w>since you are doing full stack clojure i think this should not be hard since the route definition can be done in a shared file and transformed into the appropriate format for the server</z><z id="t1545072385" t="Whiskas i’m not a specialist in this subject tho"><y>#</y><d>2018-12-17</d><h>18:46</h><w>Whiskas</w>i’m not a specialist in this subject tho</z><z id="t1545072493" t="bobcalco [:attrs {:href &quot;/_/_/users/UE5E056D7&quot;}] What i want to avoid in that case is constantly re-initializing application state each time the server posts back an index. I need some way to get the client and server to cooperate with whole-page rendering, not just the &quot;app&quot; div. At least, that&apos;s what I think I need. Separating the two seems like a good idea until you need to debug the round trip for API calls."><y>#</y><d>2018-12-17</d><h>18:48</h><w>bobcalco</w><a>@mateus.pimentel.w</a> What i want to avoid in that case is constantly re-initializing application state each time the server posts back an index. I need some way to get the client and server to cooperate with whole-page rendering, not just the &quot;app&quot; div. At least, that&apos;s what I think I need. Separating the two seems like a good idea until you need to debug the round trip for API calls.</z><z id="t1545072643" t="ddeaguiar One thing to keep in mind is that it’s quite nice to separate front-end index.html from the backend service. Completely decouple them. For example, serve the front-end from s3 or something"><y>#</y><d>2018-12-17</d><h>18:50</h><w>ddeaguiar</w>One thing to keep in mind is that it’s quite nice to separate front-end index.html from the backend service. Completely decouple them. For example, serve the front-end from s3 or something</z><z id="t1545072750" t="ddeaguiar front-end just makes service calls for data it needs. How you do this is up to you. Here’s where folks stumble on too coarse-grained or fine-grained service apis and what implementations like graphQL try to solve."><y>#</y><d>2018-12-17</d><h>18:52</h><w>ddeaguiar</w>front-end just makes service calls for data it needs. How you do this is up to you. Here’s where folks stumble on too coarse-grained or fine-grained service apis and what implementations like graphQL try to solve.</z><z id="t1545072777" t="ddeaguiar I don’t think there’s one good answer because it’s context-specific"><y>#</y><d>2018-12-17</d><h>18:52</h><w>ddeaguiar</w>I don’t think there’s one good answer because it’s context-specific</z><z id="t1545073321" t="bobcalco [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] In concept I agree of course. But development and deployment are two different worlds with their own exigencies and &quot;incidental compexities&quot;... Alas, the language can&apos;t really help us with those as much as we might like, especially once we start having to live with various design decisions and their sometimes unforeseeable consequences. I won&apos;t even mention the incidental complexities of development on a platform like the JVM with diverse tooling options and related ceremonies, and the seemingly infinite smorgasbord of library choices with varying interdependencies and version complexities... never a dull moment. 🙂"><y>#</y><d>2018-12-17</d><h>19:02</h><w>bobcalco</w><a>@ddeaguiar</a> In concept I agree of course. But development and deployment are two different worlds with their own exigencies and &quot;incidental compexities&quot;... Alas, the language can&apos;t really help us with those as much as we might like, especially once we start having to live with various design decisions and their sometimes unforeseeable consequences. I won&apos;t even mention the incidental complexities of development on a platform like the JVM with diverse tooling options and related ceremonies, and the seemingly infinite smorgasbord of library choices with varying interdependencies and version complexities... never a dull moment. <b>🙂</b></z><z id="t1545073728" t="Whiskas [:attrs {:href &quot;/_/_/users/U83QBDSHG&quot;}] are you developing a non-spa ?"><y>#</y><d>2018-12-17</d><h>19:08</h><w>Whiskas</w><a>@bob592</a> are you developing a non-spa ?</z><z id="t1545073740" t="Whiskas here i just switch views using re-frame/dispatch"><y>#</y><d>2018-12-17</d><h>19:09</h><w>Whiskas</w>here i just switch views using re-frame/dispatch</z><z id="t1545073746" t="Whiskas and the url is synced"><y>#</y><d>2018-12-17</d><h>19:09</h><w>Whiskas</w>and the url is synced</z><z id="t1545073763" t="Whiskas the url is synced in case you want to copy paste the url for that specific url"><y>#</y><d>2018-12-17</d><h>19:09</h><w>Whiskas</w>the url is synced in case you want to copy paste the url for that specific url</z><z id="t1545073779" t="Whiskas if you want to use the cached index i think you will have to add # to the url"><y>#</y><d>2018-12-17</d><h>19:09</h><w>Whiskas</w>if you want to use the cached index i think you will have to add # to the url</z><z id="t1545120735" t="mkvlr might I suggest again that it would be good to cut a pedestal release that’s compatible with Clojure 1.10 now that’s been released?"><y>#</y><d>2018-12-18</d><h>08:12</h><w>mkvlr</w>might I suggest again that it would be good to cut a pedestal release that’s compatible with Clojure 1.10 now that’s been released?</z><z id="t1545120771" t="mkvlr in the meantime people that want to upgrade Clojure can use io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;} if they’re using deps.edn"><y>#</y><d>2018-12-18</d><h>08:12</h><w>mkvlr</w>in the meantime people that want to upgrade Clojure can use <code>io.pedestal/pedestal.log {:git/url &quot;&quot; :sha &quot;5ab1c9770472694f94d0835cda412ba753b28809&quot;}</code> if they’re using <code>deps.edn</code></z><z id="t1545131373" t="souenzzo [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] you can also force a old version of core.specs org.clojure/core.specs.alpha {:mvn/version &quot;0.2.36&quot;}"><y>#</y><d>2018-12-18</d><h>11:09</h><w>souenzzo</w><a>@mkvlr</a> you can also force a old version of core.specs <code>org.clojure/core.specs.alpha {:mvn/version &quot;0.2.36&quot;}</code></z><z id="t1545139544" t="ddeaguiar Yep, I will work on cutting a release. Sorry about the delay!"><y>#</y><d>2018-12-18</d><h>13:25</h><w>ddeaguiar</w>Yep, I will work on cutting a release. Sorry about the delay!</z><z id="t1545161521" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] , I just cut a Pedestal release (`0.5.5`). I’ll posting release notes later but the TL;DR is that it’s a minor release driven by the io.pedestal.log/Clojure 1.10 incompatibility."><y>#</y><d>2018-12-18</d><h>19:32</h><w>ddeaguiar</w><a>@mkvlr</a>, I just cut a Pedestal release (`0.5.5`). I’ll posting release notes later but the TL;DR is that it’s a minor release driven by the io.pedestal.log/Clojure 1.10 incompatibility.</z><z id="t1545165622" t="Joe Lane Thank you!"><y>#</y><d>2018-12-18</d><h>20:40</h><w>Joe Lane</w>Thank you!</z><z id="t1545169344" t="donaldball I’m using pedestal log and am looking to send e.g. a slack notification whenever an error is logged. I’m trying to decide between overriding the default logger and passing an explicit logger into all of my log calls. There are few different ways I can see to make this work, curious if anyone has done or seen something similar and can speak to their experience."><y>#</y><d>2018-12-18</d><h>21:42</h><w>donaldball</w>I’m using pedestal log and am looking to send e.g. a slack notification whenever an error is logged. I’m trying to decide between overriding the default logger and passing an explicit logger into all of my log calls. There are few different ways I can see to make this work, curious if anyone has done or seen something similar and can speak to their experience.</z><z id="t1545170252" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] , had the need to do that but I’d be careful conflating logging with Slack notifications, or third party integrations in general"><y>#</y><d>2018-12-18</d><h>21:57</h><w>ddeaguiar</w><a>@donaldball</a>, had the need to do that but I’d be careful conflating logging with Slack notifications, or third party integrations in general</z><z id="t1545170275" t="ddeaguiar But overriding the default logger seems like the cleaner way to do it"><y>#</y><d>2018-12-18</d><h>21:57</h><w>ddeaguiar</w>But overriding the default logger seems like the cleaner way to do it</z><z id="t1545170640" t="donaldball Yeah, rate limiting and message size concerns are duly noted, but it’s a reasonable choice for this app"><y>#</y><d>2018-12-18</d><h>22:04</h><w>donaldball</w>Yeah, rate limiting and message size concerns are duly noted, but it’s a reasonable choice for this app</z><z id="t1545171669" t="donaldball The thing that seems most annoying about this route is that I only want to add a behavior, not replace the existing behavior, so I have to copy https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L248-L249"><y>#</y><d>2018-12-18</d><h>22:21</h><w>donaldball</w>The thing that seems most annoying about this route is that I only want to add a behavior, not replace the existing behavior, so I have to copy <a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L248-L249" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L248-L249</a></z><z id="t1545213694" t="mkvlr now that we’re trying to upgrade from 0.5.3 to 0.5.5 we’re running into https://github.com/pedestal/pedestal/pull/544/files#diff-c7e8051a2ca9de05fbfd6b4fc858ddc7 . We’ve previously just enqueued map values as interceptors (which worked fine) but now the pre condition fails."><y>#</y><d>2018-12-19</d><h>10:01</h><w>mkvlr</w>now that we’re trying to upgrade from 0.5.3 to 0.5.5 we’re running into <a href="https://github.com/pedestal/pedestal/pull/544/files#diff-c7e8051a2ca9de05fbfd6b4fc858ddc7" target="_blank">https://github.com/pedestal/pedestal/pull/544/files#diff-c7e8051a2ca9de05fbfd6b4fc858ddc7</a>. We’ve previously just enqueued map values as interceptors (which worked fine) but now the pre condition fails.</z><z id="t1545214024" t="mkvlr but looks like this was never intended. Would there be interest in accepting a change which makes enqueue also take values and converts them into an interceptor record?"><y>#</y><d>2018-12-19</d><h>10:07</h><w>mkvlr</w>but looks like this was never intended. Would there be interest in accepting a change which makes enqueue also take values and converts them into an interceptor record?</z><z id="t1545214282" t="mkvlr if not maybe we should update the interceptors guide http://pedestal.io/reference/interceptors and change the code to produce interceptor records?"><y>#</y><d>2018-12-19</d><h>10:11</h><w>mkvlr</w>if not maybe we should update the interceptors guide <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a> and change the code to produce interceptor records?</z><z id="t1545223168" t="mavbozo [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] I encountered the same problem months ago and also asked in this channel"><y>#</y><d>2018-12-19</d><h>12:39</h><w>mavbozo</w><a>@mkvlr</a> I encountered the same problem months ago and also asked in this channel</z><z id="t1545223185" t="mavbozo https://clojurians-log.clojureverse.org/pedestal/2018-09-20"><y>#</y><d>2018-12-19</d><h>12:39</h><w>mavbozo</w><a href="https://clojurians-log.clojureverse.org/pedestal/2018-09-20" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2018-09-20</a></z><z id="t1545223186" t="mavbozo https://clojurians-log.clojureverse.org/pedestal/2018-09-21"><y>#</y><d>2018-12-19</d><h>12:39</h><w>mavbozo</w><a href="https://clojurians-log.clojureverse.org/pedestal/2018-09-21" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2018-09-21</a></z><z id="t1545223322" t="mavbozo chain/enqueue is indeed intended to work only with Interceptor records"><y>#</y><d>2018-12-19</d><h>12:42</h><w>mavbozo</w><code>chain/enqueue</code> is indeed intended to work only with <code>Interceptor</code> records</z><z id="t1545226797" t="ddeaguiar Yep, that is the intended behavior. We want to avoid interceptor xform and validation during chain execution."><y>#</y><d>2018-12-19</d><h>13:39</h><w>ddeaguiar</w>Yep, that is the intended behavior. We want to avoid interceptor xform and validation during chain execution.</z><z id="t1545227911" t="mkvlr because of performance considerations?"><y>#</y><d>2018-12-19</d><h>13:58</h><w>mkvlr</w>because of performance considerations?</z><z id="t1545228138" t="mkvlr https://github.com/nextjournal/pedestal/commit/a5b69d376a30f8baefa1695789eaec7bf2144eed"><y>#</y><d>2018-12-19</d><h>14:02</h><w>mkvlr</w><a href="https://github.com/nextjournal/pedestal/commit/a5b69d376a30f8baefa1695789eaec7bf2144eed" target="_blank">https://github.com/nextjournal/pedestal/commit/a5b69d376a30f8baefa1695789eaec7bf2144eed</a></z><z id="t1545228145" t="mkvlr seems pretty minimal to me…"><y>#</y><d>2018-12-19</d><h>14:02</h><w>mkvlr</w>seems pretty minimal to me…</z><z id="t1545228171" t="mkvlr is there some performance benchmarks I can run to see the impact?"><y>#</y><d>2018-12-19</d><h>14:02</h><w>mkvlr</w>is there some performance benchmarks I can run to see the impact?</z><z id="t1545229799" t="martinklepsch You may want to vote for https://dev.clojure.org/jira/browse/CLJ-1473 to ensure that malformed pre/post conditions aren&apos;t silently skipped"><y>#</y><d>2018-12-19</d><h>14:29</h><w>martinklepsch</w>You may want to vote for <a href="https://dev.clojure.org/jira/browse/CLJ-1473" target="_blank">https://dev.clojure.org/jira/browse/CLJ-1473</a> to ensure that malformed pre/post conditions aren&apos;t silently skipped</z><z id="t1545232062" t="mkvlr [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] I want them to be skipped because they break my app 😼"><y>#</y><d>2018-12-19</d><h>15:07</h><w>mkvlr</w><a>@martinklepsch</a> I want them to be skipped because they break my app <b>😼</b></z><z id="t1545232179" t="mkvlr but I see I want to upvote your comment re breaking change"><y>#</y><d>2018-12-19</d><h>15:09</h><w>mkvlr</w>but I see I want to upvote your comment re breaking change</z><z id="t1545922803" t="ikitommi Those who would like to try pedestal with reitit routing, there is now a integration module for it: [metosin/reitit-pedestal &quot;0.2.10-alpha1&quot;] . Example project: https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger . Feedback welcome."><y>#</y><d>2018-12-27</d><h>15:00</h><w>ikitommi</w>Those who would like to try pedestal with reitit routing, there is now a integration module for it: <code>[metosin/reitit-pedestal &quot;0.2.10-alpha1&quot;]</code>. Example project: <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a>. Feedback welcome.</z><z id="t1546452806" t="asilverman good morning and happy new year clojurians, I was hoping it would be ok to ask you a question. I’m looking to implement a jasonapi complient microservice using pedestal but I’m faced with a challenge, I am not sure pedestal supports filtering and pagination in the way that the jsonapi standard defines it (i.e. filter[name]&amp;page[3] - https://jsonapi.org/format/#fetching-pagination) . Is this feature to parse multimap queryparams available in pedestal?. Thank you #pedestal"><y>#</y><d>2019-01-02</d><h>18:13</h><w>asilverman</w>good morning and happy new year clojurians, I was hoping it would be ok to ask you a question. I’m looking to implement a jasonapi complient microservice using pedestal but I’m faced with a challenge, I am not sure pedestal supports filtering and pagination in the way that the jsonapi standard defines it (i.e. filter[name]&amp;page[3] -  <a href="https://jsonapi.org/format/#fetching-pagination)" target="_blank">https://jsonapi.org/format/#fetching-pagination)</a>. Is this feature to parse multimap queryparams available in pedestal?. Thank you #pedestal</z><z id="t1546458144" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] AFAIK, those parameters will result in a params map of {:filter[name] nil :page[3] nil} ."><y>#</y><d>2019-01-02</d><h>19:42</h><w>ddeaguiar</w><a>@ariel.silverman</a> AFAIK, those parameters will result in a params map of  <code>{:filter[name] nil :page[3] nil}</code>.</z><z id="t1546459722" t="asilverman Thank you, I was hoping to get some clarity about how to parse parameters of this sort, for example say for an input of filter[name]=somename&amp;filter[id]=123 getting a nested map that looks like {:filter {:name &quot;somename&quot; :id 123} }"><y>#</y><d>2019-01-02</d><h>20:08</h><r>asilverman</r>Thank you, I was hoping to get some clarity about how to parse parameters of this sort, for example say for an input of filter[name]=somename&amp;filter[id]=123 getting a nested map that looks like <code>{:filter {:name &quot;somename&quot; :id 123} }</code></z><z id="t1546460095" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] , as of now you’d need to create an interceptor to do that transformation for you"><y>#</y><d>2019-01-02</d><h>20:14</h><r>ddeaguiar</r><a>@ariel.silverman</a>, as of now you’d need to create an interceptor to do that transformation for you</z><z id="t1546459722" t="asilverman Thank you, I was hoping to get some clarity about how to parse parameters of this sort, for example say for an input of filter[name]=somename&amp;filter[id]=123 getting a nested map that looks like {:filter {:name &quot;somename&quot; :id 123} }"><y>#</y><d>2019-01-02</d><h>20:08</h><w>asilverman</w>Thank you, I was hoping to get some clarity about how to parse parameters of this sort, for example say for an input of filter[name]=somename&amp;filter[id]=123 getting a nested map that looks like <code>{:filter {:name &quot;somename&quot; :id 123} }</code></z><z id="t1546633939" t="lwhorton hmm. i’m playing around with pedestal and failing at pretty much step one. what the heck is going on here? (defn index [req] {:status 200 :body &quot;hi&quot;}) (def routes (route/expand-routes #{[&quot;/foo&quot; :get index :route-name :index]})) (http/create-server {:routes routes :type :jetty :port port}) "><y>#</y><d>2019-01-04</d><h>20:32</h><w>lwhorton</w>hmm. i’m playing around with pedestal and failing at pretty much step one. what the heck is going on here?
<pre>(defn index [req]
  {:status 200
   :body &quot;hi&quot;})

(def routes
  (route/expand-routes
    #{[&quot;/foo&quot; :get index :route-name :index]}))

(http/create-server {:routes routes
                       :type :jetty
                       :port port})
</pre></z><z id="t1546634994" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0W0JDY4C&quot;}] can you point me to the docs you are following? The service map keys need to be fully-qualified keywords (i.e., io.pedestal.http/routes or, if you have io.pedestal.http aliased to something like http then ::http/routes , etc…)"><y>#</y><d>2019-01-04</d><h>20:49</h><r>ddeaguiar</r><a>@U0W0JDY4C</a> can you point me to the docs you are following? The service map keys need to be fully-qualified keywords (i.e., <code>io.pedestal.http/routes</code> or, if you have <code>io.pedestal.http</code> aliased to something like <code>http</code> then <code>::http/routes</code>, etc…)</z><z id="t1546635154" t="ddeaguiar I’d also assoc ::http/join? false to the service map when so that you can stop the server when running from a repl"><y>#</y><d>2019-01-04</d><h>20:52</h><r>ddeaguiar</r>I’d also assoc <code>::http/join? false</code> to the service map when so that you can stop the server when running from a repl</z><z id="t1546635232" t="ddeaguiar Finally, I’d not invoke expand-routes directly. That’s done for you by the io.pedestal.http/default-interceptors fn when create-server is invoked. Your routes should instead be (def routes #{[&quot;/foo&quot; :get `index :route-name :index]}) "><y>#</y><d>2019-01-04</d><h>20:53</h><r>ddeaguiar</r>Finally, I’d not invoke <code>expand-routes</code> directly. That’s done for you by the <code>io.pedestal.http/default-interceptors</code> fn when <code>create-server</code> is invoked. Your routes should instead be
<pre>(def routes
   #{[&quot;/foo&quot; :get `index :route-name :index]})
</pre></z><z id="t1546635288" t="ddeaguiar refer to https://github.com/pedestal/pedestal-docs/issues/66"><y>#</y><d>2019-01-04</d><h>20:54</h><r>ddeaguiar</r>refer to <a href="https://github.com/pedestal/pedestal-docs/issues/66" target="_blank">https://github.com/pedestal/pedestal-docs/issues/66</a></z><z id="t1546635292" t="ddeaguiar I need to update the docs"><y>#</y><d>2019-01-04</d><h>20:54</h><r>ddeaguiar</r>I need to update the docs</z><z id="t1546635313" t="ccann &gt; Finally, I’d not invoke expand-routes directly. good to know"><y>#</y><d>2019-01-04</d><h>20:55</h><r>ccann</r>&gt; Finally, I’d not invoke <code>expand-routes</code> directly.
good to know</z><z id="t1546635431" t="lwhorton :thumbsup: i was working off the http://pedastal.io/guides , but i see now that the ::http/ was missing"><y>#</y><d>2019-01-04</d><h>20:57</h><r>lwhorton</r><b>:thumbsup:</b> i was working off the <a href="http://pedastal.io/guides" target="_blank">http://pedastal.io/guides</a> , but i see now that the <code>::http/</code> was missing</z><z id="t1546636309" t="ddeaguiar Just an FYI, I went back and looked at the source and you can call pass in routes expanded by expand-routes . Not sure what issue I ran into when I created that Github issue ages ago but I do still think you should let Pedestal’s internals expand routes for you unless you are explicitly not leveraging the defaults provided by io.pedestal.http/default-interceptors ."><y>#</y><d>2019-01-04</d><h>21:11</h><r>ddeaguiar</r>Just an FYI, I went back and looked at the source and you can call pass in routes expanded by <code>expand-routes</code>. Not sure what issue I ran into when I created that Github issue ages ago but I do still think you should let Pedestal’s internals expand routes for you unless you are explicitly not leveraging the defaults provided by <code>io.pedestal.http/default-interceptors</code>.</z><z id="t1546636377" t="lwhorton i’m still poking around the interceptor stuff, checking out content negotiation and coersion etc.. the whole thing looks like a great paradigm"><y>#</y><d>2019-01-04</d><h>21:12</h><r>lwhorton</r>i’m still poking around the interceptor stuff, checking out content negotiation and coersion etc.. the whole thing looks like a great paradigm</z><z id="t1546636697" t="ddeaguiar Interceptors are great. The core set of interceptors provided by Pedestal is intentionally kept small. Application-specific needs can be implemented as interceptors pretty easily."><y>#</y><d>2019-01-04</d><h>21:18</h><r>ddeaguiar</r>Interceptors are great. The core set of interceptors provided by Pedestal is intentionally kept small. Application-specific needs can be implemented as interceptors pretty easily.</z><z id="t1546633999" t="lwhorton the create-server fails with `Execution error (IllegalArgumentException) at io.pedestal.http.route/eval13846$fn$G (route.clj:426). No implementation of method: :router-spec of protocol: #’io.pedestal.http.route/RouterSpecification found for class: nil`. not really sure what this means without digging into src, but so far just following the tutorial / docs has gotten me to here 😕"><y>#</y><d>2019-01-04</d><h>20:33</h><w>lwhorton</w>the create-server fails with `Execution error (IllegalArgumentException) at io.pedestal.http.route/eval13846$fn$G (route.clj:426).
No implementation of method: :router-spec of protocol: #’io.pedestal.http.route/RouterSpecification found for class: nil`. not really sure what this means without digging into src, but so far just following the tutorial / docs has gotten me to here <b>😕</b></z><z id="t1546994358" t="ccann is there a way to ensure *url-for* is bound when using the testing facilities like response-for ?"><y>#</y><d>2019-01-09</d><h>00:39</h><w>ccann</w>is there a way to ensure <code>*url-for*</code> is bound when using the testing facilities like <code>response-for</code>?</z><z id="t1547215965" t="souenzzo I&apos;m trying to do this https://github.com/pedestal/pedestal/blob/master/samples/http2/src/hp/service.clj But I&apos;m getting Execution error (IllegalStateException) at org.eclipse.jetty.alpn.server.ALPNServerConnectionFactory/&lt;init&gt; (ALPNServerConnectionFactory.java:53). No Server ALPNProcessors! "><y>#</y><d>2019-01-11</d><h>14:12</h><w>souenzzo</w>I&apos;m trying to do this
<a href="https://github.com/pedestal/pedestal/blob/master/samples/http2/src/hp/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/http2/src/hp/service.clj</a>
But I&apos;m getting
<pre>Execution error (IllegalStateException) at org.eclipse.jetty.alpn.server.ALPNServerConnectionFactory/&lt;init&gt; (ALPNServerConnectionFactory.java:53).
No Server ALPNProcessors!
</pre></z><z id="t1547217078" t="souenzzo It&apos;s something with :java-agents [[org.mortbay.jetty.alpn/jetty-alpn-agent &quot;2.0.9&quot;]] But I cant understand how to handle it."><y>#</y><d>2019-01-11</d><h>14:31</h><w>souenzzo</w>It&apos;s something with <code>:java-agents  [[org.mortbay.jetty.alpn/jetty-alpn-agent &quot;2.0.9&quot;]]</code>
But I cant understand how to handle it.</z><z id="t1547217746" t="souenzzo Solved with :dependencies [[org.eclipse.jetty/jetty-alpn-java-server &quot;9.4.14.v20181114&quot;]"><y>#</y><d>2019-01-11</d><h>14:42</h><w>souenzzo</w>Solved with <code>:dependencies [[org.eclipse.jetty/jetty-alpn-java-server &quot;9.4.14.v20181114&quot;]</code></z><z id="t1547292477" t="souenzzo I&apos;m using responses as string and by default it results in Transfer-Encoding: chunked There is some default way to generate Content-Length ?"><y>#</y><d>2019-01-12</d><h>11:27</h><w>souenzzo</w>I&apos;m using responses as string and by default it results in <code>Transfer-Encoding: chunked</code>
There is some default way to generate Content-Length ?</z><z id="t1547324184" t="orestis No, but there is some example of you look in the examples. Might be folded into a json encoder one. I filed an issue some time ago about this, which resulted in that example. "><y>#</y><d>2019-01-12</d><h>20:16</h><w>orestis</w>No, but there is some example of you look in the examples. Might be folded into a json encoder one. I filed an issue some time ago about this, which resulted in that example. </z><z id="t1548789459" t="donaldball When using the table routing syntax, what is the suggested way of applying a seq of interceptors to e.g. all routes under a given path?"><y>#</y><d>2019-01-29</d><h>19:17</h><w>donaldball</w>When using the table routing syntax, what is the suggested way of applying a seq of interceptors to e.g. all routes under a given path?</z><z id="t1548789616" t="donaldball I had thought that registering the interceptors as metadata in a wrapping vector would do it but that seems not to be true"><y>#</y><d>2019-01-29</d><h>19:20</h><w>donaldball</w>I had thought that registering the interceptors as metadata in a wrapping vector would do it but that seems not to be true</z><z id="t1548790049" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] ! You can create a var bound to the vector of common interceptors and conj your handler into it. With the table routing syntax, you’ll need to do this for each route"><y>#</y><d>2019-01-29</d><h>19:27</h><w>ddeaguiar</w>Hi <a>@donaldball</a>! You can create a var bound to the vector of common interceptors and <code>conj</code> your handler into it. With the table routing syntax, you’ll need to do this for each route</z><z id="t1548790073" t="ddeaguiar A project created using the service template will have an example of this"><y>#</y><d>2019-01-29</d><h>19:27</h><w>ddeaguiar</w>A project created using the service template will have an example of this</z><z id="t1548790092" t="ddeaguiar (def common-interceptors [(body-params/body-params) http/html-body]) ;; Tabular routes (def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/about&quot; :get (conj common-interceptors `about-page)]}) "><y>#</y><d>2019-01-29</d><h>19:28</h><w>ddeaguiar</w><pre>(def common-interceptors [(body-params/body-params) http/html-body])

;; Tabular routes
(def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)]
              [&quot;/about&quot; :get (conj common-interceptors `about-page)]})
</pre></z><z id="t1548790225" t="donaldball Yeah, that’s what I’m doing now, but it’s ergonomically less appealing than earlier syntaxes allowed. Then again, that’s what fns are for. 🙂"><y>#</y><d>2019-01-29</d><h>19:30</h><w>donaldball</w>Yeah, that’s what I’m doing now, but it’s ergonomically less appealing than earlier syntaxes allowed. Then again, that’s what fns are for. <b>🙂</b></z><z id="t1548956935" t="ccann [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] you could also set interceptors at the server config level with the key :io.pedestal.http/interceptors with a vector of common interceptors, if that factoring works for your setup"><y>#</y><d>2019-01-31</d><h>17:48</h><w>ccann</w><a>@donaldball</a> you could also set interceptors at the server config level with the key <code>:io.pedestal.http/interceptors</code>
with a vector of common interceptors, if that factoring works for your setup</z><z id="t1548957023" t="ccann so my routes looks like this: (def routes #{[&quot;/custom/notes&quot; :get [auth owner `notes/filter-by-user]] [&quot;/custom/notes&quot; :post [auth-un any-user `notes/create-one]] [&quot;/custom/notes/:id&quot; :get [auth owner `notes/read-one]] [&quot;/custom/notes/:id&quot; :patch [auth-un owner `notes/update-one]] [&quot;/custom/notes/:id/graphic&quot; :get [auth owner `notes/read-graphic]] [&quot;/custom/notes/:id/production-file&quot; :post [auth owner `notes/create-production-file]] [&quot;/custom/health_check&quot; :get `healthy]}) (def interceptors [(multipart-params) (body-params) json-body authorization exception-handler])"><y>#</y><d>2019-01-31</d><h>17:50</h><w>ccann</w>so my routes looks like this:
<pre>(def routes
  #{[&quot;/custom/notes&quot;                     :get   [auth    owner    `notes/filter-by-user]]
    [&quot;/custom/notes&quot;                     :post  [auth-un any-user `notes/create-one]]
    [&quot;/custom/notes/:id&quot;                 :get   [auth    owner    `notes/read-one]]
    [&quot;/custom/notes/:id&quot;                 :patch [auth-un owner    `notes/update-one]]
    [&quot;/custom/notes/:id/graphic&quot;         :get   [auth    owner    `notes/read-graphic]]
    [&quot;/custom/notes/:id/production-file&quot; :post  [auth    owner    `notes/create-production-file]]
    [&quot;/custom/health_check&quot;              :get   `healthy]})


(def interceptors
  [(multipart-params)
   (body-params)
   json-body
   authorization
   exception-handler])</pre></z><z id="t1548957053" t="ccann where the interceptors vector is pulled into the server config"><y>#</y><d>2019-01-31</d><h>17:50</h><w>ccann</w>where the <code>interceptors</code> vector is pulled into the server config</z><z id="t1548974994" t="caleb.macdonaldblack I&apos;m trying to access my pedestal service from my web app but the preflight OPTIONS request returns a 404. A GET request to the same url works. I haven&apos;t had this issue before when using pedestal in the past. Any ideas what silly little thing I&apos;m missing is?"><y>#</y><d>2019-01-31</d><h>22:49</h><w>caleb.macdonaldblack</w>I&apos;m trying to access my pedestal service from my web app but the preflight OPTIONS request returns a 404. A GET request to the same url works. I haven&apos;t had this issue before when using pedestal in the past. Any ideas what silly little thing I&apos;m missing is?</z><z id="t1548975336" t="ccann could it be a CORS issue?"><y>#</y><d>2019-01-31</d><h>22:55</h><w>ccann</w>could it be a CORS issue?</z><z id="t1548975371" t="caleb.macdonaldblack Actually yeah. I need to provide :: http/allowed-origins"><y>#</y><d>2019-01-31</d><h>22:56</h><w>caleb.macdonaldblack</w>Actually yeah. I need to provide <b>::</b>http/allowed-origins</z><z id="t1548975426" t="caleb.macdonaldblack I thought it wouldn&apos;t be an issue as I&apos;m hosting pedestal on the same domain. But it looks like it won&apos;t deal with preflight at all if it doesn&apos;t have that key"><y>#</y><d>2019-01-31</d><h>22:57</h><w>caleb.macdonaldblack</w>I thought it wouldn&apos;t be an issue as I&apos;m hosting pedestal on the same domain. But it looks like it won&apos;t deal with preflight at all if it doesn&apos;t have that key</z><z id="t1549661907" t="asilverman Hi #pedestal users, I am in need of guidance regarding the function below (defn create-servlet &quot;Creates a servlet given an options map with keyword keys prefixed by namespace e.g. :io.pedestal.http/interceptors or ::bootstrap/interceptors if the namespace is aliased to bootstrap. Options: * :io.pedestal.http/interceptors: A vector of interceptors that defines a service. Note: Additional options are passed to default-interceptors if :interceptors is not set.&quot; [service-map] (-&gt; service-map default-interceptors service-fn servlet)) I am looking at some legacy code that is exercising this function in order to create a test servlet, but that seems to be opposed to this guide -&gt; http://pedestal.io/guides/pedestal-with-component"><y>#</y><d>2019-02-08</d><h>21:38</h><w>asilverman</w>Hi #pedestal users, I am in need of guidance regarding the function below
<pre>(defn create-servlet
  &quot;Creates a servlet given an options map with keyword keys prefixed by namespace e.g.
  :io.pedestal.http/interceptors or ::bootstrap/interceptors if the namespace is aliased to bootstrap.

  Options:

  * :io.pedestal.http/interceptors: A vector of interceptors that defines a service.

  Note: Additional options are passed to default-interceptors if :interceptors is not set.&quot;
  [service-map]
  (-&gt; service-map
      default-interceptors
      service-fn
      servlet))</pre>

I am looking at some legacy code that is exercising this function in order to create a test servlet, but that seems to be opposed to this guide -&gt; <a href="http://pedestal.io/guides/pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component</a></z><z id="t1549661927" t="asilverman Can somebody help me understand what is this pattern of use of create-servlet ?"><y>#</y><d>2019-02-08</d><h>21:38</h><w>asilverman</w>Can somebody help me understand what is this pattern of use of <code>create-servlet</code>?</z><z id="t1549664881" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] it’s common to use response-for to test your service implementation. That constructs a servlet request under the covers which is used to exercise your implementation."><y>#</y><d>2019-02-08</d><h>22:28</h><w>ddeaguiar</w><a>@ariel.silverman</a> it’s common to use <code>response-for</code> to test your service implementation. That constructs a servlet request under the covers which is used to exercise your implementation.</z><z id="t1549905942" t="asilverman [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] - Would you be open to helping me out with this subject? I wasn’t really able to find any good resources…"><y>#</y><d>2019-02-11</d><h>17:25</h><r>asilverman</r><a>@U0FL657GR</a> - Would you be open to helping me out with this subject? I wasn’t really able to find any good resources…</z><z id="t1549980798" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] sure! Here’s a start. A new pedestal project created via the pedestal-service template contains some initial tests. Here’s a trimmed down version of one of those tests in the ‘Hello World’ sample: https://github.com/pedestal/pedestal/blob/master/samples/hello-world/test/hello_world/service_test.clj#L19-L25"><y>#</y><d>2019-02-12</d><h>14:13</h><r>ddeaguiar</r><a>@ariel.silverman</a> sure! Here’s a start. A new pedestal project created via the pedestal-service template contains some initial tests. Here’s a trimmed down version of one of those tests in the ‘Hello World’ sample: <a href="https://github.com/pedestal/pedestal/blob/master/samples/hello-world/test/hello_world/service_test.clj#L19-L25" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/hello-world/test/hello_world/service_test.clj#L19-L25</a></z><z id="t1549980835" t="ddeaguiar I’ll work on fleshing out the reference for unit testing in the http://pedestal.io docs."><y>#</y><d>2019-02-12</d><h>14:13</h><r>ddeaguiar</r>I’ll work on fleshing out the reference for unit testing in the <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> docs.</z><z id="t1549980879" t="ddeaguiar response-for can be used to test all HTTP methods. If you are testing :post you can specify a :body ."><y>#</y><d>2019-02-12</d><h>14:14</h><r>ddeaguiar</r><code>response-for</code> can be used to test all HTTP methods. If you are testing <code>:post</code> you can specify a <code>:body</code>.</z><z id="t1549980887" t="ddeaguiar Headers can also be passed"><y>#</y><d>2019-02-12</d><h>14:14</h><r>ddeaguiar</r>Headers can also be passed</z><z id="t1549993775" t="asilverman [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you for your help 🙂 I will review the project for inspiration and clarification and follow up if any questions arise. Thanks again!"><y>#</y><d>2019-02-12</d><h>17:49</h><r>asilverman</r><a>@U0FL657GR</a> thank you for your help <b>🙂</b> I will review the project for inspiration and clarification and follow up if any questions arise. Thanks again!</z><z id="t1549838579" t="caleb.macdonaldblack can i put a namespaced key in a route url? like :foo/bar ?"><y>#</y><d>2019-02-10</d><h>22:42</h><w>caleb.macdonaldblack</w>can i put a namespaced key in a route url? like <code>:foo/bar</code>?</z><z id="t1549838627" t="caleb.macdonaldblack /users/:user/id/contacts Where the namespace key is :user/id"><y>#</y><d>2019-02-10</d><h>22:43</h><w>caleb.macdonaldblack</w><code>/users/:user/id/contacts</code> Where the namespace key is <code>:user/id</code></z><z id="t1549841804" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] ! That won’t work as you’re expecting. :user will be interpreted as the path parameter, not :user/id ."><y>#</y><d>2019-02-10</d><h>23:36</h><w>ddeaguiar</w>Hi <a>@caleb.macdonaldblack</a>! That won’t work as you’re expecting. <code>:user</code> will be interpreted as the path parameter, not <code>:user/id</code>.</z><z id="t1549841850" t="caleb.macdonaldblack Okay cool. I didn&apos;t expect that to work however I wasn&apos;t sure if there was another way to achieve that. Perhaps by escaping or something"><y>#</y><d>2019-02-10</d><h>23:37</h><w>caleb.macdonaldblack</w>Okay cool. I didn&apos;t expect that to work however I wasn&apos;t sure if there was another way to achieve that. Perhaps by escaping or something</z><z id="t1549878160" t="ikitommi reitit-pedestal will support bracket-syntax and because of that, qualified path-params, should be out it few weeks. Would be /users/{user/id}/contacts . Also enables silly things like /public/file-{name}.pdf"><y>#</y><d>2019-02-11</d><h>09:42</h><w>ikitommi</w>reitit-pedestal will support bracket-syntax and because of that, qualified path-params, should be out it few weeks. Would be <code>/users/{user/id}/contacts</code>. Also enables silly things like <code>/public/file-{name}.pdf</code></z><z id="t1549973351" t="TK is it ok to have two different interceptors about (in memory) database, one for a &quot;table&quot; X and other for &quot;table&quot; Y?"><y>#</y><d>2019-02-12</d><h>12:09</h><w>TK</w>is it ok to have two different <code>interceptors</code> about (in memory) database, one for a &quot;table&quot; X and other for &quot;table&quot; Y?</z><z id="t1549980934" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UD3QRC4LA&quot;}] , I’ll hesitantly say yes but I don’t know your use case"><y>#</y><d>2019-02-12</d><h>14:15</h><w>ddeaguiar</w><a>@leandrotk100</a>, I’ll hesitantly say yes but I don’t know your use case</z><z id="t1549984134" t="TK I have a in-memory database: {:users [...] :connections [...]} I implemented a simple CRUD to the users, and I used a db-interceptor specific for the users Now I was thinking about the connections and (maybe) another db-interceptor , something like db-connection-interceptor"><y>#</y><d>2019-02-12</d><h>15:08</h><w>TK</w>I have a in-memory database:

<pre>{:users [...]
 :connections [...]}
</pre>

I implemented a simple CRUD to the users, and I used a <code>db-interceptor</code> specific for the users
Now I was thinking about the <code>connections</code> and (maybe) another <code>db-interceptor</code>, something like <code>db-connection-interceptor</code></z><z id="t1549984251" t="ddeaguiar In general, I implement an interceptor to create/get a connection and make it available on the context for other interceptors"><y>#</y><d>2019-02-12</d><h>15:10</h><w>ddeaguiar</w>In general, I implement an interceptor to create/get a connection and make it available on the context for other interceptors</z><z id="t1549984294" t="ddeaguiar I may also implement an interceptor which fetches an entity from the db and makes it available on the context/request as well."><y>#</y><d>2019-02-12</d><h>15:11</h><w>ddeaguiar</w>I may also implement an interceptor which fetches an entity from the db and makes it available on the context/request as well.</z><z id="t1549984331" t="ddeaguiar In general, I think it’s good practice to limit handlers to response formatting and push data retrieval to interceptors"><y>#</y><d>2019-02-12</d><h>15:12</h><w>ddeaguiar</w>In general, I think it’s good practice to limit handlers to response formatting and push data retrieval to interceptors</z><z id="t1550197403" t="caleb.macdonaldblack 500 errors/exceptions don&apos;t seem to add the cors header using ::http/allowed-origins . All other requests do. Is there any way to add this without creating an error interceptor to repeat what the ::http/allowed-origins param does. Or something else wrong here?"><y>#</y><d>2019-02-15</d><h>02:23</h><w>caleb.macdonaldblack</w>500 errors/exceptions don&apos;t seem to add the cors header using <code>::http/allowed-origins</code>. All other requests do. Is there any way to add this without creating an error interceptor to repeat what the <code>::http/allowed-origins </code> param does. Or something else wrong here?</z><z id="t1550244182" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] while Pedestal provides default error handling, I’d recommend implementing your own error handling interceptor which associates a more informative and, possibly, context-specific response. Adding such an error handling interceptor to your common interceptor collection will create a response which will be returns with the relevant CORS headers."><y>#</y><d>2019-02-15</d><h>15:23</h><w>ddeaguiar</w><a>@caleb.macdonaldblack</a> while Pedestal provides default error handling, I’d recommend implementing your own error handling interceptor which associates a more informative and, possibly, context-specific response. Adding such an error handling interceptor to your common interceptor collection will create a response which will be returns with the relevant CORS headers.</z><z id="t1550244527" t="ddeaguiar Here are some more details: Default error handling is considered last resort and is interceptor chain provider specific. The servlet interceptor chain provider provides a catchall but it’s implemented within the internal response processing logic. CORS is implemented as an interceptor and only supports the :enter and :leave keys. On :leave it merges the relevant headers to the response :headers map. There is no :error support because, what should it do in the case of an error? This is an application-specific concern. Explicitly handle your errors and you’ll get the result you are looking for."><y>#</y><d>2019-02-15</d><h>15:28</h><r>ddeaguiar</r>Here are some more details:

Default error handling is considered last resort and is interceptor chain provider specific. The servlet interceptor chain provider provides a catchall but it’s implemented within the internal response processing logic.

CORS is implemented as an interceptor and only supports the <code>:enter</code> and <code>:leave</code> keys. On <code>:leave</code> it merges the relevant headers to the response <code>:headers</code> map. There is no <code>:error</code> support because, what should it do in the case of an error? This is an application-specific concern.

Explicitly handle your errors and you’ll get the result you are looking for.</z><z id="t1550244646" t="ddeaguiar BTW, when I talked about context-specific error handling, I was referring to the error-dispatch helper provided by Pedestal ( https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17 )."><y>#</y><d>2019-02-15</d><h>15:30</h><r>ddeaguiar</r>BTW, when I talked about context-specific error handling, I was referring to the <code>error-dispatch</code> helper provided by Pedestal (<a href="https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17" target="_blank">https://github.com/pedestal/pedestal/blob/master/interceptor/src/io/pedestal/interceptor/error.clj#L17</a>).</z><z id="t1550244691" t="ddeaguiar It allows you to provide both general and specific error handling in one place"><y>#</y><d>2019-02-15</d><h>15:31</h><r>ddeaguiar</r>It allows you to provide both general and specific error handling in one place</z><z id="t1550245128" t="caleb.macdonaldblack Thank you for for your response. I left my question up to see if there were any other solutions. I did end up using error-dispatch though which is exactly what I needed"><y>#</y><d>2019-02-15</d><h>15:38</h><r>caleb.macdonaldblack</r>Thank you for for your response. I left my question up to see if there were any other solutions. I did end up using error-dispatch though which is exactly what I needed</z><z id="t1550267276" t="ddeaguiar I just added a Unit Testing reference to the http://pedestal.io site ( http://pedestal.io/reference/unit-testing ). [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] you may find it useful."><y>#</y><d>2019-02-15</d><h>21:47</h><w>ddeaguiar</w>I just added a Unit Testing reference to the <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> site (<a href="http://pedestal.io/reference/unit-testing" target="_blank">http://pedestal.io/reference/unit-testing</a>). <a>@ariel.silverman</a> you may find it useful.</z><z id="t1550277257" t="asilverman Thank you so much, I tried this approach but in my case since our service is wrapped inside a component I ended up creating a macro I am using as a fixture to exercise the response-for function (defmacro with-mock-ds-system [[sym ds-factory] &amp; body] ;; Create a system map with a mock datastore and a mock auth-checker, set ::http/join == false so ;; that the system doesn&apos;t block execution. `(let [temp# ~ds-factory] ;; Store a reference to this system, perhaps unnecessary but done for the sake ;; of future debuggability. (reset! mock-svc (component/start-system (service/consent-service (env/get-api-config) (create-mock-auth-checker (env/get-api-config)) {:type :mockstore :config temp#} {:env :dev ::http/join? false}))) ;; Pull the servlet function that is used for testing out of the newly created system. (let [~sym (get-in @mock-svc [:consent :service ::http/service-fn])] (try ~@body ;; Shutdown system. (finally (component/stop-system @mock-svc) (reset! mock-svc nil))))))"><y>#</y><d>2019-02-16</d><h>00:34</h><r>asilverman</r>Thank you so much, I tried this approach but in my case since our service is wrapped inside a component I ended up creating a macro I am using as a fixture to exercise the <code>response-for</code> function

<pre>(defmacro with-mock-ds-system
  [[sym ds-factory] &amp; body]
  ;; Create a system map with a mock datastore and a mock auth-checker, set ::http/join == false so
  ;; that the system doesn&apos;t block execution.
  `(let [temp# ~ds-factory]
     ;; Store a reference to this system, perhaps unnecessary but done for the sake
     ;; of future debuggability.
     (reset! mock-svc (component/start-system (service/consent-service
                                                (env/get-api-config)
                                                (create-mock-auth-checker (env/get-api-config))
                                                {:type   :mockstore
                                                 :config temp#}
                                                {:env         :dev
                                                 ::http/join? false})))
     ;; Pull the servlet function that is used for testing out of the newly created system.
     (let [~sym (get-in @mock-svc [:consent :service ::http/service-fn])]
       (try
         ~@body
         ;; Shutdown system.
         (finally
           (component/stop-system @mock-svc)
           (reset! mock-svc nil))))))</pre></z><z id="t1550422117" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] , :thumbsup: . I’ve done something similar in the past but leveraged a fixture."><y>#</y><d>2019-02-17</d><h>16:48</h><r>ddeaguiar</r><a>@ariel.silverman</a>, <b>:thumbsup:</b>. I’ve done something similar in the past but leveraged a fixture.</z><z id="t1550593401" t="asilverman I also had a fixture implementation but ended up abandoning that approach because I want to dynamically change behavior of the mock datastore based on test specific scenarios and realized that fixtures do not allow for arguments and it just seemed a bit clunky."><y>#</y><d>2019-02-19</d><h>16:23</h><r>asilverman</r>I also had a fixture implementation but ended up abandoning that approach because I want to dynamically change behavior of the mock datastore based on test specific scenarios and realized that fixtures do not allow for arguments and it just seemed a bit clunky.</z><z id="t1550593485" t="asilverman thank you for your help and for taking the initiative to write a guide on pedestal on testing. 🙂"><y>#</y><d>2019-02-19</d><h>16:24</h><r>asilverman</r>thank you for your help and for taking the initiative to write a guide on pedestal on testing. <b>🙂</b></z><z id="t1550593541" t="ddeaguiar np!"><y>#</y><d>2019-02-19</d><h>16:25</h><r>ddeaguiar</r>np!</z><z id="t1550318861" t="TK And maybe an integration testing would be to compose &quot;unit tests&quot;. for example - List resources: empty - Create resource: return resource - List resource: list with the created resource - Update the resource: return the updated resource ...and so on. Is this the idea of an integration testing?"><y>#</y><d>2019-02-16</d><h>12:07</h><w>TK</w>And maybe an integration testing would be to compose &quot;unit tests&quot;. for example
- List resources: empty
- Create resource: return resource
- List resource: list with the created resource
- Update the resource: return the updated resource
...and so on.

Is this the idea of an integration testing?</z><z id="t1550422276" t="ddeaguiar I think that’s consistent with integration testing. In my experience, the term integration testing has been used to describe end-to-end tests which exercise the system in the context of backing infrastructure/dependencies (i.e., real database, externally deployed services, etc…)"><y>#</y><d>2019-02-17</d><h>16:51</h><r>ddeaguiar</r>I think that’s consistent with integration testing. In my experience, the term integration testing has been used to describe end-to-end tests which exercise the system in the context of backing infrastructure/dependencies (i.e., real database, externally deployed services, etc…)</z><z id="t1550319574" t="TK For the unit test, we could also use let to get the response and use it to multiple &quot;assertions&quot; (let [response (response-for service :post &quot;/foo&quot; :headers {&quot;Content-Type&quot; &quot;application/json&quot;} :body &quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;)] (is (= 200 (:status response))) (is (= {&quot;foo&quot;: &quot;bar&quot;} (:body response)))) "><y>#</y><d>2019-02-16</d><h>12:19</h><w>TK</w>For the unit test, we could also use let to get the response and use it to multiple &quot;assertions&quot;

<pre>(let [response (response-for service
                             :post &quot;/foo&quot;
                             :headers {&quot;Content-Type&quot; &quot;application/json&quot;}
                             :body &quot;{\&quot;foo\&quot;:\&quot;bar\&quot;}&quot;)]
  (is (= 200 (:status response)))
  (is (= {&quot;foo&quot;: &quot;bar&quot;} (:body response))))
</pre></z><z id="t1550512884" t="souenzzo Hello I&apos;m using context-configurator to enable gzip , but it works just on &quot;public&quot; routes. I use csrf , so my get &apos;s are public and post &apos;s private ::http/enable-csrf {} ::http/enable-session {} On get&apos;s, gzip works, on post&apos;s not My context config: (defn context-configurator [^ServletContextHandler context] (let [gzip-handler (GzipHandler.)] (.setExcludedAgentPatterns gzip-handler (make-array String 0)) (.setGzipHandler context gzip-handler)) context) https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61"><y>#</y><d>2019-02-18</d><h>18:01</h><w>souenzzo</w>Hello
I&apos;m using <code>context-configurator</code> to enable <code>gzip</code>, but it works just on &quot;public&quot; routes.
I use <code>csrf</code>, so my <code>get</code>&apos;s are public and <code>post</code>&apos;s private
<pre>::http/enable-csrf       {}
 ::http/enable-session    {}
</pre>
On get&apos;s, gzip works, on post&apos;s not
My context config:
<pre>(defn context-configurator
  [^ServletContextHandler context]
  (let [gzip-handler (GzipHandler.)]
    (.setExcludedAgentPatterns gzip-handler (make-array String 0))
    (.setGzipHandler context gzip-handler))
  context)
</pre>
<a href="https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61</a></z><z id="t1550513048" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , by private you mean that the csrf token is required?"><y>#</y><d>2019-02-18</d><h>18:04</h><w>ddeaguiar</w><a>@souenzzo</a>, by private you mean that the csrf token is required?</z><z id="t1550513056" t="souenzzo yep."><y>#</y><d>2019-02-18</d><h>18:04</h><w>souenzzo</w>yep.</z><z id="t1550513134" t="ddeaguiar Hm, I’d expect that to behave similarly. I’d explore that further. If you have a minimal project reproducing the issue that would help."><y>#</y><d>2019-02-18</d><h>18:05</h><w>ddeaguiar</w>Hm, I’d expect that to behave similarly. I’d explore that further. If you have a minimal project reproducing the issue that would help.</z><z id="t1550515454" t="souenzzo https://github.com/souenzzo/cljs-issues/tree/pedestal-issue"><y>#</y><d>2019-02-18</d><h>18:44</h><r>souenzzo</r><a href="https://github.com/souenzzo/cljs-issues/tree/pedestal-issue" target="_blank">https://github.com/souenzzo/cljs-issues/tree/pedestal-issue</a></z><z id="t1550515465" t="ddeaguiar Thanks!"><y>#</y><d>2019-02-18</d><h>18:44</h><r>ddeaguiar</r>Thanks!</z><z id="t1550516731" t="souenzzo is there any quick(dirty) workaround for this problem?"><y>#</y><d>2019-02-18</d><h>19:05</h><r>souenzzo</r>is there any quick(dirty) workaround for this problem?</z><z id="t1550516862" t="ddeaguiar I don’t know. I don’t understand why csrf would interfere with compression and my gut feeling is that it’s a red herring"><y>#</y><d>2019-02-18</d><h>19:07</h><r>ddeaguiar</r>I don’t know. I don’t understand why csrf would interfere with compression and my gut feeling is that it’s a red herring</z><z id="t1550516890" t="ddeaguiar oh"><y>#</y><d>2019-02-18</d><h>19:08</h><r>ddeaguiar</r>oh</z><z id="t1550516899" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I think I know what it is"><y>#</y><d>2019-02-18</d><h>19:08</h><r>ddeaguiar</r><a>@souenzzo</a> I think I know what it is</z><z id="t1550516929" t="ddeaguiar https://www.eclipse.org/jetty/documentation/9.4.14.v20181114/gzip-filter.html"><y>#</y><d>2019-02-18</d><h>19:08</h><r>ddeaguiar</r><a href="https://www.eclipse.org/jetty/documentation/9.4.14.v20181114/gzip-filter.html" target="_blank">https://www.eclipse.org/jetty/documentation/9.4.14.v20181114/gzip-filter.html</a></z><z id="t1550516937" t="ddeaguiar includedMethods List of HTTP methods to compress. If not set, only GET requests are compressed. "><y>#</y><d>2019-02-18</d><h>19:08</h><r>ddeaguiar</r><pre>includedMethods
List of HTTP methods to compress. If not set, only GET requests are compressed.
</pre></z><z id="t1550516959" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] try specifying POST as an included method"><y>#</y><d>2019-02-18</d><h>19:09</h><r>ddeaguiar</r><a>@souenzzo</a> try specifying POST as an included method</z><z id="t1550517256" t="souenzzo Nice! Working with (.addIncludedMethods gzip-handler (into-array [&quot;GET&quot; &quot;POST&quot;])) Should I do a PR to add a comment with this link in the example? or you can add?"><y>#</y><d>2019-02-18</d><h>19:14</h><r>souenzzo</r>Nice!
Working with <code>(.addIncludedMethods gzip-handler (into-array [&quot;GET&quot; &quot;POST&quot;]))</code>
Should I do a PR to add a comment with this link in the example? or you can add?</z><z id="t1550517384" t="ddeaguiar If you create a PR that would be great!"><y>#</y><d>2019-02-18</d><h>19:16</h><r>ddeaguiar</r>If you create a PR that would be great!</z><z id="t1550518093" t="souenzzo Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] 😉 My POST respose goes from 5M to 300K"><y>#</y><d>2019-02-18</d><h>19:28</h><r>souenzzo</r>Thanks <a>@U0FL657GR</a>  <b>😉</b>
My POST respose goes from 5M to 300K</z><z id="t1550518235" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-02-18</d><h>19:30</h><r>ddeaguiar</r><b>:thumbsup:</b></z><z id="t1550523968" t="souenzzo https://github.com/pedestal/pedestal/pull/609"><y>#</y><d>2019-02-18</d><h>21:06</h><r>souenzzo</r><a href="https://github.com/pedestal/pedestal/pull/609" target="_blank">https://github.com/pedestal/pedestal/pull/609</a></z><z id="t1550588748" t="kommen I’m trying to upgrade from pedestal 0.5.3 to 0.5.5, but it breaks some of our url-for calls, raising this: [{:type java.lang.IllegalArgumentException :message &quot;Don&apos;t know how to create ISeq from: clojure.lang.Keyword&quot; :at [clojure.lang.RT seqFrom &quot;RT.java&quot; 553]}] :trace [[clojure.lang.RT seqFrom &quot;RT.java&quot; 553] [clojure.lang.RT seq &quot;RT.java&quot; 533] [clojure.core$seq__5387 invokeStatic &quot;core.clj&quot; 137] [clojure.core$empty_QMARK_ invokeStatic &quot;core.clj&quot; 6206] [clojure.core$empty_QMARK_ invoke &quot;core.clj&quot; 6206] [io.pedestal.http.route$link_str invokeStatic &quot;route.clj&quot; 252] [io.pedestal.http.route$link_str invoke &quot;route.clj&quot; 230] [io.pedestal.http.route$url_for_routes$fn__23926 doInvoke &quot;route.clj&quot; 369] "><y>#</y><d>2019-02-19</d><h>15:05</h><w>kommen</w>I’m trying to upgrade from pedestal 0.5.3 to 0.5.5, but it breaks some of our <code>url-for</code> calls, raising this:
<pre>[{:type java.lang.IllegalArgumentException
   :message &quot;Don&apos;t know how to create ISeq from: clojure.lang.Keyword&quot;
   :at [clojure.lang.RT seqFrom &quot;RT.java&quot; 553]}]
 :trace
 [[clojure.lang.RT seqFrom &quot;RT.java&quot; 553]
  [clojure.lang.RT seq &quot;RT.java&quot; 533]
  [clojure.core$seq__5387 invokeStatic &quot;core.clj&quot; 137]
  [clojure.core$empty_QMARK_ invokeStatic &quot;core.clj&quot; 6206]
  [clojure.core$empty_QMARK_ invoke &quot;core.clj&quot; 6206]
  [io.pedestal.http.route$link_str invokeStatic &quot;route.clj&quot; 252]
  [io.pedestal.http.route$link_str invoke &quot;route.clj&quot; 230]
  [io.pedestal.http.route$url_for_routes$fn__23926 doInvoke &quot;route.clj&quot; 369]
</pre></z><z id="t1550588771" t="kommen debug logging shows this:"><y>#</y><d>2019-02-19</d><h>15:06</h><w>kommen</w>debug logging shows this:</z><z id="t1550588775" t="kommen 2019-02-19 15:01:27.001 DEBUG io.pedestal.http.route - {:in :link-str, :path-parts [:profile-handle], :context-path-parts [&quot;&quot;], :line 247} "><y>#</y><d>2019-02-19</d><h>15:06</h><w>kommen</w><pre>2019-02-19 15:01:27.001 DEBUG io.pedestal.http.route - {:in :link-str, :path-parts [:profile-handle], :context-path-parts [&quot;&quot;], :line 247}
</pre></z><z id="t1550588858" t="kommen https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L252"><y>#</y><d>2019-02-19</d><h>15:07</h><w>kommen</w><a href="https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L252" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L252</a></z><z id="t1550589031" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U45J3R52L&quot;}] , sorry to hear about the issues you are having. Can you share an example url-for call that is failing?"><y>#</y><d>2019-02-19</d><h>15:10</h><w>ddeaguiar</w><a>@kommen</a>, sorry to hear about the issues you are having. Can you share an example <code>url-for</code> call that is failing?</z><z id="t1550589189" t="kommen (url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})"><y>#</y><d>2019-02-19</d><h>15:13</h><w>kommen</w><code>(url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})</code></z><z id="t1550589213" t="kommen with this route: [&quot;/:profile-handle&quot; :get [profile/fetch profile/show] :route-name :show-named-profile]"><y>#</y><d>2019-02-19</d><h>15:13</h><w>kommen</w>with this route: <code>[&quot;/:profile-handle&quot; :get [profile/fetch profile/show] :route-name :show-named-profile]</code></z><z id="t1550589259" t="ddeaguiar ok thanks"><y>#</y><d>2019-02-19</d><h>15:14</h><w>ddeaguiar</w>ok thanks</z><z id="t1550589423" t="kommen I guess the problem is that we don’t have a string before the first url param?"><y>#</y><d>2019-02-19</d><h>15:17</h><w>kommen</w>I guess the problem is that we don’t have a string before the first url param?</z><z id="t1550589727" t="ddeaguiar hrm not sure. I drop that route and url-for invocation into a new pedestal app using version 5.3 and I don’t see an issue."><y>#</y><d>2019-02-19</d><h>15:22</h><w>ddeaguiar</w>hrm not sure. I drop that route and <code>url-for</code> invocation into a new pedestal app using version 5.3 and I don’t see an issue.</z><z id="t1550589730" t="ddeaguiar Can you try this"><y>#</y><d>2019-02-19</d><h>15:22</h><w>ddeaguiar</w>Can you try this</z><z id="t1550589763" t="ddeaguiar (def my-url-for (route/url-for-routes (route/expand-routes routes))) (my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;}) "><y>#</y><d>2019-02-19</d><h>15:22</h><w>ddeaguiar</w><pre>(def my-url-for (route/url-for-routes (route/expand-routes routes)))

 (my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})
</pre></z><z id="t1550589779" t="ddeaguiar I’m assuming that your routes are bound to a var named routes"><y>#</y><d>2019-02-19</d><h>15:22</h><w>ddeaguiar</w>I’m assuming that your routes are bound to a var named <code>routes</code></z><z id="t1550589786" t="ddeaguiar replace with the correct value"><y>#</y><d>2019-02-19</d><h>15:23</h><w>ddeaguiar</w>replace with the correct value</z><z id="t1550589966" t="kommen ok, thanks. we use table routes, so I did this:"><y>#</y><d>2019-02-19</d><h>15:26</h><w>kommen</w>ok, thanks. we use table routes, so I did this:</z><z id="t1550589972" t="kommen (def my-url-for (route/url-for-routes (table/table-routes routes))) (my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})"><y>#</y><d>2019-02-19</d><h>15:26</h><w>kommen</w><pre>(def my-url-for (route/url-for-routes (table/table-routes routes)))
(my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})</pre></z><z id="t1550589977" t="kommen which works"><y>#</y><d>2019-02-19</d><h>15:26</h><w>kommen</w>which works</z><z id="t1550589996" t="ddeaguiar ok so it fails in context of a request, right?"><y>#</y><d>2019-02-19</d><h>15:26</h><w>ddeaguiar</w>ok so it fails in context of a request, right?</z><z id="t1550590003" t="kommen right"><y>#</y><d>2019-02-19</d><h>15:26</h><w>kommen</w>right</z><z id="t1550590063" t="ddeaguiar Ok, so I don’t see that behavior in the quick sample I generated but I generated it using the pedestal-service template 0.5.5 and just updated the pedestal deps to 0.5.3"><y>#</y><d>2019-02-19</d><h>15:27</h><w>ddeaguiar</w>Ok, so I don’t see that behavior in the quick sample I generated but I generated it using the <code>pedestal-service</code> template <code>0.5.5</code> and just updated the pedestal deps to <code>0.5.3</code></z><z id="t1550590211" t="kommen ok, thank you. I guess I hoped it was some thing obvious, will investigate further"><y>#</y><d>2019-02-19</d><h>15:30</h><w>kommen</w>ok, thank you. I guess I hoped it was some thing obvious, will investigate further</z><z id="t1550590411" t="ddeaguiar It’s definitely due to :context &quot;&quot;"><y>#</y><d>2019-02-19</d><h>15:33</h><w>ddeaguiar</w>It’s definitely due to <code>:context &quot;&quot;</code></z><z id="t1550590442" t="ddeaguiar (def my-url-for (route/url-for-routes (route/expand-routes routes) :context &quot;&quot;)) (my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;}) "><y>#</y><d>2019-02-19</d><h>15:34</h><w>ddeaguiar</w><pre>(def my-url-for (route/url-for-routes (route/expand-routes routes) :context &quot;&quot;))

 (my-url-for :show-named-profile :params {:profile-handle &quot;foo&quot;})
</pre></z><z id="t1550590445" t="ddeaguiar IllegalArgumentException Don&apos;t know how to create ISeq from: clojure.lang.Keyword clojure.lang.RT.seqFrom (RT.java:550)"><y>#</y><d>2019-02-19</d><h>15:34</h><w>ddeaguiar</w><code>IllegalArgumentException Don&apos;t know how to create ISeq from: clojure.lang.Keyword  clojure.lang.RT.seqFrom (RT.java:550)</code></z><z id="t1550590469" t="ddeaguiar I’m not sure why :context is set to an empty string. I don’t see that in my sample"><y>#</y><d>2019-02-19</d><h>15:34</h><w>ddeaguiar</w>I’m not sure why <code>:context</code> is set to an empty string. I don’t see that in my sample</z><z id="t1550590508" t="ddeaguiar I’ll look into that further when I have a chance. I’m curious. Tracking down where :context &quot;&quot; is being set is where I’d start looking"><y>#</y><d>2019-02-19</d><h>15:35</h><w>ddeaguiar</w>I’ll look into that further when I have a chance. I’m curious. Tracking down where <code>:context &quot;&quot;</code> is being set is where I’d start looking</z><z id="t1550591361" t="kommen [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] It looks like in pedestal 0.5.5 there is always a :context-path on the request in https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L209"><y>#</y><d>2019-02-19</d><h>15:49</h><w>kommen</w><a>@ddeaguiar</a> It looks like in pedestal 0.5.5 there is always a <code>:context-path</code> on the request in <a href="https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L209" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.5/route/src/io/pedestal/http/route.clj#L209</a></z><z id="t1550591391" t="kommen which causes context-path-parts to be [&quot;&quot;] instead of nil"><y>#</y><d>2019-02-19</d><h>15:49</h><w>kommen</w>which causes <code>context-path-parts</code> to be <code>[&quot;&quot;]</code> instead of nil</z><z id="t1550591490" t="kommen so I guess this change here: https://github.com/pedestal/pedestal/commit/1d9083421cb8fa407d2093212e048e8420009c29#diff-9be1af57b1dfcec8ea9df18ac98e6777R152"><y>#</y><d>2019-02-19</d><h>15:51</h><w>kommen</w>so I guess this change here: <a href="https://github.com/pedestal/pedestal/commit/1d9083421cb8fa407d2093212e048e8420009c29#diff-9be1af57b1dfcec8ea9df18ac98e6777R152" target="_blank">https://github.com/pedestal/pedestal/commit/1d9083421cb8fa407d2093212e048e8420009c29#diff-9be1af57b1dfcec8ea9df18ac98e6777R152</a></z><z id="t1550591642" t="ddeaguiar Ok, thanks for digging through that. I’ll take a closer look. I’ll likely update the release notes with breaking change info and possibly open an issue around it."><y>#</y><d>2019-02-19</d><h>15:54</h><w>ddeaguiar</w>Ok, thanks for digging through that. I’ll take a closer look. I’ll likely update the release notes with breaking change info and possibly open an issue around it.</z><z id="t1550591766" t="kommen I’ll file an issue with the info I found"><y>#</y><d>2019-02-19</d><h>15:56</h><w>kommen</w>I’ll file an issue with the info I found</z><z id="t1550592193" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-02-19</d><h>16:03</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1550592222" t="kommen it also reproduces with the stock lein example in the context of a request"><y>#</y><d>2019-02-19</d><h>16:03</h><w>kommen</w>it also reproduces with the stock lein example in the context of a request</z><z id="t1550593001" t="kommen https://github.com/pedestal/pedestal/issues/610"><y>#</y><d>2019-02-19</d><h>16:16</h><w>kommen</w><a href="https://github.com/pedestal/pedestal/issues/610" target="_blank">https://github.com/pedestal/pedestal/issues/610</a></z><z id="t1550593165" t="ddeaguiar thanks again 🙂"><y>#</y><d>2019-02-19</d><h>16:19</h><w>ddeaguiar</w>thanks again <b>🙂</b></z><z id="t1550607539" t="v3ga Does anyone here have any basic examples of a pedestal CRUD project with mount/component and a database?"><y>#</y><d>2019-02-19</d><h>20:18</h><w>v3ga</w>Does anyone here have any basic examples of a pedestal CRUD project with mount/component and a database?</z><z id="t1550607812" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] creating such an example has been on my todo list for a while. If you have specific questions perhaps I can provide some guidance"><y>#</y><d>2019-02-19</d><h>20:23</h><w>ddeaguiar</w><a>@decim</a> creating such an example has been on my todo list for a while. If you have specific questions perhaps I can provide some guidance</z><z id="t1550607993" t="v3ga [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] i’m very much at the beginning of it. I’ve gone through the provided tutorials and I’m really just trying to figure out where to go, what all is necessary. Even something as simple as making a post. For starters i’d like to know how to just serve a basic index.html page from my resources folder. As I get a hold on things I’ll start to make blog posts for people in the future interested."><y>#</y><d>2019-02-19</d><h>20:26</h><w>v3ga</w><a>@ddeaguiar</a> i’m very much at the beginning of it. I’ve gone through the provided tutorials and I’m really just trying to figure out where to go, what all is necessary. Even something as simple as making a post. For starters i’d like to know how to just serve a basic index.html page from my resources folder.

As I get a hold on things I’ll start to make blog posts for people in the future interested.</z><z id="t1550608138" t="ddeaguiar To serve files, add the :io.pedestal.http/resource-path key to your system map. This will serve any files which match url from that dir"><y>#</y><d>2019-02-19</d><h>20:28</h><w>ddeaguiar</w>To serve files, add the <code>:io.pedestal.http/resource-path</code> key to your system map. This will serve any files which match url from that dir</z><z id="t1550608244" t="v3ga [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] ok, nice. I really have to start looking through the source as well today. I’m coming from frameworks like ruby on rails so these libraries are very bare bones which isn’t a bad thing, it’s good to know exactly what’s taking place"><y>#</y><d>2019-02-19</d><h>20:30</h><w>v3ga</w><a>@ddeaguiar</a> ok, nice.  I really have to start looking through the source as well today. I’m coming from frameworks like ruby on rails so these libraries are very bare bones which isn’t a bad thing, it’s good to know exactly what’s taking place</z><z id="t1550608412" t="ddeaguiar I’ve experimented with component and pedestal quite a bit on various projects and I’m now more discerning about bringing the two together."><y>#</y><d>2019-02-19</d><h>20:33</h><w>ddeaguiar</w>I’ve experimented with component and pedestal quite a bit on various projects and I’m now more discerning about bringing the two together.</z><z id="t1550608466" t="ddeaguiar Pedestal provides a configuration map which you can append anything to at runtime, during system startup"><y>#</y><d>2019-02-19</d><h>20:34</h><w>ddeaguiar</w>Pedestal provides a configuration map which you can append anything to at runtime, during system startup</z><z id="t1550608503" t="ddeaguiar They key concept is to create interceptors which provide access to those things you need (i.e., db connection, etc…)"><y>#</y><d>2019-02-19</d><h>20:35</h><w>ddeaguiar</w>They key concept is to create interceptors which provide access to those things you need (i.e., db connection, etc…)</z><z id="t1550608538" t="ddeaguiar If you need to start things, you already have the facilities to do it and append the started thing to the service map"><y>#</y><d>2019-02-19</d><h>20:35</h><w>ddeaguiar</w>If you need to start things, you already have the facilities to do it and append the started thing to the service map</z><z id="t1550608543" t="ddeaguiar same with stopping"><y>#</y><d>2019-02-19</d><h>20:35</h><w>ddeaguiar</w>same with stopping</z><z id="t1550608544" t="ddeaguiar but"><y>#</y><d>2019-02-19</d><h>20:35</h><w>ddeaguiar</w>but</z><z id="t1550608577" t="ddeaguiar If you really want to use component or mount or whatever, you can"><y>#</y><d>2019-02-19</d><h>20:36</h><w>ddeaguiar</w>If you really want to use component or mount or whatever, you can</z><z id="t1550608750" t="ddeaguiar My current line of thinking here is: - Define routes in one place - Limit components to external dependency needs (db, queueing system, etc…) - Use interceptors as glue to make those dependencies available on the context map and/or request - Do more processing in interceptors and limit handlers to formatting responses - With Component, have the Pedestal component depend on all other components and be responsible for putting their interceptor glue on the interceptor chain"><y>#</y><d>2019-02-19</d><h>20:39</h><w>ddeaguiar</w>My current line of thinking here is:
- Define routes in one place
- Limit components to external dependency needs (db, queueing system, etc…)
- Use interceptors as glue to make those dependencies available on the context map and/or request
- Do more processing in interceptors and limit handlers to formatting responses
- With Component, have the Pedestal component depend on all other components and be responsible for putting their interceptor glue on the interceptor chain</z><z id="t1550608880" t="ddeaguiar Here are some examples of component+pedestal that I’ve tinkered with: https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L1 , https://github.com/ddeaguiar/component-pedestal"><y>#</y><d>2019-02-19</d><h>20:41</h><w>ddeaguiar</w>Here are some examples of component+pedestal that I’ve tinkered with: <a href="https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L1" target="_blank">https://github.com/pointslope/elements/blob/master/src/pointslope/elements/pedestal.clj#L1</a>, <a href="https://github.com/ddeaguiar/component-pedestal" target="_blank">https://github.com/ddeaguiar/component-pedestal</a></z><z id="t1550608895" t="ddeaguiar TBH, I’m not happy with either of them but you can use that for inspiration"><y>#</y><d>2019-02-19</d><h>20:41</h><w>ddeaguiar</w>TBH, I’m not happy with either of them but you can use that for inspiration</z><z id="t1550609243" t="v3ga Hmm ok, I see. Looking at ‘elements’ now. It almost seems as if it’s better to start from scratch opposed to lein new pedestal service app-name"><y>#</y><d>2019-02-19</d><h>20:47</h><w>v3ga</w>Hmm ok, I see. Looking at ‘elements’ now. It almost seems as if it’s better to start from scratch opposed to lein new pedestal service app-name</z><z id="t1550609309" t="ddeaguiar yeah it’s a different way of building a service"><y>#</y><d>2019-02-19</d><h>20:48</h><w>ddeaguiar</w>yeah it’s a different way of building a service</z><z id="t1550609440" t="ddeaguiar Again, take it with a grain of salt. Those projects are old and I’ve not had the need leverage component + pedestal lately"><y>#</y><d>2019-02-19</d><h>20:50</h><w>ddeaguiar</w>Again, take it with a grain of salt. Those projects are old and I’ve not had the need leverage component + pedestal lately</z><z id="t1550609454" t="ddeaguiar But if you are just learning pedestal, then stick with the service template"><y>#</y><d>2019-02-19</d><h>20:50</h><w>ddeaguiar</w>But if you are just learning pedestal, then stick with the service template</z><z id="t1550609777" t="ddeaguiar It’s perfectly acceptable to provision dependencies on system startup via -main or run-dev and add the interceptors which provide access to those started resources at that point."><y>#</y><d>2019-02-19</d><h>20:56</h><w>ddeaguiar</w>It’s perfectly acceptable to provision dependencies on system startup via <code>-main</code> or <code>run-dev</code> and add the interceptors which provide access to those started resources at that point.</z><z id="t1550610588" t="v3ga [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yeah i’m wondering if using component or mount is overkill as well. I may be experimenting with too many things at once. long term for this toy project i’d like to use it but I suppose I shouldn’t fear a complete rewrite after I know what’s taking place. So you do prefer component over mount? I’ve seen a bit of discussion about that."><y>#</y><d>2019-02-19</d><h>21:09</h><w>v3ga</w><a>@ddeaguiar</a> yeah i’m wondering if using component or mount is overkill as well. I may be experimenting with too many things at once. long term for this toy project i’d like to use it but I suppose I shouldn’t fear a complete rewrite after I know what’s taking place. So you do prefer component over mount? I’ve seen a bit of discussion about that.</z><z id="t1550612512" t="mkvlr [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] I prefer integrant"><y>#</y><d>2019-02-19</d><h>21:41</h><w>mkvlr</w><a>@decim</a> I prefer integrant</z><z id="t1550612572" t="mkvlr [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] check out https://lambdaisland.com/episodes/integrant"><y>#</y><d>2019-02-19</d><h>21:42</h><w>mkvlr</w><a>@decim</a> check out <a href="https://lambdaisland.com/episodes/integrant" target="_blank">https://lambdaisland.com/episodes/integrant</a></z><z id="t1550630295" t="v3ga [:attrs {:href &quot;/_/_/users/U5H74UNSF&quot;}] taking a look over that as well now"><y>#</y><d>2019-02-20</d><h>02:38</h><w>v3ga</w><a>@mkvlr</a> taking a look over that as well now</z><z id="t1550686284" t="ccann can anyone offer advice on how to disambiguate these routes? [&quot;/custom/notes/images/storage-parameters&quot; :post [...]] [&quot;/custom/notes/:id&quot; :get [...]] [&quot;/custom/notes/:id&quot; :patch [...]] [&quot;/custom/notes/:id/graphic&quot; :get [...]] [&quot;/custom/notes/:id/production-file&quot; :post [...]]"><y>#</y><d>2019-02-20</d><h>18:11</h><w>ccann</w>can anyone offer advice on how to disambiguate these routes?
<pre>[&quot;/custom/notes/images/storage-parameters&quot; :post [...]]
    [&quot;/custom/notes/:id&quot;                 :get   [...]]
    [&quot;/custom/notes/:id&quot;                 :patch [...]]
    [&quot;/custom/notes/:id/graphic&quot;         :get   [...]]
    [&quot;/custom/notes/:id/production-file&quot; :post  [...]]</pre></z><z id="t1550686300" t="ccann the first one always 404s"><y>#</y><d>2019-02-20</d><h>18:11</h><w>ccann</w>the first one always 404s</z><z id="t1550687287" t="ccann Do I have to resort to the linear router here? Can I change routing syntax instead?"><y>#</y><d>2019-02-20</d><h>18:28</h><w>ccann</w>Do I have to resort to the linear router here? Can I change routing syntax instead?</z><z id="t1550704574" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] , This behavior to be independent of routing syntax because routes all get expanded to the verbose form. What you are observing is expected behavior for the prefix tree router. As per https://github.com/pedestal/pedestal/pull/330 &gt; The prefix-tree router also changes some of the routing behavior. In the linear-search, you could have routes like /one/:wild and /one/two , the latter being a hard match and the former picking up any wildcard URL matches (not /one/two). In the prefix-tree, this isn’t allowed, and one/:wild will always be matched. This change also encourages “best practices” and removes the possibility of subtle bugs introduced by human error."><y>#</y><d>2019-02-20</d><h>23:16</h><w>ddeaguiar</w><a>@ccann</a>, This behavior to be independent of routing syntax because routes all get expanded to the verbose form. What you are observing is expected behavior for the prefix tree router. As per <a href="https://github.com/pedestal/pedestal/pull/330" target="_blank">https://github.com/pedestal/pedestal/pull/330</a>

&gt; The prefix-tree router also changes some of the routing behavior. In the linear-search, you could have routes like <code>/one/:wild</code> and <code>/one/two</code>, the latter being a hard match and the former picking up any wildcard URL matches (not /one/two). In the prefix-tree, this isn’t allowed, and <code>one/:wild</code> will always be matched. This change also encourages “best practices” and removes the possibility of subtle bugs introduced by human error.</z><z id="t1550704612" t="ddeaguiar I realize that this documentation is buried deep in the bowels of Pedestal. I plan on updating the routing docs to make this info more visible"><y>#</y><d>2019-02-20</d><h>23:16</h><w>ddeaguiar</w>I realize that this documentation is buried deep in the bowels of Pedestal. I plan on updating the routing docs to make this info more visible</z><z id="t1550704674" t="ddeaguiar If you decide to continue with your existing routes then the linear search router is the way to go."><y>#</y><d>2019-02-20</d><h>23:17</h><w>ddeaguiar</w>If you decide to continue with your existing routes then the linear search router is the way to go.</z><z id="t1550766066" t="ccann thanks very much, that makes sense. I am going to change my route"><y>#</y><d>2019-02-21</d><h>16:21</h><w>ccann</w>thanks very much, that makes sense. I am going to change my route</z><z id="t1550847223" t="ujjwalt Hi. New to Clojure and Pedestal. Looking at Vase. Can someone explain why the template doesn’t match the instructions on building your first API?"><y>#</y><d>2019-02-22</d><h>14:53</h><w>ujjwalt</w>Hi. New to Clojure and Pedestal. Looking at Vase. Can someone explain why the template doesn’t match the instructions on building your first API?</z><z id="t1550847251" t="ujjwalt Also is Pedestal and Vase ready for production use?"><y>#</y><d>2019-02-22</d><h>14:54</h><w>ujjwalt</w>Also is Pedestal and Vase ready for production use?</z><z id="t1550847882" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] and welcome 🙂 . I’ll take a look at the Vase docs. It could be that they are out of date. I’m not sure what your definition is for production use but both have been used in production systems. Pedestal predates Vase by a number of years, is highly configurable and supports high traffic usage scenarios"><y>#</y><d>2019-02-22</d><h>15:04</h><w>ddeaguiar</w>Hi <a>@ujjwalt</a> and welcome <b>🙂</b>. I’ll take a look at the Vase docs. It could be that they are out of date. I’m not sure what your definition is for production use but both have been used in production systems. Pedestal predates Vase by a number of years, is highly configurable and supports high traffic usage scenarios</z><z id="t1550847912" t="ujjwalt Yeah I meant if people have used it in production and that it won"><y>#</y><d>2019-02-22</d><h>15:05</h><w>ujjwalt</w>Yeah I meant if people have used it in production and that it won</z><z id="t1550847916" t="ujjwalt *won’t crash"><y>#</y><d>2019-02-22</d><h>15:05</h><w>ujjwalt</w>*won’t crash</z><z id="t1550847943" t="ujjwalt Little confused with Vase because of the mismatch. Any suggestions on what path to follow to understand it and start using"><y>#</y><d>2019-02-22</d><h>15:05</h><w>ujjwalt</w>Little confused with Vase because of the mismatch. Any suggestions on what path to follow to understand it and start using</z><z id="t1550847981" t="ddeaguiar I’d start with Pedestal first and understand it’s concepts"><y>#</y><d>2019-02-22</d><h>15:06</h><w>ddeaguiar</w>I’d start with Pedestal first and understand it’s concepts</z><z id="t1550848043" t="ddeaguiar Understanding Vase is much easier once you’ve got the basic concepts down"><y>#</y><d>2019-02-22</d><h>15:07</h><w>ddeaguiar</w>Understanding Vase is much easier once you’ve got the basic concepts down</z><z id="t1550848067" t="ddeaguiar Then I’d peruse Datomic docs to get a high-level understanding"><y>#</y><d>2019-02-22</d><h>15:07</h><w>ddeaguiar</w>Then I’d peruse Datomic docs to get a high-level understanding</z><z id="t1550848082" t="ddeaguiar I tried to capture the learning path here https://github.com/cognitect-labs/vase#before-you-get-started"><y>#</y><d>2019-02-22</d><h>15:08</h><w>ddeaguiar</w>I tried to capture the learning path here <a href="https://github.com/cognitect-labs/vase#before-you-get-started" target="_blank">https://github.com/cognitect-labs/vase#before-you-get-started</a></z><z id="t1550848375" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] , sorry you ran into issues with the Your first API doc. I can see that it uses the Fern api description format but the vase template is emitting the edn format. I’ll work on rectifying that but you can try working with an older version of that guide in the meantime https://github.com/cognitect-labs/vase/blob/6332b633c174fcfa40efef56d3cd0a57cd2033f8/docs/your_first_api.md"><y>#</y><d>2019-02-22</d><h>15:12</h><w>ddeaguiar</w><a>@ujjwalt</a>, sorry you ran into issues with the Your first API doc. I can see that it uses the Fern api description format but the vase template is emitting the edn format. I’ll work on rectifying that but you can try working with an older version of that guide in the meantime <a href="https://github.com/cognitect-labs/vase/blob/6332b633c174fcfa40efef56d3cd0a57cd2033f8/docs/your_first_api.md" target="_blank">https://github.com/cognitect-labs/vase/blob/6332b633c174fcfa40efef56d3cd0a57cd2033f8/docs/your_first_api.md</a></z><z id="t1550848537" t="ujjwalt Thanks a lot [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] . I’ll start there. Will get back if I encounter something else."><y>#</y><d>2019-02-22</d><h>15:15</h><w>ujjwalt</w>Thanks a lot <a>@ddeaguiar</a>. I’ll start there. Will get back if I encounter something else.</z><z id="t1550848555" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-02-22</d><h>15:15</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1550850031" t="ujjwalt Quick questions: Specifically when does one use ions vs Vase? What would be the ideal use cases for both provided we are on AWS."><y>#</y><d>2019-02-22</d><h>15:40</h><w>ujjwalt</w>Quick questions: Specifically when does one use ions vs Vase? What would be the ideal use cases for both provided we are on AWS.</z><z id="t1550851295" t="ddeaguiar It’s on my todo list to put out an example of Ions + Vase now that datomic client api support has landed on Vase master. Note that we’ve yet to push out a release of Vase with those changes"><y>#</y><d>2019-02-22</d><h>16:01</h><w>ddeaguiar</w>It’s on my todo list to put out an example of Ions + Vase now that datomic client api support has landed on Vase master. Note that we’ve yet to push out a release of Vase with those changes</z><z id="t1550851366" t="ddeaguiar Vase’s value proposition is in data described services. Using it, you can build services quickly"><y>#</y><d>2019-02-22</d><h>16:02</h><w>ddeaguiar</w>Vase’s value proposition is in data described services. Using it, you can build services quickly</z><z id="t1550851924" t="ddeaguiar Ions allows you to deploy code that runs on the Datomic infrastructure - close to your DB. In the process, it facilitates deployments."><y>#</y><d>2019-02-22</d><h>16:12</h><w>ddeaguiar</w>Ions allows you to deploy code that runs on the Datomic infrastructure - close to your DB. In the process, it facilitates deployments.</z><z id="t1550851963" t="ddeaguiar If you are working with Datomic Cloud, then there’s likely a place where Ions are a fit for you"><y>#</y><d>2019-02-22</d><h>16:12</h><w>ddeaguiar</w>If you are working with Datomic Cloud, then there’s likely a place where Ions are a fit for you</z><z id="t1550852032" t="ddeaguiar In fact, re: Ions, they run within the Datomic process"><y>#</y><d>2019-02-22</d><h>16:13</h><w>ddeaguiar</w>In fact, re: Ions, they run within the Datomic process</z><z id="t1550852060" t="ddeaguiar so your application is running in the database. You can’t get much closer to your data than that"><y>#</y><d>2019-02-22</d><h>16:14</h><w>ddeaguiar</w>so your application is running in the database. You can’t get much closer to your data than that</z><z id="t1550852072" t="ddeaguiar and you benefit from autoscaling, etc…"><y>#</y><d>2019-02-22</d><h>16:14</h><w>ddeaguiar</w>and you benefit from autoscaling, etc…</z><z id="t1550852124" t="ddeaguiar There are some caveats, you may run into dependency conflicts but the tooling around identifying, describing and resolving those has improved"><y>#</y><d>2019-02-22</d><h>16:15</h><w>ddeaguiar</w>There are some caveats, you may run into dependency conflicts but the tooling around identifying, describing and resolving those has improved</z><z id="t1550852867" t="ujjwalt I see. So there’s a use case for using Ions + Vase? Like deploying Vase services as ions? That would be pretty cool. Or maybe deploying it as an API gateway?"><y>#</y><d>2019-02-22</d><h>16:27</h><w>ujjwalt</w>I see. So there’s a use case for using Ions + Vase? Like deploying Vase services as ions? That would be pretty cool. Or maybe deploying it as an API gateway?</z><z id="t1550853020" t="ddeaguiar I’ve not tried deploying Vase via Ions yet but see no reason why that wouldn’t work. It’s just a Pedestal service and we have a Pedestal Ions interceptor chain provider https://github.com/pedestal/pedestal.ions"><y>#</y><d>2019-02-22</d><h>16:30</h><w>ddeaguiar</w>I’ve not tried deploying Vase via Ions yet but see no reason why that wouldn’t work. It’s just a Pedestal service and we have a Pedestal Ions interceptor chain provider <a href="https://github.com/pedestal/pedestal.ions" target="_blank">https://github.com/pedestal/pedestal.ions</a></z><z id="t1550853059" t="ddeaguiar but we’d need to release an updated version of Vase first containing Datomic Cloud support (currently on master)"><y>#</y><d>2019-02-22</d><h>16:30</h><w>ddeaguiar</w>but we’d need to release an updated version of Vase first containing Datomic Cloud support (currently on master)</z><z id="t1550853303" t="ddeaguiar I also think Vase + Ions is cool!"><y>#</y><d>2019-02-22</d><h>16:35</h><w>ddeaguiar</w>I also think Vase + Ions is cool!</z><z id="t1550855309" t="ujjwalt That sounds very interesting. Any possible timeline on Vase Datomic Cloud support release?"><y>#</y><d>2019-02-22</d><h>17:08</h><w>ujjwalt</w>That sounds very interesting. Any possible timeline on Vase Datomic Cloud support release?</z><z id="t1550855421" t="ddeaguiar I’m hoping in the next few weeks"><y>#</y><d>2019-02-22</d><h>17:10</h><w>ddeaguiar</w>I’m hoping in the next few weeks</z><z id="t1550855743" t="ujjwalt And any update on the pedestal docs on the website. A lot of links don’t have articles"><y>#</y><d>2019-02-22</d><h>17:15</h><w>ujjwalt</w>And any update on the pedestal docs on the website. A lot of links don’t have articles</z><z id="t1550855887" t="ddeaguiar Ongoing work in progress"><y>#</y><d>2019-02-22</d><h>17:18</h><w>ddeaguiar</w>Ongoing work in progress</z><z id="t1550856116" t="ujjwalt Cool. Thanks a lot."><y>#</y><d>2019-02-22</d><h>17:21</h><w>ujjwalt</w>Cool. Thanks a lot.</z><z id="t1550857430" t="ddeaguiar np!"><y>#</y><d>2019-02-22</d><h>17:43</h><w>ddeaguiar</w>np!</z><z id="t1550929280" t="demonshreder Where can I find the leiningen-template for pedestal-service"><y>#</y><d>2019-02-23</d><h>13:41</h><w>demonshreder</w>Where can I find the leiningen-template for <code>pedestal-service</code></z><z id="t1550929474" t="demonshreder Nvm, got it - https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service"><y>#</y><d>2019-02-23</d><h>13:44</h><w>demonshreder</w>Nvm, got it - <a href="https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service" target="_blank">https://github.com/pedestal/pedestal/tree/master/service-template/src/leiningen/new/pedestal_service</a></z><z id="t1550930218" t="demonshreder I had trouble sigining the CLA"><y>#</y><d>2019-02-23</d><h>13:56</h><w>demonshreder</w>I had trouble sigining the CLA</z><z id="t1551103766" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UGEAQ5LJJ&quot;}] sorry about the issue with the CA. We’re aware of it and looking into it"><y>#</y><d>2019-02-25</d><h>14:09</h><w>ddeaguiar</w><a>@sskamalavelan</a> sorry about the issue with the CA. We’re aware of it and looking into it</z><z id="t1551118891" t="demonshreder [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] :thumbsup:"><y>#</y><d>2019-02-25</d><h>18:21</h><w>demonshreder</w><a>@ddeaguiar</a> <b>:thumbsup:</b></z><z id="t1551277241" t="donaldball By default, the pedestal dev interceptor pprints the context when an exception occurs. Sometimes, the context can be Very Large, which makes for a hot cpu locally. Have others been sad about this, and what strategies have you employed to mitigate it?"><y>#</y><d>2019-02-27</d><h>14:20</h><w>donaldball</w>By default, the pedestal dev interceptor pprints the context when an exception occurs. Sometimes, the context can be Very Large, which makes for a hot cpu locally. Have others been sad about this, and what strategies have you employed to mitigate it?</z><z id="t1551287251" t="souenzzo I store datascript db in ctx When my repl freezes, I know that pedestal is trying to print it 😞"><y>#</y><d>2019-02-27</d><h>17:07</h><r>souenzzo</r>I store datascript db in <code>ctx</code>
When my repl freezes, I know that pedestal is trying to print it <b>😞</b></z><z id="t1551288746" t="donaldball ha ha the struggle is real"><y>#</y><d>2019-02-27</d><h>17:32</h><r>donaldball</r>ha ha the struggle is real</z><z id="t1551291757" t="ddeaguiar I can see two ways to deal with this and there both applications specific: 1. Leverage the existing print vars to control how much is printed. Clojure’s pprint impl respects those. 2. Implement your own dev interceptor variant which does not pprint the context."><y>#</y><d>2019-02-27</d><h>18:22</h><r>ddeaguiar</r>I can see two ways to deal with this and there both applications specific:
1. Leverage the existing print vars to control how much is printed. Clojure’s pprint impl respects those.
2. Implement your own dev interceptor variant which does not pprint the context.</z><z id="t1551287251" t="souenzzo I store datascript db in ctx When my repl freezes, I know that pedestal is trying to print it 😞"><y>#</y><d>2019-02-27</d><h>17:07</h><w>souenzzo</w>I store datascript db in <code>ctx</code>
When my repl freezes, I know that pedestal is trying to print it <b>😞</b></z><z id="t1551291678" t="ccann I also occasionally find this more noisy and confusing than it is helpful, but I keep thinking for some gnarly issue one day I’ll be thankful the information is all there"><y>#</y><d>2019-02-27</d><h>18:21</h><w>ccann</w>I also occasionally find this more noisy and confusing than it is helpful, but I keep thinking for some gnarly issue one day I’ll be thankful the information is all there</z><z id="t1551296029" t="souenzzo How to configure a /* in AWS API Gateway to get pedestal working in IONS?"><y>#</y><d>2019-02-27</d><h>19:33</h><w>souenzzo</w>How to configure a <code>/*</code> in AWS API Gateway to get pedestal working in IONS?</z><z id="t1551296536" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] /{proxy+} is not sufficient?"><y>#</y><d>2019-02-27</d><h>19:42</h><w>ddeaguiar</w><a>@souenzzo</a> <code>/{proxy+}</code> is not sufficient?</z><z id="t1551296611" t="ddeaguiar Have you tried this sample? https://github.com/pedestal/pedestal-ions-sample"><y>#</y><d>2019-02-27</d><h>19:43</h><w>ddeaguiar</w>Have you tried this sample? <a href="https://github.com/pedestal/pedestal-ions-sample" target="_blank">https://github.com/pedestal/pedestal-ions-sample</a></z><z id="t1551298397" t="souenzzo [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I&apos;m using proxy+ (generated by clicking in proxy checkbox) when I call it send&apos;s me {&quot;message&quot;:&quot;Missing Authentication Token&quot;} when I call it return my handler, as expected when I call it returns {&quot;message&quot;:&quot;Missing Authentication Token&quot;} again"><y>#</y><d>2019-02-27</d><h>20:13</h><w>souenzzo</w><a>@ddeaguiar</a>
I&apos;m using proxy+ (generated by clicking in proxy checkbox)
when I call <code></code> it send&apos;s me <code>{&quot;message&quot;:&quot;Missing Authentication Token&quot;}</code>
when I call <code></code> it return my handler, as expected
when I call <code></code> it returns <code>{&quot;message&quot;:&quot;Missing Authentication Token&quot;}</code> again</z><z id="t1551298543" t="souenzzo ATM I&apos;m with #{[&quot;/*&quot; :get hello]} that returns {:body (pr-str path-info) :status 200}"><y>#</y><d>2019-02-27</d><h>20:15</h><w>souenzzo</w>ATM I&apos;m with <code>#{[&quot;/*&quot; :get hello]}</code> that returns <code>{:body (pr-str path-info) :status 200}</code></z><z id="t1551299258" t="ddeaguiar hrm /proxy+ should route any child path to the ion"><y>#</y><d>2019-02-27</d><h>20:27</h><w>ddeaguiar</w>hrm /proxy+ should route any child path to the ion</z><z id="t1551299312" t="ddeaguiar to get / to work, you need to set up the ANY method on / to proxy requests to the lambda. Apparently /proxy+ doesn’t handle that"><y>#</y><d>2019-02-27</d><h>20:28</h><w>ddeaguiar</w>to get <code>/</code> to work, you need to set up the <code>ANY</code> method on <code>/</code> to proxy requests to the lambda. Apparently <code>/proxy+</code> doesn’t handle that</z><z id="t1551299328" t="ddeaguiar There’s probably a better way to do that…"><y>#</y><d>2019-02-27</d><h>20:28</h><w>ddeaguiar</w>There’s probably a better way to do that…</z><z id="t1551299401" t="souenzzo should all my routes be [&quot;/:app/my-actual-path/...&quot; :get ,,,] ?"><y>#</y><d>2019-02-27</d><h>20:30</h><w>souenzzo</w>should all my routes be <code>[&quot;/:app/my-actual-path/...&quot; :get ,,,]</code> ?</z><z id="t1551299474" t="ddeaguiar no, the relative path should suffice"><y>#</y><d>2019-02-27</d><h>20:31</h><w>ddeaguiar</w>no, the relative path should suffice</z><z id="t1551299484" t="ddeaguiar Example: https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L142-L148"><y>#</y><d>2019-02-27</d><h>20:31</h><w>ddeaguiar</w>Example: <a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L142-L148" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L142-L148</a></z><z id="t1551301610" t="souenzzo Oh, I need to &quot;deploy&quot; my api gateway config"><y>#</y><d>2019-02-27</d><h>21:06</h><w>souenzzo</w>Oh, I need to &quot;deploy&quot; my api gateway config</z><z id="t1551301623" t="souenzzo sorry [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] . Now it&apos;s working"><y>#</y><d>2019-02-27</d><h>21:07</h><w>souenzzo</w>sorry <a>@ddeaguiar</a>. Now it&apos;s working</z><z id="t1551301642" t="ddeaguiar Ah yes, deployment is important 🙂"><y>#</y><d>2019-02-27</d><h>21:07</h><w>ddeaguiar</w>Ah yes, deployment is important <b>🙂</b></z><z id="t1551301651" t="ddeaguiar That’s bitten me before…"><y>#</y><d>2019-02-27</d><h>21:07</h><w>ddeaguiar</w>That’s bitten me before…</z><z id="t1551302548" t="souenzzo Choose Add Binary Media Type, add the */* type. It will solve the fact of everything comes in base64 ?"><y>#</y><d>2019-02-27</d><h>21:22</h><w>souenzzo</w><code>Choose Add Binary Media Type, add the */* type.</code>
It will solve the fact of everything comes in base64 ?</z><z id="t1551303140" t="ddeaguiar My understanding is that by setting that, API gateway passes the data through to the ion unaltered"><y>#</y><d>2019-02-27</d><h>21:32</h><w>ddeaguiar</w>My understanding is that by setting that, API gateway passes the data through to the ion unaltered</z><z id="t1551303154" t="ddeaguiar well to the lambda proxy’ing the ion"><y>#</y><d>2019-02-27</d><h>21:32</h><w>ddeaguiar</w>well to the lambda proxy’ing the ion</z><z id="t1551305328" t="ddeaguiar BTW, that last bit is an important point. Most meaningful logs will not be in the lambda logs but the compute group logs"><y>#</y><d>2019-02-27</d><h>22:08</h><w>ddeaguiar</w>BTW, that last bit is an important point. Most meaningful logs will not be in the lambda logs but the compute group logs</z><z id="t1551305336" t="ddeaguiar easy to forget that"><y>#</y><d>2019-02-27</d><h>22:08</h><w>ddeaguiar</w>easy to forget that</z><z id="t1551306568" t="Jonathan Can pedestal still use ring middlewares as interceptors? I found the ring_middlewares sample repo but it’s in terms of pedestal 0.1.2"><y>#</y><d>2019-02-27</d><h>22:29</h><w>Jonathan</w>Can pedestal still use ring middlewares as interceptors? I found the ring_middlewares sample repo but it’s in terms of pedestal 0.1.2</z><z id="t1551363104" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U9UQ36CJJ&quot;}] ! Pedestal uses interceptors instead of middleware but there are a number of middleware that have been wrapped by interceptors ( https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj ) and, in most cases, it’s pretty straight forward to create interceptor wrappers of your own. Here’s a sample which does just that https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L51-L72 ."><y>#</y><d>2019-02-28</d><h>14:11</h><r>ddeaguiar</r>Hi <a>@U9UQ36CJJ</a>! Pedestal uses interceptors instead of middleware but there are a number of middleware that have been wrapped by interceptors (<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj</a>) and, in most cases, it’s pretty straight forward to create interceptor wrappers of your own. Here’s a sample which does just that <a href="https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L51-L72" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L51-L72</a>.</z><z id="t1551338977" t="Twice Hey, everyone! While trying to incorporate Sente library into Pedestal, I&apos;m getting No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: org.projectodd.wunderboss.web.async.ServletHttpChannel error. Can&apos;t figure out how to deal with it"><y>#</y><d>2019-02-28</d><h>07:29</h><w>Twice</w>Hey, everyone!  While trying to incorporate Sente library into Pedestal, I&apos;m getting <code>No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: org.projectodd.wunderboss.web.async.ServletHttpChannel</code> error. Can&apos;t figure out how to deal with it</z><z id="t1551367290" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UFEQ5L1NK&quot;}] , I’m not familiar with Sente but based on that message, it seems like you’ll need to implement an interceptor chain provider to support it. The default servlet-specific implementation supports Tomcat, Jetty and Immutant."><y>#</y><d>2019-02-28</d><h>15:21</h><r>ddeaguiar</r><a>@UFEQ5L1NK</a>, I’m not familiar with Sente but based on that message, it seems like you’ll need to implement an interceptor chain provider to support it. The default servlet-specific implementation supports Tomcat, Jetty and Immutant.</z><z id="t1551383378" t="Jonathan I haven’t used Sente but I recently evaluated it for a project. It’s a fairly comprehensive websockets library but it’s not compatible with Tomcat or Jetty. I ended up using http-kit’s built-in websocket library. Time will tell if that’s the right choice"><y>#</y><d>2019-02-28</d><h>19:49</h><r>Jonathan</r>I haven’t used Sente but I recently evaluated it for a project. It’s a fairly comprehensive websockets library but it’s not compatible with Tomcat or Jetty. I ended up using http-kit’s built-in websocket library. Time will tell if that’s the right choice</z><z id="t1551384118" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-02-28</d><h>20:01</h><r>ddeaguiar</r><b>:thumbsup:</b></z><z id="t1551415344" t="Twice I thought it was compatible with Immutant, guess I was wrong. Thanks for advice anyway!"><y>#</y><d>2019-03-01</d><h>04:42</h><r>Twice</r>I thought it was compatible with Immutant, guess I was wrong. Thanks for advice anyway!</z><z id="t1551779500" t="manandearth Hi there. New to pedestal. Happy to be corrected. I was extending the example in the official pedestal guide (specifically the rest api example: http://pedestal.io/guides/your-first-api ) Wanted to implement a :delete interceptor (just in order to understand). tried the following: (def list-delete {:name :list-delete :enter (fn [context] (let [nm (get-in context [:request :query-params :name]) db-id (filter (comp #{nm} (:tx-data context)) (keys (:tx-data context)))] (update context :tx-data dissoc db-id)))}) the original interceptor that creates the list is: (def list-create {:name :list-create :enter (fn [context] (let [nm (get-in context [:request :query-params :name] &quot;Unnamed List&quot;) new-list (make-list nm) db-id (str (gensym &quot;l&quot;))] (assoc context :tx-data [assoc db-id new-list])))}) the original route for the :post is: [&quot;/todo&quot; :post [db-interceptor list-create]] so my :delete root is: [&quot;/todo&quot; :delete [db-interceptor list-delete]] But trying the test: (test-request :delete &quot;/todo?name=some-list&quot;) when the state is: {&quot;l30491&quot; {:name &quot;my-other-list&quot;, :items {}}, &quot;l30517&quot; {:name &quot;yes-list&quot;, :items {}}, &quot;l30520&quot; {:name &quot;no-list&quot;, :items {}}, &quot;l30527&quot; {:name &quot;no-list&quot;, :items {}}, &quot;l30618&quot; {:name &quot;some-list&quot;, :items {}}} does not delete the list in question.... Note that some-list is the :name value in a map which is a value of the string &quot;l30618&quot; ... I think that my list-delete function should do the job, but I suspect that I don&apos;t understand something basic either about interceptors or about how :delete should be called in a REST api...."><y>#</y><d>2019-03-05</d><h>09:51</h><w>manandearth</w>Hi there. New to pedestal. Happy to be corrected.
I was extending the example in the official pedestal guide (specifically the rest api example: <a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a>)
Wanted to implement a <code>:delete</code>  interceptor  (just in order to understand). tried the following:

<pre>(def list-delete
 {:name :list-delete                                                                                                  
  :enter
   (fn [context]
      (let [nm (get-in context [:request :query-params :name]) 
            db-id (filter (comp #{nm} (:tx-data context)) (keys (:tx-data context)))] 
        (update context :tx-data dissoc db-id)))}) 
</pre>
the original interceptor that creates the list is:
<pre>(def list-create   
   {:name :list-create 
    :enter
    (fn [context]
      (let [nm       (get-in context [:request :query-params :name] &quot;Unnamed List&quot;)
            new-list (make-list nm)
            db-id    (str (gensym &quot;l&quot;))] 
        (assoc context :tx-data [assoc db-id new-list])))}) 
</pre>

the original route for the <code>:post</code> is: <code>[&quot;/todo&quot; :post [db-interceptor list-create]]</code>
so my :delete root is: <code>[&quot;/todo&quot; :delete [db-interceptor list-delete]]</code>
But  trying the test:  <code>(test-request :delete &quot;/todo?name=some-list&quot;) </code>
when the state is:
<pre>{&quot;l30491&quot; {:name &quot;my-other-list&quot;, :items {}}, &quot;l30517&quot; {:name &quot;yes-list&quot;, :items {}}, &quot;l30520&quot; {:name &quot;no-list&quot;, :items {}}, &quot;l30527&quot; {:name &quot;no-list&quot;, :items {}}, &quot;l30618&quot; {:name &quot;some-list&quot;, :items {}}} 
</pre>
does not delete the list in question....

Note that <code>some-list</code> is the :name value in a map which is a value of the string &quot;l30618&quot; ... I think that my <code>list-delete</code> function should do the job, but I suspect that I don&apos;t understand something basic either about interceptors or about how :delete should be called in a REST api....</z><z id="t1551823574" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBGH0Q0H4&quot;}] At a glance, it doesn’t look like your list-delete impl is correct"><y>#</y><d>2019-03-05</d><h>22:06</h><w>ddeaguiar</w><a>@adamgefen</a> At a glance, it doesn’t look like your <code>list-delete</code> impl is correct</z><z id="t1551823596" t="ddeaguiar the filter expression looks wrong"><y>#</y><d>2019-03-05</d><h>22:06</h><w>ddeaguiar</w>the <code>filter</code> expression looks wrong</z><z id="t1553709632" t="souenzzo There is docs about error-handling inside ions?"><y>#</y><d>2019-03-27</d><h>18:00</h><w>souenzzo</w>There is docs about error-handling inside ions?</z><z id="t1553709652" t="souenzzo Ions has a nice logging that I can see in cloudwatch"><y>#</y><d>2019-03-27</d><h>18:00</h><w>souenzzo</w>Ions has a nice logging that I can see in cloudwatch</z><z id="t1553709665" t="souenzzo but there is no logs about pedestal on there"><y>#</y><d>2019-03-27</d><h>18:01</h><w>souenzzo</w>but there is no logs about pedestal on there</z><z id="t1553709827" t="ddeaguiar Only ERROR logs are available in ions. If you need to troubleshoot something you can use cast"><y>#</y><d>2019-03-27</d><h>18:03</h><w>ddeaguiar</w>Only ERROR logs are available in ions. If you need to troubleshoot something you can use <code>cast</code></z><z id="t1553710719" t="souenzzo I think that datomic ions could provide a standard request-logger"><y>#</y><d>2019-03-27</d><h>18:18</h><w>souenzzo</w>I think that datomic ions could provide a standard <code>request-logger</code></z><z id="t1553710788" t="souenzzo can I open a issue for that? Maybe I&apos;ll do a PR tomorrow."><y>#</y><d>2019-03-27</d><h>18:19</h><w>souenzzo</w>can I open a issue for that? Maybe I&apos;ll do a PR tomorrow.</z><z id="t1553710881" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , I’m not following. Are you referring to the Pedestal.ions project?"><y>#</y><d>2019-03-27</d><h>18:21</h><w>ddeaguiar</w><a>@souenzzo</a>, I’m not following. Are you referring to the Pedestal.ions project?</z><z id="t1553710907" t="ddeaguiar If so, request logging can be done at the api gateway level"><y>#</y><d>2019-03-27</d><h>18:21</h><w>ddeaguiar</w>If so, request logging can be done at the api gateway level</z><z id="t1553710914" t="souenzzo I think that pedestal.ions could provide a standard request-logger "><y>#</y><d>2019-03-27</d><h>18:21</h><w>souenzzo</w>I think that <code>pedestal.ions</code> could provide a standard <code>request-logger</code> </z><z id="t1553710930" t="ddeaguiar So Ions only log ERROR"><y>#</y><d>2019-03-27</d><h>18:22</h><w>ddeaguiar</w>So Ions only log ERROR</z></g><g id="s15"><z id="t1553710934" t="ddeaguiar Datomic Ions"><y>#</y><d>2019-03-27</d><h>18:22</h><w>ddeaguiar</w>Datomic Ions</z><z id="t1553710939" t="souenzzo humm"><y>#</y><d>2019-03-27</d><h>18:22</h><w>souenzzo</w>humm</z><z id="t1553710940" t="souenzzo Ok"><y>#</y><d>2019-03-27</d><h>18:22</h><w>souenzzo</w>Ok</z><z id="t1553710942" t="ddeaguiar all other log levels are ignored"><y>#</y><d>2019-03-27</d><h>18:22</h><w>ddeaguiar</w>all other log levels are ignored</z><z id="t1553710954" t="ddeaguiar which is why you don’t see request logging"><y>#</y><d>2019-03-27</d><h>18:22</h><w>ddeaguiar</w>which is why you don’t see request logging</z><z id="t1553710959" t="souenzzo I will just do a error-handler"><y>#</y><d>2019-03-27</d><h>18:22</h><w>souenzzo</w>I will just do a error-handler</z><z id="t1553710970" t="ddeaguiar but you do have api gateway logs"><y>#</y><d>2019-03-27</d><h>18:22</h><w>ddeaguiar</w>but you do have api gateway logs</z><z id="t1553710981" t="ddeaguiar or you can cast"><y>#</y><d>2019-03-27</d><h>18:23</h><w>ddeaguiar</w>or you can cast</z><z id="t1553710999" t="ddeaguiar but I don’t think Pedestal.ions should use cast for such things"><y>#</y><d>2019-03-27</d><h>18:23</h><w>ddeaguiar</w>but I don’t think Pedestal.ions should use <code>cast</code> for such things</z><z id="t1553714389" t="souenzzo My lambda always returns 502 Wed Mar 27 19:17:50 UTC 2019 : Received response. Status: 200, Integration latency: 171 ms Wed Mar 27 19:17:50 UTC 2019 : Endpoint response headers: {Date=Wed, 27 Mar 2019 19:17:50 GMT, Content-Type=application/json, Content-Length=511, Connection=keep-alive, x-amzn-RequestId=xxxx-xxxx-xxxx-xxxx-xxx, x-amzn-Remapped-Content-Length=0, X-Amz-Executed-Version=$LATEST, X-Amzn-Trace-Id=root=1-xxxx-xxxx;sampled=0} Wed Mar 27 19:17:50 UTC 2019 : Endpoint response body before transformations: {&quot;body&quot;:&quot;ezpjb21taXQgbmlsfQ==&quot;,&quot;statusCode&quot;:200,&quot;headers&quot;:{&quot;X-Frame-Options&quot;:&quot;DENY&quot;,&quot;X-XSS-Protection&quot;:&quot;1; mode=block&quot;,&quot;X-Download-Options&quot;:&quot;noopen&quot;,&quot;Strict-Transport-Security&quot;:&quot;max-age=31536000; includeSubdomains&quot;,&quot;Set-Cookie&quot;:[&quot;ring-session=54747343-28c7-4e53-9441-2cb1d69b2e56;Path=\/;HttpOnly&quot;],&quot;X-Permitted-Cross-Domain-Policies&quot;:&quot;none&quot;,&quot;X-Content-Type-Options&quot;:&quot;nosniff&quot;,&quot;Content-Security-Policy&quot;:&quot;script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;&quot;,&quot;Content-Type&quot;:&quot;application\/edn&quot;},&quot;isBase64Encoded&quot;:true} Wed Mar 27 19:17:50 UTC 2019 : Execution failed due to configuration error: Malformed Lambda proxy response Wed Mar 27 19:17:50 UTC 2019 : Method completed with status: 502 "><y>#</y><d>2019-03-27</d><h>19:19</h><w>souenzzo</w>My lambda always returns 502
<pre>Wed Mar 27 19:17:50 UTC 2019 : Received response. Status: 200, Integration latency: 171 ms
Wed Mar 27 19:17:50 UTC 2019 : Endpoint response headers: {Date=Wed, 27 Mar 2019 19:17:50 GMT, Content-Type=application/json, Content-Length=511, Connection=keep-alive, x-amzn-RequestId=xxxx-xxxx-xxxx-xxxx-xxx, x-amzn-Remapped-Content-Length=0, X-Amz-Executed-Version=$LATEST, X-Amzn-Trace-Id=root=1-xxxx-xxxx;sampled=0}
Wed Mar 27 19:17:50 UTC 2019 : Endpoint response body before transformations: {&quot;body&quot;:&quot;ezpjb21taXQgbmlsfQ==&quot;,&quot;statusCode&quot;:200,&quot;headers&quot;:{&quot;X-Frame-Options&quot;:&quot;DENY&quot;,&quot;X-XSS-Protection&quot;:&quot;1; mode=block&quot;,&quot;X-Download-Options&quot;:&quot;noopen&quot;,&quot;Strict-Transport-Security&quot;:&quot;max-age=31536000; includeSubdomains&quot;,&quot;Set-Cookie&quot;:[&quot;ring-session=54747343-28c7-4e53-9441-2cb1d69b2e56;Path=\/;HttpOnly&quot;],&quot;X-Permitted-Cross-Domain-Policies&quot;:&quot;none&quot;,&quot;X-Content-Type-Options&quot;:&quot;nosniff&quot;,&quot;Content-Security-Policy&quot;:&quot;script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;&quot;,&quot;Content-Type&quot;:&quot;application\/edn&quot;},&quot;isBase64Encoded&quot;:true}
Wed Mar 27 19:17:50 UTC 2019 : Execution failed due to configuration error: Malformed Lambda proxy response
Wed Mar 27 19:17:50 UTC 2019 : Method completed with status: 502
</pre></z><z id="t1553714410" t="souenzzo I think that it&apos;s because of &quot;Set-Cookie&quot;:[&quot;ring-session=54747343-28c7-4e53-9441-2cb1d69b2e56;Path=\/;HttpOnly&quot;]"><y>#</y><d>2019-03-27</d><h>19:20</h><w>souenzzo</w>I think that it&apos;s because of <code>&quot;Set-Cookie&quot;:[&quot;ring-session=54747343-28c7-4e53-9441-2cb1d69b2e56;Path=\/;HttpOnly&quot;]</code></z><z id="t1553714459" t="souenzzo https://aws.amazon.com/premiumsupport/knowledge-center/malformed-502-api-gateway/"><y>#</y><d>2019-03-27</d><h>19:20</h><w>souenzzo</w><a href="https://aws.amazon.com/premiumsupport/knowledge-center/malformed-502-api-gateway/" target="_blank">https://aws.amazon.com/premiumsupport/knowledge-center/malformed-502-api-gateway/</a></z><z id="t1553714893" t="souenzzo root: https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L142"><y>#</y><d>2019-03-27</d><h>19:28</h><w>souenzzo</w>root: <a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L142" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/cookies.clj#L142</a></z><z id="t1553714968" t="souenzzo I will try to add one string/join &quot;;&quot; before :io.pedestal.http.ring-middlewares/session"><y>#</y><d>2019-03-27</d><h>19:29</h><w>souenzzo</w>I will try to add one string/join &quot;;&quot; before <code>:io.pedestal.http.ring-middlewares/session</code></z><z id="t1553717758" t="souenzzo Should I PR something like this? (def join-headers (io.pedestal.interceptor/interceptor {:name ::join-headers :leave (fn [{{:keys [headers]} :response :as ctx}] (if (map? headers) (assoc-in ctx [:response :headers] (into (empty headers) (map (fn [[k v]] [k (if (coll? v) (string/join &quot;;&quot; v) v)])) headers)) ctx))})) https://github.com/pedestal/pedestal.ions/blob/master/src/io/pedestal/ions.clj#L169"><y>#</y><d>2019-03-27</d><h>20:15</h><w>souenzzo</w>Should I PR something like this?
<pre>(def join-headers
  (io.pedestal.interceptor/interceptor {:name  ::join-headers
                                        :leave (fn [{{:keys [headers]} :response
                                                     :as               ctx}]
                                                 (if (map? headers)
                                                   (assoc-in ctx [:response :headers] (into (empty headers)
                                                                                            (map (fn [[k v]]
                                                                                                   [k (if (coll? v)
                                                                                                        (string/join &quot;;&quot; v)
                                                                                                        v)]))
                                                                                            headers))
                                                   ctx))}))

</pre>
<a href="https://github.com/pedestal/pedestal.ions/blob/master/src/io/pedestal/ions.clj#L169" target="_blank">https://github.com/pedestal/pedestal.ions/blob/master/src/io/pedestal/ions.clj#L169</a></z><z id="t1553718118" t="ddeaguiar Hmm yeah that looks like an issue. I can take a look at it in more detail on Friday. Can you create an issue with Pedestal.ions? You can also create a PR if you like as well."><y>#</y><d>2019-03-27</d><h>20:21</h><w>ddeaguiar</w>Hmm yeah that looks like an issue. I can take a look at it in more detail on Friday. Can you create an issue with Pedestal.ions? You can also create a PR if you like as well.</z><z id="t1553719189" t="souenzzo https://github.com/pedestal/pedestal.ions/issues/3"><y>#</y><d>2019-03-27</d><h>20:39</h><w>souenzzo</w><a href="https://github.com/pedestal/pedestal.ions/issues/3" target="_blank">https://github.com/pedestal/pedestal.ions/issues/3</a></z><z id="t1553719336" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] thanks a bunch for digging into this. I’ll look into it soon as well!"><y>#</y><d>2019-03-27</d><h>20:42</h><w>ddeaguiar</w><a>@souenzzo</a> thanks a bunch for digging into this. I’ll look into it soon as well!</z><z id="t1553736460" t="souenzzo https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L29 When I call some methods like this in my app, it returns nil . What it means?"><y>#</y><d>2019-03-28</d><h>01:27</h><w>souenzzo</w><a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L29" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L29</a>
When I call some methods like this in my app, it returns <code>nil</code>. What it means?</z><z id="t1553794399" t="souenzzo There is a bug with async interceptors in pedestal.ions. I will try to isolate"><y>#</y><d>2019-03-28</d><h>17:33</h><w>souenzzo</w>There is a bug with async interceptors in pedestal.ions. I will try to isolate</z><z id="t1553795982" t="souenzzo (let [routes #{[&quot;/sync&quot; :get {:name ::sync :enter (fn [ctx] (assoc ctx :response {:body &quot;sync&quot; :status 201}))}] [&quot;/async&quot; :get {:name ::async :enter (fn [ctx] (async/go (assoc ctx :response {:body &quot;async&quot; :status 202})))}]} h (-&gt; {::http/routes routes ::http/chain-provider provider/ion-provider} http/default-interceptors http/create-provider)] (h {:uri &quot;/sync&quot; ;:uri &quot;/async&quot; :request-method :get})) "><y>#</y><d>2019-03-28</d><h>17:59</h><w>souenzzo</w><pre>(let [routes #{[&quot;/sync&quot; :get {:name  ::sync
                              :enter (fn [ctx]
                                       (assoc ctx :response {:body   &quot;sync&quot;
                                                             :status 201}))}]
               [&quot;/async&quot; :get {:name  ::async
                               :enter (fn [ctx]
                                        (async/go
                                          (assoc ctx :response {:body   &quot;async&quot;
                                                                :status 202})))}]}
      h (-&gt; {::http/routes         routes
             ::http/chain-provider provider/ion-provider}
            http/default-interceptors
            http/create-provider)]
  (h {:uri            &quot;/sync&quot;
      ;:uri            &quot;/async&quot;
      :request-method :get}))
</pre></z><z id="t1553802099" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] going async is not supported at this time. Refer to https://github.com/pedestal/pedestal.ions#caveats"><y>#</y><d>2019-03-28</d><h>19:41</h><w>ddeaguiar</w><a>@souenzzo</a> going async is not supported at this time. Refer to <a href="https://github.com/pedestal/pedestal.ions#caveats" target="_blank">https://github.com/pedestal/pedestal.ions#caveats</a></z><z id="t1553804769" t="souenzzo it can throw a error? it was quite difficult to debug"><y>#</y><d>2019-03-28</d><h>20:26</h><w>souenzzo</w>it can throw a error? it was quite difficult to debug</z><z id="t1553807801" t="ddeaguiar Hmm, yes. I’ll look into that"><y>#</y><d>2019-03-28</d><h>21:16</h><w>ddeaguiar</w>Hmm, yes. I’ll look into that</z><z id="t1554226077" t="souenzzo pedestal.ions support websocket&apos;s? If not, it&apos;s a pedestal or a datomic-ions limitation?"><y>#</y><d>2019-04-02</d><h>17:27</h><w>souenzzo</w>pedestal.ions support websocket&apos;s?
If not, it&apos;s a pedestal or a datomic-ions limitation?</z><z id="t1554226416" t="ddeaguiar Pedestal supports websockets but, AFAIK, datomic-ions don’t"><y>#</y><d>2019-04-02</d><h>17:33</h><w>ddeaguiar</w>Pedestal supports websockets but, AFAIK, datomic-ions don’t</z><z id="t1554226468" t="ddeaguiar the ion lambda is a proxy for the service which is deployed to the datomic cluster"><y>#</y><d>2019-04-02</d><h>17:34</h><w>ddeaguiar</w>the ion lambda is a proxy for the service which is deployed to the datomic cluster</z><z id="t1554533537" t="ujjwalt Hi, I wanted to know about the state of pedestal ions interceptor chain provider. Is there a timeline on the going async caveat and what else is missing."><y>#</y><d>2019-04-06</d><h>06:52</h><w>ujjwalt</w>Hi, I wanted to know about the state of pedestal ions interceptor chain provider. Is there a timeline on the going async caveat and what else is missing.</z><z id="t1554533601" t="ujjwalt I think this is a very compelling use case for people like me doing Clojure and Datomic and using Ions as a way to continuously develop and deliver apps. I’m trying to build an API product and there is tremendous value for me in using Pedestal here for streamlining how the API functions."><y>#</y><d>2019-04-06</d><h>06:53</h><w>ujjwalt</w>I think this is a very compelling use case for people like me doing Clojure and Datomic and using Ions as a way to continuously develop and deliver apps. I’m trying to build an API product and there is tremendous value for me in using Pedestal here for streamlining how the API functions.</z><z id="t1554533631" t="ujjwalt But going async is an important step since we hit a lot of external resources to gather data."><y>#</y><d>2019-04-06</d><h>06:53</h><w>ujjwalt</w>But going async is an important step since we hit a lot of external resources to gather data.</z><z id="t1554534019" t="ujjwalt What would be recommended path to web app building with Datomic Ions if not pedestal then? Vase I believe will not work right?"><y>#</y><d>2019-04-06</d><h>07:00</h><w>ujjwalt</w>What would be recommended path to web app building with Datomic Ions if not pedestal then? Vase I believe will not work right?</z><z id="t1554534171" t="ujjwalt Actually Vase should be extensible to hook into an API gateway ion handler and take over as a microservice"><y>#</y><d>2019-04-06</d><h>07:02</h><w>ujjwalt</w>Actually Vase should be extensible to hook into an API gateway ion handler and take over as a microservice</z><z id="t1554543889" t="Jakub Holý (HolyJak) [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] we sockets with aws Lambda don&apos;t make sense. But there is solution, API Gateway manages the WS connection for you and you can push data to the client using POST to a magic url see https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] Same as 👆 I suspect async doesn&apos;t make sense with Lambda &lt;=&gt; Ions but couldn&apos;t WS solve your problem?"><y>#</y><d>2019-04-06</d><h>09:44</h><w>Jakub Holý (HolyJak)</w><a>@souenzzo</a> we sockets with aws Lambda don&apos;t make sense. But there is solution, API Gateway manages the WS connection for you and you can push data to the client using POST to a magic url see <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html</a>

<a>@ujjwalt</a> Same as <b>👆</b> I suspect async doesn&apos;t make sense with Lambda &lt;=&gt; Ions but couldn&apos;t WS solve your problem?</z><z id="t1554572264" t="ujjwalt I see but I need to provide a REST interface since that is my product."><y>#</y><d>2019-04-06</d><h>17:37</h><w>ujjwalt</w>I see but I need to provide a REST interface since that is my product.</z><z id="t1554572545" t="ujjwalt Also some of the guide and reference topics don’t have attached articles. Is that because the articles haven’t been linked or are yet to be written?"><y>#</y><d>2019-04-06</d><h>17:42</h><w>ujjwalt</w>Also some of the guide and reference topics don’t have attached articles. Is that because the articles haven’t been linked or are yet to be written?</z><z id="t1554572586" t="ujjwalt I’m asking because I’m planning to invest heavily in the Pedestal+Datomic stack for my API business"><y>#</y><d>2019-04-06</d><h>17:43</h><w>ujjwalt</w>I’m asking because I’m planning to invest heavily in the Pedestal+Datomic stack for my API business</z><z id="t1554572866" t="mtnygard [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] Consider those as invitations to contribute to the docs. 🙂"><y>#</y><d>2019-04-06</d><h>17:47</h><w>mtnygard</w><a>@ujjwalt</a> Consider those as invitations to contribute to the docs. <b>🙂</b></z><z id="t1554572940" t="mtnygard [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] The trouble with going async in Ions has to do with the way AWS handles Lambda invocations. Every Lambda call must have a timeout, after which the connection will be terminated no matter what we try to do inside the Ion."><y>#</y><d>2019-04-06</d><h>17:49</h><w>mtnygard</w><a>@ujjwalt</a> The trouble with going async in Ions has to do with the way AWS handles Lambda invocations. Every Lambda call must have a timeout, after which the connection will be terminated no matter what we try to do inside the Ion.</z><z id="t1554578605" t="ujjwalt [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] Sure once I actually understand Pedestal 🙂"><y>#</y><d>2019-04-06</d><h>19:23</h><w>ujjwalt</w><a>@mtnygard</a> Sure once I actually understand Pedestal <b>🙂</b></z><z id="t1554578630" t="ujjwalt In the mean time what would be my best bet at building a full fledged API with Datomic Ions."><y>#</y><d>2019-04-06</d><h>19:23</h><w>ujjwalt</w>In the mean time what would be my best bet at building a full fledged API with Datomic Ions.</z><z id="t1554578930" t="ujjwalt So if I’m not doing anything async then pedestal and ions work well together? Also does vase work with ions?"><y>#</y><d>2019-04-06</d><h>19:28</h><w>ujjwalt</w>So if I’m not doing anything async then pedestal and ions work well together? Also does vase work with ions?</z><z id="t1554578967" t="ujjwalt [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] BTW reading the guides right. Very well explained. You took the time to address every little detail even about topics you didn’t have to. Thanks a lot for that."><y>#</y><d>2019-04-06</d><h>19:29</h><w>ujjwalt</w><a>@mtnygard</a> BTW reading the guides right. Very well explained. You took the time to address every little detail even about topics you didn’t have to. Thanks a lot for that.</z><z id="t1554581353" t="mtnygard I think Vase will work with Ions, but I haven’t tried it myself. Maybe [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] has experimented?"><y>#</y><d>2019-04-06</d><h>20:09</h><w>mtnygard</w>I think Vase will work with Ions, but I haven’t tried it myself. Maybe <a>@ddeaguiar</a> has experimented?</z><z id="t1554666203" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] , [:attrs {:href &quot;/_/_/users/U06BLR1C6&quot;}] I’ve not experimented with Ions + Vase but, aside from not having released the Vase + Datomic Cloud bits, I see no reason why that wouldn’t work. Once we release Vase + Datomic Cloud support it is my intent to create a Vase + Datomic Ions sample. I don’t have a timeline just yet as project work has occupied my spare time lately."><y>#</y><d>2019-04-07</d><h>19:43</h><w>ddeaguiar</w><a>@ujjwalt</a>, <a>@mtnygard</a> I’ve not experimented with Ions + Vase but, aside from not  having released the Vase + Datomic Cloud bits, I see no reason why that wouldn’t work. Once we release Vase + Datomic Cloud support it is my intent to create a Vase + Datomic Ions sample. I don’t have a timeline just yet as project work has occupied my spare time lately.</z><z id="t1554666669" t="mtnygard [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] [:attrs {:href &quot;/_/_/users/U298MH0GN&quot;}] Well, the Vase + Cloud bits are available in source, so it would be fine to build a local snapshot."><y>#</y><d>2019-04-07</d><h>19:51</h><w>mtnygard</w><a>@ddeaguiar</a> <a>@ujjwalt</a> Well, the Vase + Cloud bits are available in source, so it would be fine to build a local snapshot.</z><z id="t1554666695" t="ddeaguiar yep"><y>#</y><d>2019-04-07</d><h>19:51</h><w>ddeaguiar</w>yep</z><z id="t1555000253" t="macrobartfast can anyone recommend a swagger integration for pedestal? I need to create a rest service with a swagger gui for front end devs."><y>#</y><d>2019-04-11</d><h>16:30</h><w>macrobartfast</w>can anyone recommend a swagger integration for pedestal? I need to create a rest service with a swagger gui for front end devs.</z><z id="t1555000381" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0X9N9ZK5&quot;}] are you already using pedestal or do you want to use pedestal for that? (i.e. would the rest service be a fresh project?)"><y>#</y><d>2019-04-11</d><h>16:33</h><w>martinklepsch</w><a>@macrobartfast</a> are you already using pedestal or do you want to use pedestal for that? (i.e. would the rest service be a fresh project?)</z><z id="t1555000464" t="macrobartfast well, I was using luminus, mainly because that&apos;s how I had learned to generate a rest backend with swagger... but I didn&apos;t actually need the website features of luminus, and I know pedestal is what I should be using for my services (better for microservices, etc)..."><y>#</y><d>2019-04-11</d><h>16:34</h><w>macrobartfast</w>well, I was using luminus, mainly because that&apos;s how I had learned to generate a rest backend with swagger... but I didn&apos;t actually need the website features of luminus, and I know pedestal is what I should be using for my services (better for microservices, etc)...</z><z id="t1555000486" t="macrobartfast but I&apos;m a bit challenged figuring out how to get the swagger ui going in pedestal."><y>#</y><d>2019-04-11</d><h>16:34</h><w>macrobartfast</w>but I&apos;m a bit challenged figuring out how to get the swagger ui going in pedestal.</z><z id="t1555000524" t="martinklepsch well there&apos;s this https://github.com/frankiesardo/route-swagger"><y>#</y><d>2019-04-11</d><h>16:35</h><w>martinklepsch</w>well there&apos;s this <a href="https://github.com/frankiesardo/route-swagger" target="_blank">https://github.com/frankiesardo/route-swagger</a></z><z id="t1555000541" t="martinklepsch but also consider #reitit where swagger is part of the package"><y>#</y><d>2019-04-11</d><h>16:35</h><w>martinklepsch</w>but also consider #reitit where swagger is part of the package</z><z id="t1555000567" t="martinklepsch it shares a lot of the conceptual ideas with pedetal (interceptors at the very least)"><y>#</y><d>2019-04-11</d><h>16:36</h><w>martinklepsch</w>it shares a lot of the conceptual ideas with pedetal (interceptors at the very least)</z><z id="t1555000584" t="macrobartfast it seems like reitit the popular thing now, so I may as well learn that approach."><y>#</y><d>2019-04-11</d><h>16:36</h><w>macrobartfast</w>it seems like reitit the popular thing now, so I may as well learn that approach.</z><z id="t1555000584" t="martinklepsch so depending on where you are in your project it might be worth considering"><y>#</y><d>2019-04-11</d><h>16:36</h><w>martinklepsch</w>so depending on where you are in your project it might be worth considering</z><z id="t1555000641" t="macrobartfast and of course, I&apos;m always worried about things with repos that were last updated several years ago... and I know that they may have not been updated because they &apos;are stable and don&apos;t need updating&apos;... but it&apos;s always a bit unnerving."><y>#</y><d>2019-04-11</d><h>16:37</h><w>macrobartfast</w>and of course, I&apos;m always worried about things with repos that were last updated several years ago... and I know that they may have not been updated because they &apos;are stable and don&apos;t need updating&apos;... but it&apos;s always a bit unnerving.</z><z id="t1555000676" t="martinklepsch pedestal is doing fine, I use it a lot and would happily pick it again"><y>#</y><d>2019-04-11</d><h>16:37</h><w>martinklepsch</w>pedestal is doing fine, I use it a lot and would happily pick it again</z><z id="t1555000696" t="martinklepsch just thought that because you have that swagger requirement it might be worth mentioning reitit"><y>#</y><d>2019-04-11</d><h>16:38</h><w>martinklepsch</w>just thought that because you have that swagger requirement it might be worth mentioning reitit</z><z id="t1555000726" t="macrobartfast ah, so #reitit is an alternative to pedestal?"><y>#</y><d>2019-04-11</d><h>16:38</h><w>macrobartfast</w>ah, so #reitit is an alternative to pedestal?</z><z id="t1555000743" t="macrobartfast I thought it was going to be part of pedestal or something."><y>#</y><d>2019-04-11</d><h>16:39</h><w>macrobartfast</w>I thought it was going to be part of pedestal or something.</z><z id="t1555000785" t="martinklepsch in Clojure stuff you generally shouldn&apos;t care about when stuff was updated last, if it works it&apos;s kind of going to work &quot;forever&quot; because Clojure is so stable. Literally the most breakage I&apos;ve seen without code changes has occurred due to changes in the JVM. 😄"><y>#</y><d>2019-04-11</d><h>16:39</h><w>martinklepsch</w>in Clojure stuff you generally shouldn&apos;t care about when stuff was updated last, if it works it&apos;s kind of going to work &quot;forever&quot; because Clojure is so stable. Literally the most breakage I&apos;ve seen without code changes has occurred due to changes in the JVM. <b>😄</b></z><z id="t1555000820" t="martinklepsch I think you can also combine the two but probably easier to just use one"><y>#</y><d>2019-04-11</d><h>16:40</h><w>martinklepsch</w>I think you can also combine the two but probably easier to just use one</z><z id="t1555000838" t="martinklepsch Also reitit is the default thing in the new Luminus so if you&apos;re familiar with that might be worth looking there for more info"><y>#</y><d>2019-04-11</d><h>16:40</h><w>martinklepsch</w>Also reitit is the default thing in the new Luminus so if you&apos;re familiar with that might be worth looking there for more info</z><z id="t1555000839" t="macrobartfast ah ok... so I&apos;ll go with frankiesardo/route-swagger and pedestal to dive into, on your recommendation."><y>#</y><d>2019-04-11</d><h>16:40</h><w>macrobartfast</w>ah ok... so I&apos;ll go with frankiesardo/route-swagger and pedestal to dive into, on your recommendation.</z><z id="t1555000874" t="martinklepsch not sure if Luminus has an &quot;API&quot; option that would generate some of that setup code for you"><y>#</y><d>2019-04-11</d><h>16:41</h><w>martinklepsch</w>not sure if Luminus has an &quot;API&quot; option that would generate some of that setup code for you</z><z id="t1555000919" t="macrobartfast I think I should go with pedestal over luminus in general, if only because it seems like a better thing to learn for enabling microservices to be able to talk to each other."><y>#</y><d>2019-04-11</d><h>16:41</h><w>macrobartfast</w>I think I should go with pedestal over luminus in general, if only because it seems like a better thing to learn for enabling microservices to be able to talk to each other.</z><z id="t1555001001" t="macrobartfast and that said I guess the luminus reitit would also possibly do that."><y>#</y><d>2019-04-11</d><h>16:43</h><w>macrobartfast</w>and that said I guess the luminus reitit would also possibly do that.</z><z id="t1555001093" t="macrobartfast it&apos;s just hard for folks like me to just get beyond figuring out which frameworks/libraries (I&apos;m not even sure what to call them) to use lol."><y>#</y><d>2019-04-11</d><h>16:44</h><w>macrobartfast</w>it&apos;s just hard for folks like me to just get beyond figuring out which frameworks/libraries (I&apos;m not even sure what to call them) to use lol.</z><z id="t1555001970" t="martinklepsch lein new luminus myapp +reitit +swagger +service I think I&apos;d recommend you to take a look at what this generates and see if it fits your need"><y>#</y><d>2019-04-11</d><h>16:59</h><r>martinklepsch</r><pre>lein new luminus myapp +reitit +swagger +service
</pre>

I think I&apos;d recommend you to take a look at what this generates and see if it fits your need</z><z id="t1555015360" t="macrobartfast ok... will do!"><y>#</y><d>2019-04-11</d><h>20:42</h><r>macrobartfast</r>ok... will do!</z><z id="t1555016237" t="macrobartfast that works perfectly."><y>#</y><d>2019-04-11</d><h>20:57</h><r>macrobartfast</r>that works perfectly.</z><z id="t1555016250" t="macrobartfast I will also learn the other options, for different use cases."><y>#</y><d>2019-04-11</d><h>20:57</h><r>macrobartfast</r>I will also learn the other options, for different use cases.</z><z id="t1555001911" t="martinklepsch yeah that can indeed be a bit tricky in the beginning"><y>#</y><d>2019-04-11</d><h>16:58</h><w>martinklepsch</w>yeah that can indeed be a bit tricky in the beginning</z><z id="t1555002734" t="ikitommi #reitit has first-class support for pedestal, here&apos;s a sample (with swagger): https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger"><y>#</y><d>2019-04-11</d><h>17:12</h><w>ikitommi</w>#reitit has first-class support for pedestal, here&apos;s a sample (with swagger): <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a></z><z id="t1555003233" t="ikitommi [:attrs {:href &quot;/_/_/users/U0X9N9ZK5&quot;}] In short: you swap the default pedestal router into reitit one (with a helper fn) and start using it. Besides swagger, it adds spec &amp; schema coercion, and lot of other things."><y>#</y><d>2019-04-11</d><h>17:20</h><w>ikitommi</w><a>@macrobartfast</a>  In short: you swap the default pedestal router into reitit one (with a helper fn) and start using it. Besides swagger, it adds spec &amp; schema coercion, and lot of other things.</z><z id="t1555003492" t="mtnygard [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] That&apos;s very cool."><y>#</y><d>2019-04-11</d><h>17:24</h><w>mtnygard</w><a>@ikitommi</a> That&apos;s very cool.</z><z id="t1555015557" t="macrobartfast awesome... trying all this now."><y>#</y><d>2019-04-11</d><h>20:45</h><w>macrobartfast</w>awesome... trying all this now.</z><z id="t1555271673" t="emccue I got lacinia-pedestal working with some hello world stuff"><y>#</y><d>2019-04-14</d><h>19:54</h><w>emccue</w>I got lacinia-pedestal working with some hello world stuff</z><z id="t1555271684" t="emccue but I really don&apos;t understand pedestal all that well"><y>#</y><d>2019-04-14</d><h>19:54</h><w>emccue</w>but I really don&apos;t understand pedestal all that well</z><z id="t1555271700" t="emccue so I don&apos;t know how to add routes outside of the graphql stuff"><y>#</y><d>2019-04-14</d><h>19:55</h><w>emccue</w>so I don&apos;t know how to add routes outside of the graphql stuff</z><z id="t1555271709" t="emccue (def service-map (lacinia/service-map #&apos;load-schema {:graphiql true}))"><y>#</y><d>2019-04-14</d><h>19:55</h><w>emccue</w><code>(def service-map (lacinia/service-map #&apos;load-schema {:graphiql true}))</code></z><z id="t1555272852" t="emccue I know its a very vauge question"><y>#</y><d>2019-04-14</d><h>20:14</h><w>emccue</w>I know its a very vauge question</z><z id="t1555272865" t="emccue but i am definitely missing some fundamental bits here"><y>#</y><d>2019-04-14</d><h>20:14</h><w>emccue</w>but i am definitely missing some fundamental bits here</z><z id="t1555291244" t="donaldball I’m doing this by calling graphql-routes instead of service-map , adding it to my other routes, and building my own pedestal service"><y>#</y><d>2019-04-15</d><h>01:20</h><w>donaldball</w>I’m doing this by calling <code>graphql-routes</code> instead of <code>service-map</code>, adding it to my other routes, and building my own pedestal service</z><z id="t1555291325" t="donaldball You could call service-map with a :routes arg that you build with graphql-routes yourself"><y>#</y><d>2019-04-15</d><h>01:22</h><w>donaldball</w>You could call <code>service-map</code> with a <code>:routes</code> arg that you build with <code>graphql-routes</code> yourself</z><z id="t1555323061" t="sooheon [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] mine looks like this: (def extra-routes #{[&quot;/tasks/update-articles&quot; :get update-articles :route-name :tasks/update-articles]}) (mount/defstate service :start (let [{profile :profile} (mount/args)] (-&gt; schema/footballpedia-schema (lp/service-map {:graphiql (not= :prod profile)}) (update ::http/routes set/union extra-routes) (assoc ::http/allowed-origins (if (= :prod profile) allowed-origins (constantly true))) (assoc ::http/host &quot;0.0.0.0&quot;) (assoc ::http/port 8080) http/create-server http/start)) :stop (http/stop service)) "><y>#</y><d>2019-04-15</d><h>10:11</h><w>sooheon</w><a>@emccue</a> mine looks like this:

<pre>(def extra-routes
  #{[&quot;/tasks/update-articles&quot; :get update-articles :route-name :tasks/update-articles]})


(mount/defstate service
  :start
  (let [{profile :profile} (mount/args)]
    (-&gt; schema/footballpedia-schema
        (lp/service-map {:graphiql (not= :prod profile)})
        (update ::http/routes set/union extra-routes)
        (assoc ::http/allowed-origins (if (= :prod profile)
                                        allowed-origins
                                        (constantly true)))
        (assoc ::http/host &quot;0.0.0.0&quot;)
        (assoc ::http/port 8080)
        http/create-server
        http/start))
  :stop (http/stop service))
</pre></z><z id="t1555416510" t="hmadelaine Hi everyone ! I am planning to use Pedestal and Component to start en new micro-service. I have done some research on the idiomatic way to bootstrap Pedestal with Component using the reloaded.repl flow. I found those libraries so far : https://github.com/ddeaguiar/component-pedestal https://github.com/grzm/component.pedestal But did not find any clear answer. Did I missed some articles ? Thank you very much"><y>#</y><d>2019-04-16</d><h>12:08</h><w>hmadelaine</w>Hi everyone !
I am planning to use Pedestal and Component to start en new micro-service.
I have done some research on the idiomatic way to bootstrap Pedestal with Component using the reloaded.repl flow.
I found those libraries so far :
<a href="https://github.com/ddeaguiar/component-pedestal" target="_blank">https://github.com/ddeaguiar/component-pedestal</a>
<a href="https://github.com/grzm/component.pedestal" target="_blank">https://github.com/grzm/component.pedestal</a>
But did not find any clear answer.
Did I missed some articles ?
Thank you very much</z><z id="t1555429513" t="donaldball I’m not sure I’m answering your question exactly, but I use component and pedestal and have been happiest using a :router component that builds its pedestal :routes dynamically, closing over any other stateful components; and a :jetty component that’s responsible for the jetty http/s service."><y>#</y><d>2019-04-16</d><h>15:45</h><r>donaldball</r>I’m not sure I’m answering your question exactly, but I use component and pedestal and have been happiest using a <code>:router</code> component that builds its pedestal <code>:routes</code> dynamically, closing over any other stateful components; and a <code>:jetty</code> component that’s responsible for the jetty http/s service.</z><z id="t1555439771" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U0508R629&quot;}] , glad to see that you’ll be using Pedestal. I authored ddeaguiar/component-pedestal and co-authored pointslope elements ( https://github.com/pointslope/elements ). I’ve not formally released the former and the later has not been updated in a while. As I’ve worked through various iterations of applications based on component and pedestal, I’ve become less inclined to mix the two."><y>#</y><d>2019-04-16</d><h>18:36</h><r>ddeaguiar</r>Hi <a>@U0508R629</a>, glad to see that you’ll be using Pedestal. I authored ddeaguiar/component-pedestal and co-authored pointslope elements (<a href="https://github.com/pointslope/elements" target="_blank">https://github.com/pointslope/elements</a>). I’ve not formally released the former and the later has not been updated in a while. As I’ve worked through various iterations of applications based on component and pedestal, I’ve become less inclined to mix the two.</z><z id="t1555439789" t="ddeaguiar Let me explain"><y>#</y><d>2019-04-16</d><h>18:36</h><r>ddeaguiar</r>Let me explain</z><z id="t1555439833" t="ddeaguiar Pedestal already provides a service representation that is extensible - the service map. You can assoc whatever you like to it and use that info during service initialization"><y>#</y><d>2019-04-16</d><h>18:37</h><r>ddeaguiar</r>Pedestal already provides a service representation that is extensible - the service map. You can assoc whatever you  like to it and use that info during service initialization</z><z id="t1555439882" t="ddeaguiar Start/stop entry points are pretty clear. Pedestal’s extension point is also very clear - the interceptor."><y>#</y><d>2019-04-16</d><h>18:38</h><r>ddeaguiar</r>Start/stop entry points are pretty clear. Pedestal’s extension point is also very clear - the interceptor.</z><z id="t1555439907" t="ddeaguiar All you need to do is create interceptors that make the dependency you are interested available in the context/request"><y>#</y><d>2019-04-16</d><h>18:38</h><r>ddeaguiar</r>All you need to do is create interceptors that make the dependency you are interested available in the context/request</z><z id="t1555439911" t="ddeaguiar You don’t need component for that"><y>#</y><d>2019-04-16</d><h>18:38</h><r>ddeaguiar</r>You don’t need component for that</z><z id="t1555439967" t="ddeaguiar I found that all the machinery I built around this for component basically involved how to create such interceptors and where should such code exist in a project"><y>#</y><d>2019-04-16</d><h>18:39</h><r>ddeaguiar</r>I found that all the machinery I built around this for component basically involved how to create such interceptors and where should such code exist in a project</z><z id="t1555440019" t="ddeaguiar I don’t feel it adds much value."><y>#</y><d>2019-04-16</d><h>18:40</h><r>ddeaguiar</r>I don’t feel it adds much value.</z><z id="t1555445267" t="hmadelaine [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you very much for your answer. I am not a pedestal expert so I stick to the tools I am comfortable with. I will dig deeper to understand the true philosophy of pedestal :-)"><y>#</y><d>2019-04-16</d><h>20:07</h><r>hmadelaine</r><a>@ddeaguiar</a> thank you very much for your answer. I am not a pedestal expert so I stick to the tools I am comfortable with. I will dig deeper to understand the true philosophy of pedestal :-)</z><z id="t1555432256" t="manandearth How would you add params for testing a route with response-for ? or a different way to test request maps?"><y>#</y><d>2019-04-16</d><h>16:30</h><w>manandearth</w>How would you add params for testing a route with <code>response-for</code>? or a different way to test request maps?</z><z id="t1555432409" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBGH0Q0H4&quot;}] http://pedestal.io/reference/unit-testing should clarify this. If not, let me know so I can update it."><y>#</y><d>2019-04-16</d><h>16:33</h><w>ddeaguiar</w><a>@adamgefen</a> <a href="http://pedestal.io/reference/unit-testing" target="_blank">http://pedestal.io/reference/unit-testing</a> should clarify this. If not, let me know so I can update it.</z><z id="t1555432498" t="manandearth perfect! [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] , I overlooked it."><y>#</y><d>2019-04-16</d><h>16:34</h><w>manandearth</w>perfect! <a>@ddeaguiar</a>, I overlooked it.</z><z id="t1555432505" t="ddeaguiar np!"><y>#</y><d>2019-04-16</d><h>16:35</h><w>ddeaguiar</w>np!</z><z id="t1555440630" t="manandearth ....and how would you inject a session for testing session authentication :session {:identity {:username foo}} ?"><y>#</y><d>2019-04-16</d><h>18:50</h><w>manandearth</w>....and how would you inject a session for testing session authentication <code>:session {:identity {:username foo}}</code>?</z><z id="t1555440793" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBGH0Q0H4&quot;}] how is authentication wired into your service now?"><y>#</y><d>2019-04-16</d><h>18:53</h><w>ddeaguiar</w><a>@adamgefen</a> how is authentication wired into your service now?</z><z id="t1555440879" t="manandearth buddy session"><y>#</y><d>2019-04-16</d><h>18:54</h><w>manandearth</w>buddy session</z><z id="t1555440970" t="ddeaguiar basically you want to use a stub auth store, right?"><y>#</y><d>2019-04-16</d><h>18:56</h><w>ddeaguiar</w>basically you want to use a stub auth store, right?</z><z id="t1555440992" t="manandearth yes"><y>#</y><d>2019-04-16</d><h>18:56</h><w>manandearth</w>yes</z><z id="t1555441154" t="ddeaguiar What is your auth store? A db? How is that wired in?"><y>#</y><d>2019-04-16</d><h>18:59</h><w>ddeaguiar</w>What is your auth store? A db? How is that wired in?</z><z id="t1555441180" t="ddeaguiar because you can stub that on service initialization"><y>#</y><d>2019-04-16</d><h>18:59</h><w>ddeaguiar</w>because you can stub that on service initialization</z><z id="t1555441315" t="manandearth it is a table in a postgresql, the project is component with a pedestal component and a postgres component (juxt.modular)"><y>#</y><d>2019-04-16</d><h>19:01</h><w>manandearth</w>it is a table in a postgresql, the project is component with a pedestal component and a postgres component (juxt.modular)</z><z id="t1555441345" t="ddeaguiar So the db is assoc’d to context by an interceptor?"><y>#</y><d>2019-04-16</d><h>19:02</h><w>ddeaguiar</w>So the db is assoc’d to context by an interceptor?</z><z id="t1555441363" t="ddeaguiar use a fake store in your system to return what you want"><y>#</y><d>2019-04-16</d><h>19:02</h><w>ddeaguiar</w>use a fake store in your system to return what you want</z><z id="t1555441411" t="manandearth Yes you are right. I don&apos;t need to test the db connection."><y>#</y><d>2019-04-16</d><h>19:03</h><w>manandearth</w>Yes you are right. I don&apos;t need to test the db connection.</z><z id="t1555441478" t="ddeaguiar in regards to injecting session, need to think on that part"><y>#</y><d>2019-04-16</d><h>19:04</h><w>ddeaguiar</w>in regards to injecting session, need to think on that part</z><z id="t1555441499" t="ddeaguiar ideally you wouldn’t have to first ‘log in’ then run tests"><y>#</y><d>2019-04-16</d><h>19:04</h><w>ddeaguiar</w>ideally you wouldn’t have to first ‘log in’ then run tests</z><z id="t1555441521" t="ddeaguiar better to have system set up in ‘logged in state’, I think anyway"><y>#</y><d>2019-04-16</d><h>19:05</h><w>ddeaguiar</w>better to have system set up in ‘logged in state’, I think anyway</z><z id="t1555441563" t="manandearth I see."><y>#</y><d>2019-04-16</d><h>19:06</h><w>manandearth</w>I see.</z><z id="t1555441574" t="ddeaguiar maybe I’m making it too complicated"><y>#</y><d>2019-04-16</d><h>19:06</h><w>ddeaguiar</w>maybe I’m making it too complicated</z><z id="t1555441601" t="ddeaguiar Perhaps can pass in cookie with identity info, exercise stub auth and test what you want"><y>#</y><d>2019-04-16</d><h>19:06</h><w>ddeaguiar</w>Perhaps can pass in cookie with identity info, exercise stub auth and test what you want</z><z id="t1555441607" t="ddeaguiar it’s just a header"><y>#</y><d>2019-04-16</d><h>19:06</h><w>ddeaguiar</w>it’s just a header</z><z id="t1555441644" t="manandearth Yes . I just need a way that it can be passed as a header."><y>#</y><d>2019-04-16</d><h>19:07</h><w>manandearth</w>Yes . I just need a way that it can be passed as a header.</z><z id="t1555441716" t="ddeaguiar headers can be passed via response-for"><y>#</y><d>2019-04-16</d><h>19:08</h><w>ddeaguiar</w>headers can be passed via response-for</z><z id="t1555441739" t="manandearth But it can&apos;t be just the session map, can it?"><y>#</y><d>2019-04-16</d><h>19:08</h><w>manandearth</w>But it can&apos;t be just the session map, can it?</z><z id="t1555441790" t="ddeaguiar hmm, don’t recall"><y>#</y><d>2019-04-16</d><h>19:09</h><w>ddeaguiar</w>hmm, don’t recall</z><z id="t1555441795" t="ddeaguiar try 🙂"><y>#</y><d>2019-04-16</d><h>19:09</h><w>ddeaguiar</w>try <b>🙂</b></z><z id="t1555441812" t="manandearth thanks! 😄"><y>#</y><d>2019-04-16</d><h>19:10</h><w>manandearth</w>thanks! <b>😄</b></z><z id="t1555461466" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBGH0Q0H4&quot;}] here’s an example of testing with a stub session store https://gist.github.com/ddeaguiar/defa8b2634c35cdf4db2ca626637db2f"><y>#</y><d>2019-04-17</d><h>00:37</h><w>ddeaguiar</w><a>@adamgefen</a> here’s an example of testing with a stub session store <a href="https://gist.github.com/ddeaguiar/defa8b2634c35cdf4db2ca626637db2f" target="_blank">https://gist.github.com/ddeaguiar/defa8b2634c35cdf4db2ca626637db2f</a></z><z id="t1555461488" t="ddeaguiar I’ll look into updating the docs soon"><y>#</y><d>2019-04-17</d><h>00:38</h><w>ddeaguiar</w>I’ll look into updating the docs soon</z><z id="t1555574920" t="olle Hi I&apos;m trying to serve a static js using ::http/resource-path &quot;public&quot; in the service map but I get an csp error Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src self&quot;. Note that &apos;script-src-elem&apos; was not explicitly set, so &apos;script-src&apos; is used as a fallback. ."><y>#</y><d>2019-04-18</d><h>08:08</h><w>olle</w>Hi I&apos;m trying to serve a static js using <pre>::http/resource-path   &quot;public&quot;</pre> in the service map but I get an csp error <pre>Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src self&quot;. Note that &apos;script-src-elem&apos; was not explicitly set, so &apos;script-src&apos; is used as a fallback.</pre>.</z><z id="t1555574967" t="olle Any tips 🙂"><y>#</y><d>2019-04-18</d><h>08:09</h><w>olle</w>Any tips <b>🙂</b></z><z id="t1555576224" t="Ivan It seems to me you have to configure CSP for your use case"><y>#</y><d>2019-04-18</d><h>08:30</h><w>Ivan</w>It seems to me you have to configure CSP for your use case</z><z id="t1555576232" t="Ivan https://github.com/pedestal/pedestal/issues/499"><y>#</y><d>2019-04-18</d><h>08:30</h><w>Ivan</w><a href="https://github.com/pedestal/pedestal/issues/499" target="_blank">https://github.com/pedestal/pedestal/issues/499</a></z><z id="t1555579666" t="olle Tnx yes I managed to solve it by adding ::http/secure-headers {:content-security-policy-settings {:script-src &quot;https://*.}} to my service map."><y>#</y><d>2019-04-18</d><h>09:27</h><w>olle</w>Tnx yes I managed to solve it by adding <pre>::http/secure-headers {:content-security-policy-settings {:script-src &quot;https://*.}}</pre> to my service map.</z><z id="t1555986790" t="v3ga What’s a good way to visualize interceptors in general? I’m looking for a common analogy that even a non-tech person may understand."><y>#</y><d>2019-04-23</d><h>02:33</h><w>v3ga</w>What’s a good way to visualize interceptors in general? I’m looking for a common analogy that even a non-tech person may understand.</z><z id="t1556024635" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] , perhaps this document will clear things up? http://pedestal.io/reference/interceptors"><y>#</y><d>2019-04-23</d><h>13:03</h><w>ddeaguiar</w><a>@decim</a>, perhaps this document will clear things up? <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1556027988" t="pfeodrippe Hi, is there any example using InputStream at response body? I want to support streaming from it and I&apos;m using a PipedOutputStream connected to a PipedInputStream, but it&apos;s sending everything only after everything processed. I&apos;m using future to handle what I have to process, some ideas?"><y>#</y><d>2019-04-23</d><h>13:59</h><w>pfeodrippe</w>Hi, is there any example using InputStream at response body? I want to support streaming from it and I&apos;m using a PipedOutputStream connected to a PipedInputStream, but it&apos;s sending everything only after everything processed. I&apos;m using future to handle what I have to process, some ideas?</z><z id="t1556028879" t="souenzzo {:body (io/input-stream (.getBytes &quot;foo&quot;)) :status 200} works."><y>#</y><d>2019-04-23</d><h>14:14</h><w>souenzzo</w><code>{:body    (io/input-stream (.getBytes &quot;foo&quot;)) :status 200}</code> works.</z><z id="t1556029078" t="pfeodrippe Yes, but I want to write to the client while processing, not only when it ends, so the client does not have to wait all the processing"><y>#</y><d>2019-04-23</d><h>14:17</h><w>pfeodrippe</w>Yes, but I want to write to the client while processing, not only when it ends, so the client does not have to wait all the processing</z><z id="t1556030913" t="v3ga [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yeah the guide is fine, I was just trying to think of other ways to describe it so even someone thats not a programmer can understand, for my notes"><y>#</y><d>2019-04-23</d><h>14:48</h><w>v3ga</w><a>@ddeaguiar</a> yeah the guide is fine, I was just trying to think of other ways to describe it so even someone thats not a programmer can understand, for my notes</z><z id="t1556034075" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5R6XUARE&quot;}] can you elaborate on your use case?"><y>#</y><d>2019-04-23</d><h>15:41</h><w>ddeaguiar</w><a>@pfeodrippe</a> can you elaborate on your use case?</z><z id="t1556035947" t="pfeodrippe [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I&apos;ll write a simplified code (def streamed-interceptor (interceptor {:name ::interceptor :enter (fn [context] (let [pout (PipedOutputStream.) pin (PipedInputStream. pout)] (future (with-open [pout pout] (doseq [_ (range 10)] (Thread/sleep 1000) (.write pout (.getBytes &quot;Eita\n&quot;) 0 (count &quot;Eita\n&quot;)) (.flush pout)))) (assoc context :response {:status 200 :body pin})))})) "><y>#</y><d>2019-04-23</d><h>16:12</h><w>pfeodrippe</w><a>@ddeaguiar</a> I&apos;ll write a simplified code
<pre>(def streamed-interceptor
  (interceptor
   {:name ::interceptor
    :enter
    (fn [context]
      (let [pout (PipedOutputStream.)
            pin (PipedInputStream. pout)]
        (future
          (with-open [pout pout]
            (doseq [_ (range 10)]
              (Thread/sleep 1000)
              (.write pout
                      (.getBytes &quot;Eita\n&quot;)
                      0 (count &quot;Eita\n&quot;))
              (.flush pout))))
        (assoc context
               :response {:status 200
                          :body pin})))}))
</pre></z><z id="t1556038800" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5R6XUARE&quot;}] to clarify, why do you need an input stream?"><y>#</y><d>2019-04-23</d><h>17:00</h><r>ddeaguiar</r><a>@pfeodrippe</a> to clarify, why do you need an input stream?</z><z id="t1556049221" t="pfeodrippe Sorry, just saw it now, I have a function where I&apos;m making requests to other endpoints and I want to notify the client right after the processing of 1 endpoint (of N)"><y>#</y><d>2019-04-23</d><h>19:53</h><r>pfeodrippe</r>Sorry, just saw it now, I have a function where I&apos;m making  requests to other endpoints and I want to notify the client right after the processing of 1 endpoint (of N)</z><z id="t1556049256" t="pfeodrippe So the client does not have to wait until the end of the request to get all the responses"><y>#</y><d>2019-04-23</d><h>19:54</h><r>pfeodrippe</r>So the client does not have to wait until the end of the request to get all the responses</z><z id="t1556049276" t="pfeodrippe If it&apos;s not clear, I can try to explain again 😃"><y>#</y><d>2019-04-23</d><h>19:54</h><r>pfeodrippe</r>If it&apos;s not clear, I can try to explain again <b>😃</b></z><z id="t1556036096" t="pfeodrippe Based on this code, I&apos;d like to see a new line with &quot;Eita&quot; each second"><y>#</y><d>2019-04-23</d><h>16:14</h><w>pfeodrippe</w>Based on this code, I&apos;d like to see a new line with &quot;Eita&quot; each second</z><z id="t1556036264" t="pfeodrippe I&apos;ve tested with a lot of data and it was streaming each 32768 bytes... I&apos;m now looking for a way to reduce this buffer size for the streaming response, any idea [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] ?"><y>#</y><d>2019-04-23</d><h>16:17</h><w>pfeodrippe</w>I&apos;ve tested with a lot of data and it was streaming each 32768 bytes... I&apos;m now looking for a way to reduce this buffer size for the streaming response, any idea <a>@ddeaguiar</a>?</z><z id="t1556041792" t="donaldball The docs say you can use a core.async channel for your response body to get the effect you want: http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response"><y>#</y><d>2019-04-23</d><h>17:49</h><r>donaldball</r>The docs say you can use a core.async channel for your response body to get the effect you want: <a href="http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response" target="_blank">http://pedestal.io/reference/streaming#_using_a_core_async_channel_as_the_response</a></z><z id="t1556041814" t="donaldball I have never used this mechanism though."><y>#</y><d>2019-04-23</d><h>17:50</h><r>donaldball</r>I have never used this mechanism though.</z><z id="t1556049755" t="pfeodrippe Yes, I have saw this, but we prefer more controlled threads instead of go blocks"><y>#</y><d>2019-04-23</d><h>20:02</h><r>pfeodrippe</r>Yes, I have saw this, but we prefer more controlled threads instead of go blocks</z><z id="t1556073016" t="donaldball You don’t have to use go blocks to return a channel of course, you can use the double bang fns and your own threads."><y>#</y><d>2019-04-24</d><h>02:30</h><r>donaldball</r>You don’t have to use go blocks to return a channel of course, you can use the double bang fns and your own threads.</z><z id="t1556124687" t="pfeodrippe Great o/"><y>#</y><d>2019-04-24</d><h>16:51</h><r>pfeodrippe</r>Great o/</z><z id="t1556037806" t="Braden Shepherdson I&apos;ve seen one metaphor: passing through a succession of gates or checkpoints, maybe for a flight."><y>#</y><d>2019-04-23</d><h>16:43</h><w>Braden Shepherdson</w>I&apos;ve seen one metaphor: passing through a succession of gates or checkpoints, maybe for a flight.</z><z id="t1556037816" t="Braden Shepherdson some of the tasks are one-sided, others double-sided."><y>#</y><d>2019-04-23</d><h>16:43</h><w>Braden Shepherdson</w>some of the tasks are one-sided, others double-sided.</z><z id="t1556037900" t="Braden Shepherdson eg. you check-in (`:enter` only), drop your bag (`:enter` of a double-sided one), go through security (`:enter` only), fly (the real handler), clear customs (`:leave` only), get your bag (`:leave` of the bag-handling interceptor) and done."><y>#</y><d>2019-04-23</d><h>16:45</h><w>Braden Shepherdson</w>eg. you check-in (`:enter` only), drop your bag (`:enter` of a double-sided one), go through security (`:enter` only), fly (the real handler), clear customs (`:leave` only), get your bag (`:leave` of the bag-handling interceptor) and done.</z><z id="t1556037943" t="Braden Shepherdson actually, an even better metaphor there: the check-in process gives you a token (your boarding pass) that you show to several successive checkpoints (bag drop, security, at the gate)"><y>#</y><d>2019-04-23</d><h>16:45</h><w>Braden Shepherdson</w>actually, an even better metaphor there: the check-in process gives you a token (your boarding pass) that you show to several successive checkpoints (bag drop, security, at the gate)</z><z id="t1556185651" t="v3ga [:attrs {:href &quot;/_/_/users/UCY0GT0QM&quot;}] yes now that really works. Thanks"><y>#</y><d>2019-04-25</d><h>09:47</h><w>v3ga</w><a>@braden.shepherdson</a> yes now that really works.  Thanks</z><z id="t1556641538" t="souenzzo Can I/Should I use ELB &gt; exported pedestal-ions ? Or it should be always APIGateway &gt; exported pedestal-ions ?"><y>#</y><d>2019-04-30</d><h>16:25</h><w>souenzzo</w>Can I/Should I use <code>ELB &gt; exported pedestal-ions</code>? Or it should be always <code>APIGateway &gt;  exported pedestal-ions</code> ?</z><z id="t1556645739" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] pedestal.ion leverages the request map produced by Datomic Ions’ datomic.ion.lambda.api-gateway/ionize impl. You can create an ion that consumes events from any event source but it’s up to you to implement the relevant handler."><y>#</y><d>2019-04-30</d><h>17:35</h><w>ddeaguiar</w><a>@souenzzo</a> pedestal.ion leverages the request map produced by Datomic Ions’ <code>datomic.ion.lambda.api-gateway/ionize</code> impl. You can create an ion that consumes events from any event source but it’s up to you to implement the relevant handler.</z><z id="t1557175992" t="jackson Howdy all, is there documentation somewhere, or an example, of running pedestal with https on Jetty or is that a Jetty config thing?"><y>#</y><d>2019-05-06</d><h>20:53</h><w>jackson</w>Howdy all, is there documentation somewhere, or an example, of running pedestal with https on Jetty or is that a Jetty config thing?</z><z id="t1557176462" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/UJ64540VC&quot;}] , the documentation is lagging behind on that topic but you’ll be able to configure ssl support via the service map. If you create a service using the pedestal-service lein template, you’ll see the ::http/container-options that you can specify https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/service.clj#L72-L78"><y>#</y><d>2019-05-06</d><h>21:01</h><w>ddeaguiar</w>Hi <a>@jackson.reynolds</a>, the documentation is lagging behind on that topic but you’ll be able to configure ssl support via the service map. If you create a service using the <code>pedestal-service</code> lein template, you’ll see the <code>::http/container-options</code> that you can specify <a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/service.clj#L72-L78" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/service.clj#L72-L78</a></z><z id="t1557176579" t="jackson [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] perfect, thanks!"><y>#</y><d>2019-05-06</d><h>21:02</h><w>jackson</w><a>@ddeaguiar</a> perfect, thanks!</z><z id="t1557176603" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-05-06</d><h>21:03</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1557254755" t="jackson Is there an idiomatic way to preserve cookies between test/response-for calls for things like csrf tokens?"><y>#</y><d>2019-05-07</d><h>18:45</h><w>jackson</w>Is there an idiomatic way to preserve cookies between test/response-for calls for things like csrf tokens?</z><z id="t1557262181" t="donaldball I fire up a pedestal jetty instance and use clj-http with a cookie-store when I have such needs"><y>#</y><d>2019-05-07</d><h>20:49</h><w>donaldball</w>I fire up a pedestal jetty instance and use <code>clj-http</code> with a cookie-store when I have such needs</z><z id="t1557445288" t="wei how do you serve static resources with pedestal?"><y>#</y><d>2019-05-09</d><h>23:41</h><w>wei</w>how do you serve static resources with pedestal?</z><z id="t1557449854" t="souenzzo [:attrs {:href &quot;/_/_/users/U066TMAKS&quot;}] ::http/file-path &quot;target/public&quot; &lt;&lt; files not in your classpath ::http/resource-path &quot;public&quot; &lt;&lt; files in your classpath ::http/mime-types mime/default-mime-types &lt;&lt; useful (require &apos;[ring.util.mime-type :as mime])"><y>#</y><d>2019-05-10</d><h>00:57</h><w>souenzzo</w><a>@wei</a>
<code>::http/file-path &quot;target/public&quot;</code> &lt;&lt; files not in your classpath
<code>::http/resource-path &quot;public&quot;</code> &lt;&lt; files in your classpath
<code>::http/mime-types mime/default-mime-types</code> &lt;&lt; useful <code>(require &apos;[ring.util.mime-type :as mime])</code></z><z id="t1557474038" t="wei [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] thanks! and how does that file path get associated with a URL route to serve it? sorry, fairly new to pedestal"><y>#</y><d>2019-05-10</d><h>07:40</h><w>wei</w><a>@souenzzo</a> thanks! and how does that file path get associated with a URL route to serve it? sorry, fairly new to pedestal</z><z id="t1557474443" t="wei or alternatively, if there&apos;s a link to a complete example that&apos;d be great"><y>#</y><d>2019-05-10</d><h>07:47</h><w>wei</w>or alternatively, if there&apos;s a link to a complete example that&apos;d be great</z><z id="t1557494340" t="souenzzo Using ::http/resource-path &quot;public&quot; with :paths [&quot;src&quot; &quot;resources&quot;] (in deps.edn) or :resource-path [&quot;resources&quot;] (in project.clj) resources/public/app.html will be available in :8080/app.html I think that it first try to find a file, then try to find a route in your router."><y>#</y><d>2019-05-10</d><h>13:19</h><w>souenzzo</w>Using <code>::http/resource-path &quot;public&quot;</code> with <code>:paths [&quot;src&quot; &quot;resources&quot;]</code> (in deps.edn) or <code>:resource-path [&quot;resources&quot;]</code> (in project.clj)
<code>resources/public/app.html</code> will be available in <code>:8080/app.html</code>
I think that it first try to find a file, then try to find a route in your router.</z><z id="t1557494964" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] is correct (thanks!), here are some more details. When default interceptors are added, if the ::http/resource-path is present in the service map, then an interceptor wrapping the ring resource middleware is conj’d onto the interceptor chain. This interceptor executes it’s :enter impl prior to routing."><y>#</y><d>2019-05-10</d><h>13:29</h><w>ddeaguiar</w><a>@souenzzo</a> is correct (thanks!), here are some more details. When default interceptors are added, if the <code>::http/resource-path</code> is present in the service map, then an interceptor wrapping the ring <code>resource</code> middleware is conj’d onto the interceptor chain. This interceptor executes it’s <code>:enter</code> impl prior to routing.</z><z id="t1557506641" t="jmv hi all, i&apos;ve been playing around with vase and i&apos;m wondering if there&apos;s a way for the pedestal service to reload the configuration if i change a dynamic interceptor in the fern file. e.g., i realize there is an error with my query and i want to fix it. can i do that and have the change take effect without having to stop and start vase?"><y>#</y><d>2019-05-10</d><h>16:44</h><w>jmv</w>hi all, i&apos;ve been playing around with vase and i&apos;m wondering if there&apos;s a way for the pedestal service to reload the configuration if i change a dynamic interceptor in the fern file. e.g., i realize there is an error with my query and i want to fix it. can i do that and have the change take effect without having to stop and start vase?</z><z id="t1557508178" t="asilverman #pedestal , Hi everyone. I tried to bump the version of io.pedestal/pedestal.service in my project from 0.5.3 -&gt; 0.5.4 and my service stops responding to requests on the SSL port. Anyone has any clues what could be causing this?"><y>#</y><d>2019-05-10</d><h>17:09</h><w>asilverman</w>#pedestal , Hi everyone. I tried to bump the version of <code>io.pedestal/pedestal.service</code> in my project from 0.5.3 -&gt; 0.5.4 and my service stops responding to requests on the SSL port. Anyone has any clues what could be causing this?</z><z id="t1557508784" t="donaldball yes, I believe it was that version that introduced a new behavior whereby the ssl port listener also now binds to an explicit ip address"><y>#</y><d>2019-05-10</d><h>17:19</h><r>donaldball</r>yes, I believe it was that version that introduced a new behavior whereby the ssl port listener also now binds to an explicit ip address</z><z id="t1557508899" t="donaldball Yeah, it’s called out here as a breaking change: https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018"><y>#</y><d>2019-05-10</d><h>17:21</h><r>donaldball</r>Yeah, it’s called out here as a breaking change: <a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018</a></z><z id="t1557509732" t="asilverman What should I set the :: http/port value to?"><y>#</y><d>2019-05-10</d><h>17:35</h><r>asilverman</r>What should I set the <b>::</b>http/port value to?</z><z id="t1557519508" t="asilverman hey, I actually hadn’t configured the :: http/host, once I set it to 0.0.0.0 things got going again. Thanks for the help"><y>#</y><d>2019-05-10</d><h>20:18</h><r>asilverman</r>hey, I actually hadn’t configured the <b>::</b>http/host, once I set it to 0.0.0.0 things got going again. Thanks for the help</z><z id="t1557519508" t="asilverman hey, I actually hadn’t configured the :: http/host, once I set it to 0.0.0.0 things got going again. Thanks for the help"><y>#</y><d>2019-05-10</d><h>20:18</h><w>asilverman</w>hey, I actually hadn’t configured the <b>::</b>http/host, once I set it to 0.0.0.0 things got going again. Thanks for the help</z><z id="t1557772337" t="asilverman #pedestal - hey team, has anyone experimented with clojure spec on the http headers and pedestal? I’m looking to verify specific headers were set in the request. Any help is welcome!"><y>#</y><d>2019-05-13</d><h>18:32</h><w>asilverman</w>#pedestal - hey team, has anyone experimented with clojure spec on the http headers and pedestal? I’m looking to verify specific headers were set in the request. Any help is welcome!</z><z id="t1557780420" t="Joe Lane [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] seems like you could make an interceptor which terminates the interceptor chain if the headers don’t conform."><y>#</y><d>2019-05-13</d><h>20:47</h><w>Joe Lane</w><a>@ariel.silverman</a> seems like you could make an interceptor which terminates the interceptor chain if the headers don’t conform.</z><z id="t1557780752" t="asilverman yeah that’s what i’ve set up to do, however I was hoping the framework had an opinion about this"><y>#</y><d>2019-05-13</d><h>20:52</h><w>asilverman</w>yeah that’s what i’ve set up to do, however I was hoping the framework had an opinion about this</z><z id="t1557781299" t="Joe Lane I don’t think pedestal is a framework 🙂 I like that its just a library. Vase may hold more opinions like this though."><y>#</y><d>2019-05-13</d><h>21:01</h><w>Joe Lane</w>I don’t think pedestal is a framework <b>🙂</b> I like that its just a library. Vase may hold more opinions like this though.</z><z id="t1557781727" t="ddeaguiar agree with [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] re: framework vs library. Creating your own interceptor is the way to go. Vase does have more opinions but not involve spec and headers (that I recall anyway)."><y>#</y><d>2019-05-13</d><h>21:08</h><w>ddeaguiar</w>agree with <a>@lanejo01</a> re: framework vs library. Creating your own interceptor is the way to go. Vase does have more opinions but not involve spec and headers (that I recall anyway).</z><z id="t1557812270" t="ikitommi I would say Pedestal is a framework, as it calls your code 😉 There is also reitit-pedestal add-on, which allows one to describe header-params with spec. With request-coercion interceptor mounted, validation, coercion (string-&gt;edn) and api-docs are pulled from those definitions. Would be something like: [&quot;/headers&quot; {:get {:summary &quot;playing with header-params&quot; :parameters {:header {:x-int pos-int?}} :interceptors [(coercion/coerce-request-interceptor)] :handler (fn [req] {:status 200 :body {:value (-&gt; req :parameters :header :x-int inc)}})}}] "><y>#</y><d>2019-05-14</d><h>05:37</h><w>ikitommi</w>I would say Pedestal is a framework, as it calls your code <b>😉</b> There is also <code>reitit-pedestal</code> add-on, which allows one to describe header-params with spec. With request-coercion interceptor mounted, validation, coercion (string-&gt;edn) and api-docs are pulled from those definitions. Would be something like:
<pre>[&quot;/headers&quot;
 {:get {:summary &quot;playing with header-params&quot;
        :parameters {:header {:x-int pos-int?}}
        :interceptors [(coercion/coerce-request-interceptor)]
        :handler (fn [req]
                   {:status 200
                    :body {:value (-&gt; req :parameters :header :x-int inc)}})}}]
</pre></z><z id="t1557812409" t="ikitommi"><y>#</y><d>2019-05-14</d><h>05:40</h><r>ikitommi</r></z><z id="t1557859453" t="jackson question about web sockets.. Is there a simple way to know which client closed their end so that I can remove them from my collection of clients? I&apos;ve done some workarounds requiring the client to have an id as a query param and I can look them up by request on close, but I was hoping there was something simpler that I&apos;ve been overlooking."><y>#</y><d>2019-05-14</d><h>18:44</h><w>jackson</w>question about web sockets.. Is there a simple way to know which client closed their end so that I can remove them from my collection of clients? I&apos;ve done some workarounds requiring the client to have an id as a query param and I can look them up by request on close, but I was hoping there was something simpler that I&apos;ve been overlooking.</z><z id="t1557862890" t="jackson update, keying off the hash of the request seems to work well enough without requiring the client to provide an id."><y>#</y><d>2019-05-14</d><h>19:41</h><w>jackson</w>update, keying off the hash of the request seems to work well enough without requiring the client to provide an id.</z><z id="t1557949120" t="emccue how can i make / go to /index.html"><y>#</y><d>2019-05-15</d><h>19:38</h><w>emccue</w>how can i make <code>/</code> go to <code>/index.html</code></z><z id="t1557949139" t="emccue i am using lacinia-pedestal and am trying to add a &quot;frontend&quot; with JS"><y>#</y><d>2019-05-15</d><h>19:38</h><w>emccue</w>i am using lacinia-pedestal and am trying to add a &quot;frontend&quot; with JS</z><z id="t1557949156" t="emccue right now going to / redirects to the graphiql page"><y>#</y><d>2019-05-15</d><h>19:39</h><w>emccue</w>right now going to <code>/</code> redirects to the graphiql page</z><z id="t1557949497" t="jvtrigueros [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] you could move the ide-path http://walmartlabs.github.io/apidocs/lacinia-pedestal/com.walmartlabs.lacinia.pedestal.html#var-service-map"><y>#</y><d>2019-05-15</d><h>19:44</h><w>jvtrigueros</w><a>@emccue</a> you could move the <code>ide-path</code> <a href="http://walmartlabs.github.io/apidocs/lacinia-pedestal/com.walmartlabs.lacinia.pedestal.html#var-service-map" target="_blank">http://walmartlabs.github.io/apidocs/lacinia-pedestal/com.walmartlabs.lacinia.pedestal.html#var-service-map</a></z><z id="t1557949515" t="emccue that seems super straight forward"><y>#</y><d>2019-05-15</d><h>19:45</h><w>emccue</w>that seems super straight forward</z><z id="t1557949558" t="emccue but how about serving the index.html from /"><y>#</y><d>2019-05-15</d><h>19:45</h><w>emccue</w>but how about serving the index.html from /</z><z id="t1557949695" t="emccue (I have very little experience with pedestal)"><y>#</y><d>2019-05-15</d><h>19:48</h><w>emccue</w>(I have very little experience with pedestal)</z><z id="t1557951101" t="orestis That’s trivial by adding a file/resource interceptor under there - I could share some code tomorrow. "><y>#</y><d>2019-05-15</d><h>20:11</h><w>orestis</w>That’s trivial by adding a file/resource interceptor under there - I could share some code tomorrow. </z><z id="t1557972615" t="emccue"><y>#</y><d>2019-05-16</d><h>02:10</h><w>emccue</w></z><z id="t1557972625" t="emccue I am gettingg this error with lacinia-pedestal"><y>#</y><d>2019-05-16</d><h>02:10</h><w>emccue</w>I am gettingg this error with lacinia-pedestal</z><z id="t1557972634" t="emccue it seems to be related to the jetty version"><y>#</y><d>2019-05-16</d><h>02:10</h><w>emccue</w>it seems to be related to the jetty version</z><z id="t1557972650" t="emccue"><y>#</y><d>2019-05-16</d><h>02:10</h><w>emccue</w></z><z id="t1557972660" t="emccue I&apos;m not exactly sure how to resolve it though"><y>#</y><d>2019-05-16</d><h>02:11</h><w>emccue</w>I&apos;m not exactly sure how to resolve it though</z><z id="t1557972695" t="emccue i seem to have pedestal 0.5.3 and jetty 9.4.15"><y>#</y><d>2019-05-16</d><h>02:11</h><w>emccue</w>i seem to have pedestal 0.5.3 and jetty 9.4.15</z><z id="t1558041750" t="jvtrigueros [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] do you have a short reproducible example I can try out?"><y>#</y><d>2019-05-16</d><h>21:22</h><w>jvtrigueros</w><a>@emccue</a> do you have a short reproducible example I can try out?</z><z id="t1558041790" t="emccue I think I fixed it by updating jetty"><y>#</y><d>2019-05-16</d><h>21:23</h><w>emccue</w>I think I fixed it by updating jetty</z><z id="t1558041800" t="emccue And pededtal to 55"><y>#</y><d>2019-05-16</d><h>21:23</h><w>emccue</w>And pededtal to 55</z><z id="t1558041808" t="jvtrigueros Ah, perfect!"><y>#</y><d>2019-05-16</d><h>21:23</h><w>jvtrigueros</w>Ah, perfect!</z><z id="t1558217071" t="souenzzo There is something like io.pedestal.http.body-params/body-params to responses?"><y>#</y><d>2019-05-18</d><h>22:04</h><w>souenzzo</w>There is something like <code>io.pedestal.http.body-params/body-params</code> to responses?</z><z id="t1558354975" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] are you referring to content negotiation?"><y>#</y><d>2019-05-20</d><h>12:22</h><w>ddeaguiar</w><a>@souenzzo</a> are you referring to content negotiation?</z><z id="t1558354980" t="ddeaguiar If so, then yes"><y>#</y><d>2019-05-20</d><h>12:23</h><w>ddeaguiar</w>If so, then yes</z><z id="t1558765997" t="caleb.macdonaldblack How do I serve static files?"><y>#</y><d>2019-05-25</d><h>06:33</h><w>caleb.macdonaldblack</w>How do I serve static files?</z><z id="t1558766005" t="caleb.macdonaldblack I can&apos;t really find much online"><y>#</y><d>2019-05-25</d><h>06:33</h><w>caleb.macdonaldblack</w>I can&apos;t really find much online</z><z id="t1558791159" t="souenzzo https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L198"><y>#</y><d>2019-05-25</d><h>13:32</h><w>souenzzo</w><a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L198" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L198</a></z><z id="t1558791165" t="souenzzo there is also :: file-path"><y>#</y><d>2019-05-25</d><h>13:32</h><w>souenzzo</w>there is also <b>::</b>file-path</z><z id="t1559109115" t="Ahmed Hassan Which of these is used to serve JavaScript script files like main.js ?"><y>#</y><d>2019-05-29</d><h>05:51</h><r>Ahmed Hassan</r>Which of these is used to serve JavaScript script files like <code>main.js</code>?</z><z id="t1559109258" t="Ahmed Hassan https://clojurians.slack.com/archives/C053AK3F9/p1559107538359200"><y>#</y><d>2019-05-29</d><h>05:54</h><r>Ahmed Hassan</r><a href="https://clojurians.slack.com/archives/C053AK3F9/p1559107538359200" target="_blank">https://clojurians.slack.com/archives/C053AK3F9/p1559107538359200</a></z><z id="t1559131940" t="souenzzo I output my main.js to somewhere like target/pubic/app/main.js then I set ::http/file-path to target/public In the index.html , you will import as &lt;script src=&quot;/app/main.js&quot;&gt; Don&apos;t forget about ::http/mime-types mime/default-mime-types"><y>#</y><d>2019-05-29</d><h>12:12</h><r>souenzzo</r>I output my <code>main.js</code> to somewhere like <code>target/pubic/app/main.js</code>
then I set <code>::http/file-path</code> to <code>target/public</code>
In the <code>index.html</code>, you will import as <code>&lt;script src=&quot;/app/main.js&quot;&gt;</code>
Don&apos;t forget about <code>::http/mime-types mime/default-mime-types</code></z><z id="t1559133071" t="Ahmed Hassan Bundle of thanks. It works. 🙂"><y>#</y><d>2019-05-29</d><h>12:31</h><r>Ahmed Hassan</r>Bundle of thanks. It works. <b>🙂</b></z><z id="t1559133124" t="Ahmed Hassan When I change from ::http/file-path to ::http/resource-path it gives error again. What is difference here?"><y>#</y><d>2019-05-29</d><h>12:32</h><r>Ahmed Hassan</r>When I change from <code>::http/file-path</code> to <code>::http/resource-path</code> it gives error again. What is difference here?</z><z id="t1559136504" t="souenzzo ::http/resource-path needs to be something in your classpath. In :paths from deps.edn or :resource-paths from project.clj Example: output main.js in resource/public/app/main.js resource is in my classpath. I can test with (slurp (io/resource &quot;public/app/main.js&quot;)) should return my file then I can use ::http/resource-path &quot;public&quot; , my index with src=&quot;/app/main.js&quot; ..."><y>#</y><d>2019-05-29</d><h>13:28</h><r>souenzzo</r><code>::http/resource-path</code> needs to be something in your classpath. In <code>:paths</code> from <code>deps.edn</code> or <code>:resource-paths</code> from <code>project.clj</code>
Example:
output <code>main.js</code> in <code>resource/public/app/main.js</code>
<code>resource</code> is in my classpath. I can test with <code>(slurp (io/resource &quot;public/app/main.js&quot;))</code> should return my file
then I can use <code>::http/resource-path &quot;public&quot;</code>, my index with <code>src=&quot;/app/main.js&quot;</code> ...</z><z id="t1558791174" t="souenzzo [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}]"><y>#</y><d>2019-05-25</d><h>13:32</h><w>souenzzo</w><a>@caleb.macdonaldblack</a></z><z id="t1559024759" t="Ahmed Hassan How do I tweak Content Security Policy in Pedestal?"><y>#</y><d>2019-05-28</d><h>06:25</h><w>Ahmed Hassan</w>How do I tweak Content Security Policy in Pedestal?</z><z id="t1559032564" t="souenzzo Inside service-map ::http/port 8080 ::http/secure-headers {:content-security-policy-settings content-security-policy-settings} ... "><y>#</y><d>2019-05-28</d><h>08:36</h><w>souenzzo</w>Inside service-map
<pre>::http/port 8080
::http/secure-headers {:content-security-policy-settings content-security-policy-settings}
...
</pre></z><z id="t1559032695" t="souenzzo docs here https://cljdoc.org/d/io.pedestal/pedestal.service/0.5.5/api/io.pedestal.http.secure-headers [:attrs {:href &quot;/_/_/users/UCMNZLJ93&quot;}]"><y>#</y><d>2019-05-28</d><h>08:38</h><w>souenzzo</w>docs here <a href="https://cljdoc.org/d/io.pedestal/pedestal.service/0.5.5/api/io.pedestal.http.secure-headers" target="_blank">https://cljdoc.org/d/io.pedestal/pedestal.service/0.5.5/api/io.pedestal.http.secure-headers</a>
<a>@ahmed1hsn</a></z><z id="t1559033115" t="souenzzo docs aren&apos;t awesome, but you can checkout the sources. it&apos;s just a bunch of string concat/join"><y>#</y><d>2019-05-28</d><h>08:45</h><w>souenzzo</w>docs aren&apos;t awesome, but you can checkout the sources. it&apos;s just a bunch of string concat/join</z><z id="t1559033585" t="Ahmed Hassan So, If I have set up [:attrs {:class &quot;emoji&quot;}] in service-map I do not need to include &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src ; child-src &apos;none&apos;; object-src &apos;none&apos;&quot;&gt; Tag in html. Right?"><y>#</y><d>2019-05-28</d><h>08:53</h><r>Ahmed Hassan</r>So, If I have set up <span></span> in <code>service-map</code> I do not need to include <code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src ; child-src &apos;none&apos;; object-src &apos;none&apos;&quot;&gt;</code> Tag in html. Right?</z><z id="t1559033640" t="Ahmed Hassan https://developers.google.com/web/fundamentals/security/csp/#the_meta_tag"><y>#</y><d>2019-05-28</d><h>08:54</h><r>Ahmed Hassan</r><a href="https://developers.google.com/web/fundamentals/security/csp/#the_meta_tag" target="_blank">https://developers.google.com/web/fundamentals/security/csp/#the_meta_tag</a></z><z id="t1559033763" t="souenzzo Yep. Choose one method (headers or meta-tags). https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#attr-http-equiv"><y>#</y><d>2019-05-28</d><h>08:56</h><r>souenzzo</r>Yep. Choose one method (headers or meta-tags).
<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#attr-http-equiv" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#attr-http-equiv</a></z><z id="t1559248774" t="ccann could anyone recommend a way to have the allowed-origins interceptor skip a particular route?"><y>#</y><d>2019-05-30</d><h>20:39</h><w>ccann</w>could anyone recommend a way to have the <code>allowed-origins</code> interceptor skip a particular route?</z><z id="t1559249135" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0BAS2E13&quot;}] , you have full control over what interceptors are added. Leveraging Pedestal’s default-interceptors impl should be considered a convenience and may not be suitable for some use cases. By setting the :io.pedestal.http/interceptors key on the service map you take full control over what interceptors are added when. If you do this, though, you’ll need to add the router interceptor yourself."><y>#</y><d>2019-05-30</d><h>20:45</h><w>ddeaguiar</w><a>@ccann</a>, you have full control over what interceptors are added. Leveraging Pedestal’s <code>default-interceptors</code> impl should be considered a convenience and may not be suitable for some use cases. By setting the <code>:io.pedestal.http/interceptors</code> key on the service map you take full control over what interceptors are added when. If you do this, though, you’ll need to add the router interceptor yourself.</z><z id="t1559249175" t="ccann okay yeah, thanks"><y>#</y><d>2019-05-30</d><h>20:46</h><w>ccann</w>okay yeah, thanks</z><z id="t1559249214" t="ddeaguiar Or you can just add the allowed-origins interceptor yourself in your routes and skip specifying the allowed-origins in your service map"><y>#</y><d>2019-05-30</d><h>20:46</h><w>ddeaguiar</w>Or you can just add the allowed-origins interceptor yourself in your routes and skip specifying the allowed-origins in your service map</z><z id="t1559249228" t="ddeaguiar the later is probably more confusing"><y>#</y><d>2019-05-30</d><h>20:47</h><w>ddeaguiar</w>the later is probably more confusing</z><z id="t1559249485" t="ccann the problem I’m having that led me to ask the question is that for my health check route (a GET request) I’m getting a NPE from my allowed-origins function"><y>#</y><d>2019-05-30</d><h>20:51</h><w>ccann</w>the problem I’m having that led me to ask the question is that for my health check route (a GET request) I’m getting a NPE from my allowed-origins function</z><z id="t1559249493" t="ccann which is because there is no Origin header (i’m parsing the header with a regexp)"><y>#</y><d>2019-05-30</d><h>20:51</h><w>ccann</w>which is because there is no <code>Origin</code> header (i’m parsing the header with a regexp)</z><z id="t1559249507" t="ccann because the health check is coming from an AWS server not a browser"><y>#</y><d>2019-05-30</d><h>20:51</h><w>ccann</w>because the health check is coming from an AWS server not a browser</z><z id="t1559249551" t="ccann and apparently the pedestal cors interceptor calls the allowed-origins function before determining if the request type is :options https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/src/io/pedestal/http/cors.clj#L82"><y>#</y><d>2019-05-30</d><h>20:52</h><w>ccann</w>and apparently the pedestal cors interceptor calls the <code>allowed-origins</code> function before determining if the request type is <code>:options</code> <a href="https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/src/io/pedestal/http/cors.clj#L82" target="_blank">https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/service/src/io/pedestal/http/cors.clj#L82</a></z><z id="t1559249703" t="ddeaguiar Yep, the allow-origin interceptor is added prior to the router and it is within the router where method-based matching is done"><y>#</y><d>2019-05-30</d><h>20:55</h><w>ddeaguiar</w>Yep, the <code>allow-origin</code> interceptor is added prior to the router and it is within the router where method-based matching is done</z><z id="t1559249939" t="ccann so I guess the “correct” behavior then for a missing Origin header is for the allowed-origins function to return truthy"><y>#</y><d>2019-05-30</d><h>20:58</h><w>ccann</w>so I guess the “correct” behavior then for a missing Origin header is for the allowed-origins function to return truthy</z><z id="t1559250034" t="ccann because a browser is going to send Origin , and that’s what CORS is concerned with. If a server or curl doesn’t specify an origin that’s outside the concern of CORS"><y>#</y><d>2019-05-30</d><h>21:00</h><w>ccann</w>because a browser is going to send <code>Origin</code>, and that’s what CORS is concerned with. If a server or <code>curl</code> doesn’t specify an origin that’s outside the concern of CORS</z><z id="t1559250051" t="ccann thinking out-loud here 🙂"><y>#</y><d>2019-05-30</d><h>21:00</h><w>ccann</w>thinking out-loud here <b>🙂</b></z><z id="t1559250312" t="ddeaguiar sounds reasonable"><y>#</y><d>2019-05-30</d><h>21:05</h><w>ddeaguiar</w>sounds reasonable</z><z id="t1559327730" t="hlship When using table syntax for routing, is there an simple/idiomatic way to remove the common prefix: (route/expand-routes #{[&quot;/api/job/:job-id&quot; :get (get-job client) :route-name ::get-job] [&quot;/api/jobs&quot; :post (create-job client) :route-name ::create-job]}) I&apos;d like to wrap these in something that &apos;supplies&apos; the /api part."><y>#</y><d>2019-05-31</d><h>18:35</h><w>hlship</w>When using table syntax for routing, is there an simple/idiomatic way to remove the common prefix:

<pre>(route/expand-routes
      #{[&quot;/api/job/:job-id&quot; :get
         (get-job client)
         :route-name ::get-job]
        [&quot;/api/jobs&quot; :post
         (create-job client)
         :route-name ::create-job]})
</pre>

I&apos;d like to wrap these in something that &apos;supplies&apos; the <code>/api</code> part.</z><z id="t1559654158" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , you can use a different routing syntax. The terse route syntax supports hierarchical route definitions."><y>#</y><d>2019-06-04</d><h>13:15</h><r>ddeaguiar</r><a>@U04VDKC4G</a>, you can use a different routing syntax. The terse route syntax supports hierarchical route definitions.</z><z id="t1559661855" t="hlship I want my cake and to eat it too. I generally prefer table syntax except for that bit of repetition. "><y>#</y><d>2019-06-04</d><h>15:24</h><r>hlship</r>I want my cake and to eat it too. I generally prefer table syntax except for that bit of repetition. </z><z id="t1559662205" t="ddeaguiar Yes, I prefer table syntax as well."><y>#</y><d>2019-06-04</d><h>15:30</h><r>ddeaguiar</r>Yes, I prefer table syntax as well.</z><z id="t1559335123" t="ccann ooh, I would love that as well"><y>#</y><d>2019-05-31</d><h>20:38</h><w>ccann</w>ooh, I would love that as well</z><z id="t1559456426" t="Ahmed Hassan My application is giving a lot of unnecessary logging, how can I stop it? I have put logback.xml file in /config directory. and added :paths [&quot;src/main&quot; &quot;resources&quot; &quot;config&quot;] in deps.edn file."><y>#</y><d>2019-06-02</d><h>06:20</h><w>Ahmed Hassan</w>My application is giving a lot of unnecessary logging, how can I stop it?
I have put <code>logback.xml</code> file in <code>/config</code> directory. and added <code>:paths [&quot;src/main&quot; &quot;resources&quot; &quot;config&quot;]</code> in <code>deps.edn</code> file.</z><z id="t1559456987" t="Ahmed Hassan I commented out com.fzakaria/slf4j-timbre {:mvn/version &quot;0.3.13&quot;} in deps.edn . And It&apos;s now in INFO mode."><y>#</y><d>2019-06-02</d><h>06:29</h><w>Ahmed Hassan</w>I commented out <code>com.fzakaria/slf4j-timbre   {:mvn/version &quot;0.3.13&quot;}</code> in <code>deps.edn</code>. And It&apos;s now in <code>INFO</code> mode.</z><z id="t1559936906" t="donaldball Is anyone aware of a fairly uninvasive way to, given pedestal routes, an interceptor name (e.g. ::json-response ), and an event name (e.g. :leave ), of recording the timing of every such event?"><y>#</y><d>2019-06-07</d><h>19:48</h><w>donaldball</w>Is anyone aware of a fairly uninvasive way to, given pedestal routes, an interceptor name (e.g. <code>::json-response</code>), and an event name (e.g. <code>:leave</code>), of recording the timing of every such event?</z><z id="t1559939320" t="orestis Is the :leave event the interceptor chain event :leave ? as in :enter , :leave , :error ?"><y>#</y><d>2019-06-07</d><h>20:28</h><w>orestis</w>Is the <code>:leave</code> event the interceptor chain event <code>:leave</code>? as in <code>:enter</code>, <code>:leave</code>, <code>:error</code>?</z><z id="t1559939346" t="orestis (I don’t have an answer, just want to understand the question)"><y>#</y><d>2019-06-07</d><h>20:29</h><w>orestis</w>(I don’t have an answer, just want to understand the question)</z><z id="t1559939553" t="donaldball Yea. There are a few interceptor events I’m interested in getting performance metrics on and I’d like to do it declaratively. Pedestal’s architecture facilitates this, but I’m almost a little surprised it doesn’t already have such a feature."><y>#</y><d>2019-06-07</d><h>20:32</h><w>donaldball</w>Yea. There are a few interceptor events I’m interested in getting performance metrics on and I’d like to do it declaratively. Pedestal’s architecture facilitates this, but I’m almost a little surprised it doesn’t already have such a feature.</z><z id="t1559939631" t="donaldball My current impl thought is to walk the results of io.pedestal.http.route/expand-routes and wrap the target interceptors in each route individually"><y>#</y><d>2019-06-07</d><h>20:33</h><w>donaldball</w>My current impl thought is to walk the results of <code>io.pedestal.http.route/expand-routes</code> and wrap the target interceptors in each route individually</z><z id="t1559950678" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] , Pedestal’s interceptor chain execution is managed by the io.pedestal.interceptor.chain ns. The current implementation does not support that level of instrumentation. While there’s an option to get more information regarding interceptor chain execution by using a more verbose logging level (i.e., DEBUG , TRACE ), it doesn’t sound like that’s what you are looking for. Your best bet is to either instrument the interceptors yourself or, if you’d like to get metrics for a production service, leverage an instrumentation library (i.e., New Relic) which is compatible with pedestal.log’s metric implementation. If you do the later, you likely need to add write an interceptor to identify requests (i.e., name transactions in New Relic). The benefit of using an instrumentation lib is that you’ll be able to collect information for all your apis and filter them as you see fit."><y>#</y><d>2019-06-07</d><h>23:37</h><w>ddeaguiar</w>Hi <a>@donaldball</a>, Pedestal’s interceptor chain execution is managed by the <code>io.pedestal.interceptor.chain</code> ns. The current implementation does not support that level of instrumentation. While there’s an option to get more information regarding interceptor chain execution by using a more verbose logging level (i.e., <code>DEBUG</code>, <code>TRACE</code>), it doesn’t sound like that’s what you are looking for. Your best bet is to either instrument the interceptors yourself or, if you’d like to get metrics for a production service, leverage an instrumentation library (i.e., New Relic) which is compatible with pedestal.log’s metric implementation. If you do the later, you likely need to add write an interceptor to identify requests (i.e., name transactions in New Relic). The benefit of using an instrumentation lib is that you’ll be able to collect information for all your apis and filter them as you see fit.</z><z id="t1559950816" t="ddeaguiar Although I’ve no experience with this, it may be useful: https://metrics.dropwizard.io/3.1.0/manual/servlet/#"><y>#</y><d>2019-06-07</d><h>23:40</h><w>ddeaguiar</w>Although I’ve no experience with this, it may be useful: <a href="https://metrics.dropwizard.io/3.1.0/manual/servlet/#" target="_blank">https://metrics.dropwizard.io/3.1.0/manual/servlet/#</a></z><z id="t1560182740" t="Travis Is anyone generating swagger apis using spec with pedestal ? If so are there any examples around?"><y>#</y><d>2019-06-10</d><h>16:05</h><w>Travis</w>Is anyone generating swagger apis using spec with pedestal ?  If so are there any examples around?</z><z id="t1560184637" t="ikitommi here is one example: https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger"><y>#</y><d>2019-06-10</d><h>16:37</h><w>ikitommi</w>here is one example: <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a></z><z id="t1561150347" t="ddeaguiar I just release Pedestal 0.5.7. Check out https://github.com/pedestal/pedestal/releases for details."><y>#</y><d>2019-06-21</d><h>20:52</h><w>ddeaguiar</w>I just release Pedestal 0.5.7. Check out <a href="https://github.com/pedestal/pedestal/releases" target="_blank">https://github.com/pedestal/pedestal/releases</a> for details.</z><z id="t1561150440" t="ddeaguiar In case you were wondering, the lein pedestal-service template was broken with the 0.5.6 release so I addressed that and bumped to 0.5.7."><y>#</y><d>2019-06-21</d><h>20:54</h><w>ddeaguiar</w>In case you were wondering, the lein <code>pedestal-service</code> template was broken with the 0.5.6 release so I addressed that and bumped to 0.5.7.</z><z id="t1562165974" t="Renan Oliveira Hi Guys, I have a doubt, what do you using to response in json?"><y>#</y><d>2019-07-03</d><h>14:59</h><w>Renan Oliveira</w>Hi Guys, I have a doubt, what do you using to response in json?</z><z id="t1562166900" t="renan Hi [:attrs {:href &quot;/_/_/users/UL64345M4&quot;}] i use json-body interceptor , here a example https://github.com/pedestal/pedestal/blob/master/samples/json-api/src/json_api/service.clj#L59"><y>#</y><d>2019-07-03</d><h>15:15</h><w>renan</w>Hi <a>@renanrboliveira</a> i use json-body interceptor , here a example <a href="https://github.com/pedestal/pedestal/blob/master/samples/json-api/src/json_api/service.clj#L59" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/json-api/src/json_api/service.clj#L59</a></z><z id="t1562186403" t="Renan Oliveira hey [:attrs {:href &quot;/_/_/users/U1E43JSG0&quot;}] and for validates params, if null e etc, how do you work in this case?"><y>#</y><d>2019-07-03</d><h>20:40</h><r>Renan Oliveira</r>hey <a>@renan</a> and for validates params, if null e etc, how do you work in this case?</z><z id="t1562189546" t="renan [:attrs {:href &quot;/_/_/users/UL64345M4&quot;}] normally i see examples using schema or spec to validation nulls... but when i was learning pedestal the some helpful me to this things"><y>#</y><d>2019-07-03</d><h>21:32</h><r>renan</r><a>@renanrboliveira</a> normally i see examples using schema or spec to validation nulls... but when i was learning pedestal the <code>some</code> helpful me to this things</z><z id="t1562181232" t="Renan Oliveira [:attrs {:href &quot;/_/_/users/U1E43JSG0&quot;}] thank you 😃"><y>#</y><d>2019-07-03</d><h>19:13</h><w>Renan Oliveira</w><a>@renan</a> thank you <b>😃</b></z><z id="t1562789010" t="souenzzo anyone else using #fulcro #pathom and #datomic ? Did you create resolvers using :db/id as input?"><y>#</y><d>2019-07-10</d><h>20:03</h><w>souenzzo</w>anyone else using #fulcro #pathom and #datomic ?
Did you create resolvers using <code>:db/id</code> as input?</z><z id="t1562789146" t="Joe Lane Are they mutation oriented resolvers?"><y>#</y><d>2019-07-10</d><h>20:05</h><w>Joe Lane</w>Are they mutation oriented resolvers?</z><z id="t1562789446" t="souenzzo &quot;read&quot; resolvers"><y>#</y><d>2019-07-10</d><h>20:10</h><w>souenzzo</w>&quot;read&quot; resolvers</z><z id="t1562789839" t="Joe Lane The alternative is to create an external ID of some sort. Is the application going to be integrating with 3rd parties at all? If so I&apos;d avoid using internal :db/id &apos;s externally. Otherwise i&apos;d say using :db/id is not a problem."><y>#</y><d>2019-07-10</d><h>20:17</h><w>Joe Lane</w>The alternative is to create an external ID of some sort. Is the application going to be integrating with 3rd parties at all? If so I&apos;d avoid using internal <code>:db/id</code>&apos;s externally. Otherwise i&apos;d say using <code>:db/id</code> is not a problem.</z><z id="t1562789888" t="Joe Lane I wen&apos;t down the external ID for a non-3rd-party-integrating application and if I could go back I wouldn&apos;t bother."><y>#</y><d>2019-07-10</d><h>20:18</h><w>Joe Lane</w>I wen&apos;t down the external ID for a non-3rd-party-integrating application and if I could go back I wouldn&apos;t bother.</z><z id="t1562790838" t="souenzzo I use extenal id&apos;s. But I&apos;m asking myself why not use :db/id PS: I know the limitations of :db/id"><y>#</y><d>2019-07-10</d><h>20:33</h><w>souenzzo</w>I use extenal id&apos;s. But I&apos;m asking myself why not use <code>:db/id</code>

PS: I know the limitations of :db/id</z><z id="t1562790869" t="souenzzo something like: by default use :db/id , unless I have a good reason to do not."><y>#</y><d>2019-07-10</d><h>20:34</h><w>souenzzo</w>something like: by default use <code>:db/id</code>, unless I have a good reason to do not.</z><z id="t1562790998" t="souenzzo Oh, I&apos;m on #pedestal , not #pathom. sorry. 😅"><y>#</y><d>2019-07-10</d><h>20:36</h><w>souenzzo</w>Oh, I&apos;m on #pedestal , not #pathom. sorry. <b>😅</b></z><z id="t1562905322" t="Braden Shepherdson I&apos;m getting completely swamped with DEBUG warning messages in my repl and can&apos;t see any of my own debugging."><y>#</y><d>2019-07-12</d><h>04:22</h><w>Braden Shepherdson</w>I&apos;m getting completely swamped with DEBUG warning messages in my repl and can&apos;t see any of my own debugging.</z><z id="t1562905434" t="Braden Shepherdson but I can&apos;t figure out how to control the logging level."><y>#</y><d>2019-07-12</d><h>04:23</h><w>Braden Shepherdson</w>but I can&apos;t figure out how to control the logging level.</z><z id="t1562937187" t="Joe Lane [:attrs {:href &quot;/_/_/users/UCY0GT0QM&quot;}] logback.xml under the config directory if memory serves me right."><y>#</y><d>2019-07-12</d><h>13:13</h><w>Joe Lane</w><a>@braden.shepherdson</a> logback.xml under the config directory if memory serves me right.</z><z id="t1562945278" t="macrobartfast I like the swagger-ui route luminus provides but I want to switch to pedestal... what&apos;s an approach to integrating swagger into pedestal so that I can get a swagger ui webpage? I looked online but the various projects I happened across don&apos;t seem maintained (but please refer them anyway in case I missed one)."><y>#</y><d>2019-07-12</d><h>15:27</h><w>macrobartfast</w>I like the swagger-ui route luminus provides but I want to switch to pedestal... what&apos;s an approach to integrating swagger into pedestal so that I can get a swagger ui webpage? I looked online but the various projects I happened across don&apos;t seem maintained (but please refer them anyway in case I missed one).</z><z id="t1562945407" t="macrobartfast it seems like a nice all around pedestal based service might provide both the ability to listen to a queue and do things with that as well as have a REST interface with a user interface web page (I know that&apos;s probably a lot of things to put into every service but would allow for maximum flexibility and team access)."><y>#</y><d>2019-07-12</d><h>15:30</h><w>macrobartfast</w>it seems like a nice all around pedestal based service might provide both the ability to listen to a queue and do things with that as well as have a REST interface with a user interface web page (I know that&apos;s probably a lot of things to put into every service but would allow for maximum flexibility and team access).</z><z id="t1562946085" t="Braden Shepherdson [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] ah, I had such a file generated but couldn&apos;t see why it wasn&apos;t being picked up. turns out it needs to be in the classpath. I added it to my boot, and now I&apos;m not drowning in messages anymore."><y>#</y><d>2019-07-12</d><h>15:41</h><w>Braden Shepherdson</w><a>@lanejo01</a> ah, I had such a file generated but couldn&apos;t see why it wasn&apos;t being picked up. turns out it needs to be in the classpath. I added it to my boot, and now I&apos;m not drowning in messages anymore.</z><z id="t1562946165" t="Braden Shepherdson my new problem is that I can&apos;t get the ::http/routes (fn [] ...) style to work. that spews errors about trying to use nil as an interceptor. the docs suggest this is allowed, and I&apos;m hoping that doing (route/expand-routes (deref #&apos;service/routes)) will make it dynamic for REPL based development."><y>#</y><d>2019-07-12</d><h>15:42</h><w>Braden Shepherdson</w>my new problem is that I can&apos;t get the <code>::http/routes (fn [] ...)</code> style to work. that spews errors about trying to use nil as an interceptor. the docs suggest this is allowed, and I&apos;m hoping that doing <code>(route/expand-routes (deref #&apos;service/routes))</code> will make it dynamic for REPL based development.</z><z id="t1562946222" t="Braden Shepherdson but even just replacing my (route/expand-routes service/routes) (which works) with #(route/expand-routes service/routes) fails."><y>#</y><d>2019-07-12</d><h>15:43</h><w>Braden Shepherdson</w>but even just replacing my <code>(route/expand-routes service/routes)</code> (which works) with <code>#(route/expand-routes service/routes)</code> fails.</z><z id="t1562947336" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCY0GT0QM&quot;}] if you are passing the service map through io.pedestal.http/default-interceptors you don’t need to explicitly expand routes unless :io.pedestal.http/routes is a fn"><y>#</y><d>2019-07-12</d><h>16:02</h><w>ddeaguiar</w><a>@braden.shepherdson</a> if you are passing the service map through <code>io.pedestal.http/default-interceptors</code> you don’t need to explicitly expand routes unless <code>:io.pedestal.http/routes</code> is a fn</z><z id="t1562947391" t="ddeaguiar Also, the service template using ::server/routes #(route/expand-routes (deref #&apos;service/routes)) in run-dev to facilitate local dev"><y>#</y><d>2019-07-12</d><h>16:03</h><w>ddeaguiar</w>Also, the service template using <code>::server/routes #(route/expand-routes (deref #&apos;service/routes))</code> in <code>run-dev</code> to facilitate local dev</z><z id="t1562947408" t="ddeaguiar so that should work for you"><y>#</y><d>2019-07-12</d><h>16:03</h><w>ddeaguiar</w>so that should work for you</z><z id="t1562947437" t="ddeaguiar I don’t recommend using a fn for routes outside of dev because it’s evaluated on every request"><y>#</y><d>2019-07-12</d><h>16:03</h><w>ddeaguiar</w>I don’t recommend using a fn for routes outside of dev because it’s evaluated on every request</z><z id="t1562947784" t="Braden Shepherdson yeah, I&apos;m trying to do the same as the template (I&apos;m using boot, not lein, so I didn&apos;t use the template directly) and I get a convoluted error when I pass a function."><y>#</y><d>2019-07-12</d><h>16:09</h><w>Braden Shepherdson</w>yeah, I&apos;m trying to do the same as the template (I&apos;m using boot, not lein, so I didn&apos;t use the template directly) and I get a convoluted error when I pass a function.</z><z id="t1562949376" t="ddeaguiar hrm, and you are doing ::server/routes #(route/expand-routes (deref #&apos;service/routes)) ?"><y>#</y><d>2019-07-12</d><h>16:36</h><w>ddeaguiar</w>hrm, and you are doing <code>::server/routes #(route/expand-routes (deref #&apos;service/routes))</code>?</z><z id="t1562950629" t="Braden Shepherdson yes. as far as I can tell I&apos;m running exactly the same setup as the template."><y>#</y><d>2019-07-12</d><h>16:57</h><w>Braden Shepherdson</w>yes. as far as I can tell I&apos;m running exactly the same setup as the template.</z><z id="t1562950805" t="Braden Shepherdson even just (fn [] service/routes) explodes."><y>#</y><d>2019-07-12</d><h>17:00</h><w>Braden Shepherdson</w>even just <code>(fn [] service/routes)</code> explodes.</z><z id="t1562950815" t="ddeaguiar well I don’t expect that to work"><y>#</y><d>2019-07-12</d><h>17:00</h><w>ddeaguiar</w>well I don’t expect that to work</z><z id="t1562950819" t="Braden Shepherdson while service/routes unwrapped works."><y>#</y><d>2019-07-12</d><h>17:00</h><w>Braden Shepherdson</w>while <code>service/routes</code> unwrapped works.</z><z id="t1562950825" t="ddeaguiar because the routes are not expanded"><y>#</y><d>2019-07-12</d><h>17:00</h><w>ddeaguiar</w>because the routes are not expanded</z><z id="t1562950828" t="Braden Shepherdson ah, I see."><y>#</y><d>2019-07-12</d><h>17:00</h><w>Braden Shepherdson</w>ah, I see.</z><z id="t1562950860" t="Braden Shepherdson well, (fn [] (route/expand-routes service/routes) fails too."><y>#</y><d>2019-07-12</d><h>17:01</h><w>Braden Shepherdson</w>well, <code>(fn [] (route/expand-routes service/routes)</code> fails too.</z><z id="t1562950877" t="ddeaguiar io.pedestal.http/default-interceptors will create the routing interceptor for you and, if :io.pedestal.http/routes is not a fn, it will expand it."><y>#</y><d>2019-07-12</d><h>17:01</h><w>ddeaguiar</w><code>io.pedestal.http/default-interceptors</code> will create the routing interceptor for you and, if <code>:io.pedestal.http/routes</code> is not a fn, it will expand it.</z><z id="t1562951000" t="ddeaguiar what does service/routes look like?"><y>#</y><d>2019-07-12</d><h>17:03</h><w>ddeaguiar</w>what does <code>service/routes</code> look like?</z><z id="t1562951011" t="Braden Shepherdson I&apos;ve removed all of my routes from it."><y>#</y><d>2019-07-12</d><h>17:03</h><w>Braden Shepherdson</w>I&apos;ve removed all of my routes from it.</z><z id="t1562951012" t="ddeaguiar because that should work"><y>#</y><d>2019-07-12</d><h>17:03</h><w>ddeaguiar</w>because that should work</z><z id="t1562951050" t="ddeaguiar works"><y>#</y><d>2019-07-12</d><h>17:04</h><w>ddeaguiar</w>works</z><z id="t1562951078" t="Braden Shepherdson so it&apos;s just the template now."><y>#</y><d>2019-07-12</d><h>17:04</h><w>Braden Shepherdson</w>so it&apos;s just the template now.</z><z id="t1562951250" t="Braden Shepherdson that&apos;s what I&apos;ve got."><y>#</y><d>2019-07-12</d><h>17:07</h><w>Braden Shepherdson</w>that&apos;s what I&apos;ve got.</z><z id="t1562951471" t="ddeaguiar hrm, Without seeing code I can’t determine why it’s not working. What I pasted works in a freshly generated service."><y>#</y><d>2019-07-12</d><h>17:11</h><w>ddeaguiar</w>hrm, Without seeing code I can’t determine why it’s not working. What I pasted works in a freshly generated service.</z><z id="t1562951485" t="Braden Shepherdson Pedestal 0.5.7, Clojure 1.9.0, and I restarted my REPL for good measure."><y>#</y><d>2019-07-12</d><h>17:11</h><w>Braden Shepherdson</w>Pedestal 0.5.7, Clojure 1.9.0, and I restarted my REPL for good measure.</z></g><g id="s16"><z id="t1562951500" t="Braden Shepherdson I&apos;m diffing the files looking for variations."><y>#</y><d>2019-07-12</d><h>17:11</h><w>Braden Shepherdson</w>I&apos;m diffing the files looking for variations.</z><z id="t1562951639" t="Braden Shepherdson there! I figured it out with the diff. I had shuffled some pieces between files, and then put them back. my routes had `service/about-page ; where they needed `about-page "><y>#</y><d>2019-07-12</d><h>17:13</h><w>Braden Shepherdson</w>there! I figured it out with the diff. I had shuffled some pieces between files, and then put them back. my routes had
<pre>`service/about-page
; where they needed
`about-page
</pre></z><z id="t1562951686" t="Braden Shepherdson which produces no error, but of course those symbols are not defined."><y>#</y><d>2019-07-12</d><h>17:14</h><w>Braden Shepherdson</w>which produces no error, but of course those symbols are not defined.</z><z id="t1562951714" t="Braden Shepherdson thanks for the help debugging. I&apos;m new to Pedestal and struggling, as always with a new framework, to figure out the right incantations for the magic."><y>#</y><d>2019-07-12</d><h>17:15</h><w>Braden Shepherdson</w>thanks for the help debugging. I&apos;m new to Pedestal and struggling, as always with a new framework, to figure out the right incantations for the magic.</z><z id="t1562951772" t="ddeaguiar no problem!"><y>#</y><d>2019-07-12</d><h>17:16</h><w>ddeaguiar</w>no problem!</z><z id="t1562952071" t="Braden Shepherdson the sad part of this is that I&apos;m debugging this side project during my 90-second builds at work. it just underscores the insane productivity of Clojure that I can reload things into my REPL with vim-fireplace and it&apos;s already live in my server."><y>#</y><d>2019-07-12</d><h>17:21</h><w>Braden Shepherdson</w>the sad part of this is that I&apos;m debugging this side project during my 90-second builds at work. it just underscores the insane productivity of Clojure that I can reload things into my REPL with vim-fireplace and it&apos;s already live in my server.</z><z id="t1562952125" t="Braden Shepherdson it&apos;s mind-boggling that people object to parens and dynamic types when those are the two dev experiences."><y>#</y><d>2019-07-12</d><h>17:22</h><w>Braden Shepherdson</w>it&apos;s mind-boggling that people object to parens and dynamic types when those are the two dev experiences.</z><z id="t1563223906" t="stacktracer Noob question ... in the pedestal async example: (interceptors/defbefore takes-time [context] (let [channel (chan)] (go (let [result (lengthy-computation (:request context)) new-context (assoc context :response (ring-resp/response result))] (&gt;! channel new-context))) channel)) ... is there a reason to create channel explicitly, rather than use the implicit channel that receives the result of the go body? In other words, why do the above instead of this: (interceptors/defbefore takes-time [context] (go (let [result (lengthy-computation (:request context))] (assoc context :response (ring-resp/response result)))))"><y>#</y><d>2019-07-15</d><h>20:51</h><w>stacktracer</w>Noob question ... in the pedestal async example:
<pre>(interceptors/defbefore takes-time
      [context]
      (let [channel (chan)]
        (go
         (let [result (lengthy-computation (:request context))
               new-context (assoc context :response (ring-resp/response result))]
           (&gt;! channel new-context)))
        channel))</pre>
... is there a reason to create <code>channel</code> explicitly, rather than use the implicit channel that receives the result of the <code>go</code> body?
In other words, why do the above instead of this:
<pre>(interceptors/defbefore takes-time
      [context]
      (go
        (let [result (lengthy-computation (:request context))]
          (assoc context :response (ring-resp/response result)))))</pre></z><z id="t1563224009" t="stacktracer The example in question is here: https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md#asynchronous-processing"><y>#</y><d>2019-07-15</d><h>20:53</h><w>stacktracer</w>The example in question is here: <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md#asynchronous-processing" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md#asynchronous-processing</a></z><z id="t1563224916" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UKZHCSQ7M&quot;}] I can’t think of a reason in this case. There are no options being passed during channel creation in this example."><y>#</y><d>2019-07-15</d><h>21:08</h><w>ddeaguiar</w><a>@stacktracer</a> I can’t think of a reason in this case. There are no options being passed during channel creation in this example.</z><z id="t1563234659" t="stacktracer [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thanks for the sanity check!"><y>#</y><d>2019-07-15</d><h>23:50</h><w>stacktracer</w><a>@ddeaguiar</a> Thanks for the sanity check!</z><z id="t1563300524" t="Braden Shepherdson do people generally test their interceptors in isolation, test the entire stack (below the router) for each action, or both?"><y>#</y><d>2019-07-16</d><h>18:08</h><w>Braden Shepherdson</w>do people generally test their interceptors in isolation, test the entire stack (below the router) for each action, or both?</z><z id="t1563360686" t="Daouda Hey folks, I am trying to use expand-route with no success. It`s my first time to use pedestal and I am a bit lost. (def routes (route/expand-routes #{[&quot;/&quot; :get [common-interceptors] `home-page] [&quot;/about&quot; :get [common-interceptors] `about-page] [&quot;/user&quot; :post [common-interceptors] `create-user]}))"><y>#</y><d>2019-07-17</d><h>10:51</h><w>Daouda</w>Hey folks, I am trying to use <code>expand-route</code> with no success. It`s my first time to use pedestal and I am a bit lost.
<pre>(def routes
  (route/expand-routes
   #{[&quot;/&quot; :get [common-interceptors] `home-page]
     [&quot;/about&quot; :get [common-interceptors] `about-page]
     [&quot;/user&quot; :post [common-interceptors] `create-user]}))</pre></z><z id="t1563361191" t="Daouda 1. Caused by java.lang.AssertionError Assert failed: Route name or handler appears more than once in the route spec: [[#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body} #Interceptor{:name }]] (nil? (seen-route-names rname))"><y>#</y><d>2019-07-17</d><h>10:59</h><w>Daouda</w><pre>1. Caused by java.lang.AssertionError
   Assert failed: Route name or handler appears more than once in the
   route spec: [[#Interceptor{:name
   :io.pedestal.http.body-params/body-params} #Interceptor{:name
   :io.pedestal.http/html-body} #Interceptor{:name }]] (nil?
   (seen-route-names rname))</pre></z><z id="t1563361338" t="Daouda the error seems obvious but i don`t know how to get right of it, anything I tried so far, I get other kind of error. Any help about the right way to use expand-routes ?"><y>#</y><d>2019-07-17</d><h>11:02</h><w>Daouda</w>the error seems obvious but i don`t know how to get right of it, anything I tried so far, I get other kind of error. Any help about the right way to use <code>expand-routes</code> ?</z><z id="t1563369378" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UEA9PJ9FE&quot;}] , your service is based on the pedestal-service template then io.pedestal.http/default-interceptors is being called then you don’t need route/expand-routes . In terms of your routes, it looks you are using the table route syntax but it’s not complete correct. It should look something like this: (def routes (route/expand-routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/about&quot; :get (conj common-interceptors `about-page)] [&quot;/user&quot; :post (conj common-interceptors `create-user)})) "><y>#</y><d>2019-07-17</d><h>13:16</h><w>ddeaguiar</w><a>@quieterkali</a>, your service is based on the pedestal-service template then <code>io.pedestal.http/default-interceptors</code> is being called then you don’t need <code>route/expand-routes</code>. In terms of your routes, it looks you are using the table route syntax but it’s not complete correct.  It should look something like this:

<pre>(def routes
  (route/expand-routes
   #{[&quot;/&quot; :get (conj common-interceptors `home-page)]
     [&quot;/about&quot; :get (conj common-interceptors `about-page)]
     [&quot;/user&quot; :post (conj common-interceptors `create-user)}))
</pre></z><z id="t1563369569" t="Daouda oh, how did you noticed that my project was based on pedestal service template? curiosity 😄 Can I use nested level route with this template?"><y>#</y><d>2019-07-17</d><h>13:19</h><r>Daouda</r>oh, how did you noticed that my project was based on pedestal service template? curiosity <b>😄</b>
Can I use nested level route with this template?</z><z id="t1563371709" t="ddeaguiar Lucky guess 🙂 . Table route syntax does not support nested routes. However, I find it to be the preferred route syntax because it’s easier to reason about (for me anyways)."><y>#</y><d>2019-07-17</d><h>13:55</h><r>ddeaguiar</r>Lucky guess <b>🙂</b>. Table route syntax does not support nested routes. However, I find it to be the preferred route syntax because it’s easier to reason about (for me anyways).</z><z id="t1563371741" t="ddeaguiar you’d have to create a separate route vector for, for example, /about/foobar"><y>#</y><d>2019-07-17</d><h>13:55</h><r>ddeaguiar</r>you’d have to create a separate route vector for, for example, <code>/about/foobar</code></z><z id="t1563372762" t="Braden Shepherdson curious, I find the hierarchy more difficult to follow once it grows beyond a handful of layers or a dozen routes total. I like being able to see all the routes laid out in full."><y>#</y><d>2019-07-17</d><h>14:12</h><r>Braden Shepherdson</r>curious, I find the hierarchy more difficult to follow once it grows beyond a handful of layers or a dozen routes total. I like being able to see all the routes laid out in full.</z><z id="t1563476786" t="Braden Shepherdson I had it in my head that Pedestal stops processing interceptors once someone defines the :response key. is that true? do I need to do something to configure that behavior?"><y>#</y><d>2019-07-18</d><h>19:06</h><w>Braden Shepherdson</w>I had it in my head that Pedestal stops processing interceptors once someone defines the <code>:response</code> key. is that true? do I need to do something to configure that behavior?</z><z id="t1563476797" t="Braden Shepherdson I can&apos;t actually find this in the docs, now that I&apos;m looking for it."><y>#</y><d>2019-07-18</d><h>19:06</h><w>Braden Shepherdson</w>I can&apos;t actually find this in the docs, now that I&apos;m looking for it.</z><z id="t1563476843" t="donaldball You need io.pedestal.interceptor.chain/terminate"><y>#</y><d>2019-07-18</d><h>19:07</h><w>donaldball</w>You need <code>io.pedestal.interceptor.chain/terminate</code></z><z id="t1563477270" t="ddeaguiar For servlet-based services the termination impl is present and it checks for a :response key in the context"><y>#</y><d>2019-07-18</d><h>19:14</h><w>ddeaguiar</w>For servlet-based services the termination impl is present and it checks for a <code>:response</code> key in the context</z><z id="t1563477313" t="ddeaguiar if you are testing interceptors in isolation with an empty context then you need to add that"><y>#</y><d>2019-07-18</d><h>19:15</h><w>ddeaguiar</w>if you are testing interceptors in isolation with an empty context then you need to add that</z><z id="t1563477375" t="ddeaguiar I’d prefer that over calling io.pedestal.interceptor.chain/terminate if you are going to be sending back a response"><y>#</y><d>2019-07-18</d><h>19:16</h><w>ddeaguiar</w>I’d prefer that over calling <code>io.pedestal.interceptor.chain/terminate</code> if you are going to be sending back a response</z><z id="t1563479552" t="Braden Shepherdson ah, I figured out my problem, I think. it uses the ring response? function, which requires that :headers be a map. that wasn&apos;t always true in my code."><y>#</y><d>2019-07-18</d><h>19:52</h><w>Braden Shepherdson</w>ah, I figured out my problem, I think. it uses the ring <code>response?</code> function, which requires that <code>:headers</code> be a map. that wasn&apos;t always true in my code.</z><z id="t1563479947" t="ddeaguiar Ah yep, sorry about that. I should have double checked the source."><y>#</y><d>2019-07-18</d><h>19:59</h><w>ddeaguiar</w>Ah yep, sorry about that. I should have double checked the source.</z><z id="t1563486085" t="donaldball Hey, if you use :strict-path-params? with url-for , it throws on what seem to be a lot of false positives. Digging in a little bit, it seems that if your current route has path-params, and you do not dissoc them when calling url-for on a route that does not use all of those path-params, pedestal will throw: https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/route/src/io/pedestal/http/route.clj#L257-L258 I would fairly expect this to be a subset check, not an equality check. Is there a wrinkle I’m missing?"><y>#</y><d>2019-07-18</d><h>21:41</h><w>donaldball</w>Hey, if you use <code>:strict-path-params?</code> with <code>url-for</code>, it throws on what seem to be a lot of false positives. Digging in a little bit, it seems that if your current route has path-params, and you do not dissoc them when calling <code>url-for</code> on a route that does not use all of those path-params, pedestal will throw:

<a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/route/src/io/pedestal/http/route.clj#L257-L258" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/route/src/io/pedestal/http/route.clj#L257-L258</a>

I would fairly expect this to be a subset check, not an equality check. Is there a wrinkle I’m missing?</z><z id="t1563542287" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U04V4HWQ4&quot;}] , :strict-path-params? used to be less strict. For the full story see https://github.com/pedestal/pedestal/issues/572 ."><y>#</y><d>2019-07-19</d><h>13:18</h><r>ddeaguiar</r>Hi <a>@U04V4HWQ4</a>, <code>:strict-path-params?</code> used to be less strict. For the full story see <a href="https://github.com/pedestal/pedestal/issues/572" target="_blank">https://github.com/pedestal/pedestal/issues/572</a>.</z><z id="t1563542616" t="donaldball My take is that the combination of features here - that the path-params seems to default to those of the current route, and that strict mode throws on unexpected params - results in a strict mode that’s not usable in the general case. The only thing I want from a strict mode is validating that the params a route needs exist and are valid"><y>#</y><d>2019-07-19</d><h>13:23</h><r>donaldball</r>My take is that the combination of features here - that the path-params seems to default to those of the current route, and that strict mode throws on unexpected params - results in a strict mode that’s not usable in the general case.

The only thing I want from a strict mode is validating that the params a route needs exist and are valid</z><z id="t1563543633" t="ddeaguiar Sorry this doesn’t seem to meet your needs. I’m not sure what you mean by not useable in the general case. If a path param is present on a route then the assumption is that it is needed. The current implementation of strict mode verifies this. Validation is a separate issue and is service specific. Service interceptors can handle that."><y>#</y><d>2019-07-19</d><h>13:40</h><r>ddeaguiar</r>Sorry this doesn’t seem to meet your needs. I’m not sure what you mean by not useable in the general case. If a path param is present on a route then the assumption is that it is needed.  The current implementation of strict mode verifies this. Validation is a separate issue and is service specific. Service interceptors can handle that.</z><z id="t1563544210" t="donaldball I mean that if you’re working on a traditional server-rendered html webapp, for example, and you’re in the context of a deeply nested resource (e.g. /org/:org-id/loc/:loc-id/zone/:zone-id ), and your navbar generates links to ancestor resources, you either can’t use strict mode, or you have to manually dissoc the extraneous params at every call site."><y>#</y><d>2019-07-19</d><h>13:50</h><r>donaldball</r>I mean that if you’re working on a traditional server-rendered html webapp, for example, and you’re in the context of a deeply nested resource (e.g. <code>/org/:org-id/loc/:loc-id/zone/:zone-id</code>), and your navbar generates links to ancestor resources, you either can’t use strict mode, or you have to manually dissoc the extraneous params at every call site.</z><z id="t1563544334" t="donaldball M take is just that strict mode is doing two things that could and should be separated is all"><y>#</y><d>2019-07-19</d><h>13:52</h><r>donaldball</r>M take is just that strict mode is doing two things that could and should be separated is all</z><z id="t1563492662" t="Braden Shepherdson another oddity: the docs say that :params is the combined :body-params , :path-params and :query-params - I&apos;m only using :path-params and it isn&apos;t being set. I&apos;m not sure what interceptor does that behavior, if it isn&apos;t just the docs being out of date."><y>#</y><d>2019-07-18</d><h>23:31</h><w>Braden Shepherdson</w>another oddity: the docs say that <code>:params</code> is the combined <code>:body-params</code>, <code>:path-params</code> and <code>:query-params</code> - I&apos;m only using <code>:path-params</code> and it isn&apos;t being set. I&apos;m not sure what interceptor does that behavior, if it isn&apos;t just the docs being out of date.</z><z id="t1563543950" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCY0GT0QM&quot;}] the docs are not correct, sorry you were caught by this. In general Pedestal abides by the following principle: If something is separate, keep it separate. If something can be customized via an interceptor, keep the base code as basic as possible I’ll create an issue in the pedestal.docs repo and update the docs."><y>#</y><d>2019-07-19</d><h>13:45</h><r>ddeaguiar</r><a>@UCY0GT0QM</a> the docs are not correct, sorry you were caught by this. In general Pedestal abides by the following principle:

If something is separate, keep it separate. If something can be customized via an interceptor, keep the base code as basic as possible

I’ll create an issue in the pedestal.docs repo and update the docs.</z><z id="t1563543993" t="Braden Shepherdson Thanks, I appreciate it."><y>#</y><d>2019-07-19</d><h>13:46</h><r>Braden Shepherdson</r>Thanks, I appreciate it.</z><z id="t1563544002" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-07-19</d><h>13:46</h><r>ddeaguiar</r><b>:thumbsup:</b></z><z id="t1563539133" t="orestis I had the same experience with docs etc about this — I resorted to looking at the source to figure out the correct interceptors for what I want."><y>#</y><d>2019-07-19</d><h>12:25</h><w>orestis</w>I had the same experience with docs etc about this — I resorted to looking at the source to figure out the correct interceptors for what I want.</z><z id="t1563544014" t="Braden Shepherdson I&apos;m loving the power and flexibility of Pedestal, despite the friction of the incomplete and sometimes inaccurate docs."><y>#</y><d>2019-07-19</d><h>13:46</h><w>Braden Shepherdson</w>I&apos;m loving the power and flexibility of Pedestal, despite the friction of the incomplete and sometimes inaccurate docs.</z><z id="t1563544063" t="Braden Shepherdson in particular, I&apos;m delighted with how I can use all of the interceptor machinery in some code intended to handle actions taken in a turn-based game."><y>#</y><d>2019-07-19</d><h>13:47</h><w>Braden Shepherdson</w>in particular, I&apos;m delighted with how I can use all of the interceptor machinery in some code intended to handle actions taken in a turn-based game.</z><z id="t1563544093" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] , yeah the docs are a lagging and a constant wip. Please create issues in the https://github.com/pedestal/pedestal-docs repo whenever you encounter incorrect information! It’s greatly appreciated 🙂"><y>#</y><d>2019-07-19</d><h>13:48</h><w>ddeaguiar</w><a>@orestis</a>, yeah the docs are a lagging and a constant wip. Please create issues in the <a href="https://github.com/pedestal/pedestal-docs" target="_blank">https://github.com/pedestal/pedestal-docs</a> repo whenever you encounter incorrect information! It’s greatly appreciated <b>🙂</b></z><z id="t1563547864" t="orestis Oh, I didn’t realize it’s a separate repo. I’ll have a look once I’m back in that area of my app. "><y>#</y><d>2019-07-19</d><h>14:51</h><r>orestis</r>Oh, I didn’t realize it’s a separate repo. I’ll have a look once I’m back in that area of my app. </z><z id="t1563548002" t="ddeaguiar np, thanks!"><y>#</y><d>2019-07-19</d><h>14:53</h><r>ddeaguiar</r>np, thanks!</z><z id="t1563544120" t="Braden Shepherdson using a &quot;router&quot; that matches action keywords to their interceptor chains. that lets me write interceptors that eg. check it&apos;s your turn, or that a move is legal before enacting it."><y>#</y><d>2019-07-19</d><h>13:48</h><w>Braden Shepherdson</w>using a &quot;router&quot; that matches action keywords to their interceptor chains. that lets me write interceptors that eg. check it&apos;s your turn, or that a move is legal before enacting it.</z><z id="t1563544185" t="Braden Shepherdson and unlike in most languages, where this kind of thing is a &quot;pattern&quot; I have to reimplement, it&apos;s just code I can reuse."><y>#</y><d>2019-07-19</d><h>13:49</h><w>Braden Shepherdson</w>and unlike in most languages, where this kind of thing is a &quot;pattern&quot; I have to reimplement, it&apos;s just code I can reuse.</z><z id="t1563569616" t="Braden Shepherdson I&apos;m struggling with reloading the server. sometimes it seems to get wedged, and even though I&apos;m doing a reload-all of my top-level server, and then restarting it, I&apos;m getting the old set of routes and interceptors."><y>#</y><d>2019-07-19</d><h>20:53</h><w>Braden Shepherdson</w>I&apos;m struggling with reloading the server. sometimes it seems to get wedged, and even though I&apos;m doing a reload-all of my top-level server, and then restarting it, I&apos;m getting the old set of routes and interceptors.</z><z id="t1563570060" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCY0GT0QM&quot;}] you may want to give pedestal.service-tools watch a spin. ( https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23-L36 )"><y>#</y><d>2019-07-19</d><h>21:01</h><w>ddeaguiar</w><a>@braden.shepherdson</a> you may want to give pedestal.service-tools <code>watch</code> a spin. (<a href="https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23-L36" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj#L23-L36</a>)</z><z id="t1563570094" t="ddeaguiar couple that with run-dev and you should see your route changes take effect"><y>#</y><d>2019-07-19</d><h>21:01</h><w>ddeaguiar</w>couple that with run-dev and you should see your route changes take effect</z><z id="t1563653210" t="stacktracer In Pedestal examples, the keywords used for path-params are always non-namespaced (e.g. &quot;/users/:id/posts/:post&quot; ). Is it possible to use namespaced keywords (e.g. &quot;/users/::id/posts/::post&quot; )? If it&apos;s possible, is it desirable?"><y>#</y><d>2019-07-20</d><h>20:06</h><w>stacktracer</w>In Pedestal examples, the keywords used for path-params are always non-namespaced (e.g. <code>&quot;/users/:id/posts/:post&quot;</code>). Is it possible to use namespaced keywords (e.g. <code>&quot;/users/::id/posts/::post&quot;</code>)? If it&apos;s possible, is it desirable?</z><z id="t1563719249" t="souenzzo i think that #reitit has a &quot;custom DSL&quot; that allows it."><y>#</y><d>2019-07-21</d><h>14:27</h><r>souenzzo</r>i think that #reitit has a &quot;custom DSL&quot; that allows it.</z><z id="t1563743256" t="stacktracer Thanks!"><y>#</y><d>2019-07-21</d><h>21:07</h><r>stacktracer</r>Thanks!</z><z id="t1563658519" t="Daouda Hey Folks, I’m using a pedestal service and defining my routes this way: (def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/about&quot; :get (conj common-interceptors `about-page)] [&quot;/locaux&quot; :post (conj common-interceptors `create-user)]}) But i would to have it in this format: (def routes #{[&quot;/&quot; ^:interceptors [common-interceptors] [&quot;/api&quot; [&quot;/home&quot; :get `home-page] [&quot;/about&quot; :get `about-page] [&quot;/locaux&quot; :post `create-user]]]}) So far not success. Need your help guys 😄"><y>#</y><d>2019-07-20</d><h>21:35</h><w>Daouda</w>Hey Folks, I’m using a pedestal service and defining my routes this way:
<pre>(def routes
  #{[&quot;/&quot; :get (conj common-interceptors `home-page)]
    [&quot;/about&quot; :get (conj common-interceptors `about-page)]
    [&quot;/locaux&quot; :post (conj common-interceptors `create-user)]})</pre>
But i would to have it in this format:
<pre>(def routes
  #{[&quot;/&quot; ^:interceptors [common-interceptors]
     [&quot;/api&quot;
      [&quot;/home&quot; :get `home-page]
      [&quot;/about&quot; :get `about-page]
      [&quot;/locaux&quot; :post `create-user]]]})</pre>
So far not success. Need your help guys <b>😄</b></z><z id="t1563801219" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UEA9PJ9FE&quot;}] , pedestal.route’s table syntax does not support nesting. The terse syntax does. Some documentation regarding it can be found http://pedestal.io/reference/routing-quick-reference#_terse_syntax ."><y>#</y><d>2019-07-22</d><h>13:13</h><w>ddeaguiar</w><a>@quieterkali</a>, pedestal.route’s table syntax does not support nesting. The terse syntax does. Some documentation regarding it can be found <a href="http://pedestal.io/reference/routing-quick-reference#_terse_syntax" target="_blank">http://pedestal.io/reference/routing-quick-reference#_terse_syntax</a>.</z><z id="t1563915711" t="m0smith Hi everyone. I just started a job writing a REST API or GraphQL API in clojure and we had started with pedestal. I am running into a problem trying to get swagger going as the libraries are out of date. Is anyone implementing swagger in Pedestal and if so, what libraries are your using? thanks in advance"><y>#</y><d>2019-07-23</d><h>21:01</h><w>m0smith</w>Hi everyone.  I just started a job writing a REST API or GraphQL API in clojure and we had started with pedestal.  I am running into a problem trying to get swagger going as the libraries are out of date.  Is anyone implementing swagger in Pedestal and if so, what libraries are your using?   thanks in advance</z><z id="t1563988070" t="ikitommi [:attrs {:href &quot;/_/_/users/U050VTWMB&quot;}] maybe https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger"><y>#</y><d>2019-07-24</d><h>17:07</h><w>ikitommi</w><a>@m0smith</a> maybe <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a></z><z id="t1563996856" t="m0smith Thanks I&apos;ll take a look"><y>#</y><d>2019-07-24</d><h>19:34</h><w>m0smith</w>Thanks I&apos;ll take a look</z><z id="t1564170797" t="Faisal Hasnain Looking for Pedestal integration with Netty. I didn’t see any sample/guide for that use case. https://github.com/pedestal/pedestal/tree/master/samples"><y>#</y><d>2019-07-26</d><h>19:53</h><w>Faisal Hasnain</w>Looking for Pedestal integration with Netty. I didn’t see any sample/guide for that use case. <a href="https://github.com/pedestal/pedestal/tree/master/samples" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples</a></z><z id="t1564170981" t="Faisal Hasnain I am curious about how Pedestal performance and features compare to Yada/Aleph? Specially with Pedestal/Netty. Any thoughts?"><y>#</y><d>2019-07-26</d><h>19:56</h><w>Faisal Hasnain</w>I am curious about how Pedestal performance and features compare to Yada/Aleph? Specially with Pedestal/Netty. Any thoughts?</z><z id="t1564438699" t="asilverman #pedestal - I am seeing issues when I update pedestal.service and pedestal.jetty to version 0.5.7, any clues what might be causing my http server to stop responding to requests?"><y>#</y><d>2019-07-29</d><h>22:18</h><w>asilverman</w>#pedestal - I am seeing issues when I update <code>pedestal.service</code> and <code>pedestal.jetty</code> to version 0.5.7, any clues what might be causing my http server to stop responding to requests?</z><z id="t1564438780" t="asilverman #pedestal also, can someone be kind and explain the ns-watching feature of pedestal/sevice.tools or point me out to some documentation on the subject?"><y>#</y><d>2019-07-29</d><h>22:19</h><w>asilverman</w>#pedestal also, can someone be kind and explain the ns-watching feature of <code>pedestal/sevice.tools</code> or point me out to some documentation on the subject?</z><z id="t1564494229" t="souenzzo [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] It&apos;s about BREAKING CHANGE: nil ::host in service map defaults to localhost now (rather than being container specific) #557. ? https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018"><y>#</y><d>2019-07-30</d><h>13:43</h><w>souenzzo</w><a>@ariel.silverman</a>
It&apos;s about <code>BREAKING CHANGE: nil ::host in service map defaults to localhost now (rather than being container specific) #557.</code> ?
<a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#054---june-29-2018</a></z><z id="t1564505261" t="asilverman Thank you for replying [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , I don’t think this is it, I am moving from 0.5.5 to 0.5.7. I had that issue fixed back last month."><y>#</y><d>2019-07-30</d><h>16:47</h><r>asilverman</r>Thank you for replying <a>@souenzzo</a>, I don’t think this is it, I am moving from 0.5.5 to 0.5.7. I had that issue fixed back last month.</z><z id="t1564505518" t="asilverman #pedestal - gotta love the “pull requests welcome message” found here: http://pedestal.io/reference/jetty"><y>#</y><d>2019-07-30</d><h>16:51</h><w>asilverman</w>#pedestal - gotta love the “pull requests welcome message” found here: <a href="http://pedestal.io/reference/jetty" target="_blank">http://pedestal.io/reference/jetty</a></z><z id="t1564506198" t="asilverman [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] - Now that I think about it maybe I addressed issue 054 incorrectly, what I did was the following: In my pedestal config I added { ... ::http/host &quot;0.0.0.0&quot;} "><y>#</y><d>2019-07-30</d><h>17:03</h><w>asilverman</w><a>@souenzzo</a> - Now that I think about it maybe I addressed issue 054 incorrectly, what I did was the following:
In my pedestal config I added
<pre>{ 
...
::http/host              &quot;0.0.0.0&quot;}
</pre></z><z id="t1564506234" t="asilverman maybe this is not the appropriate fix for 054"><y>#</y><d>2019-07-30</d><h>17:03</h><w>asilverman</w>maybe this is not the appropriate fix for 054</z><z id="t1564506278" t="jvtrigueros Are you running it inside a container?"><y>#</y><d>2019-07-30</d><h>17:04</h><w>jvtrigueros</w>Are you running it inside a container?</z><z id="t1564506289" t="souenzzo ::http/host &quot;0.0.0.0&quot; should work for dev setup"><y>#</y><d>2019-07-30</d><h>17:04</h><w>souenzzo</w><code>::http/host &quot;0.0.0.0&quot;</code> should work for <code>dev</code> setup</z><z id="t1564506311" t="asilverman [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] I run in a container that is deployed to ECS (AWS)"><y>#</y><d>2019-07-30</d><h>17:05</h><w>asilverman</w><a>@jvtrigueros</a> I run in a container that is deployed to ECS (AWS)</z><z id="t1564506323" t="asilverman this is my config for prod"><y>#</y><d>2019-07-30</d><h>17:05</h><w>asilverman</w>this is my config for prod</z><z id="t1564506335" t="jvtrigueros 0.0.0.0 is an unsafe default but necessary if running inside a container"><y>#</y><d>2019-07-30</d><h>17:05</h><w>jvtrigueros</w><code>0.0.0.0</code> is an unsafe default but necessary if running inside a container</z><z id="t1564506349" t="souenzzo It works on local/REPL?"><y>#</y><d>2019-07-30</d><h>17:05</h><w>souenzzo</w>It works on local/REPL?</z><z id="t1564506387" t="asilverman yeah, I am only seeing a timeout of the http server when I deploy to the higher environments"><y>#</y><d>2019-07-30</d><h>17:06</h><w>asilverman</w>yeah, I am only seeing a timeout of the http server when I deploy to the higher environments</z><z id="t1564506459" t="asilverman I saw there were some changes to the container-options for jetty"><y>#</y><d>2019-07-30</d><h>17:07</h><w>asilverman</w>I saw there were some changes to the <code>container-options</code> for jetty</z><z id="t1564506480" t="asilverman I am setting ssl via: {::http/container-options {:h2c? true :h2? false :keystore &quot;./config/keystore.p12&quot; :keystore-type &quot;PKCS12&quot; :key-password &quot;qwerty&quot; :ssl-port 9302 :ssl? false}}"><y>#</y><d>2019-07-30</d><h>17:08</h><w>asilverman</w>I am setting ssl via:
<pre>{::http/container-options {:h2c?          true
                             :h2?           false
                             :keystore      &quot;./config/keystore.p12&quot;
                             :keystore-type &quot;PKCS12&quot;
                             :key-password  &quot;qwerty&quot;
                             :ssl-port      9302
                             :ssl?          false}}</pre></z><z id="t1564506959" t="asilverman honestly I am looking to get maybe some background and docs on :io.pedestal.http.jetty/http-configuration because its pretty opaque and there is no docs I could find on it"><y>#</y><d>2019-07-30</d><h>17:15</h><w>asilverman</w>honestly I am looking to get maybe some background and docs on <code>:io.pedestal.http.jetty/http-configuration</code> because its pretty opaque and there is no docs I could find on it</z><z id="t1564506987" t="asilverman looks like maybe my cloud deployment was the issue, however I am starting to feel the pain with the lack of documentation in pedestal."><y>#</y><d>2019-07-30</d><h>17:16</h><w>asilverman</w>looks like maybe my cloud deployment was the issue, however I am starting to feel the pain with the lack of documentation in pedestal.</z><z id="t1564509372" t="jvtrigueros I&apos;ve been following this conversation, but I&apos;m still confused as to what the issue is that you&apos;re facing. I understand the docs are limited, so perhaps once you&apos;re past this a small PR would go a long way 🙂 Anyway, what exactly are you having issues with? And is there a repo I can look at and perhaps reproduce?"><y>#</y><d>2019-07-30</d><h>17:56</h><w>jvtrigueros</w>I&apos;ve been following this conversation, but I&apos;m still confused as to what the issue is that you&apos;re facing. I understand the docs are limited, so perhaps once you&apos;re past this a small PR would go a long way <b>🙂</b>

Anyway, what exactly are you having issues with? And is there a repo I can look at and perhaps reproduce?</z><z id="t1564591853" t="asilverman [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] - It turns out that we had an issue with our deployment pipeline and not with the actual code. Thanks for following up. Regarding your comments, its increasingly harder to use pedestal in a production setup when many of the configurations are missing documentation and its unclear what are the side effects of such configurations"><y>#</y><d>2019-07-31</d><h>16:50</h><r>asilverman</r><a>@jvtrigueros</a> - It turns out that we had an issue with our deployment pipeline and not with the actual code. Thanks for following up.
Regarding your comments, its increasingly harder to use pedestal in a production setup when many of the configurations are missing documentation and its unclear what are the side effects of such configurations</z><z id="t1564524509" t="Daouda Hey Folks, is there a way of a function to coerce data when entering my api with pedestal? Something that i pass de data and the schema to coerce then will try to coerce for me."><y>#</y><d>2019-07-30</d><h>22:08</h><w>Daouda</w>Hey Folks, is there a way of a function to coerce data when entering my api with pedestal?
Something that i pass de data and the schema to coerce then will try to coerce for me.</z><z id="t1564540150" t="jvtrigueros I imagine you would do this with an interceptor. An interceptor has two stages, incoming and outgoing (don&apos;t remember proper terms from memory)."><y>#</y><d>2019-07-31</d><h>02:29</h><r>jvtrigueros</r>I imagine you would do this with an interceptor. An interceptor has two stages, incoming and outgoing (don&apos;t remember proper terms from memory).</z><z id="t1564591915" t="asilverman [:attrs {:href &quot;/_/_/users/UEA9PJ9FE&quot;}] I have been doing this via a custom interceptor as a pattern"><y>#</y><d>2019-07-31</d><h>16:51</h><r>asilverman</r><a>@quieterkali</a> I have been doing this via a custom interceptor as a pattern</z><z id="t1564601626" t="ikitommi Maybe https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger"><y>#</y><d>2019-07-31</d><h>19:33</h><r>ikitommi</r>Maybe <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a></z><z id="t1564601693" t="ikitommi e.g. using reitit + Pedestal, you can use schema or spec to define the data and have generic coercion interceptors do the transform based on the models"><y>#</y><d>2019-07-31</d><h>19:34</h><r>ikitommi</r>e.g. using reitit + Pedestal, you can use schema or spec to define the data and have generic coercion interceptors do the transform based on the models</z><z id="t1564823730" t="Daouda Thank you very much, you guys helped a lot 😄"><y>#</y><d>2019-08-03</d><h>09:15</h><r>Daouda</r>Thank you very much, you guys helped a lot <b>😄</b></z><z id="t1564591853" t="asilverman [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] - It turns out that we had an issue with our deployment pipeline and not with the actual code. Thanks for following up. Regarding your comments, its increasingly harder to use pedestal in a production setup when many of the configurations are missing documentation and its unclear what are the side effects of such configurations"><y>#</y><d>2019-07-31</d><h>16:50</h><w>asilverman</w><a>@jvtrigueros</a> - It turns out that we had an issue with our deployment pipeline and not with the actual code. Thanks for following up.
Regarding your comments, its increasingly harder to use pedestal in a production setup when many of the configurations are missing documentation and its unclear what are the side effects of such configurations</z><z id="t1564591915" t="asilverman [:attrs {:href &quot;/_/_/users/UEA9PJ9FE&quot;}] I have been doing this via a custom interceptor as a pattern"><y>#</y><d>2019-07-31</d><h>16:51</h><w>asilverman</w><a>@quieterkali</a> I have been doing this via a custom interceptor as a pattern</z><z id="t1564592299" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] , sorry to hear you ran into issues. The documentation is a continual work in progress. Creating an issue in the pedestal-docs repo would be helpful in prioritizing what gets updated when. PRs are always welcome and appreciated! https://github.com/pedestal/pedestal-docs ."><y>#</y><d>2019-07-31</d><h>16:58</h><w>ddeaguiar</w><a>@ariel.silverman</a>, sorry to hear you ran into issues. The documentation is a continual work in progress. Creating an issue in the pedestal-docs repo would be helpful in prioritizing what gets updated when. PRs are always welcome and appreciated! <a href="https://github.com/pedestal/pedestal-docs" target="_blank">https://github.com/pedestal/pedestal-docs</a>.</z><z id="t1564679963" t="asilverman https://github.com/pedestal/pedestal-docs/issues/127"><y>#</y><d>2019-08-01</d><h>17:19</h><r>asilverman</r><a href="https://github.com/pedestal/pedestal-docs/issues/127" target="_blank">https://github.com/pedestal/pedestal-docs/issues/127</a></z><z id="t1564679963" t="asilverman https://github.com/pedestal/pedestal-docs/issues/127"><y>#</y><d>2019-08-01</d><h>17:19</h><w>asilverman</w><a href="https://github.com/pedestal/pedestal-docs/issues/127" target="_blank">https://github.com/pedestal/pedestal-docs/issues/127</a></z><z id="t1564737664" t="David Pham Is there anywhere where we can fund money to get documentation for pedestal? Like we had with shadow-cljs?"><y>#</y><d>2019-08-02</d><h>09:21</h><w>David Pham</w>Is there anywhere where we can fund money to get documentation for pedestal? Like we had with shadow-cljs?</z><z id="t1564761276" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UEQGQ6XH7&quot;}] , not at this time!"><y>#</y><d>2019-08-02</d><h>15:54</h><w>ddeaguiar</w><a>@neo2551</a>, not at this time!</z><z id="t1565021503" t="Janne Sauvala Hello, I’m trying out Pedestal with deps.edn. Do you have a recommended way to deploy Pedestal server that uses deps.edn?"><y>#</y><d>2019-08-05</d><h>16:11</h><w>Janne Sauvala</w>Hello, I’m trying out Pedestal with deps.edn. Do you have a recommended way to deploy Pedestal server that uses deps.edn?</z><z id="t1565025286" t="souenzzo just run clojure -m my-app.core in your server [:attrs {:href &quot;/_/_/users/UJZ6S8YR2&quot;}]"><y>#</y><d>2019-08-05</d><h>17:14</h><w>souenzzo</w>just run <code>clojure -m my-app.core</code> in your server <a>@janne.sauvala</a></z><z id="t1565035776" t="Janne Sauvala Oh right. This is handy if I don’t need to create a jar. Just place my files within a container and run that :face_with_monocle:"><y>#</y><d>2019-08-05</d><h>20:09</h><r>Janne Sauvala</r>Oh right. This is handy if I don’t need to create a jar. Just place my files within a container and run that <b>:face_with_monocle:</b></z><z id="t1565050270" t="souenzzo #datomic ions, a &quot;cloud environment&quot; by cognitect deploy things just zipping local folder and dumping into server"><y>#</y><d>2019-08-06</d><h>00:11</h><r>souenzzo</r>#datomic ions, a &quot;cloud environment&quot; by cognitect deploy things just zipping local folder and dumping into server</z><z id="t1565068663" t="Janne Sauvala Thanks, this is really helpful to know 👍 :skin-tone-2:"><y>#</y><d>2019-08-06</d><h>05:17</h><r>Janne Sauvala</r>Thanks, this is really helpful to know <b>👍</b><b>:skin-tone-2:</b></z><z id="t1565288356" t="Joe Lane [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] , yesterday I succeeded at adding vase to datomic cloud as an ion. It was non-trivial and I&apos;ve Identified a few bugs in the current CloudConnection record which prevented ions from working out of the box. I&apos;d like to contribute back to vase, but in order to write tests for this functionality it would require ions be deployed in the test harness. How would you like me to proceed (I&apos;ve already signed the CA)?"><y>#</y><d>2019-08-08</d><h>18:19</h><w>Joe Lane</w><a>@ddeaguiar</a>, yesterday I succeeded at adding vase to datomic cloud as an ion.

It was non-trivial and I&apos;ve Identified a few bugs in the current CloudConnection record which prevented ions from working out of the box.

I&apos;d like to contribute back to vase, but in order to write tests for this functionality it would require ions be deployed in the test harness.

How would you like me to proceed (I&apos;ve already signed the CA)?</z><z id="t1565288693" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] thanks for taking the initiative on this! The Datomic Cloud tests are not part of the current CI builds. IIRC, the assumption is that a Datomic Cloud instance has been provisioned. I’d need to think more through how we’d want to accommodate testing for this but I’m interested in learning more about the issues. Perhaps create a PR just for demonstration purposes?"><y>#</y><d>2019-08-08</d><h>18:24</h><w>ddeaguiar</w><a>@lanejo01</a> thanks for taking the initiative on this! The Datomic Cloud tests are not part of the current CI builds. IIRC, the assumption is that a Datomic Cloud instance has been provisioned. I’d need to think more through how we’d want to accommodate testing for this but I’m interested in learning more about the issues. Perhaps create a PR just for demonstration purposes?</z><z id="t1565289436" t="Joe Lane Will Do. I&apos;m using it on a work project right now so I have a LOT of doc ideas for fern style vase usage."><y>#</y><d>2019-08-08</d><h>18:37</h><w>Joe Lane</w>Will Do. I&apos;m using it on a work project right now so I have a LOT of doc ideas for fern style vase usage.</z><z id="t1565289583" t="ddeaguiar sweet 🙂"><y>#</y><d>2019-08-08</d><h>18:39</h><w>ddeaguiar</w>sweet <b>🙂</b></z><z id="t1566220378" t="gerred 👋 does anyone have an example of the reloading with tools.deps?"><y>#</y><d>2019-08-19</d><h>13:12</h><w>gerred</w><b>👋</b> does anyone have an example of the reloading with tools.deps?</z><z id="t1566220420" t="gerred i guess I can just use the template and pull out the run-dev function and other tools"><y>#</y><d>2019-08-19</d><h>13:13</h><w>gerred</w>i guess I can just use the template and pull out the run-dev function and other tools</z><z id="t1566484010" t="Karol Wójcik Is there a way to use pedestal with aleph?"><y>#</y><d>2019-08-22</d><h>14:26</h><w>Karol Wójcik</w>Is there a way to use pedestal with aleph?</z><z id="t1566486542" t="ouvasam Hi, i coudn&apos;t find the way to properly use http/transit-body. Is there an example that show how to send a response in trnasit from json data ? Thanks"><y>#</y><d>2019-08-22</d><h>15:09</h><w>ouvasam</w>Hi, i coudn&apos;t find the way to properly use http/transit-body. Is there an example that show how to send a response in trnasit from json data ? Thanks</z><z id="t1566612349" t="ghaskins Hi All, sorry to cross post between #clojure and here, but I wanted to announce a new tool my team has written called “Protojure” ( https://protojure.github.io/#grpc-services-in-clj ). Its relevant here because you can use it to generate GRPC servers in pedestal"><y>#</y><d>2019-08-24</d><h>02:05</h><w>ghaskins</w>Hi All, sorry to cross post between #clojure and here, but I wanted to announce a new tool my team has written called “Protojure” (<a href="https://protojure.github.io/#grpc-services-in-clj" target="_blank">https://protojure.github.io/#grpc-services-in-clj</a>).  Its relevant here because you can use it to generate GRPC servers in pedestal</z><z id="t1566612365" t="ghaskins let me know what you think"><y>#</y><d>2019-08-24</d><h>02:06</h><w>ghaskins</w>let me know what you think</z><z id="t1566612636" t="ghaskins https://github.com/protojure/protoc-plugin/tree/master/examples/hello"><y>#</y><d>2019-08-24</d><h>02:10</h><w>ghaskins</w><a href="https://github.com/protojure/protoc-plugin/tree/master/examples/hello" target="_blank">https://github.com/protojure/protoc-plugin/tree/master/examples/hello</a></z><z id="t1567003098" t="erwinrooijakkers Hi all, what is an example of a session map to pass to ::http/enable-session ?"><y>#</y><d>2019-08-28</d><h>14:38</h><w>erwinrooijakkers</w>Hi all, what is an example of a session map to pass to <code>::http/enable-session</code>?</z><z id="t1567003485" t="souenzzo By default this map will be used here (from ring.middleware.session ) (defn- session-options [options] {:store (options :store (mem/memory-store)) :cookie-name (options :cookie-name &quot;ring-session&quot;) :cookie-attrs (merge {:path &quot;/&quot; :http-only true} (options :cookie-attrs) (if-let [root (options :root)] {:path root}))}) "><y>#</y><d>2019-08-28</d><h>14:44</h><r>souenzzo</r>By default this map will be used here
(from <code>ring.middleware.session</code> )
<pre>(defn- session-options
  [options]
  {:store        (options :store (mem/memory-store))
   :cookie-name  (options :cookie-name &quot;ring-session&quot;)
   :cookie-attrs (merge {:path &quot;/&quot;
                         :http-only true}
                        (options :cookie-attrs)
                        (if-let [root (options :root)]
                          {:path root}))})
</pre></z><z id="t1567003574" t="souenzzo so your map should contain #{:store :cookie-name :cookie-attrs :root}"><y>#</y><d>2019-08-28</d><h>14:46</h><r>souenzzo</r>so your map should contain <code>#{:store :cookie-name :cookie-attrs :root}</code></z><z id="t1567003140" t="erwinrooijakkers &gt; :enable-session: A settings map to include the session middleware interceptor. If nil, this interceptor is not added. Default is nil."><y>#</y><d>2019-08-28</d><h>14:39</h><w>erwinrooijakkers</w>&gt;<b>:enable-session:</b> A settings map to include the session middleware interceptor. If nil, this interceptor is not added.  Default is nil.</z><z id="t1567003399" t="ddeaguiar As per ring session opts: https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L16-L18"><y>#</y><d>2019-08-28</d><h>14:43</h><w>ddeaguiar</w>As per ring session opts: <a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L16-L18" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/session.clj#L16-L18</a></z><z id="t1567003426" t="erwinrooijakkers Perfect. That’s the default?"><y>#</y><d>2019-08-28</d><h>14:43</h><w>erwinrooijakkers</w>Perfect. That’s the default?</z><z id="t1567003433" t="erwinrooijakkers Can I just add true ?"><y>#</y><d>2019-08-28</d><h>14:43</h><w>erwinrooijakkers</w>Can I just add <code>true</code>?</z><z id="t1567003481" t="erwinrooijakkers Thanks"><y>#</y><d>2019-08-28</d><h>14:44</h><w>erwinrooijakkers</w>Thanks</z><z id="t1567003496" t="ddeaguiar Those are the defaults so should be able to add :enable-session {} to service map"><y>#</y><d>2019-08-28</d><h>14:44</h><w>ddeaguiar</w>Those are the defaults so should be able to add <code>:enable-session {}</code> to service map</z><z id="t1567004228" t="erwinrooijakkers Thanks works 🙂"><y>#</y><d>2019-08-28</d><h>14:57</h><w>erwinrooijakkers</w>Thanks works <b>🙂</b></z><z id="t1567006195" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-08-28</d><h>15:29</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1567006467" t="erwinrooijakkers Hmm actually the cookie is not stored"><y>#</y><d>2019-08-28</d><h>15:34</h><w>erwinrooijakkers</w>Hmm actually the cookie is not stored</z><z id="t1567006629" t="erwinrooijakkers I expect a ring-session cookie, but it is not added"><y>#</y><d>2019-08-28</d><h>15:37</h><w>erwinrooijakkers</w>I expect a ring-session cookie, but it is not added</z><z id="t1567006654" t="erwinrooijakkers I use the default settings, probably miss something"><y>#</y><d>2019-08-28</d><h>15:37</h><w>erwinrooijakkers</w>I use the default settings, probably miss something</z><z id="t1567006671" t="erwinrooijakkers (ns my-service (:require [io.pedestal.http :as http] [io.pedestal.http.body-params :as body-params] [io.pedestal.http.route :as route] [ring.util.response :as ring-resp])) (defn start [request] (println &quot;start&quot; request) (ring-resp/response (format &quot;Clojure %s - served from %s&quot; (clojure-version) (route/url-for ::start)))) (defn auth [request] (println &quot;auth&quot; request) (ring-resp/response &quot;Hello World!&quot;)) (def common-interceptors [(body-params/body-params) http/html-body]) (def routes #{[&quot;/start&quot; :get (conj common-interceptors `start)] [&quot;/auth&quot; :get (conj common-interceptors `auth)]}) (def service {:env :prod ::http/routes routes ::http/enable-session {} ::http/resource-path &quot;/public&quot; ::http/type :jetty ::http/host &quot;0.0.0.0&quot; ::http/port 8080 ::http/container-options {:h2c? true :h2? false :ssl? false}}) "><y>#</y><d>2019-08-28</d><h>15:37</h><w>erwinrooijakkers</w><pre>(ns my-service
  (:require [io.pedestal.http :as http]
            [io.pedestal.http.body-params :as body-params]
            [io.pedestal.http.route :as route]
            [ring.util.response :as ring-resp]))

(defn start
  [request]
  (println &quot;start&quot; request)
  (ring-resp/response (format &quot;Clojure %s - served from %s&quot;
                              (clojure-version)
                              (route/url-for ::start))))

(defn auth
  [request]
  (println &quot;auth&quot; request)
  (ring-resp/response &quot;Hello World!&quot;))

(def common-interceptors
  [(body-params/body-params) http/html-body])

(def routes
  #{[&quot;/start&quot; :get (conj common-interceptors `start)]
    [&quot;/auth&quot; :get (conj common-interceptors `auth)]})

(def service
  {:env :prod
   ::http/routes routes
   ::http/enable-session {}
   ::http/resource-path &quot;/public&quot;
   ::http/type :jetty
   ::http/host &quot;0.0.0.0&quot;
   ::http/port 8080
   ::http/container-options {:h2c? true
                             :h2? false
                             :ssl? false}})
</pre></z><z id="t1567006747" t="erwinrooijakkers It does add :session/key"><y>#</y><d>2019-08-28</d><h>15:39</h><w>erwinrooijakkers</w>It does add <code>:session/key</code></z><z id="t1567006751" t="erwinrooijakkers Always nil"><y>#</y><d>2019-08-28</d><h>15:39</h><w>erwinrooijakkers</w>Always nil</z><z id="t1567006779" t="erwinrooijakkers And a :session that’s also nil"><y>#</y><d>2019-08-28</d><h>15:39</h><w>erwinrooijakkers</w>And a <code>:session</code> that’s also nil</z><z id="t1567006781" t="erwinrooijakkers No cookies in response"><y>#</y><d>2019-08-28</d><h>15:39</h><w>erwinrooijakkers</w>No cookies in response</z><z id="t1567006808" t="erwinrooijakkers What else do I have to add? Or return a different type of response?"><y>#</y><d>2019-08-28</d><h>15:40</h><w>erwinrooijakkers</w>What else do I have to add? Or return a different type of response?</z><z id="t1567006977" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2PGHFU5U&quot;}] have you looked at https://github.com/ring-clojure/ring/wiki/Sessions ?"><y>#</y><d>2019-08-28</d><h>15:42</h><w>ddeaguiar</w><a>@erwinrooijakkers</a> have you looked at <a href="https://github.com/ring-clojure/ring/wiki/Sessions" target="_blank">https://github.com/ring-clojure/ring/wiki/Sessions</a>?</z><z id="t1567007059" t="erwinrooijakkers Yes saw it. I also saw https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj"><y>#</y><d>2019-08-28</d><h>15:44</h><w>erwinrooijakkers</w>Yes saw it. I also saw <a href="https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/ring-middleware/src/ring_middleware/service.clj</a></z><z id="t1567007100" t="erwinrooijakkers There’s an example there so I apparently have to do more"><y>#</y><d>2019-08-28</d><h>15:45</h><w>erwinrooijakkers</w>There’s an example there so I apparently have to do more</z><z id="t1567007107" t="erwinrooijakkers Create an interceptor"><y>#</y><d>2019-08-28</d><h>15:45</h><w>erwinrooijakkers</w>Create an interceptor</z><z id="t1567007230" t="erwinrooijakkers Don’t know how it related to the service map"><y>#</y><d>2019-08-28</d><h>15:47</h><w>erwinrooijakkers</w>Don’t know how it related to the service map</z><z id="t1567007237" t="erwinrooijakkers And ::http/enable-session {}"><y>#</y><d>2019-08-28</d><h>15:47</h><w>erwinrooijakkers</w>And <code>   ::http/enable-session {}</code></z><z id="t1567007255" t="ddeaguiar If you use io.pedestal.http/default-interceptors without setting the :io.pedestal.http/interceptors kw then it should create the session interceptor for you when ::http/enable-session is provided"><y>#</y><d>2019-08-28</d><h>15:47</h><w>ddeaguiar</w>If you use <code>io.pedestal.http/default-interceptors</code> without setting the <code>:io.pedestal.http/interceptors</code> kw then it should create the session interceptor for you when <code>::http/enable-session</code> is provided</z><z id="t1567007266" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L208-L209"><y>#</y><d>2019-08-28</d><h>15:47</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L208-L209" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L208-L209</a></z><z id="t1567007292" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L257"><y>#</y><d>2019-08-28</d><h>15:48</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L257" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L257</a></z><z id="t1567007298" t="erwinrooijakkers Ah ok so I need default inerceptors"><y>#</y><d>2019-08-28</d><h>15:48</h><w>erwinrooijakkers</w>Ah ok so I need default inerceptors</z><z id="t1567007314" t="ddeaguiar yep, sorry. Assumed that you were using that"><y>#</y><d>2019-08-28</d><h>15:48</h><w>ddeaguiar</w>yep, sorry. Assumed that you were using that</z><z id="t1567007393" t="erwinrooijakkers Hmm how do I add those?"><y>#</y><d>2019-08-28</d><h>15:49</h><w>erwinrooijakkers</w>Hmm how do I add those?</z><z id="t1567007448" t="erwinrooijakkers Oh Is ee"><y>#</y><d>2019-08-28</d><h>15:50</h><w>erwinrooijakkers</w>Oh Is ee</z><z id="t1567007451" t="erwinrooijakkers there are already added"><y>#</y><d>2019-08-28</d><h>15:50</h><w>erwinrooijakkers</w>there are already added</z><z id="t1567007456" t="ddeaguiar https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27"><y>#</y><d>2019-08-28</d><h>15:50</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L27</a></z><z id="t1567007465" t="erwinrooijakkers At least in run-dev"><y>#</y><d>2019-08-28</d><h>15:51</h><w>erwinrooijakkers</w>At least in run-dev</z><z id="t1567007477" t="erwinrooijakkers Not in -main it seems like"><y>#</y><d>2019-08-28</d><h>15:51</h><w>erwinrooijakkers</w>Not in -main it seems like</z><z id="t1567007481" t="erwinrooijakkers From the pedestal-service template"><y>#</y><d>2019-08-28</d><h>15:51</h><w>erwinrooijakkers</w>From the pedestal-service template</z><z id="t1567007482" t="ddeaguiar they are"><y>#</y><d>2019-08-28</d><h>15:51</h><w>ddeaguiar</w>they are</z><z id="t1567007497" t="erwinrooijakkers ;; This is an adapted service map, that can be started and stopped ;; From the REPL you can call server/start and server/stop on this service (defonce runnable-service (server/create-server service/service)) (defn run-dev &quot;The entry-point for &apos;lein run-dev&apos;&quot; [&amp; args] (println &quot;\nCreating your [DEV] server...&quot;) (-&gt; service/service ;; start with production configuration (merge {:env :dev ;; do not block thread that starts web server ::server/join? false ;; Routes can be a function that resolve routes, ;; we can use this to set the routes to be reloadable ::server/routes #(route/expand-routes (deref #&apos;service/routes)) ;; all origins are allowed in dev mode ::server/allowed-origins {:creds true :allowed-origins (constantly true)} ;; Content Security Policy (CSP) is mostly turned off in dev mode ::server/secure-headers {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}}}) ;; Wire up interceptor chains server/default-interceptors server/dev-interceptors server/create-server server/start)) (defn -main &quot;The entry-point for &apos;lein run&apos;&quot; [&amp; args] (println &quot;\nCreating your server...&quot;) (server/start runnable-service)) "><y>#</y><d>2019-08-28</d><h>15:51</h><w>erwinrooijakkers</w><pre>;; This is an adapted service map, that can be started and stopped
;; From the REPL you can call server/start and server/stop on this service
(defonce runnable-service
  (server/create-server service/service))

(defn run-dev
  &quot;The entry-point for &apos;lein run-dev&apos;&quot;
  [&amp; args]
  (println &quot;\nCreating your [DEV] server...&quot;)
  (-&gt; service/service ;; start with production configuration
      (merge {:env :dev
              ;; do not block thread that starts web server
              ::server/join? false
              ;; Routes can be a function that resolve routes,
              ;; we can use this to set the routes to be reloadable
              ::server/routes #(route/expand-routes (deref #&apos;service/routes))
              ;; all origins are allowed in dev mode
              ::server/allowed-origins {:creds true :allowed-origins (constantly true)}
              ;; Content Security Policy (CSP) is mostly turned off in dev mode
              ::server/secure-headers {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}}})
      ;; Wire up interceptor chains
      server/default-interceptors
      server/dev-interceptors
      server/create-server
      server/start))

(defn -main
  &quot;The entry-point for &apos;lein run&apos;&quot;
  [&amp; args]
  (println &quot;\nCreating your server...&quot;)
  (server/start runnable-service))
</pre></z><z id="t1567007506" t="erwinrooijakkers In server.cljs"><y>#</y><d>2019-08-28</d><h>15:51</h><w>erwinrooijakkers</w>In <code>server.cljs</code></z><z id="t1567007533" t="ddeaguiar create-server calls create-provider which does this https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L323"><y>#</y><d>2019-08-28</d><h>15:52</h><w>ddeaguiar</w><code>create-server</code> calls <code>create-provider</code> which does this <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L323" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L323</a></z><z id="t1567007557" t="erwinrooijakkers Okay so I have the default-interceptors thnaks"><y>#</y><d>2019-08-28</d><h>15:52</h><w>erwinrooijakkers</w>Okay so I have the default-interceptors thnaks</z><z id="t1567007575" t="erwinrooijakkers And default enable-session {} should create cookie store"><y>#</y><d>2019-08-28</d><h>15:52</h><w>erwinrooijakkers</w>And default <code>enable-session {}</code> should create cookie store</z><z id="t1567007581" t="erwinrooijakkers And a ring-session cookie"><y>#</y><d>2019-08-28</d><h>15:53</h><w>erwinrooijakkers</w>And a ring-session cookie</z><z id="t1567007583" t="erwinrooijakkers But that does not happen"><y>#</y><d>2019-08-28</d><h>15:53</h><w>erwinrooijakkers</w>But that does not happen</z><z id="t1567007585" t="ddeaguiar are you putting stuff in session?"><y>#</y><d>2019-08-28</d><h>15:53</h><w>ddeaguiar</w>are you putting stuff in session?</z><z id="t1567007587" t="erwinrooijakkers No"><y>#</y><d>2019-08-28</d><h>15:53</h><w>erwinrooijakkers</w>No</z><z id="t1567007590" t="ddeaguiar refer to that doc"><y>#</y><d>2019-08-28</d><h>15:53</h><w>ddeaguiar</w>refer to that doc</z><z id="t1567007672" t="erwinrooijakkers Ah if I add something to the session, then there’s a cookie"><y>#</y><d>2019-08-28</d><h>15:54</h><w>erwinrooijakkers</w>Ah if I add something to the session, then there’s a cookie</z><z id="t1567007692" t="erwinrooijakkers Great"><y>#</y><d>2019-08-28</d><h>15:54</h><w>erwinrooijakkers</w>Great</z><z id="t1567007695" t="erwinrooijakkers Thanks!"><y>#</y><d>2019-08-28</d><h>15:54</h><w>erwinrooijakkers</w>Thanks!</z><z id="t1567012286" t="ddeaguiar :thumbsup:"><y>#</y><d>2019-08-28</d><h>17:11</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1567090206" t="erwinrooijakkers I want to add custom logging"><y>#</y><d>2019-08-29</d><h>14:50</h><w>erwinrooijakkers</w>I want to add custom logging</z><z id="t1567090239" t="erwinrooijakkers The goal is basically to ignore requests from a certain IP range"><y>#</y><d>2019-08-29</d><h>14:50</h><w>erwinrooijakkers</w>The goal is basically to ignore requests from a certain IP range</z><z id="t1567090248" t="erwinrooijakkers (Kubernetes master calling “/”)"><y>#</y><d>2019-08-29</d><h>14:50</h><w>erwinrooijakkers</w>(Kubernetes master calling “/”)</z><z id="t1567090263" t="erwinrooijakkers I’ve got some Ring middleware to do that"><y>#</y><d>2019-08-29</d><h>14:51</h><w>erwinrooijakkers</w>I’ve got some Ring middleware to do that</z><z id="t1567090272" t="erwinrooijakkers Is there a way to include that in Pedestal?"><y>#</y><d>2019-08-29</d><h>14:51</h><w>erwinrooijakkers</w>Is there a way to include that in Pedestal?</z><z id="t1567090291" t="erwinrooijakkers Now I see this: INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} ... That needs to go"><y>#</y><d>2019-08-29</d><h>14:51</h><w>erwinrooijakkers</w>Now I see this:

<pre>INFO  io.pedestal.http  - {:msg &quot;GET /&quot;, :line 80}
INFO  io.pedestal.http  - {:msg &quot;GET /&quot;, :line 80}
INFO  io.pedestal.http  - {:msg &quot;GET /&quot;, :line 80}
...
</pre>

That needs to go</z><z id="t1567090342" t="erwinrooijakkers Middleware looks like this: (defn logging-middleware [handler] (-&gt; handler (middleware.conditional/if not-request-from-internal-ip? wrap-with-info-logger))) "><y>#</y><d>2019-08-29</d><h>14:52</h><w>erwinrooijakkers</w>Middleware looks like this:

<pre>(defn logging-middleware [handler]
  (-&gt; handler
      (middleware.conditional/if not-request-from-internal-ip? wrap-with-info-logger)))
</pre></z><z id="t1567091586" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2PGHFU5U&quot;}] you can provide your own request logger. See https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206"><y>#</y><d>2019-08-29</d><h>15:13</h><w>ddeaguiar</w><a>@erwinrooijakkers</a> you can provide your own request logger. See <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205-L206</a></z><z id="t1567091621" t="ddeaguiar Add :io.pedestal.http/request-logger to your service map"><y>#</y><d>2019-08-29</d><h>15:13</h><w>ddeaguiar</w>Add <code>:io.pedestal.http/request-logger</code> to your service map</z><z id="t1567091641" t="erwinrooijakkers thanks 🙂"><y>#</y><d>2019-08-29</d><h>15:14</h><w>erwinrooijakkers</w>thanks <b>🙂</b></z><z id="t1567092817" t="erwinrooijakkers Works like a charm"><y>#</y><d>2019-08-29</d><h>15:33</h><w>erwinrooijakkers</w>Works like a charm</z><z id="t1567092891" t="erwinrooijakkers For those interested: (defn- from-internal-ip? &quot;Returns truthy when a request does not come from an internal IP (e.g., a Kubernetes node)&quot; [{:keys [server-name] :as request}] (let [internal-ip-start &quot;10.&quot;] (string/starts-with? (str server-name) internal-ip-start))) (def log-request &quot;Log the request&apos;s method and uri.&quot; (interceptor.helpers/on-request ::log-request (fn [request] (when-not (from-internal-ip? request) (log/info :msg (format &quot;%s %s&quot; (string/upper-case (name (:request-method request))) (:uri request)))) request))) "><y>#</y><d>2019-08-29</d><h>15:34</h><w>erwinrooijakkers</w>For those interested:

<pre>(defn- from-internal-ip?
  &quot;Returns truthy when a request does not come from an internal IP (e.g., a
  Kubernetes node)&quot;
  [{:keys [server-name] :as request}]
  (let [internal-ip-start &quot;10.&quot;]
    (string/starts-with? (str server-name) internal-ip-start)))

(def log-request
  &quot;Log the request&apos;s method and uri.&quot;
  (interceptor.helpers/on-request
   ::log-request
   (fn [request]
     (when-not (from-internal-ip? request)
       (log/info :msg (format &quot;%s %s&quot;
                              (string/upper-case (name (:request-method request)))
                              (:uri request))))
     request)))
</pre></z><z id="t1567378796" t="jjttjj Let&apos;s say I want an interceptor that will check a cache for some value args that should already be in the context map. if it exists, the val for that args key should be the response. Otherwise, continue the interceptor chain, and when there is a response cache it. (def cache (atom {})) {:enter (fn [{:keys [args] :as ctx}] (if (contains? @cache args) (chain/terminate ctx) ctx)) :leave (fn [{:keys [response args] :as ctx}] (if response (do (swap! cache assoc args response) ctx) (assoc ctx :response (get @cache))))} Is this the standard way this should be implemented? It would feel more natural to me to assoc the cached response if it exists in the enter function (but then i&apos;d be updating the cache every time even when a value already exists for it). Are there any obvious better ways to handle this?"><y>#</y><d>2019-09-01</d><h>22:59</h><w>jjttjj</w>Let&apos;s say I want an interceptor that will check a cache for some value <code>args</code> that should already be in the context map. if it exists, the val for that <code>args</code> key should be the response. Otherwise, continue the interceptor chain, and when there is a response cache it.

 <pre>(def cache (atom {}))

{:enter (fn [{:keys [args] :as ctx}]
          (if (contains? @cache args)
            (chain/terminate ctx)
            ctx))
 :leave (fn [{:keys [response args] :as ctx}]
          (if response
            (do (swap! cache assoc args response) ctx)
            (assoc ctx :response (get @cache))))}
</pre>
Is this the standard way this should be implemented? It would feel more natural to me to assoc the cached response if it exists in the enter function (but then i&apos;d be updating the cache every time even when a value already exists for it). Are there any obvious better ways to handle this?</z><z id="t1567389930" t="jjttjj On further thought, it makes more sense either seperating these two transducers, or probaly better yet, in :enter , if the value is cached, assoc the response and terminate, if not, enqueue a leave function that caches the result"><y>#</y><d>2019-09-02</d><h>02:05</h><w>jjttjj</w>On further thought, it makes more sense either seperating these two transducers, or probaly better yet, in <code>:enter</code>, if the value is cached, assoc the response and terminate, if not, enqueue a leave function that caches the result</z><z id="t1567760949" t="martinklepsch After upgrading to 0.5.7 from 0.5.3 my service is no longer working inside docker. I’m assuming it is related to the now mandatory-ish ::host key in the services map. Did anybody else encounter this issue and if so, what value are you setting ::host to?"><y>#</y><d>2019-09-06</d><h>09:09</h><w>martinklepsch</w>After upgrading to 0.5.7 from 0.5.3 my service is no longer working inside docker. I’m assuming it is related to the now mandatory-ish <code>::host</code> key in the services map. Did anybody else encounter this issue and if so, what value are you setting <code>::host</code> to?</z><z id="t1567761988" t="martinklepsch I guess 0.0.0.0 works but it’s a little bit annoying having to special case running the service inside docker."><y>#</y><d>2019-09-06</d><h>09:26</h><r>martinklepsch</r>I guess <code>0.0.0.0</code> works but it’s a little bit annoying having to special case running the service inside docker.</z><z id="t1567772519" t="nitaai Hello everybody. I have a question: I have a Ring middleware which wraps the whole middleware chain in a DB transaction and rolls back in the end in case there was an exception? How does one do that in Pedestal with interceptors?"><y>#</y><d>2019-09-06</d><h>12:21</h><w>nitaai</w>Hello everybody. I have a question: I have a Ring middleware which wraps the whole middleware chain in a DB transaction and rolls back in the end in case there was an exception? How does one do that in Pedestal with interceptors?</z><z id="t1567802898" t="mv Hello everyone. I am trying to build a new vase application, but the template from lein seems to be quite old (2017) and doesn’t reference any of the fern updates. Is that something that can be fixed?"><y>#</y><d>2019-09-06</d><h>20:48</h><w>mv</w>Hello everyone. I am trying to build a new vase application, but the template from lein seems to be quite old (2017) and doesn’t reference any of the fern updates. Is that something that can be fixed?</z><z id="t1568032260" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0PD452UA&quot;}] , it will be addressed with the next release. Timing of that is still TBD."><y>#</y><d>2019-09-09</d><h>12:31</h><r>ddeaguiar</r><a>@U0PD452UA</a>, it will be addressed with the next release. Timing of that is still TBD.</z><z id="t1568041947" t="mv [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thank you"><y>#</y><d>2019-09-09</d><h>15:12</h><r>mv</r><a>@U0FL657GR</a> thank you</z><z id="t1568041961" t="mv Anything I can do to help?"><y>#</y><d>2019-09-09</d><h>15:12</h><r>mv</r>Anything I can do to help?</z><z id="t1568042289" t="ddeaguiar Nothing atm but I appreciate the offer! I just need to allocate the time to wrap it up"><y>#</y><d>2019-09-09</d><h>15:18</h><r>ddeaguiar</r>Nothing atm but I appreciate the offer! I just need to allocate the time to wrap it up</z><z id="t1567976877" t="hadils Hi all! I am working with lacinia-pedestal and I want to add cookie-sessions. Here&apos;s my handler : (defn handler &quot;Ion handler. Start up backend processes.&quot; [service-map] (-&gt; service-map (assoc ::http/resource-path &quot;/public&quot; ::http/allowed-origins (constantly true) ::http/chain-provider provider/ion-provider ::http/enable-session {:store cookie/cookie-store}) cast-log http/create-provider cast-log)) which enables the Ring middleware session interceptor. Unfortunately, I am having difficulty writing an interceptor that will put a session on the HTTP browser. I would appreciate any suggestions, help, etc. you might have on this. Thanks!"><y>#</y><d>2019-09-08</d><h>21:07</h><w>hadils</w>Hi all! I am working with lacinia-pedestal and I want to add cookie-sessions. Here&apos;s my <code>handler</code>:
<pre>(defn handler
  &quot;Ion handler. Start up backend processes.&quot;
  [service-map]
  (-&gt; service-map
      (assoc ::http/resource-path &quot;/public&quot;
             ::http/allowed-origins (constantly true)
             ::http/chain-provider provider/ion-provider
             ::http/enable-session {:store cookie/cookie-store})
      cast-log
      http/create-provider
      cast-log))</pre>
which enables the Ring middleware session interceptor. Unfortunately, I am having difficulty writing an interceptor that will put a session on the HTTP browser. I would appreciate any suggestions, help, etc. you might have on this. Thanks!</z><z id="t1567990774" t="hadils This seems to be a tools.deps.alpha problem."><y>#</y><d>2019-09-09</d><h>00:59</h><w>hadils</w>This seems to be a <code>tools.deps.alpha</code> problem.</z><z id="t1568023840" t="hadils Never mind. There was a bug in the way I built my service map."><y>#</y><d>2019-09-09</d><h>10:10</h><w>hadils</w>Never mind. There was a bug in the way I built my service map.</z><z id="t1568705059" t="ouvasam Hi, i have a problem with routes and i can&apos;t find the solution"><y>#</y><d>2019-09-17</d><h>07:24</h><w>ouvasam</w>Hi, i have a problem with routes and i can&apos;t find the solution</z><z id="t1568705060" t="ouvasam &quot;/api&quot; {:interceptors [http/transit-body] &quot;/echo&quot; {:get `api/echo} &quot;/catalogues&quot; {:get `[:catalogues api/get]} &quot;/code-systems&quot; {:get `[:code-systems api/get]} &quot;/code-systems/formats&quot; {:get `[:code-system-formats api/get]} &quot;/code-systems/formats/:format&quot; {:get `[:code-system-format api/get]} &quot;/code-systems/:id&quot; {:get `[:code-system-details api/get]} &quot;/code-systems/:id/concepts&quot; {:get `[:code-system-concepts api/get]} &quot;/code-systems/:id/concepts/:id&quot; {:get `[:code-system-concept-details api/get]}"><y>#</y><d>2019-09-17</d><h>07:24</h><w>ouvasam</w>&quot;/api&quot;        {:interceptors [http/transit-body]
                       &quot;/echo&quot;          {:get `api/echo}
                       &quot;/catalogues&quot;                        {:get `[:catalogues api/get]}
                       &quot;/code-systems&quot;                      {:get `[:code-systems api/get]}
                       &quot;/code-systems/formats&quot;              {:get `[:code-system-formats api/get]}
                       &quot;/code-systems/formats/:format&quot;      {:get `[:code-system-format api/get]}
                       &quot;/code-systems/:id&quot;                  {:get `[:code-system-details api/get]}
                       &quot;/code-systems/:id/concepts&quot;         {:get `[:code-system-concepts api/get]}
                       &quot;/code-systems/:id/concepts/:id&quot;     {:get `[:code-system-concept-details api/get]}</z><z id="t1568705076" t="ouvasam Why does &quot;/code-systems/formats/:format&quot; {:get `[:code-system-format api/get]} return 404 ?"><y>#</y><d>2019-09-17</d><h>07:24</h><w>ouvasam</w>Why does &quot;/code-systems/formats/:format&quot;      {:get `[:code-system-format api/get]} return 404 ?</z><z id="t1568712382" t="orestis Reading from a phone, and lack of highlighting doesn’t help, but I don’t think you’re supposed to wrap :get [,,,] in a map. I’m surprised you don’t get an error. "><y>#</y><d>2019-09-17</d><h>09:26</h><w>orestis</w>Reading from a phone, and lack of highlighting doesn’t help, but I don’t think you’re supposed to wrap <code>:get [,,,]</code> in a map. I’m surprised you don’t get an error. </z><z id="t1568712421" t="orestis If you paste your entire routes definition it might be easier to catch. "><y>#</y><d>2019-09-17</d><h>09:27</h><w>orestis</w>If you paste your entire routes definition it might be easier to catch. </z><z id="t1568724661" t="ouvasam Hi [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] and thanks for your response. I am new to pedestal and i can&apos;t find a way to make these routes working"><y>#</y><d>2019-09-17</d><h>12:51</h><w>ouvasam</w>Hi <a>@orestis</a> and thanks for your response. I am new to pedestal and i can&apos;t find a way to make these routes working</z><z id="t1568724674" t="ouvasam (def routes #{&quot;/&quot; {:get pages/home} &quot;/health&quot; {:get `api/health} &quot;/app&quot; {:interceptors [http/html-body] &quot;&quot; {:get `pages/spa}} &quot;/api&quot; {:interceptors [http/transit-body] &quot;/echo&quot; {:get `api/echo} &quot;/catalogues&quot; {:get `[:catalogues api/get]} &quot;/code-systems&quot; {:get `[:code-systems api/get]} &quot;/code-systems/formats&quot; {:get `[:code-system-formats api/get]} &quot;/code-systems/formats/ATC&quot; {:get `[:code-system-format api/get]} &quot;/code-systems/:id&quot; {:constraints {:id #&quot;[0-9]+&quot;} :get `[:code-system-details api/get]} ; &quot;/code-systems/:id/concepts&quot; {:get `[:code-system-concepts api/get]} ; &quot;/code-systems/:id/concepts/:id&quot; {:get `[:code-system-concept-details api/get]} &quot;/user&quot; {:get `api/user}}})"><y>#</y><d>2019-09-17</d><h>12:51</h><w>ouvasam</w>(def routes
  #{&quot;/&quot; {:get          pages/home}

        &quot;/health&quot;     {:get `api/health}

        &quot;/app&quot;        {:interceptors [http/html-body]
                       &quot;&quot;            {:get `pages/spa}}

        &quot;/api&quot;        {:interceptors [http/transit-body]
                       &quot;/echo&quot;          {:get `api/echo}
                       &quot;/catalogues&quot;                        {:get `[:catalogues api/get]}
                       &quot;/code-systems&quot;                      {:get `[:code-systems api/get]}
                       &quot;/code-systems/formats&quot;              {:get `[:code-system-formats api/get]}
                       &quot;/code-systems/formats/ATC&quot;          {:get `[:code-system-format api/get]}
                       &quot;/code-systems/:id&quot;                  {:constraints {:id #&quot;[0-9]+&quot;} :get `[:code-system-details api/get]}
                       ; &quot;/code-systems/:id/concepts&quot;         {:get `[:code-system-concepts api/get]}
                       ; &quot;/code-systems/:id/concepts/:id&quot;     {:get `[:code-system-concept-details api/get]}
                       &quot;/user&quot;          {:get `api/user}}})</z><z id="t1568724682" t="ouvasam (def service {;; do not block thread that starts web server :: http/join? false :: http/port port :: http/host &quot;0.0.0.0&quot; :: http/resource-path &quot;/public&quot; :: http/routes (route/expand-routes routes) :: http/enable-session {:cookie-name &quot;SID&quot; :store (cookie/cookie-store)} :: http/type :jetty ;; for dev only? :: http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}} :: http/container-options {:h2c? true :h2? false :ssl? false}})"><y>#</y><d>2019-09-17</d><h>12:51</h><w>ouvasam</w>(def service
  {;; do not block thread that starts web server
   <b>::</b>http/join?             false
   <b>::</b>http/port              port
   <b>::</b>http/host              &quot;0.0.0.0&quot;
   <b>::</b>http/resource-path     &quot;/public&quot;
   <b>::</b>http/routes            (route/expand-routes routes)
   <b>::</b>http/enable-session    {:cookie-name &quot;SID&quot;
                             :store       (cookie/cookie-store)}
   <b>::</b>http/type              :jetty
   ;; for dev only?
   <b>::</b>http/secure-headers    {:content-security-policy-settings {:object-src &quot;none&quot;}}
   <b>::</b>http/container-options {:h2c? true
                             :h2?  false
                             :ssl? false}})</z><z id="t1568724738" t="ouvasam i did try to change to sopmething like this"><y>#</y><d>2019-09-17</d><h>12:52</h><w>ouvasam</w>i did try to change to sopmething like this</z><z id="t1568724740" t="ouvasam (def routes [[[&quot;/&quot; :get pages/home [&quot;/app&quot; {:get pages/spa} ^:interceptors [http/html-body]]]]])"><y>#</y><d>2019-09-17</d><h>12:52</h><w>ouvasam</w>(def routes
  [[[&quot;/&quot; :get  pages/home
     [&quot;/app&quot; {:get pages/spa} ^:interceptors [http/html-body]]]]])</z><z id="t1568724746" t="ouvasam but i have this error"><y>#</y><d>2019-09-17</d><h>12:52</h><w>ouvasam</w>but i have this error</z><z id="t1568724746" t="gerred [:attrs {:href &quot;/_/_/users/U0F7M1KA7&quot;}]"><y>#</y><d>2019-09-17</d><h>12:52</h><w>gerred</w><a>@ouvasam</a></z><z id="t1568724752" t="gerred there&apos;s a snippets feature in Slack if you click the paperclip, like this:"><y>#</y><d>2019-09-17</d><h>12:52</h><w>gerred</w>there&apos;s a snippets feature in Slack if you click the paperclip, like this:</z><z id="t1568724754" t="ouvasam Caused by: java.lang.IllegalArgumentException: No implementation of method: :expand-verb-action of protocol: #&apos;io.pedestal.http.route.definition.terse/ExpandableVerbAction found for class: app.html_pages$spa"><y>#</y><d>2019-09-17</d><h>12:52</h><w>ouvasam</w>Caused by: java.lang.IllegalArgumentException: No implementation of method: :expand-verb-action of protocol: #&apos;io.pedestal.http.route.definition.terse/ExpandableVerbAction found for class: app.html_pages$spa</z><z id="t1568724761" t="ouvasam Ok sorry"><y>#</y><d>2019-09-17</d><h>12:52</h><w>ouvasam</w>Ok sorry</z><z id="t1568724768" t="gerred"><y>#</y><d>2019-09-17</d><h>12:52</h><w>gerred</w></z><z id="t1568724770" t="gerred there you go 🙂"><y>#</y><d>2019-09-17</d><h>12:52</h><w>gerred</w>there you go <b>🙂</b></z><z id="t1568724778" t="gerred now it&apos;s expandable and has code highlighting."><y>#</y><d>2019-09-17</d><h>12:52</h><w>gerred</w>now it&apos;s expandable and has code highlighting.</z><z id="t1568724793" t="ouvasam thanks and sorry for that"><y>#</y><d>2019-09-17</d><h>12:53</h><w>ouvasam</w>thanks and sorry for that</z><z id="t1568724800" t="gerred no worries if you didn&apos;t know you didn&apos;t know. 🙂"><y>#</y><d>2019-09-17</d><h>12:53</h><w>gerred</w>no worries if you didn&apos;t know you didn&apos;t know. <b>🙂</b></z><z id="t1568726680" t="ouvasam Even with this new routes, last route does not work (api/code-systems/formats/test1) -&gt; 404 not found"><y>#</y><d>2019-09-17</d><h>13:24</h><w>ouvasam</w>Even with this new routes, last route does not work (api/code-systems/formats/test1) -&gt; 404 not found</z><z id="t1568730720" t="orestis That is a weird route syntax. I’m only familiar with the table syntax..."><y>#</y><d>2019-09-17</d><h>14:32</h><w>orestis</w>That is a weird route syntax. I’m only familiar with the table syntax...</z><z id="t1568730957" t="orestis http://pedestal.io/reference/routing-quick-reference - doesn’t seem to be a need to quote the vector as you do?"><y>#</y><d>2019-09-17</d><h>14:35</h><w>orestis</w><a href="http://pedestal.io/reference/routing-quick-reference" target="_blank">http://pedestal.io/reference/routing-quick-reference</a> - doesn’t seem to be a need to quote the vector as you do?</z><z id="t1568731433" t="ouvasam If i don&apos;t quote i haave error like Caused by: java.lang.IllegalArgumentException: No implementation of method: :expand-verb-action of protocol: #&apos;io.pedestal.http.route.definition.terse/ExpandableVerbAction found for class: app.html_pages$spa"><y>#</y><d>2019-09-17</d><h>14:43</h><w>ouvasam</w>If i don&apos;t quote i haave error like Caused by: java.lang.IllegalArgumentException: No implementation of method: :expand-verb-action of protocol: #&apos;io.pedestal.http.route.definition.terse/ExpandableVerbAction found for class: app.html_pages$spa</z><z id="t1568731504" t="ouvasam But i think i&apos;ll go with reitit ring. There is not so much documentation on pedestal and i am not able to understand via the api documentation. Many thanks [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}]"><y>#</y><d>2019-09-17</d><h>14:45</h><w>ouvasam</w>But i think i&apos;ll go with reitit ring. There is not so much documentation on pedestal and i am not able to understand via the api documentation. Many thanks <a>@orestis</a></z><z id="t1568731973" t="orestis I won’t blame you — I’ve only used the table syntax because it’s the only one that made some sense. The syntax you’re using looks very fiddly to get right."><y>#</y><d>2019-09-17</d><h>14:52</h><w>orestis</w>I won’t blame you — I’ve only used the table syntax because it’s the only one that made some sense. The syntax you’re using looks very fiddly to get right.</z><z id="t1569032274" t="Braden Shepherdson I&apos;m trying to get SSE working, and ran into this: ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 314} clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedes tal.http.sse/start-event-stream41445 - No implementation of method: :exec of protocol: #&apos;clojure.core.async.impl.protocols/Executor found for class: clojure.core.async.impl.e xec.threadpool$thread_pool_executor$reify__8430 at clojure.core$ex_info.invokeStatic(core.clj:4739) at clojure.core$ex_info.invoke(core.clj:4739) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:3 5) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32) at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57) at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44) at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic( j:171) "><y>#</y><d>2019-09-21</d><h>02:17</h><w>Braden Shepherdson</w>I&apos;m trying to get SSE working, and ran into this:
<pre>ERROR i.p.http.impl.servlet-interceptor  - {:msg &quot;Dev interceptor caught an exception;
Forwarding it as the response.&quot;, :line 314}
clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedes
tal.http.sse/start-event-stream41445 - No implementation of method: :exec of protocol:
#&apos;clojure.core.async.impl.protocols/Executor found for class: clojure.core.async.impl.e
xec.threadpool$thread_pool_executor$reify__8430
        at clojure.core$ex_info.invokeStatic(core.clj:4739)
        at clojure.core$ex_info.invoke(core.clj:4739)
        at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:3
5)
        at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)
        at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)
        at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)
        at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic(
j:171)
</pre></z><z id="t1569425090" t="dangercoder any up to date &quot;create-pedstal-app&quot; tool?"><y>#</y><d>2019-09-25</d><h>15:24</h><w>dangercoder</w>any up to date &quot;create-pedstal-app&quot; tool?</z><z id="t1569434698" t="nenadalm there is leiningen template: https://github.com/pedestal/pedestal/tree/master/service-template but I never used it."><y>#</y><d>2019-09-25</d><h>18:04</h><r>nenadalm</r>there is leiningen template: <a href="https://github.com/pedestal/pedestal/tree/master/service-template" target="_blank">https://github.com/pedestal/pedestal/tree/master/service-template</a> but I never used it.</z><z id="t1569453985" t="Braden Shepherdson I&apos;m struggling with Pedestal SSE"><y>#</y><d>2019-09-25</d><h>23:26</h><w>Braden Shepherdson</w>I&apos;m struggling with Pedestal SSE</z><z id="t1569454169" t="Braden Shepherdson I&apos;m following the guide, but I end up getting an error that reads in part clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedes tal.http.sse/start-event-stream41958 - No implementation of method: :exec of protocol: #&apos;clojure.core.async.impl.protocols/Executor found for class: clojure.core.async.impl.e xec.threadpool$thread_pool_executor$reify__8430 at clojure.core$ex_info.invokeStatic(core.clj:4739) at clojure.core$ex_info.invoke(core.clj:4739) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:3 5) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32) at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57) at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44) at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic( j:171) "><y>#</y><d>2019-09-25</d><h>23:29</h><w>Braden Shepherdson</w>I&apos;m following the guide, but I end up getting an error that reads in part
<pre>clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedes
tal.http.sse/start-event-stream41958 - No implementation of method: :exec of protocol:
#&apos;clojure.core.async.impl.protocols/Executor found for class: clojure.core.async.impl.e
xec.threadpool$thread_pool_executor$reify__8430
        at clojure.core$ex_info.invokeStatic(core.clj:4739)
        at clojure.core$ex_info.invoke(core.clj:4739)
        at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:3
5)
        at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)
        at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)
        at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)
        at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic(
j:171)
</pre></z><z id="t1569454196" t="Braden Shepherdson which looks like I&apos;ve either forgotten to set up a default executor, or like I&apos;m trying to call something from a main thread that needs to be called on the side."><y>#</y><d>2019-09-25</d><h>23:29</h><w>Braden Shepherdson</w>which looks like I&apos;ve either forgotten to set up a default executor, or like I&apos;m trying to call something from a main thread that needs to be called on the side.</z><z id="t1569989356" t="wei what&apos;s the best way to route /item/:uuid.json to one handler and /item/:uuid.csv to another handler?"><y>#</y><d>2019-10-02</d><h>04:09</h><w>wei</w>what&apos;s the best way to route /item/:uuid.json to one handler and /item/:uuid.csv to another handler?</z><z id="t1570009012" t="orestis I think Reitit can do that, not sure about pedestals router..."><y>#</y><d>2019-10-02</d><h>09:36</h><r>orestis</r>I think Reitit can do that, not sure about pedestals router...</z><z id="t1570003591" t="erwinrooijakkers I am using Lacinia Pedestal and want to set some cookies to expired"><y>#</y><d>2019-10-02</d><h>08:06</h><w>erwinrooijakkers</w>I am using Lacinia Pedestal and want to set some cookies to expired</z><z id="t1570003693" t="erwinrooijakkers What I tried to set multiple cookies is this interceptor: (def make-some-cookies-interceptor (fn [request] {:status 200 :headers {&quot;Set-Cookie&quot; &quot;a=; b=; c=; path=/;&quot;}})) This works only for the first cookie a . I also want to create a cookie b and c . What is the correct way to create multiple cookies?"><y>#</y><d>2019-10-02</d><h>08:08</h><w>erwinrooijakkers</w>What I tried to set multiple cookies is this interceptor:

<pre>(def make-some-cookies-interceptor
  (fn [request]
    {:status 200
     :headers {&quot;Set-Cookie&quot; &quot;a=; b=; c=; path=/;&quot;}}))
</pre>

This works only for the first cookie <code>a</code>. I also want to create a cookie <code>b</code> and <code>c</code>.

What is the correct way to create multiple cookies?</z><z id="t1570008952" t="orestis Perhaps you should also at the generic Clojure channel as you might get some ring-specific advice"><y>#</y><d>2019-10-02</d><h>09:35</h><r>orestis</r>Perhaps you should also at the generic Clojure channel as you might get some ring-specific advice</z><z id="t1570009833" t="erwinrooijakkers Thanks I will"><y>#</y><d>2019-10-02</d><h>09:50</h><r>erwinrooijakkers</r>Thanks I will</z><z id="t1570014954" t="orestis BTW I looked into this via https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie -- it seems that you can only set one cookie at a time"><y>#</y><d>2019-10-02</d><h>11:15</h><r>orestis</r>BTW I looked into this via <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie</a> -- it seems that you can only set one cookie at a time</z><z id="t1570014969" t="orestis so perhaps you could pass in a vector of headers instead?"><y>#</y><d>2019-10-02</d><h>11:16</h><r>orestis</r>so perhaps you could pass in a vector of headers instead?</z><z id="t1570014992" t="orestis {&quot;Set-Cookie&quot; [&quot;a=; path=/;&quot; &quot;b=; path=/;&quot;]}"><y>#</y><d>2019-10-02</d><h>11:16</h><r>orestis</r><code>{&quot;Set-Cookie&quot; [&quot;a=; path=/;&quot; &quot;b=; path=/;&quot;]}</code></z><z id="t1570015001" t="orestis Not sure if that works, haven&apos;t tried it"><y>#</y><d>2019-10-02</d><h>11:16</h><r>orestis</r>Not sure if that works, haven&apos;t tried it</z><z id="t1570015398" t="erwinrooijakkers It works…"><y>#</y><d>2019-10-02</d><h>11:23</h><r>erwinrooijakkers</r>It works…</z><z id="t1570015402" t="erwinrooijakkers omg"><y>#</y><d>2019-10-02</d><h>11:23</h><r>erwinrooijakkers</r>omg</z><z id="t1570006245" t="mkvlr anybody here know of a byte-range header implementation for jetty/pedestal? Use case is supporting video playback for iOS."><y>#</y><d>2019-10-02</d><h>08:50</h><w>mkvlr</w>anybody here know of a byte-range header implementation for jetty/pedestal? Use case is supporting video playback for iOS.</z><z id="t1570030727" t="Eduardo Mata Howdy Y&apos;all. I have been working on a small framework using pedestal io and integrant. The framework is used to create a server that serves user define APIs, State, Redis Processors, and Server Sent Events. Everything works greate, however, I noticed that when multiple clients are connected to the web app, the server sent events will only send data to one client at the time and it sends data in a particular order. The way the server sent events are implemented is with Core Async and the Pedestal library for SSE. such as (def sse (chan 2046)) (defn stream-ready &quot;Get data from the sse channel and put it in `channel`. this is how SSE are sent to the client&quot; [channel context-map] (go-loop [] (async/put! channel (async/&lt;! sse))) (defn stream-data &quot;Put data in the sse channel&quot; [data] (async/put! sse data)) "><y>#</y><d>2019-10-02</d><h>15:38</h><w>Eduardo Mata</w>Howdy Y&apos;all.
I have been working on a small framework using pedestal io and integrant. The framework is used to create a server that serves user define APIs, State, Redis Processors, and Server Sent Events. Everything works greate, however, I noticed that when multiple clients are connected to the web app, the server sent events will only send data to one client at the time and it sends data in a particular order.
The way the server sent events are implemented is with Core Async and the Pedestal library for SSE. such as
<pre>(def sse (chan 2046))

(defn stream-ready
&quot;Get data from the sse channel and put it in `channel`. this is how SSE are sent to the client&quot;
[channel context-map]
(go-loop []
  (async/put! channel (async/&lt;! sse)))

(defn stream-data
&quot;Put data in the sse channel&quot;
[data]
(async/put! sse data))
</pre></z><z id="t1570636423" t="dadair Hey, so I&apos;m running into some behaviour that I can&apos;t quite explain. I have two routes defined in table syntax: #{[&quot;/foos/search&quot; :get [..] :route-name :search] [&quot;/foos/:foo-id/bar&quot; :post [..] :route-name :bar]} ; the presence of the second route makes the system return a 404 for the first. This leads me to believe they are conflicting, but both the verbs and the route-names are different? I can&apos;t seem to explain this. We are on io.pedestal/pedestal.route {:mvn/version &quot;0.5.3&quot;} ."><y>#</y><d>2019-10-09</d><h>15:53</h><w>dadair</w>Hey, so I&apos;m running into some behaviour that I can&apos;t quite explain. I have two routes defined in table syntax: <code>#{[&quot;/foos/search&quot; :get [..] :route-name :search] [&quot;/foos/:foo-id/bar&quot; :post [..] :route-name :bar]}</code>; the presence of the second route makes the system return a 404 for the first. This leads me to believe they are conflicting, but both the verbs and the route-names are different? I can&apos;t seem to explain this. We are on <code>io.pedestal/pedestal.route {:mvn/version &quot;0.5.3&quot;}</code>.</z><z id="t1570638240" t="ikitommi [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] it&apos;s by design: &gt; The prefix-tree router also changes some of the routing behavior. In the linear-search, you could have routes like /one/:wild and /one/two, the latter being a hard match and the former picking up any wildcard URL matches (not /one/two). In the prefix-tree, this isn&apos;t allowed, and one/:wild will always be matched. This change also encourages &quot;best practices&quot; and removes the possibility of subtle bugs introduced by human error."><y>#</y><d>2019-10-09</d><h>16:24</h><w>ikitommi</w><a>@dadair</a> it&apos;s by design:
&gt; The prefix-tree router also changes some of the routing behavior. In the linear-search, you could have routes like /one/:wild and /one/two, the latter being a hard match and the former picking up any wildcard URL matches (not /one/two). In the prefix-tree, this isn&apos;t allowed, and one/:wild will always be matched. This change also encourages &quot;best practices&quot; and removes the possibility of subtle bugs introduced by human error.</z><z id="t1570638281" t="ikitommi https://github.com/pedestal/pedestal/pull/330"><y>#</y><d>2019-10-09</d><h>16:24</h><r>ikitommi</r><a href="https://github.com/pedestal/pedestal/pull/330" target="_blank">https://github.com/pedestal/pedestal/pull/330</a></z><z id="t1570638278" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] refer to http://pedestal.io/reference/using-the-builtin-routers . You’ll want to use the Linear Search router instead"><y>#</y><d>2019-10-09</d><h>16:24</h><w>ddeaguiar</w><a>@dadair</a> refer to <a href="http://pedestal.io/reference/using-the-builtin-routers" target="_blank">http://pedestal.io/reference/using-the-builtin-routers</a>. You’ll want to use the Linear Search router instead</z><z id="t1570638584" t="dadair Ah ok thank you; the reference docs on the website are a bit misleading, they state (iirc) that as long as verb and name differ, there is no collision"><y>#</y><d>2019-10-09</d><h>16:29</h><w>dadair</w>Ah ok thank you; the reference docs on the website are a bit misleading, they state (iirc) that as long as verb and name differ, there is no collision</z><z id="t1570638597" t="dadair I’ll take a look at the other routers"><y>#</y><d>2019-10-09</d><h>16:29</h><w>dadair</w>I’ll take a look at the other routers</z><z id="t1570639589" t="isak couldn&apos;t one just be linear for that part of the tree?"><y>#</y><d>2019-10-09</d><h>16:46</h><w>isak</w>couldn&apos;t one just be linear for that part of the tree?</z><z id="t1570743189" t="Eduardo Mata I am using https://github.com/logstash/logstash-logback-encoder to send logs to my logstash instance. I can log my data in my localhost. When I try logging to my cloud instance, it does not get logged.. Has anyone every done this before? I am using pedestal.log for logging"><y>#</y><d>2019-10-10</d><h>21:33</h><w>Eduardo Mata</w>I am using <a href="https://github.com/logstash/logstash-logback-encoder" target="_blank">https://github.com/logstash/logstash-logback-encoder</a> to send logs to my logstash instance. I can log my data in my localhost. When I try logging to my cloud instance, it does not get logged.. Has anyone every done this before? I am using pedestal.log for logging</z><z id="t1570971975" t="Daouda Hey Folks, I am facing an issue with pedestal routing in little project. My routing work fine with this: (def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/locals&quot; :post (conj common-interceptors `upsert-local!)] [&quot;/locals/:id&quot; :get (conj common-interceptors `find-one-local!)]}) But when I add one more route to the map, this get broken: (def routes #{[&quot;/&quot; :get (conj common-interceptors `home-page)] [&quot;/locals&quot; :post (conj common-interceptors `upsert-local!)] [&quot;/locals/:id&quot; :get (conj common-interceptors `find-one-local!)] [&quot;/locals&quot; :get (conj common-interceptors `find-map-local!)]}) Got this error: INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} INFO io.pedestal.http.cors - {:msg &quot;cors request processing&quot;, :origin &quot;&quot;, :allowed true, :line 84} ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 314} clojure.lang.ExceptionInfo: clojure.lang.ExceptionInfo in Interceptor :io.pedestal.http.route/router - You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it? Here is the test I am running: (fact &quot;hitting home page endpoint&quot; (GET &quot;/&quot; 200) =&gt; (match {:body {:msg &quot;Hello World!&quot;}}))"><y>#</y><d>2019-10-13</d><h>13:06</h><w>Daouda</w>Hey Folks, I am facing an issue with pedestal routing in little project.
My routing work fine with this:
<pre>(def routes
  #{[&quot;/&quot;                 :get  (conj common-interceptors  `home-page)]
    [&quot;/locals&quot;           :post (conj common-interceptors  `upsert-local!)]
    [&quot;/locals/:id&quot;       :get  (conj common-interceptors  `find-one-local!)]})</pre>
But when I add one more route to the map, this get broken:
<pre>(def routes
  #{[&quot;/&quot;                 :get  (conj common-interceptors  `home-page)]
    [&quot;/locals&quot;           :post (conj common-interceptors  `upsert-local!)]
    [&quot;/locals/:id&quot;       :get  (conj common-interceptors  `find-one-local!)]
    [&quot;/locals&quot;           :get  (conj common-interceptors  `find-map-local!)]})</pre>

Got this error:
<pre>INFO  io.pedestal.http  - {:msg &quot;GET /&quot;, :line 80}
INFO  io.pedestal.http.cors  - {:msg &quot;cors request processing&quot;, :origin &quot;&quot;, :allowed true, :line 84}
ERROR i.p.http.impl.servlet-interceptor  - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 314}
clojure.lang.ExceptionInfo: clojure.lang.ExceptionInfo in Interceptor :io.pedestal.http.route/router - You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?</pre>

Here is the test I am running:
<pre>(fact &quot;hitting home page endpoint&quot;
  (GET &quot;/&quot; 200) =&gt; (match {:body {:msg &quot;Hello World!&quot;}}))</pre></z><z id="t1570986243" t="sova-soars-the-sora You&apos;re using a SET #{} of vectors #{ [] [] [] [] } but in a SET every vector must be unique... is that the issue"><y>#</y><d>2019-10-13</d><h>17:04</h><w>sova-soars-the-sora</w>You&apos;re using a SET #{} of vectors #{ [] [] [] [] } but in a SET every vector must be unique... is that the issue</z><z id="t1570986261" t="sova-soars-the-sora actually it may just be the sequence."><y>#</y><d>2019-10-13</d><h>17:04</h><w>sova-soars-the-sora</w>actually it may just be the sequence.</z><z id="t1570986273" t="sova-soars-the-sora sometimes with COMPOJURE routing I have to adjust the order of things in the list."><y>#</y><d>2019-10-13</d><h>17:04</h><w>sova-soars-the-sora</w>sometimes with COMPOJURE routing I have to adjust the order of things in the list.</z><z id="t1570986278" t="sova-soars-the-sora because it does matching sequentially"><y>#</y><d>2019-10-13</d><h>17:04</h><w>sova-soars-the-sora</w>because it does matching sequentially</z><z id="t1570986369" t="Daouda Sorry but I still don’t get what I am doing wrong"><y>#</y><d>2019-10-13</d><h>17:06</h><w>Daouda</w>Sorry but I still don’t get what I am doing wrong</z><z id="t1570986416" t="Daouda They are all unique to me, every vector in my set are different"><y>#</y><d>2019-10-13</d><h>17:06</h><w>Daouda</w>They are all unique to me, every vector in my <code>set</code> are different</z><z id="t1570994518" t="dadair What’s the definition of find-map-local! ?"><y>#</y><d>2019-10-13</d><h>19:21</h><w>dadair</w>What’s the definition of find-map-local! ?</z><z id="t1570994536" t="dadair Maybe you aren’t returning a proper interceptor?"><y>#</y><d>2019-10-13</d><h>19:22</h><w>dadair</w>Maybe you aren’t returning a proper interceptor?</z><z id="t1570994605" t="sova-soars-the-sora yeah find-map-local must be broken"><y>#</y><d>2019-10-13</d><h>19:23</h><w>sova-soars-the-sora</w>yeah find-map-local must be broken</z><z id="t1571065415" t="sova-soars-the-sora How are you invoking Router"><y>#</y><d>2019-10-14</d><h>15:03</h><w>sova-soars-the-sora</w>How are you invoking Router</z><z id="t1571276687" t="Daouda Hey folks, according to this issue, it was a silly error, I feel so bad, I made a typo on one of my handler. That is why I was facing the issue 😞 https://clojurians.slack.com/archives/C0K65B20P/p1570971975013000"><y>#</y><d>2019-10-17</d><h>01:44</h><w>Daouda</w>Hey folks, according to this issue, it was a silly error, I feel so bad, I made a typo on one of my handler. That is why I was facing the issue <b>😞</b>
<a href="https://clojurians.slack.com/archives/C0K65B20P/p1570971975013000" target="_blank">https://clojurians.slack.com/archives/C0K65B20P/p1570971975013000</a></z><z id="t1572030568" t="hadils Hi everyone. I am having trouble with AWS API Gateway and CORS in Pedestal. I am not sure how to make it work..."><y>#</y><d>2019-10-25</d><h>19:09</h><w>hadils</w>Hi everyone. I am having trouble with AWS API Gateway and CORS in Pedestal. I am not sure how to make it work...</z><z id="t1572030945" t="hadils I have added the ::http/allowed-origins to the service-map but this is not working for me..."><y>#</y><d>2019-10-25</d><h>19:15</h><w>hadils</w>I have added the <code>::http/allowed-origins</code> to the <code>service-map</code> but this is not working for me...</z><z id="t1572031382" t="Joe Lane [:attrs {:href &quot;/_/_/users/UGNMGFJG3&quot;}] Are your aws api&apos;s using an authorizer?"><y>#</y><d>2019-10-25</d><h>19:23</h><w>Joe Lane</w><a>@hadilsabbagh18</a> Are your aws api&apos;s using an authorizer?</z><z id="t1572031398" t="hadils No, should they&gt;"><y>#</y><d>2019-10-25</d><h>19:23</h><w>hadils</w>No, should they&gt;</z><z id="t1572031400" t="hadils ?"><y>#</y><d>2019-10-25</d><h>19:23</h><w>hadils</w>?</z><z id="t1572031456" t="Joe Lane So, to be clear, this api is an unauthed api? Are you using ions/http-direct?"><y>#</y><d>2019-10-25</d><h>19:24</h><w>Joe Lane</w>So, to be clear, this api is an unauthed api? Are you using ions/http-direct?</z><z id="t1572031478" t="hadils No, lambda. This is an unathed api."><y>#</y><d>2019-10-25</d><h>19:24</h><w>hadils</w>No, lambda. This is an unathed api.</z><z id="t1572031592" t="Joe Lane So it&apos;s pedestal running in a JVM Lambda?"><y>#</y><d>2019-10-25</d><h>19:26</h><w>Joe Lane</w>So it&apos;s pedestal running in a JVM Lambda?</z><z id="t1572031688" t="hadils When I call it from an S3 website, it is returning 404 errors."><y>#</y><d>2019-10-25</d><h>19:28</h><w>hadils</w>When I call it from an S3 website, it is returning 404 errors.</z><z id="t1572031704" t="hadils I have listed the domain name as an allowed origin."><y>#</y><d>2019-10-25</d><h>19:28</h><w>hadils</w>I have listed the domain name as an allowed origin.</z><z id="t1572031714" t="Joe Lane [:attrs {:href &quot;/_/_/users/UGNMGFJG3&quot;}] On the apigateway resource have you clicked the &quot;Enable CORS&quot; dropdown?"><y>#</y><d>2019-10-25</d><h>19:28</h><w>Joe Lane</w><a>@hadilsabbagh18</a> On the apigateway resource have you clicked the &quot;Enable CORS&quot; dropdown?</z><z id="t1572031739" t="hadils Yes, I have. And changed from Mock to Lambda proxy integration."><y>#</y><d>2019-10-25</d><h>19:28</h><w>hadils</w>Yes, I have. And changed from Mock to Lambda proxy integration.</z><z id="t1572031789" t="Joe Lane Does your service map contain the secure-headers key?"><y>#</y><d>2019-10-25</d><h>19:29</h><w>Joe Lane</w>Does your service map contain the <code>secure-headers</code> key?</z><z id="t1572031804" t="hadils No."><y>#</y><d>2019-10-25</d><h>19:30</h><w>hadils</w>No.</z><z id="t1572031849" t="souenzzo [:attrs {:href &quot;/_/_/users/UGNMGFJG3&quot;}] I use ::http/secure-headers {:content-security-policy-settings &quot;script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;&quot;}}"><y>#</y><d>2019-10-25</d><h>19:30</h><w>souenzzo</w><a>@hadilsabbagh18</a> I use <code>::http/secure-headers {:content-security-policy-settings &quot;script-src  &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos;&quot;}}</code></z><z id="t1572031878" t="hadils Thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2019-10-25</d><h>19:31</h><w>hadils</w>Thanks <a>@souenzzo</a></z><z id="t1572031969" t="hadils [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] What is my-bucket supposed to be set to? My domain or the domain of the caller?"><y>#</y><d>2019-10-25</d><h>19:32</h><w>hadils</w><a>@souenzzo</a> What is <code>my-bucket</code> supposed to be set to? My domain or the domain of the caller?</z><z id="t1572032001" t="souenzzo "><y>#</y><d>2019-10-25</d><h>19:33</h><w>souenzzo</w><code></code></z><z id="t1572032155" t="hadils Ok, thanks!"><y>#</y><d>2019-10-25</d><h>19:35</h><w>hadils</w>Ok, thanks!</z><z id="t1572032738" t="hadils After returning a status code of 200 from my Lambda function, AWS then does this: (3308d6aa-08fe-40c8-9e24-ac22487b359b) Method response headers: {Access-Control-Allow-Origin=, Access-Control-Expose-Headers=, Content-Type=text/plain, X-Amzn-Trace-Id=Root=1-5db34f42-39cc3ea420f2cc35a7ae7d3c;Sampled=0} and returns a 404. I have been getting this for four days. Can anyone help me?"><y>#</y><d>2019-10-25</d><h>19:45</h><w>hadils</w>After returning a status code of 200 from my Lambda function, AWS then does this:
<pre>(3308d6aa-08fe-40c8-9e24-ac22487b359b) Method response headers: {Access-Control-Allow-Origin=, Access-Control-Expose-Headers=, Content-Type=text/plain, X-Amzn-Trace-Id=Root=1-5db34f42-39cc3ea420f2cc35a7ae7d3c;Sampled=0}
</pre>
and returns a 404. I have been getting this for four days. Can anyone help me?</z><z id="t1572033877" t="Joe Lane Is that response from your lambda or from apigateway?"><y>#</y><d>2019-10-25</d><h>20:04</h><w>Joe Lane</w>Is that response from your lambda or from apigateway?</z><z id="t1572034837" t="hadils apigateway"><y>#</y><d>2019-10-25</d><h>20:20</h><w>hadils</w>apigateway</z><z id="t1572034858" t="hadils It seems to mask the Lambda output."><y>#</y><d>2019-10-25</d><h>20:20</h><w>hadils</w>It seems to mask the Lambda output.</z><z id="t1572042318" t="Eduardo Mata I have my UI done in react. My backend is done Clojure. I use Pedestal as my server. I deployed my web app. After being deployed, I can access my site. However, If I stay in the page longer than 5 minutes, it comes back with ErrorPanel.js:36 Request has been terminated Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc. "><y>#</y><d>2019-10-25</d><h>22:25</h><w>Eduardo Mata</w>I have my UI done in react. My backend is done Clojure. I use Pedestal as my server. I deployed my web app. After being deployed, I can access my site. However, If I stay in the page longer than 5 minutes, it comes back with
<pre>ErrorPanel.js:36 Request has been terminated
Possible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.
</pre></z><z id="t1572042323" t="Eduardo Mata this is in my react ui"><y>#</y><d>2019-10-25</d><h>22:25</h><w>Eduardo Mata</w>this is in my react ui</z><z id="t1572042366" t="Eduardo Mata My backend appears to be healthy with no warns/errors. THey run a healthy check heartbeat every 10seconds"><y>#</y><d>2019-10-25</d><h>22:26</h><w>Eduardo Mata</w>My backend appears to be healthy with no warns/errors. THey run a healthy check heartbeat every 10seconds</z><z id="t1572075178" t="orestis [:attrs {:href &quot;/_/_/users/UM0E0PZ41&quot;}] what does the network panel in the browser say?"><y>#</y><d>2019-10-26</d><h>07:32</h><w>orestis</w><a>@contact904</a> what does the network panel in the browser say?</z><z id="t1572389342" t="Eduardo Mata"><y>#</y><d>2019-10-29</d><h>22:49</h><r>Eduardo Mata</r></z><z id="t1572435536" t="orestis Is there a websocket connection or anything else like that there?"><y>#</y><d>2019-10-30</d><h>11:38</h><r>orestis</r>Is there a websocket connection or anything else like that there?</z><z id="t1572435564" t="orestis Also, have a look at the Network panel (not the console). It will give you a much better overview of the actual network connections and their state."><y>#</y><d>2019-10-30</d><h>11:39</h><r>orestis</r>Also, have a look at the Network panel (not the console). It will give you a much better overview of the actual network connections and their state.</z><z id="t1572472827" t="Eduardo Mata I will, thank you."><y>#</y><d>2019-10-30</d><h>22:00</h><r>Eduardo Mata</r>I will, thank you.</z><z id="t1572472850" t="Eduardo Mata There is no websockets being used other than server sent event"><y>#</y><d>2019-10-30</d><h>22:00</h><r>Eduardo Mata</r>There is no websockets being used other than server sent event</z><z id="t1572434243" t="Mehdi H. Hi everyone! I am trying to use vase standalone with datomic-pro. The thing is I can&apos;t seem to find the latest uberjar online at the link of the doc, and anyway it would be built for datomic-free. I tried to git clone the current github repo but it doesn&apos;t &quot;lein uberjar&quot; well even as is. I went back to the 0.9.2 release, commented out the datomic-free dep and added the datomic-pro (with the version I have a licence key to). lein uberjar suggested I excluded com.google.guava/guava, and then the uberjar was completed. But now I am thinking I can&apos;t use a .fern config, and I am wondering whether I am missing a way simpler option for all this..."><y>#</y><d>2019-10-30</d><h>11:17</h><w>Mehdi H.</w>Hi everyone! I am trying to use vase standalone with datomic-pro. The thing is I can&apos;t seem to find the latest uberjar online at the link of the doc, and anyway it would be built for datomic-free. I tried to git clone the current github repo but it doesn&apos;t &quot;lein uberjar&quot; well even as is. I went back to the 0.9.2 release, commented out the datomic-free dep and added the datomic-pro (with the version I have a licence key to). lein uberjar suggested I excluded com.google.guava/guava, and then the uberjar was completed. But now I am thinking I can&apos;t use a .fern config, and I am wondering whether I am missing a way simpler option for all this...</z><z id="t1572442740" t="Mehdi H. If latest discussions about vase are on this channel, is vase still actively maintained? My whole issue is something clearly referenced more than two years ago ( https://github.com/cognitect-labs/vase/issues/50 ) and the maintainer clearly suggested that there should be a doc for going from in-memory datomic to on-disk. Should I be worried about trying to use vase in the first place? :s"><y>#</y><d>2019-10-30</d><h>13:39</h><w>Mehdi H.</w>If latest discussions about vase are on this channel, is vase still actively maintained? My whole issue is something clearly referenced more than two years ago (<a href="https://github.com/cognitect-labs/vase/issues/50" target="_blank">https://github.com/cognitect-labs/vase/issues/50</a>) and the maintainer clearly suggested that there should be a doc for going from in-memory datomic to on-disk. Should I be worried about trying to use vase in the first place? :s</z><z id="t1572468911" t="Mehdi H. noone on that issue?"><y>#</y><d>2019-10-30</d><h>20:55</h><w>Mehdi H.</w>noone on that issue?</z><z id="t1572472460" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/UPY6QU59A&quot;}] , I’m the current maintainer of Vase. Work to finalize the next release is on the back burner and atm I don’ t have a schedule to communicate but it is something that I’d like to get back to."><y>#</y><d>2019-10-30</d><h>21:54</h><w>ddeaguiar</w>Hi <a>@mehdihajjam</a>, I’m the current maintainer of Vase. Work to finalize the next release is on the back burner and atm I don’ t have a schedule to communicate but it is something that I’d like to get back to.</z><z id="t1572472946" t="Mehdi H. Awesome news! Could you help me out in the meantime on how to use 0.9.2 or any other version in standalone using datomic-pro?"><y>#</y><d>2019-10-30</d><h>22:02</h><w>Mehdi H.</w>Awesome news! Could you help me out in the meantime on how to use 0.9.2 or any other version in standalone using datomic-pro?</z><z id="t1572473059" t="Mehdi H. The answer could be as simple as use this version and this format of descriptor (I&apos;d like to use fern but it doesn&apos;t seem to work on 0.9.2)"><y>#</y><d>2019-10-30</d><h>22:04</h><w>Mehdi H.</w>The answer could be as simple as use this version and this format of descriptor (I&apos;d like to use fern but it doesn&apos;t seem to work on 0.9.2)</z><z id="t1572519262" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UPY6QU59A&quot;}] , I’m traveling atm but can help. I’ll try to dig in at my end of day but may be delayed."><y>#</y><d>2019-10-31</d><h>10:54</h><w>ddeaguiar</w><a>@mehdihajjam</a>, I’m traveling atm but can help. I’ll try to dig in at my end of day but may be delayed.</z><z id="t1572523385" t="Mehdi H. Thank you so much [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2019-10-31</d><h>12:03</h><w>Mehdi H.</w>Thank you so much <a>@ddeaguiar</a>!</z><z id="t1572971229" t="coby I&apos;m trying to load Ring&apos;s wrap-reload middleware as an interceptor. I think since wrap-reload returns a handler function that an interceptor created from wrap-reload would also necessarily be a handler, and would therefore have to go at the end of the interceptor queue. Is that right?"><y>#</y><d>2019-11-05</d><h>16:27</h><w>coby</w>I&apos;m trying to load Ring&apos;s <code>wrap-reload</code> middleware as an interceptor. I think since <code>wrap-reload</code> returns a handler function that an interceptor created from <code>wrap-reload</code> would also necessarily be a handler, and would therefore have to go at the end of the interceptor queue. Is that right?</z><z id="t1572971558" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UH85MNSKE&quot;}] perhaps Pedestal’s service-tools dev tooling is a better fit for you? https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj"><y>#</y><d>2019-11-05</d><h>16:32</h><w>ddeaguiar</w><a>@ctamayo</a> perhaps Pedestal’s <code>service-tools</code> dev tooling is a better fit for you? <a href="https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-tools/src/io/pedestal/service_tools/dev.clj</a></z><z id="t1572971711" t="coby aha, yeah that looks promising! Thanks!"><y>#</y><d>2019-11-05</d><h>16:35</h><w>coby</w>aha, yeah that looks promising! Thanks!</z><z id="t1572971862" t="ddeaguiar np!"><y>#</y><d>2019-11-05</d><h>16:37</h><w>ddeaguiar</w>np!</z><z id="t1572972621" t="coby I&apos;m a little confused about how/where to use this, though...do I wrap the expanded routes var in run-dev ? So something like... ;; Routes can be a function that resolve routes, ;; we can use this to set the routes to be reloadable ::server/routes #(route/expand-routes (dev-tools/watch-routes-fn (deref #&apos;service/routes))) "><y>#</y><d>2019-11-05</d><h>16:50</h><w>coby</w>I&apos;m a little confused about how/where to use this, though...do I wrap the expanded routes var in <code>run-dev</code>? So something like...

<pre>;; Routes can be a function that resolve routes,
              ;;  we can use this to set the routes to be reloadable
              ::server/routes #(route/expand-routes (dev-tools/watch-routes-fn (deref #&apos;service/routes)))
</pre></z><z id="t1572972744" t="coby or ::server/routes #(dev-tools/watch-routes-fn (route/expand-routes (deref #&apos;service/routes))) ?? both of these throw runtime exceptions"><y>#</y><d>2019-11-05</d><h>16:52</h><w>coby</w>or <code>::server/routes #(dev-tools/watch-routes-fn (route/expand-routes (deref #&apos;service/routes)))</code>?? both of these throw runtime exceptions</z><z id="t1572976143" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UH85MNSKE&quot;}] , watch should be sufficient. The fact that the run-dev service map uses (deref #&apos;service/routes) leads to the routes being evaluated on every request"><y>#</y><d>2019-11-05</d><h>17:49</h><w>ddeaguiar</w><a>@ctamayo</a>, <code>watch</code> should be sufficient. The fact that the <code>run-dev</code> service map uses <code>(deref #&apos;service/routes)</code> leads to the routes being evaluated  on every request</z><z id="t1573014406" t="coby Awesome, just tried that and it&apos;s working. 💯"><y>#</y><d>2019-11-06</d><h>04:26</h><w>coby</w>Awesome, just tried that and it&apos;s working. <b>💯</b></z></g><g id="s17"><z id="t1573216877" t="orestis I&apos;m running Pedestal under Elastic Beanstalk. Is there a way to configure the Logback logger to emit CloudWatch-friendly JSON?"><y>#</y><d>2019-11-08</d><h>12:41</h><w>orestis</w>I&apos;m running Pedestal under Elastic Beanstalk. Is there a way to configure the Logback logger to emit CloudWatch-friendly JSON?</z><z id="t1573216921" t="orestis I&apos;ve found this: https://github.com/osiegmar/logback-awslogs-json-encoder which seems to be what I want but I&apos;m not certain if that&apos;s the level of abstraction I should be using."><y>#</y><d>2019-11-08</d><h>12:42</h><w>orestis</w>I&apos;ve found this: <a href="https://github.com/osiegmar/logback-awslogs-json-encoder" target="_blank">https://github.com/osiegmar/logback-awslogs-json-encoder</a> which seems to be what I want but I&apos;m not certain if that&apos;s the level of abstraction I should be using.</z><z id="t1573216939" t="orestis I&apos;d also like to enhance the logs with various other stuff (e.g. Host, user-id, etc etc)"><y>#</y><d>2019-11-08</d><h>12:42</h><w>orestis</w>I&apos;d also like to enhance the logs with various other stuff (e.g. Host, user-id, etc etc)</z><z id="t1573222970" t="orestis I saw that I can do something like :io.pedestal.log/formatter cheshire/encode when calling io.pedestal.log/log , and cloudwatch is smart enough to pick that JSON up"><y>#</y><d>2019-11-08</d><h>14:22</h><w>orestis</w>I saw that I can do something like <code>:io.pedestal.log/formatter   cheshire/encode</code> when calling <code>io.pedestal.log/log</code>, and cloudwatch is smart enough to pick that JSON up</z><z id="t1573223435" t="orestis But not in insights, sigh. Perhaps it&apos;s better if the whole log is JSON (as opposed to prefixed by other logback things)"><y>#</y><d>2019-11-08</d><h>14:30</h><w>orestis</w>But not in insights, sigh. Perhaps it&apos;s better if the whole log is JSON (as opposed to prefixed by other logback things)</z><z id="t1573234495" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I’ve not used the logback-awslogs-json-encoder lib but if you do produce JSON formatted logs and use io.pedestal.log/log with a JSON formatter, then your log message will be a string albeit in JSON format. You could parse that string in CloudWatch Insights using the parse function it provides in order to create virtual fields which can be filtered on. That being said, info like Host, user-id seems better suited for MDC usage. You can use Pedestal’s io.pedestal.log/with-context impl to set a map of data in the MDC but it will be a single value under the io.pedestal key. You could format as JSON and parse as I described above, though. Alternatively, you can use the MDC directly. All values put into the MDC become separate fields prefixed by mdc in Insights which makes log analysis easy."><y>#</y><d>2019-11-08</d><h>17:34</h><w>ddeaguiar</w><a>@orestis</a> I’ve not used the logback-awslogs-json-encoder lib but if you do produce JSON formatted logs and use <code>io.pedestal.log/log</code> with a JSON formatter, then your log message will be a string albeit in JSON format. You could parse that string in CloudWatch Insights using the <code>parse</code> function it provides in order to create virtual fields which can be filtered on. That being said, info like Host, user-id seems better suited for MDC usage. You can use Pedestal’s <code>io.pedestal.log/with-context</code> impl to set a map of data in the MDC but it will be a single value under the <code>io.pedestal</code> key. You could format as JSON and parse as I described above, though. Alternatively, you can use the MDC directly. All values put into the MDC become separate fields prefixed by <code>mdc</code> in Insights which makes log analysis easy.</z><z id="t1573328629" t="Janne Sauvala I stumbled today to a very annoying thing. I was dockerizing my pedestal/lacinia server and somehow I wasn’t able to call it’s endpoint while it was running inside the container. After several hours of debugging/googling I found out about this issue https://github.com/pedestal/pedestal/issues/604"><y>#</y><d>2019-11-09</d><h>19:43</h><w>Janne Sauvala</w>I stumbled today to a very annoying thing. I was dockerizing my pedestal/lacinia server and somehow I wasn’t able to call it’s endpoint while it was running inside the container. After several hours of debugging/googling I found out about this issue <a href="https://github.com/pedestal/pedestal/issues/604" target="_blank">https://github.com/pedestal/pedestal/issues/604</a></z><z id="t1573480623" t="ddeaguiar Sorry you ran into that. I think the best thing to do is make the docs more clear about this."><y>#</y><d>2019-11-11</d><h>13:57</h><r>ddeaguiar</r>Sorry you ran into that. I think the best thing to do is make the docs more clear about this.</z><z id="t1573481697" t="Janne Sauvala It’s great Pedestal takes security seriously. A note to the docs would be really helpful. I haven’t ran into this kind of issue with other (lesser) frameworks+languages so it took me longer time to figure out the problem 🙂"><y>#</y><d>2019-11-11</d><h>14:14</h><r>Janne Sauvala</r>It’s great Pedestal takes security seriously. A note to the docs would be really helpful. I haven’t ran into this kind of issue with other (lesser) frameworks+languages so it took me longer time to figure out the problem <b>🙂</b></z><z id="t1573328707" t="Janne Sauvala ::http/host &quot;0.0.0.0&quot; did the trick and I got it working. I don’t know if this is a feature or bug :man-shrugging: :skin-tone-2:"><y>#</y><d>2019-11-09</d><h>19:45</h><w>Janne Sauvala</w><code>::http/host &quot;0.0.0.0&quot;</code> did the trick and I got it working. I don’t know if this is a feature or bug <b>:man-shrugging:</b><b>:skin-tone-2:</b></z><z id="t1573398255" t="dvingo hello, I&apos;m running a server in dev mode and getting the following content security policy error in the browser: Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled. Note that &apos;script-src-elem&apos; was not explicitly set, so &apos;script-src&apos; is used as a fallback. "><y>#</y><d>2019-11-10</d><h>15:04</h><w>dvingo</w>hello, I&apos;m running a server in dev mode and getting the following content security policy error in the browser:
<pre>Refused to load the script &apos;&apos; because it violates the following Content Security Policy directive: &quot;script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:&quot;. &apos;strict-dynamic&apos; is present, so host-based whitelisting is disabled. Note that &apos;script-src-elem&apos; was not explicitly set, so &apos;script-src&apos; is used as a fallback.
</pre></z><z id="t1573398280" t="dvingo it looks like this is the default policy, so i&apos;m not sure why it&apos;s blocking this script from being loaded"><y>#</y><d>2019-11-10</d><h>15:04</h><w>dvingo</w>it looks like this is the default policy, so i&apos;m not sure why it&apos;s blocking this script from being loaded</z><z id="t1573399228" t="dvingo found this in the samples and that fixes things: https://github.com/pedestal/pedestal/blob/2c7f6fed2105290fdcd6351249ed7072a7cab9ca/samples/cors/src/cors/server.clj#L36"><y>#</y><d>2019-11-10</d><h>15:20</h><w>dvingo</w>found this in the samples and that fixes things:
<a href="https://github.com/pedestal/pedestal/blob/2c7f6fed2105290fdcd6351249ed7072a7cab9ca/samples/cors/src/cors/server.clj#L36" target="_blank">https://github.com/pedestal/pedestal/blob/2c7f6fed2105290fdcd6351249ed7072a7cab9ca/samples/cors/src/cors/server.clj#L36</a></z><z id="t1574176351" t="martinklepsch I’m sometimes getting these &quot;error-stylobate triggered&quot; errors in the logs for the cljdoc production server. So far i hasn’t been a big issue but since it logs the entire context I think it’s causing the server to become unresponsive somehow. Maybe I’m completely wrong here but how people deal with this usually? I found this but would rather not do that: https://github.com/tonsky/grumpy/commit/c6bbcc9590394243e37c2a72a4e569a7c506be7d"><y>#</y><d>2019-11-19</d><h>15:12</h><w>martinklepsch</w>I’m sometimes getting these <code>&quot;error-stylobate triggered&quot;</code> errors in the logs for the cljdoc production server. So far i hasn’t been a big issue but since it logs the entire context I think it’s causing the server to become unresponsive somehow. Maybe I’m completely wrong here but how people deal with this usually? I found this but would rather not do that: <a href="https://github.com/tonsky/grumpy/commit/c6bbcc9590394243e37c2a72a4e569a7c506be7d" target="_blank">https://github.com/tonsky/grumpy/commit/c6bbcc9590394243e37c2a72a4e569a7c506be7d</a></z><z id="t1574176674" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] , error-stylobate is intended to be a catchall. Apps are recommended to implement their own error handling interceptors."><y>#</y><d>2019-11-19</d><h>15:17</h><w>ddeaguiar</w>Hi <a>@martinklepsch</a>, <code>error-stylobate</code> is intended to be a catchall. Apps are recommended to implement their own error handling interceptors.</z><z id="t1574176724" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thanks, so you mean I should just have a catch all interceptor myself &amp; this way avoid the stylobate logging thing?"><y>#</y><d>2019-11-19</d><h>15:18</h><w>martinklepsch</w><a>@ddeaguiar</a> Thanks, so you mean I should just have a catch all interceptor myself &amp; this way avoid the stylobate logging thing?</z><z id="t1574176753" t="ddeaguiar Yep"><y>#</y><d>2019-11-19</d><h>15:19</h><w>ddeaguiar</w>Yep</z><z id="t1574176943" t="martinklepsch Ok cool, thanks!"><y>#</y><d>2019-11-19</d><h>15:22</h><w>martinklepsch</w>Ok cool, thanks!</z><z id="t1574446888" t="Jakub Holý (HolyJak) Regarding ☝️ https://en.wikipedia.org/wiki/Stylobate 🤯"><y>#</y><d>2019-11-22</d><h>18:21</h><w>Jakub Holý (HolyJak)</w>Regarding <b>☝️</b> <a href="https://en.wikipedia.org/wiki/Stylobate" target="_blank">https://en.wikipedia.org/wiki/Stylobate</a> <b>🤯</b></z><z id="t1574689052" t="abdullahibra Hi everyone,"><y>#</y><d>2019-11-25</d><h>13:37</h><w>abdullahibra</w>Hi everyone,</z><z id="t1574689079" t="abdullahibra how can i create two different routes /users/:user-id :get and /users :get ?"><y>#</y><d>2019-11-25</d><h>13:37</h><w>abdullahibra</w>how can i create two different routes /users/:user-id :get and /users :get  ?</z><z id="t1574689088" t="abdullahibra both refer to the same route"><y>#</y><d>2019-11-25</d><h>13:38</h><w>abdullahibra</w>both refer to the same route</z><z id="t1574690470" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U145X0BPE&quot;}] , use the linear search router. http://pedestal.io/reference/linear-search-router"><y>#</y><d>2019-11-25</d><h>14:01</h><w>ddeaguiar</w>Hi <a>@abdullahibra</a>, use the linear search router. <a href="http://pedestal.io/reference/linear-search-router" target="_blank">http://pedestal.io/reference/linear-search-router</a></z><z id="t1574690515" t="abdullahibra [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] how performance of it for production use?"><y>#</y><d>2019-11-25</d><h>14:01</h><w>abdullahibra</w><a>@ddeaguiar</a> how performance of it for production use?</z><z id="t1574690663" t="ddeaguiar See http://pedestal.io/reference/using-the-builtin-routers for it’s performance characteristics. Depends on the number of routes you have"><y>#</y><d>2019-11-25</d><h>14:04</h><w>ddeaguiar</w>See <a href="http://pedestal.io/reference/using-the-builtin-routers" target="_blank">http://pedestal.io/reference/using-the-builtin-routers</a> for it’s performance characteristics. Depends on the number of routes you have</z><z id="t1574692210" t="abdullahibra Hey"><y>#</y><d>2019-11-25</d><h>14:30</h><w>abdullahibra</w>Hey</z><z id="t1574692211" t="abdullahibra {:type clojure.lang.ExceptionInfo :message You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it? :data {:t nil, :type nil} :at [io.pedestal.interceptor$interceptor invokeStatic interceptor.clj 82]}]"><y>#</y><d>2019-11-25</d><h>14:30</h><w>abdullahibra</w>  {:type clojure.lang.ExceptionInfo
   :message You&apos;re trying to use something as an interceptor that isn&apos;t supported by the protocol; Perhaps you need to extend it?
   :data {:t nil, :type nil}
   :at [io.pedestal.interceptor$interceptor invokeStatic interceptor.clj 82]}]</z><z id="t1574692228" t="abdullahibra i see this is very helpful, can anybody help me to get what&apos;s wrong with my routes ?"><y>#</y><d>2019-11-25</d><h>14:30</h><w>abdullahibra</w>i see this is very helpful, can anybody help me to get what&apos;s wrong with my routes ?</z><z id="t1574692345" t="abdullahibra"><y>#</y><d>2019-11-25</d><h>14:32</h><w>abdullahibra</w></z><z id="t1574692362" t="abdullahibra i get the user id from `auth interceptor"><y>#</y><d>2019-11-25</d><h>14:32</h><w>abdullahibra</w>i get the user id from `auth interceptor</z><z id="t1574692498" t="abdullahibra if i remove :get and :put routes it&apos;s working"><y>#</y><d>2019-11-25</d><h>14:34</h><w>abdullahibra</w>if i remove :get and :put routes it&apos;s working</z><z id="t1574692626" t="abdullahibra seems the problem in `auth"><y>#</y><d>2019-11-25</d><h>14:37</h><w>abdullahibra</w>seems the problem in `auth</z><z id="t1574692831" t="abdullahibra figured it out"><y>#</y><d>2019-11-25</d><h>14:40</h><w>abdullahibra</w>figured it out</z><z id="t1574750162" t="penryu I may just have lost my google fu for the evening with all the excitement leading up to the holiday, but I&apos;m having the hardest time finding out how to deploy a pedestal app (the hello world app from the Getting Started tutorial) on netty."><y>#</y><d>2019-11-26</d><h>06:36</h><w>penryu</w>I may just have lost my google fu for the evening with all the excitement leading up to the holiday, but I&apos;m having the hardest time finding out how to deploy a pedestal app (the hello world app from the Getting Started tutorial) on netty.</z><z id="t1574750240" t="penryu The pedestal homepage says it support netty deployment, but the list item for Netty on http://pedestal.io/reference/index is frustratingly not clickable."><y>#</y><d>2019-11-26</d><h>06:37</h><w>penryu</w>The pedestal homepage says it support netty deployment, but the list item for Netty on <a href="http://pedestal.io/reference/index" target="_blank">http://pedestal.io/reference/index</a> is frustratingly not clickable.</z><z id="t1574750280" t="penryu Am I just blind, or am I ignorant of something obvious everyone else knows?"><y>#</y><d>2019-11-26</d><h>06:38</h><w>penryu</w>Am I just blind, or am I ignorant of something obvious everyone else knows?</z><z id="t1574751657" t="penryu I should probably say, I&apos;m using deps.edn, and I&apos;m used to lein."><y>#</y><d>2019-11-26</d><h>07:00</h><w>penryu</w>I should probably say, I&apos;m using deps.edn, and I&apos;m used to lein.</z><z id="t1574751879" t="penryu Maybe I&apos;m expecting a way to deploy a jar for java -jar my-app.jar , and I&apos;m just supposed to clj ... ..."><y>#</y><d>2019-11-26</d><h>07:04</h><w>penryu</w>Maybe I&apos;m expecting a way to deploy a jar for <code>java -jar my-app.jar</code>, and I&apos;m just supposed to <code>clj ...</code>...</z><z id="t1574763692" t="dangercoder I used https://github.com/seancorfield/depstar to build an uberjar (.jar) with deps.edn,"><y>#</y><d>2019-11-26</d><h>10:21</h><w>dangercoder</w>I used <a href="https://github.com/seancorfield/depstar" target="_blank">https://github.com/seancorfield/depstar</a> to build an uberjar (.jar) with deps.edn,</z><z id="t1574776962" t="penryu [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] Thank you for the response! I’ve found several options for packaging the app, and [:attrs {:href &quot;/_/_/users/U04V70XH6&quot;}] ’s fork of depstar was the first result and it worked! But I’m still stumped on how to use the Netty support the pedestal documentation mentioned. Do you have any pointers?"><y>#</y><d>2019-11-26</d><h>14:02</h><w>penryu</w><a>@jarvinenemil</a> Thank you for the response! I’ve found several options for packaging the app, and <a>@seancorfield</a>’s fork of depstar was the first result and it worked!
But I’m still stumped on how to use the Netty support the pedestal documentation mentioned. Do you have any pointers?</z><z id="t1574777214" t="dangercoder [:attrs {:href &quot;/_/_/users/UGPM7GTKJ&quot;}] Glad to hear that. I hope someone will reply regarding Netty, I have no idea 🙂 . If you get no help here regarding Netty I would ask here: https://groups.google.com/forum/#!forum/pedestal-users https://clojureverse.org/ https://ask.clojure.org/ If you get no replies on thoose forums (which is unlikely) you will have to dig into the pedstal code-base: https://github.com/pedestal/pedestal"><y>#</y><d>2019-11-26</d><h>14:06</h><w>dangercoder</w><a>@penryu</a> Glad to hear that. I hope someone will reply regarding Netty, I have no idea <b>🙂</b>.

If you get no help here regarding Netty I would ask here:
<a href="https://groups.google.com/forum/#!forum/pedestal-users" target="_blank">https://groups.google.com/forum/#!forum/pedestal-users</a>
<a href="https://clojureverse.org/" target="_blank">https://clojureverse.org/</a>
<a href="https://ask.clojure.org/" target="_blank">https://ask.clojure.org/</a>

If you get no replies on thoose forums (which is unlikely) you will have to dig into the pedstal code-base:
<a href="https://github.com/pedestal/pedestal" target="_blank">https://github.com/pedestal/pedestal</a></z><z id="t1574791403" t="penryu Thanks for the tips! After seeing this, I did some of my due diligence and didn&apos;t find any mention of netty anywhere in the source, except in docs mentioning it was supported. My concern now is that either • it was removed without updating the docs, or • it&apos;s some plugin or magic value an experienced pedestal dev would know, but hasn&apos;t been written down I&apos;ll follow up on one of those sites. Thanks again!"><y>#</y><d>2019-11-26</d><h>18:03</h><r>penryu</r>Thanks for the tips! After seeing this, I did some of my due diligence and didn&apos;t find any mention of netty anywhere in the source, except in docs mentioning it was supported.
My concern now is that either

• it was removed without updating the docs, or
• it&apos;s some plugin or magic value an experienced pedestal dev would know, but hasn&apos;t been written down
I&apos;ll follow up on one of those sites. Thanks again!</z><z id="t1574805764" t="hlship Has anyone looked into the idea of separating routing into two stages: 1) identifying the route and 2) adding&apos; the selected routes interceptors to the queue? Why would you want that? In our case, we get a lot of garbage requests hitting our servers, stuff (usually from internal security) probing for known weaknesses (as if we were running unpatched IIS or something). We don&apos;t like to clutter our logs with those,so we have a whitelist interceptor that does some regexp on the request and rejects non-matching requests before we even log. However, we need to keep the whitelist synchronized with actual routing. It would be nice if the routing table itself could act as a white list."><y>#</y><d>2019-11-26</d><h>22:02</h><w>hlship</w>Has anyone looked into the idea of separating routing into two stages:  1) identifying the route and 2) adding&apos; the selected routes interceptors to the queue?

Why would you want that?  In our case, we get a lot of garbage requests hitting our servers, stuff (usually from internal security) probing for known weaknesses (as if we were running unpatched IIS or something).  We don&apos;t like to clutter our logs with those,so we have a whitelist interceptor that does some regexp on the request and rejects non-matching requests before we even log.

However, we need to keep the whitelist synchronized with actual routing.  It would be nice if the routing table itself could act as a white list.</z><z id="t1574806891" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] that’s how the router spec works (2 stages). It’s just not exposed"><y>#</y><d>2019-11-26</d><h>22:21</h><w>ddeaguiar</w><a>@hlship</a> that’s how the router spec works (2 stages). It’s just not exposed</z><z id="t1574806911" t="ddeaguiar match then enqueue"><y>#</y><d>2019-11-26</d><h>22:21</h><w>ddeaguiar</w>match then enqueue</z><z id="t1574807125" t="hlship I&apos;ll look at the code, maybe find a way to split the two."><y>#</y><d>2019-11-26</d><h>22:25</h><w>hlship</w>I&apos;ll look at the code, maybe find a way to split the two.</z><z id="t1574807215" t="ddeaguiar The bits are here https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L440-L451 . Perhaps you can roll your own impl."><y>#</y><d>2019-11-26</d><h>22:26</h><w>ddeaguiar</w>The bits are here <a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L440-L451" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L440-L451</a>. Perhaps you can roll your own impl.</z><z id="t1574808147" t="hlship I was just looking at that code. I wish it was already in two parts."><y>#</y><d>2019-11-26</d><h>22:42</h><w>hlship</w>I was just looking at that code.  I wish it was already in two parts.</z><z id="t1574848440" t="abdullahibra hi everyone, is there any reference to how can i add authentication to my pedestal service with other accounts, facebook, google, github for example?"><y>#</y><d>2019-11-27</d><h>09:54</h><w>abdullahibra</w>hi everyone, is there any reference to how can i add authentication to my pedestal service with other accounts, facebook, google, github for example?</z><z id="t1575296178" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U145X0BPE&quot;}] , you may find the buddy-auth sample useful ( https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth ). Building out a Pedestal-based service involves creating interceptors which add capabilities your app needs. In this case, you’ll add an interceptor which handles your auth needs."><y>#</y><d>2019-12-02</d><h>14:16</h><r>ddeaguiar</r><a>@U145X0BPE</a>, you may find the buddy-auth sample useful (<a href="https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth</a>). Building out a Pedestal-based service involves creating interceptors which add capabilities your app needs. In this case, you’ll add an interceptor which handles your auth needs.</z><z id="t1574848466" t="abdullahibra how should that work on API level not UI level ?"><y>#</y><d>2019-11-27</d><h>09:54</h><w>abdullahibra</w>how should that work on API level not UI level ?</z><z id="t1574854082" t="paulspencerwilliams I couldn&apos;t find any, but perhaps Google for OAuth2 / OpenId Connect with pedestal, as that&apos;s the protocol they use. Also, if only interested in services, you only need to research the &apos;Resource Server&apos; area of this problem."><y>#</y><d>2019-11-27</d><h>11:28</h><w>paulspencerwilliams</w>I couldn&apos;t find any, but perhaps Google for OAuth2 / OpenId Connect with pedestal, as that&apos;s the protocol they use. Also, if only interested in services, you only need to research the &apos;Resource Server&apos; area of this problem.</z><z id="t1575445335" t="Mehdi H. Hi everyone! I can&apos;t seem to be able to catch errors thrown using Pedestal. I have a transaction function to Datomic that throws a clojure.lang.ExceptionInfo exception in the datomic on-prem transactor, which, according to Datomic documention, should also be thrown in the peer, so in my case through the database interceptor that tries to transact the faulty data. None of my interceptors have an :error function, but I have used io.pedestal.interceptor.error/error-dispatch to catch the errors at the end of the process. It does not seem to work. • Does an interceptor need its :enter function to be used on the request to have its :error function used on the way out? • If so what is the proper way to user error-dispatch (the resulting interceptor is the first in the route) • any other thoughts as to why I am not catching it (it&apos;s a POST request and it returns 201 created even if it didn&apos;t happen...) Thanks!"><y>#</y><d>2019-12-04</d><h>07:42</h><w>Mehdi H.</w>Hi everyone! I can&apos;t seem to be able to catch errors thrown using Pedestal. I have a transaction function to Datomic that throws a clojure.lang.ExceptionInfo exception in the datomic on-prem transactor, which, according to Datomic documention, should also be thrown in the peer, so in my case through the database interceptor that tries to transact the faulty data. None of my interceptors have an :error function, but I have used io.pedestal.interceptor.error/error-dispatch to catch the errors at the end of the process. It does not seem to work.
• Does an interceptor need its :enter function to be used on the request to have its :error function used on the way out?
• If so what is the proper way to user error-dispatch (the resulting interceptor is the first in the route)
• any other thoughts as to why I am not catching it (it&apos;s a POST request and it returns 201 created even if it didn&apos;t happen...)
Thanks!</z><z id="t1575458292" t="Mehdi H. Never mind, I found the problem in the code"><y>#</y><d>2019-12-04</d><h>11:18</h><r>Mehdi H.</r>Never mind, I found the problem in the code</z><z id="t1576185123" t="Eduardo Mata Is it possible to increase the size of the event-channel passed by start-event-stream ?"><y>#</y><d>2019-12-12</d><h>21:12</h><w>Eduardo Mata</w>Is it possible to increase the size of the event-channel passed by <code>start-event-stream</code> ?</z><z id="t1576859858" t="martinklepsch I’m seeing stylobate errors in my logs that don’t have the :exception key, does this seem familiar to anyone? https://github.com/pedestal/pedestal/blob/4fe921325c06f8ccfa9dd5cac8c324c93a84b1f8/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L236-L245"><y>#</y><d>2019-12-20</d><h>16:37</h><w>martinklepsch</w>I’m seeing stylobate errors in my logs that don’t have the <code>:exception</code> key, does this seem familiar to anyone?
<a href="https://github.com/pedestal/pedestal/blob/4fe921325c06f8ccfa9dd5cac8c324c93a84b1f8/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L236-L245" target="_blank">https://github.com/pedestal/pedestal/blob/4fe921325c06f8ccfa9dd5cac8c324c93a84b1f8/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L236-L245</a></z><z id="t1577155077" t="Eduardo Mata Howdy! I am using pedestal sse. I wonder if there is a way to filter the data that goes out? I don&apos;t want several endpoints for different sse but one."><y>#</y><d>2019-12-24</d><h>02:37</h><w>Eduardo Mata</w>Howdy! I am using pedestal sse. I wonder if there is a way to filter the data that goes out? I don&apos;t want several endpoints for different sse but one.</z><z id="t1578489113" t="defa Is pedestal still a good choice for writing a Clojure back-end? The last release is 6 months old and there is not much traffic here or on the mailing list. Is the project no longer actively developed? Any alternatives to consider?"><y>#</y><d>2020-01-08</d><h>13:11</h><w>defa</w>Is pedestal still a good choice for writing a Clojure back-end? The last release is 6 months old and there is not much traffic here or on the mailing list. Is the project no longer actively developed? Any alternatives to consider?</z><z id="t1578493374" t="orestis Still valid and widely used, to my knowledge. But as always, do consider the alternatives from juxt, metosin, and of course whatever luminus suggests. "><y>#</y><d>2020-01-08</d><h>14:22</h><w>orestis</w>Still valid and widely used, to my knowledge. But as always, do consider the alternatives from juxt, metosin, and of course whatever luminus suggests. </z><z id="t1578497975" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U5FKQSSS1&quot;}] still valid. Pedestal core is stable so there aren’t many changes being made. I’d consider the most fluid part of Pedestal to be tracing and lambda integration."><y>#</y><d>2020-01-08</d><h>15:39</h><w>ddeaguiar</w><a>@defa</a> still valid. Pedestal core is stable so there aren’t many changes being made. I’d consider the most fluid part of Pedestal to be tracing and lambda integration.</z><z id="t1578500812" t="defa Cool, thanks, [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] "><y>#</y><d>2020-01-08</d><h>16:26</h><w>defa</w>Cool, thanks, <a>@ddeaguiar</a> </z><z id="t1578618417" t="hlship Q about io.pedestal.log; I believe this line of code: https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L247 may be broken. It attempts to use the override-logger as a LoggerSource instance, rather than a function that is passed a string and returns a LoggerSource. Unless I&apos;m missing something, you can&apos;t currently use -Dio.pedestal.log.overrideLogger=my.namespace/create-logger-source because you get a runtime exception trying to apply the LoggerSource protocol to a Var. Am I missing something?"><y>#</y><d>2020-01-10</d><h>01:06</h><w>hlship</w>Q about io.pedestal.log;  I believe this line of code:

<a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L247" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L247</a>

may be broken. It attempts to use the <code>override-logger</code> as a LoggerSource instance, rather than a function that is passed a string and returns a LoggerSource.

Unless I&apos;m missing something, you can&apos;t currently use
<pre>-Dio.pedestal.log.overrideLogger=my.namespace/create-logger-source</pre>
because you get a runtime exception trying to apply the LoggerSource protocol to a Var.

Am I missing something?</z><z id="t1578618512" t="hlship My scenario is to redirect code writing to io.pedestal.log/log to instead invoke our legacy, in-house logging framework."><y>#</y><d>2020-01-10</d><h>01:08</h><w>hlship</w>My scenario is to redirect code writing to io.pedestal.log/log to instead invoke our legacy, in-house logging framework.</z><z id="t1578618583" t="hlship I believe the overrideLogger system property works when used w/ log/info, log/debug, etc., as they go through the private log-expr function: https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L275 ... which does what you&apos;d expect; treat the override-logger as a function that generates LoggerSource instances."><y>#</y><d>2020-01-10</d><h>01:09</h><w>hlship</w>I believe the <code>overrideLogger</code> system property works when used w/ log/info, log/debug, etc., as they go through the private log-expr function:

<a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L275" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L275</a>

... which does what you&apos;d expect; treat the override-logger as a function that generates LoggerSource instances.</z><z id="t1578666901" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , yep that looks like a bug to me. I’ll file an issue and address"><y>#</y><d>2020-01-10</d><h>14:35</h><w>ddeaguiar</w><a>@hlship</a>, yep that looks like a bug to me. I’ll file an issue and address</z><z id="t1578670835" t="ddeaguiar Fix landed on master. Thanks for reporting!"><y>#</y><d>2020-01-10</d><h>15:40</h><r>ddeaguiar</r>Fix landed on master. Thanks for reporting!</z><z id="t1578680974" t="hlship There may be more to it than that."><y>#</y><d>2020-01-10</d><h>18:29</h><r>hlship</r>There may be more to it than that.</z><z id="t1578680990" t="hlship I copied master&apos;s log.clj to my project and am trying to use it."><y>#</y><d>2020-01-10</d><h>18:29</h><r>hlship</r>I copied master&apos;s log.clj to my project and am trying to use it.</z><z id="t1578681026" t="hlship But I think there&apos;s an issue in actually using it."><y>#</y><d>2020-01-10</d><h>18:30</h><r>hlship</r>But  I think there&apos;s an issue in actually using it.</z><z id="t1578681071" t="hlship Because my defaultLogger function needs to require io.pedestal.log so that it can implement the LoggerSource protocol."><y>#</y><d>2020-01-10</d><h>18:31</h><r>hlship</r>Because my defaultLogger function needs to require io.pedestal.log so that it can implement the LoggerSource protocol.</z><z id="t1578681207" t="hlship But https://github.com/pedestal/pedestal/blob/621b6896aab6582499e0076bd9c73d5aeb01dae9/log/src/io/pedestal/log.clj#L196 needs the Var in question to resolvable when io.pedestal.log is loading, resulting in a loop."><y>#</y><d>2020-01-10</d><h>18:33</h><r>hlship</r>But <a href="https://github.com/pedestal/pedestal/blob/621b6896aab6582499e0076bd9c73d5aeb01dae9/log/src/io/pedestal/log.clj#L196" target="_blank">https://github.com/pedestal/pedestal/blob/621b6896aab6582499e0076bd9c73d5aeb01dae9/log/src/io/pedestal/log.clj#L196</a> needs the Var in question to resolvable when io.pedestal.log is loading, resulting in a loop.</z><z id="t1578681250" t="hlship Perhaps use a delay to break the cycle?"><y>#</y><d>2020-01-10</d><h>18:34</h><r>hlship</r>Perhaps use a <code>delay</code> to break the cycle?</z><z id="t1578681276" t="hlship Or move LoggerSource protocol to a separate namespace."><y>#</y><d>2020-01-10</d><h>18:34</h><r>hlship</r>Or move <code>LoggerSource</code> protocol to a separate namespace.</z><z id="t1578681331" t="hlship I can do some trickery with alter-var-root! to work around this, I hope."><y>#</y><d>2020-01-10</d><h>18:35</h><r>hlship</r>I can do some trickery with alter-var-root! to work around this, I hope.</z><z id="t1578682515" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] here’s one way to address that. I’ll be honest, I’d rather the protocol live in a separate ns but unfortunately that’s not how it was implemented. This method of overriding is also used for tracing and has been a source of confusion as well. I’m going to chat with Paul about it."><y>#</y><d>2020-01-10</d><h>18:55</h><r>ddeaguiar</r><a>@hlship</a> here’s one way to address that. I’ll be honest, I’d rather the protocol live in a separate ns but unfortunately that’s not how it was implemented. This method of overriding is also used for tracing and has been a source of confusion as well. I’m going to chat with Paul about it.</z><z id="t1578682743" t="hlship Fortunately, override-logger is public, so I can just alter-var-root it in my server startup code, which should catch most of what I need."><y>#</y><d>2020-01-10</d><h>18:59</h><r>hlship</r>Fortunately, <code>override-logger</code> is public, so I can just alter-var-root it in my server startup code, which should catch most of what I need.</z><z id="t1578683021" t="ddeaguiar Ok. I’ll work on clarifying how this is intended to be done in the docs. It’s come up a number of times."><y>#</y><d>2020-01-10</d><h>19:03</h><r>ddeaguiar</r>Ok. I’ll work on clarifying how this is intended to be done in the docs. It’s come up a number of times.</z><z id="t1578683284" t="hlship I could work on a PR that made use of a delay, but it&apos;s problematic because override-logger is public."><y>#</y><d>2020-01-10</d><h>19:08</h><r>hlship</r>I could work on a PR that made use of a delay, but it&apos;s problematic because override-logger is public.</z><z id="t1578683310" t="hlship Then again, it seems like no one could possibly be using it via the sysprop/envvar at all."><y>#</y><d>2020-01-10</d><h>19:08</h><r>hlship</r>Then again, it seems like no one could possibly be using it via the sysprop/envvar at all.</z><z id="t1578683947" t="ddeaguiar FWIW, spoke to Paul and he stated that what I posted is the intended setup, albeit other methods could work as well."><y>#</y><d>2020-01-10</d><h>19:19</h><r>ddeaguiar</r>FWIW, spoke to Paul and he stated that what I posted is the intended setup, albeit other methods could work as well.</z><z id="t1578684368" t="hlship It just feels a bit broken in a way that&apos;s all but impossible to fix in a backwards compatible way. Logging ... it&apos;ll always bite your ass."><y>#</y><d>2020-01-10</d><h>19:26</h><r>hlship</r>It just feels a bit broken in a way that&apos;s all but impossible to fix in a backwards compatible way. Logging ... it&apos;ll always bite your ass.</z><z id="t1578684577" t="ddeaguiar yeah, in retrospect, splitting out the protocol would have been ideal."><y>#</y><d>2020-01-10</d><h>19:29</h><r>ddeaguiar</r>yeah, in retrospect, splitting out the protocol would have been ideal.</z><z id="t1578684725" t="hlship Is there a way to move it to a new namespace but alias the protocol (and protocol methods) back into io.pedestal.log?"><y>#</y><d>2020-01-10</d><h>19:32</h><r>hlship</r>Is there a way to move it to a new namespace but alias the protocol (and protocol methods) back into io.pedestal.log?</z><z id="t1578685023" t="ddeaguiar I don’t know for sure but I doubt it"><y>#</y><d>2020-01-10</d><h>19:37</h><r>ddeaguiar</r>I don’t know for sure but I doubt it</z><z id="t1578685330" t="hlship I&apos;m still struggling with the above approach; I think AOT is getting in the way, and (for the time being) need AOT my server."><y>#</y><d>2020-01-10</d><h>19:42</h><r>hlship</r>I&apos;m still struggling with the above approach; I think AOT is getting in the way, and (for the time being) need AOT my server.</z><z id="t1578685485" t="ddeaguiar Hm could be"><y>#</y><d>2020-01-10</d><h>19:44</h><r>ddeaguiar</r>Hm could be</z><z id="t1578685748" t="ddeaguiar I uberjar my sample with :aot :all and it seems to work. Wierd."><y>#</y><d>2020-01-10</d><h>19:49</h><r>ddeaguiar</r>I uberjar my sample with <code>:aot :all</code> and it seems to work. Wierd.</z><z id="t1578686043" t="hlship I was getting ClassNotFoundException for LoggerSource. Not sure what&apos;s up with that."><y>#</y><d>2020-01-10</d><h>19:54</h><r>hlship</r>I was getting ClassNotFoundException for LoggerSource.  Not sure what&apos;s up with that.</z><z id="t1579021628" t="souenzzo How do I get &quot;raw bytes&quot; from HTTP request?"><y>#</y><d>2020-01-14</d><h>17:07</h><w>souenzzo</w>How do I get &quot;raw bytes&quot; from HTTP request?</z><z id="t1579033357" t="orestis The body should be an input stream by default - do you need lower level than the body? Headers etc?"><y>#</y><d>2020-01-14</d><h>20:22</h><w>orestis</w>The body should be an input stream by default - do you need lower level than the body? Headers etc?</z><z id="t1579089753" t="souenzzo Yeah. &quot;full raw&quot; request, with request line, headers..."><y>#</y><d>2020-01-15</d><h>12:02</h><r>souenzzo</r>Yeah. &quot;full raw&quot; request, with request line, headers...</z><z id="t1579090872" t="orestis Don’t know anything from the top of my head. Probably need to go to a lower level. Curious to hear the use case. "><y>#</y><d>2020-01-15</d><h>12:21</h><r>orestis</r>Don’t know anything from the top of my head. Probably need to go to a lower level. Curious to hear the use case. </z><z id="t1579040582" t="bartuka hi ppl, is it possible to integrate pedestal with swagger?"><y>#</y><d>2020-01-14</d><h>22:23</h><w>bartuka</w>hi ppl, is it possible to integrate pedestal with swagger?</z><z id="t1579064790" t="orestis Not directly, but you can plug the reitit router that I believe supports this. See also #reitit "><y>#</y><d>2020-01-15</d><h>05:06</h><w>orestis</w>Not directly, but you can plug the reitit router that I believe supports this. See also #reitit </z><z id="t1579064863" t="bartuka Yes, I found it! I am trying to finish a proof of concept using both"><y>#</y><d>2020-01-15</d><h>05:07</h><w>bartuka</w>Yes, I found it! I am trying to finish a proof of concept using both</z><z id="t1579064901" t="bartuka you know how could I write a middleware to handle decimals using spec coercion?"><y>#</y><d>2020-01-15</d><h>05:08</h><w>bartuka</w>you know how could I write a middleware to handle <code>decimals</code> using spec coercion?</z><z id="t1579065059" t="bartuka or better, an interceptor 😃"><y>#</y><d>2020-01-15</d><h>05:10</h><w>bartuka</w>or better, an interceptor <b>😃</b></z><z id="t1579135546" t="chrisulloa I’m trying to upgrade pedestal from 0.5.3 to 0.5.7"><y>#</y><d>2020-01-16</d><h>00:45</h><w>chrisulloa</w>I’m trying to upgrade pedestal from 0.5.3 to 0.5.7</z><z id="t1579135563" t="chrisulloa Running locally have no issues, but when I run the service in a docker compose container, the service isn’t reachable"><y>#</y><d>2020-01-16</d><h>00:46</h><w>chrisulloa</w>Running locally have no issues, but when I run the service in a docker compose container, the service isn’t reachable</z><z id="t1579135577" t="chrisulloa I saw this comment in the changelog BREAKING CHANGE: nil ::host in service map defaults to localhost now (rather than being container specific) #557."><y>#</y><d>2020-01-16</d><h>00:46</h><w>chrisulloa</w>I saw this comment in the changelog <code>BREAKING CHANGE: nil ::host in service map defaults to localhost now (rather than being container specific) #557.</code></z><z id="t1579135601" t="jvtrigueros You might need to set your host to 0.0.0.0"><y>#</y><d>2020-01-16</d><h>00:46</h><w>jvtrigueros</w>You might need to set your host to 0.0.0.0</z><z id="t1579135614" t="chrisulloa Okay going to try that"><y>#</y><d>2020-01-16</d><h>00:46</h><w>chrisulloa</w>Okay going to try that</z><z id="t1579135621" t="chrisulloa Thank you 😃"><y>#</y><d>2020-01-16</d><h>00:47</h><w>chrisulloa</w>Thank you <b>😃</b></z><z id="t1579135682" t="chrisulloa It works!"><y>#</y><d>2020-01-16</d><h>00:48</h><w>chrisulloa</w>It works!</z><z id="t1579548617" t="chrisulloa After updating from pedestal 0.5.3 to 0.5.7, I’m noticing high memory utilization in my docker containers"><y>#</y><d>2020-01-20</d><h>19:30</h><w>chrisulloa</w>After updating from pedestal 0.5.3 to 0.5.7, I’m noticing high memory utilization in my docker containers</z><z id="t1579548628" t="chrisulloa Traffic seems to be as it was before the change"><y>#</y><d>2020-01-20</d><h>19:30</h><w>chrisulloa</w>Traffic seems to be as it was before the change</z><z id="t1579548649" t="chrisulloa I’m wondering if anyone noticed changes after upgrading pedestal. I’m thinking it might have something to due with Jetty upgrades."><y>#</y><d>2020-01-20</d><h>19:30</h><w>chrisulloa</w>I’m wondering if anyone noticed changes after upgrading pedestal. I’m thinking it might have something to due with Jetty upgrades.</z><z id="t1579548841" t="chrisulloa Jetty went from 9.4.0 to 9.4.18"><y>#</y><d>2020-01-20</d><h>19:34</h><w>chrisulloa</w>Jetty went from 9.4.0 to 9.4.18</z><z id="t1579626544" t="chrisulloa Nevermind was an unrelated issue 😃"><y>#</y><d>2020-01-21</d><h>17:09</h><w>chrisulloa</w>Nevermind was an unrelated issue <b>😃</b></z><z id="t1579866464" t="Ivar Refsdal Has anyone exposed nREPL over/through a pedestal HTTP endpoint?"><y>#</y><d>2020-01-24</d><h>11:47</h><w>Ivar Refsdal</w>Has anyone exposed nREPL over/through a pedestal HTTP endpoint?</z><z id="t1579967540" t="Shima As the pedestal documentation mentioned if one of the error-ceptors in the chain returns context the execution happens on the left part for the remaining interceptors, am I right? so why other interceptors after this one also run their error part and why the spy print an exception? {:name ::known-error   `:error (fn [context e]`       `(-&gt; context`         `(assoc :response`             `{:status 400`             `:body  {:interceptor (e :interceptor)`                  `:exception (e :exception)}`             `:header {}}))`       `(timbre/spy)}`"><y>#</y><d>2020-01-25</d><h>15:52</h><w>Shima</w>As the pedestal documentation mentioned if one of the error-ceptors in the chain returns context the execution happens on the left part for the remaining interceptors, am I right? so why other interceptors after this one also run their error part and why the spy print an exception?
<code>{:name ::known-error</code>
  `:error (fn [context e]`
      `(-&gt; context`
        `(assoc :response`
            `{:status 400`
            `:body  {:interceptor (e :interceptor)`
                 `:exception (e :exception)}`
            `:header {}}))`
      `(timbre/spy)}`</z><z id="t1579985080" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UGR3UQULA&quot;}] thanks for posting your question! There are a few issues with that error handler. Firstly, e in the code above is an ExceptionInfo instance not a fn or fn-like. Secondly, I suspect you intended to thread the context through (timbre/spy) ."><y>#</y><d>2020-01-25</d><h>20:44</h><r>ddeaguiar</r><a>@UGR3UQULA</a> thanks for posting your question! There are a few issues with that error handler. Firstly, <code>e</code> in the code above is an <code>ExceptionInfo</code> instance not a fn or fn-like. Secondly, I suspect you intended to thread the context through <code>(timbre/spy)</code> .</z><z id="t1580184532" t="macrobartfast I can&apos;t reach the server port (8080 in my case... the default Pedestal port) in a docker container in which pedestal is running on osx, even after adding :: http/host &quot;0.0.0.0&quot; per https://github.com/pedestal/pedestal/issues/604 ... I&apos;ve been working on this for several hours... I tested that an apache container running on 8080 is reachable... help."><y>#</y><d>2020-01-28</d><h>04:08</h><w>macrobartfast</w>I can&apos;t reach the server port (8080 in my case... the default Pedestal port) in a docker container in which pedestal is running on osx, even after adding <b>::</b>http/host &quot;0.0.0.0&quot; per <a href="https://github.com/pedestal/pedestal/issues/604" target="_blank">https://github.com/pedestal/pedestal/issues/604</a>... I&apos;ve been working on this for several hours... I tested that an apache container running on 8080 is reachable... help.</z><z id="t1580191979" t="chrisulloa are you exposing the port properly when running the docker container?"><y>#</y><d>2020-01-28</d><h>06:12</h><w>chrisulloa</w>are you exposing the port properly when running the docker container?</z><z id="t1580192265" t="chrisulloa nvm i see you’re in another channel figuring it out"><y>#</y><d>2020-01-28</d><h>06:17</h><w>chrisulloa</w>nvm i see you’re in another channel figuring it out</z><z id="t1580233775" t="KJO [:attrs {:href &quot;/_/_/users/U0X9N9ZK5&quot;}] Not sure if this&apos;ll be helpful, but I use the following service map to start pedestal"><y>#</y><d>2020-01-28</d><h>17:49</h><w>KJO</w><a>@macrobartfast</a> Not sure if this&apos;ll be helpful, but I use the following service map to start pedestal</z><z id="t1580233964" t="KJO {::http/host &quot;0.0.0.0&quot; ::http/allowed-origins {:allowed-origins (fn[_] true) :creds true} ::http/routes #(deref #&apos;routes) ::http/type :jetty ::http/container-options {:context-configurator jetty-websocket-configurator :h2c? true :h2 true :ssl? true :ssl-port 8081 :keystore keystore-location :key-password &quot;xxxxxxxxxx&quot; :security-provider &quot;Conscrypt&quot;} ::http/port 8080} and then the following docker command to bring up the container docker run --name test --env-file=docker/env_file.txt -p:8081:8081 -it allocations:latest and that works for me. I&apos;m sure that -p8080:8080 will also work for the non https connection"><y>#</y><d>2020-01-28</d><h>17:52</h><w>KJO</w><pre>{::http/host &quot;0.0.0.0&quot;
 ::http/allowed-origins
             {:allowed-origins (fn[_] true)
              :creds true}
 ::http/routes #(deref #&apos;routes)
 ::http/type   :jetty
 ::http/container-options
 {:context-configurator jetty-websocket-configurator
  :h2c? true
  :h2 true
  :ssl? true
  :ssl-port 8081
  :keystore keystore-location
  :key-password &quot;xxxxxxxxxx&quot;
  :security-provider &quot;Conscrypt&quot;}
 ::http/port   8080}</pre>
and then the following docker command to bring up the container
<pre>docker run --name test --env-file=docker/env_file.txt -p:8081:8081 -it allocations:latest</pre>
and that works for me. I&apos;m sure that -p8080:8080 will also work for the non https connection</z><z id="t1580237849" t="macrobartfast [:attrs {:href &quot;/_/_/users/UDBM9Q0VC&quot;}] I was exposing the port in the Dockerfile... I event tried running the container with -P (the capitalized version of the port flag) which tells Docker to pick a random high port, and it was still unreachable."><y>#</y><d>2020-01-28</d><h>18:57</h><w>macrobartfast</w><a>@christian.gonzalez</a> I was exposing the port in the Dockerfile... I event tried running the container with -P (the capitalized version of the port flag) which tells Docker to pick a random high port, and it was still unreachable.</z><z id="t1580237875" t="macrobartfast I switched to Tomcat from Jetty and that worked."><y>#</y><d>2020-01-28</d><h>18:57</h><w>macrobartfast</w>I switched to Tomcat from Jetty and that worked.</z><z id="t1580237880" t="macrobartfast but we never resolved the issue."><y>#</y><d>2020-01-28</d><h>18:58</h><w>macrobartfast</w>but we never resolved the issue.</z><z id="t1580237894" t="chrisulloa weird, we use jetty and pedestal with set up similar to above ^"><y>#</y><d>2020-01-28</d><h>18:58</h><w>chrisulloa</w>weird, we use jetty and pedestal with set up similar to above ^</z><z id="t1580237896" t="chrisulloa no problems"><y>#</y><d>2020-01-28</d><h>18:58</h><w>chrisulloa</w>no problems</z><z id="t1580237904" t="macrobartfast I know... bizarre."><y>#</y><d>2020-01-28</d><h>18:58</h><w>macrobartfast</w>I know... bizarre.</z><z id="t1580237916" t="macrobartfast I like the Jetty version, so would like it to work."><y>#</y><d>2020-01-28</d><h>18:58</h><w>macrobartfast</w>I like the Jetty version, so would like it to work.</z><z id="t1580237926" t="macrobartfast I have no reason I prefer Jetty, though."><y>#</y><d>2020-01-28</d><h>18:58</h><w>macrobartfast</w>I have no reason I prefer Jetty, though.</z><z id="t1580237938" t="chrisulloa are you overriding the pedestal jetty version?"><y>#</y><d>2020-01-28</d><h>18:58</h><w>chrisulloa</w>are you overriding the pedestal jetty version?</z><z id="t1580237974" t="chrisulloa sometimes dependencies will pull in different versions of jetty too"><y>#</y><d>2020-01-28</d><h>18:59</h><w>chrisulloa</w>sometimes dependencies will pull in different versions of jetty too</z><z id="t1580237982" t="macrobartfast I am.... I included Tomcat in project.clj and the changed the value in the map from Jetty."><y>#</y><d>2020-01-28</d><h>18:59</h><w>macrobartfast</w>I am.... I included Tomcat in project.clj and the changed the value in the map from Jetty.</z><z id="t1580237999" t="macrobartfast Yeah, I was wondering if I should change my versions."><y>#</y><d>2020-01-28</d><h>18:59</h><w>macrobartfast</w>Yeah, I was wondering if I should change my versions.</z><z id="t1580238012" t="macrobartfast Also, maybe the leiningen Pedestal template?"><y>#</y><d>2020-01-28</d><h>19:00</h><w>macrobartfast</w>Also, maybe the leiningen Pedestal template?</z><z id="t1580238037" t="macrobartfast I couldn&apos;t find it in ~/.lein/profiles so not sure where the template is specified."><y>#</y><d>2020-01-28</d><h>19:00</h><w>macrobartfast</w>I couldn&apos;t find it in ~/.lein/profiles so not sure where the template is specified.</z><z id="t1580238068" t="macrobartfast I must have a more global place I&apos;m setting up lein with the plugin."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>I must have a more global place I&apos;m setting up lein with the plugin.</z><z id="t1580238069" t="macrobartfast on osx."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>on osx.</z><z id="t1580238077" t="chrisulloa lein should pull in the template remotely"><y>#</y><d>2020-01-28</d><h>19:01</h><w>chrisulloa</w>lein should pull in the template remotely</z><z id="t1580238085" t="macrobartfast ah ok."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>ah ok.</z><z id="t1580238090" t="chrisulloa lein new pedestal-service my-project"><y>#</y><d>2020-01-28</d><h>19:01</h><w>chrisulloa</w><code>lein new pedestal-service my-project</code></z><z id="t1580238096" t="macrobartfast that&apos;s what I use."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>that&apos;s what I use.</z><z id="t1580238101" t="macrobartfast it&apos;s freaking awesome."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>it&apos;s freaking awesome.</z><z id="t1580238115" t="macrobartfast I love Pedestal."><y>#</y><d>2020-01-28</d><h>19:01</h><w>macrobartfast</w>I love Pedestal.</z><z id="t1580238136" t="chrisulloa what dependencies do you have in your project?"><y>#</y><d>2020-01-28</d><h>19:02</h><w>chrisulloa</w>what dependencies do you have in your project?</z><z id="t1580238222" t="macrobartfast (defproject general-pedestal-service &quot;0.0.1-SNAPSHOT&quot; :description &quot;FIXME: write description&quot; :url &quot; http://example.com/FIXME &quot; :license {:name &quot;Eclipse Public License&quot; :url &quot; http://www.eclipse.org/legal/epl-v10.html &quot;} :dependencies [[org.clojure/clojure &quot;1.10.1&quot;] [io.pedestal/pedestal.service &quot;0.5.7&quot;] ;; Remove this line and uncomment one of the next lines to ;; use Immutant or Tomcat instead of Jetty: ;; [io.pedestal/pedestal.jetty &quot;0.5.7&quot;] ;; [io.pedestal/pedestal.immutant &quot;0.5.7&quot;] [io.pedestal/pedestal.tomcat &quot;0.5.7&quot;] [ch.qos.logback/logback-classic &quot;1.2.3&quot; :exclusions [org.slf4j/slf4j-api]] [org.slf4j/jul-to-slf4j &quot;1.7.26&quot;] [org.slf4j/jcl-over-slf4j &quot;1.7.26&quot;] [org.slf4j/log4j-over-slf4j &quot;1.7.26&quot;]] :min-lein-version &quot;2.0.0&quot; :resource-paths [&quot;config&quot;, &quot;resources&quot;] ;; If you use HTTP/2 or ALPN, use the java-agent to pull in the correct alpn-boot dependency ;:java-agents [[org.mortbay.jetty.alpn/jetty-alpn-agent &quot;2.0.5&quot;]] :profiles {:dev {:aliases {&quot;run-dev&quot; [&quot;trampoline&quot; &quot;run&quot; &quot;-m&quot; &quot;general-pedestal-service.server/run-dev&quot;]} :dependencies [[io.pedestal/pedestal.service-tools &quot;0.5.7&quot;]]} :uberjar {:aot [general-pedestal-service.server]}} :main ^{:skip-aot true} general-pedestal-service.server)"><y>#</y><d>2020-01-28</d><h>19:03</h><w>macrobartfast</w>(defproject general-pedestal-service &quot;0.0.1-SNAPSHOT&quot;
  :description &quot;FIXME: write description&quot;
  :url &quot;<a href="http://example.com/FIXME" target="_blank">http://example.com/FIXME</a>&quot;
  :license {:name &quot;Eclipse Public License&quot;
            :url &quot;<a href="http://www.eclipse.org/legal/epl-v10.html" target="_blank">http://www.eclipse.org/legal/epl-v10.html</a>&quot;}
  :dependencies [[org.clojure/clojure &quot;1.10.1&quot;]
                 [io.pedestal/pedestal.service &quot;0.5.7&quot;]
                 ;; Remove this line and uncomment one of the next lines to
                 ;; use Immutant or Tomcat instead of Jetty:
                 ;; [io.pedestal/pedestal.jetty &quot;0.5.7&quot;]
                 ;; [io.pedestal/pedestal.immutant &quot;0.5.7&quot;]
                 [io.pedestal/pedestal.tomcat &quot;0.5.7&quot;]

                 [ch.qos.logback/logback-classic &quot;1.2.3&quot; :exclusions [org.slf4j/slf4j-api]]
                 [org.slf4j/jul-to-slf4j &quot;1.7.26&quot;]
                 [org.slf4j/jcl-over-slf4j &quot;1.7.26&quot;]
                 [org.slf4j/log4j-over-slf4j &quot;1.7.26&quot;]]
  :min-lein-version &quot;2.0.0&quot;
  :resource-paths [&quot;config&quot;, &quot;resources&quot;]
  ;; If you use HTTP/2 or ALPN, use the java-agent to pull in the correct alpn-boot dependency
                                        ;:java-agents [[org.mortbay.jetty.alpn/jetty-alpn-agent &quot;2.0.5&quot;]]
  :profiles {:dev {:aliases {&quot;run-dev&quot; [&quot;trampoline&quot; &quot;run&quot; &quot;-m&quot; &quot;general-pedestal-service.server/run-dev&quot;]}
                   :dependencies [[io.pedestal/pedestal.service-tools &quot;0.5.7&quot;]]}
             :uberjar {:aot [general-pedestal-service.server]}}
  :main ^{:skip-aot true} general-pedestal-service.server)</z><z id="t1580238266" t="macrobartfast it&apos;s just a bare bones pedestal service to get going with pedestal in docker on kubernetes."><y>#</y><d>2020-01-28</d><h>19:04</h><w>macrobartfast</w>it&apos;s just a bare bones pedestal service to get going with pedestal in docker on kubernetes.</z><z id="t1580238267" t="chrisulloa presumably had jetty line uncommented when you were trying that"><y>#</y><d>2020-01-28</d><h>19:04</h><w>chrisulloa</w>presumably had jetty line uncommented when you were trying that</z><z id="t1580238282" t="macrobartfast I did have them uncommented, good thought though."><y>#</y><d>2020-01-28</d><h>19:04</h><w>macrobartfast</w>I did have them uncommented, good thought though.</z><z id="t1580238294" t="chrisulloa what java version?"><y>#</y><d>2020-01-28</d><h>19:04</h><w>chrisulloa</w>what java version?</z><z id="t1580238299" t="chrisulloa in your dockerfile?"><y>#</y><d>2020-01-28</d><h>19:04</h><w>chrisulloa</w>in your dockerfile?</z><z id="t1580238368" t="macrobartfast java version &quot;1.8.0_92&quot;"><y>#</y><d>2020-01-28</d><h>19:06</h><w>macrobartfast</w>java version &quot;1.8.0_92&quot;</z><z id="t1580238381" t="macrobartfast FROM java:8-alpine"><y>#</y><d>2020-01-28</d><h>19:06</h><w>macrobartfast</w>FROM java:8-alpine</z><z id="t1580238386" t="chrisulloa ah okay"><y>#</y><d>2020-01-28</d><h>19:06</h><w>chrisulloa</w>ah okay</z><z id="t1580238389" t="macrobartfast the latter is the docker version"><y>#</y><d>2020-01-28</d><h>19:06</h><w>macrobartfast</w>the latter is the docker version</z><z id="t1580238391" t="chrisulloa not sure what the issue is really"><y>#</y><d>2020-01-28</d><h>19:06</h><w>chrisulloa</w>not sure what the issue is really</z><z id="t1580238395" t="macrobartfast I know, right?"><y>#</y><d>2020-01-28</d><h>19:06</h><w>macrobartfast</w>I know, right?</z><z id="t1580238415" t="macrobartfast maybe this is the right moment to go with Tomcat and move along."><y>#</y><d>2020-01-28</d><h>19:06</h><w>macrobartfast</w>maybe this is the right moment to go with Tomcat and move along.</z><z id="t1580238426" t="chrisulloa are you running the service locally with docker or in your kube cluster?"><y>#</y><d>2020-01-28</d><h>19:07</h><w>chrisulloa</w>are you running the service locally with docker or in your kube cluster?</z><z id="t1580238441" t="macrobartfast running the service locally."><y>#</y><d>2020-01-28</d><h>19:07</h><w>macrobartfast</w>running the service locally.</z><z id="t1580238482" t="macrobartfast well, first was going to run the service in a container, then run the container in the cloud in a small vps, then figure out some kube workflow."><y>#</y><d>2020-01-28</d><h>19:08</h><w>macrobartfast</w>well, first was going to run the service in a container, then run the container in the cloud in a small vps, then figure out some kube workflow.</z><z id="t1580238489" t="macrobartfast a big step for me, all that."><y>#</y><d>2020-01-28</d><h>19:08</h><w>macrobartfast</w>a big step for me, all that.</z><z id="t1580238495" t="chrisulloa for sure"><y>#</y><d>2020-01-28</d><h>19:08</h><w>chrisulloa</w>for sure</z><z id="t1580238524" t="macrobartfast terrifying devops rabbithole."><y>#</y><d>2020-01-28</d><h>19:08</h><w>macrobartfast</w>terrifying devops rabbithole.</z><z id="t1580238553" t="macrobartfast with this issue, I feel like a olympic sprinter who&apos;s tripped at the start."><y>#</y><d>2020-01-28</d><h>19:09</h><w>macrobartfast</w>with this issue, I feel like a olympic sprinter who&apos;s tripped at the start.</z><z id="t1580238657" t="macrobartfast maybe it&apos;s a test... do I just go with Tomcat and move on, or spend a day resolving the Jetty issue when it has no material effect?"><y>#</y><d>2020-01-28</d><h>19:10</h><w>macrobartfast</w>maybe it&apos;s a test... do I just go with Tomcat and move on, or spend a day resolving the Jetty issue when it has no material effect?</z><z id="t1580238672" t="macrobartfast life choices."><y>#</y><d>2020-01-28</d><h>19:11</h><w>macrobartfast</w>life choices.</z><z id="t1580238715" t="chrisulloa might be good to just run with tomcat and come back to it later"><y>#</y><d>2020-01-28</d><h>19:11</h><w>chrisulloa</w>might be good to just run with tomcat and come back to it later</z><z id="t1580238735" t="chrisulloa make an issue in pedestal since they are providing template"><y>#</y><d>2020-01-28</d><h>19:12</h><w>chrisulloa</w>make an issue in pedestal since they are providing template</z><z id="t1580238756" t="macrobartfast down the road, you&apos;ll be one of the few Jedis who knows why Encom uses Tomcat."><y>#</y><d>2020-01-28</d><h>19:12</h><w>macrobartfast</w>down the road, you&apos;ll be one of the few Jedis who knows why Encom uses Tomcat.</z><z id="t1580238813" t="chrisulloa might also be an issue with your local machine"><y>#</y><d>2020-01-28</d><h>19:13</h><w>chrisulloa</w>might also be an issue with your local machine</z><z id="t1580238821" t="macrobartfast I suspect it is."><y>#</y><d>2020-01-28</d><h>19:13</h><w>macrobartfast</w>I suspect it is.</z><z id="t1580238836" t="chrisulloa might be worth sending docker container and run script to another dev and trying"><y>#</y><d>2020-01-28</d><h>19:13</h><w>chrisulloa</w>might be worth sending docker container and run script to another dev and trying</z><z id="t1580238848" t="macrobartfast brilliant idea."><y>#</y><d>2020-01-28</d><h>19:14</h><w>macrobartfast</w>brilliant idea.</z><z id="t1580238870" t="macrobartfast and also, pull down a working pedestal service that&apos;s known to work and try it locally."><y>#</y><d>2020-01-28</d><h>19:14</h><w>macrobartfast</w>and also, pull down a working pedestal service that&apos;s known to work and try it locally.</z><z id="t1580238880" t="chrisulloa yep"><y>#</y><d>2020-01-28</d><h>19:14</h><w>chrisulloa</w>yep</z><z id="t1580238894" t="chrisulloa we have multiple services that use pedestal, same set up more or less just on different ports"><y>#</y><d>2020-01-28</d><h>19:14</h><w>chrisulloa</w>we have multiple services that use pedestal, same set up more or less just on different ports</z><z id="t1580238949" t="macrobartfast oh, one interesting thing, when I deployed to digital ocean..."><y>#</y><d>2020-01-28</d><h>19:15</h><w>macrobartfast</w>oh, one interesting thing, when I deployed to digital ocean...</z><z id="t1580238953" t="macrobartfast it didn&apos;t work."><y>#</y><d>2020-01-28</d><h>19:15</h><w>macrobartfast</w>it didn&apos;t work.</z><z id="t1580238974" t="macrobartfast so I should try a node app or something and see if it works in the cloud."><y>#</y><d>2020-01-28</d><h>19:16</h><w>macrobartfast</w>so I should try a node app or something and see if it works in the cloud.</z><z id="t1580238982" t="macrobartfast sounds like I have my next steps cut out for me."><y>#</y><d>2020-01-28</d><h>19:16</h><w>macrobartfast</w>sounds like I have my next steps cut out for me.</z><z id="t1580238994" t="chrisulloa good luck"><y>#</y><d>2020-01-28</d><h>19:16</h><w>chrisulloa</w>good luck</z><z id="t1580238999" t="chrisulloa maybe someone will chime in later who knows more"><y>#</y><d>2020-01-28</d><h>19:16</h><w>chrisulloa</w>maybe someone will chime in later who knows more</z><z id="t1580239003" t="macrobartfast thank you!"><y>#</y><d>2020-01-28</d><h>19:16</h><w>macrobartfast</w>thank you!</z><z id="t1580239049" t="macrobartfast and yes. the fact that it didn&apos;t work in the cloud tells me that something is wrong with my dependencies... I&apos;m shipping the problem up to my vps and it&apos;s occurring there."><y>#</y><d>2020-01-28</d><h>19:17</h><w>macrobartfast</w>and yes. the fact that it didn&apos;t work in the cloud tells me that something is wrong with my dependencies... I&apos;m shipping the problem up to my vps and it&apos;s occurring there.</z><z id="t1580242365" t="macrobartfast haha well... got the Tomcat version of the Pedestal service deployed in the cloud and got an SSH error ( java.lang.IllegalArgumentException: Invalid character found in method name. HTTP method names must be tokens ) so maybe I dooo like Jetty more. That may have happened with Jetty, too, for all I know. https://stackoverflow.com/questions/42218237/java-lang-illegalargumentexception-invalid-character-found-in-method-name-http"><y>#</y><d>2020-01-28</d><h>20:12</h><w>macrobartfast</w>haha well... got the Tomcat version of the Pedestal service deployed in the cloud and got an SSH error ( <code>java.lang.IllegalArgumentException: Invalid character found in method name. HTTP method names must be tokens</code> ) so maybe I dooo like Jetty more. That may have happened with Jetty, too, for all I know. <a href="https://stackoverflow.com/questions/42218237/java-lang-illegalargumentexception-invalid-character-found-in-method-name-http" target="_blank">https://stackoverflow.com/questions/42218237/java-lang-illegalargumentexception-invalid-character-found-in-method-name-http</a></z><z id="t1580243073" t="macrobartfast oh duh. works if you request via http. I shouldn&apos;t have shared my little journey."><y>#</y><d>2020-01-28</d><h>20:24</h><w>macrobartfast</w>oh duh. works if you request via http. I shouldn&apos;t have shared my little journey.</z><z id="t1580389439" t="Ivar Refsdal PS [:attrs {:href &quot;/_/_/users/U0X9N9ZK5&quot;}] It seems that the java: -docker image is discontinued and on dockerhub the java page redirects to openjdk. $ docker run -it java:8-alpine /usr/bin/java -version openjdk version &quot;1.8.0_111-internal&quot; OpenJDK Runtime Environment (build 1.8.0_111-internal-alpine-r0-b14) OpenJDK 64-Bit Server VM (build 25.111-b14, mixed mode) $ docker run -it openjdk:8-alpine /usr/bin/java -version openjdk version &quot;1.8.0_212&quot; OpenJDK Runtime Environment (IcedTea 3.12.0) (Alpine 8.212.04-r0) OpenJDK 64-Bit Server VM (build 25.212-b04, mixed mode) So you may want to start using openjdk: in Dockerfiles"><y>#</y><d>2020-01-30</d><h>13:03</h><w>Ivar Refsdal</w>PS <a>@macrobartfast</a>
It seems that the <code>java:</code>-docker image is discontinued and on dockerhub the java page redirects to openjdk.

<pre>$ docker run -it java:8-alpine /usr/bin/java -version
openjdk version &quot;1.8.0_111-internal&quot;
OpenJDK Runtime Environment (build 1.8.0_111-internal-alpine-r0-b14)
OpenJDK 64-Bit Server VM (build 25.111-b14, mixed mode)

$ docker run -it openjdk:8-alpine /usr/bin/java -version
openjdk version &quot;1.8.0_212&quot;
OpenJDK Runtime Environment (IcedTea 3.12.0) (Alpine 8.212.04-r0)
OpenJDK 64-Bit Server VM (build 25.212-b04, mixed mode)</pre>
So you may want to start using <code>openjdk:</code> in Dockerfiles</z><z id="t1580389558" t="Ivar Refsdal Ah, I see that lein new pedestal-service my-project also uses FROM java:... Edit: I opened an issue: https://github.com/pedestal/pedestal/issues/642"><y>#</y><d>2020-01-30</d><h>13:05</h><w>Ivar Refsdal</w>Ah, I see that <code>lein new pedestal-service my-project</code> also uses <code>FROM java:...</code>

Edit: I opened an issue: <a href="https://github.com/pedestal/pedestal/issues/642" target="_blank">https://github.com/pedestal/pedestal/issues/642</a></z><z id="t1580393290" t="ddeaguiar Thanks for the issue [:attrs {:href &quot;/_/_/users/UGJE0MM0W&quot;}] !"><y>#</y><d>2020-01-30</d><h>14:08</h><w>ddeaguiar</w>Thanks for the issue <a>@ivar.refsdal</a>!</z><z id="t1581355352" t="vemv Integrating Pedestal with refresh / reset is bit of a common pain point (afaict) - I have seen it recommended to use a mixed approach, which seems acceptable but also can be confusing in the context of a team using different tools of choice. In face of that I created a relatively simple wrapper at work: https://github.com/nedap/components.pedestal - after 1 year is quite proven by now. Hope some find it useful!"><y>#</y><d>2020-02-10</d><h>17:22</h><w>vemv</w>Integrating Pedestal with <code>refresh</code> / <code>reset</code> is bit of a common pain point (afaict) - I have seen it recommended to use a mixed approach, which seems acceptable but also can be confusing in the context of a team using different tools of choice.

In face of that I created a relatively simple wrapper at work: <a href="https://github.com/nedap/components.pedestal" target="_blank">https://github.com/nedap/components.pedestal</a> - after 1 year is quite proven by now.

Hope some find it useful!</z><z id="t1581857010" t="souenzzo how to handle timeouts in pedestal?"><y>#</y><d>2020-02-16</d><h>12:43</h><w>souenzzo</w>how to handle timeouts in pedestal?</z><z id="t1581872445" t="vemv wdym?"><y>#</y><d>2020-02-16</d><h>17:00</h><r>vemv</r>wdym?</z><z id="t1581872724" t="souenzzo there is a global timeout handler or something like?"><y>#</y><d>2020-02-16</d><h>17:05</h><r>souenzzo</r>there is a global timeout handler or something like?</z><z id="t1581873088" t="vemv sorry I still don&apos;t get you. there are various things that can time out"><y>#</y><d>2020-02-16</d><h>17:11</h><r>vemv</r>sorry I still don&apos;t get you. there are various things that can time out</z><z id="t1581877242" t="souenzzo I wanna say things like: if any handler last more then 3 seconds, call this other function"><y>#</y><d>2020-02-16</d><h>18:20</h><r>souenzzo</r>I wanna say things like:
if any handler last more then 3 seconds, call this other function</z><z id="t1581878940" t="vemv I&apos;d create an interceptor that is present in every route In said interceptor, I&apos;d plug in my concurrent facility of choice (java util.concurrent, clojure.core, core, async) to achieve the desired effect"><y>#</y><d>2020-02-16</d><h>18:49</h><r>vemv</r>I&apos;d create an interceptor that is present in every route

In said interceptor, I&apos;d plug in my concurrent facility of choice (java util.concurrent, clojure.core, core, async) to achieve the desired effect</z><z id="t1582540283" t="Ho0man Hi, everyone I don&apos;t know how I could write a test for the part of out API (that is implemented in pedestal) that accepts a file and uses Ring multi-part interceptor ? (Can I use the pedestal.test/response-for here the same way I used it for body params and such ? How should I construct the request and how should I feed the file to response-for ?) It will be great if anyone could help me Thanks in advance"><y>#</y><d>2020-02-24</d><h>10:31</h><w>Ho0man</w>Hi, everyone
I don&apos;t know how I could write a test for the part of out API (that is implemented in pedestal)
that accepts a file and uses Ring multi-part interceptor ? (Can I use the <code>pedestal.test/response-for</code> here
the same way I used it for body params and such ? How should I construct the request and how should I feed the file to <code>response-for</code> ?)
It will be great if anyone could help me
Thanks in advance</z><z id="t1582586489" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UU0F762AU&quot;}] , that’s a great question. Yes you can. I’ve added a sample of how you’d construct the request to the cookbook documentation ( http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service ). I’ve pasted the relevant bits above."><y>#</y><d>2020-02-24</d><h>23:21</h><r>ddeaguiar</r><a>@UU0F762AU</a>, that’s a great question. Yes you can. I’ve added a sample of how you’d construct the request to the cookbook documentation (<a href="http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service" target="_blank">http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service</a>). I’ve pasted the relevant bits above.</z><z id="t1582631287" t="mh.meraji Hi Thank you for your answer I have another issue about this subject How can we add also a simple key value near my file in the request body? Thank you for your time."><y>#</y><d>2020-02-25</d><h>11:48</h><r>mh.meraji</r>Hi
Thank you for your answer
I have another issue about this subject
How can we add also a simple key value near my file in the request body?
Thank you for your time.</z><z id="t1582669156" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBZ3VLMKJ&quot;}] it’s just a matter of adding additional fields wrapped by the boundary. The fields in the above sample do no need to be files"><y>#</y><d>2020-02-25</d><h>22:19</h><r>ddeaguiar</r><a>@UBZ3VLMKJ</a> it’s just a matter of adding additional fields wrapped by the boundary. The fields in the above sample do no need to be files</z><z id="t1582716726" t="Ho0man Thanks a lot [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2020-02-26</d><h>11:32</h><r>Ho0man</r>Thanks a lot <a>@U0FL657GR</a></z><z id="t1582717495" t="Ho0man [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Sorry another question, here you have sent a string file. But I want to send xlsx files. Can I use the same method for sending ?"><y>#</y><d>2020-02-26</d><h>11:44</h><r>Ho0man</r><a>@U0FL657GR</a> Sorry another question, here you have sent a string file. But I want to send xlsx files. Can I use the same method for sending ?</z><z id="t1582717498" t="Ho0man Thanks again"><y>#</y><d>2020-02-26</d><h>11:44</h><r>Ho0man</r>Thanks again</z><z id="t1582739176" t="dadair When using a hander-style interceptor (e.g., a req-&gt;resp function), is there any way to get the non-interpolated route (e.g., with keyword path params still in it, versus the actual values)? Printing the req seems to only have the interpolated path. I&apos;m on 0.5.3 for jetty/route/service . I know that I can have an interceptor inject [:route :path] from context into [:request &lt;somekey&gt;] , more just wondering if I&apos;m missing something."><y>#</y><d>2020-02-26</d><h>17:46</h><w>dadair</w>When using a hander-style interceptor (e.g., a req-&gt;resp function), is there any way to get the non-interpolated route (e.g., with keyword path params still in it, versus the actual values)? Printing the <code>req</code> seems to only have the interpolated path. I&apos;m on <code>0.5.3</code> for <code>jetty/route/service</code>. I know that I can have an interceptor inject <code>[:route :path]</code> from context into <code>[:request &lt;somekey&gt;]</code>, more just wondering if I&apos;m missing something.</z><z id="t1582741725" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0E2EQFME&quot;}] nope, you’re not missing anything."><y>#</y><d>2020-02-26</d><h>18:28</h><r>ddeaguiar</r><a>@U0E2EQFME</a> nope, you’re not missing anything.</z><z id="t1583193555" t="isak Anyone have any experience using pedestal as a component controlled by a component library like integrant? Was it easy to get a good REPL experience going?"><y>#</y><d>2020-03-02</d><h>23:59</h><w>isak</w>Anyone have any experience using pedestal as a component controlled by a component library like integrant? Was it easy to get a good REPL experience going?</z><z id="t1583205240" t="vemv we use it with Component at work, and it works quite well. This is our wrapper: https://github.com/nedap/components.pedestal . it has some custom idioms like those kws namespaces but it could be forked if deemed too weird. (btw, since we prefer defn to defrecord , the code might be salvaged for Integrant) In general Pedestal can be a bit picky about &quot;reloaded workflow&quot; integration and accomplishing it has given me occasional headaches."><y>#</y><d>2020-03-03</d><h>03:14</h><r>vemv</r>we use it with Component at work, and it works quite well.

This is our wrapper: <a href="https://github.com/nedap/components.pedestal" target="_blank">https://github.com/nedap/components.pedestal</a> . it has some custom idioms like those <code>kws</code> namespaces but it could be forked if deemed too weird.

(btw, since we prefer <code>defn</code> to <code>defrecord</code>, the code might be salvaged for Integrant)

In general Pedestal can be a bit picky about &quot;reloaded workflow&quot; integration and accomplishing it has given me occasional headaches.</z><z id="t1583248565" t="isak [:attrs {:href &quot;/_/_/users/U45T93RA6&quot;}] awesome, thanks!"><y>#</y><d>2020-03-03</d><h>15:16</h><r>isak</r><a>@U45T93RA6</a> awesome, thanks!</z><z id="t1583248574" t="isak I was starting to get that impression 🙂"><y>#</y><d>2020-03-03</d><h>15:16</h><r>isak</r>I was starting to get that impression <b>🙂</b></z><z id="t1583254000" t="isak Are these docs still correct about early termination happening if an interceptor in the chain returns a response map? http://pedestal.io/reference/servlet-interceptor#_early_termination For me it doesn&apos;t work - it still executes later interceptors"><y>#</y><d>2020-03-03</d><h>16:46</h><w>isak</w>Are these docs still correct about early termination happening if an interceptor in the chain returns a response map? <a href="http://pedestal.io/reference/servlet-interceptor#_early_termination" target="_blank">http://pedestal.io/reference/servlet-interceptor#_early_termination</a> For me it doesn&apos;t work - it still executes later interceptors</z><z id="t1583254378" t="isak Here is my interceptor that I expected would lead to early termination (but doesn&apos;t) based on that documentation: (def test-interceptor {:name ::test-interceptor :enter (fn [ctx] (log/info :msg &quot;Enter test-interceptor&quot;) (assoc ctx :response {:status 200 :body &quot;test&quot;})) :leave (fn [ctx] (log/info :msg &quot;leave test-interceptor&quot;) ctx)})"><y>#</y><d>2020-03-03</d><h>16:52</h><w>isak</w>Here is my interceptor that I expected would lead to early termination (but doesn&apos;t) based on that documentation:
<pre>(def test-interceptor
  {:name ::test-interceptor
   :enter
   (fn [ctx]
     (log/info :msg &quot;Enter test-interceptor&quot;)
     (assoc ctx :response {:status 200 :body &quot;test&quot;}))
   :leave (fn [ctx]
            (log/info :msg &quot;leave test-interceptor&quot;)
            ctx)})</pre></z><z id="t1583254775" t="isak Ah, it didn&apos;t work because it also needed :headers : (defn response? &quot;True if the supplied value is a valid response map.&quot; {:added &quot;1.1&quot;} [resp] (and (map? resp) (integer? (:status resp)) (map? (:headers resp))))"><y>#</y><d>2020-03-03</d><h>16:59</h><w>isak</w>Ah, it didn&apos;t work because it also needed <code>:headers</code>  :
<pre>(defn response?
  &quot;True if the supplied value is a valid response map.&quot;
  {:added &quot;1.1&quot;}
  [resp]
  (and (map? resp)
       (integer? (:status resp))
       (map? (:headers resp))))</pre></z><z id="t1583510868" t="ddeaguiar Following up on this, the response map reference doc has been updated ( http://pedestal.io/reference/response-map ). Thanks [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] for the initial PR. What is considered a valid response depends on which part of Pedestal is currently in question. The servlet integration impl abides but the Ring contract (`:status`, :headers are required). The default not-found interceptor uses a looser contract (only :status required). This was intentional since chain providers may vary."><y>#</y><d>2020-03-06</d><h>16:07</h><w>ddeaguiar</w>Following up on this, the response map reference doc has been updated (<a href="http://pedestal.io/reference/response-map" target="_blank">http://pedestal.io/reference/response-map</a>). Thanks <a>@isak</a> for the initial PR. What is considered a valid response depends on which part of Pedestal is currently in question. The servlet integration impl abides but the Ring contract (`:status`, <code>:headers</code> are required). The default <code>not-found</code> interceptor uses a looser contract (only <code>:status</code> required). This was intentional since chain providers may vary.</z><z id="t1583510993" t="isak Ah, I see. Nice!"><y>#</y><d>2020-03-06</d><h>16:09</h><r>isak</r>Ah, I see. Nice!</z><z id="t1583851424" t="Fredrik Meyer Short question: I try to use pedestal+Lacinia to build a GraphQL endpoint. It works perfectly fine in the GraphiQL endpoint. but it fails when I try to use the endpoint in Apollo+Javascript. I get a 404 on the preflight request - and I don&apos;t know how to handle this. Any tips?"><y>#</y><d>2020-03-10</d><h>14:43</h><w>Fredrik Meyer</w>Short question: I try to use pedestal+Lacinia to build a GraphQL endpoint. It works perfectly fine in the GraphiQL endpoint. but it fails when I try to use the endpoint in Apollo+Javascript. I get a 404 on the preflight request - and I don&apos;t know how to handle this. Any tips?</z><z id="t1583851594" t="ddeaguiar I’m not sure. Perhaps [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] knows?"><y>#</y><d>2020-03-10</d><h>14:46</h><r>ddeaguiar</r>I’m not sure. Perhaps <a>@U04VDKC4G</a> knows?</z><z id="t1583855778" t="hlship The URL for the websockets connection is different that the URL for normal GET/POST, which is just unavoidable due to how the Jetty stack operates. See this: https://lacinia-pedestal.readthedocs.io/en/latest/subscriptions.html#endpoint"><y>#</y><d>2020-03-10</d><h>15:56</h><r>hlship</r>The URL for the websockets connection is different that the URL for normal GET/POST, which is just unavoidable due to how the Jetty stack operates.  See this: <a href="https://lacinia-pedestal.readthedocs.io/en/latest/subscriptions.html#endpoint" target="_blank">https://lacinia-pedestal.readthedocs.io/en/latest/subscriptions.html#endpoint</a></z><z id="t1583851657" t="dvingo maybe make sure your config allows all origins, here&apos;s an example: https://github.com/pedestal/pedestal/blob/master/samples/template-server/src/template_server/server.clj#L34"><y>#</y><d>2020-03-10</d><h>14:47</h><w>dvingo</w>maybe make sure your config allows all origins, here&apos;s an example:
<a href="https://github.com/pedestal/pedestal/blob/master/samples/template-server/src/template_server/server.clj#L34" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/template-server/src/template_server/server.clj#L34</a></z><z id="t1583852349" t="Fredrik Meyer Thanks [:attrs {:href &quot;/_/_/users/U051V5LLP&quot;}] ! Adding the line ::http/allowed-origins {:creds true :allowed-origins (constantly true)} worked. Appears I need to learn more about cors and origins and such, because I don&apos;t understand why this worked"><y>#</y><d>2020-03-10</d><h>14:59</h><w>Fredrik Meyer</w>Thanks <a>@danvingo</a>! Adding the line <code>::http/allowed-origins {:creds true :allowed-origins (constantly true)}</code> worked. Appears I need to learn more about cors and origins and such, because I don&apos;t understand why this worked</z><z id="t1583874810" t="jackson Question about CORS.. should pedestal by default handle preflight OPTIONS requests, or do I need a route/interceptor for that?"><y>#</y><d>2020-03-10</d><h>21:13</h><w>jackson</w>Question about CORS.. should pedestal by default handle preflight OPTIONS requests, or do I need a route/interceptor for that?</z><z id="t1583938471" t="dvingo [:attrs {:href &quot;/_/_/users/UJ64540VC&quot;}] if you included allowed-origins: https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http.clj#L201 then the option interceptor is added: https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http/cors.clj"><y>#</y><d>2020-03-11</d><h>14:54</h><w>dvingo</w><a>@jackson.reynolds</a> if you included allowed-origins: <a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http.clj#L201" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http.clj#L201</a>
then the option interceptor is added:
<a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http/cors.clj" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/src/io/pedestal/http/cors.clj</a></z><z id="t1583942258" t="jackson [:attrs {:href &quot;/_/_/users/U051V5LLP&quot;}] Thanks. Turns out spelling is hard. hahaha"><y>#</y><d>2020-03-11</d><h>15:57</h><w>jackson</w><a>@danvingo</a> Thanks. Turns out spelling is hard. hahaha</z><z id="t1583942831" t="dvingo lol i&apos;ve been there"><y>#</y><d>2020-03-11</d><h>16:07</h><w>dvingo</w>lol i&apos;ve been there</z><z id="t1584698953" t="Ho0man Hi, everyone I was wondering how could I return a xlsx file (that I am actually constructing in the interceptor itself and not reading it from the filesystem) in pedestal ? Thanks in advance"><y>#</y><d>2020-03-20</d><h>10:09</h><w>Ho0man</w>Hi, everyone
I was wondering how could I return a xlsx file (that I am actually constructing in the interceptor itself and not reading it from the filesystem) in pedestal ?
Thanks in advance</z><z id="t1584704613" t="orestis You can return an InputStream for the body "><y>#</y><d>2020-03-20</d><h>11:43</h><w>orestis</w>You can return an InputStream for the body </z><z id="t1584706883" t="Ho0man Thanks a lot [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}]"><y>#</y><d>2020-03-20</d><h>12:21</h><r>Ho0man</r>Thanks a lot <a>@U7PBP4UVA</a></z><z id="t1584704625" t="orestis You’d need to put in the correct headers "><y>#</y><d>2020-03-20</d><h>11:43</h><w>orestis</w>You’d need to put in the correct headers </z><z id="t1584704638" t="orestis [:attrs {:href &quot;/_/_/users/U6CE37RK6&quot;}] ^^"><y>#</y><d>2020-03-20</d><h>11:43</h><w>orestis</w><a>@ho0man</a> ^^</z><z id="t1584983911" t="Santiago I’m new to pedestal (new-ish to clojure). to create a 404 response when a route doesn’t exist like {:body {:code 404 :message &quot;Not found&quot;} :status 404} I guess this is done as a interceptor, but what should I look for? Is this an :error ?"><y>#</y><d>2020-03-23</d><h>17:18</h><w>Santiago</w>I’m new to pedestal (new-ish to clojure). to create a 404 response when a route doesn’t exist like
<pre>{:body {:code 404
        :message &quot;Not found&quot;}
 :status 404}</pre>
I guess this is done as a interceptor, but what should I look for? Is this an <code>:error</code> ?</z><z id="t1584984287" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/UFPEDL1LY&quot;}] , If you include default-interceptors , there’s a default 404 interceptor provided. It can be overridden. Refer to http://pedestal.io/reference/default-interceptors and this response map footnote http://pedestal.io/reference/response-map#_footnotedef_1"><y>#</y><d>2020-03-23</d><h>17:24</h><r>ddeaguiar</r>Hi <a>@UFPEDL1LY</a>, If you include <code>default-interceptors</code>, there’s a default 404 interceptor provided. It can be overridden.  Refer to <a href="http://pedestal.io/reference/default-interceptors" target="_blank">http://pedestal.io/reference/default-interceptors</a> and this response map footnote <a href="http://pedestal.io/reference/response-map#_footnotedef_1" target="_blank">http://pedestal.io/reference/response-map#_footnotedef_1</a></z><z id="t1584984392" t="Santiago nice thanks, I can work with this 😉"><y>#</y><d>2020-03-23</d><h>17:26</h><r>Santiago</r>nice thanks, I can work with this <b>😉</b></z><z id="t1585037095" t="Santiago [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I was able to make the changes I wanted, but I don’t understand how to make the response JSON. Adding (update ::server/interceptors conj server/json-body) after (-&gt; service-map default-interceptors &lt;line above&gt; create-server start) converts good responses to JSON, but not the 404 responses. I added this ::http/not-found-interceptor my-not-found to my service-map"><y>#</y><d>2020-03-24</d><h>08:04</h><r>Santiago</r><a>@U0FL657GR</a> I was able to make the changes I wanted, but I don’t understand how to make the response JSON. Adding <code>(update ::server/interceptors conj server/json-body)</code> after
<pre>(-&gt; service-map
    default-interceptors
    &lt;line above&gt;
    create-server
    start)</pre>
converts good responses to JSON, but not the 404 responses. I added this <code>::http/not-found-interceptor my-not-found</code> to my service-map</z><z id="t1585037260" t="Santiago so it responds with 404 in the correct format, but as EDN, not JSON: {:code 404, :message &quot;Not Found :(&quot;} I guess because the JSON interceptor is before the not-found?"><y>#</y><d>2020-03-24</d><h>08:07</h><r>Santiago</r>so it responds with 404 in the correct format, but as EDN, not JSON:
<pre>{:code 404, :message &quot;Not Found :(&quot;}</pre>
I guess because the JSON interceptor is before the not-found?</z><z id="t1585042185" t="mavbozo What is the code for your my-not-found interceptor?"><y>#</y><d>2020-03-24</d><h>09:29</h><r>mavbozo</r>What is the code for your <code>my-not-found</code> interceptor?</z><z id="t1585069136" t="Santiago [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] (def my-not-found &quot;An interceptor that returns a 404 when routing failed to resolve a route.&quot; (interceptor/after ::not-found (fn [context] (if-not (http/response? (:response context)) (do (log/meter ::not-found) (assoc context :response (not-found &quot;Not Found :(&quot;))) context)))) and this is not-found (defn bad-body [code message] {:code code :message message}) (def not-found &quot;Returns a fn that creates a response map with status 404&quot; (comp ring-resp/not-found (partial bad-body 404)))"><y>#</y><d>2020-03-24</d><h>16:58</h><r>Santiago</r><a>@U075CCMPY</a>
<pre>(def my-not-found
  &quot;An interceptor that returns a 404 when routing failed to resolve a route.&quot;
  (interceptor/after
    ::not-found
    (fn [context]
      (if-not (http/response? (:response context))
        (do (log/meter ::not-found)
          (assoc context :response (not-found &quot;Not Found :(&quot;)))
        context))))</pre>
 and this is <code>not-found</code>
<pre>(defn bad-body
  [code message]
  {:code code 
   :message message})

(def not-found
  &quot;Returns a fn that creates a response map with status 404&quot;
  (comp ring-resp/not-found (partial bad-body 404)))</pre></z><z id="t1585081891" t="mavbozo nothing&apos;s wrong in your code above."><y>#</y><d>2020-03-24</d><h>20:31</h><r>mavbozo</r>nothing&apos;s wrong in your code above.</z><z id="t1585083208" t="mavbozo Your initial guess might be right, the chain of interceptors for your app looks like this [... my-not-found .. routes ... json-body] so, if the interceptor can not found any route, the execution goes back through :leave stages without entering json-body . But, I&apos;m curious about good responses returning JSON, do you use any special functions to generate JSON for good responses?"><y>#</y><d>2020-03-24</d><h>20:53</h><r>mavbozo</r>Your initial guess might be right, the chain of interceptors for your app looks like this
<code>[...  my-not-found .. routes ... json-body]</code>
so, if the interceptor can not found any route, the execution goes back through <code>:leave</code> stages without entering <code>json-body</code>.

But, I&apos;m curious about good responses returning JSON, do you use any special functions to generate JSON for good responses?</z><z id="t1585123653" t="Santiago [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] no, I use the json-body interceptor packaged with pedestal, nothing special"><y>#</y><d>2020-03-25</d><h>08:07</h><r>Santiago</r><a>@U075CCMPY</a> no, I use the json-body interceptor packaged with pedestal, nothing special</z><z id="t1585136733" t="mavbozo so, I&apos;ve just tried it myself. I&apos;m not so sure about the execution flow of interceptors I describe above. But, here&apos;s what I know so far: the chain of interceptors is like this (with irrelevant parts omitted) [... my-not-found .. routes ... json-body] for successful responses, the flow goes through :enter stages, passing routes then passing`json-body` then goes back through :leave stages then we get the http response. for 404 response because of route not found, the flow goes through routes , but the :response is nil , that&apos;s why the json-body doesn&apos;t do anything. Then, the execution goes through :leave stages, passing my-not-found , then my-not-found created your 404 custom response. but since no json-body before my-not-found , the custom 404 response is not transformed to json."><y>#</y><d>2020-03-25</d><h>11:45</h><r>mavbozo</r>so, I&apos;ve just tried it myself. I&apos;m not so sure about the execution flow of interceptors I describe above. But, here&apos;s what I know so far:
the chain of interceptors is like this (with irrelevant parts omitted)
<code>[...  my-not-found .. routes ... json-body]</code>
for successful responses, the flow goes through <code>:enter</code> stages, passing <code>routes</code>  then passing`json-body`  then goes back through <code>:leave</code> stages then we get the http response.
for 404 response because of route not found, the flow goes through <code>routes</code>, but the <code>:response</code> is <code>nil</code> , that&apos;s why the <code>json-body</code> doesn&apos;t do anything.
Then, the execution goes through <code>:leave</code> stages, passing <code>my-not-found</code> , then
<code>my-not-found</code> created your 404 custom response. but since no <code>json-body</code> before <code>my-not-found</code> , the custom 404 response is not transformed to json.</z><z id="t1585162501" t="Santiago so a way around this would be to create the 404 body in case of a nil response?"><y>#</y><d>2020-03-25</d><h>18:55</h><r>Santiago</r>so a way around this would be to create the 404 body in case of a nil response?</z><z id="t1585197719" t="mavbozo or your could modify your custom 404 by creating the json string yourself and put it in to the body also put application/json as content type in headers"><y>#</y><d>2020-03-26</d><h>04:41</h><r>mavbozo</r>or your could modify your custom 404 by creating the json string yourself and put it in to the body also put application/json as content type in headers</z><z id="t1585063891" t="yiorgos Hi guys, I started learning Pedestal and I would like to log the incoming request in the interceptor I have a function (defn home [request] (io.pedestal.log/debug &quot;-------&gt;&quot; request) {:status 200 :headers {&quot;Content-Type&quot; &quot;text/html&quot;} :body (selmer/render-file &quot;home.html&quot; {})}) but nothing is getting printed in the repl"><y>#</y><d>2020-03-24</d><h>15:31</h><w>yiorgos</w>Hi guys, I started learning Pedestal and I would like to log the incoming <code>request</code> in the interceptor

I have a function
<pre>(defn home [request]
  (io.pedestal.log/debug &quot;-------&gt;&quot; request)
  {:status 200
   :headers {&quot;Content-Type&quot; &quot;text/html&quot;}
   :body   (selmer/render-file &quot;home.html&quot; {})})</pre>
but nothing is getting printed in the repl</z><z id="t1585063920" t="yiorgos is there a more idiomatic way for inspecting stuff in pedestal?"><y>#</y><d>2020-03-24</d><h>15:32</h><w>yiorgos</w>is there a more idiomatic way for inspecting stuff in pedestal?</z><z id="t1585066902" t="orestis I’m pretty sure that call to log is wrong, but I’m on mobile and can’t check. But if you want to inspect things, I’d use the repl, def the request to a global var and go from there..."><y>#</y><d>2020-03-24</d><h>16:21</h><w>orestis</w>I’m pretty sure that call to log is wrong, but I’m on mobile and can’t check. But if you want to inspect things, I’d use the repl, <code>def</code> the request to a global var and go from there...</z><z id="t1585066974" t="orestis https://www.google.dk/search?q=clojure+debugging+with+def&amp;amp;ie=UTF-8&amp;amp;oe=UTF-8&amp;amp;hl=el-dk&amp;amp;client=safari - sorry for pasting a google link, but I’m in a hurry - there’s some good stuff out there!"><y>#</y><d>2020-03-24</d><h>16:22</h><w>orestis</w><a href="https://www.google.dk/search?q=clojure+debugging+with+def&amp;amp;ie=UTF-8&amp;amp;oe=UTF-8&amp;amp;hl=el-dk&amp;amp;client=safari" target="_blank">https://www.google.dk/search?q=clojure+debugging+with+def&amp;amp;ie=UTF-8&amp;amp;oe=UTF-8&amp;amp;hl=el-dk&amp;amp;client=safari</a> - sorry for pasting a google link, but I’m in a hurry - there’s some good stuff out there!</z><z id="t1585068120" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U051XTEJB&quot;}] , If you are using default-interceptors , there’s a default request logging interceptor but it can be overridden by adding the io.pedestal.http/request-logger key to your service map. (See http://pedestal.io/reference/default-interceptors ) [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] is correct about the logging call being incorrect. Pedestal’s logging api expects key/value pairs so you’d do something like this (log/debug :request request)"><y>#</y><d>2020-03-24</d><h>16:42</h><w>ddeaguiar</w><a>@g3o</a>, If you are using <code>default-interceptors</code>, there’s a default request logging interceptor but it can be overridden by adding the <code>io.pedestal.http/request-logger</code> key to your service map. (See <a href="http://pedestal.io/reference/default-interceptors" target="_blank">http://pedestal.io/reference/default-interceptors</a>)

<a>@orestis</a> is correct about the logging call being incorrect. Pedestal’s logging api expects key/value pairs so you’d do something like this <code>(log/debug :request request)</code></z><z id="t1585073403" t="yiorgos I’ll try that, thanks guys!"><y>#</y><d>2020-03-24</d><h>18:10</h><w>yiorgos</w>I’ll try that, thanks guys!</z><z id="t1585139871" t="yiorgos [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] that worked great, just for the reference just in case someone else faces the same problem. here are the changes (def logger (interceptor/on-request ::log-request (fn [request] (log/info :msg request) request))) (def service-map {::http/type :jetty ::http/resource-path &quot;/public&quot; ::http/port 3001 ::http/routes r/routes ::http/request-logger logger}) ;; &lt;----- update the default logger with a custom one"><y>#</y><d>2020-03-25</d><h>12:37</h><w>yiorgos</w><a>@ddeaguiar</a> that worked great, just for the reference just in case someone else faces the same problem.
here are the changes
<pre>(def logger
  (interceptor/on-request
   ::log-request
   (fn [request]
     (log/info :msg request)
     request)))

(def service-map
  {::http/type :jetty
   ::http/resource-path &quot;/public&quot;
   ::http/port 3001
   ::http/routes r/routes
   ::http/request-logger logger}) ;; &lt;----- update the default logger with a custom one</pre></z><z id="t1585139938" t="ddeaguiar Great! At some point I’ll update the Default Interceptors docs to make overriding clearer"><y>#</y><d>2020-03-25</d><h>12:38</h><w>ddeaguiar</w>Great! At some point I’ll update the Default Interceptors docs to make overriding clearer</z><z id="t1585140211" t="yiorgos I have a plain html form and I am rendering it with Semler the body of the request looks like this :body #object[org.eclipse.jetty.server.HttpInputOverHTTP 0x3747fe8b &quot;HttpInputOverHTTP@3747fe8b[c=0,q=0,[0]=null,s=STREAM]&quot;] how can I parse that? the content type is “application/x-www-form-urlencoded"><y>#</y><d>2020-03-25</d><h>12:43</h><w>yiorgos</w>I have a plain html form and I am rendering it with Semler

the body of the request looks like this <code>:body #object[org.eclipse.jetty.server.HttpInputOverHTTP 0x3747fe8b &quot;HttpInputOverHTTP@3747fe8b[c=0,q=0,[0]=null,s=STREAM]&quot;]</code>
how can I parse that?
the content type is <code> “application/x-www-form-urlencoded</code></z><z id="t1585140821" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U051XTEJB&quot;}] take a look at the body params interceptor"><y>#</y><d>2020-03-25</d><h>12:53</h><r>ddeaguiar</r><a>@U051XTEJB</a> take a look at the body params interceptor</z><z id="t1585776348" t="Ben Hammond I am trying to hook pedestal up to auth0 authentication using their ` com.auth0/mvc-auth-commons {:mvn/version &quot;1.2.0&quot;} client library, and it expects to use a SessionManager to store nonce, etc whilst awaiting the authentication to return Vanilla pedestal throws me a Caused by: java.lang.IllegalStateException: No SessionManager at org.eclipse.jetty.server.Request.getSession(Request.java:1568) Is there any received wisdom around Session Managers or Auth0 in Pedestal? should I just apply https://stackoverflow.com/questions/19718159/java-lang-illegalstateexception-no-sessionmanager and hope for the best?"><y>#</y><d>2020-04-01</d><h>21:25</h><w>Ben Hammond</w>I am trying to hook pedestal up to auth0 authentication using their `
<pre>com.auth0/mvc-auth-commons {:mvn/version &quot;1.2.0&quot;}</pre>
client library, and it expects to use a SessionManager to store nonce, etc whilst awaiting the authentication to return
Vanilla pedestal throws me a
<pre>Caused by: java.lang.IllegalStateException: No SessionManager
	at org.eclipse.jetty.server.Request.getSession(Request.java:1568)</pre>
Is there any received wisdom around Session Managers or Auth0 in Pedestal?

should I just apply
<a href="https://stackoverflow.com/questions/19718159/java-lang-illegalstateexception-no-sessionmanager" target="_blank">https://stackoverflow.com/questions/19718159/java-lang-illegalstateexception-no-sessionmanager</a>

and hope for the best?</z><z id="t1585776663" t="Ben Hammond oh perhaps I&apos;d better read https://www.eclipse.org/jetty/documentation/current/session-management.html"><y>#</y><d>2020-04-01</d><h>21:31</h><r>Ben Hammond</r>oh perhaps I&apos;d better read <a href="https://www.eclipse.org/jetty/documentation/current/session-management.html" target="_blank">https://www.eclipse.org/jetty/documentation/current/session-management.html</a></z><z id="t1585780673" t="Ben Hammond so I found https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/jetty/src/io/pedestal/http/jetty.clj#L197"><y>#</y><d>2020-04-01</d><h>22:37</h><r>Ben Hammond</r>so I found <a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/jetty/src/io/pedestal/http/jetty.clj#L197" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/jetty/src/io/pedestal/http/jetty.clj#L197</a></z><z id="t1585780756" t="Ben Hammond which is passing a (SessionHandler)null to the ServletContextHandler"><y>#</y><d>2020-04-01</d><h>22:39</h><r>Ben Hammond</r>which is passing a <code>(SessionHandler)null</code> to the ServletContextHandler</z><z id="t1585780818" t="Ben Hammond but perhaps I get the chance to reshape that context a few lines further down at (when context-configurator (context-configurator context)) "><y>#</y><d>2020-04-01</d><h>22:40</h><r>Ben Hammond</r>but perhaps I get the chance to reshape that context a few lines further down at
<pre>(when context-configurator
  (context-configurator context))</pre>
</z><z id="t1585781576" t="Ben Hammond I might be able to abuse the options {:context-configurator (fn [^ServletContextHandler sch] (set! (.-_options sch) ServletContextHandler/SESSIONS)"><y>#</y><d>2020-04-01</d><h>22:52</h><r>Ben Hammond</r>I might be able to abuse the options
<pre>{:context-configurator
      (fn [^ServletContextHandler sch]
          (set! (.-_options sch) ServletContextHandler/SESSIONS)</pre></z><z id="t1585781607" t="Ben Hammond although (set! (.-_options is looking a bit hacky..."><y>#</y><d>2020-04-01</d><h>22:53</h><r>Ben Hammond</r>although <code>(set! (.-_options</code> is looking a bit hacky...</z><z id="t1585781999" t="Ben Hammond :io.pedestal.http/container-options {:context-configurator (fn [^ServletContextHandler sch] (.insertHandler sch (SessionHandler.)) seems to do the trick though"><y>#</y><d>2020-04-01</d><h>22:59</h><r>Ben Hammond</r><pre>:io.pedestal.http/container-options
{:context-configurator
 (fn [^ServletContextHandler sch]
     (.insertHandler sch (SessionHandler.))</pre>
seems to do the trick though</z><z id="t1585840898" t="jjttjj Is there anything in the basic pedestal template that would cause it not to be accessible on a remote server but working locally through curl on the same server? Trying to figure out what I&apos;m doing wrong. The correct port seems to be open (and does work from curl)"><y>#</y><d>2020-04-02</d><h>15:21</h><w>jjttjj</w>Is there anything in the basic pedestal template that would cause it not to be accessible on a remote server but working locally through curl on the same server? Trying to figure out what I&apos;m doing wrong. The correct port seems to be open (and does work from curl)</z><z id="t1585841222" t="orestis The interface by default is localhost, need to change it to bind to 0.0.0.0 instead. "><y>#</y><d>2020-04-02</d><h>15:27</h><r>orestis</r>The interface by default is localhost, need to change it to bind to 0.0.0.0 instead. </z><z id="t1585841234" t="orestis On mobile so can’t remember how it works "><y>#</y><d>2020-04-02</d><h>15:27</h><r>orestis</r>On mobile so can’t remember how it works </z><z id="t1585841264" t="orestis Was a recent change AFAIK because it’s a security concern"><y>#</y><d>2020-04-02</d><h>15:27</h><r>orestis</r>Was a recent change AFAIK because it’s a security concern</z><z id="t1585841300" t="jjttjj Is it that :: http/allowed-origins must be set?"><y>#</y><d>2020-04-02</d><h>15:28</h><r>jjttjj</r>Is it that <b>::</b>http/allowed-origins must be set?</z><z id="t1585841569" t="jjttjj I tried setting both these keys, as in the dev server ;; all origins are allowed in dev mode ::http/allowed-origins {:creds true :allowed-origins (constantly true)} ;; Content Security Policy (CSP) is mostly turned off in dev mode ::http/secure-headers {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}}"><y>#</y><d>2020-04-02</d><h>15:32</h><r>jjttjj</r>I tried setting both these keys, as in the dev server
<pre>;; all origins are allowed in dev mode
            ::http/allowed-origins {:creds true :allowed-origins (constantly true)}
            ;; Content Security Policy (CSP) is mostly turned off in dev mode
            ::http/secure-headers  {:content-security-policy-settings {:object-src &quot;&apos;none&apos;&quot;}}</pre></z><z id="t1585842447" t="jjttjj Also tried ::http/host &quot;0.0.0.0&quot; as well as the actual IP address"><y>#</y><d>2020-04-02</d><h>15:47</h><r>jjttjj</r>Also tried <code>::http/host &quot;0.0.0.0&quot;</code> as well as the actual IP address</z><z id="t1585860438" t="haywood I’m just trying to return 401 from an interceptor but the server responds with 500"><y>#</y><d>2020-04-02</d><h>20:47</h><w>haywood</w>I’m just trying to return 401 from an interceptor but the server responds with 500</z><z id="t1585860469" t="haywood the interceptor returns {:status 401 :body &quot;Unauthorized&quot;}"><y>#</y><d>2020-04-02</d><h>20:47</h><w>haywood</w>the interceptor returns
<pre>{:status 401 :body   &quot;Unauthorized&quot;}</pre></z><z id="t1585860493" t="haywood which is somewhere in the :body response, but the main response is 500"><y>#</y><d>2020-04-02</d><h>20:48</h><w>haywood</w>which is somewhere in the <code>:body</code> response,  but the main response is 500</z><z id="t1585860497" t="haywood I don’t get it"><y>#</y><d>2020-04-02</d><h>20:48</h><w>haywood</w>I don’t get it</z><z id="t1585861170" t="haywood &quot;clojure.lang.ExceptionInfo: java.lang.NullPointerException in Interceptor :io.pedestal.http.ring-middlewares/content-type-interceptor - \n\tat io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35)\n\tat io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)\n\tat io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)\n\tat io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)\n\tat io.pedestal.interceptor.chain$leave_all_with_binding.invokeStatic(chain.clj:254)\n\tat io.pedestal.interceptor.chain$leave_all_with_binding.invoke(chain.clj:237)\n\tat io.pedestal.interceptor.chain$leave_all$fn__7211.invoke(chain.clj:268)\n\tat clojure.lang.AFn.applyToHelper(AFn.java:152)\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\n\tat clojure.core$apply.invokeStatic(core.clj:665)\n\tat clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1973)\n\tat clojure.core$with_bindings_STAR_.doInvoke(core.clj:1973)\n\tat clojure.lang.RestFn.invoke(RestFn.java:425)\n\tat io.pedestal.interceptor.chain$leave_all.invokeStatic(chain.clj:266)\n\tat io.pedestal.interceptor.chain$leave_all.invoke(chain.clj:260)\n\tat io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:379)\n\tat io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)\n\tat io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:389)\n\tat io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)\n\tat io.pedestal.http.impl.servlet_interceptor$interceptor_service_fn$fn__10376.invoke(servlet_interceptor.clj:351)\n\tat io.pedestal.http.servlet.FnServlet.service(servlet.clj:28)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:873)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:542)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:255)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1345)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:203)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:480)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1247)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:505)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267)\n\tat .AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:305)\n\tat .FillInterest.fillable(FillInterest.java:103)\n\tat .ChannelEndPoint$2.run(ChannelEndPoint.java:117)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:698)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:804)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\nCaused by: java.lang.NullPointerException: null\n&quot;"><y>#</y><d>2020-04-02</d><h>20:59</h><w>haywood</w><pre>&quot;clojure.lang.ExceptionInfo: java.lang.NullPointerException in Interceptor :io.pedestal.http.ring-middlewares/content-type-interceptor - \n\tat io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35)\n\tat io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)\n\tat io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)\n\tat io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)\n\tat io.pedestal.interceptor.chain$leave_all_with_binding.invokeStatic(chain.clj:254)\n\tat io.pedestal.interceptor.chain$leave_all_with_binding.invoke(chain.clj:237)\n\tat io.pedestal.interceptor.chain$leave_all$fn__7211.invoke(chain.clj:268)\n\tat clojure.lang.AFn.applyToHelper(AFn.java:152)\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\n\tat clojure.core$apply.invokeStatic(core.clj:665)\n\tat clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1973)\n\tat clojure.core$with_bindings_STAR_.doInvoke(core.clj:1973)\n\tat clojure.lang.RestFn.invoke(RestFn.java:425)\n\tat io.pedestal.interceptor.chain$leave_all.invokeStatic(chain.clj:266)\n\tat io.pedestal.interceptor.chain$leave_all.invoke(chain.clj:260)\n\tat io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:379)\n\tat io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)\n\tat io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:389)\n\tat io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)\n\tat io.pedestal.http.impl.servlet_interceptor$interceptor_service_fn$fn__10376.invoke(servlet_interceptor.clj:351)\n\tat io.pedestal.http.servlet.FnServlet.service(servlet.clj:28)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:873)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:542)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:255)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1345)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:203)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:480)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1247)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:505)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267)\n\tat .AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:305)\n\tat .FillInterest.fillable(FillInterest.java:103)\n\tat .ChannelEndPoint$2.run(ChannelEndPoint.java:117)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:333)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:310)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:168)\n\tat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:126)\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:366)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:698)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:804)\n\tat java.base/java.lang.Thread.run(Thread.java:834)\nCaused by: java.lang.NullPointerException: null\n&quot;</pre></z><z id="t1585861194" t="haywood error is so unhelpful no?"><y>#</y><d>2020-04-02</d><h>20:59</h><w>haywood</w>error is so unhelpful no?</z><z id="t1585861295" t="isak [:attrs {:href &quot;/_/_/users/U0TU3SMNC&quot;}] try adding :headers {}"><y>#</y><d>2020-04-02</d><h>21:01</h><w>isak</w><a>@haywood</a> try adding <code>:headers {}</code></z><z id="t1585861320" t="isak if you don&apos;t have that in there, it isn&apos;t considered a valid response for the purposes of short-circuiting, so the next interceptor will fire"><y>#</y><d>2020-04-02</d><h>21:02</h><w>isak</w>if you don&apos;t have that in there, it isn&apos;t considered a valid response for the purposes of short-circuiting, so the next interceptor will fire</z><z id="t1585861391" t="haywood into the request or the interceptor response"><y>#</y><d>2020-04-02</d><h>21:03</h><w>haywood</w>into the request or the interceptor response</z><z id="t1585861402" t="isak the latter"><y>#</y><d>2020-04-02</d><h>21:03</h><w>isak</w>the latter</z><z id="t1585861438" t="haywood ok thank you, one sec trying"><y>#</y><d>2020-04-02</d><h>21:03</h><w>haywood</w>ok thank you, one sec trying</z><z id="t1585861559" t="haywood same error, not sure where the NPE is coming from."><y>#</y><d>2020-04-02</d><h>21:05</h><w>haywood</w>same error, not sure where the NPE is coming from.</z><z id="t1585861628" t="isak oh, instead of returning {:status 401 :body &quot;Unauthorized&quot; :headers {}} you should assoc that into [ctx :response] (assoc ctx :response &lt;my response map&gt;)"><y>#</y><d>2020-04-02</d><h>21:07</h><w>isak</w>oh, instead of returning <code>{:status 401 :body   &quot;Unauthorized&quot; :headers {}}</code>  you should assoc that into <code>[ctx :response]</code>  <code>(assoc ctx :response &lt;my response map&gt;)</code></z><z id="t1585861688" t="haywood ah."><y>#</y><d>2020-04-02</d><h>21:08</h><w>haywood</w>ah.</z><z id="t1585861692" t="haywood yea that would make sense"><y>#</y><d>2020-04-02</d><h>21:08</h><w>haywood</w>yea that would make sense</z><z id="t1585861891" t="haywood (def basic-auth-interceptor (interceptor {:name ::basic-auth :enter (fn [context] (update context :request (fn [req] (let [auth-req (basic-authentication-request req basic-auth-fn)] (if (:basic-authentication auth-req) auth-req (assoc context :request {:status 401 :headers {} :body &quot;Unauthorized&quot;}))))))}))"><y>#</y><d>2020-04-02</d><h>21:11</h><w>haywood</w><pre>(def basic-auth-interceptor
  (interceptor {:name  ::basic-auth
                :enter (fn [context]
                         (update context :request
                                 (fn [req]
                                   (let [auth-req (basic-authentication-request req basic-auth-fn)]
                                     (if (:basic-authentication auth-req)
                                       auth-req
                                       (assoc context
                                              :request
                                              {:status 401
                                               :headers {}
                                               :body   &quot;Unauthorized&quot;}))))))}))</pre></z><z id="t1585861898" t="haywood no dice… still an NPE"><y>#</y><d>2020-04-02</d><h>21:11</h><w>haywood</w>no dice… still an NPE</z><z id="t1585861936" t="isak you are updating :request instead of :response"><y>#</y><d>2020-04-02</d><h>21:12</h><w>isak</w>you are updating :request instead of :response</z><z id="t1585861962" t="haywood where do I venmo you money for wasting your time"><y>#</y><d>2020-04-02</d><h>21:12</h><w>haywood</w>where do I venmo you money for wasting your time</z><z id="t1585861978" t="isak lol"><y>#</y><d>2020-04-02</d><h>21:12</h><w>isak</w>lol</z><z id="t1585863372" t="haywood just to close this out, had to change my interceptor definition: (def basic-auth-interceptor (interceptor {:name ::basic-auth :enter (fn [context] (let [req (:request context) auth-req (basic-authentication-request req basic-auth-fn)] (if (:basic-authentication auth-req) (assoc context :request auth-req) (assoc context :response {:status 401 :headers {} :body &quot;Unauthorized&quot;}))))}))"><y>#</y><d>2020-04-02</d><h>21:36</h><w>haywood</w>just to close this out, had to change my interceptor definition:

<pre>(def basic-auth-interceptor
  (interceptor {:name  ::basic-auth
                :enter (fn [context]
                         (let [req      (:request context)
                               auth-req (basic-authentication-request req basic-auth-fn)]
                           (if (:basic-authentication auth-req)
                             (assoc context :request auth-req)
                             (assoc context :response
                                    {:status  401
                                     :headers {}
                                     :body    &quot;Unauthorized&quot;}))))}))</pre></z><z id="t1585863384" t="haywood Thank you for opening my eyes to my idiocy"><y>#</y><d>2020-04-02</d><h>21:36</h><w>haywood</w>Thank you for opening my eyes to my idiocy</z><z id="t1585904826" t="Ben Hammond what is the current status of fern in vase? I just failed to load deps dependency {:deps {com.cognitect/pedestal.vase {:mvn/version &quot;0.9.4-SNAPSHOT&quot;} from Clojars {:deps {com.cognitect/pedestal.vase {:git/url &quot;&quot; :sha &quot;d882bc8f28e8af2077b55c80e069aa2238f646b7&quot;} works of course; is that my only option if I want to use fern?"><y>#</y><d>2020-04-03</d><h>09:07</h><w>Ben Hammond</w>what is the current status of fern in vase?
I just failed to load deps dependency
<pre>{:deps {com.cognitect/pedestal.vase {:mvn/version &quot;0.9.4-SNAPSHOT&quot;}</pre>
from Clojars
<pre>{:deps {com.cognitect/pedestal.vase {:git/url &quot;&quot;
                                     :sha &quot;d882bc8f28e8af2077b55c80e069aa2238f646b7&quot;}</pre>
works of course; is that my only option if I want to use fern?</z><z id="t1585919595" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] on the back burner atm. We’ve not officially released a version of vase using Fern. There are a few changes I’d like to make before doing that. Just need the time."><y>#</y><d>2020-04-03</d><h>13:13</h><w>ddeaguiar</w><a>@ben.hammond</a> on the back burner atm. We’ve not officially released a version of vase using Fern. There are a few changes I’d like to make before doing that. Just need the time.</z><z id="t1585919713" t="Ben Hammond are there any nasty surprises to be aware of? can I have multiple .fern files that I can link together? do I have to shoehorn everything into one file?"><y>#</y><d>2020-04-03</d><h>13:15</h><w>Ben Hammond</w>are there any nasty surprises to be aware of?
can I have multiple .fern files that I can link together?
do I have to shoehorn everything into one file?</z><z id="t1585920606" t="ddeaguiar Nast surprises -&gt; not that I know of Multiple file support/using one file -&gt; Vase expects your service config to be in a single file"><y>#</y><d>2020-04-03</d><h>13:30</h><w>ddeaguiar</w>Nast surprises -&gt; not that I know of
Multiple file support/using one file -&gt; Vase expects your service config to be in a single file</z><z id="t1585920692" t="Ben Hammond and if I want some kind of (fern/lit include-file then I need to write my own ?"><y>#</y><d>2020-04-03</d><h>13:31</h><w>Ben Hammond</w>and if I want some kind of <code>(fern/lit include-file</code> then I need to write my own ?</z><z id="t1585925050" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] I’d avoid getting too clever, though. reading in schema as edn should be fine but partitioning config and accessing parent config env in included files is a different matter. The later is not possible"><y>#</y><d>2020-04-03</d><h>14:44</h><r>ddeaguiar</r><a>@ben.hammond</a> I’d avoid getting too clever, though. reading in schema as edn should be fine but partitioning config and accessing parent config env in included files is a different matter. The later is not possible</z><z id="t1585925148" t="ddeaguiar If you do want to partition your config into separate files and access env across them then consider a pre-processing step which joins them prior to loading them."><y>#</y><d>2020-04-03</d><h>14:45</h><r>ddeaguiar</r>If you do want to partition your config into separate files and access env across them then consider a pre-processing step which joins them prior to loading them.</z><z id="t1585920768" t="ddeaguiar Yeah. I suppose that could be done. Fern supports plugins"><y>#</y><d>2020-04-03</d><h>13:32</h><w>ddeaguiar</w>Yeah. I suppose that could be done. Fern supports plugins</z><z id="t1585920771" t="Ben Hammond once you start sticking datomic schema in there, I can imagine a single config file getting bloated pretty quickly"><y>#</y><d>2020-04-03</d><h>13:32</h><w>Ben Hammond</w>once you start sticking datomic schema in there, I can imagine a single config file getting bloated pretty quickly</z><z id="t1585920853" t="ddeaguiar Yeah, I could see how it could get large."><y>#</y><d>2020-04-03</d><h>13:34</h><w>ddeaguiar</w>Yeah, I could see how it could get large.</z><z id="t1585920867" t="ddeaguiar The primary issue I’d like to resolve before cutting another release is https://github.com/cognitect-labs/vase/issues/45"><y>#</y><d>2020-04-03</d><h>13:34</h><w>ddeaguiar</w>The primary issue I’d like to resolve before cutting another release is <a href="https://github.com/cognitect-labs/vase/issues/45" target="_blank">https://github.com/cognitect-labs/vase/issues/45</a></z><z id="t1585930135" t="Santiago I wrote my first API using pedestal and everything works with lein run or using an uberjar, but not inside a container. I tracked it down to a step with a POST call (using clj-http-lite , but I also tried hato ) to GraphQL. Everything works on the REPL outside the container. Could this be related to pedestal, or should I look elsewhere? I tried using both immutant and jetty and it doesn’t make a difference. My host is set to 0.0.0.0 because otherwise I couldn’t send requests to the container"><y>#</y><d>2020-04-03</d><h>16:08</h><w>Santiago</w>I wrote my first API using pedestal and everything works with <code>lein run</code> or using an uberjar, but not inside a container. I tracked it down to a step with a <code>POST</code> call (using <code>clj-http-lite</code> , but I also tried <code>hato</code> ) to GraphQL. Everything works on the REPL outside the container. Could this be related to pedestal, or should I look elsewhere? I tried using both immutant and jetty and it doesn’t make a difference. My host is set to <code>0.0.0.0</code> because otherwise I couldn’t send requests to the container</z><z id="t1586209354" t="hindol Most likely a Docker issue. If you are on Linux, maybe try enabling host networking?"><y>#</y><d>2020-04-06</d><h>21:42</h><r>hindol</r>Most likely a Docker issue. If you are on Linux, maybe try enabling host networking?</z><z id="t1585935896" t="Ivan sounds like a docker network issue; I would make sure the right address and port are reachable."><y>#</y><d>2020-04-03</d><h>17:44</h><w>Ivan</w>sounds like a docker network issue; I would make sure the right address and port are reachable.</z><z id="t1586032937" t="this.rob Hi everyone, just getting started with Pedestal here 👋 I’ve read through this guide: http://pedestal.io/guides/your-first-api and have a question on how you would go about plugging in a real DB to the example code. In the example an atom is used as an in-memory DB, and the first :enter interceptor in the chain on each route derefs it and attaches the whole DB value to the context so that subsequent interceptors can query it to pull out individual records. If I were to use a real DB instead, I obviously don’t want to dump the entire contents of said DB on the context. What is the recommended pattern here? Is it okay for the DB interceptor to perform queries based on the params in the request to only return records relevant to that request, and attach these to the context? Or should I create multiple, specific DB interceptors that query the correct data and attach these to the relevant routes?"><y>#</y><d>2020-04-04</d><h>20:42</h><w>this.rob</w>Hi everyone, just getting started with Pedestal here <b>👋</b>
I’ve read through this guide: <a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a> and have a question on how you would go about plugging in a real DB to the example code.
In the example an atom is used as an in-memory DB, and the first <code>:enter</code> interceptor in the chain on each route derefs it and attaches the whole DB value to the context so that subsequent interceptors can query it to pull out individual records.
If I were to use a real DB instead, I obviously don’t want to dump the entire contents of said DB on the context. What is the recommended pattern here? Is it okay for the DB interceptor to perform queries based on the params in the request to only return records relevant to that request, and attach these to the context? Or should I create multiple, specific DB interceptors that query the correct data and attach these to the relevant routes?</z><z id="t1586033562" t="dvingo the ions sample app has examples on how to add a connection and db to the request, and some of the routes inject the single domain instance (a pet in this case) for endpoints that affect one instance: https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L157"><y>#</y><d>2020-04-04</d><h>20:52</h><w>dvingo</w>the ions sample app has examples on how to add a connection and db to the request, and some of the routes inject the single domain instance (a pet in this case) for endpoints that affect one instance:
<a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L157" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L157</a></z></g><g id="s18"><z id="t1586033603" t="dvingo for other databases you&apos;d probably put in a connection instance instead of the db"><y>#</y><d>2020-04-04</d><h>20:53</h><w>dvingo</w>for other databases you&apos;d probably put in a connection instance instead of the db</z><z id="t1586157017" t="hindol Hi, I have a question specific to this example: https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj Each established connection is maintained in an atom ws-clients . When server initiates a disconnect, it is clear which connection is getting closed but when the :on-close handler is triggered with only the code and reason, how does the server identify which session got closed?"><y>#</y><d>2020-04-06</d><h>07:10</h><w>hindol</w>Hi, I have a question specific to this example: <a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj</a>
Each established connection is maintained in an atom <code>ws-clients</code>. When server initiates a disconnect, it is clear which connection is getting closed but when the <code>:on-close</code> handler is triggered with only the code and reason, how does the server identify which session got closed?</z><z id="t1586347466" t="hindol Figured out I need to pass my own listener to Jetty."><y>#</y><d>2020-04-08</d><h>12:04</h><r>hindol</r>Figured out I need to pass my own listener to Jetty.</z><z id="t1586367425" t="this.rob i’ve noticed that if I set a lazy seq as the body on the context’s response, and that lazy seq involves side effects (e.g. debug printlns ) they are included in the body, presumably because pedestal calls pr-str on the body before returning it: (def println-test {:name :println-test :enter (fn [context] (assoc context :response {:status 200 :body (map #(do (println &quot;FOO&quot;) %) (range 0 3))}))}) If I hit an endpoint hooked up to that interceptor I get this back: {:status 200, :body &quot;(FOO\nFOO\nFOO\n0 1 2)&quot;} Am I doing something wrong? I would like the body to be EDN."><y>#</y><d>2020-04-08</d><h>17:37</h><w>this.rob</w>i’ve noticed that if I set a lazy seq as the body on the context’s response, and that lazy seq involves side effects (e.g. debug <code>printlns</code>) they are included in the body, presumably because pedestal calls <code>pr-str</code> on the body before returning it:
<pre>(def println-test
  {:name :println-test
   :enter
   (fn [context]
     (assoc context :response {:status 200
                               :body (map #(do (println &quot;FOO&quot;)
                                               %)
                                          (range 0 3))}))})</pre>
If I hit an endpoint hooked up to that interceptor I get this back:
<pre>{:status 200, :body &quot;(FOO\nFOO\nFOO\n0 1 2)&quot;}</pre>
Am I doing something wrong? I would like the body to be EDN.</z><z id="t1586367533" t="hindol map and println should not be mixed like that."><y>#</y><d>2020-04-08</d><h>17:38</h><w>hindol</w><code>map</code> and <code>println</code> should not be mixed like that.</z><z id="t1586419099" t="Ben Hammond what is the purpose of the :expose-api-at key in pedestal vase? https://github.com/cognitect-labs/vase/blob/7beba1e549a79166be5e73dd7714edb4e9b9d3e9/samples/petstore/petstore.fern#L25 it doesn&apos;t seem to be used anywhere"><y>#</y><d>2020-04-09</d><h>07:58</h><w>Ben Hammond</w>what is the purpose of the <code>:expose-api-at</code> key in pedestal vase?
<a href="https://github.com/cognitect-labs/vase/blob/7beba1e549a79166be5e73dd7714edb4e9b9d3e9/samples/petstore/petstore.fern#L25" target="_blank">https://github.com/cognitect-labs/vase/blob/7beba1e549a79166be5e73dd7714edb4e9b9d3e9/samples/petstore/petstore.fern#L25</a>
it doesn&apos;t seem to be used anywhere</z><z id="t1586453035" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] I think the intent was to leverage that to specify the api entry point but was not implemented. I’ll make a note to look into it and clean it up."><y>#</y><d>2020-04-09</d><h>17:23</h><r>ddeaguiar</r><a>@ben.hammond</a> I think the intent was to leverage that to specify the api entry point but was not implemented. I’ll make a note to look into it and clean it up.</z><z id="t1586438702" t="Ben Hammond I&apos;m trying to get my head round WebSockets on the Server side (jetty) The simple onTextMessage callback provides no context about which connection sent the message https://github.com/eclipse/jetty.project/blob/923ec38adf64d1d68da6a91902f5925a8bffb7d9/jetty-websocket/websocket-common/src/main/java/org/eclipse/jetty/websocket/common/events/EventDriver.java#L65 how do people normally corrrelate incoming messages with a specific clent connecttion?"><y>#</y><d>2020-04-09</d><h>13:25</h><w>Ben Hammond</w>I&apos;m trying to get my head round WebSockets on the Server side (jetty)
The simple <code>onTextMessage</code> callback provides no context about which connection sent the message
<a href="https://github.com/eclipse/jetty.project/blob/923ec38adf64d1d68da6a91902f5925a8bffb7d9/jetty-websocket/websocket-common/src/main/java/org/eclipse/jetty/websocket/common/events/EventDriver.java#L65" target="_blank">https://github.com/eclipse/jetty.project/blob/923ec38adf64d1d68da6a91902f5925a8bffb7d9/jetty-websocket/websocket-common/src/main/java/org/eclipse/jetty/websocket/common/events/EventDriver.java#L65</a>
how do people normally corrrelate incoming messages with a specific clent connecttion?</z><z id="t1586438927" t="Ben Hammond I&apos;m hopinig I can create a UUID session key that I can close over a new ws-listener map sort of thing but its not quite clear how to proceed"><y>#</y><d>2020-04-09</d><h>13:28</h><w>Ben Hammond</w>I&apos;m hopinig I can create a UUID session key that I can close over a new ws-listener map
sort of thing
but its not quite clear how to proceed</z><z id="t1586439682" t="Ben Hammond I could contrive that every message contained information to identtify its owner, but am hoping that is not necessary"><y>#</y><d>2020-04-09</d><h>13:41</h><w>Ben Hammond</w>I could contrive that every message contained information to identtify its owner, but am hoping that is not necessary</z><z id="t1586439881" t="Ben Hammond WebSocketAdapter just hangs onto the Session object that was presented to it originally, and doesn&apos;t worry about cross talk so perhaps I can do something like that https://github.com/eclipse/jetty.project/blob/e3c8546667aca1ee0247dfc4154a6e7189a23c81/jetty-websocket/websocket-api/src/main/java/org/eclipse/jetty/websocket/api/WebSocketAdapter.java#L28"><y>#</y><d>2020-04-09</d><h>13:44</h><w>Ben Hammond</w>WebSocketAdapter just hangs onto the Session object that was presented to it originally, and doesn&apos;t worry about cross talk
so perhaps I can do something like that
<a href="https://github.com/eclipse/jetty.project/blob/e3c8546667aca1ee0247dfc4154a6e7189a23c81/jetty-websocket/websocket-api/src/main/java/org/eclipse/jetty/websocket/api/WebSocketAdapter.java#L28" target="_blank">https://github.com/eclipse/jetty.project/blob/e3c8546667aca1ee0247dfc4154a6e7189a23c81/jetty-websocket/websocket-api/src/main/java/org/eclipse/jetty/websocket/api/WebSocketAdapter.java#L28</a></z><z id="t1586440724" t="hindol [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] Funny how I had the exact same question few days back. The solution is as you said, supply your own listener to Pedestal as :listener-fn . (defn ws-listener [_request _response ws-map] (proxy [WebSocketAdapter] [] (onWebSocketConnect [^Session ws-session] (proxy-super onWebSocketConnect ws-session) (when-let [f (:on-connect ws-map)] (f ws-session))) (onWebSocketClose [status-code reason] (when-let [f (:on-close ws-map)] (f (.getSession this) status-code reason))) (onWebSocketError [^Throwable e] (when-let [f (:on-error ws-map)] (f (.getSession this) e))) (onWebSocketText [^String message] (when-let [f (:on-text ws-map)] (f (.getSession this) message))) (onWebSocketBinary [^bytes payload offset length] (when-let [f (:on-binary ws-map)] (f (.getSession this) payload offset length))))) ::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths {:listener-fn ws-listener})} https://github.com/sunng87/ring-jetty9-adapter/blob/master/src/ring/adapter/jetty9/websocket.clj#L95 https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L104"><y>#</y><d>2020-04-09</d><h>13:58</h><w>hindol</w><a>@ben.hammond</a> Funny how I had the exact same question few days back. The solution is as you said, supply your own listener to Pedestal as <code>:listener-fn</code>.

<pre>(defn ws-listener
  [_request _response ws-map]
  (proxy [WebSocketAdapter] []
    (onWebSocketConnect [^Session ws-session]
      (proxy-super onWebSocketConnect ws-session)
      (when-let [f (:on-connect ws-map)]
        (f ws-session)))
    (onWebSocketClose [status-code reason]
      (when-let [f (:on-close ws-map)]
        (f (.getSession this) status-code reason)))
    (onWebSocketError [^Throwable e]
      (when-let [f (:on-error ws-map)]
        (f (.getSession this) e)))

    (onWebSocketText [^String message]
      (when-let [f (:on-text ws-map)]
        (f (.getSession this) message)))
    (onWebSocketBinary [^bytes payload offset length]
      (when-let [f (:on-binary ws-map)]
        (f (.getSession this) payload offset length)))))

::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths {:listener-fn ws-listener})}</pre>
<a href="https://github.com/sunng87/ring-jetty9-adapter/blob/master/src/ring/adapter/jetty9/websocket.clj#L95" target="_blank">https://github.com/sunng87/ring-jetty9-adapter/blob/master/src/ring/adapter/jetty9/websocket.clj#L95</a>
<a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L104" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L104</a></z><z id="t1586450210" t="Ben Hammond lovely thankyou I was looking for some affirmation"><y>#</y><d>2020-04-09</d><h>16:36</h><w>Ben Hammond</w>lovely thankyou
I was looking for some affirmation</z><z id="t1586450277" t="Ben Hammond although"><y>#</y><d>2020-04-09</d><h>16:37</h><w>Ben Hammond</w>although</z><z id="t1586450292" t="Ben Hammond I&apos;m wondering if it could be simpler than that"><y>#</y><d>2020-04-09</d><h>16:38</h><w>Ben Hammond</w>I&apos;m wondering if it could be simpler than that</z><z id="t1586450457" t="Ben Hammond If I write this as my listener function (defn ws-stateful-listener [^ServletUpgradeRequest req ^ServletUpgradeResponse resp wsmap-genfn] (ws/make-ws-listener (wsmap-genfn (UUID/randomUUID)))) and then I close over that UUID in the ws-map and use it as a key into my ws-sessions atom"><y>#</y><d>2020-04-09</d><h>16:40</h><w>Ben Hammond</w>If I write this as my listener function
<pre>(defn ws-stateful-listener
  [^ServletUpgradeRequest req 
   ^ServletUpgradeResponse resp 
   wsmap-genfn]
  (ws/make-ws-listener (wsmap-genfn (UUID/randomUUID))))</pre>
and then I close over that UUID in the ws-map
and use it as a key into my ws-sessions atom</z><z id="t1586450543" t="Ben Hammond its not quite as tidy as yours, because I&apos;ve had to invent a new synthetic key where the WebSocketSession would have done just as well but its a wee bit less upfront code"><y>#</y><d>2020-04-09</d><h>16:42</h><w>Ben Hammond</w>its not quite as tidy as yours, because I&apos;ve had to invent a new synthetic key
where the WebSocketSession would have done just as well
but its a wee bit less upfront code</z><z id="t1586451119" t="hindol Yeah, I know where you are coming from. The default listener provided by Ring Jetty9 Adapter is way more useful. The Pedestal one, not so much. I am not an expert so can&apos;t comment on which way is better."><y>#</y><d>2020-04-09</d><h>16:51</h><w>hindol</w>Yeah, I know where you are coming from. The default listener provided by Ring Jetty9 Adapter is way more useful. The Pedestal one, not so much.

I am not an expert so can&apos;t comment on which way is better.</z><z id="t1586509990" t="Ben Hammond I&apos;m loving the way I can hook a parameterized function into vase.pedestal using (fern/lit vase/respond like board.v1/moves (fern/lit vase/respond {:name :board.v1/moves :params [board-id] :body (xiangqi.board-api/moves board-id) :doc &quot;the moves that can be made from this board disposition&quot;}) although it did take a bit of time to figure out that was how it worked"><y>#</y><d>2020-04-10</d><h>09:13</h><w>Ben Hammond</w>I&apos;m loving the way I can hook a parameterized function into vase.pedestal using  <code>(fern/lit vase/respond</code>
like
<pre>board.v1/moves (fern/lit vase/respond
                  {:name :board.v1/moves
                   :params [board-id]
                   :body (xiangqi.board-api/moves board-id)
                   :doc &quot;the moves that can be made from this board disposition&quot;})</pre>
although it did take a bit of time to figure out that was how it worked</z><z id="t1586844800" t="Parenoid how do I enable ssl on my pedestal app so it&apos;s https as opposed to http?"><y>#</y><d>2020-04-14</d><h>06:13</h><w>Parenoid</w>how do I enable ssl on my pedestal app so it&apos;s https as opposed to http?</z><z id="t1586845531" t="hindol You can see the implementation here: https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj Check the comments towards the end."><y>#</y><d>2020-04-14</d><h>06:25</h><r>hindol</r>You can see the implementation here: <a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj</a>
Check the comments towards the end.</z><z id="t1586845579" t="hindol I have not tried the steps myself though."><y>#</y><d>2020-04-14</d><h>06:26</h><r>hindol</r>I have not tried the steps myself though.</z><z id="t1587137440" t="KJO It&apos;s a bit of a pain, but the following service map works (you can ignore the web socket stuff). Notes about the keystore are below. (def service-map (let [keystore-location (if (System/getenv &quot;KEYSTORE_LOCATION&quot;) (-&gt; (io/file (System/getenv &quot;KEYSTORE_LOCATION&quot;)) (.getCanonicalPath)) &quot;/home/user/security/jetty-keystore&quot;)] {::http/host &quot;0.0.0.0&quot; ::http/allowed-origins {:allowed-origins (fn[_] true) :creds true} ::http/routes #(deref #&apos;routes) ::http/type :jetty ::http/container-options {:context-configurator jetty-websocket-configurator :h2c? true :h2 true :ssl? true :ssl-port 8081 :keystore keystore-location :key-password &quot;thepassword&quot; :security-provider &quot;Conscrypt&quot;} ::http/port 8080})) [:attrs nil] In order for Pedestal (the back-end server) to start with Jetty, it expects a keystore to be available in a particular location (see service-map). To create the keystore (plagiarized from web, and don&apos;t remember where) Generate a private site key (site.key) $ openssl genrsa -des3 -out site.key 2048 Make a copy of site.key and strip the password, so that it can be auto-loaded $ cp site.key site.orig.key $ openssl rsa -in site.orig.key -out site.key Generate a self-signed signing request (site.csr) $ openssl req -new -key site.key -out site.csr Generate a self-signed certificate (sitex509.crt - in x509 format for loading into the keystore) $ openssl req -new -x509 -key site.key -out sitex509.crt Combine the self-signed certificate (sitex509.crt) and site key (site.key) and export it in pkcs12 format (site.pkcs12) $ openssl pkcs12 -inkey site.key -in sitex509.crt -export -out site.pkcs12 Rename the keystore (site.pkcs12) to jetty-keystore and adjust the service-map so it can be located."><y>#</y><d>2020-04-17</d><h>15:30</h><r>KJO</r>It&apos;s a bit of a pain, but the following service map works (you can ignore the web socket stuff). Notes about the keystore are below.

<pre>(def service-map
  (let
    [keystore-location
     (if (System/getenv &quot;KEYSTORE_LOCATION&quot;)
       (-&gt; (io/file (System/getenv &quot;KEYSTORE_LOCATION&quot;))
           (.getCanonicalPath))
       &quot;/home/user/security/jetty-keystore&quot;)]
    {::http/host &quot;0.0.0.0&quot;
     ::http/allowed-origins
                 {:allowed-origins (fn[_] true)
                  :creds true}
     ::http/routes #(deref #&apos;routes)
     ::http/type   :jetty
     ::http/container-options
     {:context-configurator jetty-websocket-configurator
      :h2c? true
      :h2 true
      :ssl? true
      :ssl-port 8081
      :keystore keystore-location
      :key-password &quot;thepassword&quot;
      :security-provider &quot;Conscrypt&quot;}
     ::http/port   8080}))</pre>
<i></i>

In order for Pedestal (the back-end server) to start with Jetty,
it expects a keystore to be available in a particular location
(see service-map).

To create the keystore (plagiarized from web, and don&apos;t remember where)

Generate a private site key (site.key)

<pre>$ openssl genrsa -des3 -out site.key 2048</pre>
Make a copy of site.key and strip the password,
so that it can be auto-loaded

<pre>$ cp site.key site.orig.key
    $ openssl rsa -in site.orig.key -out site.key</pre>
Generate a self-signed signing request (site.csr)

<pre>$ openssl req -new -key site.key -out site.csr</pre>
Generate a self-signed certificate (sitex509.crt - in x509 format for loading into the keystore)

<pre>$ openssl req -new -x509 -key site.key -out sitex509.crt</pre>
Combine the self-signed certificate (sitex509.crt) and site key (site.key) and
export it in pkcs12 format (site.pkcs12)

<pre>$ openssl pkcs12 -inkey site.key -in sitex509.crt -export -out site.pkcs12</pre>
Rename the keystore (site.pkcs12) to jetty-keystore

and adjust the service-map so it can be located.</z><z id="t1587139856" t="hindol Can you please write a blog post about this? That will be very helpful for anyone needing to do the same thing. And thanks!"><y>#</y><d>2020-04-17</d><h>16:10</h><r>hindol</r>Can you please write a blog post about this? That will be very helpful for anyone needing to do the same thing.

And thanks!</z><z id="t1587157814" t="KJO That&apos;s a good idea. Thanks. It&apos;s at https://heykieran.github.io/posts/pedestal-jetty-https/"><y>#</y><d>2020-04-17</d><h>21:10</h><r>KJO</r>That&apos;s a good idea. Thanks. It&apos;s at <a href="https://heykieran.github.io/posts/pedestal-jetty-https/" target="_blank">https://heykieran.github.io/posts/pedestal-jetty-https/</a></z><z id="t1587158461" t="hindol Super! Thank you."><y>#</y><d>2020-04-17</d><h>21:21</h><r>hindol</r>Super! Thank you.</z><z id="t1586844842" t="Parenoid a big topic, I know."><y>#</y><d>2020-04-14</d><h>06:14</h><w>Parenoid</w>a big topic, I know.</z><z id="t1586859657" t="Ben Hammond I have a question about (fern/lit vase.datomic.cloud/client when I try to use it, I see a java.lang.AbstractMethodError: Receiver class datomic.client.impl.shared.Client does not define or inherit an implementation of the resolved method abstract create_database(Ljava/lang/Object;)Ljava/lang/Object; of interface datomic.client.impl.shared.protocols.Client. at datomic.client.api.async$create_database.invokeStatic(async.clj:148) at datomic.client.api.async$create_database.invoke(async.clj:140) at datomic.client.api.sync.Client.create_database(sync.clj:73) at datomic.client.api$create_database.invokeStatic(api.clj:144) at datomic.client.api$create_database.invoke(api.clj:135) at com.cognitect.vase.fern.CloudConnection._interceptor(fern.clj:94) which is inline with my understanding of the datomic client: it cannot create databases. but doesn&apos;t that render the CloudConnection unusable? The culprit is at https://github.com/cognitect-labs/vase/blob/407d8cda05892ee740ac22f170156a0ee4764733/src/com/cognitect/vase/fern.clj#L94"><y>#</y><d>2020-04-14</d><h>10:20</h><w>Ben Hammond</w>I have a question about
<pre>(fern/lit vase.datomic.cloud/client</pre>
when I try to use it, I see a
<pre>java.lang.AbstractMethodError: Receiver class datomic.client.impl.shared.Client does not define or inherit an implementation of the resolved method abstract create_database(Ljava/lang/Object;)Ljava/lang/Object; of interface datomic.client.impl.shared.protocols.Client.
	at datomic.client.api.async$create_database.invokeStatic(async.clj:148)
	at datomic.client.api.async$create_database.invoke(async.clj:140)
	at datomic.client.api.sync.Client.create_database(sync.clj:73)
	at datomic.client.api$create_database.invokeStatic(api.clj:144)
	at datomic.client.api$create_database.invoke(api.clj:135)
	at com.cognitect.vase.fern.CloudConnection._interceptor(fern.clj:94)</pre>
which is inline with my understanding of the  datomic client: it cannot create databases.
but doesn&apos;t that render the CloudConnection unusable?
The culprit is at
<a href="https://github.com/cognitect-labs/vase/blob/407d8cda05892ee740ac22f170156a0ee4764733/src/com/cognitect/vase/fern.clj#L94" target="_blank">https://github.com/cognitect-labs/vase/blob/407d8cda05892ee740ac22f170156a0ee4764733/src/com/cognitect/vase/fern.clj#L94</a></z><z id="t1586860949" t="Ben Hammond Oh I see, this is a special case &gt; NOTE: create-database is not available with peer-server. &gt; Use a Datomic Peer to create databases with Datomic On-Prem."><y>#</y><d>2020-04-14</d><h>10:42</h><r>Ben Hammond</r>Oh I see, this is a special case
&gt; NOTE: create-database is not available with peer-server.
&gt; Use a Datomic Peer to create databases with Datomic On-Prem.</z><z id="t1586861180" t="Ben Hammond it would be nice if I could disable that (client/create-database call from the config"><y>#</y><d>2020-04-14</d><h>10:46</h><r>Ben Hammond</r>it would be nice if I could disable that <code>(client/create-database</code> call from the config</z><z id="t1586873104" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] thanks for pointing this out. In retrospect, DB lifecycle management should be done independently. Including calls to create-database for every request is not recommended. This new learning led to me changing the pedestal.ions sample app ( https://github.com/pedestal/pedestal-ions-sample#database-life-cycle-management ). I’m going to create an issue capture that this needs to be followed up on."><y>#</y><d>2020-04-14</d><h>14:05</h><r>ddeaguiar</r><a>@U793EL04V</a> thanks for pointing this out. In retrospect, DB lifecycle management should be done independently. Including calls to create-database for every request is not recommended.

This new learning led to me changing the pedestal.ions sample app (<a href="https://github.com/pedestal/pedestal-ions-sample#database-life-cycle-management" target="_blank">https://github.com/pedestal/pedestal-ions-sample#database-life-cycle-management</a>).

I’m going to create an issue capture that this needs to be followed up on.</z><z id="t1586873172" t="ddeaguiar In that sample I adopted the approach taken by the Datomic Ions tutorial ( https://docs.datomic.com/cloud/ions/ions-tutorial.html#orgd70504f )"><y>#</y><d>2020-04-14</d><h>14:06</h><r>ddeaguiar</r>In that sample  I adopted the approach taken by the Datomic Ions tutorial (<a href="https://docs.datomic.com/cloud/ions/ions-tutorial.html#orgd70504f" target="_blank">https://docs.datomic.com/cloud/ions/ions-tutorial.html#orgd70504f</a>)</z><z id="t1586873255" t="ddeaguiar I’m incorrect, the code you linked creates the db on interceptor creation only. Still, it should be done explicitly and elsewhere"><y>#</y><d>2020-04-14</d><h>14:07</h><r>ddeaguiar</r>I’m incorrect, the code you linked creates the db on interceptor creation only. Still, it should be done explicitly and elsewhere</z><z id="t1586874375" t="Ben Hammond Yeah I&apos;m combining integrant with vase &amp; pedestal in order to manage lifecycle and dependencies"><y>#</y><d>2020-04-14</d><h>14:26</h><r>Ben Hammond</r>Yeah I&apos;m combining integrant with vase &amp; pedestal in order to manage lifecycle and dependencies</z><z id="t1587049504" t="mike_ananev Hello. I&apos;ve encountered the problem that pedestal.log is not working under some conditions. When my program starts I set a hook for signal OS (SIGTERM, SIGINT) to make graceful shutdown of the program. During this event (shutdown) I found that logging with pedestal.log is not working. Other loggers like clojure.tools.logging works fine. Underlying logger levels like log4j2 are not the cause of the problem. I can&apos;t find the cause of such behavior of pedestal.log."><y>#</y><d>2020-04-16</d><h>15:05</h><w>mike_ananev</w>Hello. I&apos;ve encountered the problem that pedestal.log is not working under some conditions.  When my program starts I set a hook for signal OS (SIGTERM, SIGINT) to make graceful shutdown of the program. During this event (shutdown) I found that logging with pedestal.log is not working. Other loggers like clojure.tools.logging works fine. Underlying logger levels like log4j2 are not the cause of the problem. I can&apos;t find the cause of such behavior of pedestal.log.</z><z id="t1587049534" t="mike_ananev I got a null pointer exception"><y>#</y><d>2020-04-16</d><h>15:05</h><w>mike_ananev</w>I got a null pointer exception</z><z id="t1587110351" t="Ben Hammond ring.middleware.cookies/cookies-request has an arity that allows you to pass your own cookie decoder io.pedestal.http.ring-middlewares/cookies does not seem to have a way to pass in the options flag https://github.com/pedestal/pedestal/blob/f64630cb3e60ffaf607d70071ca0781a55162f43/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78 what do people normally do in this situation? insert another interceptor to further process the :cookies map? or provide a paraller interceptor to io.pedestal.http.ring-middlewares/cookies that does set a custom decoder ?"><y>#</y><d>2020-04-17</d><h>07:59</h><w>Ben Hammond</w><code>ring.middleware.cookies/cookies-request</code> has an arity that allows you to pass your own cookie decoder
<code>io.pedestal.http.ring-middlewares/cookies</code>  does not seem to have a way to  pass in the <code>options</code> flag
<a href="https://github.com/pedestal/pedestal/blob/f64630cb3e60ffaf607d70071ca0781a55162f43/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78" target="_blank">https://github.com/pedestal/pedestal/blob/f64630cb3e60ffaf607d70071ca0781a55162f43/service/src/io/pedestal/http/ring_middlewares.clj#L73-L78</a>

what do people normally do in this situation? insert another interceptor to further process the <code>:cookies</code> map?
or provide a paraller interceptor to <code>io.pedestal.http.ring-middlewares/cookies</code> that does set a custom decoder ?</z><z id="t1587668849" t="Matt Butler Am I correct that gzip compression over websocket (permessage-deflate) is enabled by default and functional out of the box on any version of pedestal that depends on jetty 9.4 or above?"><y>#</y><d>2020-04-23</d><h>19:07</h><w>Matt Butler</w>Am I correct that gzip compression over websocket (permessage-deflate) is enabled by default and functional out of the box on any version of pedestal that depends on jetty 9.4 or above?</z><z id="t1589128913" t="souenzzo Hello. There is some tool to &quot;compose&quot; pedestal services? My problem: I have a HTTP service that has csrf-enabled {} but now I need to add a public post route"><y>#</y><d>2020-05-10</d><h>16:41</h><w>souenzzo</w>Hello. There is some tool to &quot;compose&quot; pedestal services?
My problem: I have a HTTP service that has <code>csrf-enabled {}</code> but now I need to add a public <code>post</code> route</z><z id="t1589131897" t="jkxyz the CSRF protection is just an interceptor, so you could remove it from the default interceptors (by removing csrf-enabled from the service map) and only include it for the routes you want to use it for"><y>#</y><d>2020-05-10</d><h>17:31</h><r>jkxyz</r>the CSRF protection is just an interceptor, so you could remove it from the default interceptors (by removing csrf-enabled from the service map) and only include it for the routes you want to use it for</z><z id="t1589308696" t="Yuhri Graziano Bernardes Hi everyone. Do you know some lib/plugin to generate swagger doc?"><y>#</y><d>2020-05-12</d><h>18:38</h><w>Yuhri Graziano Bernardes</w>Hi everyone. Do you know some lib/plugin to generate swagger doc?</z><z id="t1589308750" t="Ian Fernandez this? https://github.com/nubank/pedestal-swagger"><y>#</y><d>2020-05-12</d><h>18:39</h><w>Ian Fernandez</w>this? <a href="https://github.com/nubank/pedestal-swagger" target="_blank">https://github.com/nubank/pedestal-swagger</a></z><z id="t1589309034" t="Yuhri Graziano Bernardes Thanks. \o"><y>#</y><d>2020-05-12</d><h>18:43</h><w>Yuhri Graziano Bernardes</w>Thanks. \o</z><z id="t1589309103" t="Yuhri Graziano Bernardes I&apos;ll see it, but i&apos;d like to have more possibilities."><y>#</y><d>2020-05-12</d><h>18:45</h><w>Yuhri Graziano Bernardes</w>I&apos;ll see it, but i&apos;d like to have more possibilities.</z><z id="t1589313160" t="ikitommi https://github.com/oliyh/pedestal-api"><y>#</y><d>2020-05-12</d><h>19:52</h><w>ikitommi</w><a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a></z><z id="t1589313214" t="ikitommi https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger"><y>#</y><d>2020-05-12</d><h>19:53</h><w>ikitommi</w><a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a></z><z id="t1589482642" t="jdkealy Is there some way to fake a request to pedestal routes without going over HTTP ?"><y>#</y><d>2020-05-14</d><h>18:57</h><w>jdkealy</w>Is there some way to fake a request to pedestal routes without going over HTTP ?</z><z id="t1589482852" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] use the response-for test helper"><y>#</y><d>2020-05-14</d><h>19:00</h><w>ddeaguiar</w><a>@jdkealy</a> use the <code>response-for</code> test helper</z><z id="t1589482918" t="ddeaguiar http://pedestal.io/reference/unit-testing#unit-testing and http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service"><y>#</y><d>2020-05-14</d><h>19:01</h><w>ddeaguiar</w><a href="http://pedestal.io/reference/unit-testing#unit-testing" target="_blank">http://pedestal.io/reference/unit-testing#unit-testing</a> and <a href="http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service" target="_blank">http://pedestal.io/cookbook/index#_how_to_test_your_servlet_based_service</a></z><z id="t1589482991" t="jdkealy Thanks!"><y>#</y><d>2020-05-14</d><h>19:03</h><w>jdkealy</w>Thanks!</z><z id="t1589482995" t="ddeaguiar :thumbsup:"><y>#</y><d>2020-05-14</d><h>19:03</h><w>ddeaguiar</w><b>:thumbsup:</b></z><z id="t1589529836" t="Karol Wójcik Imo faking the request should be considered bad practice. Why do people test whether http library like pedestal works? Shouldn&apos;t we test the domain logic instead?"><y>#</y><d>2020-05-15</d><h>08:03</h><w>Karol Wójcik</w>Imo faking the request should be considered bad practice. Why do people test whether http library like pedestal works? Shouldn&apos;t we test the domain logic instead?</z><z id="t1589553977" t="jdkealy That’s my issue is because of all the chained interceptors (I’m brand new to pedestal and interceptors ), I don’t understand how to get the result of an endpoint without using response-for"><y>#</y><d>2020-05-15</d><h>14:46</h><w>jdkealy</w>That’s my issue is because of all the chained interceptors (I’m brand new to pedestal and interceptors ), I don’t understand how to get the result of an endpoint without using <code>response-for</code></z><z id="t1589554023" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] you can also test an interceptor or subset of interceptors directly"><y>#</y><d>2020-05-15</d><h>14:47</h><w>ddeaguiar</w><a>@jdkealy</a> you can also test an interceptor or subset of interceptors directly</z><z id="t1589554117" t="jdkealy Let’s say I wanted to get a swagger.json from and upload it to S3. Would you be able to do that without using response-for ?"><y>#</y><d>2020-05-15</d><h>14:48</h><w>jdkealy</w>Let’s say I wanted to get a swagger.json  from <code></code> and upload it to S3. Would you be able to do that without using response-for ?</z><z id="t1589554203" t="jdkealy That calls this: "><y>#</y><d>2020-05-15</d><h>14:50</h><w>jdkealy</w>That calls this:
<code></code></z><z id="t1589554336" t="ddeaguiar IDK, that’s less of a pedestal concern. While working in the repl during development I don’t use response-for . I limit the usage to testing. In the repl I work with small fns which handle the core logic of the system"><y>#</y><d>2020-05-15</d><h>14:52</h><w>ddeaguiar</w>IDK, that’s less of a pedestal concern. While working in the repl during development I don’t use <code>response-for</code> . I limit the usage to testing. In the repl I work with small fns which handle the core logic of the system</z><z id="t1589554394" t="ddeaguiar I don’t think end-to-end testing is bad practice but it should not be applied as a hammer either."><y>#</y><d>2020-05-15</d><h>14:53</h><w>ddeaguiar</w>I don’t think end-to-end testing is bad practice but it should not be applied as a hammer either.</z><z id="t1589554483" t="ddeaguiar I also tend to spin up my service and send requests to it during dev as well. Changes being applied as I build. But I do that when I’m interested in any wiring I’ve done"><y>#</y><d>2020-05-15</d><h>14:54</h><w>ddeaguiar</w>I also tend to spin up my service and send requests to it during dev as well. Changes being applied as I build. But I do that when I’m interested in any wiring I’ve done</z><z id="t1589554508" t="ddeaguiar When working on interceptors, I’m most interested in Context in/out"><y>#</y><d>2020-05-15</d><h>14:55</h><w>ddeaguiar</w>When working on interceptors, I’m most interested in Context in/out</z><z id="t1589554527" t="ddeaguiar So can exercise them in isolation"><y>#</y><d>2020-05-15</d><h>14:55</h><w>ddeaguiar</w>So can exercise them in isolation</z><z id="t1589554576" t="ddeaguiar If an interceptor requires some setup (i.e., data in context) I either fake that or add the interceptors that bring in that data to the interceptor chain that gets executed"><y>#</y><d>2020-05-15</d><h>14:56</h><w>ddeaguiar</w>If an interceptor requires some setup (i.e., data in context) I either fake that or add the interceptors that bring in that data to the interceptor chain that gets executed</z><z id="t1589554635" t="ddeaguiar (def result-ctx (io.pedestal.interceptor.chain/execute {} [interceptor1 interceptor2 …])"><y>#</y><d>2020-05-15</d><h>14:57</h><w>ddeaguiar</w><code>(def result-ctx (io.pedestal.interceptor.chain/execute {} [interceptor1 interceptor2 …])</code></z><z id="t1589554638" t="ddeaguiar something like that"><y>#</y><d>2020-05-15</d><h>14:57</h><w>ddeaguiar</w>something like that</z><z id="t1589554850" t="ddeaguiar The concept of Chain Provider is at the core of Pedestal http://pedestal.io/reference/chain-providers#chain-providers"><y>#</y><d>2020-05-15</d><h>15:00</h><w>ddeaguiar</w>The concept of Chain Provider is at the core of Pedestal <a href="http://pedestal.io/reference/chain-providers#chain-providers" target="_blank">http://pedestal.io/reference/chain-providers#chain-providers</a></z><z id="t1589554899" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] glad to see you giving Pedestal a spin! Hopefully this info helps."><y>#</y><d>2020-05-15</d><h>15:01</h><w>ddeaguiar</w><a>@jdkealy</a> glad to see you giving Pedestal a spin! Hopefully this info helps.</z><z id="t1589554910" t="jdkealy Thanks a bunch 🙂"><y>#</y><d>2020-05-15</d><h>15:01</h><w>jdkealy</w>Thanks a bunch <b>🙂</b></z><z id="t1589650210" t="jdkealy When I throw an exception via an interceptor, it puts the namespace and interceptor info in it java.lang.Exception in Interceptor :pair-trade.handlers.users/sign-up - user already exists is there a nice way to just keep user already exists without splitting on “-” ?"><y>#</y><d>2020-05-16</d><h>17:30</h><w>jdkealy</w>When I throw an exception via an interceptor, it puts the namespace and interceptor info in it <code>java.lang.Exception in Interceptor :pair-trade.handlers.users/sign-up - user already exists</code> is there a nice way to just keep <code>user already exists</code>  without splitting on “-” ?</z><z id="t1589684742" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] Pedestal wraps all exceptions thrown by interceptors in an ExceptionInfo . You can either get the cause off the thrown ExceptionInfo pull it out of the ex-data using the :exception key. The joining of interceptor name and original message is not configurable. For additional attrs in ex-data, see http://pedestal.io/reference/error-handling"><y>#</y><d>2020-05-17</d><h>03:05</h><w>ddeaguiar</w><a>@jdkealy</a> Pedestal wraps all exceptions thrown by interceptors in an <code>ExceptionInfo</code>. You can either get the cause off the thrown <code>ExceptionInfo</code> pull it out of the <code>ex-data</code> using the <code>:exception</code>  key. The joining of interceptor name and original message is not configurable. For additional attrs in ex-data, see <a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a></z><z id="t1589739017" t="Lennart Buit Hey. I also have a question about exceptions. In a ‘normal’ synchronous interceptor I can just raise (or not catch) exceptions, and they’ll eventually end up in an :error interceptor. However, I can’t figure out what to do with exceptions occuring in asynchonous interceptors. The docs say they should return channels with context maps, and that exceptions are put in ::chain/error in the context map wrapped in an ExceptionInfo , but I am struggling to find out how to create such a wrapped exception to put in the context in my asynchronous interceptor."><y>#</y><d>2020-05-17</d><h>18:10</h><w>Lennart Buit</w>Hey. I also have a question about exceptions. In a ‘normal’ synchronous interceptor I can just raise (or not catch) exceptions, and they’ll eventually end up in an <code>:error</code> interceptor. However, I can’t figure out what to do with exceptions occuring in asynchonous interceptors. The docs say they should return channels with context maps, and that exceptions are put in <code>::chain/error</code> in the context map wrapped in an <code>ExceptionInfo</code>, but I am struggling to find out how to create such a wrapped exception to put in the context in my asynchronous interceptor.</z><z id="t1589842678" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/UDF11HLKC&quot;}] , assoc an ex-info wrapping your exception to the context using the :io.pedestal.interceptor.chain/error key. You can add the ex-data specified in http://pedestal.io/reference/error-handling#_error_function if you are dispatching on that info in a generic error handler. Currently the code which converts an exception to a wrapped exception is private and not part of the public api. [:attrs {:href &quot;/_/_/users/UDF11HLKC&quot;}]"><y>#</y><d>2020-05-18</d><h>22:57</h><r>ddeaguiar</r>Hi <a>@UDF11HLKC</a>, assoc an ex-info wrapping your exception to the context using the <code>:io.pedestal.interceptor.chain/error</code> key. You can add the ex-data specified in <a href="http://pedestal.io/reference/error-handling#_error_function" target="_blank">http://pedestal.io/reference/error-handling#_error_function</a> if you are dispatching on that info in a generic error handler. Currently the code which converts an exception to a wrapped exception is private and not part of the public api.
<a>@UDF11HLKC</a></z><z id="t1589842736" t="ddeaguiar Not all the ex-data is required. It depends on what you are dispatching on. The ::chain/execution-id is on the context but the stage is not. You do, however, know the stage so can add that if necessary"><y>#</y><d>2020-05-18</d><h>22:58</h><r>ddeaguiar</r>Not all the ex-data is required. It depends on what you are dispatching on. The <code>::chain/execution-id</code> is on the context but the <code>stage</code> is not. You do, however, know the stage so can add that if necessary</z><z id="t1589870036" t="Lennart Buit Okay, I’ll do that then. Thank you for answering 🙂"><y>#</y><d>2020-05-19</d><h>06:33</h><r>Lennart Buit</r>Okay, I’ll do that then. Thank you for answering <b>🙂</b></z><z id="t1589920210" t="Lennart Buit Works like a charm :thumbsup: , can provide basically the same ex-data as pedestal would! Thanks again"><y>#</y><d>2020-05-19</d><h>20:30</h><r>Lennart Buit</r>Works like a charm <b>:thumbsup:</b> , can provide basically the same ex-data as pedestal would! Thanks again</z><z id="t1589926971" t="thosmos I’m running pedestal with jetty and it appears to be bound only to localhost. Is there a common way to bind to all interfaces?"><y>#</y><d>2020-05-19</d><h>22:22</h><w>thosmos</w>I’m running pedestal with jetty and it appears to be bound only to localhost.  Is there a common way to bind to all interfaces?</z><z id="t1590272649" t="hlship This was, AFAIK, an intentional change several releases ago, to prevent (in production) accidentally binding to too many interfaces. Now it has to be done intentionally."><y>#</y><d>2020-05-23</d><h>22:24</h><r>hlship</r>This was, AFAIK, an intentional change several releases ago, to prevent (in production) accidentally binding to too many interfaces. Now it has to be done intentionally.</z><z id="t1589927831" t="thosmos I fixed it by setting the :io.pedestal.http/host key in the service-map"><y>#</y><d>2020-05-19</d><h>22:37</h><w>thosmos</w>I fixed it by setting the <code>:io.pedestal.http/host</code> key in the service-map</z><z id="t1590351760" t="jdkealy How are you supposed to get the current user in a websocket connection in pedestal/jetty? Can’t seem to find any reference to the request at all in the connection request ... ::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths)} ... (def ws-paths {&quot;/ws&quot; {:on-connect (fn [e] (let [[sess channel] ((ws/start-ws-connection new-ws-client) e)] (println &quot;CANT FIND A TOKEN OR ANYTHING HERE&quot; e) channel )) :on-text (fn [msg] (log/info :msg (str &quot;A client sent - &quot; msg))) :on-binary (fn [payload offset length] (log/info :msg &quot;Binary Message!&quot; :bytes payload)) :on-error (fn [t] (log/error :msg &quot;WS Error happened&quot; :exception t)) :on-close (fn [num-code reason-text] (log/info :msg &quot;WS Closed:&quot; :reason reason-text))}})"><y>#</y><d>2020-05-24</d><h>20:22</h><w>jdkealy</w>How are you supposed to get the current user in a websocket connection in pedestal/jetty? Can’t seem to find any reference to the request at all in the connection request
<pre>...
::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths)}
... 

(def ws-paths
  {&quot;/ws&quot; {:on-connect (fn [e]
                        (let [[sess channel] ((ws/start-ws-connection new-ws-client) e)]
                          (println &quot;CANT FIND A TOKEN OR ANYTHING HERE&quot; e)
                    channel
                    ))
          :on-text (fn [msg] (log/info :msg (str &quot;A client sent - &quot; msg)))
          :on-binary (fn [payload offset length] (log/info :msg &quot;Binary Message!&quot; :bytes payload))
          :on-error (fn [t] (log/error :msg &quot;WS Error happened&quot; :exception t))
          :on-close (fn [num-code reason-text]
                      (log/info :msg &quot;WS Closed:&quot; :reason reason-text))}})</pre></z><z id="t1590418713" t="adamfeldman There might be something to reference in this code: https://github.com/ptaoussanis/sente"><y>#</y><d>2020-05-25</d><h>14:58</h><r>adamfeldman</r>There might be something to reference in this code: <a href="https://github.com/ptaoussanis/sente" target="_blank">https://github.com/ptaoussanis/sente</a></z><z id="t1590440934" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] You can access to the upgrade request via the websocket session object. Check out the Jetty websocket api for details."><y>#</y><d>2020-05-25</d><h>21:08</h><r>ddeaguiar</r><a>@U1DBQAAMB</a> You can access to the upgrade request via the websocket session object. Check out the Jetty websocket api for details.</z><z id="t1590351947" t="jdkealy Also, I’m trying to make the connection with some query parameters. I want to A:) make the websocket connection for the associated topic and B:) authenticate that the user has access to the topic"><y>#</y><d>2020-05-24</d><h>20:25</h><w>jdkealy</w>Also, I’m trying to make the connection with some query parameters. I want to A:) make the websocket connection for the associated topic and B:) authenticate that the user has access to the topic</z><z id="t1590354326" t="dvingo this came up before, i haven&apos;t tried it but the notes are here https://clojurians-log.clojureverse.org/pedestal/2020-04-09"><y>#</y><d>2020-05-24</d><h>21:05</h><w>dvingo</w>this came up before, i haven&apos;t tried it but the notes are here
<a href="https://clojurians-log.clojureverse.org/pedestal/2020-04-09" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2020-04-09</a></z><z id="t1590355962" t="jdkealy thanks, it’s a bit over my head lol"><y>#</y><d>2020-05-24</d><h>21:32</h><w>jdkealy</w>thanks, it’s a bit over my head lol</z><z id="t1590356075" t="jdkealy is the hindol.adhya suggesting to replace #(ws/add-ws-endpoints % ws-paths) with ws-listener ? I’ll give that a try."><y>#</y><d>2020-05-24</d><h>21:34</h><w>jdkealy</w>is the <code>hindol.adhya</code> suggesting to replace <code>#(ws/add-ws-endpoints % ws-paths)</code> with <code>ws-listener</code> ? I’ll give that a try.</z><z id="t1590357042" t="hindol That&apos;s my snippet. The last line shows how to use it."><y>#</y><d>2020-05-24</d><h>21:50</h><w>hindol</w>That&apos;s my snippet. The last line shows how to use it.</z><z id="t1590357184" t="hindol Ben has an alternative approach below that. But in both cases, you supply your own listener function to add-ws-endpoints."><y>#</y><d>2020-05-24</d><h>21:53</h><w>hindol</w>Ben has an alternative approach below that. But in both cases, you supply your own listener function to add-ws-endpoints.</z><z id="t1590357927" t="jdkealy ah cool i see… So you need to dip a bit into java. Between (.getHeaders _request) / (.getRequestURI _request) I could hack getting the current user / request params. It would be super convenient to be able to leverage the interceptors, but this gets me what I need. Many thanks!"><y>#</y><d>2020-05-24</d><h>22:05</h><w>jdkealy</w>ah cool i see… So you need to dip a bit into java. Between <code>(.getHeaders _request)</code> / <code>(.getRequestURI _request)</code> I could hack getting the current user / request params. It would be super convenient to be able to leverage the interceptors, but this gets me what I need. Many  thanks!</z><z id="t1590406383" t="hindol I am in no way a WebSocket expert but I think the only opportunity to grab the HTTP(S) headers is during the WS upgrade request. Post that, I found no HTTP headers are available. One thing that helped me tremendously is this article on Heroku: https://devcenter.heroku.com/articles/websocket-security#authentication-authorization"><y>#</y><d>2020-05-25</d><h>11:33</h><w>hindol</w>I am in no way a WebSocket expert but I think the only opportunity to grab the HTTP(S) headers is during the WS upgrade request. Post that, I found no HTTP headers are available. One thing that helped me tremendously is this article on Heroku: <a href="https://devcenter.heroku.com/articles/websocket-security#authentication-authorization" target="_blank">https://devcenter.heroku.com/articles/websocket-security#authentication-authorization</a></z><z id="t1590406487" t="hindol Once a WS connection is established, I don&apos;t think you can leverage the interceptor model, at least not in a straight-forward way. I think that&apos;s designed for HTTP only."><y>#</y><d>2020-05-25</d><h>11:34</h><w>hindol</w>Once a WS connection is established, I don&apos;t think you can leverage the interceptor model, at least not in a straight-forward way. I think that&apos;s designed for HTTP only.</z><z id="t1590501802" t="Joe Lane You can &quot;leverage the interceptor model&quot; by creating your own interceptor chain and run all onmessage events through said chain. Pedestal interceptors are NOT coupled to HTTP, I&apos;ve used them with queues, my own domain logic, I&apos;ve even seen them with kafka."><y>#</y><d>2020-05-26</d><h>14:03</h><w>Joe Lane</w>You can &quot;leverage the interceptor model&quot; by creating your own interceptor chain and run all <code>onmessage</code> events through said chain. Pedestal interceptors are NOT coupled to HTTP, I&apos;ve used them with queues, my own domain logic, I&apos;ve even seen them with kafka.</z><z id="t1590523999" t="hlship We use them as wrappers around outgoing HTTP requests as well, to add logging/retries/QoS/encoding &amp; decoding ..."><y>#</y><d>2020-05-26</d><h>20:13</h><r>hlship</r>We use them as wrappers around outgoing HTTP requests as well, to add logging/retries/QoS/encoding &amp; decoding ...</z><z id="t1590502146" t="Joe Lane https://github.com/cognitect-labs/pedestal.kafka"><y>#</y><d>2020-05-26</d><h>14:09</h><w>Joe Lane</w><a href="https://github.com/cognitect-labs/pedestal.kafka" target="_blank">https://github.com/cognitect-labs/pedestal.kafka</a></z><z id="t1590502289" t="mpenet lots of libs use that pattern now, it&apos;s basically an enhanced middleware pattern (open/modifiable stack/queue). There are also a few libs that make it usable with manifold, completablefutures, cljs etc (basically implementing their own chain runner, with some slight modifications sometimes, since it&apos;s not specified)"><y>#</y><d>2020-05-26</d><h>14:11</h><w>mpenet</w>lots of libs use that pattern now, it&apos;s basically an enhanced middleware pattern (open/modifiable stack/queue). There are also a few libs that make it usable with manifold, completablefutures, cljs etc (basically implementing their own chain runner, with some slight modifications sometimes, since it&apos;s not specified)</z><z id="t1590502761" t="Joe Lane The difference between middleware and interceptors being functions vs data , respectively."><y>#</y><d>2020-05-26</d><h>14:19</h><w>Joe Lane</w>The difference between middleware and interceptors being <code>functions</code> vs <code>data</code>, respectively.</z><z id="t1590502777" t="mpenet closure vs explicit context"><y>#</y><d>2020-05-26</d><h>14:19</h><w>mpenet</w>closure vs explicit context</z><z id="t1590502783" t="mpenet but yes, kinda"><y>#</y><d>2020-05-26</d><h>14:19</h><w>mpenet</w>but yes, kinda</z><z id="t1590502797" t="Joe Lane I like your description more."><y>#</y><d>2020-05-26</d><h>14:19</h><w>Joe Lane</w>I like your description more.</z><z id="t1590502799" t="mpenet also interceptors you can modify on the fly the chain"><y>#</y><d>2020-05-26</d><h>14:19</h><w>mpenet</w>also interceptors you can modify on the fly the chain</z><z id="t1590502878" t="mpenet then some impl re-wrap errors, some dont etc etc, small variations"><y>#</y><d>2020-05-26</d><h>14:21</h><w>mpenet</w>then some impl re-wrap errors, some dont etc etc, small variations</z><z id="t1590513927" t="hindol [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] Thank you for the link. I really love the interceptor model. I find it much easier to wrap my head around than the middleware pattern. I have been looking at Sieppari for a general purpose interceptor chain but if Pedestal interceptors can be adapted, I will go with that instead."><y>#</y><d>2020-05-26</d><h>17:25</h><w>hindol</w><a>@lanejo01</a> Thank you for the link. I really love the interceptor model. I find it much easier to wrap my head around than the middleware pattern. I have been looking at Sieppari for a general purpose interceptor chain but if Pedestal interceptors can be adapted, I will go with that instead.</z><z id="t1590527664" t="ddeaguiar FYI, I’ve created https://github.com/pedestal/pedestal/issues/659 to track the creation of a session-aware WebSocketListener impl"><y>#</y><d>2020-05-26</d><h>21:14</h><w>ddeaguiar</w>FYI, I’ve created <a href="https://github.com/pedestal/pedestal/issues/659" target="_blank">https://github.com/pedestal/pedestal/issues/659</a> to track the creation of a session-aware WebSocketListener impl</z><z id="t1590561984" t="hindol If you are accepting PRs for this, I can help. (I am not an expert on frontend technologies though, so it would be good if someone can provide meaningful feedback.)"><y>#</y><d>2020-05-27</d><h>06:46</h><r>hindol</r>If you are accepting PRs for this, I can help.

(I am not an expert on frontend technologies though, so it would be good if someone can provide meaningful feedback.)</z><z id="t1590610779" t="hlship Was it intentional in io.pedestal.logging 0.5.8 to not reference the override-logger at this line: https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L277"><y>#</y><d>2020-05-27</d><h>20:19</h><w>hlship</w>Was it intentional in io.pedestal.logging 0.5.8 to not reference the override-logger at this line:

<a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L277" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj#L277</a></z><z id="t1590611174" t="hlship Essentially, for my code that bridges from io.pedestal.log to our internal logging code, changing io.pedestal.log/override-logger has no effect, as that only works for the pretty much unused io.pedestal.log/log function, and not for log-expr which is where logging really takes place."><y>#</y><d>2020-05-27</d><h>20:26</h><w>hlship</w>Essentially, for my code that bridges from io.pedestal.log to our internal logging code, changing io.pedestal.log/override-logger has no effect, as that only works for the pretty much unused io.pedestal.log/log function, and not for log-expr which is where logging really takes place.</z><z id="t1590611180" t="hlship Sorry I didn&apos;t notice this in the PR."><y>#</y><d>2020-05-27</d><h>20:26</h><w>hlship</w>Sorry I didn&apos;t notice this in the PR.</z><z id="t1590611369" t="hlship And that puts me pack at square 1, because io.pedestal.log/debug has already been compiled from the result of log-expr before my code has a chance to either set override-logger or set the JVM system property."><y>#</y><d>2020-05-27</d><h>20:29</h><w>hlship</w>And that puts me pack at square 1, because <code>io.pedestal.log/debug</code> has already been compiled from the result of log-expr before my code has a chance to either set override-logger or set the JVM system property.</z><z id="t1590611480" t="hlship (macroexpand-all &apos;(pl/debug :from :pedestal :a 1 :b 2)) =&gt; (let* [logger2682 (. org.slf4j.LoggerFactory getLogger &quot;user&quot;)] (if (io.pedestal.log/-level-enabled? logger2682 :debug) (do (let* [string2683 (let* [] (clojure.core/push-thread-bindings (clojure.core/hash-map (var clojure.core/*print-length*) 80)) (try (#object[clojure.core$pr_str 0x16f7b4af &quot;clojure.core$pr_str@16f7b4af&quot;] {:from :pedestal, :a 1, :b 2, :line 1}) (finally (clojure.core/pop-thread-bindings))))] (io.pedestal.log/-debug logger2682 string2683)))))"><y>#</y><d>2020-05-27</d><h>20:31</h><w>hlship</w><pre>(macroexpand-all &apos;(pl/debug :from :pedestal :a 1 :b 2))
=&gt;
(let*
 [logger2682 (. org.slf4j.LoggerFactory getLogger &quot;user&quot;)]
 (if
  (io.pedestal.log/-level-enabled? logger2682 :debug)
  (do
   (let*
    [string2683
     (let*
      []
      (clojure.core/push-thread-bindings (clojure.core/hash-map (var clojure.core/*print-length*) 80))
      (try
       (#object[clojure.core$pr_str 0x16f7b4af &quot;clojure.core$pr_str@16f7b4af&quot;] {:from :pedestal, :a 1, :b 2, :line 1})
       (finally (clojure.core/pop-thread-bindings))))]
    (io.pedestal.log/-debug logger2682 string2683)))))</pre></z><z id="t1590612104" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , the only change in 0.5.8 re: logging was to the log fn. The particular code you linked hasn’t changed in years. What version of Pedestal are you migrating from?"><y>#</y><d>2020-05-27</d><h>20:41</h><w>ddeaguiar</w>Hi <a>@hlship</a>, the only change in 0.5.8 re: logging was to the <code>log</code> fn. The particular code you linked hasn’t changed in years. What version of Pedestal are you migrating from?</z><z id="t1590612187" t="ddeaguiar I recall running into an issue regarding logger overriding and thought I created a GitHub issue for it but that does not seem to be the case."><y>#</y><d>2020-05-27</d><h>20:43</h><w>ddeaguiar</w>I recall running into an issue regarding logger overriding and thought I created a GitHub issue for it but that does not seem to be the case.</z><z id="t1590612510" t="hlship There was the issue that overrideLogger couldn&apos;t be used, because it was not treated as a function, that was fixed in 0.5.8."><y>#</y><d>2020-05-27</d><h>20:48</h><w>hlship</w>There was the issue that <code>overrideLogger</code> couldn&apos;t be used, because it was not treated as a function, that was fixed in 0.5.8.</z><z id="t1590612511" t="hlship https://github.com/pedestal/pedestal/commit/621b6896aab6582499e0076bd9c73d5aeb01dae9"><y>#</y><d>2020-05-27</d><h>20:48</h><w>hlship</w><a href="https://github.com/pedestal/pedestal/commit/621b6896aab6582499e0076bd9c73d5aeb01dae9" target="_blank">https://github.com/pedestal/pedestal/commit/621b6896aab6582499e0076bd9c73d5aeb01dae9</a></z><z id="t1590612526" t="hlship But from my perspective, it&apos;s only a partial fix, because it doesn&apos;t cover log-expr ."><y>#</y><d>2020-05-27</d><h>20:48</h><w>hlship</w>But from my perspective, it&apos;s only a partial fix, because it doesn&apos;t cover <code>log-expr</code>.</z><z id="t1590612550" t="hlship My workaround seems to be working:"><y>#</y><d>2020-05-27</d><h>20:49</h><w>hlship</w>My workaround seems to be working:</z><z id="t1590612553" t="hlship (def logger (memoize logger*)) ;; This actually doesn&apos;t accomplish anything in Pedestal 0.5.8 (alter-var-root #&apos;io.pedestal.log/override-logger (fn [_] logger)) (System/setProperty &quot;io.pedestal.log.overrideLogger&quot; &quot;com.walmartlabs.log.pedestal/logger&quot;)"><y>#</y><d>2020-05-27</d><h>20:49</h><w>hlship</w><pre>(def logger (memoize logger*))

;; This actually doesn&apos;t accomplish anything in Pedestal 0.5.8

(alter-var-root #&apos;io.pedestal.log/override-logger (fn [_] logger))

(System/setProperty  &quot;io.pedestal.log.overrideLogger&quot; &quot;com.walmartlabs.log.pedestal/logger&quot;)</pre></z><z id="t1590612868" t="ddeaguiar Ah I see. Ok going to create another issue which refs #638. I’ll prioritize that one"><y>#</y><d>2020-05-27</d><h>20:54</h><w>ddeaguiar</w>Ah I see. Ok going to create another issue which refs #638. I’ll prioritize that one</z><z id="t1590612908" t="ddeaguiar Will also drop a ref to your workaround"><y>#</y><d>2020-05-27</d><h>20:55</h><w>ddeaguiar</w>Will also drop a ref to your workaround</z><z id="t1590612979" t="hlship Thanks!"><y>#</y><d>2020-05-27</d><h>20:56</h><w>hlship</w>Thanks!</z><z id="t1591133289" t="lxsameer hey folks, how can i serve some static files in a directory in resources ? like serving any request that doesn&apos;t have an assigned route should look for an asset in that dir"><y>#</y><d>2020-06-02</d><h>21:28</h><w>lxsameer</w>hey folks, how can i serve some static files in a directory in resources ? like serving any request that doesn&apos;t have an assigned route should look for an asset in that dir</z><z id="t1591133639" t="hindol Pedestal has adapters for many Ring middlewares. Look up the resources middleware in Pedestal&apos;s source."><y>#</y><d>2020-06-02</d><h>21:33</h><r>hindol</r>Pedestal has adapters for many Ring middlewares. Look up the resources middleware in Pedestal&apos;s source.</z><z id="t1591133842" t="lxsameer i&apos;ve tried fast-resources and resources"><y>#</y><d>2020-06-02</d><h>21:37</h><r>lxsameer</r>i&apos;ve tried fast-resources and resources</z><z id="t1591161096" t="hindol What configuration did you try?"><y>#</y><d>2020-06-03</d><h>05:11</h><r>hindol</r>What configuration did you try?</z><z id="t1591133559" t="lxsameer btw it seems that http://pedestal.io is down or something"><y>#</y><d>2020-06-02</d><h>21:32</h><w>lxsameer</w>btw it seems that <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> is down or something</z><z id="t1591153507" t="jdkealy I find that when I am attempting to reload a handler with pedestal I also need to re-evaluate the service that calls the handler for the changes to take effect. Are there any tips to bypass having to reload the service that calls the handler ?"><y>#</y><d>2020-06-03</d><h>03:05</h><w>jdkealy</w>I find that when I am attempting to reload a handler with pedestal I also need to re-evaluate the service that calls the handler for the changes to take effect. Are there any tips to bypass having to reload the service that calls the handler ?</z><z id="t1591153865" t="isak [:attrs {:href &quot;/_/_/users/U1DBQAAMB&quot;}] for development mode, change your routes to (fn [] (expand-routes (deref #&apos;my-routes)) in the service-map (instead of the default, something like: (expand-routes my-routes) )"><y>#</y><d>2020-06-03</d><h>03:11</h><w>isak</w><a>@jdkealy</a> for development mode, change your routes to <code>(fn [] (expand-routes (deref #&apos;my-routes))</code> in the service-map (instead of the default, something like:  <code>(expand-routes my-routes)</code> )</z><z id="t1591179953" t="lxsameer hey folks: here is my routes and the logs http://paste.debian.net/1149907/"><y>#</y><d>2020-06-03</d><h>10:25</h><w>lxsameer</w>hey folks: here is my routes and the logs <a href="http://paste.debian.net/1149907/" target="_blank">http://paste.debian.net/1149907/</a></z><z id="t1591179972" t="lxsameer any post request to /q returns 404"><y>#</y><d>2020-06-03</d><h>10:26</h><w>lxsameer</w>any post request to <code>/q</code> returns 404</z><z id="t1591179989" t="lxsameer am I doing it wrong ?"><y>#</y><d>2020-06-03</d><h>10:26</h><w>lxsameer</w>am I doing it wrong ?</z><z id="t1591225941" t="jvtrigueros Is this code in a public repo somewhere? I&apos;d like to repro."><y>#</y><d>2020-06-03</d><h>23:12</h><r>jvtrigueros</r>Is this code in a public repo somewhere? I&apos;d like to repro.</z><z id="t1591225817" t="husayn hello. I am using pedestal and seeing some weird behaviour, when I catch an exception the interceptor chain restarts instead of returning my response (catch java.util.concurrent.ExecutionException e (log/info :msg &quot;return error&quot;) (assoc context :response {:status 408 :body {:status &quot;error&quot; :message (format &quot;Operation Timed out %d seconds&quot; wait-time)}})) and the logs look like 00:58:50.511 [qtp463993419-109] INFO payment-gateway.routes.collection - {:msg &quot;valid public key ?&quot;, :line 20} 00:58:50.525 [qtp463993419-109] INFO payment-gateway.routes.collection - {:msg &quot;valid referency id ?&quot;, :line 40} 00:58:50.621 [qtp463993419-109] INFO payment-gateway.routes.collection - {:msg &quot;create payment&quot;, :line 119} 00:58:52.667 [qtp463993419-109] INFO payment-gateway.routes.collection - {:status :accepted, :line 122} 00:58:52.667 [qtp463993419-109] INFO payment-gateway.routes.collection - {:msg &quot;process request&quot;, :line 125} 00:59:30.555 [qtp463993419-109] INFO payment-gateway.routes.collection - {:msg &quot;return error&quot;, :line 136} 00:59:30.565 [qtp463993419-110] INFO payment-gateway.routes.collection - {:msg &quot;valid public key ?&quot;, :line 20} 00:59:30.566 [qtp463993419-110] INFO payment-gateway.routes.collection - {:msg &quot;valid referency id ?&quot;, :line 40} As you can see the request starts on thread qtp463993419-109 but when I return, it. instead restarts on a new thread qtp463993419-110 Has anyone experienced this before or what could be going on ?"><y>#</y><d>2020-06-03</d><h>23:10</h><w>husayn</w>hello. I am using pedestal and seeing some weird behaviour, when I catch an exception the interceptor chain restarts instead of returning my response
<pre>(catch java.util.concurrent.ExecutionException e
                    (log/info :msg &quot;return error&quot;)
                    (assoc context :response
                           {:status 408
                            :body {:status &quot;error&quot;
                                   :message (format &quot;Operation Timed out %d seconds&quot; wait-time)}}))</pre>
and the logs look like
<pre>00:58:50.511 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:msg &quot;valid public key ?&quot;, :line 20}
00:58:50.525 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:msg &quot;valid referency id ?&quot;, :line 40}
00:58:50.621 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:msg &quot;create payment&quot;, :line 119}
00:58:52.667 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:status :accepted, :line 122}
00:58:52.667 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:msg &quot;process request&quot;, :line 125}
00:59:30.555 [qtp463993419-109] INFO  payment-gateway.routes.collection - {:msg &quot;return error&quot;, :line 136}
00:59:30.565 [qtp463993419-110] INFO  payment-gateway.routes.collection - {:msg &quot;valid public key ?&quot;, :line 20}
00:59:30.566 [qtp463993419-110] INFO  payment-gateway.routes.collection - {:msg &quot;valid referency id ?&quot;, :line 40}</pre>
As you can see the request starts on thread <code>qtp463993419-109</code>  but when I return, it. instead restarts on a new thread <code>qtp463993419-110</code>
Has anyone experienced this before or what could be going on ?</z><z id="t1591817536" t="emccue I know it is annoying to ask, but in a few years"><y>#</y><d>2020-06-10</d><h>19:32</h><w>emccue</w>I know it is annoying to ask, but in a few years</z><z id="t1591817543" t="emccue or maybe a decade or two"><y>#</y><d>2020-06-10</d><h>19:32</h><w>emccue</w>or maybe a decade or two</z><z id="t1591817558" t="emccue how does pedestal look when Virtual Threads are a thing"><y>#</y><d>2020-06-10</d><h>19:32</h><w>emccue</w>how does pedestal look when Virtual Threads are a thing</z><z id="t1591817586" t="emccue How much of the asynchrony wouldn&apos;t be needed anymore?"><y>#</y><d>2020-06-10</d><h>19:33</h><w>emccue</w>How much of the asynchrony wouldn&apos;t be needed anymore?</z><z id="t1591853130" t="orestis I don’t use async handlers today so I guess my code will look the same :)"><y>#</y><d>2020-06-11</d><h>05:25</h><w>orestis</w>I don’t use async handlers today so I guess my code will look the same :)</z><z id="t1591877510" t="orestis For the life of mine I can’t figure out why upgrading lacinia-pedestal to 0.13.0 breaks GraphiQL for me. I’ve narrowed it down to com.walmartlabs.lacinia.pedestal/graphiql-ide-response which somehow generates connectionParams: --NO-MATCH-- which of course the browser complains about — but even if I pass in ide-connection-params as an option I get the same result."><y>#</y><d>2020-06-11</d><h>12:11</h><w>orestis</w>For the life of mine I can’t figure out why upgrading lacinia-pedestal to 0.13.0 breaks GraphiQL for me. I’ve narrowed it down to <code>com.walmartlabs.lacinia.pedestal/graphiql-ide-response</code> which somehow generates <code>connectionParams: --NO-MATCH--</code>which of course the browser complains about — but even if I pass in <code>ide-connection-params</code> as an option I get the same result.</z><z id="t1591877585" t="orestis I’ve literally copy-pasted the function definition and when I call it locally, everything works as expected."><y>#</y><d>2020-06-11</d><h>12:13</h><w>orestis</w>I’ve literally copy-pasted the function definition and when I call it locally, everything works as expected.</z><z id="t1591877681" t="orestis This is the version 0.13 function: https://github.com/walmartlabs/lacinia-pedestal/blob/34434816cbc3ac868b7522901a5f0e875c4916cb/src/com/walmartlabs/lacinia/pedestal.clj#L441"><y>#</y><d>2020-06-11</d><h>12:14</h><w>orestis</w>This is the version 0.13 function: <a href="https://github.com/walmartlabs/lacinia-pedestal/blob/34434816cbc3ac868b7522901a5f0e875c4916cb/src/com/walmartlabs/lacinia/pedestal.clj#L441" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/blob/34434816cbc3ac868b7522901a5f0e875c4916cb/src/com/walmartlabs/lacinia/pedestal.clj#L441</a></z><z id="t1591878057" t="orestis Huh. Of course the moment I try to attach a debugger everything works 😞"><y>#</y><d>2020-06-11</d><h>12:20</h><w>orestis</w>Huh. Of course the moment I try to attach a debugger everything works <b>😞</b></z><z id="t1591878492" t="orestis But not from a fresh VM. I’m not sure what’s going on."><y>#</y><d>2020-06-11</d><h>12:28</h><w>orestis</w>But not from a fresh VM. I’m not sure what’s going on.</z><z id="t1591883336" t="orestis Ah, wrong channel, was meant to go to #graphql — sorry"><y>#</y><d>2020-06-11</d><h>13:48</h><w>orestis</w>Ah, wrong channel, was meant to go to #graphql — sorry</z><z id="t1591886636" t="hindol [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] git bisect really helps in such cases. For a deps.edn based library and if you yourself use deps, you can point to a local copy of the library and run git bisect. But here I see they are using lein. I wonder if there is still a way to bisect."><y>#</y><d>2020-06-11</d><h>14:43</h><w>hindol</w><a>@orestis</a> git bisect really helps in such cases. For a deps.edn based library and if you yourself use deps, you can point to a local copy of the library and run git bisect. But here I see they are using lein. I wonder if there is still a way to bisect.</z><z id="t1591886689" t="orestis Turns out that (as expected) it was a problem on my end (AOT compiled deps)"><y>#</y><d>2020-06-11</d><h>14:44</h><w>orestis</w>Turns out that (as expected) it was a problem on my end (AOT compiled deps)</z><z id="t1591887417" t="orestis Having fixed my AOT problems and now actually using pedestal.log 0.5.8 I’ve found a breaking change which should be impacting everyone: https://github.com/pedestal/pedestal/issues/638#issuecomment-642714551"><y>#</y><d>2020-06-11</d><h>14:56</h><w>orestis</w>Having fixed my AOT problems and now actually using pedestal.log 0.5.8 I’ve found a breaking change which should be impacting everyone: <a href="https://github.com/pedestal/pedestal/issues/638#issuecomment-642714551" target="_blank">https://github.com/pedestal/pedestal/issues/638#issuecomment-642714551</a></z><z id="t1591887542" t="orestis Seems like it’s only direct use of log/log that breaks it; log/info still works."><y>#</y><d>2020-06-11</d><h>14:59</h><w>orestis</w>Seems like it’s only direct use of <code>log/log</code> that breaks it; <code>log/info</code> still works.</z><z id="t1591889123" t="hindol Good thing you figured it out. These types of bugs are always difficult."><y>#</y><d>2020-06-11</d><h>15:25</h><w>hindol</w>Good thing you figured it out. These types of bugs are always difficult.</z><z id="t1591892582" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] sorry you ran into this issue. Creating an issue and will tackle tomorrow."><y>#</y><d>2020-06-11</d><h>16:23</h><w>ddeaguiar</w><a>@orestis</a> sorry you ran into this issue. Creating an issue and will tackle tomorrow.</z><z id="t1591893714" t="orestis No worries, I figured it out and have a workaround :)"><y>#</y><d>2020-06-11</d><h>16:41</h><r>orestis</r>No worries, I figured it out and have a workaround :)</z><z id="t1591892906" t="ddeaguiar https://github.com/pedestal/pedestal/issues/662"><y>#</y><d>2020-06-11</d><h>16:28</h><w>ddeaguiar</w><a href="https://github.com/pedestal/pedestal/issues/662" target="_blank">https://github.com/pedestal/pedestal/issues/662</a></z><z id="t1591928964" t="emccue How would i add an interceptor to &quot;everything&quot;"><y>#</y><d>2020-06-12</d><h>02:29</h><w>emccue</w>How would i add an interceptor to &quot;everything&quot;</z><z id="t1591929027" t="emccue I&apos;m thinking it makes sense to have my db pool as context accessible from an http request"><y>#</y><d>2020-06-12</d><h>02:30</h><w>emccue</w>I&apos;m thinking it makes sense to have my db pool as context accessible from an http request</z><z id="t1591960319" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] if you mean having an interceptor execute prior to any handler irrespective of route then you can create a common-interceptors coll and add it there. The buddy-auth sample does this to ensure the authentication interceptors are executed for each route ( https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L74-L80 )"><y>#</y><d>2020-06-12</d><h>11:11</h><w>ddeaguiar</w><a>@emccue</a> if you mean having an interceptor execute prior to any handler irrespective of route then you can create a common-interceptors coll and add it there. The buddy-auth sample does this to ensure the authentication interceptors are executed for each route (<a href="https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L74-L80" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/buddy-auth/src/buddy_auth/service.clj#L74-L80</a>)</z><z id="t1591981788" t="isak How do I know which websocket session sent the message here? https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58"><y>#</y><d>2020-06-12</d><h>17:09</h><w>isak</w>How do I know which websocket session sent the message here? <a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L58</a></z><z id="t1591981807" t="isak Seems like the callback only gets the message. Is there a way to change it?"><y>#</y><d>2020-06-12</d><h>17:10</h><w>isak</w>Seems like the callback only gets the message. Is there a way to change it?</z><z id="t1591982456" t="dvingo https://github.com/pedestal/pedestal/issues/659"><y>#</y><d>2020-06-12</d><h>17:20</h><w>dvingo</w><a href="https://github.com/pedestal/pedestal/issues/659" target="_blank">https://github.com/pedestal/pedestal/issues/659</a></z><z id="t1591982501" t="isak thanks, I was just about to make my own listener"><y>#</y><d>2020-06-12</d><h>17:21</h><w>isak</w>thanks, I was just about to make my own listener</z><z id="t1591982578" t="dvingo i was trying to find the slack logs, but looks like it&apos;s down now"><y>#</y><d>2020-06-12</d><h>17:22</h><w>dvingo</w>i was trying to find the slack logs, but looks like it&apos;s down now</z><z id="t1591982585" t="dvingo https://clojurians-log.clojureverse.org/pedestal/2020-04-06"><y>#</y><d>2020-06-12</d><h>17:23</h><w>dvingo</w><a href="https://clojurians-log.clojureverse.org/pedestal/2020-04-06" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2020-04-06</a></z><z id="t1591982590" t="dvingo https://clojurians-log.clojureverse.org/pedestal/2020-04-09"><y>#</y><d>2020-06-12</d><h>17:23</h><w>dvingo</w><a href="https://clojurians-log.clojureverse.org/pedestal/2020-04-09" target="_blank">https://clojurians-log.clojureverse.org/pedestal/2020-04-09</a></z><z id="t1591982654" t="dvingo this was the sample listener (defn ws-listener [_request _response ws-map] (proxy [WebSocketAdapter] [] (onWebSocketConnect [^Session ws-session] (proxy-super onWebSocketConnect ws-session) (when-let [f (:on-connect ws-map)] (f ws-session))) (onWebSocketClose [status-code reason] (when-let [f (:on-close ws-map)] (f (.getSession this) status-code reason))) (onWebSocketError [^Throwable e] (when-let [f (:on-error ws-map)] (f (.getSession this) e))) (onWebSocketText [^String message] (when-let [f (:on-text ws-map)] (f (.getSession this) message))) (onWebSocketBinary [^bytes payload offset length] (when-let [f (:on-binary ws-map)] (f (.getSession this) payload offset length))))) ;; in your service map: ::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths {:listener-fn ws-listener})}"><y>#</y><d>2020-06-12</d><h>17:24</h><w>dvingo</w>this was the sample listener
<pre>(defn ws-listener
  [_request _response ws-map]
  (proxy [WebSocketAdapter] []
    (onWebSocketConnect [^Session ws-session]
      (proxy-super onWebSocketConnect ws-session)
      (when-let [f (:on-connect ws-map)]
        (f ws-session)))
    (onWebSocketClose [status-code reason]
      (when-let [f (:on-close ws-map)]
        (f (.getSession this) status-code reason)))
    (onWebSocketError [^Throwable e]
      (when-let [f (:on-error ws-map)]
        (f (.getSession this) e)))
    (onWebSocketText [^String message]
      (when-let [f (:on-text ws-map)]
        (f (.getSession this) message)))
    (onWebSocketBinary [^bytes payload offset length]
      (when-let [f (:on-binary ws-map)]
        (f (.getSession this) payload offset length)))))

      ;; in your service map:
::http/container-options {:context-configurator #(ws/add-ws-endpoints % ws-paths {:listener-fn ws-listener})}</pre></z><z id="t1591982727" t="isak nice, thanks [:attrs {:href &quot;/_/_/users/U051V5LLP&quot;}]"><y>#</y><d>2020-06-12</d><h>17:25</h><w>isak</w>nice, thanks <a>@danvingo</a></z><z id="t1591982839" t="dvingo no prob, I&apos;ve been meaning to try this out too. would be great if you don&apos;t mind posting your working service setup when you have one"><y>#</y><d>2020-06-12</d><h>17:27</h><w>dvingo</w>no prob, I&apos;ve been meaning to try this out too. would be great if you don&apos;t mind posting your working service setup when you have one</z><z id="t1591982867" t="isak ok"><y>#</y><d>2020-06-12</d><h>17:27</h><w>isak</w>ok</z><z id="t1591984624" t="hindol [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] I hacked together the above sample, inspired by https://github.com/sunng87/ring-jetty9-adapter/blob/40aab6d0b91a7d7b63b9bf39e62e1f9801a02d3e/src/ring/adapter/jetty9/websocket.clj#L122 Hit me up if you cannot get it to work."><y>#</y><d>2020-06-12</d><h>17:57</h><w>hindol</w><a>@isak</a> I hacked together the above sample, inspired by <a href="https://github.com/sunng87/ring-jetty9-adapter/blob/40aab6d0b91a7d7b63b9bf39e62e1f9801a02d3e/src/ring/adapter/jetty9/websocket.clj#L122" target="_blank">https://github.com/sunng87/ring-jetty9-adapter/blob/40aab6d0b91a7d7b63b9bf39e62e1f9801a02d3e/src/ring/adapter/jetty9/websocket.clj#L122</a> Hit me up if you cannot get it to work.</z><z id="t1591984809" t="isak cool [:attrs {:href &quot;/_/_/users/UJRDALZA5&quot;}] [:attrs {:href &quot;/_/_/users/U051V5LLP&quot;}] , I just got it to work. Btw I noticed it is pretty hard to get a good reloading experience with the socket handlers, but here is one thing that works:"><y>#</y><d>2020-06-12</d><h>18:00</h><w>isak</w>cool <a>@hindol.adhya</a> <a>@danvingo</a>, I just got it to work. Btw I noticed it is pretty hard to get a good reloading experience with the socket handlers, but here is one thing that works:</z><z id="t1591984891" t="isak (I tried putting the var at a higher level, but didn&apos;t work)"><y>#</y><d>2020-06-12</d><h>18:01</h><w>isak</w>(I tried putting the var at a higher level, but didn&apos;t work)</z><z id="t1591984904" t="hindol Yeah Java code is calling into this code. Reloading should work with the right indirection in place."><y>#</y><d>2020-06-12</d><h>18:01</h><w>hindol</w>Yeah Java code is calling into this code. Reloading should work with the right indirection in place.</z><z id="t1591984929" t="lucian303 i&apos;m writing a &apos;not found&apos; interceptor to send all requests that were not fulfilled to another backend server and passes through its response to the output. all works, except for requests w/ a really large body, the body gets cut off in the output. it&apos;s complete in the request though. when i println the request i can see the entire body. but the output is truncated. i&apos;m using immutant though jetty does the same. what could be causing this? (defn send-request [request] (println request) (try (let [params {:url (str (config/env :neo-api-url) (:uri request)) :body (:body request) :method (:request-method request) :socket-timeout 10000 ;; in milliseconds :connection-timeout 1000 :headers (merge (:headers request) {:authorization (str &quot;Bearer &quot; (config/env :neo-api-token)) :accept &quot;application/vnd.ucf.v1+json&quot;})} response (client/request params)] (println response) response) (catch Exception e (timbre/warn &quot;Could not reach API server&quot; e)))) (def passthrough {:name ::passthrough :leave (fn [context] (let [request (:request context)] (assoc context :response (send-request request))))})"><y>#</y><d>2020-06-12</d><h>18:02</h><w>lucian303</w>i&apos;m writing a &apos;not found&apos; interceptor to send all requests that were not fulfilled to another backend server and passes through its response to the output. all works, except for requests w/ a really large body, the body gets cut off in the output. it&apos;s complete in the request though. when i println the request i can see the entire body. but the output is truncated. i&apos;m using immutant though jetty does the same. what could be causing this?

<pre>(defn send-request
  [request]
  (println request)
  (try
    (let [params   {:url                (str (config/env :neo-api-url) (:uri request))
                    :body               (:body request)
                    :method             (:request-method request)
                    :socket-timeout     10000 ;; in milliseconds
                    :connection-timeout 1000
                    :headers            (merge (:headers request)
                                               {:authorization (str &quot;Bearer &quot; (config/env :neo-api-token))
                                                :accept        &quot;application/vnd.ucf.v1+json&quot;})}
          response (client/request params)]
      (println response)
      response)
    (catch Exception e
      (timbre/warn &quot;Could not reach API server&quot; e))))

(def passthrough
  {:name  ::passthrough
   :leave (fn [context]
            (let [request (:request context)]
              (assoc context :response (send-request request))))})</pre></z><z id="t1591984936" t="isak right"><y>#</y><d>2020-06-12</d><h>18:02</h><w>isak</w>right</z><z id="t1591986222" t="lucian303 i think the issue is the headers coming back esp content-length. i updated the code to only take the body and put it in a new response and it&apos;s working now: (assoc context :response (response/response (:body (send-request request))))))}) "><y>#</y><d>2020-06-12</d><h>18:23</h><w>lucian303</w>i think the issue is the headers coming back esp content-length. i updated the code to only take the body and put it in a new response and it&apos;s working now:
<pre>(assoc context :response (response/response (:body (send-request request))))))})</pre>
</z><z id="t1591995089" t="lucian303 is there an interceptor or other way to define params using plumatic schema like compojure-api/reitit or some other way of declarative parameter handling? other than using the reitit router in pedestal that is"><y>#</y><d>2020-06-12</d><h>20:51</h><w>lucian303</w>is there an interceptor or other way to define params using plumatic schema like compojure-api/reitit or some other way of declarative parameter handling? other than using the reitit router in pedestal that is</z><z id="t1592136866" t="oliy Hi, have you looked at https://github.com/oliyh/pedestal-api ?"><y>#</y><d>2020-06-14</d><h>12:14</h><r>oliy</r>Hi, have you looked at <a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a> ?</z><z id="t1592241133" t="lucian303 i have briefly. wasn&apos;t sure if it was still an active project. same thing with the rook project. i will take a closer look"><y>#</y><d>2020-06-15</d><h>17:12</h><r>lucian303</r>i have briefly. wasn&apos;t sure if it was still an active project. same thing with the rook project. i will take a closer look</z><z id="t1592293467" t="oliy It&apos;s stable as in no outstanding bugs and no outstanding features. If you think it&apos;s missing anything or you find a bug just raise an issue/pr"><y>#</y><d>2020-06-16</d><h>07:44</h><r>oliy</r>It&apos;s stable as in no outstanding bugs and no outstanding features. If you think it&apos;s missing anything or you find a bug just raise an issue/pr</z><z id="t1592124275" t="Philipp Siegmantel Hello, I&apos;m new to pedestal and am trying to figure out how to serve static resources. My routes look like this (def routes #{[&quot;/static/&quot; :get [(fast-resource &quot;/static&quot;)]]}) but trying to curl a file results in a 404."><y>#</y><d>2020-06-14</d><h>08:44</h><w>Philipp Siegmantel</w>Hello, I&apos;m new to pedestal and am trying to figure out how to serve static resources. My routes look like this
<pre>(def routes #{[&quot;/static/&quot; :get [(fast-resource &quot;/static&quot;)]]})</pre>
but trying to curl a file results in a 404.</z><z id="t1592124324" t="Philipp Siegmantel The curl command looks like this: curl But other variations didn&apos;t work either."><y>#</y><d>2020-06-14</d><h>08:45</h><w>Philipp Siegmantel</w>The curl command looks like this:
<pre>curl </pre>
But other variations didn&apos;t work either.</z><z id="t1592159100" t="hindol Did you put your resources under resources/static/ ?"><y>#</y><d>2020-06-14</d><h>18:25</h><r>hindol</r>Did you put your resources under <code>resources/static/</code>?</z><z id="t1592160420" t="Philipp Siegmantel I just checked and it&apos;s in the right place."><y>#</y><d>2020-06-14</d><h>18:47</h><r>Philipp Siegmantel</r>I just checked and it&apos;s in the right place.</z><z id="t1592160533" t="hindol :: http/resource-path &quot;/public&quot;"><y>#</y><d>2020-06-14</d><h>18:48</h><r>hindol</r><b>::</b>http/resource-path     &quot;/public&quot;</z><z id="t1592160540" t="hindol This is worth trying."><y>#</y><d>2020-06-14</d><h>18:49</h><r>hindol</r>This is worth trying.</z><z id="t1592160551" t="hindol http://pedestal.io/cookbook/index"><y>#</y><d>2020-06-14</d><h>18:49</h><r>hindol</r><a href="http://pedestal.io/cookbook/index" target="_blank">http://pedestal.io/cookbook/index</a></z><z id="t1592160612" t="hindol This will not use fast-resource but will use resource middleware. The former uses Java NIO."><y>#</y><d>2020-06-14</d><h>18:50</h><r>hindol</r>This will not use fast-resource but will use resource middleware. The former uses Java NIO.</z><z id="t1592160853" t="Philipp Siegmantel thanks, I&apos;ll try that"><y>#</y><d>2020-06-14</d><h>18:54</h><r>Philipp Siegmantel</r>thanks, I&apos;ll try that</z><z id="t1592160965" t="Philipp Siegmantel It works, thanks for your help"><y>#</y><d>2020-06-14</d><h>18:56</h><r>Philipp Siegmantel</r>It works, thanks for your help</z><z id="t1592157390" t="Joe Lane [:attrs {:href &quot;/_/_/users/UQKL12TT5&quot;}] Check this pedestal sample out https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware"><y>#</y><d>2020-06-14</d><h>17:56</h><w>Joe Lane</w><a>@philipp.siegmantel</a> Check this pedestal sample out <a href="https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware</a></z><z id="t1592157432" t="Joe Lane It serves a static http form."><y>#</y><d>2020-06-14</d><h>17:57</h><w>Joe Lane</w>It serves a static http form.</z><z id="t1592159938" t="Philipp Siegmantel [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] Thank you, but I don&apos;t think that the example covers what I am trying to do. I didn&apos;t specify it in detail, so let&apos;s just do it know. I simply want to serve xml, audio and video files. fast-resource seems to be exactly what I want, but I can&apos;t seem to get it to work."><y>#</y><d>2020-06-14</d><h>18:38</h><w>Philipp Siegmantel</w><a>@lanejo01</a> Thank you, but I don&apos;t think that the example covers what I am trying to do. I didn&apos;t specify it in detail, so let&apos;s just do it know. I simply want to serve xml, audio and video files. <code>fast-resource</code> seems to be exactly what I want, but I can&apos;t seem to get it to work.</z><z id="t1592180836" t="asilverman Any chance pedestal would consider exposing a prometheus JettyStatisticsCollector so that we can collect jetty metrics for pedestal applications ?"><y>#</y><d>2020-06-15</d><h>00:27</h><w>asilverman</w>Any chance pedestal would consider exposing a prometheus <code>JettyStatisticsCollector</code>  so that we can collect jetty metrics for pedestal applications ?</z><z id="t1592248160" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UCZG1NMG9&quot;}] I’d like to avoid introducing additional dependencies to core Pedestal but consider it desirable that it play nice with other capabilities provided by service implementers. That being said, I’m not familiar with the details around JettyStatisticsCollector . If you feel this is important than feel free to create an issue for it so it can be vetted further!"><y>#</y><d>2020-06-15</d><h>19:09</h><r>ddeaguiar</r><a>@UCZG1NMG9</a> I’d like to avoid introducing additional dependencies to core Pedestal but consider it desirable that it play nice with other capabilities provided by service implementers. That being said, I’m not familiar with the details around <code>JettyStatisticsCollector</code> . If you feel this is important than feel free to create an issue for it so it can be vetted further!</z><z id="t1592331740" t="frankitox Hi! There&apos;s a Pedestal interceptor to reload files on save? (The way there&apos;s wrap-reload in ring)"><y>#</y><d>2020-06-16</d><h>18:22</h><w>frankitox</w>Hi! There&apos;s a Pedestal interceptor to reload files on save? (The way there&apos;s <code>wrap-reload</code> in ring)</z><z id="t1592332444" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3UFFB420&quot;}] I think the pedestal.service-tools lib will give you what you are looking for: http://pedestal.io/api/pedestal.service-tools/io.pedestal.service-tools.dev.html"><y>#</y><d>2020-06-16</d><h>18:34</h><w>ddeaguiar</w><a>@franquito</a> I think the <code>pedestal.service-tools</code> lib will give you what you are looking for: <a href="http://pedestal.io/api/pedestal.service-tools/io.pedestal.service-tools.dev.html" target="_blank">http://pedestal.io/api/pedestal.service-tools/io.pedestal.service-tools.dev.html</a></z><z id="t1592332573" t="frankitox Yes! Exactly what I was looking for, thanks!"><y>#</y><d>2020-06-16</d><h>18:36</h><w>frankitox</w>Yes! Exactly what I was looking for, thanks!</z><z id="t1592417697" t="ccann Is there a way to change the way the logged map is formatted with io.pedestal.log ?"><y>#</y><d>2020-06-17</d><h>18:14</h><w>ccann</w>Is there a way to change the way the logged map is formatted with <code>io.pedestal.log</code>?</z><z id="t1592418306" t="ddeaguiar The formatter can be specified through the key io.pedestal.log/formatter which should be &gt; A single-arg function that when given a map, returns a String for logging, defaults to pr-str You can always create your own logging macros based on the io.pedestal.log/log fn if you desire more control over logging but that won’t change the format of messages logged by Pedestal’s internals"><y>#</y><d>2020-06-17</d><h>18:25</h><r>ddeaguiar</r>The formatter can be specified through the key <code>io.pedestal.log/formatter</code> which should be

&gt;  A single-arg function that when given a map, returns a String for logging, defaults to <code>pr-str</code>
You can always create your own logging macros based on the <code>io.pedestal.log/log</code> fn if you desire more control over logging but that won’t change the format of messages logged by Pedestal’s internals</z><z id="t1592419299" t="ccann got it thanks"><y>#</y><d>2020-06-17</d><h>18:41</h><r>ccann</r>got it thanks</z><z id="t1592421037" t="ccann I’m probably making a stupid mistake, buy my macros don’t work because io.pedestal.log/log throws an NPE when it calls (and override-logger (override-logger logger-name))"><y>#</y><d>2020-06-17</d><h>19:10</h><r>ccann</r>I’m probably making a stupid mistake, buy my macros don’t work because io.pedestal.log/log throws an NPE when it calls <code>(and override-logger (override-logger logger-name))</code></z><z id="t1592421047" t="ccann I just want to use the SLF4J logger"><y>#</y><d>2020-06-17</d><h>19:10</h><r>ccann</r>I just want to use the SLF4J logger</z><z id="t1592421068" t="ccann e.g. (defmacro info [&amp; keyvals] (let [log-map (-&gt; (apply array-map keyvals) (assoc ::log/formatter formatter))] `(log/log ~log-map :info)))"><y>#</y><d>2020-06-17</d><h>19:11</h><r>ccann</r>e.g.
<pre>(defmacro info [&amp; keyvals]
  (let [log-map (-&gt; (apply array-map keyvals)
                    (assoc ::log/formatter formatter))]
    `(log/log ~log-map :info)))</pre></z><z id="t1592421348" t="ddeaguiar ah crud, yes. There’s an issue open for this https://github.com/pedestal/pedestal/issues/662 . The fix is already on master but a new release has not been cut"><y>#</y><d>2020-06-17</d><h>19:15</h><r>ddeaguiar</r>ah crud, yes. There’s an issue open for this <a href="https://github.com/pedestal/pedestal/issues/662" target="_blank">https://github.com/pedestal/pedestal/issues/662</a>. The fix is already on <code>master</code> but a new release has not been cut</z><z id="t1592421418" t="ddeaguiar You can either create an override-logger which essentially does (LoggerFactory/getLogger logger-name) or drop back to Pedestal version 0.5.7"><y>#</y><d>2020-06-17</d><h>19:16</h><r>ddeaguiar</r>You can either create an override-logger which essentially does <code>(LoggerFactory/getLogger logger-name)</code> or drop back to Pedestal version <code>0.5.7</code></z><z id="t1592421422" t="ddeaguiar Sorry about that 😕"><y>#</y><d>2020-06-17</d><h>19:17</h><r>ddeaguiar</r>Sorry about that <b>😕</b></z><z id="t1592422852" t="ccann ah no worries, thanks so much for the help. dropping to 0.5.7 did what I wanted"><y>#</y><d>2020-06-17</d><h>19:40</h><r>ccann</r>ah no worries, thanks so much for the help. dropping to 0.5.7 did what I wanted</z><z id="t1592426083" t="jackson It is possible to have a route that differs by scheme only? http://**/path/ and ws://*/path/ for example.* "><y>#</y><d>2020-06-17</d><h>20:34</h><w>jackson</w>It is possible to have a route that differs by scheme only? <code>http://**/path/</code> and <code>ws://*/path/</code> for example.* </z><z id="t1592426520" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UJ64540VC&quot;}] generally yes, see http://pedestal.io/reference/routing-quick-reference . Although for your specific example, the ws scheme pertains to WebSockets and that’s resolved at a higher level by the hosting container"><y>#</y><d>2020-06-17</d><h>20:42</h><w>ddeaguiar</w><a>@jackson.reynolds</a> generally yes, see <a href="http://pedestal.io/reference/routing-quick-reference" target="_blank">http://pedestal.io/reference/routing-quick-reference</a>. Although for your specific example, the <code>ws</code> scheme pertains to WebSockets and that’s resolved at a higher level by the hosting container</z><z id="t1592426622" t="jackson I tried specifying the scheme specifically for http but as soon as I add the ws path back in I’m getting a 405 for the http endpoint. "><y>#</y><d>2020-06-17</d><h>20:43</h><w>jackson</w>I tried specifying the scheme specifically for http but as soon as I add the ws path back in I’m getting a 405 for the http endpoint. </z><z id="t1592426923" t="jackson Just for clarity, I can have either the http or the ws endpoint working, but only one or the other and I can’t seem to get both working at the same time. Interestingly, I had this working when I was using POST for the http endpoint, but switching to GET seems to have caused the issue."><y>#</y><d>2020-06-17</d><h>20:48</h><r>jackson</r>Just for clarity, I can have either the http or the ws endpoint working, but only one or the other and I can’t seem to get both working at the same time. Interestingly, I had this working when I was using POST for the http endpoint, but switching to GET seems to have caused the issue.</z><z id="t1592427017" t="ddeaguiar If you’re using WebSockets, use the facilities provided by the container you are deploying to. For example, if using Jetty, refer to https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj"><y>#</y><d>2020-06-17</d><h>20:50</h><w>ddeaguiar</w>If you’re using WebSockets, use the facilities provided by the container you are deploying to. For example, if using Jetty, refer to <a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj</a></z><z id="t1592427101" t="ddeaguiar Check out the Jetty Websockets sample: https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L87"><y>#</y><d>2020-06-17</d><h>20:51</h><w>ddeaguiar</w>Check out the Jetty Websockets sample: <a href="https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L87" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L87</a></z><z id="t1592427266" t="jackson Yes, that’s what I have working for websockets. So when I configure the http path as a POST it works, when I configure it as a GET it doesn’t. There’s also a trailing ‘/’ at the end of the url, but I’m not sure how that could affect things."><y>#</y><d>2020-06-17</d><h>20:54</h><w>jackson</w>Yes, that’s what I have working for websockets. So when I configure the http path as a POST it works, when I configure it as a GET it doesn’t. There’s also a trailing ‘/’ at the end of the url, but I’m not sure how that could affect things.</z><z id="t1592427930" t="ddeaguiar It’s not possible to share paths between ws and http(s) schemes. Separate servlets are added per ws path."><y>#</y><d>2020-06-17</d><h>21:05</h><w>ddeaguiar</w>It’s not possible to share paths between <code>ws</code> and <code>http(s)</code> schemes. Separate servlets are added per <code>ws</code> path.</z><z id="t1592428997" t="jackson Hmm ok. I’ll keep looking for a workaround. "><y>#</y><d>2020-06-17</d><h>21:23</h><w>jackson</w>Hmm ok. I’ll keep looking for a workaround. </z><z id="t1592595217" t="lucian303 i&apos;m trying to add cors headers through the pedestal config. i set ::http/allowed-origins [&quot;*&quot;] but the header i get back is blank: Access-Control-Allow-Origin: and there is no Access-Control-Allow-Methods: header. even if i force &quot;*&quot; for that header, it still gets stripped out. is this something i need a custom interceptor for?"><y>#</y><d>2020-06-19</d><h>19:33</h><w>lucian303</w>i&apos;m trying to add cors headers through the pedestal config. i set <code>::http/allowed-origins [&quot;*&quot;]</code> but the header i get back is blank: <code>Access-Control-Allow-Origin:</code> and there is no Access-Control-Allow-Methods: header. even if i force &quot;*&quot; for that header, it still gets stripped out. is this something i need a custom interceptor for?</z><z id="t1592595647" t="dvingo your usage sounds correct to me - I would just double check what the final service config looks like when you start the server. Maybe try copying your service config to a new app template and see if that works also"><y>#</y><d>2020-06-19</d><h>19:40</h><w>dvingo</w>your usage sounds correct to me - I would just double check what the final service config looks like when you start the server. Maybe try copying your service config to a new app template and see if that works also</z><z id="t1592595799" t="lucian303 minus the routes, it looks like this: {:env :prod, :io.pedestal.http/not-found-interceptor {:name :neo.common.http.passthrough/passthrough, :leave #object[neo.common.http.passthrough$fn__36795 0x6ba197f9 &quot;neo.common.http.passthrough$fn__36795@6ba197f9&quot;]}, :io.pedestal.http/routes #{...}, :io.pedestal.http/allowed-origins [&quot;*&quot;], :io.pedestal.http/type :jetty, :io.pedestal.http/container-options {:h2c? true, :h2? false, :ssl? false}, :io.pedestal.http/host &quot;0.0.0.0&quot;, :io.pedestal.http/port 8080} i will try it in a new template"><y>#</y><d>2020-06-19</d><h>19:43</h><w>lucian303</w>minus the routes, it looks like this:
<pre>{:env :prod,
 :io.pedestal.http/not-found-interceptor {:name :neo.common.http.passthrough/passthrough,
                                          :leave #object[neo.common.http.passthrough$fn__36795
                                                         0x6ba197f9
                                                         &quot;neo.common.http.passthrough$fn__36795@6ba197f9&quot;]},
 :io.pedestal.http/routes #{...},
 :io.pedestal.http/allowed-origins [&quot;*&quot;],
 :io.pedestal.http/type :jetty,
 :io.pedestal.http/container-options {:h2c? true, :h2? false, :ssl? false},
 :io.pedestal.http/host &quot;0.0.0.0&quot;,
 :io.pedestal.http/port 8080}</pre>
i will try it in a new template</z><z id="t1592596094" t="lucian303 in the template, i get no cors headers at all w/ that setting on or off"><y>#</y><d>2020-06-19</d><h>19:48</h><w>lucian303</w>in the template, i get no cors headers at all w/ that setting on or off</z><z id="t1592596881" t="dvingo interesting I&apos;m seeing the headers not show up as well with &apos;*&apos;. digging into the implementation it looks like the origin check is using set membership: https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L57"><y>#</y><d>2020-06-19</d><h>20:01</h><w>dvingo</w>interesting I&apos;m seeing the headers not show up as well with &apos;*&apos;.
digging into the implementation it looks like the origin check is using set membership:
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L57" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L57</a></z><z id="t1592596889" t="dvingo so the * won&apos;t work here"><y>#</y><d>2020-06-19</d><h>20:01</h><w>dvingo</w>so the * won&apos;t work here</z><z id="t1592597030" t="lucian303 i c. good to know. i opened up a ticket for this https://github.com/pedestal/pedestal/issues/664"><y>#</y><d>2020-06-19</d><h>20:03</h><w>lucian303</w>i c. good to know. i opened up a ticket for this <a href="https://github.com/pedestal/pedestal/issues/664" target="_blank">https://github.com/pedestal/pedestal/issues/664</a></z><z id="t1592597034" t="dvingo ::http/allowed-origins {:creds true :allowed-origins (constantly true)}}) "><y>#</y><d>2020-06-19</d><h>20:03</h><w>dvingo</w><pre>::http/allowed-origins {:creds true :allowed-origins (constantly true)}})</pre>
</z><z id="t1592597049" t="dvingo that should effectively be the same as &quot;*&quot;"><y>#</y><d>2020-06-19</d><h>20:04</h><w>dvingo</w>that should effectively be the same as &quot;*&quot;</z><z id="t1592597213" t="lucian303 that gives me an error unfortunately: #error{:cause &quot;class java.lang.Long cannot be cast to class clojure.lang.IPersistentCollection (java.lang.Long is in module java.base of loader &apos;bootstrap&apos;; clojure.lang.IPersistentCollection is in unnamed module of loader &apos;app&apos;)&quot;,"><y>#</y><d>2020-06-19</d><h>20:06</h><w>lucian303</w>that gives me an error unfortunately: <code>#error{:cause &quot;class java.lang.Long cannot be cast to class clojure.lang.IPersistentCollection (java.lang.Long is in module java.base of loader &apos;bootstrap&apos;; clojure.lang.IPersistentCollection is in unnamed module of loader &apos;app&apos;)&quot;,</code></z><z id="t1592597562" t="dvingo seems like that is caused by something else. Here&apos;s a full example: https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L27"><y>#</y><d>2020-06-19</d><h>20:12</h><w>dvingo</w>seems like that is caused by something else. Here&apos;s a full example:
<a href="https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L27" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/cors/src/cors/server.clj#L27</a></z><z id="t1592598085" t="lucian303 i&apos;m getting the error running normally also, so it&apos;s not just the run-dev"><y>#</y><d>2020-06-19</d><h>20:21</h><w>lucian303</w>i&apos;m getting the error running normally also, so it&apos;s not just the run-dev</z><z id="t1592598098" t="lucian303 unfortunately, removing that line from my run dev ends up w/ everything responding w/ a 403"><y>#</y><d>2020-06-19</d><h>20:21</h><w>lucian303</w>unfortunately, removing that line from my run dev ends up w/ everything responding w/ a 403</z><z id="t1592618897" t="polymeris Want to output JSON instead of edn form pedestal.log... is there a way to globally override :io.pedestal.log/formatter ?"><y>#</y><d>2020-06-20</d><h>02:08</h><w>polymeris</w>Want to output JSON instead of edn form pedestal.log... is there a way to globally override <code>:io.pedestal.log/formatter</code>?</z><z id="t1592618918" t="polymeris I&apos;ve created wrapper macros, but that doesn&apos;t seem very nice: (def formatter json/encode) (defmacro trace [&amp; keyvals] `(pedestal-log/trace ::pedestal-log/formatter formatter ~@keyvals)) (defmacro debug [&amp; keyvals] `(pedestal-log/debug ::pedestal-log/formatter formatter ~@keyvals)) (defmacro info [&amp; keyvals] `(pedestal-log/info ::pedestal-log/formatter formatter ~@keyvals)) (defmacro warn [&amp; keyvals] `(pedestal-log/warn ::pedestal-log/formatter formatter ~@keyvals)) (defmacro error [&amp; keyvals] `(pedestal-log/error ::pedestal-log/formatter formatter ~@keyvals))"><y>#</y><d>2020-06-20</d><h>02:08</h><r>polymeris</r>I&apos;ve created wrapper macros, but that doesn&apos;t seem very nice:
<pre>(def formatter json/encode)

(defmacro trace [&amp; keyvals] `(pedestal-log/trace ::pedestal-log/formatter formatter ~@keyvals))
(defmacro debug [&amp; keyvals] `(pedestal-log/debug ::pedestal-log/formatter formatter ~@keyvals))
(defmacro info [&amp; keyvals] `(pedestal-log/info ::pedestal-log/formatter formatter ~@keyvals))
(defmacro warn [&amp; keyvals] `(pedestal-log/warn ::pedestal-log/formatter formatter ~@keyvals))
(defmacro error [&amp; keyvals] `(pedestal-log/error ::pedestal-log/formatter formatter ~@keyvals))</pre></z><z id="t1592656747" t="souenzzo I&apos;m also looking for this feature. [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] a PR with a property -Dio.pedestal.log.formatter=my-custom-json/encoder would be welcome?"><y>#</y><d>2020-06-20</d><h>12:39</h><r>souenzzo</r>I&apos;m also looking for this feature.
<a>@ddeaguiar</a> a PR with a property <code>-Dio.pedestal.log.formatter=my-custom-json/encoder</code> would be welcome?</z><z id="t1592942392" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] It’s worth considering. Perhaps open an issue capturing the desire?"><y>#</y><d>2020-06-23</d><h>19:59</h><r>ddeaguiar</r><a>@U2J4FRT2T</a> It’s worth considering. Perhaps open an issue capturing the desire?</z><z id="t1593047912" t="souenzzo https://github.com/pedestal/pedestal/issues/666"><y>#</y><d>2020-06-25</d><h>01:18</h><r>souenzzo</r><a href="https://github.com/pedestal/pedestal/issues/666" target="_blank">https://github.com/pedestal/pedestal/issues/666</a></z><z id="t1593047990" t="souenzzo if you like the idea i can create a PR"><y>#</y><d>2020-06-25</d><h>01:19</h><r>souenzzo</r>if you like the idea i can create a PR</z><z id="t1593103433" t="ddeaguiar Thanks, will look into it further tomorrow"><y>#</y><d>2020-06-25</d><h>16:43</h><r>ddeaguiar</r>Thanks, will look into it further tomorrow</z><z id="t1593186389" t="polymeris Thanks, [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] !"><y>#</y><d>2020-06-26</d><h>15:46</h><r>polymeris</r>Thanks, <a>@U2J4FRT2T</a>!</z><z id="t1592656747" t="souenzzo I&apos;m also looking for this feature. [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] a PR with a property -Dio.pedestal.log.formatter=my-custom-json/encoder would be welcome?"><y>#</y><d>2020-06-20</d><h>12:39</h><w>souenzzo</w>I&apos;m also looking for this feature.
<a>@ddeaguiar</a> a PR with a property <code>-Dio.pedestal.log.formatter=my-custom-json/encoder</code> would be welcome?</z><z id="t1592828970" t="Ivar Refsdal Hi. I tried to create a simple async route, returning a channel for :body : (defn respond-async [request] (let [c (async/chan)] (async/go-loop [[x &amp; xs] (range 10)] (println &quot;putting value...&quot; x) (async/&gt;! c x) (if xs (recur xs) (async/close! c))) {:status 200 :body c})) This causes the following error message: No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: clojure.core.async.impl.channels.ManyToManyChannel Am I going about this the wrong way? Or did I miss something else? Edit: I&apos;d like the response to be a (json/edn) array of [0 1 2 ... 9] . Full code and stacktrace here: https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0 Thanks and kind regards."><y>#</y><d>2020-06-22</d><h>12:29</h><w>Ivar Refsdal</w>Hi.

I tried to create a simple async route, returning a channel for <code>:body</code>:

<pre>(defn respond-async [request]
  (let [c (async/chan)]
    (async/go-loop [[x &amp; xs] (range 10)]
      (println &quot;putting value...&quot; x)
      (async/&gt;! c x)
      (if xs
        (recur xs)
        (async/close! c)))
    {:status 200
     :body   c}))</pre>
This causes the following error message:
<code>No implementation of method: :default-content-type of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: clojure.core.async.impl.channels.ManyToManyChannel</code>

Am I going about this the wrong way? Or did I miss something else?

Edit: I&apos;d like the response to be a (json/edn) array of <code>[0 1 2 ... 9]</code>.

Full code and stacktrace here:
<a href="https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0" target="_blank">https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0</a>

Thanks and kind regards.</z><z id="t1592829760" t="souenzzo [:attrs {:href &quot;/_/_/users/UGJE0MM0W&quot;}] without much attention to your async logic, pedestal.chain expect that context may be async, not the [:response :body] So you will need something like that: (def respond-async {:name ::respond-async :enter (fn [{:keys [request] :as ctx}] (let [c (async/chan)] (async/go-loop [[x &amp; xs] (range 10)] (println &quot;putting value...&quot; x) (async/&gt;! c x) (if xs (recur xs) (async/close! c))) (async/go (assoc ctx :response {:status 200 :body (async/&lt;! c)}))))})"><y>#</y><d>2020-06-22</d><h>12:42</h><w>souenzzo</w><a>@ivar.refsdal</a> without much attention to your <code>async</code> logic, <code>pedestal.chain</code> expect that <code>context</code> may be async, not the <code>[:response :body]</code>

So you will need something like that:
<pre>(def respond-async
  {:name  ::respond-async
   :enter (fn [{:keys [request] :as ctx}]
            (let [c (async/chan)]
              (async/go-loop [[x &amp; xs] (range 10)]
                (println &quot;putting value...&quot; x)
                (async/&gt;! c x)
                (if xs
                  (recur xs)
                  (async/close! c)))
              (async/go
                (assoc ctx :response {:status 200
                                      :body   (async/&lt;! c)}))))})</pre></z><z id="t1592830429" t="Ivar Refsdal Thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] That works, but only for a single value."><y>#</y><d>2020-06-22</d><h>12:53</h><w>Ivar Refsdal</w>Thanks <a>@souenzzo</a>
That works, but only for a single value.</z><z id="t1592830613" t="souenzzo Now it&apos;s more about #core-async then pedestal (def respond-async {:name ::respond-async :enter (fn [{:keys [request] :as ctx}] (let [c (async/chan)] (async/go-loop [[x &amp; xs] (range 10)] (println &quot;putting value...&quot; x) (async/&gt;! c x) (if xs (recur xs) (async/close! c))) (async/go (assoc ctx :response {:status 200 :body (async/&lt;! (async/into [] c))}))))}) =&gt; #&apos;user/respond-async (async/&lt;!! ((:enter respond-async) {})) putting value... 0 putting value... 1 putting value... 2 putting value... 3 putting value... 4 putting value... 5 putting value... 6 putting value... 7 putting value... 8 putting value... 9 =&gt; {:response {:status 200, :body [0 1 2 3 4 5 6 7 8 9]}} It works"><y>#</y><d>2020-06-22</d><h>12:56</h><r>souenzzo</r>Now it&apos;s more about #core-async then pedestal
<pre>(def respond-async
  {:name  ::respond-async
   :enter (fn [{:keys [request] :as ctx}]
            (let [c (async/chan)]
              (async/go-loop [[x &amp; xs] (range 10)]
                (println &quot;putting value...&quot; x)
                (async/&gt;! c x)
                (if xs
                  (recur xs)
                  (async/close! c)))
              (async/go
                (assoc ctx :response {:status 200
                                      :body   (async/&lt;! (async/into [] c))}))))})


=&gt; #&apos;user/respond-async
(async/&lt;!! ((:enter respond-async) {}))
putting value... 0
putting value... 1
putting value... 2
putting value... 3
putting value... 4
putting value... 5
putting value... 6
putting value... 7
putting value... 8
putting value... 9
=&gt; {:response {:status 200, :body [0 1 2 3 4 5 6 7 8 9]}}</pre>
It works</z><z id="t1592830677" t="souenzzo It&apos;s more idiomatic in pedestal turn &quot;[1 2 3]&quot; into json in another interceptor [&quot;/async-seq&quot; :get [body-&gt;json respond-async] :route-name ::async-seq] Where body-&gt;json is something like :leave (fn [ctx] (update-in ctx [:response :body] json/to-string))"><y>#</y><d>2020-06-22</d><h>12:57</h><r>souenzzo</r>It&apos;s more idiomatic in pedestal turn &quot;[1 2 3]&quot; into json in another interceptor
<pre>[&quot;/async-seq&quot;
 :get
 [body-&gt;json 
  respond-async]
 :route-name ::async-seq]</pre>
Where body-&gt;json is something like <code>:leave (fn [ctx] (update-in ctx [:response :body] json/to-string))</code></z><z id="t1592831094" t="Ivar Refsdal The reason I&apos;m (trying) to use async is that I don&apos;t want all of the data to stay in memory at once. async/into and such will do that, no?"><y>#</y><d>2020-06-22</d><h>13:04</h><r>Ivar Refsdal</r>The reason I&apos;m (trying) to use async is that I don&apos;t want all of the data to stay in memory at once.
async/into and such will do that, no?</z><z id="t1592831683" t="Ivar Refsdal The following does (almost) what I want: (def respond-async {:name ::respond-async :enter (fn [{:keys [request] :as ctx}] (let [c (async/chan)] (async/go-loop [[x &amp; xs] (range 1e5)] (println &quot;putting value...&quot; x) (when (async/&gt;! c (str x)) (if xs (recur xs) (async/close! c)))) (assoc ctx :response {:status 200 :body (fn [^ServletOutputStream sout] (async/&lt;!! ; this makes it work, but makes async pointless (async/go-loop [v (async/&lt;! c)] (if v (do (.println sout (str v)) (recur (async/&lt;! c))) (do (println &quot;closing!&quot;) (.close sout))))))})))})"><y>#</y><d>2020-06-22</d><h>13:14</h><r>Ivar Refsdal</r>The following does (almost) what I want:
<pre>(def respond-async
  {:name  ::respond-async
   :enter (fn [{:keys [request] :as ctx}]
            (let [c (async/chan)]
              (async/go-loop [[x &amp; xs] (range 1e5)]
                (println &quot;putting value...&quot; x)
                (when (async/&gt;! c (str x))
                  (if xs
                    (recur xs)
                    (async/close! c))))
              (assoc ctx :response {:status 200
                                    :body   (fn [^ServletOutputStream sout]
                                              (async/&lt;!! ; this makes it work, but makes async pointless
                                                (async/go-loop [v (async/&lt;! c)]
                                                  (if v
                                                    (do (.println sout (str v))
                                                        (recur (async/&lt;! c)))
                                                    (do (println &quot;closing!&quot;)
                                                        (.close sout))))))})))})</pre></z><z id="t1592831726" t="Ivar Refsdal That is: I&apos;m not keeping all of the data in memory. Edit: It works/starts for for example (range 1e9)"><y>#</y><d>2020-06-22</d><h>13:15</h><r>Ivar Refsdal</r>That is: I&apos;m not keeping all of the data in memory.
Edit: It works/starts for for example <code>(range 1e9)</code></z><z id="t1592831755" t="Ivar Refsdal I figured that pedestal could/would do something like this out of the box"><y>#</y><d>2020-06-22</d><h>13:15</h><r>Ivar Refsdal</r>I figured that pedestal could/would do something like this out of the box</z><z id="t1592832259" t="souenzzo https://gist.github.com/stathissideris/8659706 If you need to &quot;stream&quot; a thing that not fit in memory, you may need that lazyasyncseq thing + write direct to body (defn handler [req] (let [lazy-sequence (range 1eHUGE)] {:status 200 :body (fn [w] (json/write lazy-sequence w))}))"><y>#</y><d>2020-06-22</d><h>13:24</h><r>souenzzo</r><a href="https://gist.github.com/stathissideris/8659706" target="_blank">https://gist.github.com/stathissideris/8659706</a>
If you need to &quot;stream&quot; a thing that not fit in memory, you may need that <code>lazyasyncseq</code> thing + write direct to body

(defn handler
  [req]
  (let [lazy-sequence (range 1eHUGE)]
    {:status 200
     :body (fn [w]
             (json/write lazy-sequence w))}))</z><z id="t1592832271" t="souenzzo AKA: you may not need async, just lazyness"><y>#</y><d>2020-06-22</d><h>13:24</h><r>souenzzo</r>AKA: you may not need async, just lazyness</z><z id="t1592838195" t="Ivar Refsdal Thanks again [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ! Can the lazyseq approach block while writing? If the writer is full or the consumer cannot keep up? This was the reason I wanted to go for an async solution: I thought that pedestal would check the underlying stream for me and juggle the writing to client and reading from my chan."><y>#</y><d>2020-06-22</d><h>15:03</h><r>Ivar Refsdal</r>Thanks again <a>@souenzzo</a>!

Can the lazyseq approach block while writing? If the writer is full or the consumer cannot keep up?
This was the reason I wanted to go for an async solution: I thought that pedestal would check the underlying stream for me and juggle the writing to client and reading from my chan.</z><z id="t1592838579" t="souenzzo write is a blocking operation. yes, you can &quot;block waiting&quot; + &quot;block writing&quot; Something like (defn write-json-array-from-channel [^Writer w c] (.write w &quot;[&quot;) (loop [] (when-let [v (async/&lt;!! c)] (json/write v w) (.write &quot;, &quot;) (recur))) (.write w &quot;]&quot;) ;; I don&apos;t know much about `flush` / `close` but i think that ;; you should do something after &quot;finish&quot; write. (.flush w) (.close w)) Probably there is already some json library that works/support core.async channels (AKA you don&apos;t need to write this function))"><y>#</y><d>2020-06-22</d><h>15:09</h><r>souenzzo</r>write is a blocking operation. yes, you can &quot;block waiting&quot; + &quot;block writing&quot;
Something like
<pre>(defn write-json-array-from-channel
  [^Writer w c]
  (.write w &quot;[&quot;)
  (loop []
    (when-let [v (async/&lt;!! c)]
      (json/write v w)
      (.write &quot;, &quot;)
      (recur)))
  (.write w &quot;]&quot;)
  ;; I don&apos;t know much about `flush` / `close` but i think that 
  ;; you should do something after &quot;finish&quot; write.
  (.flush w)
  (.close w))</pre>
Probably there is already some <code>json</code> library that works/support core.async channels (AKA you don&apos;t need to write this function))</z><z id="t1592838736" t="Ivar Refsdal Right... But I think this defeats the purpose of using async in the first place? That is: this code uses async/&lt;!! and that may block the thread"><y>#</y><d>2020-06-22</d><h>15:12</h><r>Ivar Refsdal</r>Right... But I think this defeats the purpose of using async in the first place?
That is: this code uses async/&lt;!! and that may block the thread</z><z id="t1592838981" t="Ivar Refsdal I see that javax.servlet.ServletOutputStream has setWriteListener : /** * Instructs the &lt;code&gt;ServletOutputStream&lt;/code&gt; to invoke the provided * {@link WriteListener} when it is possible to write * * * @param writeListener the {@link WriteListener} that should be notified * when it&apos;s possible to write * * @exception IllegalStateException if one of the following conditions is true * &lt;ul&gt; * &lt;li&gt;the associated request is neither upgraded nor the async started * &lt;li&gt;setWriteListener is called more than once within the scope of the same request. * &lt;/ul&gt; * * @throws NullPointerException if writeListener is null * * @since Servlet 3.1 */ public abstract void setWriteListener(WriteListener writeListener);"><y>#</y><d>2020-06-22</d><h>15:16</h><r>Ivar Refsdal</r>I see that <code>javax.servlet.ServletOutputStream</code> has <code>setWriteListener</code>:

<pre>/**
     * Instructs the &lt;code&gt;ServletOutputStream&lt;/code&gt; to invoke the provided
     * {@link WriteListener} when it is possible to write
     *
     *
     * @param writeListener the {@link WriteListener} that should be notified
     *  when it&apos;s possible to write
     *
     * @exception IllegalStateException if one of the following conditions is true
     * &lt;ul&gt;
     * &lt;li&gt;the associated request is neither upgraded nor the async started
     * &lt;li&gt;setWriteListener is called more than once within the scope of the same request.
     * &lt;/ul&gt;
     *
     * @throws NullPointerException if writeListener is null
     *
     * @since Servlet 3.1
     */
    public abstract void setWriteListener(WriteListener writeListener);</pre></z><z id="t1592839053" t="Ivar Refsdal I think that would be the correct approach to use. But that method is only called for immutant/undertow in pedestal as far as I can see: https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/immutant/src/io/pedestal/http/immutant/container.clj#L54"><y>#</y><d>2020-06-22</d><h>15:17</h><r>Ivar Refsdal</r>I think that would be the correct approach to use.
But that method is only called for immutant/undertow in pedestal as far as I can see:
<a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/immutant/src/io/pedestal/http/immutant/container.clj#L54" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/immutant/src/io/pedestal/http/immutant/container.clj#L54</a></z><z id="t1592839183" t="Ivar Refsdal It&apos;s my first time looking at async in pedestal, so apologies if I&apos;m totally off."><y>#</y><d>2020-06-22</d><h>15:19</h><r>Ivar Refsdal</r>It&apos;s my first time looking at async in pedestal, so apologies if I&apos;m totally off.</z><z id="t1592839348" t="souenzzo now you are way beyond what i know 🙂"><y>#</y><d>2020-06-22</d><h>15:22</h><r>souenzzo</r>now you are way beyond what i know <b>🙂</b></z><z id="t1592839568" t="Ivar Refsdal Thanks for the input, I would not have made it without it :-) Seems the &quot;perfect&quot; way is not available in pedestal yet though (as far as I can tell)."><y>#</y><d>2020-06-22</d><h>15:26</h><r>Ivar Refsdal</r>Thanks for the input, I would not have made it without it :-)
Seems the &quot;perfect&quot; way is not available in pedestal yet though (as far as I can tell).</z><z id="t1592839907" t="Ivar Refsdal I may poke further at it tomorrow"><y>#</y><d>2020-06-22</d><h>15:31</h><r>Ivar Refsdal</r>I may poke further at it tomorrow</z><z id="t1592840491" t="souenzzo Pedestal will make the simple case simple And will allow you to tweak/develop your complex case If your handler returns a simple HTML string, that done if your handler need to lazylly write in a specific format where the data comes from X Y Z, you can access the internals need to implement that."><y>#</y><d>2020-06-22</d><h>15:41</h><r>souenzzo</r>Pedestal will make the simple case simple
And will allow you to tweak/develop your complex case
If your handler returns a simple HTML string, that done
if your handler need to lazylly write in a specific format where the data comes from X Y Z, you can access the internals need to implement that.</z><z id="t1592840507" t="souenzzo also take a look at &quot;examples&quot; directory in pedestal src 🙂"><y>#</y><d>2020-06-22</d><h>15:41</h><r>souenzzo</r>also take a look at &quot;examples&quot; directory in pedestal src <b>🙂</b></z><z id="t1592899668" t="Ivar Refsdal Thanks!"><y>#</y><d>2020-06-23</d><h>08:07</h><r>Ivar Refsdal</r>Thanks!</z><z id="t1592902644" t="Ivar Refsdal I didn&apos;t find an async example in the &quot;samples&quot; directory that does a similar thing like the code above. The closest thing was a server-side-event server."><y>#</y><d>2020-06-23</d><h>08:57</h><r>Ivar Refsdal</r>I didn&apos;t find an async example in the &quot;samples&quot; directory that does a similar thing like the code above.
The closest thing was a server-side-event server.</z><z id="t1592912204" t="Ivar Refsdal I opened an issue for this: https://github.com/pedestal/pedestal/issues/665"><y>#</y><d>2020-06-23</d><h>11:36</h><r>Ivar Refsdal</r>I opened an issue for this:
<a href="https://github.com/pedestal/pedestal/issues/665" target="_blank">https://github.com/pedestal/pedestal/issues/665</a></z><z id="t1593507021" t="Ivar Refsdal Hi again [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] If you are interested the following code solved the use case: https://github.com/pedestal/pedestal/issues/665#issuecomment-651652532 It&apos;s not perfect, but it works."><y>#</y><d>2020-06-30</d><h>08:50</h><r>Ivar Refsdal</r>Hi again <a>@souenzzo</a>
If you are interested the following code solved the use case:
<a href="https://github.com/pedestal/pedestal/issues/665#issuecomment-651652532" target="_blank">https://github.com/pedestal/pedestal/issues/665#issuecomment-651652532</a>
It&apos;s not perfect, but it works.</z><z id="t1593522299" t="souenzzo I think that we are a bit confused about async and lazy things If you are sending a huge payload, your client probably will not handle it &quot;as a json array&quot;, it will prefer &quot;a steam of jsons&quot;"><y>#</y><d>2020-06-30</d><h>13:04</h><r>souenzzo</r>I think that we are a bit confused about async and lazy things
If you are sending a huge payload, your client probably will not handle it &quot;as a json array&quot;, it will prefer &quot;a steam of jsons&quot;</z><z id="t1593594958" t="Ivar Refsdal Then you are inventing a new content type. I don&apos;t think that is correct."><y>#</y><d>2020-07-01</d><h>09:15</h><r>Ivar Refsdal</r>Then you are inventing a new content type. I don&apos;t think that is correct.</z><z id="t1593199522" t="Aleed you can’t mix and match pedestal route syntax right? e.g. if I’m using Terse Syntax and another library uses Table Syntax"><y>#</y><d>2020-06-26</d><h>19:25</h><w>Aleed</w>you can’t mix and match pedestal route syntax right?
e.g. if I’m using Terse Syntax and another library uses Table Syntax</z><z id="t1593199727" t="ddeaguiar I suppose it depends on how the routes get expanded. I’ve not tried this but it may work if you expand them separately then combine"><y>#</y><d>2020-06-26</d><h>19:28</h><w>ddeaguiar</w>I suppose it depends on how the routes get expanded. I’ve not tried this but it may work if you expand them separately then combine</z><z id="t1593360162" t="husayn is it possible to extend a protocol defined in another library ? …. specifically TraceSpan in io.pedestal.log so that it implements .Closeable ?"><y>#</y><d>2020-06-28</d><h>16:02</h><w>husayn</w>is it possible to extend a protocol defined in another library ? …. specifically <code>TraceSpan</code> in <code>io.pedestal.log</code>  so that it implements <code>.Closeable</code> ?</z><z id="t1593369918" t="emccue no, but you can make your own protocol to bridge the two"><y>#</y><d>2020-06-28</d><h>18:45</h><w>emccue</w>no, but you can make your own protocol to bridge the two</z><z id="t1593370006" t="emccue (defprotocol AsCloseable (-as-closeable [_])) (extend-type java.io.Closeable AsCloseable (-as-closeable [this] this))"><y>#</y><d>2020-06-28</d><h>18:46</h><w>emccue</w><pre>(defprotocol AsCloseable
  (-as-closeable [_]))

(extend-type java.io.Closeable
  AsCloseable
  (-as-closeable [this] this))</pre></z><z id="t1593370031" t="emccue actually, err"><y>#</y><d>2020-06-28</d><h>18:47</h><w>emccue</w>actually, err</z><z id="t1593370074" t="emccue its not super straight forward"><y>#</y><d>2020-06-28</d><h>18:47</h><w>emccue</w>its not super straight forward</z><z id="t1593370105" t="emccue you can&apos;t actually implement a protocol on something based on it implementing another protocol"><y>#</y><d>2020-06-28</d><h>18:48</h><w>emccue</w>you can&apos;t actually implement a protocol on something based on it implementing another protocol</z><z id="t1593370154" t="emccue if you want to do that you probably would have to do a custom dispatch mechanism in some way"><y>#</y><d>2020-06-28</d><h>18:49</h><w>emccue</w>if you want to do that you probably would have to do a custom dispatch mechanism in some way</z><z id="t1593370269" t="emccue (defn as-closeable [item] (cond (satisfies? TraceSpan (type item)) (...) (implements? Closeable item) item :else ...AAAA...))"><y>#</y><d>2020-06-28</d><h>18:51</h><w>emccue</w><pre>(defn as-closeable [item]
  (cond
    (satisfies? TraceSpan (type item))
    (...)
   
    (implements? Closeable item)
    item

    :else
    ...AAAA...))</pre></z><z id="t1593370282" t="emccue the simplest and least extensible way would be this"><y>#</y><d>2020-06-28</d><h>18:51</h><w>emccue</w>the simplest and least extensible way would be this</z><z id="t1593370331" t="emccue i actually consider this a pretty big downside to protocols - they don&apos;t actually work like traits in rust or similar where you can implement a trait for anything that implements a trait"><y>#</y><d>2020-06-28</d><h>18:52</h><w>emccue</w>i actually consider this a pretty big downside to protocols - they don&apos;t actually work like traits in rust or similar where you can implement a trait for anything that implements a trait</z><z id="t1593371082" t="emccue (def extending-protocols (atom []) (defn register-impl-for-protocol! [protocol impl] (swap! extending-protocols conj [protocol impl])) (defn as-closeable [item] (cond (instance? Closeable item) item :else (loop [impls @extending-protocols] (if-not (empty? impls) (let [[protocol impl] (first impls) remaining-impls (rest impls)] (if (satisfies? protocol item) (impl item) (recur remaining-impls))) (throw (IllegalArgumentException. (str &quot;No Impl found for &quot; item)))))"><y>#</y><d>2020-06-28</d><h>19:04</h><w>emccue</w><pre>(def extending-protocols (atom [])

(defn register-impl-for-protocol! [protocol impl]
  (swap! extending-protocols conj [protocol impl]))

(defn as-closeable [item]
  (cond
    (instance? Closeable item)
    item

    :else
    (loop [impls @extending-protocols]
      (if-not (empty? impls)
        (let [[protocol impl] (first impls)
              remaining-impls (rest impls)]
          (if (satisfies? protocol item)
            (impl item)
            (recur remaining-impls)))
        (throw (IllegalArgumentException. (str &quot;No Impl found for &quot; item)))))</pre></z><z id="t1593371165" t="emccue the downside here is that with-open and co won&apos;t actually work"><y>#</y><d>2020-06-28</d><h>19:06</h><w>emccue</w>the downside here is that <code>with-open</code> and co won&apos;t actually work</z><z id="t1593371231" t="emccue I actually made a thing that I think came close to giving a general approach for this before"><y>#</y><d>2020-06-28</d><h>19:07</h><w>emccue</w>I actually made a thing that I think came close to giving a general approach for this before</z><z id="t1593371237" t="emccue"><y>#</y><d>2020-06-28</d><h>19:07</h><w>emccue</w></z><z id="t1593371903" t="emccue [:attrs {:href &quot;/_/_/users/U401357B6&quot;}]"><y>#</y><d>2020-06-28</d><h>19:18</h><w>emccue</w><a>@husayn</a></z><z id="t1593412228" t="husayn [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] thanks a lot, should work"><y>#</y><d>2020-06-29</d><h>06:30</h><w>husayn</w><a>@emccue</a> thanks a lot, should work</z><z id="t1593516128" t="erwinrooijakkers Hi because of a health check I see every second logging like this: {&quot;message&quot;:&quot;{:msg \&quot;GET /\&quot;, :line 80}&quot;,&quot;severity&quot;:&quot;INFO&quot;,&quot;thread&quot;:&quot;qtp1569164069-15&quot;,&quot;logger&quot;:&quot;io.pedestal.http&quot;}"><y>#</y><d>2020-06-30</d><h>11:22</h><w>erwinrooijakkers</w>Hi because of a health check I see every second logging like this:

<pre>{&quot;message&quot;:&quot;{:msg \&quot;GET /\&quot;, :line 80}&quot;,&quot;severity&quot;:&quot;INFO&quot;,&quot;thread&quot;:&quot;qtp1569164069-15&quot;,&quot;logger&quot;:&quot;io.pedestal.http&quot;}</pre></z><z id="t1593516147" t="erwinrooijakkers Is there a way to modify the logger in such a way that requests to “\/” are ignored?"><y>#</y><d>2020-06-30</d><h>11:22</h><w>erwinrooijakkers</w>Is there a way to modify the logger in such a way that requests to “\/” are ignored?</z><z id="t1593524189" t="Joe Lane [:attrs {:href &quot;/_/_/users/U2PGHFU5U&quot;}] change your logback.xml file to change the log level that is reported to be above &quot;INFO&quot;"><y>#</y><d>2020-06-30</d><h>13:36</h><w>Joe Lane</w><a>@erwinrooijakkers</a> change your <code>logback.xml</code> file to change the log level that is reported to be above &quot;INFO&quot;</z><z id="t1593524843" t="erwinrooijakkers The thing is I do want other INFO logging"><y>#</y><d>2020-06-30</d><h>13:47</h><w>erwinrooijakkers</w>The thing  is I do want other INFO logging</z><z id="t1593524848" t="erwinrooijakkers Other requests are fine"><y>#</y><d>2020-06-30</d><h>13:47</h><w>erwinrooijakkers</w>Other requests are fine</z><z id="t1593524857" t="erwinrooijakkers Only not GET requests to /"><y>#</y><d>2020-06-30</d><h>13:47</h><w>erwinrooijakkers</w>Only not GET requests to /</z><z id="t1593524888" t="erwinrooijakkers I think it can be done by modifying the request-logger"><y>#</y><d>2020-06-30</d><h>13:48</h><w>erwinrooijakkers</w>I think it can be done by modifying the <code>request-logger</code></z><z id="t1593524933" t="erwinrooijakkers Default is this: (def log-request &quot;Log the request&apos;s method and uri.&quot; (interceptor/on-request ::log-request (fn [request] (log/info :msg (format &quot;%s %s&quot; (string/upper-case (name (:request-method request))) (:uri request))) (log/meter ::request) request)))"><y>#</y><d>2020-06-30</d><h>13:48</h><w>erwinrooijakkers</w>Default is this:

<pre>(def log-request
  &quot;Log the request&apos;s method and uri.&quot;
  (interceptor/on-request
    ::log-request
    (fn [request]
      (log/info :msg (format &quot;%s %s&quot;
                             (string/upper-case (name (:request-method request)))
                             (:uri request)))
      (log/meter ::request)
      request)))</pre></z><z id="t1593524946" t="erwinrooijakkers So I can change that one to check the :uri and then not log. 🙂"><y>#</y><d>2020-06-30</d><h>13:49</h><w>erwinrooijakkers</w>So I can change that one to check the :uri and then not log. <b>🙂</b></z><z id="t1593681116" t="Ivar Refsdal That&apos;s seems fine I think"><y>#</y><d>2020-07-02</d><h>09:11</h><r>Ivar Refsdal</r>That&apos;s seems fine I think</z><z id="t1593681181" t="Ivar Refsdal On my service-map I&apos;m doing pretty much exactly that: ; [io.pedestal.http :as http] (assoc ::http/request-logger weblog/log-request) and (def log-request &quot;Log the request&apos;s method and uri.&quot; (helpers/on-request ::log-request (fn [request] (when (not= &quot;/graphql-ws&quot; (:uri request)) (ped-log/info :msg (format &quot;%s %s&quot; (str/upper-case (name (:request-method request))) (:uri request))) (ped-log/meter ::request)) request))) Pretty similar to your case"><y>#</y><d>2020-07-02</d><h>09:13</h><r>Ivar Refsdal</r>On my service-map I&apos;m doing pretty much exactly that:
<pre>; [io.pedestal.http :as http]
(assoc ::http/request-logger weblog/log-request)</pre>
and
<pre>(def log-request
  &quot;Log the request&apos;s method and uri.&quot;
  (helpers/on-request
    ::log-request
    (fn [request]
      (when (not= &quot;/graphql-ws&quot; (:uri request))
        (ped-log/info :msg (format &quot;%s %s&quot;
                                   (str/upper-case (name (:request-method request)))
                                   (:uri request)))
        (ped-log/meter ::request))
      request)))</pre>
Pretty similar to your case</z><z id="t1593525894" t="Joe Lane I really think you should make that change in the logback.xml , but I don&apos;t know the details off the top of my head. This sounds like it should be a configuration change though, not a code change."><y>#</y><d>2020-06-30</d><h>14:04</h><w>Joe Lane</w>I really think you should make that change in the <code>logback.xml</code>, but I don&apos;t know the details off the top of my head. This sounds like it should be a configuration change though, not a code change.</z><z id="t1593535566" t="erwinrooijakkers Uhm well logback only has access to the string content. It might be able to create a filter based on a regex."><y>#</y><d>2020-06-30</d><h>16:46</h><r>erwinrooijakkers</r>Uhm well logback only has access to the string content. It might be able to create a filter based on a regex.</z><z id="t1593526287" t="dvingo you could decorate the default request-logger and then pass yours in when you create the service https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205"><y>#</y><d>2020-06-30</d><h>14:11</h><w>dvingo</w>you could decorate the default request-logger and then pass yours in when you create the service
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L205</a></z><z id="t1594059137" t="dangercoder How scalable are websockets with Pedestal and Jetty? Is it fully &quot;non-blocking&quot;?"><y>#</y><d>2020-07-06</d><h>18:12</h><w>dangercoder</w>How scalable are websockets with Pedestal and Jetty? Is it fully &quot;non-blocking&quot;?</z><z id="t1594060058" t="dangercoder found my answer, seems to be based on nio and some issues with blocking behaviour was resolved by e.g send-async and more functions."><y>#</y><d>2020-07-06</d><h>18:27</h><r>dangercoder</r>found my answer, seems to be based on nio and some issues with blocking behaviour was resolved by e.g send-async and more functions.</z><z id="t1594067056" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] keep in mind that you have full control over how websockets are implemented. You can provide your own start fn, listener implementation if you have specific needs"><y>#</y><d>2020-07-06</d><h>20:24</h><r>ddeaguiar</r><a>@UBN9SNVB4</a> keep in mind that you have full control over how websockets are implemented. You can provide your own start fn, listener implementation if you have specific needs</z><z id="t1594067560" t="dangercoder thanks, i&apos;ll keep that in mind"><y>#</y><d>2020-07-06</d><h>20:32</h><r>dangercoder</r>thanks, i&apos;ll keep that in mind</z><z id="t1594649784" t="abdullahibra Hi everyone,"><y>#</y><d>2020-07-13</d><h>14:16</h><w>abdullahibra</w>Hi everyone,</z><z id="t1594649849" t="abdullahibra i&apos;m using reitit with pedestal, How can this simple example https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger be improved to add better handling of invalid inputs?"><y>#</y><d>2020-07-13</d><h>14:17</h><w>abdullahibra</w>i&apos;m using reitit with pedestal, How can this simple example <a href="https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger" target="_blank">https://github.com/metosin/reitit/tree/master/examples/pedestal-swagger</a> be improved to add better handling of invalid inputs?</z><z id="t1594666654" t="twashing I know Lacinia-Pedestal supports GraphiQL . But GraphiQL looks more like a GQL query workbench. It’d be nice if there was a Swagger for GraphQL."><y>#</y><d>2020-07-13</d><h>18:57</h><w>twashing</w>I know <code>Lacinia-Pedestal</code> supports <code>GraphiQL</code> . But GraphiQL looks more like a GQL query workbench.

It’d be nice if there was a Swagger for GraphQL.</z><z id="t1594672519" t="chrisulloa It has a documentation explorer. You can also use other tooling as a consumer to validate your graphql queries in your IDE."><y>#</y><d>2020-07-13</d><h>20:35</h><r>chrisulloa</r>It has a documentation explorer. You can also use other tooling as a consumer to validate your graphql queries in your IDE.</z></g><g id="s19"><z id="t1594672631" t="chrisulloa Which I think is better than Swagger… just in my opinion"><y>#</y><d>2020-07-13</d><h>20:37</h><r>chrisulloa</r>Which I think is better than Swagger… just in my opinion</z><z id="t1594745293" t="jjttjj When trying to use SSE with pedestal I&apos;m getting the warnings described here: https://github.com/pedestal/pedestal/issues/631 Do I understand correctly that these warnings are expected (because SSE clients will inevitably disconnect and that&apos;s all the warning is saying?) So it would be fine to just set console logging to ignore these?"><y>#</y><d>2020-07-14</d><h>16:48</h><w>jjttjj</w>When trying to use SSE with pedestal I&apos;m getting the warnings described here: <a href="https://github.com/pedestal/pedestal/issues/631" target="_blank">https://github.com/pedestal/pedestal/issues/631</a>
Do I understand correctly that these warnings are expected (because SSE clients will inevitably disconnect and that&apos;s all the warning is saying?) So it would be fine to just set console logging to ignore these?</z><z id="t1594745490" t="jjttjj Or is there a better way to silence these"><y>#</y><d>2020-07-14</d><h>16:51</h><w>jjttjj</w>Or is there a better way to silence these</z><z id="t1595793649" t="souenzzo Where is the pedestal function that turs :path-info &quot;/42&quot; into :path-params {:a &quot;42&quot;} ?"><y>#</y><d>2020-07-26</d><h>20:00</h><w>souenzzo</w>Where is the pedestal function that turs <code>:path-info &quot;/42&quot;</code> into <code>:path-params {:a &quot;42&quot;}</code> ?</z><z id="t1595948872" t="frankitox Maybe in one of the default interceptors?"><y>#</y><d>2020-07-28</d><h>15:07</h><r>frankitox</r>Maybe in one of the default interceptors?</z><z id="t1595863950" t="danieroux https://github.com/cognitect-labs/vase has no mention of Transit, I see EDN and JSON. Is it because adding Transit as a format is easy enough? I am surprised to not see it first and foremost?"><y>#</y><d>2020-07-27</d><h>15:32</h><w>danieroux</w><a href="https://github.com/cognitect-labs/vase" target="_blank">https://github.com/cognitect-labs/vase</a> has no mention of Transit, I see EDN and JSON. Is it because adding Transit as a format is easy enough? I am surprised to not see it first and foremost?</z><z id="t1596308331" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U9E8C7QRJ&quot;}] there’s an old, open PR ( https://github.com/cognitect-labs/vase/pull/62 ) which adds Transit support. It still needs to be fleshed out further. I don’t have a timeline for when that PR will land but once done I’d be cutting the next release (0.9.4)"><y>#</y><d>2020-08-01</d><h>18:58</h><r>ddeaguiar</r><a>@U9E8C7QRJ</a> there’s an old, open PR (<a href="https://github.com/cognitect-labs/vase/pull/62" target="_blank">https://github.com/cognitect-labs/vase/pull/62</a>) which adds Transit support. It still needs to be fleshed out further. I don’t have a timeline for when that PR will land but once done I’d be cutting the next release (0.9.4)</z><z id="t1597117227" t="subsaharancoder What&apos;s the recommended way of setting up a route with an interceptor for body-params ? I have this: [&quot;/api/users&quot; :post [(body-params/body-params)] ;user-handler :route-name :user-handler ] with my handler: (defn user-handler [{:keys [headers params json-params path-params] :as request}] {:status 200 :body &quot;/api/users&quot;}) but doesn&apos;t seem to work"><y>#</y><d>2020-08-11</d><h>03:40</h><w>subsaharancoder</w>What&apos;s the recommended way of setting up a route with an interceptor for <code>body-params</code>?  I have this:
<pre>[&quot;/api/users&quot;
       :post [(body-params/body-params)]
       ;user-handler
       :route-name :user-handler
       ]</pre>
with my handler:
<pre>(defn user-handler
  [{:keys [headers params json-params path-params] :as request}]
  {:status 200 :body &quot;/api/users&quot;})</pre>
but doesn&apos;t seem to work</z><z id="t1597120327" t="subsaharancoder figured this out"><y>#</y><d>2020-08-11</d><h>04:32</h><w>subsaharancoder</w>figured this out</z><z id="t1597167106" t="dangercoder When you compose interceptors, whats the preferred pedestal way? Many interceptors or few interceptors? Example: 1. &quot;light weight interceptors&quot; (conj common-interceptors error-handler coerce-create-transaction-request with-jdbc-transaction-interceptor! get-current-user-interceptor! get-current-system-status-interceptor! validate-user-balance-interceptor save-transaction-interceptor! notify-booking-system-interceptor!) 2. &quot;heavy-weight-interceptors&quot; (conj common-interceptors error-handler coerce-create-transaction-request handle-create-transaction-interceptor) "><y>#</y><d>2020-08-11</d><h>17:31</h><w>dangercoder</w>When you compose interceptors, whats the preferred pedestal way? Many interceptors or few interceptors?

Example:

1. &quot;light weight interceptors&quot;
<pre>(conj common-interceptors
      error-handler
      coerce-create-transaction-request
      with-jdbc-transaction-interceptor!
      get-current-user-interceptor!
      get-current-system-status-interceptor!
      validate-user-balance-interceptor
      save-transaction-interceptor!
      notify-booking-system-interceptor!)</pre>
2. &quot;heavy-weight-interceptors&quot;
<pre>(conj common-interceptors
      error-handler
      coerce-create-transaction-request
      handle-create-transaction-interceptor)</pre>
</z><z id="t1597167365" t="ddeaguiar I tend to prefer small interceptors where each focuses on a single responsibility but I suppose it depends on context"><y>#</y><d>2020-08-11</d><h>17:36</h><w>ddeaguiar</w>I tend to prefer small interceptors where each focuses on a single responsibility but I suppose it depends on context</z><z id="t1597167566" t="dangercoder To me, having small interceptors which focus on a single responsibility makes things more explicit"><y>#</y><d>2020-08-11</d><h>17:39</h><w>dangercoder</w>To me, having small interceptors which focus on a single responsibility makes things more explicit</z><z id="t1597167670" t="ddeaguiar plus they are easier to reason about, test, etc…"><y>#</y><d>2020-08-11</d><h>17:41</h><w>ddeaguiar</w>plus they are easier to reason about, test, etc…</z><z id="t1597167786" t="isak A downside could be performance. E.g., 10 round-trips to the database, instead of just 1"><y>#</y><d>2020-08-11</d><h>17:43</h><w>isak</w>A downside could be performance. E.g., 10 round-trips to the database, instead of just 1</z><z id="t1597169418" t="dangercoder indeed isak, one always has to think about roundtrips 🙂"><y>#</y><d>2020-08-11</d><h>18:10</h><w>dangercoder</w>indeed isak, one always has to think about roundtrips <b>🙂</b></z><z id="t1597441846" t="subsaharancoder How do you setup up CORS in Pedestal http://pedestal.io/api/pedestal.service/io.pedestal.http.cors.html ? I&apos;m noticing my browser to backend calls keep getting changed to OPTIONS"><y>#</y><d>2020-08-14</d><h>21:50</h><w>subsaharancoder</w>How do you setup up CORS in Pedestal <a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.cors.html" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.cors.html</a> ? I&apos;m noticing my browser to backend calls keep getting changed to <code>OPTIONS</code></z><z id="t1597442077" t="subsaharancoder figured this out 🙂 I just added ::http/allowed-origins (constantly true) to the service-map 🙂"><y>#</y><d>2020-08-14</d><h>21:54</h><w>subsaharancoder</w>figured this out <b>🙂</b> I just added
<pre>::http/allowed-origins (constantly true)</pre>
to the service-map <b>🙂</b></z><z id="t1597444169" t="Joe Lane [:attrs {:href &quot;/_/_/users/UM72P2SQM&quot;}] that may be fine for dev, but you probably want something more secure for production "><y>#</y><d>2020-08-14</d><h>22:29</h><w>Joe Lane</w><a>@johnwesonga</a> that may be fine for dev, but you probably want something more secure for production </z><z id="t1597445120" t="subsaharancoder [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] any pointers?"><y>#</y><d>2020-08-14</d><h>22:45</h><w>subsaharancoder</w><a>@lanejo01</a> any pointers?</z><z id="t1597445481" t="Joe Lane None right now, I’m mobile. But you basically just disabled cors and I don’t think you intended that for a prod workload. "><y>#</y><d>2020-08-14</d><h>22:51</h><w>Joe Lane</w>None right now, I’m mobile. But you basically just disabled cors and I don’t think you intended that for a prod workload. </z><z id="t1597447931" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UM72P2SQM&quot;}] sorry to hear that you’ve encountered issues while using Pedestal. Are you sure it’s the CORS interceptor that is changing your requests to OPTIONS ? Additional documentation regarding CORS configuration via the service map can be found in http://pedestal.io/reference/service-map#_description and http://pedestal.io/reference/service-map#_cors"><y>#</y><d>2020-08-14</d><h>23:32</h><w>ddeaguiar</w><a>@johnwesonga</a> sorry to hear that you’ve encountered issues while using Pedestal. Are you sure it’s the CORS interceptor that is changing your requests to <code>OPTIONS</code> ? Additional documentation regarding CORS configuration via the service map can be found in <a href="http://pedestal.io/reference/service-map#_description" target="_blank">http://pedestal.io/reference/service-map#_description</a> and <a href="http://pedestal.io/reference/service-map#_cors" target="_blank">http://pedestal.io/reference/service-map#_cors</a></z><z id="t1597691193" t="Ashkan Banitalebi Hi all, With the risk of this question being totally annoying and basic, what is the best practice for input validation in pedestal? I think I&apos;ll be using spec of each request input (the body) and I want for each API to have its own input validation. What I found, looking online was: https://github.com/oliyh/pedestal-api and https://github.com/metosin/reitit have some utilities for input/output validation and, mainly, coercion. However, I think I&apos;d be better off writing my own interceptor(s) validating data. Am I missing something here? Thanks in advance. 🍻"><y>#</y><d>2020-08-17</d><h>19:06</h><w>Ashkan Banitalebi</w>Hi all,
With the risk of this question being totally annoying and basic, what is the best practice for input validation in pedestal?
I think I&apos;ll be using spec of each request input (the body) and I want for each API to have its own input validation.

What I found, looking online was: <a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a> and <a href="https://github.com/metosin/reitit" target="_blank">https://github.com/metosin/reitit</a> have some utilities for input/output validation and, mainly, coercion. However, I think I&apos;d be better off writing my own interceptor(s) validating data.

Am I missing something here?

Thanks in advance. <b>🍻</b></z><z id="t1598171519" t="dangercoder I rolled my own interceptor for this, it&apos;s based on spec/conform"><y>#</y><d>2020-08-23</d><h>08:31</h><r>dangercoder</r>I rolled my own interceptor for this, it&apos;s based on spec/conform</z><z id="t1598171578" t="dangercoder and expo.. re-invented the wheel a little bit since I know reitit has similar functionality."><y>#</y><d>2020-08-23</d><h>08:32</h><r>dangercoder</r>and expo.. re-invented the wheel a little bit since I know reitit has similar functionality.</z><z id="t1597691868" t="ikitommi [:attrs {:href &quot;/_/_/users/UUL0R283Y&quot;}] spec doesn&apos;t support runtime value transformations, so if you want to roll your own solution, you should pick one of the spec coercion libs out there."><y>#</y><d>2020-08-17</d><h>19:17</h><w>ikitommi</w><a>@ashkan.dant3</a> spec doesn&apos;t support runtime value transformations, so if you want to roll your own solution, you should pick one of the spec coercion libs out there.</z><z id="t1597691925" t="ikitommi I believe you can just pick the reitit spec request &amp; response coercion interceptors and use them with vanilla pedestal."><y>#</y><d>2020-08-17</d><h>19:18</h><r>ikitommi</r>I believe you can just pick the reitit spec request &amp; response coercion interceptors and use them with vanilla pedestal.</z><z id="t1597692017" t="ikitommi https://github.com/metosin/reitit/blob/master/modules/reitit-http/src/reitit/http/coercion.cljc#L6-L50"><y>#</y><d>2020-08-17</d><h>19:20</h><r>ikitommi</r><a href="https://github.com/metosin/reitit/blob/master/modules/reitit-http/src/reitit/http/coercion.cljc#L6-L50" target="_blank">https://github.com/metosin/reitit/blob/master/modules/reitit-http/src/reitit/http/coercion.cljc#L6-L50</a></z><z id="t1597692157" t="ikitommi needs few locs of glue code, that&apos;s all"><y>#</y><d>2020-08-17</d><h>19:22</h><r>ikitommi</r>needs few locs of glue code, that&apos;s all</z><z id="t1597697713" t="Ashkan Banitalebi Thanks [:attrs {:href &quot;/_/_/users/U055NJ5CC&quot;}] , that&apos;s very helpful. Since coercion is not my focus (mainly just validation), I think any of these options would do nicely."><y>#</y><d>2020-08-17</d><h>20:55</h><r>Ashkan Banitalebi</r>Thanks <a>@U055NJ5CC</a>, that&apos;s very helpful.

Since coercion is not my focus (mainly just validation), I think any of these options would do nicely.</z><z id="t1598026874" t="jdkealy How would you conditionally start (start-event-stream my-handler) I would like to inspect the request to make sure that the user is authenticated. If I made a pedestal interceptor that checks for the user and calls (start-event-stream my-handler) inside the interceptor i get, EventSource’s response has a MIME type (“Text/Plain”) that is not “text/event-stream”"><y>#</y><d>2020-08-21</d><h>16:21</h><w>jdkealy</w>How would you conditionally start <code>(start-event-stream my-handler)</code> I would like to inspect the request to make sure that the user is authenticated. If I made a pedestal interceptor that checks for the user and calls <code>(start-event-stream my-handler)</code>  inside the interceptor i get, EventSource’s response has a MIME type (“Text/Plain”) that is not “text/event-stream”</z><z id="t1598387417" t="thumbnail We use pedestal with jetty, and have a legacy app which sends a utf-8 string as a header. Jetty (rightfully) expects iso-8859-1, so we end up with a malformed string. Would it be possible to get the raw header, so we could parse it as utf-8 directly?"><y>#</y><d>2020-08-25</d><h>20:30</h><w>thumbnail</w>We use pedestal with jetty, and have a legacy app which sends a utf-8 string as a header. Jetty (rightfully) expects iso-8859-1, so we end up with a malformed string. Would it be possible to get the raw header, so we could parse it as utf-8 directly?</z><z id="t1598388658" t="thumbnail (String. (.getBytes my-str StandardCharsets/ISO_8859_1) StandardCharsets/UTF_8) Re-encoding seems to work; Nice!."><y>#</y><d>2020-08-25</d><h>20:50</h><r>thumbnail</r><pre>(String. (.getBytes my-str StandardCharsets/ISO_8859_1) StandardCharsets/UTF_8)</pre>
Re-encoding seems to work; Nice!.</z><z id="t1598890320" t="jdkealy I’m having trouble removing X-FRAME-OPTIONS headers. Right now, the setting is set to DENY. If I update the headers in an interceptor to “SAMEORIGIN”, it gets overwritten, however I want to remove the header altogether."><y>#</y><d>2020-08-31</d><h>16:12</h><w>jdkealy</w>I’m having trouble removing X-FRAME-OPTIONS headers. Right now, the setting is set to DENY. If I update the headers in an interceptor to “SAMEORIGIN”, it gets overwritten, however I want to remove the header altogether.</z><z id="t1598891118" t="isak There is probably a built in / default interceptor that has a :leave clause that executes after yours. Try adding an interceptor with a :leave as the very first interceptor."><y>#</y><d>2020-08-31</d><h>16:25</h><r>isak</r>There is probably a built in / default interceptor that has a <code>:leave</code>  clause that executes after yours. Try adding an interceptor with a <code>:leave</code> as the very first interceptor.</z><z id="t1598891179" t="isak e.g.,: (update ::http/interceptors (fn [xs s] (into [s] xs)) (interceptor/interceptor {:name :fix-xframe :leave (fn [ctx] ;... )}))"><y>#</y><d>2020-08-31</d><h>16:26</h><r>isak</r>e.g.,:
<pre>(update ::http/interceptors
              (fn [xs s] (into [s] xs))
              (interceptor/interceptor
                {:name :fix-xframe
                 :leave (fn [ctx]
                          ;...
                          )}))</pre></z><z id="t1598891189" t="jdkealy Right I’ve done that. If I leave the X-FRAME-OPTIONS header undefined it just gets set to deny"><y>#</y><d>2020-08-31</d><h>16:26</h><r>jdkealy</r>Right I’ve done that. If I leave the X-FRAME-OPTIONS header undefined it just gets set to deny</z><z id="t1598891207" t="jdkealy If I set it to SAMEORIGIN, it stays as SAMEORIGIN"><y>#</y><d>2020-08-31</d><h>16:26</h><r>jdkealy</r>If I set it to SAMEORIGIN, it stays as SAMEORIGIN</z><z id="t1598891255" t="isak Hmm, maybe it is coming from Jetty (or your webserver)"><y>#</y><d>2020-08-31</d><h>16:27</h><r>isak</r>Hmm, maybe it is coming from Jetty (or your webserver)</z><z id="t1599031038" t="jacekschae Hi all, just wanted to let you know that this week’s episode on ClojureScript Podcast is with Dan and it’s all about Pedestal https://soundcloud.com/user-959992602/s3-e7-pedestal-with-daniel-de-aguiar"><y>#</y><d>2020-09-02</d><h>07:17</h><w>jacekschae</w>Hi all, just wanted to let you know that this week’s episode on ClojureScript Podcast is with Dan and it’s all about Pedestal <a href="https://soundcloud.com/user-959992602/s3-e7-pedestal-with-daniel-de-aguiar" target="_blank">https://soundcloud.com/user-959992602/s3-e7-pedestal-with-daniel-de-aguiar</a></z><z id="t1599130728" t="dehli hello! how does a handler get access to variables from the context object that it needs? my first inclination is to create an interceptor that extracts the data and then assoc’s it into the request object. is that the right way?"><y>#</y><d>2020-09-03</d><h>10:58</h><w>dehli</w>hello! how does a handler get access to variables from the context object that it needs? my first inclination is to create an interceptor that extracts the data and then assoc’s it into the request object. is that the right way?</z><z id="t1599138234" t="souenzzo Or just turn your &quot;handler&quot; into a &quot;interceptor&quot;"><y>#</y><d>2020-09-03</d><h>13:03</h><r>souenzzo</r>Or just turn your &quot;handler&quot; into a &quot;interceptor&quot;</z><z id="t1599144023" t="dehli awesome, thanks!"><y>#</y><d>2020-09-03</d><h>14:40</h><r>dehli</r>awesome, thanks!</z><z id="t1599594685" t="emccue I am having some basic issues with interceptors"><y>#</y><d>2020-09-08</d><h>19:51</h><w>emccue</w>I am having some basic issues with interceptors</z><z id="t1599594707" t="emccue I am trying to write an interceptor to just add some fields to the context object"><y>#</y><d>2020-09-08</d><h>19:51</h><w>emccue</w>I am trying to write an interceptor to just add some fields to the context object</z><z id="t1599594736" t="emccue (defn respond-hello [db request] {:status 200 :body (str (request-&gt;str (jdbc/execute! db [&quot;SELECT * FROM PERSON&quot;])) &quot;\n&quot; (request-&gt;str request))}) (defn routes [db] (route/expand-routes #{[&quot;/greet&quot; :get (partial respond-hello db) :route-name ::respond-hello] [&quot;/&quot; :get respond-elm-app :route-name ::spa]})) (defn start-server [config db] (let [attach-system {:enter (fn [context] (assoc context :context {:db db :config config}))}] (-&gt; {:env :dev ::http/routes (routes db) ::http/port (config/server-port config) ::http/type :jetty ::http/join? false} (http/default-interceptors) (update :io.pedestal.http/interceptors conj attach-system) http/create-server http/start)))"><y>#</y><d>2020-09-08</d><h>19:52</h><w>emccue</w><pre>(defn respond-hello [db request]
  {:status 200 :body (str (request-&gt;str (jdbc/execute! db [&quot;SELECT * FROM PERSON&quot;]))
                          &quot;\n&quot;
                          (request-&gt;str request))})

(defn routes [db]
   (route/expand-routes
     #{[&quot;/greet&quot; :get (partial respond-hello db) :route-name ::respond-hello]
       [&quot;/&quot; :get respond-elm-app :route-name ::spa]}))


(defn start-server
  [config db]
  (let [attach-system {:enter (fn [context]
                                (assoc context :context {:db db
                                                         :config config}))}]
    (-&gt; {:env :dev
         ::http/routes (routes db)
         ::http/port (config/server-port config)
         ::http/type :jetty
         ::http/join? false}
        (http/default-interceptors)
        (update :io.pedestal.http/interceptors conj attach-system)
        http/create-server
        http/start)))</pre></z><z id="t1599594806" t="emccue [{:type java.lang.AssertionError :message &quot;Assert failed: (every? interceptor/interceptor? interceptors)&quot; :at [io.pedestal.interceptor.chain$enqueue invokeStatic &quot;chain.clj&quot; 273]}]"><y>#</y><d>2020-09-08</d><h>19:53</h><w>emccue</w><pre>[{:type java.lang.AssertionError
   :message &quot;Assert failed: (every? interceptor/interceptor? interceptors)&quot;
   :at [io.pedestal.interceptor.chain$enqueue invokeStatic &quot;chain.clj&quot; 273]}]</pre></z><z id="t1599594809" t="emccue but I get this"><y>#</y><d>2020-09-08</d><h>19:53</h><w>emccue</w>but I get this</z><z id="t1599594823" t="emccue which makes me think that somehow i structured my interceptor wrong"><y>#</y><d>2020-09-08</d><h>19:53</h><w>emccue</w>which makes me think that somehow i structured my interceptor wrong</z><z id="t1599594864" t="emccue but the error is the same regardless if I have a :name on the interceptor so i feel at a loss"><y>#</y><d>2020-09-08</d><h>19:54</h><w>emccue</w>but the error is the same regardless if I have a <code>:name</code> on the interceptor so i feel at a loss</z><z id="t1599595934" t="isak What you inject there isn&apos;t an interceptor yet. You should call io.pedestal.interceptor/interceptor on that map before you inject it."><y>#</y><d>2020-09-08</d><h>20:12</h><r>isak</r>What you inject there isn&apos;t an interceptor yet. You should call io.pedestal.interceptor/interceptor on that map before you inject it.</z><z id="t1599602128" t="michaelteter Hello all. I&apos;m making my first attempt to build an API, and I can&apos;t figure out how to get POSTed application/json data. My context in my route handler doesn&apos;t seem to have the request body json in it."><y>#</y><d>2020-09-08</d><h>21:55</h><w>michaelteter</w>Hello all.  I&apos;m making my first attempt to build an API, and I can&apos;t figure out how to get POSTed application/json data.  My context in my route handler doesn&apos;t seem to have the request body json in it.</z><z id="t1599603433" t="isak Did you look under :request in the context?"><y>#</y><d>2020-09-08</d><h>22:17</h><r>isak</r>Did you look under <code>:request</code> in the context?</z><z id="t1599603565" t="isak Are you using the io.pedestal.http.body-params/body-params interceptor? If so, you should look under [:request :io.pedestal.http.body-params/body-params]"><y>#</y><d>2020-09-08</d><h>22:19</h><r>isak</r>Are you using the io.pedestal.http.body-params/body-params interceptor? If so, you should look under <code>[:request :io.pedestal.http.body-params/body-params]</code></z><z id="t1599603694" t="michaelteter Thanks. I did finally get past the problem. This seems to give me what I need: ` [&quot;/add-event&quot; :post [(io.pedestal.http.body-params/body-params) pusher-api.incoming-data/add-event] :route-name :add-event] "><y>#</y><d>2020-09-08</d><h>22:21</h><r>michaelteter</r>Thanks.  I did finally get past the problem.  This seems to give me what I need: `
<pre>[&quot;/add-event&quot;   :post [(io.pedestal.http.body-params/body-params) pusher-api.incoming-data/add-event] :route-name :add-event]</pre>
</z><z id="t1599603734" t="michaelteter my mistake was not calling body-params ( ). I was just referencing it 😛"><y>#</y><d>2020-09-08</d><h>22:22</h><r>michaelteter</r>my mistake was not calling body-params ( ).  I was just referencing it <b>😛</b></z><z id="t1600258272" t="Test This Hello. I am looking at pedestal docs on the clojure site. What is there, is awesome. Really clear and well explained. However, there are many incomplete docs. Are there other resources where to find more information on the topics that are missing (other than API docs and the source code)? I don&apos;t have anything specific in mind at this point. But just want to become aware of the resources that exist, since I am hoping to learn it. I am very new to clojure, and am exploring different ways of creating backend service. Any recommendations about pedestal vs reitit."><y>#</y><d>2020-09-16</d><h>12:11</h><w>Test This</w>Hello. I am looking at pedestal docs on the clojure site. What is there, is awesome. Really clear and well explained. However, there are many incomplete docs. Are there other resources where to find more information on the topics that are missing (other than API docs and the source code)? I don&apos;t have anything specific in mind at this point. But just want to become aware of the resources that exist, since I am hoping to learn it. I am very new to clojure, and am exploring different ways of creating backend service. Any recommendations about pedestal vs reitit.</z><z id="t1600262385" t="orestis The examples in the source code are quite illustrative: https://github.com/pedestal/pedestal/tree/master/samples"><y>#</y><d>2020-09-16</d><h>13:19</h><w>orestis</w>The examples in the source code are quite illustrative: <a href="https://github.com/pedestal/pedestal/tree/master/samples" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples</a></z><z id="t1600262425" t="orestis And, you can combine pedestal and reitit (reitit is only for routing): https://cljdoc.org/d/metosin/reitit/0.5.5/doc/http/pedestal"><y>#</y><d>2020-09-16</d><h>13:20</h><w>orestis</w>And, you can combine pedestal and reitit (reitit is only for routing): <a href="https://cljdoc.org/d/metosin/reitit/0.5.5/doc/http/pedestal" target="_blank">https://cljdoc.org/d/metosin/reitit/0.5.5/doc/http/pedestal</a></z><z id="t1600296284" t="Test This Thank you for the clarification and the link. Look forward to working with Pedestal"><y>#</y><d>2020-09-16</d><h>22:44</h><w>Test This</w>Thank you for the clarification and the link. Look forward to working with Pedestal</z><z id="t1600540619" t="diego.videco Hello everyone, I am working with websockets and am wondering if there is some kind of default ping/pong for keeping the connections alive? I have looked around and haven&apos;t been able to find anything on this respect. If there is nothing, what is the or a recommended approach?"><y>#</y><d>2020-09-19</d><h>18:36</h><w>diego.videco</w>Hello everyone, I am working with websockets and am wondering if there is some kind of default ping/pong for keeping the connections alive? I have looked around and haven&apos;t been able to find anything on this respect. If there is nothing, what is the or a recommended approach?</z><z id="t1600712328" t="isak There is something built in, but sometimes they still get closed by code outside your app (on the firewall, for example). One approach I&apos;ve seen people take is to just send a {&quot;type&quot;: &quot;ka&quot;} (ka = keepalive) message every 30 seconds, if no other message has been sent. Hasura does this for GraphQL subscriptions, for example."><y>#</y><d>2020-09-21</d><h>18:18</h><r>isak</r>There is something built in, but sometimes they still get closed by code outside your app (on the firewall, for example). One approach I&apos;ve seen people take is to just send a <code>{&quot;type&quot;: &quot;ka&quot;}</code> (ka = keepalive) message every 30 seconds, if no other message has been sent. Hasura does this for GraphQL subscriptions, for example.</z><z id="t1600712394" t="isak For another project I tried sending ping/pong messages (a special message type in the websocket spec), but it didn&apos;t change anything, and those messages don&apos;t appear as frames in the browser tooling"><y>#</y><d>2020-09-21</d><h>18:19</h><r>isak</r>For another project I tried sending ping/pong messages (a special message type in the websocket spec), but it didn&apos;t change anything, and those messages don&apos;t appear as frames in the browser tooling</z><z id="t1600712406" t="isak (This was in .NET though, not pedestal)"><y>#</y><d>2020-09-21</d><h>18:20</h><r>isak</r>(This was in .NET though, not pedestal)</z><z id="t1600738564" t="diego.videco Thanks [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] , for the mean time I cooked my own ping/pong and it seems to work, though I still wonder if there might be something in pedestal that already does this (although I did look into some parts of the codebase)"><y>#</y><d>2020-09-22</d><h>01:36</h><r>diego.videco</r>Thanks <a>@U08JKUHA9</a>, for the mean time I cooked my own ping/pong and it seems to work, though I still wonder if there might be something in pedestal that already does this (although I did look into some parts of the codebase)</z><z id="t1600784572" t="isak Ok. https://www.eclipse.org/lists/jetty-users/msg04961.html re you using Jetty? I think the relevant settings are more likely to be there. For example: https://stackoverflow.com/a/22871227"><y>#</y><d>2020-09-22</d><h>14:22</h><r>isak</r>Ok. <a href="https://www.eclipse.org/lists/jetty-users/msg04961.html" target="_blank">https://www.eclipse.org/lists/jetty-users/msg04961.html</a>re you using Jetty? I think the relevant settings are more likely to be there.
For example:
<a href="https://stackoverflow.com/a/22871227" target="_blank">https://stackoverflow.com/a/22871227</a></z><z id="t1600804713" t="diego.videco yeah, thanks again!"><y>#</y><d>2020-09-22</d><h>19:58</h><r>diego.videco</r>yeah, thanks again!</z><z id="t1600853626" t="dangercoder How are admin endpoints handled in pedestal? I am used to exposing theese endpoints on a different port than the &quot;public facing api&quot;."><y>#</y><d>2020-09-23</d><h>09:33</h><w>dangercoder</w>How are admin endpoints handled in pedestal? I am used to exposing theese endpoints on a different port than the &quot;public facing api&quot;.</z><z id="t1600853652" t="dangercoder Does anyone have an example? E.g I want to expose port 5000 for admin-endpoints (health/metrics) and 8080 for my &quot;regular api&quot;."><y>#</y><d>2020-09-23</d><h>09:34</h><w>dangercoder</w>Does anyone have an example? E.g I want to expose port 5000 for admin-endpoints (health/metrics) and 8080 for my &quot;regular api&quot;.</z><z id="t1600853665" t="dangercoder I guess it depends on which web-server is used also.."><y>#</y><d>2020-09-23</d><h>09:34</h><w>dangercoder</w>I guess it depends on which web-server is used also..</z><z id="t1600853776" t="dangercoder In e.g Jetty&quot;, this is possible with multiple connectors"><y>#</y><d>2020-09-23</d><h>09:36</h><w>dangercoder</w>In e.g Jetty&quot;, this is possible with multiple connectors</z><z id="t1600867391" t="souenzzo [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] i do that in 2 ways: - I have multiple instances of pedestal. My current app has 4 different ports/instances. - I gave up default-interceptors . Now I have a custom interceptors set where things like sessions and csrf-token are after the routing (to it can be applied just for some routes)"><y>#</y><d>2020-09-23</d><h>13:23</h><w>souenzzo</w><a>@jarvinenemil</a> i do that in 2 ways:
- I have multiple instances of pedestal. My current app has 4 different ports/instances.
- I gave up <code>default-interceptors</code>. Now I have a custom interceptors set where things like <code>sessions</code> and <code>csrf-token</code> are after the routing (to it can be applied just for some routes)</z><z id="t1600867661" t="dangercoder so pedestal starts several web-servers? or can it re-use the same instance? 😄"><y>#</y><d>2020-09-23</d><h>13:27</h><w>dangercoder</w>so pedestal starts several web-servers? or can it re-use the same instance? <b>😄</b></z><z id="t1600882374" t="isak If you really want to do it on a different port, I think you need more than one service-map that is http/started . If it were me though, I would just use an /admin &quot;route folder&quot;, where all the routes get an interceptor added that ensures admin access. (But I don&apos;t have an example app to show)"><y>#</y><d>2020-09-23</d><h>17:32</h><w>isak</w>If you really want to do it on a different port, I think you need more than one service-map that is <code>http/started</code> . If it were me though, I would just use an <code>/admin</code> &quot;route folder&quot;, where all the routes get an interceptor added that ensures admin access. (But I don&apos;t have an example app to show)</z><z id="t1600945893" t="Linus Ericsson [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] i have two different instances of pedestal-with-jetty-servers started (using component or mount). There may be a more efficent way use one jetty to listen to two servers, but I have not investigated that further."><y>#</y><d>2020-09-24</d><h>11:11</h><w>Linus Ericsson</w><a>@jarvinenemil</a> i have two different instances of pedestal-with-jetty-servers started (using component or mount). There may be a more efficent way use one jetty to listen to two servers, but I have not investigated that further.</z><z id="t1600977036" t="dangercoder it&apos;s possible to hook into the java-instance of jetty and configure connectors through pedestal so i guess it&apos;s possible 🙂"><y>#</y><d>2020-09-24</d><h>19:50</h><w>dangercoder</w>it&apos;s possible to hook into the java-instance of jetty and configure connectors through pedestal so i guess it&apos;s possible <b>🙂</b></z><z id="t1601047868" t="Zebra Hello, everyone how to deal with sharp latency increases during load in pedestal jetty based server? When querying db and sending large json response to 1 request latency is around 700ms, and as i increase requests to 15-25 per second response times grow to 16-27s, how to deal with this? (Standard settings, prod mode, full async and nio)"><y>#</y><d>2020-09-25</d><h>15:31</h><w>Zebra</w>Hello, everyone how to deal with sharp latency increases during load in pedestal jetty based server? When querying db and sending large json response to 1 request latency is around 700ms, and as i increase requests to 15-25 per second response times grow to 16-27s, how to deal with this? (Standard settings, prod mode, full async and nio)</z><z id="t1601051239" t="souenzzo can you exemplify this? Did you use time macro to check if this time is from j/query or any other component? You are using json? cheshire? how do you benchmark it?"><y>#</y><d>2020-09-25</d><h>16:27</h><r>souenzzo</r>can you exemplify this?
Did you use <code>time</code> macro to check if this time is from j/query or any other component?
You are using json? cheshire? how do you benchmark it?</z><z id="t1601051525" t="Zebra Muuntaja for encoding, wrk2 for testing"><y>#</y><d>2020-09-25</d><h>16:32</h><r>Zebra</r>Muuntaja for encoding, wrk2 for testing</z><z id="t1601051772" t="Zebra Also yeah, i used time to look for handler time, it uses fixedthreadpool for queries and does a bit of mapping, the time it takes to complete handler takes 450-550ms"><y>#</y><d>2020-09-25</d><h>16:36</h><r>Zebra</r>Also yeah, i used time to look for handler time, it uses fixedthreadpool for queries and does a bit of mapping, the time it takes to complete handler takes 450-550ms</z><z id="t1601051774" t="souenzzo What the request does? Are you sure that your operation isn&apos;t blocking the async threads?"><y>#</y><d>2020-09-25</d><h>16:36</h><r>souenzzo</r>What the request does?
Are you sure that your operation isn&apos;t blocking the async threads?</z><z id="t1601051820" t="Zebra Queries are submitted to a fixedsizethreadpool that returns a chan on completion, other than that nothing blocking"><y>#</y><d>2020-09-25</d><h>16:37</h><r>Zebra</r>Queries are submitted to a fixedsizethreadpool that returns a chan on completion, other than that nothing blocking</z><z id="t1601049576" t="chrisulloa Is there anything built into pedestal to let the client specify keys? /posts/42?fields=subject,author_name kind of thing"><y>#</y><d>2020-09-25</d><h>15:59</h><w>chrisulloa</w>Is there anything built into pedestal to let the client specify keys? <code>/posts/42?fields=subject,author_name</code> kind of thing</z><z id="t1601049607" t="chrisulloa writing an interceptor but also curious if anything is already baked in"><y>#</y><d>2020-09-25</d><h>16:00</h><w>chrisulloa</w>writing an interceptor but also curious if anything is already baked in</z><z id="t1601050872" t="Zebra Query params are parsed by default if im not mistaken"><y>#</y><d>2020-09-25</d><h>16:21</h><w>Zebra</w>Query params are parsed by default if im not mistaken</z><z id="t1601050922" t="Zebra /posts/42?fields[]=subject&amp;fields[]=author_name"><y>#</y><d>2020-09-25</d><h>16:22</h><w>Zebra</w><code>/posts/42?fields[]=subject&amp;fields[]=author_name</code></z><z id="t1601051406" t="souenzzo [:attrs {:href &quot;/_/_/users/UDBM9Q0VC&quot;}] you end up re-writting (a part of) graphql"><y>#</y><d>2020-09-25</d><h>16:30</h><w>souenzzo</w><a>@christian.gonzalez</a> you end up re-writting (a part of) graphql</z><z id="t1601051454" t="chrisulloa [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] true 😂"><y>#</y><d>2020-09-25</d><h>16:30</h><w>chrisulloa</w><a>@souenzzo</a> true <b>😂</b></z><z id="t1601051518" t="souenzzo #pathom has a &quot;nested select-keys&quot;, that may help you https://blog.wsscode.com/pathom/v2/pathom/2.2.0/other-helpers.html"><y>#</y><d>2020-09-25</d><h>16:31</h><w>souenzzo</w>#pathom has a &quot;nested select-keys&quot;, that may help you
<a href="https://blog.wsscode.com/pathom/v2/pathom/2.2.0/other-helpers.html" target="_blank">https://blog.wsscode.com/pathom/v2/pathom/2.2.0/other-helpers.html</a></z><z id="t1601051557" t="chrisulloa thank you! checking that out, not sure yet if i need to specify nested keys"><y>#</y><d>2020-09-25</d><h>16:32</h><w>chrisulloa</w>thank you! checking that out, not sure yet if i need to specify nested keys</z><z id="t1601303427" t="emccue what is the difference between io.pedestal.log and clojure.tools.logging?"><y>#</y><d>2020-09-28</d><h>14:30</h><w>emccue</w>what is the difference between io.pedestal.log and clojure.tools.logging?</z><z id="t1601303437" t="emccue does it matter which one I use?"><y>#</y><d>2020-09-28</d><h>14:30</h><w>emccue</w>does it matter which one I use?</z><z id="t1601303718" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] io.pedestal.log is the logging lib provided by Pedestal. When you create a new pedestal service, it’s a dependency since Pedestal uses it internally. Pedestal.log defaults to sljf4j-based logging by default but takes a data-centric approach to logging. It’s api is different that clojure.tools.logging but they both provide similarly named log-level macros"><y>#</y><d>2020-09-28</d><h>14:35</h><w>ddeaguiar</w><a>@emccue</a> <code>io.pedestal.log</code> is the logging lib provided by Pedestal. When you create a new pedestal service, it’s a dependency since Pedestal uses it internally. Pedestal.log defaults to sljf4j-based logging by default but takes a data-centric approach to logging. It’s api is different that clojure.tools.logging but they both provide similarly named log-level macros</z><z id="t1601304317" t="emccue So for my purposes I can just use either and both will go through logback right? I don&apos;t need to refactor all my logs?"><y>#</y><d>2020-09-28</d><h>14:45</h><w>emccue</w>So for my purposes I can just use either and both will go through logback right? I don&apos;t need to refactor all my logs?</z><z id="t1601304514" t="ddeaguiar If you already have clojure.tools.logging in place then you can continue to use that. The same logback config will be used"><y>#</y><d>2020-09-28</d><h>14:48</h><w>ddeaguiar</w>If you already have clojure.tools.logging in place then you can continue to use that. The same logback config will be used</z><z id="t1601304664" t="emccue (I probably will use the data driven api going forward)"><y>#</y><d>2020-09-28</d><h>14:51</h><w>emccue</w>(I probably will use the data driven api going forward)</z><z id="t1601416778" t="abdullahibra Hi everyone,"><y>#</y><d>2020-09-29</d><h>21:59</h><w>abdullahibra</w>Hi everyone,</z><z id="t1601416848" t="abdullahibra can i achieve that /company/:company-id/department/:department-id in routes of pedestal along with separate routes for company routes as /company/:company-id ?"><y>#</y><d>2020-09-29</d><h>22:00</h><w>abdullahibra</w>can i achieve that
 /company/:company-id/department/:department-id in routes of pedestal along with separate routes for company routes as
/company/:company-id ?</z><z id="t1601446401" t="thumbnail Yes, you can at least do it with the linear router. Make sure to take the order into account (shorter route first)"><y>#</y><d>2020-09-30</d><h>06:13</h><r>thumbnail</r>Yes, you can at least do it with the linear router. Make sure to take the order into account (shorter route first)</z><z id="t1601469599" t="ddeaguiar See http://pedestal.io/reference/using-the-builtin-routers for more info"><y>#</y><d>2020-09-30</d><h>12:39</h><r>ddeaguiar</r>See <a href="http://pedestal.io/reference/using-the-builtin-routers" target="_blank">http://pedestal.io/reference/using-the-builtin-routers</a> for more info</z><z id="t1601434467" t="dehli hello, i have an overall question about interceptors. if you have an interceptor that depends on another interceptor is there a way that’s represented? i was thinking that the dependency could be enforced by checking if the expected value is there and if not, then inject the required interceptor. is there some better way? Basically what I’m doing now is: (def my-interceptor {:enter (fn [{:keys [required-key] :as ctx}] (if (nil? required-key) (inject-then-reexecute ctx required-key-interceptor) (continue-with-execution ctx)))}) And inject-then-reexecute will move the current interceptor from the stack back to the queue and then add whatever the dependency interceptor is"><y>#</y><d>2020-09-30</d><h>02:54</h><w>dehli</w>hello, i have an overall question about interceptors. if you have an interceptor that depends on another interceptor is there a way that’s represented? i was thinking that the dependency could be enforced by checking if the expected value is there and if not, then inject the required interceptor. is there some better way?

Basically what I’m doing now is:

<pre>(def my-interceptor
  {:enter (fn [{:keys [required-key] :as ctx}]
            (if (nil? required-key)
              (inject-then-reexecute ctx required-key-interceptor)
              (continue-with-execution ctx)))})</pre>
And <code>inject-then-reexecute</code> will move the current interceptor from the stack back to the queue and then add whatever the dependency interceptor is</z><z id="t1601446533" t="thumbnail I would consider the missing interceptor a bug, so if anything, I&apos;d throw an exception stating exactly that (&quot;missing xyz in context. Is interceptor-xyz setup?&quot;)"><y>#</y><d>2020-09-30</d><h>06:15</h><r>thumbnail</r>I would consider the missing interceptor a bug, so if anything, I&apos;d throw an exception stating exactly that (&quot;missing xyz in context. Is interceptor-xyz setup?&quot;)</z><z id="t1601467653" t="dehli Thanks! That makes sense. I like that better!"><y>#</y><d>2020-09-30</d><h>12:07</h><r>dehli</r>Thanks! That makes sense. I like that better!</z><z id="t1601550980" t="oliy i wrote a little library many years ago to help deal with this https://github.com/oliyh/angel-interceptor"><y>#</y><d>2020-10-01</d><h>11:16</h><r>oliy</r>i wrote a little library many years ago to help deal with this <a href="https://github.com/oliyh/angel-interceptor" target="_blank">https://github.com/oliyh/angel-interceptor</a></z><z id="t1601593364" t="dehli Awesome, thanks for sharing! Will check it out"><y>#</y><d>2020-10-01</d><h>23:02</h><r>dehli</r>Awesome, thanks for sharing! Will check it out</z><z id="t1601534040" t="emccue Probably a decently common problem"><y>#</y><d>2020-10-01</d><h>06:34</h><w>emccue</w>Probably a decently common problem</z><z id="t1601534043" t="emccue"><y>#</y><d>2020-10-01</d><h>06:34</h><w>emccue</w></z><z id="t1601534047" t="emccue I have some images in s3"><y>#</y><d>2020-10-01</d><h>06:34</h><w>emccue</w>I have some images in s3</z><z id="t1601534065" t="emccue and I want to send them to the user"><y>#</y><d>2020-10-01</d><h>06:34</h><w>emccue</w>and I want to send them to the user</z><z id="t1601534089" t="emccue"><y>#</y><d>2020-10-01</d><h>06:34</h><w>emccue</w></z><z id="t1601534100" t="emccue right now I have a basic handler that finds the right file"><y>#</y><d>2020-10-01</d><h>06:35</h><w>emccue</w>right now I have a basic handler that finds the right file</z><z id="t1601534143" t="emccue"><y>#</y><d>2020-10-01</d><h>06:35</h><w>emccue</w></z><z id="t1601534149" t="emccue and gets the contents as an input stream"><y>#</y><d>2020-10-01</d><h>06:35</h><w>emccue</w>and gets the contents as an input stream</z><z id="t1601534178" t="emccue does anyone know why this is so slow and how can I improve it?"><y>#</y><d>2020-10-01</d><h>06:36</h><w>emccue</w>does anyone know why this is so slow and how can I improve it?</z><z id="t1601539917" t="Karol Wójcik What for you’re proxying the image? Wouldn’t be easier to just send url to resource?"><y>#</y><d>2020-10-01</d><h>08:11</h><r>Karol Wójcik</r>What for you’re proxying the image? Wouldn’t be easier to just send url to resource?</z><z id="t1601540006" t="Karol Wójcik https://stackoverflow.com/a/33605888 that should be helpful."><y>#</y><d>2020-10-01</d><h>08:13</h><r>Karol Wójcik</r><a href="https://stackoverflow.com/a/33605888" target="_blank">https://stackoverflow.com/a/33605888</a> that should be helpful.</z><z id="t1601551552" t="emccue I had no clue about the presigned url thing"><y>#</y><d>2020-10-01</d><h>11:25</h><r>emccue</r>I had no clue about the presigned url thing</z><z id="t1601554028" t="emccue It seems like a nightmarish tunnel of CORS so far"><y>#</y><d>2020-10-01</d><h>12:07</h><r>emccue</r>It seems like a nightmarish tunnel of CORS so far</z><z id="t1601565219" t="Joe Lane [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] You could also serve the images through the cloudfront CDN Backed by S3. Can include auth and everything, then your webservers aren&apos;t burdened with all that io / memory usage."><y>#</y><d>2020-10-01</d><h>15:13</h><w>Joe Lane</w><a>@emccue</a> You could also serve the images through the cloudfront CDN Backed by S3. Can include auth and everything, then your webservers aren&apos;t burdened with all that io / memory usage.</z><z id="t1601580767" t="emccue What is the cost of this approach vs S3?"><y>#</y><d>2020-10-01</d><h>19:32</h><r>emccue</r>What is the cost of this approach vs S3?</z><z id="t1601580782" t="emccue I&apos;ve never used cloudfront CDN before"><y>#</y><d>2020-10-01</d><h>19:33</h><r>emccue</r>I&apos;ve never used cloudfront CDN before</z><z id="t1601580836" t="Joe Lane How do you want to measure it?"><y>#</y><d>2020-10-01</d><h>19:33</h><r>Joe Lane</r>How do you want to measure it?</z><z id="t1601580852" t="Joe Lane Time? Dollars? Complexity? Performance?"><y>#</y><d>2020-10-01</d><h>19:34</h><r>Joe Lane</r>Time? Dollars? Complexity? Performance?</z><z id="t1601566447" t="Janne Sauvala Sorry for hijacking the above discussion but it is close to a problem I have been thinking. How about the other way around when you want the user to be able to save images to S3 and store information about that image to your DB (user abc112 has uploaded image cat-foobar.jpg). One option is that the frontend client directly stores the image to S3 and then reports to backend API that image was stored with a name X. But these two operations are not atomic and if the image upload is successful and backend API call fails then I have an image in S3 that does not have DB record. Any thoughts how this could be solved?"><y>#</y><d>2020-10-01</d><h>15:34</h><w>Janne Sauvala</w>Sorry for hijacking the above discussion but it is close to a problem I have been thinking. How about the other way around when you want the user to be able to save images to S3 and store information about that image to your DB (user abc112 has uploaded image cat-foobar.jpg). One option is that the frontend client directly stores the image to S3 and then reports to backend API that image was stored with a name X. But these two operations are not atomic and if the image upload is successful and backend API call fails then I have an image in S3 that does not have DB record. Any thoughts how this could be solved?</z><z id="t1601567343" t="isak One way is to have them upload to an s3 bucket that gets autowiped after a day (or something) (There are lifecycle policies that enable this, IIRC). Then if you get the acknowledgement that they successfully uploaded, move that object to your real storage bucket."><y>#</y><d>2020-10-01</d><h>15:49</h><r>isak</r>One way is to have them upload to an s3 bucket that gets autowiped after a day (or something) (There are lifecycle policies that enable this, IIRC). Then if you get the acknowledgement that they successfully uploaded, move that object to your real storage bucket.</z><z id="t1601567723" t="emccue I am gonna be doing this too"><y>#</y><d>2020-10-01</d><h>15:55</h><r>emccue</r>I am gonna be doing this too</z><z id="t1601567982" t="emccue My current plan to handle this is to somehow have the user&apos;s upload be key&apos;ed under a uuid"><y>#</y><d>2020-10-01</d><h>15:59</h><r>emccue</r>My current plan to handle this is to somehow have the user&apos;s upload be key&apos;ed under a uuid</z><z id="t1601567989" t="emccue and then who cares"><y>#</y><d>2020-10-01</d><h>15:59</h><r>emccue</r>and then who cares</z><z id="t1601568016" t="emccue and I can run a background job to clean it up later, if my bill goes too high or something"><y>#</y><d>2020-10-01</d><h>16:00</h><r>emccue</r>and I can run a background job to clean it up later, if my bill goes too high or something</z><z id="t1601568256" t="Joe Lane You can use an s3 lambda trigger to call your API / put a message onto SQS that adds that record to your database."><y>#</y><d>2020-10-01</d><h>16:04</h><r>Joe Lane</r>You can use an s3 lambda trigger to call your API / put a message onto SQS that adds that record to your database.</z><z id="t1601568530" t="Janne Sauvala Good ideas, thanks!"><y>#</y><d>2020-10-01</d><h>16:08</h><r>Janne Sauvala</r>Good ideas, thanks!</z><z id="t1601567451" t="abdullahibra Hello everyone,"><y>#</y><d>2020-10-01</d><h>15:50</h><w>abdullahibra</w>Hello everyone,</z><z id="t1601567506" t="abdullahibra i&apos;m using vector based routes, how can i pass not common interceptors for get and post for the same route"><y>#</y><d>2020-10-01</d><h>15:51</h><w>abdullahibra</w>i&apos;m using vector based routes, how can i pass not common interceptors for get and post for the same route</z><z id="t1601567563" t="abdullahibra for example: [&quot;/company&quot; {:get company/get-all :post [:create-company company/create!]} ^:interceptors [auth]]"><y>#</y><d>2020-10-01</d><h>15:52</h><w>abdullahibra</w>for example:
[&quot;/company&quot; {:get company/get-all :post [:create-company company/create!]} ^:interceptors [auth]]</z><z id="t1601567607" t="abdullahibra now how can i add new interceptor for post for example: validate-new-company"><y>#</y><d>2020-10-01</d><h>15:53</h><w>abdullahibra</w>now how can i add new interceptor for post for example: validate-new-company</z><z id="t1601567608" t="abdullahibra ?"><y>#</y><d>2020-10-01</d><h>15:53</h><w>abdullahibra</w>?</z><z id="t1601567657" t="abdullahibra i assume interceptors defined as metadata for get and post for company are common"><y>#</y><d>2020-10-01</d><h>15:54</h><w>abdullahibra</w>i assume interceptors defined as metadata for get and post for company are common</z><z id="t1601567677" t="abdullahibra but i only want to apply validate-new-company for only post"><y>#</y><d>2020-10-01</d><h>15:54</h><w>abdullahibra</w>but i only want to apply validate-new-company for only post</z><z id="t1601568177" t="emccue (also maybe a good trigger point to have this not be empty)"><y>#</y><d>2020-10-01</d><h>16:02</h><w>emccue</w>(also maybe a good trigger point to have this not be empty)</z><z id="t1601568179" t="emccue http://pedestal.io/guides/uploading-files"><y>#</y><d>2020-10-01</d><h>16:02</h><w>emccue</w><a href="http://pedestal.io/guides/uploading-files" target="_blank">http://pedestal.io/guides/uploading-files</a></z><z id="t1601568206" t="emccue (considering its the third result on google right after example repos)"><y>#</y><d>2020-10-01</d><h>16:03</h><w>emccue</w>(considering its the third result on google right after example repos)</z><z id="t1601573587" t="dangercoder I found something when using pedestal. The first request (when i boot up the web server) always takes a long time (1 seconds~) then it&apos;s 20-40ms 🙂 What could be the cause?"><y>#</y><d>2020-10-01</d><h>17:33</h><w>dangercoder</w>I found something when using pedestal. The first request (when i boot up the web server) always takes a long time (1 seconds~) then it&apos;s 20-40ms <b>🙂</b>

What could be the cause?</z><z id="t1601573669" t="dangercoder This is on localhost without TLS."><y>#</y><d>2020-10-01</d><h>17:34</h><r>dangercoder</r>This is on localhost without TLS.</z><z id="t1601585784" t="emccue"><y>#</y><d>2020-10-01</d><h>20:56</h><w>emccue</w></z><z id="t1601585794" t="emccue somewhat confused why json params would be a map of string-&gt;string"><y>#</y><d>2020-10-01</d><h>20:56</h><w>emccue</w>somewhat confused why json params would be a map of string-&gt;string</z><z id="t1601585830" t="emccue since [1, 2, 3] is valid json"><y>#</y><d>2020-10-01</d><h>20:57</h><w>emccue</w>since <code>[1, 2, 3]</code>  is valid json</z><z id="t1601585836" t="emccue and so is {&quot;a&quot;: 10}"><y>#</y><d>2020-10-01</d><h>20:57</h><w>emccue</w>and so is <code>{&quot;a&quot;: 10}</code></z><z id="t1601586122" t="emccue is this just a docs mistake?"><y>#</y><d>2020-10-01</d><h>21:02</h><w>emccue</w>is this just a docs mistake?</z><z id="t1601663001" t="souenzzo For is. It shoud be any? JSON also allow values like 42 true false &quot;s&quot;"><y>#</y><d>2020-10-02</d><h>18:23</h><r>souenzzo</r>For is.
It shoud be <code>any?</code>
JSON also allow values like <code>42 true false &quot;s&quot;</code></z><z id="t1601657124" t="abdullahibra Hi"><y>#</y><d>2020-10-02</d><h>16:45</h><w>abdullahibra</w>Hi</z><z id="t1601657135" t="abdullahibra is there anybody experienced that error:"><y>#</y><d>2020-10-02</d><h>16:45</h><w>abdullahibra</w>is there anybody experienced that error:</z><z id="t1601657141" t="abdullahibra #error { :cause Assert failed: In row 1, there were unused elements (:route-name :bucket-update). The whole route was: [&quot;/buckets/:id&quot; :patch [{:name :buckets-api.app.interceptors/valid-json?, :leave #object[buckets_api.app.interceptors$fn__1002 0x4d2950ed &quot;buckets_api.app.interceptors$fn__1002@4d2950ed&quot;]} #Interceptor{:name :io.pedestal.http.ring-middlewares/multipart-params} #Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/json-body} buckets-api.app.auth/auth buckets-api.app.routes.buckets/validate-bucket-id buckets-api.app.routes.buckets/validate-update-bucket buckets-api.app.handlers.buckets/update!] :constraints {:id #&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;} :route-name :bucket-update] (empty? (:remaining ctx)) :via [{:type clojure.lang.Compiler$CompilerException :message Syntax error macroexpanding at (service.clj:72:29). :data #:clojure.error{:phase :execution, :line 72, :column 29, :source service.clj} :at [clojure.lang.Compiler$InvokeExpr eval Compiler.java 3707]} {:type java.lang.AssertionError :message Assert failed: In row 1, there were unused elements (:route-name :bucket-update)."><y>#</y><d>2020-10-02</d><h>16:45</h><w>abdullahibra</w><pre>#error {
 :cause Assert failed: In row 1, there were unused elements (:route-name :bucket-update).
The whole route was: [&quot;/buckets/:id&quot; :patch [{:name :buckets-api.app.interceptors/valid-json?, :leave #object[buckets_api.app.interceptors$fn__1002 0x4d2950ed &quot;buckets_api.app.interceptors$fn__1002@4d2950ed&quot;]} #Interceptor{:name :io.pedestal.http.ring-middlewares/multipart-params} #Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/json-body} buckets-api.app.auth/auth buckets-api.app.routes.buckets/validate-bucket-id buckets-api.app.routes.buckets/validate-update-bucket buckets-api.app.handlers.buckets/update!] :constraints {:id #&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;} :route-name :bucket-update]
(empty? (:remaining ctx))
 :via
 [{:type clojure.lang.Compiler$CompilerException
   :message Syntax error macroexpanding at (service.clj:72:29).
   :data #:clojure.error{:phase :execution, :line 72, :column 29, :source service.clj}
   :at [clojure.lang.Compiler$InvokeExpr eval Compiler.java 3707]}
  {:type java.lang.AssertionError
   :message Assert failed: In row 1, there were unused elements (:route-name :bucket-update).</pre></z><z id="t1601964113" t="mavbozo [:attrs {:href &quot;/_/_/users/U145X0BPE&quot;}] i can reproduce that error with code below. you have to put :route-name before :constraints (defn respond-hello &quot;&quot; [request] {:status 200 :body &quot;Hello, world&quot;}) (defn greet [req] {:status 200 :body &quot;Greet&quot;}) (def routes (route/expand-routes #{[&quot;/hello&quot; :get [respond-hello] :route-name :hello] [&quot;/greet/:id&quot; :get [{:name :greet :enter greet}] :constraints {:id #&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;} :route-name :greet ]})) "><y>#</y><d>2020-10-06</d><h>06:01</h><w>mavbozo</w><a>@abdullahibra</a> i can reproduce that error with code below. you have to put <code>:route-name</code> before <code>:constraints</code>
<pre>(defn respond-hello
  &quot;&quot;
  [request]
  {:status 200 :body &quot;Hello, world&quot;})

(defn greet
  [req] {:status 200 :body &quot;Greet&quot;})

(def routes
  (route/expand-routes
   #{[&quot;/hello&quot; :get [respond-hello] :route-name :hello]
     [&quot;/greet/:id&quot; :get [{:name :greet :enter greet}]
      :constraints {:id #&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&quot;}
      :route-name :greet ]})) </pre></z><z id="t1601964159" t="mavbozo error: #error { :cause &quot;Assert failed: In row 2, there were unused elements (:route-name :greet).\nThe whole route was: [\&quot;/greet/:id\&quot; :get [{:name :greet, :enter #function[mavp.foo/greet]}] :constraints {:id #\&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\&quot;} :route-name :greet]\n(empty? (:remaining ctx))&quot; :via [{:type clojure.lang.Compiler$CompilerException :message &quot;Syntax error macroexpanding at (form-init15957751344353533874.clj:15:3).&quot; :data #:clojure.error{:phase :execution, :line 15, :column 3, :source &quot;form-init15957751344353533874.clj&quot;}"><y>#</y><d>2020-10-06</d><h>06:02</h><w>mavbozo</w>error:
<pre>#error {
 :cause &quot;Assert failed: In row 2, there were unused elements (:route-name :greet).\nThe whole route was: [\&quot;/greet/:id\&quot; :get [{:name :greet, :enter #function[mavp.foo/greet]}] :constraints {:id #\&quot;[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\&quot;} :route-name :greet]\n(empty? (:remaining ctx))&quot;
 :via
 [{:type clojure.lang.Compiler$CompilerException
   :message &quot;Syntax error macroexpanding at (form-init15957751344353533874.clj:15:3).&quot;
   :data #:clojure.error{:phase :execution, :line 15, :column 3, :source &quot;form-init15957751344353533874.clj&quot;}</pre></z><z id="t1601970626" t="abdullahibra [:attrs {:href &quot;/_/_/users/U075CCMPY&quot;}] perfect, Thank you 🙂"><y>#</y><d>2020-10-06</d><h>07:50</h><w>abdullahibra</w><a>@mavbozo</a> perfect, Thank you <b>🙂</b></z><z id="t1602014653" t="emccue So really basic question about servlet interceptors"><y>#</y><d>2020-10-06</d><h>20:04</h><w>emccue</w>So really basic question about servlet interceptors</z><z id="t1602014654" t="emccue https://www.eclipse.org/jetty/javadoc/9.4.32.v20200930/org/eclipse/jetty/servlets/DoSFilter.html"><y>#</y><d>2020-10-06</d><h>20:04</h><w>emccue</w><a href="https://www.eclipse.org/jetty/javadoc/9.4.32.v20200930/org/eclipse/jetty/servlets/DoSFilter.html" target="_blank">https://www.eclipse.org/jetty/javadoc/9.4.32.v20200930/org/eclipse/jetty/servlets/DoSFilter.html</a></z><z id="t1602014658" t="emccue say i wanted to add this"><y>#</y><d>2020-10-06</d><h>20:04</h><w>emccue</w>say i wanted to add this</z><z id="t1602014707" t="emccue from what i infer from the docs, I would have my service map"><y>#</y><d>2020-10-06</d><h>20:05</h><w>emccue</w>from what i infer from the docs, I would have my service map</z><z id="t1602014742" t="emccue (-&gt; {::http/routes (if (config/production? config) (routes system) (fn [] (routes system))) ::http/port (config/server-port config) ::http/host (if (config/production? config) &quot;0.0.0.0&quot; &quot;localhost&quot;) ::http/type :jetty ...} (add-servlet-filter {:filter DoSFilter}))"><y>#</y><d>2020-10-06</d><h>20:05</h><w>emccue</w><pre>(-&gt; {::http/routes (if (config/production? config)
                         (routes system)
                         (fn [] (routes system)))
         ::http/port (config/server-port config)
         ::http/host (if (config/production? config)
                       &quot;0.0.0.0&quot;
                       &quot;localhost&quot;)
         ::http/type :jetty
         ...}
   (add-servlet-filter {:filter DoSFilter}))</pre></z><z id="t1602015014" t="emccue is there a way to configure it not via an xml config?"><y>#</y><d>2020-10-06</d><h>20:10</h><w>emccue</w>is there a way to configure it not via an xml config?</z><z id="t1602015019" t="emccue &lt;filter&gt; &lt;filter-name&gt;DoSFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.eclipse.jetty.servlets.DoSFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;maxRequestsPerSec&lt;/param-name&gt; &lt;param-value&gt;30&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt;"><y>#</y><d>2020-10-06</d><h>20:10</h><w>emccue</w><pre>&lt;filter&gt;
   &lt;filter-name&gt;DoSFilter&lt;/filter-name&gt;
   &lt;filter-class&gt;org.eclipse.jetty.servlets.DoSFilter&lt;/filter-class&gt;
   &lt;init-param&gt;
     &lt;param-name&gt;maxRequestsPerSec&lt;/param-name&gt;
     &lt;param-value&gt;30&lt;/param-value&gt;
   &lt;/init-param&gt;
 &lt;/filter&gt;</pre></z><z id="t1602015023" t="emccue https://www.eclipse.org/jetty/documentation/current/dos-filter.html"><y>#</y><d>2020-10-06</d><h>20:10</h><w>emccue</w><a href="https://www.eclipse.org/jetty/documentation/current/dos-filter.html" target="_blank">https://www.eclipse.org/jetty/documentation/current/dos-filter.html</a></z><z id="t1602018860" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] you should be able to configure it in code. Initialize the filter with relevant values then add it"><y>#</y><d>2020-10-06</d><h>21:14</h><w>ddeaguiar</w><a>@emccue</a> you should be able to configure it in code. Initialize the filter with relevant values then add it</z><z id="t1602515353" t="Aleh Atsman Hello everyone, I am working on project based on pedestal and I am having strange issue with routing. My route configuration looks like that: [&quot;/team&quot; {:post `create-team} [&quot;/users&quot; {:get `get-users}] [&quot;/:team-id&quot; {:delete `delete-team :put `update-team}]] For some reason, when I try to send GET req to /team/users it returns 404. If I add get handler for &quot;/team/:team-id&quot; it got called instead of /users even thou I send request to /team/users . Why do those routes conflict? I didn&apos;t specify get handler for /:team-id , so why does it conflict and what can I do about it?"><y>#</y><d>2020-10-12</d><h>15:09</h><w>Aleh Atsman</w>Hello everyone,

I am working on project based on pedestal and I am having strange issue with routing. My route configuration looks like that:
<pre>[&quot;/team&quot;
 {:post `create-team}
 [&quot;/users&quot;
  {:get `get-users}]
 [&quot;/:team-id&quot;
  {:delete `delete-team
   :put `update-team}]]</pre>
For some reason, when I try to send GET req to <code>/team/users</code> it returns 404. If I add get handler for &quot;/team/:team-id&quot; it got called instead of <code>/users</code> even thou I send request to <code>/team/users</code> .

Why do those routes conflict? I didn&apos;t specify get handler for <code>/:team-id</code> , so why does it conflict and what can I do about it?</z><z id="t1602515555" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U4N27TADS&quot;}] use the linear search router. See http://pedestal.io/reference/linear-search-router"><y>#</y><d>2020-10-12</d><h>15:12</h><w>ddeaguiar</w><a>@aleh_atsman</a> use the linear search router. See <a href="http://pedestal.io/reference/linear-search-router" target="_blank">http://pedestal.io/reference/linear-search-router</a></z><z id="t1602515589" t="ddeaguiar See Caveats here http://pedestal.io/reference/prefix-tree-router#_caveats"><y>#</y><d>2020-10-12</d><h>15:13</h><w>ddeaguiar</w>See Caveats here <a href="http://pedestal.io/reference/prefix-tree-router#_caveats" target="_blank">http://pedestal.io/reference/prefix-tree-router#_caveats</a></z><z id="t1602515620" t="ddeaguiar re: prefix tree router which is the default"><y>#</y><d>2020-10-12</d><h>15:13</h><w>ddeaguiar</w>re: prefix tree router which is the default</z><z id="t1602515808" t="Aleh Atsman [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] thx for fast reply!"><y>#</y><d>2020-10-12</d><h>15:16</h><w>Aleh Atsman</w><a>@ddeaguiar</a> thx for fast reply!</z><z id="t1603235138" t="hadils Hi. Is there any way to measure the time spent on each :enter and :leave functions in each pedestal interceptor? I am using Lacinia-Pedestal and I don&apos;t want to dig into Lacinia&apos;s code to make changes if I don&apos;t have to..."><y>#</y><d>2020-10-20</d><h>23:05</h><w>hadils</w>Hi. Is there any way to measure the time spent on each <code>:enter</code> and <code>:leave</code> functions in each pedestal interceptor? I am using Lacinia-Pedestal and I don&apos;t want to dig into Lacinia&apos;s code to make changes if I don&apos;t have to...</z><z id="t1603293864" t="ddeaguiar [:attrs {:href &quot;/_/_/users/UGNMGFJG3&quot;}] unfortunately the interceptor chain implementation does not provide such information nor an ability to hook into interceptor chain execution."><y>#</y><d>2020-10-21</d><h>15:24</h><r>ddeaguiar</r><a>@UGNMGFJG3</a> unfortunately the interceptor chain implementation does not provide such information nor an ability to hook into interceptor chain execution.</z><z id="t1603293994" t="hadils Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2020-10-21</d><h>15:26</h><r>hadils</r>Thanks <a>@U0FL657GR</a></z><z id="t1603270143" t="simongray Does Pedestal have anything to help with SAML single sign-on?"><y>#</y><d>2020-10-21</d><h>08:49</h><w>simongray</w>Does Pedestal have anything to help with SAML single sign-on?</z><z id="t1603294194" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] Pedestal provides the base implementation for creating services. Authentication needs are best handled by interceptors and the needs vary based on the project. If there’s not a library which provides a Pedestal interceptor or Ring middleware for this, it should be straight forward to craft an interceptor based on a lower-level, third party implementation. The Pedestal buddy-auth https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth provides an example of how to wire in authentication."><y>#</y><d>2020-10-21</d><h>15:29</h><r>ddeaguiar</r><a>@U4P4NREBY</a> Pedestal provides the base implementation for creating services. Authentication needs are best handled by interceptors and the needs vary based on the project. If there’s not a library which provides a Pedestal interceptor or Ring middleware for this, it should be straight forward to craft an interceptor based on a lower-level, third party implementation. The Pedestal buddy-auth <a href="https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/buddy-auth</a> provides an example of how to wire in authentication.</z><z id="t1603294262" t="simongray Thanks Dan, that’s pretty helpful. Hope you’re doing well. :)"><y>#</y><d>2020-10-21</d><h>15:31</h><r>simongray</r>Thanks Dan, that’s pretty helpful. Hope you’re doing well. :)</z><z id="t1603294377" t="ddeaguiar I am! Glad to see you’re giving Pedestal a spin! Hope all is well in Denmark 🙂"><y>#</y><d>2020-10-21</d><h>15:32</h><r>ddeaguiar</r>I am! Glad to see you’re giving Pedestal a spin! Hope all is well in Denmark <b>🙂</b></z><z id="t1603642152" t="Louis Kottmann hello, I read around but I do not understand how can I make pedestal&apos;s log/info macro to just output a string i.e: right now I have to call (log/info :msg &quot;hello&quot;) which writes out: INFO louisbot-ssj2.api.slack - {:msg &quot;hello&quot;, :line 78} and I would like to call (log/info &quot;hello&quot;) that should output INFO louisbot-ssj2.api.slack - hello (there could be a (L78) as well but I don&apos;t mind giving it up) how may I acheive this?"><y>#</y><d>2020-10-25</d><h>16:09</h><w>Louis Kottmann</w>hello, I read around but I do not understand how can I make pedestal&apos;s <code>log/info</code> macro to just output a string
i.e: right now I have to call <code>(log/info :msg &quot;hello&quot;)</code>
which writes out: <code>INFO  louisbot-ssj2.api.slack  - {:msg &quot;hello&quot;, :line 78}</code>
and I would like to call <code>(log/info &quot;hello&quot;)</code>
that should output <code>INFO  louisbot-ssj2.api.slack  - hello</code> (there could be a <code>(L78)</code> as well but I don&apos;t mind giving it up)
how may I acheive this?</z><z id="t1603691243" t="orestis You have to configure a handler in logback I think "><y>#</y><d>2020-10-26</d><h>05:47</h><w>orestis</w>You have to configure a handler in logback I think </z><z id="t1603691347" t="orestis I don’t think you can avoid the :msg argument though. That’s inherent in the macro, it needs key value pairs. I’d write my own macro or use something else if it’s a requirement. "><y>#</y><d>2020-10-26</d><h>05:49</h><w>orestis</w>I don’t think you can avoid the :msg argument though. That’s inherent in the macro, it needs key value pairs. I’d write my own macro or use something else if it’s a requirement. </z><z id="t1603691490" t="orestis Actually, you can use :io.pedestal.log/formatter to encode the arguments in your own way"><y>#</y><d>2020-10-26</d><h>05:51</h><w>orestis</w>Actually, you can use :io.pedestal.log/formatter to encode the arguments in your own way</z><z id="t1603713547" t="Louis Kottmann thanks I&apos;ll try that tonight"><y>#</y><d>2020-10-26</d><h>11:59</h><w>Louis Kottmann</w>thanks I&apos;ll try that tonight</z><z id="t1603714995" t="Louis Kottmann I just tried actually and it&apos;s perfect, thank you!"><y>#</y><d>2020-10-26</d><h>12:23</h><w>Louis Kottmann</w>I just tried actually and it&apos;s perfect, thank you!</z><z id="t1604326750" t="simongray I don’t understand how to get https working and I can’t find any sample code. My understanding is that this is a minimal configuration: (def service-map (let [home (System/getProperty &quot;user.home&quot;) jks (str home &quot;/_certifiable_certs/localhost-1d070e4/dev-server.jks&quot;)] {::http/routes routes ::http/type :jetty ::http/port 8890 ;; Development-only keystore created using Bruce Hauman&apos;s Certifiable. ;; ::http/container-options {:ssl? true :ssl-port 443 :keystore jks :key-password &quot;password&quot;}})) but attempting to start the server using this service map results in Execution error (BindException) at (Net.java:-2). Permission denied what am I missing here…?"><y>#</y><d>2020-11-02</d><h>14:19</h><w>simongray</w>I don’t understand how to get https working and I can’t find any sample code. My understanding is that this is a minimal configuration:
<pre>(def service-map
  (let [home (System/getProperty &quot;user.home&quot;)
        jks  (str home &quot;/_certifiable_certs/localhost-1d070e4/dev-server.jks&quot;)]
    {::http/routes            routes
     ::http/type              :jetty
     ::http/port              8890

     ;; Development-only keystore created using Bruce Hauman&apos;s Certifiable.
     ;; 
     ::http/container-options {:ssl?         true
                               :ssl-port     443
                               :keystore     jks
                               :key-password &quot;password&quot;}}))</pre>
but attempting to start the server using this service map results in
<pre>Execution error (BindException) at  (Net.java:-2).
Permission denied </pre>
what am I missing here…?</z><z id="t1604326785" t="ddeaguiar Running locally?"><y>#</y><d>2020-11-02</d><h>14:19</h><w>ddeaguiar</w>Running locally?</z><z id="t1604326787" t="simongray yes"><y>#</y><d>2020-11-02</d><h>14:19</h><w>simongray</w>yes</z><z id="t1604326817" t="ddeaguiar The process doesn’t have permissions to run on port 443"><y>#</y><d>2020-11-02</d><h>14:20</h><w>ddeaguiar</w>The process doesn’t have permissions to run on port 443</z><z id="t1604326847" t="simongray changing the :ssl-port to literally anything gives me the same exception (edit: anything below 1024 I guess)"><y>#</y><d>2020-11-02</d><h>14:20</h><w>simongray</w>changing the :ssl-port to literally anything gives me the same exception (edit: anything below 1024 I guess)</z><z id="t1604326857" t="ddeaguiar hrm"><y>#</y><d>2020-11-02</d><h>14:20</h><w>ddeaguiar</w>hrm</z><z id="t1604326883" t="ddeaguiar ports less than 1024 require root perms"><y>#</y><d>2020-11-02</d><h>14:21</h><w>ddeaguiar</w>ports less than 1024 require root perms</z><z id="t1604326995" t="simongray aha!"><y>#</y><d>2020-11-02</d><h>14:23</h><w>simongray</w>aha!</z><z id="t1604327031" t="simongray Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I didn’t know that 🙂"><y>#</y><d>2020-11-02</d><h>14:23</h><w>simongray</w>Thanks <a>@ddeaguiar</a> I didn’t know that <b>🙂</b></z><z id="t1604327133" t="ddeaguiar np!"><y>#</y><d>2020-11-02</d><h>14:25</h><w>ddeaguiar</w>np!</z><z id="t1604417259" t="simongray In case the user is trying to access some path that they’re not allowed into, I want my service to short-circuit and return HTTP status 403 immediately. What is the right way to do this? Should I throw an exception in one interceptor and then handle it in another?"><y>#</y><d>2020-11-03</d><h>15:27</h><w>simongray</w>In case the user is trying to access some path that they’re not allowed into, I want my service to short-circuit and return HTTP status 403 immediately. What is the right way to do this? Should I throw an exception in one interceptor and then handle it in another?</z><z id="t1604418288" t="simongray Also, based on http://pedestal.io/guides/hello-world-content-types &gt; One important note here: As soon as any interceptor attaches a response to the context map, Pedestal considers the request handled. Remaining interceptors won’t be called, and only the ones that are already on the stack will have their `:leave` functions called. This is a “short-circuit” behavior like an early-exit in code. I would expect an interceptor chain consisting of two interceptors where the first one attaches a 403 response to short-circuit the chain, but it doesn’t seem to do so? This is the code for the interceptor: (ic/interceptor {:name ::session-guard :enter (fn [ctx] (assoc ctx :response {:status 403}))}) It is the first interceptor in a vector containing two of them. If it is the only interceptor in the chain I get my 403 response, but otherwise it just continues on the to the next interceptor. Kind of unexpected?"><y>#</y><d>2020-11-03</d><h>15:44</h><w>simongray</w>Also, based on <a href="http://pedestal.io/guides/hello-world-content-types" target="_blank">http://pedestal.io/guides/hello-world-content-types</a>
&gt; One important note here: As soon as any interceptor attaches a response to the context map, Pedestal considers the request handled. Remaining interceptors won’t be called, and only the ones that are already on the stack will have their `:leave` functions called. This is a “short-circuit” behavior like an early-exit in code.
I would expect an interceptor chain consisting of two interceptors where the first one attaches a 403 response to short-circuit the chain, but it doesn’t seem to do so? This is the code for the interceptor:
<pre>(ic/interceptor
    {:name  ::session-guard
     :enter (fn [ctx]
              (assoc ctx :response {:status 403}))})</pre>
It is the first interceptor in a vector containing two of them. If it is the only interceptor in the chain I get my 403 response, but otherwise it just continues on the to the next interceptor. Kind of unexpected?</z><z id="t1604418486" t="simongray This is the relevant route: #{[&quot;/guarded&quot; :get [(ic/session-guard conf) (guarded-page)] :route-name ::guarded-page]} (ic/session-guard conf) creates the interceptor that attaches a 403 response, while (guarded-page) creates a ring handler that makes a regular 200 response. When both are present I always get the 200 and if only the first interceptor is there I get the 403. No short-circuiting in sight?"><y>#</y><d>2020-11-03</d><h>15:48</h><w>simongray</w>This is the relevant route:
<pre>#{[&quot;/guarded&quot; :get [(ic/session-guard conf) (guarded-page)] :route-name ::guarded-page]}</pre>
(ic/session-guard conf) creates the interceptor that attaches a 403 response, while (guarded-page) creates a ring handler that makes a regular 200 response. When both are present I always get the 200 and if only the first interceptor is there I get the 403. No short-circuiting in sight?</z><z id="t1604420445" t="simongray So I followed the Pedestal source code all the way to (defn- terminator-inject [context] (interceptor.chain/terminate-when context #(ring-response/response? (:response %)))) Which checks whether the response is a valid Ring response: (defn response? &quot;True if the supplied value is a valid response map.&quot; {:added &quot;1.1&quot;} [resp] (and (map? resp) (integer? (:status resp)) (map? (:headers resp)))) And then I noticed that :headers must be set, so I went and modified my interceptor to also return a headers map: (defn session-guard [{:keys [users]}] (ic/interceptor {:name ::session-guard :enter (fn [ctx] (assoc ctx :response {:status 403 :headers {}}))})) and now it short-circuits as expected 🙂 I would still like to know if it makes more sense to do this as part of error-handling though. Any thoughts? Also, sorry for a wall of text."><y>#</y><d>2020-11-03</d><h>16:20</h><w>simongray</w>So I followed the Pedestal source code all the way to
<pre>(defn- terminator-inject
  [context]
  (interceptor.chain/terminate-when context #(ring-response/response? (:response %))))</pre>
Which checks whether the response is a valid Ring response:
<pre>(defn response?
  &quot;True if the supplied value is a valid response map.&quot;
  {:added &quot;1.1&quot;}
  [resp]
  (and (map? resp)
       (integer? (:status resp))
       (map? (:headers resp))))</pre>
And then I noticed that :headers must be set, so I went and modified my interceptor to also return a headers map:
<pre>(defn session-guard
  [{:keys [users]}]
  (ic/interceptor
    {:name  ::session-guard
     :enter (fn [ctx]
              (assoc ctx :response {:status 403
                                    :headers {}}))}))</pre>
and now it short-circuits as expected <b>🙂</b>
I would still like to know if it makes more sense to do this as part of error-handling though. Any thoughts? Also, sorry for a wall of text.</z><z id="t1604421410" t="souenzzo there is a io.pedestal.http/response? , that is used by the standard not-found-interceptor 😉"><y>#</y><d>2020-11-03</d><h>16:36</h><r>souenzzo</r>there is a <code>io.pedestal.http/response?</code>, that is used by the standard <code>not-found-interceptor</code> <b>😉</b></z><z id="t1604440173" t="simongray seems kind of sloppy that two only slightly different predicate functions are in use for termination and not-found… wonder why?"><y>#</y><d>2020-11-03</d><h>21:49</h><r>simongray</r>seems kind of sloppy that two only slightly different predicate functions are in use for termination and not-found… wonder why?</z><z id="t1604428324" t="Louis Kottmann actually I discovered that if you just assoc a response to the context in an interceptor, it stops the chain right there and sends your response"><y>#</y><d>2020-11-03</d><h>18:32</h><w>Louis Kottmann</w>actually I discovered that if you just <code>assoc</code> a response to the context in an interceptor, it stops the chain right there and sends your response</z><z id="t1604428331" t="Louis Kottmann (assoc context :response (u/forbidden msg))"><y>#</y><d>2020-11-03</d><h>18:32</h><w>Louis Kottmann</w><pre>(assoc context :response (u/forbidden msg))</pre></z><z id="t1604428343" t="orestis There’s also “terminate” http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate"><y>#</y><d>2020-11-03</d><h>18:32</h><w>orestis</w>There’s also “terminate” <a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.chain.html#var-terminate</a></z><z id="t1604428353" t="Louis Kottmann but I wonder if that&apos;s as valid as I tested"><y>#</y><d>2020-11-03</d><h>18:32</h><w>Louis Kottmann</w>but I wonder if that&apos;s as valid as I tested</z><z id="t1604428371" t="Louis Kottmann yeah I did see terminate, but why not just set the response if it&apos;s enough?"><y>#</y><d>2020-11-03</d><h>18:32</h><w>Louis Kottmann</w>yeah I did see terminate, but why not just set the response if it&apos;s enough?</z><z id="t1604428425" t="chrisulloa Yeah the :response value should trigger the short-circuiting. I wasn’t aware of the header requirement, but in our services we always attach content-type headers."><y>#</y><d>2020-11-03</d><h>18:33</h><w>chrisulloa</w>Yeah the :response value should trigger the short-circuiting. I wasn’t aware of the header requirement, but in our services we always attach content-type headers.</z><z id="t1604428491" t="chrisulloa To me throwing an error in your interceptor, then catching it in another error interceptor and returning a 403 seems like a good way to do it. Especially if you are in a place where it’s easier to throw an exception than return a response. But would be interesting to know how other people handle that."><y>#</y><d>2020-11-03</d><h>18:34</h><w>chrisulloa</w>To me throwing an error in your interceptor, then catching it in another error interceptor and returning a 403 seems like a good way to do it. Especially if you are in a place where it’s easier to throw an exception than return a response. But would be interesting to know how other people handle that.</z><z id="t1604428515" t="chrisulloa We usually check permissions at the very beginning of the interceptor stack."><y>#</y><d>2020-11-03</d><h>18:35</h><w>chrisulloa</w>We usually check permissions at the very beginning of the interceptor stack.</z><z id="t1604428520" t="chrisulloa So don’t find myself needing to do that."><y>#</y><d>2020-11-03</d><h>18:35</h><w>chrisulloa</w>So don’t find myself needing to do that.</z><z id="t1604428549" t="Louis Kottmann for the header, I use the :leave interceptor io.pedestal.http/json-body and never had an issue (I never set them manually)"><y>#</y><d>2020-11-03</d><h>18:35</h><w>Louis Kottmann</w>for the header, I use the <code>:leave</code> interceptor <code>io.pedestal.http/json-body</code> and never had an issue (I never set them manually)</z><z id="t1604428628" t="chrisulloa json-body docs Set the Content-Type header to &quot;application/json&quot; and convert the body to JSON if the body is a collection and a type has not been set."><y>#</y><d>2020-11-03</d><h>18:37</h><w>chrisulloa</w>json-body docs
<pre>Set the Content-Type header to &quot;application/json&quot; and convert the body to
JSON if the body is a collection and a type has not been set.</pre></z><z id="t1604487828" t="simongray I was thinking it could make sense to set my own namespaced key in the service map and allow my interceptors to read configuration from that. Is that advisable? And is it even possible for an interceptor to read keys in the service map?"><y>#</y><d>2020-11-04</d><h>11:03</h><w>simongray</w>I was thinking it could make sense to set my own namespaced key in the service map and allow my interceptors to read configuration from that. Is that advisable? And is it even possible for an interceptor to read keys in the service map?</z><z id="t1604489552" t="souenzzo I use this add-service-map in most of the apps that i develop https://github.com/souenzzo/graph-demo/blob/master/src/main/souenzzo/graph_demo/core.clj#L156"><y>#</y><d>2020-11-04</d><h>11:32</h><r>souenzzo</r>I use this add-service-map in most of the apps that i develop

<a href="https://github.com/souenzzo/graph-demo/blob/master/src/main/souenzzo/graph_demo/core.clj#L156" target="_blank">https://github.com/souenzzo/graph-demo/blob/master/src/main/souenzzo/graph_demo/core.clj#L156</a></z><z id="t1604490010" t="simongray [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Perfect! I guess this does not come built in then. Do you also keep your own custom keys in the service map or do you just this interceptor to read some of the standard keys?"><y>#</y><d>2020-11-04</d><h>11:40</h><r>simongray</r><a>@U2J4FRT2T</a> Perfect! I guess this does not come built in then. Do you also keep your own custom keys in the service map or do you just this interceptor to read some of the standard keys?</z><z id="t1604490535" t="souenzzo I use a lot of custom keys. including things like &quot;db connection&quot; and other things"><y>#</y><d>2020-11-04</d><h>11:48</h><r>souenzzo</r>I use a lot of custom keys. including things like &quot;db connection&quot; and other things</z><z id="t1604487923" t="simongray The point was just to have an alternative to calling a bunch of interceptor constructor functions. Integrating with the Pedestal service map would also gather more configuration in the same place. So for instance I might write: {::http/type :jetty ::http/port 8080 ::http/routes #{...} :my.own.ns/config {...}}"><y>#</y><d>2020-11-04</d><h>11:05</h><w>simongray</w>The point was just to have an alternative to calling a bunch of interceptor constructor functions. Integrating with the Pedestal service map would also gather more configuration in the same place. So for instance I might write:
<pre>{::http/type :jetty
 ::http/port 8080
 ::http/routes #{...}
 :my.own.ns/config {...}}</pre></z><z id="t1604626729" t="lucian303 i&apos;d like to upload a few files using the multipart/form-data content type, like this: curl -L -X POST &apos;&apos; -F &apos; i&apos;ve added a new route: [&quot;/upload&quot; :post [(io.pedestal.http.ring-middlewares/multipart-params) `upload]] where upload is just a function that prints the request for now. the :multipart-params is null, however. what am i missing and how can i get the uploaded data?"><y>#</y><d>2020-11-06</d><h>01:38</h><w>lucian303</w>i&apos;d like to upload a few files using the <code>multipart/form-data</code> content type, like this:
<code>curl -L -X POST &apos;&apos; -F &apos;</code>

i&apos;ve added a new route:
<pre>[&quot;/upload&quot; :post [(io.pedestal.http.ring-middlewares/multipart-params) `upload]]</pre>
where <code>upload</code> is just a function that prints the request for now. the <code>:multipart-params</code> is null, however. what am i missing and how can i get the uploaded data?</z><z id="t1604875439" t="jhowd does anyone have a pedestal app that uses re-frame for the frontend? I am wanting to browse a repo so I can trace though how it would work because I seem to be struggling with it on my own"><y>#</y><d>2020-11-08</d><h>22:43</h><w>jhowd</w>does anyone have a pedestal app that uses re-frame for the frontend? I am wanting to browse a repo so I can trace though how it would work because I seem to be struggling with it on my own</z><z id="t1604910501" t="simongray I get the struggle (modern full-stack web development is complicated), but something like Re-frame is completely orthogonal to whatever the backend web service is written in. The only job that Pedestal (or Compojure or whatever) should have is to serve an HTML page containing your compiled JS bundle and perhaps expose 1 or more backend endpoints for data exchange. What part are you struggling with?"><y>#</y><d>2020-11-09</d><h>08:28</h><r>simongray</r>I get the struggle (modern full-stack web development is complicated), but something like Re-frame is completely orthogonal to whatever the backend web service is written in. The only job that Pedestal (or Compojure or whatever) should have is to serve an HTML page containing your compiled JS bundle and perhaps expose 1 or more backend endpoints for data exchange. What part are you struggling with?</z><z id="t1604910641" t="simongray This is not Pedestal (it’s Compojure), but it might point you in the right direction: https://github.com/simongray/sino.study/blob/master/src/sinostudy/navigation/handler.clj#L73-L90 Basically, there is a single API endpoint for data exchange using Transit and then a single endpoint (a fallback endpoint for unmatched requests) which serves the HTML page itself. It also uses Compojure’s way to specify static resources as a separate “endpoint”."><y>#</y><d>2020-11-09</d><h>08:30</h><r>simongray</r>This is not Pedestal (it’s Compojure), but it might point you in the right direction: <a href="https://github.com/simongray/sino.study/blob/master/src/sinostudy/navigation/handler.clj#L73-L90" target="_blank">https://github.com/simongray/sino.study/blob/master/src/sinostudy/navigation/handler.clj#L73-L90</a>
Basically, there is a single API endpoint for data exchange using Transit and then a single endpoint (a fallback endpoint for unmatched requests) which serves the HTML page itself. It also uses Compojure’s way to specify static resources as a separate “endpoint”.</z><z id="t1604937024" t="souenzzo Hello [:attrs {:href &quot;/_/_/users/U01EB94T3LY&quot;}] You are usin #shadow-cljs or figwheel for cljs? If you are on #shadow-cljs : ;; shadow-cljs.edn [:builds :my-cool-project] :output-dir &quot;target/my-cool-project&quot; :asset-path &quot;/my-cool-project&quot; :modules {:my-client {:entries [...]}} Then in your #pedestal service-map ::http/port 8080 ::http/file-path &quot;target&quot; A handler for your &quot;HTML&quot; (defn my-spa [req] {:body &quot; ... &lt;script src=&apos;/my-cool-project/my-client.js&apos;&gt; ...&quot; :headers {&quot;Content-Type&quot; &quot;text/html&quot;} :status 200}) Then your router (def routes #{[&quot;/spa&quot; :get my-spa :route-name :my-spa ]})"><y>#</y><d>2020-11-09</d><h>15:50</h><r>souenzzo</r>Hello <a>@jonathan.howden</a>
You are usin #shadow-cljs or figwheel for cljs?

If you are on #shadow-cljs :
<pre>;; shadow-cljs.edn [:builds :my-cool-project]
:output-dir       &quot;target/my-cool-project&quot;
:asset-path       &quot;/my-cool-project&quot;
:modules          {:my-client {:entries [...]}}</pre>
Then in your #pedestal service-map
<pre>::http/port 8080
::http/file-path     &quot;target&quot;</pre>
A handler for your &quot;HTML&quot;
<pre>(defn my-spa 
  [req]
  {:body &quot; ... &lt;script src=&apos;/my-cool-project/my-client.js&apos;&gt; ...&quot;
   :headers {&quot;Content-Type&quot; &quot;text/html&quot;}
   :status 200})</pre>
Then your router

<code>(def routes #{[&quot;/spa&quot; :get my-spa :route-name :my-spa ]})</code></z><z id="t1604941619" t="jhowd thank you both! This is definitely helpful and gives me a good path to start down"><y>#</y><d>2020-11-09</d><h>17:06</h><r>jhowd</r>thank you both! This is definitely helpful and gives me a good path to start down</z><z id="t1604937024" t="souenzzo Hello [:attrs {:href &quot;/_/_/users/U01EB94T3LY&quot;}] You are usin #shadow-cljs or figwheel for cljs? If you are on #shadow-cljs : ;; shadow-cljs.edn [:builds :my-cool-project] :output-dir &quot;target/my-cool-project&quot; :asset-path &quot;/my-cool-project&quot; :modules {:my-client {:entries [...]}} Then in your #pedestal service-map ::http/port 8080 ::http/file-path &quot;target&quot; A handler for your &quot;HTML&quot; (defn my-spa [req] {:body &quot; ... &lt;script src=&apos;/my-cool-project/my-client.js&apos;&gt; ...&quot; :headers {&quot;Content-Type&quot; &quot;text/html&quot;} :status 200}) Then your router (def routes #{[&quot;/spa&quot; :get my-spa :route-name :my-spa ]})"><y>#</y><d>2020-11-09</d><h>15:50</h><w>souenzzo</w>Hello <a>@jonathan.howden</a>
You are usin #shadow-cljs or figwheel for cljs?

If you are on #shadow-cljs :
<pre>;; shadow-cljs.edn [:builds :my-cool-project]
:output-dir       &quot;target/my-cool-project&quot;
:asset-path       &quot;/my-cool-project&quot;
:modules          {:my-client {:entries [...]}}</pre>
Then in your #pedestal service-map
<pre>::http/port 8080
::http/file-path     &quot;target&quot;</pre>
A handler for your &quot;HTML&quot;
<pre>(defn my-spa 
  [req]
  {:body &quot; ... &lt;script src=&apos;/my-cool-project/my-client.js&apos;&gt; ...&quot;
   :headers {&quot;Content-Type&quot; &quot;text/html&quot;}
   :status 200})</pre>
Then your router

<code>(def routes #{[&quot;/spa&quot; :get my-spa :route-name :my-spa ]})</code></z><z id="t1604937262" t="souenzzo If you prefer a &quot;HTML file&quot;: - Be sure that resources is in your :paths on deps.edn - Add a ::http/resource-path &quot;public&quot; (do not remove file-path !!! ) - create resources/public/index.html with your HTML - You will not need my-spa handler function nor routes change - Connect to localhost:8080/index.html"><y>#</y><d>2020-11-09</d><h>15:54</h><w>souenzzo</w>If you prefer a &quot;HTML file&quot;:
- Be sure that <code>resources</code> is in your <code>:paths</code> on <code>deps.edn</code>
- Add a <code>::http/resource-path &quot;public&quot;</code> (do not remove <code>file-path</code> !!! )
- create <code>resources/public/index.html</code> with your HTML
- You will not need <code>my-spa</code> handler function nor routes change
- Connect to localhost:8080/index.html</z><z id="t1604942087" t="lispers-anonymous Does anyone know why it&apos;s necessary to use a var to reference your routes when setting up pedestal in order for changes to the routes to be picked up properly? Example of var being used here: https://github.com/pedestal/samples/blob/caaf04afe255586f8f4e1235deeb0c1904179355/auto-reload-server/dev/dev.clj#L12"><y>#</y><d>2020-11-09</d><h>17:14</h><w>lispers-anonymous</w>Does anyone know why it&apos;s necessary to use a <code>var</code> to reference your routes when setting up pedestal in order for changes to the routes to be picked up properly? Example of var being used here: <a href="https://github.com/pedestal/samples/blob/caaf04afe255586f8f4e1235deeb0c1904179355/auto-reload-server/dev/dev.clj#L12" target="_blank">https://github.com/pedestal/samples/blob/caaf04afe255586f8f4e1235deeb0c1904179355/auto-reload-server/dev/dev.clj#L12</a></z><z id="t1604949847" t="isak [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] because otherwise, the current value of the routes gets baked into the service-map"><y>#</y><d>2020-11-09</d><h>19:24</h><w>isak</w><a>@dannyfreeman</a> because otherwise, the current value of the routes gets baked into the service-map</z><z id="t1605184715" t="Louis Kottmann I have a pedestal app (a REST API) that must respond quickly before actually doing the (long) work i.e: receive a POST request, verify the auth token checks out, data sent is good, then return 200 ok within 3 seconds But after that I actually do some heavy work with lots of branching, and the same branchings can be reused many times, and the pedestal HTTP mechanism is gone because I already replied to the request. I initially thought about turning the branchings into reusable macros, but I realized that&apos;s the job pedestal does, except I use it for HTTP requests. And the website says it&apos;s not just for HTTP! Great, though how do I get started? what&apos;s the entry point to generate a new non-HTTP context, add non-HTTP interceptors, and get it running?"><y>#</y><d>2020-11-12</d><h>12:38</h><w>Louis Kottmann</w>I have a pedestal app (a REST API) that must respond quickly before actually doing the (long) work
i.e: receive a POST request, verify the auth token checks out, data sent is good, then return <code>200 ok</code> within 3 seconds

But after that I actually do some heavy work with lots of branching, and the same branchings can be reused many times, and the pedestal HTTP mechanism is gone because I already replied to the request.
I initially thought about turning the branchings into reusable macros, but I realized that&apos;s the job pedestal does, except I use it for HTTP requests. And the website says it&apos;s not just for HTTP!

Great, though how do I get started? what&apos;s the entry point to generate a new non-HTTP context, add non-HTTP interceptors, and get it running?</z><z id="t1605198196" t="dvingo Here&apos;s a toy example: (:require [io.pedestal.interceptor :as i] [io.pedestal.interceptor.chain :as chain] [io.pedestal.interceptor.helpers :as ih]) (def i1 (i/interceptor {:enter (fn [c] (log/info &quot;in i1&quot;) c)})) (def i2 (i/interceptor {:enter (fn [c] (go (log/info &quot;in i2&quot;)) c)})) (def i3 (ih/before (fn [c] (log/info &quot;in i3&quot;) c))) (def my-ints [i1 i2 i3]) (chain/execute {} my-ints) (chain/execute-only {} :enter my-ints) "><y>#</y><d>2020-11-12</d><h>16:23</h><w>dvingo</w>Here&apos;s a toy example:
<pre>(:require
  [io.pedestal.interceptor :as i]
  [io.pedestal.interceptor.chain :as chain]
  [io.pedestal.interceptor.helpers :as ih])

(def i1 (i/interceptor {:enter (fn [c] (log/info &quot;in i1&quot;) c)}))
(def i2 (i/interceptor {:enter (fn [c] (go (log/info &quot;in i2&quot;)) c)}))
(def i3 (ih/before (fn [c] (log/info &quot;in i3&quot;) c)))
(def my-ints [i1 i2 i3])
(chain/execute {} my-ints)
(chain/execute-only {} :enter my-ints)</pre>
</z><z id="t1605198250" t="Louis Kottmann that looks great, I&apos;ll try it out tonight"><y>#</y><d>2020-11-12</d><h>16:24</h><w>Louis Kottmann</w>that looks great, I&apos;ll try it out tonight</z><z id="t1605198253" t="Louis Kottmann thanks!"><y>#</y><d>2020-11-12</d><h>16:24</h><w>Louis Kottmann</w>thanks!</z><z id="t1605198293" t="dvingo no prob!"><y>#</y><d>2020-11-12</d><h>16:24</h><w>dvingo</w>no prob!</z><z id="t1605226045" t="Louis Kottmann works like a charm, I&apos;m adding a terminator and an error handler"><y>#</y><d>2020-11-13</d><h>00:07</h><w>Louis Kottmann</w>works like a charm, I&apos;m adding a terminator and an error handler</z><z id="t1605463105" t="hequ What’s the point of interceptors having both enter and leave functions? Why are interceptors not “just functions” which can be executed in order? I read the interceptors reference but I’m having a hard time understanding what is the benefit of having both enter and leave functions? And why the request has to “make a loop” by first executing all enter functions and then all the leave functions?"><y>#</y><d>2020-11-15</d><h>17:58</h><w>hequ</w>What’s the point of interceptors having both enter and leave functions? Why are interceptors not “just functions” which can be executed in order? I read the interceptors reference but I’m having a hard time understanding what is the benefit of having both enter and leave functions? And why the request has to “make a loop” by first executing all enter functions and then all the leave functions?</z><z id="t1605463350" t="emccue [:attrs {:href &quot;/_/_/users/U0VP24R1P&quot;}] Let me answer that with a practical use"><y>#</y><d>2020-11-15</d><h>18:02</h><w>emccue</w><a>@hequ</a> Let me answer that with a practical use</z><z id="t1605463444" t="emccue First, an interceptor I wrote that sees if a later interceptor has filled in a :response, and if its a get request will fill in the standard Single Page App code"><y>#</y><d>2020-11-15</d><h>18:04</h><w>emccue</w>First, an interceptor I wrote that sees if a later interceptor has filled in a :response, and if its a get request will fill in the standard Single Page App code</z><z id="t1605463447" t="emccue ;; ---------------------------------------------------------------------------- (def serve-elm-on-404 &quot;Intercepts any unhandled get requests and serves the SPA.&quot; {:leave (fn [context] (if (and (not (http/response? (:response context))) (= :get (:request-method (:request context)))) (assoc context :response {:status 200 :headers {&quot;Content-Type&quot; &quot;text/html&quot;} :body (page/html5 {:lang &quot;en&quot;} [:html [:head [:meta {:charset &quot;UTF-8&quot;}] [:style &quot;body { padding: 0; margin: 0; }&quot;]] [:body [:div {:id &quot;mount&quot;}] [:script {:type &quot;text/javascript&quot;} (-&gt; (io/resource &quot;public/app.js&quot;) ;; TODO: Cache (slurp))] [:script {:type &quot;text/javascript&quot;} &quot;var app = Elm.Main.init({node: document.getElementById(&apos;mount&apos;)});&quot;]]])}) context))})"><y>#</y><d>2020-11-15</d><h>18:04</h><w>emccue</w><pre>;; ----------------------------------------------------------------------------
(def serve-elm-on-404
  &quot;Intercepts any unhandled get requests and serves the SPA.&quot;
  {:leave
   (fn [context]
     (if (and (not (http/response? (:response context)))
              (= :get (:request-method (:request context))))
       (assoc
         context
         :response
         {:status 200
          :headers {&quot;Content-Type&quot; &quot;text/html&quot;}
          :body
          (page/html5
            {:lang &quot;en&quot;}
            [:html
             [:head
              [:meta {:charset &quot;UTF-8&quot;}]
              [:style &quot;body { padding: 0; margin: 0; }&quot;]]
             [:body
              [:div {:id &quot;mount&quot;}]
              [:script {:type &quot;text/javascript&quot;} (-&gt; (io/resource &quot;public/app.js&quot;) ;; TODO: Cache
                                                     (slurp))]
              [:script {:type &quot;text/javascript&quot;}
               &quot;var app = Elm.Main.init({node: document.getElementById(&apos;mount&apos;)});&quot;]]])})
       context))})</pre></z><z id="t1605463597" t="emccue You can write this in the &quot;function stacking&quot; way for sure, so its not the best example, but it is a case where it is pretty clear what is going on"><y>#</y><d>2020-11-15</d><h>18:06</h><w>emccue</w>You can write this in the &quot;function stacking&quot; way for sure, so its not the best example, but it is a case where it is pretty clear what is going on</z><z id="t1605463628" t="emccue since you have the :response as just a detail of how the different layers communicate"><y>#</y><d>2020-11-15</d><h>18:07</h><w>emccue</w>since you have the <code>:response</code> as just a detail of how the different layers communicate</z><z id="t1605463635" t="emccue the other way would look like"><y>#</y><d>2020-11-15</d><h>18:07</h><w>emccue</w>the other way would look like</z><z id="t1605463702" t="emccue (defn wrap-with-spa [route] (fn [req] (let [res (route req)] (if (nil? res) (... single page app ...) res))))"><y>#</y><d>2020-11-15</d><h>18:08</h><w>emccue</w><pre>(defn wrap-with-spa [route]
   (fn [req]
      (let [res (route req)]
        (if (nil? res)
           (... single page app ...)
           res))))</pre></z><z id="t1605463748" t="emccue A better example might be this"><y>#</y><d>2020-11-15</d><h>18:09</h><w>emccue</w>A better example might be this</z><z id="t1605463758" t="emccue (def requires-auth-interceptor &quot;An interceptor that looks for a user in the request map and (if there is none), early returns a 401. &quot; {:name ::requires-auth-interceptor :enter (fn [context] (let [{:keys [user]} (:request context)] (if-not user (-&gt; context (assoc :response unauthorized-response) (interceptor-chain/terminate)) context)))})"><y>#</y><d>2020-11-15</d><h>18:09</h><w>emccue</w><pre>(def requires-auth-interceptor
  &quot;An interceptor that looks for a user in the request map and
  (if there is none), early returns a 401. &quot;
  {:name ::requires-auth-interceptor
   :enter
   (fn [context]
     (let [{:keys [user]} (:request context)]
       (if-not user
         (-&gt; context
             (assoc :response unauthorized-response)
             (interceptor-chain/terminate))
         context)))})</pre></z><z id="t1605463798" t="emccue Since the interceptors are a chain, we can do meta stuff like re-arrange or add steps to what comes next"><y>#</y><d>2020-11-15</d><h>18:09</h><w>emccue</w>Since the interceptors are a chain, we can do meta stuff like re-arrange or add steps to what comes next</z><z id="t1605463878" t="emccue The other thing it allows is seperation of &quot;async&quot; steps"><y>#</y><d>2020-11-15</d><h>18:11</h><w>emccue</w>The other thing it allows is seperation of &quot;async&quot; steps</z><z id="t1605463904" t="emccue if one of the interceptors returns a core.async channel, pedestal will handle the juggling of that for you"><y>#</y><d>2020-11-15</d><h>18:11</h><w>emccue</w>if one of the interceptors returns a core.async channel, pedestal will handle the juggling of that for you</z><z id="t1605463929" t="emccue and no other interceptor needs to know that what was returned happened asynchronously"><y>#</y><d>2020-11-15</d><h>18:12</h><w>emccue</w>and no other interceptor needs to know that what was returned happened asynchronously</z><z id="t1605463949" t="emccue (afaik, i haven&apos;t tested that for anything)"><y>#</y><d>2020-11-15</d><h>18:12</h><w>emccue</w>(afaik, i haven&apos;t tested that for anything)</z><z id="t1605463965" t="emccue I guess it really isn&apos;t a hard need to"><y>#</y><d>2020-11-15</d><h>18:12</h><w>emccue</w>I guess it really isn&apos;t a hard need to</z><z id="t1605464003" t="emccue a whole bunch, in fact most, http frameworks get by with either middleware stacking or some other system"><y>#</y><d>2020-11-15</d><h>18:13</h><w>emccue</w>a whole bunch, in fact most, http frameworks get by with either middleware stacking or some other system</z><z id="t1605464061" t="emccue but there are some concrete benefits to doing it this way"><y>#</y><d>2020-11-15</d><h>18:14</h><w>emccue</w>but there are some concrete benefits to doing it this way</z><z id="t1605464102" t="emccue since the same &quot;chain of steps that happen one after another&quot; model can be generalized to more than http"><y>#</y><d>2020-11-15</d><h>18:15</h><w>emccue</w>since the same &quot;chain of steps that happen one after another&quot; model can be generalized to more than http</z><z id="t1605464164" t="emccue (huge grains of salt - I have been frequently befuddled by pedestal and that hasn&apos;t stopped)"><y>#</y><d>2020-11-15</d><h>18:16</h><w>emccue</w>(huge grains of salt - I have been frequently befuddled by pedestal and that hasn&apos;t stopped)</z><z id="t1605464189" t="emccue (but I have made decent progress writing my hobby app with it so i at least kinda sorta know some things)"><y>#</y><d>2020-11-15</d><h>18:16</h><w>emccue</w>(but I have made decent progress writing my hobby app with it so i at least kinda sorta know some things)</z><z id="t1605465087" t="hequ Thank you for the concrete examples! So to test my understanding: if your route is about getting some user-data from a database table you could write an enter interceptor which could (for example) first check if that data is already available in some cache and early exit if it is? And if not then there is an enter interceptor which could fetch that user-data and then one or more leave interceptors which would transform that data to a correct response format? Or does it even matter if those are enter or leave interceptors?"><y>#</y><d>2020-11-15</d><h>18:31</h><w>hequ</w>Thank you for the concrete examples!

So to test my understanding: if your route is about getting some user-data from a database table you could write an enter interceptor which could (for example) first check if that data is already available in some cache and early exit if it is? And if not then there is an enter interceptor which could fetch that user-data and then one or more leave interceptors which would transform that data to a correct response format? Or does it even matter if those are enter or leave interceptors?</z><z id="t1605465547" t="Louis Kottmann I&apos;d say use :enter interceptors to build your response, and use :leave interceptors to massage it"><y>#</y><d>2020-11-15</d><h>18:39</h><r>Louis Kottmann</r>I&apos;d say use <code>:enter</code> interceptors to build your response, and use <code>:leave</code> interceptors to massage it</z><z id="t1605465605" t="Louis Kottmann for example there is a http/json-body that comes with pedestal that will set the content-type to application/json if no content-type is already set"><y>#</y><d>2020-11-15</d><h>18:40</h><r>Louis Kottmann</r>for example there is a <code>http/json-body</code> that comes with pedestal that will set the content-type to <code>application/json</code> if no content-type is already set</z><z id="t1605465670" t="Louis Kottmann you could do it in an :enter interceptor but as soon as an interceptor returns a context with a :response it will start leaving"><y>#</y><d>2020-11-15</d><h>18:41</h><r>Louis Kottmann</r>you could do it in an <code>:enter</code> interceptor but as soon as an interceptor returns a <code>context</code> with a <code>:response</code> it will start leaving</z><z id="t1605465688" t="Louis Kottmann so to make a reusable default it is in its own :leave interceptor"><y>#</y><d>2020-11-15</d><h>18:41</h><r>Louis Kottmann</r>so to make a reusable default it is in its own <code>:leave</code> interceptor</z><z id="t1605465798" t="hequ oh, so you can control the flow by attaching a response to the context. Well that’s nice."><y>#</y><d>2020-11-15</d><h>18:43</h><r>hequ</r>oh, so you can control the flow by attaching a response to the context. Well that’s nice.</z><z id="t1605465218" t="Louis Kottmann I have complex a chain of boolean logic which would be tens of levels of nested conditionals with short-circuits via cond now it is a pedestal interceptor (non-http) chain and they are all packaged in their nice little interceptors, which makes it composable for other chains as well"><y>#</y><d>2020-11-15</d><h>18:33</h><w>Louis Kottmann</w>I have complex a chain of boolean logic which would be tens of levels of nested conditionals with short-circuits via <code>cond</code>
now it is a pedestal interceptor (non-http) chain and they are all packaged in their nice little interceptors, which makes it composable for other chains as well</z><z id="t1605465222" t="Louis Kottmann it&apos;s pretty nifty"><y>#</y><d>2020-11-15</d><h>18:33</h><w>Louis Kottmann</w>it&apos;s pretty nifty</z><z id="t1605465297" t="Louis Kottmann and yeah there are gotchas, for example I got bitten earlier today because I was declare -ing interceptors before providing them and then defining them, and pedestal crashed because some declared interceptors were &quot;unbound&quot; and it could not check their type so I had to reorder the code in the correct order (and lose some readability)"><y>#</y><d>2020-11-15</d><h>18:34</h><w>Louis Kottmann</w>and yeah there are gotchas, for example I got bitten earlier today because I was <code>declare</code>-ing interceptors before providing them and then defining them,
and pedestal crashed because some declared interceptors were &quot;unbound&quot; and it could not check their type
so I had to reorder the code in the correct order (and lose some readability)</z><z id="t1605466538" t="hequ I probably have too limited understanding for now as my use cases are a pretty basic rest api. But thanks anyway for providing some light on this topic! 🙂"><y>#</y><d>2020-11-15</d><h>18:55</h><w>hequ</w>I probably have too limited understanding for now as my use cases are a pretty basic rest api. But thanks anyway for providing some light on this topic! <b>🙂</b></z><z id="t1605552426" t="Michael Stokley am i correct in thinking that no :leave function will ever be called if there is a handler anywhere in the interceptor stack?"><y>#</y><d>2020-11-16</d><h>18:47</h><w>Michael Stokley</w>am i correct in thinking that no <code>:leave</code> function will ever be called if there is a handler anywhere in the interceptor stack?</z><z id="t1605552551" t="Michael Stokley or just those whose sister :enter functions have not been invoked?"><y>#</y><d>2020-11-16</d><h>18:49</h><w>Michael Stokley</w>or just those whose sister <code>:enter</code> functions have not been invoked?</z><z id="t1605552643" t="Michael Stokley or just those whose interceptor is placed after the handler?"><y>#</y><d>2020-11-16</d><h>18:50</h><w>Michael Stokley</w>or just those whose interceptor is placed after the handler?</z><z id="t1605553066" t="Michael Stokley i was reading something in the documentation about this just a few days ago, but i can&apos;t seem to find it. what i see now says: the handler must be the last interceptor. i assume other interceptors&apos; :leave functions will be invoked, even with a handler in the final position, even if they have no corresponding :enter function, because not doing so would severely limit the use of handlers, ever."><y>#</y><d>2020-11-16</d><h>18:57</h><w>Michael Stokley</w>i was reading something in the documentation about this just a few days ago, but i can&apos;t seem to find it. what i see now says: the handler must be the last interceptor. i assume other interceptors&apos; <code>:leave</code> functions will be invoked, even with a handler in the final position, even if they have no corresponding <code>:enter</code> function, because not doing so would severely limit the use of handlers, ever.</z><z id="t1605566211" t="Louis Kottmann every time an :enter interceptor is called, its corresponding :leave is added to the stack of things to call when unwinding"><y>#</y><d>2020-11-16</d><h>22:36</h><w>Louis Kottmann</w>every time an <code>:enter</code> interceptor is called, its corresponding <code>:leave</code> is added to the stack of things to call when unwinding</z><z id="t1605566245" t="Louis Kottmann if your interceptor only has a :leave fn defined, if must be passed throuh on the way in to be pushed to the stack"><y>#</y><d>2020-11-16</d><h>22:37</h><w>Louis Kottmann</w>if your interceptor only has a <code>:leave</code> fn defined, if must be passed throuh on the way in to be pushed to the stack</z><z id="t1605566313" t="Louis Kottmann handlers are meant to be the last thing in the chain, and you can tell because they do not get the full context (just the :request )"><y>#</y><d>2020-11-16</d><h>22:38</h><w>Louis Kottmann</w>handlers are meant to be the last thing in the chain, and you can tell because they do not get the full context (just the <code>:request</code>)</z><z id="t1605566320" t="Louis Kottmann i.e: they cannot enqueue anything"><y>#</y><d>2020-11-16</d><h>22:38</h><w>Louis Kottmann</w>i.e: they cannot enqueue anything</z><z id="t1605566346" t="Louis Kottmann they do not, however, prevent :leave fns to be called when unwinding"><y>#</y><d>2020-11-16</d><h>22:39</h><w>Louis Kottmann</w>they do not, however, prevent <code>:leave</code> fns to be called when unwinding</z><z id="t1605567589" t="Michael Stokley thanks [:attrs {:href &quot;/_/_/users/U01CVNTDF34&quot;}] !"><y>#</y><d>2020-11-16</d><h>22:59</h><w>Michael Stokley</w>thanks <a>@lkottmann</a>!</z><z id="t1605613540" t="Mehdi H. Hi all! I am trying out SSE with Pedestal + Jetty. My stream-ready function is really basic and adds an event every second to the channel (with a buffer of 200). For some reason, it takes around a minute to start the stream to the client (cljs + fetch), it bursts around 60 messages and it then ends the stream. Have anyone experienced that? Is it something that could be linked to some Jetty buffering and queue flushing? Thanks in advance!"><y>#</y><d>2020-11-17</d><h>11:45</h><w>Mehdi H.</w>Hi all! I am trying out SSE with Pedestal + Jetty. My stream-ready function is really basic and adds an event every second to the channel (with a buffer of 200). For some reason, it takes around a minute to start the stream to the client (cljs + fetch), it bursts around 60 messages and it then ends the stream. Have anyone experienced that? Is it something that could be linked to some Jetty buffering and queue flushing? Thanks in advance!</z><z id="t1605619676" t="Mehdi H. This is the error I am getting: ERROR io.pedestal.http.impl.servlet-interceptor [async-dispatch-3] {:msg &quot;An error occured when async writing to the client&quot;, :line 116, :src-chan #object[clojure.core.async.impl.channels.ManyToManyChannel 0x1ce67b &quot;clojure.core.async.impl.channels.ManyToManyChannel@1ce67b&quot;], :throwable #error { :cause &quot;Close org.eclipse.jetty.server.HttpConnection$SendCallback@55b587d4[PROCESSING][i=null,cb=org.eclipse.jetty.server.HttpChannel$SendCallback@15b51ddb] in state PROCESSING&quot; :via [{:type java.io.IOException :message &quot;Close org.eclipse.jetty.server.HttpConnection$SendCallback@55b587d4[PROCESSING][i=null,cb=org.eclipse.jetty.server.HttpChannel$SendCallback@15b51ddb] in state PROCESSING&quot; :at [org.eclipse.jetty.util.IteratingCallback close &quot;IteratingCallback.java&quot; 427]}] :trace [[org.eclipse.jetty.util.IteratingCallback close &quot;IteratingCallback.java&quot; 427] [org.eclipse.jetty.server.HttpConnection onClose &quot;HttpConnection.java&quot; 519] [org.eclipse.jetty.io.ssl.SslConnection onClose &quot;SslConnection.java&quot; 289] [org.eclipse.jetty.io.SelectorManager connectionClosed &quot;SelectorManager.java&quot; 345] [org.eclipse.jetty.io.ManagedSelector$DestroyEndPoint run &quot;ManagedSelector.java&quot; 956] [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 698] [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 804] [java.lang.Thread run &quot;Thread.java&quot; 748]]}}"><y>#</y><d>2020-11-17</d><h>13:27</h><w>Mehdi H.</w>This is the error I am getting:
<pre>ERROR io.pedestal.http.impl.servlet-interceptor [async-dispatch-3]
{:msg &quot;An error occured when async writing to the client&quot;, :line 116, :src-chan #object[clojure.core.async.impl.channels.ManyToManyChannel 0x1ce67b &quot;clojure.core.async.impl.channels.ManyToManyChannel@1ce67b&quot;], :throwable #error {
 :cause &quot;Close org.eclipse.jetty.server.HttpConnection$SendCallback@55b587d4[PROCESSING][i=null,cb=org.eclipse.jetty.server.HttpChannel$SendCallback@15b51ddb] in state PROCESSING&quot;
 :via
 [{:type java.io.IOException
   :message &quot;Close org.eclipse.jetty.server.HttpConnection$SendCallback@55b587d4[PROCESSING][i=null,cb=org.eclipse.jetty.server.HttpChannel$SendCallback@15b51ddb] in state PROCESSING&quot;
   :at [org.eclipse.jetty.util.IteratingCallback close &quot;IteratingCallback.java&quot; 427]}]
 :trace
 [[org.eclipse.jetty.util.IteratingCallback close &quot;IteratingCallback.java&quot; 427]
  [org.eclipse.jetty.server.HttpConnection onClose &quot;HttpConnection.java&quot; 519]
  [org.eclipse.jetty.io.ssl.SslConnection onClose &quot;SslConnection.java&quot; 289]
  [org.eclipse.jetty.io.SelectorManager connectionClosed &quot;SelectorManager.java&quot; 345]
  [org.eclipse.jetty.io.ManagedSelector$DestroyEndPoint run &quot;ManagedSelector.java&quot; 956]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 698]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 804]
  [java.lang.Thread run &quot;Thread.java&quot; 748]]}}</pre></z><z id="t1605622309" t="Mehdi H. With an event put every 10 seconds in the channel, the error still comes around but the connexion isn&apos;t shut down. So maybe the error message isn&apos;t linked to the connexion being closed despite the message? And maybe this is a client side issue where the client cannot deal with a one event per second load? Even if this is the case, the 60sec start time for the sse stream to start outputting events is puzzling."><y>#</y><d>2020-11-17</d><h>14:11</h><w>Mehdi H.</w>With an event put every 10 seconds in the channel, the error still comes around but the connexion isn&apos;t shut down. So maybe the error message isn&apos;t linked to the connexion being closed despite the message? And maybe this is a client side issue where the client cannot deal with a one event per second load? Even if this is the case, the 60sec start time for the sse stream to start outputting events is puzzling.</z><z id="t1605862908" t="simongray Is there some obvious way to implement rate-limiting for a Pedestal web service?"><y>#</y><d>2020-11-20</d><h>09:01</h><w>simongray</w>Is there some obvious way to implement rate-limiting for a Pedestal web service?</z><z id="t1605867139" t="Louis Kottmann with a proxy like Nginx or Kong?"><y>#</y><d>2020-11-20</d><h>10:12</h><w>Louis Kottmann</w>with a proxy like Nginx or Kong?</z><z id="t1605867524" t="simongray [:attrs {:href &quot;/_/_/users/U01CVNTDF34&quot;}] no proxy at the moment. I don&apos;t expect I&apos;ll need one, though if that&apos;s the preferred way to get rate limiting I guess I will?"><y>#</y><d>2020-11-20</d><h>10:18</h><w>simongray</w><a>@lkottmann</a> no proxy at the moment. I don&apos;t expect I&apos;ll need one, though if that&apos;s the preferred way to get rate limiting I guess I will?</z><z id="t1605867751" t="Louis Kottmann there are ring middlewares if you want a clojure-only solution"><y>#</y><d>2020-11-20</d><h>10:22</h><w>Louis Kottmann</w>there are ring middlewares if you want a clojure-only solution</z><z id="t1605874577" t="simongray I guess an alternative to using ring-middleware in a Pedestal app is to use one these Jetty filters: • https://www.eclipse.org/jetty/documentation/current/dos-filter.html • https://www.eclipse.org/jetty/documentation/current/qos-filter.html I would want to do it from Clojure, though, not through XML. Anyone have any experience setting up Jetty filters in Pedestal?"><y>#</y><d>2020-11-20</d><h>12:16</h><w>simongray</w>I guess an alternative to using ring-middleware in a Pedestal app is to use one these Jetty filters:
• <a href="https://www.eclipse.org/jetty/documentation/current/dos-filter.html" target="_blank">https://www.eclipse.org/jetty/documentation/current/dos-filter.html</a>
• <a href="https://www.eclipse.org/jetty/documentation/current/qos-filter.html" target="_blank">https://www.eclipse.org/jetty/documentation/current/qos-filter.html</a>
I would want to do it from Clojure, though, not through XML. Anyone have any experience setting up Jetty filters in Pedestal?</z><z id="t1605874781" t="simongray Perhaps using the `:context-configurator` key in the Jetty configuration and code similar to this? https://www.programcreek.com/java-api-examples/?class=org.eclipse.jetty.servlet.ServletContextHandler&amp;amp;method=addFilter I have no idea how to use `:context-configurator` though. The Pedestal documentation simply says: &gt; “A function called with the `org.eclipse.jetty.servlet.ServletContextHandler` instance. Use when advanced customization is required.”"><y>#</y><d>2020-11-20</d><h>12:19</h><w>simongray</w>Perhaps using the `:context-configurator` key in the Jetty configuration and code similar to this? <a href="https://www.programcreek.com/java-api-examples/?class=org.eclipse.jetty.servlet.ServletContextHandler&amp;amp;method=addFilter" target="_blank">https://www.programcreek.com/java-api-examples/?class=org.eclipse.jetty.servlet.ServletContextHandler&amp;amp;method=addFilter</a>
I have no idea how to use `:context-configurator` though. The Pedestal documentation simply says:
&gt; “A function called with the `org.eclipse.jetty.servlet.ServletContextHandler` instance. Use when advanced customization is required.”</z><z id="t1605875283" t="simongray Scratch that, I got confused. `:context-configurator` is a just function you define taking one arg (the current org.eclipse.jetty.servlet.ServletContextHandler) and obviously methods can then be called on it in that context."><y>#</y><d>2020-11-20</d><h>12:28</h><w>simongray</w>Scratch that, I got confused. `:context-configurator` is a just function you define taking one arg (the current org.eclipse.jetty.servlet.ServletContextHandler) and obviously methods can then be called on it in that context.</z><z id="t1605876478" t="souenzzo Here how I use context-configurator (defn context-configurator [^ServletContextHandler context] (let [gzip-handler (GzipHandler.)] (.setExcludedAgentPatterns gzip-handler (make-array String 0)) (.setGzipHandler context gzip-handler)) context) ... ::http/container-options {:h2c? true :context-configurator context-configurator}"><y>#</y><d>2020-11-20</d><h>12:47</h><r>souenzzo</r>Here how I use context-configurator
<pre>(defn context-configurator
  [^ServletContextHandler context]
  (let [gzip-handler (GzipHandler.)]
    (.setExcludedAgentPatterns gzip-handler (make-array String 0))
    (.setGzipHandler context gzip-handler))
  context)

... ::http/container-options {:h2c?                 true
                              :context-configurator context-configurator}</pre></z><z id="t1605876915" t="simongray Thanks. Pretty simple stuff."><y>#</y><d>2020-11-20</d><h>12:55</h><r>simongray</r>Thanks. Pretty simple stuff.</z><z id="t1606140873" t="simongray Maybe I am dense, but what does this mean? ::http/join? If false, do not block the thread that starts the web server. Passed to the container. And why would I want the thread blocked/not blocked?"><y>#</y><d>2020-11-23</d><h>14:14</h><w>simongray</w>Maybe I am dense, but what does this mean?
<pre>::http/join?	
If false, do not block the thread that starts the web server. Passed to the container.</pre>
And why would I want the thread blocked/not blocked?</z><z id="t1606141017" t="ddeaguiar When running the server from a repl, you wouldn’t want to block the repl so you’d use ::http/join? false during development."><y>#</y><d>2020-11-23</d><h>14:16</h><w>ddeaguiar</w>When running the server from a repl, you wouldn’t want to block the repl so you’d use <code>::http/join? false</code> during development.</z><z id="t1606141594" t="simongray [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Thank you. Is there any reason to not just use ::http/join? false all the time?"><y>#</y><d>2020-11-23</d><h>14:26</h><w>simongray</w><a>@ddeaguiar</a> Thank you. Is there any reason to not just use <code>::http/join? false</code> all the time?</z><z id="t1606142038" t="ddeaguiar Hrm, good question. I don’t recall off hand. Will look into it!"><y>#</y><d>2020-11-23</d><h>14:33</h><w>ddeaguiar</w>Hrm, good question. I don’t recall off hand. Will look into it!</z><z id="t1606142172" t="orestis your main thread will exit, right? The JVM will probably keep going (is the Jetty thread daemon?)"><y>#</y><d>2020-11-23</d><h>14:36</h><w>orestis</w>your main thread will exit, right? The JVM will probably keep going (is the Jetty thread daemon?)</z><z id="t1606142344" t="orestis In production we actually have this: (defn join-server-thread [system] (let [^org.eclipse.jetty.server.Server jetty-server (get-in system [:pedestal :service :io.pedestal.http/server])] (.join jetty-server))) "><y>#</y><d>2020-11-23</d><h>14:39</h><w>orestis</w>In production we actually have this:
<pre>(defn join-server-thread [system]
  (let [^org.eclipse.jetty.server.Server jetty-server (get-in system [:pedestal :service :io.pedestal.http/server])]
    (.join jetty-server)))</pre>
</z><z id="t1606142558" t="ddeaguiar Think [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] is right."><y>#</y><d>2020-11-23</d><h>14:42</h><w>ddeaguiar</w>Think <a>@orestis</a> is right.</z><z id="t1606142657" t="orestis And our -main looks like this: (defn -main [&amp; args] (println &quot;Starting...&quot;) (java.security.Security/setProperty &quot;networkaddress.cache.ttl&quot; &quot;30&quot;) (nosco.util.repl/try-start-nrepl 6666) (let [conf (prod-config dev-config) system (try (start-system nosco.http.service/prod-service-map conf) (catch Exception e (shutdown-agents) (throw e)))] (join-server-thread system) (shutdown-agents))) "><y>#</y><d>2020-11-23</d><h>14:44</h><w>orestis</w>And our <code>-main</code> looks like this:
<pre>(defn -main [&amp; args]
  (println &quot;Starting...&quot;)
  (java.security.Security/setProperty &quot;networkaddress.cache.ttl&quot; &quot;30&quot;)
  (nosco.util.repl/try-start-nrepl 6666)
  (let [conf (prod-config dev-config)
        system (try (start-system nosco.http.service/prod-service-map conf)
                    (catch Exception e
                      (shutdown-agents)
                      (throw e)))]
    (join-server-thread system)
    (shutdown-agents)))</pre>
</z><z id="t1606142705" t="orestis I think the point was to be able to cleanly shutdown agents when the jetty thread terminates. If you let it go off you won’t be able to know when it shut down…"><y>#</y><d>2020-11-23</d><h>14:45</h><w>orestis</w>I think the point was to be able to cleanly shutdown agents when the jetty thread terminates. If you let it go off you won’t be able to know when it shut down…</z><z id="t1606142918" t="simongray [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] That makes sense, although I don’t have any shutdown-specific code in my case (yet). And then in addition to that, if I don’t join I will have to make up some other artificial way to keep the main process running?"><y>#</y><d>2020-11-23</d><h>14:48</h><w>simongray</w><a>@orestis</a> That makes sense, although I don’t have any shutdown-specific code in my case (yet). And then in addition to that, if I don’t join I will have to make up some other artificial way to keep the main process running?</z><z id="t1606142969" t="orestis I’m not quite sure if the Jetty thread is Daemon (will not prevent JVM from exiting) or not -&gt; https://www.geeksforgeeks.org/daemon-thread-java/"><y>#</y><d>2020-11-23</d><h>14:49</h><w>orestis</w>I’m not quite sure if the Jetty thread is Daemon (will not prevent JVM from exiting) or not -&gt; <a href="https://www.geeksforgeeks.org/daemon-thread-java/" target="_blank">https://www.geeksforgeeks.org/daemon-thread-java/</a></z><z id="t1606143058" t="orestis But in general you should keep a handle on threads, so I think not auto-joining and manually joining as I pasted above is sane. Bonus, it’s the same configuration between REPL and production, with the difference that in REPL you never join 🙂"><y>#</y><d>2020-11-23</d><h>14:50</h><w>orestis</w>But in general you should keep a handle on threads, so I think not auto-joining and manually joining as I pasted above is sane. Bonus, it’s the same configuration between REPL and production, with the difference that in REPL you never join <b>🙂</b></z><z id="t1606143083" t="orestis (Sorry if you already knew about daemon threads 🙂 )"><y>#</y><d>2020-11-23</d><h>14:51</h><w>orestis</w>(Sorry if you already knew about daemon threads <b>🙂</b> )</z><z id="t1606143117" t="simongray No I don’t, so thank you for that. 🙂 I guess I will simply cargo-cult whatever everyone else is doing for now :)"><y>#</y><d>2020-11-23</d><h>14:51</h><w>simongray</w>No I don’t, so thank you for that. <b>🙂</b>  I guess I will simply cargo-cult whatever everyone else is doing for now :)</z><z id="t1606143200" t="orestis I think that for REPL you never want to join as then you wan’t be able to keep the REPL going. You can always test what happens in production if you don’t join, it’s just annoying because you have to keep re-starting the JVM…"><y>#</y><d>2020-11-23</d><h>14:53</h><w>orestis</w>I think that for REPL you never want to join as then you wan’t be able to keep the REPL going. You can always test what happens in production if you don’t join, it’s just annoying because you have to keep re-starting the JVM…</z><z id="t1606143244" t="simongray yeah, I just tried it out in the REPL, but that’s why I was curious when it made sense to join."><y>#</y><d>2020-11-23</d><h>14:54</h><w>simongray</w>yeah, I just tried it out in the REPL, but that’s why I was curious when it made sense to join.</z><z id="t1606143618" t="simongray BTW [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I actually got a working SAML 2.0 auth solution up and running pretty quickly. I’ve deliberately architected it in such a way that the relevant namespaces can eventually be put inside their own a library. The basic idea is that the library consumer (just myself for now) supplies a small configuration map, joins their routes with a set of ready-made SAML routes, and then prepends a SAML-session auth interceptor chain to any route endpoints that require controlled access. That seemed the most logical way to do it to me. Would you say this is the idiomatic way to do things in Pedestal?"><y>#</y><d>2020-11-23</d><h>15:00</h><w>simongray</w>BTW <a>@ddeaguiar</a> I actually got a working SAML 2.0 auth solution up and running pretty quickly. I’ve deliberately architected it in such a way that the relevant namespaces can eventually be put inside their own a library. The basic idea is that the library consumer (just myself for now) supplies a small configuration map, joins their routes with a set of ready-made SAML routes, and then prepends a SAML-session auth interceptor chain to any route endpoints that require controlled access. That seemed the most logical way to do it to me. Would you say this is the idiomatic way to do things in Pedestal?</z><z id="t1606145386" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] It’s worth reviewing the benefit the library consumer gets by having the library manage routes as well. Routing and auth are different responsibilities. Sure, with SAML a service will have to participate in some sort of back-and-forth but the routes are just bindings to some implementation. I also suggest looking at prior art (even beyond Clojure). For example, I’ve not used https://github.com/propan/geheimtur in a long time but that lib did make the explicit choice to avoid dealing with routing."><y>#</y><d>2020-11-23</d><h>15:29</h><w>ddeaguiar</w><a>@simongray</a> It’s worth reviewing the benefit the library consumer gets by having the library manage routes as well. Routing and auth are different responsibilities. Sure, with SAML a service will have to participate in some sort of back-and-forth but the routes are just bindings to some implementation.  I also suggest looking at prior art (even beyond Clojure). For example, I’ve not used <a href="https://github.com/propan/geheimtur" target="_blank">https://github.com/propan/geheimtur</a> in a long time but that lib did make the explicit choice to avoid dealing with routing.</z></g><g id="s20"><z id="t1606145519" t="simongray The exact routes required for the SAML flow are all configurable in the config, but I set some defaults when left unconfigured."><y>#</y><d>2020-11-23</d><h>15:31</h><w>simongray</w>The exact routes required for the SAML flow are all configurable in the config, but I set some defaults when left unconfigured.</z><z id="t1606145955" t="simongray And you can of course just use the various interceptors in a an isolated way too. I just thought that an assembled set of routes would be quite illustrative 🙂"><y>#</y><d>2020-11-23</d><h>15:39</h><r>simongray</r>And you can of course just use the various interceptors in a an isolated way too. I just thought that an assembled set of routes would be quite illustrative <b>🙂</b></z><z id="t1606145844" t="simongray Unfortunately, I don’t think there is much prior art in the Clojure space. The primary reason I’m rolling my own is that the go-to solution in the Java space, Shibboleth-sp, is incredibly terse and I figured I would be better served by isolating the functionality I need in a small library and then re-using that for the various web services I need to make (they all require some form of SAML login). Thank you for the geheimtur link though. I didn’t know about that (and I don’t really how much OAuth 2.0 and SAML 2.0 resemble one another), but it’s useful to learn from anyway."><y>#</y><d>2020-11-23</d><h>15:37</h><w>simongray</w>Unfortunately, I don’t think there is much prior art in the Clojure space. The primary reason I’m rolling my own is that the go-to solution in the Java space, Shibboleth-sp, is incredibly terse and I figured I would be better served by isolating the functionality I need in a small library and then re-using that for the various web services I need to make (they all require some form of SAML login). Thank you for the geheimtur link though. I didn’t know about that (and I don’t really how much OAuth 2.0 and SAML 2.0 resemble one another), but it’s useful to learn from anyway.</z><z id="t1606148446" t="orestis Oh I’d love to see a new SAML implementation- it’s an area full of dangers and pitfalls. I assume [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] you’re delegating the core logic to another library?"><y>#</y><d>2020-11-23</d><h>16:20</h><w>orestis</w>Oh I’d love to see a new SAML implementation- it’s an area full of dangers and pitfalls. I assume <a>@simongray</a> you’re delegating the core logic to another library?</z><z id="t1606148503" t="simongray Yeah, I am using the metabase fork of the saml20-clj lib (which wraps the same core lib used by Shibboleth-sp)"><y>#</y><d>2020-11-23</d><h>16:21</h><w>simongray</w>Yeah, I am using the metabase fork of the saml20-clj lib (which wraps the same core lib used by Shibboleth-sp)</z><z id="t1606148600" t="simongray [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] current state https://github.com/kuhumcst/louis-hjelmslev/blob/development/src/dk/cst/pedestal_sp.clj and helper namespaces: https://github.com/kuhumcst/louis-hjelmslev/tree/development/src/dk/cst/pedestal_sp"><y>#</y><d>2020-11-23</d><h>16:23</h><w>simongray</w><a>@orestis</a> current state <a href="https://github.com/kuhumcst/louis-hjelmslev/blob/development/src/dk/cst/pedestal_sp.clj" target="_blank">https://github.com/kuhumcst/louis-hjelmslev/blob/development/src/dk/cst/pedestal_sp.clj</a>
and helper namespaces: <a href="https://github.com/kuhumcst/louis-hjelmslev/tree/development/src/dk/cst/pedestal_sp" target="_blank">https://github.com/kuhumcst/louis-hjelmslev/tree/development/src/dk/cst/pedestal_sp</a></z><z id="t1606148748" t="simongray and some kind of explanation of what I am doing which will eventually become the README of whatever repo I’m putting this in once I’m done with it: https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md"><y>#</y><d>2020-11-23</d><h>16:25</h><w>simongray</w>and some kind of explanation of what I am doing which will eventually become the README of whatever repo I’m putting this in once I’m done with it: <a href="https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md" target="_blank">https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md</a></z><z id="t1606215424" t="simongray Question: can I access the interceptor chains of other routes from inside an interceptor (through some path in the context)?"><y>#</y><d>2020-11-24</d><h>10:57</h><w>simongray</w>Question: can I access the interceptor chains of other routes from inside an interceptor (through some path in the context)?</z><z id="t1606215696" t="simongray I guess I can access the router interceptor, so could that be used to construct interceptor chains for named routes inside another interceptor?"><y>#</y><d>2020-11-24</d><h>11:01</h><w>simongray</w>I guess I can access the router interceptor, so could that be used to construct interceptor chains for named routes inside another interceptor?</z><z id="t1606220190" t="simongray Ok, so I had a look at the Pedestal source code and this is what I came up with: (defn- find-router* [stack] (loop [[ic &amp; remaining] stack] (if (= (:name ic) ::route/router) ic (recur remaining)))) (def find-router (memoize find-router*)) (defn context-&gt;router [ctx] (find-router (::chain/stack ctx))) ;; Modified version of `io.pedestal.http.route/try-routing-for` (defn routing-for [router query-string verb] (let [context {:request {:path-info query-string :request-method verb}} context ((:enter router) context)] (:route context))) And then inside the Interceptor you can do e.g. (-&gt; (context-&gt;router ctx) (routing-for &quot;/&quot; :get)) I’m not sure if it’s possible to resolve routes by route-names in this way, though."><y>#</y><d>2020-11-24</d><h>12:16</h><r>simongray</r>Ok, so I had a look at the Pedestal source code and this is what I came up with:
<pre>(defn- find-router*
  [stack]
  (loop [[ic &amp; remaining] stack]
    (if (= (:name ic) ::route/router)
      ic
      (recur remaining))))

(def find-router
  (memoize find-router*))

(defn context-&gt;router
  [ctx]
  (find-router (::chain/stack ctx)))

;; Modified version of `io.pedestal.http.route/try-routing-for`
(defn routing-for
  [router query-string verb]
  (let [context {:request {:path-info query-string
                           :request-method verb}}
        context ((:enter router) context)]
    (:route context)))</pre>
And then inside the Interceptor you can do e.g.
<pre>(-&gt; (context-&gt;router ctx)
    (routing-for &quot;/&quot; :get))</pre>
I’m not sure if it’s possible to resolve routes by route-names in this way, though.</z><z id="t1606222597" t="simongray It seems you can do this to get a URL from the context and a route-name: (defn url-for [{:keys [bindings] :as ctx} &amp; args] (let [*url-for* @(get bindings #&apos;io.pedestal.http.route/*url-for*)] (apply *url-for* args)))"><y>#</y><d>2020-11-24</d><h>12:56</h><r>simongray</r>It seems you can do this to get a URL from the context and a route-name:
<pre>(defn url-for
  [{:keys [bindings] :as ctx} &amp; args]
  (let [*url-for* @(get bindings #&apos;io.pedestal.http.route/*url-for*)]
    (apply *url-for* args)))</pre></z><z id="t1606222728" t="simongray But it doesn’t seem possible to get a fully bidirectional variant, since you still need a verb and possibly some route-specific params to resolve to the correct routing."><y>#</y><d>2020-11-24</d><h>12:58</h><r>simongray</r>But it doesn’t seem possible to get a fully bidirectional variant, since you still need a verb and possibly some route-specific params to resolve to the correct routing.</z><z id="t1606229780" t="orestis What do you need to do?"><y>#</y><d>2020-11-24</d><h>14:56</h><r>orestis</r>What do you need to do?</z><z id="t1606244158" t="simongray I’m trying to make a function to be used when generating frontend content that can determine whether access to a route is possible or not based on the existence of certain interceptors so that I can e.g. disable/remove certain links dynamically, but I want to accomplish it by reading from the service context only."><y>#</y><d>2020-11-24</d><h>18:55</h><r>simongray</r>I’m trying to make a function to be used when generating frontend content that can determine whether access to a route is possible or not based on the existence of certain interceptors so that I can e.g. disable/remove certain links dynamically, but I want to accomplish it by reading from the service context only.</z><z id="t1606244411" t="simongray So that you can do something like [(restrict-to ...) ....] in the interceptor chain of one route and then in a response content-generating interceptor of another route you call something like (allowed? ...) in some hiccup-generating logic to determine whether a route is authenticated and/or authorised for the SAML user, using this information to modify the HTML content being served in order to nudge the user away from clicking links that will end badly (e.g. 403 forbidden)."><y>#</y><d>2020-11-24</d><h>19:00</h><r>simongray</r>So that you can do something like  <code>[(restrict-to ...) ....]</code> in the interceptor chain of one route and then in a response content-generating interceptor of another route you call something like <code>(allowed? ...)</code> in some hiccup-generating logic to determine whether a route is authenticated and/or authorised for the SAML user, using this information to modify the HTML content being served in order to nudge the user away from clicking links that will end badly (e.g. 403 forbidden).</z><z id="t1606244474" t="simongray The trick is trying to do it in a decoupled way, only considering what’s in context."><y>#</y><d>2020-11-24</d><h>19:01</h><r>simongray</r>The trick is trying to do it in a decoupled way, only considering what’s in context.</z><z id="t1606245346" t="simongray I admit it&apos;s kind of an experimental approach, but I did have to solve something similar at my old work right before I left in their huge legacy system (in fact, I hear they&apos;re still trying to solve it) and I have this feeling that a fairly integrated system could be made from a few basic interceptors and some helper functions."><y>#</y><d>2020-11-24</d><h>19:15</h><r>simongray</r>I admit it&apos;s kind of an experimental approach, but I did have to solve something similar at my old work right before I left in their huge legacy system (in fact, I hear they&apos;re still trying to solve it) and I have this feeling that a fairly integrated system could be made from a few basic interceptors and some helper functions.</z><z id="t1606323136" t="orestis I still don’t quite get it :) are you saying something like “the UI shouldn’t contain links that will be rejected anyway”? And then using your pedestal routes to figure that out?"><y>#</y><d>2020-11-25</d><h>16:52</h><r>orestis</r>I still don’t quite get it :) are you saying something like “the UI shouldn’t contain links that will be rejected anyway”? And then using your pedestal routes to figure that out?</z><z id="t1606323234" t="orestis I’m not 100% on the extra data that you can put in pedestals routes (I don’t heavily use them and for front end I use reitit) but I would probably move this info out to some other data structure and generate both interceptors and permission logic based on it..."><y>#</y><d>2020-11-25</d><h>16:53</h><r>orestis</r>I’m not 100% on the extra data that you can put in pedestals routes (I don’t heavily use them and for front end I use reitit) but I would probably move this info out to some other data structure and generate both interceptors and permission logic based on it...</z><z id="t1606345559" t="simongray I managed to make it work earlier. Explained here: https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md#bidirectional-authorisation"><y>#</y><d>2020-11-25</d><h>23:05</h><r>simongray</r>I managed to make it work earlier. Explained here: <a href="https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md#bidirectional-authorisation" target="_blank">https://github.com/kuhumcst/louis-hjelmslev/blob/development/pedestal-sp.md#bidirectional-authorisation</a></z><z id="t1606345755" t="simongray I’m still ruminating on the frontend part, specifically how to integrate this with a SPA :)"><y>#</y><d>2020-11-25</d><h>23:09</h><r>simongray</r>I’m still ruminating on the frontend part, specifically how to integrate this with a SPA :)</z><z id="t1606345900" t="simongray And sure you can always go back one level, but that introduces coupling, along with additional configuration and parameters to pass along to functions. The challenge is to get rid of those :)"><y>#</y><d>2020-11-25</d><h>23:11</h><r>simongray</r>And sure you can always go back one level, but that introduces coupling, along with additional configuration and parameters to pass along to functions. The challenge is to get rid of those :)</z><z id="t1606375848" t="orestis We introduced a permissions namespace that speaks the domain language, and many resources (served by graphql, but should work in any case) expose flags about permitted operations..."><y>#</y><d>2020-11-26</d><h>07:30</h><r>orestis</r>We introduced a permissions namespace that speaks the domain language, and many resources (served by graphql, but should work in any case) expose flags about permitted operations...</z><z id="t1606375887" t="orestis So that the SPA can do data-driven UI. Still in the discovery phase though..."><y>#</y><d>2020-11-26</d><h>07:31</h><r>orestis</r>So that the SPA can do data-driven UI. Still in the discovery phase though...</z><z id="t1606379684" t="simongray Yeah, something like that is definitely an option. Direct coupling with an API is quite convenient, but if I want this to be a in a library I’m going to need something slightly more generic. Maybe it’ll take a few walks before I figure out a good way 🙂"><y>#</y><d>2020-11-26</d><h>08:34</h><r>simongray</r>Yeah, something like that is definitely an option. Direct coupling with an API is quite convenient, but if I want this to be a in a library I’m going to need something slightly more generic. Maybe it’ll take a few walks before I figure out a good way <b>🙂</b></z><z id="t1606235276" t="Michael Stokley if i&apos;m running a pedestal server in a separate thread (for testing purposes), how can i clean it up, or kill it? i&apos;ve tried (.interrupt thread-with-running-server) but it doesn&apos;t seem to help"><y>#</y><d>2020-11-24</d><h>16:27</h><w>Michael Stokley</w>if i&apos;m running a pedestal server in a separate thread (for testing purposes), how can i clean it up, or kill it? i&apos;ve tried <code>(.interrupt thread-with-running-server)</code> but it doesn&apos;t seem to help</z><z id="t1606235321" t="Michael Stokley we also tried putting the server in an atom and running (http/stop @server-atom) but since running the server blocks, it never gets swapped into the atom in the first place"><y>#</y><d>2020-11-24</d><h>16:28</h><r>Michael Stokley</r>we also tried putting the server in an atom and running <code>(http/stop @server-atom)</code> but since running the server blocks, it never gets swapped into the atom in the first place</z><z id="t1606235333" t="Michael Stokley at least, this is what we think is happening"><y>#</y><d>2020-11-24</d><h>16:28</h><r>Michael Stokley</r>at least, this is what we think is happening</z><z id="t1606236488" t="Michael Stokley should this just be handled by setting :http/join? to false?"><y>#</y><d>2020-11-24</d><h>16:48</h><r>Michael Stokley</r>should this just be handled by setting <code>:http/join?</code> to false?</z><z id="t1606240844" t="Michael Stokley ok, figured this out. need to add a try catch in the function passed to the thread to allow it to be interrupt-able. then i can run whatever shutdown actions i need."><y>#</y><d>2020-11-24</d><h>18:00</h><r>Michael Stokley</r>ok, figured this out. need to add a try catch in the function passed to the thread to allow it to be interrupt-able. then i can run whatever shutdown actions i need.</z><z id="t1606240967" t="orestis Join to false seems more robust to me"><y>#</y><d>2020-11-24</d><h>18:02</h><r>orestis</r>Join to false seems more robust to me</z><z id="t1606248989" t="souenzzo Do pedestal (or some pedestal lib) do routing given the HTTP domain?"><y>#</y><d>2020-11-24</d><h>20:16</h><w>souenzzo</w>Do pedestal (or some pedestal lib) do routing given the HTTP domain?</z><z id="t1606249934" t="souenzzo In ring/pedestal, the domain is the :host"><y>#</y><d>2020-11-24</d><h>20:32</h><w>souenzzo</w>In ring/pedestal, the domain is the <code>:host</code></z><z id="t1606258658" t="hlship So, let me tell you a story ... the other day, we had a network problem in our load balancers; this caused IO problems writing the response to the client (`io.pedestal.http.impl.servlet-interceptor/ring-response`); the exceptions thrown were caught by stylobate and logged. The exception occured inside io.pedestal.http.impl.servlet_interceptor/write-body . • Problem was, other interceptors had attached large maps to the :request ; logging that produced 800KB of output per exception which caused a cascade of other problems • When using io.pedestal.http/create-server you end up threading through io.pedestal.http.impl.servlet-interceptor/http-interceptor-service-fn where stylobate and ring-response interceptors are added • This is in internal implementation, and things are private; very hard to override stylobate&apos;s behavior here without forcing access to private functions So, I&apos;m changing our interceptors to, on leave/error, remove the added keys, but that&apos;s not totally foolproof. I really just want to tweak stylobate&apos;s logging to not include the context (or, perhaps, carefully include only selected keys from the context and request). I&apos;m thinking the best solution might be to add our own own top-level error reporting interceptor and put a ring-response directly after; this will do the expected response writing work, and then the Pedestal-added ring-response will see that the response has already been committed (and the :body removed) and do nothing. TL;DR; if you are putting large maps into the context and they percolate back up out of your code, and an exception is thrown when writing the response stream to the client, then you will experience logging grief, and there isn&apos;t an easy way to override Pedestal&apos;s behavior here."><y>#</y><d>2020-11-24</d><h>22:57</h><w>hlship</w>So, let me tell you a story ... the other day, we had a network problem in our load balancers; this caused IO problems writing the response to the client (`io.pedestal.http.impl.servlet-interceptor/ring-response`); the exceptions thrown were caught by <code>stylobate</code> and logged.  The exception occured inside <code>io.pedestal.http.impl.servlet_interceptor/write-body</code>.
• Problem was, other interceptors had attached large maps to the <code>:request</code> ; logging that produced 800KB of output per exception which caused a cascade of other problems
• When using <code>io.pedestal.http/create-server</code>  you end up threading through <code>io.pedestal.http.impl.servlet-interceptor/http-interceptor-service-fn</code> where stylobate and ring-response interceptors are added
• This is in internal implementation, and things are private; very hard to override stylobate&apos;s behavior here without forcing access to private functions
So, I&apos;m changing our interceptors to, on leave/error, remove the added keys, but that&apos;s not totally foolproof. I really just want to tweak stylobate&apos;s logging to not include the context (or, perhaps, carefully include only selected keys from the context and request).

I&apos;m thinking the best solution might be to add our own own top-level error reporting interceptor and put a <code>ring-response</code> directly after; this will do the expected response writing work, and then the Pedestal-added <code>ring-response</code> will see that the response has already been committed (and the <code>:body</code> removed) and do nothing.

TL;DR; if you are putting large maps into the context and they percolate back up out of your code, and an exception is thrown when writing the response stream to the client, then you will experience logging grief, and there isn&apos;t an easy way to override Pedestal&apos;s behavior here.</z><z id="t1606496261" t="hlship I&apos;m trying a solution, an interceptor that sits early in the stack, and green-lists all the context and request keys (on enter) and uses select-keys on leave/error (obviously, also allowing :response)."><y>#</y><d>2020-11-27</d><h>16:57</h><r>hlship</r>I&apos;m trying a solution, an interceptor that sits early in the stack,  and green-lists all the context and request keys  (on enter) and uses select-keys on leave/error (obviously, also allowing :response).</z><z id="t1606316111" t="simongray Something I’ve been wondering about…. why is it necessary to have this separation into a context map and a response map. Why can’t the response map itself be treated as the context?"><y>#</y><d>2020-11-25</d><h>14:55</h><w>simongray</w>Something I’ve been wondering about…. why is it necessary to have this separation into a context map and a response map. Why can’t the response map itself be treated as the context?</z><z id="t1606320813" t="souenzzo https://github.com/metosin/sieppari does that For pedestal, i think the reason is &quot;history&quot;"><y>#</y><d>2020-11-25</d><h>16:13</h><r>souenzzo</r><a href="https://github.com/metosin/sieppari" target="_blank">https://github.com/metosin/sieppari</a> does that
For pedestal, i think the reason is &quot;history&quot;</z><z id="t1606324339" t="simongray Interesting. I have some difficulties gauging how much of Pedestal is replaced by reitit/sieppari and possibly other metosin projects?"><y>#</y><d>2020-11-25</d><h>17:12</h><r>simongray</r>Interesting. I have some difficulties gauging how much of Pedestal is replaced by reitit/sieppari and possibly other metosin projects?</z><z id="t1606340460" t="souenzzo I prefer pedestal. I have some critiques about metosin tools"><y>#</y><d>2020-11-25</d><h>21:41</h><r>souenzzo</r>I prefer pedestal. I have some critiques about metosin tools</z><z id="t1606345595" t="simongray What kind of critiques?"><y>#</y><d>2020-11-25</d><h>23:06</h><r>simongray</r>What kind of critiques?</z><z id="t1606347054" t="souenzzo - they do performance in a &quot;microbenchmark world&quot; - they usually prefer unqualified keys - they use BreakVer - they usually over-extend their interfaces to &quot;developer easiness&quot;"><y>#</y><d>2020-11-25</d><h>23:30</h><r>souenzzo</r>- they do performance in a &quot;microbenchmark world&quot;
- they usually prefer unqualified keys
- they use <code>BreakVer</code>
- they usually over-extend their interfaces to &quot;developer easiness&quot;</z><z id="t1606347339" t="simongray Interesting. I’m not that intimately familiar with their libraries other than spec-tools which we had a couple of uses for at my old work. My superficial impression is that they seem to be kind of intent on learning from and one-upping Cognitect with many of their libs."><y>#</y><d>2020-11-25</d><h>23:35</h><r>simongray</r>Interesting. I’m not that intimately familiar with their libraries other than spec-tools which we had a couple of uses for at my old work. My superficial impression is that they seem to be kind of intent on learning from and one-upping Cognitect with many of their libs.</z><z id="t1606347470" t="simongray I think there is definitely some value in a slow-moving project like Pedestal and I do respect Dan, whom I’ve met a few times as he was a visiting consultant at my old workplace (along with many other Cognitecters)."><y>#</y><d>2020-11-25</d><h>23:37</h><r>simongray</r>I think there is definitely some value in a slow-moving project like Pedestal and I do respect Dan, whom I’ve met a few times as he was a visiting consultant at my old workplace (along with many other Cognitecters).</z><z id="t1606348708" t="souenzzo I&apos;m not belittling their work. I use/recommend them. But I do not feel as confident with it."><y>#</y><d>2020-11-25</d><h>23:58</h><r>souenzzo</r>I&apos;m not belittling their work. I use/recommend them. But I do not feel as confident with it.</z><z id="t1606401959" t="gphilipp 👋 [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] I’ve raised https://github.com/pedestal/pedestal/pull/673 but the build is failing because Github Actions has introduced last month a guard against scripts modifying env variables (eg lein setting LEIN_HOME ). It seems that you can allow this by setting the ACTIONS_ALLOW_UNSECURE_COMMANDS to true see https://github.blog/changelog/2020-10-01-github-actions-deprecating-set-env-and-add-path-commands/"><y>#</y><d>2020-11-26</d><h>14:45</h><w>gphilipp</w><b>👋</b> <a>@ddeaguiar</a> I’ve raised <a href="https://github.com/pedestal/pedestal/pull/673" target="_blank">https://github.com/pedestal/pedestal/pull/673</a>but the build is failing because Github Actions has introduced last month a guard against scripts modifying env variables (eg <code>lein</code> setting <code>LEIN_HOME</code>). It seems that you can allow this by setting the <code>ACTIONS_ALLOW_UNSECURE_COMMANDS</code> to <code>true</code> see <a href="https://github.blog/changelog/2020-10-01-github-actions-deprecating-set-env-and-add-path-commands/" target="_blank">https://github.blog/changelog/2020-10-01-github-actions-deprecating-set-env-and-add-path-commands/</a></z><z id="t1606475830" t="simongray I don’t think I quite understand error handling. According to http://Pedestal.io : &gt; As long as there is an error attached to that key, Pedestal will not invoke the usual `:enter` and `:leave` functions. Instead, it looks for the next interceptor in the chain that has a `:error` function attached to it. So I would expect that throwing an exception in the :enter function would look for the exception handling Interceptor next in the queue. However, the behaviour actually seems to be the opposite: only Interceptors that come before the throwing Interceptor are considered."><y>#</y><d>2020-11-27</d><h>11:17</h><w>simongray</w>I don’t think I quite understand error handling. According to <a href="http://Pedestal.io" target="_blank">http://Pedestal.io</a>:
&gt; As long as there is an error attached to that key, Pedestal will not invoke the usual `:enter` and `:leave` functions. Instead, it looks for the next interceptor in the chain that has a `:error` function attached to it.
So I would expect that throwing an exception in the <code>:enter</code> function would look for the exception handling Interceptor next in the queue. However, the behaviour actually seems to be the opposite: only Interceptors that come before the throwing Interceptor are considered.</z><z id="t1606475885" t="simongray I guess “the chain” really means “Interceptors that have been visited at least once”."><y>#</y><d>2020-11-27</d><h>11:18</h><w>simongray</w>I guess “the chain” really means “Interceptors that have been visited at least once”.</z><z id="t1606475905" t="simongray and then anything that comes after the throwing Interceptor is thrown out."><y>#</y><d>2020-11-27</d><h>11:18</h><w>simongray</w>and then anything that comes after the throwing Interceptor is thrown out.</z><z id="t1606476131" t="simongray So should error handlers always be put at the very beginning of the Interceptors vector?"><y>#</y><d>2020-11-27</d><h>11:22</h><w>simongray</w>So should error handlers always be put at the very beginning of the Interceptors vector?</z><z id="t1606477310" t="orestis yes, a thrown exception AFAIK will terminate the queue and start unwinding"><y>#</y><d>2020-11-27</d><h>11:41</h><w>orestis</w>yes, a thrown exception AFAIK will terminate the queue and start unwinding</z><z id="t1606477425" t="souenzzo I found some tests with routing with :app-name // :host But I can&apos;t make it work. There is any sample app using this? (i prefer tabular routes once all my routes are tabular at this moment) https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/test/io/pedestal/http/route_test.clj#L285"><y>#</y><d>2020-11-27</d><h>11:43</h><w>souenzzo</w>I found some tests with routing with <code>:app-name</code> // <code>:host</code>
But I can&apos;t make it work. There is any sample app using this?
(i prefer tabular routes once all my routes are tabular at this moment)
<a href="https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/test/io/pedestal/http/route_test.clj#L285" target="_blank">https://github.com/pedestal/pedestal/blob/aa71a3a630dd21861c0682eeeebec762cbf3f85c/service/test/io/pedestal/http/route_test.clj#L285</a></z><z id="t1606477498" t="souenzzo I&apos;m trying with ::http/routes (vec (concat (route/expand-routes red-green) (route/expand-routes todo-list))) It throws Execution error (AssertionError) at io.pedestal.http.route.definition.terse/eval12443$fn (terse.clj:52). Assert failed: Cannot expand &apos;[:path &quot;/red&quot;]&apos; as a route. Expected a verb map or path string, but found a class clojure.lang.MapEntry instead false"><y>#</y><d>2020-11-27</d><h>11:44</h><r>souenzzo</r>I&apos;m trying with
<pre>::http/routes (vec (concat
                     (route/expand-routes red-green)
                     (route/expand-routes todo-list)))</pre>
It throws
<pre>Execution error (AssertionError) at io.pedestal.http.route.definition.terse/eval12443$fn (terse.clj:52).
Assert failed: Cannot expand &apos;[:path &quot;/red&quot;]&apos; as a route. Expected a verb map or path string, but found a class clojure.lang.MapEntry instead
false</pre></z><z id="t1606478212" t="souenzzo OK, i should just concat, not vec concat"><y>#</y><d>2020-11-27</d><h>11:56</h><r>souenzzo</r>OK, i should just concat, not vec concat</z><z id="t1606478246" t="souenzzo Pedestal is awesome. If there is docs for it, it would be a good clojure selling point"><y>#</y><d>2020-11-27</d><h>11:57</h><r>souenzzo</r>Pedestal is awesome. If there is docs for it, it would be a good clojure selling point</z><z id="t1606482230" t="souenzzo https://gist.github.com/souenzzo/84851560aefb2e919e293996d3c9f1ff"><y>#</y><d>2020-11-27</d><h>13:03</h><r>souenzzo</r><a href="https://gist.github.com/souenzzo/84851560aefb2e919e293996d3c9f1ff" target="_blank">https://gist.github.com/souenzzo/84851560aefb2e919e293996d3c9f1ff</a></z><z id="t1606749284" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] by using vec you inadvertently switched routing syntax. FWIW, the docs do http://pedestal.io/reference/routing-quick-reference#_routes the relation between routing syntax and data structure type."><y>#</y><d>2020-11-30</d><h>15:14</h><r>ddeaguiar</r><a>@U2J4FRT2T</a> by using <code>vec</code> you inadvertently switched routing syntax. FWIW, the docs do <a href="http://pedestal.io/reference/routing-quick-reference#_routes" target="_blank">http://pedestal.io/reference/routing-quick-reference#_routes</a> the relation between routing syntax and data structure type.</z><z id="t1606478246" t="souenzzo Pedestal is awesome. If there is docs for it, it would be a good clojure selling point"><y>#</y><d>2020-11-27</d><h>11:57</h><w>souenzzo</w>Pedestal is awesome. If there is docs for it, it would be a good clojure selling point</z><z id="t1606720088" t="dangercoder How do you handle metrics with pedestal &amp; prometheus? I need to expose a metrics endpoint and I am using Prometheus, which scrapes a /metrics endpoint. I found this issue: https://github.com/pedestal/pedestal/issues/568"><y>#</y><d>2020-11-30</d><h>07:08</h><w>dangercoder</w>How do you handle metrics with pedestal &amp; prometheus? I need to expose a metrics endpoint and I am using Prometheus, which scrapes a /metrics endpoint.

I found this issue: <a href="https://github.com/pedestal/pedestal/issues/568" target="_blank">https://github.com/pedestal/pedestal/issues/568</a></z><z id="t1606721277" t="dangercoder One way to do it is to use the micrometer-java-lib and expose an /metrics endpoint"><y>#</y><d>2020-11-30</d><h>07:27</h><r>dangercoder</r>One way to do it is to use the micrometer-java-lib and expose an /metrics endpoint</z><z id="t1606739279" t="dangercoder The current implementation for pedestal looks extenable, great news 🙂 https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj"><y>#</y><d>2020-11-30</d><h>12:27</h><r>dangercoder</r>The current implementation for pedestal looks extenable, great news <b>🙂</b> <a href="https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj" target="_blank">https://github.com/pedestal/pedestal/blob/master/log/src/io/pedestal/log.clj</a></z><z id="t1607006612" t="dangercoder Hi, I have a problem with using Pedestal on Kubernetes (most likely due to the default security in Pedestal) I keep on getting &quot;connection refused&quot;, I can see that the readiness probe hitting the application web server: 14:40:40.294 [qtp1307000786-19] INFO io.pedestal.http - {:msg &quot;GET /health&quot;, :line 80} I currently have this config: ::http/type :jetty ::http/secure-headers nil ::http/host &quot;0.0.0.0&quot; ::http/port port ::http/enable-csrf false Anyone who have had similar issues?"><y>#</y><d>2020-12-03</d><h>14:43</h><w>dangercoder</w>Hi, I have a problem with using Pedestal on Kubernetes (most likely due to the default security in Pedestal)

I keep on getting &quot;connection refused&quot;, I can see that the readiness probe hitting the application web server:
<code>14:40:40.294 [qtp1307000786-19] INFO  io.pedestal.http  - {:msg &quot;GET /health&quot;, :line 80}</code>

I currently have this config:
<pre>::http/type           :jetty
                     ::http/secure-headers nil
                     ::http/host           &quot;0.0.0.0&quot;
                     ::http/port           port
                     ::http/enable-csrf    false</pre>
Anyone who have had similar issues?</z><z id="t1607006854" t="dangercoder actually I fixed it with my current config. It was the secure headers setting that made it not work 🙂"><y>#</y><d>2020-12-03</d><h>14:47</h><r>dangercoder</r>actually I fixed it with my current config. It was the secure headers setting that made it not work <b>🙂</b></z><z id="t1607040200" t="smnplk Hi! I am a complete pedestal newb and don&apos;t know how to tell my server to serve static resources from resources/ folder"><y>#</y><d>2020-12-04</d><h>00:03</h><w>smnplk</w>Hi! I am a complete pedestal newb and don&apos;t know how to tell my server to serve static resources from resources/ folder</z><z id="t1607040246" t="smnplk I do have { :: http/resource-path &quot;/public&quot; ...} in my server config map"><y>#</y><d>2020-12-04</d><h>00:04</h><w>smnplk</w>I do have   {<b>::</b>http/resource-path &quot;/public&quot; ...} in my server config map</z><z id="t1607040266" t="smnplk and I do have resources/public folder in my project dir"><y>#</y><d>2020-12-04</d><h>00:04</h><w>smnplk</w>and I do have resources/public folder in my project dir</z><z id="t1607040409" t="smnplk (def server-config {::http/resource-path &quot;/public&quot; ::http/routes routes ::http/type :jetty ::http/port 8890}) This is my config map."><y>#</y><d>2020-12-04</d><h>00:06</h><w>smnplk</w><pre>(def server-config
  {::http/resource-path &quot;/public&quot;
   ::http/routes        routes
   ::http/type          :jetty
   ::http/port          8890})</pre>
This is my config map.</z><z id="t1607040538" t="smnplk I have a in resources/public/file.txt and when I request it (localhost:8890/file.txt), I get a 404"><y>#</y><d>2020-12-04</d><h>00:08</h><w>smnplk</w>I have a in resources/public/file.txt and when I request it (localhost:8890/file.txt), I get a 404</z><z id="t1607040570" t="smnplk I was following official docs"><y>#</y><d>2020-12-04</d><h>00:09</h><w>smnplk</w>I was following official docs</z><z id="t1607053772" t="souenzzo [:attrs {:href &quot;/_/_/users/U068UBMJR&quot;}] resource-path will search inside your &quot;JVM resources&quot; So if you have resources/public/page.html : - Your deps.edn/project.clj should contian :paths [... &quot;resources&quot;] or :resource-paths [&quot;resources&quot;] - Changes in deps/project.clj need a repl restart - Use ::http/resource-path &quot;public&quot; - connect to "><y>#</y><d>2020-12-04</d><h>03:49</h><w>souenzzo</w><a>@smnplk</a> <code>resource-path</code> will search inside your &quot;JVM resources&quot;
So if you have <code>resources/public/page.html</code>:
- Your deps.edn/project.clj should contian <code>:paths [... &quot;resources&quot;]</code> or <code>:resource-paths [&quot;resources&quot;]</code>
- Changes in deps/project.clj need a repl restart
- Use <code>::http/resource-path &quot;public&quot;</code>
- connect to <code></code></z><z id="t1607054943" t="smnplk yeah, i just wanted to write my solution. I did some debugging with ( http://clojure.java.io/resource &quot;path-to-file) and it dawned on me, that i don&apos;t have the resources folder specified under :paths inside deps.edn"><y>#</y><d>2020-12-04</d><h>04:09</h><w>smnplk</w>yeah, i just wanted to write my solution. I did some debugging with  (<a href="http://clojure.java.io/resource" target="_blank">http://clojure.java.io/resource</a> &quot;path-to-file) and it dawned on me, that i don&apos;t have the resources folder specified under :paths inside deps.edn</z><z id="t1607054983" t="smnplk never learn 2 different tools at the same time 😉"><y>#</y><d>2020-12-04</d><h>04:09</h><w>smnplk</w>never learn 2 different tools at the same time <b>😉</b></z><z id="t1607370038" t="souenzzo How can I turn things like /foo/{id} (swagger/openapi path specs) into something that pedestal understand, like /foo/:id"><y>#</y><d>2020-12-07</d><h>19:40</h><w>souenzzo</w>How can I turn things like <code>/foo/{id}</code> (swagger/openapi path specs) into something that pedestal understand, like <code>/foo/:id</code></z><z id="t1607370183" t="souenzzo (string/replace &quot;/foo/{bar}/car/{var}&quot; #&quot;(\{[^\}]+\})&quot; (fn [[v _]] (str &quot;:&quot; (subs v 1 (dec (count v))))))"><y>#</y><d>2020-12-07</d><h>19:43</h><r>souenzzo</r><pre>(string/replace &quot;/foo/{bar}/car/{var}&quot;
                #&quot;(\{[^\}]+\})&quot;
                (fn [[v _]]
                  (str &quot;:&quot; (subs v 1 (dec (count v))))))</pre></z><z id="t1607379958" t="souenzzo I&apos;m still looking for a &quot;final solution&quot; for this issue"><y>#</y><d>2020-12-07</d><h>22:25</h><r>souenzzo</r>I&apos;m still looking for a &quot;final solution&quot; for this issue</z><z id="t1607412979" t="simongray seems good enough to me. What’s wrong with using regex?"><y>#</y><d>2020-12-08</d><h>07:36</h><r>simongray</r>seems good enough to me. What’s wrong with using regex?</z><z id="t1607413336" t="simongray You could cut down a bit by using an inner group, I think: (string/replace &quot;/foo/{bar}/car/{var}&quot; #&quot;(\{([^\}]+)\})&quot; (fn [[_ _ token]] (str &quot;:&quot; token)))"><y>#</y><d>2020-12-08</d><h>07:42</h><r>simongray</r>You could cut down a bit by using an inner group, I think:
<pre>(string/replace &quot;/foo/{bar}/car/{var}&quot;
                 #&quot;(\{([^\}]+)\})&quot;
                 (fn [[_ _ token]]
                   (str &quot;:&quot; token)))</pre></z><z id="t1607413403" t="simongray then the function gets [full-match, outer-group, inner-group] as its input."><y>#</y><d>2020-12-08</d><h>07:43</h><r>simongray</r>then the function gets <code>[full-match, outer-group, inner-group]</code> as its input.</z><z id="t1607420082" t="souenzzo I&apos;m implementing a REST interface that flows google style it use things like &quot;/orders/{order-id}/fulfillments:create-with-invoice&quot; https://cloud.google.com/apis/design/custom_methods I still don&apos;t know how to handle this in pedestal. Not even writing the path &quot;manually&quot;"><y>#</y><d>2020-12-08</d><h>09:34</h><r>souenzzo</r>I&apos;m implementing a REST interface that flows google style

it use  things like <code>&quot;/orders/{order-id}/fulfillments:create-with-invoice&quot;</code>

<a href="https://cloud.google.com/apis/design/custom_methods" target="_blank">https://cloud.google.com/apis/design/custom_methods</a>

I still don&apos;t know how to handle this in pedestal.
Not even writing the path &quot;manually&quot;</z><z id="t1607420082" t="souenzzo I&apos;m implementing a REST interface that flows google style it use things like &quot;/orders/{order-id}/fulfillments:create-with-invoice&quot; https://cloud.google.com/apis/design/custom_methods I still don&apos;t know how to handle this in pedestal. Not even writing the path &quot;manually&quot;"><y>#</y><d>2020-12-08</d><h>09:34</h><w>souenzzo</w>I&apos;m implementing a REST interface that flows google style

it use  things like <code>&quot;/orders/{order-id}/fulfillments:create-with-invoice&quot;</code>

<a href="https://cloud.google.com/apis/design/custom_methods" target="_blank">https://cloud.google.com/apis/design/custom_methods</a>

I still don&apos;t know how to handle this in pedestal.
Not even writing the path &quot;manually&quot;</z><z id="t1607504913" t="simongray I’m trying to figure out whether I screwed up my SSL/HTTPS config somehow or whether the IT department providing the server did. If I make an HTTPS request to a Pedestal web service and I get an 1) empty response and 2) the Pedestal log show no request having been made, then I guess it’s safe to assume that my IT department is blocking port 443, right?"><y>#</y><d>2020-12-09</d><h>09:08</h><w>simongray</w>I’m trying to figure out whether I screwed up my SSL/HTTPS config somehow or whether the IT department providing the server did.

If I make an HTTPS request to a Pedestal web service and I get an 1) empty response and 2) the Pedestal log show no request having been made, then I guess it’s safe to assume that my IT department is blocking port 443, right?</z><z id="t1607515405" t="souenzzo [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] double check ::http/host &quot;0.0.0.0&quot;"><y>#</y><d>2020-12-09</d><h>12:03</h><w>souenzzo</w><a>@simongray</a> double check <code>::http/host &quot;0.0.0.0&quot;</code></z><z id="t1607515750" t="simongray Thanks. That was actually the first surprising issue I had, but I solved it yesterday 🙂"><y>#</y><d>2020-12-09</d><h>12:09</h><r>simongray</r>Thanks. That was actually the first surprising issue I had, but I solved it yesterday <b>🙂</b></z><z id="t1607515928" t="simongray I think I narrowed this issue down to having to do with a failing SSL handshake, probably because I imported some Let’s Encrypt certificates into a java keystore in a wrong way..? To be fair, for some inexplicable reason using a certificate in Pedestal/Java applications requires using a keystore file and importing the certificates into a keystore, apparently requires first converting them into a separate pkcs12 file… it’s all very convoluted and hard to understand :P"><y>#</y><d>2020-12-09</d><h>12:12</h><w>simongray</w>I think I narrowed this issue down to having to do with a failing SSL handshake, probably because I imported some Let’s Encrypt certificates into a java keystore in a wrong way..? To be fair, for some inexplicable reason using a certificate in Pedestal/Java applications requires using a keystore file and importing the certificates into a keystore, apparently requires first converting them into a separate pkcs12 file… it’s all very convoluted and hard to understand  :P</z><z id="t1607528663" t="simongray Fixed… the problem was actually just me destructuring the wrong key somewhere in my Clojure code… sigh"><y>#</y><d>2020-12-09</d><h>15:44</h><r>simongray</r>Fixed… the problem was actually just me destructuring the wrong key somewhere in my Clojure code… sigh</z><z id="t1607679109" t="simongray Anybody have any experience with this? https://github.com/oliyh/pedestal-api"><y>#</y><d>2020-12-11</d><h>09:31</h><w>simongray</w>Anybody have any experience with this? <a href="https://github.com/oliyh/pedestal-api" target="_blank">https://github.com/oliyh/pedestal-api</a></z><z id="t1608208820" t="simongray Anybody know what the Docker support mentioned in the Github README is about? https://github.com/pedestal/pedestal#notable-capabilities"><y>#</y><d>2020-12-17</d><h>12:40</h><w>simongray</w>Anybody know what the Docker support mentioned in the Github README is about? <a href="https://github.com/pedestal/pedestal#notable-capabilities" target="_blank">https://github.com/pedestal/pedestal#notable-capabilities</a></z><z id="t1608209865" t="souenzzo I think that it&apos;s from early days of docker and it&apos;s just about &quot;we have a example of running on docker&quot;"><y>#</y><d>2020-12-17</d><h>12:57</h><r>souenzzo</r>I think that it&apos;s from early days of docker and it&apos;s just about &quot;we have a example of running on docker&quot;</z><z id="t1608211565" t="simongray I thought as much."><y>#</y><d>2020-12-17</d><h>13:26</h><r>simongray</r>I thought as much.</z><z id="t1608628768" t="simongray gzipping content in Jetty seems to actually break any emojis on an HTML page? At least it does in my case. Kind of strange."><y>#</y><d>2020-12-22</d><h>09:19</h><w>simongray</w>gzipping content in Jetty seems to actually break any emojis on an HTML page? At least it does in my case. Kind of strange.</z><z id="t1608630350" t="simongray Actually, scratch that, it seems that the issue is somehow Docker-related. Weird."><y>#</y><d>2020-12-22</d><h>09:45</h><w>simongray</w>Actually, scratch that, it seems that the issue is somehow Docker-related. Weird.</z><z id="t1608630955" t="simongray https://medium.com/quiq-blog/handling-emoticons-or-other-unicode-characters-beware-of-docker-images-f0f11673dac4"><y>#</y><d>2020-12-22</d><h>09:55</h><r>simongray</r><a href="https://medium.com/quiq-blog/handling-emoticons-or-other-unicode-characters-beware-of-docker-images-f0f11673dac4" target="_blank">https://medium.com/quiq-blog/handling-emoticons-or-other-unicode-characters-beware-of-docker-images-f0f11673dac4</a></z><z id="t1608659142" t="orestis [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] hm, I ran into an issue that the JVM uses by default the platform encoding. Best to set it explicitly via a Java system property. "><y>#</y><d>2020-12-22</d><h>17:45</h><w>orestis</w><a>@simongray</a> hm, I ran into an issue that the JVM uses by default the platform encoding. Best to set it explicitly via a Java system property. </z><z id="t1608659337" t="orestis Something like -Dfile.encoding=UTF-8"><y>#</y><d>2020-12-22</d><h>17:48</h><w>orestis</w>Something like <code>-Dfile.encoding=UTF-8</code></z><z id="t1608739313" t="zoad 👋 I created a simple application to test the return of a channel as response like this: https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md When I execute the code via lein run-dev and make a curl to the endpoint, it is working fine, returning 200 and the expected body. But when I generate a war and deploy it on Jetty, the endpoint still returns 200 but the body is empty. Do I need to configure something on jetty to make it work?"><y>#</y><d>2020-12-23</d><h>16:01</h><w>zoad</w><b>👋</b> I created a simple application to test the return of a channel as response like this: <a href="https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/guides/documentation/service-async.md</a> When I execute the code via <code>lein run-dev</code> and make a curl to the endpoint, it is working fine, returning 200 and the expected body. But when I generate a war and deploy it on Jetty, the endpoint still returns 200 but the body is empty. Do I need to configure something on jetty to make it work?</z><z id="t1608766181" t="zoad I figured out. I had to add &lt;async-supported&gt;true&lt;/async-supported&gt; to the web.xml generated."><y>#</y><d>2020-12-23</d><h>23:29</h><r>zoad</r>I figured out. I had to add <code>&lt;async-supported&gt;true&lt;/async-supported&gt;</code> to the web.xml generated.</z><z id="t1610022166" t="Eamonn Sullivan For my 10% day at work, I want to set up a basic GraphQL API using pedestal and lacinia-pedestal, but before I start creating from scratch, is there a tools-deps based template for such a thing around? I couldn&apos;t find one, but my google-fu may be poor. There&apos;s a lien template, but I&apos;ve become accustomed to deps.edn lately and would like to stick with that."><y>#</y><d>2021-01-07</d><h>12:22</h><w>Eamonn Sullivan</w>For my 10% day at work, I want to set up a basic GraphQL API using pedestal and lacinia-pedestal, but before I start creating from scratch, is there a tools-deps based template for such a thing around? I couldn&apos;t find one, but my google-fu may be poor. There&apos;s a lien template, but I&apos;ve become accustomed to deps.edn lately and would like to stick with that.</z><z id="t1610055779" t="souenzzo https://souenzzo.com.br/clojure-ssr-app-with-pedestal-and-hiccup.html"><y>#</y><d>2021-01-07</d><h>21:42</h><r>souenzzo</r><a href="https://souenzzo.com.br/clojure-ssr-app-with-pedestal-and-hiccup.html" target="_blank">https://souenzzo.com.br/clojure-ssr-app-with-pedestal-and-hiccup.html</a></z><z id="t1610095865" t="Eamonn Sullivan Thanks!"><y>#</y><d>2021-01-08</d><h>08:51</h><r>Eamonn Sullivan</r>Thanks!</z><z id="t1610486555" t="dangercoder Is it possible to define a default route in pedestal? e.g. if I don&apos;t get any hits, call this interceptor/handler."><y>#</y><d>2021-01-12</d><h>21:22</h><w>dangercoder</w>Is it possible to define a default route in pedestal? e.g. if I don&apos;t get any hits, call this interceptor/handler.</z><z id="t1610486583" t="dangercoder Ive done something similar with Reitit + Ring in the past. There you could define a &quot;default handler&quot;."><y>#</y><d>2021-01-12</d><h>21:23</h><r>dangercoder</r>Ive done something similar with Reitit + Ring in the past. There you could define a &quot;default handler&quot;.</z><z id="t1610486709" t="dangercoder One way to do it is to add a default interceptor that takes care of it."><y>#</y><d>2021-01-12</d><h>21:25</h><r>dangercoder</r>One way to do it is to add a default interceptor that takes care of it.</z><z id="t1610486716" t="ddeaguiar You can do so be specifying a catch-all route and using the linear-search router. The caveat is that the catchall route needs to be the last one specified."><y>#</y><d>2021-01-12</d><h>21:25</h><r>ddeaguiar</r>You can do so be specifying a catch-all route and using the linear-search router. The caveat is that the catchall route needs to be the last one specified.</z><z id="t1610486770" t="ddeaguiar You either use the terse route syntax or the table-routes fn to expand your routes directly"><y>#</y><d>2021-01-12</d><h>21:26</h><r>ddeaguiar</r>You either use the terse route syntax or the table-routes fn to expand your routes directly</z><z id="t1610486837" t="ddeaguiar Funny enough I was just looking at adding this info to the docs. It came up some time ago in the pedestal user groups ( https://groups.google.com/g/pedestal-users/c/lkrODbKivaU/m/cOtDLJNBDQAJ )"><y>#</y><d>2021-01-12</d><h>21:27</h><r>ddeaguiar</r>Funny enough I was just looking at adding this info to the docs. It came up some time ago in the pedestal user groups (<a href="https://groups.google.com/g/pedestal-users/c/lkrODbKivaU/m/cOtDLJNBDQAJ" target="_blank">https://groups.google.com/g/pedestal-users/c/lkrODbKivaU/m/cOtDLJNBDQAJ</a>)</z><z id="t1610486980" t="dangercoder Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] your answer was exactly what I was looking for 🙂"><y>#</y><d>2021-01-12</d><h>21:29</h><r>dangercoder</r>Thanks <a>@U0FL657GR</a> your answer was exactly what I was looking for <b>🙂</b></z><z id="t1610534202" t="simongray One could well imagine wanting to use a different route resolution algorithm while also having a default handler specified, right? It’s a bit sad that it’s complected like that."><y>#</y><d>2021-01-13</d><h>10:36</h><r>simongray</r>One could well imagine wanting to use a different route resolution algorithm while also having a default handler specified, right? It’s a bit sad that it’s complected like that.</z><z id="t1610537523" t="souenzzo I use ::http/not-found-interceptor"><y>#</y><d>2021-01-13</d><h>11:32</h><r>souenzzo</r>I use <code>::http/not-found-interceptor</code></z><z id="t1610548237" t="simongray Aha!"><y>#</y><d>2021-01-13</d><h>14:30</h><r>simongray</r>Aha!</z><z id="t1610554592" t="souenzzo For browsers, consider 303 + Location https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Location"><y>#</y><d>2021-01-13</d><h>16:16</h><r>souenzzo</r>For browsers, consider <code>303</code> + <code>Location</code>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Location" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Location</a></z><z id="t1610555301" t="simongray Right, doing an explicit redirect makes a lot of sense."><y>#</y><d>2021-01-13</d><h>16:28</h><r>simongray</r>Right, doing an explicit redirect makes a lot of sense.</z><z id="t1610561163" t="Braden Shepherdson I&apos;m trying to add CORS support to Protojure, which uses a Pedestal stack on top of undertow. it looks like a correct :response map is being created, but then when the undertow integration starts trying to build the response, I get an IllegalStateException that the response has already started being sent. I&apos;m not sure where to start looking to see how that might have happened or what part of my Pedestal stack started sending the response early."><y>#</y><d>2021-01-13</d><h>18:06</h><w>Braden Shepherdson</w>I&apos;m trying to add CORS support to Protojure, which uses a Pedestal stack on top of undertow. it looks like a correct <code>:response</code> map is being created, but then when the undertow integration starts trying to build the response, I get an <code>IllegalStateException</code> that the response has already started being sent. I&apos;m not sure where to start looking to see how that might have happened or what part of my Pedestal stack started sending the response early.</z><z id="t1610561188" t="Braden Shepherdson is there some magic I&apos;m not aware of when someone sets {:response {:status 200 ...}} on the context?"><y>#</y><d>2021-01-13</d><h>18:06</h><w>Braden Shepherdson</w>is there some magic I&apos;m not aware of when someone sets <code>{:response {:status 200 ...}}</code> on the context?</z><z id="t1610707384" t="orestis I’m looking into PAC4J as a possible authentication solution for our pedestal app. It claims: &gt; Available for most frameworks/tools (implementations): &gt; https://github.com/pac4j/spring-webmvc-pac4j  •  https://github.com/pac4j/j2e-pac4j  •  https://github.com/pac4j/pac4j-springboot  •  https://github.com/bujiio/buji-pac4j  •  https://github.com/pac4j/spring-security-pac4j  •  https://github.com/pac4j/play-pac4j  •  https://github.com/pac4j/vertx-pac4j &gt; https://github.com/pac4j/spark-pac4j  •  https://github.com/pac4j/javalin-pac4j  •  http://ratpack.io/manual/current/pac4j.html#pac4j  •  http://www.pippo.ro/doc/security.html#pac4j-integration  •  https://github.com/pac4j/undertow-pac4j  •  http://jooby.org/doc/pac4j &gt; https://apereo.github.io/cas/6.2.x/integration/Delegate-Authentication.html  •  https://github.com/pac4j/jax-rs-pac4j  •  https://github.com/pac4j/dropwizard-pac4j  •  https://github.com/pac4j/lagom-pac4j  •  https://github.com/StackVista/akka-http-pac4j  •  http://knox.apache.org/books/knox-1-1-0/user-guide.html#Pac4j+Provider+-+CAS+/+OAuth+/+SAML+/+OpenID+Connect"><y>#</y><d>2021-01-15</d><h>10:43</h><w>orestis</w>I’m looking into PAC4J as a possible authentication solution for our pedestal app. It claims:
&gt; Available for most frameworks/tools (implementations):
&gt; <a href="https://github.com/pac4j/spring-webmvc-pac4j" target="_blank">https://github.com/pac4j/spring-webmvc-pac4j</a> • <a href="https://github.com/pac4j/j2e-pac4j" target="_blank">https://github.com/pac4j/j2e-pac4j</a> • <a href="https://github.com/pac4j/pac4j-springboot" target="_blank">https://github.com/pac4j/pac4j-springboot</a> • <a href="https://github.com/bujiio/buji-pac4j" target="_blank">https://github.com/bujiio/buji-pac4j</a> • <a href="https://github.com/pac4j/spring-security-pac4j" target="_blank">https://github.com/pac4j/spring-security-pac4j</a> • <a href="https://github.com/pac4j/play-pac4j" target="_blank">https://github.com/pac4j/play-pac4j</a> • <a href="https://github.com/pac4j/vertx-pac4j" target="_blank">https://github.com/pac4j/vertx-pac4j</a>
&gt; <a href="https://github.com/pac4j/spark-pac4j" target="_blank">https://github.com/pac4j/spark-pac4j</a> • <a href="https://github.com/pac4j/javalin-pac4j" target="_blank">https://github.com/pac4j/javalin-pac4j</a> • <a href="http://ratpack.io/manual/current/pac4j.html#pac4j" target="_blank">http://ratpack.io/manual/current/pac4j.html#pac4j</a> • <a href="http://www.pippo.ro/doc/security.html#pac4j-integration" target="_blank">http://www.pippo.ro/doc/security.html#pac4j-integration</a> • <a href="https://github.com/pac4j/undertow-pac4j" target="_blank">https://github.com/pac4j/undertow-pac4j</a> • <a href="http://jooby.org/doc/pac4j" target="_blank">http://jooby.org/doc/pac4j</a>
&gt; <a href="https://apereo.github.io/cas/6.2.x/integration/Delegate-Authentication.html" target="_blank">https://apereo.github.io/cas/6.2.x/integration/Delegate-Authentication.html</a> • <a href="https://github.com/pac4j/jax-rs-pac4j" target="_blank">https://github.com/pac4j/jax-rs-pac4j</a> • <a href="https://github.com/pac4j/dropwizard-pac4j" target="_blank">https://github.com/pac4j/dropwizard-pac4j</a> • <a href="https://github.com/pac4j/lagom-pac4j" target="_blank">https://github.com/pac4j/lagom-pac4j</a> • <a href="https://github.com/StackVista/akka-http-pac4j" target="_blank">https://github.com/StackVista/akka-http-pac4j</a> • <a href="http://knox.apache.org/books/knox-1-1-0/user-guide.html#Pac4j+Provider+-+CAS+/+OAuth+/+SAML+/+OpenID+Connect" target="_blank">http://knox.apache.org/books/knox-1-1-0/user-guide.html#Pac4j+Provider+-+CAS+/+OAuth+/+SAML+/+OpenID+Connect</a></z><z id="t1610707419" t="orestis Is one of those (e.g. JEE) something I could use in combination with pedestal?"><y>#</y><d>2021-01-15</d><h>10:43</h><w>orestis</w>Is one of those (e.g. JEE) something I could use in combination with pedestal?</z><z id="t1610708849" t="jkxyz [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I imagine you could use the Undertow adapter with pedestal’s :context-configurator option"><y>#</y><d>2021-01-15</d><h>11:07</h><w>jkxyz</w><a>@orestis</a> I imagine you could use the Undertow adapter with pedestal’s <code>:context-configurator</code> option</z><z id="t1610709033" t="orestis That’s assuming I use the undertow pedestal adapter, right?"><y>#</y><d>2021-01-15</d><h>11:10</h><w>orestis</w>That’s assuming I use the undertow pedestal adapter, right?</z><z id="t1610709477" t="jkxyz We already use Undertow through immutant 🙂 immutant.web/run can take an Undertow handler. But I’m not sure how you would then get the authenticated user from the pedestal request context"><y>#</y><d>2021-01-15</d><h>11:17</h><w>jkxyz</w>We already use Undertow through immutant <b>🙂</b> <code>immutant.web/run</code> can take an Undertow handler. But I’m not sure how you would then get the authenticated user from the pedestal request context</z><z id="t1610709672" t="orestis I’m pretty sure we’re using jetty ;)"><y>#</y><d>2021-01-15</d><h>11:21</h><w>orestis</w>I’m pretty sure we’re using jetty ;)</z><z id="t1610710120" t="jkxyz You’re right 😛"><y>#</y><d>2021-01-15</d><h>11:28</h><w>jkxyz</w>You’re right <b>😛</b></z><z id="t1610710296" t="orestis Don’t mind us we work together! "><y>#</y><d>2021-01-15</d><h>11:31</h><w>orestis</w>Don’t mind us we work together! </z><z id="t1610722346" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I’m not familiar with pac4j but I suspect that the jee-pac4j would work. Based on the https://github.com/pac4j/jee-pac4j/wiki/Get-the-authenticated-user-profiles , you can get the authenticated user profile info of the servlet request which will be available in Pedestal’s Context Map. I’ve not gone through the pac4j docs in detail though so can’t say for certain."><y>#</y><d>2021-01-15</d><h>14:52</h><w>ddeaguiar</w><a>@orestis</a> I’m not familiar with pac4j but I suspect that the jee-pac4j would work. Based on the <a href="https://github.com/pac4j/jee-pac4j/wiki/Get-the-authenticated-user-profiles" target="_blank">https://github.com/pac4j/jee-pac4j/wiki/Get-the-authenticated-user-profiles</a>, you can get the authenticated user profile info of the servlet request which will be available in Pedestal’s Context Map. I’ve not gone through the pac4j docs in detail though so can’t say for certain.</z><z id="t1610723841" t="orestis Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] - I guess then my question is how do I get hold of the servlet so I can bolt other things in top of it?"><y>#</y><d>2021-01-15</d><h>15:17</h><w>orestis</w>Thanks <a>@ddeaguiar</a> - I guess then my question is how do I get hold of the servlet so I can bolt other things in top of it?</z><z id="t1610723928" t="orestis Although after looking deeper into pac4j I think it would make more sense to make a ring adapter or something similar so it can be made into something that integrates with the pedestals router "><y>#</y><d>2021-01-15</d><h>15:18</h><w>orestis</w>Although after looking deeper into pac4j I think it would make more sense to make a ring adapter or something similar so it can be made into something that integrates with the pedestals router </z><z id="t1610724156" t="ddeaguiar You can add servlet filters through a function specified in the :context-configurator container option. We have a https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61-L71 that demonstrates this."><y>#</y><d>2021-01-15</d><h>15:22</h><w>ddeaguiar</w>You can add servlet filters through a function specified in the  <code>:context-configurator</code>  container option. We have a <a href="https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61-L71" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L61-L71</a> that demonstrates this.</z><z id="t1610724189" t="ddeaguiar An interceptor-based approach would be more idiomatic but I’m not sure what work is involved there"><y>#</y><d>2021-01-15</d><h>15:23</h><w>ddeaguiar</w>An interceptor-based approach would be more idiomatic but I’m not sure what work is involved there</z><z id="t1611651643" t="amorokh hi all, I am developing a web API using pedestal and jetty and suddenly I get the following exception (with stacktrace) when trying to access my service, anyone has any idea what I’ve done wrong or what this means?"><y>#</y><d>2021-01-26</d><h>09:00</h><w>amorokh</w>hi all, I am developing a web API using pedestal and jetty and suddenly I get the following exception (with stacktrace) when trying to access my service, anyone has any idea what I’ve done wrong or what this means?</z><z id="t1611651648" t="amorokh WARN org.eclipse.jetty.server.HttpChannel - /foo java.lang.IncompatibleClassChangeError: Found interface org.eclipse.jetty.http.pathmap.PathSpec, but class was expected at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:455) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201) at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1247) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132) at org.eclipse.jetty.server.Server.handle(Server.java:505) at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370) at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267) at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773) at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905) at java.base/java.lang.Thread.run(Thread.java:832)"><y>#</y><d>2021-01-26</d><h>09:00</h><w>amorokh</w><pre>WARN  org.eclipse.jetty.server.HttpChannel - /foo
java.lang.IncompatibleClassChangeError: Found interface org.eclipse.jetty.http.pathmap.PathSpec, but class was expected
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:455)
        at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:201)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1247)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:144)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:132)
        at org.eclipse.jetty.server.Server.handle(Server.java:505)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:370)
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:267)
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
        at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905)
        at java.base/java.lang.Thread.run(Thread.java:832)</pre></z><z id="t1611652591" t="amorokh sorry, I get this exceptioin while trying to access any endpoint on my server, regardless if that endpoint has en existing route or not"><y>#</y><d>2021-01-26</d><h>09:16</h><w>amorokh</w>sorry, I get this exceptioin while trying to access any endpoint on my server, regardless if that endpoint has en existing route or not</z><z id="t1611660205" t="amorokh I have another project with a similar setup that works ok, from the logs I can see that it loads jetty-9.4.18.v20190429 while the project that does not work loads jetty-9.4.35.v20201120 for some reason, I have no explicit dep i my deps.edn"><y>#</y><d>2021-01-26</d><h>11:23</h><w>amorokh</w>I have another project with a similar setup that works ok, from the logs I can see that it loads <code>jetty-9.4.18.v20190429</code> while the project that does not work loads <code>jetty-9.4.35.v20201120</code>  for some reason, I have no explicit dep i my deps.edn</z><z id="t1611664858" t="amorokh ok, so I also have a dep to stylefruits/gniazdo {:mvn/version &quot;1.2.0&quot;} which in turn uses the later version of jetty (sorry to spam)"><y>#</y><d>2021-01-26</d><h>12:40</h><w>amorokh</w>ok, so I also have a dep to <code>stylefruits/gniazdo {:mvn/version &quot;1.2.0&quot;}</code> which in turn uses the later version of jetty (sorry to spam)</z><z id="t1612718841" t="aaroncoding Hey all, I&apos;m going through the guide here http://pedestal.io/guides/hello-world-query-parameters I actually just copied and pasted their entire code at the end, but I&apos;m still having issues where it doesn&apos;t reload changes to the code. What I do: clj user=&gt; (require &apos;hello) user=&gt; (hello/start-dev) ... some server stuff... New terminal curl -i &quot;Aaron&quot; ; Hello, Aaron back in hello.clj, change the response to (str &quot;Your name is: &quot; nm ...) user=&gt; (hello/restart) curl -i &quot;Aaron&quot; ; Hello, Aaron At this point I was expecting it to start saying &quot;Your name is: Aaron&quot;. And if I shut down the repl, then start up all over again, it does! But it should do that just from running the (restart) function, no?"><y>#</y><d>2021-02-07</d><h>17:27</h><w>aaroncoding</w>Hey all,
I&apos;m going through the guide here <a href="http://pedestal.io/guides/hello-world-query-parameters" target="_blank">http://pedestal.io/guides/hello-world-query-parameters</a>
I actually just copied and pasted their entire code at the end, but I&apos;m still having issues where it doesn&apos;t reload changes to the code.

What I do:
<pre>clj
user=&gt; (require &apos;hello)
user=&gt; (hello/start-dev)
... some server stuff...</pre>
New terminal
<pre>curl -i &quot;Aaron&quot;
; Hello, Aaron</pre>
back in hello.clj, change the response to (str &quot;Your name is: &quot; nm ...)
<pre>user=&gt; (hello/restart)</pre>
<pre>curl -i &quot;Aaron&quot;
; Hello, Aaron</pre>
At this point I was expecting it to start saying &quot;Your name is: Aaron&quot;.
And if I shut down the repl, then start up all over again, it does! But it should do that just from running the (restart) function, no?</z><z id="t1613156416" t="vemv I&apos;d recommend to get started via the official pedestal-service template. Specifically, it uses this trick (`#&apos;` syntax): https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service-template/src/leiningen/new/pedestal_service/server.clj#L21"><y>#</y><d>2021-02-12</d><h>19:00</h><r>vemv</r>I&apos;d recommend to get started via the official <code>pedestal-service</code> template.

Specifically, it uses this trick (`#&apos;` syntax): <a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service-template/src/leiningen/new/pedestal_service/server.clj#L21" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service-template/src/leiningen/new/pedestal_service/server.clj#L21</a></z><z id="t1612754921" t="souenzzo I would use (require &apos;hello :reload) [:attrs {:href &quot;/_/_/users/UE1747L7J&quot;}]"><y>#</y><d>2021-02-08</d><h>03:28</h><w>souenzzo</w>I would use <code>(require &apos;hello :reload)</code> <a>@coding.aaronp</a></z><z id="t1613518782" t="fabrao hello all, I´m including my own routes to lacinia routes. I`m using mount to start the process about web servering and one of this routes I´m using a state from mount. But it´s getting some https://en.wikipedia.org/wiki/Cyclic_redundancy_check because state includes web server that define route and route include state"><y>#</y><d>2021-02-16</d><h>23:39</h><w>fabrao</w>hello all, I´m including my own routes to lacinia routes. I`m using mount to start the process about web servering and one of this routes I´m using a state from mount. But it´s getting some <a href="https://en.wikipedia.org/wiki/Cyclic_redundancy_check" target="_blank">https://en.wikipedia.org/wiki/Cyclic_redundancy_check</a> because state includes web server that define route and route include state</z><z id="t1613518881" t="fabrao routes are defined with def and I can´t pass this state to this route"><y>#</y><d>2021-02-16</d><h>23:41</h><w>fabrao</w>routes are defined with <code>def</code> and I can´t pass this state to this route</z><z id="t1613613712" t="souenzzo Is it a bug? I expect that it results in &quot;/a%2Fb&quot; (let [url-for (-&gt; `#{[&quot;/:x&quot; :get get]} route/expand-routes route/url-for-routes)] (url-for :clojure.core/get :params {:x &quot;a/b&quot;})) =&gt; &quot;/a/b&quot;"><y>#</y><d>2021-02-18</d><h>02:01</h><w>souenzzo</w>Is it a bug? I expect that it results in <code>&quot;/a%2Fb&quot;</code>
<pre>(let [url-for (-&gt; `#{[&quot;/:x&quot; :get get]}
                  route/expand-routes
                  route/url-for-routes)]
  (url-for :clojure.core/get
           :params {:x &quot;a/b&quot;}))
=&gt; &quot;/a/b&quot;</pre></z><z id="t1613652814" t="fabrao hello all, is there possible to create .war file to use int Tomcat?"><y>#</y><d>2021-02-18</d><h>12:53</h><w>fabrao</w>hello all, is there possible to create .war file to use int Tomcat?</z><z id="t1613653553" t="Joe Lane [:attrs {:href &quot;/_/_/users/U0YJJPFRA&quot;}] https://github.com/pedestal/pedestal/tree/master/samples/war-example"><y>#</y><d>2021-02-18</d><h>13:05</h><w>Joe Lane</w><a>@fabrao</a> <a href="https://github.com/pedestal/pedestal/tree/master/samples/war-example" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/war-example</a></z><z id="t1614617658" t="souenzzo Any feedack on this? should I do a PR? https://github.com/pedestal/pedestal/issues/678"><y>#</y><d>2021-03-01</d><h>16:54</h><w>souenzzo</w>Any feedack on this? should I do a PR?
<a href="https://github.com/pedestal/pedestal/issues/678" target="_blank">https://github.com/pedestal/pedestal/issues/678</a></z><z id="t1614618037" t="souenzzo I&apos;m working on an adapter to create an :http-client , used in clj-http.client/request for pedestal response-for It would allow me to test my application using the clj-http interface, that can be used to real requests on the app."><y>#</y><d>2021-03-01</d><h>17:00</h><w>souenzzo</w>I&apos;m working on an adapter to create an <code>:http-client</code>, used in <code>clj-http.client/request</code> for pedestal <code>response-for</code>
It would allow me to test my application using the <code>clj-http</code> interface, that can be used to real requests on the app.</z><z id="t1614711724" t="lucian303 any idea how i would specify the order of routes when using a :linear-search router? i have three (or more routes) and want the wildcard route to execute last if no other route matches. i&apos;ve tried arranging them in the set differently but the results always seem to be random as far as the order of processing and dispatch: [&quot;/api/do&quot; :get (conj html-interceptors `api) :route-name :api] [&quot;/&quot; :get (conj html-interceptors `home-page) :route-name :home] [&quot;/*all&quot; :get (conj html-interceptors `home-page) :route-name :documents-tree]"><y>#</y><d>2021-03-02</d><h>19:02</h><w>lucian303</w>any idea how i would specify the order of routes when using a <code>:linear-search</code> router? i have three (or more routes) and want the wildcard route to execute last if no other route matches. i&apos;ve tried arranging them in the set differently but the results always seem to be random as far as the order of processing and dispatch:

<pre>[&quot;/api/do&quot; :get (conj html-interceptors `api) :route-name :api]
[&quot;/&quot; :get (conj html-interceptors `home-page) :route-name :home]
[&quot;/*all&quot; :get (conj html-interceptors `home-page) :route-name :documents-tree]</pre></z><z id="t1615241675" t="thumbnail A set has no order guarantee. Try using a vector :)"><y>#</y><d>2021-03-08</d><h>22:14</h><r>thumbnail</r>A set has no order guarantee. Try using a vector :)</z><z id="t1616007391" t="fabrao hello all, how do I configure the /public to an url like if my app will be in &quot; http://www.something.com/myapp &quot; ?"><y>#</y><d>2021-03-17</d><h>18:56</h><w>fabrao</w>hello all, how do I configure the /public to an url like if my app will be in &quot;<a href="http://www.something.com/myapp" target="_blank">http://www.something.com/myapp</a>&quot; ?</z><z id="t1616103779" t="ddeaguiar Do you mean for serving static files?"><y>#</y><d>2021-03-18</d><h>21:42</h><r>ddeaguiar</r>Do you mean for serving static files?</z><z id="t1616110406" t="fabrao [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] yes"><y>#</y><d>2021-03-18</d><h>23:33</h><r>fabrao</r><a>@U0FL657GR</a> yes</z><z id="t1616007402" t="fabrao in routes?"><y>#</y><d>2021-03-17</d><h>18:56</h><w>fabrao</w>in routes?</z><z id="t1616188062" t="lucian303 i have an error interceptor that works well in capturing exceptions thrown directly from another interceptor, in this case (add-corpus-document) below. but it doesn’t capture exceptions thrown from a function (add-document) that’s called indirectly through map below by that interceptor. in that case, it seems to continue w/ the interceptor chain until another directly called interceptor throws a different exception which would have the one below as its cause. this doesn’t make any sense. why would an exception get handled differently directly in an interceptor but not in the functions it calls? (defn add-document [id request file] (throw (ex-info &quot;nope, this doesn&apos;t directly trigger the error interceptor&quot; {:show-user true :type :validation})) (defn add-corpus-document [request] ;; the same (throw) call above would work just fine here directly in the interceptor (ring-response/response (map #(add-document 0 0 %) (:multipart-params request))))"><y>#</y><d>2021-03-19</d><h>21:07</h><w>lucian303</w>i have an error interceptor that works well in capturing exceptions thrown directly from another interceptor, in this case <code>(add-corpus-document)</code> below. but it doesn’t capture exceptions thrown from a function <code>(add-document)</code> that’s called indirectly through map below by that interceptor. in that case, it seems to continue w/ the interceptor chain until another directly called interceptor throws a different exception which would have the one below as its cause. this doesn’t make any sense. why would an exception get handled differently directly in an interceptor but not in the functions it calls?

<pre>(defn add-document
  [id request file]
  (throw (ex-info &quot;nope, this doesn&apos;t directly trigger the error interceptor&quot;
                  {:show-user true
                   :type      :validation}))

(defn add-corpus-document
  [request]
  ;; the same (throw) call above would work just fine here directly in the interceptor
  (ring-response/response (map #(add-document 0 0 %) (:multipart-params request))))</pre></z><z id="t1616194845" t="lucian303 nevermind, seems to be because of the lazy map call above"><y>#</y><d>2021-03-19</d><h>23:00</h><w>lucian303</w>nevermind, seems to be because of the lazy map call above</z><z id="t1616706593" t="souenzzo There is a example about how to implement 429 status code in pedestal/jetty? https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429"><y>#</y><d>2021-03-25</d><h>21:09</h><w>souenzzo</w>There is a example about how to implement 429 status code in pedestal/jetty?

 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/429</a></z><z id="t1616709427" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] you might find that Jetty’s DoS filter meets your needs. ( https://www.eclipse.org/jetty/documentation/jetty-9/index.php )"><y>#</y><d>2021-03-25</d><h>21:57</h><w>ddeaguiar</w><a>@souenzzo</a> you might find that Jetty’s DoS filter meets your needs. (<a href="https://www.eclipse.org/jetty/documentation/jetty-9/index.php" target="_blank">https://www.eclipse.org/jetty/documentation/jetty-9/index.php</a>)</z><z id="t1616740682" t="simongray [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] I’ve added the DosFilter too. It was pretty easy to do, example here: https://github.com/kuhumcst/glossematics/blob/master/src/dk/cst/hjelmslev/service.clj#L36-L46"><y>#</y><d>2021-03-26</d><h>06:38</h><w>simongray</w><a>@souenzzo</a> I’ve added the DosFilter too. It was pretty easy to do, example here: <a href="https://github.com/kuhumcst/glossematics/blob/master/src/dk/cst/hjelmslev/service.clj#L36-L46" target="_blank">https://github.com/kuhumcst/glossematics/blob/master/src/dk/cst/hjelmslev/service.clj#L36-L46</a></z><z id="t1616740945" t="simongray Incredible, they already moved their own documentation. Anyway, the relevant configuration params are also availalable here: https://wiki.eclipse.org/Jetty/Reference/DoSFilter"><y>#</y><d>2021-03-26</d><h>06:42</h><w>simongray</w>Incredible, they already moved their own documentation. Anyway, the relevant configuration params are also availalable here: <a href="https://wiki.eclipse.org/Jetty/Reference/DoSFilter" target="_blank">https://wiki.eclipse.org/Jetty/Reference/DoSFilter</a></z><z id="t1616762643" t="souenzzo I&apos;m expecting something where I can run a function that returns if it&apos;s a DoS or not"><y>#</y><d>2021-03-26</d><h>12:44</h><w>souenzzo</w>I&apos;m expecting something where I can run a function that returns if it&apos;s a DoS or not</z><z id="t1616763419" t="simongray I think the nature of DoS attacks or other kinds of surges preclude running custom code, but I can see why that would be nice in a Clojure context."><y>#</y><d>2021-03-26</d><h>12:56</h><w>simongray</w>I think the nature of DoS attacks or other kinds of surges preclude running custom code, but I can see why that would be nice in a Clojure context.</z><z id="t1618785736" t="Franco Gasperino hello all. using the interceptor body-params, i&apos;m able to accept a post verb with a json body as edn as documented. Im i wrong to expect an end assoc map structure, with the Content-Type header set, should also be handled in the response by the same inteceptor (:leave) ? (def test {:name :test :enter (fn [context] (let [request (:request context) {:keys [headers json-params]} request] (assoc context :response {:status 200 :body json-params :headers {&quot;Content-Type&quot; &quot;application/json&quot;}})))}) (def common [(body-params)]) (def test-interceptor (conj common test)) (def routes #{[&quot;/test&quot; :post test-interceptor :route-name :test]})"><y>#</y><d>2021-04-18</d><h>22:42</h><w>Franco Gasperino</w>hello all. using the interceptor body-params, i&apos;m able to accept a post verb with a json body as edn as documented. Im i wrong to expect an end assoc map structure, with the Content-Type header set, should also be handled in the response by the same inteceptor (:leave) ?

<pre>(def test
  {:name :test
   :enter
   (fn [context]
     (let [request (:request context)
           {:keys [headers json-params]} request]
       (assoc context :response
          {:status 200
           :body json-params
           :headers {&quot;Content-Type&quot; &quot;application/json&quot;}})))})

(def common [(body-params)])
(def test-interceptor (conj common test))

(def routes
  #{[&quot;/test&quot; :post test-interceptor :route-name :test]})</pre></z><z id="t1618785792" t="Franco Gasperino The HTTP response in the client has the Content-Type set to &quot;application/json&quot;, but the body of the response is still edn: {:key &quot;value&quot;}"><y>#</y><d>2021-04-18</d><h>22:43</h><w>Franco Gasperino</w>The HTTP response in the client has the Content-Type set to &quot;application/json&quot;, but the body of the response is still edn:
  {:key &quot;value&quot;}</z><z id="t1618785840" t="Franco Gasperino My assumption is that body-params on :leave will stringify-keys or such"><y>#</y><d>2021-04-18</d><h>22:44</h><w>Franco Gasperino</w>My assumption is that body-params on :leave will stringify-keys or such</z><z id="t1618837016" t="souenzzo [:attrs {:href &quot;/_/_/users/U01RGC7177E&quot;}] It&apos;s the io.pedestal.http.impl.servlet-interceptor/WriteableBody protocol Once your body is a clojure.lang.IPersistentCollection (a map? ), the protocol will be implemented as (default-content-type [_] &quot;application/edn&quot;) (write-body-to-stream [o output-stream] (let [writer (OutputStreamWriter. output-stream)] (binding [*out* writer] (pr o)) (.flush writer))) It means, it there is no Content-Type on the response headers, it will use &quot;application/edn&quot; There is no default behavior in pedestal that &quot;check the response header and use a custom write method&quot; for the body"><y>#</y><d>2021-04-19</d><h>12:56</h><w>souenzzo</w><a>@franco.gasperino</a>
It&apos;s the <code>io.pedestal.http.impl.servlet-interceptor/WriteableBody</code> protocol
Once your body is a  <code>clojure.lang.IPersistentCollection</code> (a <code>map?</code> ), the protocol will be implemented as
<pre>(default-content-type [_] &quot;application/edn&quot;)
(write-body-to-stream [o output-stream]
    (let [writer (OutputStreamWriter. output-stream)]
      (binding [*out* writer]
        (pr o))
      (.flush writer)))</pre>
It means, it there is no <code>Content-Type</code> on the response headers, it will use <code>&quot;application/edn&quot;</code>

There is no default behavior in pedestal that &quot;check the response header and use a custom write method&quot; for the body</z><z id="t1618849958" t="Franco Gasperino Thanks for the reply. I experienced the native map body as application/edn content-type in the reply as well"><y>#</y><d>2021-04-19</d><h>16:32</h><r>Franco Gasperino</r>Thanks for the reply. I experienced the native map body as application/edn content-type in the reply as well</z><z id="t1621498517" t="simongray Someone here once showed me some trick to have the routes (and their interceptor chains) update more dynamically in the REPL when the underlying code changes, but I forgot what it was. I think it was some combination of characters like ’# and perhaps a few more lines of supporting code. Anybody know what I may be thinking of? Currently, I have to restart the service every time I want to see updated interceptor chains."><y>#</y><d>2021-05-20</d><h>08:15</h><w>simongray</w>Someone here once showed me some trick to have the routes (and their interceptor chains) update more dynamically in the REPL when the underlying code changes, but I forgot what it was. I think it was some combination of characters like ’# and perhaps a few more lines of supporting code. Anybody know what I may be thinking of? Currently, I have to restart the service every time I want to see updated interceptor chains.</z><z id="t1621499049" t="danieroux (defn- route-fn &quot;Use the deref of the namespace to get hot-reloaded namespaces.&quot; [] (route/expand-routes (deref #&apos;your.ns/routes))) (-&gt; service-handler/service ; hot-reloaded-fn ftw! (assoc ::http/routes route-fn))"><y>#</y><d>2021-05-20</d><h>08:24</h><w>danieroux</w><pre>(defn- route-fn
  &quot;Use the deref of the namespace to get hot-reloaded namespaces.&quot;
  []
  (route/expand-routes
    (deref #&apos;your.ns/routes)))

(-&gt; service-handler/service
    ; hot-reloaded-fn ftw!
    (assoc ::http/routes route-fn))</pre></z><z id="t1621499082" t="simongray I think that was it, [:attrs {:href &quot;/_/_/users/U9E8C7QRJ&quot;}] ! Thanks."><y>#</y><d>2021-05-20</d><h>08:24</h><w>simongray</w>I think that was it, <a>@danie</a>! Thanks.</z><z id="t1621499161" t="simongray One question though: My routes are generated inside a function taking a config map: (defn routes [conf] (route/expand-routes (set/union (example-routes conf) (sp.routes/all conf)))) I’m not sure how to represent that. your.ns/routes in your example is just a var representing a data structure, right?"><y>#</y><d>2021-05-20</d><h>08:26</h><w>simongray</w>One question though: My routes are generated inside a function taking a config map:
<pre>(defn routes
  [conf]
  (route/expand-routes
    (set/union (example-routes conf)
               (sp.routes/all conf))))</pre>
I’m not sure how to represent that. <code>your.ns/routes</code> in your example is just a var representing a data structure, right?</z><z id="t1621499466" t="simongray I think it’s the deref that’s tripping me up"><y>#</y><d>2021-05-20</d><h>08:31</h><w>simongray</w>I think it’s the deref that’s tripping me up</z><z id="t1621499491" t="danieroux What is your ::http/routes ? Because whatever that is, you can deref?"><y>#</y><d>2021-05-20</d><h>08:31</h><w>danieroux</w>What is your <code>::http/routes</code>? Because whatever that is, you can deref?</z><z id="t1621499710" t="simongray (defn service-map [conf] {::http/routes (routes conf) ::http/type :jetty ::http/port 8080})"><y>#</y><d>2021-05-20</d><h>08:35</h><w>simongray</w><pre>(defn service-map
  [conf]
  {::http/routes (routes conf)
   ::http/type   :jetty
   ::http/port   8080})</pre></z><z id="t1621499808" t="simongray And then in my start I deref an atom containing the overall conf, pass that to the function creating the service map and pass the created service map to http/create-server"><y>#</y><d>2021-05-20</d><h>08:36</h><w>simongray</w>And then in my <code>start</code>  I deref an atom containing the overall conf,  pass that to the function creating the service map and pass the created service map to <code>http/create-server</code></z><z id="t1621499880" t="simongray what does service-handler/service do?"><y>#</y><d>2021-05-20</d><h>08:38</h><w>simongray</w>what does <code>service-handler/service</code>  do?</z><z id="t1621499915" t="simongray that’s just the service map?"><y>#</y><d>2021-05-20</d><h>08:38</h><w>simongray</w>that’s just the service map?</z><z id="t1621500204" t="danieroux {::http/routes ((deref #&apos;routes) conf)}"><y>#</y><d>2021-05-20</d><h>08:43</h><w>danieroux</w><pre>{::http/routes ((deref #&apos;routes) conf)}</pre></z><z id="t1621500210" t="danieroux That may work?"><y>#</y><d>2021-05-20</d><h>08:43</h><w>danieroux</w>That may work?</z><z id="t1621500307" t="danieroux hmm, probably not."><y>#</y><d>2021-05-20</d><h>08:45</h><w>danieroux</w>hmm, probably not.</z><z id="t1621500414" t="simongray Ended up doing this (defn routes [conf] (route/expand-routes (set/union ((deref #&apos;example-routes) conf) ((deref #&apos;sp.routes/all) conf)))) (defn service-map [conf] {::http/routes #(routes conf) ::http/type :jetty ::http/port 8080}) and it seems to work"><y>#</y><d>2021-05-20</d><h>08:46</h><w>simongray</w>Ended up doing this
<pre>(defn routes
  [conf]
  (route/expand-routes
    (set/union ((deref #&apos;example-routes) conf)
               ((deref #&apos;sp.routes/all) conf))))

(defn service-map
  [conf]
  {::http/routes #(routes conf)
   ::http/type   :jetty
   ::http/port   8080})</pre>
and it seems to work</z><z id="t1621500444" t="simongray (reloading the config doesn’t need to be dynamic, just the code changes)"><y>#</y><d>2021-05-20</d><h>08:47</h><w>simongray</w>(reloading the config doesn’t need to be dynamic, just the code changes)</z><z id="t1621500445" t="simongray thanks for you help!"><y>#</y><d>2021-05-20</d><h>08:47</h><w>simongray</w>thanks for you help!</z><z id="t1621500530" t="simongray but this also seems to work, so I’m unsure what deref’ing gets me: (defn routes [conf] (route/expand-routes (set/union (example-routes conf) (sp.routes/all conf)))) (defn service-map [conf] {::http/routes #(routes conf) ::http/type :jetty ::http/port 8080})"><y>#</y><d>2021-05-20</d><h>08:48</h><w>simongray</w>but this also seems to work, so I’m unsure what deref’ing gets me:
<pre>(defn routes
  [conf]
  (route/expand-routes
    (set/union (example-routes conf)
               (sp.routes/all conf))))

(defn service-map
  [conf]
  {::http/routes #(routes conf)
   ::http/type   :jetty
   ::http/port   8080})</pre></z><z id="t1621500721" t="danieroux {::http/routes #((deref #&apos;routes) conf)}"><y>#</y><d>2021-05-20</d><h>08:52</h><w>danieroux</w><pre>{::http/routes #((deref #&apos;routes) conf)}</pre></z><z id="t1621500787" t="danieroux That’s what I would have suggested. The deref so that it gets the latest installed routes in the ns, on every invocation. And if what you have works, it works!"><y>#</y><d>2021-05-20</d><h>08:53</h><w>danieroux</w>That’s what I would have suggested. The deref so that it gets the latest installed <code>routes</code> in the ns, on every invocation. And if what you have works, it works!</z><z id="t1621500943" t="simongray Ok, gonna try that out"><y>#</y><d>2021-05-20</d><h>08:55</h><w>simongray</w>Ok, gonna try that out</z><z id="t1621500947" t="simongray thanks a lot for taking the time"><y>#</y><d>2021-05-20</d><h>08:55</h><w>simongray</w>thanks a lot for taking the time</z><z id="t1621502982" t="simongray Can confirm that #((deref #&apos;routes) conf) works great! Vars continue to confuddle me 😛"><y>#</y><d>2021-05-20</d><h>09:29</h><w>simongray</w>Can confirm that <code>#((deref #&apos;routes) conf)</code> works great! Vars continue to confuddle me <b>😛</b></z><z id="t1621585165" t="simongray Anybody have some for-dummies tutorial on creating custom Exception types in Clojure? Pedestal seems to rely on custom exceptions in io.pedestal.interceptor.error/error-dispatch , but Clojure favours throwing ex-info everywhere which doesn’t really mesh well with Pedestal."><y>#</y><d>2021-05-21</d><h>08:19</h><w>simongray</w>Anybody have some for-dummies tutorial on creating custom Exception types in Clojure? Pedestal seems to rely on custom exceptions in <code>io.pedestal.interceptor.error/error-dispatch</code> , but Clojure favours throwing <code>ex-info</code> everywhere which doesn’t really mesh well with Pedestal.</z><z id="t1621585652" t="danieroux Not a direct answer. I’ve been leaning hard on https://github.com/cognitect-labs/anomalies - and it is also what Datomic generates, so that meshes well with my life"><y>#</y><d>2021-05-21</d><h>08:27</h><r>danieroux</r>Not a direct answer. I’ve been leaning hard on <a href="https://github.com/cognitect-labs/anomalies" target="_blank">https://github.com/cognitect-labs/anomalies</a> - and it is also what Datomic generates, so that meshes well with my life</z><z id="t1621586059" t="simongray I’ve seen those before, but I was unsure if the idea is to use this as ex-data keys."><y>#</y><d>2021-05-21</d><h>08:34</h><r>simongray</r>I’ve seen those before, but I was unsure if the idea is to use this as ex-data keys.</z><z id="t1621586568" t="danieroux Wherever is sensible, I try/catch and return a map with an anomaly. Then somewhere else, I pull out of that map what I want, or deal with that anomaly. I don’t let exceptions bubble up. I let data flow through."><y>#</y><d>2021-05-21</d><h>08:42</h><r>danieroux</r>Wherever is sensible, I try/catch and return a map with an anomaly. Then somewhere else, I pull out of that map what I want, or deal with that anomaly.

I don’t let exceptions bubble up.  I let data flow through.</z><z id="t1621585310" t="simongray Or maybe I’ll just throw ex-info everywhere and not dispatch on exception type…"><y>#</y><d>2021-05-21</d><h>08:21</h><w>simongray</w>Or maybe I’ll just throw ex-info everywhere and not dispatch on exception type…</z><z id="t1621585382" t="simongray Guess I can just check the content of every clojure.lang.ExceptionInfo"><y>#</y><d>2021-05-21</d><h>08:23</h><w>simongray</w>Guess I can just check the content of every clojure.lang.ExceptionInfo</z><z id="t1621606760" t="ordnungswidrig [:attrs {:href &quot;/_/_/users/U4P4NREBY&quot;}] I also recommend using anomalies or some other form of &quot;classification&quot; beyond java types. Catch ExceptionInfo and match on whatever content in ex-data to determine what to do with it. And then there is https://github.com/scgilardi/slingshot"><y>#</y><d>2021-05-21</d><h>14:19</h><w>ordnungswidrig</w><a>@simongray</a> I also recommend using anomalies or some other form of &quot;classification&quot; beyond java types. Catch ExceptionInfo and match on whatever content in ex-data to determine what to do with it. And then there is <a href="https://github.com/scgilardi/slingshot" target="_blank">https://github.com/scgilardi/slingshot</a></z><z id="t1623117033" t="lucian303 i have a routes namespace where i define some routes (def routes #{[&quot;/Team&quot; :get (conj api-interceptors entities/team-stubs)]})` and an entities namespace where i implement that route. how can i use the url-for-routes in the entities namespace to include links to other endpoints without causing a circular reference? (def url-for (route/url-for-routes routes/app-routes)) it seems like this would be the most common usage but it results in circular references and thus cannot be done ... what can i do short of putting the entire app in one namespace? is there a solution to this common issue?"><y>#</y><d>2021-06-08</d><h>01:50</h><w>lucian303</w>i have a routes namespace where i define some routes <code>(def routes #{[&quot;/Team&quot; :get (conj api-interceptors </code>entities/team-stubs)]})` and an entities namespace where i implement that route. how can i use the <code>url-for-routes</code> in the entities namespace to include links to other endpoints without causing a circular reference? <code>(def url-for (route/url-for-routes routes/app-routes))</code> it seems like this would be the most common usage but it  results in circular references and thus cannot be done ... what can i do short of putting the entire app in one namespace? is there a solution to this common issue?</z><z id="t1623279555" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U053KNT7C&quot;}] have you tried routes/url-for ? If so, why doesn’t it meet your needs? It only requires a route name ( https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/http2/src/hp/service.clj#L13 )."><y>#</y><d>2021-06-09</d><h>22:59</h><r>ddeaguiar</r><a>@lucian303</a> have you tried <code>routes/url-for</code>? If so, why doesn’t it meet your needs? It only requires a route name (<a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/http2/src/hp/service.clj#L13" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/http2/src/hp/service.clj#L13</a>).</z><z id="t1623348824" t="lucian303 thank you [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] that&apos;s what i was looking for. i hadn&apos;t tried it because i didn&apos;t understand that part of the documentation and i thought the reference to url-for was the url-for created using url-for-routes in the example code at http://pedestal.io/guides/defining-routes"><y>#</y><d>2021-06-10</d><h>18:13</h><r>lucian303</r>thank you <a>@ddeaguiar</a> that&apos;s what i was looking for. i hadn&apos;t tried it because i didn&apos;t understand that part of the documentation and i thought the reference to <code>url-for</code> was the <code>url-for</code> created using <code>url-for-routes</code> in the example code at <a href="http://pedestal.io/guides/defining-routes" target="_blank">http://pedestal.io/guides/defining-routes</a></z><z id="t1623360578" t="ddeaguiar Ok. I’ll look into rewording that example to avoid confusion."><y>#</y><d>2021-06-10</d><h>21:29</h><r>ddeaguiar</r>Ok. I’ll look into rewording that example to avoid confusion.</z><z id="t1623148281" t="souenzzo I have this issue too [:attrs {:href &quot;/_/_/users/U053KNT7C&quot;}] You can use route/url-for from inside requests But it&apos;s not a final solution"><y>#</y><d>2021-06-08</d><h>10:31</h><w>souenzzo</w>I have this issue too <a>@lucian303</a>
You can use route/url-for from inside requests
But it&apos;s not a final solution</z><z id="t1623160996" t="lucian303 u mean that function is available in the request map? [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2021-06-08</d><h>14:03</h><w>lucian303</w>u mean that function is available in the request map? <a>@souenzzo</a></z><z id="t1623161474" t="souenzzo Not exactly inside the request map But there is the route/*url-for* available, if you are inside a interceptor/handler called after the standard route interceptor https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L374"><y>#</y><d>2021-06-08</d><h>14:11</h><w>souenzzo</w>Not exactly inside the request map
But there is the <code>route/*url-for*</code> available, if you are inside a interceptor/handler called after the standard route interceptor
<a href="https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L374" target="_blank">https://github.com/pedestal/pedestal/blob/master/route/src/io/pedestal/http/route.clj#L374</a></z><z id="t1623279607" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , what use case requires this? Why isn’t routes/url-for sufficient?"><y>#</y><d>2021-06-09</d><h>23:00</h><r>ddeaguiar</r><a>@souenzzo</a>, what use case requires this? Why isn’t <code>routes/url-for</code> sufficient?</z><z id="t1623280303" t="souenzzo - we had a handler that use route/url-for to generate and send a email to the user - we changed our approach. moved this handler into a kafka batch processing, providing the same parameters that the http-handler used to have (query-params etc) - the handler stopped to work because it uses route/url-for and it&apos;s not available - once we pretend to move many endpoints into kafka, we choose to provide the route/*url-for* inside the kafka processing context."><y>#</y><d>2021-06-09</d><h>23:11</h><r>souenzzo</r>- we had a handler that use <code>route/url-for</code> to generate and send a email to the user
- we changed our approach. moved this handler into a kafka batch processing, providing the same parameters that the http-handler used to have (query-params etc)
- the handler stopped to work because it uses route/url-for and it&apos;s not available
- once we pretend to move many endpoints into kafka, we choose to provide the <code>route/*url-for*</code> inside the kafka processing context.</z><z id="t1623360812" t="souenzzo [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] any feedback about my usage?"><y>#</y><d>2021-06-10</d><h>21:33</h><r>souenzzo</r><a>@ddeaguiar</a> any feedback about my usage?</z><z id="t1623361073" t="ddeaguiar I think that’s fine. route/url-for was intended to be used within request execution."><y>#</y><d>2021-06-10</d><h>21:37</h><r>ddeaguiar</r>I think that’s fine. <code>route/url-for</code> was intended to be used within request execution.</z><z id="t1623161588" t="souenzzo I don&apos;t know/understand why it&apos;s not a value in the context/request, or at least a public var. I use (with-bindings {#&apos;route/*url-for* my-custom-url-for} in some places in my code"><y>#</y><d>2021-06-08</d><h>14:13</h><w>souenzzo</w>I don&apos;t know/understand why it&apos;s not a value in the context/request, or at least a public var.
I use <code>(with-bindings {#&apos;route/*url-for* my-custom-url-for}</code> in some places in my code</z><z id="t1623161672" t="souenzzo pedestal.route is an awesome lib, but without docs is really hard to use also, there is some design deicisions that i can&apos;t understand"><y>#</y><d>2021-06-08</d><h>14:14</h><w>souenzzo</w>pedestal.route is an awesome lib, but without docs is really hard to use
also, there is some design deicisions that i can&apos;t understand</z><z id="t1623171078" t="lucian303 i c. i&apos;ll try that. i was already trying all kinds of require hacks and such so any solution at this point, no matter how hacky, is most welcome"><y>#</y><d>2021-06-08</d><h>16:51</h><w>lucian303</w>i c. i&apos;ll try that. i was already trying all kinds of require hacks and such so any solution at this point, no matter how hacky, is most welcome</z><z id="t1623182443" t="souenzzo [:attrs {:href &quot;/_/_/users/U053KNT7C&quot;}] you can use promise/deliver to avoid circular deps"><y>#</y><d>2021-06-08</d><h>20:00</h><w>souenzzo</w><a>@lucian303</a> you can use promise/deliver to avoid circular deps</z><z id="t1623348824" t="lucian303 thank you [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] that&apos;s what i was looking for. i hadn&apos;t tried it because i didn&apos;t understand that part of the documentation and i thought the reference to url-for was the url-for created using url-for-routes in the example code at http://pedestal.io/guides/defining-routes"><y>#</y><d>2021-06-10</d><h>18:13</h><w>lucian303</w>thank you <a>@ddeaguiar</a> that&apos;s what i was looking for. i hadn&apos;t tried it because i didn&apos;t understand that part of the documentation and i thought the reference to <code>url-for</code> was the <code>url-for</code> created using <code>url-for-routes</code> in the example code at <a href="http://pedestal.io/guides/defining-routes" target="_blank">http://pedestal.io/guides/defining-routes</a></z><z id="t1623243230" t="Fabim [:attrs {:href &quot;/_/_/users/U053KNT7C&quot;}] I’m just starting with Pedestal. Maybe reitit https://cljdoc.org/d/metosin/reitit/0.5.13/doc/http/pedestal could be an alternative solution?"><y>#</y><d>2021-06-09</d><h>12:53</h><w>Fabim</w><a>@lucian303</a> I’m just starting with Pedestal. Maybe reitit <a href="https://cljdoc.org/d/metosin/reitit/0.5.13/doc/http/pedestal" target="_blank">https://cljdoc.org/d/metosin/reitit/0.5.13/doc/http/pedestal</a> could be an alternative solution?</z><z id="t1623275035" t="lucian303 [:attrs {:href &quot;/_/_/users/U010L3S1XHS&quot;}] yes, maybe. it looks like reitit does solve this problem by providing the router with the request which should be a no brainer for any app that lives in more than one namespace. i actually wanted to use reitit to begin with but good luck trying to figure out how to hook it into pedestal. i gave up after a couple of days"><y>#</y><d>2021-06-09</d><h>21:43</h><w>lucian303</w><a>@merklefabian</a> yes, maybe. it looks like reitit does solve this problem by providing the router with the request which should be a no brainer for any app that lives in more than one namespace. i actually wanted to use reitit to begin with but good luck trying to figure out how to hook it into pedestal. i gave up after a couple of days</z><z id="t1623275114" t="lucian303 [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] that is interesting. i&apos;m not sure how that would work but i&apos;ll look into it. i was not able to get with-bindings to work. it just results in an unbound fn. i&apos;m also not sure it would refer to the correct router in pedestal as there are multiple ones, one for each server"><y>#</y><d>2021-06-09</d><h>21:45</h><w>lucian303</w><a>@souenzzo</a> that is interesting. i&apos;m not sure how that would work but i&apos;ll look into it. i was not able to get with-bindings to work. it just results in an unbound fn. i&apos;m also not sure it would refer to the correct router in pedestal as there are multiple ones, one for each server</z><z id="t1623275220" t="souenzzo [:attrs {:href &quot;/_/_/users/U053KNT7C&quot;}] can you push a small example into github?"><y>#</y><d>2021-06-09</d><h>21:47</h><w>souenzzo</w><a>@lucian303</a> can you push a small example into github?</z><z id="t1623275309" t="lucian303 yes, but it may not be till tomorrow"><y>#</y><d>2021-06-09</d><h>21:48</h><w>lucian303</w>yes, but it may not be till tomorrow</z><z id="t1624992729" t="dangercoder Does anyone know if there are any plans on swapping out Dropwizard metrics for micrometer?"><y>#</y><d>2021-06-29</d><h>18:52</h><w>dangercoder</w>Does anyone know if there are any plans on swapping out Dropwizard metrics for micrometer?</z><z id="t1625319277" t="Fabim I am using the official pedestal web-socket example code. How do I retrieve the send-ch when the client closes the connection? Unfortunately the :on-close of ws-path only has a num-code and not the ws-session and the send-ch like the :on-connect https://github.com/pedestal/pedestal/blob/a72c7a274af0e60ba42a18d859f7c6fe9314130e/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61"><y>#</y><d>2021-07-03</d><h>13:34</h><w>Fabim</w>I am using the official pedestal web-socket example code.

How do I retrieve the <code>send-ch</code> when the client closes the connection?

Unfortunately the <code>:on-close</code> of <code>ws-path</code> only has a num-code and not the <code>ws-session</code> and the <code>send-ch</code> like the <code>:on-connect</code> <a href="https://github.com/pedestal/pedestal/blob/a72c7a274af0e60ba42a18d859f7c6fe9314130e/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61" target="_blank">https://github.com/pedestal/pedestal/blob/a72c7a274af0e60ba42a18d859f7c6fe9314130e/samples/jetty-web-sockets/src/jetty_web_sockets/service.clj#L61</a></z><z id="t1625325895" t="souenzzo Hey Fabim After study a bit the interface, I see that even on jetty we don&apos;t have the instance. I believe that this is because when the close event occours, the Session already do not exists anymore. For advanced usages, you can take a look at listener-fn and make-ws-listener https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L125"><y>#</y><d>2021-07-03</d><h>15:24</h><r>souenzzo</r>Hey Fabim

After study a bit the interface, I see that even on jetty we don&apos;t have the instance.
I believe that this is because when the close event occours, the Session already do not exists anymore.

For advanced usages, you can take a look at <code>listener-fn</code> and <code>make-ws-listener</code>
<a href="https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L125" target="_blank">https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty/websockets.clj#L125</a></z><z id="t1625329276" t="Fabim [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Thanks for your answer. Since the session is not returned, it’s hard to find the corresponding send-ch and to close it. I’m curious if there is a good way of cleaning up the connections at :on-close (ideally using interceptors). Other web-socket solutions like chord.http-kit send a message on close, but I’m not sure how to integrate them in the pedestal ws-routing."><y>#</y><d>2021-07-03</d><h>16:21</h><r>Fabim</r><a>@U2J4FRT2T</a> Thanks for your answer.
Since the session is not returned, it’s hard to find the corresponding <code>send-ch</code> and to close it.

I’m curious if there is a good way of cleaning up the connections at <code>:on-close</code>  (ideally using interceptors).

Other web-socket solutions like <code>chord.http-kit</code> send a message on close, but I’m not sure how to integrate them in the pedestal ws-routing.</z><z id="t1625491633" t="souenzzo A practical response: You don&apos;t need to implement close methods You will always need an ping method, to find disconnected clients (due no-internet or something like) In this ping routine, you will close/cleanup the closed channels"><y>#</y><d>2021-07-05</d><h>13:27</h><r>souenzzo</r>A practical response:
You don&apos;t need to implement close methods
You will always need an ping method, to find disconnected clients (due no-internet or something like)
In this ping routine, you will close/cleanup the closed channels</z><z id="t1625491743" t="Fabim Ah interesting, thanks. Makes sense, I was assuming I can rely on a on-close message."><y>#</y><d>2021-07-05</d><h>13:29</h><r>Fabim</r>Ah interesting, thanks. Makes sense, I was assuming I can rely on a on-close message.</z><z id="t1625492634" t="souenzzo Another close trigger is when you are writing a response but it throws a &quot;closed stream&quot; error. I worked with websockes about 4 years ago, I don&apos;t remember everything well. But as far I remember, most of our sockets close came from write errors"><y>#</y><d>2021-07-05</d><h>13:43</h><r>souenzzo</r>Another close trigger is when you are writing a response but it throws a &quot;closed stream&quot; error.

I worked with websockes about 4 years ago, I don&apos;t remember everything well.
But as far I remember, most of our sockets close came from write errors</z><z id="t1625490909" t="hanDerPeder also using the official pedestal web-socket example. is it possible to have a server with only a websocket endpoint at the root path? Ie, no routes?"><y>#</y><d>2021-07-05</d><h>13:15</h><w>hanDerPeder</w>also using the official pedestal web-socket example. is it possible to have a server with only a websocket endpoint at the root path? Ie, no routes?</z><z id="t1626078373" t="v3ga Anyone have any idea why I&apos;m not able to stop my server like this using integrant? How would I properly get a hold of my server instance? https://gist.github.com/v3gal0g/68268567dff31fa336bae8fc5ff877d4"><y>#</y><d>2021-07-12</d><h>08:26</h><w>v3ga</w>Anyone have any idea why I&apos;m not able to stop my server like this using integrant?  How would I properly get a hold of my server instance? <a href="https://gist.github.com/v3gal0g/68268567dff31fa336bae8fc5ff877d4" target="_blank">https://gist.github.com/v3gal0g/68268567dff31fa336bae8fc5ff877d4</a></z><z id="t1626090438" t="souenzzo [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] move http/create-server to configuration"><y>#</y><d>2021-07-12</d><h>11:47</h><w>souenzzo</w><a>@decim</a> move <code>http/create-server</code> to <code>configuration</code></z><z id="t1626095431" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] yeah thats a change I may make as well (-&gt; opts :server http/stop) gave me what I was after but i&apos;ll be shifting some things around today."><y>#</y><d>2021-07-12</d><h>13:10</h><w>v3ga</w><a>@souenzzo</a> yeah thats a change I may make as well (-&gt; opts :server http/stop) gave me what I was after but i&apos;ll be shifting some things around today.</z><z id="t1626270007" t="andrea.crotti is there a way to get the handler that&apos;s going to be called given the routes and a URL? Just the reverse operation of url-for really"><y>#</y><d>2021-07-14</d><h>13:40</h><w>andrea.crotti</w>is there a way to get the handler that&apos;s going to be called given the routes and a URL? Just the reverse operation of <code>url-for</code> really</z><z id="t1626450867" t="Ben Hammond I am looking for the minimal way to use pedestal table routes on their own (in a datomic http ion as it happens) at the moment I have # included io.pedestal/pedestal.route in deps # included io.pedestal/pedestal.service because I want to be able to use io.pedestal.test/response-for # got a function to create a simple context and call the table-router on it and now I get a queue of interceptors that the routers has found me: I guess I then have to call io.pedestal.interceptor.chain/execute on the interceptors that the router found for me... which feels like I have crossed a line in reinventing the wheel... is there a simple way to reuse the table-router, or should I keep going down this path?"><y>#</y><d>2021-07-16</d><h>15:54</h><w>Ben Hammond</w>I am looking for the minimal way to use pedestal table routes on their own (in a datomic http ion as it happens)
at the moment I have
# included <code>io.pedestal/pedestal.route</code> in deps
# included <code>io.pedestal/pedestal.service</code> because I want to be able to use <code>io.pedestal.test/response-for</code>
# got a function to create a simple context and call the table-router on it

and now I get a queue of interceptors that the routers has found me:
I guess I then have to call <code>io.pedestal.interceptor.chain/execute</code>
on the interceptors that the router found for me...

which feels like I have crossed a line in reinventing the wheel...
is there a simple way to reuse the table-router,
or should I keep going down this path?</z><z id="t1626450977" t="Ben Hammond actually maybe that call to execute was the last step I needed"><y>#</y><d>2021-07-16</d><h>15:56</h><r>Ben Hammond</r>actually maybe that call to execute was the last step I needed</z><z id="t1626450985" t="Joe Lane • https://github.com/pedestal/pedestal.ions • https://github.com/pedestal/pedestal-ions-sample"><y>#</y><d>2021-07-16</d><h>15:56</h><w>Joe Lane</w>• <a href="https://github.com/pedestal/pedestal.ions" target="_blank">https://github.com/pedestal/pedestal.ions</a>
• <a href="https://github.com/pedestal/pedestal-ions-sample" target="_blank">https://github.com/pedestal/pedestal-ions-sample</a></z><z id="t1626451159" t="Ben Hammond d&apos;oh of course Thankyou very much"><y>#</y><d>2021-07-16</d><h>15:59</h><r>Ben Hammond</r>d&apos;oh
of course

Thankyou very much</z><z id="t1626451407" t="Ben Hammond is it called &apos;Pedestal&apos; in reference to the Diana Ross song?"><y>#</y><d>2021-07-16</d><h>16:03</h><w>Ben Hammond</w>is it called &apos;Pedestal&apos; in reference to the Diana Ross song?</z><z id="t1627488309" t="Ben Hammond &gt; I&apos;m in the middle of a chain reaction"><y>#</y><d>2021-07-28</d><h>16:05</h><r>Ben Hammond</r>&gt; I&apos;m in the middle of a chain reaction</z><z id="t1626981774" t="ChillPillzKillzBillz maybe this is a rookie mistake... but when I try to access the page my pedestal is hosting... I only get the text of the html I am sending as response... instead of the actual page... why?"><y>#</y><d>2021-07-22</d><h>19:22</h><w>ChillPillzKillzBillz</w>maybe this is a rookie mistake... but when I try to access the page my pedestal is hosting... I only get the text of the html I am sending as response... instead of the actual page... why?</z><z id="t1626983141" t="souenzzo [:attrs {:href &quot;/_/_/users/U022LK3L4JJ&quot;}] you need to add :headers {&quot;Content-Type&quot; &quot;text/html&quot;} to your response By default, if pedestal find a string on the :body , it will write it as &quot;text/plain&quot;"><y>#</y><d>2021-07-22</d><h>19:45</h><w>souenzzo</w><a>@abhishek.mazy</a> you need to add <code>:headers {&quot;Content-Type&quot; &quot;text/html&quot;}</code> to your response

By default, if pedestal find a string on the <code>:body</code>, it will write it as &quot;text/plain&quot;</z><z id="t1626983458" t="ChillPillzKillzBillz Many thanks for this!! It is a pity that this is not specified in any of the tutorials/cookbooks... anywho!! Thanks a bunch!!"><y>#</y><d>2021-07-22</d><h>19:50</h><r>ChillPillzKillzBillz</r>Many thanks for this!! It is a pity that this is not specified in any of the tutorials/cookbooks... anywho!! Thanks a bunch!!</z><z id="t1626984577" t="ChillPillzKillzBillz Another rookie question: I am trying to serve js files generated by figwheel. I am running a simultaneous build environment... or atleast trying to... My Folder structure is as follows: ├───resources │ └───public │ └───css ├───src │ ├───backend │ └───frontend ├───target │ └───public │ └───cljs-out │ └───dev └───test └───frontend Now from pedestal I&apos;d like to supply the css folder in resources/public as well as the cljs-out folder in target/public folder as static resources. I&apos;ve added both of these paths to my deps.edn such that :paths [&quot;src&quot; &quot;resources&quot; &quot;target/public&quot;] is the definition there. Additionally my service definition is as follows: (def service {:env :prod ::http/routes routes ::http/resource-path &quot;public&quot; ::http/type :jetty ::http/port 8080 ::http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}}}) Unfortunately when I access the page, I can&apos;t see the cljs-out folder. How can this be done?"><y>#</y><d>2021-07-22</d><h>20:09</h><w>ChillPillzKillzBillz</w>Another rookie question: I am trying to serve js files generated by figwheel. I am running a simultaneous build environment... or atleast trying to... My Folder structure is as follows:
├───resources
│   └───public
│       └───css
├───src
│   ├───backend
│   └───frontend
├───target
│   └───public
│       └───cljs-out
│           └───dev
└───test
    └───frontend

Now from pedestal I&apos;d like to supply the css folder in resources/public as well as the cljs-out folder in target/public folder as static resources.

I&apos;ve added both of these paths to my deps.edn such that <code>:paths [&quot;src&quot; &quot;resources&quot; &quot;target/public&quot;]</code> is the definition there. Additionally my service definition is as follows:
<pre>(def service {:env                 :prod
              ::http/routes        routes
              ::http/resource-path &quot;public&quot;
              ::http/type          :jetty
              ::http/port          8080
              ::http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}}})</pre>
Unfortunately when I access the page, I can&apos;t see the cljs-out folder. How can this be done?</z><z id="t1626987760" t="souenzzo [:attrs {:href &quot;/_/_/users/U022LK3L4JJ&quot;}] i personally use ::http/file-path &quot;target/public&quot; I don&apos;t like to use :paths [... &quot;folder-with-a-lot-of-gen-things&quot;] because will make this folder be in my classpath and the intellij indexer will blow up"><y>#</y><d>2021-07-22</d><h>21:02</h><w>souenzzo</w><a>@abhishek.mazy</a> i personally use
<code>::http/file-path &quot;target/public&quot;</code>
I don&apos;t like to use
<code>:paths [... &quot;folder-with-a-lot-of-gen-things&quot;]</code>
because will make this folder be in my classpath and the intellij indexer will blow up</z><z id="t1627031838" t="ChillPillzKillzBillz Ok so after this do I remove the &quot;folder-with-a-lot-of-gen-things&quot; out of the :paths in deps.edn? Thanks for this I&apos;ll give it a try..."><y>#</y><d>2021-07-23</d><h>09:17</h><r>ChillPillzKillzBillz</r>Ok so after this do I remove the &quot;folder-with-a-lot-of-gen-things&quot; out of the :paths in deps.edn? Thanks for this I&apos;ll give it a try...</z><z id="t1627032010" t="ChillPillzKillzBillz I am happy to report that now it is working for me!! 🎉 I didn&apos;t have to change the :paths in deps.edn"><y>#</y><d>2021-07-23</d><h>09:20</h><r>ChillPillzKillzBillz</r>I am happy to report that now it is working for me!! <b>🎉</b>

I didn&apos;t have to change the :paths in deps.edn</z><z id="t1627741974" t="ChillPillzKillzBillz Can someone please explain the back tick notation in pedestal routes definition...? e.g. (def routes (let [session-interceptor (middlewares/session {:store (cookie/cookie-store)})] (route/expand-routes [[[&quot;/&quot; {:get `intro-form}] [&quot;/introduce&quot; ^:interceptors [(body-params/body-params) middlewares/params middlewares/keyword-params session-interceptor] {:post `introduction}] [&quot;/hello&quot; ^:interceptors [session-interceptor] {:get `hello}]]])))"><y>#</y><d>2021-07-31</d><h>14:32</h><w>ChillPillzKillzBillz</w>Can someone please explain the back tick notation in pedestal routes definition...? e.g.
<pre>(def routes
  (let [session-interceptor (middlewares/session {:store (cookie/cookie-store)})]
    (route/expand-routes
     [[[&quot;/&quot; {:get `intro-form}]
       [&quot;/introduce&quot; ^:interceptors [(body-params/body-params)
                                     middlewares/params
                                     middlewares/keyword-params
                                     session-interceptor]
        {:post `introduction}]
       [&quot;/hello&quot; ^:interceptors [session-interceptor]
        {:get `hello}]]])))</pre></z><z id="t1627750368" t="souenzzo backtick isn&apos;t a pedestal thing backtick is a clojure thing it&apos;s the &quot;quasiquote&quot; operation when you write intor-form , it evaluates to an object, usually something like #object[...$intro_form ...] When you do a quasiquote, it returns the symbol you can replace {:get `intro-form} with {:get (symbol &quot;current-namespace&quot; &quot;intro-form&quot;)}"><y>#</y><d>2021-07-31</d><h>16:52</h><r>souenzzo</r>backtick isn&apos;t a pedestal thing
backtick is a clojure thing
it&apos;s the &quot;quasiquote&quot; operation
when you write <code>intor-form</code>, it evaluates to an object, usually something like <code>#object[...$intro_form ...]</code>
When you do a quasiquote, it returns the symbol
you can replace
<pre>{:get `intro-form}</pre>
with
<code>{:get (symbol &quot;current-namespace&quot; &quot;intro-form&quot;)}</code></z><z id="t1627760901" t="souenzzo when you use a symbol, you don&apos;t need to use a route-name"><y>#</y><d>2021-07-31</d><h>19:48</h><r>souenzzo</r>when you use a symbol, you don&apos;t need to use a route-name</z><z id="t1627809532" t="ChillPillzKillzBillz ah"><y>#</y><d>2021-08-01</d><h>09:18</h><r>ChillPillzKillzBillz</r>ah</z><z id="t1627809533" t="ChillPillzKillzBillz ok"><y>#</y><d>2021-08-01</d><h>09:18</h><r>ChillPillzKillzBillz</r>ok</z><z id="t1627809541" t="ChillPillzKillzBillz cool Many Thanks for the explanation!"><y>#</y><d>2021-08-01</d><h>09:19</h><r>ChillPillzKillzBillz</r>cool Many Thanks for the explanation!</z><z id="t1627743983" t="ChillPillzKillzBillz Another noob question: I am trying to replicate the pedestal sample for session management using cookies from official http://pedestal.io . The code can be found https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware . The code works great for me. But now I want to make sure that nobody can end up being asked to tell their names again once they&apos;ve already done so... So I made the following modifications: (defn intro-form &quot;Prompt a user for their name, then remember it&quot; [req] (if (empty? (get-in req [:session :name])) (html-response (slurp (io/resource &quot;hello-form.html&quot;))) (ring-resp/redirect &quot;/hello&quot;))) and (def routes (let [session-interceptor (middlewares/session {:store (cookie/cookie-store)})] (route/expand-routes [[[&quot;/&quot; ^:interceptors [session-interceptor] {:get `intro-form}] [&quot;/introduce&quot; ^:interceptors [(body-params/body-params) middlewares/params middlewares/keyword-params session-interceptor] {:post `introduction}] [&quot;/hello&quot; ^:interceptors [session-interceptor] {:get `hello}]]]))) Now this has the desired effect. Such that once I&apos;ve logged in... (so to speak) I can&apos;t go back to the login page. The problem is however that I can&apos;t create a new session even when I am opening new tabs/windows in chrome... I am sure I am missing something silly. Any help will be much appreciated!! How can I create different cookies for different tabs...?"><y>#</y><d>2021-07-31</d><h>15:06</h><w>ChillPillzKillzBillz</w>Another noob question: I am trying to replicate the pedestal sample for session management using cookies from official <a href="http://pedestal.io" target="_blank">http://pedestal.io</a> . The code can be found <a href="https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/ring-middleware</a>. The code works great for me. But now I want to make sure that nobody can end up being asked to tell their names again once they&apos;ve already done so... So I made the following modifications:
<pre>(defn intro-form
  &quot;Prompt a user for their name, then remember it&quot;
  [req]
  (if (empty? (get-in req [:session :name]))
    (html-response
     (slurp (io/resource &quot;hello-form.html&quot;)))
    (ring-resp/redirect &quot;/hello&quot;)))</pre>
and
<pre>(def routes
  (let [session-interceptor (middlewares/session {:store (cookie/cookie-store)})]
    (route/expand-routes
     [[[&quot;/&quot; ^:interceptors [session-interceptor] {:get `intro-form}]
       [&quot;/introduce&quot; ^:interceptors [(body-params/body-params)
                                     middlewares/params
                                     middlewares/keyword-params
                                     session-interceptor]
        {:post `introduction}]
       [&quot;/hello&quot; ^:interceptors [session-interceptor]
        {:get `hello}]]])))</pre>
Now this has the desired effect. Such that once I&apos;ve logged in... (so to speak) I can&apos;t go back to the login page. The problem is however that I can&apos;t create a new session even when I am opening new tabs/windows in chrome... I am sure I am missing something silly. Any help will be much appreciated!!
How can I create different cookies for different tabs...?</z><z id="t1627761056" t="souenzzo No, you can not create a cookie for each tab. it&apos;s a web/browser issue, not a server/pedestal issue. To make behaviors like this, you will end up doing a SPA or at least, some JS code"><y>#</y><d>2021-07-31</d><h>19:50</h><r>souenzzo</r>No, you can not create a cookie for each tab. it&apos;s a web/browser issue, not a server/pedestal issue.
To make behaviors like this, you will end up doing a SPA or at least, some JS code</z><z id="t1627809601" t="ChillPillzKillzBillz Apologies, I am not only new to clojure/script but also web development. So a complete noob!! How is this usually handled in real life...? Any pointers... would be much appreciated!! Thanks for the quick response too!!"><y>#</y><d>2021-08-01</d><h>09:20</h><r>ChillPillzKillzBillz</r>Apologies, I am not only new to clojure/script but also web development. So a complete noob!! How is this usually handled in real life...? Any pointers... would be much appreciated!! Thanks for the quick response too!!</z><z id="t1627860676" t="souenzzo IMHO, its simply not handled. Why do you want to deliver different contents to different tabs?"><y>#</y><d>2021-08-01</d><h>23:31</h><r>souenzzo</r>IMHO, its simply not handled. Why do you want to deliver different contents to different tabs?</z><z id="t1627895670" t="ChillPillzKillzBillz its like setting up a session for each request... If a new tab is opened, then this is a unique request"><y>#</y><d>2021-08-02</d><h>09:14</h><r>ChillPillzKillzBillz</r>its like setting up a session for each request... If a new tab is opened, then this is a unique request</z><z id="t1627896627" t="ChillPillzKillzBillz So if somebody has used the first tab to login... say... when the same person opens the new tab... he should not be considered logged in.. right from the beginning..."><y>#</y><d>2021-08-02</d><h>09:30</h><r>ChillPillzKillzBillz</r>So if somebody has used the first tab to login... say... when the same person opens the new tab... he should not be considered logged in.. right from the beginning...</z><z id="t1627896719" t="ChillPillzKillzBillz or am I being pedantic... (which is quite possible ... 😁 )"><y>#</y><d>2021-08-02</d><h>09:31</h><r>ChillPillzKillzBillz</r>or am I being pedantic... (which is quite possible ... <b>😁</b>)</z><z id="t1627908354" t="souenzzo so, if i click in &quot;open in a new tab&quot;, i will need to login again?!"><y>#</y><d>2021-08-02</d><h>12:45</h><r>souenzzo</r>so, if i click in &quot;open in a new tab&quot;, i will need to login again?!</z><z id="t1627926308" t="ChillPillzKillzBillz isn&apos;t that how it works?"><y>#</y><d>2021-08-02</d><h>17:45</h><r>ChillPillzKillzBillz</r>isn&apos;t that how it works?</z><z id="t1627926321" t="ChillPillzKillzBillz like in banks websites..."><y>#</y><d>2021-08-02</d><h>17:45</h><r>ChillPillzKillzBillz</r>like in banks websites...</z><z id="t1627926322" t="ChillPillzKillzBillz no?"><y>#</y><d>2021-08-02</d><h>17:45</h><r>ChillPillzKillzBillz</r>no?</z><z id="t1627926351" t="ChillPillzKillzBillz My pedanticometer is telling me that I am dangerously close to being pedantic now..."><y>#</y><d>2021-08-02</d><h>17:45</h><r>ChillPillzKillzBillz</r>My pedanticometer is telling me that I am dangerously close to being pedantic now...</z><z id="t1627930196" t="souenzzo Well. Maybe in traditional banks do that. But if they can, they will add a metal detector in the login and close the agency (website) at 5PM too. I would not use tradicional banks as a reference of good website experience. I would say that most of the websites that require login in a new tab do that as a &quot;side effect&quot;, not as a intended behavior. In the way where browsers work, they implement security, sessions, storages, etc.. You can say &quot;well, I don&apos;t trust browser security&quot;. In these case, you can do a not-website (app or something like). But use a browser, skip its default behavior and reimplement your own security policies, IMHO, is the worst combination. PS.: I&apos;m not feeling that you are pedantic 🙂"><y>#</y><d>2021-08-02</d><h>18:49</h><r>souenzzo</r>Well. Maybe in traditional banks do that. But if they can, they will add a metal detector in the login and close the agency (website) at 5PM too.
I would not use tradicional banks as a reference of good website experience.
I would say that most of the websites that require login in a new tab do that as a &quot;side effect&quot;, not as a intended behavior.
In the way where browsers work, they implement security, sessions, storages, etc..

You can say &quot;well, I don&apos;t trust browser security&quot;. In these case, you can do a not-website (app or something like). But use a browser, skip its default behavior and reimplement your own security policies, IMHO, is the worst combination.

PS.: I&apos;m not feeling that you are pedantic <b>🙂</b></z><z id="t1627964855" t="ChillPillzKillzBillz Thanks for that!! I&apos;ll do some research on some sites that I know to understand how this login behaviour actually works... maybe I&apos;ve got it wrong in my head. I am not only new to clojure but also web development. So I keep getting surprised by the usual and sundry. Thanks again!!"><y>#</y><d>2021-08-03</d><h>04:27</h><r>ChillPillzKillzBillz</r>Thanks for that!! I&apos;ll do some research on some sites that I know to understand how this login behaviour actually works... maybe I&apos;ve got it wrong in my head. I am not only new to clojure but also web development. So I keep getting surprised by the usual and sundry. Thanks again!!</z><z id="t1628372688" t="v3ga Noob question, I’m trying to figure out how handle routing/saving to a db. I’m basically trying to use ‘store-book!’ in db.clj in the interceptor ‘insert-book’ but I’m getting a 404. How bad am I butchering this? https://gist.github.com/v3gal0g/a2656ddad262a04641f1c6e4d8833534"><y>#</y><d>2021-08-07</d><h>21:44</h><w>v3ga</w>Noob question, I’m trying to figure out how handle routing/saving to a db.  I’m basically trying to use ‘store-book!’ in db.clj in the interceptor ‘insert-book’ but I’m getting a 404. How bad am I butchering this?
<a href="https://gist.github.com/v3gal0g/a2656ddad262a04641f1c6e4d8833534" target="_blank">https://gist.github.com/v3gal0g/a2656ddad262a04641f1c6e4d8833534</a></z><z id="t1628376147" t="vemv have you tried a simpler endpoint first? GET instead of POST what&apos;s your repro? you haven&apos;t specified a curl command or such have you tried increasing the logging level? have you successfully used the official pedestal template for some quick inspiration?"><y>#</y><d>2021-08-07</d><h>22:42</h><r>vemv</r>have you tried a simpler endpoint first? GET instead of POST

what&apos;s your repro? you haven&apos;t specified a <code>curl</code> command or such

have you tried increasing the logging level?

have you successfully used the official pedestal template for some quick inspiration?</z><z id="t1628376172" t="vemv (you don&apos;t need to answer these one by one - simply trying to hint how I&apos;d solve this myself :) )"><y>#</y><d>2021-08-07</d><h>22:42</h><r>vemv</r>(you don&apos;t need to answer these one by one - simply trying to hint how I&apos;d solve this myself :) )</z><z id="t1628376454" t="v3ga lol, yeah i’ve gone through the basic docs and made basic APIs. i’ll be toying with logging next. I’m fairly new to clojure and dev in general but I feel i’m fairly close. I’ve been attempting to work with POSTMAN and getting a 404 error. One thing I’m doing a bit differently from the examples I’ve seen is people handle the DB transactions within the interceptor. I’ve sort of decoupled that. Still going over things to figure what alls necessary."><y>#</y><d>2021-08-07</d><h>22:47</h><r>v3ga</r>lol, yeah i’ve gone through the basic docs and made basic APIs. i’ll be toying with logging next. I’m fairly new to clojure and dev in general but I feel i’m fairly close.

I’ve been attempting to work with POSTMAN and getting a 404 error.  One thing I’m doing a bit differently from the examples I’ve seen is people handle the DB transactions within the interceptor. I’ve sort of decoupled that. Still going over things to figure  what alls necessary.</z><z id="t1628376812" t="vemv perhaps it&apos;s related to code loading/reloading. for that reason I&apos;d try to toy with a GET endpoint, make a small change to it and verify that code reloading effectively changes its behavior otherwise make small changes (change GET to a minimalistic POST endpoint. then add functionality to the POST) until you detect the precise source of the issue"><y>#</y><d>2021-08-07</d><h>22:53</h><r>vemv</r>perhaps it&apos;s related to code loading/reloading. for that reason I&apos;d try to toy with a GET endpoint, make a small change to it and verify that code reloading effectively changes its behavior

otherwise make small changes (change GET to a minimalistic POST endpoint. then add functionality to the POST) until you detect the precise source of the issue</z><z id="t1628377611" t="v3ga Oh… I may not be far off. Going to test a few things. But now that i’m using restclient in emacs It’s hitting something."><y>#</y><d>2021-08-07</d><h>23:06</h><r>v3ga</r>Oh… I may not be far off.  Going to test a few things. But now that i’m using restclient in emacs It’s hitting something.</z><z id="t1628378016" t="v3ga"><y>#</y><d>2021-08-07</d><h>23:13</h><r>v3ga</r></z><z id="t1628378236" t="v3ga Got it! it was working correctly."><y>#</y><d>2021-08-07</d><h>23:17</h><r>v3ga</r>Got it! it was working correctly.</z><z id="t1628378016" t="v3ga"><y>#</y><d>2021-08-07</d><h>23:13</h><w>v3ga</w></z><z id="t1628378236" t="v3ga Got it! it was working correctly."><y>#</y><d>2021-08-07</d><h>23:17</h><w>v3ga</w>Got it! it was working correctly.</z><z id="t1628602353" t="v3ga Newbie issue continued. For the life of me I can’t delete a record with my route. “delete-book!” works as far as the db transaction goes but for my route I keep getting a 404. Once I have all of the basics i’ll be writing blog posts on this since the documentation is sparse/geared towards people with a bit more experience."><y>#</y><d>2021-08-10</d><h>13:32</h><w>v3ga</w>Newbie issue continued.  For the life of me I can’t delete  a record with my route.  “delete-book!” works as far as the db transaction goes but for my route I keep getting a 404.    Once I have all of the basics i’ll be writing blog posts on this since the documentation is sparse/geared towards people with a bit more experience.</z><z id="t1628602697" t="Joe Lane Doesn’t look like the delete-book interceptor returns a ring response. Does it actually delete the book but just return 404?"><y>#</y><d>2021-08-10</d><h>13:38</h><r>Joe Lane</r>Doesn’t look like the delete-book interceptor returns a ring response.  

Does it actually delete the book but just return 404?</z><z id="t1628602734" t="v3ga No, it’s not deleting the book either."><y>#</y><d>2021-08-10</d><h>13:38</h><r>v3ga</r>No, it’s not deleting the book either.</z><z id="t1628602873" t="Joe Lane Ok so does the request ever get to that handler? Pprint the ctx before attempting to get the book ID"><y>#</y><d>2021-08-10</d><h>13:41</h><r>Joe Lane</r>Ok so does the request ever get to that handler? Pprint the ctx before attempting to get the book ID</z><z id="t1628603021" t="v3ga No it doesn’t get that far. This kicks out when I attempt “DELETE http://locahost:3000/book/11 =&gt; :initiated21-08-10 13:42:17 Akuma.local INFO [io.pedestal.http:116] - {:msg “DELETE /book/11”, :line 80}"><y>#</y><d>2021-08-10</d><h>13:43</h><r>v3ga</r>No it doesn’t get that far.  This kicks out when I attempt  “DELETE <a href="http://locahost:3000/book/11" target="_blank">http://locahost:3000/book/11</a>

=&gt; :initiated21-08-10 13:42:17 Akuma.local INFO [io.pedestal.http:116] - {:msg “DELETE /book/11”, :line 80}</z><z id="t1628604632" t="souenzzo Your function delete-book returns something from db/delete-book! This something do not have a :status map Pedestal default not-found handler will seach for {:status ...} in the response, if not found, then it will put 404. A possible solution (def delete-book {:name ::delete-book :enter (fn [context] (let [id (-&gt; context :path-params :id)] (db/delete-book! id) {:status 202}))}) https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L93"><y>#</y><d>2021-08-10</d><h>14:10</h><r>souenzzo</r>Your function <code>delete-book</code> returns something from <code>db/delete-book!</code>

This something do not have a <code>:status</code> map
Pedestal default <code>not-found</code> handler will seach for <code>{:status ...}</code> in the response, if not found, then it will put 404.

A possible solution

<pre>(def delete-book
  {:name ::delete-book
   :enter (fn [context]
            (let [id (-&gt; context :path-params :id)]
              (db/delete-book! id)
              {:status 202}))})</pre>
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L93" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L93</a></z><z id="t1628604824" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ohh…. hmm, where can I learn more how all of this works? Just reading the source code? It’s hard to figure out where to begin and what direction to go."><y>#</y><d>2021-08-10</d><h>14:13</h><r>v3ga</r><a>@U2J4FRT2T</a> ohh…. hmm, where can I learn more how all of this works? Just reading the source code? It’s hard to figure out where to begin and what direction to go.</z><z id="t1628604905" t="Joe Lane &gt; Doesn’t look like the delete-book interceptor returns a ring response. Handlers must return ring-responses"><y>#</y><d>2021-08-10</d><h>14:15</h><r>Joe Lane</r>&gt; Doesn’t look like the delete-book interceptor returns a ring response.
Handlers must return ring-responses</z><z id="t1628604988" t="v3ga"><y>#</y><d>2021-08-10</d><h>14:16</h><r>v3ga</r></z><z id="t1628605016" t="v3ga [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] at one point I returned with this but was running into the same issue."><y>#</y><d>2021-08-10</d><h>14:16</h><r>v3ga</r><a>@U0CJ19XAM</a> at one point I returned with this but was running into the same issue.</z><z id="t1628605059" t="souenzzo The code in most of cases is simple to read. I&apos;m happy with response-for and other tools like scope capture that allow me to quickly experiment, explore, prototype and understand the behavior of the library. Would be nice if more people write tutorials about pedestal, or contribute to the official docs."><y>#</y><d>2021-08-10</d><h>14:17</h><r>souenzzo</r>The code in most of cases is simple to read.
I&apos;m happy with response-for and other tools like scope capture that allow me to quickly experiment, explore, prototype and understand the behavior of the library.
Would be nice if more people write tutorials about pedestal, or contribute to the official docs.</z><z id="t1628605213" t="v3ga Yeah… I think as I figure things out I’ll make some blog posts. There’s actually a decent book that uses pedestal all the way through but they also throw in Datomic and focus on building microservices. There’s good information but they drown you with other advanced topics."><y>#</y><d>2021-08-10</d><h>14:20</h><r>v3ga</r>Yeah… I think as I figure things out I’ll make some blog posts.  There’s actually a decent book that uses pedestal all the way through but they also throw in Datomic and focus on building microservices.  There’s good information but they drown you with other advanced topics.</z><z id="t1628605228" t="souenzzo In your particular case, you are in a &quot;unspecified area&quot;, once &quot;handlers should return ring response map&quot; and you are not returning it, it&apos;s hard to document/explain which behavior will occur"><y>#</y><d>2021-08-10</d><h>14:20</h><r>souenzzo</r>In your particular case, you are in a &quot;unspecified area&quot;, once &quot;handlers should return ring response map&quot; and you  are not returning it, it&apos;s hard to document/explain which behavior will occur</z><z id="t1628605307" t="souenzzo But for sure, it&apos;s a common mistake, so it worth a effort to do better docs/explain on it."><y>#</y><d>2021-08-10</d><h>14:21</h><r>souenzzo</r>But for sure, it&apos;s a common mistake, so it worth a effort to do better docs/explain on it.</z><z id="t1628605429" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] hmm adding {:status 202} didn’t make it work either. I’m still having trouble believing its even reaching the interceptor. I tried to print ‘context’ out with hashp and it never gets there…. I’m going to take a step back and focus on getting a grasp on context/request/response maps. I’m sure i’ll be back on here in a few but for now I think its better that I slow down and take a step back. Completely lost."><y>#</y><d>2021-08-10</d><h>14:23</h><r>v3ga</r><a>@U2J4FRT2T</a> hmm adding {:status 202} didn’t make it work either.  I’m still having trouble believing its even reaching the interceptor.  I tried to print ‘context’ out with hashp and it never gets there….   I’m going to take a step back and focus on getting a grasp on context/request/response maps.   I’m sure i’ll be back on here in a few but for now I think its better that I slow down and take a step back. Completely lost.</z><z id="t1628605468" t="souenzzo (def delete-book {:name ::delete-book :enter (fn [context] (let [id (-&gt; context :path-params :id)] (db/delete-book! id) (assoc context :response {:status 202})))})"><y>#</y><d>2021-08-10</d><h>14:24</h><r>souenzzo</r><pre>(def delete-book
  {:name ::delete-book
   :enter (fn [context]
            (let [id (-&gt; context :path-params :id)]
              (db/delete-book! id)
             (assoc context :response  {:status 202})))})</pre></z><z id="t1628605487" t="souenzzo also"><y>#</y><d>2021-08-10</d><h>14:24</h><r>souenzzo</r>also</z><z id="t1628605500" t="souenzzo (-&gt; context :request :path-params :id)"><y>#</y><d>2021-08-10</d><h>14:25</h><r>souenzzo</r><code>(-&gt; context :request :path-params :id)</code></z><z id="t1628605605" t="souenzzo a handler is a function that receive a request and returns a response , as in ring meaning. an interceptor has enter/leave/error stages, each of these receives and returns a context, which contains a request map, maybe a response map. error stages receives 2 args: ctx and exception"><y>#</y><d>2021-08-10</d><h>14:26</h><r>souenzzo</r>a <code>handler</code> is a function that receive a <code>request</code> and returns a <code>response</code>, as in ring meaning.

an <code>interceptor</code> has enter/leave/error stages, each of these receives and returns a context, which contains a request map, maybe a response map.
error stages receives 2 args: ctx and exception</z><z id="t1628606081" t="souenzzo With this form, you can prototype and explore pedestal in a quickly way: (require &apos;[io.pedestal.http :as http] &apos;[io.pedestal.test :refer [response-for]]) (let [routes #{[&quot;/book/:id&quot; :delete [{:name :book-delete :enter (fn [ctx] (def _ctx ctx) (assoc ctx :response {:status 202}))}]]} service-fn (-&gt; {::http/routes routes} http/default-interceptors http/create-servlet ::http/service-fn)] (response-for service-fn :delete &quot;/book/123&quot;)) =&gt; {:status 202, :body &quot;&quot;, :headers {&quot;Strict-Transport-Security&quot; &quot;max-age=31536000; includeSubdomains&quot;, &quot;X-Frame-Options&quot; &quot;DENY&quot;, &quot;X-Content-Type-Options&quot; &quot;nosniff&quot;, &quot;X-XSS-Protection&quot; &quot;1; mode=block&quot;, &quot;X-Download-Options&quot; &quot;noopen&quot;, &quot;X-Permitted-Cross-Domain-Policies&quot; &quot;none&quot;, &quot;Content-Security-Policy&quot; &quot;object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:;&quot;}} ;; now you can inspect ctx _ctx {:request {.... } ...} Where I do (def _ctx ctx) , you can use (tap&gt; ctx) or any other &quot;scope capture&quot; method. There is many libraries that do that. You can also create a deftest to do that even quickier or capture a scope in your &quot;real&quot; running app It will help you to inspect/experiment"><y>#</y><d>2021-08-10</d><h>14:34</h><r>souenzzo</r>With this form, you can prototype and explore pedestal in a quickly way:
<pre>(require &apos;[io.pedestal.http :as http]
  &apos;[io.pedestal.test :refer [response-for]])

(let [routes #{[&quot;/book/:id&quot; :delete
                [{:name  :book-delete
                  :enter (fn [ctx]
                           (def _ctx ctx)
                           (assoc ctx :response {:status 202}))}]]}
      service-fn (-&gt; {::http/routes routes}
                   http/default-interceptors
                   http/create-servlet
                   ::http/service-fn)]
  (response-for service-fn
    :delete &quot;/book/123&quot;))
=&gt; {:status  202,
    :body    &quot;&quot;,
    :headers {&quot;Strict-Transport-Security&quot;         &quot;max-age=31536000; includeSubdomains&quot;,
              &quot;X-Frame-Options&quot;                   &quot;DENY&quot;,
              &quot;X-Content-Type-Options&quot;            &quot;nosniff&quot;,
              &quot;X-XSS-Protection&quot;                  &quot;1; mode=block&quot;,
              &quot;X-Download-Options&quot;                &quot;noopen&quot;,
              &quot;X-Permitted-Cross-Domain-Policies&quot; &quot;none&quot;,
              &quot;Content-Security-Policy&quot;           &quot;object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:;&quot;}}
;; now you can inspect ctx
_ctx 
{:request {.... } ...}</pre>
Where I do <code>(def _ctx ctx)</code>, you can use <code>(tap&gt; ctx)</code> or any other &quot;scope capture&quot; method. There is many libraries that do that.


You can also create a <code>deftest</code> to do that even quickier

or capture a scope in your &quot;real&quot; running app
It will help you to inspect/experiment</z><z id="t1628607531" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ok, going to toy with it. I’ve been meaning to toy with tap&gt; as well."><y>#</y><d>2021-08-10</d><h>14:58</h><r>v3ga</r><a>@U2J4FRT2T</a> ok, going to toy with it. I’ve been meaning to toy with tap&gt; as well.</z><z id="t1629303588" t="Ben Hammond Hi. I am trying to hook into AWS Cognito to exchange an authorization code for an id_token I have found that I can cobble something together using raw org.eclipse.jetty.client.HttpClient like this (defn logged-in [request] (println &quot;logged-in&quot;) (prn request) (let [cli (doto (HttpClient. (SslContextFactory$Client. true)) (.start)) req (doto (.POST cli &quot;&quot;) (.content (FormContentProvider. (doto (Fields.) (.add &quot;grant_type&quot; &quot;authorization_code&quot;) (.add &quot;client_id&quot; &quot;*****&quot;) (.add &quot;code&quot; (get-in request [:params :code])) (.add &quot;redirect_uri&quot; &quot;&quot;)))) ) ^ContentResponse cr (.send req) ] (clojure.pprint/pprint cr) (println (.getContentAsString cr)) but this seems a bit ugly but I don&apos;t want to introduce a new clj-http library just to extract id_token; mostly I am using com.cognitect.aws/api libraries Is that a cognitect api library function that will exchange authorization codes for id_tokens (that I&apos;ve not found)? Is there some more elegant way to run this code? I imagine it must be a fairly common thing to do..."><y>#</y><d>2021-08-18</d><h>16:19</h><w>Ben Hammond</w>Hi.
I am trying to hook into AWS Cognito to exchange an authorization code for an id_token
I have found that I can cobble something together using raw <code>org.eclipse.jetty.client.HttpClient</code> like this
<pre>(defn logged-in [request]
  (println &quot;logged-in&quot;)
  (prn request)
  (let [cli (doto (HttpClient. (SslContextFactory$Client. true)) (.start))
        req (doto
            (.POST cli &quot;&quot;)
              (.content (FormContentProvider.
                         (doto (Fields.)
                           (.add &quot;grant_type&quot; &quot;authorization_code&quot;)
                           (.add &quot;client_id&quot; &quot;*****&quot;)
                           (.add &quot;code&quot; (get-in request [:params :code]))
                           (.add &quot;redirect_uri&quot; &quot;&quot;))))
              )
        ^ContentResponse cr (.send req)
        ]
    (clojure.pprint/pprint cr)
    (println (.getContentAsString cr))</pre>
but this seems a bit ugly

but I don&apos;t want to introduce a new <code>clj-http</code> library just to extract id_token;
mostly I am using <code>com.cognitect.aws/api</code> libraries

Is that a cognitect api library function that will exchange authorization codes for id_tokens (that I&apos;ve not found)?
Is there some more elegant way to run this code?
I imagine it must be a fairly common thing to do...</z><z id="t1629304274" t="Joe Lane Hi [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] , you should also ask this question over in #aws"><y>#</y><d>2021-08-18</d><h>16:31</h><r>Joe Lane</r>Hi <a>@U793EL04V</a>, you should also ask this question over in #aws</z><z id="t1629304352" t="Joe Lane I&apos;m a bit confused, where are you getting the request from in the above function? Are you going through APIGW?"><y>#</y><d>2021-08-18</d><h>16:32</h><r>Joe Lane</r>I&apos;m a bit confused, where are you getting the <code>request</code> from in the above function? Are you going through APIGW?</z><z id="t1629304492" t="Ben Hammond I am running a pedestal instance on localhost:8080"><y>#</y><d>2021-08-18</d><h>16:34</h><r>Ben Hammond</r>I am running a pedestal instance on <code>localhost:8080</code></z><z id="t1629304521" t="Ben Hammond eventually it will be running an a datomic ionic direct-http thingamy"><y>#</y><d>2021-08-18</d><h>16:35</h><r>Ben Hammond</r>eventually it will be running an a datomic ionic direct-http thingamy</z><z id="t1629304545" t="Ben Hammond or maybe a plain old ion lambda if that turns out more satisfactory"><y>#</y><d>2021-08-18</d><h>16:35</h><r>Ben Hammond</r>or maybe a plain old ion lambda if that turns out more satisfactory</z><z id="t1629304591" t="Joe Lane I don&apos;t think ion lambda http-proxy will be more satisfactory for you 🙂"><y>#</y><d>2021-08-18</d><h>16:36</h><r>Joe Lane</r>I don&apos;t think ion lambda http-proxy will be more satisfactory for you <b>🙂</b></z><z id="t1629304608" t="Ben Hammond i do try to stay open-minded"><y>#</y><d>2021-08-18</d><h>16:36</h><r>Ben Hammond</r>i do try to stay open-minded</z><z id="t1629304615" t="Joe Lane Good idea 🙂"><y>#</y><d>2021-08-18</d><h>16:36</h><r>Joe Lane</r>Good idea <b>🙂</b></z><z id="t1629304695" t="Joe Lane Have you considered using a cognito authorizer for your APIGW route?"><y>#</y><d>2021-08-18</d><h>16:38</h><r>Joe Lane</r>Have you considered using a cognito authorizer for your APIGW route?</z><z id="t1629304724" t="Ben Hammond a what?"><y>#</y><d>2021-08-18</d><h>16:38</h><r>Ben Hammond</r>a what?</z><z id="t1629304730" t="Ben Hammond what is that?"><y>#</y><d>2021-08-18</d><h>16:38</h><r>Ben Hammond</r>what is that?</z><z id="t1629304764" t="Ben Hammond ultimately, once api calls are getting made, i plan to use the built in cognito checking"><y>#</y><d>2021-08-18</d><h>16:39</h><r>Ben Hammond</r>ultimately, once api calls are getting made, i plan to use the built in cognito checking</z><z id="t1629304784" t="Ben Hammond but I&apos;ve only just got logging in working"><y>#</y><d>2021-08-18</d><h>16:39</h><r>Ben Hammond</r>but I&apos;ve only just got logging in working</z><z id="t1629304830" t="Ben Hammond you mean like https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-enable-cognito-user-pool.html"><y>#</y><d>2021-08-18</d><h>16:40</h><r>Ben Hammond</r>you mean like
<a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-enable-cognito-user-pool.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-enable-cognito-user-pool.html</a></z></g><g id="s21"><z id="t1629304838" t="Ben Hammond yes, that is my intention"><y>#</y><d>2021-08-18</d><h>16:40</h><r>Ben Hammond</r>yes, that is my intention</z><z id="t1629304901" t="Ben Hammond its all done using Http Headers rather than cookies"><y>#</y><d>2021-08-18</d><h>16:41</h><r>Ben Hammond</r>its all done using Http Headers rather than cookies</z><z id="t1629304902" t="Joe Lane Not with the REST API though, with the latest release we use the HTTP API, not the REST API. I&apos;m thinking something like https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-jwt-authorizer.html"><y>#</y><d>2021-08-18</d><h>16:41</h><r>Joe Lane</r>Not with the REST API though, with the latest release we use the HTTP API, not the REST API.

I&apos;m thinking something like <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-jwt-authorizer.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-jwt-authorizer.html</a></z><z id="t1629304945" t="Ben Hammond why does it use Headers rather than cookies? are cookies found to be insecure?"><y>#</y><d>2021-08-18</d><h>16:42</h><r>Ben Hammond</r>why does it use Headers rather than cookies?
are cookies found to be insecure?</z><z id="t1629304960" t="Joe Lane Which has an example of using cognito for the JWT authorizer. If you need more flexibility you can also use the previous access control mechanism which calls lambdas, AKA an ion."><y>#</y><d>2021-08-18</d><h>16:42</h><r>Joe Lane</r>Which has an example of using cognito for the JWT authorizer.

If you need more flexibility you can also use the previous access control mechanism which calls lambdas, AKA an ion.</z><z id="t1629305015" t="Joe Lane Cookies are browser focused, headers are inclusive of mobile apps as well."><y>#</y><d>2021-08-18</d><h>16:43</h><r>Joe Lane</r>Cookies are browser focused, headers are inclusive of mobile apps as well.</z><z id="t1629306530" t="emccue If you are going to cobble something together without a library, I would personally reccomend the new JDK http client"><y>#</y><d>2021-08-18</d><h>17:08</h><r>emccue</r>If you are going to cobble something together without a library, I would personally reccomend the new JDK http client</z><z id="t1629306564" t="emccue Not that jetty&apos;s is broken or bad in any particular way"><y>#</y><d>2021-08-18</d><h>17:09</h><r>emccue</r>Not that jetty&apos;s is broken or bad in any particular way</z><z id="t1629494335" t="bringe Hello. I&apos;m wondering if I&apos;m misunderstanding something about pedestal&apos;s async handling in interceptors. The below code returns nil , rather than a context map. (def async-example (interceptor {:name :async-example :enter (fn [context] (go (assoc context :async-result &quot;some result&quot;)))})) (chain/execute {} [async-example]) If I remove the go block, I get the context map I expect. I wonder if it&apos;s something related to using execute , though looking in pedestal&apos;s source, it seems execute does perform the async handling if a channel is returned. https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L173 Is something not working as it should, or am I doing something incorrectly for this to work?"><y>#</y><d>2021-08-20</d><h>21:18</h><w>bringe</w>Hello. I&apos;m wondering if I&apos;m misunderstanding something about pedestal&apos;s async handling in interceptors. The below code returns <code>nil</code>, rather than a context map.

<pre>(def async-example
  (interceptor
   {:name :async-example
    :enter (fn [context]
             (go
               (assoc context :async-result &quot;some result&quot;)))}))

(chain/execute {} [async-example])</pre>
If I remove the <code>go</code> block, I get the context map I expect. I wonder if it&apos;s something related to using <code>execute</code> , though looking in pedestal&apos;s source, it seems <code>execute</code> does perform the async handling if a channel is returned. <a href="https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L173" target="_blank">https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L173</a>

Is something not working as it should, or am I doing something incorrectly for this to work?</z><z id="t1629500514" t="bringe A reference: http://pedestal.io/reference/interceptors#_interceptor_return_values"><y>#</y><d>2021-08-20</d><h>23:01</h><r>bringe</r>A reference: <a href="http://pedestal.io/reference/interceptors#_interceptor_return_values" target="_blank">http://pedestal.io/reference/interceptors#_interceptor_return_values</a></z><z id="t1629500709" t="isak I see this in the code: https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L102-L108"><y>#</y><d>2021-08-20</d><h>23:05</h><r>isak</r>I see this in the code: <a href="https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L102-L108" target="_blank">https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L102-L108</a></z><z id="t1629500818" t="isak Actually not sure that matters, it seems like your example is supposed to work"><y>#</y><d>2021-08-20</d><h>23:06</h><r>isak</r>Actually not sure that matters, it seems like your example is supposed to work</z><z id="t1629501851" t="bringe Yeah, it looks like should. :thinking_face:"><y>#</y><d>2021-08-20</d><h>23:24</h><r>bringe</r>Yeah, it looks like should. <b>:thinking_face:</b></z><z id="t1629504584" t="bringe I think it has something to do with the repl and threading, though I&apos;m not sure what exactly is happening. If I change the body of execute in the pedestal source to this: ([context] (let [context (some-&gt; context begin enter-all terminate leave-all end)] (prn &quot;context&quot; context) (if-let [ex (::error context)] (throw ex) (do (prn &quot;returning:&quot; context) context)))) ... then run my example, I get these logs and result: &quot;context&quot; nil &quot;returning:&quot; nil &quot;context&quot; {:async-result &quot;some result&quot;} &quot;returning:&quot; {:async-result &quot;some result&quot;} nil"><y>#</y><d>2021-08-21</d><h>00:09</h><r>bringe</r>I think it has something to do with the repl and threading, though I&apos;m not sure what exactly is happening.

If I change the body of <code>execute</code> in the pedestal source to this:

<pre>([context]
   (let [context (some-&gt; context
                         begin
                         enter-all
                         terminate
                         leave-all
                         end)]
     (prn &quot;context&quot; context)
     (if-let [ex (::error context)]
       (throw ex)
       (do
         (prn &quot;returning:&quot; context)
         context))))</pre>
... then run my example, I get these logs and result:

<pre>&quot;context&quot; nil
&quot;returning:&quot; nil
&quot;context&quot; {:async-result &quot;some result&quot;}
&quot;returning:&quot; {:async-result &quot;some result&quot;}
nil</pre></z><z id="t1629504630" t="bringe I need to go afk for now, but thanks for taking a look earlier [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] ."><y>#</y><d>2021-08-21</d><h>00:10</h><r>bringe</r>I need to go afk for now, but thanks for taking a look earlier <a>@U08JKUHA9</a>.</z><z id="t1629636604" t="souenzzo (chain/execute {} [(interceptor/interceptor {:name :leave :leave (fn [{:keys [response] :as context}] (prn [:response response]) context)}) (interceptor/interceptor {:name :async-example :enter (fn [context] (async/go (assoc context :response {:status 202})))})]) ret =&gt; nil stdout =&gt; [:response {:status 202}] "><y>#</y><d>2021-08-22</d><h>12:50</h><r>souenzzo</r><pre>(chain/execute
  {}
  [(interceptor/interceptor
     {:name  :leave
      :leave (fn [{:keys [response]
                   :as   context}]
               (prn [:response response])
               context)})
   (interceptor/interceptor
     {:name  :async-example
      :enter (fn [context]
               (async/go
                 (assoc context :response {:status 202})))})])
ret =&gt; nil
stdout =&gt; [:response {:status 202}]</pre>
</z><z id="t1629669576" t="ddeaguiar From the http://pedestal.io/reference/interceptors#_interceptor_return_values and as demonstrated ^^: &gt; Any interceptor downstream of an asynchronous interceptor will be executed in the `core.async` thread pool."><y>#</y><d>2021-08-22</d><h>21:59</h><r>ddeaguiar</r>From the <a href="http://pedestal.io/reference/interceptors#_interceptor_return_values" target="_blank">http://pedestal.io/reference/interceptors#_interceptor_return_values</a> and as demonstrated ^^:

&gt;  Any interceptor downstream of an asynchronous interceptor will be executed in the `core.async` thread pool.</z><z id="t1629683906" t="isak Understandable that it can&apos;t be synchronous, but wouldn&apos;t it make sense to return the result asynchronously in some way, like is done for the synchronous path?"><y>#</y><d>2021-08-23</d><h>01:58</h><r>isak</r>Understandable that it can&apos;t be synchronous, but wouldn&apos;t it make sense to return the result asynchronously in some way, like is done for the synchronous path?</z><z id="t1629724759" t="lispers-anonymous I believe this behavior is expected. https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L110-L117 The docs call out that if a channel is received instead of a context it will return immediately with a nil."><y>#</y><d>2021-08-23</d><h>13:19</h><r>lispers-anonymous</r>I believe this behavior is expected.

<a href="https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L110-L117" target="_blank">https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/interceptor/src/io/pedestal/interceptor/chain.clj#L110-L117</a>

The docs call out that if a channel is received instead of a context it will return immediately with a nil.</z><z id="t1629725244" t="lispers-anonymous Pedestal itself doesn&apos;t need the context when everything has finished executing. One of the last interceptors that will be executed is responsible for writing the response to the response output stream. Once that is done there is really nothing left to do. https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L288 https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L218"><y>#</y><d>2021-08-23</d><h>13:27</h><r>lispers-anonymous</r>Pedestal itself doesn&apos;t need the context when everything has finished executing. One of the last interceptors that will be executed is responsible for writing the response to the response output stream. Once that is done there is really nothing left to do.

<a href="https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L288" target="_blank">https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L288</a>
<a href="https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L218" target="_blank">https://github.com/pedestal/pedestal/blob/6b518f1403132e0474daa5edaf08b1de1df267b5/service/src/io/pedestal/http/impl/servlet_interceptor.clj#L218</a></z><z id="t1629733115" t="bringe Thanks for the replies. [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] Yes, that&apos;s the part of the docs I linked earlier in the thread. I suppose I just didn&apos;t fully understand the implications."><y>#</y><d>2021-08-23</d><h>15:38</h><r>bringe</r>Thanks for the replies. <a>@U0FL657GR</a> Yes, that&apos;s the part of the docs I linked earlier in the thread. I suppose I just didn&apos;t fully understand the implications.</z><z id="t1630087106" t="apt Hi folks. Given a url, I’d like to get the associated route. What’s the pedestal function that does that? For example, given a url /api/fd17ae7e-6f8e-4ca6-813f-3597f950db55/foo , I’d like to get /api/:id/foo . Context: I’m trying to extract some logs from integration tests. The logs have the raw url, and I need to get their associated routes for generating some visualizations. Using pedestal internal functions is fine in this context (integration tests)."><y>#</y><d>2021-08-27</d><h>17:58</h><w>apt</w>Hi folks. Given a url, I’d like to get the associated route. What’s the pedestal function that does that?

For example, given a url <code>/api/fd17ae7e-6f8e-4ca6-813f-3597f950db55/foo</code>, I’d like to get <code>/api/:id/foo</code>.

Context: I’m trying to extract some logs from integration tests. The logs have the raw url, and I need to get their associated routes for generating some visualizations.
Using pedestal internal functions is fine in this context (integration tests).</z><z id="t1630316050" t="Lukas Hello, I&apos;m trying out pedestal and I wonder if there is a way to reload an interceptor after modification without restarting the server everytime?"><y>#</y><d>2021-08-30</d><h>09:34</h><w>Lukas</w>Hello, I&apos;m trying out pedestal and I wonder if there is a way to reload an interceptor after modification without restarting the server everytime?</z><z id="t1630362936" t="lispers-anonymous When setting up your server, you provide a :io.pedestal.http/routes key in the server config map. It&apos;s value can be the routes or a function that returns the routes. For development time, using a function will enable you to reload your code without restarting. That function should access your routes through the var that holds them (or the var of a function that returns the routes, if that is how you set it up). If you pass the routes directly, then the next time your code changes the routes that pedestal is holding onto will be the previous version of them. (def my-routes #{[&quot;/home&quot; :get some-interceptors] [&quot;/dog/:name&quot; :get dog-interceptors]}) ;; ... later (io.pedestal.http/create-server {:io.pedestal.http/routes (fn [] (io.pedestal.http.route/expand-routes (deref #&apos;my-routes))) ;;... the rest of the server config }) Something like that should work. The repl support in pedestal is not very well documented. Note that if you use are using emacs and cider, cider-ns-refresh can destroy your vars and re-create them. That will require you to restart your repl, so avoid that command if possible."><y>#</y><d>2021-08-30</d><h>22:35</h><r>lispers-anonymous</r>When setting up your server, you provide a <code>:io.pedestal.http/routes</code> key in the server config map. It&apos;s value can be the routes or a function that returns the routes.

For development time, using a function will enable you to reload your code without restarting. That function should access your routes through the <code>var</code> that holds them (or the var of a function that returns the routes, if that is how you set it up). If you pass the routes directly, then the next time your code changes the routes that pedestal is holding onto will be the previous version of them.

<pre>(def my-routes
  #{[&quot;/home&quot; :get some-interceptors]
    [&quot;/dog/:name&quot; :get dog-interceptors]})

;; ... later

(io.pedestal.http/create-server
  {:io.pedestal.http/routes 
   (fn [] 
     (io.pedestal.http.route/expand-routes (deref #&apos;my-routes)))
   ;;... the rest of the server config
  })</pre>
Something like that should work. The repl support in pedestal is not very well documented.

Note that if you use are using emacs and cider, <code>cider-ns-refresh</code> can destroy your vars and re-create them. That will require you to restart your repl, so avoid that command if possible.</z><z id="t1630366451" t="lispers-anonymous Here is a more complete example https://gitlab.com/dannyfreeman/pedestal-repl-example/-/blob/master/src/dfreeman/pedestal_repl_example.clj"><y>#</y><d>2021-08-30</d><h>23:34</h><r>lispers-anonymous</r>Here is a more complete example <a href="https://gitlab.com/dannyfreeman/pedestal-repl-example/-/blob/master/src/dfreeman/pedestal_repl_example.clj" target="_blank">https://gitlab.com/dannyfreeman/pedestal-repl-example/-/blob/master/src/dfreeman/pedestal_repl_example.clj</a></z><z id="t1630394716" t="Lukas Thanks a lot! I figured I missed a pair of parentheses. I wrote ::server/routes (fn [] (deref #&apos;service/routes)) instead of ::server/routes (fn [] ((deref #&apos;service/routes)))"><y>#</y><d>2021-08-31</d><h>07:25</h><r>Lukas</r>Thanks a lot! I figured I missed a pair of parentheses. I wrote
<pre>::server/routes (fn [] (deref #&apos;service/routes)) </pre>
instead of
<pre>::server/routes (fn [] ((deref #&apos;service/routes)))</pre></z><z id="t1630412644" t="lispers-anonymous Glad you got it figured out. This a great trick whenever you are providing something to a long running process and you want the ability to change the thing your code is providing out from under the process. It&apos;s not just a pedestal thing."><y>#</y><d>2021-08-31</d><h>12:24</h><r>lispers-anonymous</r>Glad you got it figured out. This a great trick whenever you are providing something to a long running process and you want the ability to change the thing your code is providing out from under the process. It&apos;s not just a pedestal thing.</z><z id="t1630333484" t="Joe Lane [:attrs {:href &quot;/_/_/users/UP2FUP0TT&quot;}] http://pedestal.io/guides/developing-at-the-repl"><y>#</y><d>2021-08-30</d><h>14:24</h><w>Joe Lane</w><a>@lukas.block</a> <a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a></z><z id="t1630518905" t="isak When doing development with io.pedestal.log , is there a way to customize how the data gets formatted, specifically when it gets printed in the REPL console?"><y>#</y><d>2021-09-01</d><h>17:55</h><w>isak</w>When doing development with <code>io.pedestal.log</code> , is there a way to customize how the data gets formatted, specifically when it gets printed in the REPL console?</z><z id="t1630519655" t="souenzzo [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] no, but you can do it via your provider For example, I use lockback and this is my logback.xml (thread)"><y>#</y><d>2021-09-01</d><h>18:07</h><w>souenzzo</w><a>@isak</a> no, but you can do it via your provider
For example, I use lockback and this is my logback.xml (thread)</z><z id="t1630519816" t="souenzzo &lt;configuration scan=&quot;true&quot; scanPeriod=&quot;5 seconds&quot;&gt; &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;%date{&quot;mm:ss.SSS&quot;,UTC} %level %msg%n%replace(%caller{2..3}){&apos;Caller\+[0-9]&apos;, &apos;&apos;}&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;root level=&quot;INFO&quot;&gt; &lt;appender-ref ref=&quot;STDOUT&quot;/&gt; &lt;/root&gt; &lt;logger name=&quot;io.pedestal&quot; level=&quot;ERROR&quot;/&gt; &lt;logger name=&quot;org.eclipse&quot; level=&quot;ERROR&quot;/&gt; &lt;logger name=&quot;io.netty&quot; level=&quot;INFO&quot;/&gt; &lt;logger name=&quot;com.amazonaws&quot; level=&quot;INFO&quot;/&gt; &lt;logger name=&quot;datomic&quot; level=&quot;ERROR&quot;/&gt; &lt;/configuration&gt; Using this %caller{2..3} makes #cursive understand that line as a stacktrace line, then it turns it into a clickable link"><y>#</y><d>2021-09-01</d><h>18:10</h><r>souenzzo</r><pre>&lt;configuration scan=&quot;true&quot;
               scanPeriod=&quot;5 seconds&quot;&gt;
    &lt;appender name=&quot;STDOUT&quot;
              class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;%date{&quot;mm:ss.SSS&quot;,UTC} %level %msg%n%replace(%caller{2..3}){&apos;Caller\+[0-9]&apos;, &apos;&apos;}&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;root level=&quot;INFO&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot;/&gt;
    &lt;/root&gt;
    &lt;logger name=&quot;io.pedestal&quot; level=&quot;ERROR&quot;/&gt;
    &lt;logger name=&quot;org.eclipse&quot; level=&quot;ERROR&quot;/&gt;
    &lt;logger name=&quot;io.netty&quot; level=&quot;INFO&quot;/&gt;
    &lt;logger name=&quot;com.amazonaws&quot; level=&quot;INFO&quot;/&gt;
    &lt;logger name=&quot;datomic&quot; level=&quot;ERROR&quot;/&gt;
&lt;/configuration&gt;</pre>
Using this <code>%caller{2..3}</code> makes #cursive understand that line as a stacktrace line, then it turns it into a clickable link</z><z id="t1630519825" t="souenzzo"><y>#</y><d>2021-09-01</d><h>18:10</h><r>souenzzo</r></z><z id="t1630519914" t="souenzzo You can also parse/pprint values, but you will need to write a custom appender (in the case of logback) It may bring complexities to compile your project."><y>#</y><d>2021-09-01</d><h>18:11</h><r>souenzzo</r>You can also parse/pprint values, but you will need to write a custom appender (in the case of logback)
It may bring complexities to compile your project.</z><z id="t1630519992" t="souenzzo also, take a look at tap&gt; and &quot;REBL&quot; things, like #reveal and others libs. It may solve your problem in another way"><y>#</y><d>2021-09-01</d><h>18:13</h><r>souenzzo</r>also, take a look at <code>tap&gt;</code> and &quot;REBL&quot; things, like #reveal and others libs.
It may solve your problem in another way</z><z id="t1630522066" t="isak [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Ok nice, I&apos;m also using logback and cursive. So is the pattern able to call arbitrary code?"><y>#</y><d>2021-09-01</d><h>18:47</h><r>isak</r><a>@U2J4FRT2T</a> Ok nice, I&apos;m also using logback and cursive. So is the pattern able to call arbitrary code?</z><z id="t1630522106" t="souenzzo you will need to write a custom appender"><y>#</y><d>2021-09-01</d><h>18:48</h><r>souenzzo</r>you will need to write a custom appender</z><z id="t1630522137" t="isak Yea for tap&gt; I found that really nice to use with cursive. I just added this and it works great for me: ;; Add puget printer for taps (require &apos;[puget.printer]) (let [print-taps-fn (fn [x] (puget.printer/with-options {:width 40 :map-coll-separator :line} (puget.printer/cprint x)))] (add-tap print-taps-fn)) "><y>#</y><d>2021-09-01</d><h>18:48</h><r>isak</r>Yea for tap&gt; I found that really nice to use with cursive. I just added this and it works great for me:
<pre>;; Add puget printer for taps
  (require &apos;[puget.printer])
  (let [print-taps-fn
        (fn [x]
          (puget.printer/with-options
            {:width 40 :map-coll-separator :line}
            (puget.printer/cprint x)))]
    (add-tap print-taps-fn))</pre>
</z><z id="t1630522192" t="isak Ok I may try to write a custom appender that uses puget for the console. Thanks for the help [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2021-09-01</d><h>18:49</h><r>isak</r>Ok I may try to write a custom appender that uses puget for the console. Thanks for the help <a>@U2J4FRT2T</a></z><z id="t1630691454" t="vemv what happens if you saturate the Pedestal &quot;async interceptors&quot; mechanism with more requests than it can handle on time? maybe it blows up at 1024? (as ~usual in core.async systems) is there anything that one can configure?"><y>#</y><d>2021-09-03</d><h>17:50</h><w>vemv</w>what happens if you saturate the Pedestal &quot;async interceptors&quot; mechanism with more requests than it can handle on time?

maybe it blows up at 1024? (as ~usual in core.async systems)

is there anything that one can configure?</z><z id="t1630691567" t="vemv (I guess that I could try out the Pedestal behavior quite quickly... maybe the question is even faster to answer)"><y>#</y><d>2021-09-03</d><h>17:52</h><r>vemv</r>(I guess that I could try out the Pedestal behavior quite quickly... maybe the question is even faster to answer)</z><z id="t1631065458" t="v3ga I’m not sure if I should be asking in here or #hiccup but could someone point me in the right direction for using my “/book/new” route with a standard form via hiccup? I’m rather new to web dev in general as far as dealing with a backend so I’m not sure where i’m goofing. https://gist.github.com/v3gal0g/04eeba0fdf38ea573f49c20ee68c7238"><y>#</y><d>2021-09-08</d><h>01:44</h><w>v3ga</w>I’m not sure if I should be asking in here or #hiccup but  could someone point me in the right direction for using my “/book/new” route with a standard form via hiccup? I’m rather new to web dev in general as far as dealing with a backend so I’m not sure where i’m goofing. <a href="https://gist.github.com/v3gal0g/04eeba0fdf38ea573f49c20ee68c7238" target="_blank">https://gist.github.com/v3gal0g/04eeba0fdf38ea573f49c20ee68c7238</a></z><z id="t1631066011" t="souenzzo • forms will be submited as &quot;url encoded&quot; or &quot;multipart&quot; https://developer.mozilla.org/en-US/docs/Learn/Forms/Sending_and_retrieving_form_data I think that a possible tasklist for you • Make :: insert-book handle form params • Make &quot;/book/new&quot; :get method, that returns a HTML via hiccup • Make the form inside hiccup HTML I didn&apos;t understand what is comlog"><y>#</y><d>2021-09-08</d><h>01:53</h><r>souenzzo</r>• forms will be submited as &quot;url encoded&quot; or &quot;multipart&quot;
<a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Sending_and_retrieving_form_data" target="_blank">https://developer.mozilla.org/en-US/docs/Learn/Forms/Sending_and_retrieving_form_data</a>

I think that a possible tasklist for you
• Make <b>::</b>insert-book handle form params
• Make &quot;/book/new&quot; :get method, that returns a HTML via hiccup
• Make the form inside hiccup HTML

I didn&apos;t understand what is comlog</z><z id="t1631066421" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] yeah thats where i’m goofing. making it handle form params. Right now I can give it a json map via curl/Emacs REST client. I was wondering how to go about sending the data from the form as JSON before I start fooling around with reagent, etc. Comlog is just a creative name i’m using for what will later be a dashboard of sorts."><y>#</y><d>2021-09-08</d><h>02:00</h><r>v3ga</r><a>@U2J4FRT2T</a> yeah thats where i’m goofing.  making it handle form params.  Right now I can give it a json map via curl/Emacs REST client.  I was wondering how to go about sending the data from the form as JSON before I start fooling around with reagent, etc.

Comlog is just a creative name i’m using for what will later be a dashboard of sorts.</z><z id="t1631068271" t="v3ga I sort of see my confusion now. My intention is to post and receive json yet I wanted to experiment with just hiccup first before taking the leap."><y>#</y><d>2021-09-08</d><h>02:31</h><r>v3ga</r>I sort of see my confusion now.  My intention is to post and receive json yet I wanted to experiment with just hiccup first before taking the leap.</z><z id="t1631068271" t="v3ga I sort of see my confusion now. My intention is to post and receive json yet I wanted to experiment with just hiccup first before taking the leap."><y>#</y><d>2021-09-08</d><h>02:31</h><w>v3ga</w>I sort of see my confusion now.  My intention is to post and receive json yet I wanted to experiment with just hiccup first before taking the leap.</z><z id="t1631726622" t="v3ga Can someone explain what’s causing a “Key must be an integer” when attempting to POST on “/iota”? https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/router.clj#L43 https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/journal.clj#L100"><y>#</y><d>2021-09-15</d><h>17:23</h><w>v3ga</w>Can someone explain what’s causing a “Key must be an integer” when attempting to POST on “/iota”?

<a href="https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/router.clj#L43" target="_blank">https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/router.clj#L43</a>
<a href="https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/journal.clj#L100" target="_blank">https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/journal.clj#L100</a></z><z id="t1631727290" t="lispers-anonymous Sounds like something in your code is expecting a vector and not a map. Not sure what without seeing the full exception. It could be this: https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/router.clj#L47 I&apos;m not sure if :post/:get/etc can accept a map with an :interceptors key. I was under the impression you provide an vector of interceptors directly. [&quot;/iota&quot; {... :post [journal/create-iota!]}]]"><y>#</y><d>2021-09-15</d><h>17:34</h><r>lispers-anonymous</r>Sounds like something in your code is expecting a vector and not a map. Not sure what without seeing the full exception.

It could be this: <a href="https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/router.clj#L47" target="_blank">https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/router.clj#L47</a>

I&apos;m not sure if :post/:get/etc can accept a map with an :interceptors key. I was under the impression you provide an vector of interceptors directly.

<pre>[&quot;/iota&quot; {... :post [journal/create-iota!]}]]</pre></z><z id="t1631727638" t="v3ga hmm, not sure if this works. It throws the same error even as :post [journal/create-iota!] https://gist.github.com/v3gal0g/0615877edc8c81feb3e9a54236c53ec3"><y>#</y><d>2021-09-15</d><h>17:40</h><r>v3ga</r>hmm, not sure if this works.    It throws the same error even as :post [journal/create-iota!]

<a href="https://gist.github.com/v3gal0g/0615877edc8c81feb3e9a54236c53ec3" target="_blank">https://gist.github.com/v3gal0g/0615877edc8c81feb3e9a54236c53ec3</a></z><z id="t1631727972" t="lispers-anonymous There is more to read about the terse syntax you are trying to use here: http://pedestal.io/reference/routing-quick-reference#_terse_syntax My original example seems wrong now. This may work [&quot;/iota&quot; {... :post `journal/create-iota!}]] ;; or [&quot;/iota&quot; {... :post [:create-iota `journal/create-iota!]}]] ;; s.t. :create-iota is a name given to this endpoint"><y>#</y><d>2021-09-15</d><h>17:46</h><r>lispers-anonymous</r>There is more to read about the terse syntax you are trying to use here: <a href="http://pedestal.io/reference/routing-quick-reference#_terse_syntax" target="_blank">http://pedestal.io/reference/routing-quick-reference#_terse_syntax</a>

My original example seems wrong now. This may work
<pre>[&quot;/iota&quot; {... :post `journal/create-iota!}]]
;; or
[&quot;/iota&quot; {... :post [:create-iota `journal/create-iota!]}]] ;; s.t. :create-iota is a name given to this endpoint</pre></z><z id="t1631728009" t="lispers-anonymous I don&apos;t think that is your problem though"><y>#</y><d>2021-09-15</d><h>17:46</h><r>lispers-anonymous</r>I don&apos;t think that is your problem though</z><z id="t1631728022" t="lispers-anonymous The exception is being thrown in an interceptor by this name: :io.pedestal.http.secure-headers/secure-headers"><y>#</y><d>2021-09-15</d><h>17:47</h><r>lispers-anonymous</r>The exception is being thrown in an interceptor by this name: <code>:io.pedestal.http.secure-headers/secure-headers</code></z><z id="t1631728138" t="v3ga everything is public if that helps https://github.com/v3gal0g/cybernest-xd/"><y>#</y><d>2021-09-15</d><h>17:48</h><r>v3ga</r>everything is public if that helps <a href="https://github.com/v3gal0g/cybernest-xd/" target="_blank">https://github.com/v3gal0g/cybernest-xd/</a></z><z id="t1631728208" t="lispers-anonymous I see this https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/system.clj#L15-L17"><y>#</y><d>2021-09-15</d><h>17:50</h><r>lispers-anonymous</r>I see this <a href="https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/system.clj#L15-L17" target="_blank">https://github.com/v3gal0g/cybernest-xd/blob/a26dedde3eda6624b3f163c8182bbec53d05f9f0/src/clj/cybernest_xd/system.clj#L15-L17</a></z><z id="t1631728274" t="lispers-anonymous Does it work if you remove that setting? That would indicate that the value of :content-security-policy-settings you have setup is not right."><y>#</y><d>2021-09-15</d><h>17:51</h><r>lispers-anonymous</r>Does it work if you remove that setting? That would indicate that the value of <code>:content-security-policy-settings</code> you have setup is not right.</z><z id="t1631728276" t="v3ga hmmm i’d think that would be fine since swagger and everything works… the error is thrown when I attempt to use/test “/iota” With that said i’m rather weak with both clojure and pedestal here."><y>#</y><d>2021-09-15</d><h>17:51</h><r>v3ga</r>hmmm i’d think that would be fine since swagger and everything works… the error is thrown when I attempt to use/test “/iota”   With that said i’m rather weak with both clojure and pedestal here.</z><z id="t1631728372" t="lispers-anonymous Try to use &quot;default-src &apos;self&apos;; style-src &apos;self&apos; &apos;unsafe-inline&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos;&quot;"><y>#</y><d>2021-09-15</d><h>17:52</h><r>lispers-anonymous</r>Try to use
<pre>&quot;default-src &apos;self&apos;; style-src &apos;self&apos; &apos;unsafe-inline&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos;&quot;</pre></z><z id="t1631728393" t="lispers-anonymous This is the pedestal default for that value: &quot;object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:;&quot;"><y>#</y><d>2021-09-15</d><h>17:53</h><r>lispers-anonymous</r>This is the pedestal default for that value:
<pre>&quot;object-src &apos;none&apos;; script-src &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; &apos;strict-dynamic&apos; https: http:;&quot;</pre></z><z id="t1631728449" t="v3ga lets see…"><y>#</y><d>2021-09-15</d><h>17:54</h><r>v3ga</r>lets see…</z><z id="t1631728605" t="v3ga Hmm I don’t think thats it"><y>#</y><d>2021-09-15</d><h>17:56</h><r>v3ga</r>Hmm I don’t think thats it</z><z id="t1631728708" t="lispers-anonymous What about removing the ::server/secure-headers from your service map and restarting? The error is being thrown when pedestal is trying to build those secure headers so it has to be something related to that"><y>#</y><d>2021-09-15</d><h>17:58</h><r>lispers-anonymous</r>What about removing the <code>::server/secure-headers</code> from your service map and restarting? The error is being thrown when pedestal is trying to build those secure headers so it has to be something related to that</z><z id="t1631728833" t="v3ga for some reason that kills swagger all together"><y>#</y><d>2021-09-15</d><h>18:00</h><r>v3ga</r>for some reason that kills swagger all together</z><z id="t1631728895" t="v3ga yeah that blocks swagger-ui-bundle.js, etc when removed completely"><y>#</y><d>2021-09-15</d><h>18:01</h><r>v3ga</r>yeah that blocks swagger-ui-bundle.js, etc when removed completely</z><z id="t1631729841" t="v3ga Now it works…wth."><y>#</y><d>2021-09-15</d><h>18:17</h><r>v3ga</r>Now it works…wth.</z><z id="t1631729884" t="lispers-anonymous I can&apos;t offer much advice around swagger and pedestal. I&apos;ve not done any real work with the two."><y>#</y><d>2021-09-15</d><h>18:18</h><r>lispers-anonymous</r>I can&apos;t offer much advice around swagger and pedestal. I&apos;ve not done any real work with the two.</z><z id="t1631729952" t="v3ga No worries…it works now but i’m not sure whats changed. So i’ll stop here and check the diffs. Thank you though. I believe the issue was around where you mentioned. Something clearly was off."><y>#</y><d>2021-09-15</d><h>18:19</h><r>v3ga</r>No worries…it works now but i’m not sure whats changed. So i’ll stop here and check the diffs. Thank you though. I believe the issue was around where you mentioned. Something clearly was off.</z><z id="t1631730649" t="vemv In case you appreciate the technique, for cases like these I do as follows: 1.- get a stacktrace 2.- use jump-to-definition 3.- strategically place debugging statements (or (assert) s) across functions described in the stacktrace 4.- take note of the precise place that passed a wrong value and fix it needs a little bit of IDE/editor mastery but it pays off so well"><y>#</y><d>2021-09-15</d><h>18:30</h><r>vemv</r>In case you appreciate the technique, for cases like these I do as follows:

1.- get a stacktrace
2.- use jump-to-definition
3.- strategically place debugging statements (or <code>(assert)</code>s) across functions described in the stacktrace
4.- take note of the precise place that passed a wrong value and fix it

needs a little bit of IDE/editor mastery but it pays off so well</z><z id="t1631731135" t="v3ga [:attrs {:href &quot;/_/_/users/U45T93RA6&quot;}] sounds good, i’ll put that into practice. In this particular case though I’m not sure because it really didn’t seem to give you anywhere to jump to outside of the route I wanted?"><y>#</y><d>2021-09-15</d><h>18:38</h><r>v3ga</r><a>@vemv</a> sounds good, i’ll put that into practice.  In this particular case though I’m not sure because it really didn’t seem to give you anywhere to jump to outside of the route I wanted?</z><z id="t1631733028" t="lispers-anonymous You would have had to jump into the pedestal code itself in this particular case. Your server config was setup, then being interpreted when a request came in, so the original source of the problem was a little difficult to track down."><y>#</y><d>2021-09-15</d><h>19:10</h><r>lispers-anonymous</r>You would have had to jump into the pedestal code itself in this particular case. Your server config was setup, then being interpreted when a request came in, so the original source of the problem was a little difficult to track down.</z><z id="t1631733082" t="lispers-anonymous I would encourage you to look through some of the pedestal code sometime, especially when problems pop up like this. It can be a lot at first, but I usually find it pretty straightforward to read through"><y>#</y><d>2021-09-15</d><h>19:11</h><r>lispers-anonymous</r>I would encourage you to look through some of the pedestal code sometime, especially when problems pop up like this. It can be a lot at first, but I usually find it pretty straightforward to read through</z><z id="t1631739307" t="v3ga [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] yeah I have it saved under favorites to skim through from time to time. I actually stopped and briefly went over basics with ring. I SHOULD spend more time there but I’m a glutton for pain."><y>#</y><d>2021-09-15</d><h>20:55</h><r>v3ga</r><a>@dannyfreeman</a> yeah I have it saved under favorites to skim through from time to time.  I actually stopped and briefly went over basics with ring. I SHOULD spend more time there but I’m a glutton for pain.</z><z id="t1631729841" t="v3ga Now it works…wth."><y>#</y><d>2021-09-15</d><h>18:17</h><w>v3ga</w>Now it works…wth.</z><z id="t1631731135" t="v3ga [:attrs {:href &quot;/_/_/users/U45T93RA6&quot;}] sounds good, i’ll put that into practice. In this particular case though I’m not sure because it really didn’t seem to give you anywhere to jump to outside of the route I wanted?"><y>#</y><d>2021-09-15</d><h>18:38</h><w>v3ga</w><a>@vemv</a> sounds good, i’ll put that into practice.  In this particular case though I’m not sure because it really didn’t seem to give you anywhere to jump to outside of the route I wanted?</z><z id="t1631736391" t="Ben Hammond I am running pedestal/ion-provider to support a direct http ion. I am trying to debug the CORS :io.pedestal.http/allowed-origins configuration and I am therefore interested in the log output written by (log/info :msg &quot;cors request processing&quot; :origin origin :allowed allowed) but I cannot seem to find it in cloudwatch logs; https://docs.datomic.com/cloud/ions/ions-monitoring.html#java-logging seems to imply that log/info just doesn&apos;t get written to cloudwatch events; is that true? would I normally expect the http-direct logs to be written direction into the datomic loggroup?"><y>#</y><d>2021-09-15</d><h>20:06</h><w>Ben Hammond</w>I am running <code>pedestal/ion-provider</code> to support a direct http ion. I am trying to debug the CORS <code>:io.pedestal.http/allowed-origins</code> configuration and I am therefore interested in the log output written by
<pre>(log/info :msg &quot;cors request processing&quot;
                                      :origin origin
                                      :allowed allowed)</pre>
but I cannot seem to find it in cloudwatch logs;

<a href="https://docs.datomic.com/cloud/ions/ions-monitoring.html#java-logging" target="_blank">https://docs.datomic.com/cloud/ions/ions-monitoring.html#java-logging</a>
seems to imply that <code>log/info</code> just doesn&apos;t get written to cloudwatch events; is that true?

would I normally expect the http-direct logs to be written direction into the <code>datomic</code> loggroup?</z><z id="t1631739307" t="v3ga [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] yeah I have it saved under favorites to skim through from time to time. I actually stopped and briefly went over basics with ring. I SHOULD spend more time there but I’m a glutton for pain."><y>#</y><d>2021-09-15</d><h>20:55</h><w>v3ga</w><a>@dannyfreeman</a> yeah I have it saved under favorites to skim through from time to time.  I actually stopped and briefly went over basics with ring. I SHOULD spend more time there but I’m a glutton for pain.</z><z id="t1631798275" t="finchharold Hi all, can someone guide me to an example for http://pedestal.io/reference/streaming ?"><y>#</y><d>2021-09-16</d><h>13:17</h><w>finchharold</w>Hi all, can someone guide me to an example for <a href="http://pedestal.io/reference/streaming" target="_blank">http://pedestal.io/reference/streaming</a>?</z><z id="t1631799184" t="souenzzo [:attrs {:href &quot;/_/_/users/U01MCFSB8Q2&quot;}] If you do (with-open [w (io/writer &quot;out.json&quot;)] (json/write (repeat 1e8 {:hello &quot;world&quot;}) w)) you should end up with a out.json with ~1.7Gb¹ Sometimes you need to read/write things that are larger than your memory (Xmx, in JVM case) For example, if you want to send (repeat 1e9 {:hello &quot;world&quot;}) as a JSON in a HTTP response. 1e9 with a simple and imprecise math should take ~10Gb of memory If you try :body (json/write-str (repeat 1e9 {:hello &quot;world&quot;})) , it will probably run out-of-memory, because it will try to allocate a 10Gb string all at once You can switch to streamed responses To do that, you can use :body (fn [out] (json/write (repeat 1e9 {:hello &quot;world&quot;}) (io/writer out))) . This is a &quot;Streaming&quot; approach. It should work in a simple 500Mb machine. Another option, if your 10Gb JSON file is already saved in your disk, you can do :body (io/file &quot;out.json&quot;) or :body (io/input-steram &quot;out.json&quot;) To go async, you will need to return something like (go (assoc ctx :response {:body my-chan})) , then (dotimes [i 1e9] (async/&gt;! my-chan {:hello &quot;World&quot;})) ¹ This value may be different in your machine due disk blocks and other resource allocation things"><y>#</y><d>2021-09-16</d><h>13:33</h><w>souenzzo</w><a>@kishorekaranam99</a>
If you do
<pre>(with-open [w (io/writer &quot;out.json&quot;)]
  (json/write
    (repeat 1e8 {:hello &quot;world&quot;})
    w))</pre>
you should end up with a <code>out.json</code> with ~1.7Gb¹
Sometimes you need to read/write things that are larger than your memory (Xmx, in JVM case)
For example, if you want to send <code>(repeat 1e9 {:hello &quot;world&quot;})</code> as a JSON in a HTTP response.
<code>1e9</code> with a simple and imprecise math should take ~10Gb of memory
If you try <code>:body (json/write-str (repeat 1e9 {:hello &quot;world&quot;}))</code>, it will probably run out-of-memory, because it will try to allocate a 10Gb string all at once

You can switch to streamed responses
To do that, you can use <code>:body (fn [out] (json/write (repeat 1e9 {:hello &quot;world&quot;}) (io/writer out)))</code>. This is a &quot;Streaming&quot; approach. It should work in a simple 500Mb machine.

Another option, if your 10Gb JSON file is already saved in your disk, you can do <code>:body (io/file &quot;out.json&quot;)</code> or <code>:body (io/input-steram &quot;out.json&quot;)</code>

To go async, you will need to return something like <code>(go (assoc ctx :response {:body my-chan}))</code>, then <code>(dotimes [i 1e9] (async/&gt;! my-chan {:hello &quot;World&quot;}))</code>

¹ This value may be different in your machine due disk blocks and other resource allocation things</z><z id="t1631800295" t="simongray What is the point of the dev-interceptors ? I recently needed to circumvent CORS during development and I thought maybe the dev-interceptors might be the way to do it, since it adds an interceptor called dev-allow-origin , but all that interceptor does is delete the origin header from the request…? This doesn’t actually allow cross-origin requests AFAIK. It turns out that the real solution to allowing cross-origin requests during development is to set the :io.pedestal.http/allowed-origins key to (constantly true) (…or I guess to manually add an interceptor that sets the Access-Control-Allow-Origin header to * )."><y>#</y><d>2021-09-16</d><h>13:51</h><w>simongray</w>What is the point of the <code>dev-interceptors</code> ? I recently needed to circumvent CORS during development and I thought maybe the <code>dev-interceptors</code> might be the way to do it, since it  adds an interceptor called <code>dev-allow-origin</code>, but all that interceptor does is delete the origin header from the request…? This doesn’t actually allow cross-origin requests AFAIK.

It turns out that the real solution to allowing cross-origin requests during development is to set the <code>:io.pedestal.http/allowed-origins</code> key to <code>(constantly true)</code>  (…or I guess to manually add an interceptor that sets the <code>Access-Control-Allow-Origin</code> header to <code>*</code>).</z><z id="t1631813593" t="lispers-anonymous dev-interceptors also includes a generic error handler that will return information about any unhanded exception in the response body. I find that to be useful during development. I can&apos;t speak to the dev-allow-origin interceptor."><y>#</y><d>2021-09-16</d><h>17:33</h><r>lispers-anonymous</r>dev-interceptors also includes a generic error handler that will return information about any unhanded exception in the response body. I find that to be useful during development. I can&apos;t speak to the dev-allow-origin interceptor.</z><z id="t1631800643" t="Fredrik The way I read the code, an empty &quot;origin&quot; header is passed through the CORS checker"><y>#</y><d>2021-09-16</d><h>13:57</h><w>Fredrik</w>The way I read the code, an empty <code>&quot;origin&quot;</code> header is passed through the CORS checker</z><z id="t1631800669" t="Fredrik Have you tested it out?"><y>#</y><d>2021-09-16</d><h>13:57</h><w>Fredrik</w>Have you tested it out?</z><z id="t1631800718" t="simongray There’s no need, since I fixed it? In order to get a non-empty response in a modern browser you need to set Access-Control-Allow-Originn . The dev-interceptors do not do this."><y>#</y><d>2021-09-16</d><h>13:58</h><w>simongray</w>There’s no need, since I fixed it? In order to get a non-empty response in a modern browser you need to set <code>Access-Control-Allow-Originn</code>. The <code>dev-interceptors</code> do not do this.</z><z id="t1631800760" t="simongray I was just commenting on the fact that this piece of code seemingly hasn’t kept up with modern browser policy."><y>#</y><d>2021-09-16</d><h>13:59</h><w>simongray</w>I was just commenting on the fact that this piece of code seemingly hasn’t kept up with modern browser policy.</z><z id="t1631800867" t="simongray I just think that the dev-allow-origin interceport should set this header and it doesn’t do that. That would be my expectation."><y>#</y><d>2021-09-16</d><h>14:01</h><w>simongray</w>I just think that the <code>dev-allow-origin</code> interceport should set this header and it doesn’t do that. That would be my expectation.</z><z id="t1631801053" t="Fredrik I see your point now, the problem is not that the request doesn&apos;t complete server-side, it&apos;s that the browser requires this header on the response"><y>#</y><d>2021-09-16</d><h>14:04</h><w>Fredrik</w>I see your point now, the problem is not that the request doesn&apos;t complete server-side, it&apos;s that the browser requires this header on the response</z><z id="t1631801152" t="simongray Yeah. If you don’t set Access-Control-Allow-Origin the JS or CLJS app making the request will simply get back an empty 200 response. If you CURL the same resource it works fine, because CURL isn’t a web browser and doesn’t care about CORS."><y>#</y><d>2021-09-16</d><h>14:05</h><w>simongray</w>Yeah. If you don’t set <code>Access-Control-Allow-Origin</code> the JS or CLJS app making the request will simply get back an empty 200 response. If you CURL the same resource it works fine, because CURL isn’t a web browser and doesn’t care about CORS.</z><z id="t1631813654" t="lispers-anonymous Sounds like a great issue to open in the pedestal repo."><y>#</y><d>2021-09-16</d><h>17:34</h><w>lispers-anonymous</w>Sounds like a great issue to open in the pedestal repo.</z><z id="t1632926210" t="enn Is there any way to stop Pedestal from capturing *out* ?"><y>#</y><d>2021-09-29</d><h>14:36</h><w>enn</w>Is there any way to stop Pedestal from capturing <code>*out*</code> ?</z><z id="t1633087084" t="simongray How to do I make a catch-all/not-found route? I.e. one that doesn’t cancel out the other routes. When I was using Compojure it was as simple as &quot;*&quot; while making sure that the route was the last to be defined. Then the SPA gets served in the same HTML/JS blob and the frontend routing in the single-page app would basically take over."><y>#</y><d>2021-10-01</d><h>11:18</h><w>simongray</w>How to do I make a catch-all/not-found route? I.e. one that doesn’t cancel out the other routes. When I was using Compojure it was as simple as <code>&quot;*&quot;</code> while making sure that the route was the last to be defined. Then the SPA gets served in the same HTML/JS blob and the frontend routing in the single-page app would basically take over.</z><z id="t1633087318" t="simongray With Pedestal it seems like you need separation into separate paths, e.g. /app and /api for this work…? And if you want both /app and /app/* to work you will need to make two separate routes. Is that the case?"><y>#</y><d>2021-10-01</d><h>11:21</h><w>simongray</w>With Pedestal it seems like you need separation into separate paths, e.g. <code>/app</code> and <code>/api</code> for this work…? And if you want both <code>/app</code> and <code>/app/*</code> to work you will need to make two separate routes. Is that the case?</z><z id="t1633088274" t="simongray I basically need all of this to get it to work and it’s still less elegant than Compojure since it forces me to use “/app” as a the root rather than “/”: [&quot;/&quot; :get redirect :route-name ::root] [&quot;/app&quot; :get single-page-app :route-name ::app] [&quot;/app/*&quot; :get single-page-app :route-name ::app-path]"><y>#</y><d>2021-10-01</d><h>11:37</h><w>simongray</w>I basically need all of this to get it to work and it’s still less elegant than Compojure since it forces me to use “/app” as a the root rather than “/”:
<pre>[&quot;/&quot; :get redirect :route-name ::root]
[&quot;/app&quot; :get single-page-app :route-name ::app]
[&quot;/app/*&quot; :get single-page-app :route-name ::app-path]</pre></z><z id="t1633095307" t="emccue There isn&apos;t a way with pedestal&apos;s routing - but what you can do is use interceptors for this"><y>#</y><d>2021-10-01</d><h>13:35</h><w>emccue</w>There isn&apos;t a way with pedestal&apos;s routing - but what you can do is use interceptors for this</z><z id="t1633095393" t="emccue ;; ---------------------------------------------------------------------------- (def serve-spa-on-404 &quot;Intercepts any unhandled get requests and serves the SPA.&quot; {:leave (fn [context] (if (and (not (http/response? (:response context))) (= :get (:request-method (:request context)))) (assoc context :response {:status 200 :headers {&quot;Content-Type&quot; &quot;text/html&quot;} :body (page/html5 {:lang &quot;en&quot;} [:html [:head [:meta {:charset &quot;UTF-8&quot;}] [:style &quot;body { padding: 0; margin: 0; }&quot;]] [:body [:div {:id &quot;mount&quot;}] [:script {:type &quot;text/javascript&quot;} (-&gt; (io/resource &quot;public/app.js&quot;) ;; TODO: Cache (slurp))] [:script {:type &quot;text/javascript&quot;} &quot;var app = Elm.Main.init({node: document.getElementById(&apos;mount&apos;)});&quot;]]])}) context))})"><y>#</y><d>2021-10-01</d><h>13:36</h><w>emccue</w><pre>;; ----------------------------------------------------------------------------
(def serve-spa-on-404
  &quot;Intercepts any unhandled get requests and serves the SPA.&quot;
  {:leave
   (fn [context]
     (if (and (not (http/response? (:response context)))
              (= :get (:request-method (:request context))))
       (assoc
         context
         :response
         {:status 200
          :headers {&quot;Content-Type&quot; &quot;text/html&quot;}
          :body
          (page/html5
            {:lang &quot;en&quot;}
            [:html
             [:head
              [:meta {:charset &quot;UTF-8&quot;}]
              [:style &quot;body { padding: 0; margin: 0; }&quot;]]
             [:body
              [:div {:id &quot;mount&quot;}]
              [:script {:type &quot;text/javascript&quot;} (-&gt; (io/resource &quot;public/app.js&quot;) ;; TODO: Cache
                                                     (slurp))]
              [:script {:type &quot;text/javascript&quot;}
               &quot;var app = Elm.Main.init({node: document.getElementById(&apos;mount&apos;)});&quot;]]])})
       context))})</pre></z><z id="t1633095426" t="emccue if you went through the interceptor chain and didn&apos;t produce a response"><y>#</y><d>2021-10-01</d><h>13:37</h><w>emccue</w>if you went through the interceptor chain and didn&apos;t produce a response</z><z id="t1633095432" t="emccue and its a get request\"><y>#</y><d>2021-10-01</d><h>13:37</h><w>emccue</w>and its a get request\</z><z id="t1633095443" t="emccue then you serve your JS"><y>#</y><d>2021-10-01</d><h>13:37</h><w>emccue</w>then you serve your JS</z><z id="t1633099766" t="simongray Ah, interesting approach [:attrs {:href &quot;/_/_/users/U3JH98J4R&quot;}] . Thanks for including the code 🙂"><y>#</y><d>2021-10-01</d><h>14:49</h><w>simongray</w>Ah, interesting approach <a>@emccue</a>. Thanks for including the code <b>🙂</b></z><z id="t1633367731" t="v3ga What would be a good way to go about handling multiple response formats? I’m working on a sort of CMS so I have a view thats private, meant only for the content creator which works as an SPA… though my public view i’d like to generate server side with hiccup. What’s a good way to think about or deal with this? Should I just create separate /api/ routes meant for the creator or is there a cleaner approach I can take?"><y>#</y><d>2021-10-04</d><h>17:15</h><w>v3ga</w>What would be a good way to go about handling multiple response formats?  I’m working on a sort of CMS so I have a view thats private, meant only for the content creator which works as an SPA… though my public view i’d like to generate server side with hiccup. What’s a good way to think about or deal with this? Should I just create separate /api/ routes meant for the creator or is there a cleaner approach I can take?</z><z id="t1633516305" t="hanDerPeder sounds like you’re talking about content negotiation. http://pedestal.io/api/pedestal.service/io.pedestal.http.content-negotiation.html"><y>#</y><d>2021-10-06</d><h>10:31</h><w>hanDerPeder</w>sounds like you’re talking about content negotiation. <a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.content-negotiation.html" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.content-negotiation.html</a></z><z id="t1633543326" t="v3ga Yeah I believe so. I think my question is more architecture based opposed to pedestal but that is indeed what I&apos;m after. I&apos;ll take a look and I&apos;m still trying to decide how I&apos;m going to handle this. I&apos;m looking to both create static pages and more dynamic pages. "><y>#</y><d>2021-10-06</d><h>18:02</h><r>v3ga</r>Yeah I believe so.  I think my question is more architecture based opposed to pedestal but that is indeed what I&apos;m after. I&apos;ll take a look and I&apos;m still trying to decide how I&apos;m going to handle this.  I&apos;m looking to both create static pages and more dynamic pages.  </z><z id="t1633618020" t="simongray What I do is just use the built-in Pedestal interceptor for content negotation. Then I have a map of content-type-&gt;body-fn for the endpoint in question which is used by the handler (and the keys of the map are used by the content-negotiation interceptor). The endpoint then just creates content based on the negotiated content type."><y>#</y><d>2021-10-07</d><h>14:47</h><r>simongray</r>What I do is just use the built-in Pedestal interceptor for content negotation. Then I have a map of <code>content-type-&gt;body-fn</code> for the endpoint in question which is used by the handler (and the keys of the map are used by the content-negotiation interceptor). The endpoint then just creates content based on the negotiated content type.</z><z id="t1633618121" t="simongray Here’s what it looks like: https://github.com/kuhumcst/glossematics/blob/feature/meeting-prep-2/src/dk/cst/glossematics/backend/files.clj#L37-L78"><y>#</y><d>2021-10-07</d><h>14:48</h><r>simongray</r>Here’s what it looks like: <a href="https://github.com/kuhumcst/glossematics/blob/feature/meeting-prep-2/src/dk/cst/glossematics/backend/files.clj#L37-L78" target="_blank">https://github.com/kuhumcst/glossematics/blob/feature/meeting-prep-2/src/dk/cst/glossematics/backend/files.clj#L37-L78</a></z><z id="t1633669024" t="v3ga Exactly what I wanted. I was also wondering if this could be done using multimethods in some way. I was watching a video on Clojurescript and that popped into my mind as a possible solution. Newbie thoughts…. But yes you&apos;re doing exactly what I want. I&apos;m over engineering a cms and from my view the page will be fairly dynamic but I&apos;d like to create static pages server side as well. "><y>#</y><d>2021-10-08</d><h>04:57</h><r>v3ga</r>Exactly what I wanted.  I was also wondering if this could be done using multimethods in some way. I was watching a video on Clojurescript and that popped into my mind as a possible solution. Newbie thoughts…. But yes you&apos;re doing exactly what I want.  I&apos;m over engineering a cms and from my view the page will be fairly dynamic but I&apos;d like to create static pages server side as well. </z><z id="t1633863376" t="simongray Glad I could help. Yup, multi-methods can be used too, but personally I rarely use them since I prefer simpler things such as maps. I guess if you nee extensibility, multi-methods are the better choice."><y>#</y><d>2021-10-10</d><h>10:56</h><r>simongray</r>Glad I could help. Yup, multi-methods can be used too, but personally I rarely use them since I prefer simpler things such as maps. I guess if you nee extensibility, multi-methods are the better choice.</z><z id="t1633516364" t="hanDerPeder there is a guide: http://pedestal.io/guides/hello-world-content-types"><y>#</y><d>2021-10-06</d><h>10:32</h><w>hanDerPeder</w>there is a guide: <a href="http://pedestal.io/guides/hello-world-content-types" target="_blank">http://pedestal.io/guides/hello-world-content-types</a></z><z id="t1633669024" t="v3ga Exactly what I wanted. I was also wondering if this could be done using multimethods in some way. I was watching a video on Clojurescript and that popped into my mind as a possible solution. Newbie thoughts…. But yes you&apos;re doing exactly what I want. I&apos;m over engineering a cms and from my view the page will be fairly dynamic but I&apos;d like to create static pages server side as well. "><y>#</y><d>2021-10-08</d><h>04:57</h><w>v3ga</w>Exactly what I wanted.  I was also wondering if this could be done using multimethods in some way. I was watching a video on Clojurescript and that popped into my mind as a possible solution. Newbie thoughts…. But yes you&apos;re doing exactly what I want.  I&apos;m over engineering a cms and from my view the page will be fairly dynamic but I&apos;d like to create static pages server side as well. </z><z id="t1633818082" t="Marcus is pedestal still under active development?"><y>#</y><d>2021-10-09</d><h>22:21</h><w>Marcus</w>is pedestal still under active development?</z><z id="t1633827671" t="souenzzo No but if you find some but we can fix it"><y>#</y><d>2021-10-10</d><h>01:01</h><r>souenzzo</r>No but if you find some but we can fix it</z><z id="t1633950169" t="simongray It’s in maintenance mode, basically: https://github.com/pedestal/pedestal/commits/master"><y>#</y><d>2021-10-11</d><h>11:02</h><r>simongray</r>It’s in maintenance mode, basically: <a href="https://github.com/pedestal/pedestal/commits/master" target="_blank">https://github.com/pedestal/pedestal/commits/master</a></z><z id="t1633952032" t="Marcus Ok. Thanks!"><y>#</y><d>2021-10-11</d><h>11:33</h><r>Marcus</r>Ok. Thanks!</z><z id="t1634045963" t="Neil Ashton [:attrs {:href &quot;/_/_/users/US3KUG0JZ&quot;}] : the company I work for (Kevel) includes engineers who work on Pedestal; concerning the status of the project, one of them said: &gt; The current Pedestal is stable and will be released as Pedestal 1.0. Pedestal2 is in active development and we’ll be moving it to a public branch soon"><y>#</y><d>2021-10-12</d><h>13:39</h><r>Neil Ashton</r><a>@US3KUG0JZ</a>: the company I work for (Kevel) includes engineers who work on Pedestal; concerning the status of the project, one of them said:

&gt; The current Pedestal is stable and will be released as Pedestal 1.0. Pedestal2 is in active development and we’ll be moving it to a public branch soon</z><z id="t1634049624" t="simongray Oh, that’s interesting."><y>#</y><d>2021-10-12</d><h>14:40</h><r>simongray</r>Oh, that’s interesting.</z><z id="t1634049681" t="simongray I guess we can ping [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] directly…?"><y>#</y><d>2021-10-12</d><h>14:41</h><r>simongray</r>I guess we can ping <a>@U0FL657GR</a>directly…?</z><z id="t1634053180" t="Ivan I&apos;ve also seen hints about Pedestal2, but I don&apos;t think the development is public"><y>#</y><d>2021-10-12</d><h>15:39</h><r>Ivan</r>I&apos;ve also seen hints about Pedestal2, but I don&apos;t think the development is public</z><z id="t1634053284" t="Ivan iirc, &quot;Pedestal2&quot; came up when ring-2 was about to be released and there was a discussion on performance and a mention comparing it with Pedestal2"><y>#</y><d>2021-10-12</d><h>15:41</h><r>Ivan</r>iirc, &quot;Pedestal2&quot; came up when ring-2 was about to be released and there was a discussion on performance and a mention comparing it with Pedestal2</z><z id="t1634106744" t="Marcus Very nice to know about the upcoming v2 🙂 Thanks!"><y>#</y><d>2021-10-13</d><h>06:32</h><r>Marcus</r>Very nice to know about  the upcoming v2 <b>🙂</b> Thanks!</z><z id="t1634231819" t="ddeaguiar Pedestal is being maintained but the pace of change has slowed because we’re currently in maintenance mode. I’ve not been actively checking this channel as of late, though."><y>#</y><d>2021-10-14</d><h>17:16</h><r>ddeaguiar</r>Pedestal is being maintained but the pace of change has slowed because we’re currently in maintenance mode. I’ve not been actively checking this channel as of late, though.</z><z id="t1634172867" t="fabrao is there any way to turn off the pedestal org.eclipse.jetty Debug messages from timbre?"><y>#</y><d>2021-10-14</d><h>00:54</h><w>fabrao</w>is there any way to turn off the pedestal <code>org.eclipse.jetty</code> Debug messages from timbre?</z><z id="t1634172930" t="fabrao I tried using com.fzakaria/slf4j-timbre and use :ns-blacklist [&quot;org.eclipse.jetty.*&quot; &quot;io.pedestal.*&quot; &quot;com.walmartlabs.lacinia.*&quot;] but it didn´t work"><y>#</y><d>2021-10-14</d><h>00:55</h><w>fabrao</w>I tried using <code>com.fzakaria/slf4j-timbre</code> and use <code>:ns-blacklist [&quot;org.eclipse.jetty.*&quot; &quot;io.pedestal.*&quot; &quot;com.walmartlabs.lacinia.*&quot;]</code> but it didn´t work</z><z id="t1634551444" t="Ivar Refsdal What version of timbre and slf4j-timbre are you using? :ns-blacklist is deprecated? I am using :min-level like so: {:min-level [[#{&quot;*&quot;} :info] [#{&quot;*&quot;} :warn]]} for passing to timbre 5.1.0 and using slf4j-timbre 0.3.20"><y>#</y><d>2021-10-18</d><h>10:04</h><r>Ivar Refsdal</r>What version of timbre and slf4j-timbre are you using?
<code>:ns-blacklist</code> is deprecated?

I am using <code>:min-level</code> like so:
<pre>{:min-level       [[#{&quot;*&quot;} :info]
                                       [#{&quot;*&quot;} :warn]]}</pre>
for passing to timbre 5.1.0
and using slf4j-timbre 0.3.20</z><z id="t1634551452" t="Ivar Refsdal which works fine"><y>#</y><d>2021-10-18</d><h>10:04</h><r>Ivar Refsdal</r>which works fine</z><z id="t1636333350" t="ghaskins I ran into a problem where the recent log back-classic broke, resulting in slf4j based Java code, like jetty and Kafka disregarding timbre whitelists"><y>#</y><d>2021-11-08</d><h>01:02</h><r>ghaskins</r>I ran into a problem where the recent log back-classic broke, resulting in slf4j based Java code, like jetty and Kafka disregarding timbre whitelists</z><z id="t1636333404" t="ghaskins The solution is to remove the exclusion on logback-classic for the API, then all is well"><y>#</y><d>2021-11-08</d><h>01:03</h><r>ghaskins</r>The solution is to remove the exclusion on logback-classic for the API, then all is well</z><z id="t1636333417" t="ghaskins Not sure this is same issue as you are facing"><y>#</y><d>2021-11-08</d><h>01:03</h><r>ghaskins</r>Not sure this is same issue as you are facing</z><z id="t1634180684" t="v3ga Can someone point me in the right direction. I’m trying to send a POST from my client and earlier today I did manage to send my :post field and get it to save to the database. At the moment that’s not working and i’m trying to figure out what’s going on and if this is an issue with my backend or frontend(both)? https://gist.github.com/v3gal0g/273cf964b423bfd7719d05d0722e058b"><y>#</y><d>2021-10-14</d><h>03:04</h><w>v3ga</w>Can someone point me in the right direction. I’m trying to send a POST from my client and earlier today I did manage to send my :post field and get it to save to the database.  At the moment that’s not working and i’m trying to figure out what’s going on and if this is an issue with my backend or frontend(both)?

<a href="https://gist.github.com/v3gal0g/273cf964b423bfd7719d05d0722e058b" target="_blank">https://gist.github.com/v3gal0g/273cf964b423bfd7719d05d0722e058b</a></z><z id="t1634180829" t="v3ga The response is nil, I see that. But i’m confused as hell because it did indeed write to my DB earlier. Now it triggers the creation of an empty row so I at least know it’s hitting that route properly, i’m just not catching the data."><y>#</y><d>2021-10-14</d><h>03:07</h><w>v3ga</w>The response is nil, I see that. But i’m confused as hell because it did indeed write to my DB earlier. Now it triggers the creation of an empty row so I at least know it’s hitting that route properly, i’m just not catching the data.</z><z id="t1634190110" t="Lennart Buit Your log contains an exception. So presumably something goes wrong in your handler / pedestal ends up down the error functions of your interceptors "><y>#</y><d>2021-10-14</d><h>05:41</h><r>Lennart Buit</r>Your log contains an exception. So presumably something goes wrong in your handler / pedestal ends up down the error functions of your interceptors </z><z id="t1634190265" t="Lennart Buit The exception says you are calling a map (which is legit), but don’t end up passing arguments. I think that’s somewhere else (as in, not in your gist)"><y>#</y><d>2021-10-14</d><h>05:44</h><r>Lennart Buit</r>The exception says you are calling a map (which is legit), but don’t end up passing arguments. I think that’s somewhere else (as in, not in your gist)</z><z id="t1634190393" t="Lennart Buit (This is allowed: ({:a 1} :a) , but this is not ({:a 1}) )"><y>#</y><d>2021-10-14</d><h>05:46</h><r>Lennart Buit</r>(This is allowed: <code>({:a 1} :a)</code>, but this is not <code>({:a 1})</code>)</z><z id="t1634190427" t="v3ga Hmm, I do have the project public. Oh! That ghetto hack to pass in the architect id huh? https://github.com/v3gal0g/cybernest-xd"><y>#</y><d>2021-10-14</d><h>05:47</h><r>v3ga</r>Hmm, I do have the project public.  Oh! That ghetto hack to pass in the architect id huh? <a href="https://github.com/v3gal0g/cybernest-xd" target="_blank">https://github.com/v3gal0g/cybernest-xd</a></z><z id="t1634224541" t="souenzzo On pedestal context we can find &quot;content-type&quot; &quot;application/transit+json&quot; Is it really transit? If it is transit, you should access :transit-params (that is nil, in this case) If is not transit, you shuold use content-type application/json You probably will solve this on the client. The server looks fine"><y>#</y><d>2021-10-14</d><h>15:15</h><r>souenzzo</r>On pedestal context we can find &quot;content-type&quot; &quot;application/transit+json&quot;
Is it really transit? If it is transit, you should access <code>:transit-params</code> (that is nil, in this case)
If is not transit, you shuold use content-type application/json
You probably will solve this on the client. The server looks fine</z><z id="t1634224657" t="souenzzo This should fix (defn send-message! [fields] (-&gt; (js/fetch &quot;/iots&quot; #js{:method &quot;POST&quot; :headers #js {&quot;content-type&quot; &quot;application/json&quot;} :body (js/JSON.strinfigy (clj-&gt;js @fields))}) (.then (fn [res] (.json res))) (.then #(.log js/console (str &quot;response: &quot; %))) (.catch #(.error js/console (str &quot;error: &quot; %)))))"><y>#</y><d>2021-10-14</d><h>15:17</h><r>souenzzo</r>This should fix
<pre>(defn send-message! [fields]
  (-&gt; (js/fetch &quot;/iots&quot;
        #js{:method  &quot;POST&quot;
            :headers #js {&quot;content-type&quot; &quot;application/json&quot;}
            :body    (js/JSON.strinfigy (clj-&gt;js @fields))})
    (.then (fn [res] (.json res)))
    (.then #(.log js/console (str &quot;response: &quot; %)))
    (.catch #(.error js/console (str &quot;error: &quot; %)))))</pre></z><z id="t1634224947" t="souenzzo I have a small reagent+pedestal didactic project, with just ~300 LOC It uses JSON to communicate in the API, really similar to your setup. I&apos;m still writing the tutorial (it is incomplete) but it serves as a reference 🙂 https://github.com/souenzzo/atemoia"><y>#</y><d>2021-10-14</d><h>15:22</h><r>souenzzo</r>I have a small reagent+pedestal didactic project, with just ~300 LOC
It uses JSON to communicate in the API, really similar to your setup.
I&apos;m still writing the tutorial (it is incomplete) but it serves as a reference <b>🙂</b>
<a href="https://github.com/souenzzo/atemoia" target="_blank">https://github.com/souenzzo/atemoia</a></z><z id="t1634225960" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] Thanks! Taking a look now… yeah i’m just now learning how to read the output and noticed I was trying to access something that doesn’t exist."><y>#</y><d>2021-10-14</d><h>15:39</h><r>v3ga</r><a>@U2J4FRT2T</a> Thanks! Taking a look now…  yeah i’m just now learning how to read the output and noticed I was trying to access something that doesn’t exist.</z><z id="t1634226036" t="v3ga js/fetch is really interesting. I’ve never seen that before. That’s preferred over cljs-ajax?"><y>#</y><d>2021-10-14</d><h>15:40</h><r>v3ga</r>js/fetch is really interesting. I’ve never seen that before.  That’s preferred over cljs-ajax?</z><z id="t1634226511" t="souenzzo I really like the browser API&apos;s. I (personally) don&apos;t see many value in these &quot;magical easy ajax libraries&quot; https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API"><y>#</y><d>2021-10-14</d><h>15:48</h><r>souenzzo</r>I really like the browser API&apos;s. I (personally) don&apos;t see many value in these &quot;magical easy ajax libraries&quot;
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank">https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API</a></z><z id="t1634226575" t="v3ga Yeah, I won’t argue that. I’m just now starting to learn JS so I know what’s actually going on. I’ll adopt this practice."><y>#</y><d>2021-10-14</d><h>15:49</h><r>v3ga</r>Yeah, I won’t argue that.  I’m just now starting to learn JS so I know what’s actually going on. I’ll adopt this practice.</z><z id="t1634227740" t="souenzzo feel free to send me any questions 🙂"><y>#</y><d>2021-10-14</d><h>16:09</h><r>souenzzo</r>feel free to send me any questions <b>🙂</b></z><z id="t1634227792" t="Lennart Buit Mdn is your friend in learning browser tech (html/css/js + stdlib)"><y>#</y><d>2021-10-14</d><h>16:09</h><r>Lennart Buit</r>Mdn is your friend in learning browser tech (html/css/js + stdlib)</z><z id="t1634229957" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] will do"><y>#</y><d>2021-10-14</d><h>16:45</h><r>v3ga</r><a>@U2J4FRT2T</a> will do</z><z id="t1634522349" t="v3ga Ok sorry, I still have some confusion. I’m able to write to the database now from my client but it still throws a 500 and complains. What am I missing there because my map definitely is getting passed in to insert-iota https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/db.clj#L133 clojure.lang.ExceptionInfo: clojure.lang.ArityException in Interceptor :cybernest-xd.db/insert-iota - Wrong number of args (0) passed to: clojure.lang.PersistentHashMap"><y>#</y><d>2021-10-18</d><h>01:59</h><r>v3ga</r>Ok sorry, I still have some confusion. I’m able to write to the database now from my client but it still throws a 500 and complains. What am I missing there because my map definitely is getting passed in to insert-iota

<a href="https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/db.clj#L133" target="_blank">https://github.com/v3gal0g/cybernest-xd/blob/main/src/clj/cybernest_xd/db.clj#L133</a>

<code>clojure.lang.ExceptionInfo: clojure.lang.ArityException in Interceptor :cybernest-xd.db/insert-iota - Wrong number of args (0) passed to: clojure.lang.PersistentHashMap</code></z><z id="t1634556271" t="souenzzo This error: `Wrong number of args (0) passed to: clojure.lang.PersistentHashMap db.clj` Is always result of something like (m) or (apply m []) where m is a hash-map I think that in this case, is related to the #spy/p"><y>#</y><d>2021-10-18</d><h>11:24</h><r>souenzzo</r>This error:
`Wrong number of args (0) passed to: clojure.lang.PersistentHashMap
db.clj`
Is always result of something like <code>(m)</code> or <code>(apply m [])</code> where <code>m</code> is a <code>hash-map</code>

I think that in this case, is related to the #spy/p</z><z id="t1634557863" t="v3ga [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] wow, that absolutely was it… thank you!"><y>#</y><d>2021-10-18</d><h>11:51</h><r>v3ga</r><a>@U2J4FRT2T</a> wow, that absolutely was it… thank you!</z><z id="t1635334778" t="pooriaTaj curl: (7) Failed to connect to 0.0.0.0 port 8822: Connection refused I am hosting a pedestal on a docker image in a remote server , I have mapped the ports in the container and set my host ip to 0.0.0.0 but cannot initiate a curl call any solution ?"><y>#</y><d>2021-10-27</d><h>11:39</h><w>pooriaTaj</w>curl: (7) Failed to connect to 0.0.0.0 port 8822: Connection refused
I am hosting a pedestal on a docker image in a remote server , I have mapped the ports in the container and set my host ip to 0.0.0.0 but cannot initiate a curl call any solution ?</z><z id="t1635351311" t="richiardiandrea Hi there, has anybody tried to debug pedestal handlers? By debug I mean use, for instance, the Cider debugger. I have noticed that that does not work here and I was wondering if there is any trick I need to employ (like using vars for the routes?)"><y>#</y><d>2021-10-27</d><h>16:15</h><w>richiardiandrea</w>Hi there, has anybody tried to debug pedestal handlers? By debug I mean use, for instance, the Cider debugger.

I have noticed that that does not work here and I was wondering if there is any trick I need to employ (like using vars for the routes?)</z><z id="t1635358197" t="vemv I&apos;m not much of a debugger person but perhaps sneaking https://github.com/gfredericks/debug-repl into interceptor execution would be workable? (although not as sophisticated as cider)"><y>#</y><d>2021-10-27</d><h>18:09</h><r>vemv</r>I&apos;m not much of a debugger person but perhaps sneaking <a href="https://github.com/gfredericks/debug-repl" target="_blank">https://github.com/gfredericks/debug-repl</a> into interceptor execution would be workable?

(although not as sophisticated as cider)</z><z id="t1635363699" t="richiardiandrea yeah but I am sure there is a way, just was wondering if somebody already tried 😄"><y>#</y><d>2021-10-27</d><h>19:41</h><r>richiardiandrea</r>yeah but I am sure there is a way, just was wondering if somebody already tried <b>😄</b></z><z id="t1635426148" t="Ben Halton hi there, I&apos;m trying to do a fairly basic demo of some SSE with pedestal. I think I&apos;m missing something obvious. I&apos;ve tried the demo here: http://pedestal.io/reference/server-sent-events and it &quot;works&quot; in that I see the events in the client. But in order to make that happen I need to close the event-chan which doesn&apos;t really make sense to me? I was hoping to keep the event-chan as a long running pipe for events which would get picked up on the client."><y>#</y><d>2021-10-28</d><h>13:02</h><w>Ben Halton</w>hi there, I&apos;m trying to do a fairly basic demo of some SSE with pedestal. I think I&apos;m missing something obvious. I&apos;ve tried the demo here: <a href="http://pedestal.io/reference/server-sent-events" target="_blank">http://pedestal.io/reference/server-sent-events</a> and it &quot;works&quot; in that I see the events in the client. But in order to make that happen I need to close the <code>event-chan</code> which doesn&apos;t really make sense to me? I was hoping to keep the event-chan as a long running pipe for events which would get picked up on the client.</z><z id="t1635426174" t="Ben Halton I need a way to &quot;flush&quot; the channel to the client without closing the chan"><y>#</y><d>2021-10-28</d><h>13:02</h><w>Ben Halton</w>I need a way to &quot;flush&quot; the channel to the client without closing the chan</z><z id="t1635426364" t="Ben Halton or maybe I&apos;m doing something dim on the client to cause that ?"><y>#</y><d>2021-10-28</d><h>13:06</h><w>Ben Halton</w>or maybe I&apos;m doing something dim on the client to cause that ?</z><z id="t1635428638" t="Ben Halton well I&apos;ve spent some time looking at the client side and I don&apos;t think it&apos;s that"><y>#</y><d>2021-10-28</d><h>13:43</h><w>Ben Halton</w>well I&apos;ve spent some time looking at the client side and I don&apos;t think it&apos;s that</z><z id="t1635463222" t="Fredrik Are you running this demo: https://github.com/pedestal/pedestal/tree/master/samples/server-sent-events ? You are indeed supposed to be able to keep the event-channel open for as long as you need it. When using SSE a separate dispatch loop starts piping from the event-channel to the client, so something strange is going on if you need to close the event-channel for this to happen."><y>#</y><d>2021-10-28</d><h>23:20</h><w>Fredrik</w>Are you running this demo: <a href="https://github.com/pedestal/pedestal/tree/master/samples/server-sent-events" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/server-sent-events</a>?  You are indeed supposed to be able to keep the event-channel open for as long as you need it. When using SSE a separate dispatch loop starts piping from the event-channel to the client, so something strange is going on if you need to close the event-channel for this to happen.</z><z id="t1635493328" t="Ben Halton I&apos;m not running that example but I&apos;ll try it today. I&apos;ve worked through the pedestal code and can see what should be happening - the events are written to the stream but seemingly not &quot;flushed&quot; through to the client"><y>#</y><d>2021-10-29</d><h>07:42</h><w>Ben Halton</w>I&apos;m not running that example but I&apos;ll try it today. I&apos;ve worked through the pedestal code and can see what should be happening - the events are written to the stream but seemingly not &quot;flushed&quot; through to the client</z><z id="t1635493517" t="Fredrik If you want you could try share your code and we could try to figure out what&apos;s going on"><y>#</y><d>2021-10-29</d><h>07:45</h><w>Fredrik</w>If you want you could try share your code and we could try to figure out what&apos;s going on</z><z id="t1635497440" t="Ben Halton thanks I appreciate that - I&apos;m afk today mainly but will do so :thumbsup: :skin-tone-2:"><y>#</y><d>2021-10-29</d><h>08:50</h><w>Ben Halton</w>thanks I appreciate that - I&apos;m afk today mainly but will do so <b>:thumbsup:</b><b>:skin-tone-2:</b></z><z id="t1635593680" t="Ben Halton so having a look at this today and the example above works - we think it is because we have gzip configured and this causes issues with SSE"><y>#</y><d>2021-10-30</d><h>11:34</h><w>Ben Halton</w>so having a look at this today and the example above works - we think it is because we have gzip configured and this causes issues with SSE</z><z id="t1635605477" t="Ben Halton quick update - yes excluding gzip from that route makes it work"><y>#</y><d>2021-10-30</d><h>14:51</h><w>Ben Halton</w>quick update - yes excluding gzip from that route makes it work</z><z id="t1635793174" t="sova-soars-the-sora Hi, I have a function throw an error and I reckon that my error-interceptor is the one that gets the last say on what happens. Are there idiomatic or preferred ways to have the error-interceptor return a particular {:body &quot;&quot; :status 200} for errors that are anticipated?"><y>#</y><d>2021-11-01</d><h>18:59</h><w>sova-soars-the-sora</w>Hi, I have a function <code>throw</code> an error and I reckon that my <code>error-interceptor</code> is the one that gets the last say on what happens.  Are there idiomatic or preferred ways to have the <code>error-interceptor</code> return a particular <code>{:body &quot;&quot; :status 200}</code> for errors that are anticipated?</z><z id="t1635794883" t="Fredrik You can have a look at the error-dispatch interceptor: https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/test/io/pedestal/interceptor/error_test.clj"><y>#</y><d>2021-11-01</d><h>19:28</h><r>Fredrik</r>You can have a look at the <code>error-dispatch</code> interceptor: <a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/test/io/pedestal/interceptor/error_test.clj" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/test/io/pedestal/interceptor/error_test.clj</a></z><z id="t1635795420" t="Fredrik In your case, it sounds like your error-interceptor should either process the exception by returning (assoc ctx :response {:body &quot;&quot; :status 200}) , or signal that it can&apos;t by returning (assoc ctx :error ex) ."><y>#</y><d>2021-11-01</d><h>19:37</h><r>Fredrik</r>In your case, it sounds like your <code>error-interceptor</code> should either process the exception by returning <code>(assoc ctx :response {:body &quot;&quot; :status 200})</code>, or signal that it can&apos;t by returning <code>(assoc ctx :error ex)</code>.</z><z id="t1635797277" t="sova-soars-the-sora Okay cool, I will try that. ty"><y>#</y><d>2021-11-01</d><h>20:07</h><r>sova-soars-the-sora</r>Okay cool, I will try that.  ty</z><z id="t1635799901" t="sova-soars-the-sora Pedestal addresses this by catching all exceptions thrown from an interceptor. It wraps the exception in an ExceptionInfo instance which is then bound to the :io.pedestal.interceptor.chain/error key in the context map. As long as there is an error attached to that key, Pedestal will not invoke the usual :enter and :leave functions. Instead, it looks for the next interceptor in the chain that has a :error function attached to it. So there&apos;s :enter :leave and also :error I want to return a 200 on a certain &quot;error&quot; but I&apos;m still having a little trouble sussing out how"><y>#</y><d>2021-11-01</d><h>20:51</h><r>sova-soars-the-sora</r><pre>Pedestal addresses this by catching all exceptions thrown from an interceptor. It wraps the exception in an ExceptionInfo instance which is then bound to the :io.pedestal.interceptor.chain/error key in the context map.

As long as there is an error attached to that key, Pedestal will not invoke the usual :enter and :leave functions. Instead, it looks for the next interceptor in the chain that has a :error function attached to it.</pre>

So there&apos;s <code>:enter</code> <code>:leave</code> and also <code>:error</code>

I want to return a 200 on a certain &quot;error&quot; but I&apos;m still having a little trouble sussing out how</z><z id="t1635803818" t="Fredrik You&apos;ll want to enqueue an interceptor high enough up in the chain to catch any potential errors. This interceptor only needs an :error function"><y>#</y><d>2021-11-01</d><h>21:56</h><r>Fredrik</r>You&apos;ll want to enqueue an interceptor high enough up in the chain to catch any potential errors. This interceptor only needs an <code>:error</code> function</z><z id="t1635803866" t="Fredrik This function has only one responsibility: Given a context and an exception, either handle the exception or pass it on"><y>#</y><d>2021-11-01</d><h>21:57</h><r>Fredrik</r>This function has only one responsibility: Given a context and an exception, either handle the exception or pass it on</z><z id="t1635804047" t="Fredrik I think it&apos;s important to understand that when an error is thrown, the rest of the enqueued interceptors are dropped, and we start going up the stack of previously visited interceptors. Maybe the documentation doesn&apos;t make this 100% clear."><y>#</y><d>2021-11-01</d><h>22:00</h><r>Fredrik</r>I think it&apos;s important to understand that when an error is thrown, the rest of the enqueued interceptors are dropped, and we start going up the stack of previously visited interceptors. Maybe the documentation doesn&apos;t make this 100% clear.</z><z id="t1635804087" t="Fredrik If you want to share some code we can walk through this together 🙂"><y>#</y><d>2021-11-01</d><h>22:01</h><r>Fredrik</r>If you want to share some code we can walk through this together <b>🙂</b></z><z id="t1635805066" t="sova-soars-the-sora I think it makes sense, I would have preferred a graphical explanation 😅"><y>#</y><d>2021-11-01</d><h>22:17</h><r>sova-soars-the-sora</r>I think it makes sense, I would have preferred a graphical explanation <b>😅</b></z><z id="t1635806576" t="sova-soars-the-sora Oh hey, I figured it out."><y>#</y><d>2021-11-01</d><h>22:42</h><r>sova-soars-the-sora</r>Oh hey, I figured it out.</z><z id="t1635806637" t="sova-soars-the-sora I really appreciate you taking the time to point me in the right direction. I was close but I needed a better understanding of ex-info and catching it in the right interceptor (we have 2 error interceptors, for different endpoints)"><y>#</y><d>2021-11-01</d><h>22:43</h><r>sova-soars-the-sora</r>I really appreciate you taking the time to point me in the right direction.  I was close but I needed a better understanding of <code>ex-info</code> and catching it in the right interceptor (we have 2 error interceptors, for different endpoints)</z><z id="t1635848752" t="Fahd El Mazouni Hi ! did anyone have to deal with websocket auth on pedestal with jetty ? chrome doesn&apos;t put any cookies on the upgrade request and I have no idea how to make it do that. I really want to avoid putting the session cookie in websocket request query string. any help would be much appreciated"><y>#</y><d>2021-11-02</d><h>10:25</h><w>Fahd El Mazouni</w>Hi ! did anyone have to deal with websocket auth on pedestal with jetty ? chrome doesn&apos;t put any cookies on the upgrade request and I have no idea how to make it do that. I really want to avoid putting the session cookie in websocket request query string.
any help would be much appreciated</z><z id="t1635849394" t="thumbnail It seems common to just send the auth string as the first message on the socket, and close the socket when the client isn&apos;t authenticated"><y>#</y><d>2021-11-02</d><h>10:36</h><r>thumbnail</r>It seems common to just send the auth string as the first message on the socket, and close the socket when the client isn&apos;t authenticated</z><z id="t1636164843" t="souenzzo Where I can learn more about pedestal2 https://github.com/pedestal/pedestal/issues/666#issuecomment-961791163 ?"><y>#</y><d>2021-11-06</d><h>02:14</h><w>souenzzo</w>Where I can learn more about pedestal2 <a href="https://github.com/pedestal/pedestal/issues/666#issuecomment-961791163" target="_blank">https://github.com/pedestal/pedestal/issues/666#issuecomment-961791163</a> ?</z><z id="t1636317609" t="andrewhr The gist can be found here https://github.com/pedestal/pedestal/issues/693#issuecomment-961862883 Following that thread Paul mentions plans for sharing documentation and prototype-quality code. "><y>#</y><d>2021-11-07</d><h>20:40</h><r>andrewhr</r>The gist can be found here <a href="https://github.com/pedestal/pedestal/issues/693#issuecomment-961862883" target="_blank">https://github.com/pedestal/pedestal/issues/693#issuecomment-961862883</a>

Following that thread Paul mentions plans for sharing documentation and prototype-quality code. </z><z id="t1636378171" t="dangercoder i am getting hyped"><y>#</y><d>2021-11-08</d><h>13:29</h><r>dangercoder</r>i am getting hyped</z><z id="t1636564683" t="sova-soars-the-sora Hi, I have some interceptors that add some helpful logging data to requests, but I notice that when an error is thrown it short-circuits to the error-interceptor. How can I make sure my logging methods hit every request even when there&apos;s an error in the chain?"><y>#</y><d>2021-11-10</d><h>17:18</h><w>sova-soars-the-sora</w>Hi, I have some interceptors that add some helpful logging data to requests, but I notice that when an error is thrown it short-circuits to the error-interceptor.  How can I make sure my logging methods hit every request even when there&apos;s an error in the chain?</z><z id="t1636567781" t="sova-soars-the-sora Annd nevermind 😄"><y>#</y><d>2021-11-10</d><h>18:09</h><w>sova-soars-the-sora</w>Annd nevermind <b>😄</b></z><z id="t1636567792" t="sova-soars-the-sora thanks for standing by at the ready, gents"><y>#</y><d>2021-11-10</d><h>18:09</h><w>sova-soars-the-sora</w>thanks for standing by at the ready, gents</z><z id="t1636635045" t="simongray Did anybody here ever write a language negotiation interceptor/rewrite the content negotiation interceptor to support languages? i.e. https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language"><y>#</y><d>2021-11-11</d><h>12:50</h><w>simongray</w>Did anybody here ever write a language negotiation interceptor/rewrite the content negotiation interceptor to support languages? i.e. <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language</a></z><z id="t1636654667" t="Fredrik The argument :content-param-paths specifies where to look for the &quot;Accept&quot; header. If you set it to [:request :headers &quot;accept-language&quot;] , and change this line to store the negotiation result in the correct place, you should be good. https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/content_negotiation.clj#L186"><y>#</y><d>2021-11-11</d><h>18:17</h><w>Fredrik</w>The argument <code>:content-param-paths</code> specifies where to look for the &quot;Accept&quot; header. If you set it to <code>[:request :headers &quot;accept-language&quot;]</code> , and change this line to store the negotiation result in the correct place, you should be good. <a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/content_negotiation.clj#L186" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/content_negotiation.clj#L186</a></z><z id="t1636712156" t="simongray [:attrs {:href &quot;/_/_/users/U024X3V2YN4&quot;}] Thanks! I wasn’t expecting it to be to be this simple. So I gather that the content-type negotiation logic is the same as for language negotiation?"><y>#</y><d>2021-11-12</d><h>10:15</h><w>simongray</w><a>@frwdrik</a> Thanks! I wasn’t expecting it to be to be this simple. So I gather that the content-type negotiation logic is the same as for language negotiation?</z><z id="t1636712772" t="Fredrik According to that link you mentioned, the &quot;Accept-Languge&quot; header uses https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation"><y>#</y><d>2021-11-12</d><h>10:26</h><w>Fredrik</w>According to that link you mentioned, the &quot;Accept-Languge&quot; header uses <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation" target="_blank">https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation</a></z><z id="t1636713239" t="Fredrik Listed on that page is several &quot;Accept-*&quot; headers that the server can negotiate on. But I believe it ultimately is up to the server to choose exactly which negotiation strategy it wants to use. For Apache, check out https://httpd.apache.org/docs/current/en/content-negotiation.html#algorithm"><y>#</y><d>2021-11-12</d><h>10:33</h><w>Fredrik</w>Listed on that page is several &quot;Accept-*&quot; headers that the server can
negotiate on. But I believe it ultimately is up to the server to choose exactly which negotiation strategy it wants to use. For Apache, check out <a href="https://httpd.apache.org/docs/current/en/content-negotiation.html#algorithm" target="_blank">https://httpd.apache.org/docs/current/en/content-negotiation.html#algorithm</a></z><z id="t1636713558" t="Fredrik But in short, yes, using the same negotiation logic should be fine 🙂"><y>#</y><d>2021-11-12</d><h>10:39</h><w>Fredrik</w>But in short, yes, using the same negotiation logic should be fine <b>🙂</b></z><z id="t1636713743" t="Fredrik The io.pedestal.http.content-negotiation also mentions it has public functions &quot;to allow others to build custom accept-* handling (language, charset, etc.)&quot;"><y>#</y><d>2021-11-12</d><h>10:42</h><w>Fredrik</w>The <code>io.pedestal.http.content-negotiation</code> also mentions it has public functions &quot;to allow others to build custom accept-* handling (language, charset, etc.)&quot;</z><z id="t1636807790" t="simongray Thanks, a lot [:attrs {:href &quot;/_/_/users/U024X3V2YN4&quot;}] . This is so helpful."><y>#</y><d>2021-11-13</d><h>12:49</h><w>simongray</w>Thanks, a lot <a>@frwdrik</a>. This is so helpful.</z><z id="t1636853483" t="Fredrik You&apos;re welcome, I learnt new stuff too!"><y>#</y><d>2021-11-14</d><h>01:31</h><w>Fredrik</w>You&apos;re welcome, I learnt new stuff too!</z><z id="t1637138526" t="simongray So, curiously, even though the documentation kinda lets on that you can reuse negotiate-content for other kinds of negotiation, e.g. language, in practice it is completely hardcoded to content-type. I ended up making my own interceptor and reusing the parsing functions: (defn -&gt;language-negotiation-ic &quot;Make a language negotiation interceptor from a coll of `supported-languages`. The interceptor reuses Pedestal&apos;s content-negotiation logic, but unlike the included content negotiation interceptor this one does not create a 406 response if no match is found.&quot; [supported-languages] (let [match-fn (conneg/best-match-fn supported-languages) lang-paths [[:request :headers &quot;accept-language&quot;] [:request :headers :accept-language]]] {:name ::negotiate-language :enter (fn [ctx] (if-let [accept-param (loop [[path &amp; paths] lang-paths] (if-let [param (get-in ctx path)] param (when (not-empty paths) (recur paths))))] (if-let [language (-&gt;&gt; (conneg/parse-accept-* accept-param) (conneg/best-match match-fn))] (assoc-in ctx [:request :accept-language] language) ctx) ctx))}))"><y>#</y><d>2021-11-17</d><h>08:42</h><w>simongray</w>So, curiously, even though the documentation kinda lets on that you can reuse <code>negotiate-content</code> for other kinds of negotiation, e.g. language, in practice it is completely hardcoded to content-type. I ended up making my own interceptor and reusing the parsing functions:

<pre>(defn -&gt;language-negotiation-ic
  &quot;Make a language negotiation interceptor from a coll of `supported-languages`.

  The interceptor reuses Pedestal&apos;s content-negotiation logic, but unlike the
  included content negotiation interceptor this one does not create a 406
  response if no match is found.&quot;
  [supported-languages]
  (let [match-fn   (conneg/best-match-fn supported-languages)
        lang-paths [[:request :headers &quot;accept-language&quot;]
                    [:request :headers :accept-language]]]
    {:name  ::negotiate-language
     :enter (fn [ctx]
              (if-let [accept-param (loop [[path &amp; paths] lang-paths]
                                      (if-let [param (get-in ctx path)]
                                        param
                                        (when (not-empty paths)
                                          (recur paths))))]
                (if-let [language (-&gt;&gt; (conneg/parse-accept-* accept-param)
                                       (conneg/best-match match-fn))]
                  (assoc-in ctx [:request :accept-language] language)
                  ctx)
                ctx))}))</pre></z><z id="t1637147460" t="Fredrik yes, the negotiate-content function itself is hard-coded, but like you&apos;ve done here, the io.pedestal.content-negotiation has smaller functions you can use to make your own negotiation."><y>#</y><d>2021-11-17</d><h>11:11</h><w>Fredrik</w>yes, the <code>negotiate-content</code> function itself is hard-coded, but like you&apos;ve done here, the <code>io.pedestal.content-negotiation</code> has smaller functions you can use to make your own negotiation.</z><z id="t1637258039" t="richiardiandrea Hi there, does anybody use integrant with pedestal? I am curious to know what the suspend-key! loooks like, if any 😄"><y>#</y><d>2021-11-18</d><h>17:53</h><w>richiardiandrea</w>Hi there, does anybody use integrant with pedestal? I am curious to know what the <code>suspend-key!</code> loooks like, if any <b>😄</b></z><z id="t1637279867" t="isak yea, but we don&apos;t use suspend-key"><y>#</y><d>2021-11-18</d><h>23:57</h><w>isak</w>yea, but we don&apos;t use suspend-key</z><z id="t1637686641" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] thanks, how do you handle the reset ? cause that would not call halt-key but will call init-key again and your server will try to bind again to its host"><y>#</y><d>2021-11-23</d><h>16:57</h><w>richiardiandrea</w><a>@isak</a> thanks, how do you handle the <code>reset</code>? cause that would not call <code>halt-key</code> but will call <code>init-key</code> again and your server will try to bind again to its host</z><z id="t1637687638" t="isak [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] ig/halt-key! does get called for me. You are using integrant.repl/reset , right?"><y>#</y><d>2021-11-23</d><h>17:13</h><r>isak</r><a>@U0C8489U6</a> <code>ig/halt-key!</code>  does get called for me. You are using <code>integrant.repl/reset</code>, right?</z><z id="t1637687700" t="isak So then I just call http/stop on the server returned from http/start and it works"><y>#</y><d>2021-11-23</d><h>17:15</h><r>isak</r>So then I just call <code>http/stop</code> on the server returned from <code>http/start</code> and it works</z><z id="t1637687762" t="isak Maybe it doesn&apos;t call halt if you have a suspend defined?"><y>#</y><d>2021-11-23</d><h>17:16</h><r>isak</r>Maybe it doesn&apos;t call halt if you have a suspend defined?</z><z id="t1637703748" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] yeah for some reason halt did not get call here, I am not sure why - I might need to try again if you say so"><y>#</y><d>2021-11-23</d><h>21:42</h><r>richiardiandrea</r><a>@isak</a> yeah for some reason halt did not get call here, I am not sure why - I might need to try again if you say so</z><z id="t1637778043" t="richiardiandrea You are right halt-key is hit, I might have had problems with variable redefinition at the REPL"><y>#</y><d>2021-11-24</d><h>18:20</h><r>richiardiandrea</r>You are right <code>halt-key</code> is hit, I might have had problems with variable redefinition at the REPL</z><z id="t1639099283" t="Proctor Pedestal Interceptors design history question, was there a consideration for a :finally /`:always` type of function that would be invoked after :error or :leave to focus specifically on clean-up of “opened” resources (e.g. db connection, file io, etc)? I know it could be covered by using the same function reference for both the :error and :leave key, but that potentially complects resource clean-up with error handling / post processing, compared to adding complexity/overhead on another exit path through the interceptor"><y>#</y><d>2021-12-10</d><h>01:21</h><w>Proctor</w>Pedestal Interceptors design history question, was there a consideration for a <code>:finally</code>/`:always` type of function that would be invoked after <code>:error</code> or <code>:leave</code> to focus specifically on clean-up of “opened” resources (e.g. db connection, file io, etc)? I know it could be covered by using the same function reference for both the <code>:error</code> and <code>:leave</code> key, but that potentially complects resource clean-up with error handling / post processing, compared to adding complexity/overhead on another exit path through the interceptor</z><z id="t1639099411" t="Proctor Looking at Pedestal interceptor inspired processing in places that are not HTTP request based processing"><y>#</y><d>2021-12-10</d><h>01:23</h><r>Proctor</r>Looking at Pedestal interceptor inspired processing in places that are not HTTP request based processing</z><z id="t1639220748" t="orestis PSA: if you&apos;re using pedestal and log4j then you are vulnerable to the recently announced log4j vulnerability, since pedestal will log the path of a GET request. "><y>#</y><d>2021-12-11</d><h>11:05</h><w>orestis</w>PSA: if you&apos;re using pedestal and log4j then you are vulnerable to the recently announced log4j vulnerability, since pedestal will log the path of a GET request. </z><z id="t1639405577" t="ddeaguiar Based on http://slf4j.org/log4shell.html SLF4J It looks like if you use Logback you are ok. Pedestal services created through the service template use Logback."><y>#</y><d>2021-12-13</d><h>14:26</h><r>ddeaguiar</r>Based on <a href="http://slf4j.org/log4shell.html" target="_blank">http://slf4j.org/log4shell.html</a> SLF4J It looks like if you use Logback you are ok. Pedestal services created through the  service template use Logback.</z><z id="t1639421018" t="orestis We switched recently from logback to log4j (can&apos;t remember the reasons any more) but luckily we patched everything before the floodgates opened"><y>#</y><d>2021-12-13</d><h>18:43</h><r>orestis</r>We switched recently from logback to log4j (can&apos;t remember the reasons any more) but luckily we patched everything before the floodgates opened</z><z id="t1639405577" t="ddeaguiar Based on http://slf4j.org/log4shell.html SLF4J It looks like if you use Logback you are ok. Pedestal services created through the service template use Logback."><y>#</y><d>2021-12-13</d><h>14:26</h><w>ddeaguiar</w>Based on <a href="http://slf4j.org/log4shell.html" target="_blank">http://slf4j.org/log4shell.html</a> SLF4J It looks like if you use Logback you are ok. Pedestal services created through the  service template use Logback.</z><z id="t1639577900" t="Ben Hammond what is the idiomatic way to get an absolute URL out of url-for ? I can cobble somethings together by picking bits of of the context, but I imagine there might be a nicer way I&apos;ve just not found it out"><y>#</y><d>2021-12-15</d><h>14:18</h><w>Ben Hammond</w>what is the idiomatic way to get an absolute URL out of <code>url-for</code> ?
I can cobble somethings together by picking bits of of the context,
but I imagine there might be a nicer way
I&apos;ve just not found it out</z><z id="t1639584772" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] ! url-for takes the same options as url-for-routes . You can pass the option :absolute? true to get an absolute url. Example: (io.pedestal.route/url-for ::home-page :absolute? true)"><y>#</y><d>2021-12-15</d><h>16:12</h><r>ddeaguiar</r>Hi <a>@U793EL04V</a>! <code>url-for</code> takes the same options as <code>url-for-routes</code> . You can pass the option <code>:absolute? true</code> to get an absolute url. Example:

<pre>(io.pedestal.route/url-for ::home-page :absolute? true)</pre></z><z id="t1639586128" t="Ben Hammond perfect. Thankyou"><y>#</y><d>2021-12-15</d><h>16:35</h><r>Ben Hammond</r>perfect.
Thankyou</z><z id="t1640790530" t="zoad 👋 I have a Pedestal app running on a Jetty server with HTTP/2 enabled. From the server, I would like to send a GOAWAY HTTP/2 data frame to the client to make the client open a new connection, but I didn&apos;t find a way to send HTTP/2 data frames from the server to the client. Do you know how can I do it?"><y>#</y><d>2022-12-29</d><h>15:08</h><w>zoad</w><b>👋</b> I have a Pedestal app running on a Jetty server with HTTP/2 enabled. From the server, I would like to send a GOAWAY HTTP/2 data frame to the client to make the client open a new connection, but I didn&apos;t find a way to send HTTP/2 data frames from the server to the client. Do you know how can I do it?</z><z id="t1641904659" t="maxt Hi! Can I make pedestal use a redefined handler without any reload? With ring and jetty, I used to refer to the handler with #&apos;handler and then it dynamically uses the latest version. Can I achieve something similar with (http/start (http/create-server …}} ?"><y>#</y><d>2022-01-11</d><h>12:37</h><w>maxt</w>Hi! Can I make pedestal use a redefined handler without any reload?

With ring and jetty, I used to refer to the handler with <code>#&apos;handler</code>  and then it dynamically uses the latest version. Can I achieve something similar with <code>(http/start (http/create-server …}}</code>?</z><z id="t1641914784" t="vemv Perhaps it&apos;s this line? https://github.com/pedestal/pedestal/blob/97ff368b64325b24d78a200205282cdc93e0d7a6/service-template/src/leiningen/new/pedestal_service/server.clj#L21"><y>#</y><d>2022-01-11</d><h>15:26</h><r>vemv</r>Perhaps it&apos;s this line? <a href="https://github.com/pedestal/pedestal/blob/97ff368b64325b24d78a200205282cdc93e0d7a6/service-template/src/leiningen/new/pedestal_service/server.clj#L21" target="_blank">https://github.com/pedestal/pedestal/blob/97ff368b64325b24d78a200205282cdc93e0d7a6/service-template/src/leiningen/new/pedestal_service/server.clj#L21</a></z><z id="t1641914842" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0773UB6D&quot;}] What do you mean by &quot;without any reload&quot;? If you&apos;re using the service template then, when developing locally and using run-dev you can change your handler implementation and evaluate it in the repl to see the change take effect."><y>#</y><d>2022-01-11</d><h>15:27</h><r>ddeaguiar</r><a>@maxt</a> What do you mean by &quot;without any reload&quot;? If you&apos;re using the service template then, when developing locally and using <code>run-dev</code> you can change your handler implementation and evaluate it in the repl to see the change take effect.</z><z id="t1641914894" t="ddeaguiar the pedestal service-tools library provides a couple of helper fns which watch for changes and load them for you as well"><y>#</y><d>2022-01-11</d><h>15:28</h><r>ddeaguiar</r>the pedestal <code>service-tools</code> library provides a couple of helper fns which watch for changes and load them for you as well</z><z id="t1641915095" t="maxt Supplying :: http/routes as a function worked perfectly."><y>#</y><d>2022-01-11</d><h>15:31</h><r>maxt</r>Supplying <b>::</b>http/routes as a function worked perfectly.</z><z id="t1641915149" t="maxt I was following the http://pedestal.io/guides/hello-world tutorial and didn’t use run-dev"><y>#</y><d>2022-01-11</d><h>15:32</h><r>maxt</r>I was following the <a href="http://pedestal.io/guides/hello-world" target="_blank">http://pedestal.io/guides/hello-world</a> tutorial and didn’t use run-dev</z><z id="t1641915179" t="maxt But thank you all for all your pointers"><y>#</y><d>2022-01-11</d><h>15:32</h><r>maxt</r>But thank you all for all your pointers</z><z id="t1641914697" t="orestis [:attrs {:href &quot;/_/_/users/U0773UB6D&quot;}] yes, for handlers that go at the end of an interceptor chain, but not for interceptors themselves (I think). If you have some current code that&apos;s not behaving as expected please share."><y>#</y><d>2022-01-11</d><h>15:24</h><w>orestis</w><a>@maxt</a> yes, for handlers that go at the end of an interceptor chain, but not for interceptors themselves (I think). If you have some current code that&apos;s not behaving as expected please share.</z><z id="t1641914842" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U0773UB6D&quot;}] What do you mean by &quot;without any reload&quot;? If you&apos;re using the service template then, when developing locally and using run-dev you can change your handler implementation and evaluate it in the repl to see the change take effect."><y>#</y><d>2022-01-11</d><h>15:27</h><w>ddeaguiar</w><a>@maxt</a> What do you mean by &quot;without any reload&quot;? If you&apos;re using the service template then, when developing locally and using <code>run-dev</code> you can change your handler implementation and evaluate it in the repl to see the change take effect.</z><z id="t1641915095" t="maxt Supplying :: http/routes as a function worked perfectly."><y>#</y><d>2022-01-11</d><h>15:31</h><w>maxt</w>Supplying <b>::</b>http/routes as a function worked perfectly.</z><z id="t1642203165" t="jyriand Hello. Probably a question that has been asked multiple times. But how can I serve index.html on my / path? Right now i have to type /index.html to view it"><y>#</y><d>2022-01-14</d><h>23:32</h><w>jyriand</w>Hello. Probably a question that has been asked multiple times. But how can I serve <code>index.html</code> on my <code>/</code> path? Right now i have to type <code>/index.html</code> to view it</z><z id="t1642214657" t="emccue add a route that will serve the contents of the file when the url matches “/”"><y>#</y><d>2022-01-15</d><h>02:44</h><w>emccue</w>add a route that will serve the contents of the file when the url matches “/”</z><z id="t1642236003" t="hanDerPeder fast-resource does this: https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/ring_middlewares.clj#L148"><y>#</y><d>2022-01-15</d><h>08:40</h><w>hanDerPeder</w>fast-resource does this: <a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/ring_middlewares.clj#L148" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http/ring_middlewares.clj#L148</a></z><z id="t1642244112" t="jyriand This is how i got it working, but it doesn&apos;t seem like a reasonable solution (defn get-homepage [request] {:status 200 :body (slurp (io/file &quot;resources/public/index.html&quot;)) :headers {&quot;Content-Type&quot; &quot;text/html&quot;}}) Tried also with fast-resource but I might be missing something, because it doesn&apos;t work [&quot;/&quot; :get [(fast-resource &quot;public&quot;)] :route-name :index] I have defined the resource-path ::http/resource-path &quot;public&quot; "><y>#</y><d>2022-01-15</d><h>10:55</h><w>jyriand</w>This is how i got it working, but it doesn&apos;t seem like a reasonable solution
<pre>(defn get-homepage [request]
  {:status 200
   :body (slurp (io/file &quot;resources/public/index.html&quot;))
   :headers {&quot;Content-Type&quot; &quot;text/html&quot;}})</pre>
Tried also  with <code>fast-resource</code> but I might be missing something, because it doesn&apos;t work
<pre>[&quot;/&quot; :get [(fast-resource &quot;public&quot;)] :route-name :index]</pre>
I have defined the <code>resource-path</code>
<pre>::http/resource-path  &quot;public&quot;</pre>
</z><z id="t1643103818" t="v3ga did you add “resources” to :paths in your deps.edn?"><y>#</y><d>2022-01-25</d><h>09:43</h><r>v3ga</r>did you add “resources” to :paths in your deps.edn?</z><z id="t1642267232" t="hanDerPeder I think your supposed to put the resource interceptor in your interceptor chain before your router. Thats how I do it at least. "><y>#</y><d>2022-01-15</d><h>17:20</h><w>hanDerPeder</w>I think your supposed to put the resource interceptor in your interceptor chain before your router. Thats how I do it at least. </z><z id="t1642267361" t="hanDerPeder https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http.clj#L265"><y>#</y><d>2022-01-15</d><h>17:22</h><w>hanDerPeder</w><a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http.clj#L265" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/service/src/io/pedestal/http.clj#L265</a></z><z id="t1642757382" t="FiVo Hey, asking a #vase question. I have messed up a schema update, can I just rollback or do I need to explicitly retract/rename things? Or does it depend on the changes? Are the semantics of an schema update essentially the same as for datomic standalone?"><y>#</y><d>2022-01-21</d><h>09:29</h><w>FiVo</w>Hey, asking a #vase question. I have messed up a schema update, can I just rollback or do I need to explicitly retract/rename things? Or does it depend on the changes? Are the semantics of an schema update essentially the same as for datomic standalone?</z><z id="t1642793424" t="orestis I&apos;ve opened an issue regarding setting the user field on an AWS Xray segment: https://github.com/pedestal/pedestal/issues/701 -- just FYI. I can probably figure out a workaround but I wanted to capture this for the future. I&apos;ve no idea about OpenTracing or tracing in general, but I could try to offer a PR for this."><y>#</y><d>2022-01-21</d><h>19:30</h><w>orestis</w>I&apos;ve opened an issue regarding setting the <code>user</code> field on an AWS Xray segment: <a href="https://github.com/pedestal/pedestal/issues/701" target="_blank">https://github.com/pedestal/pedestal/issues/701</a> -- just FYI. I can probably figure out a workaround but I wanted to capture this for the future. I&apos;ve no idea about OpenTracing or tracing in general, but I could try to offer a PR for this.</z><z id="t1643057999" t="zyxmn hello, trying the pedestal tutorial and how do I make the http/start to start the server and return the service map instead of starting the server and not returning"><y>#</y><d>2022-01-24</d><h>20:59</h><w>zyxmn</w>hello, trying the pedestal tutorial and how do I make the <code>http/start</code> to start the server and return the service map instead of starting the server and not returning</z><z id="t1643058195" t="zyxmn ah I see the :http/join? in the 2nd lesson 😅"><y>#</y><d>2022-01-24</d><h>21:03</h><r>zyxmn</r>ah I see the <code>:http/join?</code> in the 2nd lesson <b>😅</b></z><z id="t1643402156" t="wilkerlucio hello, is there a way to compose multiple interceptors in one? for example, lets say I have interceptors a , b and c , and I want to make a new interceptor d that is the equivalent of using [a b c] , is there a way to compose interceptors like this?"><y>#</y><d>2022-01-28</d><h>20:35</h><w>wilkerlucio</w>hello, is there a way to compose multiple interceptors in one? for example, lets say I have interceptors <code>a</code>, <code>b</code> and <code>c</code>, and I want to make a new interceptor <code>d</code> that is the equivalent of using <code>[a b c]</code>, is there a way to compose interceptors like this?</z><z id="t1643402499" t="Joe Lane You can concatenate interceptors together to get to [a b c] but if you want to compose them I think you&apos;d have to do some magic with nested chain executors."><y>#</y><d>2022-01-28</d><h>20:41</h><w>Joe Lane</w>You can concatenate interceptors together to get to <code>[a b c]</code> but if you want to compose them I think you&apos;d have to do some magic with nested chain executors.</z><z id="t1643767567" t="v3ga So i&apos;m working with pedestal, reitit and shadow-cljs. Last night it seemed to work fine but now my repl literally blows up when I try to reach my SPA. Also even my initial &quot;/&quot; route which pulls a server side page seems to take unreasonably long and spits out a lot of data in the repl https://gist.github.com/v3gal0g/43ec3efa79e5de72484f0ab5cec96ef9"><y>#</y><d>2022-02-02</d><h>02:06</h><w>v3ga</w>So i&apos;m working with pedestal, reitit and shadow-cljs.  Last night it seemed to work fine but now my repl literally blows up when I try to reach my SPA.  Also even my initial &quot;/&quot; route which pulls a server side page seems to take unreasonably long and spits out a lot of data in the repl

<a href="https://gist.github.com/v3gal0g/43ec3efa79e5de72484f0ab5cec96ef9" target="_blank">https://gist.github.com/v3gal0g/43ec3efa79e5de72484f0ab5cec96ef9</a></z><z id="t1643779825" t="vemv maybe change the log level? all those DEBUGs might be causing some problem e.g. in Emacs, any buffer with too many characters will be sluggish"><y>#</y><d>2022-02-02</d><h>05:30</h><r>vemv</r>maybe change the log level? all those DEBUGs might be causing some problem

e.g. in Emacs, any buffer with too many characters will be sluggish</z><z id="t1643780671" t="v3ga Yeah that as well..but it wasn&apos;t doing that the other day...also now with my SPA page it flat out just hangs. I ended up reverting to my ring/reitit code. I&apos;m still curious as to whats going on though. It doesn&apos;t make sense to me but it seems to be stuck in a loop even though the routes are extremely basic."><y>#</y><d>2022-02-02</d><h>05:44</h><r>v3ga</r>Yeah that as well..but it wasn&apos;t doing that the other day...also now with my SPA page it flat out just hangs.  I ended up reverting to my ring/reitit code.  I&apos;m still curious as to whats going on though. It doesn&apos;t make sense to me but it seems to be stuck in a loop even though the routes are extremely  basic.</z><z id="t1643838969" t="dvingo I have a slightly different setup with pedestal + reitit +muuntaja than what you have there if you want to compare&amp;contrast https://github.com/dvingo/dv.fulcro-template/blob/5d69fefd7157f52bf725c362e794b9eacf3ea25d/resources/clj/new/dv.fulcro_template/src/main/app/server/service.clj#L208"><y>#</y><d>2022-02-02</d><h>21:56</h><r>dvingo</r>I have a slightly different setup with pedestal + reitit +muuntaja than what you have there if you want to compare&amp;contrast <a href="https://github.com/dvingo/dv.fulcro-template/blob/5d69fefd7157f52bf725c362e794b9eacf3ea25d/resources/clj/new/dv.fulcro_template/src/main/app/server/service.clj#L208" target="_blank">https://github.com/dvingo/dv.fulcro-template/blob/5d69fefd7157f52bf725c362e794b9eacf3ea25d/resources/clj/new/dv.fulcro_template/src/main/app/server/service.clj#L208</a></z><z id="t1643857821" t="v3ga ok yeah, thank you. taking a look over it now. Its hard to find examples though I did notice this week there are many more out there then last spring"><y>#</y><d>2022-02-03</d><h>03:10</h><r>v3ga</r>ok yeah, thank you. taking a look over it now.  Its hard to find examples though I did notice this week there are many more out there then last spring</z><z id="t1643858365" t="v3ga also are you pulling 0.5.9 or 0.5.10? I haven&apos;t had a chance to downgrade again but I wondered if that may be the issue"><y>#</y><d>2022-02-03</d><h>03:19</h><r>v3ga</r>also are you pulling 0.5.9 or 0.5.10? I haven&apos;t had a chance to downgrade again but I wondered if that may be the issue</z><z id="t1643880047" t="v3ga Got it. I believe (http/router routes ...) was the problem. I had the map with my reitit setup inside the same s-exp that I called my routes. Around where you showed...weird. No more blocking."><y>#</y><d>2022-02-03</d><h>09:20</h><r>v3ga</r>Got it. I believe (http/router routes ...) was the problem. I had the map with my reitit setup  inside the same s-exp that I called my routes. Around where you showed...weird.  No more blocking.</z><z id="t1643993853" t="dvingo oh weird, glad you found it! I haven&apos;t tried with 0.5.10 yet"><y>#</y><d>2022-02-04</d><h>16:57</h><r>dvingo</r>oh weird, glad you found it! I haven&apos;t tried  with 0.5.10 yet</z><z id="t1643915574" t="lucian303 how can I make a wildcard route to only serve routes that are not explicitly defined in my routes? i thought this was working before, but there is an issue as sometimes the wildcard route serves the defined routes also: my routes: (def routes #{[&quot;/&quot; :get (conj html-interceptors `home-page)] [&quot;/*all&quot; :get (conj html-interceptors `all-page)] [&quot;/api/config&quot; :get (conj open-api-interceptors `config)]}) and in my service config, i have added: :io.pedestal.http/router :linear-search I&apos;ve also tried to switch the order of the routes, putting the wildcard last, without luck. But the routes are defined as a set, which means they are unordered. Using a sorted set leads to errors. I think the lack of order of the set is likely what is leading to the issues but i&apos;m not sure how to fix it. Seems to me the linear router exists, but it can&apos;t be used since the order of routes simply cannot be defined. If that&apos;s not the case, how can the order of the routes be defined? So reading up on route syntax, it seems this affects the table syntax because it uses a set. Is there a way to use table syntax without a set? Maybe the expanded syntax is the only way to do this?"><y>#</y><d>2022-02-03</d><h>19:12</h><w>lucian303</w>how can I make a wildcard route to only serve routes that are not explicitly defined in my routes? i thought this was working before, but there is an issue as sometimes the wildcard route serves the defined routes also:
my routes:
<pre>(def routes #{[&quot;/&quot; :get (conj html-interceptors `home-page)]

              [&quot;/*all&quot; :get (conj html-interceptors `all-page)]
              [&quot;/api/config&quot; :get (conj open-api-interceptors `config)]})</pre>
and in my service config, i have added:
<pre>:io.pedestal.http/router :linear-search</pre>
I&apos;ve also tried to switch the order of the routes, putting the wildcard last, without luck.

But the routes are defined as a set, which means they are unordered. Using a sorted set leads to errors. I think the lack of order of the set is likely what is leading to the issues but i&apos;m not sure how to fix it.

Seems to me the linear router exists, but it can&apos;t be used since the order of routes simply cannot be defined. If that&apos;s not the case, how can the order of the routes be defined?

So reading up on route syntax, it seems this affects the table syntax because it uses a set. Is there a way to use table syntax without a set? Maybe the expanded syntax is the only way to do this?</z><z id="t1643929802" t="lucian303 For now, I&apos;m using this to override the protocol and process vectors using table syntax but a config option would probably be best: ;; Extend protocol and process routes in vectors using table syntax (extend-protocol route/ExpandableRoutes clojure.lang.APersistentVector (-expand-routes [route-spec] (table/table-routes route-spec)))"><y>#</y><d>2022-02-03</d><h>23:10</h><r>lucian303</r>For now, I&apos;m using this to override the protocol and process vectors using table syntax but a config option would probably be best:
<pre>;; Extend protocol and process routes in vectors using table syntax
(extend-protocol route/ExpandableRoutes
  clojure.lang.APersistentVector
  (-expand-routes [route-spec]
    (table/table-routes route-spec)))</pre></z><z id="t1643956581" t="hanDerPeder With linear-search you should use a vector of routes, not a set."><y>#</y><d>2022-02-04</d><h>06:36</h><r>hanDerPeder</r>With linear-search you should use a vector of routes, not a set.</z><z id="t1643956655" t="hanDerPeder Also, if you want a handler for any non matched route you could use an interceptor after your router."><y>#</y><d>2022-02-04</d><h>06:37</h><r>hanDerPeder</r>Also, if you want a handler for any non matched route you could use an interceptor after your router.</z><z id="t1644273417" t="lucian303 is it possible to use a set w/ the tabular format? it seems that a vector is interpreted w/ the terse format, that&apos;s why i overrode that protocol to interpret vectors using the table format. is there a better way to do that?"><y>#</y><d>2022-02-07</d><h>22:36</h><r>lucian303</r>is it possible to use a set w/ the tabular format? it seems that a vector is interpreted w/ the terse format, that&apos;s why i overrode that protocol to interpret vectors using the table format. is there a better way to do that?</z><z id="t1644183811" t="v3ga Ok so I like to ssh into my desktop and work on my projects and I have nginx set up where I can hit whatever webserver i spin up on port 8080. With ring/jetty this works fine. But with pedestal clearly there&apos;s some setting or flag I need to cut on. can someone point me in the right direction? I assume it&apos;s allowed-origins and I gave it a vector with [&quot; http://cybernest:8080 &quot;] but that of course didn&apos;t work."><y>#</y><d>2022-02-06</d><h>21:43</h><w>v3ga</w>Ok so I like to ssh into  my desktop and work on my projects and I have nginx set up where I can hit whatever webserver i spin up on port 8080.  With ring/jetty this works fine.  But with pedestal clearly there&apos;s some setting or flag I need to cut on. can someone point me in the right direction?  I assume it&apos;s allowed-origins and I gave it a vector with [&quot;<a href="http://cybernest:8080" target="_blank">http://cybernest:8080</a>&quot;] but that of course didn&apos;t work.</z><z id="t1644186086" t="sova-soars-the-sora Hi is there an equivalent of wrap-reload middleware from Ring for pedestal ?"><y>#</y><d>2022-02-06</d><h>22:21</h><w>sova-soars-the-sora</w>Hi is there an equivalent of wrap-reload middleware from Ring for <code>pedestal</code> ?</z><z id="t1644187863" t="v3ga Yes, take a look here. &quot;run-dev&quot;. Also derefing your routes I believe will give you what you&apos;re after. http://pedestal.io/guides/developing-at-the-repl"><y>#</y><d>2022-02-06</d><h>22:51</h><w>v3ga</w>Yes, take a look here. &quot;run-dev&quot;.  Also derefing your routes I believe will give you what you&apos;re after.
<a href="http://pedestal.io/guides/developing-at-the-repl" target="_blank">http://pedestal.io/guides/developing-at-the-repl</a></z><z id="t1644195056" t="dvingo it&apos;s used in some samples, but I don&apos;t think the docs mention it anywhere: https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/template-server/src/template_server/server.clj#L32"><y>#</y><d>2022-02-07</d><h>00:50</h><w>dvingo</w>it&apos;s used in some samples, but I don&apos;t think the docs mention it anywhere:
<a href="https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/template-server/src/template_server/server.clj#L32" target="_blank">https://github.com/pedestal/pedestal/blob/d20065013abf5d3793ae5301e18a2398707fa2a9/samples/template-server/src/template_server/server.clj#L32</a></z><z id="t1644418787" t="Godwin Ko I’m using Jetty container, but when the server startup, a few log message pops up about Undertow server started, together with xnio &amp; jboss thread message. Is there any other service that is using Undertow by default? I’m currently using pedestal 0.5.8, thx 🙇 :skin-tone-2:"><y>#</y><d>2022-02-09</d><h>14:59</h><w>Godwin Ko</w>I’m using Jetty container, but when the server startup, a few log message pops up about Undertow server started, together with xnio &amp; jboss thread message.  Is there any other service that is using Undertow by default?  I’m currently using pedestal 0.5.8, thx <b>🙇</b><b>:skin-tone-2:</b></z><z id="t1644429972" t="souenzzo can you share your service-map? or at least a part of it."><y>#</y><d>2022-02-09</d><h>18:06</h><r>souenzzo</r>can you share your service-map? or at least a part of it.</z><z id="t1644438144" t="Godwin Ko here it is, thx a lot in advance 🙇 :skin-tone-2: (defn service-map [env] {:env :prod ::http/router :linear-search ::http/routes routes/routes ::http/type :jetty ::http/port (:port env) ::http/join? false ::http/enable-session {:store (cookie/cookie-store {:key (get-in env [:session :key])}) :cookie-name (get-in env [:session :name]) :cookie-attrs {:http-only true :same-site :lax}} ::http/container-options {:max-threads 8} ::http/request-logger log/log-request}) (mount/defstate ^:dynamic *http* :start (if (:dev cfg/*env*) (-&gt; (service-map cfg/*env*) (merge {:env :dev ::http/routes #(deref #&apos;routes/routes)}) http/default-interceptors http/dev-interceptors http/create-server http/start) (-&gt; (service-map cfg/*env*) http/default-interceptors http/create-server http/start)) :stop (http/stop *http*))"><y>#</y><d>2022-02-09</d><h>20:22</h><r>Godwin Ko</r>here it is, thx a lot in advance <b>🙇</b><b>:skin-tone-2:</b>

<pre>(defn service-map [env]
  {:env :prod
   ::http/router :linear-search
   ::http/routes routes/routes
   ::http/type :jetty
   ::http/port (:port env)
   ::http/join? false
   ::http/enable-session {:store (cookie/cookie-store {:key (get-in env [:session :key])})
                          :cookie-name (get-in env [:session :name])
                          :cookie-attrs {:http-only true
                                         :same-site :lax}}
   ::http/container-options {:max-threads 8}
   ::http/request-logger log/log-request})

(mount/defstate ^:dynamic *http*
  :start (if (:dev cfg/*env*)
           (-&gt; (service-map cfg/*env*)
               (merge {:env :dev
                       ::http/routes #(deref #&apos;routes/routes)})
               http/default-interceptors
               http/dev-interceptors
               http/create-server
               http/start)
           (-&gt; (service-map cfg/*env*)
               http/default-interceptors
               http/create-server
               http/start))
  :stop (http/stop *http*))</pre></z><z id="t1644438331" t="Godwin Ko and the screen cap of server start log"><y>#</y><d>2022-02-09</d><h>20:25</h><r>Godwin Ko</r>and the screen cap of server start log</z><z id="t1644522321" t="Fahd El Mazouni do you see logs for jetty starting up ? maybe there is some other dependency starting the undertow server"><y>#</y><d>2022-02-10</d><h>19:45</h><r>Fahd El Mazouni</r>do you see logs for jetty starting up ? maybe there is some other dependency starting the undertow server</z><z id="t1644572286" t="Godwin Ko nop, those four lines are the only log output when server start, and I’m pretty sure that I’m using Jetty container, pedestal will complaint if I take out pedestal.jetty from deps.edn, I’ve no clue why Undertow / JBoss message pops up? :thinking_face:"><y>#</y><d>2022-02-11</d><h>09:38</h><r>Godwin Ko</r>nop, those four lines are the only log output when server start, and I’m pretty sure that I’m using Jetty container, pedestal will complaint if I take out <code>pedestal.jetty</code> from deps.edn, I’ve no clue why Undertow / JBoss message pops up? <b>:thinking_face:</b></z><z id="t1644582342" t="souenzzo [:attrs {:href &quot;/_/_/users/ULS5BHEUR&quot;}] do you have shadow-cljs in your classpath? shadow-cljs produces this log output"><y>#</y><d>2022-02-11</d><h>12:25</h><r>souenzzo</r><a>@ULS5BHEUR</a> do you have shadow-cljs in your classpath?
shadow-cljs produces this log output</z><z id="t1644586230" t="Godwin Ko oh my god, you’re right!! I’m combining both shadow-cljs &amp; pedestal for a full stack development environment. Thanks a lot, and sorry for asking in the wrong channel, which I didn’t mean to…… 😅"><y>#</y><d>2022-02-11</d><h>13:30</h><r>Godwin Ko</r>oh my god, you’re right!!
I’m combining both shadow-cljs &amp; pedestal for a full stack development environment.  Thanks a lot, and sorry for asking in the wrong channel, which I didn’t mean to…… <b>😅</b></z><z id="t1645555586" t="Miguel Rivas This is a bit of pedestal/reitit question. I&apos;m using XTDB as data storage, they offer a https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L446 for their web console and I&apos;ve been trying to use it in my pedestal stack. So far I&apos;ve been able to somewhat use it by converting the said handler into a pedestal interceptor, such as: ;; this is &quot;xtdb-interceptor&quot; (-&gt; xtdb-handler (io.pedestal.interceptor/interceptor)) and then adding it to my service-map config (update service-map ::io.pedestal.http/interceptors conj xtdb-interceptor) This works up until I try to interact with xtdb&apos;s console and say, run a query, the request seems to be handled ok and a response is returned such as: {:status 200, :body &lt;&lt;StreamableResponse&gt;&gt;, :headers {&quot;Content-Type&quot; &quot;application/edn; charset=utf-8&quot;}} However the StreamableResponse body is not being handled/coerced, causing a java.lang.IllegalArgumentException: No implementation of method: :write-body-to-stream of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: juxt.clojars_mirrors.muuntaja.v0v6v8.muuntaja.protocols.StreamableResponse . I do notice that https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L428 does provide coercion/middlewares for their console&apos;s routes, however this doesn&apos;t seem to be working. Maybe the approach of using the handler as an interceptor is wrong? Any ideas on how I could plug it into my pedestal config?"><y>#</y><d>2022-02-22</d><h>18:46</h><w>Miguel Rivas</w>This is a bit of pedestal/reitit question. I&apos;m using <code>XTDB</code> as data storage, they offer a <a href="https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L446" target="_blank">https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L446</a> for their web console and I&apos;ve been trying to use it in my pedestal stack. So far I&apos;ve been able to somewhat use it by converting the said handler into a pedestal interceptor, such as:
<pre>;; this is &quot;xtdb-interceptor&quot;
(-&gt; xtdb-handler
    (io.pedestal.interceptor/interceptor))</pre>
and then adding it to my service-map config
<pre>(update service-map ::io.pedestal.http/interceptors conj xtdb-interceptor)</pre>
This works up until I try to interact with xtdb&apos;s console and say, run a query, the request seems to be handled ok and a response is returned such as:
<pre>{:status 200,
  :body &lt;&lt;StreamableResponse&gt;&gt;,
  :headers {&quot;Content-Type&quot; &quot;application/edn; charset=utf-8&quot;}}</pre>
However the StreamableResponse body is not being handled/coerced, causing a <code>java.lang.IllegalArgumentException: No implementation of method: :write-body-to-stream of protocol: #&apos;io.pedestal.http.impl.servlet-interceptor/WriteableBody found for class: juxt.clojars_mirrors.muuntaja.v0v6v8.muuntaja.protocols.StreamableResponse</code>.
I do notice that <a href="https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L428" target="_blank">https://github.com/xtdb/xtdb/blob/20a2632a18a36dae2e915ab032307ce0c5b3e150/modules/http-server/src/xtdb/http_server.clj#L428</a> does provide coercion/middlewares for their console&apos;s routes, however this doesn&apos;t seem to be working. Maybe the approach of using the handler as an interceptor is wrong? Any ideas on how I could plug it into my pedestal config?</z><z id="t1645560314" t="ddeaguiar Seems like you need to extend WritableBody to StreamableResponse or the concrete impl"><y>#</y><d>2022-02-22</d><h>20:05</h><r>ddeaguiar</r>Seems like you need to extend WritableBody to StreamableResponse or the concrete impl</z><z id="t1645728266" t="Miguel Rivas just in case anyone tries to do the same and use this handler with pedestal, I got it working by extending Pedestal&apos;s io.pedestal.http.impl.servlet-interceptor/WriteableBody protocol like so: (extend-protocol io.pedestal.http.impl.servlet-interceptor/WriteableBody (Class/forName &quot;[B&quot;) (write-body-to-stream [^InputStream input-stream ^OutputStream output-stream] (with-open [out output-stream] (.write out ^bytes input-stream))) juxt.clojars_mirrors.muuntaja.v0v6v8.muuntaja.protocols.StreamableResponse (write-body-to-stream [^InputStream input-stream ^OutputStream output-stream] (with-open [out output-stream] ((.f input-stream) ^OutputStream out)))) I hope this helps anyone that may try to use xtdb&apos;s console with pedestal 😄"><y>#</y><d>2022-02-24</d><h>18:44</h><r>Miguel Rivas</r>just in case anyone tries to do the same and use this handler with pedestal, I got it working by extending Pedestal&apos;s <code>io.pedestal.http.impl.servlet-interceptor/WriteableBody</code> protocol like so:
<pre>(extend-protocol io.pedestal.http.impl.servlet-interceptor/WriteableBody
  (Class/forName &quot;[B&quot;)
  (write-body-to-stream [^InputStream input-stream ^OutputStream output-stream]
    (with-open [out output-stream]
      (.write out ^bytes input-stream)))

  juxt.clojars_mirrors.muuntaja.v0v6v8.muuntaja.protocols.StreamableResponse
  (write-body-to-stream [^InputStream input-stream ^OutputStream output-stream]
    (with-open [out output-stream]
      ((.f input-stream) ^OutputStream out))))</pre>
I hope this helps anyone that may try to use xtdb&apos;s console with pedestal <b>😄</b></z><z id="t1645620505" t="orestis Is there a way, for a set of routes, to apply rate-limiting or lower priority or just confine them to a fixed number of threads so that they don&apos;t overrun the server? We&apos;re using jetty..."><y>#</y><d>2022-02-23</d><h>12:48</h><w>orestis</w>Is there a way, for a set of routes, to apply rate-limiting or lower priority or just confine them to a fixed number of threads so that they don&apos;t overrun the server? We&apos;re using jetty...</z><z id="t1645645080" t="ghadi if they&apos;ve made it into your routes, jetty is already handling them you may want to consider a rate-limiting load balancer in front of your service (e.g. API Gateway)"><y>#</y><d>2022-02-23</d><h>19:38</h><w>ghadi</w>if they&apos;ve made it into your routes, jetty is already handling them
you may want to consider a rate-limiting load balancer in front of your service (e.g. API Gateway)</z><z id="t1645645628" t="vemv in-app rate limiting makes sense IMO, if the resource being rate-limited isn&apos;t jetty itself e.g. if some route guards some special resource, maybe you want to rate-limit that specific resource"><y>#</y><d>2022-02-23</d><h>19:47</h><w>vemv</w>in-app rate limiting makes sense IMO, if the resource being rate-limited isn&apos;t jetty itself

e.g. if some route guards some special resource, maybe you want to rate-limit that specific resource</z><z id="t1645646209" t="orestis I should probably look into jetty specifically, and see if it can do basic routing and strategies like this before handing over to pedestal itself. Eg a different queuing/buffering strategy. "><y>#</y><d>2022-02-23</d><h>19:56</h><w>orestis</w>I should probably look into jetty specifically, and see if it can do basic routing and strategies like this before handing over to pedestal itself. Eg a different queuing/buffering strategy. </z><z id="t1645646255" t="orestis Unfortunately can&apos;t use api gateway yet. Or can I? Not sure if it can route to an ALB…"><y>#</y><d>2022-02-23</d><h>19:57</h><w>orestis</w>Unfortunately can&apos;t use api gateway yet. Or can I? Not sure if it can route to an ALB…</z><z id="t1645646406" t="ghadi you can use a rate-limiting interceptor"><y>#</y><d>2022-02-23</d><h>20:00</h><w>ghadi</w>you can use a rate-limiting interceptor</z><z id="t1645646430" t="ghadi rate information could be local or shared across instances (e.g. using a db) depending on requirements"><y>#</y><d>2022-02-23</d><h>20:00</h><w>ghadi</w>rate information could be local or shared across instances (e.g. using a db) depending on requirements</z><z id="t1646246249" t="zeitstein I&apos;m seeing unexpected behaviour, but I&apos;m not sure if it warrants opening an issue. If the content-type request header is specified as anything other than &quot;Content-Type&quot; (e.g. &quot;content-type&quot; ), the value of :content-type is an empty string in (:request context) . Perhaps related to https://github.com/pedestal/pedestal/issues/681 ? I&apos;ll share a reproducible example in the thread."><y>#</y><d>2022-03-02</d><h>18:37</h><w>zeitstein</w>I&apos;m seeing unexpected behaviour, but I&apos;m not sure if it warrants opening an issue. If the content-type request header is specified as anything other than <code>&quot;Content-Type&quot;</code> (e.g. <code>&quot;content-type&quot;</code>), the value of <code>:content-type</code> is an empty string in <code>(:request context)</code>. Perhaps related to <a href="https://github.com/pedestal/pedestal/issues/681" target="_blank">https://github.com/pedestal/pedestal/issues/681</a>? I&apos;ll share a reproducible example in the thread.</z><z id="t1646246266" t="zeitstein (ns server.issue (:require [io.pedestal.http :as http] [io.pedestal.test :as test] [io.pedestal.http.route :as route])) (def echo {:name ::echo :enter (fn [context] (let [request (:request context) ;; to enable read-string request* (dissoc request :servlet-response :servlet :servlet-request :body :url-for)] (assoc context :response {:status 200 :body request*})))}) (def routes (route/expand-routes #{[&quot;/echo&quot; :get [echo]]})) (def service-map {::http/routes routes ::http/type :jetty ::http/port 8080}) (defonce server (atom nil)) (defn start-dev [] (reset! server (-&gt; service-map (assoc ::http/join? false) http/create-server http/start))) (defn stop-dev [] (http/stop @server)) (defn restart [] (stop-dev) (start-dev)) (comment (stop-dev) (start-dev) (restart) (-&gt; (test/response-for (:io.pedestal.http/service-fn @server) :get &quot;/echo&quot; :headers {&quot;content-type&quot; &quot;text/html&quot;}) :body read-string :content-type) (-&gt; (test/response-for (:io.pedestal.http/service-fn @server) :get &quot;/echo&quot; :headers {&quot;Content-Type&quot; &quot;text/html&quot;}) :body read-string :content-type) ; )"><y>#</y><d>2022-03-02</d><h>18:37</h><r>zeitstein</r><pre>(ns server.issue
  (:require
   [io.pedestal.http :as http]
   [io.pedestal.test :as test]
   [io.pedestal.http.route :as route]))

(def echo
  {:name ::echo
   :enter
   (fn [context]
     (let [request (:request context)
           ;; to enable read-string
           request* (dissoc request
                      :servlet-response
                      :servlet
                      :servlet-request
                      :body
                      :url-for)]
       (assoc context :response
         {:status 200 :body request*})))})

(def routes
  (route/expand-routes #{[&quot;/echo&quot; :get [echo]]}))

(def service-map
  {::http/routes routes
   ::http/type   :jetty
   ::http/port   8080})

(defonce server (atom nil))

(defn start-dev []
  (reset! server
    (-&gt; service-map
      (assoc ::http/join? false)
      http/create-server
      http/start)))

(defn stop-dev []
  (http/stop @server))

(defn restart []
  (stop-dev)
  (start-dev))

(comment
  (stop-dev)
  (start-dev)
  (restart)

  (-&gt; (test/response-for (:io.pedestal.http/service-fn @server) :get &quot;/echo&quot;
        :headers {&quot;content-type&quot; &quot;text/html&quot;})
    :body
    read-string
    :content-type)

  (-&gt; (test/response-for (:io.pedestal.http/service-fn @server) :get &quot;/echo&quot;
        :headers {&quot;Content-Type&quot; &quot;text/html&quot;})
    :body
    read-string
    :content-type)
  ;
  )</pre></z><z id="t1646405245" t="Casey How can I write an interceptor that will be called when pedestal serves static resources from the :io.pedestal.http/resource-path` dir? Any interceptors I add to the service-map don&apos;t get triggered 😕 Specifically I&apos;m serving an html file in there and I want to override the CSP headers just when serving that specific file."><y>#</y><d>2022-03-04</d><h>14:47</h><w>Casey</w>How can I write an interceptor that will be called when pedestal serves static resources from the <code></code>:io.pedestal.http/resource-path`  dir?  Any interceptors I add to the service-map don&apos;t get triggered <b>😕</b>

Specifically I&apos;m serving an html file in there and I want to override the CSP headers just when serving that specific file.</z><z id="t1646500191" t="zeitstein I&apos;m using io.pedestal.http.ring-middlewares/fast-resource and two :leave interceptors before it to serve html from / . Don&apos;t know if that helps."><y>#</y><d>2022-03-05</d><h>17:09</h><r>zeitstein</r>I&apos;m using <code>io.pedestal.http.ring-middlewares/fast-resource</code> and two <code>:leave</code> interceptors before it to serve html from <code>/</code>. Don&apos;t know if that helps.</z><z id="t1646580636" t="mindbender Any plan to integrate pedestal with tools.deps?"><y>#</y><d>2022-03-06</d><h>15:30</h><w>mindbender</w>Any plan to integrate pedestal with tools.deps?</z><z id="t1646580892" t="mindbender This is going to make it easier to work with pedestal from within application in being able to add specific sources during development according to development needs and help understand the codebase better."><y>#</y><d>2022-03-06</d><h>15:34</h><r>mindbender</r>This is going to make it easier to work with pedestal from within application in being able to add specific sources during development according to development needs and help understand the codebase better.</z><z id="t1646581246" t="mindbender I see some initial efforts here but that effort seem to have dwindled: https://github.com/pedestal/pedestal/pull/596"><y>#</y><d>2022-03-06</d><h>15:40</h><r>mindbender</r>I see some initial efforts here but that effort seem to have dwindled:
<a href="https://github.com/pedestal/pedestal/pull/596" target="_blank">https://github.com/pedestal/pedestal/pull/596</a></z><z id="t1647206543" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U0HJYDTP1&quot;}] it’s on the radar. I don’t have a timeline as to when we’ll get back to that work, though."><y>#</y><d>2022-03-13</d><h>21:22</h><r>ddeaguiar</r>Hi <a>@U0HJYDTP1</a> it’s on the radar. I don’t have a timeline as to when we’ll get back to that work, though.</z><z id="t1647028097" t="jmv hey all, what&apos;s the best way to set the *mdc-context* so that the value is reflect in every interceptor in the chain? basically i would like to set some metadata at the start of a request, so that logging in the rest of the interceptors in the chain have this metadata."><y>#</y><d>2022-03-11</d><h>19:48</h><w>jmv</w>hey all, what&apos;s the best way to set the <code>*mdc-context*</code> so that the value is reflect in every interceptor in the chain? basically i would like to set some metadata at the start of a request, so that logging in the rest of the interceptors in the chain have this metadata.</z><z id="t1647028119" t="jmv also, if setting *mdc-context* is not the best way to do this, lemme know!"><y>#</y><d>2022-03-11</d><h>19:48</h><r>jmv</r>also, if setting <code>*mdc-context*</code> is not the best way to do this, lemme know!</z><z id="t1647028434" t="ghadi Not sure about that particular dynvar, but if an interceptor returns a context with :bindings , they will be active through further interceptors http://pedestal.io/reference/context-map"><y>#</y><d>2022-03-11</d><h>19:53</h><r>ghadi</r>Not sure about that particular dynvar, but if an interceptor returns a context with :bindings , they will be active through further interceptors <a href="http://pedestal.io/reference/context-map" target="_blank">http://pedestal.io/reference/context-map</a></z><z id="t1647029220" t="jmv thank you for sharing! this sounds like exactly what i&apos;m looking for"><y>#</y><d>2022-03-11</d><h>20:07</h><r>jmv</r>thank you for sharing! this sounds like exactly what i&apos;m looking for</z><z id="t1683125006" t="Phillip Mates I&apos;m also trying to manipulate the *mdc-context* via an interceptor, in order to set a correlation-id per request. I tried binding *mdc-context* to something using pedestal&apos;s :bindings but found it wasn&apos;t enough to actually get the new context to register. After some debugging I realized that one still needs to &quot;install&quot; the new context in the MDC. I&apos;m thinking something like this will do the trick: {:name ::cid :enter (fn [context] (let [new-mdc-context (merge .... io.pedestal.log/*mdc-context*)] (io.pedestal.log/-put-mdc (MDC/getMDCAdapter) io.pedestal.log/mdc-context-key (pr-str (dissoc new-mdc-context :io.pedestal.log/formatter :io.pedestal.log/mdc))) (-&gt; context (update context :bindings assoc #&apos;io.pedestal.log/*mdc-context* new-mdc-context) (assoc ::old-mdc-context io.pedestal.log/*mdc-context*)))) :leave (fn [context] (when-let [old-mdc-context (::old-mdc-context context)] ;; go back to old MDC (io.pedestal.log/-put-mdc (MDC/getMDCAdapter) io.pedestal.log/mdc-context-key (pr-str (dissoc old-mdc-context :io.pedestal.log/formatter :io.pedestal.log/mdc)))) context)} wanted to share if that helps others with similar issue"><y>#</y><d>2023-05-03</d><h>14:43</h><r>Phillip Mates</r>I&apos;m also trying to manipulate the <code>*mdc-context*</code> via an interceptor, in order to set a correlation-id per request.

I tried binding <code>*mdc-context*</code> to something using pedestal&apos;s <code>:bindings</code>  but found it wasn&apos;t enough to actually get the new context to register.

After some debugging I realized that one still needs to &quot;install&quot; the new context in the MDC.

I&apos;m thinking something like this will do the trick:

<pre>{:name ::cid
 :enter (fn [context]
          (let [new-mdc-context (merge .... io.pedestal.log/*mdc-context*)]
            (io.pedestal.log/-put-mdc (MDC/getMDCAdapter)
                                 io.pedestal.log/mdc-context-key
                                 (pr-str (dissoc new-mdc-context
                                                 :io.pedestal.log/formatter
                                                 :io.pedestal.log/mdc)))
          (-&gt; context
              (update context
                      :bindings
                      assoc
                      #&apos;io.pedestal.log/*mdc-context*
                      new-mdc-context)
              (assoc ::old-mdc-context io.pedestal.log/*mdc-context*))))
 :leave (fn [context]
          (when-let [old-mdc-context (::old-mdc-context context)]
            ;; go back to old MDC
            (io.pedestal.log/-put-mdc (MDC/getMDCAdapter)
                                   io.pedestal.log/mdc-context-key
                                   (pr-str (dissoc old-mdc-context
                                                   :io.pedestal.log/formatter
                                                   :io.pedestal.log/mdc))))
          context)}</pre>
wanted to share if that helps others with similar issue</z><z id="t1647160024" t="Prabu Rajan Hello all, I wrote a step-by-step guide to get watch and auto-reload working in REPL mode on pedestal. The articles is here - https://dev.to/praburajan/watch-and-auto-reload-a-clojure-pedestal-service-on-save-4ehl . This refers to the thread https://clojurians.slack.com/archives/C0K65B20P/p1641904659003200"><y>#</y><d>2022-03-13</d><h>08:27</h><w>Prabu Rajan</w>Hello all, I wrote a step-by-step guide to get watch and auto-reload working in REPL mode on pedestal. The articles is here - <a href="https://dev.to/praburajan/watch-and-auto-reload-a-clojure-pedestal-service-on-save-4ehl" target="_blank">https://dev.to/praburajan/watch-and-auto-reload-a-clojure-pedestal-service-on-save-4ehl</a>. This refers to the thread <a href="https://clojurians.slack.com/archives/C0K65B20P/p1641904659003200" target="_blank">https://clojurians.slack.com/archives/C0K65B20P/p1641904659003200</a></z><z id="t1647540760" t="sb I would like to change the maximum header size: https://github.com/pedestal/pedestal/issues/615 like here"><y>#</y><d>2022-03-17</d><h>18:12</h><w>sb</w>I would like to change the maximum header size: <a href="https://github.com/pedestal/pedestal/issues/615" target="_blank">https://github.com/pedestal/pedestal/issues/615</a> like here</z><z id="t1647540771" t="sb I get still 414 Too long Uri"><y>#</y><d>2022-03-17</d><h>18:12</h><w>sb</w>I get still 414 Too long Uri</z><z id="t1647540782" t="sb What is the problem with my code, what I forget to add?"><y>#</y><d>2022-03-17</d><h>18:13</h><w>sb</w>What is the problem with my code, what I forget to add?</z><z id="t1647540952" t="sb I used 0.5.4 version, maybe that is the problem. I check one moment."><y>#</y><d>2022-03-17</d><h>18:15</h><w>sb</w>I used 0.5.4 version, maybe that is the problem. I check one moment.</z><z id="t1647543528" t="sb That was the problem. I know that is not a best idea.. but now, that is enough."><y>#</y><d>2022-03-17</d><h>18:58</h><w>sb</w>That was the problem. I know that is not a best idea.. but now, that is enough.</z><z id="t1647595084" t="sb Is that possible to setup different headersize for localhost (cljs-&gt;clj requests) or API URL? (I know maybe better to do Google way, redirect POST to GET, but I would like to understand is that possible?"><y>#</y><d>2022-03-18</d><h>09:18</h><w>sb</w>Is that possible to setup different headersize for localhost (cljs-&gt;clj requests) or API URL? (I know maybe better to do Google way, redirect POST to GET, but I would like to understand is that possible?</z><z id="t1647607522" t="souenzzo You can have different main&apos;s with different configs for dev setup and prod setup based on this example: https://github.com/pedestal/pedestal/issues/615#issuecomment-505622534 you can do: (def service {...}) (defn dev-main [&amp; args] (-&gt; service (assoc-in [::http/container-options :io.pedestal.http.jetty/http-configuration] (http-configuration 5000)) http/default-interceptors http/create-server http/start)) (defn -main [&amp; args] (-&gt; service http/default-interceptors http/create-server http/start))"><y>#</y><d>2022-03-18</d><h>12:45</h><r>souenzzo</r>You can have different main&apos;s with different configs for dev setup and prod setup
based on this example:
<a href="https://github.com/pedestal/pedestal/issues/615#issuecomment-505622534" target="_blank">https://github.com/pedestal/pedestal/issues/615#issuecomment-505622534</a>
you can do:
<pre>(def service
  {...})
(defn dev-main
  [&amp; args]
  (-&gt; service
    (assoc-in [::http/container-options :io.pedestal.http.jetty/http-configuration]
      (http-configuration 5000))
    http/default-interceptors
    http/create-server
    http/start))
(defn -main
  [&amp; args]
  (-&gt; service
    http/default-interceptors
    http/create-server
    http/start))</pre></z><z id="t1647651682" t="sb [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] thanks!!"><y>#</y><d>2022-03-19</d><h>01:01</h><r>sb</r><a>@U2J4FRT2T</a> thanks!!</z><z id="t1647971615" t="steffan Running a Pedestal service with Clojure 1.11.0 gives a number of warnings to console. Seems Pedestal has an outdated dependency on org.clojure/tools.analyzer.jvm https://github.com/pedestal/pedestal/blob/50fe5ea89108998ac5a79a02a44432fd111ea6f8/service/project.clj#L36 WARNING: update-vals already refers to: #&apos;clojure.core/update-vals in namespace: clojure.tools.analyzer.utils, being replaced by: #&apos;clojure.tools.analyzer.utils/update-vals WARNING: update-keys already refers to: #&apos;clojure.core/update-keys in namespace: clojure.tools.analyzer.utils, being replaced by: #&apos;clojure.tools.analyzer.utils/update-keys"><y>#</y><d>2022-03-22</d><h>17:53</h><w>steffan</w>Running a Pedestal service with Clojure 1.11.0 gives a number of warnings to console. Seems Pedestal has an outdated dependency on <code>org.clojure/tools.analyzer.jvm</code>
<a href="https://github.com/pedestal/pedestal/blob/50fe5ea89108998ac5a79a02a44432fd111ea6f8/service/project.clj#L36" target="_blank">https://github.com/pedestal/pedestal/blob/50fe5ea89108998ac5a79a02a44432fd111ea6f8/service/project.clj#L36</a>
<pre>WARNING: update-vals already refers to: #&apos;clojure.core/update-vals in namespace: clojure.tools.analyzer.utils, being replaced by: #&apos;clojure.tools.analyzer.utils/update-vals
WARNING: update-keys already refers to: #&apos;clojure.core/update-keys in namespace: clojure.tools.analyzer.utils, being replaced by: #&apos;clojure.tools.analyzer.utils/update-keys</pre></z><z id="t1647977028" t="richiardiandrea probably tools.analyzer.jvm needs bumping...or removal if the only functions pedestal uses are those update-* ones"><y>#</y><d>2022-03-22</d><h>19:23</h><r>richiardiandrea</r>probably <code>tools.analyzer.jvm</code> needs bumping...or removal if the only functions pedestal uses are those <code>update-*</code> ones</z><z id="t1648054019" t="ddeaguiar Thanks [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] , we&apos;ll take a look"><y>#</y><d>2022-03-23</d><h>16:46</h><r>ddeaguiar</r>Thanks <a>@U0C8489U6</a>, we&apos;ll take a look</z><z id="t1648393493" t="popeye I am using pedatsal web framework (defn study-fn [ctx] // transformation on ctx ) (def interceptor-1 {:name :studies :enter study-fn}) [&quot;/rest/get-studis&quot; :get [interceptor-1] :route-name :studies] Is there a way where we can pass an extra function in the routs? like below [&quot;/rest/get-studis&quot; :get [interceptor-1 (fn [] {:message &quot;message&quot;} )] :route-name :studies] so that study_fn can be something like below (defn study-fn [ctx parameter] // transformation on ctx )"><y>#</y><d>2022-03-27</d><h>15:04</h><w>popeye</w>I am using pedatsal web framework
<pre>(defn study-fn [ctx]
 // transformation on ctx
)   

(def interceptor-1
  {:name :studies
   :enter study-fn})

[&quot;/rest/get-studis&quot; :get [interceptor-1] :route-name :studies]</pre>
Is there a way where we can pass an extra function in the routs? like below

<pre>[&quot;/rest/get-studis&quot; :get [interceptor-1  (fn [] {:message &quot;message&quot;} )] :route-name :studies]</pre>
so that study_fn can be something like below

<pre>(defn study-fn [ctx parameter]

 // transformation on ctx

)</pre></z><z id="t1648399310" t="pithyless [:attrs {:href &quot;/_/_/users/U01J3DB39R6&quot;}] This is not specific to pedestal, but what you usually want to do in cases like this is create a closure that returns parameterized functions (sometimes referred to as &quot;close over a function&quot;) - and not to be confused with &quot;Clojure&quot;. This way you can customize the function, without needing to change the underlying API. (defn make-study-fn [opts] (fn [ctx] &quot;Here you have access to both ctx and opts&quot;)) (defn interceptor-1 [opts] {:name :studies :enter (make-study-fn opts)}) [&quot;/rest/get-studies&quot; :get [(interceptor-1 {:message &quot;message&quot;})] ,,,]"><y>#</y><d>2022-03-27</d><h>16:41</h><r>pithyless</r><a>@U01J3DB39R6</a> This is not specific to pedestal, but what you usually want to do in cases like this is create a closure that returns parameterized functions (sometimes referred to as &quot;close over a function&quot;) - and not to be confused with &quot;Clojure&quot;. This way you can customize the function, without needing to change the underlying API.

<pre>(defn make-study-fn [opts]
  (fn [ctx] &quot;Here you have access to both ctx and opts&quot;))


(defn interceptor-1 [opts]
 {:name :studies
  :enter (make-study-fn opts)})


[&quot;/rest/get-studies&quot; :get [(interceptor-1 {:message &quot;message&quot;})] ,,,]</pre></z><z id="t1648407012" t="popeye thanks for the response [:attrs {:href &quot;/_/_/users/U05476190&quot;}] , Will try this"><y>#</y><d>2022-03-27</d><h>18:50</h><r>popeye</r>thanks for the response <a>@U05476190</a>, Will try this</z><z id="t1648871873" t="v3ga Does anyone have any examples of uploading an image/file?"><y>#</y><d>2022-04-02</d><h>03:57</h><w>v3ga</w>Does anyone have any examples of uploading an image/file?</z><z id="t1648940009" t="v3ga In particular I see multipart-params mentioned in the docs. I&apos;m using rings instructions now and loo,I got at pedestals tests but it&apos;s a bit unclear "><y>#</y><d>2022-04-02</d><h>22:53</h><r>v3ga</r>In particular I see multipart-params mentioned in the docs.  I&apos;m using rings instructions now and loo,I got at pedestals tests but it&apos;s a bit unclear </z><z id="t1648941227" t="v3ga Oooh I think I&apos;ve got it! xD "><y>#</y><d>2022-04-02</d><h>23:13</h><r>v3ga</r>Oooh I think I&apos;ve got it! xD </z><z id="t1649175054" t="kaffein hey people 👋 … quick question regarding interceptors . I am trying to implement one to process a hmac signature to verify incoming requests on one of my webhooks. And even though I have placed this interceptor as the first in my interceptor stack, I can not seem to be able to retrieve the raw json body of the request from there i.e it is already null at that point. It seems that the underlying Inputstream has already been consumed. Also, I have some other stuff in my interceptors chain for e.g body-params but unfortunately I can not re-build the exact same request body as the original raw one for the hash calculation. What am I missing ? Is there a way for me to have this raw initial json body somehow saved in the context maybe ? thanks in adv."><y>#</y><d>2022-04-05</d><h>16:10</h><w>kaffein</w>hey people <b>👋</b> … quick question regarding <code>interceptors</code> . I am trying to implement one to process a hmac signature to verify incoming requests on one of my webhooks.
And even though I have placed this interceptor as the first in my interceptor stack, I can not seem to be able to retrieve the raw json body of the request from there i.e it is already <code>null</code> at that point.
It seems that the underlying <code>Inputstream</code> has already been consumed. Also, I have some other stuff in my interceptors chain for e.g <code>body-params</code> but unfortunately I can not re-build the exact same request body as the original raw one for the hash calculation.

What am I missing ? Is there a way for me to have this raw initial json body somehow saved in the <code>context</code> maybe ? thanks in adv.</z><z id="t1649175636" t="isak [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}] just call .reset on that inputstream"><y>#</y><d>2022-04-05</d><h>16:20</h><w>isak</w><a>@kaffein</a> just call <code>.reset</code> on that inputstream</z><z id="t1649175683" t="kaffein oh okay, I will try that out [:attrs {:href &quot;/_/_/users/U08JKUHA9&quot;}] :thumbsup: thanks for the hint"><y>#</y><d>2022-04-05</d><h>16:21</h><w>kaffein</w>oh okay, I will try that out <a>@isak</a> <b>:thumbsup:</b> thanks for the hint</z><z id="t1649175740" t="ghadi not always possible, sometimes streams are truly gone"><y>#</y><d>2022-04-05</d><h>16:22</h><w>ghadi</w>not always possible, sometimes streams are truly gone</z><z id="t1649175754" t="ghadi might want to find/replace the interceptor that is doing the slurping"><y>#</y><d>2022-04-05</d><h>16:22</h><w>ghadi</w>might want to find/replace the interceptor that is doing the slurping</z><z id="t1649175771" t="ghadi and make it slurp and hash, or slurp and leave the original"><y>#</y><d>2022-04-05</d><h>16:22</h><w>ghadi</w>and make it slurp and hash, or slurp and leave the original</z></g><g id="s22"><z id="t1649175806" t="isak It should be possible because I have done the same thing, but yea that might be better"><y>#</y><d>2022-04-05</d><h>16:23</h><w>isak</w>It should be possible because I have done the same thing, but yea that might be better</z><z id="t1649175860" t="kaffein oh okay [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] but I guess it might be some interceptor added implicitly by Pedestal then because I have already placed mine at the top of the chain in the service-map."><y>#</y><d>2022-04-05</d><h>16:24</h><w>kaffein</w>oh okay <a>@ghadi</a> but I guess it might be some interceptor added implicitly by Pedestal then because I have already placed mine at the top of the chain in the service-map.</z><z id="t1649520012" t="d Hey, guys 👋 I was trying to run the https://github.com/pedestal/pedestal/tree/master/samples/hello-world with lein run-dev , but requests were throwing an exception: clojure.lang.ExceptionInfo: java.lang.NullPointerException in Interceptor :io.pedestal.http.route/router - Cannot invoke &quot;java.lang.CharSequence.length()&quot; because &quot;this.text&quot; is null lein run worked tho. The problem seems to be at this line: https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32 I had to change this line to ::http/routes #(route/expand-routes (deref #&apos;service/routes)) in order to fix the issue and have an interactive workflow. Am I missing something? Is this a known bug? Should the docs be updated?"><y>#</y><d>2022-04-09</d><h>16:00</h><w>d</w>Hey, guys <b>👋</b>
I was trying to run the <a href="https://github.com/pedestal/pedestal/tree/master/samples/hello-world" target="_blank">https://github.com/pedestal/pedestal/tree/master/samples/hello-world</a> with <code>lein run-dev</code>, but requests were throwing an exception:
<pre>clojure.lang.ExceptionInfo: java.lang.NullPointerException in Interceptor :io.pedestal.http.route/router - Cannot invoke &quot;java.lang.CharSequence.length()&quot; because &quot;this.text&quot; is null</pre>
<code>lein run</code> worked tho. The problem seems to be at this line: <a href="https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32</a>

I had to change this line to <code>::http/routes #(route/expand-routes (deref #&apos;service/routes))</code> in order to fix the issue and have an interactive workflow. Am I missing something? Is this a known bug? Should the docs be updated?</z><z id="t1649560551" t="souenzzo [:attrs {:href &quot;/_/_/users/UHJEMHKFB&quot;}] this line is wrong. I think that you can open a pull request fixing it"><y>#</y><d>2022-04-10</d><h>03:15</h><w>souenzzo</w><a>@andreolvr0</a> this line is wrong. I think that you can open a pull request fixing it</z><z id="t1649612563" t="d Guess someone already tried that, the last commit on that file is from a https://github.com/pedestal/pedestal/pull/668 that removed defroutes and added expand-routes , but just the removal of defroutes landed on master... See the https://github.com/pedestal/pedestal/pull/668#issuecomment-700073719 on the PR, so I&apos;m confused... maybe this is a bug?"><y>#</y><d>2022-04-10</d><h>17:42</h><w>d</w>Guess someone already tried that, the last commit on that file is from a <a href="https://github.com/pedestal/pedestal/pull/668" target="_blank">https://github.com/pedestal/pedestal/pull/668</a>that removed <code>defroutes</code> and added <code>expand-routes</code> , but just the removal of <code>defroutes</code> landed on master... See the <a href="https://github.com/pedestal/pedestal/pull/668#issuecomment-700073719" target="_blank">https://github.com/pedestal/pedestal/pull/668#issuecomment-700073719</a> on the PR, so I&apos;m confused... maybe this is a bug?</z><z id="t1649641051" t="souenzzo this commit introduced the bug https://github.com/pedestal/pedestal/commit/50fe5ea89108998ac5a79a02a44432fd111ea6f8 I think that a PR that only change this line can be merged https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32 The PR #668 proposed to change port and many other unwanted changes."><y>#</y><d>2022-04-11</d><h>01:37</h><r>souenzzo</r>this commit introduced the bug
<a href="https://github.com/pedestal/pedestal/commit/50fe5ea89108998ac5a79a02a44432fd111ea6f8" target="_blank">https://github.com/pedestal/pedestal/commit/50fe5ea89108998ac5a79a02a44432fd111ea6f8</a>
I think that a PR that only change this line can be merged
<a href="https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32</a>

The PR #668 proposed to change port and many other unwanted changes.</z><z id="t1649612618" t="d But the http://pedestal.io/guides/hello-world#_routes uses expand-route :man-shrugging:"><y>#</y><d>2022-04-10</d><h>17:43</h><w>d</w>But the<a href="http://pedestal.io/guides/hello-world#_routes" target="_blank">http://pedestal.io/guides/hello-world#_routes</a> uses expand-route <b>:man-shrugging:</b></z><z id="t1649660843" t="Ho0man Hi everyone, Is there a way to change the pedestal log level ? or limit the amount of logs it produces ? or direct to those files to some file ? Thanks a lot"><y>#</y><d>2022-04-11</d><h>07:07</h><w>Ho0man</w>Hi everyone,
Is there a way to change the pedestal log level ?
or limit the amount of logs it produces ?
or direct to those files to some file ?
Thanks a lot</z><z id="t1649663460" t="v3ga Yes... funny enough this article helped me clear up all the noise. Scroll until you see &quot;Fix logging noise&quot; https://shivekkhurana.medium.com/learn-clojure-by-building-a-drug-dealer-api-part-2-de8c47512a71"><y>#</y><d>2022-04-11</d><h>07:51</h><r>v3ga</r>Yes... funny enough this article helped me clear up all the noise.  Scroll until you see &quot;Fix logging noise&quot; <a href="https://shivekkhurana.medium.com/learn-clojure-by-building-a-drug-dealer-api-part-2-de8c47512a71" target="_blank">https://shivekkhurana.medium.com/learn-clojure-by-building-a-drug-dealer-api-part-2-de8c47512a71</a></z><z id="t1649667035" t="Ho0man Thanks a lot [:attrs {:href &quot;/_/_/users/U06FM9QN9&quot;}] It helped a lot"><y>#</y><d>2022-04-11</d><h>08:50</h><r>Ho0man</r>Thanks a lot <a>@U06FM9QN9</a> 
It helped a lot</z><z id="t1649742104" t="jtth Is Vase basically archived? "><y>#</y><d>2022-04-12</d><h>05:41</h><w>jtth</w>Is Vase basically archived? </z><z id="t1649809837" t="jtth Can anyone give advice on how to redirect a static route to a resource (“index.html”)? I’m not sure where to slurp the file from when running in prod from an uberjar (which packages the contents of the resources folder)"><y>#</y><d>2022-04-13</d><h>00:30</h><w>jtth</w>Can anyone give advice on how to redirect a static route to a resource (“index.html”)? I’m not sure where to <code>slurp</code> the file from when running in prod from an uberjar (which packages the contents of the resources folder)</z><z id="t1649810089" t="jtth Solved my own problem: (defn home-page [request] (-&gt; (ring-resp/response (str (slurp ( &quot;public/index.html&quot;)))) (ring-resp/content-type &quot;text/html&quot;))) Though if anyone knows about something simpler to just do the redirect that’d be neat."><y>#</y><d>2022-04-13</d><h>00:34</h><r>jtth</r>Solved my own problem:

<pre>(defn home-page
  [request]
  (-&gt; (ring-resp/response
        (str (slurp ( &quot;public/index.html&quot;))))
      (ring-resp/content-type &quot;text/html&quot;)))</pre>
Though if anyone knows about something simpler to just do the redirect that’d be neat.</z><z id="t1650026629" t="emccue (defn home-page [request] (response/redirect &quot;public/index.html&quot;)) If you serve the resource in addition on that path"><y>#</y><d>2022-04-15</d><h>12:43</h><r>emccue</r><pre>(defn home-page
  [request]
  (response/redirect &quot;public/index.html&quot;))</pre>
If you serve the resource in addition on that path</z><z id="t1649810089" t="jtth Solved my own problem: (defn home-page [request] (-&gt; (ring-resp/response (str (slurp ( &quot;public/index.html&quot;)))) (ring-resp/content-type &quot;text/html&quot;))) Though if anyone knows about something simpler to just do the redirect that’d be neat."><y>#</y><d>2022-04-13</d><h>00:34</h><w>jtth</w>Solved my own problem:

<pre>(defn home-page
  [request]
  (-&gt; (ring-resp/response
        (str (slurp ( &quot;public/index.html&quot;))))
      (ring-resp/content-type &quot;text/html&quot;)))</pre>
Though if anyone knows about something simpler to just do the redirect that’d be neat.</z><z id="t1650101755" t="sb I would like to use “X-HTTP-Method-Override” in Pedestal. I see that is needed an extra setup. I found one at RING case (defn wrap-method-override &quot;Ring middleware for method overriding (X-HTTP-Method-Override)&quot; [handler] (fn [req] (let [x-http-method (get (-&gt; req :headers) &quot;x-http-method-override&quot; &quot;&quot;)] (if (contains? #{&quot;delete&quot; &quot;put&quot;} (string/lower-case x-http-method)) (handler (if x-http-method (assoc req :request-method (keyword (string/lower-case x-http-method))) req)) (handler req))))) [from ithaka]. Example request (ajax-request {:uri &quot;/api/post-get&quot; ;; both exist here, get and post :method :post :headers {&quot;X-HTTP-Method-Override&quot; &quot;GET&quot;} :params {:q &quot;something here&quot;} :handler (fn [data] (js/console.log &quot;success2 &quot; data)) :error-handler (fn [data] (js/console.log &quot;error &quot; data)) :format (ajax.json/json-request-format) :response-format (ajax.json/json-response-format)}) when I call, I see in the logs POST request, which is normally np.. because I can send back data in this way. Just I really want to understand why I can’t mod the method. I use Jetty + Pedestal. Any idea, maybe I need to write an interceptor or I need to add at Jetty side something (like Ring)? Maybe at :io.pedestal.http.jetty/http-configuration side (container options)?"><y>#</y><d>2022-04-16</d><h>09:35</h><w>sb</w>I would like to use “X-HTTP-Method-Override” in Pedestal. I see that is needed an extra setup. I found one at RING case
<pre>(defn wrap-method-override
  &quot;Ring middleware for method overriding (X-HTTP-Method-Override)&quot;
  [handler]
  (fn [req]
    (let [x-http-method (get (-&gt; req :headers) &quot;x-http-method-override&quot; &quot;&quot;)]
      (if (contains? #{&quot;delete&quot; &quot;put&quot;} (string/lower-case x-http-method))
        (handler (if x-http-method (assoc req :request-method (keyword (string/lower-case x-http-method))) req))
        (handler req)))))</pre>
[from ithaka]. Example request
<pre>(ajax-request
  {:uri             &quot;/api/post-get&quot; ;; both exist here, get and post
   :method          :post
   :headers         {&quot;X-HTTP-Method-Override&quot; &quot;GET&quot;}
   :params          {:q  &quot;something here&quot;}
   :handler         (fn [data]
                      (js/console.log &quot;success2 &quot; data))
   :error-handler   (fn [data]
                      (js/console.log &quot;error &quot; data))
   :format          (ajax.json/json-request-format)
   :response-format (ajax.json/json-response-format)})</pre>
when I call, I see in the logs POST request, which is normally np.. because I can send back data in this way. Just I really want to understand why I can’t mod the method. I use Jetty + Pedestal. Any idea, maybe I need to write an interceptor or I need to add at Jetty side something (like Ring)? Maybe at
<pre>:io.pedestal.http.jetty/http-configuration </pre>
side (container options)?</z><z id="t1650106554" t="sb Ofc, I can route POST to GET on server side, just my question is, is that possible in real change/ mod the method or not."><y>#</y><d>2022-04-16</d><h>10:55</h><r>sb</r>Ofc, I can route POST to GET on server side, just my question is, is that possible in real change/ mod the method or not.</z><z id="t1650215221" t="camdez [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] I’m not deeply knowledgeable here, but the original request map uses :method whereas the middleware assoc es :request-method . Possibly just that?"><y>#</y><d>2022-04-17</d><h>17:07</h><r>camdez</r><a>@U2T2ZEVPC</a> I’m not deeply knowledgeable here, but the original request map uses <code>:method</code> whereas the middleware <code>assoc</code>es <code>:request-method</code>. Possibly just that?</z><z id="t1650247851" t="sb Thanks I check it!"><y>#</y><d>2022-04-18</d><h>02:10</h><r>sb</r>Thanks I check it!</z><z id="t1650102538" t="sb Ps. I tested with js/fetch too, same result."><y>#</y><d>2022-04-16</d><h>09:48</h><w>sb</w>Ps. I tested with js/fetch too, same result.</z><z id="t1650419568" t="quan xing Would you recommend an open source project that uses pedestal?"><y>#</y><d>2022-04-20</d><h>01:52</h><w>quan xing</w>Would you recommend an open source project that uses pedestal?</z><z id="t1650960003" t="tomekw Is it possible to match /foo , /foo/ , and /foo/:bar with one route def with optional :bar ? :thinking_face:"><y>#</y><d>2022-04-26</d><h>08:00</h><w>tomekw</w>Is it possible to match <code>/foo</code>, <code>/foo/</code>, and <code>/foo/:bar</code> with one route def with optional <code>:bar</code>? <b>:thinking_face:</b></z><z id="t1650963987" t="Linus Ericsson no, i really don&apos;t think so."><y>#</y><d>2022-04-26</d><h>09:06</h><r>Linus Ericsson</r>no, i really don&apos;t think so.</z><z id="t1650988762" t="quan xing I defined routes : (defn login [request] (log/info request)) (def routes #{[&quot;/design_unit/register&quot; :get register :route-name :resgister] [&quot;/design_unit/saveleader&quot; :get (conj inter/common-interceptors `save-leader)] [&quot;/login&quot; :post [inter/common-interceptors `login]] }) but run error: Syntax error (AssertionError) compiling at (app\server.clj:6:1). Assert failed: In row 9, the vector of handlers should have been a bunch of interceptors but was [[#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body}] app.design-unit.bzarea.handler/login]. The whole route was: [&quot;/login&quot; :post [[#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body}] app.design-unit.bzarea.handler/login] :route-name :login] (every? (fn* [p1__11405#] (satisfies? interceptor/IntoInterceptor p1__11405#)) handlers) I&apos;m referring to this URL http://pedestal.io/reference/routing-quick-reference use conj is ok ,but use [] is reoprt error."><y>#</y><d>2022-04-26</d><h>15:59</h><w>quan xing</w>I defined routes :
<pre>(defn login
  [request]
  (log/info request))

(def routes #{[&quot;/design_unit/register&quot; :get register :route-name :resgister]
              [&quot;/design_unit/saveleader&quot; 
               :get (conj inter/common-interceptors `save-leader)]
              
              [&quot;/login&quot; :post [inter/common-interceptors `login]]
              })</pre>
but run error:
<pre>Syntax error (AssertionError) compiling at (app\server.clj:6:1).
Assert failed: In row 9, the vector of handlers should have been a bunch of interceptors but was [[#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body}] app.design-unit.bzarea.handler/login].
The whole route was: [&quot;/login&quot; :post [[#Interceptor{:name :io.pedestal.http.body-params/body-params} #Interceptor{:name :io.pedestal.http/html-body}] app.design-unit.bzarea.handler/login] :route-name :login]
(every? (fn* [p1__11405#] (satisfies? interceptor/IntoInterceptor p1__11405#)) handlers)</pre>
I&apos;m referring to this URL <a href="http://pedestal.io/reference/routing-quick-reference" target="_blank">http://pedestal.io/reference/routing-quick-reference</a>
use conj is ok ,but use [] is reoprt error.</z><z id="t1650990659" t="Braden Shepherdson that spot in the route is supposed to be either a function (`register`) or a list of interceptors. (conj inter/common-interceptors &apos;save-leader) returns a list, with save-leader at the end."><y>#</y><d>2022-04-26</d><h>16:30</h><r>Braden Shepherdson</r>that spot in the route is supposed to be either a function (`register`) or a list of interceptors. <code>(conj inter/common-interceptors &apos;save-leader)</code> returns a list, with <code>save-leader</code> at the end.</z><z id="t1650990694" t="Braden Shepherdson but if the common-interceptors is [a b c] , the broken /login route&apos;s list looks like this [[a b c] &apos;login] , which isn&apos;t right."><y>#</y><d>2022-04-26</d><h>16:31</h><r>Braden Shepherdson</r>but if the <code>common-interceptors</code> is <code>[a b c]</code>, the broken <code>/login</code> route&apos;s list looks like this <code>[[a b c] &apos;login]</code>, which isn&apos;t right.</z><z id="t1651070914" t="quan xing ok Thanks!"><y>#</y><d>2022-04-27</d><h>14:48</h><r>quan xing</r>ok Thanks!</z><z id="t1651830378" t="tomekw What&apos;s the idiomatic way to catch all exceptions using error-dispatch so I could display the full stack trace in the dev mode and custom error page in prod? :thinking_face:"><y>#</y><d>2022-05-06</d><h>09:46</h><w>tomekw</w>What&apos;s the idiomatic way to catch all exceptions using <code>error-dispatch</code> so I could display the full stack trace in the dev mode and custom error page in prod? <b>:thinking_face:</b></z><z id="t1651832055" t="tomekw (def error-handler-intc (error/error-dispatch [ctx ex] :else (assoc ctx :response (ok (app-layout [:div [:h2 (ex-message ex)] [:pre (with-out-str (trace/print-stack-trace ex))]]))))) ?"><y>#</y><d>2022-05-06</d><h>10:14</h><r>tomekw</r><pre>(def error-handler-intc
  (error/error-dispatch [ctx ex]
                        :else (assoc ctx :response (ok (app-layout [:div
                                                                    [:h2 (ex-message ex)]
                                                                    [:pre (with-out-str (trace/print-stack-trace ex))]])))))</pre>
?</z><z id="t1651840489" t="ddeaguiar [:attrs {:href &quot;/_/_/users/U030521UZ1N&quot;}] I’d use a separate error handling interceptor for dev as opposed to using env-based dispatch. For example, Pedestal’s http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-dev-interceptors will return a response with the stack trace. You can include them in your dev interceptors."><y>#</y><d>2022-05-06</d><h>12:34</h><r>ddeaguiar</r><a>@U030521UZ1N</a> I’d use a separate error handling interceptor for dev as opposed to using env-based dispatch. For example, Pedestal’s <a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-dev-interceptors" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-dev-interceptors</a> will return a response with the stack trace. You can include them in your dev interceptors.</z><z id="t1651841619" t="tomekw thx [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] !"><y>#</y><d>2022-05-06</d><h>12:53</h><r>tomekw</r>thx <a>@U0FL657GR</a>!</z><z id="t1653219041" t="simongray I run a Pedestal+Jetty service on a production Linux server with a reverse proxy in front of it (Caddy) exposing the service on the Internet through ports 80/443. When I create the service, I can either use the value “0.0.0.0” or “127.0.0.1&quot; for the ::http/host key in the service map. Using “0.0.0.0” provides some advantages during development on my Mac (no reverse proxy involved), since I can then access the website served by the Pedestal service using my phone to test out how it looks on a phone. This is not possible if I use “127.0.0.1&quot;, so I definitely want to use “0.0.0.0” during dev. However, I am unsure whether this is a bad idea for the production server? I have tried reading up on this, but networking is to me a domain that is incredibly jargon-heavy while also being fairly orthogonal to what I spend the rest of my time on, that I really can’t make heads or tails of what I am reading."><y>#</y><d>2022-05-22</d><h>11:30</h><w>simongray</w>I run a Pedestal+Jetty service on a production Linux server with a reverse proxy in front of it (Caddy) exposing the service on the Internet through ports 80/443. When I create the service, I can either use the value “0.0.0.0” or “127.0.0.1&quot; for the <code>::http/host</code> key in the service map.

Using “0.0.0.0” provides some advantages during development on my Mac (no reverse proxy involved), since I can then access the website served by the Pedestal service using my phone to test out how it looks on a phone. This is not possible if I use “127.0.0.1&quot;, so I definitely want to use “0.0.0.0” during dev.

However, I am unsure whether this is a bad idea for the production server? I have tried reading up on this, but networking is to me a domain that is incredibly jargon-heavy while also being fairly orthogonal to what I spend the rest of my time on, that I really can’t make heads or tails of what I am reading.</z><z id="t1653228760" t="jkxyz You generally want to limit the number of processes which are listening for connections from the public internet. So if you have Caddy in front of your service then the service only needs to listen on 127.0.0.1, and it therefore can&apos;t receive malicious connection attempts which circumvent Caddy. The localhost interface is not exposed to the public internet at all. This is more about security in depth though since you probably have a firewall which is whitelisting ports 80/443 "><y>#</y><d>2022-05-22</d><h>14:12</h><r>jkxyz</r>You generally want to limit the number of processes which are listening for connections from the public internet. So if you have Caddy in front of your service then the service only needs to listen on 127.0.0.1, and it therefore can&apos;t receive malicious connection attempts which circumvent Caddy. The localhost interface is not exposed to the public internet at all. This is more about security in depth though since you probably have a firewall which is whitelisting ports 80/443 </z><z id="t1653232497" t="simongray Ok, thanks a lot. 🙂"><y>#</y><d>2022-05-22</d><h>15:14</h><r>simongray</r>Ok, thanks a lot. <b>🙂</b></z><z id="t1653990626" t="tomekw I think the best idea is to either set :http/host based on some config variable (`ENV=prod` vs ENV=dev ) or always use 127.0.0.1 and use something like ngrok to expose your local env when needed. I guess the latter is a better idea"><y>#</y><d>2022-05-31</d><h>09:50</h><r>tomekw</r>I think the best idea is to either set <code>:http/host</code> based on some config variable (`ENV=prod` vs <code>ENV=dev</code>) or always use 127.0.0.1 and use something like ngrok to expose your local env when needed. I guess the latter is a better idea</z><z id="t1653998969" t="simongray Definitely"><y>#</y><d>2022-05-31</d><h>12:09</h><r>simongray</r>Definitely</z><z id="t1653660333" t="Shivam A Is there any interceptor available which converts vector /map to json string"><y>#</y><d>2022-05-27</d><h>14:05</h><w>Shivam A</w>Is there any interceptor available which converts vector /map to json string</z><z id="t1653662018" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U03ED4AHTLK&quot;}] , checkout the http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-json-body interceptor."><y>#</y><d>2022-05-27</d><h>14:33</h><r>ddeaguiar</r>Hi <a>@U03ED4AHTLK</a>, checkout the <a href="http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-json-body" target="_blank">http://pedestal.io/api/pedestal.service/io.pedestal.http.html#var-json-body</a> interceptor.</z><z id="t1653662406" t="Shivam A Thanks [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}]"><y>#</y><d>2022-05-27</d><h>14:40</h><r>Shivam A</r>Thanks <a>@U0FL657GR</a></z><z id="t1653831772" t="Shivam A I am getting Uneven number of Pattern Rows. The last form (assoc ctx :io.pedestal.interceptor.chain/error ex)` seems out of place.` error when doing error-dispatch as mentioned in this page http://pedestal.io/reference/error-handling"><y>#</y><d>2022-05-29</d><h>13:42</h><w>Shivam A</w>I am getting
<code>Uneven number of Pattern Rows. The last form </code>(assoc ctx :io.pedestal.interceptor.chain/error ex)` seems out of place.` error when doing error-dispatch as mentioned in this page <a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a></z><z id="t1653876646" t="Linus Ericsson Do you have the keyword :else before that row? Its not a comment"><y>#</y><d>2022-05-30</d><h>02:10</h><r>Linus Ericsson</r>Do you have the keyword :else before that row? Its not a comment</z><z id="t1653886205" t="Shivam A Yes :else is missing, I didn&apos;t notice that. Thanks"><y>#</y><d>2022-05-30</d><h>04:50</h><r>Shivam A</r>Yes :else is missing, I didn&apos;t notice that. Thanks</z><z id="t1654617210" t="tomekw I guess when I want to pass deps to interceptors when I have pass them to the &quot;routes&quot; fn? I mean: server -&gt; service-map -&gt; routes -&gt; interceptors?"><y>#</y><d>2022-06-07</d><h>15:53</h><w>tomekw</w>I guess when I want to pass deps to interceptors when I have pass them to the &quot;routes&quot; fn? I mean: server -&gt; service-map -&gt; routes -&gt; interceptors?</z><z id="t1654625407" t="dangercoder That&apos;s how I do it, you can create a generic interceptor that injects &quot;components&quot; into your context so you can reach them in later interceptors, e.g. :system.components/db :system.components/producer"><y>#</y><d>2022-06-07</d><h>18:10</h><r>dangercoder</r>That&apos;s how I do it, you can create a generic interceptor that injects &quot;components&quot; into your context so you can reach them in later interceptors, e.g.

<code>:system.components/db</code>
<code>:system.components/producer</code></z><z id="t1654626372" t="tomekw thx, that&apos;s what I&apos;ve done actually 🙂"><y>#</y><d>2022-06-07</d><h>18:26</h><r>tomekw</r>thx, that&apos;s what I&apos;ve done actually <b>🙂</b></z><z id="t1656059501" t="simongray I am trying to transform my production web service from using clojure to compiling an uberjar and running this using java -jar . Apparently, this is wreaking havoc on file access! The latest issue I am running into is that rather than serving my main.css , which is served fine when running in the REPL, I get servedanother main.css from the resource path. This other main.css is brought in by a library. I have have this set in my context map: ::http/resource-path &quot;/public&quot; In my HTML I have &lt;link href=&quot;/css/main.css&quot; rel=&quot;stylesheet&quot;&gt; , but Pedestal fetches the [:attrs nil] at /public/css/main.css rather than the [:attrs nil] in the same path."><y>#</y><d>2022-06-24</d><h>08:31</h><w>simongray</w>I am trying to transform my production web service from using <code>clojure</code> to compiling an uberjar and running this using <code>java -jar</code> . Apparently, this is wreaking havoc on file access!

The latest issue I am running into is that rather than serving my <code>main.css</code>, which is served fine when running in the REPL, I get servedanother <code>main.css</code> from the resource path. This other main.css is brought in by a library. I have have this set in my context map:
<pre>::http/resource-path  &quot;/public&quot;</pre>
In my HTML I have <code>&lt;link href=&quot;/css/main.css&quot; rel=&quot;stylesheet&quot;&gt;</code> , but Pedestal fetches the <b>resource</b> at <code>/public/css/main.css</code> rather than the <b>file</b> in the same path.</z><z id="t1656060413" t="simongray TL;DR Pedestal serves me random resources in libraries rather than the CSS file that’s on disk. How can I make it serve me files on disk?"><y>#</y><d>2022-06-24</d><h>08:46</h><w>simongray</w>TL;DR Pedestal serves me random resources in libraries rather than the CSS file that’s on disk. How can I make it serve me files on disk?</z><z id="t1656061075" t="simongray Do I seriously need to write a custom classloader just to get Pedestal to prefer files on disk…? 😮"><y>#</y><d>2022-06-24</d><h>08:57</h><w>simongray</w>Do I seriously need to write a custom classloader just to get Pedestal to prefer files on disk…? <b>😮</b></z><z id="t1656062609" t="rolt i&apos;m not entirely sure, but have you tried ::http/file-path ?"><y>#</y><d>2022-06-24</d><h>09:23</h><w>rolt</w>i&apos;m not entirely sure, but have you tried <code>::http/file-path</code> ?</z><z id="t1656062894" t="simongray [:attrs {:href &quot;/_/_/users/U02F0C62TC1&quot;}] oh, I did not know about this. Gonna try this out! Thanks."><y>#</y><d>2022-06-24</d><h>09:28</h><w>simongray</w><a>@rolthiolliere</a> oh, I did not know about this. Gonna try this out! Thanks.</z><z id="t1656063675" t="rolt however if the css file is linked to the app you may want to deliver it the the jar as a resource anyway. I would assume that if you set the resource path correctly in the uberjar conf it would prefer the app&apos;s resources to a lib&apos;s resources when there is a conflict"><y>#</y><d>2022-06-24</d><h>09:41</h><w>rolt</w>however if the css file is linked to the app you may want to deliver it the the jar as a resource anyway. I would assume that if you set the resource path correctly in the uberjar conf it would prefer the app&apos;s resources to a lib&apos;s resources when there is a conflict</z><z id="t1656063714" t="simongray Yeah, I learned some more about resource paths over in #clojure-europe so I guess I can just make a different directory structure to avoid the shadowing entirely: https://clojurians.slack.com/archives/CBJ5CGE0G/p1656063632492859"><y>#</y><d>2022-06-24</d><h>09:41</h><w>simongray</w>Yeah, I learned some more about resource paths over in #clojure-europe so I guess I can just make a different directory structure to avoid the shadowing entirely: <a href="https://clojurians.slack.com/archives/CBJ5CGE0G/p1656063632492859" target="_blank">https://clojurians.slack.com/archives/CBJ5CGE0G/p1656063632492859</a></z><z id="t1656434004" t="kishima Hello, is it possible to receive a request with content-type application/octet-stream and read its body directly as a byte-array? When I perform the request, I receive an HTTPInputOverHttp. I see it is an InputStream and maybe I can convert it in an interceptor, but it seems that it would be possible to receive it directly as a stream (I might be wrong though)"><y>#</y><d>2022-06-28</d><h>16:33</h><w>kishima</w>Hello, is it possible to receive a request with content-type <code>application/octet-stream</code> and read its body directly as a byte-array?
When I perform the request, I receive an HTTPInputOverHttp. I see it is an InputStream and maybe I can convert it in an interceptor, but it seems that it would be possible to receive it directly as a stream (I might be wrong though)</z><z id="t1656440772" t="souenzzo (defn get-handler [{:keys [^InputStream body]}] (let [byte-array (.toByteArray (with-open [baos (ByteArrayOutputStream.)] (.transferTo body baos) baos))] ....)) Something like that. In JVM8, you can use (io/copy body baos)"><y>#</y><d>2022-06-28</d><h>18:26</h><r>souenzzo</r><pre>(defn get-handler
  [{:keys [^InputStream body]}]
  (let [byte-array (.toByteArray  (with-open [baos (ByteArrayOutputStream.)]
                                    (.transferTo body baos)
                                    baos))]
    ....))</pre>
Something like that.

In JVM8, you can use <code>(io/copy body baos)</code></z><z id="t1656523719" t="richiardiandrea Hi folks, we have a problem here, basically GET returns an unescaped path parameter. I see that there is a test in the repo to validate that happens, what can be the issue, any suggestion on how to debug?"><y>#</y><d>2022-06-29</d><h>17:28</h><w>richiardiandrea</w>Hi folks, we have a problem here, basically <code>GET </code> returns an unescaped path parameter.

I see that there is a test in the repo to validate that happens, what can be the issue, any suggestion on how to debug?</z><z id="t1656558342" t="souenzzo https://gist.github.com/souenzzo/5c1ad0b3613c029b4d70900862e769e6"><y>#</y><d>2022-06-30</d><h>03:05</h><r>souenzzo</r><a href="https://gist.github.com/souenzzo/5c1ad0b3613c029b4d70900862e769e6" target="_blank">https://gist.github.com/souenzzo/5c1ad0b3613c029b4d70900862e769e6</a></z><z id="t1656962653" t="richiardiandrea yes I would expect the :path-params to be &quot;Some Body&quot;"><y>#</y><d>2022-07-04</d><h>19:24</h><r>richiardiandrea</r>yes I would expect the <code>:path-params</code> to be <code>&quot;Some Body&quot;</code></z><z id="t1656963299" t="souenzzo I think that in most browsers, you can send /Some Body and it will work"><y>#</y><d>2022-07-04</d><h>19:34</h><r>souenzzo</r>I think that in most browsers, you can send <code>/Some Body</code> and it will work</z><z id="t1657488994" t="Ian Fernandez How can I debug which is the interceptor that is breaking when I have this error? Assert failed: (valid-interceptor? %)"><y>#</y><d>2022-07-10</d><h>21:36</h><w>Ian Fernandez</w>How can I debug which is the interceptor that is breaking when I have this error?
<code>Assert failed: (valid-interceptor? %)</code></z><z id="t1657495644" t="souenzzo Can you share the first line of the stacktrace"><y>#</y><d>2022-07-10</d><h>23:27</h><r>souenzzo</r>Can you share the first line of the stacktrace</z><z id="t1657496691" t="Ian Fernandez Got working , I was having a variable instead of a function in the routes vector "><y>#</y><d>2022-07-10</d><h>23:44</h><r>Ian Fernandez</r>Got working , I was having a variable instead of a function in the routes vector </z><z id="t1657496749" t="Ian Fernandez It would be good to have a better stacktrace for this case "><y>#</y><d>2022-07-10</d><h>23:45</h><r>Ian Fernandez</r>It would be good to have a better stacktrace for this case </z><z id="t1657496691" t="Ian Fernandez Got working , I was having a variable instead of a function in the routes vector "><y>#</y><d>2022-07-10</d><h>23:44</h><w>Ian Fernandez</w>Got working , I was having a variable instead of a function in the routes vector </z><z id="t1657496749" t="Ian Fernandez It would be good to have a better stacktrace for this case "><y>#</y><d>2022-07-10</d><h>23:45</h><w>Ian Fernandez</w>It would be good to have a better stacktrace for this case </z><z id="t1658519859" t="Ian Fernandez :io.pedestal.http.secure-headers/secure-headers - Key must be integer"><y>#</y><d>2022-07-22</d><h>19:57</h><w>Ian Fernandez</w>:io.pedestal.http.secure-headers/secure-headers - Key must be integer</z><z id="t1658519873" t="Ian Fernandez I&apos;m having this error, what does it mean?"><y>#</y><d>2022-07-22</d><h>19:57</h><w>Ian Fernandez</w>I&apos;m having this error, what does it mean?</z><z id="t1658521112" t="ghadi you need a full stack trace"><y>#</y><d>2022-07-22</d><h>20:18</h><w>ghadi</w>you need a full stack trace</z><z id="t1658521115" t="ghadi *e"><y>#</y><d>2022-07-22</d><h>20:18</h><w>ghadi</w><code>*e</code></z><z id="t1658521150" t="ghadi but, what that&apos;s trying to tell you is that there is a call to assoc to a vector, and you can only assoc to integer keys in the vector"><y>#</y><d>2022-07-22</d><h>20:19</h><w>ghadi</w>but, what that&apos;s trying to tell you is that there is a call to assoc to a vector, and you can only assoc to integer keys in the vector</z><z id="t1658521158" t="ghadi but your code has passed that keyword instead"><y>#</y><d>2022-07-22</d><h>20:19</h><w>ghadi</w>but your code has passed that keyword instead</z><z id="t1658521201" t="ghadi (assoc [:foo :bar :baz] :quux 42) instead of (assoc [:foo :bar :baz] 0 42)"><y>#</y><d>2022-07-22</d><h>20:20</h><w>ghadi</w><code>(assoc [:foo :bar :baz] :quux 42)</code> instead of
<code>(assoc [:foo :bar :baz] 0 42)</code></z><z id="t1658533368" t="Ian Fernandez thanks 🙂"><y>#</y><d>2022-07-22</d><h>23:42</h><w>Ian Fernandez</w>thanks <b>🙂</b></z><z id="t1658533852" t="Ian Fernandez the stacktrace couldn&apos;t be found in *e [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2022-07-22</d><h>23:50</h><w>Ian Fernandez</w>the stacktrace couldn&apos;t be found in <code>*e</code> <a>@ghadi</a></z><z id="t1659613327" t="Lennart Buit *e is a special variable set to the last exception in REPLs. Depending on where you are trying to reference that, it might not be bound."><y>#</y><d>2022-08-04</d><h>11:42</h><w>Lennart Buit</w><code>*e</code> is a special variable set to the last exception in REPLs. Depending on where you are trying to reference that, it might not be bound.</z><z id="t1661195534" t="dangercoder does anyone have a version of io.pedestal.test/response-for laying around which lets you pass in a context? else I’ll build one 😄"><y>#</y><d>2022-08-22</d><h>19:12</h><w>dangercoder</w>does anyone have a version of <code>io.pedestal.test/response-for</code> laying around which lets you pass in a context? else I’ll build one <b>😄</b></z><z id="t1661204294" t="souenzzo [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] the idea of response-for is to call your application as it curl was calling it"><y>#</y><d>2022-08-22</d><h>21:38</h><r>souenzzo</r><a>@UBN9SNVB4</a> the idea of response-for is to call your application as it <code>curl</code> was calling it</z><z id="t1661204322" t="souenzzo if you implement this feature, response-for will be equivalent to simply call the function handler/the interceptor chain"><y>#</y><d>2022-08-22</d><h>21:38</h><r>souenzzo</r>if you implement this feature, response-for will be equivalent to simply call the function handler/the interceptor chain</z><z id="t1661204358" t="souenzzo why you can&apos;t pass (response-for ... :body (t/write-str {:username ...}))"><y>#</y><d>2022-08-22</d><h>21:39</h><r>souenzzo</r>why you can&apos;t pass <code>(response-for ... :body (t/write-str {:username ...}))</code></z><z id="t1661204373" t="souenzzo and :headers {&quot;my-session&quot; &quot;....&quot;}"><y>#</y><d>2022-08-22</d><h>21:39</h><r>souenzzo</r>and <code>:headers {&quot;my-session&quot; &quot;....&quot;}</code></z><z id="t1661233597" t="dangercoder Hi thanks for the answer [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , I had another thought about it and I agree it just calls the interceptor chain, but there is value in testing the “whole chain” with the routes etc. The problem here is session really, the user is expected to have a session. I could make it so that I attach an interceptor which adds a session when I’m in test mode. Then I could still use response-for without any changes"><y>#</y><d>2022-08-23</d><h>05:46</h><r>dangercoder</r>Hi thanks for the answer <a>@U2J4FRT2T</a>, I had another thought about it and I agree it just calls the interceptor chain, but there is value in testing the “whole chain” with the routes etc.

The problem here is session really, the user is expected to have a session. I could make it so that I attach an interceptor which adds a session when I’m in test mode. Then I could still use response-for without any changes</z><z id="t1661249010" t="rolt how do you expect the end user to pass the session ? it has to be through http related fields, cookies or headers anyway. Or do you want to mock this ? Note: the routes are part of the interceptor chain"><y>#</y><d>2022-08-23</d><h>10:03</h><r>rolt</r>how do you expect the end user to pass the session ? it has to be through http related fields, cookies or headers anyway. Or do you want to mock this ?
Note: the routes are part of the interceptor chain</z><z id="t1661241676" t="Thomas Moerman Hi folks, I&apos;m interested in learning more about interceptors. I understand the mechanics, but what I&apos;m looking for are some heuristics on how to write interceptors the idiomatic way. E.g. what goes where: which logic is typically performed in the :enter fn opposed to the :leave fn, where do side-effects go, etc. For instance: you could append a persistence interceptor at the end of the chain, performing db transactions in :enter, or you could write an interceptor that does this in the :leave fn, and put it at the start of the chain (using the :enter fn of that interceptor to perform some setup logic, for example). Any resources or pointers that come to mind? I&apos;m reading the book &quot;Microservices with Clojure&quot;, the author rarely uses the :leave fn, hence my question. Thanks."><y>#</y><d>2022-08-23</d><h>08:01</h><w>Thomas Moerman</w>Hi folks, I&apos;m interested in learning more about interceptors. I understand the mechanics, but what I&apos;m looking for are some heuristics on how to write interceptors the idiomatic way. E.g. what goes where: which logic is typically performed in the :enter fn opposed to the :leave fn, where do side-effects go, etc. For instance: you could append a persistence interceptor at the end of the chain, performing db transactions in :enter, or you could write an interceptor that does this in the :leave fn, and put it at the start of the chain (using the :enter fn of that interceptor to perform some setup logic, for example). Any resources or pointers that come to mind? I&apos;m reading the book &quot;Microservices with Clojure&quot;, the author rarely uses the :leave fn, hence my question. Thanks.</z><z id="t1661265746" t="hanDerPeder The way i think of it is enter runs before a decision and leave runs after. So you would generally fetch all the things you need to make a decision in enter , make your decision in a (pure) handler, then fire off effects in leave . "><y>#</y><d>2022-08-23</d><h>14:42</h><r>hanDerPeder</r>The way i think of it is <code>enter</code> runs before a decision and <code>leave</code> runs after. So you would generally fetch all the things you need to make a decision in <code>enter</code>, make your decision in a (pure) handler, then fire off effects in <code>leave</code>. </z><z id="t1661279252" t="Thomas Moerman Thanks, [:attrs {:href &quot;/_/_/users/U013U475882&quot;}] that makes sense."><y>#</y><d>2022-08-23</d><h>18:27</h><r>Thomas Moerman</r>Thanks, <a>@U013U475882</a> that makes sense.</z><z id="t1661646090" t="hlship And the trick is, if your leave needs information determined during enter it must assoc that into the context map. I generally assoc with a namespace-qualified (aka private) key, e.g. (assoc context ::user-id user-id) or whatever you need."><y>#</y><d>2022-08-28</d><h>00:21</h><r>hlship</r>And the trick is, if your <code>leave</code> needs information determined during <code>enter</code> it must <code>assoc</code> that into the context map.  I generally assoc with a namespace-qualified (aka private) key, e.g. <code>(assoc context ::user-id user-id)</code>  or whatever you need.</z><z id="t1661433163" t="V I am currently trying to create my own version of s3-presigned-url. Where a client can receive and signed-URL and upload their file via the URL and a PUT request. The link generation has gone fine and I can reach my server. I am using pedestal. However it&apos;s the file itself I am having a hard time figuring out how to handle. I send the request where the body is the binary file. But what I receive is an org.eclipse.jetty.server.HttpInputOverHTTP object which I have no idea how to handle. I would really like not to switch away from using a PUT request, so is there anybody who can help me on how to handle this, maybe with an interceptor?"><y>#</y><d>2022-08-25</d><h>13:12</h><w>V</w>I am currently trying to create my own version of s3-presigned-url. Where a client can receive and signed-URL and upload their file via the URL and a PUT request. The link generation has gone fine and I can reach my server. I am using pedestal. However it&apos;s the file itself I am having a hard time figuring out how to handle. I send the request where the body is the binary file. But what I receive is an org.eclipse.jetty.server.HttpInputOverHTTP object which I have no idea how to handle. I would really like not to switch away from using a PUT request, so is there anybody who can help me on how to handle this, maybe with an interceptor?</z><z id="t1661433257" t="V I have seen suggestions of using https://ring-clojure.github.io/ring/ring.middleware.multipart-params.html - But that would require changing from PUT to POST, which i would rather not"><y>#</y><d>2022-08-25</d><h>13:14</h><r>V</r>I have seen suggestions of using <a href="https://ring-clojure.github.io/ring/ring.middleware.multipart-params.html" target="_blank">https://ring-clojure.github.io/ring/ring.middleware.multipart-params.html</a> - But that would require changing from PUT to POST, which i would rather not</z><z id="t1661434060" t="V My main problem is that if i receive a file through the endpoint and upload it to aws it will be larger than the one i sent and also corrupt"><y>#</y><d>2022-08-25</d><h>13:27</h><r>V</r>My main problem is that if i receive a file through the endpoint and upload it to aws it will be larger than the one i sent and also corrupt</z><z id="t1661475052" t="souenzzo The client is not an Browser/HTML page? Is another JVM?"><y>#</y><d>2022-08-26</d><h>00:50</h><r>souenzzo</r>The client is not an Browser/HTML page?

Is another JVM?</z><z id="t1661475427" t="souenzzo https://www.baeldung.com/httpclient-multipart-upload"><y>#</y><d>2022-08-26</d><h>00:57</h><r>souenzzo</r><a href="https://www.baeldung.com/httpclient-multipart-upload" target="_blank">https://www.baeldung.com/httpclient-multipart-upload</a></z><z id="t1662417343" t="Eugen hi, I am doing some research on what web &quot;framework&quot; to use for a clojure web app. Pedestal seems very promissing. Is there a way to support jetty 10 / 11? I think multiple jetty versions will be available / supported by default, esp with the servlet package move from javax -&gt; jackarta . Right now Jetty 9 is no longer supported https://github.com/eclipse/jetty.project/issues/7958 . Jetty 10 is stable and 11 as well - with different API sets. Would it make sense for pedestal to add support for jetty 10 and jetty 11 ? I imagine the code might be more or less the same"><y>#</y><d>2022-09-05</d><h>22:35</h><w>Eugen</w>hi, I am doing some research on what web &quot;framework&quot; to use for a clojure web app.
Pedestal seems very promissing.

Is there a way to support jetty 10 / 11?

I think multiple jetty versions will be available / supported by default, esp with the servlet package move from javax -&gt; jackarta .
Right now Jetty 9 is no longer supported <a href="https://github.com/eclipse/jetty.project/issues/7958" target="_blank">https://github.com/eclipse/jetty.project/issues/7958</a> .
Jetty 10 is stable and 11 as well - with different API sets.

Would it make sense for pedestal to add support for jetty 10 and jetty 11 ?
I imagine the code might be more or less the same</z><z id="t1662430523" t="lread I think we still have a little time left until Jetty 9 moves to deprecated. &gt; While users of Jetty 9.x will continue to see releases for security and critical issues until 9.x goes End of Life (EOL), the only ongoing support provided will be for Webtide customers. &gt; As for the official EOL of Jetty 9.x, we will give at least 6 months notice after the last https://webtide.com customer has transitioned off of using 9.x. We can’t provide a firm date, but it is unlikely to happen before 2025. "><y>#</y><d>2022-09-06</d><h>02:15</h><r>lread</r>I think we still have a little time left until Jetty 9 moves to deprecated.

&gt; While users of Jetty 9.x will continue to see releases for security and critical issues until 9.x goes End of Life (EOL), the only ongoing support provided will be for Webtide customers.
&gt; As for the official EOL of Jetty 9.x, we will give at least 6 months notice after the last <a href="https://webtide.com" target="_blank">https://webtide.com</a> customer has transitioned off of using 9.x. We can’t provide a firm date, but it is unlikely to happen before 2025.
</z><z id="t1662456893" t="Eugen true, but new projects could use the newer version and not be forced to upgrade when jetty 9 support is done. This is more important for jetty 11 which uses the new jakarta servlet packages. Currently there is no support for them"><y>#</y><d>2022-09-06</d><h>09:34</h><r>Eugen</r>true, but new projects could use the newer version and not be forced to upgrade when jetty 9 support is done.
This is more important for jetty 11 which uses the new jakarta servlet packages.
Currently there is no support for them</z><z id="t1662473765" t="lread Ya, not disagreeing, just saying we have a little time to prepare. So what&apos;s the strategy for jetty 10 (javax) vs 11 (jakarta)? Seems all a bit confusing and awkward. Which one would pedestal use?"><y>#</y><d>2022-09-06</d><h>14:16</h><r>lread</r>Ya, not disagreeing, just saying we have a little time to prepare.
So what&apos;s the strategy for jetty 10 (javax) vs 11 (jakarta)?
Seems all a bit confusing and awkward. Which one would pedestal use?</z><z id="t1662473950" t="Eugen java ee (servlet api) was opensourced. but oracle could not / did not open source javax.yyy package namespace. hence jackarta.yyy namespace came to be under Eclipse foundation which is the steward for both jetty and servlet api"><y>#</y><d>2022-09-06</d><h>14:19</h><r>Eugen</r>java ee (servlet api) was opensourced. but oracle could not / did not open source javax.yyy package namespace. hence jackarta.yyy namespace came to be under Eclipse foundation which is the steward for both jetty and servlet api</z><z id="t1662473983" t="Eugen I believe both jetty-10 and jetty-11 should be supported"><y>#</y><d>2022-09-06</d><h>14:19</h><r>Eugen</r>I believe both jetty-10 and jetty-11 should be supported</z><z id="t1662474004" t="Eugen jetty 10 is upgrade path for jetty 9"><y>#</y><d>2022-09-06</d><h>14:20</h><r>Eugen</r>jetty 10 is upgrade path for jetty 9</z><z id="t1662474063" t="Eugen jetty 11 will ensure upgrade path to servlet versions 5, 6 and beyond, as released by eclipse"><y>#</y><d>2022-09-06</d><h>14:21</h><r>Eugen</r>jetty 11 will ensure upgrade path to servlet versions 5, 6 and beyond, as released by eclipse</z><z id="t1662475063" t="lread Thanks [:attrs {:href &quot;/_/_/users/U011NGC5FFY&quot;}] ! So would there have to be two separate pedestal release variants? Pedestal javax and pedestal jakarta?"><y>#</y><d>2022-09-06</d><h>14:37</h><r>lread</r>Thanks <a>@U011NGC5FFY</a>! So would there have to be two separate pedestal release variants? Pedestal javax and pedestal jakarta?</z><z id="t1662475350" t="Eugen I see it that way"><y>#</y><d>2022-09-06</d><h>14:42</h><r>Eugen</r>I see it that way</z><z id="t1662606268" t="Eugen hi [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] , was checking out contributor agreement and primed issues. I came to this one and was curios why it is left untouched . I would like to use pedestal and perhaps contribute some things. looking around to see how things are https://github.com/pedestal/pedestal/pull/691"><y>#</y><d>2022-09-08</d><h>03:04</h><w>Eugen</w>hi  <a>@ddeaguiar</a> , was checking out contributor agreement and primed issues. I came to this one and was curios why it is left untouched . I would like to use pedestal and perhaps contribute some things. looking around to see how things are <a href="https://github.com/pedestal/pedestal/pull/691" target="_blank">https://github.com/pedestal/pedestal/pull/691</a></z><z id="t1662655252" t="ddeaguiar Hi [:attrs {:href &quot;/_/_/users/U011NGC5FFY&quot;}] it’s a bandwith issue. I’m in the process of handing off stewardship to a couple of other people and expect that Pedestal will get more consistent support once that’s done. I expect this transition to be complete in the next few weeks."><y>#</y><d>2022-09-08</d><h>16:40</h><r>ddeaguiar</r>Hi <a>@U011NGC5FFY</a> it’s a bandwith issue. I’m in the process of handing off stewardship to a couple of other people and expect that Pedestal will get more consistent support once that’s done. I expect this transition to be complete in the next few weeks.</z><z id="t1662655312" t="Eugen thanks for taking the time to reply. looking forward to &quot;meeting them&quot;. Will you announce this transition?"><y>#</y><d>2022-09-08</d><h>16:41</h><r>Eugen</r>thanks for taking the time to reply.
looking forward to &quot;meeting them&quot;.

Will you announce this transition?</z><z id="t1662655366" t="ddeaguiar yep, plan to!"><y>#</y><d>2022-09-08</d><h>16:42</h><r>ddeaguiar</r>yep, plan to!</z><z id="t1662790126" t="ZehCnaS34 hi all, not sure if this is the right channel to go through, but I&apos;m having some trouble setting up pedestal+integrant.repl. For some context, I&apos;ll attach a snippet: (-&gt; {::http/routes routes ::http/host host ::http/port port ::http/type :jetty ::http/resource-path &quot;book/public&quot; ::http/join? false ::http/secure-headers {:content-security-policy-settings {:object-src &quot;none&quot;}} ::http/allowed-origins {:creds true :allowed-origins (constantly true)}} (http/create-server) (http/start)) This form is within an integrant init-key defmethod. The problem that I&apos;m facing is that the server works when starting via cli -M -m [...] , but not when inside a REPL session using integrant.repl/reset and integrant.repl/go . The error I&apos;m receiving while in the repl session is an HTTP ERROR 500 and the only header attached the response is Connection: close Honestly not sure how to proceed. Has anyone ran into this type of issue before?"><y>#</y><d>2022-09-10</d><h>06:08</h><w>ZehCnaS34</w>hi all, not sure if this is the right channel to go through, but I&apos;m having some trouble setting up pedestal+integrant.repl.

For some context, I&apos;ll attach a snippet:
<pre>(-&gt; {::http/routes          routes
     ::http/host            host
     ::http/port            port
     ::http/type            :jetty
     ::http/resource-path   &quot;book/public&quot;
     ::http/join?           false
     ::http/secure-headers  {:content-security-policy-settings {:object-src &quot;none&quot;}}
     ::http/allowed-origins {:creds true :allowed-origins (constantly true)}}
    (http/create-server)
    (http/start))</pre>
This form is within an integrant <code>init-key</code> defmethod. The problem that I&apos;m facing is that the server works when starting via <code>cli -M -m [...]</code>, but not when inside a REPL session using <code>integrant.repl/reset</code> and <code>integrant.repl/go</code>.

The error I&apos;m receiving while in the repl session is an <code>HTTP ERROR 500</code> and the only header attached the response is <code>Connection: close</code>

Honestly not sure how to proceed. Has anyone ran into this type of issue before?</z><z id="t1663002361" t="Fredy Gadotti Hey folks, what is the recommended folder structure for a medium application using Pedestal? I saw in the book Microservices with Clojure an approach that I felt a little bit strange of using everything as interceptors. Here is the official https://github.com/PacktPublishing/Microservices-with-Clojure/tree/master/Chapter10/helping-hands-alert.chapter-10/src/clj/helping_hands/alert from the book: ;; Tabular routes (def routes #{[&quot;/alerts/email&quot; :post (conj common-interceptors `auth `core/validate `core/send-email `gen-events) :route-name :alert-email] [&quot;/alerts/sms&quot; :post (conj common-interceptors `auth `core/validate `core/send-sms `gen-events) :route-name :alert-sms]}) Validation interceptor: (def validate {:name ::validate :enter (fn [context] (if-let [params (-&gt; context :request :form-params)] ;; validate and return a context with tx-data ;; or terminated interceptor chain (prepare-valid-context context) (chain/terminate (assoc context :response {:status 400 :body &quot;Invalid parameters&quot;})))) :error (fn [context ex-info] (assoc context :response {:status 500 :body (.getMessage ex-info)}))}) Business logic interceptor: (def send-email {:name ::send-email :enter (fn [context] (let [tx-data (:tx-data context) msg (into {} (filter (comp some? val) {:from &quot; In OO languages usually I would organize my application in something like Hexagonal Architecture, MVC or any other well spread pattern. Do you have any suggestion for organization?"><y>#</y><d>2022-09-12</d><h>17:06</h><w>Fredy Gadotti</w>Hey folks, what is the recommended folder structure for a medium application using Pedestal?
I saw in the book Microservices with Clojure an approach that I felt a little bit strange of using everything as interceptors. Here is the official <a href="https://github.com/PacktPublishing/Microservices-with-Clojure/tree/master/Chapter10/helping-hands-alert.chapter-10/src/clj/helping_hands/alert" target="_blank">https://github.com/PacktPublishing/Microservices-with-Clojure/tree/master/Chapter10/helping-hands-alert.chapter-10/src/clj/helping_hands/alert</a> from the book:
<pre>;; Tabular routes
(def routes #{[&quot;/alerts/email&quot;
               :post (conj common-interceptors `auth `core/validate
                           `core/send-email `gen-events)
               :route-name :alert-email]
              [&quot;/alerts/sms&quot;
               :post (conj common-interceptors `auth `core/validate
                           `core/send-sms `gen-events)
               :route-name :alert-sms]})</pre>
Validation interceptor:
<pre>(def validate
  {:name ::validate

   :enter
   (fn [context]
     (if-let [params (-&gt; context :request :form-params)]
       ;; validate and return a context with tx-data
       ;; or terminated interceptor chain
       (prepare-valid-context context)
       (chain/terminate
        (assoc context
               :response {:status 400
                          :body &quot;Invalid parameters&quot;}))))

   :error
   (fn [context ex-info]
     (assoc context
            :response {:status 500
                       :body (.getMessage ex-info)}))})</pre>
Business logic interceptor:
<pre>(def send-email
  {:name ::send-email

   :enter
   (fn [context]
     (let [tx-data (:tx-data context)
           msg (into {} (filter (comp some? val)
                                {:from &quot;</pre>
In OO languages usually I would organize my application in something like Hexagonal Architecture, MVC or any other well spread pattern.
Do you have any suggestion for organization?</z><z id="t1663007190" t="Thomas Moerman Project #polylith is gaining traction in the clojure community as an opinionated approach to structure a clj codebase."><y>#</y><d>2022-09-12</d><h>18:26</h><r>Thomas Moerman</r>Project #polylith is gaining traction in the clojure community as an opinionated approach to structure a clj codebase.</z><z id="t1663007525" t="Fredy Gadotti Thank you Thomas, I will take a look!"><y>#</y><d>2022-09-12</d><h>18:32</h><r>Fredy Gadotti</r>Thank you Thomas, I will take a look!</z><z id="t1663267975" t="Eugen yeah, I was going to suggest polylith myself"><y>#</y><d>2022-09-15</d><h>18:52</h><r>Eugen</r>yeah, I was going to suggest polylith myself</z><z id="t1663268004" t="Eugen we are migrating to it at work"><y>#</y><d>2022-09-15</d><h>18:53</h><r>Eugen</r>we are migrating to it at work</z><z id="t1663005739" t="hlship That&apos;s a bit of an open-ended question. It&apos;s like anything else, use a structure that grows with you. I would probably look for distinct sub-domains and have a namespace for each (for example, for E-commerce it might be product-catalog, product-detail, shopping-card, check-out, and so forth). I would also look for cross-cutting concerns such as auth and have a namespace for that."><y>#</y><d>2022-09-12</d><h>18:02</h><w>hlship</w>That&apos;s a bit of an open-ended question. It&apos;s like anything else, use a structure that grows with you.  I would probably look for distinct sub-domains and have a namespace for each (for example, for E-commerce it might be product-catalog, product-detail, shopping-card, check-out, and so forth).  I would also look for cross-cutting concerns such as auth and have a namespace for that.</z><z id="t1663007493" t="Fredy Gadotti Thank you Howard! My initial idea was split by feature like you suggested. I prefer do it in a way where I put other files near to where they are used instead of just split by responsibilities. E.g: avoid having folders for controllers, services, adapters and so on."><y>#</y><d>2022-09-12</d><h>18:31</h><r>Fredy Gadotti</r>Thank you Howard! My initial idea was split by feature like you suggested. I prefer do it in a way where I put other files near to where they are used instead of just split by responsibilities.
E.g: avoid having folders for controllers, services, adapters and so on.</z><z id="t1663019965" t="souenzzo My only advice is grow on demand. Don&apos;t start your project creating tons of namespaces &quot;that will be important&quot;, like *.interceptos *.handlers.*entity *.routes ... Start on a single file, once you see that there is a collection of things that make sense to have it own namespace, create it. give it a good name, not like .utils or .things-that-i-dont-like"><y>#</y><d>2022-09-12</d><h>21:59</h><r>souenzzo</r>My only advice is grow on demand.

Don&apos;t start your project creating  tons of namespaces &quot;that will be important&quot;, like <code>*.interceptos</code> <code>*.handlers.*entity</code> <code>*.routes</code>...

Start on a single file, once you see that there is a collection of things that make sense to have it own namespace, create it. give it a good name, not like <code>.utils</code> or <code>.things-that-i-dont-like</code></z><z id="t1663005974" t="hlship In Pedestal, everything ultimately ends up as an Interceptor (even routes!), but for many cases, there are helpers; for example, http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.helpers.html#var-defhandler lets you define a Ring-style handler for the end of your interceptor chain."><y>#</y><d>2022-09-12</d><h>18:06</h><w>hlship</w>In Pedestal, everything ultimately ends up as an Interceptor (even routes!), but for many cases, there are helpers; for example, <a href="http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.helpers.html#var-defhandler" target="_blank">http://pedestal.io/api/pedestal.interceptor/io.pedestal.interceptor.helpers.html#var-defhandler</a> lets you define a Ring-style handler for the end of your interceptor chain.</z><z id="t1663352062" t="ddeaguiar Hi folks, I’d like to announce that [:attrs {:href &quot;/_/_/users/U0FRJF287&quot;}] and [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] will be taking over the stewardship of Pedestal. This transition will result in more consistent support for Pedestal and increase the opportunity for community involvement and innovation. I’d like to thank Brian and Howard for taking on this role and I look forward to all the great work that follows!"><y>#</y><d>2022-09-16</d><h>18:14</h><w>ddeaguiar</w>Hi folks, I’d like to announce that <a>@bonkydog</a> and <a>@hlship</a> will be
taking over the stewardship of Pedestal. This transition will result in more consistent support for Pedestal and increase the opportunity for community involvement and innovation. I’d like to thank Brian and Howard for taking on this role and I look forward to all the great work that follows!</z><z id="t1663355933" t="Eugen thanks for your effort [:attrs {:href &quot;/_/_/users/U0FL657GR&quot;}] 👍 Good luck [:attrs {:href &quot;/_/_/users/U0FRJF287&quot;}] and [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , any plans for the project ?"><y>#</y><d>2022-09-16</d><h>19:18</h><r>Eugen</r>thanks for your effort <a>@U0FL657GR</a> <b>👍</b>

Good luck <a>@bonkydog</a> and <a>@hlship</a>,
any plans for the project ?</z><z id="t1663357270" t="jmv Thanks for all the work you&apos;ve put into pedestal over the years! "><y>#</y><d>2022-09-16</d><h>19:41</h><r>jmv</r>Thanks for all the work you&apos;ve put into pedestal over the years! </z><z id="t1663360809" t="bonkydog We&apos;ve got a fix for custom loggers ready soon and are looking at improving tracing and async."><y>#</y><d>2022-09-16</d><h>20:40</h><r>bonkydog</r>We&apos;ve got a fix for custom loggers ready soon and are looking at improving tracing and async.</z><z id="t1663360854" t="bonkydog We&apos;re also got some catching up to do on PRs. 😅"><y>#</y><d>2022-09-16</d><h>20:40</h><r>bonkydog</r>We&apos;re also got some catching up to do on PRs. <b>😅</b></z><z id="t1663364072" t="Ivan thank you!"><y>#</y><d>2022-09-16</d><h>21:34</h><r>Ivan</r>thank you!</z><z id="t1663356074" t="erwinrooijakkers How to make swagger routes? I have now (ns service (:require [io.pedestal.http :as http] [reitit.swagger :as swagger] [reitit.swagger-ui :as swagger-ui])) (def swagger-handler (swagger/create-swagger-handler)) (def swagger-ui-handler (swagger-ui/create-swagger-ui-handler)) (def ping-handler (fn [_req] {:status 200, :body &quot;pong&quot;})) (def routes `[[[&quot;/api&quot; [&quot;/ping&quot; {:get ping-handler}]] ^{:no-doc true} [&quot;/&quot; [&quot;/swagger.json&quot; {:get swagger-handler}] [&quot;/api-docs/*&quot; {:get swagger-ui-handler}]]]]) (def service {:env :prod ::http/routes routes ::http/allowed-origins [&quot;&quot;] ::http/resource-path &quot;/public&quot; ::http/type :jetty ::http/port 3000 ::http/host &quot;0.0.0.0&quot; ::http/container-options {:h2c? true :h2? false :ssl? false}}) but when I navigate to swagger.json I get internal server exception .. Caused by: java.lang.IllegalArgumentException: No implementation of method: :compiled-routes of protocol: #&apos;reitit.core/Router found for class: nil"><y>#</y><d>2022-09-16</d><h>19:21</h><w>erwinrooijakkers</w>How to make swagger routes? I have now

<pre>(ns service
  (:require
   [io.pedestal.http :as http]
   [reitit.swagger :as swagger]
   [reitit.swagger-ui :as swagger-ui]))

(def swagger-handler
  (swagger/create-swagger-handler))

(def swagger-ui-handler
  (swagger-ui/create-swagger-ui-handler))

(def ping-handler
  (fn [_req] {:status 200, :body &quot;pong&quot;}))

(def routes
  `[[[&quot;/api&quot;
      [&quot;/ping&quot; {:get ping-handler}]]
     ^{:no-doc true}
     [&quot;/&quot;
      [&quot;/swagger.json&quot; {:get swagger-handler}]
      [&quot;/api-docs/*&quot; {:get swagger-ui-handler}]]]])

(def service
  {:env :prod
   ::http/routes routes
   ::http/allowed-origins [&quot;&quot;]
   ::http/resource-path &quot;/public&quot;
   ::http/type :jetty
   ::http/port 3000
   ::http/host &quot;0.0.0.0&quot;
   ::http/container-options {:h2c? true
                             :h2? false
                             :ssl? false}})</pre>
but when I navigate to swagger.json I get

<pre>internal server exception .. Caused by: java.lang.IllegalArgumentException: No implementation of method: :compiled-routes of protocol: #&apos;reitit.core/Router found for class: nil</pre></z><z id="t1663576691" t="souenzzo Hey [:attrs {:href &quot;/_/_/users/U2PGHFU5U&quot;}] See this doc https://github.com/metosin/reitit/blob/master/doc/http/pedestal.md Highlight to this part: ;; no pedestal routes ::server/routes []} (server/default-interceptors) ;; swap the reitit router (pedestal/replace-last-interceptor (pedestal/routing-interceptor (http/router routes))) "><y>#</y><d>2022-09-19</d><h>08:38</h><r>souenzzo</r>Hey <a>@U2PGHFU5U</a>
See this doc <a href="https://github.com/metosin/reitit/blob/master/doc/http/pedestal.md" target="_blank">https://github.com/metosin/reitit/blob/master/doc/http/pedestal.md</a>

Highlight to this part:
<pre>;; no pedestal routes
     ::server/routes []}
    (server/default-interceptors)
    ;; swap the reitit router
    (pedestal/replace-last-interceptor
      (pedestal/routing-interceptor
        (http/router routes)))</pre>
</z><z id="t1663576746" t="souenzzo Pedestal do not support reitit. Reitit supports pedestal, so it more about a #reitit question."><y>#</y><d>2022-09-19</d><h>08:39</h><r>souenzzo</r>Pedestal do not support reitit.
Reitit supports pedestal, so it more about a #reitit question.</z><z id="t1663788927" t="erwinrooijakkers Thanks"><y>#</y><d>2022-09-21</d><h>19:35</h><r>erwinrooijakkers</r>Thanks</z><z id="t1663356085" t="erwinrooijakkers the /ping endpoint does work"><y>#</y><d>2022-09-16</d><h>19:21</h><w>erwinrooijakkers</w>the /ping endpoint does work</z><z id="t1664482552" t="enn Is it possible to set a dynamic binding in an interceptor that will be in scope for a later interceptor? Use case: I want to control the behavior of a function called by an interceptor I don’t control, and that interceptor does not pass necessary context."><y>#</y><d>2022-09-29</d><h>20:15</h><w>enn</w>Is it possible to set a dynamic binding in an interceptor that will be in scope for a later interceptor? Use case: I want to control the behavior of a function called by an interceptor I don’t control, and that interceptor does not pass necessary context.</z><z id="t1664482629" t="ghadi yes [:attrs {:href &quot;/_/_/users/U060QM7AA&quot;}] - there should be some docs about how to direct bindings by associng into the context"><y>#</y><d>2022-09-29</d><h>20:17</h><w>ghadi</w>yes <a>@enn</a> - there should be some docs about how to direct bindings by associng into the context</z><z id="t1664482642" t="ghadi I don’t have a link handy"><y>#</y><d>2022-09-29</d><h>20:17</h><w>ghadi</w>I don’t have a link handy</z><z id="t1664482802" t="enn The only thing I see in http://pedestal.io/reference/interceptors or http://pedestal.io/guides/what-is-an-interceptor is some stuff on how to modify the interceptor chain"><y>#</y><d>2022-09-29</d><h>20:20</h><w>enn</w>The only thing I see in <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a> or <a href="http://pedestal.io/guides/what-is-an-interceptor" target="_blank">http://pedestal.io/guides/what-is-an-interceptor</a> is some stuff on how to modify the interceptor chain</z><z id="t1664482931" t="ghadi http://pedestal.io/reference/context-map"><y>#</y><d>2022-09-29</d><h>20:22</h><r>ghadi</r><a href="http://pedestal.io/reference/context-map" target="_blank">http://pedestal.io/reference/context-map</a></z><z id="t1664482947" t="enn aha, perfect! thank you"><y>#</y><d>2022-09-29</d><h>20:22</h><r>enn</r>aha, perfect! thank you</z><z id="t1664692685" t="hanDerPeder Is this a bug? from the code it seems that routers should be able to route based on the :host of the request, but this breaks the prefix-tree router (require &apos;[io.pedestal.http.route.prefix-tree :as prefix-tree] &apos;[io.pedestal.http.route.router :as router]) (def my-router (prefix-tree/router [{:path &quot;/foo/:x&quot;} {:path &quot;/foo/:x/bar/*rest&quot;} {:path &quot;/:param&quot; :host &quot;&quot;}])) (router/find-route my-router {:path-info &quot;/foo/1&quot;}) ;; =&gt; nil (router/find-route my-router {:path-info &quot;/test&quot;}) ;; =&gt; nil (router/find-route my-router {:path-info &quot;/test&quot; :host &quot;&quot;}) ;; =&gt; nil "><y>#</y><d>2022-10-02</d><h>06:38</h><w>hanDerPeder</w>Is this a bug? from the code it seems that routers should be able to route based on the <code>:host</code> of the request, but this breaks the prefix-tree router
<pre>(require &apos;[io.pedestal.http.route.prefix-tree :as prefix-tree]
         &apos;[io.pedestal.http.route.router :as router])

(def my-router (prefix-tree/router [{:path &quot;/foo/:x&quot;}
                                    {:path &quot;/foo/:x/bar/*rest&quot;}
                                    {:path &quot;/:param&quot; :host &quot;&quot;}]))

(router/find-route my-router {:path-info &quot;/foo/1&quot;}) ;; =&gt; nil
(router/find-route my-router {:path-info &quot;/test&quot;}) ;; =&gt; nil
(router/find-route my-router {:path-info &quot;/test&quot; :host &quot;&quot;}) ;; =&gt; nil</pre>
</z><z id="t1664692697" t="hanDerPeder linear-search works as expected"><y>#</y><d>2022-10-02</d><h>06:38</h><w>hanDerPeder</w>linear-search works as expected</z><z id="t1665160479" t="MegaMatt I&apos;m having trouble finding documentation related to this configuration. https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L39 {:env :prod} can anyone point me to the documentation for what it does?"><y>#</y><d>2022-10-07</d><h>16:34</h><w>MegaMatt</w>I&apos;m having trouble finding documentation related to this configuration.
<a href="https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L39" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/servlet-filters-gzip/src/gzip/service.clj#L39</a>
<code>{:env :prod}</code> 
can anyone point me to the documentation for what it does?</z><z id="t1665390739" t="souenzzo After find-usages in the project, seems that it is not used outside the samples directory. So seems that it has no effect."><y>#</y><d>2022-10-10</d><h>08:32</h><r>souenzzo</r>After find-usages in the project, seems that it is not used outside the <code>samples</code> directory.
So seems that it has no effect.</z><z id="t1665329507" t="popeye Hello team, I have two interceptor 1 and 2 , How to return result on one interceptor to another ?"><y>#</y><d>2022-10-09</d><h>15:31</h><w>popeye</w>Hello team, I have two interceptor 1 and 2 , How to return result on one interceptor to another ?</z><z id="t1665402336" t="hanDerPeder http://pedestal.io/reference/interceptors"><y>#</y><d>2022-10-10</d><h>11:45</h><r>hanDerPeder</r><a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1665674107" t="amorokh hi all, I see that https://github.com/pedestal/pedestal/issues/718 has been closed but I see no new release, is that planned soon?"><y>#</y><d>2022-10-13</d><h>15:15</h><w>amorokh</w>hi all, I see that <a href="https://github.com/pedestal/pedestal/issues/718" target="_blank">https://github.com/pedestal/pedestal/issues/718</a> has been closed but I see no new release, is that planned soon?</z><z id="t1665678809" t="hlship There is a snapshot release with these fixes on clojars; however, they were generated as part of building and testing a new deps.edn-based bulid system."><y>#</y><d>2022-10-13</d><h>16:33</h><w>hlship</w>There is a snapshot release with these fixes on clojars; however, they were generated as part of building and testing a new deps.edn-based bulid system.</z><z id="t1666000175" t="vemv btw, the lein-nvd plugin referenced in the issue above is now named https://github.com/rm-hull/nvd-clojure . If you&apos;d like to integrate it I&apos;d gladly review it"><y>#</y><d>2022-10-17</d><h>09:49</h><r>vemv</r>btw, the lein-nvd plugin referenced in the issue above is now named <a href="https://github.com/rm-hull/nvd-clojure" target="_blank">https://github.com/rm-hull/nvd-clojure</a>.

If you&apos;d like to integrate it I&apos;d gladly review it</z><z id="t1666050668" t="richiardiandrea I&apos;ll also be able to confirm things are working well against our code base. What is the snapshot release? We are eager to get those CVEs fixes in 😉"><y>#</y><d>2022-10-17</d><h>23:51</h><r>richiardiandrea</r>I&apos;ll also be able to confirm things are working well against our code base.
What is the snapshot release?

We are eager to get those CVEs fixes in <b>😉</b></z><z id="t1666198411" t="hlship So there&apos;s a 0.5.11-SNAPSHOT version on Clojars but it should be used with caution, see: https://github.com/clojars/clojars-web/wiki/Stable-SNAPSHOT-Identifiers"><y>#</y><d>2022-10-19</d><h>16:53</h><r>hlship</r>So there&apos;s a 0.5.11-SNAPSHOT version on Clojars but it should be used with caution, see: <a href="https://github.com/clojars/clojars-web/wiki/Stable-SNAPSHOT-Identifiers" target="_blank">https://github.com/clojars/clojars-web/wiki/Stable-SNAPSHOT-Identifiers</a></z><z id="t1666160197" t="onetom I wonder why is deref necessary https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201 : (let [options ((deref #&apos;session/session-options) options)] where session/session-options is: (defn- session-options [options] {:store (options :store (mem/memory-store)) ... i would have thought that calling the #&apos;session/session-options var directly does a deref anyway..."><y>#</y><d>2022-10-19</d><h>06:16</h><w>onetom</w>I wonder why is <code>deref</code> necessary <a href="https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201" target="_blank">https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201</a>:
<pre>(let [options ((deref #&apos;session/session-options) options)]</pre>
where <code>session/session-options</code> is:
<pre>(defn- session-options
  [options]
  {:store        (options :store (mem/memory-store))
...</pre>
i would have thought that calling the <code>#&apos;session/session-options</code> var directly does a <code>deref</code> anyway...</z><z id="t1666198577" t="hlship Do you have pointers to the source?"><y>#</y><d>2022-10-19</d><h>16:56</h><r>hlship</r>Do you have pointers to the source?</z><z id="t1666263585" t="onetom i provided the link already, but i guess it&apos;s hard to see, that the word &quot;here&quot; is a link, so here it is again: https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201"><y>#</y><d>2022-10-20</d><h>10:59</h><r>onetom</r>i provided the link already, but i guess it&apos;s hard to see, that the word &quot;here&quot; is a link, so here it is again:
<a href="https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201" target="_blank">https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/src/io/pedestal/http/ring_middlewares.clj#L201</a></z><z id="t1666161571" t="onetom what is https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/test/io/pedestal/http/ring_middlewares_test.clj#L214 testing: ; delete session (#(assoc % :response (assoc (:request %) :session nil))) we shouldn&apos;t just have everything from the :request put into the :response , no? i was expecting just a direct clearing of the :session , eg: ; delete session (#(assoc-in % [:response :session] nil))"><y>#</y><d>2022-10-19</d><h>06:39</h><w>onetom</w>what is <a href="https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/test/io/pedestal/http/ring_middlewares_test.clj#L214" target="_blank">https://github.com/pedestal/pedestal/blob/95e0f1b9f81b2fe1a11b98ab37517296bcc289ca/service/test/io/pedestal/http/ring_middlewares_test.clj#L214</a> testing:
<pre>; delete session
            (#(assoc % :response (assoc (:request %) :session nil)))</pre>
we shouldn&apos;t just have everything from the <code>:request</code> put into the <code>:response</code>, no?
i was expecting just a direct clearing of the <code>:session</code>, eg:
<pre>; delete session
            (#(assoc-in % [:response :session] nil))</pre></z><z id="t1666161583" t="onetom (im just looking into these things, because i want to use the ring session middleware as a sieppari interceptor, in a reitit setup, which doesn&apos;t seem to provide an example of how to do that.)"><y>#</y><d>2022-10-19</d><h>06:39</h><w>onetom</w>(im just looking into these things, because i want to use the ring session middleware as a sieppari interceptor, in a reitit setup, which doesn&apos;t seem to provide an example of how to do that.)</z><z id="t1666814645" t="plins hello everyone, I have a potentially large lazy dataset returned by jdbc-next, and I want to stream the response as a csv file whats the best way of doing this? returning an input steram? a function? I took a look at the docs but its not clear to me how to connect the dots"><y>#</y><d>2022-10-26</d><h>20:04</h><w>plins</w>hello everyone, I have a potentially large lazy dataset returned by jdbc-next, and I want to stream the response as a csv file

whats the best way of doing this? returning an input steram? a function? I took a look at the docs but its not clear to me how to connect the dots</z><z id="t1666814926" t="souenzzo Something like this (defn get-huge-data [req] (let [c (async/chan)] (async/thread (doseq [v (jdbc/get-values)] (async/&gt;!! c v))) {:body c :status 200}))"><y>#</y><d>2022-10-26</d><h>20:08</h><r>souenzzo</r>Something like this
<pre>(defn get-huge-data 
  [req]
  (let [c (async/chan)]
    (async/thread 
      (doseq [v (jdbc/get-values)]
        (async/&gt;!! c v)))
    {:body c
     :status 200}))</pre></z><z id="t1666815071" t="plins that makes sense, thanks! I wonder how to factor in the writer for the csv"><y>#</y><d>2022-10-26</d><h>20:11</h><r>plins</r>that makes sense, thanks!

I wonder how to factor in the writer for the csv</z><z id="t1666815145" t="plins maybe instead of returning a channel I could return an input stream, and write to that input using a thread instead of core.async?"><y>#</y><d>2022-10-26</d><h>20:12</h><r>plins</r>maybe instead of returning a channel I could return an input stream, and write to that input using a <code>thread</code> instead of core.async?</z><z id="t1666815194" t="plins I wonder if Pedestal will wait for the thread to finish to finish the response"><y>#</y><d>2022-10-26</d><h>20:13</h><r>plins</r>I wonder if Pedestal will wait for the thread to finish to finish the response</z><z id="t1666815350" t="souenzzo searching an old complete/correct example here."><y>#</y><d>2022-10-26</d><h>20:15</h><r>souenzzo</r>searching an old complete/correct example here.</z><z id="t1666815370" t="plins thank you very much mister ❤️"><y>#</y><d>2022-10-26</d><h>20:16</h><r>plins</r>thank you very much mister <b>❤️</b></z><z id="t1666815596" t="souenzzo https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0/d449ef39b35e00e9d3ae2b45313d4ec360a3303f"><y>#</y><d>2022-10-26</d><h>20:19</h><r>souenzzo</r><a href="https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0/d449ef39b35e00e9d3ae2b45313d4ec360a3303f" target="_blank">https://gist.github.com/ivarref/b57cf40ea4739dacc4bbe7bbcaa8aec0/d449ef39b35e00e9d3ae2b45313d4ec360a3303f</a></z><z id="t1666815677" t="souenzzo note that the key is &quot;return a channel&quot; How you will pipe the data into this channel may be tricky"><y>#</y><d>2022-10-26</d><h>20:21</h><r>souenzzo</r>note that the key is &quot;return a channel&quot;

How you will pipe the data into this channel may be tricky</z><z id="t1666815746" t="souenzzo (pipe jdbc, that is a sync library, into an async chan, may be tricky)"><y>#</y><d>2022-10-26</d><h>20:22</h><r>souenzzo</r>(pipe jdbc, that is a sync library, into an async chan, may be tricky)</z><z id="t1666815834" t="plins given it returns a lazy list as a result I was under the impression that I could doseq without having to load the entire collection in memory"><y>#</y><d>2022-10-26</d><h>20:23</h><r>plins</r>given it returns a lazy list as a result I was under the impression that I could <code>doseq</code> without having to load the entire collection in memory</z><z id="t1666815870" t="souenzzo yeah but it will require a dedicated thread"><y>#</y><d>2022-10-26</d><h>20:24</h><r>souenzzo</r>yeah but it will require a dedicated thread</z><z id="t1666815997" t="souenzzo In this specific case, of a lazy seq from jdbc into the response, may be easier to write as you read, like this (require &apos;[io.pedestal.http :as http] &apos;[clojure.core.async :as async] &apos;[io.pedestal.test :refer [response-for]]) (let [index (fn [req] (let [lazy-jdbc-result (#_jdbc/execute.. do [1 2 3])] {:body (fn [out] (with-open [w (io/writer out)] (doseq [v lazy-jdbc-result] (json/write v w) (.write w (int \newline))))) :status 200})) service-fn (-&gt; {::http/routes `#{[&quot;/&quot; :get ~index :route-name ::index]}} http/default-interceptors http/create-servlet ::http/service-fn)] (response-for service-fn :get &quot;/&quot;))"><y>#</y><d>2022-10-26</d><h>20:26</h><r>souenzzo</r>In this specific case, of a lazy seq from jdbc into the response, may be easier to write as you read, like this
<pre>(require &apos;[io.pedestal.http :as http]
  &apos;[clojure.core.async :as async]
  &apos;[io.pedestal.test :refer [response-for]])
(let [index (fn [req]
              (let [lazy-jdbc-result (#_jdbc/execute.. do
                                       [1 2 3])]
                {:body   (fn [out]
                           (with-open [w (io/writer out)]
                             (doseq [v lazy-jdbc-result]
                               (json/write v w)
                               (.write w (int \newline)))))
                 :status 200}))
      service-fn (-&gt; {::http/routes `#{[&quot;/&quot; :get ~index
                                        :route-name ::index]}}
                   http/default-interceptors
                   http/create-servlet
                   ::http/service-fn)]
  (response-for service-fn :get &quot;/&quot;))</pre></z><z id="t1666816054" t="plins yep looks like this will do the trick thanks a lot ❤️ !!"><y>#</y><d>2022-10-26</d><h>20:27</h><r>plins</r>yep looks like this will do the trick thanks a lot <b>❤️</b> !!</z><z id="t1667229740" t="agorgl Hello there! How do you usually create your new pedestal project skeletons based on deps.edn ? I created an empty project using clojure -Tclj-new app :name sample.service :output sample-service and manually added the pedestal dependencies, and some code from the hello-world example in the pedestal repo. Is there any better/recommended way?"><y>#</y><d>2022-10-31</d><h>15:22</h><w>agorgl</w>Hello there! How do you usually create your new pedestal project skeletons based on <code>deps.edn</code> ?
I created an empty project using <code>clojure -Tclj-new app :name sample.service :output sample-service</code> and manually added the pedestal dependencies, and some code from the hello-world example in the pedestal repo. Is there any better/recommended way?</z><z id="t1667246168" t="hlship Pedestal currently has a Leiningen template. I&apos;m in the middle of converting Pedestal from Leinigen to deps.edn, and I suspect we&apos;ll be able to create a template for that."><y>#</y><d>2022-10-31</d><h>19:56</h><r>hlship</r>Pedestal currently has a Leiningen template.  I&apos;m in the middle of converting Pedestal from Leinigen to deps.edn, and I suspect we&apos;ll be able to create a template for that.</z><z id="t1667303061" t="agorgl Amazing!"><y>#</y><d>2022-11-01</d><h>11:44</h><r>agorgl</r>Amazing!</z><z id="t1667423954" t="agorgl Hello there! I suppose there is some problem with the hello-world example in the pedestal repo? The ::http/routes in the run-dev function are defined as: https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32 While in the pedestal-service template are defined as: https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21 I see also that they are wrapped with route/expand-routes in some examples and they are not wrapped in some others, what is the correct usage?"><y>#</y><d>2022-11-02</d><h>21:19</h><w>agorgl</w>Hello there! I suppose there is some problem with the <code>hello-world</code> example in the pedestal repo?
The <code>::http/routes</code> in the <code>run-dev</code> function are defined as:
<a href="https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32" target="_blank">https://github.com/pedestal/pedestal/blob/master/samples/hello-world/src/hello_world/server.clj#L32</a>
While in the <code>pedestal-service</code> template are defined as:
<a href="https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21" target="_blank">https://github.com/pedestal/pedestal/blob/master/service-template/src/leiningen/new/pedestal_service/server.clj#L21</a>
I see also that they are wrapped with <code>route/expand-routes</code> in some examples and they are not wrapped in some others, what is the correct usage?</z><z id="t1667427996" t="souenzzo Both are supported :: http/routes could be • a value that implements expand-routes • a function that returns the expanded route."><y>#</y><d>2022-11-02</d><h>22:26</h><w>souenzzo</w>Both are supported
<b>::</b>http/routes could be
• a value that implements expand-routes
• a function that returns the expanded route.</z><z id="t1667449481" t="orestis Am I not seeing something - pedestal/log has a facility to add data to MDC, but it&apos;s only exposed via macros, which are not really handy when working with interceptors. I ended up just using log4j2 ThreadContext which is the same thing, but I&apos;m curious..."><y>#</y><d>2022-11-03</d><h>04:24</h><w>orestis</w>Am I not seeing something - <code>pedestal/log</code> has a facility to add data to MDC, but it&apos;s only exposed via macros, which are not really handy when working with interceptors. I ended up just using log4j2 <code>ThreadContext</code> which is the same thing, but I&apos;m curious...</z><z id="t1667449517" t="orestis That is, I want to set a value during an interceptor :enter and clear everything out at the last interceptor."><y>#</y><d>2022-11-03</d><h>04:25</h><r>orestis</r>That is, I want to set a value during an interceptor <code>:enter</code> and clear everything out at the last interceptor.</z><z id="t1667509658" t="hlship That may be problematic if the interceptor is part of an async operation."><y>#</y><d>2022-11-03</d><h>21:07</h><r>hlship</r>That may be problematic if the interceptor is part of an async operation.</z><z id="t1667509675" t="hlship As the thread executing code within the async chain may vary."><y>#</y><d>2022-11-03</d><h>21:07</h><r>hlship</r>As the thread executing code within the async chain may vary.</z><z id="t1667552657" t="orestis Yes, I’m aware of that. We mostly use futures in our code but I’m not sure if they propagate Thread locals too. "><y>#</y><d>2022-11-04</d><h>09:04</h><r>orestis</r>Yes, I’m aware of that. We mostly use futures in our code but I’m not sure if they propagate Thread locals too. </z><z id="t1667552717" t="orestis Obviously in async operations all bets are off but we’re not using them - the alternative there is manually keeping track of a log context "><y>#</y><d>2022-11-04</d><h>09:05</h><r>orestis</r>Obviously in async operations all bets are off but we’re not using them - the alternative there is manually keeping track of a log context </z><z id="t1667569402" t="Shivam A Hi folks, I am trying to integrate reitit with pedestal web backend. For some reason coercion/coerce-exceptions-interceptor is not handling coercion type exceptions. Code: (def router (http/router [&quot;/v1&quot; [&quot;/&quot; {:get {:summary &quot;simple get handler&quot; :parameters {:query {:student-id s/Int}} :handler home-page} :post {:summary &quot;simple post handler&quot; :responses {200 {:body {:total s/Int}}} :parameters {:body {:name s/Str :age s/Int}} :handler home-page}}]] {:exception pretty/exception :data {:muuntaja m/instance :compile rc/compile-request-coercers :coercion reitit.coercion.schema/coercion :interceptors [(parameters/parameters-interceptor) (muuntaja/format-negotiate-interceptor) (muuntaja/format-response-interceptor) (muuntaja/format-request-interceptor) (muuntaja/format-interceptor) (coercion/coerce-response-interceptor) (coercion/coerce-request-interceptor) (coercion/coerce-exceptions-interceptor) (exception/exception-interceptor)]}})) exception: ERROR i.p.http.impl.servlet-interceptor - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 314} clojure.lang.ExceptionInfo: clojure.lang.ExceptionInfo in Interceptor :reitit.http.coercion/coerce-request - Request coercion failed: #reitit.coercion.CoercionError{:schema {:student-id Int, Keyword Any}, :errors {:student-id missing-required-key}} at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35) at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32) at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57) at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44) at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic(chain.clj:171) at io.pedestal.interceptor.chain$process_all_with_binding.invoke(chain.clj:146) at io.pedestal.interceptor.chain$process_all$fn__9181.invoke(chain.clj:188) at clojure.lang.AFn.applyToHelper(AFn.java:152) at clojure.lang.AFn.applyTo(AFn.java:144) at clojure.core$apply.invokeStatic(core.clj:665) at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1973) at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1973) at clojure.lang.RestFn.invoke(RestFn.java:425) at io.pedestal.interceptor.chain$process_all.invokeStatic(chain.clj:186) at io.pedestal.interceptor.chain$process_all.invoke(chain.clj:182) at io.pedestal.interceptor.chain$enter_all.invokeStatic(chain.clj:235) at io.pedestal.interceptor.chain$enter_all.invoke(chain.clj:229) at io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:379) at io.pedestal.interceptor.chain$execute.invoke(chain.clj:352) at io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:389) at io.pedestal.interceptor.chain$execute.invoke(chain.clj:352) at io.pedestal.http.impl.servlet_interceptor$interceptor_service_fn$fn__12805.invoke(servlet_interceptor.clj:351) at io.pedestal.http.servlet.FnServlet.service(servlet.clj:28) at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:550) at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) at org.eclipse.jetty.server.Server.handle(Server.java:516) at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:400) at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:645) at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:392) at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) at .AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) at .FillInterest.fillable(FillInterest.java:105) at .ChannelEndPoint$1.run(ChannelEndPoint.java:104) at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883) at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034) at java.base/java.lang.Thread.run(Thread.java:833) Caused by: clojure.lang.ExceptionInfo: Request coercion failed: #reitit.coercion.CoercionError{:schema {:student-id Int, Keyword Any}, :errors {:student-id missing-required-key}} at reitit.coercion$request_coercion_failed_BANG_.invokeStatic(coercion.cljc:46) at reitit.coercion$request_coercion_failed_BANG_.invoke(coercion.cljc:44) at reitit.coercion$request_coercer$fn__15954.invoke(coercion.cljc:86) at reitit.coercion$coerce_request$fn__15967.invoke(coercion.cljc:113) at clojure.lang.PersistentArrayMap.kvreduce(PersistentArrayMap.java:377) at clojure.core$fn__8437.invokeStatic(core.clj:6845) at clojure.core$fn__8437.invoke(core.clj:6830) at clojure.core.protocols$fn__8167$G__8162__8176.invoke(protocols.clj:175) at clojure.core$reduce_kv.invokeStatic(core.clj:6856) at clojure.core$reduce_kv.invoke(core.clj:6847) at reitit.coercion$coerce_request.invokeStatic(coercion.cljc:111) at reitit.coercion$coerce_request.invoke(coercion.cljc:110) at reitit.http.coercion$coerce_request_interceptor$fn__310$fn__312.invoke(coercion.cljc:24) at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:54) ... 41 common frames omitted"><y>#</y><d>2022-11-04</d><h>13:43</h><w>Shivam A</w>Hi folks, I am trying to integrate <code>reitit</code> with <code>pedestal</code> web backend. For some reason <code>coercion/coerce-exceptions-interceptor</code> is not handling <code>coercion</code> type exceptions.
Code:
<code>(def router</code>
  <code>(http/router [&quot;/v1&quot;</code>
                <code>[&quot;/&quot; {:get {:summary &quot;simple get handler&quot;</code>
                            <code>:parameters {:query {:student-id s/Int}}</code>
                            <code>:handler home-page}</code>
                      <code>:post {:summary &quot;simple post handler&quot;</code>
                             <code>:responses {200 {:body {:total s/Int}}}</code>
                             <code>:parameters {:body {:name s/Str :age s/Int}}</code>
                             <code>:handler home-page}}]]</code>
               <code>{:exception pretty/exception</code>
                <code>:data {:muuntaja m/instance</code>
                       <code>:compile rc/compile-request-coercers</code>
                       <code>:coercion reitit.coercion.schema/coercion</code>
                       <code>:interceptors [(parameters/parameters-interceptor)</code>
                                      <code>(muuntaja/format-negotiate-interceptor)</code>
                                      <code>(muuntaja/format-response-interceptor)</code>
                                      <code>(muuntaja/format-request-interceptor)</code>
                                      <code>(muuntaja/format-interceptor)</code>
                                      <code>(coercion/coerce-response-interceptor)</code>
                                      <code>(coercion/coerce-request-interceptor)</code>
                                      <code>(coercion/coerce-exceptions-interceptor)</code>
                                      <code>(exception/exception-interceptor)]}}))</code>

exception:
<code>ERROR i.p.http.impl.servlet-interceptor  - {:msg &quot;Dev interceptor caught an exception; Forwarding it as the response.&quot;, :line 314}</code>
<code>clojure.lang.ExceptionInfo: clojure.lang.ExceptionInfo in Interceptor :reitit.http.coercion/coerce-request - Request coercion failed: #reitit.coercion.CoercionError{:schema {:student-id Int, Keyword Any}, :errors {:student-id missing-required-key}}</code>
        <code>at io.pedestal.interceptor.chain$throwable__GT_ex_info.invokeStatic(chain.clj:35)</code>
        <code>at io.pedestal.interceptor.chain$throwable__GT_ex_info.invoke(chain.clj:32)</code>
        <code>at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:57)</code>
        <code>at io.pedestal.interceptor.chain$try_f.invoke(chain.clj:44)</code>
        <code>at io.pedestal.interceptor.chain$process_all_with_binding.invokeStatic(chain.clj:171)</code>
        <code>at io.pedestal.interceptor.chain$process_all_with_binding.invoke(chain.clj:146)</code>
        <code>at io.pedestal.interceptor.chain$process_all$fn__9181.invoke(chain.clj:188)</code>
        <code>at clojure.lang.AFn.applyToHelper(AFn.java:152)</code>
        <code>at clojure.lang.AFn.applyTo(AFn.java:144)</code>
        <code>at clojure.core$apply.invokeStatic(core.clj:665)</code>
        <code>at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1973)</code>
        <code>at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1973)</code>
        <code>at clojure.lang.RestFn.invoke(RestFn.java:425)</code>
        <code>at io.pedestal.interceptor.chain$process_all.invokeStatic(chain.clj:186)</code>
        <code>at io.pedestal.interceptor.chain$process_all.invoke(chain.clj:182)</code>
        <code>at io.pedestal.interceptor.chain$enter_all.invokeStatic(chain.clj:235)</code>
        <code>at io.pedestal.interceptor.chain$enter_all.invoke(chain.clj:229)</code>
        <code>at io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:379)</code>
        <code>at io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)</code>
        <code>at io.pedestal.interceptor.chain$execute.invokeStatic(chain.clj:389)</code>
        <code>at io.pedestal.interceptor.chain$execute.invoke(chain.clj:352)</code>
        <code>at io.pedestal.http.impl.servlet_interceptor$interceptor_service_fn$fn__12805.invoke(servlet_interceptor.clj:351)</code>
        <code>at io.pedestal.http.servlet.FnServlet.service(servlet.clj:28)</code>
        <code>at org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799)</code>
        <code>at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:550)</code>
        <code>at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)</code>
        <code>at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434)</code>
        <code>at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)</code>
        <code>at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501)</code>
        <code>at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)</code>
        <code>at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349)</code>
        <code>at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)</code>
        <code>at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)</code>
        <code>at org.eclipse.jetty.server.Server.handle(Server.java:516)</code>
        <code>at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:400)</code>
        <code>at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:645)</code>
        <code>at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:392)</code>
        <code>at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)</code>
        <code>at .AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)</code>
        <code>at .FillInterest.fillable(FillInterest.java:105)</code>
        <code>at .ChannelEndPoint$1.run(ChannelEndPoint.java:104)</code>
        <code>at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)</code>
        <code>at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)</code>
        <code>at java.base/java.lang.Thread.run(Thread.java:833)</code>
<code>Caused by: clojure.lang.ExceptionInfo: Request coercion failed: #reitit.coercion.CoercionError{:schema {:student-id Int, Keyword Any}, :errors {:student-id missing-required-key}}</code>
        <code>at reitit.coercion$request_coercion_failed_BANG_.invokeStatic(coercion.cljc:46)</code>
        <code>at reitit.coercion$request_coercion_failed_BANG_.invoke(coercion.cljc:44)</code>
        <code>at reitit.coercion$request_coercer$fn__15954.invoke(coercion.cljc:86)</code>
        <code>at reitit.coercion$coerce_request$fn__15967.invoke(coercion.cljc:113)</code>
        <code>at clojure.lang.PersistentArrayMap.kvreduce(PersistentArrayMap.java:377)</code>
        <code>at clojure.core$fn__8437.invokeStatic(core.clj:6845)</code>
        <code>at clojure.core$fn__8437.invoke(core.clj:6830)</code>
        <code>at clojure.core.protocols$fn__8167$G__8162__8176.invoke(protocols.clj:175)</code>
        <code>at clojure.core$reduce_kv.invokeStatic(core.clj:6856)</code>
        <code>at clojure.core$reduce_kv.invoke(core.clj:6847)</code>
        <code>at reitit.coercion$coerce_request.invokeStatic(coercion.cljc:111)</code>
        <code>at reitit.coercion$coerce_request.invoke(coercion.cljc:110)</code>
        <code>at reitit.http.coercion$coerce_request_interceptor$fn__310$fn__312.invoke(coercion.cljc:24)</code>
        <code>at io.pedestal.interceptor.chain$try_f.invokeStatic(chain.clj:54)</code>
        <code>... 41 common frames omitted</code></z><z id="t1667590554" t="souenzzo this is more about #C7YF1SBT3"><y>#</y><d>2022-11-04</d><h>19:35</h><r>souenzzo</r>this is more about #C7YF1SBT3</z><z id="t1667595604" t="agorgl Hello there again! I&apos;ve read the pedestal &apos;Your First API&apos; example ( http://pedestal.io/guides/your-first-api ) and I&apos;m trying to understand why is it a good/better idea to &apos;inject&apos; the db through interceptors. Couldn&apos;t we just use the domain functions to manipulate domain entities / run domain logic? E.g. in the tutorial a simple read operation / api is: (def list-view {:name :list-view :enter (fn [context] (if-let [db-id (get-in context [:request :path-params :list-id])] (if-let [the-list (find-list-by-id (get-in context [:request :database]) db-id)] (assoc context :result the-list) context) context))}) Couldn&apos;t this just be something like: (defn list-view [request] (if-let [db-id (get-in request [:path-params :list-id])] (if-let [the-list (find-list-by-id db-id)] the-list))) Where the find-list-by-id domain method would also hide the implementation detail of the repository / data layer?"><y>#</y><d>2022-11-04</d><h>21:00</h><w>agorgl</w>Hello there again! I&apos;ve read the pedestal &apos;Your First API&apos; example (<a href="http://pedestal.io/guides/your-first-api" target="_blank">http://pedestal.io/guides/your-first-api</a>) and I&apos;m trying to understand why is it a good/better idea to &apos;inject&apos; the db through interceptors. Couldn&apos;t we just use the domain functions to manipulate domain entities / run domain logic?
E.g. in the tutorial a simple read operation / api is:
<pre>(def list-view
  {:name :list-view
   :enter
   (fn [context]
     (if-let [db-id (get-in context [:request :path-params :list-id])]                  
       (if-let [the-list (find-list-by-id (get-in context [:request :database]) db-id)] 
         (assoc context :result the-list)                                               
         context)
       context))})</pre>
Couldn&apos;t this just be something like:
<pre>(defn list-view [request]
  (if-let [db-id (get-in request [:path-params :list-id])]                  
    (if-let [the-list (find-list-by-id db-id)] 
      the-list)))</pre>
Where the <code>find-list-by-id</code> domain method would also hide the implementation detail of the repository / data layer?</z><z id="t1667609662" t="jmv I typically do it the way you’re suggesting. "><y>#</y><d>2022-11-05</d><h>00:54</h><r>jmv</r>I typically do it the way you’re suggesting. </z><z id="t1667755381" t="hlship I prefer to avoid globals at all cost, since that impacts testing. If the database is in the context, then I can fabricate a context with a mock database for testing purposes, and have confidence in my code. If the database is a global, then tests can have unintended consequences. It&apos;s about pushing the side-effecting, non-functional parts of your code into carefully managed corners. Your mileage may vary."><y>#</y><d>2022-11-06</d><h>17:23</h><r>hlship</r>I prefer to avoid globals at all cost, since that impacts testing.  If the database is in the context, then I can fabricate a context with a mock database for testing purposes, and have confidence in my code.  If the database is a global, then tests can have unintended consequences.  It&apos;s about pushing the side-effecting, non-functional parts of your code into carefully managed corners. Your mileage may vary.</z><z id="t1667873821" t="vemv I think there are two questions in one in OP: • why use interceptors for domain logic? • why inject the DB? the latter is already answered. For the former, I&apos;d say that not everything has to be an interceptor. Or at least your interceptors can be very thin, invoking independent defns that are agnostic about requests, interceptors and so on. This relates to a couple concepts: • &quot;thin controllers, fat models&quot; which is a Rails mantra (an interceptor is somewhat analog to a controller) • Hexagonal architecture e.g. decouple domain logic from HTTP processing."><y>#</y><d>2022-11-08</d><h>02:17</h><r>vemv</r>I think there are two questions in one in OP:

• why use interceptors for domain logic?
• why inject the DB?
the latter is already answered.

For the former, I&apos;d say that not everything has to be an interceptor. Or at least your interceptors can be very thin, invoking independent defns that are agnostic about requests, interceptors and so on.

This relates to a couple concepts:

• &quot;thin controllers, fat models&quot; which is a Rails mantra (an interceptor is somewhat analog to a controller)
• Hexagonal architecture e.g. decouple domain logic from HTTP processing.</z><z id="t1667996999" t="agorgl Can we somehow make resources / static content work like most other static content servers like nginx where serves in pedestal?"><y>#</y><d>2022-11-09</d><h>12:29</h><w>agorgl</w>Can we somehow make resources / static content work like most other static content servers like nginx where <code></code> serves <code></code> in pedestal?</z><z id="t1668001159" t="agorgl I went down the rabbit hole. Seems that by default pedestal uses both content-type and file-path middleware / interceptors from ring: https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L260 https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L268 defined here: https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L69 https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L81 which lead inside ring: https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/content_type.clj#L6 https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/file.clj#L19 https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/util/response.clj#L148"><y>#</y><d>2022-11-09</d><h>13:39</h><r>agorgl</r>I went down the rabbit hole.
Seems that by default pedestal uses both <code>content-type</code> and <code>file-path</code> middleware / interceptors from ring:
<a href="https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L260" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L260</a>
<a href="https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L268" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http.clj#L268</a>
defined here:
<a href="https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L69" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L69</a>
<a href="https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L81" target="_blank">https://github.com/pedestal/pedestal/blob/0.5.10/service/src/io/pedestal/http/ring_middlewares.clj#L81</a>
which lead inside ring:
<a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/content_type.clj#L6" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/content_type.clj#L6</a>
<a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/file.clj#L19" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/middleware/file.clj#L19</a>
<a href="https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/util/response.clj#L148" target="_blank">https://github.com/ring-clojure/ring/blob/master/ring-core/src/ring/util/response.clj#L148</a></z><z id="t1668001330" t="agorgl Using ::http/file-path to enable the default file pedestal interceptor by e.g. specifying ::http/file-path &quot;resources/public/&quot; works, but not as expected. It now serves files from given directory, but with a content-type response of application/octet-stream which leads to the html file being downloaded instead of presented by the browser"><y>#</y><d>2022-11-09</d><h>13:42</h><r>agorgl</r>Using <code>::http/file-path</code> to enable the default <code>file</code> pedestal interceptor by e.g. specifying <code>::http/file-path &quot;resources/public/&quot;</code> works, but not as expected. It now serves files from given directory, but with a content-type response of <code>application/octet-stream</code> which leads to the html file being downloaded instead of presented by the browser</z><z id="t1668020618" t="hanDerPeder Check out the fast-resource interceptor. https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L148"><y>#</y><d>2022-11-09</d><h>19:03</h><r>hanDerPeder</r>Check out the fast-resource interceptor.
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L148" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/ring_middlewares.clj#L148</a></z><z id="t1668022727" t="agorgl Tried fast-resource interceptor too, same outcome as file interceptor"><y>#</y><d>2022-11-09</d><h>19:38</h><r>agorgl</r>Tried fast-resource interceptor too, same outcome as file interceptor</z><z id="t1668022870" t="agorgl I removed :: http/resource-path to disable default resource interceptor and added a route like: [&quot;/&quot; :get [(middleware/fast-resource &quot;/public&quot;)]] inspected the service map just to make sure, and same result: while I get the index.html back in the response, the content type is set to application/octet-stream and this leads to a download"><y>#</y><d>2022-11-09</d><h>19:41</h><r>agorgl</r>I removed <b>::</b>http/resource-path to disable default resource interceptor and added a route like:
<pre>[&quot;/&quot; :get [(middleware/fast-resource &quot;/public&quot;)]]</pre>
inspected the service map just to make sure, and same result: while I get the index.html back in the response, the content type is set to application/octet-stream and this leads to a download</z><z id="t1668023760" t="hanDerPeder ah, yes. i remember now. the content-type ring middleware only sets the content type based on the request uri. it does not look at the file extension. theres an issue and a PR that fixes this in the ring repo, but alas, its not merged. https://github.com/ring-clojure/ring/issues/408 https://github.com/ring-clojure/ring/pull/452 we ended up doing this at work: `(defn content-type-interceptor [] (after :: content-type-interceptor (fn [ctx] (let [uri (get-in ctx [:request :uri]) resp (:response ctx)] (if-let [mime-type (or (get-in ctx [:response :headers &quot;Content-Type&quot;]) (mime/ext-mime-type uri) ;; Additional check compared to io.pedestal.http.ring-middlewares/content-type ;; Workaround for problem described here: https://github.com/ring-clojure/ring/issues/408 (when (instance? File (:body resp)) (mime/ext-mime-type (.getAbsolutePath (:body resp)))) ;; Same problem as above, when all else fails. Look for a hint in the context map. (when ( :: mime-lookup ctx) (mime/ext-mime-type ( :: mime-lookup ctx))))] (assoc-in ctx [:response :headers &quot;Content-Type&quot;] mime-type) ctx)))))` "><y>#</y><d>2022-11-09</d><h>19:56</h><r>hanDerPeder</r>ah, yes. i remember now. the content-type ring middleware only sets the content type based on the request uri. it does not look at the file extension. theres an issue and a PR that fixes this in the ring repo, but alas, its not merged.

<a href="https://github.com/ring-clojure/ring/issues/408" target="_blank">https://github.com/ring-clojure/ring/issues/408</a>
<a href="https://github.com/ring-clojure/ring/pull/452" target="_blank">https://github.com/ring-clojure/ring/pull/452</a>

we ended up doing this at work:

`(defn content-type-interceptor []
  (after <b>::</b>content-type-interceptor
         (fn [ctx]
           (let [uri  (get-in ctx [:request :uri])
                 resp (:response ctx)]
             (if-let [mime-type (or (get-in ctx [:response :headers &quot;Content-Type&quot;])
                                    (mime/ext-mime-type uri)

                                    ;; Additional check compared to io.pedestal.http.ring-middlewares/content-type
                                    ;; Workaround for problem described here: <a href="https://github.com/ring-clojure/ring/issues/408" target="_blank">https://github.com/ring-clojure/ring/issues/408</a>
                                    (when (instance? File (:body resp))
                                      (mime/ext-mime-type (.getAbsolutePath (:body resp))))

                                    ;; Same problem as above, when all else fails. Look for a hint in the context map.
                                    (when (<b>::</b>mime-lookup ctx)
                                      (mime/ext-mime-type (<b>::</b>mime-lookup ctx))))]

               (assoc-in ctx [:response :headers &quot;Content-Type&quot;] mime-type)
               ctx)))))`
</z><z id="t1668027649" t="agorgl I think that does the trick, although I would love this functionality to be supported upstream"><y>#</y><d>2022-11-09</d><h>21:00</h><r>agorgl</r>I think that does the trick, although I would love this functionality to be supported upstream</z><z id="t1668027654" t="agorgl Thanks for the suggestion!"><y>#</y><d>2022-11-09</d><h>21:00</h><r>agorgl</r>Thanks for the suggestion!</z><z id="t1668024850" t="dangercoder Is there something in pedestal which lets me define an interceptor which is executed before every other interceptor in the chain? (I want to tap&gt; the interceptor :name and context for debugging purposes) 🙂 . {::interceptor-name :my-interceptor ::input-context context}"><y>#</y><d>2022-11-09</d><h>20:14</h><w>dangercoder</w>Is there something in pedestal which lets me define an interceptor which is executed before every other interceptor in the chain? (I want to <code>tap&gt;</code> the interceptor <code>:name</code> and context for debugging purposes) <b>🙂</b>.

<code>{::interceptor-name :my-interceptor</code>
 <code>::input-context    context}</code></z><z id="t1668025657" t="hanDerPeder No, but that should be fairly straight forward to create: 1 map :name over your chain 2 instantiate the &quot;tapping&quot; interceptor for each name 3 interleave those with your original chain"><y>#</y><d>2022-11-09</d><h>20:27</h><r>hanDerPeder</r>No, but that should be fairly straight forward to create:

1 map :name over your chain
2 instantiate the &quot;tapping&quot; interceptor for each name
3 interleave those with your original chain</z><z id="t1668025816" t="hanDerPeder I think metosin has something like this, maybe in reitit, that will also run diff on the context to highlight whats changed."><y>#</y><d>2022-11-09</d><h>20:30</h><r>hanDerPeder</r>I think metosin has something like this, maybe in reitit, that will also run diff on the context to highlight whats changed.</z><z id="t1668026499" t="dangercoder Thanks for the ideas, very much appreciated!"><y>#</y><d>2022-11-09</d><h>20:41</h><r>dangercoder</r>Thanks for the ideas, very much appreciated!</z><z id="t1668032803" t="hlship Also, Pedestal already has logging of :enter, :leave, and :exit for each interceptor."><y>#</y><d>2022-11-09</d><h>22:26</h><r>hlship</r>Also, Pedestal already has logging of :enter, :leave, and :exit for each interceptor.</z><z id="t1668032814" t="hlship Take a look in the .chain namespace."><y>#</y><d>2022-11-09</d><h>22:26</h><r>hlship</r>Take a look in the .chain namespace.</z><z id="t1668069356" t="dangercoder 👍"><y>#</y><d>2022-11-10</d><h>08:35</h><r>dangercoder</r><b>👍</b></z><z id="t1669068453" t="hlship We just pushed 0.5.11-beta-1 up to clojars. Feedback is most welcome, especially if you have any difficulty upgrading to the lastest versions."><y>#</y><d>2022-11-21</d><h>22:07</h><w>hlship</w>We just pushed 0.5.11-beta-1 up to clojars.  Feedback is most welcome, especially if you have any difficulty upgrading to the lastest versions.</z><z id="t1669075180" t="Joe R. Smith What kind of difficulty do you speak of?"><y>#</y><d>2022-11-21</d><h>23:59</h><r>Joe R. Smith</r>What kind of difficulty do you speak of?</z><z id="t1669126926" t="hlship Just the normal challenges when third-party dependencies change. Outside of those changes, there is not a lot in this release."><y>#</y><d>2022-11-22</d><h>14:22</h><r>hlship</r>Just the normal challenges when third-party dependencies change.  Outside of those changes, there is not a lot in this release.</z><z id="t1669242627" t="lread Congrats on the release! As new maintainers, are you planning on keeping the https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md , https://github.com/pedestal/pedestal/tags and https://github.com/pedestal/pedestal/releases up to date?"><y>#</y><d>2022-11-23</d><h>22:30</h><r>lread</r>Congrats on the release! As new maintainers, are you planning on keeping the <a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md</a>, <a href="https://github.com/pedestal/pedestal/tags" target="_blank">https://github.com/pedestal/pedestal/tags</a> and <a href="https://github.com/pedestal/pedestal/releases" target="_blank">https://github.com/pedestal/pedestal/releases</a> up to date?</z><z id="t1669242811" t="lread (not suggesting you should, I just find these things helpful and am curious)"><y>#</y><d>2022-11-23</d><h>22:33</h><r>lread</r>(not suggesting you should, I just find these things helpful and am curious)</z><z id="t1669244030" t="lread Also: any big reason for the beta qualifier? Note that tools like https://github.com/liquidz/antq will not show updates that have alpha beta rc qualifiers because they are considered to be in development (and assumedly not production candidates). This will make it harder for folks to discover the new release."><y>#</y><d>2022-11-23</d><h>22:53</h><r>lread</r>Also: any big reason for the <code>beta</code> qualifier? Note that tools like <a href="https://github.com/liquidz/antq" target="_blank">https://github.com/liquidz/antq</a> will not show updates that have <code>alpha</code> <code>beta</code> <code>rc</code> qualifiers because they are considered to be in development (and assumedly not production candidates). This will make it harder for folks to discover the new release.</z><z id="t1669242627" t="lread Congrats on the release! As new maintainers, are you planning on keeping the https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md , https://github.com/pedestal/pedestal/tags and https://github.com/pedestal/pedestal/releases up to date?"><y>#</y><d>2022-11-23</d><h>22:30</h><w>lread</w>Congrats on the release! As new maintainers, are you planning on keeping the <a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md</a>, <a href="https://github.com/pedestal/pedestal/tags" target="_blank">https://github.com/pedestal/pedestal/tags</a> and <a href="https://github.com/pedestal/pedestal/releases" target="_blank">https://github.com/pedestal/pedestal/releases</a> up to date?</z><z id="t1669244030" t="lread Also: any big reason for the beta qualifier? Note that tools like https://github.com/liquidz/antq will not show updates that have alpha beta rc qualifiers because they are considered to be in development (and assumedly not production candidates). This will make it harder for folks to discover the new release."><y>#</y><d>2022-11-23</d><h>22:53</h><w>lread</w>Also: any big reason for the <code>beta</code> qualifier? Note that tools like <a href="https://github.com/liquidz/antq" target="_blank">https://github.com/liquidz/antq</a> will not show updates that have <code>alpha</code> <code>beta</code> <code>rc</code> qualifiers because they are considered to be in development (and assumedly not production candidates). This will make it harder for folks to discover the new release.</z><z id="t1669122008" t="souenzzo Happy to see this pedestal release Two questions: • why https://github.com/pedestal/pedestal/blob/master/.github/workflows/ci.yml#L18 ?? • Any hope to https://github.com/pedestal/pedestal/issues/666 ? We are now using requiring-resolve, so my proposal is way easier to apply 🙂 "><y>#</y><d>2022-11-22</d><h>13:00</h><w>souenzzo</w>Happy to see this pedestal release
Two questions:
• why <a href="https://github.com/pedestal/pedestal/blob/master/.github/workflows/ci.yml#L18" target="_blank">https://github.com/pedestal/pedestal/blob/master/.github/workflows/ci.yml#L18</a>??
• Any hope to <a href="https://github.com/pedestal/pedestal/issues/666" target="_blank">https://github.com/pedestal/pedestal/issues/666</a>? We are now using requiring-resolve, so my proposal is way easier to apply <b>🙂</b> </z><z id="t1669132125" t="orestis Circling back to https://clojurians.slack.com/archives/C0K65B20P/p1667449481412759 (no easy way to set a ThreadContext in pedestal/log), I discovered that obviously ThreadContext doesn&apos;t get propagated via bound-fn - as only clojure bindings are taken into account. So I need a way to set (or pull) values from a binding, but under a custom name..."><y>#</y><d>2022-11-22</d><h>15:48</h><w>orestis</w>Circling back to <a href="https://clojurians.slack.com/archives/C0K65B20P/p1667449481412759" target="_blank">https://clojurians.slack.com/archives/C0K65B20P/p1667449481412759</a> (no easy way to set a <code>ThreadContext</code> in pedestal/log), I discovered that obviously <code>ThreadContext</code> doesn&apos;t get propagated via <code>bound-fn</code> - as only clojure bindings are taken into account. So I need a way to set (or pull) values from a binding, but under a custom name...</z><z id="t1669132602" t="orestis Context: all I want to do is, for our multi-tenant app, correlate logs messages with the tenants that made the request. It seems like I have to write my own logging functions that look at a thread-local dynamic var that stores the tenant id?"><y>#</y><d>2022-11-22</d><h>15:56</h><w>orestis</w>Context: all I want to do is, for our multi-tenant app, correlate logs messages with the tenants that made the request. It seems like I have to write my own logging functions that look at a thread-local dynamic var that stores the tenant id?</z><z id="t1669132909" t="orestis This is probably a job for tracing, but again I can&apos;t find a way to do this..."><y>#</y><d>2022-11-22</d><h>16:01</h><r>orestis</r>This is probably a job for tracing, but again I can&apos;t find a way to do this...</z><z id="t1669142294" t="hlship It&apos;s tricky because of Pedestal&apos;s approach to logging."><y>#</y><d>2022-11-22</d><h>18:38</h><r>hlship</r>It&apos;s tricky because of Pedestal&apos;s approach to logging.</z><z id="t1669142337" t="hlship Perhaps what&apos;s needed is an extension to chain/execute that allows user code to perform pre and post execution setup before an interceptor is called."><y>#</y><d>2022-11-22</d><h>18:38</h><r>hlship</r>Perhaps what&apos;s needed is an extension to chain/execute that allows user code to perform pre and post execution setup before an interceptor is called.</z><z id="t1669142352" t="hlship Such that, say, support for :bindings is a specific example of a more general case."><y>#</y><d>2022-11-22</d><h>18:39</h><r>hlship</r>Such that, say, support for :bindings is a specific example of a more general case.</z><z id="t1669142867" t="orestis Taking a step back from pedestal interceptors, and focusing on pedestal/log : the issue crops up in lacinia-pedestal which AFAICT does asynchronous query execution. So, the lacinia resolver functions are called in a different thread than the http interceptor, therefore my approach to use log4j2 ThreadContext to put the tenant id in all &quot;child&quot; logging calls doesn&apos;t work - I have to use a clojure dynamic var since at least that&apos;s propagated across if you&apos;re a bit careful with futures/agents."><y>#</y><d>2022-11-22</d><h>18:47</h><r>orestis</r>Taking a step back from pedestal interceptors, and focusing on <code>pedestal/log</code> : the issue crops up in <code>lacinia-pedestal</code> which AFAICT does asynchronous query execution.

So, the lacinia resolver functions are called in a different thread than the http interceptor, therefore my approach to use log4j2 <code>ThreadContext</code> to put the tenant id in all &quot;child&quot; logging calls doesn&apos;t work - I have to use a clojure dynamic var since at least that&apos;s propagated across if you&apos;re a bit careful with futures/agents.</z><z id="t1669142913" t="orestis I find the MDC code of pedestal/log hard to parse, it seems like there might be a way to put in a custom MDC implementation? There&apos;s a little bit of abstraction there but it&apos;s not clear to me yet if/how it can be done."><y>#</y><d>2022-11-22</d><h>18:48</h><r>orestis</r>I find the MDC code of <code>pedestal/log</code> hard to parse, it seems like there might be a way to put in a custom MDC implementation? There&apos;s a little bit of abstraction there but it&apos;s not clear to me yet if/how it can be done.</z><z id="t1669143813" t="orestis One more thing before I go to bed... possible solution to my problem: 1. It seems like Log4j2 can be made to use an InheritableThreadLocal which might work for my use case, and 2. It also seems I can override the Pedestal logger entirely (though I don&apos;t really want to do that). 3. I could implement my own macros (info/warn/etc) that make use of a dynamic var and use pedestal/log as an implementation detail, which might be the simplest approach but I&apos;d lose information if library code doesn&apos;t use our library, hmmm"><y>#</y><d>2022-11-22</d><h>19:03</h><r>orestis</r>One more thing before I go to bed... possible solution to my problem:
1.  It seems like Log4j2 can be made to use an <code>InheritableThreadLocal</code> which might work for my use case, and
2. It also seems I can override the Pedestal logger entirely (though I don&apos;t really want to do that). 
3. I could implement my own macros (info/warn/etc) that make use of a dynamic var and use <code>pedestal/log</code> as an implementation detail, which might be the simplest approach but I&apos;d lose information if library code doesn&apos;t use our library, hmmm</z><z id="t1669149102" t="MIJOTHY i opted for (3), given various issues I’ve had with MDCs ( https://github.com/malcolmsparks/clj-logging-config/issues/19#issue-13690326 , https://stackoverflow.com/questions/6073019/how-to-use-mdc-with-thread-pools ), and wanting to ensure uniform serialisation of our app data before it hits the slf4j impl that clients can specify"><y>#</y><d>2022-11-22</d><h>20:31</h><r>MIJOTHY</r>i opted for (3), given various issues I’ve had with MDCs (<a href="https://github.com/malcolmsparks/clj-logging-config/issues/19#issue-13690326" target="_blank">https://github.com/malcolmsparks/clj-logging-config/issues/19#issue-13690326</a>, <a href="https://stackoverflow.com/questions/6073019/how-to-use-mdc-with-thread-pools" target="_blank">https://stackoverflow.com/questions/6073019/how-to-use-mdc-with-thread-pools</a>), and wanting to ensure uniform serialisation of our app data before it hits the slf4j impl that clients can specify</z><z id="t1669149278" t="MIJOTHY if i had complete control over the logging stack (i.e. didn’t have the requirement of consumers being able to bring thier own logging impl. so could just log to stdout in a single-line json format), i’d probably go with mulog. but given the constraint of “impl supplied by consumer”, the lack of needing to correlate logging by 3rd party libs (which only log at DEBUG and whose logging isn’t anywhere near as useful as our clojure code’s logs), using a dynvar for context in a thin wrapper over pedestal was an easy way to make things work"><y>#</y><d>2022-11-22</d><h>20:34</h><r>MIJOTHY</r>if i had complete control over the logging stack (i.e. didn’t have the requirement of consumers being able to bring thier own logging impl. so could just log to stdout in a single-line json format), i’d probably go with mulog. but given the constraint of “impl supplied by consumer”, the lack of needing to correlate logging by 3rd party libs (which only log at DEBUG and whose logging isn’t anywhere near as useful as our clojure code’s logs), using a dynvar for context in a thin wrapper over pedestal was an easy way to make things work</z><z id="t1669188454" t="orestis Thanks [:attrs {:href &quot;/_/_/users/U017FSCPU30&quot;}]"><y>#</y><d>2022-11-23</d><h>07:27</h><r>orestis</r>Thanks <a>@U017FSCPU30</a></z><z id="t1669190149" t="orestis Looking at https://issues.apache.org/jira/browse/LOG4J2-479 , InheritableThreadLocal seems to be a footgun waiting to happen, so that&apos;s out too."><y>#</y><d>2022-11-23</d><h>07:55</h><r>orestis</r>Looking at <a href="https://issues.apache.org/jira/browse/LOG4J2-479" target="_blank">https://issues.apache.org/jira/browse/LOG4J2-479</a>, <code>InheritableThreadLocal</code> seems to be a footgun waiting to happen, so that&apos;s out too.</z><z id="t1669665536" t="Esteban Ginocchio Silva Does anyone know if there any good libraries to generate OpenApi3 documentation from a pedestal server?"><y>#</y><d>2022-11-28</d><h>19:58</h><w>Esteban Ginocchio Silva</w>Does anyone know if there any good libraries to generate OpenApi3 documentation from a pedestal server?</z><z id="t1669762019" t="richiardiandrea He folks, we are thinking of accepting yaml on one of our endpoints, does a yaml interceptor exist out there in the wild?"><y>#</y><d>2022-11-29</d><h>22:46</h><w>richiardiandrea</w>He folks, we are thinking of accepting yaml on one of our endpoints, does a <code>yaml</code> interceptor exist out there in the wild?</z><z id="t1669762840" t="hlship io.pedestal.http.body-params/body-params can do this, but not out of the box (it supports JSON, EDN, transit, and HTTP forms out of the box) ; you can plug in a parser for yaml pretty easily I suspect."><y>#</y><d>2022-11-29</d><h>23:00</h><r>hlship</r>io.pedestal.http.body-params/body-params can do this, but not out of the box (it supports JSON, EDN, transit, and HTTP forms out of the box) ; you can plug in a parser for yaml pretty easily I suspect.</z><z id="t1669762899" t="richiardiandrea Ok I&apos;ll try to take that route, I guess the parse is pluggable via service map?"><y>#</y><d>2022-11-29</d><h>23:01</h><r>richiardiandrea</r>Ok I&apos;ll try to take that route, I guess the parse is pluggable via service map?</z><z id="t1669765001" t="lread If you need a YAML parser, I&apos;m one of the maintainers of https://github.com/clj-commons/clj-yaml , which is a wrapper around SnakeYAML. Drop by #C042XAQFCCU if you decide to use it and have any questions."><y>#</y><d>2022-11-29</d><h>23:36</h><r>lread</r>If you need a YAML parser, I&apos;m one of the maintainers of <a href="https://github.com/clj-commons/clj-yaml" target="_blank">https://github.com/clj-commons/clj-yaml</a>, which is a wrapper around SnakeYAML. Drop by #C042XAQFCCU if you decide to use it and have any questions.</z><z id="t1671383810" t="Ben Hammond Hi I get a Jetty conflict between com.cognitect.aws/api 0.8.612 and io.pedestal/pedestal.jetty 0.5.10 They load different versions of Jetty which appear to play badly together org.eclipse.jetty/jetty-http 9.4.48.v20220622 tries to call in to org.eclipse.jetty/jetty-servlet 9.4.44.v20210927 and ends up with an UnsupportedOperationException. is this a known problem? and is there a standard fix? Stack trace looks like java.lang.UnsupportedOperationException: Use .getMatched(String) instead at org.eclipse.jetty.http.pathmap.PathMappings.getMatch(PathMappings.java:259) at org.eclipse.jetty.servlet.ServletHandler.getMappedServlet(ServletHandler.java:572) at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:468) at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349) at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) at org.eclipse.jetty.server.Server.handle(Server.java:512) at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:400) at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:645) at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:392) at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555) at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410) at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164) at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883) at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034) at java.base/java.lang.Thread.run(Thread.java:831)"><y>#</y><d>2022-12-18</d><h>17:16</h><w>Ben Hammond</w>Hi I get a Jetty conflict between
<pre>com.cognitect.aws/api 0.8.612</pre>
and
<pre>io.pedestal/pedestal.jetty 0.5.10</pre>
They load different versions of Jetty which appear to play badly together
<pre>org.eclipse.jetty/jetty-http 9.4.48.v20220622</pre>
tries to call in to
<pre>org.eclipse.jetty/jetty-servlet 9.4.44.v20210927</pre>
and ends up with an UnsupportedOperationException.

is this a known problem? and is there a standard fix?
Stack trace looks like
<pre>java.lang.UnsupportedOperationException: Use .getMatched(String) instead
	at org.eclipse.jetty.http.pathmap.PathMappings.getMatch(PathMappings.java:259)
	at org.eclipse.jetty.servlet.ServletHandler.getMappedServlet(ServletHandler.java:572)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:468)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:512)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:400)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:645)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:392)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555)
	at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410)
	at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
	at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
	at java.base/java.lang.Thread.run(Thread.java:831)</pre></z><z id="t1671383887" t="Ben Hammond should I force io.pedestal/pedestal.jetty to use the new Jetty libraries?"><y>#</y><d>2022-12-18</d><h>17:18</h><r>Ben Hammond</r>should I force io.pedestal/pedestal.jetty to use the new Jetty libraries?</z><z id="t1671387580" t="souenzzo TLDR: yes. I think that you should simply use the newer ones."><y>#</y><d>2022-12-18</d><h>18:19</h><r>souenzzo</r>TLDR: yes. I think that you should simply use the newer ones.</z><z id="t1671395141" t="hlship We have an alpha release of Pedestal 0.5.11 that&apos;s actually reasonably stable and updates the Jetty dependencies to 9.4.48.v20220622. I&apos;m not at the office now so I&apos;m having trouble tracking down where the dependency from aws/api to jetty comes from."><y>#</y><d>2022-12-18</d><h>20:25</h><r>hlship</r>We have an alpha release of Pedestal 0.5.11 that&apos;s actually reasonably stable and updates the Jetty dependencies to 9.4.48.v20220622.  I&apos;m not at the office now so I&apos;m having trouble tracking down where the dependency from aws/api to jetty comes from.</z><z id="t1671395204" t="hlship I may have a few minutes tomorrow to track this down. I&apos;d check the dependency tree of aws/api."><y>#</y><d>2022-12-18</d><h>20:26</h><r>hlship</r>I may have a few minutes tomorrow to track this down.  I&apos;d check the dependency tree of aws/api.</z><z id="t1671397823" t="Ben Hammond just to confirm - I can make my problem go away with this deps.edn configuration io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.10&quot; :exclusions [org.eclipse.jetty/jetty-alpn-server org.eclipse.jetty/jetty-security org.eclipse.jetty/jetty-server org.eclipse.jetty/jetty-servlet org.eclipse.jetty/jetty-util-ajax]} org.eclipse.jetty/jetty-alpn-server {:mvn/version &quot;9.4.48.v20220622&quot;} org.eclipse.jetty/jetty-server {:mvn/version &quot;9.4.48.v20220622&quot;} org.eclipse.jetty/jetty-servlet {:mvn/version &quot;9.4.48.v20220622&quot;}"><y>#</y><d>2022-12-18</d><h>21:10</h><r>Ben Hammond</r>just to confirm -  I can make my problem go away with this deps.edn configuration
<pre>io.pedestal/pedestal.jetty {:mvn/version &quot;0.5.10&quot;
                                    :exclusions [org.eclipse.jetty/jetty-alpn-server
                                                 org.eclipse.jetty/jetty-security
                                                 org.eclipse.jetty/jetty-server
                                                 org.eclipse.jetty/jetty-servlet
                                                 org.eclipse.jetty/jetty-util-ajax]}
        org.eclipse.jetty/jetty-alpn-server {:mvn/version &quot;9.4.48.v20220622&quot;}
        org.eclipse.jetty/jetty-server {:mvn/version &quot;9.4.48.v20220622&quot;}
        org.eclipse.jetty/jetty-servlet {:mvn/version &quot;9.4.48.v20220622&quot;}</pre></z><z id="t1671465347" t="hlship com.cognitect/http-client has a dep on jetty-client 9.4.48.v20220622 pedestal-jetty 0.5.11-alpha-1 also has a dep on 9.4.48.v20220622, so using the alpha will also fix this issue."><y>#</y><d>2022-12-19</d><h>15:55</h><r>hlship</r>com.cognitect/http-client has a dep on jetty-client 9.4.48.v20220622

pedestal-jetty 0.5.11-alpha-1 also has a dep on 9.4.48.v20220622, so using the alpha will also fix this issue.</z><z id="t1671465477" t="Ben Hammond mvnrepository reckons it is in beta. https://mvnrepository.com/artifact/io.pedestal/pedestal.jetty/0.5.11-beta-1 ☝️ this one?"><y>#</y><d>2022-12-19</d><h>15:57</h><r>Ben Hammond</r>mvnrepository reckons it is in beta.
<a href="https://mvnrepository.com/artifact/io.pedestal/pedestal.jetty/0.5.11-beta-1" target="_blank">https://mvnrepository.com/artifact/io.pedestal/pedestal.jetty/0.5.11-beta-1</a>
<b>☝️</b>
this one?</z><z id="t1671667363" t="lread Just noticing that pedestal is deployed to both https://mvnrepository.com/artifact/io.pedestal?sort=popular and https://clojars.org/search?q=io.pedestal . Are they both official? If so, why both?"><y>#</y><d>2022-12-22</d><h>00:02</h><w>lread</w>Just noticing that pedestal is deployed to both <a href="https://mvnrepository.com/artifact/io.pedestal?sort=popular" target="_blank">https://mvnrepository.com/artifact/io.pedestal?sort=popular</a> and <a href="https://clojars.org/search?q=io.pedestal" target="_blank">https://clojars.org/search?q=io.pedestal</a>.
Are they both official? If so, why both?</z><z id="t1671704407" t="souenzzo From https://mvnrepository.com/artifact/io.pedestal/pedestal.service/0.5.11-beta-1 page: &gt; Note: this artifact is located at Clojars repository ( https://clojars.org/repo/ ) "><y>#</y><d>2022-12-22</d><h>10:20</h><r>souenzzo</r>From <a href="https://mvnrepository.com/artifact/io.pedestal/pedestal.service/0.5.11-beta-1" target="_blank">https://mvnrepository.com/artifact/io.pedestal/pedestal.service/0.5.11-beta-1</a> page:
&gt; Note: this artifact is located at Clojars repository (<a href="https://clojars.org/repo/" target="_blank">https://clojars.org/repo/</a>) </z><z id="t1671727991" t="lread Much thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ! I wrongly assumed mvnrepository only listed artifacts on maven central."><y>#</y><d>2022-12-22</d><h>16:53</h><r>lread</r>Much thanks <a>@U2J4FRT2T</a>! I wrongly assumed mvnrepository only listed artifacts on maven central.</z><z id="t1671733758" t="souenzzo 🙂 I usually only search in maven central."><y>#</y><d>2022-12-22</d><h>18:29</h><r>souenzzo</r><b>🙂</b>

I usually only search in maven central.</z><z id="t1672650563" t="simongray can anybody here help me contextualise https://github.com/factorhouse/slipway in the context of Pedestal?"><y>#</y><d>2023-01-02</d><h>09:09</h><w>simongray</w>can anybody here help me contextualise <a href="https://github.com/factorhouse/slipway" target="_blank">https://github.com/factorhouse/slipway</a> in the context of Pedestal?</z><z id="t1672650634" t="simongray e.g. would it be possible to swap out the Jetty used in Pedestal with Slipway?"><y>#</y><d>2023-01-02</d><h>09:10</h><w>simongray</w>e.g. would it be possible to swap out the Jetty used in Pedestal with Slipway?</z><z id="t1672653042" t="orestis I am not sure how Pedestal exposes its interceptors, but in theory you could put Pedestal’s interceptors on top of slipway. I can’t see the value proposition though. "><y>#</y><d>2023-01-02</d><h>09:50</h><r>orestis</r>I am not sure how Pedestal exposes its interceptors, but in theory you could put Pedestal’s interceptors on top of slipway. I can’t see the value proposition though. </z><z id="t1672653686" t="simongray Slipway seems to be a data-oriented wrapper of a more recent version of Jetty, so the value proposition—as I see it—is data all the way down when combined with Pedestal’s config. A big declarative server setup."><y>#</y><d>2023-01-02</d><h>10:01</h><r>simongray</r>Slipway seems to be a data-oriented wrapper of a more recent version of Jetty, so the value proposition—as I see it—is data all the way down when combined with Pedestal’s config. A big declarative server setup.</z><z id="t1673395092" t="CarnunMP Hey all. Been stumped with this for a little while now... I have some routes which look like: (def routes (route/expand-routes #{[&quot;/&quot; :get [interceptors/redirect-home]] [&quot;/:page-uid/:slug&quot; :get [interceptors/get-pages]] [&quot;/email-sub&quot; :put [interceptors/upsert-sub]]})) Any idea why the &quot;/email-sub&quot; route won&apos;t match/why I keep getting 404s? :thinking_face: Fwiw I have ::http/resource-path set on the service map, the interceptors all have :name s, the other routes work just fine, and I&apos;m using the http/default-interceptors . And another thing: upsert-sub &apos;s :enter never fires. The request never gets that far."><y>#</y><d>2023-01-10</d><h>23:58</h><w>CarnunMP</w>Hey all. Been stumped with this for a little while now...

I have some routes which look like:
<pre>(def routes
  (route/expand-routes
    #{[&quot;/&quot; :get [interceptors/redirect-home]]
      [&quot;/:page-uid/:slug&quot; :get [interceptors/get-pages]]
      [&quot;/email-sub&quot; :put [interceptors/upsert-sub]]}))</pre>
Any idea why the <code>&quot;/email-sub&quot;</code> route won&apos;t match/why I keep getting 404s? <b>:thinking_face:</b>

Fwiw I have <code>::http/resource-path</code> set on the service map, the interceptors all have <code>:name</code>s, the other routes work just fine, and I&apos;m using the <code>http/default-interceptors</code>.

And another thing: <code>upsert-sub</code>&apos;s <code>:enter</code> never fires. The request never gets that far.</z><z id="t1673395192" t="Joe R. Smith /email-sub doesn&apos;t match anything (unless you meant the last one to be /:c)"><y>#</y><d>2023-01-10</d><h>23:59</h><r>Joe R. Smith</r>/email-sub doesn&apos;t match anything (unless you meant the last one to be /:c)</z><z id="t1673395215" t="Joe R. Smith A PUT to /c doesn&apos;t invoke bar?"><y>#</y><d>2023-01-11</d><h>00:00</h><r>Joe R. Smith</r>A PUT to /c doesn&apos;t invoke bar?</z><z id="t1673395245" t="CarnunMP Sorry, was meant to be /c ! Edited now. 🙂"><y>#</y><d>2023-01-11</d><h>00:00</h><r>CarnunMP</r>Sorry, was meant to be <code>/c</code>! Edited now. <b>🙂</b></z><z id="t1673395253" t="CarnunMP And no, it doesn&apos;t."><y>#</y><d>2023-01-11</d><h>00:00</h><r>CarnunMP</r>And no, it doesn&apos;t.</z><z id="t1673395257" t="Joe R. Smith 🙂"><y>#</y><d>2023-01-11</d><h>00:00</h><r>Joe R. Smith</r><b>🙂</b></z><z id="t1673395311" t="Joe R. Smith hmm, doesn&apos;t match anything else"><y>#</y><d>2023-01-11</d><h>00:01</h><r>Joe R. Smith</r>hmm, doesn&apos;t match anything else</z><z id="t1673395507" t="CarnunMP right? 😅"><y>#</y><d>2023-01-11</d><h>00:05</h><r>CarnunMP</r>right? <b>😅</b></z><z id="t1673395564" t="Joe R. Smith does it work w/ any other http verb? e.g., if you change it to :get ?"><y>#</y><d>2023-01-11</d><h>00:06</h><r>Joe R. Smith</r>does it work w/ any other http verb? e.g., if you change it to :get ?</z><z id="t1673395617" t="CarnunMP nope, same issue"><y>#</y><d>2023-01-11</d><h>00:06</h><r>CarnunMP</r>nope, same issue</z><z id="t1673395625" t="CarnunMP :post too"><y>#</y><d>2023-01-11</d><h>00:07</h><r>CarnunMP</r><code>:post</code> too</z><z id="t1673395685" t="Joe R. Smith so, really, you&apos;re saying a single component route with any http verb and any interceptor with an :enter never calls the enter fn?"><y>#</y><d>2023-01-11</d><h>00:08</h><r>Joe R. Smith</r>so, really, you&apos;re saying a single component route with any http verb and any interceptor with an :enter never calls the enter fn?</z><z id="t1673395724" t="Joe R. Smith the routes are a set, so order ostensibly doesn&apos;t matter"><y>#</y><d>2023-01-11</d><h>00:08</h><r>Joe R. Smith</r>the routes are a set, so order ostensibly doesn&apos;t matter</z><z id="t1673395728" t="CarnunMP in the above case? yeah seems like it!"><y>#</y><d>2023-01-11</d><h>00:08</h><r>CarnunMP</r>in the above case? yeah

seems like it!</z><z id="t1673395732" t="Joe R. Smith what&apos;s the output of expand-routes?"><y>#</y><d>2023-01-11</d><h>00:08</h><r>Joe R. Smith</r>what&apos;s the output of expand-routes?</z><z id="t1673395825" t="CarnunMP no reason to be coy about real names on reflection, ha... ({:path &quot;/:page-uid/:slug&quot;, :method :get, :path-constraints {:page-uid &quot;([^/]+)&quot;, :slug &quot;([^/]+)&quot;}, :path-re #&quot;/([^/]+)/([^/]+)&quot;, :path-parts [:page-uid :slug], :interceptors [#io.pedestal.interceptor.Interceptor{:name :get-pages, :enter #object[carnun.com.server.interceptors$fn__44626 &quot;0x32682328&quot; &quot;carnun.com.server.interceptors$fn__44626@32682328&quot;], :leave nil, :error nil, :carnun/doc &quot;If the `single` query param is present, returns &apos;raw&apos; page html for the URL&apos;s primary page. Otherwise,\n returns html for all of the pages (primary + `pages`) wrapped in boilerplate — i.e. the full site.&quot;}], :route-name :get-pages, :path-params [:page-uid :slug]} {:path &quot;/email-sub&quot;, :method :put, :path-re #&quot;/\Qemail-sub\E&quot;, :path-parts [&quot;email-sub&quot;], :interceptors [#io.pedestal.interceptor.Interceptor{:name :upsert-sub, :enter #object[carnun.com.server.interceptors$fn__44629 &quot;0x6f35f49&quot; &quot;carnun.com.server.interceptors$fn__44629@6f35f49&quot;], :leave nil, :error nil}], :route-name :upsert-sub, :path-params []} {:path &quot;/&quot;, :method :get, :path-re #&quot;/\Q\E&quot;, :path-parts [&quot;&quot;], :interceptors [#io.pedestal.interceptor.Interceptor{:name :redirect-home, :enter #object[carnun.com.server.interceptors$fn__44624 &quot;0x106aac72&quot; &quot;carnun.com.server.interceptors$fn__44624@106aac72&quot;], :leave nil, :error nil}], :route-name :redirect-home, :path-params []})"><y>#</y><d>2023-01-11</d><h>00:10</h><r>CarnunMP</r>no reason to be coy about real names on reflection, ha...
<pre>({:path &quot;/:page-uid/:slug&quot;,
  :method :get,
  :path-constraints {:page-uid &quot;([^/]+)&quot;, :slug &quot;([^/]+)&quot;},
  :path-re #&quot;/([^/]+)/([^/]+)&quot;,
  :path-parts [:page-uid :slug],
  :interceptors [#io.pedestal.interceptor.Interceptor{:name :get-pages,
                                                      :enter #object[carnun.com.server.interceptors$fn__44626 &quot;0x32682328&quot; &quot;carnun.com.server.interceptors$fn__44626@32682328&quot;],
                                                      :leave nil,
                                                      :error nil,
                                                      :carnun/doc &quot;If the `single` query param is present, returns &apos;raw&apos; page html for the URL&apos;s primary page. Otherwise,\n               returns html for all of the pages (primary + `pages`) wrapped in boilerplate — i.e. the full site.&quot;}],
  :route-name :get-pages,
  :path-params [:page-uid :slug]}
 {:path &quot;/email-sub&quot;,
  :method :put,
  :path-re #&quot;/\Qemail-sub\E&quot;,
  :path-parts [&quot;email-sub&quot;],
  :interceptors [#io.pedestal.interceptor.Interceptor{:name :upsert-sub, :enter #object[carnun.com.server.interceptors$fn__44629 &quot;0x6f35f49&quot; &quot;carnun.com.server.interceptors$fn__44629@6f35f49&quot;], :leave nil, :error nil}],
  :route-name :upsert-sub,
  :path-params []}
 {:path &quot;/&quot;,
  :method :get,
  :path-re #&quot;/\Q\E&quot;,
  :path-parts [&quot;&quot;],
  :interceptors [#io.pedestal.interceptor.Interceptor{:name :redirect-home, :enter #object[carnun.com.server.interceptors$fn__44624 &quot;0x106aac72&quot; &quot;carnun.com.server.interceptors$fn__44624@106aac72&quot;], :leave nil, :error nil}],
  :route-name :redirect-home,
  :path-params []})</pre></z><z id="t1673395894" t="Joe R. Smith this one, I&apos;m guessing: {:path &quot;/email-sub&quot;, :method :put, :path-re #&quot;/\Qemail-sub\E&quot;, :path-parts [&quot;email-sub&quot;], :interceptors [#io.pedestal.interceptor.Interceptor{:name :upsert-sub, :enter #object[carnun.com.server.interceptors$fn__44629 &quot;0x6f35f49&quot; &quot;carnun.com.server.interceptors$fn__44629@6f35f49&quot;], :leave nil, :error nil}], :route-name :upsert-sub, :path-params []}"><y>#</y><d>2023-01-11</d><h>00:11</h><r>Joe R. Smith</r>this one, I&apos;m guessing:

<pre>{:path &quot;/email-sub&quot;,
  :method :put,
  :path-re #&quot;/\Qemail-sub\E&quot;,
  :path-parts [&quot;email-sub&quot;],
  :interceptors [#io.pedestal.interceptor.Interceptor{:name :upsert-sub, :enter #object[carnun.com.server.interceptors$fn__44629 &quot;0x6f35f49&quot; &quot;carnun.com.server.interceptors$fn__44629@6f35f49&quot;], :leave nil, :error nil}],
  :route-name :upsert-sub,
  :path-params []}</pre></z><z id="t1673395967" t="CarnunMP this weirdness holds with the redirect-home route omitted too, fwiw"><y>#</y><d>2023-01-11</d><h>00:12</h><r>CarnunMP</r>this weirdness holds with the <code>redirect-home</code> route omitted too, fwiw</z><z id="t1673395974" t="CarnunMP and yes, that&apos;s the one"><y>#</y><d>2023-01-11</d><h>00:12</h><r>CarnunMP</r>and yes, that&apos;s the one</z><z id="t1673395994" t="Joe R. Smith just ... bizarre"><y>#</y><d>2023-01-11</d><h>00:13</h><r>Joe R. Smith</r>just ... bizarre</z><z id="t1673396093" t="Joe R. Smith looking at a pedestal service of my own, I see no difference for a single component route"><y>#</y><d>2023-01-11</d><h>00:14</h><r>Joe R. Smith</r>looking at a pedestal service of my own, I see no difference for a single component route</z><z id="t1673396145" t="Joe R. Smith anything special about :upsert-sub ?"><y>#</y><d>2023-01-11</d><h>00:15</h><r>Joe R. Smith</r>anything special about :upsert-sub ?</z><z id="t1673396156" t="CarnunMP &gt; just ... bizarre you can say that again"><y>#</y><d>2023-01-11</d><h>00:15</h><r>CarnunMP</r>&gt; just ... bizarre
you can say that again</z><z id="t1673396199" t="CarnunMP certainly not right now! (def upsert-sub {:name :upsert-sub :enter (fn [ctx] (let [db (xt/db (get-in ctx path/xtdb-node))] (prn &quot;foo&quot;) (def ctx ctx) #_(email/upsert-sub) ;; save contact to db ;; send confirmation email (assoc ctx :response {:status 200 :body &quot;yo&quot; :headers {&quot;Content-Type&quot; &quot;text/plain&quot;}})))})"><y>#</y><d>2023-01-11</d><h>00:16</h><r>CarnunMP</r>certainly not right now!

<pre>(def upsert-sub
  {:name :upsert-sub
   :enter (fn [ctx]
            (let [db (xt/db (get-in ctx path/xtdb-node))]
              (prn &quot;foo&quot;)
              (def ctx ctx)
              #_(email/upsert-sub)
              ;; save contact to db
              ;; send confirmation email
              (assoc ctx :response {:status 200
                                    :body &quot;yo&quot;
                                    :headers {&quot;Content-Type&quot; &quot;text/plain&quot;}})))})</pre></z><z id="t1673396263" t="CarnunMP The idea that :enter here never fires is based on never seeing the prn output and ctx remaining unbound, fwiw."><y>#</y><d>2023-01-11</d><h>00:17</h><r>CarnunMP</r>The idea that <code>:enter</code> here never fires is based on never seeing the <code>prn</code> output and <code>ctx</code> remaining unbound, fwiw.</z><z id="t1673396295" t="Joe R. Smith seems pretty solid"><y>#</y><d>2023-01-11</d><h>00:18</h><r>Joe R. Smith</r>seems pretty solid</z><z id="t1673396312" t="Joe R. Smith don&apos;t names have to be ns-qualified?"><y>#</y><d>2023-01-11</d><h>00:18</h><r>Joe R. Smith</r>don&apos;t names have to be ns-qualified?</z><z id="t1673396320" t="Joe R. Smith e.g. :: upsert-sub"><y>#</y><d>2023-01-11</d><h>00:18</h><r>Joe R. Smith</r>e.g. <b>::</b>upsert-sub</z><z id="t1673396366" t="CarnunMP hmm, that isn&apos;t an issue with the other routes/interceptors"><y>#</y><d>2023-01-11</d><h>00:19</h><r>CarnunMP</r>hmm, that isn&apos;t an issue with the other routes/interceptors</z><z id="t1673396381" t="CarnunMP but idk, you might be right!"><y>#</y><d>2023-01-11</d><h>00:19</h><r>CarnunMP</r>but idk, you might be right!</z><z id="t1673396396" t="Joe R. Smith I&apos;ve never not qualified them, so I&apos;m just going off of experience. Probably not an issue"><y>#</y><d>2023-01-11</d><h>00:19</h><r>Joe R. Smith</r>I&apos;ve never not qualified them, so I&apos;m just going off of experience. Probably not an issue</z><z id="t1673396410" t="Joe R. Smith :name should be optional"><y>#</y><d>2023-01-11</d><h>00:20</h><r>Joe R. Smith</r>:name should be optional</z><z id="t1673396432" t="CarnunMP iirc they just have to be unique, which qualification increases the chances of 😛"><y>#</y><d>2023-01-11</d><h>00:20</h><r>CarnunMP</r>iirc they just have to be unique, which qualification increases the chances of <b>😛</b></z><z id="t1673396562" t="Joe R. Smith possible you&apos;re throwing an exception from your xt/db call and then swallowing that exception?"><y>#</y><d>2023-01-11</d><h>00:22</h><r>Joe R. Smith</r>possible you&apos;re throwing an exception from your xt/db call and then swallowing that exception?</z><z id="t1673396582" t="Joe R. Smith can you move your prn and def to before the let ?"><y>#</y><d>2023-01-11</d><h>00:23</h><r>Joe R. Smith</r>can you move your prn and def to before the let ?</z><z id="t1673396589" t="CarnunMP on it!"><y>#</y><d>2023-01-11</d><h>00:23</h><r>CarnunMP</r>on it!</z><z id="t1673396602" t="Joe R. Smith I&apos;m ... out of ideas. 😄"><y>#</y><d>2023-01-11</d><h>00:23</h><r>Joe R. Smith</r>I&apos;m ... out of ideas. <b>😄</b></z><z id="t1673396723" t="CarnunMP well... it was worth a shot"><y>#</y><d>2023-01-11</d><h>00:25</h><r>CarnunMP</r>well... it was worth a shot</z><z id="t1673396734" t="CarnunMP no change"><y>#</y><d>2023-01-11</d><h>00:25</h><r>CarnunMP</r>no change</z><z id="t1673396785" t="CarnunMP really appreciate the help regardless man 😄"><y>#</y><d>2023-01-11</d><h>00:26</h><r>CarnunMP</r>really appreciate the help regardless man <b>😄</b></z><z id="t1673396785" t="Joe R. Smith please tell me what it was when you figure it out so I can share in the facepalming for whatever simple thing we both missed"><y>#</y><d>2023-01-11</d><h>00:26</h><r>Joe R. Smith</r>please tell me what it was when you figure it out so I can share in the facepalming for whatever simple thing we both missed</z><z id="t1673396804" t="CarnunMP oh, goes without saying"><y>#</y><d>2023-01-11</d><h>00:26</h><r>CarnunMP</r>oh, goes without saying</z><z id="t1673396808" t="CarnunMP 😁"><y>#</y><d>2023-01-11</d><h>00:26</h><r>CarnunMP</r><b>😁</b></z><z id="t1673396810" t="Joe R. Smith goodluck!"><y>#</y><d>2023-01-11</d><h>00:26</h><r>Joe R. Smith</r>goodluck!</z><z id="t1673396815" t="CarnunMP ty!"><y>#</y><d>2023-01-11</d><h>00:26</h><r>CarnunMP</r>ty!</z><z id="t1673397140" t="CarnunMP (I&apos;m heading to bed now, 🤞 I dream the solution...)"><y>#</y><d>2023-01-11</d><h>00:32</h><r>CarnunMP</r>(I&apos;m heading to bed now, <b>🤞</b> I dream the solution...)</z><z id="t1673401496" t="souenzzo btw, there is route constraints http://pedestal.io/guides/defining-routes#_constraints"><y>#</y><d>2023-01-11</d><h>01:44</h><r>souenzzo</r>btw, there is route constraints
<a href="http://pedestal.io/guides/defining-routes#_constraints" target="_blank">http://pedestal.io/guides/defining-routes#_constraints</a></z><z id="t1673471212" t="CarnunMP Thanks for the suggestion [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] ! But I&apos;m not sure where they&apos;d come in here (given the below)... Do you have an idea? 🙂"><y>#</y><d>2023-01-11</d><h>21:06</h><r>CarnunMP</r>Thanks for the suggestion <a>@U2J4FRT2T</a>! But I&apos;m not sure where they&apos;d come in here (given the below)...

Do you have an idea? <b>🙂</b></z><z id="t1673471249" t="CarnunMP *(given the below, and that I&apos;m not landing on any other routes either 😕 )"><y>#</y><d>2023-01-11</d><h>21:07</h><r>CarnunMP</r>*(given the below, and that I&apos;m not landing on any other routes either <b>😕</b> )</z><z id="t1673471450" t="CarnunMP Huh! It seems things work just fine when I prefix both routes, e.g. with /blog/ and /api/ like so: (def routes (route/expand-routes #{[&quot;/&quot; :get [interceptors/redirect-home]] [&quot;/blog/:page-uid/:slug&quot; :get [interceptors/get-pages]] [&quot;/api/email-sub&quot; :put [interceptors/upsert-sub]]})) But why? :thinking_face:"><y>#</y><d>2023-01-11</d><h>21:10</h><r>CarnunMP</r>Huh! It seems things work just fine when I prefix both routes, e.g. with <code>/blog/</code> and <code>/api/</code> like so:
<pre>(def routes
  (route/expand-routes
    #{[&quot;/&quot; :get [interceptors/redirect-home]]
      [&quot;/blog/:page-uid/:slug&quot; :get [interceptors/get-pages]]
      [&quot;/api/email-sub&quot; :put [interceptors/upsert-sub]]}))</pre>
But why? <b>:thinking_face:</b></z><z id="t1673471723" t="CarnunMP cc: [:attrs {:href &quot;/_/_/users/U087E7EJW&quot;}]"><y>#</y><d>2023-01-11</d><h>21:15</h><r>CarnunMP</r>cc: <a>@U087E7EJW</a></z><z id="t1673978497" t="ajones from recommendations I was given years back around wild card routes and path params in pedestal it makes a lot of sense that it was having those problems (though been a while since I’ve read through the routers). where the /:page-uid/:slug is probably conflicting with the /email-sub route with them being at the same level, and the path param parsing of /:page-uid/:slug would interfere with the identification of the email-sub route. doing what you did and grouping the route for /:page-uid/:slug under some prefix, is the same recommendation I’d be giving people at work. the prefix for just the /blog/:page-uid/:slug route should be the only one needed. ran a few tests with a dummy pedestal-service template and things check out so far. looks like I’m more than a bit late to the convo (maybe you’ve already found the answer 🤷 ), though hopefully this helps someone in the future."><y>#</y><d>2023-01-17</d><h>18:01</h><r>ajones</r>from recommendations I was given years back around wild card routes and path params in pedestal it makes a lot of sense that it was having those problems (though been a while since I’ve read through the routers).

where the <code>/:page-uid/:slug</code> is probably conflicting with the <code>/email-sub</code> route with them being at the same level, and the path param parsing of <code>/:page-uid/:slug</code> would interfere with the identification of the <code>email-sub</code> route.

doing what you did and grouping the route for <code>/:page-uid/:slug</code> under some prefix, is the same recommendation I’d be giving people at work. the prefix for just the <code>/blog/:page-uid/:slug</code> route should be the only one needed. ran a few tests with a dummy <code>pedestal-service</code> template and things check out so far.

looks like I’m more than a bit late to the convo (maybe you’ve already found the answer <b>🤷</b>), though hopefully this helps someone in the future.</z><z id="t1675264247" t="CarnunMP [:attrs {:href &quot;/_/_/users/UE4SAM0A0&quot;}] I went with the prefixing, yep! 🙂"><y>#</y><d>2023-02-01</d><h>15:10</h><r>CarnunMP</r><a>@UE4SAM0A0</a> I went with the prefixing, yep! <b>🙂</b></z><z id="t1675264417" t="ajones [:attrs {:href &quot;/_/_/users/U018D6NKRA4&quot;}] cool 👍"><y>#</y><d>2023-02-01</d><h>15:13</h><r>ajones</r><a>@U018D6NKRA4</a> cool <b>👍</b></z><z id="t1676007298" t="Joe R. Smith I didn’t think of it at the time we last chatted, but there are also multiple routers with different routing semantics, see the table in this section of the docs: http://pedestal.io/reference/routing-quick-reference#_routers"><y>#</y><d>2023-02-10</d><h>05:34</h><r>Joe R. Smith</r>I didn’t think of it at the time we last chatted, but there are also multiple routers with different routing semantics, see the table in this section of the docs: <a href="http://pedestal.io/reference/routing-quick-reference#_routers" target="_blank">http://pedestal.io/reference/routing-quick-reference#_routers</a></z><z id="t1673397140" t="CarnunMP (I&apos;m heading to bed now, 🤞 I dream the solution...)"><y>#</y><d>2023-01-11</d><h>00:32</h><w>CarnunMP</w>(I&apos;m heading to bed now, <b>🤞</b> I dream the solution...)</z><z id="t1673471450" t="CarnunMP Huh! It seems things work just fine when I prefix both routes, e.g. with /blog/ and /api/ like so: (def routes (route/expand-routes #{[&quot;/&quot; :get [interceptors/redirect-home]] [&quot;/blog/:page-uid/:slug&quot; :get [interceptors/get-pages]] [&quot;/api/email-sub&quot; :put [interceptors/upsert-sub]]})) But why? :thinking_face:"><y>#</y><d>2023-01-11</d><h>21:10</h><w>CarnunMP</w>Huh! It seems things work just fine when I prefix both routes, e.g. with <code>/blog/</code> and <code>/api/</code> like so:
<pre>(def routes
  (route/expand-routes
    #{[&quot;/&quot; :get [interceptors/redirect-home]]
      [&quot;/blog/:page-uid/:slug&quot; :get [interceptors/get-pages]]
      [&quot;/api/email-sub&quot; :put [interceptors/upsert-sub]]}))</pre>
But why? <b>:thinking_face:</b></z><z id="t1674243113" t="hkrish I am using Pedestal and try to call AWS Cognito idp API with cognitect aws library. Created a User Pool at Cognito, and created new IAM user. I have set up the credential &amp; config files at .aws directory. The AWS CLI call works just fine, and showing the User Pool Information as below: $$&gt; aws cognito-idp list-user-pools --region us-west-1 --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-west-1_uVhjybJkfk&quot;, &quot;Name&quot;: &quot;XXXXXX&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot; } ] } But the from the REPL using Cognitect API: (aws/invoke cognito-idp {:op :SignUp :request {:ClientId &quot;XXXXXXXX&quot; :Username &quot;&lt;mailto:- /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt;&quot; :Password &quot;Password&quot; :SecretHash (calculate-secret-hash {:client-id &quot;-------&quot; :client-secret &quot;--------&quot; :username &quot;&lt;mailto: /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt;&quot;})}}) =&gt; {: type &quot;ResourceNotFoundException&quot;, :message &quot;User pool client XXXXXXX does not exist.&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} Any hints? Thanks in advance."><y>#</y><d>2023-01-20</d><h>19:31</h><w>hkrish</w>I am using Pedestal and try to call AWS Cognito idp API with cognitect aws library.  Created a User Pool at Cognito, and created new IAM user.  I have set up the credential &amp; config files at .aws directory.  The AWS CLI call works just fine, and showing the User Pool Information as below:

$$&gt; aws  cognito-idp list-user-pools --region us-west-1 --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-west-1_uVhjybJkfk&quot;,
            &quot;Name&quot;: &quot;XXXXXX&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;
        }
    ]
}

But the from the REPL using Cognitect API:

(aws/invoke cognito-idp
              {:op :SignUp
               :request
               {:ClientId  &quot;XXXXXXXX&quot;
                :Username &quot;&lt;mailto:-<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;&quot;
                :Password &quot;Password&quot;
                :SecretHash (calculate-secret-hash
                              {:client-id &quot;-------&quot;
                               :client-secret &quot;--------&quot;
                               :username &quot;&lt;mailto:<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;&quot;})}})
=&gt;
{:type &quot;ResourceNotFoundException&quot;,
 :message &quot;User pool client XXXXXXX does not exist.&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}

Any hints?  Thanks in advance.</z><z id="t1674261667" t="pavlosmelissinos Are you sure the code version connects to us-west-1? How do you create cognito-idp in the REPL?"><y>#</y><d>2023-01-21</d><h>00:41</h><r>pavlosmelissinos</r>Are you sure the code version connects to us-west-1? How do you create cognito-idp in the REPL?</z><z id="t1674261696" t="pavlosmelissinos This question doesn&apos;t seem to be pedestal-related btw"><y>#</y><d>2023-01-21</d><h>00:41</h><r>pavlosmelissinos</r>This question doesn&apos;t seem to be pedestal-related btw</z><z id="t1674261117" t="hkrish I think I got it solved. I am not sure this is the cause. But I found it very interesting. 1. Created a user pool on us-west-1. Run the command: % aws cognito-idp list-user-pools --region us-west-1 --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-west-1_mUijhrybU&quot;, &quot;Name&quot;: &quot;--&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot; } ] } 2. Run the command again with no region parameter: % aws cognito-idp list-user-pools --max-results 10 { &quot;UserPools&quot;: [] } 3. Created a user pool on us-east-1. Run the command: % aws cognito-idp list-user-pools --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-east-1_7nUtrepfj&quot;, &quot;Name&quot;: &quot;----&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot; } ] } Interesting. So when I call the cognito-idp Signup API from cognitect aws api, I got this response on the REPL: {:UserConfirmed false, :CodeDeliveryDetails {:Destination &quot;h* @g* &quot;, :DeliveryMedium &quot;EMAIL&quot;, :AttributeName &quot;email&quot;}, :UserSub &quot;53bc5c-------------------24----d52&quot;} Problem solved by creating the USER POOL in the US-EAST-1 region!! (A bug in the AWS CLI?)"><y>#</y><d>2023-01-21</d><h>00:31</h><w>hkrish</w>I think I got it solved.  I am not sure this is the cause.  But I found it very interesting.

1. Created a user pool on us-west-1.  Run the command:
% aws  cognito-idp list-user-pools --region us-west-1 --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-west-1_mUijhrybU&quot;,
            &quot;Name&quot;: &quot;--&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;
        }
    ]
}
2. Run the command again with no region parameter:
 % aws  cognito-idp list-user-pools  --max-results 10
{
    &quot;UserPools&quot;: []
}
3. Created a user pool on us-east-1.  Run the command:
% aws  cognito-idp list-user-pools  --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-east-1_7nUtrepfj&quot;,
            &quot;Name&quot;: &quot;----&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;
        }
    ]
}

Interesting.  So when I call the cognito-idp Signup API from cognitect aws api, I got this response on the REPL:
{:UserConfirmed false,
 :CodeDeliveryDetails {:Destination &quot;h*@g*&quot;, :DeliveryMedium &quot;EMAIL&quot;, :AttributeName &quot;email&quot;},
 :UserSub &quot;53bc5c-------------------24----d52&quot;}

Problem solved by creating the USER POOL in the US-EAST-1 region!!  (A bug in the AWS CLI?)</z><z id="t1674419148" t="Chris Lester I have a newbie pedestal question around sessions. I am bringing a new service up and followed the service example using the middlewares/session (using cookies for brevity .. will move this to a cache/db later). (let [key (random/bytes 16) _ (log/info :service-init {:session-key (.toString key)}) session-interceptor (middlewares/session {:store (cookie/cookie-store {:key key})}) common-interceptors [(body-params/body-params) http/html-body http/json-body] routes #{;; public apis [&quot;/login&quot; :get [auth-login] :route-name :login] ;; authenticated APIs: ;; [&quot;/login-user&quot; :get [auth-login-user util/html-render session-interceptor welcome-interceptor] :route-name :login-user] [&quot;/logout/&quot; :get [auth-validate auth-logout] :route-name :logout]} The auth-login-user is an interceptor that looks like this: (interceptor/interceptor {:name ::code-exchange :enter (fn [{:keys [request session interceptors query-params path-params route] :as ctx}] ;; code exchange -&gt; verify response -&gt; verify token --&gt; authenticated ;; (let [response (perform-code-exchange {:request request :code-path code-path :grant-type token-exchange :m2m-config m2m :jwk-endpoint jwk-endpoint :token-endpoint token-endpoint :redirect-uri redirect-uri :required? required?}) auth-token (-&gt; response :body (json/decode keyword) :access_token)] (-&gt; ctx (assoc-in [:response :session] (get-in [:request :session] ctx)) (assoc-in [:response :session :auth-token] auth-token))))}) The session doesn&apos;t exist in the ctx, but following the docs on middlewares/session to copy it over if it does. Testing the login-user redirect I see a default cookie, but not one with the key provided. I also don&apos;t see any :session-key in the context map .. and associating a [:response :session] to the response map does not seem to add one. In fact, I&apos;m not sure I understand how to get any modifications of the response map (for example, added something to the [:response :request :header] map) to show up on the client side. Is there some obvious thing I&apos;m missing, or a more complete example that I can use?"><y>#</y><d>2023-01-22</d><h>20:25</h><w>Chris Lester</w>I have a newbie pedestal question around sessions. I am bringing a new service up and followed the service example using the middlewares/session (using cookies for brevity  .. will move this to a cache/db later).

<pre>(let [key (random/bytes 16)
        _ (log/info :service-init {:session-key (.toString key)})
        session-interceptor (middlewares/session {:store (cookie/cookie-store {:key key})}) 
        common-interceptors [(body-params/body-params) http/html-body http/json-body]
        routes #{;; public apis
                 [&quot;/login&quot; :get [auth-login] :route-name :login]

                 ;; authenticated APIs:
                 ;;
                 [&quot;/login-user&quot; :get [auth-login-user util/html-render session-interceptor welcome-interceptor] :route-name :login-user]
                 [&quot;/logout/&quot; :get [auth-validate auth-logout] :route-name :logout]}</pre>
The auth-login-user is an interceptor that looks like this:

<pre>(interceptor/interceptor
                                {:name ::code-exchange
                                 :enter (fn [{:keys [request session interceptors query-params path-params route] :as ctx}]
                                          ;; code exchange -&gt; verify response -&gt; verify token --&gt; authenticated
                                          ;;
                                          (let [response (perform-code-exchange {:request request
                                                                                :code-path code-path
                                                                                :grant-type token-exchange
                                                                                :m2m-config m2m
                                                                                :jwk-endpoint jwk-endpoint
                                                                                :token-endpoint token-endpoint
                                                                                :redirect-uri redirect-uri
                                                                                :required? required?})
                                                auth-token (-&gt; response :body (json/decode keyword) :access_token)]
                                            (-&gt; ctx
                                                (assoc-in [:response :session] (get-in [:request :session] ctx))
                                                (assoc-in [:response :session :auth-token] auth-token))))})</pre>
The session doesn&apos;t exist in the ctx, but following the docs on middlewares/session to copy it over if it does.

Testing the login-user redirect I see a default cookie, but not one with the key provided. I also don&apos;t see any :session-key in the context map .. and associating a [:response :session] to the response map does not seem to add one. In fact, I&apos;m not sure I understand how to get any modifications of the response map (for example, added something to the [:response :request :header] map) to show up on the client side. Is there some obvious thing I&apos;m missing, or a more complete example that I can use?</z><z id="t1674424271" t="Chris Lester Found the problem in my html-render interceptor. I should change the namespace name to avoid thinking it&apos;s ring util when I&apos;m tired I think. It was overwriting the response with the result from the html render."><y>#</y><d>2023-01-22</d><h>21:51</h><r>Chris Lester</r>Found the problem in my html-render interceptor. I should change the namespace name to avoid thinking it&apos;s ring util when I&apos;m tired I think. It was overwriting the response with the result from the html render.</z></g><g id="s23"><z id="t1675851933" t="Jacob Molin Hi! I&apos;m trying to host a swagger-ui on a pedestal route which depends on manually written documentation, i.e. a swagger.json file. I&apos;ve looked at https://github.com/frankiesardo/route-swagger/blob/8ebab45d03cb43fdec323b955f5ae4c152814d39/src/route_swagger/interceptor.clj and I&apos;ve gotten it to work by autogenerating the swagger.json file as described in route-swagger. However, I haven&apos;t figured out how I can make it depend on a manually written swagger.json file that I&apos;ve hosted myself on a different endpoint (I&apos;ve solved the hosting of a manually written swagger.json). I&apos;ve also looked at using the https://github.com/metosin/ring-swagger-ui directly to wrap the swagger-ui middleware in a Pedestal interceptor, but haven&apos;t succeded. This would be my preferred method, if possible. Anyone got any suggestions? And please let me know if something&apos;s unclear or there&apos;s an even better way! Here&apos;s an example of what I would like to achieve in building the Pedestal routes table: (ns nice.nm (:require [cheshire.core :as json] [ring.swagger.swagger-ui :refer :all] [ring.swagger.swagger-ui/swagger-ui])) (def swagger-json {:name ::swagger-json-interceptor :enter (fn [context] (assoc context :response {:status 200 :headers {&quot;Content-Type&quot; &quot;application/json; charset=utf-8&quot;} :body (cheshire.core/parse-string (slurp &quot;&lt;path-to-dir&gt;/swagger.json&quot;))}))}) (def swagger-ui {:name ::swagger-ui-interceptor :enter (fn [context] (ring.swagger.swagger-ui/swagger-ui {:path &quot;/test&quot; :swagger-docs &quot;/applications/api/v1/swagger-json-static&quot;}))}) (defn routes [] #{[&quot;/endpoint1&quot; :post [interceptor1 endpoint1-handler] :route-name :endpoint1] [&quot;/endpoint2&quot; :get [endpoint2] :route-name :endpoint2] [&quot;/manually-written-swagger.json&quot; :get [swagger-json] :route-name :swagger-json] [&quot;/swagger-ui&quot; :get [swagger-ui] :route-name :swagger-ui]})"><y>#</y><d>2023-02-08</d><h>10:25</h><w>Jacob Molin</w>Hi! I&apos;m trying to host a swagger-ui on a pedestal route which depends on manually written documentation, i.e. a swagger.json file. I&apos;ve looked at <a href="https://github.com/frankiesardo/route-swagger/blob/8ebab45d03cb43fdec323b955f5ae4c152814d39/src/route_swagger/interceptor.clj" target="_blank">https://github.com/frankiesardo/route-swagger/blob/8ebab45d03cb43fdec323b955f5ae4c152814d39/src/route_swagger/interceptor.clj</a> and I&apos;ve gotten it to work by autogenerating the swagger.json file as described in route-swagger. However, I haven&apos;t figured out how I can make it depend on a manually written swagger.json file that I&apos;ve hosted myself on a different endpoint (I&apos;ve solved the hosting of a manually written swagger.json). I&apos;ve also looked at using the <a href="https://github.com/metosin/ring-swagger-ui" target="_blank">https://github.com/metosin/ring-swagger-ui</a> directly to wrap the swagger-ui middleware in a Pedestal interceptor, but haven&apos;t succeded. This would be my preferred method, if possible. Anyone got any suggestions? And please let me know if something&apos;s unclear or there&apos;s an even better way!

Here&apos;s an example of what I would like to achieve in building the Pedestal routes table:
<pre>(ns nice.nm
  (:require [cheshire.core :as json]
            [ring.swagger.swagger-ui :refer :all]
            [ring.swagger.swagger-ui/swagger-ui]))

(def swagger-json
  {:name ::swagger-json-interceptor
   :enter (fn [context]
            (assoc context :response {:status  200
                                      :headers {&quot;Content-Type&quot; &quot;application/json; charset=utf-8&quot;}
                                      :body (cheshire.core/parse-string (slurp &quot;&lt;path-to-dir&gt;/swagger.json&quot;))}))})

(def swagger-ui
  {:name ::swagger-ui-interceptor
   :enter (fn [context]
            (ring.swagger.swagger-ui/swagger-ui {:path &quot;/test&quot;
                                                 :swagger-docs &quot;/applications/api/v1/swagger-json-static&quot;}))})

(defn routes
  []
  #{[&quot;/endpoint1&quot;
     :post [interceptor1
            endpoint1-handler]
     :route-name :endpoint1]
    [&quot;/endpoint2&quot;
     :get [endpoint2]
     :route-name :endpoint2] 
    [&quot;/manually-written-swagger.json&quot;
       :get [swagger-json]
       :route-name :swagger-json]
    [&quot;/swagger-ui&quot;
       :get [swagger-ui]
       :route-name :swagger-ui]})</pre></z><z id="t1677334718" t="popeye [:attrs {:href &quot;/_/_/users/U04GATKRD35&quot;}] , even I am trying to do it now, one thing is swagger-json is not creating an interceptor, it supposed to bound between (interceptor/interceptor right ?"><y>#</y><d>2023-02-25</d><h>14:18</h><r>popeye</r><a>@U04GATKRD35</a>, even I am trying to do it now, one thing is <code>swagger-json</code> is not creating an interceptor, it supposed to bound between <code>(interceptor/interceptor</code> right ?</z><z id="t1677334748" t="popeye may be I am wrong! I am trying it first time"><y>#</y><d>2023-02-25</d><h>14:19</h><r>popeye</r>may be I am wrong! I am trying it first time</z><z id="t1678105899" t="Jacob Molin You&apos;re right!"><y>#</y><d>2023-03-06</d><h>12:31</h><r>Jacob Molin</r>You&apos;re right!</z><z id="t1678105905" t="Jacob Molin In the end I actually just used the Swagger-UI as a static resource by placing the content of the Swagger-UI /dist folder in the &quot;resources/public&quot; directory in my project, as explained in the https://github.com/swagger-api/swagger-ui#general (last line in General section: &quot;If you are looking for plain ol&apos; HTML/JS/CSS, https://github.com/swagger-api/swagger-ui/releases/latest and copy the contents of the /dist folder to your server.&quot;). You can read about static routes in Pedestal http://pedestal.io/cookbook/index#_how_to_serve_static_resources ."><y>#</y><d>2023-03-06</d><h>12:31</h><r>Jacob Molin</r>In the end I actually just used the Swagger-UI as a static resource by placing the content of the Swagger-UI <code>/dist</code> folder in the &quot;resources/public&quot; directory in my project, as explained in the <a href="https://github.com/swagger-api/swagger-ui#general" target="_blank">https://github.com/swagger-api/swagger-ui#general</a> (last line in General section: &quot;If you are looking for plain ol&apos; HTML/JS/CSS, <a href="https://github.com/swagger-api/swagger-ui/releases/latest" target="_blank">https://github.com/swagger-api/swagger-ui/releases/latest</a> and copy the contents of the <code>/dist</code> folder to your server.&quot;). You can read about static routes in Pedestal <a href="http://pedestal.io/cookbook/index#_how_to_serve_static_resources" target="_blank">http://pedestal.io/cookbook/index#_how_to_serve_static_resources</a>.</z><z id="t1678106070" t="Jacob Molin Then I just changed the config of Swagger-UI in https://github.com/swagger-api/swagger-ui/blob/master/dist/swagger-initializer.js#L5 . Info on the config can be found https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/ ."><y>#</y><d>2023-03-06</d><h>12:34</h><r>Jacob Molin</r>Then I just changed the config of Swagger-UI in <a href="https://github.com/swagger-api/swagger-ui/blob/master/dist/swagger-initializer.js#L5" target="_blank">https://github.com/swagger-api/swagger-ui/blob/master/dist/swagger-initializer.js#L5</a>. Info on the config can be found <a href="https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/" target="_blank">https://swagger.io/docs/open-source-tools/swagger-ui/usage/configuration/</a>.</z><z id="t1699373333" t="h0bbit Thanks for the instructions [:attrs {:href &quot;/_/_/users/U04GATKRD35&quot;}] , I went down this route as well. Adding one more change I needed to make to get everything working: I added ::http/secure-headers {:content-security-policy-settings &quot;object-src &apos;none&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; https: http:;&quot;} to the service map, because the browser refused to load &lt;script src=&quot;./swagger-ui-bundle.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt; &lt;script src=&quot;./swagger-ui-standalone-preset.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt; &lt;script src=&quot;./swagger-initializer.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt; in /dist/index.html due to the default Content Security Policy. What I’ve changed in content-security-policy-settings is adding &apos;self&apos; in script-src . Everything else is the default."><y>#</y><d>2023-11-07</d><h>16:08</h><r>h0bbit</r>Thanks for the instructions <a>@U04GATKRD35</a>, I went down this route as well. Adding one more change I needed to make to get everything working:

I added
<pre>::http/secure-headers
{:content-security-policy-settings &quot;object-src &apos;none&apos;; script-src &apos;self&apos; &apos;unsafe-inline&apos; &apos;unsafe-eval&apos; https: http:;&quot;}</pre>
to the service map, because the browser refused to load
<pre>&lt;script src=&quot;./swagger-ui-bundle.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt;
    &lt;script src=&quot;./swagger-ui-standalone-preset.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt;
    &lt;script src=&quot;./swagger-initializer.js&quot; charset=&quot;UTF-8&quot;&gt; &lt;/script&gt;</pre>
in <code>/dist/index.html</code> due to the default Content Security Policy.

What I’ve changed in <code>content-security-policy-settings</code> is adding <code>&apos;self&apos;</code> in <code>script-src</code>. Everything else is the default.</z><z id="t1699871407" t="Jacob Molin Great to hear [:attrs {:href &quot;/_/_/users/U051S5XR3&quot;}] !"><y>#</y><d>2023-11-13</d><h>10:30</h><r>Jacob Molin</r>Great to hear <a>@U051S5XR3</a>!</z><z id="t1678141985" t="lread As a pedestal novice, I wonder, is it more idiomatic for a pedestal app to use exceptions to trigger error responses? From http://pedestal.io/reference/error-handling , I&apos;m guessing yes but am not entirely sure, hence my question."><y>#</y><d>2023-03-06</d><h>22:33</h><w>lread</w>As a pedestal novice, I wonder, is it more idiomatic for a pedestal app to use exceptions to trigger error responses? From <a href="http://pedestal.io/reference/error-handling" target="_blank">http://pedestal.io/reference/error-handling</a>, I&apos;m guessing yes but am not entirely sure, hence my question.</z><z id="t1678148434" t="hlship No, don&apos;t do that. Create an error response map and attach that the the context in a handler or interceptor."><y>#</y><d>2023-03-07</d><h>00:20</h><w>hlship</w>No, don&apos;t do that.  Create an error response map and attach that the the context in a handler or interceptor.</z><z id="t1678148459" t="hlship In no language do you want to use exceptions as a flow of control method."><y>#</y><d>2023-03-07</d><h>00:20</h><w>hlship</w>In no language do you want to use exceptions as a flow of control method.</z><z id="t1678148584" t="hlship http://pedestal.io/reference/response-map"><y>#</y><d>2023-03-07</d><h>00:23</h><w>hlship</w><a href="http://pedestal.io/reference/response-map" target="_blank">http://pedestal.io/reference/response-map</a></z><z id="t1678148647" t="hlship http://pedestal.io/reference/context-map#_as_applied_to_http But the docs could be clearer about this &quot;attach a :response&quot; behavior. It&apos;s kind of implied and scattered, and needs to be brought into better focus."><y>#</y><d>2023-03-07</d><h>00:24</h><w>hlship</w><a href="http://pedestal.io/reference/context-map#_as_applied_to_http" target="_blank">http://pedestal.io/reference/context-map#_as_applied_to_http</a>

But the docs could be clearer about this &quot;attach a :response&quot; behavior. It&apos;s kind of implied and scattered, and needs to be brought into better focus.</z><z id="t1678161332" t="lread Thanks for the reply [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , much appreciated. That suits me, I like to use exceptions for unexpected events. Ya, agreed, the pedestal docs could be viewed as somewhat misleading here. Maybe an example app somewhere could serve as guidance for error flow handling? Do you know of any?"><y>#</y><d>2023-03-07</d><h>03:55</h><w>lread</w>Thanks for the reply <a>@hlship</a>, much appreciated.
That suits me, I like to use exceptions for unexpected events.
Ya, agreed, the pedestal docs could be viewed as somewhat misleading here.
Maybe an example app somewhere could serve as guidance for error flow handling?
Do you know of any?</z><z id="t1678193420" t="dvingo Yes I think it&apos;s a very elegant approach to throw exceptions and use one :error handler to return the appropriate response. This is idiomatic pedestal code as the example on that documentation page shows. Advice to not throw exceptions for control flow is dogmatic. There are very wise opinions, with arguments to back them up, stating the exact opposite, I found this exegesis enlightening https://grishaev.me/en/clj-book-exceptions/#when-to-throw-exceptions"><y>#</y><d>2023-03-07</d><h>12:50</h><w>dvingo</w>Yes I think it&apos;s a very elegant approach to throw exceptions and use one <code>:error</code> handler to return the appropriate response. This is idiomatic pedestal code as the example on that documentation page shows.
Advice to not throw exceptions for control flow is dogmatic. There are very wise opinions, with arguments to back them up, stating the exact opposite, I found this exegesis enlightening <a href="https://grishaev.me/en/clj-book-exceptions/#when-to-throw-exceptions" target="_blank">https://grishaev.me/en/clj-book-exceptions/#when-to-throw-exceptions</a></z><z id="t1678193722" t="lread Interesting, thanks for a differing perspective [:attrs {:href &quot;/_/_/users/U051V5LLP&quot;}] ."><y>#</y><d>2023-03-07</d><h>12:55</h><w>lread</w>Interesting, thanks for a differing perspective <a>@danvingo</a>.</z><z id="t1678193878" t="lread My interest is to conform to what pedestal was designed to support. But maybe pedestal itself does not have a strong opinion on error flow."><y>#</y><d>2023-03-07</d><h>12:57</h><w>lread</w>My interest is to conform to what pedestal was designed to support.  But maybe pedestal itself does not have a strong opinion on error flow.</z><z id="t1678194185" t="pavlosmelissinos For what it&apos;s worth I use exceptions + cognitect-labs/anomalies a lot with pedestal, especially for input validation, to give the correct context to the user in case of an error. I think it&apos;s a nice way to separate concerns. The code that knows about the error throws an ex-info with the context map (:category of anomaly and extra info) and the code that&apos;s responsible for sending back a response to the client reads the ex-data of the exception and decides the type of response based on the category of the anomaly."><y>#</y><d>2023-03-07</d><h>13:03</h><w>pavlosmelissinos</w>For what it&apos;s worth I use exceptions + cognitect-labs/anomalies a lot with pedestal, especially for input validation, to give the correct context to the user in case of an error.

I think it&apos;s a nice way to separate concerns. The code that knows about the error throws an ex-info with the context map (:category of anomaly and extra info) and the code that&apos;s responsible for sending back a response to the client reads the ex-data of the exception and decides the type of response based on the category of the anomaly.</z><z id="t1678194688" t="lread Thanks [:attrs {:href &quot;/_/_/users/UEQPKG7HQ&quot;}] , I&apos;ve been meaning to look into cognitect anomalies.... now that is one https://github.com/cognitect-labs/anomalies/blob/master/src/cognitect/anomalies.cljc library!"><y>#</y><d>2023-03-07</d><h>13:11</h><w>lread</w>Thanks <a>@pavlos</a>, I&apos;ve been meaning to look into cognitect anomalies.... now that is one <a href="https://github.com/cognitect-labs/anomalies/blob/master/src/cognitect/anomalies.cljc" target="_blank">https://github.com/cognitect-labs/anomalies/blob/master/src/cognitect/anomalies.cljc</a> library!</z><z id="t1678218218" t="lread [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] I&apos;m exploring: &gt; Create an error response map and attach that the the context in a handler or interceptor. That&apos;s cool. The docs imply that the interceptor :error is called only on a thrown exception, but it is also called when an interceptor sets :io.pedestal.interceptor.chain/error in the context . Also, to me anyway, the docs imply that the value for :io.pedestal.interceptor.chain/error should be an Exception , but you are suggesting it could be a simple map."><y>#</y><d>2023-03-07</d><h>19:43</h><w>lread</w><a>@hlship</a> I&apos;m exploring:
&gt; Create an error response map and attach that the the context in a handler or interceptor.
That&apos;s cool. The docs imply that the interceptor <code>:error</code> is called only on a thrown exception, but it is also called when an interceptor sets <code>:io.pedestal.interceptor.chain/error</code> in the <code>context</code>.
Also, to me anyway, the docs imply that the value for <code>:io.pedestal.interceptor.chain/error</code> should be an <code>Exception</code>, but you are suggesting it could be a simple map.</z><z id="t1678219448" t="hlship No I&apos;m not. :io.pedestal.interceptor.chain/error is for thrown exceptions, :response is for a response map. I don&apos;t think that user code should ever set the :: error key, but user code should absolutely set the :response key."><y>#</y><d>2023-03-07</d><h>20:04</h><w>hlship</w>No I&apos;m not.  :io.pedestal.interceptor.chain/error is for thrown exceptions, :response is for a response map.  I don&apos;t think that user code should ever set the <b>::</b>error key, but user code should absolutely set the :response key.</z><z id="t1678219615" t="hlship As soon as any interceptor sets the :response key, or after a handler returns a response map (which is the same thing from Pedestal&apos;s point of view), execution switches to :leave mode, resulting in the response map turning into an HTTP response."><y>#</y><d>2023-03-07</d><h>20:06</h><w>hlship</w>As soon as any interceptor sets the :response key, or after a handler returns a response map (which is the same thing from Pedestal&apos;s point of view), execution switches to :leave mode, resulting in the response map turning into an HTTP response.</z><z id="t1678220694" t="lread Ah, ok. Thanks. A sample app with error flow handling (exceptional and non-exceptional) would be awesome."><y>#</y><d>2023-03-07</d><h>20:24</h><w>lread</w>Ah, ok. Thanks. A sample app with error flow handling (exceptional and non-exceptional) would be awesome.</z><z id="t1678221007" t="lread If I ever get to a point where I fully understand a sensible strategy, I would be happy to share that understanding as updates to pedestal docs."><y>#</y><d>2023-03-07</d><h>20:30</h><w>lread</w>If I ever get to a point where I fully understand a sensible strategy, I would be happy to share that understanding as updates to pedestal docs.</z><z id="t1678372270" t="simongray https://clojurians.slack.com/archives/C06MAR553/p1678372244017299"><y>#</y><d>2023-03-09</d><h>14:31</h><w>simongray</w><a href="https://clojurians.slack.com/archives/C06MAR553/p1678372244017299" target="_blank">https://clojurians.slack.com/archives/C06MAR553/p1678372244017299</a></z><z id="t1680504287" t="Chris Lester I am trying to get SSE events working for the first time, and am encountering an error around content types I could use help with: No matching content-type available {:supported-content-types #{application/json application/transit+msgpack application/transit+json application/edn}, :available-content-types (multipart/form-data), :header Accept} I&apos;m unsure how to inform Pedestal this is a text/event-stream or get it to be &quot;happy&quot; .. but setting the content type in a header doesn&apos;t seem to work. I.e., returning this from the (sse/start-event-stream ..) stream-ready fn. {:body (stream-events response event-chan) ;; fixed one bug where those were reversed, did not help. :headers {&quot;Content-Type&quot; &quot;text/event-stream&quot;}} Stream-events is simple, takes a source chan and feeds it to the target chan: (defn stream-events [source sink] (async/go (loop [] (let [event (async/&lt;! source)] (when (not= :done event) (async/&gt;! sink event) (recur))))))"><y>#</y><d>2023-04-03</d><h>06:44</h><w>Chris Lester</w>I am trying to get SSE events working for the first time, and am encountering an error around content types I could use help with:
<pre>No matching content-type available {:supported-content-types #{application/json application/transit+msgpack application/transit+json application/edn}, :available-content-types (multipart/form-data), :header Accept}</pre>
I&apos;m unsure how to inform Pedestal this is a text/event-stream or get it to be &quot;happy&quot; .. but setting the content type in a header doesn&apos;t seem to work. I.e., returning this from the (sse/start-event-stream ..) stream-ready fn.

<pre>{:body (stream-events response event-chan) ;; fixed one bug where those were reversed, did not help.
        :headers {&quot;Content-Type&quot; &quot;text/event-stream&quot;}}</pre>
Stream-events is simple, takes a source chan and feeds it to the target chan:
<pre>(defn stream-events [source sink]
  (async/go
    (loop []
      (let [event (async/&lt;! source)]
        (when (not= :done event)
          (async/&gt;! sink event)
          (recur))))))</pre></z><z id="t1680536576" t="hlship There&apos;s no chance you are attempting to stream a nil? core.async treats nil as roughly &quot;this channel has closed&quot;."><y>#</y><d>2023-04-03</d><h>15:42</h><r>hlship</r>There&apos;s no chance you are attempting to stream a nil?  core.async treats nil as roughly &quot;this channel has closed&quot;.</z><z id="t1680545525" t="Chris Lester It&apos;s possible I suppose, although I get a response from the same code in the repl. I&apos;ll add some logging to track that possibility."><y>#</y><d>2023-04-03</d><h>18:12</h><r>Chris Lester</r>It&apos;s possible I suppose, although I get a response from the same code in the repl. I&apos;ll add some logging to track that possibility.</z><z id="t1680545559" t="Chris Lester Ofc, in the repl I&apos;m not going through pedestals full stack. I haven&apos;t spent time to figure out how to get that working yet."><y>#</y><d>2023-04-03</d><h>18:12</h><r>Chris Lester</r>Ofc, in the repl I&apos;m not going through pedestals full stack. I haven&apos;t spent time to figure out how to get that working yet.</z><z id="t1680551335" t="Chris Lester Yep, that is what&apos;s happening. Will chase that down. Thx!"><y>#</y><d>2023-04-03</d><h>19:48</h><r>Chris Lester</r>Yep, that is what&apos;s happening. Will chase that down. Thx!</z><z id="t1680849781" t="agorgl I saw a PR bumping pedestal to version 0.6.0, is this gonna land soon?"><y>#</y><d>2023-04-07</d><h>06:43</h><w>agorgl</w>I saw a PR bumping pedestal to version 0.6.0, is this gonna land soon?</z><z id="t1680885901" t="hlship Yes, very close. I had some Lacinia things to straighten out first."><y>#</y><d>2023-04-07</d><h>16:45</h><w>hlship</w>Yes, very close. I had some Lacinia things to straighten out first.</z><z id="t1680885936" t="hlship Only so much open source time in the week. How does borkdude manage all?"><y>#</y><d>2023-04-07</d><h>16:45</h><w>hlship</w>Only so much open source time in the week.  How does borkdude manage all?</z><z id="t1680886262" t="danieroux I submitted a patch to one of his plethora of things, turned away from the keyboard, turned back and it was merged with a new release. That guy. Sheesh."><y>#</y><d>2023-04-07</d><h>16:51</h><r>danieroux</r>I submitted a patch to one of his plethora of things, turned away from the keyboard, turned back and it was merged with a new release.

That guy. Sheesh.</z><z id="t1680888055" t="Joe R. Smith “Borkdude” is actually a team of developers. Kind of like the Borg. "><y>#</y><d>2023-04-07</d><h>17:20</h><r>Joe R. Smith</r>“Borkdude” is actually a team of developers. Kind of like the Borg. </z><z id="t1681327422" t="rossputin (re-posting from the clojure channel) Hi all - I’m hoping someone can point me to an example of passing state into pedestal so it will be available in all functions associated with routes - tutorials or docs etc - thanks!"><y>#</y><d>2023-04-12</d><h>19:23</h><w>rossputin</w>(re-posting from the clojure channel) Hi all - I’m hoping someone can point me to an example of passing state into pedestal so it will be available in all functions associated with routes - tutorials or docs etc - thanks!</z><z id="t1681327567" t="rossputin For context - I’m trying to avoid having an atom and using that sprinkled around the code"><y>#</y><d>2023-04-12</d><h>19:26</h><r>rossputin</r>For context - I’m trying to avoid having an atom and using that sprinkled around the code</z><z id="t1681328773" t="Mark Wardle You can create an interceptor which could be used by one or more, or all of your routes that injects whatever you want into the context or the request, and so make it available to all subsequent interceptors. e.g. see http://pedestal.io/reference/interceptors"><y>#</y><d>2023-04-12</d><h>19:46</h><r>Mark Wardle</r>You can create an interceptor which could be used by one or more, or all of your routes that injects whatever you want into the context or the request, and so make it available to all subsequent interceptors. e.g. see <a href="http://pedestal.io/reference/interceptors" target="_blank">http://pedestal.io/reference/interceptors</a></z><z id="t1681328983" t="Mark Wardle There they have an example of attaching a database. Generally, I think most people use some form of component framework such as integrant, or component, or mount, so that you can pass in your dependencies (E.g. a database conn pool) to your server on startup, and then build your service to include an interceptor than pushes the conn into the context/request. That&apos;s what I do mostly. But here is an example from one of my projects, which takes a dependency (for this it is &apos;svc&apos;) and ensures it will be available by building an interceptor using it."><y>#</y><d>2023-04-12</d><h>19:49</h><r>Mark Wardle</r>There they have an example of attaching a database. Generally, I think most people use some form of component framework such as integrant, or component, or mount, so that you can pass in your dependencies (E.g. a database conn pool) to your server on startup, and then build your service to include an interceptor than pushes the conn into the context/request. That&apos;s what I do mostly. But here is an example from one of my projects, which takes a dependency (for this it is &apos;svc&apos;) and ensures it will be available by building an interceptor using it.</z><z id="t1681329023" t="Mark Wardle https://github.com/wardle/hermes/blob/main/cmd/com/eldrix/hermes/cmd/server.clj"><y>#</y><d>2023-04-12</d><h>19:50</h><r>Mark Wardle</r><a href="https://github.com/wardle/hermes/blob/main/cmd/com/eldrix/hermes/cmd/server.clj" target="_blank">https://github.com/wardle/hermes/blob/main/cmd/com/eldrix/hermes/cmd/server.clj</a></z><z id="t1681329172" t="rossputin Thanks very much for the help - off to read up!"><y>#</y><d>2023-04-12</d><h>19:52</h><r>rossputin</r>Thanks very much for the help - off to read up!</z><z id="t1681329609" t="Mark Wardle No problem. The trick is to realise that pedestal takes functions and maps and turns them into interceptors for you, but if you are building one yourself and adding it into your interceptor chain then you need to manually make an interceptor using ‘interceptor’. "><y>#</y><d>2023-04-12</d><h>20:00</h><r>Mark Wardle</r>No problem. The trick is to realise that pedestal takes functions and maps and turns them into interceptors for you, but if you are building one yourself and adding it into your interceptor chain then you need to manually make an interceptor using ‘interceptor’. </z><z id="t1681329933" t="Mark Wardle Also see http://pedestal.io/guides/what-is-an-interceptor"><y>#</y><d>2023-04-12</d><h>20:05</h><r>Mark Wardle</r>Also see <a href="http://pedestal.io/guides/what-is-an-interceptor" target="_blank">http://pedestal.io/guides/what-is-an-interceptor</a></z><z id="t1681366603" t="Mark Wardle I just looked through my code example and noticed some of the interceptors can sometimes return nil - that’ll result in a server error when in fact it should be a 404. They should always return something."><y>#</y><d>2023-04-13</d><h>06:16</h><r>Mark Wardle</r>I just looked through my code example and noticed some of the interceptors can sometimes return nil - that’ll result in a server error when in fact it should be a 404. They should always return something.</z><z id="t1681367182" t="rossputin thanks for the follow, definitely going to save me time"><y>#</y><d>2023-04-13</d><h>06:26</h><r>rossputin</r>thanks for the follow, definitely going to save me time</z><z id="t1682357914" t="lread FYI: Noticed https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217"><y>#</y><d>2023-04-24</d><h>17:38</h><w>lread</w>FYI: Noticed <a href="https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217" target="_blank">https://github.com/eclipse/jetty.project/releases/tag/jetty-9.4.51.v20230217</a></z><z id="t1682521069" t="lread https://github.com/cljdoc/cljdoc/blob/3a67a070f9ff4dd9f75b07a1549faf85f6ba601e/deps.edn#L12-L18 , but nice to not have to override."><y>#</y><d>2023-04-26</d><h>14:57</h><r>lread</r><a href="https://github.com/cljdoc/cljdoc/blob/3a67a070f9ff4dd9f75b07a1549faf85f6ba601e/deps.edn#L12-L18" target="_blank">https://github.com/cljdoc/cljdoc/blob/3a67a070f9ff4dd9f75b07a1549faf85f6ba601e/deps.edn#L12-L18</a>, but nice to not have to override.</z><z id="t1682521125" t="lread Happy to raise issue + PR if maintainers are interested in that kind of help."><y>#</y><d>2023-04-26</d><h>14:58</h><r>lread</r>Happy to raise issue + PR if maintainers are interested in that kind of help.</z><z id="t1682604329" t="Phillip Mates hi folks, wanted to ask if anyone is working on getting jetty10 bumped ( https://github.com/pedestal/pedestal/pull/721 )? our app keeps getting this error https://github.com/ptaoussanis/sente/issues/387 , which seems to be solved by jetty10 but we can&apos;t bump because pedestal is still on 9. If not, I&apos;ll probably take the work from https://github.com/pedestal/pedestal/pull/721 and deal with the project.clj -&gt; deps.edn merge conflicts so I can use jetty10 in our own system. But wanted to check if something is in the works, before going down that path. thanks!"><y>#</y><d>2023-04-27</d><h>14:05</h><w>Phillip Mates</w>hi folks, wanted to ask if anyone is working on getting jetty10 bumped (<a href="https://github.com/pedestal/pedestal/pull/721" target="_blank">https://github.com/pedestal/pedestal/pull/721</a>)?
our app keeps getting this error <a href="https://github.com/ptaoussanis/sente/issues/387" target="_blank">https://github.com/ptaoussanis/sente/issues/387</a>, which seems to be solved by jetty10 but we can&apos;t bump because pedestal is still on 9.

If not, I&apos;ll probably take the work from <a href="https://github.com/pedestal/pedestal/pull/721" target="_blank">https://github.com/pedestal/pedestal/pull/721</a> and deal with the project.clj -&gt; deps.edn merge conflicts so I can use jetty10 in our own system. But wanted to check if something is in the works, before going down that path.
thanks!</z><z id="t1682620182" t="hlship Getting off of Jetty9 is planned. I hope to get 0.6.0 final out soon, and our top priority after that is getting on Jetty 10 and/or 11."><y>#</y><d>2023-04-27</d><h>18:29</h><w>hlship</w>Getting off of Jetty9 is planned.  I hope to get 0.6.0 final out soon, and our top priority after that is getting on Jetty 10 and/or 11.</z><z id="t1682620203" t="hlship Still up in the air about what that would look like."><y>#</y><d>2023-04-27</d><h>18:30</h><w>hlship</w>Still up in the air about what that would look like.</z><z id="t1683041125" t="kpav I am going through the http://pedestal.io/guides/pedestal-with-component#using-pedestal-with-component doc, and theres a bit in there about not starting the server when testing, but it doesn&apos;t really explain the &quot;why&quot; -- I am curious why we would not want the server to start while unit testing?"><y>#</y><d>2023-05-02</d><h>15:25</h><w>kpav</w>I am going through the <a href="http://pedestal.io/guides/pedestal-with-component#using-pedestal-with-component" target="_blank">http://pedestal.io/guides/pedestal-with-component#using-pedestal-with-component</a> doc, and theres a bit in there about not starting the server when testing, but it doesn&apos;t really explain the &quot;why&quot; -- I am curious why we would not want the server to start while unit testing?</z><z id="t1683050453" t="hlship It&apos;s not very clear in the doc; essentially, starting up Jetty and routing requests through it is somewhat slow, and there&apos;s also the issue of the port - which can only be bound by a single thread. Pedestal includes code that uses the application stack, minus the actual HTTP processing part (Jetty), and allows you to exercise it without involving HTTP - you send data to routes, it goes through all the appropriate interceptors and handlers, and you can validate the response against expectations. This is less brittle and much faster for testing."><y>#</y><d>2023-05-02</d><h>18:00</h><w>hlship</w>It&apos;s not very clear in the doc; essentially, starting up Jetty and routing requests through it is somewhat slow, and there&apos;s also the issue of the port - which can only be bound by a single thread.  Pedestal includes code that uses the application stack, minus the actual HTTP processing part (Jetty), and allows you to exercise it without involving HTTP - you send data to routes, it goes through all the appropriate interceptors and handlers, and you can validate the response against expectations.  This is less brittle and much faster for testing.</z><z id="t1683050474" t="hlship I&apos;m having some trouble getting doc updates published, but I&apos;ll look into updating this to be more clear."><y>#</y><d>2023-05-02</d><h>18:01</h><w>hlship</w>I&apos;m having some trouble getting doc updates published, but I&apos;ll look into updating this to be more clear.</z><z id="t1683209981" t="kpav Thanks again for the insightful answer! It makes a lot of sense, and it makes me appreciate the fact that you can test routes and interceptors separately from the server, gives a lot of flexibility in testing"><y>#</y><d>2023-05-04</d><h>14:19</h><r>kpav</r>Thanks again for the insightful answer! It makes a lot of sense, and it makes me appreciate the fact that you can test routes and interceptors separately from the server, gives a lot of flexibility in testing</z><z id="t1683893954" t="Eduardo Lopes How can I suggest doc improvements? Got stuck on adding global interceptors and I have some suggestions."><y>#</y><d>2023-05-12</d><h>12:19</h><w>Eduardo Lopes</w>How can I suggest doc improvements? Got stuck on adding global interceptors and I have some suggestions.</z><z id="t1683932873" t="hlship https://github.com/pedestal/pedestal-docs/issues"><y>#</y><d>2023-05-12</d><h>23:07</h><w>hlship</w><a href="https://github.com/pedestal/pedestal-docs/issues" target="_blank">https://github.com/pedestal/pedestal-docs/issues</a></z><z id="t1684602073" t="ghaskins [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] apologies, I had missed your comment about CLA for https://github.com/pedestal/pedestal/pull/721"><y>#</y><d>2023-05-20</d><h>17:01</h><w>ghaskins</w><a>@hlship</a> apologies, I had missed your comment about CLA for <a href="https://github.com/pedestal/pedestal/pull/721" target="_blank">https://github.com/pedestal/pedestal/pull/721</a></z><z id="t1684736950" t="dangercoder Will this allow pedestal users to configure Jetty to use Virtual Threads? 🙂"><y>#</y><d>2023-05-22</d><h>06:29</h><r>dangercoder</r>Will this allow pedestal users to configure Jetty to use Virtual Threads? <b>🙂</b></z><z id="t1685024655" t="ghaskins [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] I didn’t do any work to expose additional features, just merely port from jetty 9.x to 10.x."><y>#</y><d>2023-05-25</d><h>14:24</h><r>ghaskins</r><a>@UBN9SNVB4</a> I didn’t do any work to expose additional features, just merely port from jetty 9.x to 10.x.</z><z id="t1684602077" t="ghaskins It’s fixed now"><y>#</y><d>2023-05-20</d><h>17:01</h><w>ghaskins</w>It’s fixed now</z><z id="t1684736950" t="dangercoder Will this allow pedestal users to configure Jetty to use Virtual Threads? 🙂"><y>#</y><d>2023-05-22</d><h>06:29</h><w>dangercoder</w>Will this allow pedestal users to configure Jetty to use Virtual Threads? <b>🙂</b></z><z id="t1685139962" t="Eduardo Lopes How can I achieve &quot;&quot;hot reloading&quot;&quot;, or just loading, for interceptors running in REPL? I was following this http://pedestal.io/guides/live-repl#_starting_point to achieve routes reloading, but now I am struggling on interceptors. I tried using and clojure.tools.namespace.repl but I&apos;m not understanding some things I will describe better on the thread."><y>#</y><d>2023-05-26</d><h>22:26</h><w>Eduardo Lopes</w>How can I achieve &quot;&quot;hot reloading&quot;&quot;, or just loading, for interceptors running in REPL? I was following this <a href="http://pedestal.io/guides/live-repl#_starting_point" target="_blank">http://pedestal.io/guides/live-repl#_starting_point</a> to achieve routes reloading, but now I am struggling on interceptors. I tried using <code></code> and <code>clojure.tools.namespace.repl</code> but I&apos;m not understanding some things I will describe better on the thread.</z><z id="t1685140040" t="Eduardo Lopes I first tried using clojure.tools.namespace.repl with a functions to restart my component system, using component.repl also: (defn restart-system [] (stop) (set-refresh-dirs &quot;src/&quot;) (set-init get-system) (refresh) (start)) But changing an interceptor and restarting the system did not worked. The old code keeps it there."><y>#</y><d>2023-05-26</d><h>22:27</h><r>Eduardo Lopes</r>I first tried using <code>clojure.tools.namespace.repl</code> with a functions to restart my component system, using component.repl also:

<pre>(defn restart-system []
  (stop)
  (set-refresh-dirs &quot;src/&quot;)
  (set-init get-system)
  (refresh)
  (start))</pre>
But changing an interceptor and restarting the system did not worked. The old code keeps it there.</z><z id="t1685140131" t="Eduardo Lopes I managed to work adding using dev/watch before my http server is created and started. But for this work I need to manually load interceptor files and restart the system to modifications appear."><y>#</y><d>2023-05-26</d><h>22:28</h><r>Eduardo Lopes</r>I managed to work adding <code></code> using <code>dev/watch</code> before my http server is created and started. But for this work I need to manually load interceptor files and restart the system to modifications appear.</z><z id="t1685140232" t="Eduardo Lopes Is there a better way for doing this? I don&apos;t know clojure so much to make an approach similar to interactive routing docs, but I&apos;m wondering if it&apos;s possible and is the better way to do so."><y>#</y><d>2023-05-26</d><h>22:30</h><r>Eduardo Lopes</r>Is there a better way for doing this? I don&apos;t know clojure so much to make an approach similar to interactive routing docs, but I&apos;m wondering if it&apos;s possible and is the better way to do so.</z><z id="t1685141493" t="phill Hot (or warm?) reloading is kind of orthogonal to Pedestal. Pedestal interceptors are a slightly resistant pattern because (like all well-managed run-time data) the interceptor chain is data held in closure by a long-running function, which reloading does not interrupt. A workaround is for your interceptors to delegate immediately to plain functions, which (require...:reload) redefines."><y>#</y><d>2023-05-26</d><h>22:51</h><r>phill</r>Hot (or warm?) reloading is kind of orthogonal to Pedestal.  Pedestal interceptors are a slightly resistant pattern because (like all well-managed run-time data) the interceptor chain is data held in closure by a long-running function, which reloading does not interrupt. A workaround is for your interceptors to delegate immediately to plain functions, which (require...:reload) redefines.</z><z id="t1685197036" t="souenzzo just switch from ::http/routes (my-routes) to ::http/routes (fn [] (my-routes))"><y>#</y><d>2023-05-27</d><h>14:17</h><r>souenzzo</r>just switch from  <code>::http/routes (my-routes)</code>  to <code>::http/routes (fn [] (my-routes))</code></z><z id="t1685213369" t="Eduardo Lopes [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] for routing I followed the doc ::http/routes (if (= :prod env) routes/routes #(route/expand-routes (deref (var routes/routes)))) Changing code from interceptor is the trouble"><y>#</y><d>2023-05-27</d><h>18:49</h><r>Eduardo Lopes</r><a>@U2J4FRT2T</a> for routing I followed the doc

<pre>::http/routes (if (= :prod env)
                               routes/routes
                               #(route/expand-routes (deref (var routes/routes)))) </pre>
Changing code from interceptor is the trouble</z><z id="t1685214185" t="souenzzo Where are you using the interceptors? Before or after the router? The interceptors before the router will only change after a server restart. It should not be a issue once they do not change a lot."><y>#</y><d>2023-05-27</d><h>19:03</h><r>souenzzo</r>Where are you using the interceptors? Before or after the router? The interceptors before the router will only change after a server restart. It should not be a issue once they do not change a lot.</z><z id="t1685214281" t="Eduardo Lopes (cond-&gt; {:env env ::http/routes (if (= :prod env) routes/routes #(route/expand-routes (deref (var routes/routes)))) ::http/type :jetty ::http/port 8890 ::http/join? false} true http/default-interceptors ;;true http/dev-interceptors true interceptors/apply-interceptors true http/create-server (not= env :test) http/start true ((partial assoc this :service))) Something like this, interceptors/apply-interceptors is like this: (defn conj-interceptor [service-map interceptor] (update service-map ::http/interceptors conj interceptor)) (defn apply-interceptors [service-map] (-&gt; service-map (conj-interceptor authentication-interceptor))) "><y>#</y><d>2023-05-27</d><h>19:04</h><r>Eduardo Lopes</r><pre>(cond-&gt; {:env          env
         ::http/routes (if (= :prod env)
                         routes/routes
                         #(route/expand-routes (deref (var routes/routes))))
         ::http/type   :jetty
         ::http/port   8890
         ::http/join?  false}
  true   http/default-interceptors
  ;;true   http/dev-interceptors
  true   interceptors/apply-interceptors
  true   http/create-server
  (not= env :test)   http/start
  true   ((partial assoc this :service)))</pre>
Something like this, interceptors/apply-interceptors is like this:
<pre>(defn conj-interceptor [service-map interceptor]
  (update service-map ::http/interceptors conj interceptor))

(defn apply-interceptors [service-map]
  (-&gt; service-map
      (conj-interceptor authentication-interceptor)))</pre>
</z><z id="t1685214356" t="Eduardo Lopes I think I found what may be my problem, but not sure yet. I am using helper functions and import with alias but this is a warning in https://github.com/clojure/tools.namespace#warnings-for-helper-functions ."><y>#</y><d>2023-05-27</d><h>19:05</h><r>Eduardo Lopes</r>I think I found what may be my problem, but not sure yet. I am using helper functions and import with alias but this is a warning in<a href="https://github.com/clojure/tools.namespace#warnings-for-helper-functions" target="_blank">https://github.com/clojure/tools.namespace#warnings-for-helper-functions</a>.</z><z id="t1685215060" t="Eduardo Lopes The problem is that I was setting (set-refresh-dirs &quot;src/&quot;) and when I used refresh I actually was not reloading my user namespace (under dev/user.clj). I could debug this by adding keys to my component system map and even after refresh they did not appear. I assumed that if they didn&apos;t appear is because my system map is not reloading, so my interceptors wouldn&apos;t reload either. 🙂"><y>#</y><d>2023-05-27</d><h>19:17</h><r>Eduardo Lopes</r>The problem is that I was setting <code>(set-refresh-dirs &quot;src/&quot;)</code> and when I used <code>refresh</code> I actually was not reloading my user namespace (under dev/user.clj). I could debug this by adding keys to my component system map and even after refresh they did not appear.

I assumed that if they didn&apos;t appear is because my system map is not reloading, so my interceptors wouldn&apos;t reload either. <b>🙂</b></z><z id="t1685364233" t="Eduardo Lopes [:attrs {:href &quot;/_/_/users/U0HG4EHMH&quot;}] using :reload worked exactly as expected, loading my required file &quot;hot reloads&quot; interceptor. Using it have any consequences on production builded code? Just to make sure I&apos;m not using an workaround that is actually not recommended"><y>#</y><d>2023-05-29</d><h>12:43</h><r>Eduardo Lopes</r><a>@U0HG4EHMH</a> using :reload worked exactly as expected, loading my required file &quot;hot reloads&quot; interceptor. Using it have any consequences on production builded code? Just to make sure I&apos;m not using an workaround that is actually not recommended</z><z id="t1685145951" t="hlship Good news everyone! I have http://pedestal.io/index publishing again - now using a GitHub action. This was an obstacle preventing progress towards the next Pedestal release."><y>#</y><d>2023-05-27</d><h>00:05</h><w>hlship</w>Good news everyone!   I have <a href="http://pedestal.io/index" target="_blank">http://pedestal.io/index</a> publishing again - now using a GitHub action. This was an obstacle preventing progress towards the next Pedestal release.</z><z id="t1685744164" t="hlship Just released 0.6.0-beta-2 to clojars."><y>#</y><d>2023-06-02</d><h>22:16</h><w>hlship</w>Just released 0.6.0-beta-2 to clojars.</z><z id="t1685744198" t="hlship We would appreciate if pedestal users could validate the changes in this new release of pedestal."><y>#</y><d>2023-06-02</d><h>22:16</h><w>hlship</w>We would appreciate if pedestal users could validate the changes in this new release of pedestal.</z><z id="t1685982884" t="lread Thanks, I&apos;ve bumped cljdoc, don&apos;t expect any issues, will ping you if I see any!"><y>#</y><d>2023-06-05</d><h>16:34</h><r>lread</r>Thanks, I&apos;ve bumped cljdoc, don&apos;t expect any issues, will ping you if I see any!</z><z id="t1685744314" t="hlship it&apos;s almost entirely documentation and dependency changes since 0.5.11-beta-1."><y>#</y><d>2023-06-02</d><h>22:18</h><w>hlship</w>it&apos;s almost entirely documentation and dependency changes since 0.5.11-beta-1.</z><z id="t1685744355" t="hlship I suspect if nobody has issues, we can move to a final 0.6.0 release next week. It&apos; been long enough, why rush 🤷 ?"><y>#</y><d>2023-06-02</d><h>22:19</h><w>hlship</w>I suspect if nobody has issues, we can move to a final 0.6.0 release next week.  It&apos; been long enough, why rush <b>🤷</b> ?</z><z id="t1685987628" t="hlship The main change to watch out for is related to path parameters in routing: https://github.com/pedestal/pedestal/issues/588"><y>#</y><d>2023-06-05</d><h>17:53</h><w>hlship</w>The main change to watch out for is related to path parameters in routing: <a href="https://github.com/pedestal/pedestal/issues/588" target="_blank">https://github.com/pedestal/pedestal/issues/588</a></z><z id="t1686007013" t="phill It seems to say, that if a program uses path parameters then it won&apos;t work anymore? That&apos;s a big breaking change. Is there guidance for a workaround?"><y>#</y><d>2023-06-05</d><h>23:16</h><r>phill</r>It seems to say, that if a program uses path parameters then it won&apos;t work anymore?  That&apos;s a big breaking change.  Is there guidance for a workaround?</z><z id="t1686007046" t="phill And, p.s., does it merit a major version number change?"><y>#</y><d>2023-06-05</d><h>23:17</h><r>phill</r>And, p.s., does it merit a major version number change?</z><z id="t1686007181" t="hlship It&apos;s actually the opposite; an existing program will have set up its own logic to decode path parameters, but now that (by default) happens automatically and you may decode path parameters twice, which is wasteful and occasionally will cause errors (for instance, if a % is encoded as %37 it will decode once to % then fail when decoding the second time (either erroring, or consuming two hex digits that follow it)."><y>#</y><d>2023-06-05</d><h>23:19</h><r>hlship</r>It&apos;s actually the opposite; an existing program will have set up its own logic to decode path parameters, but now that (by default) happens automatically and you may decode path parameters twice, which is wasteful and occasionally will cause errors (for instance, if a <code>%</code> is encoded as <code>%37</code> it will decode once to <code>%</code> then fail when decoding the second time (either erroring, or consuming two hex digits that follow it).</z><z id="t1686007186" t="hlship So it can be subtle."><y>#</y><d>2023-06-05</d><h>23:19</h><r>hlship</r>So it can be subtle.</z><z id="t1686007208" t="hlship The intention is that this decoding should always have happened, but it didn&apos;t and there wasn&apos;t a test so nobody realized for a while."><y>#</y><d>2023-06-05</d><h>23:20</h><r>hlship</r>The intention is that this decoding should always have happened, but it didn&apos;t and there wasn&apos;t a test so nobody realized for a while.</z><z id="t1686071632" t="lread Something is different between 0.5.11-beta-1 and 0.6.0-beta-2 in how + is handled in path portion of URL which caused an issue for cljdoc. I&apos;ll report back when I&apos;ve figured out what&apos;s up."><y>#</y><d>2023-06-06</d><h>17:13</h><w>lread</w>Something is different between <code>0.5.11-beta-1</code> and <code>0.6.0-beta-2</code> in how <code>+</code> is handled in path portion of URL which caused an issue for cljdoc. I&apos;ll report back when I&apos;ve figured out what&apos;s up.</z><z id="t1686072568" t="hlship That&apos;s another case where double HTML decoding would show up. See the notes in the https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#060---unreleased"><y>#</y><d>2023-06-06</d><h>17:29</h><w>hlship</w>That&apos;s another case where double HTML decoding would show up.  See the notes in the <a href="https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#060---unreleased" target="_blank">https://github.com/pedestal/pedestal/blob/master/CHANGELOG.md#060---unreleased</a></z><z id="t1686073064" t="lread Ah thanks, I missed that breaking change in the changelog! Should &quot;0.6.0 - UNRELEASED&quot; maybe be changed to &quot;0.6.0-beta-2 - June 2, 2023&quot;? I was actually reading latest changes from https://github.com/pedestal/pedestal/releases page and didn&apos;t even notice I wasn&apos;t reading about 0.6.0 because 0.6.0 is not listed there."><y>#</y><d>2023-06-06</d><h>17:37</h><w>lread</w>Ah thanks, I missed that breaking change in the changelog!  Should &quot;0.6.0 - UNRELEASED&quot; maybe be changed to &quot;0.6.0-beta-2 - June 2, 2023&quot;?
I was actually reading latest changes from <a href="https://github.com/pedestal/pedestal/releases" target="_blank">https://github.com/pedestal/pedestal/releases</a> page and didn&apos;t even notice I wasn&apos;t reading about 0.6.0 because 0.6.0 is not listed there.</z><z id="t1686073473" t="hlship I tend to only put a final entry in for an entire release cycle; the notes accumulate under the &quot;UNRELEASED&quot; heading until the final 0.6.0 release. I think this addresses the needs of the majority of Pedestal users, who will not upgrade until the next final release, and will want to see the changes all in one place."><y>#</y><d>2023-06-06</d><h>17:44</h><w>hlship</w>I tend to only put a final entry in for an entire release cycle; the notes accumulate under the &quot;UNRELEASED&quot; heading until the final 0.6.0 release.  I think this addresses the needs of the majority of Pedestal users, who will not upgrade until the next final release, and will want to see the changes all in one place.</z><z id="t1686075375" t="lread I personally find this confusing but totally respect how you want to sail your ship!"><y>#</y><d>2023-06-06</d><h>18:16</h><r>lread</r>I personally find this confusing but totally respect how you want to sail your ship!</z><z id="t1686083789" t="hlship Maybe I&apos;m wrong, but this is essentially how I&apos;ve operated across many different projects since maybe 2002."><y>#</y><d>2023-06-06</d><h>20:36</h><r>hlship</r>Maybe I&apos;m wrong, but this is essentially how I&apos;ve operated across many different projects since maybe 2002.</z><z id="t1686085632" t="lread There is no right or wrong. All good now that I understand it."><y>#</y><d>2023-06-06</d><h>21:07</h><r>lread</r>There is no right or wrong. All good now that I understand it.</z><z id="t1686241963" t="hlship I think we can expect a 0.6.0 on monday afternoon, unless there are some objections soon."><y>#</y><d>2023-06-08</d><h>16:32</h><w>hlship</w>I think we can expect a 0.6.0 on monday afternoon, unless there are some objections soon.</z><z id="t1686772312" t="hlship Our focus for pedestal next is on moving to a more modern version of Jetty. And it should not take 18 months."><y>#</y><d>2023-06-14</d><h>19:51</h><w>hlship</w>Our focus for pedestal next is on moving to a more modern version of Jetty.  And it should not take 18 months.</z><z id="t1686773466" t="Eugen thanks and good luck!"><y>#</y><d>2023-06-14</d><h>20:11</h><w>Eugen</w>thanks and good luck!</z><z id="t1686773496" t="Eugen jetty is progressing nicely and they are first adopters of virtual threads comming in September in JDK 21 LTS"><y>#</y><d>2023-06-14</d><h>20:11</h><w>Eugen</w>jetty is progressing nicely and they are first adopters of virtual threads comming in September in JDK 21 LTS</z><z id="t1686869738" t="hlship com.walmartlabs/lacinia-pedestal 1.2-beta-1 Exposes Lacinia GraphQL to HTTP clients using Pedestal, including subscriptions. Significant changes: • Many dependency upgrades, including Pedestal 0.6.0 • Logging related to subscriptions switched from debug to trace https://github.com/walmartlabs/lacinia-pedestal/issues?q=is%3Aclosed+milestone%3A1.2"><y>#</y><d>2023-06-15</d><h>22:55</h><w>hlship</w>com.walmartlabs/lacinia-pedestal 1.2-beta-1

Exposes Lacinia GraphQL to HTTP clients using Pedestal, including subscriptions.

Significant changes:

• Many dependency upgrades, including Pedestal 0.6.0
• Logging related to subscriptions switched from debug to trace
<a href="https://github.com/walmartlabs/lacinia-pedestal/issues?q=is%3Aclosed+milestone%3A1.2" target="_blank">https://github.com/walmartlabs/lacinia-pedestal/issues?q=is%3Aclosed+milestone%3A1.2</a></z><z id="t1686869765" t="hlship If no one sees any problems, this can be rolled to a final 1.2 release next week."><y>#</y><d>2023-06-15</d><h>22:56</h><w>hlship</w>If no one sees any problems, this can be rolled to a final 1.2 release next week.</z><z id="t1686930504" t="Zed I just updated to the lacinia-pedestal beta, my tests pass and everything seems to be working"><y>#</y><d>2023-06-16</d><h>15:48</h><w>Zed</w>I just updated to the lacinia-pedestal beta, my tests pass and everything seems to be working</z><z id="t1686932009" t="hlship lacinia-pedestal doesn&apos;t, as far as I can remember, make use of any path parameters, so upgrade path is pretty low risk."><y>#</y><d>2023-06-16</d><h>16:13</h><r>hlship</r>lacinia-pedestal doesn&apos;t, as far as I can remember, make use of any path parameters, so upgrade path is pretty low risk.</z><z id="t1687144376" t="hifumi123 I’m trying to use the CORS interceptor that comes out of the box with Pedestal, but I can’t figure out what I’m doing wrong. I am using the following service map. {::http/routes routes ::http/type :jetty ::http/port 8080 ::http/join? false ::http/allowed-origins [&quot;&quot;]} My route tree looks as follows: (def routes (route/expand-routes #{[&quot;/hello&quot; :get hello :route-name :routes/get-hello] [&quot;/hello&quot; :head hello :route-name :routes/head-hello]})) Then when try sending OPTIONS /hello , I get a 404 response from the server."><y>#</y><d>2023-06-19</d><h>03:12</h><w>hifumi123</w>I’m trying to use the CORS interceptor that comes out of the box with Pedestal, but I can’t figure out what I’m doing wrong. I am using the following service map.
<pre>{::http/routes          routes
 ::http/type            :jetty
 ::http/port            8080
 ::http/join?           false
 ::http/allowed-origins [&quot;&quot;]}</pre>
My route tree looks as follows:
<pre>(def routes
  (route/expand-routes #{[&quot;/hello&quot; :get  hello :route-name :routes/get-hello]
                         [&quot;/hello&quot; :head hello :route-name :routes/head-hello]}))</pre>
Then when try sending <code>OPTIONS /hello</code>, I get a 404 response from the server.</z><z id="t1687166498" t="souenzzo add this: ::http/allowed-origins {:allowed-origins (fn [origin] (let [allowed (contains? #{&quot;&quot;} origin)] (log/info :origin origin :allowed allowed) allowed))} Will help you to debug. maybe your allowed-origins is not working (aka no logs at all). this is because you are not using default-interceptors or something like maybe you are using the wrong origin name"><y>#</y><d>2023-06-19</d><h>09:21</h><r>souenzzo</r>add this:
<pre>::http/allowed-origins {:allowed-origins (fn [origin]
                                           (let [allowed (contains? #{&quot;&quot;} origin)]
                                             (log/info :origin origin :allowed allowed)
                                             allowed))}</pre>
Will help you to debug.

maybe your <code>allowed-origins</code> is not working (aka no logs at all). this is because you are not using default-interceptors or something like

maybe you are using the wrong <code>origin</code> name</z><z id="t1687167809" t="hifumi123 Your suggestion works, it looks like I misread the docstring or it’s become outdated"><y>#</y><d>2023-06-19</d><h>09:43</h><r>hifumi123</r>Your suggestion works, it looks like I misread the docstring or it’s become outdated</z><z id="t1687170385" t="souenzzo the array form should be supported and equivalent to this map+function."><y>#</y><d>2023-06-19</d><h>10:26</h><r>souenzzo</r>the array form should be supported and equivalent to this map+function.</z><z id="t1687170544" t="souenzzo checkout this function https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L49-L58"><y>#</y><d>2023-06-19</d><h>10:29</h><r>souenzzo</r>checkout this function <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L49-L58" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http/cors.clj#L49-L58</a></z><z id="t1687170714" t="hifumi123 Yeah, I just did some testing and it looks like everything works when I use [&quot;localhost&quot;] instead of my original example"><y>#</y><d>2023-06-19</d><h>10:31</h><r>hifumi123</r>Yeah, I just did some testing and it looks like everything works when I use <code>[&quot;localhost&quot;]</code> instead of my original example</z><z id="t1687170717" t="hifumi123 Thanks for the guidance"><y>#</y><d>2023-06-19</d><h>10:31</h><r>hifumi123</r>Thanks for the guidance</z><z id="t1687816716" t="hlship Leading into Pedestal 0.7.x, a big focus will be to bring Jetty to version 10 or 11 and to add features to make it easier to enable web sockets and listening on multiple hosts and ports; this should be easy enough for Jetty and maybe Tomcat, but Immutant hasn&apos;t been updated in 6 years and does not appear to be widely used. In the interests of keeping our work load approachable, I&apos;d like to float the idea of removing the pedestal.immutant library so that we can focus of Jetty and Tomcat. I&apos;ve always been a fan of only shipping code that has been tested in a running application. As much as I love tests and testing, there&apos;s no substitute for hands on &quot;using it in anger&quot;. That&apos;s never been a problem for Tapestry (in the distant past), Pretty, Lacinia, and pedestal.jetty. Unfortunately, I have never used the pedestal.tomcat library - all my previous experience as a Pedestal user focused on Jetty. Are there people in the Pedestal community using Tomcat, and if so, are there any volunteers to help us validate that Pedestal 0.7.0, which may also switch to a more recent version of Tomcat, is fully operational in Tomcat?"><y>#</y><d>2023-06-26</d><h>21:58</h><w>hlship</w>Leading into Pedestal 0.7.x, a big focus will be to bring Jetty to version 10 or 11 and to add features to make it easier to enable web sockets and listening on multiple hosts and ports; this should be easy enough for Jetty and maybe Tomcat, but Immutant hasn&apos;t been updated in 6 years and does not appear to be widely used.  In the interests of keeping our work load approachable, I&apos;d like to float the idea of removing the pedestal.immutant library so that we can focus of Jetty and Tomcat.

I&apos;ve always been a fan of only shipping code that has been tested in a running application. As much as I love tests and testing, there&apos;s no substitute for hands on &quot;using it in anger&quot;.  That&apos;s never been a problem for Tapestry (in the distant past), Pretty, Lacinia, and pedestal.jetty.

Unfortunately, I have never used the pedestal.tomcat library - all my previous experience as a Pedestal user focused on Jetty.  Are there people in the Pedestal community using Tomcat, and if so, are there any volunteers to help us validate that Pedestal 0.7.0, which may also switch to a more recent version of Tomcat, is fully operational in Tomcat?</z><z id="t1687861483" t="Eugen I would like to point out that Jetty 10 and 11 are different things. Jetty 11 uses the new jakarta.servlet namespage for Java EE (Servlet API). Jetty 10 uses the old javax.servlet api for apps that have not been migrated yet (the majority I would imagine)"><y>#</y><d>2023-06-27</d><h>10:24</h><r>Eugen</r>I would like to point out that Jetty 10 and 11 are different things.
Jetty 11 uses the new <code>jakarta.servlet</code> namespage for Java EE (Servlet API).
Jetty 10 uses the old <code>javax.servlet</code> api for apps that have not been migrated yet (the majority I would imagine)</z><z id="t1687861507" t="Eugen I would argue that both should be supported."><y>#</y><d>2023-06-27</d><h>10:25</h><r>Eugen</r>I would argue that both should be supported.</z><z id="t1687861525" t="Eugen Jetty 10 being the last release to support javax.servlet"><y>#</y><d>2023-06-27</d><h>10:25</h><r>Eugen</r>Jetty 10 being the last release to support <code>javax.servlet</code></z><z id="t1687888718" t="hlship The major impact is the Java class io.pedestal.servlet.ClojureVarServlet - it&apos;s where the majority of the javax. imports occur; this implies that we will need to update Tomcat at the same time as Jetty. Jetty 11 and Tomcat 10.0 both use jakara. namespaces. Jetty 10 would be easier, but it hits end-of-life in only a year."><y>#</y><d>2023-06-27</d><h>17:58</h><r>hlship</r>The major impact is the Java class io.pedestal.servlet.ClojureVarServlet - it&apos;s where the majority of the javax. imports occur; this implies that we will need to update Tomcat at the same time as Jetty.  Jetty 11 and Tomcat 10.0 both use jakara. namespaces.  Jetty 10 would be easier, but it hits end-of-life in only a year.</z><z id="t1688226112" t="PK Anane I see.. what will be the impact of supporting only Jetty 11? Maybe if a sensitization drive is begun the community will be aware of what to expect. Especially since Jetty 10 hits EOL"><y>#</y><d>2023-07-01</d><h>15:41</h><r>PK Anane</r>I see.. what will be the impact of supporting only Jetty 11? Maybe if a sensitization drive is begun the community will be aware of what to expect. Especially since Jetty 10 hits EOL</z><z id="t1688226112" t="PK Anane I see.. what will be the impact of supporting only Jetty 11? Maybe if a sensitization drive is begun the community will be aware of what to expect. Especially since Jetty 10 hits EOL"><y>#</y><d>2023-07-01</d><h>15:41</h><w>PK Anane</w>I see.. what will be the impact of supporting only Jetty 11? Maybe if a sensitization drive is begun the community will be aware of what to expect. Especially since Jetty 10 hits EOL</z><z id="t1688143521" t="isak In a new project I&apos;m managing pedestal (jetty) via integrant, and when I reset the system, I get a java.net.BindException (port is in use) unless I add (Thread/sleep 1000) after calling http/stop . Is there a built in way to stop the server, and wait for it to be stopped?"><y>#</y><d>2023-06-30</d><h>16:45</h><w>isak</w>In a new project I&apos;m managing pedestal (jetty) via integrant, and when I reset the system, I get a <code>java.net.BindException</code> (port is in use) unless I add <code>(Thread/sleep 1000)</code> after calling <code>http/stop</code>. Is there a built in way to stop the server, and wait for it to be stopped?</z><z id="t1688375478" t="rolt i&apos;m using the same setup and never had this problem. Do you reproduce the issue with a simple pedestal stop/start ?"><y>#</y><d>2023-07-03</d><h>09:11</h><r>rolt</r>i&apos;m using the same setup and never had this problem. Do you reproduce the issue with a simple pedestal stop/start ?</z><z id="t1688571388" t="isak Hmm now I can&apos;t reproduce it at all. I must have been doing something incorrectly before."><y>#</y><d>2023-07-05</d><h>15:36</h><r>isak</r>Hmm now I can&apos;t reproduce it at all. I must have been doing something incorrectly before.</z><z id="t1688198846" t="hifumi123 Is there any particular reason the Pedestal website is HTTP-only?"><y>#</y><d>2023-07-01</d><h>08:07</h><w>hifumi123</w>Is there any particular reason the Pedestal website is HTTP-only?</z><z id="t1688238145" t="hlship I think for the majority of Pedestal users, the fact that pedestal.jetty is switching from Jetty 9 to (likely) Jetty 11 will not make any difference; it’s only if your application’s code uses the available callbacks to manipulate the Jetty APIs - which will change - such as (for example) to set up web socket support, that you’ll feel the pain. There might be other small changes related to packaging up a WAR file. We’ll know more as we start the make the changes."><y>#</y><d>2023-07-01</d><h>19:02</h><w>hlship</w>I think for the majority of Pedestal users, the fact that pedestal.jetty is switching from Jetty 9 to (likely) Jetty 11 will not make any difference; it’s only if your application’s  code uses the available callbacks to manipulate the Jetty APIs - which will change - such as (for example) to set up web socket support, that you’ll feel the pain. There might be other small changes related to packaging up a WAR file.  We’ll know more as we start the make the changes.</z><z id="t1688573096" t="isak One problem with the current websocket support is makes it harder than it should be to inject the system (for using integrant) into the socket context. You have to copy and alter some functions from pedestal. Maybe that is already known, if not - something to think about for the next API."><y>#</y><d>2023-07-05</d><h>16:04</h><w>isak</w>One problem with the current websocket support is makes it harder than it should be to inject the system (for using integrant) into the socket context. You have to copy and alter some functions from pedestal. Maybe that is already known, if not - something to think about for the next API.</z><z id="t1689702895" t="hlship We&apos;re working on that stuff right now, looking for simplifications and unlocking some odd choices. What&apos;s in 0.6 is neither tested nor documented (shame!) so we&apos;re working on adding tests and then a better, but not compatible, API for 0.7."><y>#</y><d>2023-07-18</d><h>17:54</h><w>hlship</w>We&apos;re working on that stuff right now, looking for simplifications and unlocking some odd choices. What&apos;s in 0.6 is neither tested nor documented (shame!) so we&apos;re working on adding tests and then a better, but not compatible, API for 0.7.</z><z id="t1689787585" t="Avelino how do i remove the jetty logs on the pedestal? this: [main] INFO org.eclipse.jetty.util.log - Logging initialized @4363ms to org.eclipse.jetty.util.log.Slf4jLog [main] INFO org.eclipse.jetty.server.Server - jetty-9.4.44.v20210927; built: 2021-09-27T23:02:44.612Z; git: 8da83308eeca865e495e53ef315a249d63ba9332; jvm 20.0.1 [main] INFO org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@5824c80c{/,null,AVAILABLE} Execution error (BindException) at (Net.java:-2)."><y>#</y><d>2023-07-19</d><h>17:26</h><w>Avelino</w>how do i remove the jetty logs on the pedestal?

this:
<pre>[main] INFO org.eclipse.jetty.util.log - Logging initialized @4363ms to org.eclipse.jetty.util.log.Slf4jLog
[main] INFO org.eclipse.jetty.server.Server - jetty-9.4.44.v20210927; built: 2021-09-27T23:02:44.612Z; git: 8da83308eeca865e495e53ef315a249d63ba9332; jvm 20.0.1
[main] INFO org.eclipse.jetty.server.handler.ContextHandler - Started o.e.j.s.ServletContextHandler@5824c80c{/,null,AVAILABLE}
Execution error (BindException) at  (Net.java:-2).</pre></z><z id="t1689790427" t="souenzzo depends on which logging backend you are using if you are using logback, you can configure filters and avoid org.eclpse.* namespaces https://logback.qos.ch/manual/filters.html some backends, like simple do not support filters, AFIK using a nop backend may be a solution https://mvnrepository.com/artifact/org.slf4j/slf4j-nop"><y>#</y><d>2023-07-19</d><h>18:13</h><r>souenzzo</r>depends on which logging backend you are using
if you are using logback, you can configure filters and avoid <code>org.eclpse.*</code> namespaces
<a href="https://logback.qos.ch/manual/filters.html" target="_blank">https://logback.qos.ch/manual/filters.html</a>

some backends, like <code>simple</code> do not support filters, AFIK

using a nop backend may be a solution
<a href="https://mvnrepository.com/artifact/org.slf4j/slf4j-nop" target="_blank">https://mvnrepository.com/artifact/org.slf4j/slf4j-nop</a></z><z id="t1689793371" t="Chicão this is the pr https://github.com/moclojer/moclojer/pull/135 if you want look at"><y>#</y><d>2023-07-19</d><h>19:02</h><r>Chicão</r>this is the pr <a href="https://github.com/moclojer/moclojer/pull/135" target="_blank">https://github.com/moclojer/moclojer/pull/135</a> if you want look at</z><z id="t1689794842" t="Avelino [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] is that PR"><y>#</y><d>2023-07-19</d><h>19:27</h><r>Avelino</r><a>@U2J4FRT2T</a> is that PR</z><z id="t1690044686" t="souenzzo HOW TO FILTER PEDESTA LOGS, VIA java.util.logs: I will leave this commit on this thread for docs https://github.com/souenzzo/moclojer/commit/bbe82379274c00228343d28ee926bc8ce63f6f1c"><y>#</y><d>2023-07-22</d><h>16:51</h><r>souenzzo</r>HOW TO FILTER PEDESTA LOGS, VIA java.util.logs:
I will leave this commit on this thread for docs

<a href="https://github.com/souenzzo/moclojer/commit/bbe82379274c00228343d28ee926bc8ce63f6f1c" target="_blank">https://github.com/souenzzo/moclojer/commit/bbe82379274c00228343d28ee926bc8ce63f6f1c</a></z><z id="t1689967718" t="steven kent Do you have to user a .war file to deploy a Pedestal service? Can it be a .jar instead? Also, doing this with deps.edn, does anyone have any pointers to documentation (I saw this https://clojure.atlassian.net/browse/TBUILD-21 &amp; http://pedestal.io/guides/war-deployment ). Also, does anyone have experience deploying a Pedestal service to Azure App Service? Any advice on that? Thank you"><y>#</y><d>2023-07-21</d><h>19:28</h><w>steven kent</w>Do you have to user a .war file to deploy a Pedestal service? Can it be a .jar instead? Also, doing this with deps.edn, does anyone have any pointers to documentation (I saw this <a href="https://clojure.atlassian.net/browse/TBUILD-21" target="_blank">https://clojure.atlassian.net/browse/TBUILD-21</a> &amp; <a href="http://pedestal.io/guides/war-deployment" target="_blank">http://pedestal.io/guides/war-deployment</a>). Also, does anyone have experience deploying a Pedestal service to Azure App Service? Any advice on that? Thank you</z><z id="t1689969464" t="hlship Generally, you stand up an embedded Jetty (or Tomcat) instance as part of your application, but building and deploying a WAR file is also supported."><y>#</y><d>2023-07-21</d><h>19:57</h><w>hlship</w>Generally, you stand up an embedded Jetty (or Tomcat) instance as part of your application, but building and deploying a WAR file is also supported.</z><z id="t1689977008" t="phill It looks like a rarely-taken path. A crucial part is not there - A link or precise reference to &quot;the Pedestal template&quot;, from which you should copy some functions, would be a good addition."><y>#</y><d>2023-07-21</d><h>22:03</h><r>phill</r>It looks like a rarely-taken path. A crucial part is not there - A link or precise reference to &quot;the Pedestal template&quot;, from which you should copy some functions, would be a good addition.</z><z id="t1689977095" t="phill But OP wanted to use a jar instead, and indeed that is very easy to do with Pedestal, such as by following the Hello World tutorial at http://pedestal.io/guides/ ."><y>#</y><d>2023-07-21</d><h>22:04</h><r>phill</r>But OP wanted to use a jar instead, and indeed that is very easy to do with Pedestal, such as by following the Hello World tutorial at <a href="http://pedestal.io/guides/" target="_blank">http://pedestal.io/guides/</a>.</z><z id="t1690294283" t="Shekhar I am attempting to gracefully shut down the Pedestal server, and I have implemented a shutdown hook as shown below: (.addShutdownHook (Runtime/getRuntime) (Thread. (fn [] (timbre/warn &quot;Shutting down the server&quot;) (http/stop @server)))) I get below logs in the terminal when I press Ctrl + C 2023-07-25T13:13:00.471Z worf.local WARN [unifize.system:194] - Shutting down the server 2023-07-25T13:13:00.477Z worf.local INFO [org.eclipse.jetty.server.AbstractConnector:381] - Stopped ServerConnector@3b19d8ba{HTTP/1.1, (http/1.1, h2c)}{localhost:3592} 2023-07-25T13:13:00.479Z worf.local INFO [org.eclipse.jetty.server.handler.ContextHandler:1153] - Stopped o.e.j.s.ServletContextHandler@58bb05a9{/,null,STOPPED} Upon initiating the shutdown, Jetty terminates active HTTP connections with the client. Is this the intended behaviour, or am I missing something?"><y>#</y><d>2023-07-25</d><h>14:11</h><w>Shekhar</w>I am attempting to gracefully shut down the Pedestal server, and I have implemented a shutdown hook as shown below:

<pre>(.addShutdownHook (Runtime/getRuntime)
                  (Thread. (fn []
                               (timbre/warn &quot;Shutting down the server&quot;)                       
                               (http/stop @server))))
</pre>
I get below logs in the terminal when I press <code>Ctrl + C</code>

<pre>2023-07-25T13:13:00.471Z worf.local WARN [unifize.system:194] - Shutting down the server
2023-07-25T13:13:00.477Z worf.local INFO [org.eclipse.jetty.server.AbstractConnector:381] - Stopped ServerConnector@3b19d8ba{HTTP/1.1, (http/1.1, h2c)}{localhost:3592}
2023-07-25T13:13:00.479Z worf.local INFO [org.eclipse.jetty.server.handler.ContextHandler:1153] - Stopped o.e.j.s.ServletContextHandler@58bb05a9{/,null,STOPPED}
</pre>
Upon initiating the shutdown, Jetty terminates active HTTP connections with the client. Is this the intended behaviour, or am I missing something?</z><z id="t1690802225" t="Shekhar How can I configure Pedestal to prevent active HTTP connections from being terminated during shutdown? Any suggestions would be greatly appreciated."><y>#</y><d>2023-07-31</d><h>11:17</h><w>Shekhar</w>How can I configure Pedestal to prevent active HTTP connections from being terminated during shutdown? Any suggestions would be greatly appreciated.</z><z id="t1690809681" t="rolt i&apos;m surprised jetty does no perform a graceful shutdown by default. You could try setting the stopTimeout (setStopTimeout here: https://github.com/pedestal/pedestal/blob/9b02e4c4a9b87c718ed7f3f7bcdab032e84336a7/jetty/src/io/pedestal/http/jetty.clj#L195 ) to see if that helps ? https://eclipse.dev/jetty/documentation/jetty-9/index.html#jetty-connectors"><y>#</y><d>2023-07-31</d><h>13:21</h><r>rolt</r>i&apos;m surprised jetty does no perform a graceful shutdown by default. You could try setting the <code>stopTimeout</code>
(setStopTimeout here: <a href="https://github.com/pedestal/pedestal/blob/9b02e4c4a9b87c718ed7f3f7bcdab032e84336a7/jetty/src/io/pedestal/http/jetty.clj#L195" target="_blank">https://github.com/pedestal/pedestal/blob/9b02e4c4a9b87c718ed7f3f7bcdab032e84336a7/jetty/src/io/pedestal/http/jetty.clj#L195</a>) to see if that helps ?
<a href="https://eclipse.dev/jetty/documentation/jetty-9/index.html#jetty-connectors" target="_blank">https://eclipse.dev/jetty/documentation/jetty-9/index.html#jetty-connectors</a></z><z id="t1690811240" t="rolt To perform a graceful shutdown of Jetty, the stats https://eclipse.dev/jetty/documentation/jetty-9/index.html#startup-modules must be enabled apparently you need both the stats module and a positive value for stopTimeout (and a recent version of jetty 9.4) ~stopTimeout should be 30s by default, so maybe just adding the stats module would fix the issue ?~ (it&apos;s hard to distinguish what applies to the embedded version or to the application version, seems like it&apos;s null by default) edit: from the doc // === jetty-stats.xml === StatisticsHandler stats = new StatisticsHandler(); stats.setHandler(server.getHandler()); server.setHandler(stats); server.addBeanToAllConnectors(new ConnectionStatistics());"><y>#</y><d>2023-07-31</d><h>13:47</h><r>rolt</r>To perform a graceful shutdown of Jetty, the <code>stats</code> <a href="https://eclipse.dev/jetty/documentation/jetty-9/index.html#startup-modules" target="_blank">https://eclipse.dev/jetty/documentation/jetty-9/index.html#startup-modules</a> must be enabled

apparently you need both the stats module and a positive value for stopTimeout (and a recent version of jetty 9.4)
~stopTimeout should be 30s by default, so maybe just adding the stats module would fix the issue ?~ (it&apos;s hard to distinguish what applies to the embedded version or to the application version, seems like it&apos;s null by default)

edit: from the doc
<pre>// === jetty-stats.xml ===
        StatisticsHandler stats = new StatisticsHandler();
        stats.setHandler(server.getHandler());
        server.setHandler(stats);
        server.addBeanToAllConnectors(new ConnectionStatistics());</pre></z><z id="t1690902506" t="Shekhar Thanks [:attrs {:href &quot;/_/_/users/U02F0C62TC1&quot;}] I will try this"><y>#</y><d>2023-08-01</d><h>15:08</h><r>Shekhar</r>Thanks <a>@U02F0C62TC1</a> I will try this</z><z id="t1690980914" t="rolt I tried it and simply adding stats made it work. So no need to set stopTimeout if the default value is good enough for you (defn add-stats [m] (let [^org.eclipse.jetty.server.Server server (::server/server m) stats (new org.eclipse.jetty.server.handler.StatisticsHandler)] (.setHandler stats (.getHandler server)) (.setHandler server stats) m))"><y>#</y><d>2023-08-02</d><h>12:55</h><r>rolt</r>I tried it and simply adding stats made it work. So no need to set stopTimeout if the default value is good enough for you
<pre>(defn add-stats
  [m]
  (let [^org.eclipse.jetty.server.Server server (::server/server m)
        stats (new org.eclipse.jetty.server.handler.StatisticsHandler)]
    (.setHandler stats (.getHandler server))
    (.setHandler server stats)
    m))</pre></z><z id="t1690981283" t="rolt also: I did not manage to make the stopTimeout value work so I don&apos;t know how to properly set it. Or maybe it can&apos;t be lower than other timeout values (connection, socket, etc) perhaps it will be clearer jetty 10/11 (i tried to set it on the ServerConnector instances in create-server, no errors but my server did not stop early if I set a low timeout value, it still waited for my handler to respond)"><y>#</y><d>2023-08-02</d><h>13:01</h><r>rolt</r>also: I did not manage to make the stopTimeout value work so I don&apos;t know how to properly set it. Or maybe it can&apos;t be lower than other timeout values (connection, socket, etc)
perhaps it will be clearer jetty 10/11
(i tried to set it on the <code>ServerConnector</code> instances in create-server, no errors but my server did not stop early if I set a low timeout value, it still waited for my handler to respond)</z><z id="t1690981807" t="Shekhar Are you invoking the add-stats function after starting the server?"><y>#</y><d>2023-08-02</d><h>13:10</h><r>Shekhar</r>Are you invoking the <code>add-stats</code> function after starting the server?</z><z id="t1690981837" t="rolt after creating the server, before starting it"><y>#</y><d>2023-08-02</d><h>13:10</h><r>rolt</r>after creating the server, before starting it</z><z id="t1690981876" t="rolt from the pedestal-service template: (-&gt; [...] server/create-server add-stats server/start)"><y>#</y><d>2023-08-02</d><h>13:11</h><r>rolt</r>from the pedestal-service template:
<pre>(-&gt; [...] 
     server/create-server
      add-stats
      server/start)</pre></z><z id="t1690981882" t="Shekhar Thank you so much"><y>#</y><d>2023-08-02</d><h>13:11</h><r>Shekhar</r>Thank you so much</z><z id="t1691136495" t="Shekhar I did manage to increase or decrease timeout [:attrs {:href &quot;/_/_/users/U02F0C62TC1&quot;}] (defn add-stats [{:keys [::server/server] :as service-map}] (let [stats (StatisticsHandler.)] (.setStopTimeout server 20000) (.setHandler stats (.getHandler server)) (.setHandler server stats) service-map)) "><y>#</y><d>2023-08-04</d><h>08:08</h><r>Shekhar</r>I did manage to increase or decrease timeout <a>@U02F0C62TC1</a>
<pre>(defn add-stats
  [{:keys [::server/server] :as service-map}]
  (let [stats (StatisticsHandler.)]
    (.setStopTimeout server 20000)
    (.setHandler stats (.getHandler server))
    (.setHandler server stats)
    service-map))</pre>
</z><z id="t1691136658" t="Shekhar The statistic handler can be also configured via container-options like (defn jetty-configurator &quot;Add statistics handler in Jetty server via `container-options` of the pedestal.&quot; [server] (let [stats (StatisticsHandler.)] (.setStopTimeout server 60000) (.setHandler stats (.getHandler server)) (.setHandler server stats)) server) And from pedestal-service template: (-&gt; service-map (assoc ::http/container-options {:configurator jetty-configurator}) http/create-server http/start) "><y>#</y><d>2023-08-04</d><h>08:10</h><r>Shekhar</r>The statistic handler can be also configured via <code>container-options</code> like
<pre>(defn jetty-configurator
  &quot;Add statistics handler in Jetty server via `container-options` of the
  pedestal.&quot;
  [server]
  (let [stats (StatisticsHandler.)]
    (.setStopTimeout server 60000)
    (.setHandler stats (.getHandler server))
    (.setHandler server stats))
  server)</pre>
And from pedestal-service template:
<pre>(-&gt; service-map
    (assoc ::http/container-options {:configurator jetty-configurator})
    http/create-server
    http/start)</pre>
</z><z id="t1691136861" t="rolt nice that&apos;s way cleaner"><y>#</y><d>2023-08-04</d><h>08:14</h><r>rolt</r>nice that&apos;s way cleaner</z><z id="t1691136927" t="rolt it&apos;s so weird because in the doc they write about the stopTimeout in the server connector section, not the server one"><y>#</y><d>2023-08-04</d><h>08:15</h><r>rolt</r>it&apos;s so weird because in the doc they write about the stopTimeout in the server connector section, not the server one</z><z id="t1692296960" t="simon Hi all! I&apos;m struggling a bit testing my pedestal code.. I have an interceptor on a single route which I don&apos;t want to run in my tests. How would I go about this? Copy/paste my service-map in the tests and just exclude the interceptor? Or is there a more elegant way to handle this? Thanks for any feedback!"><y>#</y><d>2023-08-17</d><h>18:29</h><w>simon</w>Hi all! I&apos;m struggling a bit testing my pedestal code.. I have an interceptor on a single route which I don&apos;t want to run in my tests. How would I go about this? Copy/paste my service-map in the tests and just exclude the interceptor? Or is there a more elegant way to handle this? Thanks for any feedback!</z><z id="t1692302662" t="hlship I can think of a few options. First off, you must have a function somewhere that builds your routes and assembles the service map, so you could pass in a test mode (vs. production mode) flag that would skip certain interceptors. Option two: the service map or route starts as data that could be manipulated before the Router is created from the routing data, or the server is created from the service map. Option three: there may be a style of coding the interceptor where you can split out the logic; for example, if the interceptor invokes a function, you could with-redefs change that function to prevent the interceptor from interfering with your test. Maybe even something like: (with-redefs [interceptor-on-enter-fn identity] . .. test code ... ) "><y>#</y><d>2023-08-17</d><h>20:04</h><w>hlship</w>I can think of a few options.  First off, you must have a function somewhere that builds your routes and assembles the service map, so you could pass in a test mode (vs. production mode) flag that would skip certain interceptors.

Option two: the service map or route starts as data that could be manipulated before the Router is created from the routing data, or the server is created from the service map.

Option three: there may be a style of coding the interceptor where you can split out the logic; for example, if the interceptor invokes a function, you could <code>with-redefs</code> change that function to prevent the interceptor from interfering with your test. Maybe even something like:

<pre>(with-redefs [interceptor-on-enter-fn identity] .
  .. test code ... ) </pre></z><z id="t1692304362" t="simon Thanks for your feedback! 😊 Option one is a good idea, haven&apos;t thought of it. I&apos;ve tried option two and three, but both didn&apos;t work and it was driving me a bit up the walls.. For option two I wrote two functions to manipulate the raw service map. One to remove interceptors from ::io.pedestal.http/interceptors and another to remove interceptors from routes. And even though when I inspected the service map the interceptor on the route was gone, when I started the service it was still applied. 🙈 Could be that it was too long a day in front of the screen though.. I&apos;ve also tried option three, pretty much like you write, using with-redefs and using the function that is bound to the :enter of the interceptor. But also this didn&apos;t work, and I gave up pretty quickly. I just remember from python that it depends very much in which namespace you mock/redef the function, and so didn&apos;t try a lot. Option three would be my favorite though, if I get it to work. I have an interceptor namespace where I define my custom interceptors and create them like this: (def presence-interceptor (io.pedestal.interceptor/interceptor {:name ::presence-interceptor :enter update-presence})) Then in my tests I import the interceptor and redefine it: (ns core-test (:require [app.interceptors :as interceptors] [io.pedestal.test :as test])) (def service (:io.pedestal.http/service-fn (io.pedestal.http/create-servlet core/service-map))) (deftest test-something (with-redefs [interceptors/update-presence identity] (is (= &quot;&quot; (:body (test/response-for service :post &quot;/test/&quot; :headers {&quot;Content-Type&quot; &quot;application/json&quot;} :body &quot;{}&quot;)))) But in my tests this didn&apos;t work. I&apos;ve also tried creating my service within the scope of with-redefs , but didn&apos;t work either. Does this look correct, like how you would use redef here with the interceptor?"><y>#</y><d>2023-08-17</d><h>20:32</h><w>simon</w>Thanks for your feedback! <b>😊</b> Option one is a good idea, haven&apos;t thought of it. I&apos;ve tried option two and three, but both didn&apos;t work and it was driving me a bit up the walls..

For option two I wrote two functions to manipulate the raw service map. One to remove interceptors from <code>::io.pedestal.http/interceptors</code> and another to remove interceptors from routes. And even though when I inspected the service map the interceptor on the route was gone, when I started the service it was still applied. <b>🙈</b> Could be that it was too long a day in front of the screen though..

I&apos;ve also tried option three, pretty much like you write, using <code>with-redefs</code> and using the function that is bound to the <code>:enter</code> of the interceptor. But also this didn&apos;t work, and I gave up pretty quickly. I just remember from python that it depends very much in which namespace you mock/redef the function, and so didn&apos;t try a lot.

Option three would be my favorite though, if I get it to work. I have an interceptor namespace where I define my custom interceptors and create them like this:
<pre>(def presence-interceptor
  (io.pedestal.interceptor/interceptor
    {:name ::presence-interceptor
     :enter update-presence}))</pre>
Then in my tests I import the interceptor and redefine it:
<pre>(ns core-test
  (:require
    [app.interceptors :as interceptors]
    [io.pedestal.test :as test]))

(def service (:io.pedestal.http/service-fn (io.pedestal.http/create-servlet core/service-map)))

(deftest test-something
  (with-redefs [interceptors/update-presence identity]
    (is (= &quot;&quot; (:body (test/response-for service
                                :post &quot;/test/&quot;
                                :headers {&quot;Content-Type&quot; &quot;application/json&quot;}
                                :body &quot;{}&quot;))))</pre>
But in my tests this didn&apos;t work. I&apos;ve also tried creating my service within the scope of <code>with-redefs</code>, but didn&apos;t work either.

Does this look correct, like how you would use redef here with the interceptor?</z><z id="t1692312437" t="hlship If you made it ... :enter #&apos;update-presence it may work. What&apos;s happening is that you are capturing the value of the update-presense Var, a fn. Later, you with-redefs to rebind the Var, but the captures function is still in use. By always invoking the Var (not capturing it), you incur the cost of de-referencing the value of the Var, but then are able to rebind it for your tests. I should have mentioned that here, there&apos;s some more context here: http://pedestal.io/guides/live-repl"><y>#</y><d>2023-08-17</d><h>22:47</h><w>hlship</w>If you made it <code>... :enter #&apos;update-presence</code> it may work.  What&apos;s happening is that you are capturing the value of the <code>update-presense</code> Var, a fn.  Later, you <code>with-redefs</code> to rebind the Var, but the captures function is still in use.  By always invoking the Var (not capturing it), you incur the cost of de-referencing the value of the Var, but then are able to rebind it for your tests.  I should have mentioned that here, there&apos;s some more context here: <a href="http://pedestal.io/guides/live-repl" target="_blank">http://pedestal.io/guides/live-repl</a></z><z id="t1692346190" t="simon Thanks a lot for your explanation, it all starts to click. 😊 I have also read through the live-repl guide, somehow I&apos;ve missed it before, it has also really thorough explanations, very cool. You mention the cost of de-referencing - it&apos;s hard for me to estimate the impact of it, is it ok to run it like this in production? Asking because in the live-repl guide they say to not use a function to create the routes in production, but I guess the cost of de-referencing is ok?"><y>#</y><d>2023-08-18</d><h>08:09</h><w>simon</w>Thanks a lot for your explanation, it all starts to click. <b>😊</b> I have also read through the live-repl guide, somehow I&apos;ve missed it before, it has also really thorough explanations, very cool. You mention the cost of de-referencing - it&apos;s hard for me to estimate the impact of it, is it ok to run it like this in production? Asking because in the live-repl guide they say to not use a function to create the routes in production, but I guess the cost of de-referencing is ok?</z><z id="t1692355052" t="phill If you operate Twitter then you might do well to avoid the extra dereference. The difference might be so small that web performance tools could not even measure it, but of course the more requests your server receives, the faster it adds up. Clojure is great for first-order, &quot;work smarter, not harder&quot; speed, relative to other tools where you have to program &quot;safe copies&quot; of things or derive map keys from objects by toString all the time. But, Clojure offers some second-order, elective, micro-inefficiencies, like lazy sequences. Rule of thumb: if you&apos;re OK with lazy sequences then you need not worry about the extra dereference. Creating routes with a function is fine too, but you do not want Pedestal to call that function every time it gets a request. In production, once is plenty (if we may assume the result will be equivalent every time). How bad is it? Well, what you see in your development environment is what you&apos;ll get. It might feel OK. Just don&apos;t do it. 🙂"><y>#</y><d>2023-08-18</d><h>10:37</h><r>phill</r>If you operate Twitter then you might do well to avoid the extra dereference. The difference might be so small that web performance tools could not even measure it, but of course the more requests your server receives, the faster it adds up.

Clojure is great for first-order, &quot;work smarter, not harder&quot; speed, relative to other tools where you have to program &quot;safe copies&quot; of things or derive map keys from objects by toString all the time. But, Clojure offers some second-order, elective, micro-inefficiencies, like lazy sequences. Rule of thumb: if you&apos;re OK with lazy sequences then you need not worry about the extra dereference.

Creating routes with a function is fine too, but you do not want Pedestal to call that function every time it gets a request. In production, once is plenty (if we may assume the result will be equivalent every time). How bad is it? Well, what you see in your development environment is what you&apos;ll get. It might feel OK.  Just don&apos;t do it. <b>🙂</b></z><z id="t1692362694" t="simon Thank you! 😊 That sounds like good advice. About &quot;work smarter, not harder&quot;, that was also my thinking. In the way I use clojure it is probably not optimized for speed, and I guess I could make many improvements, so the extra dereference wouldn&apos;t matter that much. Also thanks for the tip about the routes. In the end I&apos;ve tried to :enter #&apos;update-presence , but then an assert failed about it not being a valid interceptor anymore. So in the end I redefined the function calling the db in the interceptor, which was what I wanted to avoid. Thanks for sharing your knowledge! I keep being amazed by the support of the clojure community. 😊"><y>#</y><d>2023-08-18</d><h>12:44</h><r>simon</r>Thank you! <b>😊</b> That sounds like good advice. About &quot;work smarter, not harder&quot;, that was also my thinking. In the way I use clojure it is probably not optimized for speed, and I guess I could make many improvements, so the extra dereference wouldn&apos;t matter that much. Also thanks for the tip about the routes.

In the end I&apos;ve tried to <code>:enter #&apos;update-presence</code>, but then an assert failed about it not being a valid interceptor anymore. So in the end I redefined the function calling the db in the interceptor, which was what I wanted to avoid.

Thanks for sharing your knowledge! I keep being amazed by the support of the clojure community. <b>😊</b></z><z id="t1695452923" t="Mark Wardle Is there an easy way to switch Jetty to using virtual threads when using Pedestal and running on Java that supports them?"><y>#</y><d>2023-09-23</d><h>07:08</h><w>Mark Wardle</w>Is there an easy way to switch Jetty to using virtual threads when using Pedestal and running on Java that supports them?</z><z id="t1695452964" t="Mark Wardle eg. are there any &apos;hooks&apos; I can use to potentially configure the thread pool used internally?"><y>#</y><d>2023-09-23</d><h>07:09</h><r>Mark Wardle</r>eg. are there any &apos;hooks&apos; I can use to potentially configure the thread pool used internally?</z><z id="t1695498583" t="jmv Have you tried passing in a custom :thread-pool ? http://pedestal.io/reference/jetty"><y>#</y><d>2023-09-23</d><h>19:49</h><r>jmv</r>Have you tried passing in a custom <code>:thread-pool</code>?

<a href="http://pedestal.io/reference/jetty" target="_blank">http://pedestal.io/reference/jetty</a></z><z id="t1695500734" t="Mark Wardle Thanks! I didn’t spot that page in the docs! Perfect. I’ll try and do some benchmarking! "><y>#</y><d>2023-09-23</d><h>20:25</h><r>Mark Wardle</r>Thanks! I didn’t spot that page in the docs! Perfect. I’ll try and do some benchmarking! </z><z id="t1695501397" t="jmv Report back! Very curious to see the results. "><y>#</y><d>2023-09-23</d><h>20:36</h><r>jmv</r>Report back! Very curious to see the results. </z><z id="t1695545892" t="Mark Wardle Not sure this works as jetty 9&apos;s QueuedThreadPool doesn&apos;t support setting an executor service. Direct use of e.g. Jetty 11 via ring jetty adaptor has that hook."><y>#</y><d>2023-09-24</d><h>08:58</h><r>Mark Wardle</r>Not sure this works as jetty 9&apos;s QueuedThreadPool doesn&apos;t support setting an executor service. Direct use of e.g. Jetty 11 via ring jetty adaptor has that hook.</z><z id="t1695625918" t="souenzzo https://clojurians.slack.com/archives/C06E3HYPR/p1695577334020949"><y>#</y><d>2023-09-25</d><h>07:11</h><r>souenzzo</r><a href="https://clojurians.slack.com/archives/C06E3HYPR/p1695577334020949" target="_blank">https://clojurians.slack.com/archives/C06E3HYPR/p1695577334020949</a></z><z id="t1696055080" t="Patrix I have an interceptor where, in the (post) request, I&apos;m trying to access json params, so ok we have the :json-params map. But I also want to access the raw POST data as a string. I see there&apos;s also a :body key in the :request, however it&apos;s some Java object. (org.eclipse.jetty.server.HttpInputOverHTTP). Not sure how to proceed from here as my familiarity with the java/jetty land is quite minimal... So essentially, what would be the recommended way of getting that POST body as a string?"><y>#</y><d>2023-09-30</d><h>06:24</h><w>Patrix</w>I have an interceptor where, in the (post) request, I&apos;m trying to access json params, so ok we have the :json-params map. But I also want to access the raw POST data as a string. I see there&apos;s also a :body key in the :request, however it&apos;s some Java object. (org.eclipse.jetty.server.HttpInputOverHTTP). Not sure how to proceed from here as my familiarity with the java/jetty land is quite minimal...

So essentially, what would be the recommended way of getting that POST body as a string?</z><z id="t1696137707" t="Patrix So I figured I can (slurp) that object, however that yields an empty string. Probably because, as I just learned, Output streams can be read only once... And I&apos;m guessing the stream is read throughout all the other interceptors that get the json params for example."><y>#</y><d>2023-10-01</d><h>05:21</h><r>Patrix</r>So I figured I can (slurp) that object, however that yields an empty string. Probably because, as I just learned, Output streams can be read only once... And I&apos;m guessing the stream is read throughout all the other interceptors that get the json params for example.</z><z id="t1696272201" t="jmv You may want to use the body-params interceptor: http://pedestal.io/api/io.pedestal.http.body-params.html#var-body-params"><y>#</y><d>2023-10-02</d><h>18:43</h><r>jmv</r>You may want to use the body-params interceptor: <a href="http://pedestal.io/api/io.pedestal.http.body-params.html#var-body-params" target="_blank">http://pedestal.io/api/io.pedestal.http.body-params.html#var-body-params</a></z><z id="t1696272268" t="jmv docs: http://pedestal.io/reference/parameters#_body_parameters"><y>#</y><d>2023-10-02</d><h>18:44</h><r>jmv</r>docs: <a href="http://pedestal.io/reference/parameters#_body_parameters" target="_blank">http://pedestal.io/reference/parameters#_body_parameters</a></z><z id="t1696280807" t="souenzzo you may want to not use body-param interceptor body parameter interceptor will not provide access to the raw body you probably need something like this: (def my-json-interceptor {:name ::my-json-interceptor :enter (fn [{:keys [request] :as ctx}] (if ;; maybe check if method=post and content-type=json (-&gt; request :request-method #{:post :put &apos;...}) (let [raw-body-str (-&gt; request :body slurp) json-params (json/parse-string raw-body-str true)] (-&gt; ctx (assoc-in [:request :json-params] json-params) (assoc-in [:request :raw-body-str] raw-body-str))) ctx))})"><y>#</y><d>2023-10-02</d><h>21:06</h><r>souenzzo</r>you may want to not use <code>body-param</code> interceptor

body parameter interceptor will not provide access to the <code>raw</code> body

you probably need something like this:
<pre>(def my-json-interceptor
  {:name  ::my-json-interceptor
   :enter (fn [{:keys [request]
                :as   ctx}]
            (if
              ;; maybe check if method=post and content-type=json
              (-&gt; request :request-method 
                #{:post :put &apos;...})
              (let [raw-body-str (-&gt; request :body slurp)
                    json-params (json/parse-string raw-body-str true)]
                (-&gt; ctx
                  (assoc-in [:request :json-params] json-params)
                  (assoc-in [:request :raw-body-str] raw-body-str)))
              ctx))})</pre></z><z id="t1696289815" t="Patrix Ahhh ok so for this one route, I should probably not use the default interceptors? So I probably shouldn&apos;t put it in my service map then, as that would apply to every route.."><y>#</y><d>2023-10-02</d><h>23:36</h><r>Patrix</r>Ahhh ok so for this one route, I should probably not use the default interceptors? So I probably shouldn&apos;t put it in my service map then, as that would apply to every route..</z><z id="t1696289841" t="Patrix thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] , [:attrs {:href &quot;/_/_/users/UDXEK491P&quot;}] , let me try these..."><y>#</y><d>2023-10-02</d><h>23:37</h><r>Patrix</r>thanks <a>@U2J4FRT2T</a>, <a>@UDXEK491P</a>, let me try these...</z><z id="t1696327038" t="Patrix Ok, this seems to be working! Now I&apos;m able to get that raw body string and validate it with the stripe webhook secret key, whew. And still can get the json params to proceed with actually handling the events was able to remove the body-params interceptor from the service map, and move that into the other function I had which added a bunch of interceptors, but only for the routes that need that, instead of all routes."><y>#</y><d>2023-10-03</d><h>09:57</h><r>Patrix</r>Ok, this seems to be working! Now I&apos;m able to get that raw body string and validate it with the stripe webhook secret key, whew. And still can get the json params to proceed with actually handling the events

was able to remove the body-params interceptor from the service map, and move that into the other function I had which added a bunch of interceptors, but only for the routes that need that, instead of all routes.</z><z id="t1696327051" t="Patrix thanks for the tips/direction, that was straightforward enough 🙂"><y>#</y><d>2023-10-03</d><h>09:57</h><r>Patrix</r>thanks for the tips/direction, that was straightforward enough <b>🙂</b></z><z id="t1696332450" t="Patrix ok I didn&apos;t need to refactor all that but it helped me simplify a few things sooo it&apos;s ok, I think"><y>#</y><d>2023-10-03</d><h>11:27</h><r>Patrix</r>ok I didn&apos;t need to refactor all that but it helped me simplify a few things sooo it&apos;s ok, I think</z><z id="t1696414523" t="souenzzo Btw, do not use slurp in prod. Check HttpInputBody docs to see how to read properly"><y>#</y><d>2023-10-04</d><h>10:15</h><r>souenzzo</r>Btw, do not use slurp in prod.
Check HttpInputBody docs to see how to read properly</z><z id="t1696777241" t="Patrix Will do!"><y>#</y><d>2023-10-08</d><h>15:00</h><r>Patrix</r>Will do!</z><z id="t1696812103" t="Patrix [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] could you help with some pointers where I can read more about both of those? (why not use slurp in prod.. and how to read from an HttpInputBody ?)"><y>#</y><d>2023-10-09</d><h>00:41</h><r>Patrix</r><a>@U2J4FRT2T</a> could you help with some pointers where I can read more about both of those? (why not use slurp in prod.. and how to read from an HttpInputBody ?)</z><z id="t1696844159" t="souenzzo slurp is a easy, but not so simple tool I see slurp as a &quot;dev helper&quot; function. For prod, I&apos;d write a function like this (defn req-body-&gt;str [{:keys [^InputStream body]}] (String. (.readAllBytes body)))"><y>#</y><d>2023-10-09</d><h>09:35</h><r>souenzzo</r><code>slurp</code> is a easy, but not so simple tool
I see <code>slurp</code> as a &quot;dev helper&quot; function.

For prod, I&apos;d write a function like this

<pre>(defn req-body-&gt;str 
  [{:keys [^InputStream body]}]
  (String. (.readAllBytes body)))</pre></z><z id="t1696898135" t="Patrix ahh ok, so because the body object is a subclass of an InputStream (can&apos;t remember how I figured that out a week ago), then I can use the methods of InputStream to access it, rather than search through Jetty docs to figure that out. Got it! Thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2023-10-10</d><h>00:35</h><r>Patrix</r>ahh ok, so because the body object is a subclass of an InputStream (can&apos;t remember how I figured that out a week ago), then I can use the methods of InputStream to access it, rather than search through Jetty docs to figure that out. Got it! Thanks <a>@U2J4FRT2T</a></z><z id="t1696413268" t="agorgl Hello! I&apos;m using fast-resource interceptor to serve static resources (in order to have the index? functionality). While developing this seems to work (as it serves resources from the filesystem) but when used from within an uberjar, I get a clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedestal.http.ring-middlewares/fast-resource - Not a file: jar:file:/path/to/app.jar!/public/ Is this intended? If so shouldn&apos;t the interceptor be named fast-file instead of fast-resource ?"><y>#</y><d>2023-10-04</d><h>09:54</h><w>agorgl</w>Hello! I&apos;m using <code>fast-resource</code> interceptor to serve static resources (in order to have the <code>index?</code> functionality).

While developing this seems to work (as it serves resources from the filesystem) but when used from within an uberjar, I get a <code>clojure.lang.ExceptionInfo: java.lang.IllegalArgumentException in Interceptor :io.pedestal.http.ring-middlewares/fast-resource - Not a file: jar:file:/path/to/app.jar!/public/</code>

Is this intended? If so shouldn&apos;t the interceptor be named <code>fast-file</code> instead of <code>fast-resource</code>?</z><z id="t1696450739" t="souenzzo Here seems that ::http/type can be only a keyword https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L312 Here seems that ::http/type can be a keyword or a function https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L343 It seems wired to me."><y>#</y><d>2023-10-04</d><h>20:18</h><w>souenzzo</w>Here seems that <code>::http/type</code> can be only a keyword
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L312" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L312</a>

Here seems that <code>::http/type</code> can be a keyword or a function
<a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L343" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L343</a>

It seems wired to me.</z><z id="t1696471223" t="hlship Yes, I&apos;m working on that, and introducing schemas to properly describe and validate what all the options are."><y>#</y><d>2023-10-05</d><h>02:00</h><r>hlship</r>Yes, I&apos;m working on that, and introducing schemas to properly describe and validate what all the options are.</z><z id="t1696471249" t="hlship Should be keyword or function, and I&apos;m updating docs to lean towards function, not keyword. Better for AOT compilation and such."><y>#</y><d>2023-10-05</d><h>02:00</h><r>hlship</r>Should be keyword or function, and I&apos;m updating docs to lean towards function, not keyword.  Better for AOT compilation and such.</z><z id="t1696497764" t="souenzzo if ::http/type is a function, it requires ::http/chain-provider ::http/chain-provider is a function service-map -&gt; service-map that should assoc a new keys, usually ::http/service-fn etc into service-map ::http/type is a function service-map options -&gt; srv-description , where options contains keys like :port , and srv-description should contins at least :server :start-fn :stop-fn I&apos;m working in a new HTTP backend for pedestal 🙂 Mostly for learning//fun"><y>#</y><d>2023-10-05</d><h>09:22</h><r>souenzzo</r>if <code>::http/type</code> is a function, it requires <code>::http/chain-provider</code>

<code>::http/chain-provider</code> is a function <code>service-map -&gt; service-map</code> that should assoc a new keys, usually <code>::http/service-fn</code> etc into service-map

<code>::http/type</code> is a function <code>service-map options -&gt; srv-description</code>, where <code>options</code> contains keys like <code>:port</code>, and <code>srv-description</code> should contins at least <code>:server :start-fn :stop-fn</code>

I&apos;m working in  a new HTTP backend for pedestal <b>🙂</b>
Mostly for learning//fun</z><z id="t1696497841" t="souenzzo btw, service-map-&gt;server-options//server-map-&gt;service-map functions makes the code way harder to browse, once you can&apos;t use find keyword usages"><y>#</y><d>2023-10-05</d><h>09:24</h><r>souenzzo</r>btw, <code>service-map-&gt;server-options//server-map-&gt;service-map</code> functions makes the code way harder to browse, once you can&apos;t use <code>find keyword usages</code></z><z id="t1696532006" t="hlship I don&apos;t want to disparage the prior code owners, I&apos;m sure there were some reasons for all of this."><y>#</y><d>2023-10-05</d><h>18:53</h><r>hlship</r>I don&apos;t want to disparage the prior code owners, I&apos;m sure there were some reasons for all of this.</z><z id="t1696542319" t="souenzzo btw, less then ~100LOC and about ~5 functions to create a new pedestal backend, from http://java.net .ServerSocket. for sure a wrong and incomplete server (still not writing headers, etc). but a nice experience"><y>#</y><d>2023-10-05</d><h>21:45</h><r>souenzzo</r>btw, less then ~100LOC and about ~5 functions to create a new pedestal backend, from <a href="http://java.net" target="_blank">http://java.net</a>.ServerSocket.

for sure a wrong and incomplete server (still not writing headers, etc). but a nice experience</z><z id="t1696532133" t="hlship We&apos;re continuing to have trouble updating the SSL support for Tomcat; the API is quite different between 9 and 10 and this is a big distraction from all the more interesting things we&apos;d like to be working on. Does anyone here have a goo d understanding of SSL support in Tomcat?"><y>#</y><d>2023-10-05</d><h>18:55</h><w>hlship</w>We&apos;re continuing to have trouble updating the SSL support for Tomcat; the API is quite different between 9 and 10 and this is a big distraction from all the more interesting things we&apos;d like to be working on. Does anyone here have a goo d understanding of SSL support in Tomcat?</z><z id="t1696547279" t="isak If anyone wants to try https://helidon.io/nima , the new loom webserver from oracle, we have a first draft of a pedestal adapter here: https://github.com/xledger/pedestal-helidon/ (This is just pasted and adapted from [:attrs {:href &quot;/_/_/users/U050SC7SV&quot;}] ’s https://github.com/mpenet/mina )"><y>#</y><d>2023-10-05</d><h>23:07</h><w>isak</w>If anyone wants to try <a href="https://helidon.io/nima" target="_blank">https://helidon.io/nima</a>, the new loom webserver from oracle, we have a first draft of a pedestal adapter here:

<a href="https://github.com/xledger/pedestal-helidon/" target="_blank">https://github.com/xledger/pedestal-helidon/</a>

(This is just pasted and adapted from <a>@mpenet</a>’s <a href="https://github.com/mpenet/mina" target="_blank">https://github.com/mpenet/mina</a>)</z><z id="t1696570381" t="mpenet nice!"><y>#</y><d>2023-10-06</d><h>05:33</h><r>mpenet</r>nice!</z><z id="t1696570450" t="mpenet you should be able to make it way more minimal. :handler is wired via server options, which is just a multimethod. You could just create a :pedestal-handler mm that does what you need and not have to fork the whole project that way."><y>#</y><d>2023-10-06</d><h>05:34</h><r>mpenet</r>you should be able to make it way more minimal. :handler is wired via server options, which is just a multimethod. You could just create a :pedestal-handler mm that does what you need and not have to fork the whole project that way.</z><z id="t1696570506" t="mpenet see https://github.com/mpenet/mina/blob/main/src/s_exp/mina/options.clj#L9 and https://github.com/mpenet/mina/blob/main/src/s_exp/mina/handler.clj#L23"><y>#</y><d>2023-10-06</d><h>05:35</h><r>mpenet</r>see <a href="https://github.com/mpenet/mina/blob/main/src/s_exp/mina/options.clj#L9" target="_blank">https://github.com/mpenet/mina/blob/main/src/s_exp/mina/options.clj#L9</a> and <a href="https://github.com/mpenet/mina/blob/main/src/s_exp/mina/handler.clj#L23" target="_blank">https://github.com/mpenet/mina/blob/main/src/s_exp/mina/handler.clj#L23</a></z><z id="t1696570550" t="mpenet I was planning on doing just that for grpc and websocket"><y>#</y><d>2023-10-06</d><h>05:35</h><r>mpenet</r>I was planning on doing just that for grpc and websocket</z><z id="t1696601260" t="isak Ah very cool, I&apos;ll try switching to that approach"><y>#</y><d>2023-10-06</d><h>14:07</h><r>isak</r>Ah very cool, I&apos;ll try switching to that approach</z><z id="t1696601291" t="mpenet I just updated it to helidon 4 rc1 btw"><y>#</y><d>2023-10-06</d><h>14:08</h><r>mpenet</r>I just updated it to helidon 4 rc1 btw</z><z id="t1696606427" t="isak Unforked a lot of it now: https://github.com/xledger/pedestal-helidon/commit/7f6e21043fc894e1021955e297d132b04742485b I left the modified request/context adapter, since I don&apos;t think there is a way to use the one from mina without loosing some of the nice perf stuff you added."><y>#</y><d>2023-10-06</d><h>15:33</h><r>isak</r>Unforked a lot of it now: <a href="https://github.com/xledger/pedestal-helidon/commit/7f6e21043fc894e1021955e297d132b04742485b" target="_blank">https://github.com/xledger/pedestal-helidon/commit/7f6e21043fc894e1021955e297d132b04742485b</a>

I left the modified request/context adapter, since I don&apos;t think there is a way to use the one from mina without loosing some of the nice perf stuff you added.</z><z id="t1696805180" t="hifumi123 is there a reason for deploying a SNAPSHOT2? it should be sufficient to redeploy the SNAPSHOT since these are by definition mutable and maven / leiningen / etc will constantly pull in the latest version of the SNAPSHOT"><y>#</y><d>2023-10-08</d><h>22:46</h><r>hifumi123</r>is there a reason for deploying a SNAPSHOT2? it should be sufficient to redeploy the SNAPSHOT since these are by definition mutable and maven / leiningen / etc will constantly pull in the latest version of the SNAPSHOT</z><z id="t1696860253" t="isak Ah, I didn&apos;t know I could redeploy them"><y>#</y><d>2023-10-09</d><h>14:04</h><r>isak</r>Ah, I didn&apos;t know I could redeploy them</z><z id="t1696949999" t="frankiesardo Hello friends! Been a long time since I used pedestal and I&apos;m looking forward to include it again in a brand new project. I&apos;m curious - what&apos;s the state of https://github.com/cognitect-labs/vase and https://github.com/cognitect-labs/pedestal.views ? Is somebody actively using them in production?"><y>#</y><d>2023-10-10</d><h>14:59</h><w>frankiesardo</w>Hello friends! Been a long time since I used pedestal and I&apos;m looking forward to include it again in a brand new project.
I&apos;m curious - what&apos;s the state of <a href="https://github.com/cognitect-labs/vase" target="_blank">https://github.com/cognitect-labs/vase</a> and <a href="https://github.com/cognitect-labs/pedestal.views" target="_blank">https://github.com/cognitect-labs/pedestal.views</a>? Is somebody actively using them in production?</z><z id="t1696953268" t="hlship I think the world has moved in a different direction; at this point, those libraries are inactive and unsupported and Pedestal is exclusively a server-side technology. I would look at Reagent and Re-Frame as ways to develop in ClojureScript for the client."><y>#</y><d>2023-10-10</d><h>15:54</h><w>hlship</w>I think the world has moved in a different direction; at this point, those libraries are inactive and unsupported and Pedestal is exclusively a server-side technology.  I would look at Reagent and Re-Frame as ways to develop in ClojureScript for the client.</z><z id="t1696964418" t="frankiesardo I think pedestal.views + htmx is a great combo - I&apos;m getting very passionate about it and prefer it to the new Next.js RSC directions. The hottest technology is old technology, as always 🙂"><y>#</y><d>2023-10-10</d><h>19:00</h><w>frankiesardo</w>I think pedestal.views + htmx is a great combo - I&apos;m getting very passionate about it and prefer it to the new Next.js RSC directions. The hottest technology is old technology, as always <b>🙂</b></z><z id="t1696988732" t="hlship This might be helpful: https://biffweb.com/"><y>#</y><d>2023-10-11</d><h>01:45</h><r>hlship</r>This might be helpful: <a href="https://biffweb.com/" target="_blank">https://biffweb.com/</a></z><z id="t1697005022" t="frankiesardo Yep, saw this, but I think pedestal.vase + pedestal.views + htmx is a superior stack. Anyway, I&apos;ll give it a shot, thanks!"><y>#</y><d>2023-10-11</d><h>06:17</h><r>frankiesardo</r>Yep, saw this, but I think pedestal.vase + pedestal.views + htmx is a superior stack. Anyway, I&apos;ll give it a shot, thanks!</z><z id="t1697232071" t="hlship In case it sounds a little quiet here: I&apos;m putting our documentation into good order before taking on more complicated things. Documentation is moving from the pedestal-docs repo into the main pedestal repo (so that documentation and code can be side-by-side) and I&apos;m switching over to Antora for the build (so that we can publish multiple versions of the documentation, linked to different branches). You can watch the progress in this branch: https://github.com/pedestal/pedestal/commits/hls/antora-docs-0.7"><y>#</y><d>2023-10-13</d><h>21:21</h><w>hlship</w>In case it sounds a little quiet here:  I&apos;m putting our documentation into good order before taking on more complicated things.  Documentation is moving from the pedestal-docs repo into the main pedestal repo (so that documentation and code can be side-by-side) and I&apos;m switching over to Antora for the build (so that we can publish multiple versions of the documentation, linked to different branches).  You can watch the progress in this branch: <a href="https://github.com/pedestal/pedestal/commits/hls/antora-docs-0.7" target="_blank">https://github.com/pedestal/pedestal/commits/hls/antora-docs-0.7</a></z><z id="t1697673672" t="hlship Here&apos;s a preview of the new documentation: http://pedestal.io/antora/pedestal/0.7-pre/index.html"><y>#</y><d>2023-10-19</d><h>00:01</h><w>hlship</w>Here&apos;s a preview of the new documentation: <a href="http://pedestal.io/antora/pedestal/0.7-pre/index.html" target="_blank">http://pedestal.io/antora/pedestal/0.7-pre/index.html</a></z><z id="t1697711042" t="souenzzo those line numbers are wired"><y>#</y><d>2023-10-19</d><h>10:24</h><r>souenzzo</r>those line numbers are wired</z><z id="t1697711055" t="souenzzo 1,2,3 1,2 1,2 .."><y>#</y><d>2023-10-19</d><h>10:24</h><r>souenzzo</r>1,2,3 1,2 1,2 ..</z><z id="t1697711280" t="souenzzo In http://pedestal.io/antora/pedestal/0.7-pre/guides/hello-world-query-parameters.html#_the_request_map After &gt; With the update code live, you can use curl again to see the change in the service’s behavior: There is two curl&apos;s responses in the block the first one is wrong."><y>#</y><d>2023-10-19</d><h>10:28</h><r>souenzzo</r>In
<a href="http://pedestal.io/antora/pedestal/0.7-pre/guides/hello-world-query-parameters.html#_the_request_map" target="_blank">http://pedestal.io/antora/pedestal/0.7-pre/guides/hello-world-query-parameters.html#_the_request_map</a>
After
&gt; With the update code live, you can use curl again to see the change in the service’s behavior:
There is two curl&apos;s responses in the block
the first one is wrong.</z><z id="t1697754676" t="hlship Those are callouts, used as we introduce each little bit, and when we do the &quot;whole shebang&quot; we need to find a way to hide them."><y>#</y><d>2023-10-19</d><h>22:31</h><r>hlship</r>Those are callouts, used as we introduce each little bit, and when we do the &quot;whole shebang&quot; we need to find a way to hide them.</z><z id="t1697754878" t="hlship I fixed the curl part."><y>#</y><d>2023-10-19</d><h>22:34</h><r>hlship</r>I fixed the curl part.</z><z id="t1697755182" t="hlship And the fix is live."><y>#</y><d>2023-10-19</d><h>22:39</h><r>hlship</r>And the fix is live.</z><z id="t1697755194" t="hlship Thanks for looking!"><y>#</y><d>2023-10-19</d><h>22:39</h><r>hlship</r>Thanks for looking!</z><z id="t1698357868" t="hlship That&apos;s ugly! The latest iteration gets rid of the &quot;Getting Started&quot; button, at least for the moment."><y>#</y><d>2023-10-26</d><h>22:04</h><r>hlship</r>That&apos;s ugly!  The latest iteration gets rid of the &quot;Getting Started&quot; button, at least for the moment.</z><z id="t1697755290" t="hlship I think the new Antora-based documentation will be easier with people to work with; I found jBake to be a bit cranky and hard to setup. I hope this will spur people to provide documentation PRs."><y>#</y><d>2023-10-19</d><h>22:41</h><w>hlship</w>I think the new Antora-based documentation will be easier with people to work with; I found jBake to be a bit cranky and hard to setup.  I hope this will spur people to provide documentation PRs.</z><z id="t1697755321" t="hlship Antora is very fast, once you do the initial setup, it takes maybe a second to generate a local copy of the Pedestal site. Near real-time feedback makes it much easier to do the tough work of writing documentation."><y>#</y><d>2023-10-19</d><h>22:42</h><w>hlship</w>Antora is very fast, once you do the initial setup, it takes maybe a second to generate a local copy of the Pedestal site. Near real-time feedback makes it much easier to do the tough work of writing documentation.</z><z id="t1698065265" t="simongray I would like all my routes to support a trailing slash too. Do any of you have a plug-and-play solution for that? Other than duplicating every route."><y>#</y><d>2023-10-23</d><h>12:47</h><w>simongray</w>I would like all my routes to support a trailing slash too. Do any of you have a plug-and-play solution for that? Other than duplicating every route.</z><z id="t1698076749" t="hlship You could have an interceptor examine and modify the :uri request key, to strip off a trailing slash if present."><y>#</y><d>2023-10-23</d><h>15:59</h><r>hlship</r>You could have an interceptor examine and modify the :uri request key, to strip off a trailing slash if present.</z><z id="t1698131179" t="simongray yeah, I thought that might be the way to go too. Thanks!"><y>#</y><d>2023-10-24</d><h>07:06</h><r>simongray</r>yeah, I thought that might be the way to go too. Thanks!</z><z id="t1698539583" t="souenzzo Hello [:attrs {:href &quot;/_/_/users/U04VDKC4G&quot;}] , me again studying #C0K65B20P https://github.com/pedestal/pedestal.ions/blob/0.1.3/src/io/pedestal/ions.clj#L162 , from pedestal ions, returns a function (a ring handler) If we use the ion-provider in a pedestal https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L176 and call https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L26 , it will return a https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L59-L65 Ok, I know that pedestal.ions don&apos;t have a server But inside https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L453 we call server function in the return of create-provider So: • create-provider should return a service-map , not a function as pedestal.ions does (bug in pedestal.ions)"><y>#</y><d>2023-10-29</d><h>00:33</h><w>souenzzo</w>Hello <a>@hlship</a>, me again  studying #C0K65B20P
<a href="https://github.com/pedestal/pedestal.ions/blob/0.1.3/src/io/pedestal/ions.clj#L162" target="_blank">https://github.com/pedestal/pedestal.ions/blob/0.1.3/src/io/pedestal/ions.clj#L162</a>, from pedestal ions, returns a function (a ring handler)

If we use the ion-provider in a pedestal <a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L176" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/service.clj#L176</a> and call <a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L26" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L26</a>, it will return a <a href="https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L59-L65" target="_blank">https://github.com/pedestal/pedestal-ions-sample/blob/master/src/ion_sample/ion.clj#L59-L65</a>


Ok, I know that pedestal.ions don&apos;t have a server

But inside <a href="https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L453" target="_blank">https://github.com/pedestal/pedestal/blob/master/service/src/io/pedestal/http.clj#L453</a> we call <code>server</code> function in the return of <code>create-provider</code>

So:
• <code>create-provider</code> should return a <code>service-map</code>, not a <code>function</code> as <code>pedestal.ions</code> does (bug in pedestal.ions)</z><z id="t1698817585" t="hlship That is wuite possible. I don’t have any experience with Ions so rhis might be a challenge to sort out. "><y>#</y><d>2023-11-01</d><h>05:46</h><r>hlship</r>That is wuite possible. I don’t have any experience with Ions so rhis might be a challenge to sort out. </z><z id="t1698831475" t="souenzzo I was using pedestal.ions as a reference to know &quot;best practices on implementing a custom provider&quot;"><y>#</y><d>2023-11-01</d><h>09:37</h><r>souenzzo</r>I was using <code>pedestal.ions</code> as a reference to know &quot;best practices on implementing a custom provider&quot;</z><z id="t1698877674" t="hlship The updated documentation is now up at http://pedestal.io ."><y>#</y><d>2023-11-01</d><h>22:27</h><w>hlship</w>The updated documentation is now up at <a href="http://pedestal.io" target="_blank">http://pedestal.io</a>.</z><z id="t1698939731" t="richiardiandrea It looks way better, good job!"><y>#</y><d>2023-11-02</d><h>15:42</h><r>richiardiandrea</r>It looks way better, good job!</z><z id="t1698940920" t="hlship I&apos;m very happy with the results myself."><y>#</y><d>2023-11-02</d><h>16:02</h><r>hlship</r>I&apos;m very happy with the results myself.</z><z id="t1699229150" t="Patrix looks great!"><y>#</y><d>2023-11-06</d><h>00:05</h><r>Patrix</r>looks great!</z><z id="t1699966199" t="amorokh hi, is there any work being done regarding the CVEs mentioned in https://github.com/pedestal/pedestal/issues/763 ? is there something I can do to help?"><y>#</y><d>2023-11-14</d><h>12:49</h><w>amorokh</w>hi, is there any work being done regarding the CVEs mentioned in <a href="https://github.com/pedestal/pedestal/issues/763" target="_blank">https://github.com/pedestal/pedestal/issues/763</a> ? is there something I can do to help?</z><z id="t1699966489" t="vemv (non-maintainer here - I only got a notification because I contribute to nvd-clojure itself) A good way in which you can contribute (and actually avoid the issue for you) is bumping those transitive deps in your specific project, and verify that everything keeps working Breaking changes are somewhat more frequent in the Java world, so I&apos;d recommend a cautious QA round. Surely the maintainers would appreciate a PR / experience report afterwards."><y>#</y><d>2023-11-14</d><h>12:54</h><r>vemv</r>(non-maintainer here - I only got a notification because I contribute to nvd-clojure itself)

A good way in which you can contribute (and actually avoid the issue for you) is bumping those transitive deps in your specific project, and verify that everything keeps working

Breaking changes are somewhat more frequent in the Java world, so I&apos;d recommend a cautious QA round.

Surely the maintainers would appreciate a PR / experience report afterwards.</z><z id="t1699966900" t="amorokh actually currently doing just that 🙂"><y>#</y><d>2023-11-14</d><h>13:01</h><r>amorokh</r>actually currently doing just that <b>🙂</b></z><z id="t1700079817" t="Kelvin Hello, I was the person who opened this issue. We regularly do what [:attrs {:href &quot;/_/_/users/U45T93RA6&quot;}] described - bump the transitive Jetty deps in our downstream apps and verifying that our apps still work. That said, in this case we stuck with the newest Jetty 9.x.x versions, while Pedestal has been updated to use Jetty 11.x.x, so we will have to do further testing when we update Jetty to 11."><y>#</y><d>2023-11-15</d><h>20:23</h><r>Kelvin</r>Hello, I was the person who opened this issue. We regularly do what <a>@U45T93RA6</a> described - bump the transitive Jetty deps in our downstream apps and verifying that our apps still work. That said, in this case we stuck with the newest Jetty 9.x.x versions, while Pedestal has been updated to use Jetty 11.x.x, so we will have to do further testing when we update Jetty to 11.</z><z id="t1700267628" t="hlship Verifying is appreciated; generally, we bump the Jetty dependency and check that our tests pass. Ideally, I&apos;d deploy it out to a few thousand NuBank servers just to be sure ... but that&apos;s a bit of a challenge for internal reasons. I generally trust Jetty, they&apos;re old pros at this kind of thing, but a verification by other parties, in production, is always welcome."><y>#</y><d>2023-11-18</d><h>00:33</h><r>hlship</r>Verifying is appreciated; generally, we bump the Jetty dependency and check that our tests pass. Ideally, I&apos;d deploy it out to a few thousand NuBank servers just to be sure ... but that&apos;s a bit of a challenge for internal reasons. I generally trust Jetty, they&apos;re old pros at this kind of thing, but a verification by other parties, in production, is always welcome.</z><z id="t1700300811" t="amorokh many thanks, I will update and try it out in our product! however, we have not yet released to end-customer so will only be able to verify in preview, dev and test-environments"><y>#</y><d>2023-11-18</d><h>09:46</h><r>amorokh</r>many thanks, I will update and try it out in our product! however, we have not yet released to end-customer so will only be able to verify in preview, dev and test-environments</z><z id="t1699980193" t="hlship We should be able to get a 0.6.x maintenance release out with a fix; we&apos;re currently working on Pedestal 0.7, which is based on Jetty 11."><y>#</y><d>2023-11-14</d><h>16:43</h><w>hlship</w>We should be able to get a 0.6.x maintenance release out with a fix; we&apos;re currently working on Pedestal 0.7, which is based on Jetty 11.</z></g></div></body>