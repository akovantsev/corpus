<!DOCTYPE html>
<head><title>test-check</title><meta charset="UTF-8" /><style type="text/css">body {
    font-family: Monaco, Menlo, Consolas, "Courier New", sans-serif;
    font-size: 12px;
    margin: 15px;
}
h2 {text-align: center}
pre,
code {
    font-family: Monaco, Menlo, Consolas, "Courier New", monospace;
    color: #333;
    line-break: anywhere;
}
a {
    line-break: anywhere;
}
code {
    /*line-height: 1.2;*/
    white-space: normal;
    color: #c25;
    background-color: #f7f7f9;
    border: 1px solid #e1e1e8;
}
pre {
    margin: .5rem 0 .2rem;
    font-size: .75rem;
    /*line-height: 1.15rem;*/
    background: #fbfaf8;
    padding: .5rem;
    word-break: normal;
    display: block;
    border: 1px solid rgba(0, 0, 0, .15);
    white-space: pre-wrap;
    word-wrap: break-word;
    border-radius: 4px;
}
/*span {*/
z {
    white-space: pre-wrap;
}

d {padding-right: 8px;}
h {padding-right: 16px;}

w, r {
    margin-right: 10px;
    padding-right: 8px;
    text-align: right;
}

d,h,w,r {
    background-color: lavender;
    margin-top: 1px;
    display: inline-table; /* prevents doubleclick selection spillover into neighbour elements */
}

h:hover,
d:hover {
    text-decoration: underline;
    color: blue;
    cursor: row-resize;
}
d {padding-right: 8px;}
h {padding-right: 16px;}

z {display: block;}

z:target > r,
z:target > w,
z:target > d,
z:target > h {
    background-color: aquamarine
}

#filters-container {
    position: fixed;
    left: 50px;
    z-index: 1;
}
#filters-container > input {
    /*column:*/
    display: block;
    outline-color: aquamarine;
}

y {
    cursor: pointer;
    text-decoration: none;
    color: blue;
    position: absolute;
    left: 3px;
}

y:hover {
    text-decoration: underline;
    color: aquamarine;
}


</style></head><body><style id="css-username">w {min-width: 208px;} r {min-width: 240px;}</style><style id="css-text-filter"></style><style id="css-date-filter"></style><style id="css-filter-override"></style><p id="filters-container"><input id="text-filter" onkeyup="debtextfilter(this.value)" placeholder="filter text" type="string" /><button hidden="hidden" id="date-filter" onclick="cleardatefilter()"></button></p><h2>#test-check</h2><pre><i>generated UTC: 2023-11-22 19:44</i><i>
latest data: <a href="https://clojurians-log.clojureverse.org/test-check/2023-09-02">https://clojurians-log.clojureverse.org/test-check/2023-09-02</a></i><i>
messages: 2986</i>
pro tips:
* Double click on text to filter by it. (doubleclick + cmd-f for extra points).
* Click on date to keep day visible regardless of filter.
* Click on time to keep hour visible regardless of filter.</pre><script>const textFilterInput = document.getElementById("text-filter");
const dateFilterInput = document.getElementById("date-filter");
const filterTextStyle = document.getElementById("css-text-filter");
const filterDateStyle = document.getElementById("css-date-filter");
const filterStyleOverride = document.getElementById("css-filter-override");



function textFilter2(text) {
    var style = '';
    if (text.trim() !== '') {
        text.split(' ').forEach(function (t) {
            if (t !== '') {
                style = style + "z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
            }
        });
    }
    filterTextStyle.innerHTML = style;
}
function textFilter(text) {
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (s){
            var sid = s.getAttribute("id");
            text.split(' ').forEach(function (t) {
                if (t !== '') {
                    filterTextStyle.innerHTML += "\ng#" + sid + " > z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
                }
            });
        })
    }
}
function textFilter3(text) {
    console.time("text search");
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        const re = new RegExp( text, "i");
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (w){
            var zs = w.getElementsByTagName ("z");
            var zsArr = Array.prototype.slice.call(zs);
            var ids = zsArr
                .filter(function (el) {
                    return !re.test(el.innerText);
                })
                .map(function (el){
                    return el.getAttribute("id");
                });
            if (ids) {
                filterTextStyle.innerHTML += "\n#" + ids.join(",#") + " {display: none; opacity: 0.6}";
            }
        })
    }
    console.timeEnd("text search");
}


function filterSelection (e) {
    let sel = document.getSelection();
    let txt = sel.toString();
    textFilterInput.value = (txt || "");
    textFilter(txt);
}
function debounce1(callback, delay) {
    let timeout;
    return function(arg) {
        clearTimeout(timeout);
        timeout = setTimeout(callback, delay, arg);
    }
}

function keyUp (e) {
    if (e.code === "KeyF" && e.ctrlKey) {
        let txt = document.getSelection().toString();
        if (txt.length > 0) {
            textFilterInput.value = (txt || "");
            textFilter(txt);
        }
    }
}


function showDateTimes (el, datestr, hourstr) {
    dateFilterInput.innerText = "clear: " + datestr + " " + hourstr;
    dateFilterInput.hidden = false;
    let ids = [];
    const clicked = el.parentElement;  // el = z#id/t
    ids.push(clicked.id);
    // var idbefore, idafter;
    let cursor = clicked;
    function nextCursor (cursor) {
        const id = (cursor && cursor.id);
        const d = (cursor && cursor.children[1]);
        const h = (cursor && cursor.children[2])
        if (id) {
            ids.push(id); //includes 1st next-id not matching date.
        } else {
            cursor = null;
        }
        if (d && (d.textContent === datestr) && (!hourstr || (h && h.textContent.startsWith(hourstr)))) {
        } else {
            cursor = null;
        }
        return cursor;
    }
    while (cursor) {
        cursor = nextCursor(cursor.previousElementSibling);
    }

    cursor = clicked;

    while (cursor) {
        cursor = nextCursor(cursor.nextElementSibling);
    }


    var style1 = '';
    var style2 = '';
    var content;
    if (datestr.includes(" ")) { //hour
        content = " *";
    } else {
        content = "**";
    }
    ids.forEach(function (id) {
        if (id) {
            style1 = style1 + ", #" + id;
            style2 = style2 + ", #" + id + " h:after";
        }
    })
    if (style1) {
        style1 = style1.substring(1) + " {display: block !important}";
    }
    if (style2) {
        style2 = style2.substring(1) + " {content: \"" + content + "\"; position: absolute}"
    }
    filterDateStyle.innerHTML = style1 + "\n" + style2;
}

// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView
function filterDay (el) {
    showDateTimes(el, el.textContent);
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function filterHours (el) {
    showDateTimes(el, el.previousElementSibling.textContent, el.textContent.substring(0, 2));
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function forceShowSelected (el) {
    var id = el.parentElement.id
    if (id) {
        window.location.hash = "#" + id;
        filterStyleOverride.innerHTML = ""
            + "#" + id
            + " {display: block !important;}"
            + "#" + id + " h:after"
            + " {content: \"  #\"; position: absolute}";

    } else {
        window.location.hash = "";
        filterStyleOverride.innerHTML = "";
    }
}


function cleardatefilter () {
    dateFilterInput.hidden = true;
    dateFilterInput.innerText = "";
    filterDateStyle.innerHTML = "";
}

const debtextfilter = debounce1(textFilter, 200);

function doubleClick (e) {
    if (e.target.tagName !== "INPUT"
        && e.target.tagName !== "D"
        && e.target.tagName !== "H") {

        filterSelection();
        e.target.scrollIntoView({behavior: "auto", block: "center", inline: "start"});
    }
}

function onclick(e) {
    if (e.target.tagName === "Y") {
        e.preventDefault();
        forceShowSelected(e.target);
    } else if (e.target.tagName === "D") {
        e.preventDefault();
        filterDay(e.target);
    } else if (e.target.tagName === "H") {
        e.preventDefault();
        filterHours(e.target);
    }
}

document.onclick = onclick;
document.ondblclick = doubleClick;
document.onkeyup = keyUp;
textFilterInput.focus();
</script><div><g id="s0"><z id="t1454010239" t="paulspencerwilliams Hi all."><y>#</y><d>2016-01-28</d><h>19:43</h><w>paulspencerwilliams</w>Hi all.</z><z id="t1454050299" t="lucasbradstreet Howdy"><y>#</y><d>2016-01-29</d><h>06:51</h><w>lucasbradstreet</w>Howdy</z><z id="t1454055121" t="paulspencerwilliams Hi [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] ."><y>#</y><d>2016-01-29</d><h>08:12</h><w>paulspencerwilliams</w>Hi <a>@lucasbradstreet</a>.</z><z id="t1454056270" t="paulspencerwilliams So I was hoping to get some advice about the properties I could test for the convert function found at https://github.com/paulspencerwilliams/gormanic/blob/master/src/gormanic/core.clj"><y>#</y><d>2016-01-29</d><h>08:31</h><w>paulspencerwilliams</w>So I was hoping to get some advice about the properties I could test for the convert function found at <a href="https://github.com/paulspencerwilliams/gormanic/blob/master/src/gormanic/core.clj" target="_blank">https://github.com/paulspencerwilliams/gormanic/blob/master/src/gormanic/core.clj</a></z><z id="t1454056713" t="lucasbradstreet testing the string generated by convert will be a bit annoying"><y>#</y><d>2016-01-29</d><h>08:38</h><w>lucasbradstreet</w>testing the string generated by convert will be a bit annoying</z><z id="t1454056718" t="lucasbradstreet but you could test the functions that it uses"><y>#</y><d>2016-01-29</d><h>08:38</h><w>lucasbradstreet</w>but you could test the functions that it uses</z><z id="t1454056737" t="lucasbradstreet some easy ones, do any of them return a negative month, day, year"><y>#</y><d>2016-01-29</d><h>08:38</h><w>lucasbradstreet</w>some easy ones, do any of them return a negative month, day, year</z><z id="t1454056757" t="lucasbradstreet or a month larger than 12 (or 11 if 0 indexed), day greater than 31, tec"><y>#</y><d>2016-01-29</d><h>08:39</h><w>lucasbradstreet</w>or a month larger than 12 (or 11 if 0 indexed), day greater than 31, tec</z><z id="t1454056758" t="lucasbradstreet etc"><y>#</y><d>2016-01-29</d><h>08:39</h><w>lucasbradstreet</w>etc</z><z id="t1454056881" t="paulspencerwilliams okay."><y>#</y><d>2016-01-29</d><h>08:41</h><w>paulspencerwilliams</w>okay.</z><z id="t1454056959" t="paulspencerwilliams I understand testing the boundaries aren’t crossed like you mentioned. If I returning a map rather than string, with day, month and year keys, it would be easier to ‘parse’ and thus test. Would quickcheck style testing help then?"><y>#</y><d>2016-01-29</d><h>08:42</h><w>paulspencerwilliams</w>I understand testing the boundaries aren’t crossed like you mentioned. If I returning a map rather than string, with day, month and year keys, it would be easier to ‘parse’ and thus test. Would quickcheck style testing help then?</z><z id="t1454057067" t="paulspencerwilliams Would I use it to test the function actually returns the correct resultant date? I was thinking that I would have to model the gormanic calendar in the test, and for a random set of input dates, ensure convert would return the appropriate gormanic date. But this would be in effect duplicating SUT code in the test?"><y>#</y><d>2016-01-29</d><h>08:44</h><w>paulspencerwilliams</w>Would I use it to test the function actually returns the correct resultant date? I was thinking that I would have to model the gormanic calendar in the test, and for a random set of input dates, ensure convert would return the appropriate gormanic date. But this would be in effect duplicating SUT code in the test?</z><z id="t1454057139" t="paulspencerwilliams Apologies, if I’ve asked a common question, I’ve watched a few videos etc but many properties seem abstract, or away from the concrete problem if that makes sense?"><y>#</y><d>2016-01-29</d><h>08:45</h><w>paulspencerwilliams</w>Apologies, if I’ve asked a common question, I’ve watched a few videos etc but many properties seem abstract, or away from the concrete problem if that makes sense?</z><z id="t1454057297" t="lucasbradstreet Yeah, a map definitely seems easier"><y>#</y><d>2016-01-29</d><h>08:48</h><w>lucasbradstreet</w>Yeah, a map definitely seems easier</z><z id="t1454057361" t="lucasbradstreet I don’t know enough about the gormanic calender to provide some good properties there 😕"><y>#</y><d>2016-01-29</d><h>08:49</h><w>lucasbradstreet</w>I don’t know enough about the gormanic calender to provide some good properties there <b>😕</b></z><z id="t1454057456" t="lucasbradstreet The wikipedia page isn’t all that much help, heh"><y>#</y><d>2016-01-29</d><h>08:50</h><w>lucasbradstreet</w>The wikipedia page isn’t all that much help, heh</z><z id="t1454057718" t="lucasbradstreet One idea is if you could provide a comparator function for both date types, and make sure that if one random date is greater than another random date in the gregorian calender, then it’s also greater in the calculated gormanic calender date."><y>#</y><d>2016-01-29</d><h>08:55</h><w>lucasbradstreet</w>One idea is if you could provide a comparator function for both date types, and make sure that if one random date is greater than another random date in the gregorian calender, then it’s also greater in the calculated gormanic calender date.</z><z id="t1454057893" t="paulspencerwilliams hehe, oh sorry, the gormanic calendar is made up for a kata. okay, I need to think about your idea for the comparator function. If I developed one, would you not simply say that for all inputs, the output compares exactly to the input?"><y>#</y><d>2016-01-29</d><h>08:58</h><w>paulspencerwilliams</w>hehe, oh sorry, the gormanic calendar is made up for a kata. okay, I need to think about your idea for the comparator function. If I developed one, would you not simply say that for all inputs, the output compares exactly to the input?</z><z id="t1454057917" t="lucasbradstreet Exactly"><y>#</y><d>2016-01-29</d><h>08:58</h><w>lucasbradstreet</w>Exactly</z><z id="t1454058007" t="paulspencerwilliams okay. Cheers, let me think about that and I’ll have a play."><y>#</y><d>2016-01-29</d><h>09:00</h><w>paulspencerwilliams</w>okay. Cheers, let me think about that and I’ll have a play.</z><z id="t1455005722" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U064B4L0K&quot;}] : what solution did you end up with, and were you satisfied with the result?"><y>#</y><d>2016-02-09</d><h>08:15</h><w>lucasbradstreet</w><a>@paulspencerwilliams</a>: what solution did you end up with, and were you satisfied with the result?</z><z id="t1455006049" t="paulspencerwilliams Hi [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] , in the end, I used a combination of roundtripping tests for majority of coverage backed by example based tests for confidence. I will reduce these examples to a couple when I get back to tidying the code. I promised a blog post, and one is in draft although it maybe the weekend before I get chance to revisit it but I really enjoyed the exercise. Satified? I&apos;m not sure, I liked the example based backups atm, but I think that will dissappear as I start to explore more. I can imagine using test.check more as I move my workflow from TDD, to repl driven. https://github.com/paulspencerwilliams/gormanic/blob/master/test/gormanic/core_test.clj"><y>#</y><d>2016-02-09</d><h>08:20</h><w>paulspencerwilliams</w>Hi <a>@lucasbradstreet</a>, in the end, I used a combination of roundtripping tests for majority of coverage backed by example based tests for confidence. I will reduce these examples to a couple when I get back to tidying the code. I promised a blog post, and one is in draft although it maybe the weekend before I get chance to revisit it but I really enjoyed the exercise.  Satified? I&apos;m not sure, I liked the example based backups atm, but I think that will dissappear as I start to explore more. I can imagine using test.check more as I move my workflow from TDD, to repl driven. 
 <a href="https://github.com/paulspencerwilliams/gormanic/blob/master/test/gormanic/core_test.clj" target="_blank">https://github.com/paulspencerwilliams/gormanic/blob/master/test/gormanic/core_test.clj</a></z><z id="t1455006129" t="lucasbradstreet Cool. Was curious "><y>#</y><d>2016-02-09</d><h>08:22</h><w>lucasbradstreet</w> Cool. Was curious </z><z id="t1455006144" t="lucasbradstreet I usually pepper in a few example based tests as a sanity check"><y>#</y><d>2016-02-09</d><h>08:22</h><w>lucasbradstreet</w>I usually pepper in a few example based tests as a sanity check</z><z id="t1462887460" t="lucasbradstreet Good article on different types of properties https://fsharpforfunandprofit.com/posts/property-based-testing-2/"><y>#</y><d>2016-05-10</d><h>13:37</h><w>lucasbradstreet</w>Good article on different types of properties <a href="https://fsharpforfunandprofit.com/posts/property-based-testing-2/" target="_blank">https://fsharpforfunandprofit.com/posts/property-based-testing-2/</a></z><z id="t1464657935" t="lgastako Is there an idiomatic way to test that a function returns nil when given any value of any type other than the expected type? Or in general to generate something like “any value of any type exception this one”?"><y>#</y><d>2016-05-31</d><h>01:25</h><w>lgastako</w>Is there an idiomatic way to test that a function returns nil when given any value of any type other than the expected type? Or in general to generate something like “any value of any type exception this one”?</z><z id="t1464680656" t="lucasbradstreet lgastako: you can feed it gen/any, but it’ll be limited in the types that it can emit and you’d still need to test whether it sometimes returns a value when given the correct type. It doesn’t feel like the sort of thing I’d property test though."><y>#</y><d>2016-05-31</d><h>07:44</h><w>lucasbradstreet</w>lgastako: you can feed it gen/any, but it’ll be limited in the types that it can emit and you’d still need to test whether it sometimes returns a value when given the correct type. It doesn’t feel like the sort of thing I’d property test though.</z><z id="t1465393875" t="wilkerlucio hello"><y>#</y><d>2016-06-08</d><h>13:51</h><w>wilkerlucio</w>hello</z><z id="t1465393898" t="wilkerlucio is it possible to run async code into a (props/for-all) ?"><y>#</y><d>2016-06-08</d><h>13:51</h><w>wilkerlucio</w>is it possible to run async code into a <code>(props/for-all)</code>?</z><z id="t1465393914" t="wilkerlucio I would like to test some cljs code that requires to be async, any ideas on how to do that?"><y>#</y><d>2016-06-08</d><h>13:51</h><w>wilkerlucio</w>I would like to test some cljs code that requires to be async, any ideas on how to do that?</z><z id="t1465394494" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U066U8JQJ&quot;}] : I’ve used property testing with core.async before. The only real way I could figure out to do it to make sure that there’s some kind of terminator on the channel (this could be that the channel was closed), and that you’ve hit it. You could also add a big enough sleep to make sure that everything should have finished, but that’s super hacky and will limit how many examples you can run in a given time"><y>#</y><d>2016-06-08</d><h>14:01</h><w>lucasbradstreet</w><a>@wilkerlucio</a>: I’ve used property testing with core.async before. The only real way I could figure out to do it to make sure that there’s some kind of terminator on the channel (this could be that the channel was closed), and that you’ve hit it. You could also add a big enough sleep to make sure that everything should have finished, but that’s super hacky and will limit how many examples you can run in a given time</z><z id="t1465394674" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U066U8JQJ&quot;}] : you may also find https://github.com/czan/stateful-check helpful"><y>#</y><d>2016-06-08</d><h>14:04</h><w>lucasbradstreet</w><a>@wilkerlucio</a>: you may also find <a href="https://github.com/czan/stateful-check" target="_blank">https://github.com/czan/stateful-check</a> helpful</z><z id="t1465394777" t="wilkerlucio hi Lucas, sorry, I didn&apos;t understand the idea you told me to use core.async, can you show me a code example of it please?"><y>#</y><d>2016-06-08</d><h>14:06</h><w>wilkerlucio</w>hi Lucas, sorry, I didn&apos;t understand the idea you told me to use core.async, can you show me a code example of it please?</z><z id="t1465394880" t="lucasbradstreet Sorry, I don’t really have an example handy. It really depends on what you’re trying to do"><y>#</y><d>2016-06-08</d><h>14:08</h><w>lucasbradstreet</w>Sorry, I don’t really have an example handy. It really depends on what you’re trying to do</z><z id="t1465397554" t="wilkerlucio thats fine, on my case I don&apos;t really need the for-all, I&apos;m doing ok just sampling and testing from it, thanks for the assistance"><y>#</y><d>2016-06-08</d><h>14:52</h><w>wilkerlucio</w>thats fine, on my case I don&apos;t really need the for-all, I&apos;m doing ok just sampling and testing from it, thanks for the assistance</z><z id="t1465412003" t="gfredericks lucasbradstreet: &quot;big enough sleep&quot; ⇐ are you talking about clj-jvm instead of cljs?"><y>#</y><d>2016-06-08</d><h>18:53</h><w>gfredericks</w>lucasbradstreet: &quot;big enough sleep&quot; ⇐ are you talking about clj-jvm instead of cljs?</z><z id="t1465412022" t="gfredericks wilkerlucio: I was just wondering about async tests myself like two days ago; I think you&apos;d need a separate test runner"><y>#</y><d>2016-06-08</d><h>18:53</h><w>gfredericks</w>wilkerlucio: I was just wondering about async tests myself like two days ago; I think you&apos;d need a separate test runner</z><z id="t1465412037" t="gfredericks i.e., would have to modify clojure.test.check/quick-check"><y>#</y><d>2016-06-08</d><h>18:53</h><w>gfredericks</w>i.e., would have to modify clojure.test.check/quick-check</z><z id="t1465412044" t="lucasbradstreet Oh yeah, I am"><y>#</y><d>2016-06-08</d><h>18:54</h><w>lucasbradstreet</w>Oh yeah, I am</z><z id="t1465412097" t="gfredericks wilkerlucio: you&apos;d have to rewrite quick-check to listen for results on a core.async channel I think"><y>#</y><d>2016-06-08</d><h>18:54</h><w>gfredericks</w>wilkerlucio: you&apos;d have to rewrite quick-check to listen for results on a core.async channel I think</z><z id="t1465412125" t="gfredericks it&apos;d probably be one of those &quot;quick-check returns a channel that will eventually receive the result&quot; sort of situations"><y>#</y><d>2016-06-08</d><h>18:55</h><w>gfredericks</w>it&apos;d probably be one of those &quot;quick-check returns a channel that will eventually receive the result&quot; sort of situations</z><z id="t1465412174" t="lucasbradstreet Yeah, that’s basically along the lines of what I was trying to get across"><y>#</y><d>2016-06-08</d><h>18:56</h><w>lucasbradstreet</w>Yeah, that’s basically along the lines of what I was trying to get across</z><z id="t1465412256" t="gfredericks and then would need to rewrite prop/for-all to supply a channel for the body to write to somehow, or something"><y>#</y><d>2016-06-08</d><h>18:57</h><w>gfredericks</w>and then would need to rewrite prop/for-all to supply a channel for the body to write to somehow, or something</z><z id="t1465415402" t="wilkerlucio yeah, seems a lot of fun doing it, just need some time to learn how test.check works, hehe"><y>#</y><d>2016-06-08</d><h>19:50</h><w>wilkerlucio</w>yeah, seems a lot of fun doing it, just need some time to learn how test.check works, hehe</z><z id="t1465415434" t="gfredericks I&apos;m happy to advise"><y>#</y><d>2016-06-08</d><h>19:50</h><w>gfredericks</w>I&apos;m happy to advise</z><z id="t1465494049" t="ag if I have something like this: (defn uuid-gen [] (g/return (-&gt; g/uuid g/generate str))) {:table &quot;my-table&quot; :key (uuid-gen) :rows (-&gt; (g/hash-map :id (uuid-gen) :external-reference-id g/string-alphanumeric) (g/vector 1000) g/not-empty g/generate)} how can I ensure that uuids generated for :key and :id are always unique?"><y>#</y><d>2016-06-09</d><h>17:40</h><w>ag</w>if I have something like this:
<pre>(defn uuid-gen []
  (g/return (-&gt; g/uuid g/generate str)))

{:table &quot;my-table&quot;
    :key   (uuid-gen)
    :rows  (-&gt; (g/hash-map
                 :id                    (uuid-gen)
                 :external-reference-id g/string-alphanumeric)
             (g/vector 1000) g/not-empty g/generate)}
</pre>
how can I ensure that uuids generated for <code>:key</code> and <code>:id</code> are always unique?</z><z id="t1465494344" t="ag I think I need to use something like gen/let ?"><y>#</y><d>2016-06-09</d><h>17:45</h><w>ag</w>I think I need to use something like <code>gen/let</code>?</z><z id="t1465494573" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] in cases where I wanted my uuids to be unique, and … thus uuid’y, I’ve just cheated by doing something like this: (gen/no-shrink (gen/fmap (fn [_] (java.util.UUID/randomUUID)) gen/int))"><y>#</y><d>2016-06-09</d><h>17:49</h><w>lucasbradstreet</w><a>@ag</a> in cases where I wanted my uuids to be unique, and … thus uuid’y, I’ve just cheated by doing something like this: <code>(gen/no-shrink (gen/fmap (fn [_] (java.util.UUID/randomUUID)) gen/int))</code></z><z id="t1465494614" t="lucasbradstreet the gen/int bit is especially more cheaty. There may be a nicer way to do it"><y>#</y><d>2016-06-09</d><h>17:50</h><w>lucasbradstreet</w>the gen/int bit is especially more cheaty. There may be a nicer way to do it</z><z id="t1465494698" t="ag [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] : trying that, thanks"><y>#</y><d>2016-06-09</d><h>17:51</h><w>ag</w><a>@lucasbradstreet</a>: trying that, thanks</z><z id="t1465495017" t="ag excuse my complete noob question (I’m lazy). what is shrinking?"><y>#</y><d>2016-06-09</d><h>17:56</h><w>ag</w>excuse my complete noob question (I’m lazy). what is shrinking?</z><z id="t1465495335" t="lucasbradstreet test.check will shrink down your test cases so that it can find the smallest failing case e.g. integers might shrink from 232323976 to 0, a vector might shrink from a many element vector to a small one"><y>#</y><d>2016-06-09</d><h>18:02</h><w>lucasbradstreet</w>test.check will shrink down your test cases so that it can find the smallest failing case e.g. integers might shrink from 232323976 to 0, a vector might shrink from a many element vector to a small one</z><z id="t1465495354" t="lucasbradstreet since all we’re doing is generating a UUID, and not using the int generated by gen/int, there’s no point in shrinking this case"><y>#</y><d>2016-06-09</d><h>18:02</h><w>lucasbradstreet</w>since all we’re doing is generating a UUID, and not using the int generated by gen/int, there’s no point in shrinking this case</z><z id="t1465495453" t="lucasbradstreet Oh, I can see what your problem is in that example"><y>#</y><d>2016-06-09</d><h>18:04</h><w>lucasbradstreet</w>Oh, I can see what your problem is in that example</z><z id="t1465495469" t="lucasbradstreet Hmm, maybe not"><y>#</y><d>2016-06-09</d><h>18:04</h><w>lucasbradstreet</w>Hmm, maybe not</z><z id="t1465495529" t="lucasbradstreet what you’re doing wrong is actually generating a uuid sample via g/generate"><y>#</y><d>2016-06-09</d><h>18:05</h><w>lucasbradstreet</w>what you’re doing wrong is actually generating a uuid sample via g/generate</z><z id="t1465495532" t="lucasbradstreet and then using gen/return"><y>#</y><d>2016-06-09</d><h>18:05</h><w>lucasbradstreet</w>and then using gen/return</z><z id="t1465495542" t="lucasbradstreet try (gen/fmap str gen/uuid)"><y>#</y><d>2016-06-09</d><h>18:05</h><w>lucasbradstreet</w>try (gen/fmap str gen/uuid)</z><z id="t1465495560" t="lucasbradstreet That’ll give you a uuid str generator"><y>#</y><d>2016-06-09</d><h>18:06</h><w>lucasbradstreet</w>That’ll give you a uuid str generator</z><z id="t1465495611" t="lucasbradstreet Your problem was that you were essentially going (gen/return &quot;5813d2ec-c486-4428-833d-e8373910ae14”)"><y>#</y><d>2016-06-09</d><h>18:06</h><w>lucasbradstreet</w>Your problem was that you were essentially going (gen/return &quot;5813d2ec-c486-4428-833d-e8373910ae14”)</z><z id="t1465495619" t="lucasbradstreet which will, of course, always return the same value"><y>#</y><d>2016-06-09</d><h>18:06</h><w>lucasbradstreet</w>which will, of course, always return the same value</z><z id="t1465495754" t="ag Thank you for enabling my laziness and explaining in great detail 🙂"><y>#</y><d>2016-06-09</d><h>18:09</h><w>ag</w>Thank you for enabling my laziness and explaining in great detail <b>🙂</b></z><z id="t1465495824" t="lucasbradstreet happy to help spread the love and the word of the church of property test"><y>#</y><d>2016-06-09</d><h>18:10</h><w>lucasbradstreet</w>happy to help spread the love and the word of the church of property test</z><z id="t1465496881" t="gfredericks ag: lucasbradstreet: this might not be in the docstring but gen/uuid generates unique uuids"><y>#</y><d>2016-06-09</d><h>18:28</h><w>gfredericks</w>ag: lucasbradstreet: this might not be in the docstring but gen/uuid generates unique uuids</z><z id="t1465496910" t="gfredericks it&apos;s sort of in the docstring. It could be more clear."><y>#</y><d>2016-06-09</d><h>18:28</h><w>gfredericks</w>it&apos;s sort of in the docstring. It could be more clear.</z><z id="t1465496972" t="ag [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : yeah I think I’m doing something totally wacky here… no one to blame but myself."><y>#</y><d>2016-06-09</d><h>18:29</h><w>ag</w><a>@gfredericks</a>: yeah I think I’m doing something totally wacky here… no one to blame but myself.</z><z id="t1465496977" t="ag still learning"><y>#</y><d>2016-06-09</d><h>18:29</h><w>ag</w>still learning</z><z id="t1465497590" t="lucasbradstreet Yeah. I realised this which is why I investigated why the original solution didn&apos;t work. Thanks for saying that "><y>#</y><d>2016-06-09</d><h>18:39</h><w>lucasbradstreet</w>Yeah. I realised this which is why I investigated why the original solution didn&apos;t work. Thanks for saying that  </z><z id="t1465497668" t="gfredericks I should also add things to the docstring for generate saying it&apos;s just a dev tool"><y>#</y><d>2016-06-09</d><h>18:41</h><w>gfredericks</w>I should also add things to the docstring for generate saying it&apos;s just a dev tool</z><z id="t1465497671" t="gfredericks ag: ⇑"><y>#</y><d>2016-06-09</d><h>18:41</h><w>gfredericks</w>ag: ⇑</z><z id="t1465497696" t="gfredericks I bet people use it for real generators more often than I was expecting"><y>#</y><d>2016-06-09</d><h>18:41</h><w>gfredericks</w>I bet people use it for real generators more often than I was expecting</z><z id="t1465497741" t="lucasbradstreet The improved suggestion will be more reproducible than the one that I suggested. The original one will give different results when you use the same seed"><y>#</y><d>2016-06-09</d><h>18:42</h><w>lucasbradstreet</w>The improved suggestion will be more reproducible than the one that I suggested. The original one will give different results when you use the same seed</z><z id="t1465497791" t="lucasbradstreet It&apos;s easy enough to do starting out. Try some stuff out, and then you need a generator again so you go and stick it into return or elements without realising "><y>#</y><d>2016-06-09</d><h>18:43</h><w>lucasbradstreet</w>It&apos;s easy enough to do starting out. Try some stuff out, and then you need a generator again so you go and stick it into return or elements without realising </z><z id="t1465497808" t="gfredericks yeah :/"><y>#</y><d>2016-06-09</d><h>18:43</h><w>gfredericks</w>yeah :/</z><z id="t1465497841" t="lucasbradstreet gen/sample does sound more devvy than gen/generate. I could see how people could get confused there"><y>#</y><d>2016-06-09</d><h>18:44</h><w>lucasbradstreet</w>gen/sample does sound more devvy than gen/generate. I could see how people could get confused there</z><z id="t1465497889" t="lucasbradstreet A docstring note would be good anyway"><y>#</y><d>2016-06-09</d><h>18:44</h><w>lucasbradstreet</w>A docstring note would be good anyway</z><z id="t1465497909" t="gfredericks yeah, probably on both of them"><y>#</y><d>2016-06-09</d><h>18:45</h><w>gfredericks</w>yeah, probably on both of them</z><z id="t1469224751" t="zane Why is clojure.test.check.generators/make-gen private?"><y>#</y><d>2016-07-22</d><h>21:59</h><w>zane</w>Why is <code>clojure.test.check.generators/make-gen</code> private?</z><z id="t1469224759" t="zane What&apos;s the official way to make a generator from a thunk?"><y>#</y><d>2016-07-22</d><h>21:59</h><w>zane</w>What&apos;s the official way to make a generator from a thunk?</z><z id="t1469310033" t="gfredericks zane: what&apos;s the relationships between the thunk and the resulting generator?"><y>#</y><d>2016-07-23</d><h>21:40</h><w>gfredericks</w>zane: what&apos;s the relationships between the thunk and the resulting generator?</z><z id="t1469318809" t="gfredericks if you just want to write your own (fn [rnd size] ...), the reason make-gen isn&apos;t public is that in most cases doing something so low-level isn&apos;t necessary"><y>#</y><d>2016-07-24</d><h>00:06</h><w>gfredericks</w>if you just want to write your own (fn [rnd size] ...), the reason make-gen isn&apos;t public is that in most cases doing something so low-level isn&apos;t necessary</z><z id="t1469318836" t="gfredericks so I&apos;m interested in what that function is doing so I can see if there&apos;s some higher-level way to accomplish the same thing"><y>#</y><d>2016-07-24</d><h>00:07</h><w>gfredericks</w>so I&apos;m interested in what that function is doing so I can see if there&apos;s some higher-level way to accomplish the same thing</z><z id="t1469462925" t="zane [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : The thunk is literally producing the generated value. e.g. (fn [&amp; _] (java.util.UUID/randomUUID)) ."><y>#</y><d>2016-07-25</d><h>16:08</h><w>zane</w><a>@gfredericks</a>: The thunk is literally producing the generated value. e.g. <code>(fn [&amp; _] (java.util.UUID/randomUUID))</code>.</z><z id="t1469462954" t="zane I see now that make-gen doesn&apos;t take a thunk (my bad!) but I&apos;m still wondering what the right way to go about this is."><y>#</y><d>2016-07-25</d><h>16:09</h><w>zane</w>I see now that <code>make-gen</code> doesn&apos;t take a thunk (my bad!) but I&apos;m still wondering what the right way to go about this is.</z><z id="t1469463015" t="zane The best thing we could come up with was: (clojure.test.check.generators/fmap (fn [_] (java.util.UUID/randomUUID)) (clojure.test.check.generators/return nil))"><y>#</y><d>2016-07-25</d><h>16:10</h><w>zane</w>The best thing we could come up with was: <code>(clojure.test.check.generators/fmap (fn [_] (java.util.UUID/randomUUID)) (clojure.test.check.generators/return nil))</code></z><z id="t1469463025" t="zane But that obviously feels pretty gross since the work of clojure.test.check.generators/return is discarded."><y>#</y><d>2016-07-25</d><h>16:10</h><w>zane</w>But that obviously feels pretty gross since the work of <code>clojure.test.check.generators/return</code> is discarded.</z><z id="t1469463419" t="gfredericks [:attrs {:href &quot;/_/_/users/U050CT4HR&quot;}] : would gen/uuid work for you or are you doing something else?"><y>#</y><d>2016-07-25</d><h>16:16</h><w>gfredericks</w><a>@zane</a>: would gen/uuid work for you or are you doing something else?</z><z id="t1469463441" t="zane Ah, I don&apos;t think gen/uuid exists in the alpha we&apos;re using."><y>#</y><d>2016-07-25</d><h>16:17</h><w>zane</w>Ah, I don&apos;t think <code>gen/uuid</code> exists in the alpha we&apos;re using.</z><z id="t1469463461" t="zane Assuming it doesn&apos;t, what would the right workaround be?"><y>#</y><d>2016-07-25</d><h>16:17</h><w>zane</w>Assuming it doesn&apos;t, what would the right workaround be?</z><z id="t1469463488" t="zane (Maybe the answer is: Update your alpha. 😄 )"><y>#</y><d>2016-07-25</d><h>16:18</h><w>zane</w>(Maybe the answer is: Update your alpha. <b>😄</b>)</z><z id="t1469463507" t="gfredericks You could generate a collection of hex characters and use gen/fmap to convert then to a uuid"><y>#</y><d>2016-07-25</d><h>16:18</h><w>gfredericks</w>You could generate a collection of hex characters and use gen/fmap to convert then to a uuid</z><z id="t1469463551" t="zane Eek."><y>#</y><d>2016-07-25</d><h>16:19</h><w>zane</w>Eek.</z><z id="t1469463589" t="lucasbradstreet You can also generate two longs and build a uuid with it"><y>#</y><d>2016-07-25</d><h>16:19</h><w>lucasbradstreet</w>You can also generate two longs and build a uuid with it</z><z id="t1469463601" t="gfredericks In general you want to use the randomness of the framework, not calling any random functions yourself, else you lose determinism and shrinking"><y>#</y><d>2016-07-25</d><h>16:20</h><w>gfredericks</w>In general you want to use the randomness of the framework, not calling any random functions yourself, else you lose determinism and shrinking</z><z id="t1469463619" t="lucasbradstreet Ah, my strategy doesn’t ensure uniqueness"><y>#</y><d>2016-07-25</d><h>16:20</h><w>lucasbradstreet</w>Ah, my strategy doesn’t ensure uniqueness</z><z id="t1469463633" t="gfredericks Neither does mine"><y>#</y><d>2016-07-25</d><h>16:20</h><w>gfredericks</w>Neither does mine</z><z id="t1469463669" t="lucasbradstreet This is what you’d use if you don’t need uniqueness https://docs.oracle.com/javase/7/docs/api/java/util/UUID.html#UUID(long,%20long)"><y>#</y><d>2016-07-25</d><h>16:21</h><w>lucasbradstreet</w>This is what you’d use if you don’t need uniqueness <a href="https://docs.oracle.com/javase/7/docs/api/java/util/UUID.html#UUID(long,%20long)" target="_blank">https://docs.oracle.com/javase/7/docs/api/java/util/UUID.html#UUID(long,%20long)</a></z><z id="t1469463705" t="lucasbradstreet I’ve also used with-redefs to override my internal random uuid generation function, and I just generated the seed via test.check"><y>#</y><d>2016-07-25</d><h>16:21</h><w>lucasbradstreet</w>I’ve also used with-redefs to override my internal random uuid generation function, and I just generated the seed via test.check</z><z id="t1469463751" t="lucasbradstreet A bit hacky, but it saved me from having to pass down a UUID seed and changing a lot of code"><y>#</y><d>2016-07-25</d><h>16:22</h><w>lucasbradstreet</w>A bit hacky, but it saved me from having to pass down a UUID seed and changing a lot of code</z><z id="t1469463845" t="gfredericks I&apos;d just copy the code from master probably"><y>#</y><d>2016-07-25</d><h>16:24</h><w>gfredericks</w>I&apos;d just copy the code from master probably</z><z id="t1469464196" t="lucasbradstreet mmm"><y>#</y><d>2016-07-25</d><h>16:29</h><w>lucasbradstreet</w>mmm</z><z id="t1469567004" t="ag can someone help me with creating a generator, that generates a map that contains keys like this { :amount-debit (gen/pos-int) :amount-credit (gen/pos-int) } The problem is it has to be either debit or credit, and never both. And always one of them should have a value, they can&apos;t be null both at the same time"><y>#</y><d>2016-07-26</d><h>21:03</h><w>ag</w>can someone help me with creating a generator, that generates a map that contains keys like this
<pre>{
 :amount-debit  (gen/pos-int)
 :amount-credit (gen/pos-int)
}
</pre>
The problem is it has to be either debit or credit, and never both. And always one of them should have a value, they can&apos;t be null both at the same time</z><z id="t1469567892" t="metametadata [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] like this? (def gen-card (gen/let [card-type (gen/elements [:amount-credit :amount-debit]) value gen/s-pos-int] (hash-map card-type value))) (println &quot;Sample:&quot; (gen/sample gen-card 5)) ;; Sample: ({:amount-debit 1} {:amount-debit 1} {:amount-credit 1} {:amount-debit 3} {:amount-credit 2}) "><y>#</y><d>2016-07-26</d><h>21:18</h><w>metametadata</w><a>@ag</a> like this?
<pre>(def gen-card (gen/let
                [card-type (gen/elements [:amount-credit :amount-debit])
                 value gen/s-pos-int]
                (hash-map card-type value)))

(println &quot;Sample:&quot; (gen/sample gen-card 5))
;; Sample: ({:amount-debit 1} {:amount-debit 1} {:amount-credit 1} {:amount-debit 3} {:amount-credit 2})
</pre></z><z id="t1469568056" t="ag [:attrs {:href &quot;/_/_/users/U06BDK9S7&quot;}] : hmmm interesting, my current code is slightly different, but I see what you’re suggesting. I’ll try to see if I can use this style without having to refactor a lot"><y>#</y><d>2016-07-26</d><h>21:20</h><w>ag</w><a>@metametadata</a>: hmmm interesting, my current code is slightly different, but I see what you’re suggesting. I’ll try to see if I can use this style without having to refactor a lot</z><z id="t1469568078" t="ag thanks"><y>#</y><d>2016-07-26</d><h>21:21</h><w>ag</w>thanks</z><z id="t1469569092" t="ag Although it should generate a map with both debit and credit, yet only one of them should have a value"><y>#</y><d>2016-07-26</d><h>21:38</h><w>ag</w>Although it should generate a map with both debit and credit, yet only one of them should have a value</z><z id="t1469569183" t="ag I started with gen/let where I’m using is-debit gen/boolean and then I think I want to try to use something like :amount-debit (g/such-that (fn [_] (= is-debit true)) g/pos-int)"><y>#</y><d>2016-07-26</d><h>21:39</h><w>ag</w>I started with <code>gen/let</code> where I’m using <code>is-debit gen/boolean</code> and then I think I want to try to use something like <code> :amount-debit          (g/such-that (fn [_] (= is-debit true)) g/pos-int)</code></z><z id="t1469569208" t="ag but this fails with Couldn’t satisfy such-that predicate after 10 tries"><y>#</y><d>2016-07-26</d><h>21:40</h><w>ag</w>but this fails with <code>Couldn’t satisfy such-that predicate after 10 tries</code></z><z id="t1469569586" t="ag ah nevermind using regular if fork with pos-int and return 0 seems worked"><y>#</y><d>2016-07-26</d><h>21:46</h><w>ag</w>ah nevermind using regular <code>if</code> fork with pos-int and return 0 seems worked</z><z id="t1469570609" t="ag eh, actually it didn’t, I need a need to have a let block scoped insid gen/hash-map block"><y>#</y><d>2016-07-26</d><h>22:03</h><w>ag</w>eh, actually it didn’t, I need a need to have a <code>let</code> block scoped insid <code>gen/hash-map</code> block</z><z id="t1469570693" t="ag or I have to assoc two gen/hash-maps somehow"><y>#</y><d>2016-07-26</d><h>22:04</h><w>ag</w>or I have to <code>assoc</code> two <code>gen/hash-maps</code> somehow</z><z id="t1469570864" t="ag is there a way to “merge” multiple hash-map generators?"><y>#</y><d>2016-07-26</d><h>22:07</h><w>ag</w>is there a way to “merge” multiple <code>hash-map</code> generators?</z><z id="t1469572167" t="ag so this: (g/let [debit? g/boolean] (g/hash-map :created-at (timestamp-gen) :amount-debit (g/fmap #(when debit? %) g/pos-int) :amount-credit (g/fmap #(when-not debit? %) g/pos-int))) does not work 😞"><y>#</y><d>2016-07-26</d><h>22:29</h><w>ag</w>so this: 
<pre>(g/let [debit? g/boolean]
  (g/hash-map
    :created-at            (timestamp-gen)
    :amount-debit          (g/fmap #(when debit? %) g/pos-int)
    :amount-credit         (g/fmap #(when-not debit? %) g/pos-int)))
</pre>
does not work <b>😞</b></z><z id="t1469573359" t="gfredericks um"><y>#</y><d>2016-07-26</d><h>22:49</h><w>gfredericks</w>um</z><z id="t1469573370" t="gfredericks I would do"><y>#</y><d>2016-07-26</d><h>22:49</h><w>gfredericks</w>I would do</z><z id="t1469573479" t="gfredericks (g/fmap (fn [[amount key created-at]] (assoc {:amount-debit nil :amount-credit nil :created-at created-at} key amount)) (g/tuple g/pos-int (g/elements [:amount-debit :amount-credit]) (timestamp-gen)))"><y>#</y><d>2016-07-26</d><h>22:51</h><w>gfredericks</w><code>(g/fmap (fn [[amount key created-at]] (assoc {:amount-debit nil :amount-credit nil :created-at created-at} key amount)) (g/tuple g/pos-int (g/elements [:amount-debit :amount-credit]) (timestamp-gen)))</code></z><z id="t1469573482" t="gfredericks [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] ↑"><y>#</y><d>2016-07-26</d><h>22:51</h><w>gfredericks</w><a>@ag</a> ↑</z><z id="t1469585603" t="metametadata [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] your snippets both seem to work and produce similar results"><y>#</y><d>2016-07-27</d><h>02:13</h><w>metametadata</w><a>@ag</a> <a>@gfredericks</a> your snippets both seem to work and produce similar results</z><z id="t1469587631" t="metametadata refactoring [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] &apos;s version I came up with this (extracted amount and gen-when ): (defn gen-when [x gen] (gen/let [x (gen/return x)] (when x gen))) (def gen-card (gen/let [debit? gen/boolean amount gen/pos-int] (gen/hash-map :created-at gen/pos-int :amount-debit (gen-when debit? amount) :amount-credit (gen-when (not debit?) amount)))) Sample: ({:created-at 0, :amount-debit 0, :amount-credit nil} {:created-at 0, :amount-debit nil, :amount-credit 0} {:created-at 0, :amount-debit nil, :amount-credit 2} {:created-at 2, :amount-debit 3, :amount-credit nil} {:created-at 4, :amount-debit nil, :amount-credit 0}) I tend to eliminate bind and fmap because for me they&apos;re harder to read than let . I also like here how using gen/hash-map allows to &quot;inline&quot; :created-at generator."><y>#</y><d>2016-07-27</d><h>02:47</h><w>metametadata</w>refactoring <a>@ag</a>&apos;s version I came up with this (extracted <code>amount</code> and <code>gen-when</code>):

<pre>(defn gen-when
  [x gen]
  (gen/let
    [x (gen/return x)]
    (when x gen)))

(def gen-card
  (gen/let
    [debit? gen/boolean
     amount gen/pos-int]
    (gen/hash-map
      :created-at gen/pos-int
      :amount-debit (gen-when debit? amount)
      :amount-credit (gen-when (not debit?) amount))))
</pre>

Sample:
<pre>({:created-at 0, :amount-debit 0, :amount-credit nil}
 {:created-at 0, :amount-debit nil, :amount-credit 0}
 {:created-at 0, :amount-debit nil, :amount-credit 2}
 {:created-at 2, :amount-debit 3, :amount-credit nil}
 {:created-at 4, :amount-debit nil, :amount-credit 0})
</pre>

I tend to eliminate <code>bind</code> and <code>fmap</code> because for me they&apos;re harder to read than <code>let</code>.
I also like here how using <code>gen/hash-map</code> allows to &quot;inline&quot; <code>:created-at</code> generator.</z><z id="t1469587816" t="gfredericks [:attrs {:href &quot;/_/_/users/U06BDK9S7&quot;}] : your gen-when ignores its first argument"><y>#</y><d>2016-07-27</d><h>02:50</h><w>gfredericks</w><a>@metametadata</a>: your <code>gen-when</code> ignores its first argument</z><z id="t1469587835" t="gfredericks oh I take it back"><y>#</y><d>2016-07-27</d><h>02:50</h><w>gfredericks</w>oh I take it back</z><z id="t1469587957" t="gfredericks okay so if you want to use let then I think (gen/let [debit? gen/boolean, amount gen/pos-int, created-at gen/pos-int] {:created-at created-at :amount-debit (when debit? amount) :amount-credit (when-not debit? amount)}) would be a bit more direct"><y>#</y><d>2016-07-27</d><h>02:52</h><w>gfredericks</w>okay so if you want to use let then I think <code>(gen/let [debit? gen/boolean, amount gen/pos-int, created-at gen/pos-int] {:created-at created-at :amount-debit (when debit? amount) :amount-credit (when-not debit? amount)})</code> would be a bit more direct</z><z id="t1469588118" t="gfredericks you don&apos;t get to inline the created-at generator but on the other hand you don&apos;t have to create wrapper generators for credit/debit"><y>#</y><d>2016-07-27</d><h>02:55</h><w>gfredericks</w>you don&apos;t get to inline the created-at generator but on the other hand you don&apos;t have to create wrapper generators for credit/debit</z><z id="t1469588171" t="metametadata yeah, agree. I guess the approach will depend on the number of additional fields in the card map"><y>#</y><d>2016-07-27</d><h>02:56</h><w>metametadata</w>yeah, agree. I guess the approach will depend on the number of additional fields in the card map</z><z id="t1469588245" t="metametadata ie if there are a lot of fields similar to created-at than &quot;inlining&quot; is more preferable"><y>#</y><d>2016-07-27</d><h>02:57</h><w>metametadata</w>ie if there are a lot of  fields similar to <code>created-at</code> than &quot;inlining&quot; is more preferable</z><z id="t1469588719" t="ag actually my thing worked, I didn&apos;t know it. My ui was broken, I couldn&apos;t see it :)"><y>#</y><d>2016-07-27</d><h>03:05</h><w>ag</w>actually my thing worked, I didn&apos;t know it. My ui was broken, I couldn&apos;t see it :)</z><z id="t1469589939" t="gfredericks [:attrs {:href &quot;/_/_/users/U06BDK9S7&quot;}] : you can also do both -- make two maps and merge them together"><y>#</y><d>2016-07-27</d><h>03:25</h><w>gfredericks</w><a>@metametadata</a>: you can also do both -- make two maps and merge them together</z><z id="t1469656186" t="mattly has anyone written about reducing generation time for creating large tree structures in test.check ?"><y>#</y><d>2016-07-27</d><h>21:49</h><w>mattly</w>has anyone written about reducing generation time for creating large tree structures in test.check ?</z><z id="t1469656234" t="mattly I added a new branch in my structure recently and it tripled the test run time"><y>#</y><d>2016-07-27</d><h>21:50</h><w>mattly</w>I added a new branch in my structure recently and it tripled the test run time</z><z id="t1469656294" t="mattly the branch is basically (gen/list-distinct-by :name (gen/hash-map :name gen/string-alphanumeric)) and gets fmapped over with some other stuff"><y>#</y><d>2016-07-27</d><h>21:51</h><w>mattly</w>the branch is basically <code>(gen/list-distinct-by :name (gen/hash-map :name gen/string-alphanumeric))</code> and gets fmapped over with some other stuff</z><z id="t1469656305" t="mattly the actual value of the string isn&apos;t important so much as that it&apos;s distinct"><y>#</y><d>2016-07-27</d><h>21:51</h><w>mattly</w>the actual value of the string isn&apos;t important so much as that it&apos;s distinct</z><z id="t1469656343" t="mattly so I&apos;m looking at strategies for getting rid of the distinct clause in the list generator and making the value distinct some other way"><y>#</y><d>2016-07-27</d><h>21:52</h><w>mattly</w>so I&apos;m looking at strategies for getting rid of the distinct clause in the list generator and making the value distinct some other way</z><z id="t1469656414" t="mattly I&apos;d also love to know if there&apos;s a way to peek a bit better at which parts of my tree are taking the most time generate"><y>#</y><d>2016-07-27</d><h>21:53</h><w>mattly</w>I&apos;d also love to know if there&apos;s a way to peek a bit better at which parts of my tree are taking the most time generate</z><z id="t1469659998" t="gfredericks mattly: have you checked if the runtime increase roughly corresponds to an increase in the size of the generated data?"><y>#</y><d>2016-07-27</d><h>22:53</h><w>gfredericks</w>mattly: have you checked if the runtime increase roughly corresponds to an increase in the size of the generated data?</z><z id="t1469660022" t="mattly gfredericks: working on it"><y>#</y><d>2016-07-27</d><h>22:53</h><w>mattly</w>gfredericks: working on it</z><z id="t1469660029" t="mattly but I think it does"><y>#</y><d>2016-07-27</d><h>22:53</h><w>mattly</w>but I think it does</z><z id="t1469660033" t="gfredericks if it does correspond, then my initial reaction would be &quot;that sounds reasonable&quot;; if not, then that could potentially be a problem worth looking into"><y>#</y><d>2016-07-27</d><h>22:53</h><w>gfredericks</w>if it does correspond, then my initial reaction would be &quot;that sounds reasonable&quot;; if not, then that could potentially be a problem worth looking into</z><z id="t1469660050" t="gfredericks unless I&apos;m misunderstanding your question"><y>#</y><d>2016-07-27</d><h>22:54</h><w>gfredericks</w>unless I&apos;m misunderstanding your question</z><z id="t1469660080" t="mattly I don&apos;t think it&apos;s a problem of test.check per-se so much as the data structure I&apos;m creating with it"><y>#</y><d>2016-07-27</d><h>22:54</h><w>mattly</w>I don&apos;t think it&apos;s a problem of test.check per-se so much as the data structure I&apos;m creating with it</z><z id="t1469660105" t="gfredericks mattly: how familiar are you with test.check&apos;s general sizing mechanism?"><y>#</y><d>2016-07-27</d><h>22:55</h><w>gfredericks</w>mattly: how familiar are you with test.check&apos;s general sizing mechanism?</z><z id="t1469660140" t="mattly gfredericks: I&apos;ve dug into the code a bit but haven&apos;t tried writing my own generator beyond composing from primitives"><y>#</y><d>2016-07-27</d><h>22:55</h><w>mattly</w>gfredericks: I&apos;ve dug into the code a bit but haven&apos;t tried writing my own generator beyond composing from primitives</z><z id="t1469660155" t="gfredericks you shouldn&apos;t need to normally"><y>#</y><d>2016-07-27</d><h>22:55</h><w>gfredericks</w>you shouldn&apos;t need to normally</z><z id="t1469660160" t="mattly yeah"><y>#</y><d>2016-07-27</d><h>22:56</h><w>mattly</w>yeah</z><z id="t1469660205" t="gfredericks I suppose I&apos;m just wondering if you understand it well enough to know why (gen/vector (gen/vector (gen/vector (gen/vector (gen/vector gen/nat))))) would OOM"><y>#</y><d>2016-07-27</d><h>22:56</h><w>gfredericks</w>I suppose I&apos;m just wondering if you understand it well enough to know why <code>(gen/vector (gen/vector (gen/vector (gen/vector (gen/vector gen/nat)))))</code> would OOM</z><z id="t1469660214" t="mattly I&apos;m pretty sure the problem stems from the need for distinct values where the value doesn&apos;t actually matter at a low point in the tree, and then having to generate all the child branches"><y>#</y><d>2016-07-27</d><h>22:56</h><w>mattly</w>I&apos;m pretty sure the problem stems from the need for distinct values where the value doesn&apos;t actually matter at a low point in the tree, and then having to generate all the child branches</z><z id="t1469660219" t="mattly ah"><y>#</y><d>2016-07-27</d><h>22:56</h><w>mattly</w>ah</z><z id="t1469660221" t="mattly yeah I do"><y>#</y><d>2016-07-27</d><h>22:57</h><w>mattly</w>yeah I do</z><z id="t1469660230" t="mattly I&apos;ve run into that quite a bit on Circle 😄"><y>#</y><d>2016-07-27</d><h>22:57</h><w>mattly</w>I&apos;ve run into that quite a bit on Circle <b>😄</b></z><z id="t1469660254" t="mattly most of my lists / vectors anymore I put max-elements on"><y>#</y><d>2016-07-27</d><h>22:57</h><w>mattly</w>most of my lists / vectors anymore I put max-elements on</z><z id="t1469660303" t="gfredericks I think the distinct generator is highly unlikely to be slow without also throwing exceptions"><y>#</y><d>2016-07-27</d><h>22:58</h><w>gfredericks</w>I think the distinct generator is highly unlikely to be slow without also throwing exceptions</z><z id="t1469660310" t="mattly ok"><y>#</y><d>2016-07-27</d><h>22:58</h><w>mattly</w>ok</z><z id="t1469660336" t="gfredericks i.e., if you think the problem is that it has to throw away a bunch of stuff because of collisions"><y>#</y><d>2016-07-27</d><h>22:58</h><w>gfredericks</w>i.e., if you think the problem is that it has to throw away a bunch of stuff because of collisions</z><z id="t1469660348" t="mattly that was my guess"><y>#</y><d>2016-07-27</d><h>22:59</h><w>mattly</w>that was my guess</z><z id="t1469660358" t="gfredericks it&apos;ll throw an exception if it can&apos;t generate a unique thing after ~10 tries"><y>#</y><d>2016-07-27</d><h>22:59</h><w>gfredericks</w>it&apos;ll throw an exception if it can&apos;t generate a unique thing after ~10 tries</z><z id="t1469660368" t="gfredericks so it&apos;s hard to imagine a scenario where it expends much effort on this without hitting 10 occasionally"><y>#</y><d>2016-07-27</d><h>22:59</h><w>gfredericks</w>so it&apos;s hard to imagine a scenario where it expends much effort on this without hitting 10 occasionally</z><z id="t1469660376" t="mattly fair point"><y>#</y><d>2016-07-27</d><h>22:59</h><w>mattly</w>fair point</z><z id="t1469663938" t="mattly I got some instrumentation up around the generators and my test runs"><y>#</y><d>2016-07-27</d><h>23:58</h><w>mattly</w>I got some instrumentation up around the generators and my test runs</z><z id="t1469663957" t="mattly eliminating the need to generate distinct values on one branch of my tree cut the test run time in half"><y>#</y><d>2016-07-27</d><h>23:59</h><w>mattly</w>eliminating the need to generate distinct values on one branch of my tree cut the test run time in half</z><z id="t1469663982" t="mattly I&apos;m basically putting those values in now after-the-fact similar to how you might do serial ids"><y>#</y><d>2016-07-27</d><h>23:59</h><w>mattly</w>I&apos;m basically putting those values in now after-the-fact similar to how you might do serial ids</z><z id="t1469664005" t="mattly I found a few other places in the actual generation of things where I&apos;m being wasteful"><y>#</y><d>2016-07-28</d><h>00:00</h><w>mattly</w>I found a few other places in the actual generation of things where I&apos;m being wasteful</z><z id="t1469664046" t="mattly but cutting that out wasn&apos;t nearly quite as effective as getting rid of distinct requirement"><y>#</y><d>2016-07-28</d><h>00:00</h><w>mattly</w>but cutting that out wasn&apos;t nearly quite as effective as getting rid of distinct requirement</z><z id="t1469664181" t="mattly btw, thanks for all the work on test.chuck, checking and subsequence are invaluable tools in my toolbox these days"><y>#</y><d>2016-07-28</d><h>00:03</h><w>mattly</w>btw, thanks for all the work on test.chuck, <code>checking</code> and <code>subsequence</code> are invaluable tools in my toolbox these days</z><z id="t1469664226" t="gfredericks :)"><y>#</y><d>2016-07-28</d><h>00:03</h><w>gfredericks</w>:)</z><z id="t1469664243" t="gfredericks I don&apos;t quite understand what you mean by &quot;putting those values in now after-the-fact&quot;"><y>#</y><d>2016-07-28</d><h>00:04</h><w>gfredericks</w>I don&apos;t quite understand what you mean by &quot;putting those values in now after-the-fact&quot;</z><z id="t1469664249" t="mattly hm"><y>#</y><d>2016-07-28</d><h>00:04</h><w>mattly</w>hm</z><z id="t1469664292" t="mattly I&apos;ll do an example"><y>#</y><d>2016-07-28</d><h>00:04</h><w>mattly</w>I&apos;ll do an example</z><z id="t1469664349" t="gfredericks FYI distinct collections are generated by maintaining the elements in a transient set: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L546"><y>#</y><d>2016-07-28</d><h>00:05</h><w>gfredericks</w>FYI distinct collections are generated by maintaining the elements in a transient set: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L546" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L546</a></z><z id="t1469664359" t="mattly oh interesting"><y>#</y><d>2016-07-28</d><h>00:05</h><w>mattly</w>oh interesting</z><z id="t1469664395" t="gfredericks so it&apos;s not inconceivable that the overhead of adding and looking up elements is slowing things down"><y>#</y><d>2016-07-28</d><h>00:06</h><w>gfredericks</w>so it&apos;s not inconceivable that the overhead of adding and looking up elements is slowing things down</z><z id="t1469664416" t="gfredericks if that&apos;s really your issue I have a hard time imagining how to make it faster"><y>#</y><d>2016-07-28</d><h>00:06</h><w>gfredericks</w>if that&apos;s really your issue I have a hard time imagining how to make it faster</z><z id="t1469664436" t="mattly (gen/fmap (fn [things] (map #(assoc %2 :name (str %1 &quot;-&quot; (:name %2))) (range) things)) (gen/list (gen/hash-map :name gen/string-alphanumeric)))"><y>#</y><d>2016-07-28</d><h>00:07</h><w>mattly</w><code>(gen/fmap (fn [things] (map #(assoc %2 :name (str %1 &quot;-&quot; (:name %2))) (range) things)) (gen/list (gen/hash-map :name gen/string-alphanumeric)))</code></z><z id="t1469664444" t="mattly yeah"><y>#</y><d>2016-07-28</d><h>00:07</h><w>mattly</w>yeah</z><z id="t1469664482" t="mattly I get that, and really for me and my use case it comes down to, am I using the generator for actual values I want to test or just random input?"><y>#</y><d>2016-07-28</d><h>00:08</h><w>mattly</w>I get that, and really for me and my use case it comes down to, am I using the generator for actual values I want to test or just random input?</z><z id="t1469664500" t="mattly and in the case of these names, it&apos;s just random input that needs to be distinct"><y>#</y><d>2016-07-28</d><h>00:08</h><w>mattly</w>and in the case of these names, it&apos;s just random input that needs to be distinct</z><z id="t1469664543" t="gfredericks I suppose you probably have to compute hash values for the data when you wouldn&apos;t otherwise"><y>#</y><d>2016-07-28</d><h>00:09</h><w>gfredericks</w>I suppose you probably have to compute hash values for the data when you wouldn&apos;t otherwise</z><z id="t1469664545" t="mattly I won&apos;t get much value of shrinking"><y>#</y><d>2016-07-28</d><h>00:09</h><w>mattly</w>I won&apos;t get much value of shrinking</z><z id="t1469664641" t="mattly where I get the value of shrinking here is the number and depth of branches and the leaf values"><y>#</y><d>2016-07-28</d><h>00:10</h><w>mattly</w>where I get the value of shrinking here is the number and depth of branches and the leaf values</z><z id="t1469664650" t="mattly but not the id"><y>#</y><d>2016-07-28</d><h>00:10</h><w>mattly</w>but not the id</z><z id="t1469664750" t="gfredericks FYI gen/uuid is evenly distributed and doesn&apos;t shrink, so you could use that for uniqueness without needing to check"><y>#</y><d>2016-07-28</d><h>00:12</h><w>gfredericks</w>FYI gen/uuid is evenly distributed and doesn&apos;t shrink, so you could use that for uniqueness without needing to check</z><z id="t1469664788" t="mattly yeah, that occurred to me as well"><y>#</y><d>2016-07-28</d><h>00:13</h><w>mattly</w>yeah, that occurred to me as well</z><z id="t1469664830" t="mattly but this works better for my use-case"><y>#</y><d>2016-07-28</d><h>00:13</h><w>mattly</w>but this works better for my use-case</z><z id="t1469664839" t="mattly it&apos;s... complicated"><y>#</y><d>2016-07-28</d><h>00:13</h><w>mattly</w>it&apos;s... complicated</z><z id="t1469664886" t="mattly I&apos;m working on a system to let people do self-serve analytics on a data warehouse, but with a complicated permissions structure on top of it"><y>#</y><d>2016-07-28</d><h>00:14</h><w>mattly</w>I&apos;m working on a system to let people do self-serve analytics on a data warehouse, but with a complicated permissions structure on top of it</z><z id="t1469664958" t="mattly from my experience doing similar things in the past, i know that scenario-based testing has its own set of gotchas"><y>#</y><d>2016-07-28</d><h>00:15</h><w>mattly</w>from my experience doing similar things in the past, i know that scenario-based testing has its own set of gotchas</z><z id="t1469665019" t="mattly so I&apos;m basically generating the dimension/fact graph and putting that into our data store, which, well, it&apos;s not what I would have chose"><y>#</y><d>2016-07-28</d><h>00:16</h><w>mattly</w>so I&apos;m basically generating the dimension/fact graph and putting that into our data store, which, well, it&apos;s not what I would have chose</z><z id="t1469665075" t="mattly property-based testing of it though has helped me catch a ton of bugs in the prototype I&apos;m replacing that I don&apos;t think anyone would have ever thought to look for"><y>#</y><d>2016-07-28</d><h>00:17</h><w>mattly</w>property-based testing of it though has helped me catch a ton of bugs in the prototype I&apos;m replacing that I don&apos;t think anyone would have ever thought to look for</z><z id="t1469685884" t="mattly having gotten rid of the distinct name requirements across my entire gen&apos;d tree, and doing some other things around the frequency of size and depth of branches, I cut the run for my test suite down to 1/10th of what it was before"><y>#</y><d>2016-07-28</d><h>06:04</h><w>mattly</w>having gotten rid of the distinct name requirements across my entire gen&apos;d tree, and doing some other things around the frequency of size and depth of branches, I cut the run for my test suite down to 1/10th of what it was before</z><z id="t1469685897" t="mattly and it still shrinks awesomely"><y>#</y><d>2016-07-28</d><h>06:04</h><w>mattly</w>and it still shrinks awesomely</z><z id="t1469685933" t="mattly I also included in the trunk generator some flags to turn off certain branches of the tree if they&apos;re not needed for a test"><y>#</y><d>2016-07-28</d><h>06:05</h><w>mattly</w>I also included in the trunk generator some flags to turn off certain branches of the tree if they&apos;re not needed for a test</z><z id="t1469716654" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] do you think parallelizing tests and/or generators would help out?"><y>#</y><d>2016-07-28</d><h>14:37</h><w>gfredericks</w><a>@mattly</a> do you think parallelizing tests and/or generators would help out?</z><z id="t1469717097" t="gfredericks I&apos;ve worked on parallelizing tests before, but it just occurred to me that slow generators could be parallelized even if the tests themselves can&apos;t"><y>#</y><d>2016-07-28</d><h>14:44</h><w>gfredericks</w>I&apos;ve worked on parallelizing tests before, but it just occurred to me that slow generators could be parallelized even if the tests themselves can&apos;t</z><z id="t1469717153" t="gfredericks E.g., during the test run you have one or more background threads doing the generating while the main thread does the actual tests"><y>#</y><d>2016-07-28</d><h>14:45</h><w>gfredericks</w>E.g., during the test run you have one or more background threads doing the generating while the main thread does the actual tests</z><z id="t1469717300" t="mattly I&apos;m not sure, tbh"><y>#</y><d>2016-07-28</d><h>14:48</h><w>mattly</w>I&apos;m not sure, tbh</z><z id="t1469717369" t="mattly One thing I&apos;m looking into now, after a deeper branch ends up with 100k+ nodes when it starts to fail, is exponential scaling of the size of nodes"><y>#</y><d>2016-07-28</d><h>14:49</h><w>mattly</w>One thing I&apos;m looking into now, after a deeper branch ends up with 100k+ nodes when it starts to fail, is exponential scaling of the size of nodes</z><z id="t1469717451" t="mattly which would actually fit the shape of the data I&apos;m trying to model well"><y>#</y><d>2016-07-28</d><h>14:50</h><w>mattly</w>which would actually fit the shape of the data I&apos;m trying to model well</z><z id="t1469722420" t="gfredericks You&apos;re saying you like it being so large? "><y>#</y><d>2016-07-28</d><h>16:13</h><w>gfredericks</w>You&apos;re saying you like it being so large? </z><z id="t1469726212" t="mattly eh, well, that&apos;s the count of something akin to (gen/vector (gen/vector (gen/vector gen/int))) but flattened; and I&apos;ve found a few bugs that have only manifested when the node size gets that large"><y>#</y><d>2016-07-28</d><h>17:16</h><w>mattly</w>eh, well, that&apos;s the count of something akin to <code>(gen/vector (gen/vector (gen/vector gen/int)))</code> but flattened; and I&apos;ve found a few bugs that have only manifested when the node size gets that large</z><z id="t1469726240" t="mattly shrinking, of course, will end up narrowing that down to like the 2 or 3 end nodes that cause the failure"><y>#</y><d>2016-07-28</d><h>17:17</h><w>mattly</w>shrinking, of course, will end up narrowing that down to like the 2 or 3 end nodes that cause the failure</z><z id="t1469726263" t="mattly and really it&apos;s more due to the nature of the data I&apos;m working with / replicating, and the complex query sets I have to run on top of them"><y>#</y><d>2016-07-28</d><h>17:17</h><w>mattly</w>and really it&apos;s more due to the nature of the data I&apos;m working with / replicating, and the complex query sets I have to run on top of them</z><z id="t1469726464" t="mattly as I find specific cases like that I tend to break out specific tests for that data scenario"><y>#</y><d>2016-07-28</d><h>17:21</h><w>mattly</w>as I find specific cases like that I tend to break out specific tests for that data scenario</z><z id="t1470142742" t="rickmoynihan is there a good resource to help understand shrinking; how it works, what to consider etc..."><y>#</y><d>2016-08-02</d><h>12:59</h><w>rickmoynihan</w>is there a good resource to help understand shrinking; how it works, what to consider etc...</z><z id="t1470142775" t="rickmoynihan it seems like quite an involved topic"><y>#</y><d>2016-08-02</d><h>12:59</h><w>rickmoynihan</w>it seems like quite an involved topic</z><z id="t1470144558" t="lucasbradstreet I’m interested in this. I have a reasonable intuition about it, but I’d like something in more detail"><y>#</y><d>2016-08-02</d><h>13:29</h><w>lucasbradstreet</w>I’m interested in this. I have a reasonable intuition about it, but I’d like something in more detail</z><z id="t1470146464" t="gfredericks well I can answer specific questions about it at least"><y>#</y><d>2016-08-02</d><h>14:01</h><w>gfredericks</w>well I can answer specific questions about it at least</z><z id="t1470146508" t="gfredericks for the most part the shrinking strategy mirrors the structure of your generator"><y>#</y><d>2016-08-02</d><h>14:01</h><w>gfredericks</w>for the most part the shrinking strategy mirrors the structure of your generator</z><z id="t1470146541" t="gfredericks e.g., tuple shrinks by shrinking its elements; collections shrink by deleting elements and shrinking elements"><y>#</y><d>2016-08-02</d><h>14:02</h><w>gfredericks</w>e.g., tuple shrinks by shrinking its elements; collections shrink by deleting elements and shrinking elements</z><z id="t1470146559" t="gfredericks fmap shrinks by shrinking the underlying element and running it through the function again"><y>#</y><d>2016-08-02</d><h>14:02</h><w>gfredericks</w>fmap shrinks by shrinking the underlying element and running it through the function again</z><z id="t1470146995" t="gfredericks bind is a little weird though, and therefore so is gen/let"><y>#</y><d>2016-08-02</d><h>14:09</h><w>gfredericks</w>bind is a little weird though, and therefore so is gen/let</z><z id="t1470150251" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : regarding the test.check issue described in CLJ-1997, I&apos;m considering pasting all the relevant code from riddley into test.check as the most practical option. I&apos;m wondering if you see any problems with doing something like that for a contrib library."><y>#</y><d>2016-08-02</d><h>15:04</h><w>gfredericks</w><a>@alexmiller</a>: regarding the test.check issue described in CLJ-1997, I&apos;m considering pasting all the relevant code from riddley into test.check as the most practical option. I&apos;m wondering if you see any problems with doing something like that for a contrib library.</z><z id="t1470160458" t="mattly I&apos;ve started moving away from generators like gen/frequency that don&apos;t shrink in favor of those that provide predictable shrinking behavior such as gen/one-of"><y>#</y><d>2016-08-02</d><h>17:54</h><w>mattly</w>I&apos;ve started moving away from generators like <code>gen/frequency</code> that don&apos;t shrink in favor of those that provide predictable shrinking behavior such as <code>gen/one-of</code></z><z id="t1470160510" t="mattly the idea being that when there are multiple possible values that require different generators, it will shrink along an axis of my choosing"><y>#</y><d>2016-08-02</d><h>17:55</h><w>mattly</w>the idea being that when there are multiple possible values that require different generators, it will shrink along an axis of my choosing</z><z id="t1470160652" t="mattly for example, I have a node on the tree structure I generate where most of the time the value is an element from a collection, but sometimes it&apos;s not – however for most of the problems I encounter, that doesn&apos;t matter"><y>#</y><d>2016-08-02</d><h>17:57</h><w>mattly</w>for example, I have a node on the tree structure I generate where most of the time the value is an element from a collection, but sometimes it&apos;s not – however for most of the  problems I encounter, that doesn&apos;t matter</z><z id="t1470160658" t="mattly so I setup the generator like so:"><y>#</y><d>2016-08-02</d><h>17:57</h><w>mattly</w>so I setup the generator like so:</z><z id="t1470160717" t="mattly instead of using gen/frequency to mimic the structure of my inputs"><y>#</y><d>2016-08-02</d><h>17:58</h><w>mattly</w>instead of using <code>gen/frequency</code> to mimic the structure of my inputs</z><z id="t1470160749" t="mattly it will definitely test the case where there&apos;s a thing, but will shrink towards there not being a thing"><y>#</y><d>2016-08-02</d><h>17:59</h><w>mattly</w>it will definitely test the case where there&apos;s a thing, but will shrink towards there not being a thing</z><z id="t1470160760" t="mattly which reduces the noise I have to contend with when troubleshooting a failure"><y>#</y><d>2016-08-02</d><h>17:59</h><w>mattly</w>which reduces the noise I have to contend with when troubleshooting a failure</z><z id="t1470160856" t="mattly in some cases where things is a fixed size, I actually use gen/one-of to force a shrinking preference, since gen/elements is always random; you&apos;d have to shrink the size of the input if you wanted predictability"><y>#</y><d>2016-08-02</d><h>18:00</h><w>mattly</w>in some cases where <code>things</code> is a fixed size, I actually use <code>gen/one-of</code> to force a shrinking preference, since <code>gen/elements</code> is always random; you&apos;d have to shrink the size of the input if you wanted predictability</z><z id="t1470160903" t="mattly (and feel free to correct me if I&apos;m wrong – I&apos;m going off of observation from usage and cursory readings of the code)"><y>#</y><d>2016-08-02</d><h>18:01</h><w>mattly</w>(and feel free to correct me if I&apos;m wrong – I&apos;m going off of observation from usage and cursory readings of the code)</z><z id="t1470161468" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] : what makes you say gen/frequency doesn&apos;t shrink?"><y>#</y><d>2016-08-02</d><h>18:11</h><w>gfredericks</w><a>@mattly</a>: what makes you say <code>gen/frequency</code> doesn&apos;t shrink?</z><z id="t1470161521" t="gfredericks oh I see; I&apos;m inclined to say that&apos;s a bug"><y>#</y><d>2016-08-02</d><h>18:12</h><w>gfredericks</w>oh I see; I&apos;m inclined to say that&apos;s a bug</z><z id="t1470161534" t="mattly [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : my experience of using it, that example before, the frequencies didn&apos;t seem to matter when shrinking"><y>#</y><d>2016-08-02</d><h>18:12</h><w>mattly</w><a>@gfredericks</a>: my experience of using it, that example before, the frequencies didn&apos;t seem to matter when shrinking</z><z id="t1470161564" t="gfredericks I would think it should shrink toward earlier generators like one-of does"><y>#</y><d>2016-08-02</d><h>18:12</h><w>gfredericks</w>I would think it should shrink toward earlier generators like <code>one-of</code> does</z><z id="t1470161577" t="mattly so f.e. [[3 (gen/return nil)] [1 (gen/elements things)]] it&apos;ll still pick gen/elements"><y>#</y><d>2016-08-02</d><h>18:12</h><w>mattly</w>so f.e. <code>[[3 (gen/return nil)] [1 (gen/elements things)]]</code> it&apos;ll still pick gen/elements</z><z id="t1470161580" t="mattly that&apos;d be even better"><y>#</y><d>2016-08-02</d><h>18:13</h><w>mattly</w>that&apos;d be even better</z><z id="t1470161618" t="gfredericks would you like to file the bug or shall I?"><y>#</y><d>2016-08-02</d><h>18:13</h><w>gfredericks</w>would you like to file the bug or shall I?</z><z id="t1470161649" t="mattly go for it, i don&apos;t think I have an account on the jira"><y>#</y><d>2016-08-02</d><h>18:14</h><w>mattly</w>go for it, i don&apos;t think I have an account on the jira</z><z id="t1470161654" t="mattly I probably should"><y>#</y><d>2016-08-02</d><h>18:14</h><w>mattly</w>I probably should</z><z id="t1470161663" t="mattly and you&apos;d know more about what to say about it 😄"><y>#</y><d>2016-08-02</d><h>18:14</h><w>mattly</w>and you&apos;d know more about what to say about it <b>😄</b></z><z id="t1470161883" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] : http://dev.clojure.org/jira/browse/TCHECK-114"><y>#</y><d>2016-08-02</d><h>18:18</h><w>gfredericks</w><a>@mattly</a>: <a href="http://dev.clojure.org/jira/browse/TCHECK-114" target="_blank">http://dev.clojure.org/jira/browse/TCHECK-114</a></z><z id="t1470161922" t="mattly I&apos;m planning to do a writeup on my usage of test.check and property-based testing on the system I&apos;m working on"><y>#</y><d>2016-08-02</d><h>18:18</h><w>mattly</w>I&apos;m planning to do a writeup on my usage of test.check and property-based testing on the system I&apos;m working on</z><z id="t1470161959" t="mattly there&apos;s a lot of material out there on what it is, but very little on how to use it effectively"><y>#</y><d>2016-08-02</d><h>18:19</h><w>mattly</w>there&apos;s a lot of material out there on what it is, but very little on how to use it effectively</z><z id="t1470162060" t="mattly this has been such a success on my system, I&apos;m teaching our QA guy how to write generators"><y>#</y><d>2016-08-02</d><h>18:21</h><w>mattly</w>this has been such a success on my system, I&apos;m teaching our QA guy how to write generators</z><z id="t1470162166" t="gfredericks nice"><y>#</y><d>2016-08-02</d><h>18:22</h><w>gfredericks</w>nice</z><z id="t1470204254" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] cool, let me know if you want some eyes on it before you release it 🙂"><y>#</y><d>2016-08-03</d><h>06:04</h><w>lucasbradstreet</w><a>@mattly</a> cool, let me know if you want some eyes on it before you release it <b>🙂</b></z><z id="t1470320559" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : bumping the question above about pasting riddley into test.check"><y>#</y><d>2016-08-04</d><h>14:22</h><w>gfredericks</w><a>@alexmiller</a>: bumping the question above about pasting riddley into test.check</z><z id="t1470320634" t="gfredericks I just looked at the source and it&apos;s just a few hundred lines. I&apos;m guessing licensing/CA issues would be the biggest thing?"><y>#</y><d>2016-08-04</d><h>14:23</h><w>gfredericks</w>I just looked at the source and it&apos;s just a few hundred lines. I&apos;m guessing licensing/CA issues would be the biggest thing?</z><z id="t1470341270" t="Alex Miller (Clojure team) sorry, I didn’t belong to this channel so didn’t get any notifications"><y>#</y><d>2016-08-04</d><h>20:07</h><w>Alex Miller (Clojure team)</w>sorry, I didn’t belong to this channel so didn’t get any notifications</z><z id="t1470341629" t="Alex Miller (Clojure team) haven’t read all the back chat yet but pulling riddley into test-check would require some things wrt license and contribution"><y>#</y><d>2016-08-04</d><h>20:13</h><w>Alex Miller (Clojure team)</w>haven’t read all the back chat yet but pulling riddley into test-check would require some things wrt license and contribution</z><z id="t1470341644" t="Alex Miller (Clojure team) maybe this isn’t a problem you should be solving in test.check"><y>#</y><d>2016-08-04</d><h>20:14</h><w>Alex Miller (Clojure team)</w>maybe this isn’t a problem you should be solving in test.check</z><z id="t1470341684" t="gfredericks yeah, that&apos;s why I opened CLJ-1997; I&apos;d rather not solve it :)"><y>#</y><d>2016-08-04</d><h>20:14</h><w>gfredericks</w>yeah, that&apos;s why I opened CLJ-1997; I&apos;d rather not solve it :)</z><z id="t1470341706" t="gfredericks unless you&apos;re just objecting to it being a problem"><y>#</y><d>2016-08-04</d><h>20:15</h><w>gfredericks</w>unless you&apos;re just objecting to it being a problem</z><z id="t1470341716" t="gfredericks (the gen/let thing in particular)"><y>#</y><d>2016-08-04</d><h>20:15</h><w>gfredericks</w>(the <code>gen/let</code> thing in particular)</z><z id="t1470341825" t="Alex Miller (Clojure team) if I read all this correctly, let allows you to handle both dependent and independent generators but because it can’t tell the difference it performs the more complicated dependent expansion"><y>#</y><d>2016-08-04</d><h>20:17</h><w>Alex Miller (Clojure team)</w>if I read all this correctly, let allows you to handle both dependent and independent generators but because it can’t tell the difference it performs the more complicated dependent expansion</z><z id="t1470341889" t="gfredericks right"><y>#</y><d>2016-08-04</d><h>20:18</h><w>gfredericks</w>right</z><z id="t1470341891" t="Alex Miller (Clojure team) to which maybe I would suggest that you should add something that just lets you do the independent generator case with the less complicated expansion rather than trying to detect the difference"><y>#</y><d>2016-08-04</d><h>20:18</h><w>Alex Miller (Clojure team)</w>to which maybe I would suggest that you should add something that just lets you do the independent generator case with the less complicated expansion rather than trying to detect the difference</z><z id="t1470341913" t="Alex Miller (Clojure team) and/or to let users tell you which is which"><y>#</y><d>2016-08-04</d><h>20:18</h><w>Alex Miller (Clojure team)</w>and/or to let users tell you which is which</z><z id="t1470341919" t="gfredericks I suggested a much more complex macro a while back (analagous to for ) but reid didn&apos;t like it :)"><y>#</y><d>2016-08-04</d><h>20:18</h><w>gfredericks</w>I suggested a much more complex macro a while back (analagous to <code>for</code>) but reid didn&apos;t like it :)</z><z id="t1470341927" t="gfredericks so I agree with you actually"><y>#</y><d>2016-08-04</d><h>20:18</h><w>gfredericks</w>so I agree with you actually</z><z id="t1470341940" t="Alex Miller (Clojure team) sounds like a quorum to me :)"><y>#</y><d>2016-08-04</d><h>20:19</h><w>Alex Miller (Clojure team)</w>sounds like a quorum to me :)</z><z id="t1470341945" t="gfredericks haha"><y>#</y><d>2016-08-04</d><h>20:19</h><w>gfredericks</w>haha</z><z id="t1470341958" t="Alex Miller (Clojure team) see how easy that was? :)"><y>#</y><d>2016-08-04</d><h>20:19</h><w>Alex Miller (Clojure team)</w>see how easy that was? :)</z><z id="t1470341974" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : do you think a fully-featured analog to clojure.core/for would be a good fit?"><y>#</y><d>2016-08-04</d><h>20:19</h><w>gfredericks</w><a>@alexmiller</a>: do you think a fully-featured analog to <code>clojure.core/for</code> would be a good fit?</z><z id="t1470342005" t="gfredericks (examples here: https://github.com/gfredericks/test.chuck#for )"><y>#</y><d>2016-08-04</d><h>20:20</h><w>gfredericks</w>(examples here: <a href="https://github.com/gfredericks/test.chuck#for" target="_blank">https://github.com/gfredericks/test.chuck#for</a>)</z><z id="t1470342031" t="gfredericks the recomendation would then be &quot;if you care about optimizing shrinking, use for instead of let &quot;"><y>#</y><d>2016-08-04</d><h>20:20</h><w>gfredericks</w>the recomendation would then be &quot;if you care about optimizing shrinking, use <code>for</code> instead of <code>let</code>&quot;</z><z id="t1470342040" t="Alex Miller (Clojure team) yeah, I’ve looked at it in the past"><y>#</y><d>2016-08-04</d><h>20:20</h><w>Alex Miller (Clojure team)</w>yeah, I’ve looked at it in the past</z><z id="t1470342062" t="Alex Miller (Clojure team) it seems fine, but I can’t say for as a name had much resonance for me"><y>#</y><d>2016-08-04</d><h>20:21</h><w>Alex Miller (Clojure team)</w>it seems fine, but I can’t say <code>for</code> as a name had much resonance for me</z><z id="t1470342076" t="gfredericks ah yeah; I was just making the analogy to clojure.core/for I guess"><y>#</y><d>2016-08-04</d><h>20:21</h><w>gfredericks</w>ah yeah; I was just making the analogy to <code>clojure.core/for</code> I guess</z><z id="t1470342090" t="gfredericks monads and whatnot :)"><y>#</y><d>2016-08-04</d><h>20:21</h><w>gfredericks</w>monads and whatnot :)</z><z id="t1470342116" t="gfredericks let+"><y>#</y><d>2016-08-04</d><h>20:21</h><w>gfredericks</w><code>let+</code></z><z id="t1470342127" t="Alex Miller (Clojure team) over"><y>#</y><d>2016-08-04</d><h>20:22</h><w>Alex Miller (Clojure team)</w><code>over</code></z><z id="t1470342135" t="gfredericks o_O"><y>#</y><d>2016-08-04</d><h>20:22</h><w>gfredericks</w>o_O</z><z id="t1470342164" t="Alex Miller (Clojure team) I’m not known for being very successful at suggesting good names :)"><y>#</y><d>2016-08-04</d><h>20:22</h><w>Alex Miller (Clojure team)</w>I’m not known for being very successful at suggesting good names :)</z><z id="t1470342183" t="Alex Miller (Clojure team) but I would prefer something that’s not a variant of let"><y>#</y><d>2016-08-04</d><h>20:23</h><w>Alex Miller (Clojure team)</w>but I would prefer something that’s not a variant of <code>let</code></z><z id="t1470342220" t="Alex Miller (Clojure team) and I think it’s different enough from clojure.core/for that I’d be a little leery of overlapping that name"><y>#</y><d>2016-08-04</d><h>20:23</h><w>Alex Miller (Clojure team)</w>and I think it’s different enough from clojure.core/for that I’d be a little leery of overlapping that name</z><z id="t1470342233" t="gfredericks what sort of difference are you thinking of?"><y>#</y><d>2016-08-04</d><h>20:23</h><w>gfredericks</w>what sort of difference are you thinking of?</z><z id="t1470342238" t="Alex Miller (Clojure team) but maybe I could be convinced"><y>#</y><d>2016-08-04</d><h>20:23</h><w>Alex Miller (Clojure team)</w>but maybe I could be convinced</z><z id="t1470342273" t="gfredericks :parallel is an extra feature; but I think every aspect of clojure.core/for has an analog"><y>#</y><d>2016-08-04</d><h>20:24</h><w>gfredericks</w><code>:parallel</code> is an extra feature; but I think every aspect of <code>clojure.core/for</code> has an analog</z><z id="t1470342312" t="Alex Miller (Clojure team) what does parallel do again?"><y>#</y><d>2016-08-04</d><h>20:25</h><w>Alex Miller (Clojure team)</w>what does parallel do again?</z><z id="t1470342327" t="gfredericks it&apos;s exactly the thing you use to solve the problem with let"><y>#</y><d>2016-08-04</d><h>20:25</h><w>gfredericks</w>it&apos;s exactly the thing you use to solve the problem with <code>let</code></z><z id="t1470342333" t="Alex Miller (Clojure team) just independent"><y>#</y><d>2016-08-04</d><h>20:25</h><w>Alex Miller (Clojure team)</w>just independent</z><z id="t1470342333" t="gfredericks it&apos;s how you say &quot;these are independent&quot;"><y>#</y><d>2016-08-04</d><h>20:25</h><w>gfredericks</w>it&apos;s how you say &quot;these are independent&quot;</z><z id="t1470342336" t="gfredericks yeah"><y>#</y><d>2016-08-04</d><h>20:25</h><w>gfredericks</w>yeah</z><z id="t1470342360" t="gfredericks you could imagine clojure.core/for having something analogous that would let you iterate over two seqs in parallel"><y>#</y><d>2016-08-04</d><h>20:26</h><w>gfredericks</w>you could imagine <code>clojure.core/for</code> having something analogous that would let you iterate over two seqs in parallel</z><z id="t1470342488" t="Alex Miller (Clojure team) I guess putting on my Rich hair, I would say: what problem are we trying to solve and what are some alternatives and tradeoffs between them?"><y>#</y><d>2016-08-04</d><h>20:28</h><w>Alex Miller (Clojure team)</w>I guess putting on my Rich hair, I would say: what problem are we trying to solve and what are some alternatives and tradeoffs between them?</z><z id="t1470342497" t="Alex Miller (Clojure team) this is one option"><y>#</y><d>2016-08-04</d><h>20:28</h><w>Alex Miller (Clojure team)</w>this is one option</z><z id="t1470342500" t="Alex Miller (Clojure team) what are some others"><y>#</y><d>2016-08-04</d><h>20:28</h><w>Alex Miller (Clojure team)</w>what are some others</z><z id="t1470342532" t="gfredericks the problem is that gen/let is very easy to use and expressing parallelism is comparably difficult (`gen/tuple` and destructuring)"><y>#</y><d>2016-08-04</d><h>20:28</h><w>gfredericks</w>the problem is that <code>gen/let</code> is very easy to use and expressing parallelism is comparably difficult (`gen/tuple` and destructuring)</z><z id="t1470342558" t="gfredericks and so people will either naively use gen/let or else be grumpy that they can&apos;t"><y>#</y><d>2016-08-04</d><h>20:29</h><w>gfredericks</w>and so people will either naively use <code>gen/let</code> or else be grumpy that they can&apos;t</z><z id="t1470342611" t="Alex Miller (Clojure team) there’s a lot packed into for (some might argue too much :) - is there some way to take it apart into reusable pieces?"><y>#</y><d>2016-08-04</d><h>20:30</h><w>Alex Miller (Clojure team)</w>there’s a lot packed into for (some might argue too much :) - is there some way to take it apart into reusable pieces?</z><z id="t1470342646" t="gfredericks it&apos;s also possible to backwards-compatibly just add :parallel to gen/let"><y>#</y><d>2016-08-04</d><h>20:30</h><w>gfredericks</w>it&apos;s also possible to backwards-compatibly just add <code>:parallel</code> to <code>gen/let</code></z><z id="t1470342669" t="gfredericks I literally read &quot;hat&quot;"><y>#</y><d>2016-08-04</d><h>20:31</h><w>gfredericks</w>I literally read &quot;hat&quot;</z><z id="t1470342683" t="gfredericks so I needed you to point it out but now I enjoy it"><y>#</y><d>2016-08-04</d><h>20:31</h><w>gfredericks</w>so I needed you to point it out but now I enjoy it</z><z id="t1470342688" t="Alex Miller (Clojure team) good, thanks :)"><y>#</y><d>2016-08-04</d><h>20:31</h><w>Alex Miller (Clojure team)</w>good, thanks :)</z><z id="t1470342702" t="Alex Miller (Clojure team) hereby trademarking that"><y>#</y><d>2016-08-04</d><h>20:31</h><w>Alex Miller (Clojure team)</w>hereby trademarking that</z><z id="t1470342746" t="Alex Miller (Clojure team) unfortunately, I have to go pick up my dog right now, but I think it’s worth considering the tradeoffs of adding :parallel to let"><y>#</y><d>2016-08-04</d><h>20:32</h><w>Alex Miller (Clojure team)</w>unfortunately, I have to go pick up my dog right now, but I think it’s worth considering the tradeoffs of adding :parallel to let</z><z id="t1470342760" t="gfredericks yeah I like that idea more now that you&apos;ve made me think about it"><y>#</y><d>2016-08-04</d><h>20:32</h><w>gfredericks</w>yeah I like that idea more now that you&apos;ve made me think about it</z><z id="t1470342786" t="Alex Miller (Clojure team) pulling in either riddley or tools.analyzer seems like a large step so I would try to avoid it if possible"><y>#</y><d>2016-08-04</d><h>20:33</h><w>Alex Miller (Clojure team)</w>pulling in either riddley or tools.analyzer seems like a large step so I would try to avoid it if possible</z><z id="t1470342795" t="gfredericks ACK"><y>#</y><d>2016-08-04</d><h>20:33</h><w>gfredericks</w>ACK</z><z id="t1470585908" t="gfredericks I&apos;m taking a twitter poll on options for independent bindings in gen/let: https://mobile.twitter.com/gfredericks_/status/762311329470447616"><y>#</y><d>2016-08-07</d><h>16:05</h><w>gfredericks</w>I&apos;m taking a twitter poll on options for independent bindings in gen/let: <a href="https://mobile.twitter.com/gfredericks_/status/762311329470447616" target="_blank">https://mobile.twitter.com/gfredericks_/status/762311329470447616</a></z><z id="t1470585944" t="gfredericks So far people like the map syntax, which surprised me /cc [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] "><y>#</y><d>2016-08-07</d><h>16:05</h><w>gfredericks</w>So far people like the map syntax, which surprised me /cc <a>@alexmiller</a> </z><z id="t1471306696" t="gfredericks going to try to tackle parallel tests once and for all"><y>#</y><d>2016-08-16</d><h>00:18</h><w>gfredericks</w>going to try to tackle parallel tests once and for all</z><z id="t1471402322" t="lvh woop woop 🙂"><y>#</y><d>2016-08-17</d><h>02:52</h><w>lvh</w>woop woop <b>🙂</b></z><z id="t1471402512" t="gfredericks it&apos;s more of a headache than it should be :("><y>#</y><d>2016-08-17</d><h>02:55</h><w>gfredericks</w>it&apos;s more of a headache than it should be :(</z><z id="t1471444873" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : re our twitter conversation, what’s your solution for generators with high variance? I think maybe it’s ok, because the common case where you’re using parallel testing will be tests passing"><y>#</y><d>2016-08-17</d><h>14:41</h><w>lucasbradstreet</w><a>@gfredericks</a>: re our twitter conversation, what’s your solution for generators with high variance? I think maybe it’s ok, because the common case where you’re using parallel testing will be tests passing</z><z id="t1471444947" t="lucasbradstreet if your tests are failing often, then generally parallelism isn’t really all that helpful anyway. Most of the time when I run test.check running overnight in #core JVMs, I do not expect to catch anything"><y>#</y><d>2016-08-17</d><h>14:42</h><w>lucasbradstreet</w>if your tests are failing often, then generally parallelism isn’t really all that helpful anyway. Most of the time when I run test.check running overnight in #core JVMs, I do not expect to catch anything</z><z id="t1471445236" t="gfredericks It can slow down even in the passing case"><y>#</y><d>2016-08-17</d><h>14:47</h><w>gfredericks</w>It can slow down even in the passing case</z><z id="t1471445249" t="gfredericks Oh I forgot another goal"><y>#</y><d>2016-08-17</d><h>14:47</h><w>gfredericks</w>Oh I forgot another goal</z><z id="t1471445261" t="gfredericks Given a seed, the result should be deterministic"><y>#</y><d>2016-08-17</d><h>14:47</h><w>gfredericks</w>Given a seed, the result should be deterministic</z><z id="t1471445306" t="gfredericks So if you&apos;re preallocating work you have to give n/t trials to each thread"><y>#</y><d>2016-08-17</d><h>14:48</h><w>gfredericks</w>So if you&apos;re preallocating work you have to give n/t trials to each thread</z><z id="t1471445307" t="lucasbradstreet Yeah, I agree with that goal. That’s why I was saying that you have to partition the space and check whether all threads have passed X, where X is a failing iteration"><y>#</y><d>2016-08-17</d><h>14:48</h><w>lucasbradstreet</w>Yeah, I agree with that goal. That’s why I was saying that you have to partition the space and check whether all threads have passed X, where X is a failing iteration</z></g><g id="s1"><z id="t1471445325" t="lucasbradstreet I can see how it’ll slow down passing cases though"><y>#</y><d>2016-08-17</d><h>14:48</h><w>lucasbradstreet</w>I can see how it’ll slow down passing cases though</z><z id="t1471445332" t="gfredericks If one thread has lots of slow trials the others will be idle while it finished"><y>#</y><d>2016-08-17</d><h>14:48</h><w>gfredericks</w>If one thread has lots of slow trials the others will be idle while it finished</z><z id="t1471445339" t="lucasbradstreet Yeah, that’s troublesome"><y>#</y><d>2016-08-17</d><h>14:48</h><w>lucasbradstreet</w>Yeah, that’s troublesome</z><z id="t1471445348" t="lucasbradstreet Especially if you have a bunch of tests to run through"><y>#</y><d>2016-08-17</d><h>14:49</h><w>lucasbradstreet</w>Especially if you have a bunch of tests to run through</z><z id="t1471445354" t="gfredericks So my alg has a queue of trials to run"><y>#</y><d>2016-08-17</d><h>14:49</h><w>gfredericks</w>So my alg has a queue of trials to run</z><z id="t1471445362" t="lucasbradstreet Generally I’m just running one test overnight, on X cores"><y>#</y><d>2016-08-17</d><h>14:49</h><w>lucasbradstreet</w>Generally I’m just running one test overnight, on X cores</z><z id="t1471445373" t="lucasbradstreet So this isn’t a problem, but I see where it’s a problem for a test suite"><y>#</y><d>2016-08-17</d><h>14:49</h><w>lucasbradstreet</w>So this isn’t a problem, but I see where it’s a problem for a test suite</z><z id="t1471445405" t="gfredericks And the threads just pull them off the queue"><y>#</y><d>2016-08-17</d><h>14:50</h><w>gfredericks</w>And the threads just pull them off the queue</z><z id="t1471445419" t="lucasbradstreet I was going to say, a priority queue might be the answer"><y>#</y><d>2016-08-17</d><h>14:50</h><w>lucasbradstreet</w>I was going to say, a priority queue might be the answer</z><z id="t1471445430" t="gfredericks Priority? "><y>#</y><d>2016-08-17</d><h>14:50</h><w>gfredericks</w>Priority? </z><z id="t1471445436" t="lucasbradstreet Maybe you don’t even need to prioritise, now that I think about it"><y>#</y><d>2016-08-17</d><h>14:50</h><w>lucasbradstreet</w>Maybe you don’t even need to prioritise, now that I think about it</z><z id="t1471445440" t="gfredericks Yeah"><y>#</y><d>2016-08-17</d><h>14:50</h><w>gfredericks</w>Yeah</z><z id="t1471445476" t="gfredericks The other problem I have is deciding how to manage the threads"><y>#</y><d>2016-08-17</d><h>14:51</h><w>gfredericks</w>The other problem I have is deciding how to manage the threads</z><z id="t1471445498" t="gfredericks I suppose I could have it just use N futures...?"><y>#</y><d>2016-08-17</d><h>14:51</h><w>gfredericks</w>I suppose I could have it just use N futures...?</z><z id="t1471445506" t="lucasbradstreet You also need to ID the test cases, in case there is some variance in when the cases finish?"><y>#</y><d>2016-08-17</d><h>14:51</h><w>lucasbradstreet</w>You also need to ID the test cases, in case there is some variance in when the cases finish?</z><z id="t1471445507" t="gfredericks Maybe that&apos;s best actually"><y>#</y><d>2016-08-17</d><h>14:51</h><w>gfredericks</w>Maybe that&apos;s best actually</z><z id="t1471445518" t="gfredericks Yes they&apos;re ordered"><y>#</y><d>2016-08-17</d><h>14:51</h><w>gfredericks</w>Yes they&apos;re ordered</z><z id="t1471445560" t="gfredericks So a lot of complexity comes from when you find the first failure but have to wait for all earlier jobs to finish first"><y>#</y><d>2016-08-17</d><h>14:52</h><w>gfredericks</w>So a lot of complexity comes from when you find the first failure but have to wait for all earlier jobs to finish first</z><z id="t1471445571" t="lucasbradstreet Yep, I can see that"><y>#</y><d>2016-08-17</d><h>14:52</h><w>lucasbradstreet</w>Yep, I can see that</z><z id="t1471445645" t="lucasbradstreet If you use futures, make sure to check for (Thread/interrupted) in the processing loop, so you can cancel the thread reliably after the test is done"><y>#</y><d>2016-08-17</d><h>14:54</h><w>lucasbradstreet</w>If you use futures, make sure to check for (Thread/interrupted) in the processing loop, so you can cancel the thread reliably after the test is done</z><z id="t1471445872" t="gfredericks yeah cancelling things is a big deal too"><y>#</y><d>2016-08-17</d><h>14:57</h><w>gfredericks</w>yeah cancelling things is a big deal too</z><z id="t1471445888" t="gfredericks I don&apos;t know how bad it is to .stop a thread"><y>#</y><d>2016-08-17</d><h>14:58</h><w>gfredericks</w>I don&apos;t know how bad it is to <code>.stop</code> a thread</z><z id="t1471445911" t="lucasbradstreet Yeah, it doesn’t really work well"><y>#</y><d>2016-08-17</d><h>14:58</h><w>lucasbradstreet</w>Yeah, it doesn’t really work well</z><z id="t1471445921" t="lucasbradstreet It’s really up to the thread to behave well"><y>#</y><d>2016-08-17</d><h>14:58</h><w>lucasbradstreet</w>It’s really up to the thread to behave well</z><z id="t1471445947" t="lucasbradstreet if you check whether you’ve been interrupted in between test iterations, you’ll be fine with just (future-cancel fut)"><y>#</y><d>2016-08-17</d><h>14:59</h><w>lucasbradstreet</w>if you check whether you’ve been interrupted in between test iterations, you’ll be fine with just (future-cancel fut)</z><z id="t1471445958" t="gfredericks C-c in nrepl calls .stop I think"><y>#</y><d>2016-08-17</d><h>14:59</h><w>gfredericks</w>C-c in nrepl calls .stop I think</z><z id="t1471445989" t="lucasbradstreet future-cancel may do too, but it’s really up to the thread to behave properly"><y>#</y><d>2016-08-17</d><h>14:59</h><w>lucasbradstreet</w>future-cancel may do too, but it’s really up to the thread to behave properly</z><z id="t1471446047" t="lucasbradstreet pretty sure thread.stop has been deprecated too"><y>#</y><d>2016-08-17</d><h>15:00</h><w>lucasbradstreet</w>pretty sure thread.stop has been deprecated too</z><z id="t1471446075" t="lucasbradstreet yep, https://stackoverflow.com/questions/16504140/thread-stop-deprecated"><y>#</y><d>2016-08-17</d><h>15:01</h><w>lucasbradstreet</w>yep, <a href="https://stackoverflow.com/questions/16504140/thread-stop-deprecated" target="_blank">https://stackoverflow.com/questions/16504140/thread-stop-deprecated</a></z><z id="t1471446104" t="gfredericks yeah that&apos;s the entire reason for my hesitation"><y>#</y><d>2016-08-17</d><h>15:01</h><w>gfredericks</w>yeah that&apos;s the entire reason for my hesitation</z><z id="t1471446129" t="gfredericks it&apos;s tough in this case to ensure the thread behaves properly though since it&apos;s running user code, and so might hang"><y>#</y><d>2016-08-17</d><h>15:02</h><w>gfredericks</w>it&apos;s tough in this case to ensure the thread behaves properly though since it&apos;s running user code, and so might hang</z><z id="t1471446167" t="gfredericks so if I don&apos;t call thread.stop, the caveat to users is &quot;if your test or your generator hangs, you&apos;re just going to have an extra thread on your jvm until you restart it, sorry&quot;"><y>#</y><d>2016-08-17</d><h>15:02</h><w>gfredericks</w>so if I don&apos;t call thread.stop, the caveat to users is &quot;if your test or your generator hangs, you&apos;re just going to have an extra thread on your jvm until you restart it, sorry&quot;</z><z id="t1471446183" t="lucasbradstreet if user code hangs, it’s not your problem in my opinion"><y>#</y><d>2016-08-17</d><h>15:03</h><w>lucasbradstreet</w>if user code hangs, it’s not your problem in my opinion</z><z id="t1471446190" t="lucasbradstreet best you can do is exit between iterations"><y>#</y><d>2016-08-17</d><h>15:03</h><w>lucasbradstreet</w>best you can do is exit between iterations</z><z id="t1471446201" t="gfredericks sure, but users have the expectation that they can C-c their tests and everything stops"><y>#</y><d>2016-08-17</d><h>15:03</h><w>gfredericks</w>sure, but users have the expectation that they can C-c their tests and everything stops</z><z id="t1471446215" t="gfredericks what is &quot;exit between iterations&quot;?"><y>#</y><d>2016-08-17</d><h>15:03</h><w>gfredericks</w>what is &quot;exit between iterations&quot;?</z><z id="t1471446240" t="lucasbradstreet I agree, but there’s nothing you can do to guarantee that. User code can always cause situations where that is not true"><y>#</y><d>2016-08-17</d><h>15:04</h><w>lucasbradstreet</w>I agree, but there’s nothing you can do to guarantee that. User code can always cause situations where that is not true</z><z id="t1471446266" t="lucasbradstreet I mean, a thread will, at minimum, stop between an test iteration"><y>#</y><d>2016-08-17</d><h>15:04</h><w>lucasbradstreet</w>I mean, a thread will, at minimum, stop between an test iteration</z><z id="t1471446342" t="lucasbradstreet as far as I know, there may be other situations where their code can bail safely, but there can always be other situations where things are blocked and C-c is never going to help"><y>#</y><d>2016-08-17</d><h>15:05</h><w>lucasbradstreet</w>as far as I know, there may be other situations where their code can bail safely, but there can always be other situations where things are blocked and C-c is never going to help</z><z id="t1471446372" t="gfredericks that&apos;s true when users are explicitly using threading constructs"><y>#</y><d>2016-08-17</d><h>15:06</h><w>gfredericks</w>that&apos;s true when users are explicitly using threading constructs</z><z id="t1471446386" t="lucasbradstreet when I say “may”, I mean, it depends on their code"><y>#</y><d>2016-08-17</d><h>15:06</h><w>lucasbradstreet</w>when I say “may”, I mean, it depends on their code</z><z id="t1471446392" t="gfredericks but for user code on the main thread I think it&apos;s always true that C-c in nrepl stops it"><y>#</y><d>2016-08-17</d><h>15:06</h><w>gfredericks</w>but for user code on the main thread I think it&apos;s always true that C-c in nrepl stops it</z><z id="t1471446431" t="gfredericks I suppose this discussion overlaps with the &quot;should tests run in parallel by default?&quot; question"><y>#</y><d>2016-08-17</d><h>15:07</h><w>gfredericks</w>I suppose this discussion overlaps with the &quot;should tests run in parallel by default?&quot; question</z><z id="t1471446565" t="lucasbradstreet Ah yes, I can see how that is important "><y>#</y><d>2016-08-17</d><h>15:09</h><w>lucasbradstreet</w>Ah yes, I can see how that is important </z><z id="t1471447061" t="gfredericks I think using futures and using an atom to aggregate the results will simplify that code a lot"><y>#</y><d>2016-08-17</d><h>15:17</h><w>gfredericks</w>I think using futures and using an atom to aggregate the results will simplify that code a lot</z><z id="t1471447103" t="gfredericks so I&apos;m glad about that; "><y>#</y><d>2016-08-17</d><h>15:18</h><w>gfredericks</w>so I&apos;m glad about that; </z><z id="t1471447142" t="gfredericks I&apos;m a little grumpy about how this interacts with the reporter-fn, since I think that has to be nondeterministic now"><y>#</y><d>2016-08-17</d><h>15:19</h><w>gfredericks</w>I&apos;m a little grumpy about how this interacts with the reporter-fn, since I think that has to be nondeterministic now</z><z id="t1471447179" t="gfredericks and the behavior when the reporter-fn throws an exception is potentially weirder"><y>#</y><d>2016-08-17</d><h>15:19</h><w>gfredericks</w>and the behavior when the reporter-fn throws an exception is potentially weirder</z><z id="t1471459647" t="Alex Miller (Clojure team) calling .stop on a thread is bad - it frees all monitors which can badly impact others using them"><y>#</y><d>2016-08-17</d><h>18:47</h><w>Alex Miller (Clojure team)</w>calling .stop on a thread is bad - it frees all monitors which can badly impact others using them</z><z id="t1471459681" t="Alex Miller (Clojure team) much preferred to interrupt"><y>#</y><d>2016-08-17</d><h>18:48</h><w>Alex Miller (Clojure team)</w>much preferred to interrupt</z><z id="t1471464469" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : do you think it&apos;s a problem that nrepl does it on ctrl-c?"><y>#</y><d>2016-08-17</d><h>20:07</h><w>gfredericks</w><a>@alexmiller</a>: do you think it&apos;s a problem that nrepl does it on ctrl-c?</z><z id="t1471464508" t="gfredericks should we be resigned to forcing repl users to restart their jvm if they execute an infinite loop?"><y>#</y><d>2016-08-17</d><h>20:08</h><w>gfredericks</w>should we be resigned to forcing repl users to restart their jvm if they execute an infinite loop?</z><z id="t1471464593" t="gfredericks I see ctrl-c at the builtin clojure repl just kills the whole jvm"><y>#</y><d>2016-08-17</d><h>20:09</h><w>gfredericks</w>I see ctrl-c at the builtin clojure repl just kills the whole jvm</z><z id="t1471464686" t="gfredericks I&apos;m also curious if you have any sense for how realistic the monitor problem is to a user who isn&apos;t explicitly using monitors"><y>#</y><d>2016-08-17</d><h>20:11</h><w>gfredericks</w>I&apos;m also curious if you have any sense for how realistic the monitor problem is to a user who isn&apos;t explicitly using monitors</z><z id="t1471465686" t="Alex Miller (Clojure team) I don’t know that there is any better solution for nrepl, but that doesn’t make it good"><y>#</y><d>2016-08-17</d><h>20:28</h><w>Alex Miller (Clojure team)</w>I don’t know that there is any better solution for nrepl, but that doesn’t make it good</z><z id="t1471465775" t="Alex Miller (Clojure team) the thread stop thing is a real problem, which is why its deprecated. any code that uses Java locks will be affected and that includes code that is calling into the Clojure runtime in places where synchronization is used (every lazy seq uses synchronization)."><y>#</y><d>2016-08-17</d><h>20:29</h><w>Alex Miller (Clojure team)</w>the thread stop thing is a real problem, which is why its deprecated. any code that uses Java locks will be affected and that includes code that is calling into the Clojure runtime in places where synchronization is used (every lazy seq uses synchronization).</z><z id="t1471465870" t="Alex Miller (Clojure team) that said, typically at the repl, the person typing is the one likely to be affected and they will probably just start over with (mostly) fresh resources"><y>#</y><d>2016-08-17</d><h>20:31</h><w>Alex Miller (Clojure team)</w>that said, typically at the repl, the person typing is the one likely to be affected and they will probably just start over with (mostly) fresh resources</z><z id="t1471465962" t="Alex Miller (Clojure team) Java Concurrency in Practice is probably the best resource on these problems and their recommended alternatives"><y>#</y><d>2016-08-17</d><h>20:32</h><w>Alex Miller (Clojure team)</w>Java Concurrency in Practice is probably the best resource on these problems and their recommended alternatives</z><z id="t1471470256" t="gfredericks Yeah that&apos;s about what I thought. Seems like there&apos;s not much you can do in a general context where you don&apos;t control all the code. I&apos;m surprised it hasn&apos;t been worth fixing (or is too hard to fix) on modern jvms"><y>#</y><d>2016-08-17</d><h>21:44</h><w>gfredericks</w>Yeah that&apos;s about what I thought. Seems like there&apos;s not much you can do in a general context where you don&apos;t control all the code. I&apos;m surprised it hasn&apos;t been worth fixing (or is too hard to fix) on modern jvms</z><z id="t1471572188" t="lvh What’s the generator equivalent of “repeatedly”? I know return is constantly . Use case is: generate nested data structure with random (but no-shrink, because they don’t affect execution) byte arrays"><y>#</y><d>2016-08-19</d><h>02:03</h><w>lvh</w>What’s the generator equivalent of “repeatedly”? I know <code>return</code> is <code>constantly</code>. Use case is: generate nested data structure with random (but no-shrink, because they don’t affect execution) byte arrays</z><z id="t1471572295" t="lvh I think the answer is (defn frepeatedly [f] (fmap #(f) (return nil)))"><y>#</y><d>2016-08-19</d><h>02:04</h><w>lvh</w>I think the answer is <code>(defn frepeatedly [f] (fmap #(f) (return nil)))</code></z><z id="t1471572299" t="lvh or something"><y>#</y><d>2016-08-19</d><h>02:04</h><w>lvh</w>or something</z><z id="t1471572639" t="gfredericks um"><y>#</y><d>2016-08-19</d><h>02:10</h><w>gfredericks</w>um</z><z id="t1471572665" t="gfredericks you just want to generate collections of byte arrays?"><y>#</y><d>2016-08-19</d><h>02:11</h><w>gfredericks</w>you just want to generate collections of byte arrays?</z><z id="t1471572702" t="gfredericks it sounds like you just described (gen/list (gen/no-shrink gen/bytes)) maybe?"><y>#</y><d>2016-08-19</d><h>02:11</h><w>gfredericks</w>it sounds like you just described <code>(gen/list (gen/no-shrink gen/bytes))</code> maybe?</z><z id="t1471573036" t="gfredericks [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] ⇑"><y>#</y><d>2016-08-19</d><h>02:17</h><w>gfredericks</w><a>@lvh</a> ⇑</z><z id="t1471573199" t="lvh [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : Well, sorta. I want byte arrays of a specific size (they’re cryptographic keys) — I already have a function for doing that, hence the phrasing of the question"><y>#</y><d>2016-08-19</d><h>02:19</h><w>lvh</w><a>@gfredericks</a>: Well, sorta. I want byte arrays of a specific size (they’re cryptographic keys) — I already have a function for doing that, hence the phrasing of the question</z><z id="t1471573225" t="lvh I don’t actually care that they’re cryptographically random for these tests, but have a mild preference for just using the same tool"><y>#</y><d>2016-08-19</d><h>02:20</h><w>lvh</w>I don’t actually care that they’re cryptographically random for these tests, but have a mild preference for just using the same tool</z><z id="t1471573303" t="gfredericks if you don&apos;t use test.check&apos;s randomness then you won&apos;t have the reproducibility you normally have"><y>#</y><d>2016-08-19</d><h>02:21</h><w>gfredericks</w>if you don&apos;t use test.check&apos;s randomness then you won&apos;t have the reproducibility you normally have</z><z id="t1471573333" t="gfredericks but if you&apos;re convinced it won&apos;t affect your tests and don&apos;t want to bother reimplementing as a generator, I&apos;d just &quot;generate&quot; that stuff as part of running your test and not in the generator"><y>#</y><d>2016-08-19</d><h>02:22</h><w>gfredericks</w>but if you&apos;re convinced it won&apos;t affect your tests and don&apos;t want to bother reimplementing as a generator, I&apos;d just &quot;generate&quot; that stuff as part of running your test and not in the generator</z><z id="t1471573351" t="gfredericks fixed-length byte arrays wouldn&apos;t be hard to implement though"><y>#</y><d>2016-08-19</d><h>02:22</h><w>gfredericks</w>fixed-length byte arrays wouldn&apos;t be hard to implement though</z><z id="t1471573567" t="gfredericks e.g., (gen/fmap byte-array (gen/vector (gen/choose -128 127) 12))"><y>#</y><d>2016-08-19</d><h>02:26</h><w>gfredericks</w>e.g., <code>(gen/fmap byte-array (gen/vector (gen/choose -128 127) 12))</code></z><z id="t1471573578" t="gfredericks that should give you a uniform distribution"><y>#</y><d>2016-08-19</d><h>02:26</h><w>gfredericks</w>that should give you a uniform distribution</z><z id="t1471573597" t="lvh OK, thanks 🙂 For clarity, the value doesn’t matter, but the length does; any byte array that isn’t exactly this length is wrong and won’t work"><y>#</y><d>2016-08-19</d><h>02:26</h><w>lvh</w>OK, thanks <b>🙂</b> For clarity, the value doesn’t matter, but the length does; any byte array that isn’t exactly this length is wrong and won’t work</z><z id="t1471573742" t="gfredericks (gen/return (byte-array (repeat 12 0))) :P"><y>#</y><d>2016-08-19</d><h>02:29</h><w>gfredericks</w><code>(gen/return (byte-array (repeat 12 0)))</code> :P</z><z id="t1471573887" t="lvh I do want them to be different; because I’m deriving keys, so seeing the value that got produced (if the inputs are different) tells me what really happened"><y>#</y><d>2016-08-19</d><h>02:31</h><w>lvh</w>I do want them to be different; because I’m deriving keys, so seeing the value that got produced (if the inputs are different) tells me what really happened</z><z id="t1471573941" t="lvh (opaquely, of course :))"><y>#</y><d>2016-08-19</d><h>02:32</h><w>lvh</w>(opaquely, of course :))</z><z id="t1471573997" t="gfredericks ah"><y>#</y><d>2016-08-19</d><h>02:33</h><w>gfredericks</w>ah</z><z id="t1471573998" t="lvh I think I might go with the approach you suggested of just generating them separately; or using test.check to generate steps rather than doing the operations directly 🙂"><y>#</y><d>2016-08-19</d><h>02:33</h><w>lvh</w>I think I might go with the approach you suggested of just generating them separately; or using test.check to generate steps rather than doing the operations directly <b>🙂</b></z><z id="t1471995743" t="gfredericks discussing parallelizing test.check on twitter is hard"><y>#</y><d>2016-08-23</d><h>23:42</h><w>gfredericks</w>discussing parallelizing test.check on twitter is hard</z><z id="t1472008190" t="Alex Miller (Clojure team) s/test.check/anything/"><y>#</y><d>2016-08-24</d><h>03:09</h><w>Alex Miller (Clojure team)</w>s/test.check/anything/</z><z id="t1472490417" t="lvh Is there something in test.check for producing equal-but-internally-different data structures? (Trying to check if a serialization format is deterministic)."><y>#</y><d>2016-08-29</d><h>17:06</h><w>lvh</w>Is there something in test.check for producing equal-but-internally-different data structures? (Trying to check if a serialization format is deterministic).</z><z id="t1472497043" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] where two data structures are equal but will serialize/deserialize to something equal but distinct? e.g. clojure maps and records can be equal, but a record should round trip back to a record"><y>#</y><d>2016-08-29</d><h>18:57</h><w>lucasbradstreet</w><a>@lvh</a> where two data structures are equal but will serialize/deserialize to something equal but distinct? e.g. clojure maps and records can be equal, but a record should round trip back to a record</z><z id="t1472497130" t="lvh Oh, right — that’s a good point 🙂"><y>#</y><d>2016-08-29</d><h>18:58</h><w>lvh</w>Oh, right — that’s a good point <b>🙂</b></z><z id="t1472497167" t="lvh I guess I’m mostly thinking of issues like map key order or set order"><y>#</y><d>2016-08-29</d><h>18:59</h><w>lvh</w>I guess I’m mostly thinking of issues like map key order or set order</z><z id="t1472497348" t="lucasbradstreet Ah. Those two are interesting although, at least in clojure, I don’t think/don’t count them as part of the contract"><y>#</y><d>2016-08-29</d><h>19:02</h><w>lucasbradstreet</w>Ah. Those two are interesting although, at least in clojure, I don’t think/don’t count them as part of the contract</z><z id="t1472497407" t="lucasbradstreet https://github.com/ztellman/collection-check might be handy if you’re interested in stuff like maps/sets/etc, though it wasn’t really built for what you want"><y>#</y><d>2016-08-29</d><h>19:03</h><w>lucasbradstreet</w><a href="https://github.com/ztellman/collection-check" target="_blank">https://github.com/ztellman/collection-check</a> might be handy if you’re interested in stuff like maps/sets/etc, though it wasn’t really built for what you want</z><z id="t1472502188" t="Alex Miller (Clojure team) maps and sets are not ordered - equality does not consider them (and there are no guarantees around it)"><y>#</y><d>2016-08-29</d><h>20:23</h><w>Alex Miller (Clojure team)</w>maps and sets are not ordered - equality does not consider them (and there are no guarantees around it)</z><z id="t1472502853" t="lucasbradstreet I remember from the google groups discussion that the order of keys and the order of vals, on an identical? map, are guaranteed to be in the same order, but that was it"><y>#</y><d>2016-08-29</d><h>20:34</h><w>lucasbradstreet</w>I remember from the google groups discussion that the order of keys and the order of vals, on an identical? map, are guaranteed to be in the same order, but that was it</z><z id="t1472513088" t="gfredericks [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] I think if you could enumerate the sort of distinctions you&apos;re aiming at it wouldn&apos;t be hard to put together yourself "><y>#</y><d>2016-08-29</d><h>23:24</h><w>gfredericks</w><a>@lvh</a> I think if you could enumerate the sort of distinctions you&apos;re aiming at it wouldn&apos;t be hard to put together yourself </z><z id="t1472513112" t="gfredericks (defn gen-tweak &quot;Returns a generator of variants of x such that (= x x&apos;)&quot; [x] ...)"><y>#</y><d>2016-08-29</d><h>23:25</h><w>gfredericks</w>(defn gen-tweak &quot;Returns a generator of variants of x such that (= x x&apos;)&quot; [x] ...)</z><z id="t1472518635" t="lvh Yeah; I was hoping that was implemented already because I’ll probably miss a bunch 🙂"><y>#</y><d>2016-08-30</d><h>00:57</h><w>lvh</w>Yeah; I was hoping that was implemented already because I’ll probably miss a bunch <b>🙂</b></z><z id="t1472519061" t="gfredericks it&apos;d be a weird thing to include, because it&apos;s open-ended and also inherently suspicious of clojure itself"><y>#</y><d>2016-08-30</d><h>01:04</h><w>gfredericks</w>it&apos;d be a weird thing to include, because it&apos;s open-ended and also inherently suspicious of clojure itself</z><z id="t1472519409" t="lvh yeah"><y>#</y><d>2016-08-30</d><h>01:10</h><w>lvh</w>yeah</z><z id="t1472519420" t="lvh canonical serialization is desirable in a lot of cases though 🙂"><y>#</y><d>2016-08-30</d><h>01:10</h><w>lvh</w>canonical serialization is desirable in a lot of cases though <b>🙂</b></z><z id="t1472519438" t="lvh Fortunately I can mostly deal with just local storage, so I don’t really need it"><y>#</y><d>2016-08-30</d><h>01:10</h><w>lvh</w>Fortunately I can mostly deal with just local storage, so I don’t really need it</z><z id="t1472519517" t="gfredericks also it depends on clojure impl details"><y>#</y><d>2016-08-30</d><h>01:11</h><w>gfredericks</w>also it depends on clojure impl details</z><z id="t1472519556" t="lvh right; which is why I want it as a test and not as some manual verification"><y>#</y><d>2016-08-30</d><h>01:12</h><w>lvh</w>right; which is why I want it as a test and not as some manual verification</z><z id="t1472519567" t="lvh I want a computer to tell me when it stops being true before it matters 🙂"><y>#</y><d>2016-08-30</d><h>01:12</h><w>lvh</w>I want a computer to tell me when it stops being true before it matters <b>🙂</b></z><z id="t1472519732" t="gfredericks feel free to add something to test.chuck"><y>#</y><d>2016-08-30</d><h>01:15</h><w>gfredericks</w>feel free to add something to test.chuck</z><z id="t1472934769" t="gfredericks writing a quickcheck is hard"><y>#</y><d>2016-09-03</d><h>20:32</h><w>gfredericks</w>writing a quickcheck is hard</z><z id="t1473105977" t="lvh hm"><y>#</y><d>2016-09-05</d><h>20:06</h><w>lvh</w>hm</z><z id="t1473106090" t="lvh I have a seq of generators; I’d like a generator that concats the seqs; how do I do that while keeping shrinking?"><y>#</y><d>2016-09-05</d><h>20:08</h><w>lvh</w>I have a seq of generators; I’d like a generator that concats the seqs; how do I do that while keeping shrinking?</z><z id="t1473106097" t="lvh (IIUC sample would work, but would break shrinking.)"><y>#</y><d>2016-09-05</d><h>20:08</h><w>lvh</w>(IIUC sample would work, but would break shrinking.)</z><z id="t1473106194" t="lucasbradstreet Can you just do (gen/fmap #(reduce into [] %) (apply gen/tuple seq-of-generators)"><y>#</y><d>2016-09-05</d><h>20:09</h><w>lucasbradstreet</w>Can you just do (gen/fmap #(reduce into [] %) (apply gen/tuple seq-of-generators)</z><z id="t1473106241" t="lvh (I also just realized that I can just make the generator later; i.e. first compute the concat’d thing, then chuck.gen/subsequence from that)"><y>#</y><d>2016-09-05</d><h>20:10</h><w>lvh</w>(I also just realized that I can just make the generator later; i.e. first compute the concat’d thing, then chuck.gen/subsequence from that)</z><z id="t1473106257" t="lucasbradstreet Yeah, that would also work"><y>#</y><d>2016-09-05</d><h>20:10</h><w>lucasbradstreet</w>Yeah, that would also work</z><z id="t1473106314" t="lvh thanks 🙂 that was stumping me until I wrote it out 🙂"><y>#</y><d>2016-09-05</d><h>20:11</h><w>lvh</w>thanks <b>🙂</b> that was stumping me until I wrote it out <b>🙂</b></z><z id="t1473106329" t="lucasbradstreet 🦆"><y>#</y><d>2016-09-05</d><h>20:12</h><w>lucasbradstreet</w><b>🦆</b></z><z id="t1473106354" t="lvh exactly"><y>#</y><d>2016-09-05</d><h>20:12</h><w>lvh</w>exactly</z><z id="t1473971487" t="aengelberg Is there a way to get a variant of gen/any that does not return NaN ?"><y>#</y><d>2016-09-15</d><h>20:31</h><w>aengelberg</w>Is there a way to get a variant of <code>gen/any</code> that does not return <code>NaN</code>?</z><z id="t1473971569" t="aengelberg My use case is that I want to do an operation on two different types of datastructures and verify that the two results are equal. The problem is that, when the outputs are structurally equal but both have NaN deeply nested inside of them, = will return false."><y>#</y><d>2016-09-15</d><h>20:32</h><w>aengelberg</w>My use case is that I want to do an operation on two different types of datastructures and verify that the two results are equal. The problem is that, when the outputs are structurally equal but both have <code>NaN</code> deeply nested inside of them, <code>=</code> will return false.</z><z id="t1473971642" t="aengelberg So, the generator can&apos;t just not return NaN, I would need it to not return NaN at any level of nesting."><y>#</y><d>2016-09-15</d><h>20:34</h><w>aengelberg</w>So, the generator can&apos;t just not return NaN, I would need it to not return NaN at any level of nesting.</z><z id="t1473982133" t="gfredericks man I needed that for test.check itself"><y>#</y><d>2016-09-15</d><h>23:28</h><w>gfredericks</w>man I needed that for test.check itself</z><z id="t1473982148" t="gfredericks I wonder what I did"><y>#</y><d>2016-09-15</d><h>23:29</h><w>gfredericks</w>I wonder what I did</z><z id="t1473982186" t="gfredericks https://github.com/clojure/test.check/blob/master/src/test/clojure/clojure/test/check/test.cljc#L1083"><y>#</y><d>2016-09-15</d><h>23:29</h><w>gfredericks</w><a href="https://github.com/clojure/test.check/blob/master/src/test/clojure/clojure/test/check/test.cljc#L1083" target="_blank">https://github.com/clojure/test.check/blob/master/src/test/clojure/clojure/test/check/test.cljc#L1083</a></z><z id="t1473982212" t="gfredericks looks like I used a custom recursive generator"><y>#</y><d>2016-09-15</d><h>23:30</h><w>gfredericks</w>looks like I used a custom recursive generator</z><z id="t1473982376" t="gfredericks It was oriented at edn which afaik can&apos;t handle infinities either"><y>#</y><d>2016-09-15</d><h>23:32</h><w>gfredericks</w>It was oriented at edn which afaik can&apos;t handle infinities either</z><z id="t1473982402" t="gfredericks But NaN is pretty poisonous "><y>#</y><d>2016-09-15</d><h>23:33</h><w>gfredericks</w>But NaN is pretty poisonous </z><z id="t1473982426" t="gfredericks You could add something to test.chuck if you&apos;d find that useful"><y>#</y><d>2016-09-15</d><h>23:33</h><w>gfredericks</w>You could add something to test.chuck if you&apos;d find that useful</z><z id="t1474483144" t="Alex Miller (Clojure team) [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] curious if these failures are meaningful to you http://dev.clojure.org/jira/browse/CLJ-2026"><y>#</y><d>2016-09-21</d><h>18:39</h><w>Alex Miller (Clojure team)</w><a>@gfredericks</a> curious if these failures are meaningful to you <a href="http://dev.clojure.org/jira/browse/CLJ-2026" target="_blank">http://dev.clojure.org/jira/browse/CLJ-2026</a></z><z id="t1474483156" t="Alex Miller (Clojure team) in particular, if they are known things fixed since 0.9"><y>#</y><d>2016-09-21</d><h>18:39</h><w>Alex Miller (Clojure team)</w>in particular, if they are known things fixed since 0.9</z><z id="t1475170348" t="ag hey guys… does anyone know why (defspec foo-test 100 (prop/for-all [m (s/gen ::bool-kv)] ,,, is failing when run in clojurescript with lein-doo in phantomjs? throws this: ERROR in (foo-test) ("><y>#</y><d>2016-09-29</d><h>17:32</h><w>ag</w>hey guys… does anyone know why 
<pre>(defspec foo-test 100 
  (prop/for-all [m (s/gen ::bool-kv)] ,,,</pre>

 is failing when run in clojurescript with lein-doo in phantomjs? throws this:
<pre>ERROR in (foo-test) (</pre></z><z id="t1475171651" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0G75ARHC&quot;}] my work mate had a similar problem to that and it was due to not requiring something"><y>#</y><d>2016-09-29</d><h>17:54</h><w>lucasbradstreet</w><a>@ag</a> my work mate had a similar problem to that and it was due to not requiring something</z><z id="t1475171668" t="lucasbradstreet I was surprised that cljsbuild didn’t warn about it"><y>#</y><d>2016-09-29</d><h>17:54</h><w>lucasbradstreet</w>I was surprised that cljsbuild didn’t warn about it</z><z id="t1475171680" t="lucasbradstreet Your mileage may vary, but it’s worth checking"><y>#</y><d>2016-09-29</d><h>17:54</h><w>lucasbradstreet</w>Your mileage may vary, but it’s worth checking</z><z id="t1475171718" t="ag actually same code works when compiled javascript directly passed to karma (without using lein-doo)"><y>#</y><d>2016-09-29</d><h>17:55</h><w>ag</w>actually same code works when compiled javascript directly passed to karma (without using lein-doo)</z><z id="t1475171725" t="ag I want to use lein-doo though"><y>#</y><d>2016-09-29</d><h>17:55</h><w>ag</w>I want to use lein-doo though</z><z id="t1475172343" t="lucasbradstreet Are they using different compiler modes? i.e. advanced vs none?"><y>#</y><d>2016-09-29</d><h>18:05</h><w>lucasbradstreet</w>Are they using different compiler modes? i.e. advanced vs none?</z><z id="t1475172466" t="ag it completely breaks with :simple. java.lang.AssertionError: Assert failed: No file for namespace my-app.test-runner exists"><y>#</y><d>2016-09-29</d><h>18:07</h><w>ag</w>it completely breaks with :simple. <pre>java.lang.AssertionError: Assert failed: No file for namespace my-app.test-runner exists</pre></z><z id="t1475172549" t="ag with :whitespace it fails with a different error: Error: Cannot find module &apos;function (f) {if(typeof exports===&quot;object&quot;&amp;&amp;typeof module!==&quot;undefined&quot;){module.exports=f()}else if(typeof define===&quot;function&quot;&amp;&amp;define.amd){define([],f)}else{var g;if(typeof window!==&quot;undefined&quot;){g=window}else if(typeof global!==&quot;undefined&quot;){g=global}else if(typeof self!==&quot;undefined&quot;){g=self}else{g=this}g.React = f()}}’ "><y>#</y><d>2016-09-29</d><h>18:09</h><w>ag</w>with :whitespace it fails with a different error:
<pre>Error: Cannot find module &apos;function (f) {if(typeof exports===&quot;object&quot;&amp;&amp;typeof module!==&quot;undefined&quot;){module.exports=f()}else if(typeof define===&quot;function&quot;&amp;&amp;define.amd){define([],f)}else{var g;if(typeof window!==&quot;undefined&quot;){g=window}else if(typeof global!==&quot;undefined&quot;){g=global}else if(typeof self!==&quot;undefined&quot;){g=self}else{g=this}g.React = f()}}’
</pre></z><z id="t1475172625" t="lucasbradstreet Seems like a require error, but I don’t know too much more"><y>#</y><d>2016-09-29</d><h>18:10</h><w>lucasbradstreet</w>Seems like a require error, but I don’t know too much more</z><z id="t1475172695" t="ag I have created issue https://github.com/bensu/doo/issues/118"><y>#</y><d>2016-09-29</d><h>18:11</h><w>ag</w>I have created issue <a href="https://github.com/bensu/doo/issues/118" target="_blank">https://github.com/bensu/doo/issues/118</a></z><z id="t1475172805" t="lucasbradstreet I think it’s quite likely not to be a doo error"><y>#</y><d>2016-09-29</d><h>18:13</h><w>lucasbradstreet</w>I think it’s quite likely not to be a doo error</z><z id="t1475172873" t="lucasbradstreet Try requiring clojure.test.check.generators"><y>#</y><d>2016-09-29</d><h>18:14</h><w>lucasbradstreet</w>Try requiring clojure.test.check.generators</z><z id="t1475172901" t="lucasbradstreet Possibly shouldn’t need to, but I think it might be a bug in the cljs compiler if it’s not warning about it"><y>#</y><d>2016-09-29</d><h>18:15</h><w>lucasbradstreet</w>Possibly shouldn’t need to, but I think it might be a bug in the cljs compiler if it’s not warning about it</z><z id="t1475173000" t="ag still the same 😞"><y>#</y><d>2016-09-29</d><h>18:16</h><w>ag</w>still the same <b>😞</b></z><z id="t1475173019" t="lucasbradstreet I asked my co-worker and his was clojure.test.check.properties"><y>#</y><d>2016-09-29</d><h>18:16</h><w>lucasbradstreet</w>I asked my co-worker and his was clojure.test.check.properties</z><z id="t1475173044" t="ag I do have that require"><y>#</y><d>2016-09-29</d><h>18:17</h><w>ag</w>I do have that require</z><z id="t1475173047" t="ag [clojure.test.check.properties :as prop]"><y>#</y><d>2016-09-29</d><h>18:17</h><w>ag</w><code>[clojure.test.check.properties :as prop]</code></z><z id="t1475173105" t="lucasbradstreet OK, I’ve got nothing then 🙂"><y>#</y><d>2016-09-29</d><h>18:18</h><w>lucasbradstreet</w>OK, I’ve got nothing then <b>🙂</b></z><z id="t1475173175" t="ag so I’m wondering if it has something to do with how I require clojure.spec.generators?"><y>#</y><d>2016-09-29</d><h>18:19</h><w>ag</w>so I’m wondering if it has something to do with how I require clojure.spec.generators?</z><z id="t1475173244" t="ag so here’s the thing to require clojure spec, in clojurescript you can either do require &apos;[cljs.spec,,, or require &apos;[clojure.spec,,,"><y>#</y><d>2016-09-29</d><h>18:20</h><w>ag</w>so here’s the thing to require clojure spec, in clojurescript you can either do <code>require &apos;[cljs.spec,,,</code> or <code>require &apos;[clojure.spec,,,</code></z><z id="t1475173258" t="ag but when it comes to generators it’s not that smart"><y>#</y><d>2016-09-29</d><h>18:20</h><w>ag</w>but when it comes to generators it’s not that smart</z><z id="t1475173277" t="ag you can’t do require &apos;[clojure.spec.generators]"><y>#</y><d>2016-09-29</d><h>18:21</h><w>ag</w>you can’t do <code>require &apos;[clojure.spec.generators]</code></z><z id="t1475173289" t="lucasbradstreet Maybe"><y>#</y><d>2016-09-29</d><h>18:21</h><w>lucasbradstreet</w>Maybe</z><z id="t1475173305" t="ag I found a way to include them like this [cljs.spec.impl.gen :as gen]"><y>#</y><d>2016-09-29</d><h>18:21</h><w>ag</w>I found a way to include them like this <code>[cljs.spec.impl.gen :as gen]</code></z><z id="t1475173316" t="ag but maybe that’s not completely right?"><y>#</y><d>2016-09-29</d><h>18:21</h><w>ag</w>but maybe that’s not completely right?</z><z id="t1475173348" t="ag but then why the same code compiled and run outside of doo works fine?"><y>#</y><d>2016-09-29</d><h>18:22</h><w>ag</w>but then why the same code compiled and run outside of doo works fine?</z><z id="t1475259275" t="liamd i was wondering how to write good properties for property based testing"><y>#</y><d>2016-09-30</d><h>18:14</h><w>liamd</w>i was wondering how to write good properties for property based testing</z><z id="t1475259291" t="liamd for instance i have this function: (defn pixel-&gt;tile [position tile-size] {:x (Math/floor (/ (:x position) tile-size)) :y (Math/floor (/ (:y position) tile-size))}) "><y>#</y><d>2016-09-30</d><h>18:14</h><w>liamd</w>for instance i have this function:
<pre>(defn pixel-&gt;tile [position tile-size]
  {:x (Math/floor (/ (:x position) tile-size))
   :y (Math/floor (/ (:y position) tile-size))})
</pre></z><z id="t1475259299" t="liamd which is pretty simple"><y>#</y><d>2016-09-30</d><h>18:14</h><w>liamd</w>which is pretty simple</z><z id="t1475259350" t="liamd i suppose i’d want to check that the output is non-nil and &gt; 0? but that doesn’t seem to ensure the logic of it"><y>#</y><d>2016-09-30</d><h>18:15</h><w>liamd</w>i suppose i’d want to check that the output is non-nil and &gt; 0? but that doesn’t seem to ensure the logic of it</z><z id="t1475259356" t="liamd is this too simple for property based testing?"><y>#</y><d>2016-09-30</d><h>18:15</h><w>liamd</w>is this too simple for property based testing?</z><z id="t1475267096" t="lucasbradstreet It’s a pretty simple function, so it might be hard to come up with something much better. You could check whether the returned x is &lt;= to the position x"><y>#</y><d>2016-09-30</d><h>20:24</h><w>lucasbradstreet</w>It’s a pretty simple function, so it might be hard to come up with something much better. You could check whether the returned x is &lt;= to the position x</z><z id="t1475273857" t="gfredericks you could probably come up with a distance-scaling property"><y>#</y><d>2016-09-30</d><h>22:17</h><w>gfredericks</w>you could probably come up with a distance-scaling property</z><z id="t1475273874" t="gfredericks a relationship between (distance p1 p2) and (distance (f p1) (f p2))"><y>#</y><d>2016-09-30</d><h>22:17</h><w>gfredericks</w>a relationship between (distance p1 p2) and (distance (f p1) (f p2))</z><z id="t1475273915" t="gfredericks or more generally the 2d-vector representing the offset between them"><y>#</y><d>2016-09-30</d><h>22:18</h><w>gfredericks</w>or more generally the 2d-vector representing the offset between them</z><z id="t1475334956" t="gfredericks another idea: &quot;adjacent pixels are mapped to the same or adjacent tiles&quot;"><y>#</y><d>2016-10-01</d><h>15:15</h><w>gfredericks</w>another idea: &quot;adjacent pixels are mapped to the same or adjacent tiles&quot;</z><z id="t1477320340" t="nwjsmith Has anyone had experience adding &apos;famous&apos; examples to their test.check runs?"><y>#</y><d>2016-10-24</d><h>14:45</h><w>nwjsmith</w>Has anyone had experience adding &apos;famous&apos; examples to their test.check runs?</z><z id="t1477320423" t="nwjsmith I think it would be valuable for regression testing, but I suppose that&apos;s what clojure.test is for."><y>#</y><d>2016-10-24</d><h>14:47</h><w>nwjsmith</w>I think it would be valuable for regression testing, but I suppose that&apos;s what clojure.test is for.</z><z id="t1477322918" t="hiredman I think the same thing that would let you do that, also makes it easier to run you test over and over again with a given set of inputs if you do hit a failure, which is useful when you do find a failure"><y>#</y><d>2016-10-24</d><h>15:28</h><w>hiredman</w>I think the same thing that would let you do that, also makes it easier to run you test over and over again with a given set of inputs if you do hit a failure, which is useful when you do find a failure</z><z id="t1477322961" t="hiredman the way to do that, I think, is to have your, uh, assertions, as separate functions"><y>#</y><d>2016-10-24</d><h>15:29</h><w>hiredman</w>the way to do that, I think, is to have your, uh, assertions, as separate functions</z><z id="t1477322981" t="hiredman which you can call from properties or other tests"><y>#</y><d>2016-10-24</d><h>15:29</h><w>hiredman</w>which you can call from properties or other tests</z><z id="t1477323085" t="nwjsmith That would work"><y>#</y><d>2016-10-24</d><h>15:31</h><w>nwjsmith</w>That would work</z><z id="t1477323362" t="nwjsmith I&apos;m experimenting with using spec/test.check to do TDD. It&apos;s proving more challenging than I thought it would be. Often it&apos;s easier to come up with an example than a property/invariant."><y>#</y><d>2016-10-24</d><h>15:36</h><w>nwjsmith</w>I&apos;m experimenting with using spec/test.check to do TDD. It&apos;s proving more challenging than I thought it would be. Often it&apos;s easier to come up with an example than a property/invariant.</z><z id="t1477334614" t="gfredericks writing properties takes practice"><y>#</y><d>2016-10-24</d><h>18:43</h><w>gfredericks</w>writing properties takes practice</z><z id="t1477334632" t="gfredericks &quot;I don&apos;t know what properties to write&quot; is a common problem people run into at first"><y>#</y><d>2016-10-24</d><h>18:43</h><w>gfredericks</w>&quot;I don&apos;t know what properties to write&quot; is a common problem people run into at first</z><z id="t1477334727" t="Alex Miller (Clojure team) the only hard parts of property testing are the generators and the properties"><y>#</y><d>2016-10-24</d><h>18:45</h><w>Alex Miller (Clojure team)</w>the only hard parts of property testing are the generators and the properties</z><z id="t1477334747" t="Alex Miller (Clojure team) ;)"><y>#</y><d>2016-10-24</d><h>18:45</h><w>Alex Miller (Clojure team)</w>;)</z><z id="t1477335412" t="nwjsmith I better get practicing then 🙂 Hopefully in a few years, there will be much more guidance on how to do property-based testing. There&apos;s so much out there on example-based now."><y>#</y><d>2016-10-24</d><h>18:56</h><w>nwjsmith</w>I better get practicing then <b>🙂</b> Hopefully in a few years, there will be much more guidance on how to do property-based testing. There&apos;s so much out there on example-based now.</z><z id="t1477575100" t="Yehonathan Sharvit https://twitter.com/viebel/status/791633195016003584"><y>#</y><d>2016-10-27</d><h>13:31</h><w>Yehonathan Sharvit</w><a href="https://twitter.com/viebel/status/791633195016003584" target="_blank">https://twitter.com/viebel/status/791633195016003584</a></z><z id="t1477575132" t="Yehonathan Sharvit what do you guys think of this interactive tutorial? Did you learn something about test.check ?"><y>#</y><d>2016-10-27</d><h>13:32</h><w>Yehonathan Sharvit</w>what do you guys think of this interactive tutorial? Did you learn something about <code>test.check</code>?</z><z id="t1477576008" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0L91U7A8&quot;}] : oh sweet! 👍 I&apos;ll give it a go when I get home and will let you know if I have any comments "><y>#</y><d>2016-10-27</d><h>13:46</h><w>lucasbradstreet</w><a>@viebel</a>: oh sweet! <b>👍</b>I&apos;ll give it a go when I get home and will let you know if I have any comments </z><z id="t1477576091" t="Yehonathan Sharvit [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] It’s kind of the same idea as the onyx tutorial [:attrs {:href &quot;/_/_/users/U050A65BL&quot;}] shared on #onyx but it has much more content. It’s all about Code Interactivity in the browser."><y>#</y><d>2016-10-27</d><h>13:48</h><w>Yehonathan Sharvit</w><a>@lucasbradstreet</a>  It’s kind of the same idea as the onyx tutorial <a>@michaeldrogalis</a> shared on #onyx but it has much more content. It’s all about Code Interactivity in the browser.</z><z id="t1477596721" t="Yehonathan Sharvit [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] test.check official doc with klipse will look like this"><y>#</y><d>2016-10-27</d><h>19:32</h><w>Yehonathan Sharvit</w><a>@lucasbradstreet</a> test.check official doc with klipse will look like this</z><z id="t1477596740" t="Yehonathan Sharvit https://viebel.github.io/klipse/examples/test.check/doc/generator-examples.html https://viebel.github.io/klipse/examples/test.check/doc/clojure.test.check.html#var-quick-check"><y>#</y><d>2016-10-27</d><h>19:32</h><w>Yehonathan Sharvit</w><a href="https://viebel.github.io/klipse/examples/test.check/doc/generator-examples.html" target="_blank">https://viebel.github.io/klipse/examples/test.check/doc/generator-examples.html</a>

<a href="https://viebel.github.io/klipse/examples/test.check/doc/clojure.test.check.html#var-quick-check" target="_blank">https://viebel.github.io/klipse/examples/test.check/doc/clojure.test.check.html#var-quick-check</a></z><z id="t1477635303" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0L91U7A8&quot;}] so great!"><y>#</y><d>2016-10-28</d><h>06:15</h><w>lucasbradstreet</w><a>@viebel</a> so great!</z><z id="t1477635347" t="Yehonathan Sharvit [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] which one? the blog post or the interactive doc?"><y>#</y><d>2016-10-28</d><h>06:15</h><w>Yehonathan Sharvit</w><a>@lucasbradstreet</a>  which one? the blog post or the interactive doc?</z><z id="t1477635573" t="lucasbradstreet Both are great. I love the docs versions with inline testable examples though. I want it everywhere 😄"><y>#</y><d>2016-10-28</d><h>06:19</h><w>lucasbradstreet</w>Both are great. I love the docs versions with inline testable examples though. I want it everywhere <b>😄</b></z><z id="t1477635691" t="lucasbradstreet In the example where the property is incorrect i.e. (let [s (sort v)] (&lt; (first s) (last s))))) it might be useful to say that both properties and the code they test can be incorrect. Usually you’re trying to start from a correct property and find a bug in your code, but sometimes your code ends up testing your properties instead. I’m not sure how obvious it’ll be to a new user"><y>#</y><d>2016-10-28</d><h>06:21</h><w>lucasbradstreet</w>In the example where the property is incorrect i.e. 
(let [s (sort v)]
  (&lt; (first s) (last s)))))
it might be useful to say that both properties and the code they test can be incorrect. Usually you’re trying to start from a correct property and find a bug in your code, but sometimes your code ends up testing your properties instead. I’m not sure how obvious it’ll be to a new user</z><z id="t1477656881" t="Yehonathan Sharvit good input"><y>#</y><d>2016-10-28</d><h>12:14</h><w>Yehonathan Sharvit</w>good input</z><z id="t1477656889" t="Yehonathan Sharvit how would you fix it [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] ?"><y>#</y><d>2016-10-28</d><h>12:14</h><w>Yehonathan Sharvit</w>how would you fix it <a>@lucasbradstreet</a> ?</z><z id="t1477656981" t="Yehonathan Sharvit [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] you can live interactive doc with the codox klipse theme. It’s super easy to integrate in any lib that is cljs ported"><y>#</y><d>2016-10-28</d><h>12:16</h><w>Yehonathan Sharvit</w><a>@lucasbradstreet</a> you can live interactive doc with the codox klipse  theme. It’s super easy to integrate in any lib that is cljs ported</z><z id="t1477656996" t="Yehonathan Sharvit https://github.com/viebel/codox-klipse-theme"><y>#</y><d>2016-10-28</d><h>12:16</h><w>Yehonathan Sharvit</w><a href="https://github.com/viebel/codox-klipse-theme" target="_blank">https://github.com/viebel/codox-klipse-theme</a></z><z id="t1478380741" t="gfredericks I&apos;m messing around with a protocol for returning data with a trial: https://github.com/clojure/test.check/commit/a7860f25a4d6755e71d5fc13907279e16059c1f5"><y>#</y><d>2016-11-05</d><h>21:19</h><w>gfredericks</w>I&apos;m messing around with a protocol for returning data with a trial: <a href="https://github.com/clojure/test.check/commit/a7860f25a4d6755e71d5fc13907279e16059c1f5" target="_blank">https://github.com/clojure/test.check/commit/a7860f25a4d6755e71d5fc13907279e16059c1f5</a></z><z id="t1478636318" t="mattly is there any way to tell test.check to give up and just show me the smallest failing result so far after a certain number of iterations?"><y>#</y><d>2016-11-08</d><h>20:18</h><w>mattly</w>is there any way to tell test.check to give up and just show me the smallest failing result so far after a certain number of iterations?</z><z id="t1478636337" t="mattly I&apos;ve got one failure that I&apos;m having a really hard time tracking down, but it&apos;ll run for 100k iterations without settling"><y>#</y><d>2016-11-08</d><h>20:18</h><w>mattly</w>I&apos;ve got one failure that I&apos;m having a really hard time tracking down, but it&apos;ll run for 100k iterations without settling</z><z id="t1478640558" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] there are a couple tickets surrounding that"><y>#</y><d>2016-11-08</d><h>21:29</h><w>gfredericks</w><a>@mattly</a> there are a couple tickets surrounding that</z><z id="t1478640610" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] there is also a callback function you can register on the master branch, that would let you &quot;listen&quot; for things as it&apos;s shrinking"><y>#</y><d>2016-11-08</d><h>21:30</h><w>gfredericks</w><a>@mattly</a> there is also a callback function you can register on the master branch, that would let you &quot;listen&quot; for things as it&apos;s shrinking</z><z id="t1478640674" t="gfredericks there&apos;s a ticket for a max-shrink-time option, and for capturing C-c interruptions and returning the smallest value so far"><y>#</y><d>2016-11-08</d><h>21:31</h><w>gfredericks</w>there&apos;s a ticket for a max-shrink-time option, and for capturing C-c interruptions and returning the smallest value so far</z><z id="t1478640694" t="gfredericks I think the latter one is hairy though so I don&apos;t know if it will get implemented :/"><y>#</y><d>2016-11-08</d><h>21:31</h><w>gfredericks</w>I think the latter one is hairy though so I don&apos;t know if it will get implemented :/</z><z id="t1478640755" t="gfredericks C-c would probably be the most useful, so if it turns out to be straightforward I would love to add it"><y>#</y><d>2016-11-08</d><h>21:32</h><w>gfredericks</w><code>C-c</code> would probably be the most useful, so if it turns out to be straightforward I would love to add it</z><z id="t1478640802" t="gfredericks if it&apos;s hairy it&apos;s probably because of varying details in different repls vs. unix signals when running test processes and that sort of thing"><y>#</y><d>2016-11-08</d><h>21:33</h><w>gfredericks</w>if it&apos;s hairy it&apos;s probably because of varying details in different repls vs. unix signals when running test processes and that sort of thing</z><z id="t1478641898" t="mattly oh fun"><y>#</y><d>2016-11-08</d><h>21:51</h><w>mattly</w>oh fun</z><z id="t1478680346" t="lucasbradstreet max-shrink-time would be nice. I sometimes resort to dumping the first shrink and then manually shrinking it via other strategies for some of my tests. The callback function would be awesome though - even selectively printing the failures as it shrinks would be helpful"><y>#</y><d>2016-11-09</d><h>08:32</h><w>lucasbradstreet</w>max-shrink-time would be nice. I sometimes resort to dumping the first shrink and then manually shrinking it via other strategies for some of my tests. The callback function would be awesome though - even selectively printing the failures as it shrinks would be helpful</z><z id="t1478697611" t="gfredericks I figured max-shrink time would be useful for CI"><y>#</y><d>2016-11-09</d><h>13:20</h><w>gfredericks</w>I figured max-shrink time would be useful for CI</z><z id="t1478697655" t="lucasbradstreet Absolutely"><y>#</y><d>2016-11-09</d><h>13:20</h><w>lucasbradstreet</w>Absolutely</z><z id="t1478697681" t="lucasbradstreet Even just printing the seed before a shrink would be helpful, to be honest."><y>#</y><d>2016-11-09</d><h>13:21</h><w>lucasbradstreet</w>Even just printing the seed before a shrink would be helpful, to be honest.</z><z id="t1478697711" t="lucasbradstreet Or giving us a way to do so. The callback idea would work though."><y>#</y><d>2016-11-09</d><h>13:21</h><w>lucasbradstreet</w>Or giving us a way to do so. The callback idea would work though.</z><z id="t1478698402" t="gfredericks Well the callback is already implemented simple_smile "><y>#</y><d>2016-11-09</d><h>13:33</h><w>gfredericks</w>Well the callback is already implemented <b>simple_smile</b> </z><z id="t1478698710" t="lucasbradstreet Looking forward to trying it"><y>#</y><d>2016-11-09</d><h>13:38</h><w>lucasbradstreet</w>Looking forward to trying it</z><z id="t1478843849" t="mattly I have a wrapper around test.chuck&apos;s checking that prints iteration count as it goes solely to prevent CI from timing out 😄"><y>#</y><d>2016-11-11</d><h>05:57</h><w>mattly</w>I have a wrapper around test.chuck&apos;s <code>checking</code> that prints iteration count as it goes solely to prevent CI from timing out <b>😄</b></z><z id="t1478843861" t="mattly well, and a nice guide for me"><y>#</y><d>2016-11-11</d><h>05:57</h><w>mattly</w>well, and a nice guide for me</z><z id="t1478863460" t="lucasbradstreet Cool"><y>#</y><d>2016-11-11</d><h>11:24</h><w>lucasbradstreet</w>Cool</z><z id="t1478874064" t="gfredericks ha"><y>#</y><d>2016-11-11</d><h>14:21</h><w>gfredericks</w>ha</z><z id="t1478874079" t="gfredericks I hadn&apos;t thought about a CI that times out only when you stop printing"><y>#</y><d>2016-11-11</d><h>14:21</h><w>gfredericks</w>I hadn&apos;t thought about a CI that times out only when you stop printing</z><z id="t1479127355" t="gfredericks I&apos;m trying to figure out if prop/for-all could be changed to support clojure.test assertions without breaking anything"><y>#</y><d>2016-11-14</d><h>12:42</h><w>gfredericks</w>I&apos;m trying to figure out if <code>prop/for-all</code> could be changed to support <code>clojure.test</code> assertions without breaking anything</z><z id="t1479127372" t="gfredericks either all the time, or only when using defspec (not sure which of those is better to aim for)"><y>#</y><d>2016-11-14</d><h>12:42</h><w>gfredericks</w>either all the time, or only when using <code>defspec</code> (not sure which of those is better to aim for)</z><z id="t1479128204" t="nberger That would be awesome. At first glance I&apos;d say that having it in defspec and providing an easy way to use it when not in defspec should be enough"><y>#</y><d>2016-11-14</d><h>12:56</h><w>nberger</w>That would be awesome. At first glance I&apos;d say that having it in <code>defspec</code> and providing an easy way to use it when not in <code>defspec</code> should be enough</z><z id="t1479128660" t="gfredericks I was hoping to make it just start working, without adding any new functions/macros"><y>#</y><d>2016-11-14</d><h>13:04</h><w>gfredericks</w>I was hoping to make it just start working, without adding any new functions/macros</z><z id="t1479128686" t="gfredericks i.e., if you put assertions in the body of your prop/for-all , it bases pass/failure on that instead of the expression return value"><y>#</y><d>2016-11-14</d><h>13:04</h><w>gfredericks</w>i.e., if you put assertions in the body of your <code>prop/for-all</code>, it bases pass/failure on that instead of the expression return value</z><z id="t1479128744" t="gfredericks if new functions/macros are okay, then just adding a clojure.test.check.clojure-test/for-all would work"><y>#</y><d>2016-11-14</d><h>13:05</h><w>gfredericks</w>if new functions/macros are okay, then just adding a <code>clojure.test.check.clojure-test/for-all</code> would work</z><z id="t1479128864" t="gfredericks actually I just thought about it a bit, and the edge cases involved in having both behaviors in the same macro are kind of nasty"><y>#</y><d>2016-11-14</d><h>13:07</h><w>gfredericks</w>actually I just thought about it a bit, and the edge cases involved in having both behaviors in the same macro are kind of nasty</z><z id="t1479128906" t="gfredericks edge cases meaning how things play out if you accidentally do or don&apos;t include assertions"><y>#</y><d>2016-11-14</d><h>13:08</h><w>gfredericks</w>edge cases meaning how things play out if you accidentally do or don&apos;t include assertions</z><z id="t1479128924" t="gfredericks I may have just talked myself out of it"><y>#</y><d>2016-11-14</d><h>13:08</h><w>gfredericks</w>I may have just talked myself out of it</z><z id="t1479212892" t="gfredericks [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] I&apos;m curious if there&apos;s a cleaner way to implement statistics using this: https://github.com/clojure/test.check/commit/4450152532eeaace449ca9241673428a19448eba"><y>#</y><d>2016-11-15</d><h>12:28</h><w>gfredericks</w><a>@nberger</a> I&apos;m curious if there&apos;s a cleaner way to implement statistics using this: <a href="https://github.com/clojure/test.check/commit/4450152532eeaace449ca9241673428a19448eba" target="_blank">https://github.com/clojure/test.check/commit/4450152532eeaace449ca9241673428a19448eba</a></z><z id="t1479213234" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I think so. I&apos;ll play with it in the next few days. I already started rebasing the stats branch to the current master, playing with this will be my next task"><y>#</y><d>2016-11-15</d><h>12:33</h><w>nberger</w><a>@gfredericks</a> I think so. I&apos;ll play with it in the next few days. I already started rebasing the stats branch to the current master, playing with this will be my next task</z><z id="t1479213773" t="nberger but not &quot;as is&quot;: we need a way to carry the labels over the quick check loop, but result is not passed over on passing trials (neither to the recur or to the reporter-fn :trial ). I&apos;m looking at https://github.com/clojure/test.check/blob/4450152532eeaace449ca9241673428a19448eba/src/main/clojure/clojure/test/check.cljc#L101-L105"><y>#</y><d>2016-11-15</d><h>12:42</h><w>nberger</w>but not &quot;as is&quot;: we need a way to carry the labels over the quick check loop, but result is not passed over on passing trials (neither to the recur or to the <code>reporter-fn :trial</code>). I&apos;m looking at <a href="https://github.com/clojure/test.check/blob/4450152532eeaace449ca9241673428a19448eba/src/main/clojure/clojure/test/check.cljc#L101-L105" target="_blank">https://github.com/clojure/test.check/blob/4450152532eeaace449ca9241673428a19448eba/src/main/clojure/clojure/test/check.cljc#L101-L105</a></z><z id="t1479213964" t="nberger We especially need to pass it in some way in that recur call. But passing result doesn&apos;t make much sense to me"><y>#</y><d>2016-11-15</d><h>12:46</h><w>nberger</w>We especially need to pass it in some way in that recur call. But passing <code>result</code> doesn&apos;t make much sense to me</z><z id="t1479214078" t="gfredericks right"><y>#</y><d>2016-11-15</d><h>12:47</h><w>gfredericks</w>right</z><z id="t1479214102" t="gfredericks it might not make any sense"><y>#</y><d>2016-11-15</d><h>12:48</h><w>gfredericks</w>it might not make any sense</z><z id="t1479214108" t="gfredericks just struck me as a somewhat overlapping bit of functionality"><y>#</y><d>2016-11-15</d><h>12:48</h><w>gfredericks</w>just struck me as a somewhat overlapping bit of functionality</z><z id="t1479214131" t="nberger yeah"><y>#</y><d>2016-11-15</d><h>12:48</h><w>nberger</w>yeah</z><z id="t1479214783" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] have you thought of turning the quickcheck loop into a reduce, where some &quot;bigger&quot; state is carried over, including the rng-state, the labels, test count... well all the state that is passed over in the recur but in a way that it would be easier to add stuff like the stats labels?"><y>#</y><d>2016-11-15</d><h>12:59</h><w>nberger</w><a>@gfredericks</a> have you thought of turning the quickcheck loop into a reduce, where some &quot;bigger&quot; state is carried over, including the rng-state, the labels, test count... well all the state that is passed over in the recur but in a way that it would be easier to add stuff like the stats labels?</z><z id="t1479215123" t="nberger I&apos;ve been thinking around that idea for some time, but never got to play with it. At first sight seems like it should work. I think haskell&apos;s quickcheck works that way, I&apos;m looking at https://github.com/nick8325/quickcheck/blob/master/Test/QuickCheck/Property.hs#L370 . Even though my haskell fu is very limited, and that the function is called mapTotalResult , I think it&apos;s a reduce 🙂"><y>#</y><d>2016-11-15</d><h>13:05</h><w>nberger</w>I&apos;ve been thinking around that idea for some time, but never got to play with it. At first sight seems like it should work.
I think haskell&apos;s quickcheck works that way, I&apos;m looking at <a href="https://github.com/nick8325/quickcheck/blob/master/Test/QuickCheck/Property.hs#L370" target="_blank">https://github.com/nick8325/quickcheck/blob/master/Test/QuickCheck/Property.hs#L370</a>. Even though my haskell fu is very limited, and that the function is called <code>mapTotalResult</code>, I think it&apos;s a reduce <b>🙂</b></z><z id="t1479215234" t="nberger For anyone wondering what statistics are we talking about, it&apos;s on http://dev.clojure.org/jira/browse/TCHECK-87"><y>#</y><d>2016-11-15</d><h>13:07</h><w>nberger</w>For anyone wondering what statistics are we talking about, it&apos;s on <a href="http://dev.clojure.org/jira/browse/TCHECK-87" target="_blank">http://dev.clojure.org/jira/browse/TCHECK-87</a></z><z id="t1479215287" t="gfredericks I was monkeying with the quickcheck loop when I was trying to do parallel tests"><y>#</y><d>2016-11-15</d><h>13:08</h><w>gfredericks</w>I was monkeying with the quickcheck loop when I was trying to do parallel tests</z><z id="t1479215300" t="gfredericks which changes the linearity of the reduce"><y>#</y><d>2016-11-15</d><h>13:08</h><w>gfredericks</w>which changes the linearity of the reduce</z><z id="t1479215309" t="gfredericks but I think it is a reduce, yeah"><y>#</y><d>2016-11-15</d><h>13:08</h><w>gfredericks</w>but I think it is a reduce, yeah</z><z id="t1479389597" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I just uploaded an updated patch for TCHECK-87 which is basically the old patch rebased to the current master + some polishing. Definitely not a final patch but in a better shape to experiment with it. And here&apos;s a nice diff: https://github.com/clojure/test.check/compare/master...nberger:stats-generator 🙂"><y>#</y><d>2016-11-17</d><h>13:33</h><w>nberger</w><a>@gfredericks</a> I just uploaded an updated patch for TCHECK-87 which is basically the old patch rebased to the current master + some polishing. Definitely not a final patch but in a better shape to experiment with it. And here&apos;s a nice diff: <a href="https://github.com/clojure/test.check/compare/master...nberger:stats-generator" target="_blank">https://github.com/clojure/test.check/compare/master...nberger:stats-generator</a> <b>🙂</b></z><z id="t1479390229" t="gfredericks [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] you&apos;re not coming to the conj, are you? "><y>#</y><d>2016-11-17</d><h>13:43</h><w>gfredericks</w><a>@nberger</a> you&apos;re not coming to the conj, are you? </z><z id="t1479392812" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I don&apos;t think so..."><y>#</y><d>2016-11-17</d><h>14:26</h><w>nberger</w><a>@gfredericks</a> I don&apos;t think so...</z><z id="t1479399755" t="gfredericks :/"><y>#</y><d>2016-11-17</d><h>16:22</h><w>gfredericks</w>:/</z><z id="t1479733113" t="gfredericks just added the result-data feature to master: https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179"><y>#</y><d>2016-11-21</d><h>12:58</h><w>gfredericks</w>just added the result-data feature to master: <a href="https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179" target="_blank">https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179</a></z><z id="t1479733284" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] ⇑ that should allow clojure.spec to not need to wrap failure data in an exception"><y>#</y><d>2016-11-21</d><h>13:01</h><w>gfredericks</w><a>@alexmiller</a> ⇑ that should allow clojure.spec to not need to wrap failure data in an exception</z><z id="t1479733642" t="gfredericks actually taking advantage of that would mean that clojure.spec requires the next release of test.check; so I&apos;m curious A) if that&apos;s reasonable, and B) if so, whether it&apos;s time for me to start panicking about finishing a test.check release before clojure-1.9 is ready"><y>#</y><d>2016-11-21</d><h>13:07</h><w>gfredericks</w>actually taking advantage of that would mean that clojure.spec requires the next release of test.check; so I&apos;m curious A) if that&apos;s reasonable, and B) if so, whether it&apos;s time for me to start panicking about finishing a test.check release before clojure-1.9 is ready</z><z id="t1479738627" t="Alex Miller (Clojure team) to be discussed"><y>#</y><d>2016-11-21</d><h>14:30</h><w>Alex Miller (Clojure team)</w>to be discussed</z><z id="t1479738691" t="Alex Miller (Clojure team) I’m working hard on the build server right now, hoping to get it up to the point where I can actually build test.check normally again"><y>#</y><d>2016-11-21</d><h>14:31</h><w>Alex Miller (Clojure team)</w>I’m working hard on the build server right now, hoping to get it up to the point where I can actually build test.check normally again</z><z id="t1479738710" t="Alex Miller (Clojure team) it’s not like 1.9 is imminent or anything"><y>#</y><d>2016-11-21</d><h>14:31</h><w>Alex Miller (Clojure team)</w>it’s not like 1.9 is imminent or anything</z><z id="t1479739302" t="gfredericks Ok, I won&apos;t want to build anything for at least a week; I&apos;m thinking of doing an alpha first, so people can use new stuff with the clojure 1.9 alphas"><y>#</y><d>2016-11-21</d><h>14:41</h><w>gfredericks</w>Ok, I won&apos;t want to build anything for at least a week; I&apos;m thinking of doing an alpha first, so people can use new stuff with the clojure 1.9 alphas</z><z id="t1479739579" t="Alex Miller (Clojure team) are you going to be at the conj?"><y>#</y><d>2016-11-21</d><h>14:46</h><w>Alex Miller (Clojure team)</w>are you going to be at the conj?</z><z id="t1479742374" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] yep"><y>#</y><d>2016-11-21</d><h>15:32</h><w>gfredericks</w><a>@alexmiller</a> yep</z><z id="t1479742921" t="Alex Miller (Clojure team) cool, we should chat at some point"><y>#</y><d>2016-11-21</d><h>15:42</h><w>Alex Miller (Clojure team)</w>cool, we should chat at some point</z><z id="t1479744911" t="gfredericks I&apos;ll make sure that happens"><y>#</y><d>2016-11-21</d><h>16:15</h><w>gfredericks</w>I&apos;ll make sure that happens</z><z id="t1479756304" t="dangit Are people using test.check and midje together? Putting a tc/defspec instead a midje/fact doesn’t seem to do much."><y>#</y><d>2016-11-21</d><h>19:25</h><w>dangit</w>Are people using test.check and midje together? Putting a <code>tc/defspec</code> instead a <code>midje/fact</code> doesn’t seem to do much.</z><z id="t1479756763" t="gfredericks [:attrs {:href &quot;/_/_/users/U152X7205&quot;}] could you share some code? I can&apos;t tell what you mean exactly"><y>#</y><d>2016-11-21</d><h>19:32</h><w>gfredericks</w><a>@dangit</a> could you share some code? I can&apos;t tell what you mean exactly</z><z id="t1479756793" t="gfredericks I dont&apos; know how midje integrates with clojure.test, but presumably you could intermingle those integrations"><y>#</y><d>2016-11-21</d><h>19:33</h><w>gfredericks</w>I dont&apos; know how midje integrates with clojure.test, but presumably you could intermingle those integrations</z><z id="t1479756809" t="gfredericks defspec looks just like a regular clojure.test/deftest from clojure.test&apos;s perspective"><y>#</y><d>2016-11-21</d><h>19:33</h><w>gfredericks</w>defspec looks just like a regular <code>clojure.test/deftest</code> from clojure.test&apos;s perspective</z><z id="t1479757291" t="dangit Yeah, I’m a bit of a newb, shoving a deftest inside a midje fact was just a guess. I tried this: (facts &quot;about numbers&quot; (fact &quot;a number is anything&quot; 4 =&gt; anything) (defspec inc-test 100 (prop/for-all [v gen/int] (= (inc v) (+ 2 v))))) hoping midje would figure out what was going on but the result is: &gt;&gt;&gt; Output from clojure.test tests: FAIL in (inc-test) (clojure_test.cljc:21) expected: result actual: false 1 failures, 0 errors. &gt;&gt;&gt; Midje summary: All checks (1) succeeded. Subprocess failed So the failure triggers, but midje thinks everything is fine."><y>#</y><d>2016-11-21</d><h>19:41</h><w>dangit</w>Yeah, I’m a bit of a newb, shoving a deftest inside a midje fact was just a guess. I tried this:
<pre>(facts &quot;about numbers&quot;
  (fact &quot;a number is anything&quot;
    4 =&gt; anything)
  (defspec inc-test
    100
    (prop/for-all [v gen/int]
                  (= (inc v) (+ 2 v)))))
</pre>
hoping midje would figure out what was going on but the result is:
<pre>&gt;&gt;&gt; Output from clojure.test tests:

FAIL in (inc-test) (clojure_test.cljc:21)
expected: result
  actual: false

1 failures, 0 errors.
&gt;&gt;&gt; Midje summary:
All checks (1) succeeded.
Subprocess failed</pre>

So the failure triggers, but midje thinks everything is fine.</z><z id="t1479757921" t="gfredericks defspec will only work at the top level; I don&apos;t know whether your test-runner is just clojure.test or if it&apos;s midje-specific, and that would determine whether your top-level defspec actually gets runs"><y>#</y><d>2016-11-21</d><h>19:52</h><w>gfredericks</w>defspec will only work at the top level; I don&apos;t know whether your test-runner is just clojure.test or if it&apos;s midje-specific, and that would determine whether your top-level defspec actually gets runs</z><z id="t1479757950" t="gfredericks but if you like the nesting there&apos;s probably some way to run a generative test inside the facts macro"><y>#</y><d>2016-11-21</d><h>19:52</h><w>gfredericks</w>but if you like the nesting there&apos;s probably some way to run a generative test inside the <code>facts</code> macro</z><z id="t1479757960" t="gfredericks maybe by calling clojure.test.check/quick-check directly"><y>#</y><d>2016-11-21</d><h>19:52</h><w>gfredericks</w>maybe by calling <code>clojure.test.check/quick-check</code> directly</z><z id="t1479758017" t="gfredericks I don&apos;t know midje but I assume in the worst case you could do something like (fact &quot;this property holds&quot; (boolean (:result (quick-check 100 (prop/for-all ...)))) =&gt; true)"><y>#</y><d>2016-11-21</d><h>19:53</h><w>gfredericks</w>I don&apos;t know midje but I assume in the worst case you could do something like <code>(fact &quot;this property holds&quot; (boolean (:result (quick-check 100 (prop/for-all ...)))) =&gt; true)</code></z><z id="t1479758032" t="gfredericks so the only question is what&apos;s the best way to make that less tedious"><y>#</y><d>2016-11-21</d><h>19:53</h><w>gfredericks</w>so the only question is what&apos;s the best way to make that less tedious</z><z id="t1479758048" t="gfredericks which I can&apos;t guess at, not knowing midje"><y>#</y><d>2016-11-21</d><h>19:54</h><w>gfredericks</w>which I can&apos;t guess at, not knowing midje</z><z id="t1479758049" t="dangit I’m just running lein midje/using midje’s autotest. The test is definitely getting run, it just seems like a hack what I’m doing now. Calling quick-check directly is a sane idea. 🙂"><y>#</y><d>2016-11-21</d><h>19:54</h><w>dangit</w>I’m just running lein midje/using midje’s autotest. The test is definitely getting run, it just seems like a hack what I’m doing now. Calling quick-check directly is a sane idea. <b>🙂</b></z><z id="t1479758091" t="dangit Yeah, ok, thanks! I’ll play around with it a bit more."><y>#</y><d>2016-11-21</d><h>19:54</h><w>dangit</w>Yeah, ok, thanks! I’ll play around with it a bit more.</z><z id="t1479758102" t="gfredericks np"><y>#</y><d>2016-11-21</d><h>19:55</h><w>gfredericks</w>np</z><z id="t1480428296" t="nberger I just created a ticket with a patch proposing a refactor to the quick-check loop that includes a clean way to provide feedback during the test run and also to augment/modify the state carried over during the process, making it easy to implement things like early abort, calculating statistics, adding timestamps at different steps of the process, etc. Feel free to give your feedback in http://dev.clojure.org/jira/browse/TCHECK-126"><y>#</y><d>2016-11-29</d><h>14:04</h><w>nberger</w>I just created a ticket with a patch proposing a refactor to the quick-check loop that includes a clean way to provide feedback during the test run and also to augment/modify the state carried over during the process, making it easy to implement things like early abort, calculating statistics, adding timestamps at different steps of the process, etc. Feel free to give your feedback in <a href="http://dev.clojure.org/jira/browse/TCHECK-126" target="_blank">http://dev.clojure.org/jira/browse/TCHECK-126</a></z><z id="t1480431007" t="gfredericks That would be an interesting extension point for users"><y>#</y><d>2016-11-29</d><h>14:50</h><w>gfredericks</w>That would be an interesting extension point for users</z><z id="t1480431155" t="gfredericks transducers might have something to do with this"><y>#</y><d>2016-11-29</d><h>14:52</h><w>gfredericks</w>transducers might have something to do with this</z><z id="t1480437937" t="nberger I&apos;d like to hear more about your transducers idea :)"><y>#</y><d>2016-11-29</d><h>16:45</h><w>nberger</w>I&apos;d like to hear more about your transducers idea :)</z><z id="t1480441349" t="gfredericks It might be thwarted by the irregularity of the shrinking phase"><y>#</y><d>2016-11-29</d><h>17:42</h><w>gfredericks</w>It might be thwarted by the irregularity of the shrinking phase</z><z id="t1480441428" t="gfredericks But transducers are maybe related in that they separate the sequence processing logic from the orchestration, so that you can do things like swap in async orchestration"><y>#</y><d>2016-11-29</d><h>17:43</h><w>gfredericks</w>But transducers are maybe related in that they separate the sequence processing logic from the orchestration, so that you can do things like swap in async orchestration</z><z id="t1480441462" t="gfredericks It would be cool if parallelism where swappinable too, but I don&apos;t think transducers are amenable to that"><y>#</y><d>2016-11-29</d><h>17:44</h><w>gfredericks</w>It would be cool if parallelism where swappinable too, but I don&apos;t think transducers are amenable to that</z><z id="t1480442547" t="Alex Miller (Clojure team) not currently"><y>#</y><d>2016-11-29</d><h>18:02</h><w>Alex Miller (Clojure team)</w>not currently</z><z id="t1480443686" t="gfredericks I spent a lot of braintime trying to figure out how to do something transducerlike with the test.check shrink-tree but I think it seemed to hard to do while allowing the shrinking algorithm to do whatever it wanted"><y>#</y><d>2016-11-29</d><h>18:21</h><w>gfredericks</w>I spent a lot of braintime trying to figure out how to do something transducerlike with the test.check shrink-tree but I think it seemed to hard to do while allowing the shrinking algorithm to do whatever it wanted</z><z id="t1480443722" t="gfredericks I forget what problem I was trying to solve exactly; probably just vague performance"><y>#</y><d>2016-11-29</d><h>18:22</h><w>gfredericks</w>I forget what problem I was trying to solve exactly; probably just vague performance</z><z id="t1481212770" t="nwjsmith Is there a way to observe how a generator shrinks?"><y>#</y><d>2016-12-08</d><h>15:59</h><w>nwjsmith</w>Is there a way to observe how a generator shrinks?</z><z id="t1481212798" t="nwjsmith Like sample , but starting from a “big” generated value and then shrinking down?"><y>#</y><d>2016-12-08</d><h>15:59</h><w>nwjsmith</w>Like <code>sample</code>, but starting from a “big” generated value and then shrinking down?</z><z id="t1481222753" t="gfredericks theoretically yes, there&apos;s just not an easy function included that does this"><y>#</y><d>2016-12-08</d><h>18:45</h><w>gfredericks</w>theoretically yes, there&apos;s just not an easy function included that does this</z><z id="t1481222782" t="gfredericks I&apos;ve written it once or twice, it&apos;s only a few lines; I probably don&apos;t have one handy though"><y>#</y><d>2016-12-08</d><h>18:46</h><w>gfredericks</w>I&apos;ve written it once or twice, it&apos;s only a few lines; I probably don&apos;t have one handy though</z><z id="t1481222817" t="gfredericks your request can be interpreted a couple of different ways though"><y>#</y><d>2016-12-08</d><h>18:46</h><w>gfredericks</w>your request can be interpreted a couple of different ways though</z><z id="t1481223090" t="gfredericks default shrinks are going to be less interesting; e.g., if your generator is (gen/vector gen-some-big-hairy-data-structure) , then the easiest way of shrinking it consists of taking one step to []"><y>#</y><d>2016-12-08</d><h>18:51</h><w>gfredericks</w>default shrinks are going to be less interesting; e.g., if your generator is <code>(gen/vector gen-some-big-hairy-data-structure)</code>, then the easiest way of shrinking it consists of taking one step to <code>[]</code></z><z id="t1481224277" t="nwjsmith Maybe a version of sample that returns small , medium , big , medium , small , so that it’s easy to see how a value grows then shrinks?"><y>#</y><d>2016-12-08</d><h>19:11</h><w>nwjsmith</w>Maybe a version of sample that returns <code>small</code>, <code>medium</code>, <code>big</code>, <code>medium</code>, <code>small</code>, so that it’s easy to see how a value grows then shrinks?</z><z id="t1481224299" t="gfredericks that might be weirder than it sounds"><y>#</y><d>2016-12-08</d><h>19:11</h><w>gfredericks</w>that might be weirder than it sounds</z><z id="t1481224313" t="nwjsmith I should probably get a much better understanding of test.check’s shrinking before bugging you furthur"><y>#</y><d>2016-12-08</d><h>19:11</h><w>nwjsmith</w>I should probably get a much better understanding of test.check’s shrinking before bugging you furthur</z><z id="t1481224322" t="gfredericks it&apos;s tempting to think that the growing you see in sample and in a test run is related to the shrinking you get in a failure, but they&apos;re almost entirely unrelated processes"><y>#</y><d>2016-12-08</d><h>19:12</h><w>gfredericks</w>it&apos;s tempting to think that the growing you see in <code>sample</code> and in a test run is related to the shrinking you get in a failure, but they&apos;re almost entirely unrelated processes</z><z id="t1481224349" t="gfredericks I don&apos;t mind discussing it, the whole thing is currently underdocumented so I deserve to have to explain things live :)"><y>#</y><d>2016-12-08</d><h>19:12</h><w>gfredericks</w>I don&apos;t mind discussing it, the whole thing is currently underdocumented so I deserve to have to explain things live :)</z><z id="t1481224388" t="gfredericks another thing you could implement without too much trouble is a random shrink"><y>#</y><d>2016-12-08</d><h>19:13</h><w>gfredericks</w>another thing you could implement without too much trouble is a random shrink</z><z id="t1481224406" t="gfredericks it might not resemble too closely what would happen in a real test, but it could at least give you an idea of what sorts of steps are possible"><y>#</y><d>2016-12-08</d><h>19:13</h><w>gfredericks</w>it might not resemble too closely what would happen in a real test, but it could at least give you an idea of what sorts of steps are possible</z><z id="t1481224612" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] this part of this talk introduces the idea of a shrink tree, which is most of what you need to know to understand the shrinking mechanics: https://youtu.be/u0t-6lUvXHo?t=11m6s"><y>#</y><d>2016-12-08</d><h>19:16</h><w>gfredericks</w><a>@nwjsmith</a> this part of this talk introduces the idea of a shrink tree, which is most of what you need to know to understand the shrinking mechanics: <a href="https://youtu.be/u0t-6lUvXHo?t=11m6s" target="_blank">https://youtu.be/u0t-6lUvXHo?t=11m6s</a></z><z id="t1481224647" t="nwjsmith Oh, excellent. Thanks!"><y>#</y><d>2016-12-08</d><h>19:17</h><w>nwjsmith</w>Oh, excellent. Thanks!</z><z id="t1481225245" t="gfredericks I suppose it&apos;s a rather steep introduction, but it&apos;s at least better than me typing stuff "><y>#</y><d>2016-12-08</d><h>19:27</h><w>gfredericks</w>I suppose it&apos;s a rather steep introduction, but it&apos;s at least better than me typing stuff </z><z id="t1481815181" t="gfredericks I think I figured out how to use transducers in the shrink trees"><y>#</y><d>2016-12-15</d><h>15:19</h><w>gfredericks</w>I think I figured out how to use transducers in the shrink trees</z><z id="t1481815349" t="gfredericks It would save a lot of intermediate lazy seq allocations, but I think it would only apply when shrinking, so it&apos;s not obviously worth the effort. "><y>#</y><d>2016-12-15</d><h>15:22</h><w>gfredericks</w>It would save a lot of intermediate lazy seq allocations, but I think it would only apply when shrinking, so it&apos;s not obviously worth the effort. </z><z id="t1481816750" t="nberger Nice!"><y>#</y><d>2016-12-15</d><h>15:45</h><w>nberger</w>Nice!</z><z id="t1482064849" t="nberger Uploaded an alternative patch to http://dev.clojure.org/jira/browse/TCHECK-126 (Refactor c.t.c/quick-check as a state machine to provide more extension points). The new patch refactors c.t.c/quick-check &quot;in-place&quot;, instead of introducing a separate namespace like in the old patch. Most important change is that it replaces the reporter-fn with a step-fn which allows feeding back the quick-check loop to drive/augment it by returning a modified quick-check state (for example, adding a timestamp, or dynamically changing the number of tests left). reporter-fn was for side-effects only, step-fn allows to do the side-effects AND modify the qc state. I understand this is not a breaking change because the reporter-fn has not been part of a release yet AFAIK"><y>#</y><d>2016-12-18</d><h>12:40</h><w>nberger</w>Uploaded an alternative patch to <a href="http://dev.clojure.org/jira/browse/TCHECK-126" target="_blank">http://dev.clojure.org/jira/browse/TCHECK-126</a> (Refactor c.t.c/quick-check as a state machine to provide more extension points). The new patch refactors c.t.c/quick-check &quot;in-place&quot;, instead of introducing a separate namespace like in the old patch.
Most important change is that it replaces the <code>reporter-fn</code> with a <code>step-fn</code> which allows feeding back the quick-check loop to drive/augment it by returning a modified quick-check state (for example, adding a timestamp, or dynamically changing the number of tests left). <code>reporter-fn</code> was for side-effects only, <code>step-fn</code> allows to do the side-effects AND modify the qc state.
I understand this is not a breaking change because the <code>reporter-fn</code> has not been part of a release yet AFAIK</z><z id="t1482065324" t="gfredericks so step-fn is part of the public API then?"><y>#</y><d>2016-12-18</d><h>12:48</h><w>gfredericks</w>so <code>step-fn</code> is part of the public API then?</z><z id="t1482065586" t="nberger yes, through the new step-fn option that replaces reporter-fn . There&apos;s also a c.t.c.clojure-test/default-step-fn now"><y>#</y><d>2016-12-18</d><h>12:53</h><w>nberger</w>yes, through the new <code>step-fn</code> option that replaces <code>reporter-fn</code>. There&apos;s also a <code>c.t.c.clojure-test/default-step-fn</code> now</z><z id="t1482065619" t="nberger here&apos;s the new default-step-fn : https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-fb4b33c15ed48f22f9f6c3655f16da02R29"><y>#</y><d>2016-12-18</d><h>12:53</h><w>nberger</w>here&apos;s the new <code>default-step-fn</code>: <a href="https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-fb4b33c15ed48f22f9f6c3655f16da02R29" target="_blank">https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-fb4b33c15ed48f22f9f6c3655f16da02R29</a></z><z id="t1482065654" t="gfredericks hm"><y>#</y><d>2016-12-18</d><h>12:54</h><w>gfredericks</w>hm</z><z id="t1482065680" t="gfredericks I&apos;d want to be sure that creating a well-behaved and useful step-fn isn&apos;t more difficult than a reporter-fn"><y>#</y><d>2016-12-18</d><h>12:54</h><w>gfredericks</w>I&apos;d want to be sure that creating a well-behaved and useful <code>step-fn</code> isn&apos;t more difficult than a <code>reporter-fn</code></z><z id="t1482065837" t="nberger yeah, that&apos;s a risk... we could check for nil, but not sure if much more than that... maybe check that we get a map with certain keys back? But I don&apos;t know, passing a step-fn is a bit of &quot;advanced usage&quot;, and reading a little bit about it or seeing an example is not such a big expectation, maybe... Here&apos;s an example of a step-fn: https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R985"><y>#</y><d>2016-12-18</d><h>12:57</h><w>nberger</w>yeah, that&apos;s a risk... we could check for nil, but not sure if much more than that... maybe check that we get a map with certain keys back? But I don&apos;t know, passing a <code>step-fn</code> is a bit of &quot;advanced usage&quot;, and reading a little bit about it or seeing an example is not such a big expectation, maybe... Here&apos;s an example of a step-fn: <a href="https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R985" target="_blank">https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R985</a></z><z id="t1482065870" t="nberger and here&apos;s a more useful one: https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R1042"><y>#</y><d>2016-12-18</d><h>12:57</h><w>nberger</w>and here&apos;s a more useful one: <a href="https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R1042" target="_blank">https://github.com/clojure/test.check/compare/master...nberger:test.check2-reporter-fn#diff-5eb045ad9cf20dd057f8344a877abd89R1042</a></z><z id="t1482065921" t="nberger perhaps we could provide some specs for the step-fn..."><y>#</y><d>2016-12-18</d><h>12:58</h><w>nberger</w>perhaps we could provide some specs for the step-fn...</z><z id="t1482066179" t="nberger another option is to keep separate functions for the side-effecty part (`reporter-fn`) and the modify-qc-state part (`step-fn`? will need help with the names 😄 )"><y>#</y><d>2016-12-18</d><h>13:02</h><w>nberger</w>another option is to keep separate functions for the side-effecty part (`reporter-fn`) and the modify-qc-state part (`step-fn`? will need help with the names <b>😄</b> )</z><z id="t1482066270" t="nberger but I don&apos;t know... maybe that&apos;s more appropriate for a layer over this (a step-fn that composes a reporter-fn and a change-qc-state-fn or whatever)"><y>#</y><d>2016-12-18</d><h>13:04</h><w>nberger</w>but I don&apos;t know... maybe that&apos;s more appropriate for a layer over this (a <code>step-fn</code> that composes a reporter-fn and a change-qc-state-fn or whatever)</z><z id="t1482066993" t="gfredericks what uses do you imagine a user having for a step-fn that aren&apos;t possible with reporter-fn ?"><y>#</y><d>2016-12-18</d><h>13:16</h><w>gfredericks</w>what uses do you imagine a user having for a <code>step-fn</code> that aren&apos;t possible with <code>reporter-fn</code>?</z></g><g id="s2"><z id="t1482067895" t="nberger 1. implementing the stats feature 2. add timestamps at different stages of the quick-check test 3. dynamically change for how long the test should run (by changing the num-tests key, or by introducing a new abort? key in the future) 4. bound tests and shrinks in time (maybe this goes under the previous item, but it&apos;s a long-standing request in TCHECK-8 and this way it could be implemented as an extension)"><y>#</y><d>2016-12-18</d><h>13:31</h><w>nberger</w>1. implementing the stats feature
2. add timestamps at different stages of the quick-check test
3. dynamically change for how long the test should run (by changing the num-tests key, or by introducing a new <code>abort?</code> key in the future)
4. bound tests and shrinks in time (maybe this goes under the previous item, but it&apos;s a long-standing request in TCHECK-8 and this way it could be implemented as an extension)</z><z id="t1482068083" t="nberger and others that users will come up with 🙂 . Another benefit IMO is that it the qc state has the same shape at all stages of the quick-check run (except for added keys during shrink that don&apos;t make sense before it starts, for example), so it should make it marginally easier for say an editor to integrate with this to provide live status of the test.check progress"><y>#</y><d>2016-12-18</d><h>13:34</h><w>nberger</w>and others that users will come up with <b>🙂</b>. Another benefit IMO is that it the qc state has the same shape at all stages of the quick-check run (except for added keys during shrink that don&apos;t make sense before it starts, for example), so it should make it marginally easier for say an editor to integrate with this to provide live status of the test.check progress</z><z id="t1482069101" t="nberger Not sure if it gives any benefit for clojure.spec, that&apos;s something to be explored..."><y>#</y><d>2016-12-18</d><h>13:51</h><w>nberger</w>Not sure if it gives any benefit for clojure.spec, that&apos;s something to be explored...</z><z id="t1482069173" t="nberger Another benefit: the periodic reporter could be re implemented to not use a global atom quite easily"><y>#</y><d>2016-12-18</d><h>13:52</h><w>nberger</w>Another benefit: the periodic reporter could be re implemented to not use a global atom quite easily</z><z id="t1482105318" t="gfredericks I keep wondering if a rewrite of the generators namespace could result in a more coherent notion of size ; it seems hard to come up with one"><y>#</y><d>2016-12-18</d><h>23:55</h><w>gfredericks</w>I keep wondering if a rewrite of the <code>generators</code> namespace could result in a more coherent notion of <code>size</code>; it seems hard to come up with one</z><z id="t1482105382" t="gfredericks an initial thought is that sizing generators could be easier to understand if they tried to interpret size as a suggested value for (comp count pr-str)"><y>#</y><d>2016-12-18</d><h>23:56</h><w>gfredericks</w>an initial thought is that sizing generators could be easier to understand if they tried to interpret <code>size</code> as a suggested value for <code>(comp count pr-str)</code></z><z id="t1482105405" t="gfredericks or a suggested maximum value"><y>#</y><d>2016-12-18</d><h>23:56</h><w>gfredericks</w>or a suggested maximum value</z><z id="t1482105432" t="gfredericks but there are lots of cases where that&apos;s not a useful default, so users would have to be more involved with sizing to get what they want"><y>#</y><d>2016-12-18</d><h>23:57</h><w>gfredericks</w>but there are lots of cases where that&apos;s not a useful default, so users would have to be more involved with sizing to get what they want</z><z id="t1482105466" t="gfredericks and it would also be hard to pull off, especially for combining collection generators with custom generators using gen/bind"><y>#</y><d>2016-12-18</d><h>23:57</h><w>gfredericks</w>and it would also be hard to pull off, especially for combining collection generators with custom generators using <code>gen/bind</code></z><z id="t1482105489" t="gfredericks it&apos;d be useful to know how well the other quickchecks do at this"><y>#</y><d>2016-12-18</d><h>23:58</h><w>gfredericks</w>it&apos;d be useful to know how well the other quickchecks do at this</z><z id="t1482105599" t="gfredericks I don&apos;t like that clojure.spec needed to do some weird depth-tracking thing"><y>#</y><d>2016-12-18</d><h>23:59</h><w>gfredericks</w>I don&apos;t like that clojure.spec needed to do some weird depth-tracking thing</z><z id="t1482347167" t="ag How could I generate data based on concrete collection. e.g. I have a predefined list of accounts, need a generator that would generate data for each of the account in that list. e.g. (for [a accounts] (-&gt; :account/spec s/gen gen/generate (merge a))) - where :account/spec is a spec of map. This snippet does not return a generator though, and I need a generator"><y>#</y><d>2016-12-21</d><h>19:06</h><w>ag</w>How could I generate data based on concrete collection. e.g. I have a predefined list of accounts, need a generator that would generate data for each of the account in that list. e.g. <code>(for [a accounts] (-&gt; :account/spec s/gen gen/generate (merge a)))</code> - where <code>:account/spec</code> is a spec of map. This snippet does not return a generator though, and I need a generator</z><z id="t1482356630" t="ag can I run multiple assertions in defspec ?"><y>#</y><d>2016-12-21</d><h>21:43</h><w>ag</w>can I run multiple assertions in <code>defspec</code> ?</z><z id="t1482356651" t="ag I know, I probably shouldn’t, but..."><y>#</y><d>2016-12-21</d><h>21:44</h><w>ag</w>I know, I probably shouldn’t, but...</z><z id="t1482356655" t="ag what if?"><y>#</y><d>2016-12-21</d><h>21:44</h><w>ag</w>what if?</z><z id="t1482356720" t="ag should I just use and ?"><y>#</y><d>2016-12-21</d><h>21:45</h><w>ag</w>should I just use <code>and</code> ?</z><z id="t1482357869" t="gfredericks yep"><y>#</y><d>2016-12-21</d><h>22:04</h><w>gfredericks</w>yep</z><z id="t1482357884" t="gfredericks which obscures which leg failed when something fails"><y>#</y><d>2016-12-21</d><h>22:04</h><w>gfredericks</w>which obscures which leg failed when something fails</z><z id="t1482357902" t="gfredericks that sort of thing might improve in the future"><y>#</y><d>2016-12-21</d><h>22:05</h><w>gfredericks</w>that sort of thing might improve in the future</z><z id="t1483387727" t="paulspencerwilliams Hi. I’ve a question about property based testing and test.check and their suitability to the following integration validation. If I wanted to check that function (first-available-timeslot {:attendees 3 :starts 2017-02-03 :ends 2017-02-03 :duration 60}) returns the first 1 hour slot not conflicting with a generated set of random meetings in the same calendar. The properties in english would be “result doesn’t overlap with other meetings”, “time slot is in a meeting room with at least a capacity of :attendees&quot; and somehow “the result is the first suitable result. Am I thinking about this the right way?"><y>#</y><d>2017-01-02</d><h>20:08</h><w>paulspencerwilliams</w>Hi. I’ve a question about property based testing and test.check and their suitability to the following integration validation. If I wanted to check that function <pre>(first-available-timeslot {:attendees 3 :starts 2017-02-03 :ends 2017-02-03 :duration 60})</pre> returns the first 1 hour slot not conflicting with a generated set of random meetings in the same calendar. The properties in english would be “result doesn’t overlap with other meetings”, “time slot is in a meeting room with at least a capacity of :attendees&quot; and somehow “the result is the first suitable result. Am I thinking about this the right way?</z><z id="t1483390307" t="gfredericks I assume the function can fail if the constraints aren&apos;t satisfiable"><y>#</y><d>2017-01-02</d><h>20:51</h><w>gfredericks</w>I assume the function can fail if the constraints aren&apos;t satisfiable</z><z id="t1483390430" t="gfredericks Are you planning on just testing with that piece of example data you showed, or generating that input as well?"><y>#</y><d>2017-01-02</d><h>20:53</h><w>gfredericks</w>Are you planning on just testing with that piece of example data you showed, or generating that input as well?</z><z id="t1483390459" t="paulspencerwilliams Correct, and generating input also."><y>#</y><d>2017-01-02</d><h>20:54</h><w>paulspencerwilliams</w>Correct, and generating input also.</z><z id="t1483390502" t="gfredericks I think the first two properties are good"><y>#</y><d>2017-01-02</d><h>20:55</h><w>gfredericks</w>I think the first two properties are good</z><z id="t1483390530" t="gfredericks The third has slightly more of the &quot;duplicating the business logic&quot; flavor"><y>#</y><d>2017-01-02</d><h>20:55</h><w>gfredericks</w>The third has slightly more of the &quot;duplicating the business logic&quot; flavor</z><z id="t1483390555" t="gfredericks But might be easy enough as to be worth it"><y>#</y><d>2017-01-02</d><h>20:55</h><w>gfredericks</w>But might be easy enough as to be worth it</z><z id="t1483390602" t="paulspencerwilliams okay. I’ll have a bash. My concern was that integration tests are expensive, and having many tests with large datasets even more so, although they obviously offer far more confidence."><y>#</y><d>2017-01-02</d><h>20:56</h><w>paulspencerwilliams</w>okay. I’ll have a bash. My concern was that integration tests are expensive, and having many tests with large datasets even more so, although they obviously offer far more confidence.</z><z id="t1483390636" t="gfredericks Expensive meaning dev time? Waiting for tests? "><y>#</y><d>2017-01-02</d><h>20:57</h><w>gfredericks</w>Expensive meaning dev time? Waiting for tests? </z><z id="t1483390692" t="paulspencerwilliams Waiting for tests. Further, the query might operate against a db, or possibly google calendars api so there’s timeouts and error conditions complicating things."><y>#</y><d>2017-01-02</d><h>20:58</h><w>paulspencerwilliams</w>Waiting for tests. Further, the query might operate against a db, or possibly google calendars api so there’s timeouts and error conditions complicating things.</z><z id="t1483390734" t="gfredericks I would try to mock out things you don&apos;t control"><y>#</y><d>2017-01-02</d><h>20:58</h><w>gfredericks</w>I would try to mock out things you don&apos;t control</z><z id="t1483390763" t="gfredericks Unreliable tests are even more annoying in PBT"><y>#</y><d>2017-01-02</d><h>20:59</h><w>gfredericks</w>Unreliable tests are even more annoying in PBT</z><z id="t1483390788" t="gfredericks Shrinking can be almost meaningless"><y>#</y><d>2017-01-02</d><h>20:59</h><w>gfredericks</w>Shrinking can be almost meaningless</z><z id="t1483390844" t="paulspencerwilliams Yeah, that’s what I was thinking. I actually wonder whether syncing a copy of the calendar into a clojure owned data structure before querying might allow better reasonability. It’s only a small dataset."><y>#</y><d>2017-01-02</d><h>21:00</h><w>paulspencerwilliams</w>Yeah, that’s what I was thinking. I actually wonder whether syncing a copy of the calendar into a clojure owned data structure before querying might allow better reasonability. It’s only a small dataset.</z><z id="t1483390901" t="gfredericks Or generate the calendar"><y>#</y><d>2017-01-02</d><h>21:01</h><w>gfredericks</w>Or generate the calendar</z><z id="t1483390984" t="gfredericks A property I just thought of that is a corollary of the &quot;earliest time slot&quot; requirement: "><y>#</y><d>2017-01-02</d><h>21:03</h><w>gfredericks</w>A property I just thought of that is a corollary of the &quot;earliest time slot&quot; requirement: </z><z id="t1483391068" t="gfredericks &quot;Given two reservation requests where the first is strictly easier to satisfy than the second, processing them in order should never result in the second being scheduled before the first"><y>#</y><d>2017-01-02</d><h>21:04</h><w>gfredericks</w>&quot;Given two reservation requests where the first is strictly easier to satisfy than the second, processing them in order should never result in the second being scheduled before the first</z><z id="t1483391122" t="gfredericks Meaning they should have the same date range, and the second should involve at least as many people and minutes"><y>#</y><d>2017-01-02</d><h>21:05</h><w>gfredericks</w>Meaning they should have the same date range, and the second should involve at least as many people and minutes</z><z id="t1483391172" t="paulspencerwilliams Just parsing that..."><y>#</y><d>2017-01-02</d><h>21:06</h><w>paulspencerwilliams</w>Just parsing that...</z><z id="t1483391219" t="paulspencerwilliams Got it, yes. It’s these property identifications that make it difficult, and require a lot of experience."><y>#</y><d>2017-01-02</d><h>21:06</h><w>paulspencerwilliams</w>Got it, yes. It’s these property identifications that make it difficult, and require a lot of experience.</z><z id="t1483391229" t="gfredericks Yep"><y>#</y><d>2017-01-02</d><h>21:07</h><w>gfredericks</w>Yep</z><z id="t1483391280" t="gfredericks I&apos;m about to sacrifice my phone for the sake of providing entertainment to my offspring, so that may be all the pondering I can do for now "><y>#</y><d>2017-01-02</d><h>21:08</h><w>gfredericks</w>I&apos;m about to sacrifice my phone for the sake of providing entertainment to my offspring, so that may be all the pondering I can do for now </z><z id="t1483391307" t="paulspencerwilliams [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] thanks for the help. I will explore this further tomorrow and enjoy the rest of your evening!"><y>#</y><d>2017-01-02</d><h>21:08</h><w>paulspencerwilliams</w><a>@gfredericks</a> thanks for the help. I will explore this further tomorrow and enjoy the rest of your evening!</z><z id="t1483393039" t="mattly is there any way to instrument a set of generators for a test to track performance?"><y>#</y><d>2017-01-02</d><h>21:37</h><w>mattly</w>is there any way to instrument a set of generators for a test to track performance?</z><z id="t1483393080" t="mattly I&apos;ve got what, to me, seems like a relatively simple generation set that takes 20+ seconds per iteration for some reason"><y>#</y><d>2017-01-02</d><h>21:38</h><w>mattly</w>I&apos;ve got what, to me, seems like a relatively simple generation set that takes 20+ seconds per iteration for some reason</z><z id="t1483393126" t="mattly there&apos;s no recursion, and the only such-that checks that a basic keyword produces something not part of a previously-generated set"><y>#</y><d>2017-01-02</d><h>21:38</h><w>mattly</w>there&apos;s no recursion, and the only <code>such-that</code> checks that a basic keyword produces something not part of a previously-generated set</z><z id="t1483393256" t="mattly hm"><y>#</y><d>2017-01-02</d><h>21:40</h><w>mattly</w>hm</z><z id="t1483393680" t="hiredman that definitely will slow things down"><y>#</y><d>2017-01-02</d><h>21:48</h><w>hiredman</w>that definitely will slow things down</z><z id="t1483393943" t="hiredman depending on what you are doing, you could generate a set, then use fmap to remove an element and return a tuple of [removed-element set] to get a similar effect without thrashing such-that"><y>#</y><d>2017-01-02</d><h>21:52</h><w>hiredman</w>depending on what you are doing, you could generate a set, then use fmap to remove an element and return a tuple of [removed-element set] to get a similar effect without thrashing such-that</z><z id="t1483394616" t="mattly that could work"><y>#</y><d>2017-01-02</d><h>22:03</h><w>mattly</w>that could work</z><z id="t1483394634" t="mattly as it is I&apos;m using a modified version of test.chuck&apos;s testing that will output things on each iteration"><y>#</y><d>2017-01-02</d><h>22:03</h><w>mattly</w>as it is I&apos;m using a modified version of test.chuck&apos;s <code>testing</code> that will output things on each iteration</z><z id="t1483394643" t="mattly I&apos;m modifying that to display gen vs. test times"><y>#</y><d>2017-01-02</d><h>22:04</h><w>mattly</w>I&apos;m modifying that to display gen vs. test times</z><z id="t1483394699" t="mattly and then doing simple one-off tests with each of my generators"><y>#</y><d>2017-01-02</d><h>22:04</h><w>mattly</w>and then doing simple one-off tests with each of my generators</z><z id="t1483396802" t="gfredericks I doubt thrashing such-that would have such severe consequences unless you manually raised the iteration limit"><y>#</y><d>2017-01-02</d><h>22:40</h><w>gfredericks</w>I doubt thrashing such-that would have such severe consequences unless you manually raised the iteration limit</z><z id="t1483396812" t="gfredericks It gives up after 10 tries"><y>#</y><d>2017-01-02</d><h>22:40</h><w>gfredericks</w>It gives up after 10 tries</z><z id="t1483397001" t="mattly yeah, it&apos;s not that so far as I can tell"><y>#</y><d>2017-01-02</d><h>22:43</h><w>mattly</w>yeah, it&apos;s not that so far as I can tell</z><z id="t1483400087" t="mattly heh, as usual, my takeaway is &quot;don&apos;t use generators for things you don&apos;t need to test the properties of&quot;"><y>#</y><d>2017-01-02</d><h>23:34</h><w>mattly</w>heh, as usual, my takeaway is &quot;don&apos;t use generators for things you don&apos;t need to test the properties of&quot;</z><z id="t1483400232" t="mattly replacing (gen/map gen/keyword some-other-gen {:min-elements 1 :max-elements 20}) with"><y>#</y><d>2017-01-02</d><h>23:37</h><w>mattly</w>replacing <code>(gen/map gen/keyword some-other-gen {:min-elements 1 :max-elements 20})</code> with</z><z id="t1483400400" t="gfredericks 🙁 "><y>#</y><d>2017-01-02</d><h>23:40</h><w>gfredericks</w><b>🙁</b> </z><z id="t1483400406" t="mattly reduced the time spent running generators to about an eighth of the origional"><y>#</y><d>2017-01-02</d><h>23:40</h><w>mattly</w>reduced the time spent running generators to about an eighth of the origional</z><z id="t1483400414" t="gfredericks That&apos;s unfortunate"><y>#</y><d>2017-01-02</d><h>23:40</h><w>gfredericks</w>That&apos;s unfortunate</z><z id="t1483400425" t="mattly yeah"><y>#</y><d>2017-01-02</d><h>23:40</h><w>mattly</w>yeah</z><z id="t1483400429" t="gfredericks But sounds plausible"><y>#</y><d>2017-01-02</d><h>23:40</h><w>gfredericks</w>But sounds plausible</z><z id="t1483400486" t="mattly the keys don&apos;t really have any special properties here, it&apos;s mostly, I&apos;m testing the map of some-other-gen here and how that effects the code I&apos;m testing"><y>#</y><d>2017-01-02</d><h>23:41</h><w>mattly</w>the keys don&apos;t really have any special properties here, it&apos;s mostly, I&apos;m testing the map of <code>some-other-gen</code> here and how that effects the code I&apos;m testing</z><z id="t1483400509" t="mattly but it literally went from"><y>#</y><d>2017-01-02</d><h>23:41</h><w>mattly</w>but it literally went from</z><z id="t1483400583" t="mattly ...this being the output of my runner"><y>#</y><d>2017-01-02</d><h>23:43</h><w>mattly</w>...this being the output of my runner</z><z id="t1483400674" t="mattly I have another project where I did something similar"><y>#</y><d>2017-01-02</d><h>23:44</h><w>mattly</w>I have another project where I did something similar</z><z id="t1483400701" t="mattly it&apos;s a parser of sorts and I needed a bunch of word-looking text"><y>#</y><d>2017-01-02</d><h>23:45</h><w>mattly</w>it&apos;s a parser of sorts and I needed a bunch of word-looking text</z><z id="t1483400753" t="mattly I started with (gen/not-empty (gen/string-alphanumeric)) and ended up switching to (gen/elements a-set-of-words-from-lorem-text) because it was a similar magnitude faster"><y>#</y><d>2017-01-02</d><h>23:45</h><w>mattly</w>I started with <code>(gen/not-empty (gen/string-alphanumeric))</code> and ended up switching to <code>(gen/elements a-set-of-words-from-lorem-text)</code> because it was a similar magnitude faster</z><z id="t1483400863" t="mattly so I&apos;ve started having to ask on these things, ok, what am I actually testing the properties of here?"><y>#</y><d>2017-01-02</d><h>23:47</h><w>mattly</w>so I&apos;ve started having to ask on these things, ok, what am I actually testing the properties of here?</z><z id="t1483400876" t="mattly and what can I get away with not generating"><y>#</y><d>2017-01-02</d><h>23:47</h><w>mattly</w>and what can I get away with not generating</z><z id="t1483403379" t="gfredericks This is all about faster feedback? "><y>#</y><d>2017-01-03</d><h>00:29</h><w>gfredericks</w>This is all about faster feedback? </z><z id="t1483403447" t="gfredericks Sometimes I wish we had better tools for running a few choice tests to get fast feedback, and doing the heavy PBT via some async workflow"><y>#</y><d>2017-01-03</d><h>00:30</h><w>gfredericks</w>Sometimes I wish we had better tools for running a few choice tests to get fast feedback, and doing the heavy PBT via some async workflow</z><z id="t1483403548" t="gfredericks It might be possible to optimize the string/keyword generators by avoiding the intermediate vectors. Would be interesting to try, and would speed up a lot of people&apos;s tests if it works"><y>#</y><d>2017-01-03</d><h>00:32</h><w>gfredericks</w>It might be possible to optimize the string/keyword generators by avoiding the intermediate vectors. Would be interesting to try, and would speed up a lot of people&apos;s tests if it works</z><z id="t1483404382" t="mattly yes and no"><y>#</y><d>2017-01-03</d><h>00:46</h><w>mattly</w>yes and no</z><z id="t1483404406" t="mattly ...but mostly yes"><y>#</y><d>2017-01-03</d><h>00:46</h><w>mattly</w>...but mostly yes</z><z id="t1483404434" t="mattly when 100 iterations of tests takes 10 minutes versus 30 seconds, I think that goes beyond &quot;faster feedback&quot;"><y>#</y><d>2017-01-03</d><h>00:47</h><w>mattly</w>when 100 iterations of tests takes 10 minutes versus 30 seconds, I think that goes beyond &quot;faster feedback&quot;</z><z id="t1483404836" t="gfredericks test.chuck has a mechanism for varying how many tests are run"><y>#</y><d>2017-01-03</d><h>00:53</h><w>gfredericks</w>test.chuck has a mechanism for varying how many tests are run</z><z id="t1483404854" t="mattly yeah, I use that on our CI"><y>#</y><d>2017-01-03</d><h>00:54</h><w>mattly</w>yeah, I use that on our CI</z><z id="t1483404916" t="mattly but overall it gets into other factors especially with the CI"><y>#</y><d>2017-01-03</d><h>00:55</h><w>mattly</w>but overall it gets into other factors especially with the CI</z><z id="t1483404934" t="mattly Circle has a time limit for any given test run of 2 hours"><y>#</y><d>2017-01-03</d><h>00:55</h><w>mattly</w>Circle has a time limit for any given test run of 2 hours</z><z id="t1483404951" t="mattly which I was hitting a lot in the early days of this project"><y>#</y><d>2017-01-03</d><h>00:55</h><w>mattly</w>which I was hitting a lot in the early days of this project</z><z id="t1483409101" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] is this jvm or js? I&apos;ll probably do some profiling"><y>#</y><d>2017-01-03</d><h>02:05</h><w>gfredericks</w><a>@mattly</a> is this jvm or js? I&apos;ll probably do some profiling</z><z id="t1483534262" t="gfredericks [:attrs {:href &quot;/_/_/users/U053V4R5N&quot;}] I&apos;m playing around with keyword/string perf, but am not seeing anything super egregious so it would help to have more details about your &quot;100 iterations takes 10 minutes&quot; case"><y>#</y><d>2017-01-04</d><h>12:51</h><w>gfredericks</w><a>@mattly</a> I&apos;m playing around with keyword/string perf, but am not seeing anything super egregious so it would help to have more details about your &quot;100 iterations takes 10 minutes&quot; case</z><z id="t1483534384" t="gfredericks I have some ideas for speeding things up, but I can generate several keywords/strings in a millisecond so I can&apos;t get that to add up to 10 minutes"><y>#</y><d>2017-01-04</d><h>12:53</h><w>gfredericks</w>I have some ideas for speeding things up, but I can generate several keywords/strings in a millisecond so I can&apos;t get that to add up to 10 minutes</z><z id="t1483558218" t="mattly [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] js; I&apos;ll get you a code sample in a bit"><y>#</y><d>2017-01-04</d><h>19:30</h><w>mattly</w><a>@gfredericks</a> js; I&apos;ll get you a code sample in a bit</z><z id="t1483558243" t="mattly (derp, forgot this was a test against my client-side code)"><y>#</y><d>2017-01-04</d><h>19:30</h><w>mattly</w>(derp, forgot this was a test against my client-side code)</z><z id="t1483561502" t="gfredericks Ok, I was trying jvm this morning. It&apos;s possible js has some comparative perf problems"><y>#</y><d>2017-01-04</d><h>20:25</h><w>gfredericks</w>Ok, I was trying jvm this morning. It&apos;s possible js has some comparative perf problems</z><z id="t1484053577" t="gfredericks [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] do you know whether your refactoring of the quick-check function would make it easier to support asynchronous tests?"><y>#</y><d>2017-01-10</d><h>13:06</h><w>gfredericks</w><a>@nberger</a> do you know whether your refactoring of the quick-check function would make it easier to support asynchronous tests?</z><z id="t1484053582" t="gfredericks apologies if I&apos;ve asked that before"><y>#</y><d>2017-01-10</d><h>13:06</h><w>gfredericks</w>apologies if I&apos;ve asked that before</z><z id="t1484063905" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : I&apos;m not sure what&apos;s the issue with asynchronous tests, do you have more context? An example or something to read?"><y>#</y><d>2017-01-10</d><h>15:58</h><w>nberger</w><a>@gfredericks</a>: I&apos;m not sure what&apos;s the issue with asynchronous tests, do you have more context? An example or something to read?</z><z id="t1484063968" t="nberger I do think it should help with running tests in parallel, maybe with a bit more refactoring"><y>#</y><d>2017-01-10</d><h>15:59</h><w>nberger</w>I do think it should help with running tests in parallel, maybe with a bit more refactoring</z><z id="t1484065555" t="gfredericks [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] basic use case is wanting to test browser stuff in cljs; if you need to pause the thread to let the browser render things, you can&apos;t have a test that just returns pass/fail"><y>#</y><d>2017-01-10</d><h>16:25</h><w>gfredericks</w><a>@nberger</a> basic use case is wanting to test browser stuff in cljs; if you need to pause the thread to let the browser render things, you can&apos;t have a test that just returns pass/fail</z><z id="t1484065608" t="gfredericks you could e.g. return a future or a channel; but that means the quickcheck loop cannot just examine the result, it has to also pause somehow or another until the result is available; traditionally that would mean it would have to shove the rest of the computation into a callback"><y>#</y><d>2017-01-10</d><h>16:26</h><w>gfredericks</w>you could e.g. return a future or a channel; but that means the quickcheck loop cannot just examine the result, it has to also pause somehow or another until the result is available; traditionally that would mean it would have to shove the rest of the computation into a callback</z><z id="t1484065661" t="gfredericks this is why core.async is so complex, to allow you to pretend your code is synchronous, and the go macro twists it all into a knot so you don&apos;t have to"><y>#</y><d>2017-01-10</d><h>16:27</h><w>gfredericks</w>this is why core.async is so complex, to allow you to pretend your code is synchronous, and the <code>go</code> macro twists it all into a knot so you don&apos;t have to</z><z id="t1484065702" t="gfredericks but unless you&apos;re already programming with this kind of thing in mind it&apos;s usually a big pain to rework the program"><y>#</y><d>2017-01-10</d><h>16:28</h><w>gfredericks</w>but unless you&apos;re already programming with this kind of thing in mind it&apos;s usually a big pain to rework the program</z><z id="t1484065711" t="gfredericks so test.check just doesn&apos;t support that kind of test at the moment"><y>#</y><d>2017-01-10</d><h>16:28</h><w>gfredericks</w>so test.check just doesn&apos;t support that kind of test at the moment</z><z id="t1484066074" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : got it. Thought it was something like that but wanted to confirm. Have you seen the async macro in cljs.test? It&apos;s definitely not perfect (doesn&apos;t play well with with-redefs for example) but it&apos;s a start"><y>#</y><d>2017-01-10</d><h>16:34</h><w>nberger</w><a>@gfredericks</a>: got it. Thought it was something like that but wanted to confirm. Have you seen the async macro in cljs.test? It&apos;s definitely not perfect (doesn&apos;t play well with <code>with-redefs</code> for example) but it&apos;s a start</z><z id="t1484066109" t="gfredericks no"><y>#</y><d>2017-01-10</d><h>16:35</h><w>gfredericks</w>no</z><z id="t1484066370" t="gfredericks I&apos;m asking about your changes because if you tried to take the current code and refactor it to be async, the loop s would have to be transformed into something more abstract; I wasn&apos;t sure if your restructuring had already accomplished that"><y>#</y><d>2017-01-10</d><h>16:39</h><w>gfredericks</w>I&apos;m asking about your changes because if you tried to take the current code and refactor it to be async, the <code>loop</code>s would have to be transformed into something more abstract; I wasn&apos;t sure if your restructuring had already accomplished that</z><z id="t1484067946" t="nberger I see. I didn&apos;t take it that far"><y>#</y><d>2017-01-10</d><h>17:05</h><w>nberger</w>I see. I didn&apos;t take it that far</z><z id="t1484070214" t="nberger I&apos;m also not 100% sure in that the loop would have to be transformed. Using an approach similar to the cljs.test async macro or how some core.async tests are written, which is basically using a &quot;latch&quot; (with countdown or not), the loop can be used as is, even without the refactoring. I&apos;ll try to come up with an example next week "><y>#</y><d>2017-01-10</d><h>17:43</h><w>nberger</w>I&apos;m also not 100% sure in that the loop would have to be transformed. Using an approach similar to the cljs.test <code>async</code> macro or how some core.async tests are written, which is basically using a &quot;latch&quot; (with countdown or not), the loop can be used as is, even without the refactoring. I&apos;ll try to come up with an example next week </z><z id="t1484074039" t="gfredericks that would surprise me"><y>#</y><d>2017-01-10</d><h>18:47</h><w>gfredericks</w>that would surprise me</z><z id="t1484075727" t="nberger Yeah, thinking more about it, a different abstraction would be needed. I&apos;ll hopefully have some time to play with it next week"><y>#</y><d>2017-01-10</d><h>19:15</h><w>nberger</w>Yeah, thinking more about it, a different abstraction would be needed. I&apos;ll hopefully have some time to play with it next week</z><z id="t1484363214" t="gfredericks Nothing like a good tweet about test.check https://twitter.com/SirFashinaTaiwo/status/819973439469416448"><y>#</y><d>2017-01-14</d><h>03:06</h><w>gfredericks</w>Nothing like a good tweet about test.check <a href="https://twitter.com/SirFashinaTaiwo/status/819973439469416448" target="_blank">https://twitter.com/SirFashinaTaiwo/status/819973439469416448</a></z><z id="t1484363255" t="lucasbradstreet Hah"><y>#</y><d>2017-01-14</d><h>03:07</h><w>lucasbradstreet</w>Hah</z><z id="t1484363264" t="lucasbradstreet test.check politics please"><y>#</y><d>2017-01-14</d><h>03:07</h><w>lucasbradstreet</w>test.check politics please</z><z id="t1484579359" t="wotbrew I want to write a generator that zipmaps values in coll-a to values in coll-b, but with the restriction that each entry in coll-a will be present in keys of the resulting map. Is this possible?"><y>#</y><d>2017-01-16</d><h>15:09</h><w>wotbrew</w>I want to write a generator that zipmaps values in coll-a to values in coll-b, but with the restriction that each entry in coll-a will be present in keys of the resulting map. Is this possible?</z><z id="t1484579822" t="wotbrew I&apos;ve got something like this (let [a [1 2 3] b [:foo :bar]] (gen/fmap (partial apply zipmap) (gen/tuple (gen/shuffle a) (gen/return (cycle b))))) "><y>#</y><d>2017-01-16</d><h>15:17</h><w>wotbrew</w>I&apos;ve got something like this
<pre>(let [a [1 2 3]
           b [:foo :bar]]
       (gen/fmap (partial apply zipmap)
                 (gen/tuple
                   (gen/shuffle a)
                   (gen/return (cycle b)))))
</pre></z><z id="t1484579838" t="wotbrew not sure if there is a better way to do it"><y>#</y><d>2017-01-16</d><h>15:17</h><w>wotbrew</w>not sure if there is a better way to do it</z><z id="t1484583047" t="gfredericks how about (let [a [1 2 3], b [:foo :bar]] (gen/let [vals (gen/vector (gen/elements b) (count a))] (zipmap a vals))) [:attrs {:href &quot;/_/_/users/U0GE2S1NH&quot;}]"><y>#</y><d>2017-01-16</d><h>16:10</h><w>gfredericks</w>how about <code>(let [a [1 2 3], b [:foo :bar]] (gen/let [vals (gen/vector (gen/elements b) (count a))] (zipmap a vals)))</code> <a>@danstone</a></z><z id="t1484583423" t="wotbrew Thats great - thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2017-01-16</d><h>16:17</h><w>wotbrew</w>Thats great - thanks <a>@gfredericks</a></z><z id="t1484583643" t="gfredericks np"><y>#</y><d>2017-01-16</d><h>16:20</h><w>gfredericks</w>np</z><z id="t1486644052" t="gfredericks I think test.check should have builtin generators for uniform doubles and uniform integers"><y>#</y><d>2017-02-09</d><h>12:40</h><w>gfredericks</w>I think test.check should have builtin generators for uniform doubles and uniform integers</z><z id="t1486644084" t="gfredericks since those can be useful tools for building other generators"><y>#</y><d>2017-02-09</d><h>12:41</h><w>gfredericks</w>since those can be useful tools for building other generators</z><z id="t1486644095" t="gfredericks each is a bit tricky though"><y>#</y><d>2017-02-09</d><h>12:41</h><w>gfredericks</w>each is a bit tricky though</z><z id="t1486644119" t="gfredericks A) for uniform doubles, should the value shrink? how exactly?"><y>#</y><d>2017-02-09</d><h>12:41</h><w>gfredericks</w>A) for uniform doubles, should the value shrink? how exactly?</z><z id="t1486644173" t="gfredericks B) for uniform integers, how should the clj and cljs versions relate? clj could provide arbitrary ranges of integers, while cljs is natively limited to ±2^53"><y>#</y><d>2017-02-09</d><h>12:42</h><w>gfredericks</w>B) for uniform integers, how should the clj and cljs versions relate? clj could provide arbitrary ranges of integers, while cljs is natively limited to ±2^53</z><z id="t1486644233" t="gfredericks cljs could do something fancy where it allows goog integers as well as native integers and if you give it bounds outside of native integers it generates googs"><y>#</y><d>2017-02-09</d><h>12:43</h><w>gfredericks</w>cljs could do something fancy where it allows goog integers as well as native integers and if you give it bounds outside of native integers it generates googs</z><z id="t1486644271" t="gfredericks (or would it be more correct to generate types based on the types you pass in? so if you give it a couple small googs for the range it still generates googs)"><y>#</y><d>2017-02-09</d><h>12:44</h><w>gfredericks</w>(or would it be more correct to generate types based on the types you pass in? so if you give it a couple small googs for the range it still generates googs)</z><z id="t1486644291" t="gfredericks now that I&apos;ve said &quot;goog&quot; so many times out loud I realize that a reasonable cljs approach is just to only support the native range"><y>#</y><d>2017-02-09</d><h>12:44</h><w>gfredericks</w>now that I&apos;ve said &quot;goog&quot; so many times out loud I realize that a reasonable cljs approach is just to only support the native range</z><z id="t1486644310" t="gfredericks and have the generator constructor throw if you try to do anything else"><y>#</y><d>2017-02-09</d><h>12:45</h><w>gfredericks</w>and have the generator constructor throw if you try to do anything else</z><z id="t1486645203" t="gfredericks okay I think I will do that. (gen/uniform-integer min-inclusive max-exclusive) and gen/uniform-double"><y>#</y><d>2017-02-09</d><h>13:00</h><w>gfredericks</w>okay I think I will do that. <code>(gen/uniform-integer min-inclusive max-exclusive)</code> and <code>gen/uniform-double</code></z><z id="t1486823425" t="mss hey all, new to property based testing so forgive me if this is a pretty simplistic question. what’s the idiomatic way to apply filtering functions to keys and values of generated maps? seems I could use fmap as a filtering function or such-that w a predicate, but I wanted to know if there are ramifications to using one over another"><y>#</y><d>2017-02-11</d><h>14:30</h><w>mss</w>hey all, new to property based testing so forgive me if this is a pretty simplistic question. 

what’s the idiomatic way to apply filtering functions to keys and values of generated maps? 

seems I could use <code>fmap</code> as a filtering function or <code>such-that</code> w a predicate, but I wanted to know if there are ramifications to using one over another</z><z id="t1486830303" t="Alex Miller (Clojure team) I think such-that is the preferred tool, assuming most of your generated values pass the filter"><y>#</y><d>2017-02-11</d><h>16:25</h><w>Alex Miller (Clojure team)</w>I think such-that is the preferred tool, assuming most of your generated values pass the filter</z><z id="t1486830346" t="Alex Miller (Clojure team) As such-that will give up after a fixed number of attempts "><y>#</y><d>2017-02-11</d><h>16:25</h><w>Alex Miller (Clojure team)</w>As such-that will give up after a fixed number of attempts </z><z id="t1486912476" t="mss that makes sense. and if I’m having trouble getting such-that to satisfy the predicate within a certain number of attempts, fmap still produces shrinkable generators correct?"><y>#</y><d>2017-02-12</d><h>15:14</h><w>mss</w>that makes sense. and if I’m having trouble getting <code>such-that</code> to satisfy the predicate within a certain number of attempts, <code>fmap</code> still produces shrinkable generators correct?</z><z id="t1486913497" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V5HFPU&quot;}] definitely; anything with fmap is likely more efficient than such-that as well, since it doesn&apos;t need to generate extra stuff"><y>#</y><d>2017-02-12</d><h>15:31</h><w>gfredericks</w><a>@mss</a> definitely; anything with <code>fmap</code> is likely more efficient than <code>such-that</code> as well, since it doesn&apos;t need to generate extra stuff</z><z id="t1486916227" t="mss awesome, thank you"><y>#</y><d>2017-02-12</d><h>16:17</h><w>mss</w>awesome, thank you</z><z id="t1488060494" t="mss hey all, newbie test.check question. how would I go about creating a generator for something like java date objects? I’ve found obv clojure.data.generators/date, which produces random date objects. I’m missing how to utilize that fn to produce a generator I could use in e.g. specs"><y>#</y><d>2017-02-25</d><h>22:08</h><w>mss</w>hey all, newbie test.check question. 

how would I go about creating a generator for something like java date objects? 

I’ve found obv clojure.data.generators/date, which produces random date objects. 

I’m missing how to utilize that fn to produce a generator I could use in e.g. specs</z><z id="t1488061831" t="mss I can use return but from what I can tell from the documentation, the value returned by the call should always be the same, as opposed to something randomized"><y>#</y><d>2017-02-25</d><h>22:30</h><w>mss</w>I can use <code>return</code> but from what I can tell from the documentation, the value returned by the call should always be the same, as opposed to something randomized</z><z id="t1488064042" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V5HFPU&quot;}] you can&apos;t use things in clojure.data.generators for test.check"><y>#</y><d>2017-02-25</d><h>23:07</h><w>gfredericks</w><a>@mss</a> you can&apos;t use things in clojure.data.generators for test.check</z><z id="t1488064066" t="gfredericks a super easy option is (gen/fmap #(java.util.Date. %) gen/large-integer)"><y>#</y><d>2017-02-25</d><h>23:07</h><w>gfredericks</w>a super easy option is <code>(gen/fmap #(java.util.Date. %) gen/large-integer)</code></z><z id="t1488064076" t="gfredericks if you don&apos;t care about the distribution at all that will suffice"><y>#</y><d>2017-02-25</d><h>23:07</h><w>gfredericks</w>if you don&apos;t care about the distribution at all that will suffice</z><z id="t1488064213" t="mss wonderful, thanks for the feedback"><y>#</y><d>2017-02-25</d><h>23:10</h><w>mss</w>wonderful, thanks for the feedback</z><z id="t1488064218" t="gfredericks np"><y>#</y><d>2017-02-25</d><h>23:10</h><w>gfredericks</w>np</z><z id="t1488411987" t="andrea.crotti I was wondering, if I have some constraints I want to apply with such-that"><y>#</y><d>2017-03-01</d><h>23:46</h><w>andrea.crotti</w>I was wondering, if I have some constraints I want to apply with <code>such-that</code></z><z id="t1488412007" t="andrea.crotti should they be as early as possible in the generator definition or as late as possible?"><y>#</y><d>2017-03-01</d><h>23:46</h><w>andrea.crotti</w>should they be as early as possible in the generator definition or as late as possible?</z><z id="t1488412020" t="andrea.crotti I would guess better to cut early to avoid extra computation"><y>#</y><d>2017-03-01</d><h>23:47</h><w>andrea.crotti</w>I would guess better to cut early to avoid extra computation</z><z id="t1488412053" t="andrea.crotti creating some generators for this pet project https://github.com/AndreaCrotti/scrabble/blob/master/test/clj/scrabble/core_test.clj#L114"><y>#</y><d>2017-03-01</d><h>23:47</h><w>andrea.crotti</w>creating some generators for this pet project <a href="https://github.com/AndreaCrotti/scrabble/blob/master/test/clj/scrabble/core_test.clj#L114" target="_blank">https://github.com/AndreaCrotti/scrabble/blob/master/test/clj/scrabble/core_test.clj#L114</a></z><z id="t1488412062" t="andrea.crotti (and it&apos;s pretty awesome actually I have to say)"><y>#</y><d>2017-03-01</d><h>23:47</h><w>andrea.crotti</w>(and it&apos;s pretty awesome actually I have to say)</z><z id="t1488418010" t="gfredericks [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] yep, earlier is better as you say"><y>#</y><d>2017-03-02</d><h>01:26</h><w>gfredericks</w><a>@andrea.crotti</a> yep, earlier is better as you say</z><z id="t1488446401" t="andrea.crotti cool thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2017-03-02</d><h>09:20</h><w>andrea.crotti</w>cool thanks <a>@gfredericks</a></z><z id="t1488446423" t="andrea.crotti another thing, suppose I have a bag with a limited number of objects in it per type"><y>#</y><d>2017-03-02</d><h>09:20</h><w>andrea.crotti</w>another thing, suppose I have a bag with a limited number of objects in it per type</z><z id="t1488446469" t="andrea.crotti at the moment what I&apos;m doing is to generate sequences picking random types and applying constraints to be sure there are never too many of a certain type"><y>#</y><d>2017-03-02</d><h>09:21</h><w>andrea.crotti</w>at the moment what I&apos;m doing is to generate sequences picking random types and applying constraints to be sure there are never too many of a certain type</z><z id="t1488446514" t="andrea.crotti I guess there is probably a more efficient way? in theory it&apos;s just a random selection in a list, removing the element selected each time"><y>#</y><d>2017-03-02</d><h>09:21</h><w>andrea.crotti</w>I guess there is probably a more efficient way?
in theory it&apos;s just a random selection in a list, removing the element selected each time</z><z id="t1488446535" t="andrea.crotti any more idiomatic way to do that with test.check [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] ?"><y>#</y><d>2017-03-02</d><h>09:22</h><w>andrea.crotti</w>any more idiomatic way to do that with test.check <a>@gfredericks</a> ?</z><z id="t1488450038" t="andrea.crotti btw it looks like it&apos;s not possible to file an issue here https://github.com/clojure/test.check"><y>#</y><d>2017-03-02</d><h>10:20</h><w>andrea.crotti</w>btw it looks like it&apos;s not possible to file an issue  here <a href="https://github.com/clojure/test.check" target="_blank">https://github.com/clojure/test.check</a></z><z id="t1488450056" t="andrea.crotti and there is no mention in the readme about how to do that either"><y>#</y><d>2017-03-02</d><h>10:20</h><w>andrea.crotti</w>and there is no mention in the readme about how to do that either</z><z id="t1488465121" t="gfredericks [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] clojure and all the contribs are managed on http://dev.clojure.org/jira"><y>#</y><d>2017-03-02</d><h>14:32</h><w>gfredericks</w><a>@andrea.crotti</a> clojure and all the contribs are managed on <a href="http://dev.clojure.org/jira" target="_blank">http://dev.clojure.org/jira</a></z><z id="t1488465181" t="gfredericks This is mentioned in the readme under Contributing"><y>#</y><d>2017-03-02</d><h>14:33</h><w>gfredericks</w>This is mentioned in the readme under Contributing</z><z id="t1488465295" t="gfredericks I don&apos;t quite understand the requirements for your bag of limited number of objects question -- it would help if you could share the code you have that does that"><y>#</y><d>2017-03-02</d><h>14:34</h><w>gfredericks</w>I don&apos;t quite understand the requirements for your bag of limited number of objects question -- it would help if you could share the code you have that does that</z><z id="t1488465298" t="andrea.crotti Ah sorry my bad "><y>#</y><d>2017-03-02</d><h>14:34</h><w>andrea.crotti</w>Ah sorry my bad </z><z id="t1488465322" t="andrea.crotti It&apos;s the link I shared yesterday "><y>#</y><d>2017-03-02</d><h>14:35</h><w>andrea.crotti</w>It&apos;s the link I shared yesterday </z><z id="t1488465343" t="andrea.crotti Just the usual scrabble bag of letters "><y>#</y><d>2017-03-02</d><h>14:35</h><w>andrea.crotti</w>Just the usual scrabble bag of letters </z><z id="t1488465388" t="gfredericks Oh so the main constraint is you can&apos;t have too many of each letter? "><y>#</y><d>2017-03-02</d><h>14:36</h><w>gfredericks</w>Oh so the main constraint is you can&apos;t have too many of each letter? </z><z id="t1488465406" t="andrea.crotti Yes, there is a max quantity for each "><y>#</y><d>2017-03-02</d><h>14:36</h><w>andrea.crotti</w>Yes, there is a max quantity for each </z><z id="t1488465429" t="andrea.crotti And applying constraints would work but I bet it&apos;s not really efficient "><y>#</y><d>2017-03-02</d><h>14:37</h><w>andrea.crotti</w>And applying constraints would work but I bet it&apos;s not really efficient </z><z id="t1488465444" t="gfredericks Do you care about distribution/shrinking?"><y>#</y><d>2017-03-02</d><h>14:37</h><w>gfredericks</w>Do you care about distribution/shrinking?</z><z id="t1488465446" t="andrea.crotti Maybe I can write my own generator "><y>#</y><d>2017-03-02</d><h>14:37</h><w>andrea.crotti</w>Maybe I can write my own generator </z><z id="t1488465475" t="andrea.crotti Potentially yes "><y>#</y><d>2017-03-02</d><h>14:37</h><w>andrea.crotti</w>Potentially yes </z><z id="t1488465579" t="gfredericks One idea is to generate a size (gen/nat) and a shuffling of a complete collection of letters, and then fmap with (take size shuffled)"><y>#</y><d>2017-03-02</d><h>14:39</h><w>gfredericks</w>One idea is to generate a size (gen/nat) and a shuffling of a complete collection of letters,  and then fmap with (take size shuffled)</z><z id="t1488465601" t="gfredericks gen/shuffle for doing the shuffling"><y>#</y><d>2017-03-02</d><h>14:40</h><w>gfredericks</w>gen/shuffle for doing the shuffling</z><z id="t1488465658" t="gfredericks That still does some throwaway work but it&apos;s at least conceptually simple and easy to tweak"><y>#</y><d>2017-03-02</d><h>14:40</h><w>gfredericks</w>That still does some throwaway work but it&apos;s at least conceptually simple and easy to tweak</z><z id="t1488465684" t="gfredericks And gives you a realistic distribution in a certain sense"><y>#</y><d>2017-03-02</d><h>14:41</h><w>gfredericks</w>And gives you a realistic distribution in a certain sense</z><z id="t1488470804" t="andrea.crotti ah cool yes I can check"><y>#</y><d>2017-03-02</d><h>16:06</h><w>andrea.crotti</w>ah cool yes I can check</z><z id="t1488470810" t="andrea.crotti thanks for the idea"><y>#</y><d>2017-03-02</d><h>16:06</h><w>andrea.crotti</w>thanks for the idea</z><z id="t1488470822" t="andrea.crotti writing your own generator would be problematic?"><y>#</y><d>2017-03-02</d><h>16:07</h><w>andrea.crotti</w>writing your own generator would be problematic?</z><z id="t1488470863" t="andrea.crotti about the issue I wanted to raise, I just wanted to say that now both &quot;generators&quot; and &quot;combinators&quot; are both in the same namespace"><y>#</y><d>2017-03-02</d><h>16:07</h><w>andrea.crotti</w>about the issue I wanted to raise, I just wanted to say that now both &quot;generators&quot; and &quot;combinators&quot; are both in the same namespace</z><z id="t1488470893" t="andrea.crotti and even have the same prefixed name, even if they have two quite different roles from my undertanding"><y>#</y><d>2017-03-02</d><h>16:08</h><w>andrea.crotti</w>and even have the same prefixed name, even if they have two quite different roles from my undertanding</z><z id="t1488470922" t="andrea.crotti that&apos;s all I wanted to mention really"><y>#</y><d>2017-03-02</d><h>16:08</h><w>andrea.crotti</w>that&apos;s all I wanted to mention really</z><z id="t1488473154" t="gfredericks [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] what do you mean by &quot;writing your own generator&quot;? I would call what I just described writing your own generator"><y>#</y><d>2017-03-02</d><h>16:45</h><w>gfredericks</w><a>@andrea.crotti</a> what do you mean by &quot;writing your own generator&quot;? I would call what I just described writing your own generator</z><z id="t1488473206" t="andrea.crotti ah ok but if it&apos;s just built using the &quot;official&quot; combinators and generators"><y>#</y><d>2017-03-02</d><h>16:46</h><w>andrea.crotti</w>ah ok but if it&apos;s just built using the &quot;official&quot; combinators and generators</z><z id="t1488473211" t="andrea.crotti does it count as my custom generator?"><y>#</y><d>2017-03-02</d><h>16:46</h><w>andrea.crotti</w>does it count as my custom generator?</z><z id="t1488473300" t="gfredericks [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] test.check is designed so that you shouldn&apos;t need to go beyond those"><y>#</y><d>2017-03-02</d><h>16:48</h><w>gfredericks</w><a>@andrea.crotti</a> test.check is designed so that you shouldn&apos;t need to go beyond those</z><z id="t1488473315" t="gfredericks so we don&apos;t usually talk about anything more custom than that"><y>#</y><d>2017-03-02</d><h>16:48</h><w>gfredericks</w>so we don&apos;t usually talk about anything more custom than that</z><z id="t1488473550" t="gfredericks if you have something you think you can&apos;t do with the combinators I&apos;d be happy to look at it"><y>#</y><d>2017-03-02</d><h>16:52</h><w>gfredericks</w>if you have something you think you can&apos;t do with the combinators I&apos;d be happy to look at it</z><z id="t1488475149" t="andrea.crotti ok great thanks"><y>#</y><d>2017-03-02</d><h>17:19</h><w>andrea.crotti</w>ok great thanks</z><z id="t1488817076" t="peeja Is there any way to generate a value (or a sequence of values) from a generator using a custom seed? It looks to me like the only place you can set the seed (that&apos;s a public interface) is in quick-check itself."><y>#</y><d>2017-03-06</d><h>16:17</h><w>peeja</w>Is there any way to generate a value (or a sequence of values) from a generator using a custom seed? It looks to me like the only place you can set the seed (that&apos;s a public interface) is in <code>quick-check</code> itself.</z><z id="t1488820273" t="peeja It looks like gen/vector with a min/max length ignores size . That is, I expected (gen/generate (gen/vector gen/string 0 10) 0) to generate an empty vector, but it doesn&apos;t (any more often than it would with no size given)."><y>#</y><d>2017-03-06</d><h>17:11</h><w>peeja</w>It looks like <code>gen/vector</code> with a min/max length ignores <code>size</code>. That is, I expected <code>(gen/generate (gen/vector gen/string 0 10) 0)</code> to generate an empty vector, but it doesn&apos;t (any more often than it would with no <code>size</code> given).</z><z id="t1488820281" t="peeja Is my expectation wrong, or is that a bug?"><y>#</y><d>2017-03-06</d><h>17:11</h><w>peeja</w>Is my expectation wrong, or is that a bug?</z><z id="t1488820717" t="gfredericks [:attrs {:href &quot;/_/_/users/U0F4Q1Q3E&quot;}] ignores size when picking the vector size, probably; it doesn&apos;t ignore size entirely since it&apos;ll use it when generating elements from the passed-in generator"><y>#</y><d>2017-03-06</d><h>17:18</h><w>gfredericks</w><a>@peeja</a> ignores size when picking the vector size, probably; it doesn&apos;t ignore size entirely since it&apos;ll use it when generating elements from the passed-in generator</z><z id="t1488820726" t="gfredericks I think you could call it a half-bug"><y>#</y><d>2017-03-06</d><h>17:18</h><w>gfredericks</w>I think you could call it a half-bug</z><z id="t1488820731" t="peeja Yeah, that&apos;s what I mean"><y>#</y><d>2017-03-06</d><h>17:18</h><w>peeja</w>Yeah, that&apos;s what I mean</z><z id="t1488820740" t="gfredericks I&apos;d be happy to have a ticket about it if it&apos;s a problem for you"><y>#</y><d>2017-03-06</d><h>17:19</h><w>gfredericks</w>I&apos;d be happy to have a ticket about it if it&apos;s a problem for you</z><z id="t1488820747" t="gfredericks trying to think of a workaround"><y>#</y><d>2017-03-06</d><h>17:19</h><w>gfredericks</w>trying to think of a workaround</z><z id="t1488820748" t="peeja Awesome, will do."><y>#</y><d>2017-03-06</d><h>17:19</h><w>peeja</w>Awesome, will do.</z><z id="t1488820803" t="gfredericks [:attrs {:href &quot;/_/_/users/U0F4Q1Q3E&quot;}] w.r.t. custom seeds, you&apos;d have to resort to not-quite-public-API calls such as (rose/root (gen/call-gen g (random/make-random seed) size))"><y>#</y><d>2017-03-06</d><h>17:20</h><w>gfredericks</w><a>@peeja</a> w.r.t. custom seeds, you&apos;d have to resort to not-quite-public-API calls such as <code>(rose/root (gen/call-gen g (random/make-random seed) size))</code></z><z id="t1488820821" t="gfredericks I would consider making something like that first-class if there was a compelling general need for it"><y>#</y><d>2017-03-06</d><h>17:20</h><w>gfredericks</w>I would consider making something like that first-class if there was a compelling general need for it</z><z id="t1488820948" t="peeja In my case, I&apos;m trying to determine whether a keyword&apos;s spec specifies a sequence or not by generating the simplest (cheapest) value I can and asking if it&apos;s sequential? . clojure.spec/every &apos;s generator uses a max/min even if you don&apos;t give it one, which means I&apos;m always generating elements. Generating an empty vector/list would be better, but it&apos;s not a dealbreaker, considering the size still keeps the complexity of what it generates pretty low."><y>#</y><d>2017-03-06</d><h>17:22</h><w>peeja</w>In my case, I&apos;m trying to determine whether a keyword&apos;s spec specifies a sequence or not by generating the simplest (cheapest) value I can and asking if it&apos;s <code>sequential?</code>. <code>clojure.spec/every</code>&apos;s generator uses a max/min even if you don&apos;t give it one, which means I&apos;m always generating elements. Generating an empty vector/list would be better, but it&apos;s not a dealbreaker, considering the size still keeps the complexity of what it generates pretty low.</z><z id="t1488820971" t="peeja And for the custom seed, thanks, I&apos;ll try that!"><y>#</y><d>2017-03-06</d><h>17:22</h><w>peeja</w>And for the custom seed, thanks, I&apos;ll try that!</z><z id="t1488821029" t="gfredericks every can&apos;t generate an empty collection? that sounds like a spec bug"><y>#</y><d>2017-03-06</d><h>17:23</h><w>gfredericks</w><code>every</code> can&apos;t generate an empty collection? that sounds like a spec bug</z><z id="t1488821136" t="peeja It can, but I can&apos;t force it to"><y>#</y><d>2017-03-06</d><h>17:25</h><w>peeja</w>It can, but I can&apos;t force it to</z><z id="t1488821174" t="peeja I&apos;d like (gen/generate (s/every string?) 0) to always be empty"><y>#</y><d>2017-03-06</d><h>17:26</h><w>peeja</w>I&apos;d like <code>(gen/generate (s/every string?) 0)</code> to always be empty</z><z id="t1488821442" t="gfredericks Oh I see. Spec does some manual sizing that I&apos;m not sure is justified in every case, and this might be an example of that"><y>#</y><d>2017-03-06</d><h>17:30</h><w>gfredericks</w>Oh I see. Spec does some manual sizing that I&apos;m not sure is justified in every case, and this might be an example of that</z><z id="t1488826731" t="gfredericks the question of a better distribution for gen/vector is interesting, since users could say something like (gen/vector g 0 40000) and it&apos;d seem weird to only give them relatively small vectors"><y>#</y><d>2017-03-06</d><h>18:58</h><w>gfredericks</w>the question of a better distribution for <code>gen/vector</code> is interesting, since users could say something like <code>(gen/vector g 0 40000)</code> and it&apos;d seem weird to only give them relatively small vectors</z><z id="t1488826748" t="gfredericks I&apos;m reworking the distribution of gen/large-integer and I think something based on that could work"><y>#</y><d>2017-03-06</d><h>18:59</h><w>gfredericks</w>I&apos;m reworking the distribution of <code>gen/large-integer</code> and I think something based on that could work</z><z id="t1489063707" t="jmglov I&apos;m sorry if I&apos;m repeating an oft-asked and answered question, but I&apos;m really struggling with how to write properties to test my functionality without re-implementing the code I&apos;m testing. Does anyone have a solid resource with some nice examples that could lead me out of the wilderness here?"><y>#</y><d>2017-03-09</d><h>12:48</h><w>jmglov</w>I&apos;m sorry if I&apos;m repeating an oft-asked and answered question, but I&apos;m really struggling with how to write properties to test my functionality without re-implementing the code I&apos;m testing. Does anyone have a solid resource with some nice examples that could lead me out of the wilderness here?</z><z id="t1489072558" t="nwjsmith [:attrs {:href &quot;/_/_/users/U054AT6KT&quot;}] https://fsharpforfunandprofit.com/posts/property-based-testing-2/"><y>#</y><d>2017-03-09</d><h>15:15</h><w>nwjsmith</w><a>@jmglov</a> <a href="https://fsharpforfunandprofit.com/posts/property-based-testing-2/" target="_blank">https://fsharpforfunandprofit.com/posts/property-based-testing-2/</a></z><z id="t1489074778" t="Alex Miller (Clojure team) [:attrs {:href &quot;/_/_/users/U054AT6KT&quot;}] I like to say that generative testing is easy - the only hard parts are the generators and the properties"><y>#</y><d>2017-03-09</d><h>15:52</h><w>Alex Miller (Clojure team)</w><a>@jmglov</a> I like to say that generative testing is easy - the only hard parts are the generators and the properties</z><z id="t1489074856" t="Alex Miller (Clojure team) I took a stab at this topic of finding good properties in Clojure Applied, ch 8"><y>#</y><d>2017-03-09</d><h>15:54</h><w>Alex Miller (Clojure team)</w>I took a stab at this topic of finding good properties in Clojure Applied, ch 8</z><z id="t1489074895" t="Alex Miller (Clojure team) I haven’t seen that link from [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] before but seems like generally good advice"><y>#</y><d>2017-03-09</d><h>15:54</h><w>Alex Miller (Clojure team)</w>I haven’t seen that link from <a>@nwjsmith</a> before but seems like generally good advice</z><z id="t1489076646" t="nwjsmith I’ve been working on a tool that can help with finding properties."><y>#</y><d>2017-03-09</d><h>16:24</h><w>nwjsmith</w>I’ve been working on a tool that can help with finding properties.</z><z id="t1489076701" t="nwjsmith It will take a set of properties, and the arg and return generators (e.g. from spec’s fdef ), and generate a mutation of the function under test"><y>#</y><d>2017-03-09</d><h>16:25</h><w>nwjsmith</w>It will take a set of properties, and the arg and return generators (e.g. from spec’s <code>fdef</code>), and generate a mutation of the function under test</z><z id="t1489076735" t="nwjsmith Then it will run the mutant through the properties. If the mutant passes, then the tool reports an error."><y>#</y><d>2017-03-09</d><h>16:25</h><w>nwjsmith</w>Then it will run the mutant through the properties. If the mutant passes, then the tool reports an error.</z><z id="t1489076800" t="nwjsmith It presents the mutant, which is usually very simple, and that can guide you to your next property. You play “whack-a-mutant” until no mutants pass."><y>#</y><d>2017-03-09</d><h>16:26</h><w>nwjsmith</w>It presents the mutant, which is usually very simple, and that can guide you to your next property. You play “whack-a-mutant” until no mutants pass.</z><z id="t1489076905" t="nwjsmith An example: let’s say we’re writing properties for sort , you might start with the property that the input and output lists have the same count"><y>#</y><d>2017-03-09</d><h>16:28</h><w>nwjsmith</w>An example: let’s say we’re writing properties for <code>sort</code>, you might start with the property that the input and output lists have the same count</z><z id="t1489076984" t="nwjsmith This tool will generate a really simple mutant that passes all the properties, like (fn [x] (if (= x [1]) [2] (sort x)))"><y>#</y><d>2017-03-09</d><h>16:29</h><w>nwjsmith</w>This tool will generate a really simple mutant that passes all the properties, like <code>(fn [x] (if (= x [1]) [2] (sort x)))</code></z><z id="t1489077069" t="nwjsmith We want to whack this mutant (which isn’t our sort function). So we write a property that the input and output lists have to have the same elements. Our tool finds a new mutant that passes our properties (fn [x] (if (= x [1 2]) [2 1] (sort x)))"><y>#</y><d>2017-03-09</d><h>16:31</h><w>nwjsmith</w>We want to whack this mutant (which isn’t our <code>sort</code> function). So we write a property that the input and output lists have to have the same elements. Our tool finds a new mutant that passes our properties <code>(fn [x] (if (= x [1 2]) [2 1] (sort x)))</code></z><z id="t1489077193" t="nwjsmith Finally, we write a property that says the elements of the return list should be in ascending order, and the tool reports no new mutants. This means we’ve written a complete set of properties"><y>#</y><d>2017-03-09</d><h>16:33</h><w>nwjsmith</w>Finally, we write a property that says the elements of the return list should be in ascending order, and the tool reports no new mutants. This means we’ve written a complete set of properties</z><z id="t1489077327" t="nwjsmith (it’s based on https://github.com/rudymatela/fitspec )"><y>#</y><d>2017-03-09</d><h>16:35</h><w>nwjsmith</w>(it’s based on <a href="https://github.com/rudymatela/fitspec" target="_blank">https://github.com/rudymatela/fitspec</a>)</z><z id="t1489104994" t="gfredericks that&apos;s really cool"><y>#</y><d>2017-03-10</d><h>00:16</h><w>gfredericks</w>that&apos;s really cool</z><z id="t1489138623" t="jmglov [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] I have &quot;Clojure Applied&quot;, and really love it. 🙂"><y>#</y><d>2017-03-10</d><h>09:37</h><w>jmglov</w><a>@alexmiller</a> I have &quot;Clojure Applied&quot;, and really love it. <b>🙂</b></z><z id="t1489138833" t="jmglov I&apos;ll re-read that section of chapter 8. So far, the issue I&apos;ve had with existing resources on property-based testing is that the examples have to be small enough to fit in a chapter or blog post, and thus don&apos;t cover the complexity of the type of business logic that exists in production systems."><y>#</y><d>2017-03-10</d><h>09:40</h><w>jmglov</w>I&apos;ll re-read that section of chapter 8. So far, the issue I&apos;ve had with existing resources on property-based testing is that the examples have to be small enough to fit in a chapter or blog post, and thus don&apos;t cover the complexity of the type of business logic that exists in production systems.</z><z id="t1489138880" t="jmglov I feel like I&apos;m so close to enlightenment with property-based testing, but haven&apos;t had the &quot;a-ha!&quot; moment yet."><y>#</y><d>2017-03-10</d><h>09:41</h><w>jmglov</w>I feel like I&apos;m so close to enlightenment with property-based testing, but haven&apos;t had the &quot;a-ha!&quot; moment yet.</z><z id="t1489138961" t="jmglov [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] Thanks for the link! I&apos;m really looking forward to seeing the tool you&apos;re working on, as well. 🙂"><y>#</y><d>2017-03-10</d><h>09:42</h><w>jmglov</w><a>@nwjsmith</a> Thanks for the link! I&apos;m really looking forward to seeing the tool you&apos;re working on, as well. <b>🙂</b></z><z id="t1491338667" t="johanatan hi, is there an equivalent of listOfN ? list-distinct comes close (with its :num-elements param) but I don&apos;t want to forbid duplicates."><y>#</y><d>2017-04-04</d><h>20:44</h><w>johanatan</w>hi, is there an equivalent of <code>listOfN</code>? <code>list-distinct</code> comes close (with its <code>:num-elements</code> param) but I don&apos;t want to forbid duplicates.</z><z id="t1491338701" t="johanatan also, is there a function to convert a list of generators to a generator of a list?"><y>#</y><d>2017-04-04</d><h>20:45</h><w>johanatan</w>also, is there a function to convert a list of generators to a generator of a list?</z><z id="t1491338734" t="johanatan i suppose apply gen/tuple could do the latter"><y>#</y><d>2017-04-04</d><h>20:45</h><w>johanatan</w>i suppose <code>apply gen/tuple</code> could do the latter</z><z id="t1491339705" t="johanatan actually yes apply gen/tuple definitely answers my second question"><y>#</y><d>2017-04-04</d><h>21:01</h><w>johanatan</w>actually yes <code>apply gen/tuple</code> definitely answers my second question</z><z id="t1491343252" t="gfredericks [:attrs {:href &quot;/_/_/users/U0E98NQG2&quot;}] gen/vector can do it too."><y>#</y><d>2017-04-04</d><h>22:00</h><w>gfredericks</w><a>@johanatan</a> gen/vector can do it too.</z><z id="t1491343920" t="johanatan [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] what about listOfN ?"><y>#</y><d>2017-04-04</d><h>22:12</h><w>johanatan</w><a>@gfredericks</a> what about <code>listOfN</code>?</z><z id="t1491344112" t="gfredericks [:attrs {:href &quot;/_/_/users/U0E98NQG2&quot;}] does that mean a fixed length list? That&apos;s what I&apos;m saying gen/vector can do, if you pass a length arg"><y>#</y><d>2017-04-04</d><h>22:15</h><w>gfredericks</w><a>@johanatan</a> does that mean a fixed length list? That&apos;s what I&apos;m saying gen/vector can do, if you pass a length arg</z><z id="t1491346185" t="johanatan Oh I see. Yes a fixed length list "><y>#</y><d>2017-04-04</d><h>22:49</h><w>johanatan</w>Oh I see. Yes a fixed length list </z><z id="t1491346188" t="johanatan Thx!"><y>#</y><d>2017-04-04</d><h>22:49</h><w>johanatan</w>Thx!</z><z id="t1492308386" t="nberger [:attrs {:href &quot;/_/_/users/U0CJ8PTE1&quot;}] one way is using gen/let : (defn gen-with-index-and-count-using-let &quot;Return a generator that will return tuples of: [&lt;value from coll-gen&gt; [&lt;valid index in coll&gt; &lt;count within bounds of index to end of coll&gt;].&quot; [coll-gen] (gen/let [coll coll-gen index (gen/choose 0 (max 0 (dec (count coll)))) bounded-count (gen/choose 0 (- (count coll) index))] [coll [index bounded-count]])) "><y>#</y><d>2017-04-16</d><h>02:06</h><w>nberger</w><a>@jfntn</a> one way is using <code>gen/let</code>:
<pre>(defn gen-with-index-and-count-using-let
    &quot;Return a generator that will return tuples of:
    [&lt;value from coll-gen&gt;
    [&lt;valid index in coll&gt;
    &lt;count within bounds of index to end of coll&gt;].&quot;
    [coll-gen]
    (gen/let [coll coll-gen
              index (gen/choose 0 (max 0 (dec (count coll))))
              bounded-count (gen/choose 0 (- (count coll) index))]
      [coll [index bounded-count]]))
</pre></z><z id="t1492308537" t="nberger makes it much easier to read to my eyes 🙂"><y>#</y><d>2017-04-16</d><h>02:08</h><w>nberger</w>makes it much easier to read to my eyes <b>🙂</b></z><z id="t1492318938" t="jfntn Ooh monads 😄 very nice, didn’t know about this let, thank you"><y>#</y><d>2017-04-16</d><h>05:02</h><w>jfntn</w>Ooh monads <b>😄</b> very nice, didn’t know about this let, thank you</z><z id="t1492365779" t="nberger Hehe yeah, it&apos;s a macro that takes those bindings and transform them to use gen/bind so it&apos;s probably generating something similar to your original generator"><y>#</y><d>2017-04-16</d><h>18:02</h><w>nberger</w>Hehe yeah, it&apos;s a macro that takes those bindings and transform them to use gen/bind so it&apos;s probably generating something similar to your original generator</z><z id="t1493075963" t="kenny Oooo, super simple 🙂 (gen/vector-distinct gen/double {:min-elements 2 :max-elements 10}) "><y>#</y><d>2017-04-24</d><h>23:19</h><w>kenny</w>Oooo, super simple <b>🙂</b>
<pre>(gen/vector-distinct gen/double {:min-elements 2
                                               :max-elements 10})
</pre></z><z id="t1493210772" t="gfredericks I&apos;m working on a biginteger generator for test.check, presumably to be used by spec as well (directly or indirectly); the main decision to make is what the distribution should be. Here&apos;s what I&apos;ve got so far, interested in any comments. https://gist.github.com/gfredericks/b6b59f1c531dc36017e45f2f0beeff9e"><y>#</y><d>2017-04-26</d><h>12:46</h><w>gfredericks</w>I&apos;m working on a biginteger generator for test.check, presumably to be used by spec as well (directly or indirectly); the main decision to make is what the distribution should be. Here&apos;s what I&apos;ve got so far, interested in any comments.

<a href="https://gist.github.com/gfredericks/b6b59f1c531dc36017e45f2f0beeff9e" target="_blank">https://gist.github.com/gfredericks/b6b59f1c531dc36017e45f2f0beeff9e</a></z><z id="t1493231971" t="bbloom let’s say i want to test some stateful thing by generating a sequence of actions to perform"><y>#</y><d>2017-04-26</d><h>18:39</h><w>bbloom</w>let’s say i want to test some stateful thing by generating a sequence of actions to perform</z><z id="t1493231982" t="bbloom how do i use state to inform future generated actions?"><y>#</y><d>2017-04-26</d><h>18:39</h><w>bbloom</w>how do i use state to inform future generated actions?</z><z id="t1493232066" t="bbloom simple example: let’s say i want to test a growable array class with three methods: getLength, append, and getNth"><y>#</y><d>2017-04-26</d><h>18:41</h><w>bbloom</w>simple example: let’s say i want to test a growable array class with three methods:  getLength, append, and getNth</z><z id="t1493232084" t="bbloom that was easy to test, but as soon as i wanted to test setNth, i was at a loss"><y>#</y><d>2017-04-26</d><h>18:41</h><w>bbloom</w>that was easy to test, but as soon as i wanted to test setNth, i was at a loss</z><z id="t1493232100" t="bbloom how do i make it so that setNth can check getLength first?"><y>#</y><d>2017-04-26</d><h>18:41</h><w>bbloom</w>how do i make it so that setNth can check getLength first?</z><z id="t1493232142" t="bbloom my current hack is to just do modulo math at the time of applying the action - but that only works for this simple example &amp; i have more complex stuff i want to test"><y>#</y><d>2017-04-26</d><h>18:42</h><w>bbloom</w>my current hack is to just do modulo math at the time of applying the action - but that only works for this simple example &amp; i have more complex stuff i want to test</z><z id="t1493232306" t="bbloom my best guest is to try defining generators recursively, deferred by an fmap or bind or something - but wasn’t sure if that was a hack or recommended or what"><y>#</y><d>2017-04-26</d><h>18:45</h><w>bbloom</w>my best guest is to try defining generators recursively, deferred by an fmap or bind or something - but wasn’t sure if that was a hack or recommended or what</z><z id="t1493232344" t="bbloom ie parameterize them based on a model of the state"><y>#</y><d>2017-04-26</d><h>18:45</h><w>bbloom</w>ie parameterize them based on a model of the state</z><z id="t1493232400" t="Alex Miller (Clojure team) the general approach is to first build a (random) model, then produce the action list via fmap/bind"><y>#</y><d>2017-04-26</d><h>18:46</h><w>Alex Miller (Clojure team)</w>the general approach is to first build a (random) model, then produce the action list via fmap/bind</z><z id="t1493232464" t="bbloom not 100% sure i follow. is there a super simple example somewhere?"><y>#</y><d>2017-04-26</d><h>18:47</h><w>bbloom</w>not 100% sure i follow. is there a super simple example somewhere?</z><z id="t1493232568" t="gfredericks There&apos;s a whole lib for this kind of thing I think"><y>#</y><d>2017-04-26</d><h>18:49</h><w>gfredericks</w>There&apos;s a whole lib for this kind of thing I think</z><z id="t1493232594" t="gfredericks https://github.com/czan/stateful-check"><y>#</y><d>2017-04-26</d><h>18:49</h><w>gfredericks</w><a href="https://github.com/czan/stateful-check" target="_blank">https://github.com/czan/stateful-check</a></z><z id="t1493232600" t="bbloom i’m looking at two such libraries now, trying to see if they clarify things for me: stateful-check and states"><y>#</y><d>2017-04-26</d><h>18:50</h><w>bbloom</w>i’m looking at two such libraries now, trying to see if they clarify things for me: stateful-check and states</z><z id="t1493232619" t="gfredericks I haven&apos;t used either, but I&apos;ve reviewed stateful-check a bit and it seems solid"><y>#</y><d>2017-04-26</d><h>18:50</h><w>gfredericks</w>I haven&apos;t used either, but I&apos;ve reviewed stateful-check a bit and it seems solid</z><z id="t1493232763" t="bbloom there’s a non-trivial amount of code in this lib. i’ll study it, but i’m hoping to identify the essence of it."><y>#</y><d>2017-04-26</d><h>18:52</h><w>bbloom</w>there’s a non-trivial amount of code in this lib. i’ll study it, but i’m hoping to identify the essence of it.</z><z id="t1493232880" t="gfredericks [:attrs {:href &quot;/_/_/users/U053S2W0V&quot;}] do you understand the idea of modeling the whole interaction ahead of time?"><y>#</y><d>2017-04-26</d><h>18:54</h><w>gfredericks</w><a>@bbloom</a> do you understand the idea of modeling the whole interaction ahead of time?</z><z id="t1493232921" t="Alex Miller (Clojure team) it’s been a while since I’ve looked at collection-check but I know it does a lot of this operation kind of thing (can’t remember if it’s stateful though)"><y>#</y><d>2017-04-26</d><h>18:55</h><w>Alex Miller (Clojure team)</w>it’s been a while since I’ve looked at collection-check but I know it does a lot of this operation kind of thing (can’t remember if it’s stateful though)</z><z id="t1493232998" t="bbloom so i haven’t used test-check in anger at all, but i did successfully roll my own generative/simulation testing thing in go for a wire protocol. but that was a hierarchical temporal marckov model, i didn’t do shrinking, and i did all the validation later on the log file - worked mostly as a stress test for a long running system"><y>#</y><d>2017-04-26</d><h>18:56</h><w>bbloom</w>so i haven’t used test-check in anger at all, but i did successfully roll my own generative/simulation testing thing in go for a wire protocol. but that was a hierarchical temporal marckov model, i didn’t do shrinking, and i did all the validation later on the log file - worked mostly as a stress test for a long running system</z><z id="t1493233048" t="bbloom to get multiple tests, i didn’t have a backtracking generator type thing - instead just ran a bunch in parallel, since they were also testing limited hardware resources (ie physical devices)"><y>#</y><d>2017-04-26</d><h>18:57</h><w>bbloom</w>to get multiple tests, i didn’t have a backtracking generator type thing - instead just ran a bunch in parallel, since they were also testing limited hardware resources (ie physical devices)</z><z id="t1493233061" t="gfredericks I think the shrinking model is the biggest reason that the generate-everything-up-front approach works best"><y>#</y><d>2017-04-26</d><h>18:57</h><w>gfredericks</w>I think the shrinking model is the biggest reason that the generate-everything-up-front approach works best</z><z id="t1493233061" t="bbloom so i have a bit of a grasp on the concepts, but no knowledge of the specific apis"><y>#</y><d>2017-04-26</d><h>18:57</h><w>bbloom</w>so i have a bit of a grasp on the concepts, but no knowledge of the specific apis</z><z id="t1493233083" t="bbloom sooo now back to your question: i’m not sure what you mean “modeling the whole itneraction ahead of time”"><y>#</y><d>2017-04-26</d><h>18:58</h><w>bbloom</w>sooo now back to your question: i’m not sure what you mean “modeling the whole itneraction ahead of time”</z><z id="t1493233091" t="gfredericks the only viable alternative I&apos;ve seen is the python/hypothesis approach which is extremely imperative and wildly different"><y>#</y><d>2017-04-26</d><h>18:58</h><w>gfredericks</w>the only viable alternative I&apos;ve seen is the python/hypothesis approach which is extremely imperative and wildly different</z><z id="t1493233096" t="bbloom [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : i’m looking at collection-check, as what i’m doing is quite similar. thanks"><y>#</y><d>2017-04-26</d><h>18:58</h><w>bbloom</w><a>@alexmiller</a>: i’m looking at collection-check, as what i’m doing is quite similar. thanks</z><z id="t1493233159" t="gfredericks [:attrs {:href &quot;/_/_/users/U053S2W0V&quot;}] I mean the generator generates the entire intended interaction, e.g. - insert a - insert b - read 0, expect a - read 1, expect b - etc."><y>#</y><d>2017-04-26</d><h>18:59</h><w>gfredericks</w><a>@bbloom</a> I mean the generator generates the entire intended interaction, e.g.

- insert a
- insert b
- read 0, expect a
- read 1, expect b
- etc.</z><z id="t1493233172" t="gfredericks I believe this is essentially the idea behind stateful-check"><y>#</y><d>2017-04-26</d><h>18:59</h><w>gfredericks</w>I believe this is essentially the idea behind stateful-check</z><z id="t1493233184" t="gfredericks it does all the wiring-up for you"><y>#</y><d>2017-04-26</d><h>18:59</h><w>gfredericks</w>it does all the wiring-up for you</z><z id="t1493233210" t="bbloom yeah, so i’m trying to test some java code that is stateful &amp; i’m successfully generating a sequence of actions &amp; applying them"><y>#</y><d>2017-04-26</d><h>19:00</h><w>bbloom</w>yeah, so i’m trying to test some java code that is stateful &amp; i’m successfully generating a sequence of actions &amp; applying them</z><z id="t1493233244" t="bbloom the tricky bit is the bit that stateful-check seems to address: using the state of the model in order inform the generators"><y>#</y><d>2017-04-26</d><h>19:00</h><w>bbloom</w>the tricky bit is the bit that stateful-check seems to address: using the state of the model in order inform the generators</z><z id="t1493233308" t="gfredericks &quot;Why can&apos;t I call generators in the middle of my test?&quot; is a common thing people run into; currently test.check doesn&apos;t try to give you a way to do that, but I&apos;m not 100% convinced it can&apos;t be done"><y>#</y><d>2017-04-26</d><h>19:01</h><w>gfredericks</w>&quot;Why can&apos;t I call generators in the middle of my test?&quot; is a common thing people run into; currently test.check doesn&apos;t try to give you a way to do that, but I&apos;m not 100% convinced it can&apos;t be done</z><z id="t1493233320" t="gfredericks I&apos;ve thought about it a lot; the shrinking is the hard part"><y>#</y><d>2017-04-26</d><h>19:02</h><w>gfredericks</w>I&apos;ve thought about it a lot; the shrinking is the hard part</z><z id="t1493233358" t="bbloom the fact that it’s asked for a lot leads me to wonder: is it a misunderstanding that leads to it being wanted? or it just hard to provide?"><y>#</y><d>2017-04-26</d><h>19:02</h><w>bbloom</w>the fact that it’s asked for a lot leads me to wonder: is it a misunderstanding that leads to it being wanted? or it just hard to provide?</z><z id="t1493233364" t="bbloom ie should i be thinking about it differently?"><y>#</y><d>2017-04-26</d><h>19:02</h><w>bbloom</w>ie should i be thinking about it differently?</z><z id="t1493233412" t="Alex Miller (Clojure team) We&apos;ve done a number of sim testing projects at Cognitect that pushed this kind of thing really far"><y>#</y><d>2017-04-26</d><h>19:03</h><w>Alex Miller (Clojure team)</w>We&apos;ve done a number of sim testing projects at Cognitect that pushed this kind of thing really far</z><z id="t1493233445" t="Alex Miller (Clojure team) But there you don&apos;t really care about shrinking at all"><y>#</y><d>2017-04-26</d><h>19:04</h><w>Alex Miller (Clojure team)</w>But there you don&apos;t really care about shrinking at all</z><z id="t1493233491" t="bbloom glad to hear that - since i had no use for shrinking in my sim test and wondered if i was just missing out"><y>#</y><d>2017-04-26</d><h>19:04</h><w>bbloom</w>glad to hear that - since i had no use for shrinking in my sim test and wondered if i was just missing out</z><z id="t1493233515" t="Alex Miller (Clojure team) I&apos;d ask [:attrs {:href &quot;/_/_/users/U04V47GHC&quot;}] about some of those ideas - he has some libs that I think are oss that do statistical / stateful generative stuff"><y>#</y><d>2017-04-26</d><h>19:05</h><w>Alex Miller (Clojure team)</w>I&apos;d ask <a>@luke</a> about some of those ideas - he has some libs that I think are oss that do statistical / stateful generative stuff</z><z id="t1493233522" t="bbloom this is the first time i wanted to test something that felt complex enough to justify test check and not complex enough to justify distributed sim testing"><y>#</y><d>2017-04-26</d><h>19:05</h><w>bbloom</w>this is the first time i wanted to test something that felt complex enough to justify test check and not complex enough to justify distributed sim testing</z><z id="t1493233525" t="gfredericks it should be possible to write a thingamajigger to call generators in the test deterministically, without doing any shrinking"><y>#</y><d>2017-04-26</d><h>19:05</h><w>gfredericks</w>it should be possible to write a thingamajigger to call generators in the test deterministically, without doing any shrinking</z><z id="t1493233662" t="Alex Miller (Clojure team) In general with sim testing you want some simple (ish) model how users use the system such that you can generate realistic (ish) streams of random activity"><y>#</y><d>2017-04-26</d><h>19:07</h><w>Alex Miller (Clojure team)</w>In general with sim testing you want some simple (ish) model how users use the system such that you can generate realistic (ish) streams of random activity</z><z id="t1493233707" t="bbloom yeah - in my case, i simulated a police officer on patrol. turning cameras on and off, watching videos, driving to and from places with or without wifi, etc"><y>#</y><d>2017-04-26</d><h>19:08</h><w>bbloom</w>yeah - in my case, i simulated a police officer on patrol. turning cameras on and off, watching videos, driving to and from places with or without wifi, etc</z><z id="t1493233719" t="bbloom worked nicely"><y>#</y><d>2017-04-26</d><h>19:08</h><w>bbloom</w>worked nicely</z><z id="t1493233740" t="Alex Miller (Clojure team) Yeah, exactly"><y>#</y><d>2017-04-26</d><h>19:09</h><w>Alex Miller (Clojure team)</w>Yeah, exactly</z><z id="t1493233757" t="Alex Miller (Clojure team) Our domains were a lot more complicated :)"><y>#</y><d>2017-04-26</d><h>19:09</h><w>Alex Miller (Clojure team)</w>Our domains were a lot more complicated :)</z><z id="t1493233769" t="bbloom i’d imagine"><y>#</y><d>2017-04-26</d><h>19:09</h><w>bbloom</w>i’d imagine</z><z id="t1493233794" t="Alex Miller (Clojure team) Cognitect does arch consult gigs, just saying :)"><y>#</y><d>2017-04-26</d><h>19:09</h><w>Alex Miller (Clojure team)</w>Cognitect does arch consult gigs, just saying :)</z><z id="t1493233821" t="bbloom 🙂"><y>#</y><d>2017-04-26</d><h>19:10</h><w>bbloom</w><b>🙂</b></z><z id="t1493233843" t="gfredericks ...arch?"><y>#</y><d>2017-04-26</d><h>19:10</h><w>gfredericks</w>...arch?</z><z id="t1493233887" t="Alex Miller (Clojure team) architecture"><y>#</y><d>2017-04-26</d><h>19:11</h><w>Alex Miller (Clojure team)</w>architecture</z><z id="t1493233905" t="gfredericks like...CPU chips? big buildings?"><y>#</y><d>2017-04-26</d><h>19:11</h><w>gfredericks</w>like...CPU chips? big buildings?</z><z id="t1493233913" t="gfredericks large-scale computer systems?"><y>#</y><d>2017-04-26</d><h>19:11</h><w>gfredericks</w>large-scale computer systems?</z><z id="t1493233919" t="Alex Miller (Clojure team) That"><y>#</y><d>2017-04-26</d><h>19:11</h><w>Alex Miller (Clojure team)</w>That</z><z id="t1493233932" t="Alex Miller (Clojure team) Really any scale :)"><y>#</y><d>2017-04-26</d><h>19:12</h><w>Alex Miller (Clojure team)</w>Really any scale :)</z><z id="t1493233943" t="Alex Miller (Clojure team) Architecture review "><y>#</y><d>2017-04-26</d><h>19:12</h><w>Alex Miller (Clojure team)</w>Architecture review </z><z id="t1493234033" t="bbloom i don’t work on that any more, but the team seems quite happy with the architecture i built for them - which is largely clojure/hickey-inspired, thank you very much 😉"><y>#</y><d>2017-04-26</d><h>19:13</h><w>bbloom</w>i don’t work on that any more, but the team seems quite happy with the architecture i built for them - which is largely clojure/hickey-inspired, thank you very much <b>😉</b></z><z id="t1493234173" t="bbloom [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] i don’t quite understand the api well enough yet to know if that code is useful to me"><y>#</y><d>2017-04-26</d><h>19:16</h><w>bbloom</w><a>@gfredericks</a> i don’t quite understand the api well enough yet to know if that code is useful to me</z><z id="t1493234186" t="gfredericks [:attrs {:href &quot;/_/_/users/U053S2W0V&quot;}] I added an example"><y>#</y><d>2017-04-26</d><h>19:16</h><w>gfredericks</w><a>@bbloom</a> I added an example</z><z id="t1493234204" t="gfredericks the idea is you generate one of these f s and then you can call it from the body of your property as many times as you want with arbitrary generators"><y>#</y><d>2017-04-26</d><h>19:16</h><w>gfredericks</w>the idea is you generate one of these <code>f</code>s and then you can call it from the body of your property as many times as you want with arbitrary generators</z><z id="t1493234255" t="gfredericks it&apos;s a stateful function, whose state is randomness derived from the normal test.check source of randomness, so the whole thing should be deterministic as long as you don&apos;t call the function in nondeterministic ways"><y>#</y><d>2017-04-26</d><h>19:17</h><w>gfredericks</w>it&apos;s a stateful function, whose state is randomness derived from the normal test.check source of randomness, so the whole thing should be deterministic as long as you don&apos;t call the function in nondeterministic ways</z><z id="t1493234292" t="bbloom i’m not sure i need something that sophisticated"><y>#</y><d>2017-04-26</d><h>19:18</h><w>bbloom</w>i’m not sure i need something that sophisticated</z><z id="t1493234370" t="gfredericks so e.g., if you have your stateful java collection and want to generate a valid index, you&apos;d call (f (gen/choose 0 (dec (.getLength thingamajig))))"><y>#</y><d>2017-04-26</d><h>19:19</h><w>gfredericks</w>so e.g., if you have your stateful java collection and want to generate a valid index, you&apos;d call <code>(f (gen/choose 0 (dec (.getLength thingamajig))))</code></z><z id="t1493234400" t="gfredericks and that call would return an index between 0 and (dec (.getLength thingamajig))"><y>#</y><d>2017-04-26</d><h>19:20</h><w>gfredericks</w>and that call would return an index between <code>0</code> and <code>(dec (.getLength thingamajig))</code></z><z id="t1493234418" t="gfredericks the sophistication is mostly to satisfy my own ideals of reproducibility"><y>#</y><d>2017-04-26</d><h>19:20</h><w>gfredericks</w>the sophistication is mostly to satisfy my own ideals of reproducibility</z><z id="t1493234440" t="gfredericks if you couldn&apos;t care less about that you can just call gen/generate and not bother with any of this"><y>#</y><d>2017-04-26</d><h>19:20</h><w>gfredericks</w>if you couldn&apos;t care less about that you can just call <code>gen/generate</code> and not bother with any of this</z><z id="t1493234710" t="bbloom so i don’t actually need to call .getLength on the real stateful object during test execution"><y>#</y><d>2017-04-26</d><h>19:25</h><w>bbloom</w>so i don’t actually need to call .getLength on the real stateful object during test execution</z><z id="t1493234719" t="bbloom i just want to track some state in the model &amp; use that to inform which actions to generate"><y>#</y><d>2017-04-26</d><h>19:25</h><w>bbloom</w>i just want to track some state in the model &amp; use that to inform which actions to generate</z><z id="t1493234751" t="bbloom looking at collection-check, they seem to use clojure’s types as a model"><y>#</y><d>2017-04-26</d><h>19:25</h><w>bbloom</w>looking at collection-check, they seem to use clojure’s types as a model</z><z id="t1493234775" t="bbloom but zach does basically what i mentioned earlier: he generates wild indexes for nth/assoc and then fixes them up during execution"><y>#</y><d>2017-04-26</d><h>19:26</h><w>bbloom</w>but zach does basically what i mentioned earlier: he generates wild indexes for nth/assoc and then fixes them up during execution</z><z id="t1493234880" t="bbloom how much am i expected to know about the rose tree stuff in order to make effective use of test-check? this stateful-check thing manipulates it quite a bit, plus has some gen-do monadic bind syntax etc that seems redundant w/ fmap, gen/let, etc"><y>#</y><d>2017-04-26</d><h>19:28</h><w>bbloom</w>how much am i expected to know about the rose tree stuff in order to make effective use of test-check? this stateful-check thing manipulates it quite a bit, plus has some gen-do monadic bind syntax etc that seems redundant w/ fmap, gen/let, etc</z><z id="t1493234921" t="gfredericks users don&apos;t normally need to care about the rose tree"><y>#</y><d>2017-04-26</d><h>19:28</h><w>gfredericks</w>users don&apos;t normally need to care about the rose tree</z></g><g id="s3"><z id="t1493234968" t="gfredericks my guess is that stateful-check&apos;s low-level internals are an attempt to shrink better than the naive shrinking you get by making a pile of binds"><y>#</y><d>2017-04-26</d><h>19:29</h><w>gfredericks</w>my guess is that stateful-check&apos;s low-level internals are an attempt to shrink better than the naive shrinking you get by making a pile of binds</z><z id="t1493234986" t="gfredericks gen/bind is pretty dumb about shrinking"><y>#</y><d>2017-04-26</d><h>19:29</h><w>gfredericks</w><code>gen/bind</code> is pretty dumb about shrinking</z><z id="t1493235011" t="gfredericks and stateful-check might be able to make assumptions that bind can&apos;t"><y>#</y><d>2017-04-26</d><h>19:30</h><w>gfredericks</w>and stateful-check might be able to make assumptions that <code>bind</code> can&apos;t</z><z id="t1493235053" t="gfredericks maybe a simple example of generating a model with actions would be helpful"><y>#</y><d>2017-04-26</d><h>19:30</h><w>gfredericks</w>maybe a simple example of generating a model with actions would be helpful</z><z id="t1493235088" t="gfredericks gimme a minute"><y>#</y><d>2017-04-26</d><h>19:31</h><w>gfredericks</w>gimme a minute</z><z id="t1493235103" t="bbloom thanks for your help. greatly appreciated"><y>#</y><d>2017-04-26</d><h>19:31</h><w>bbloom</w>thanks for your help. greatly appreciated</z><z id="t1493235107" t="bbloom you too [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}]"><y>#</y><d>2017-04-26</d><h>19:31</h><w>bbloom</w>you too <a>@alexmiller</a></z><z id="t1493235245" t="bbloom i’m still reading and trying to make sense of stateful-check, but some things concern me"><y>#</y><d>2017-04-26</d><h>19:34</h><w>bbloom</w>i’m still reading and trying to make sense of stateful-check, but some things concern me</z><z id="t1493235269" t="bbloom for example, command argument generation seems to attempt to implicitly and recursively lift values to be generators"><y>#</y><d>2017-04-26</d><h>19:34</h><w>bbloom</w>for example, command argument generation seems to attempt to implicitly and recursively lift values to be generators</z><z id="t1493235285" t="bbloom which seems like magic i don’t want, at least not before i am comfortable w/ the monadic api"><y>#</y><d>2017-04-26</d><h>19:34</h><w>bbloom</w>which seems like magic i don’t want, at least not before i am comfortable w/ the monadic api</z><z id="t1493235320" t="bbloom meanwhile, i’m failing to extract the essence from the core of the generate-commands* routine"><y>#</y><d>2017-04-26</d><h>19:35</h><w>bbloom</w>meanwhile, i’m failing to extract the essence from the core of the generate-commands* routine</z><z id="t1493235424" t="gfredericks yeah I&apos;ve never liked the values-can-be-generators idea"><y>#</y><d>2017-04-26</d><h>19:37</h><w>gfredericks</w>yeah I&apos;ve never liked the values-can-be-generators idea</z><z id="t1493235443" t="gfredericks in practice it&apos;s probably not too confusing"><y>#</y><d>2017-04-26</d><h>19:37</h><w>gfredericks</w>in practice it&apos;s probably not too confusing</z><z id="t1493235461" t="gfredericks ....maybe"><y>#</y><d>2017-04-26</d><h>19:37</h><w>gfredericks</w>....maybe</z><z id="t1493235476" t="bbloom ….maybe with a type system? 😛"><y>#</y><d>2017-04-26</d><h>19:37</h><w>bbloom</w>….maybe with a type system? <b>😛</b></z><z id="t1493235487" t="gfredericks yeah 🙂"><y>#</y><d>2017-04-26</d><h>19:38</h><w>gfredericks</w>yeah <b>🙂</b></z><z id="t1493235660" t="gfredericks could fancy it up to add the intermediate state at each step, or generate random assertions if you don&apos;t want to just compare the whole map"><y>#</y><d>2017-04-26</d><h>19:41</h><w>gfredericks</w>could fancy it up to add the intermediate state at each step, or generate random assertions if you don&apos;t want to just compare the whole map</z><z id="t1493235672" t="gfredericks note that the gen/let s are where bind is happening"><y>#</y><d>2017-04-26</d><h>19:41</h><w>gfredericks</w>note that the <code>gen/let</code>s are where <code>bind</code> is happening</z><z id="t1493235732" t="gfredericks there might be stack problems with this; maybe that&apos;s another reason for stateful-check&apos;s complexity"><y>#</y><d>2017-04-26</d><h>19:42</h><w>gfredericks</w>there might be stack problems with this; maybe that&apos;s another reason for stateful-check&apos;s complexity</z><z id="t1493235746" t="gfredericks e.g., if you wanted to generate 10000 actions you might have problems"><y>#</y><d>2017-04-26</d><h>19:42</h><w>gfredericks</w>e.g., if you wanted to generate 10000 actions you might have problems</z><z id="t1493235753" t="bbloom yeah - so i tried something like this and got a stackoverflow"><y>#</y><d>2017-04-26</d><h>19:42</h><w>bbloom</w>yeah - so i tried something like this and got a stackoverflow</z><z id="t1493235779" t="bbloom but thanks, this example is much closer to my intuition"><y>#</y><d>2017-04-26</d><h>19:42</h><w>bbloom</w>but thanks, this example is much closer to my intuition</z><z id="t1493235800" t="gfredericks I just generated 20,000 of these up to the normal max-size of 200 and got no exceptions"><y>#</y><d>2017-04-26</d><h>19:43</h><w>gfredericks</w>I just generated 20,000 of these up to the normal max-size of <code>200</code> and got no exceptions</z><z id="t1493235829" t="gfredericks looks like the sizes don&apos;t get above 20 though"><y>#</y><d>2017-04-26</d><h>19:43</h><w>gfredericks</w>looks like the sizes don&apos;t get above 20 though</z><z id="t1493235832" t="gfredericks so that might be bad"><y>#</y><d>2017-04-26</d><h>19:43</h><w>gfredericks</w>so that might be bad</z><z id="t1493235874" t="gfredericks that&apos;s probably why it&apos;s not SOing 🙂"><y>#</y><d>2017-04-26</d><h>19:44</h><w>gfredericks</w>that&apos;s probably why it&apos;s not SOing <b>🙂</b></z><z id="t1493235884" t="bbloom 😛"><y>#</y><d>2017-04-26</d><h>19:44</h><w>bbloom</w><b>😛</b></z><z id="t1493235890" t="gfredericks to get larger you&apos;d use gen/frequency instead of gen/one-of and tweak the weights"><y>#</y><d>2017-04-26</d><h>19:44</h><w>gfredericks</w>to get larger you&apos;d use <code>gen/frequency</code> instead of <code>gen/one-of</code> and tweak the weights</z><z id="t1493235902" t="gfredericks alternately you could generate a size up front and pass that through the recursion"><y>#</y><d>2017-04-26</d><h>19:45</h><w>gfredericks</w>alternately you could generate a size up front and pass that through the recursion</z><z id="t1493235902" t="bbloom well you had equal assoc/dissoc frequency"><y>#</y><d>2017-04-26</d><h>19:45</h><w>bbloom</w>well you had equal assoc/dissoc frequency</z><z id="t1493235907" t="bbloom yeah"><y>#</y><d>2017-04-26</d><h>19:45</h><w>bbloom</w>yeah</z><z id="t1493235925" t="bbloom i wasn’t doing any dissoc to reduce the size, so it grew faster"><y>#</y><d>2017-04-26</d><h>19:45</h><w>bbloom</w>i wasn’t doing any dissoc to reduce the size, so it grew faster</z><z id="t1493235962" t="gfredericks I think stack problems would be related to action-count, not the size of the state"><y>#</y><d>2017-04-26</d><h>19:46</h><w>gfredericks</w>I think stack problems would be related to action-count, not the size of the state</z><z id="t1493235996" t="bbloom oh, hmm that’s right"><y>#</y><d>2017-04-26</d><h>19:46</h><w>bbloom</w>oh, hmm that’s right</z><z id="t1493236007" t="bbloom not sure what i did, since it’s like 5000 undos ago 🙂"><y>#</y><d>2017-04-26</d><h>19:46</h><w>bbloom</w>not sure what i did, since it’s like 5000 undos ago <b>🙂</b></z><z id="t1493236090" t="bbloom with respect to shrinking: how well does that work as things grow more complex?"><y>#</y><d>2017-04-26</d><h>19:48</h><w>bbloom</w>with respect to shrinking: how well does that work as things grow more complex?</z><z id="t1493236115" t="bbloom i’m somewhat skeptical it can work well for stateful tests - since each removed operation can potentially invalidate the remainder of the operations"><y>#</y><d>2017-04-26</d><h>19:48</h><w>bbloom</w>i’m somewhat skeptical it can work well for stateful tests - since each removed operation can potentially invalidate the remainder of the operations</z><z id="t1493236122" t="gfredericks that&apos;s exactly the problem"><y>#</y><d>2017-04-26</d><h>19:48</h><w>gfredericks</w>that&apos;s exactly the problem</z><z id="t1493236155" t="gfredericks if you&apos;re using the naive bind structure in my example, what would happen is if test.check tries to shrink an earlier action it will generate a totally new set of following actions"><y>#</y><d>2017-04-26</d><h>19:49</h><w>gfredericks</w>if you&apos;re using the naive bind structure in my example, what would happen is if test.check tries to shrink an earlier action it will generate a totally new set of following actions</z><z id="t1493236168" t="gfredericks it might be that in practice this isn&apos;t as bad as it sounds"><y>#</y><d>2017-04-26</d><h>19:49</h><w>gfredericks</w>it might be that in practice this isn&apos;t as bad as it sounds</z><z id="t1493236184" t="gfredericks I get almost 0 complaints about this"><y>#</y><d>2017-04-26</d><h>19:49</h><w>gfredericks</w>I get almost 0 complaints about this</z><z id="t1493236230" t="bbloom which of course could mean 1) it’s perfect 2) no body is using it or 3) people don’t understand it well enough to complain about it without embarassing themselves like i’m doing now 🙂"><y>#</y><d>2017-04-26</d><h>19:50</h><w>bbloom</w>which of course could mean 1) it’s perfect 2) no body is using it or 3) people don’t understand it well enough to complain about it without embarassing themselves like i’m doing now <b>🙂</b></z><z id="t1493236231" t="gfredericks I made a ticket about it at least, but don&apos;t know if it will lead anywhere https://dev.clojure.org/jira/browse/TCHECK-112"><y>#</y><d>2017-04-26</d><h>19:50</h><w>gfredericks</w>I made a ticket about it at least, but don&apos;t know if it will lead anywhere <a href="https://dev.clojure.org/jira/browse/TCHECK-112" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-112</a></z><z id="t1493236243" t="gfredericks yeah exactly"><y>#</y><d>2017-04-26</d><h>19:50</h><w>gfredericks</w>yeah exactly</z><z id="t1493236257" t="gfredericks 2 isn&apos;t plausible; people are definitely using bind , at least via gen/let"><y>#</y><d>2017-04-26</d><h>19:50</h><w>gfredericks</w>2 isn&apos;t plausible; people are definitely using <code>bind</code>, at least via <code>gen/let</code></z><z id="t1493236268" t="gfredericks in fact gen/let tends to encourage over using bind"><y>#</y><d>2017-04-26</d><h>19:51</h><w>gfredericks</w>in fact <code>gen/let</code> tends to encourage over using <code>bind</code></z><z id="t1493236301" t="gfredericks i.e., using bind to combine two independent generators in a way that you could do with gen/tuple"><y>#</y><d>2017-04-26</d><h>19:51</h><w>gfredericks</w>i.e., using <code>bind</code> to combine two independent generators in a way that you could do with <code>gen/tuple</code></z><z id="t1493236343" t="bbloom does tuple do “parallel” bind? ie it shrinks from any position fairly?"><y>#</y><d>2017-04-26</d><h>19:52</h><w>bbloom</w>does tuple do “parallel” bind? ie it shrinks from any position fairly?</z><z id="t1493236359" t="bbloom and bind is “left biased”?"><y>#</y><d>2017-04-26</d><h>19:52</h><w>bbloom</w>and bind is “left biased”?</z><z id="t1493236382" t="gfredericks that...might be right"><y>#</y><d>2017-04-26</d><h>19:53</h><w>gfredericks</w>that...might be right</z><z id="t1493236388" t="gfredericks tuple shrinks each thing independently"><y>#</y><d>2017-04-26</d><h>19:53</h><w>gfredericks</w><code>tuple</code> shrinks each thing independently</z><z id="t1493236399" t="gfredericks you can always rewrite tuple with bind but not vice versa"><y>#</y><d>2017-04-26</d><h>19:53</h><w>gfredericks</w>you can always rewrite <code>tuple</code> with <code>bind</code> but not vice versa</z><z id="t1493236402" t="bbloom gotcha - so tuple is applicative"><y>#</y><d>2017-04-26</d><h>19:53</h><w>bbloom</w>gotcha - so tuple is applicative</z><z id="t1493236412" t="gfredericks that&apos;s probably true"><y>#</y><d>2017-04-26</d><h>19:53</h><w>gfredericks</w>that&apos;s probably true</z><z id="t1493236438" t="bbloom ok - so i guess i’ve confirmed 1) i understand this and 2) i still have no idea how to use the API 😛 thanks"><y>#</y><d>2017-04-26</d><h>19:53</h><w>bbloom</w>ok - so i guess i’ve confirmed 1) i understand this and 2) i still have no idea how to use the API <b>😛</b> thanks</z><z id="t1493236451" t="bbloom i’ll keep playing with it"><y>#</y><d>2017-04-26</d><h>19:54</h><w>bbloom</w>i’ll keep playing with it</z><z id="t1493236461" t="bbloom will let you know how it turns out"><y>#</y><d>2017-04-26</d><h>19:54</h><w>bbloom</w>will let you know how it turns out</z><z id="t1493236464" t="gfredericks oh well; do let me know if you have more questions or accusations"><y>#</y><d>2017-04-26</d><h>19:54</h><w>gfredericks</w>oh well; do let me know if you have more questions or accusations</z><z id="t1493236509" t="bbloom heh, i hope the accusations thing was a joke and/or not about me. let me know if i failed to politely convey my gratitude!"><y>#</y><d>2017-04-26</d><h>19:55</h><w>bbloom</w>heh, i hope the accusations thing was a joke and/or not about me. let me know if i failed to politely convey my gratitude!</z><z id="t1493236533" t="gfredericks oh yeah sorry, definitely a joke"><y>#</y><d>2017-04-26</d><h>19:55</h><w>gfredericks</w>oh yeah sorry, definitely a joke</z><z id="t1493238965" t="bbloom so shrinking only removes elements from the reproduction, right? no rewriting in any way?"><y>#</y><d>2017-04-26</d><h>20:36</h><w>bbloom</w>so shrinking only removes elements from the reproduction, right? no rewriting in any way?</z><z id="t1493239190" t="bbloom i’m attempting a “loose” approach to action generation - will leave state out of that part &amp; use state in the code that “runs” the actions. that will screw up shrinking probably, but i’ll deal with that when i have trouble pinpointing an issue in the future"><y>#</y><d>2017-04-26</d><h>20:39</h><w>bbloom</w>i’m attempting a “loose” approach to action generation - will leave state out of that part &amp; use state in the code that “runs” the actions. that will screw up shrinking probably, but i’ll deal with that when i have trouble pinpointing an issue in the future</z><z id="t1493239316" t="bbloom so like if i were testing that random access stack example from before, actions may just be like “do 5 pushes, then randomly swap elements 8 times, then do two pops, etc….”"><y>#</y><d>2017-04-26</d><h>20:41</h><w>bbloom</w>so like if i were testing that random access stack example from before, actions may just be like “do 5 pushes, then randomly swap elements 8 times, then do two pops, etc….”</z><z id="t1493239320" t="bbloom and see how that does for me"><y>#</y><d>2017-04-26</d><h>20:42</h><w>bbloom</w>and see how that does for me</z><z id="t1493240537" t="bbloom is there a generator that will (with high likelihood?) test boundary cases such as max/min integers? - the large-integer generator doesn’t seem to explicitly select those, so i guess i need to just use one-of or frequency to ensure those cases get covered (which is relevant to me b/c the code under test does some low level binary fiddling sometimes &amp; i want to make sure it doesn’t screw that up)"><y>#</y><d>2017-04-26</d><h>21:02</h><w>bbloom</w>is there a generator that will (with high likelihood?) test boundary cases such as max/min integers? - the large-integer generator doesn’t seem to explicitly select those, so i guess i need to just use one-of or frequency to ensure those cases get covered (which is relevant to me b/c the code under test does some low level binary fiddling sometimes &amp; i want to make sure it doesn’t screw that up)</z><z id="t1493243686" t="bbloom i’ve gotta say - the learning curve is relatively steep with this stuff"><y>#</y><d>2017-04-26</d><h>21:54</h><w>bbloom</w>i’ve gotta say - the learning curve is relatively steep with this stuff</z><z id="t1493243714" t="bbloom but that might just be b/c i’m not comfortable using stuff w/o understanding it - and the monadic stuff makes it a bit opaque"><y>#</y><d>2017-04-26</d><h>21:55</h><w>bbloom</w>but that might just be b/c i’m not comfortable using stuff w/o understanding it - and the monadic stuff makes it a bit opaque</z><z id="t1493243877" t="bbloom for example, it wasn’t immediately clear what a “property” really was under the hood (just a generator that produces a particular shape of data) or that it was safe to use side effecting asserts in such a property"><y>#</y><d>2017-04-26</d><h>21:57</h><w>bbloom</w>for example, it wasn’t immediately clear what a “property” really was under the hood (just a generator that produces a particular shape of data) or that it was safe to use side effecting asserts in such a property</z><z id="t1493243892" t="bbloom the readme shows an example that returns a boolean"><y>#</y><d>2017-04-26</d><h>21:58</h><w>bbloom</w>the readme shows an example that returns a boolean</z><z id="t1493243910" t="bbloom but if i tested each property individually, my tests would be far too slow"><y>#</y><d>2017-04-26</d><h>21:58</h><w>bbloom</w>but if i tested each property individually, my tests would be far too slow</z><z id="t1493245999" t="bbloom spotted http://blog.colinwilliams.name/blog/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check/ - which seems like an improvement"><y>#</y><d>2017-04-26</d><h>22:33</h><w>bbloom</w>spotted <a href="http://blog.colinwilliams.name/blog/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check/" target="_blank">http://blog.colinwilliams.name/blog/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check/</a> - which seems like an improvement</z><z id="t1493246025" t="bbloom while i’m rambling to myself (or whoever is listening?):"><y>#</y><d>2017-04-26</d><h>22:33</h><w>bbloom</w>while i’m rambling to myself (or whoever is listening?):</z><z id="t1493246067" t="bbloom i’m not quite happy with my attempts to generate action sequences yet - i’m getting more variability in parameters and less variability in the sequence of actions - i’m not sure how to influence that properly yet"><y>#</y><d>2017-04-26</d><h>22:34</h><w>bbloom</w>i’m not quite happy with my attempts to generate action sequences yet - i’m getting more variability in parameters and less variability in the sequence of actions - i’m not sure how to influence that properly yet</z><z id="t1493246099" t="bbloom to use the stack example again, i’m getting a lot of tests that try just using different elements to push on the stack, but really what i want is a lot more tests that have longer sequences of pushes/pops/etc"><y>#</y><d>2017-04-26</d><h>22:34</h><w>bbloom</w>to use the stack example again, i’m getting a lot of tests that try just using different elements to push on the stack, but really what i want is a lot more tests that have longer sequences of pushes/pops/etc</z><z id="t1493246328" t="bbloom the internal generation strategy doesn’t appear to be documented anywhere. is it a top-down strategy? or a bottom-up one? or some hybrid? i can’t really tell easily, nor what the implications of that would be"><y>#</y><d>2017-04-26</d><h>22:38</h><w>bbloom</w>the internal generation strategy doesn’t appear to be documented anywhere. is it a top-down strategy? or a bottom-up one? or some hybrid? i can’t really tell easily, nor what the implications of that would be</z><z id="t1493247807" t="gfredericks Hi"><y>#</y><d>2017-04-26</d><h>23:03</h><w>gfredericks</w>Hi</z><z id="t1493247916" t="gfredericks https://clojurians.slack.com/archives/C0JKW8K62/p1493238965936535 If you&apos;re talking about something like the event modeling code I shared earlier, new events CAN be generated during shrinking"><y>#</y><d>2017-04-26</d><h>23:05</h><w>gfredericks</w><a href="https://clojurians.slack.com/archives/C0JKW8K62/p1493238965936535" target="_blank">https://clojurians.slack.com/archives/C0JKW8K62/p1493238965936535</a>

If you&apos;re talking about something like the event modeling code I shared earlier, new events CAN be generated during shrinking</z><z id="t1493247947" t="bbloom how does that work?"><y>#</y><d>2017-04-26</d><h>23:05</h><w>bbloom</w>how does that work?</z><z id="t1493248008" t="gfredericks So bind generates a value from one generator, then uses the user supplied function to create a new generator and generates a value from that"><y>#</y><d>2017-04-26</d><h>23:06</h><w>gfredericks</w>So bind generates a value from one generator, then uses the user supplied function to create a new generator and generates a value from that</z><z id="t1493248017" t="gfredericks That much is straightforward? "><y>#</y><d>2017-04-26</d><h>23:06</h><w>gfredericks</w>That much is straightforward? </z><z id="t1493248021" t="bbloom yeah"><y>#</y><d>2017-04-26</d><h>23:07</h><w>bbloom</w>yeah</z><z id="t1493248035" t="gfredericks There are two ways to shrink from there"><y>#</y><d>2017-04-26</d><h>23:07</h><w>gfredericks</w>There are two ways to shrink from there</z><z id="t1493248066" t="gfredericks You can shrink the thing generated in the second step - that&apos;s the easy way"><y>#</y><d>2017-04-26</d><h>23:07</h><w>gfredericks</w>You can shrink the thing generated in the second step - that&apos;s the easy way</z><z id="t1493248144" t="gfredericks The hard way is to shrink the thing generated in the first step, because then you&apos;re obligated to call the user function with the new smaller value, which returns a potentiality entirely new generator that may have nothing to do with the original second-step value"><y>#</y><d>2017-04-26</d><h>23:09</h><w>gfredericks</w>The hard way is to shrink the thing generated in the first step, because then you&apos;re obligated to call the user function with the new smaller value, which returns a potentiality entirely new generator that may have nothing to do with the original second-step value</z><z id="t1493248158" t="gfredericks In any case you can&apos;t assume they&apos;re related"><y>#</y><d>2017-04-26</d><h>23:09</h><w>gfredericks</w>In any case you can&apos;t assume they&apos;re related</z><z id="t1493248202" t="gfredericks So the only way to proceed is to generate something entirely new and probably unrelated from that new generator"><y>#</y><d>2017-04-26</d><h>23:10</h><w>gfredericks</w>So the only way to proceed is to generate something entirely new and probably unrelated from that new generator</z><z id="t1493248250" t="gfredericks I suppose you could at least use the same randomness, just in case that helps. I think test.check already does that"><y>#</y><d>2017-04-26</d><h>23:10</h><w>gfredericks</w>I suppose you could at least use the same randomness, just in case that helps. I think test.check already does that</z><z id="t1493248284" t="bbloom i guess i don’t understand the shrinking process at all then - b/c what you’re saying here doesn’t make sense to me"><y>#</y><d>2017-04-26</d><h>23:11</h><w>bbloom</w>i guess i don’t understand the shrinking process at all then - b/c what you’re saying here doesn’t make sense to me</z><z id="t1493248326" t="bbloom is it just that shrinking re-runs the generators in some “shrink mode” and can do whatever the hell it wants?"><y>#</y><d>2017-04-26</d><h>23:12</h><w>bbloom</w>is it just that shrinking re-runs the generators in some “shrink mode” and can do whatever the hell it wants?</z><z id="t1493248333" t="gfredericks So shrinking is not an independent operation on generated values -- it&apos;s essentially done at generation time, by each generator in the composition"><y>#</y><d>2017-04-26</d><h>23:12</h><w>gfredericks</w>So shrinking is not an independent operation on generated values -- it&apos;s essentially done at generation time, by each generator in the composition</z><z id="t1493248362" t="gfredericks This is a difference from haskell as I understand it"><y>#</y><d>2017-04-26</d><h>23:12</h><w>gfredericks</w>This is a difference from haskell as I understand it</z><z id="t1493248398" t="bbloom so is shrinking just “re-generate, but smaller”?"><y>#</y><d>2017-04-26</d><h>23:13</h><w>bbloom</w>so is shrinking just “re-generate, but smaller”?</z><z id="t1493248405" t="gfredericks No"><y>#</y><d>2017-04-26</d><h>23:13</h><w>gfredericks</w>No</z><z id="t1493248409" t="bbloom i would have expected generate &amp; shrink to be two methods on a protocol"><y>#</y><d>2017-04-26</d><h>23:13</h><w>bbloom</w>i would have expected generate &amp; shrink to be two methods on a protocol</z><z id="t1493248435" t="gfredericks It&apos;s not - a generator returns a Very Large lazy tree of values"><y>#</y><d>2017-04-26</d><h>23:13</h><w>gfredericks</w>It&apos;s not - a generator returns a Very Large lazy tree of values</z><z id="t1493248462" t="gfredericks The root is the generated value; each node&apos;s children are ways to shrink from the value at that node"><y>#</y><d>2017-04-26</d><h>23:14</h><w>gfredericks</w>The root is the generated value; each node&apos;s children are ways to shrink from the value at that node</z><z id="t1493248472" t="gfredericks The shrinking algorithm walks that tree"><y>#</y><d>2017-04-26</d><h>23:14</h><w>gfredericks</w>The shrinking algorithm walks that tree</z><z id="t1493248494" t="gfredericks Higher order generators combine these trees"><y>#</y><d>2017-04-26</d><h>23:14</h><w>gfredericks</w>Higher order generators combine these trees</z><z id="t1493248510" t="gfredericks E.g., gen/fmap calls rose/fmap"><y>#</y><d>2017-04-26</d><h>23:15</h><w>gfredericks</w>E.g., gen/fmap calls rose/fmap</z><z id="t1493248515" t="bbloom ah, see, my mental model was one of producer/consumer"><y>#</y><d>2017-04-26</d><h>23:15</h><w>bbloom</w>ah, see, my mental model was one of producer/consumer</z><z id="t1493248520" t="bbloom emitting generated values"><y>#</y><d>2017-04-26</d><h>23:15</h><w>bbloom</w>emitting generated values</z><z id="t1493248528" t="bbloom totally wrong apparently 😛"><y>#</y><d>2017-04-26</d><h>23:15</h><w>bbloom</w>totally wrong apparently <b>😛</b></z><z id="t1493248559" t="gfredericks I can&apos;t remember if reid came up with it himself, but people don&apos;t seem to expect it"><y>#</y><d>2017-04-26</d><h>23:15</h><w>gfredericks</w>I can&apos;t remember if reid came up with it himself, but people don&apos;t seem to expect it</z><z id="t1493248577" t="gfredericks I think maybe he guessed the impl based on erlang&apos;s API"><y>#</y><d>2017-04-26</d><h>23:16</h><w>gfredericks</w>I think maybe he guessed the impl based on erlang&apos;s API</z><z id="t1493248611" t="gfredericks So perhaps john hughes is the source"><y>#</y><d>2017-04-26</d><h>23:16</h><w>gfredericks</w>So perhaps john hughes is the source</z><z id="t1493248686" t="gfredericks My talk Purely Random is about a lot of these details and about how I converted test.check to use an immutable rng"><y>#</y><d>2017-04-26</d><h>23:18</h><w>gfredericks</w>My talk Purely Random is about a lot of these details and about how I  converted test.check to use an immutable rng</z><z id="t1493248700" t="bbloom i might have to watch that"><y>#</y><d>2017-04-26</d><h>23:18</h><w>bbloom</w>i might have to watch that</z><z id="t1493248758" t="gfredericks I wish I knew how to get slack to notify me of any activity in this channel"><y>#</y><d>2017-04-26</d><h>23:19</h><w>gfredericks</w>I wish I knew how to get slack to notify me of any activity in this channel</z><z id="t1493248783" t="gfredericks Maybe I just did that"><y>#</y><d>2017-04-26</d><h>23:19</h><w>gfredericks</w>Maybe I just did that</z><z id="t1493248791" t="bbloom so if i do (gen/sample (gen/list gen/int)) for a large sample size - and take the max of the lengths of the lists, it seems to stop at 99"><y>#</y><d>2017-04-26</d><h>23:19</h><w>bbloom</w>so if i do (gen/sample (gen/list gen/int)) for a large sample size - and take the max of the lengths of the lists, it seems to stop at 99</z><z id="t1493248795" t="bbloom i have no idea what controls that value"><y>#</y><d>2017-04-26</d><h>23:19</h><w>bbloom</w>i have no idea what controls that value</z><z id="t1493248801" t="bbloom and i have no idea how to go about figuring it out lol"><y>#</y><d>2017-04-26</d><h>23:20</h><w>bbloom</w>and i have no idea how to go about figuring it out lol</z><z id="t1493248831" t="gfredericks There&apos;s a doc page in the repo on growth and shrinking"><y>#</y><d>2017-04-26</d><h>23:20</h><w>gfredericks</w>There&apos;s a doc page in the repo on growth and shrinking</z><z id="t1493248875" t="gfredericks The other thing people don&apos;t usually expect is that growth and shrinking are not related"><y>#</y><d>2017-04-26</d><h>23:21</h><w>gfredericks</w>The other thing people don&apos;t usually expect is that growth and shrinking are not related</z><z id="t1493248912" t="bbloom the word “grow” does not appear in any of the .md files in the doc directory 😛"><y>#</y><d>2017-04-26</d><h>23:21</h><w>bbloom</w>the word “grow” does not appear in any of the .md files in the doc directory <b>😛</b></z><z id="t1493248928" t="gfredericks Should be in one of the titles"><y>#</y><d>2017-04-26</d><h>23:22</h><w>gfredericks</w>Should be in one of the titles</z><z id="t1493248939" t="gfredericks Growth"><y>#</y><d>2017-04-26</d><h>23:22</h><w>gfredericks</w>Growth</z><z id="t1493248964" t="bbloom nope - maybe it’s somewhere else? i’ve read all the docs in the repo that i could find, heh"><y>#</y><d>2017-04-26</d><h>23:22</h><w>bbloom</w>nope - maybe it’s somewhere else? i’ve read all the docs in the repo that i could find, heh</z><z id="t1493248971" t="gfredericks Um"><y>#</y><d>2017-04-26</d><h>23:22</h><w>gfredericks</w>Um</z><z id="t1493248975" t="gfredericks I&apos;ll find it"><y>#</y><d>2017-04-26</d><h>23:22</h><w>gfredericks</w>I&apos;ll find it</z><z id="t1493249014" t="gfredericks https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md"><y>#</y><d>2017-04-26</d><h>23:23</h><w>gfredericks</w><a href="https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md" target="_blank">https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md</a></z><z id="t1493249021" t="gfredericks It&apos;s new, maybe you didn&apos;t have it locally"><y>#</y><d>2017-04-26</d><h>23:23</h><w>gfredericks</w>It&apos;s new, maybe you didn&apos;t have it locally</z><z id="t1493249056" t="bbloom ah, sorry - my bad. my last pull failed, i have code from december"><y>#</y><d>2017-04-26</d><h>23:24</h><w>bbloom</w>ah, sorry - my bad. my last pull failed, i have code from december</z><z id="t1493249073" t="bbloom will read that"><y>#</y><d>2017-04-26</d><h>23:24</h><w>bbloom</w>will read that</z><z id="t1493249133" t="bbloom lol, i had code checked out from ~2 days before you added that"><y>#</y><d>2017-04-26</d><h>23:25</h><w>bbloom</w>lol, i had code checked out from ~2 days before you added that</z><z id="t1493249141" t="gfredericks Haha"><y>#</y><d>2017-04-26</d><h>23:25</h><w>gfredericks</w>Haha</z><z id="t1493249635" t="bbloom ok - that doc gave me a much better idea of how growth &amp; size works. thank you!"><y>#</y><d>2017-04-26</d><h>23:33</h><w>bbloom</w>ok - that doc gave me a much better idea of how growth &amp; size works. thank you!</z><z id="t1493249643" t="bbloom however, it didn’t give me much insight in to shrinking"><y>#</y><d>2017-04-26</d><h>23:34</h><w>bbloom</w>however, it didn’t give me much insight in to shrinking</z><z id="t1493249656" t="bbloom other than the fact that shrinking is unrelated to growth 😛"><y>#</y><d>2017-04-26</d><h>23:34</h><w>bbloom</w>other than the fact that shrinking is unrelated to growth <b>😛</b></z><z id="t1493249765" t="bbloom also, i’m still not clear on how size is related to whether or not a generator is run"><y>#</y><d>2017-04-26</d><h>23:36</h><w>bbloom</w>also, i’m still not clear on how size is related to whether or not a generator is run</z><z id="t1493249772" t="bbloom for example, if i do this: (gen/sample (gen/vector (gen/resize 0 gen/int)))"><y>#</y><d>2017-04-26</d><h>23:36</h><w>bbloom</w>for example, if i do this:    (gen/sample (gen/vector (gen/resize 0 gen/int)))</z><z id="t1493249797" t="bbloom i get stuff like [0] multiple times, which i’d expect - but it suggests that the frequency of generator execution is unrelated to the size of the range of the generator"><y>#</y><d>2017-04-26</d><h>23:36</h><w>bbloom</w>i get stuff like [0] multiple times, which i’d expect - but it suggests that the frequency of generator execution is unrelated to the size of the range of the generator</z><z id="t1493249965" t="bbloom in order to have any confidence… i guess i’m going to need to understand this rose tree thing…."><y>#</y><d>2017-04-26</d><h>23:39</h><w>bbloom</w>in order to have any confidence… i guess i’m going to need to understand this rose tree thing….</z><z id="t1493250112" t="bbloom found this explanation: http://reiddraper.com/writing-simple-check/"><y>#</y><d>2017-04-26</d><h>23:41</h><w>bbloom</w>found this explanation: <a href="http://reiddraper.com/writing-simple-check/" target="_blank">http://reiddraper.com/writing-simple-check/</a></z><z id="t1493250262" t="gfredericks gen/generate can give you better control than sample for playing with sizing"><y>#</y><d>2017-04-26</d><h>23:44</h><w>gfredericks</w>gen/generate can give you better control than sample for playing with sizing</z><z id="t1493250373" t="bbloom ok, i think i understand the rose tree / shrinking now…."><y>#</y><d>2017-04-26</d><h>23:46</h><w>bbloom</w>ok, i think i understand the rose tree / shrinking now….</z><z id="t1493250410" t="bbloom Reid’s rationale suggests getting a shrinker “for free” from the generator, but i’m skeptical of that approach vs the two-method approach that apparently haskell uses"><y>#</y><d>2017-04-26</d><h>23:46</h><w>bbloom</w>Reid’s rationale suggests getting a shrinker “for free” from the generator, but i’m skeptical of that approach vs the two-method approach that apparently haskell uses</z><z id="t1493250566" t="gfredericks You&apos;re thinking a generator is an implementation of a protocol with one method for generating a value and another for shrinking it?"><y>#</y><d>2017-04-26</d><h>23:49</h><w>gfredericks</w>You&apos;re thinking a generator is an implementation of a protocol with one method for generating a value and another for shrinking it?</z><z id="t1493250589" t="bbloom i did think that, which is apparently true in QuickCheck according to Reid’s blog post"><y>#</y><d>2017-04-26</d><h>23:49</h><w>bbloom</w>i did think that, which is apparently true in QuickCheck according to Reid’s blog post</z><z id="t1493250626" t="gfredericks Consider how to implement fmap then"><y>#</y><d>2017-04-26</d><h>23:50</h><w>gfredericks</w>Consider how to implement fmap then</z><z id="t1493250655" t="gfredericks (gen/fmap str gen/nat), e.g."><y>#</y><d>2017-04-26</d><h>23:50</h><w>gfredericks</w>(gen/fmap str gen/nat), e.g.</z><z id="t1493250693" t="gfredericks How do you shrink &quot;42&quot; given a function that can shrink 42"><y>#</y><d>2017-04-26</d><h>23:51</h><w>gfredericks</w>How do you shrink &quot;42&quot; given a function that can shrink 42</z><z id="t1493250801" t="bbloom same way it does now? seems like it just divides by two in some complex round-about fashion"><y>#</y><d>2017-04-26</d><h>23:53</h><w>bbloom</w>same way it does now? seems like it just divides by two in some complex round-about fashion</z><z id="t1493250815" t="gfredericks It&apos;s a string, not a number"><y>#</y><d>2017-04-26</d><h>23:53</h><w>gfredericks</w>It&apos;s a string, not a number</z><z id="t1493250835" t="bbloom ah"><y>#</y><d>2017-04-26</d><h>23:53</h><w>bbloom</w>ah</z><z id="t1493250846" t="bbloom sorry, i misread"><y>#</y><d>2017-04-26</d><h>23:54</h><w>bbloom</w>sorry, i misread</z><z id="t1493250926" t="bbloom (defn fmap [f x] (reify IGenerator (gen [this ctx] (f (gen x ctx))) (shrink [this ctx value] (f (shrink x ctx))))"><y>#</y><d>2017-04-26</d><h>23:55</h><w>bbloom</w>(defn fmap [f x] (reify IGenerator (gen [this ctx] (f (gen x ctx))) (shrink [this ctx value] (f (shrink x ctx))))</z><z id="t1493250940" t="bbloom 😛"><y>#</y><d>2017-04-26</d><h>23:55</h><w>bbloom</w><b>😛</b></z><z id="t1493251020" t="bbloom er sub that second value with x"><y>#</y><d>2017-04-26</d><h>23:57</h><w>bbloom</w>er sub that second value with x</z><z id="t1493251025" t="bbloom or second x with value"><y>#</y><d>2017-04-26</d><h>23:57</h><w>bbloom</w>or second x with value</z><z id="t1493251028" t="bbloom you get the idea"><y>#</y><d>2017-04-26</d><h>23:57</h><w>bbloom</w>you get the idea</z><z id="t1493251040" t="bbloom but yeah, i get my intuition doesn’t match reality"><y>#</y><d>2017-04-26</d><h>23:57</h><w>bbloom</w>but yeah, i get my intuition doesn’t match reality</z><z id="t1493251092" t="bbloom but as far as i can tell, the public API of test.check doesn’t expose the rose tree stuff"><y>#</y><d>2017-04-26</d><h>23:58</h><w>bbloom</w>but as far as i can tell, the public API of test.check doesn’t expose the rose tree stuff</z><z id="t1493251102" t="bbloom all the constructors for generators assume you return a value, not a rose tree"><y>#</y><d>2017-04-26</d><h>23:58</h><w>bbloom</w>all the constructors for generators assume you return a value, not a rose tree</z><z id="t1493251145" t="bbloom which i guess that explains why stateful-check mucks around with internals a bit"><y>#</y><d>2017-04-26</d><h>23:59</h><w>bbloom</w>which i guess that explains why stateful-check mucks around with internals a bit</z><z id="t1493251245" t="gfredericks Yeah, test.check hopes that the public API is sufficient"><y>#</y><d>2017-04-27</d><h>00:00</h><w>gfredericks</w>Yeah, test.check hopes that the public API is sufficient</z><z id="t1493251276" t="gfredericks I assume you see the bug in your code? "><y>#</y><d>2017-04-27</d><h>00:01</h><w>gfredericks</w>I assume you see the bug in your code? </z><z id="t1493251318" t="gfredericks Or, why that function doesn&apos;t/ can&apos;t work"><y>#</y><d>2017-04-27</d><h>00:01</h><w>gfredericks</w>Or, why that function doesn&apos;t/ can&apos;t work</z><z id="t1493251361" t="bbloom other than my typo with the wrong variable? and the lack of the “AST interpreter” that would drive that protocol? no, not really"><y>#</y><d>2017-04-27</d><h>00:02</h><w>bbloom</w>other than my typo with the wrong variable? and the lack of the “AST interpreter” that would drive that protocol? no, not really</z><z id="t1493251368" t="bbloom at least i assume you have some insight i’m missing"><y>#</y><d>2017-04-27</d><h>00:02</h><w>bbloom</w>at least i assume you have some insight i’m missing</z><z id="t1493251411" t="gfredericks In the fmap str example, you&apos;ll be passing a string to a shrinker that expects integers"><y>#</y><d>2017-04-27</d><h>00:03</h><w>gfredericks</w>In the fmap str example, you&apos;ll be passing a string to a shrinker that expects integers</z><z id="t1493251449" t="gfredericks value is a string, (shrink x ...) wants an integer"><y>#</y><d>2017-04-27</d><h>00:04</h><w>gfredericks</w>value is a string,  (shrink x ...) wants an integer</z><z id="t1493251517" t="bbloom i was thinking the value would be whatever value was being wrapped"><y>#</y><d>2017-04-27</d><h>00:05</h><w>bbloom</w>i was thinking the value would be whatever value was being wrapped</z><z id="t1493251520" t="gfredericks Somebody somewhere will have to parse the string"><y>#</y><d>2017-04-27</d><h>00:05</h><w>gfredericks</w>Somebody somewhere will have to parse the string</z><z id="t1493251520" t="bbloom not the generated value"><y>#</y><d>2017-04-27</d><h>00:05</h><w>bbloom</w>not the generated value</z><z id="t1493251538" t="bbloom i you’d have a tree of alternating generate/shrink calls"><y>#</y><d>2017-04-27</d><h>00:05</h><w>bbloom</w>i you’d have a tree of alternating generate/shrink calls</z><z id="t1493251577" t="bbloom the idea was that fmap wouldn’t do any shrinking at all"><y>#</y><d>2017-04-27</d><h>00:06</h><w>bbloom</w>the idea was that fmap wouldn’t do any shrinking at all</z><z id="t1493251583" t="bbloom or at least no extra shrinking"><y>#</y><d>2017-04-27</d><h>00:06</h><w>bbloom</w>or at least no extra shrinking</z><z id="t1493251589" t="bbloom beyond what the wrapped generator does"><y>#</y><d>2017-04-27</d><h>00:06</h><w>bbloom</w>beyond what the wrapped generator does</z><z id="t1493251672" t="gfredericks That&apos;s ideal, I&apos;m just not sure how you wrap this up into the test runner in an arbitrarily composable way"><y>#</y><d>2017-04-27</d><h>00:07</h><w>gfredericks</w>That&apos;s ideal, I&apos;m just not sure how you wrap this up into the test runner in an arbitrarily composable way</z><z id="t1493251691" t="bbloom i’m not even convinced that it makes sense to combine generating and shrinking one-to-one like this"><y>#</y><d>2017-04-27</d><h>00:08</h><w>bbloom</w>i’m not even convinced that it makes sense to combine generating and shrinking one-to-one like this</z><z id="t1493251823" t="bbloom i just assumed that shrinking would be simpler than generating in that the tree would be a subset of the generator tree"><y>#</y><d>2017-04-27</d><h>00:10</h><w>bbloom</w>i just assumed that shrinking would be simpler than generating in that the tree would be a subset of the generator tree</z><z id="t1493251835" t="bbloom and only isomorphic to it if most of the nodes were the identity-shrinker"><y>#</y><d>2017-04-27</d><h>00:10</h><w>bbloom</w>and only isomorphic to it if most of the nodes were the identity-shrinker</z><z id="t1493251862" t="bbloom for example if you generate an arbitrary number and then filter the even ones, you only want one number shrinker, not two"><y>#</y><d>2017-04-27</d><h>00:11</h><w>bbloom</w>for example if you generate an arbitrary number and then filter the even ones, you only want one number shrinker, not two</z><z id="t1493251891" t="bbloom similarly, for the stateful testing case with shrinking, you almost only want to remove actions, not actually alter the contents of any of those actions"><y>#</y><d>2017-04-27</d><h>00:11</h><w>bbloom</w>similarly, for the stateful testing case with shrinking, you almost only want to remove actions, not actually alter the contents of any of those actions</z><z id="t1493251982" t="bbloom way beyond just generative testing, i’m not a fan of monadic apis in general…. i’d much rather build a generator out of transparent data and then interpret (or compile) that - especially so that i could add more methods beyond just generate/shrink…."><y>#</y><d>2017-04-27</d><h>00:13</h><w>bbloom</w>way beyond just generative testing, i’m not a fan of monadic apis in general…. i’d much rather build a generator out of transparent data and then interpret (or compile) that - especially so that i could add more methods beyond just generate/shrink….</z><z id="t1493252060" t="bbloom but this is way off topic, my apologies"><y>#</y><d>2017-04-27</d><h>00:14</h><w>bbloom</w>but this is way off topic, my apologies</z><z id="t1493252638" t="gfredericks I&apos;m not even sure what sort of tree you&apos;re imagining"><y>#</y><d>2017-04-27</d><h>00:23</h><w>gfredericks</w>I&apos;m not even sure what sort of tree you&apos;re imagining</z><z id="t1493252684" t="bbloom the tree of generators that is returning a pure value (that is, of course, tree shaped)"><y>#</y><d>2017-04-27</d><h>00:24</h><w>bbloom</w>the tree of generators that is returning a pure value (that is, of course, tree shaped)</z><z id="t1493252720" t="gfredericks The shape of generator composition doesn&apos;t necessarily mirror the shape of the data"><y>#</y><d>2017-04-27</d><h>00:25</h><w>gfredericks</w>The shape of generator composition doesn&apos;t necessarily mirror the shape of the data</z><z id="t1493252762" t="bbloom sure, it’s not 1-to-1, but it has some similarity in general, no?"><y>#</y><d>2017-04-27</d><h>00:26</h><w>bbloom</w>sure, it’s not 1-to-1, but it has some similarity in general, no?</z><z id="t1493252776" t="gfredericks I&apos;ve thought about generators-as-data, but seems hard to do bind"><y>#</y><d>2017-04-27</d><h>00:26</h><w>gfredericks</w>I&apos;ve thought about generators-as-data, but seems hard to do bind</z><z id="t1493252790" t="bbloom bind (well, lexical scope in general) is always the hard part"><y>#</y><d>2017-04-27</d><h>00:26</h><w>bbloom</w>bind (well, lexical scope in general) is always the hard part</z><z id="t1493252849" t="gfredericks So test.check has an approach where bind at least works 😛 "><y>#</y><d>2017-04-27</d><h>00:27</h><w>gfredericks</w>So test.check has an approach where bind at least works <b>😛</b> </z><z id="t1493252948" t="gfredericks So you&apos;re imagining that the user-facing API for your generators is the protocol of two functions? If so I&apos;m still not seeing how you get around the fmap problem"><y>#</y><d>2017-04-27</d><h>00:29</h><w>gfredericks</w>So you&apos;re imagining that the user-facing API for your generators is the protocol of two functions? If so I&apos;m still not seeing how you get around the fmap problem</z><z id="t1493252975" t="bbloom i’m not trying to propose a new solution"><y>#</y><d>2017-04-27</d><h>00:29</h><w>bbloom</w>i’m not trying to propose a new solution</z><z id="t1493252988" t="bbloom i’m saying that it didn’t match my intuition - which has now been corrected"><y>#</y><d>2017-04-27</d><h>00:29</h><w>bbloom</w>i’m saying that it didn’t match my intuition - which has now been corrected</z><z id="t1493253008" t="bbloom but the larger problem i have is that, even understanding how it works, i’m not sure how to make effective use of it"><y>#</y><d>2017-04-27</d><h>00:30</h><w>bbloom</w>but the larger problem i have is that, even understanding how it works, i’m not sure how to make effective use of it</z><z id="t1493253020" t="bbloom let’s take the stack example again"><y>#</y><d>2017-04-27</d><h>00:30</h><w>bbloom</w>let’s take the stack example again</z><z id="t1493253061" t="bbloom if i have random push/pop operations and it’s going to do shrinking, it’s going to waste a bunch of time pushing or popping smaller integers, when really i want to try fewer pops or fewer pushes"><y>#</y><d>2017-04-27</d><h>00:31</h><w>bbloom</w>if i have random push/pop operations and it’s going to do shrinking, it’s going to waste a bunch of time pushing or popping smaller integers, when really i want to try fewer pops or fewer pushes</z><z id="t1493253062" t="bbloom right?"><y>#</y><d>2017-04-27</d><h>00:31</h><w>bbloom</w>right?</z><z id="t1493253092" t="gfredericks Somewhat"><y>#</y><d>2017-04-27</d><h>00:31</h><w>gfredericks</w>Somewhat</z><z id="t1493253104" t="gfredericks It will shrink each integer straight to 0"><y>#</y><d>2017-04-27</d><h>00:31</h><w>gfredericks</w>It will shrink each integer straight to 0</z><z id="t1493253109" t="gfredericks In one step"><y>#</y><d>2017-04-27</d><h>00:31</h><w>gfredericks</w>In one step</z><z id="t1493253125" t="gfredericks Only if that doesn&apos;t work does it try other things"><y>#</y><d>2017-04-27</d><h>00:32</h><w>gfredericks</w>Only if that doesn&apos;t work does it try other things</z><z id="t1493253134" t="gfredericks So N steps total to accomplish that"><y>#</y><d>2017-04-27</d><h>00:32</h><w>gfredericks</w>So N steps total to accomplish that</z><z id="t1493253148" t="gfredericks But it could also try removing things first, I&apos;m not sure"><y>#</y><d>2017-04-27</d><h>00:32</h><w>gfredericks</w>But it could also try removing things first, I&apos;m not sure</z><z id="t1493253186" t="gfredericks That depends on which step bind tries first "><y>#</y><d>2017-04-27</d><h>00:33</h><w>gfredericks</w>That depends on which step bind tries first </z><z id="t1493253264" t="gfredericks One downside to this structure is you can&apos;t give shrink hints"><y>#</y><d>2017-04-27</d><h>00:34</h><w>gfredericks</w>One downside to this structure is you can&apos;t give shrink hints</z><z id="t1493253308" t="gfredericks I think shrinking efficiency is only an issue when generating really large compositions"><y>#</y><d>2017-04-27</d><h>00:35</h><w>gfredericks</w>I think shrinking efficiency is only an issue when generating really large compositions</z><z id="t1493253405" t="gfredericks I suppose I shouldn&apos;t say there&apos;s no way to give hints; for your example, if it was a problem, you could wrap the integer generator in gen/no-shrink"><y>#</y><d>2017-04-27</d><h>00:36</h><w>gfredericks</w>I suppose I shouldn&apos;t say there&apos;s no way to give hints; for your example, if it was a problem, you could wrap the integer generator in <code>gen/no-shrink</code></z><z id="t1493253455" t="gfredericks test.check does this itself for the builtin UUID generator, on the assumption that there&apos;s not much to be gained from shrinking a UUID"><y>#</y><d>2017-04-27</d><h>00:37</h><w>gfredericks</w>test.check does this itself for the builtin UUID generator, on the assumption that there&apos;s not much to be gained from shrinking a UUID</z><z id="t1493253541" t="gfredericks w.r.t. the earlier question on large-integer boundary testing, that&apos;s a more general issue I&apos;m aware of but haven&apos;t been sure how clever it should try to be"><y>#</y><d>2017-04-27</d><h>00:39</h><w>gfredericks</w>w.r.t. the earlier question on large-integer boundary testing, that&apos;s a more general issue I&apos;m aware of but haven&apos;t been sure how clever it should try to be</z><z id="t1493253616" t="gfredericks I&apos;ve considered rebooting the generators namespace to clean up the API; maybe there could be a partition into lower-level generators and higher-level clever ones"><y>#</y><d>2017-04-27</d><h>00:40</h><w>gfredericks</w>I&apos;ve considered rebooting the generators namespace to clean up the API; maybe there could be a partition into lower-level generators and higher-level clever ones</z><z id="t1493253649" t="gfredericks the low level ones do simple easy to understand things, the high level ones do lots of ad-hoc stuff to try to break your code"><y>#</y><d>2017-04-27</d><h>00:40</h><w>gfredericks</w>the low level ones do simple easy to understand things, the high level ones do lots of ad-hoc stuff to try to break your code</z><z id="t1493253656" t="gfredericks ¯\(ツ)/¯"><y>#</y><d>2017-04-27</d><h>00:40</h><w>gfredericks</w>¯\(ツ)/¯</z><z id="t1493253952" t="bbloom interesting"><y>#</y><d>2017-04-27</d><h>00:45</h><w>bbloom</w>interesting</z><z id="t1493253959" t="bbloom i’m gonna have a think on all this"><y>#</y><d>2017-04-27</d><h>00:45</h><w>bbloom</w>i’m gonna have a think on all this</z><z id="t1493253979" t="bbloom thanks again"><y>#</y><d>2017-04-27</d><h>00:46</h><w>bbloom</w>thanks again</z><z id="t1493258665" t="nberger Hey guys, great discussion here. I think the announcement of hedgehog, a new quickcheck-like library for haskell is very relevant: https://www.reddit.com/r/haskell/comments/646k3d/ann_hedgehog_property_testing/ . One of its selling points is that it &quot;uses integrated shrinking, so shrinks obey the invariants of generated values by construction [...] an approach to property testing which is also used by QuiviQ&apos;s Erlang QuickCheck, Hypothesis, and test.check&quot;"><y>#</y><d>2017-04-27</d><h>02:04</h><w>nberger</w>Hey guys, great discussion here.
I think the announcement of hedgehog, a new quickcheck-like library for haskell is very relevant: <a href="https://www.reddit.com/r/haskell/comments/646k3d/ann_hedgehog_property_testing/" target="_blank">https://www.reddit.com/r/haskell/comments/646k3d/ann_hedgehog_property_testing/</a>. One of its selling points is that it &quot;uses integrated shrinking, so shrinks obey the invariants of generated values by construction [...] an approach to property testing which is also used by QuiviQ&apos;s Erlang QuickCheck, Hypothesis, and test.check&quot;</z><z id="t1493258838" t="gfredericks Oh nice - I forgot about that"><y>#</y><d>2017-04-27</d><h>02:07</h><w>gfredericks</w>Oh nice - I forgot about that</z><z id="t1493259027" t="nberger I see references to a shrink tree in the code. But can&apos;t say much more 🙂"><y>#</y><d>2017-04-27</d><h>02:10</h><w>nberger</w>I see references to a shrink tree in the code. But can&apos;t say much more <b>🙂</b></z><z id="t1493259780" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : btw I made some progress on the async quick-check. I pushed a draft to my repo today: https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async . I&apos;m working on a defspec-async macro now that would use that stuff and would make the tests much easier to write (for example it &quot;knows&quot; when to call the done from cljs.test/async, which is on :succeeded or :shrunk) so the :step-fn that I&apos;m using in the tests would be gone"><y>#</y><d>2017-04-27</d><h>02:23</h><w>nberger</w><a>@gfredericks</a>: btw I made some progress on the async quick-check. I pushed a draft to my repo today: <a href="https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async" target="_blank">https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async</a>. I&apos;m working on a <code>defspec-async</code> macro now that would use that stuff and would make the tests much easier to write (for example it &quot;knows&quot; when to call the <code>done</code> from cljs.test/async, which is on :succeeded or :shrunk) so the :step-fn that I&apos;m using in the tests would be gone</z><z id="t1493260315" t="gfredericks [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] someone made a ticket asking for that"><y>#</y><d>2017-04-27</d><h>02:31</h><w>gfredericks</w><a>@nberger</a> someone made a ticket asking for that</z><z id="t1493260449" t="nberger yep, saw it. I&apos;ve been thinking about this for a long time, the ticket made me go to the keyboard and try to make it work, and I&apos;m quite happy with the result so far"><y>#</y><d>2017-04-27</d><h>02:34</h><w>nberger</w>yep, saw it. I&apos;ve been thinking about this for a long time, the ticket made me go to the keyboard and try to make it work, and I&apos;m quite happy with the result so far</z><z id="t1493260487" t="nberger I&apos;m hoping to have a more rounded version soon"><y>#</y><d>2017-04-27</d><h>02:34</h><w>nberger</w>I&apos;m hoping to have a more rounded version soon</z><z id="t1493260497" t="gfredericks cool, let me know and I&apos;ll take a look"><y>#</y><d>2017-04-27</d><h>02:34</h><w>gfredericks</w>cool, let me know and I&apos;ll take a look</z><z id="t1493260503" t="nberger will do"><y>#</y><d>2017-04-27</d><h>02:35</h><w>nberger</w>will do</z><z id="t1493407445" t="nberger [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] : I added a defspec-async macro in that branch, it would be great if you could take a look and tell me how it looks to you. This async stuff is done over the refactoring that I started a while ago, so here&apos;s the diff based on that refactoring: https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async And here&apos;s the refactor itself: https://github.com/clojure/test.check/compare/master...nberger:test.check.refactor (it&apos;s the same diff as in the current TCHECK-126 patch)"><y>#</y><d>2017-04-28</d><h>19:24</h><w>nberger</w><a>@gfredericks</a>: I added a <code>defspec-async</code> macro in that branch, it would be great if you could take a look and tell me how it looks to you. This async stuff is done over the refactoring that I started a while ago, so here&apos;s the diff based on that refactoring: <a href="https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async" target="_blank">https://github.com/nberger/test.check/compare/test.check.refactor...refactor-allow-async</a>
And here&apos;s the refactor itself: <a href="https://github.com/clojure/test.check/compare/master...nberger:test.check.refactor" target="_blank">https://github.com/clojure/test.check/compare/master...nberger:test.check.refactor</a> (it&apos;s the same diff as in the current TCHECK-126 patch)</z><z id="t1493407658" t="nberger There&apos;s some level of duplication between quick-check /`async-quick-check` and also shrink /`async-shrink` but maybe it&apos;s better this way (than refactoring it further so they share some parts but it could end being less readable)"><y>#</y><d>2017-04-28</d><h>19:27</h><w>nberger</w>There&apos;s some level of duplication between <code>quick-check</code>/`async-quick-check` and also <code>shrink</code>/`async-shrink` but maybe it&apos;s better this way (than refactoring it further so they share some parts but it could end being less readable)</z><z id="t1493409403" t="gfredericks okay, I&apos;ll take a look in the next few days; thanks!"><y>#</y><d>2017-04-28</d><h>19:56</h><w>gfredericks</w>okay, I&apos;ll take a look in the next few days; thanks!</z><z id="t1493410981" t="nberger Thanks to you!"><y>#</y><d>2017-04-28</d><h>20:23</h><w>nberger</w>Thanks to you!</z><z id="t1494334832" t="gfredericks wow; this 10,000 message limit gets hit pretty fast"><y>#</y><d>2017-05-09</d><h>13:00</h><w>gfredericks</w>wow; this 10,000 message limit gets hit pretty fast</z><z id="t1494336099" t="gfredericks Oh my mobile client still has old messages in this channel, but the web client doesn&apos;t. Slack is strange. "><y>#</y><d>2017-05-09</d><h>13:21</h><w>gfredericks</w>Oh my mobile client still has old messages in this channel, but the web client doesn&apos;t. Slack is strange. </z><z id="t1495559561" t="Alex Miller (Clojure team) [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] hey, I have a probably too broad question re test.check generators. There are a number of circumstances where random inputs can get “too big” (usually via either collection sizing or nesting) if you do enough tests. Surely this is an issue that quickcheck has already encountered - do they have generic ways to do thinning or something else? (I will do some of my own research but figured you might already know about it)"><y>#</y><d>2017-05-23</d><h>17:12</h><w>Alex Miller (Clojure team)</w><a>@gfredericks</a> hey, I have a probably too broad question re test.check generators. There are a number of circumstances where random inputs can get “too big” (usually via either collection sizing or nesting) if you do enough tests. Surely this is an issue that quickcheck has already encountered - do they have generic ways to do thinning or something else? (I will do some of my own research but figured you might already know about it)</z><z id="t1495562203" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] you&apos;re asking about something more sophisticated than the normal size control techniques?"><y>#</y><d>2017-05-23</d><h>17:56</h><w>gfredericks</w><a>@alexmiller</a> you&apos;re asking about something more sophisticated than the normal <code>size</code> control techniques?</z><z id="t1495562327" t="Alex Miller (Clojure team) well… kind of. this is really about controlling size at a higher level, which as I’ve been thinking about it more is really connected to controlling generation over a greater composite structure (which is the thing we’re producing out of a composite spec)"><y>#</y><d>2017-05-23</d><h>17:58</h><w>Alex Miller (Clojure team)</w>well… kind of. this is really about controlling size at a higher level, which as I’ve been thinking about it more is really connected to controlling generation over a greater composite structure (which is the thing we’re producing out of a composite spec)</z><z id="t1495562354" t="Alex Miller (Clojure team) I went and looked at some of the quickcheck stuff more and it seems like there are all those knobs for size, scale, etc"><y>#</y><d>2017-05-23</d><h>17:59</h><w>Alex Miller (Clojure team)</w>I went and looked at some of the quickcheck stuff more and it seems like there are all those knobs for size, scale, etc</z><z id="t1495562361" t="Alex Miller (Clojure team) but they assume pretty localized and intentional use"><y>#</y><d>2017-05-23</d><h>17:59</h><w>Alex Miller (Clojure team)</w>but they assume pretty localized and intentional use</z><z id="t1495562445" t="Alex Miller (Clojure team) my real goal here is: how can we assure that an automatically created composite generator does not produce a value so big that it kills testing. and maybe the answer is really being smarter in spec about how we use test.check"><y>#</y><d>2017-05-23</d><h>18:00</h><w>Alex Miller (Clojure team)</w>my real goal here is: how can we assure that an automatically created composite generator does not produce a value so big that it kills testing. and maybe the answer is really being smarter in spec about how we use test.check</z><z id="t1495562516" t="Alex Miller (Clojure team) some more specific problem areas are: collection size, recursive/nesting size, and individual value size (for things that use variable memory like strings, keywords, symbols)"><y>#</y><d>2017-05-23</d><h>18:01</h><w>Alex Miller (Clojure team)</w>some more specific problem areas are: collection size, recursive/nesting size, and individual value size (for things that use variable memory like strings, keywords, symbols)</z><z id="t1495562552" t="Alex Miller (Clojure team) really these are mostly easy to manage in isolation but are in some cases harder in combination"><y>#</y><d>2017-05-23</d><h>18:02</h><w>Alex Miller (Clojure team)</w>really these are mostly easy to manage in isolation but are in some cases harder in combination</z><z id="t1495562583" t="Alex Miller (Clojure team) sorry, stepping away for a few"><y>#</y><d>2017-05-23</d><h>18:03</h><w>Alex Miller (Clojure team)</w>sorry, stepping away for a few</z><z id="t1495562707" t="gfredericks Yes definitely; sizing is one of the biggest headaches I&apos;ve encountered in maintaining test.check -- I&apos;ve kept wanting to redo the size parameter so that it has some kind of linear relationship to the (comp count pr-str) of the value generated"><y>#</y><d>2017-05-23</d><h>18:05</h><w>gfredericks</w>Yes definitely; sizing is one of the biggest headaches I&apos;ve encountered in maintaining test.check -- I&apos;ve kept wanting to redo the size parameter so that it has some kind of linear relationship to the (comp count pr-str) of the value generated</z><z id="t1495562929" t="gfredericks I thought about maybe having each generator have knowledge about the size of things it generates, but that doesn&apos;t work so well for gen/one-of or gen/frequency , and not at all for gen/bind"><y>#</y><d>2017-05-23</d><h>18:08</h><w>gfredericks</w>I thought about maybe having each generator have knowledge about the size of things it generates, but that doesn&apos;t work so well for <code>gen/one-of</code> or <code>gen/frequency</code>, and not at all for <code>gen/bind</code></z><z id="t1495562933" t="gfredericks even gen/fmap would be hard"><y>#</y><d>2017-05-23</d><h>18:08</h><w>gfredericks</w>even <code>gen/fmap</code> would be hard</z><z id="t1495562977" t="gfredericks so I think the only other approach to a general solution would be to have some sort of logical post-processing that prunes things when the whole structure is too big"><y>#</y><d>2017-05-23</d><h>18:09</h><w>gfredericks</w>so I think the only other approach to a general solution would be to have some sort of logical post-processing that prunes things when the whole structure is too big</z><z id="t1495562981" t="gfredericks I haven&apos;t thought about that one too much"><y>#</y><d>2017-05-23</d><h>18:09</h><w>gfredericks</w>I haven&apos;t thought about that one too much</z><z id="t1495563051" t="gfredericks My guess is that this is the biggest sizing pitfall for spec: https://dev.clojure.org/jira/browse/TCHECK-106"><y>#</y><d>2017-05-23</d><h>18:10</h><w>gfredericks</w>My guess is that this is the biggest sizing pitfall for spec: <a href="https://dev.clojure.org/jira/browse/TCHECK-106" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-106</a></z><z id="t1495563115" t="gfredericks it&apos;s possible that solving that would be enough from spec&apos;s perspective"><y>#</y><d>2017-05-23</d><h>18:11</h><w>gfredericks</w>it&apos;s possible that solving that would be enough from spec&apos;s perspective</z><z id="t1495567340" t="Alex Miller (Clojure team) yes, I think that is the highest priority issue"><y>#</y><d>2017-05-23</d><h>19:22</h><w>Alex Miller (Clojure team)</w>yes, I think that is the highest priority issue</z><z id="t1495567378" t="Alex Miller (Clojure team) Rich suggested that maybe there was some notion of “thinning” that could be applied as you generate - reducing the scale as you get deeper in a structure"><y>#</y><d>2017-05-23</d><h>19:22</h><w>Alex Miller (Clojure team)</w>Rich suggested that maybe there was some notion of “thinning” that could be applied as you generate - reducing the scale as you get deeper in a structure</z><z id="t1495567512" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] yeah, that&apos;s something that the recursive-gen already does (else it&apos;d likely generate infinite structures)"><y>#</y><d>2017-05-23</d><h>19:25</h><w>gfredericks</w><a>@alexmiller</a> yeah, that&apos;s something that the <code>recursive-gen</code> already does (else it&apos;d likely generate infinite structures)</z><z id="t1495567577" t="gfredericks I certainly considered it -- it had the feel of a breaking change, so I was probably hesitant on that count, but there might have been some more subtleties; I&apos;ll give that some more thought and try it out"><y>#</y><d>2017-05-23</d><h>19:26</h><w>gfredericks</w>I certainly considered it -- it had the feel of a breaking change, so I was probably hesitant on that count, but there might have been some more subtleties;

I&apos;ll give that some more thought and try it out</z><z id="t1495567622" t="gfredericks one approach I tried with recursive-gen was to take the current size and partition it up randomly among the elements of the collection to be generated"><y>#</y><d>2017-05-23</d><h>19:27</h><w>gfredericks</w>one approach I tried with <code>recursive-gen</code> was to take the current <code>size</code> and partition it up randomly among the elements of the collection to be generated</z><z id="t1495567634" t="gfredericks I think that&apos;s a lot harder with recursive-gen than it would be with the regular collection generators"><y>#</y><d>2017-05-23</d><h>19:27</h><w>gfredericks</w>I think that&apos;s a lot harder with <code>recursive-gen</code> than it would be with the regular collection generators</z><z id="t1495567640" t="gfredericks so maybe there is hope"><y>#</y><d>2017-05-23</d><h>19:27</h><w>gfredericks</w>so maybe there is hope</z><z id="t1495567723" t="Alex Miller (Clojure team) yeah, I saw some interesting stuff in the quickcheck papers about the recursive gen aspects"><y>#</y><d>2017-05-23</d><h>19:28</h><w>Alex Miller (Clojure team)</w>yeah, I saw some interesting stuff in the quickcheck papers about the recursive gen aspects</z><z id="t1495567747" t="Alex Miller (Clojure team) and spec is doing some of its own things there as well"><y>#</y><d>2017-05-23</d><h>19:29</h><w>Alex Miller (Clojure team)</w>and spec is doing some of its own things there as well</z><z id="t1495567773" t="gfredericks yeah I noticed that and wasn&apos;t sure what I thought about it"><y>#</y><d>2017-05-23</d><h>19:29</h><w>gfredericks</w>yeah I noticed that and wasn&apos;t sure what I thought about it</z><z id="t1495567841" t="Alex Miller (Clojure team) heh"><y>#</y><d>2017-05-23</d><h>19:30</h><w>Alex Miller (Clojure team)</w>heh</z><z id="t1495567844" t="gfredericks I&apos;m not sure that there are any serious backwards-compatibility concerns about changing the sizing behavior, so I&apos;ll consider this a plausible solution"><y>#</y><d>2017-05-23</d><h>19:30</h><w>gfredericks</w>I&apos;m not sure that there are any serious backwards-compatibility concerns about changing the sizing behavior, so I&apos;ll consider this a plausible solution</z><z id="t1495567859" t="gfredericks do you have a guess about whether there will be other serious sizing issues remaining?"><y>#</y><d>2017-05-23</d><h>19:30</h><w>gfredericks</w>do you have a guess about whether there will be other serious sizing issues remaining?</z><z id="t1495567883" t="Alex Miller (Clojure team) collection size and recursion seem to be at the root of the majority of issues I see"><y>#</y><d>2017-05-23</d><h>19:31</h><w>Alex Miller (Clojure team)</w>collection size and recursion seem to be at the root of the majority of issues I see</z><z id="t1495567904" t="gfredericks does spec use recursive-gen at all?"><y>#</y><d>2017-05-23</d><h>19:31</h><w>gfredericks</w>does spec use <code>recursive-gen</code> at all?</z><z id="t1495567915" t="Alex Miller (Clojure team) don’t know"><y>#</y><d>2017-05-23</d><h>19:31</h><w>Alex Miller (Clojure team)</w>don’t know</z><z id="t1495567923" t="gfredericks I think the biggest thing I noticed was that it didn&apos;t even with naturally recursive specs"><y>#</y><d>2017-05-23</d><h>19:32</h><w>gfredericks</w>I think the biggest thing I noticed was that it didn&apos;t even with naturally recursive specs</z><z id="t1495567963" t="Alex Miller (Clojure team) yeah, the gen namespace doesn’t pull in recursive-gen so I’d guess nothing is using it"><y>#</y><d>2017-05-23</d><h>19:32</h><w>Alex Miller (Clojure team)</w>yeah, the gen namespace doesn’t pull in recursive-gen so I’d guess nothing is using it</z><z id="t1495567976" t="gfredericks it might not be a good fit anyhow"><y>#</y><d>2017-05-23</d><h>19:32</h><w>gfredericks</w>it might not be a good fit anyhow</z><z id="t1495567994" t="Alex Miller (Clojure team) I don’t know if that was a conscious choice or not (although with Rich I typically bet on the side of conscious choice)"><y>#</y><d>2017-05-23</d><h>19:33</h><w>Alex Miller (Clojure team)</w>I don’t know if that was a conscious choice or not (although with Rich I typically bet on the side of conscious choice)</z><z id="t1495568023" t="Alex Miller (Clojure team) stepping away again, maybe for a while, sorry :)"><y>#</y><d>2017-05-23</d><h>19:33</h><w>Alex Miller (Clojure team)</w>stepping away again, maybe for a while, sorry :)</z><z id="t1495568034" t="gfredericks no problem"><y>#</y><d>2017-05-23</d><h>19:33</h><w>gfredericks</w>no problem</z><z id="t1495786142" t="andrea.crotti I was trying to write a generator for a matrix of random elements, but with rows of equal length"><y>#</y><d>2017-05-26</d><h>08:09</h><w>andrea.crotti</w>I was trying to write a generator for a matrix of random elements, but with rows of equal length</z><z id="t1495786149" t="andrea.crotti so this actually works (defn gen-image [nrows ncols] (gen/vector (gen/vector (gen/elements core/COLOURS) ncols) nrows)) "><y>#</y><d>2017-05-26</d><h>08:09</h><w>andrea.crotti</w>so this actually works
<pre>(defn gen-image
  [nrows ncols]
  (gen/vector (gen/vector
               (gen/elements core/COLOURS)
               ncols)
              nrows))

</pre></z><z id="t1495786206" t="andrea.crotti however now gen-image is a function, and also doing this is not possible (prop/for-all [nrows gen/pos-int ncols gen/pos-int mat (gen-image nrows ncols)]) "><y>#</y><d>2017-05-26</d><h>08:10</h><w>andrea.crotti</w>however now gen-image is a function, and also doing this is not possible
<pre>(prop/for-all
 [nrows gen/pos-int
  ncols gen/pos-int
  mat (gen-image nrows ncols)])
</pre></z><z id="t1495786216" t="andrea.crotti because nrows and ncols are not defined at that point"><y>#</y><d>2017-05-26</d><h>08:10</h><w>andrea.crotti</w>because nrows and ncols are not defined at that point</z><z id="t1495786236" t="andrea.crotti I also try to nest prop/for-all but while that doesn&apos;t fail it doesn&apos;t really seem to do anything useful"><y>#</y><d>2017-05-26</d><h>08:10</h><w>andrea.crotti</w>I also try to nest prop/for-all but while that doesn&apos;t fail it doesn&apos;t really seem to do anything useful</z><z id="t1495786245" t="andrea.crotti any suggestion?"><y>#</y><d>2017-05-26</d><h>08:10</h><w>andrea.crotti</w>any suggestion?</z><z id="t1495799485" t="andrea.crotti [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] brilliant thanks"><y>#</y><d>2017-05-26</d><h>11:51</h><w>andrea.crotti</w><a>@gfredericks</a> brilliant thanks</z><z id="t1495824522" t="nwjsmith err, wasn&apos;t there a guide for using recursive-gen somewhere?"><y>#</y><d>2017-05-26</d><h>18:48</h><w>nwjsmith</w>err, wasn&apos;t there a guide for using <code>recursive-gen</code> somewhere?</z><z id="t1495824781" t="nwjsmith Found it! https://github.com/clojure/test.check/blob/master/doc/intro.md#recursive-generators"><y>#</y><d>2017-05-26</d><h>18:53</h><w>nwjsmith</w>Found it! <a href="https://github.com/clojure/test.check/blob/master/doc/intro.md#recursive-generators" target="_blank">https://github.com/clojure/test.check/blob/master/doc/intro.md#recursive-generators</a></z><z id="t1495828148" t="nwjsmith Hrm. So I&apos;m a bit stuck trying to write a generator for a directed acyclic graph. This is what I would like to do: ;; generate a list of nodes ;; for each node x in the list ;; generate a none-empty subset of nodes to the right of x in the list ;; for each node in the subset ;; create an edge from x to the node "><y>#</y><d>2017-05-26</d><h>19:49</h><w>nwjsmith</w>Hrm. So I&apos;m a bit stuck trying to write a generator for a directed acyclic graph. This is what I would like to do:
<pre>;; generate a list of nodes
;; for each node x in the list
;;   generate a none-empty subset of nodes to the right of x in the list 
;;   for each node in the subset
;;     create an edge from x to the node
</pre></z><z id="t1495829865" t="nwjsmith (gen/bind (gen/list-distinct gen-node {:min-elements 2}) (fn [[node &amp; possible-joins]] (gen/fmap (fn [adjacent-nodes] (map (partial join-nodes node) adjacent-nodes)) (gen/set (gen/elements possible-joins))))) "><y>#</y><d>2017-05-26</d><h>20:17</h><w>nwjsmith</w><pre>(gen/bind (gen/list-distinct gen-node {:min-elements 2})
           (fn [[node &amp; possible-joins]]
             (gen/fmap (fn [adjacent-nodes]
                         (map (partial join-nodes node) adjacent-nodes))
                       (gen/set (gen/elements possible-joins)))))
</pre></z><z id="t1495829957" t="nwjsmith that&apos;s what I have so far. Generate some nodes, take the first one, generate a subset from the rest, and create edges between the node and each node in the subset"><y>#</y><d>2017-05-26</d><h>20:19</h><w>nwjsmith</w>that&apos;s what I have so far. Generate some nodes, take the first one, generate a subset from the rest, and create edges between the node and each node in the subset</z><z id="t1495829986" t="nwjsmith I&apos;m having trouble figuring out how to recur on the &quot;next&quot; node"><y>#</y><d>2017-05-26</d><h>20:19</h><w>nwjsmith</w>I&apos;m having trouble figuring out how to recur on the &quot;next&quot; node</z><z id="t1495830319" t="gfredericks you could make that work, but something simpler might be to just generate all the edges at once"><y>#</y><d>2017-05-26</d><h>20:25</h><w>gfredericks</w>you could make that work, but something simpler might be to just generate all the edges at once</z><z id="t1495830383" t="gfredericks (gen/let [nodes (gen/vector-distinct gen-node {:min-elements 2}), edges (gen/vector-distinct (gen/vector-distinct (gen/elements nodes) {:num-elements 2}))] ... figure which direction the edges go based on the ordering of nodes...)"><y>#</y><d>2017-05-26</d><h>20:26</h><w>gfredericks</w><code>(gen/let [nodes (gen/vector-distinct gen-node {:min-elements 2}), edges (gen/vector-distinct (gen/vector-distinct (gen/elements nodes) {:num-elements 2}))] ... figure which direction the edges go based on the ordering of nodes...)</code></z><z id="t1495830440" t="gfredericks pardon my lack of line breaks"><y>#</y><d>2017-05-26</d><h>20:27</h><w>gfredericks</w>pardon my lack of line breaks</z><z id="t1495830581" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] ⇑"><y>#</y><d>2017-05-26</d><h>20:29</h><w>gfredericks</w><a>@nwjsmith</a> ⇑</z><z id="t1496493223" t="alex.ter.weele [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] : I’m working on a similar problem. My approach (which doesn’t work yet) will be something like this: Perform a random number of “rounds” On each round, generate an arbitrary number of new nodes, then draw arbitrary edges from the already-existing nodes to new nodes. Recur on the union of new nodes and existing nodes (i.e. add the new nodes to the already existing nodes)"><y>#</y><d>2017-06-03</d><h>12:33</h><w>alex.ter.weele</w><a>@nwjsmith</a>: I’m working on a similar problem. My approach (which doesn’t work yet) will be something like this:
Perform a random number of “rounds”
On each round, generate an arbitrary number of new nodes, then draw arbitrary edges from the already-existing nodes to new nodes.
Recur on the union of new nodes and existing nodes (i.e. add the new nodes to the already existing nodes)</z><z id="t1496502827" t="nwjsmith [:attrs {:href &quot;/_/_/users/U36FNSJUC&quot;}] I managed to figure out how to generate the DAG in the way I described: https://gist.github.com/nwjsmith/0f4288db2f7c0be8b06e5237d6175b3d"><y>#</y><d>2017-06-03</d><h>15:13</h><w>nwjsmith</w><a>@alex.ter.weele</a> I managed to figure out how to generate the DAG in the way I described: <a href="https://gist.github.com/nwjsmith/0f4288db2f7c0be8b06e5237d6175b3d" target="_blank">https://gist.github.com/nwjsmith/0f4288db2f7c0be8b06e5237d6175b3d</a></z><z id="t1496502928" t="nwjsmith The magic happens in gen-acyclic-edges , where we build up a list of generators of connecting edges, and call gen/tuple on it once we&apos;re finished"><y>#</y><d>2017-06-03</d><h>15:15</h><w>nwjsmith</w>The magic happens in <code>gen-acyclic-edges</code>, where we build up a list of generators of connecting edges, and call <code>gen/tuple</code> on it once we&apos;re finished</z><z id="t1496503650" t="alex.ter.weele OK, I get it! It took me a second to realize why gen-acyclic-edges will never create cycles--because edges only go forward in the list."><y>#</y><d>2017-06-03</d><h>15:27</h><w>alex.ter.weele</w>OK, I get it! It took me a second to realize why <code>gen-acyclic-edges</code> will never create cycles--because edges only go forward in the list.</z><z id="t1497232098" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] I&apos;ll start poking around with a collection sizing overhaul this week"><y>#</y><d>2017-06-12</d><h>01:48</h><w>gfredericks</w><a>@alexmiller</a> I&apos;ll start poking around with a collection sizing overhaul this week</z><z id="t1497622196" t="carocad hey guys, where could I submit a bug report of the test.check library?"><y>#</y><d>2017-06-16</d><h>14:09</h><w>carocad</w>hey guys, where could I submit a bug report of the test.check library?</z><z id="t1497622368" t="gfredericks [:attrs {:href &quot;/_/_/users/U0LJU20SJ&quot;}] http://dev.clojure.org/jira"><y>#</y><d>2017-06-16</d><h>14:12</h><w>gfredericks</w><a>@carocad</a> <a href="http://dev.clojure.org/jira" target="_blank">http://dev.clojure.org/jira</a></z><z id="t1497623726" t="carocad [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] thanks"><y>#</y><d>2017-06-16</d><h>14:35</h><w>carocad</w><a>@gfredericks</a> thanks</z><z id="t1497623758" t="carocad maybe you could help me?. I think I might be doing a stupic mistake but I dont see it 😕"><y>#</y><d>2017-06-16</d><h>14:35</h><w>carocad</w>maybe you could help me?. I think I might be doing a stupic mistake but I dont see it <b>😕</b></z><z id="t1497623803" t="carocad the locals declared inside prop/for-all are not being recognized"><y>#</y><d>2017-06-16</d><h>14:36</h><w>carocad</w>the locals declared inside <code>prop/for-all</code> are not being recognized</z><z id="t1497623816" t="carocad I cannot even make the example in the README work"><y>#</y><d>2017-06-16</d><h>14:36</h><w>carocad</w>I cannot even make the example in the README work</z><z id="t1497625119" t="carocad bug report submitted"><y>#</y><d>2017-06-16</d><h>14:58</h><w>carocad</w>bug report submitted</z><z id="t1497625552" t="gfredericks [:attrs {:href &quot;/_/_/users/U0LJU20SJ&quot;}] that&apos;s pretty strange"><y>#</y><d>2017-06-16</d><h>15:05</h><w>gfredericks</w><a>@carocad</a> that&apos;s pretty strange</z><z id="t1497625668" t="carocad yeap, I am still trying to make sense of it. I mean if it would be normal if would have popep up before the lib release"><y>#</y><d>2017-06-16</d><h>15:07</h><w>carocad</w>yeap, I am still trying to make sense of it. I mean if it would be normal if would have popep up before the lib release</z><z id="t1497625688" t="gfredericks [:attrs {:href &quot;/_/_/users/U0LJU20SJ&quot;}] looking at the travis log, the problem seems to be using previous bindings in the for-all, which doesn&apos;t support that"><y>#</y><d>2017-06-16</d><h>15:08</h><w>gfredericks</w><a>@carocad</a> looking at the travis log, the problem seems to be using previous bindings in the for-all, which doesn&apos;t support that</z><z id="t1497625699" t="gfredericks The bindings are independent"><y>#</y><d>2017-06-16</d><h>15:08</h><w>gfredericks</w>The bindings are independent</z><z id="t1497625727" t="gfredericks That doesn&apos;t explain your claim that the readme example doesn&apos;t work"><y>#</y><d>2017-06-16</d><h>15:08</h><w>gfredericks</w>That doesn&apos;t explain your claim that the readme example doesn&apos;t work</z><z id="t1497625753" t="carocad I can put it on my file and show you a travis fail if that helps"><y>#</y><d>2017-06-16</d><h>15:09</h><w>carocad</w>I can put it on my file and show you a travis fail if that helps</z><z id="t1497625777" t="carocad btw, removing the previous binding didnt solve it in my case"><y>#</y><d>2017-06-16</d><h>15:09</h><w>carocad</w>btw, removing the previous binding didnt solve it in my case</z><z id="t1497625859" t="gfredericks You&apos;d have to refactor it to one binding with gen/let and destructing, probably"><y>#</y><d>2017-06-16</d><h>15:10</h><w>gfredericks</w>You&apos;d have to refactor it to one binding with gen/let and destructing, probably</z><z id="t1497625875" t="gfredericks The travis logs are helpful, yeah"><y>#</y><d>2017-06-16</d><h>15:11</h><w>gfredericks</w>The travis logs are helpful, yeah</z></g><g id="s4"><z id="t1497625894" t="gfredericks Especially if the source is online too "><y>#</y><d>2017-06-16</d><h>15:11</h><w>gfredericks</w>Especially if the source is online too </z><z id="t1497625908" t="carocad it is. Currently a pr but it should be enough"><y>#</y><d>2017-06-16</d><h>15:11</h><w>carocad</w>it is. Currently a pr but it should be enough</z><z id="t1497626115" t="carocad hmmm seems that I was wrong. The build is still failing but it doesnt show the same problem as before"><y>#</y><d>2017-06-16</d><h>15:15</h><w>carocad</w>hmmm seems that I was wrong. The build is still failing but it doesnt show the same problem as before</z><z id="t1497626121" t="carocad https://travis-ci.org/n7a235/backend.routing/builds/243706150?utm_source=github_status&amp;amp;utm_medium=notification"><y>#</y><d>2017-06-16</d><h>15:15</h><w>carocad</w><a href="https://travis-ci.org/n7a235/backend.routing/builds/243706150?utm_source=github_status&amp;amp;utm_medium=notification" target="_blank">https://travis-ci.org/n7a235/backend.routing/builds/243706150?utm_source=github_status&amp;amp;utm_medium=notification</a></z><z id="t1497626140" t="carocad the pr is this if it helps: https://github.com/n7a235/backend.routing/pull/3"><y>#</y><d>2017-06-16</d><h>15:15</h><w>carocad</w>the pr is this if it helps: <a href="https://github.com/n7a235/backend.routing/pull/3" target="_blank">https://github.com/n7a235/backend.routing/pull/3</a></z><z id="t1497626314" t="gfredericks [:attrs {:href &quot;/_/_/users/U0LJU20SJ&quot;}] that looks like just an eastwood failure?"><y>#</y><d>2017-06-16</d><h>15:18</h><w>gfredericks</w><a>@carocad</a> that looks like just an eastwood failure?</z><z id="t1497626356" t="carocad yeah it seems like it. I just changed my code and the example from the repo worked locally. I am testing in travis"><y>#</y><d>2017-06-16</d><h>15:19</h><w>carocad</w>yeah it seems like it. I just changed my code and the example from the repo worked locally. I am testing in travis</z><z id="t1497626658" t="carocad yeah it worked"><y>#</y><d>2017-06-16</d><h>15:24</h><w>carocad</w>yeah it worked</z><z id="t1497626684" t="carocad so the problem was the previous bindings 😄 sorry"><y>#</y><d>2017-06-16</d><h>15:24</h><w>carocad</w>so the problem was the previous bindings <b>😄</b> sorry</z><z id="t1497626718" t="carocad I&apos;m closing the issue"><y>#</y><d>2017-06-16</d><h>15:25</h><w>carocad</w>I&apos;m closing the issue</z><z id="t1497626761" t="gfredericks cool, thanks"><y>#</y><d>2017-06-16</d><h>15:26</h><w>gfredericks</w>cool, thanks</z><z id="t1497626890" t="carocad oh it seems I cannot close the issue 😞 I put a comment explaining it was my failure though"><y>#</y><d>2017-06-16</d><h>15:28</h><w>carocad</w>oh it seems I cannot close the issue <b>😞</b>
I put a comment explaining it was my failure though</z><z id="t1497626940" t="gfredericks huh, strange"><y>#</y><d>2017-06-16</d><h>15:29</h><w>gfredericks</w>huh, strange</z><z id="t1497626942" t="gfredericks I&apos;ll close it"><y>#</y><d>2017-06-16</d><h>15:29</h><w>gfredericks</w>I&apos;ll close it</z><z id="t1497627098" t="carocad thanks :thumbsup:"><y>#</y><d>2017-06-16</d><h>15:31</h><w>carocad</w>thanks <b>:thumbsup:</b></z><z id="t1497878492" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] I have a branch with proposed changes to collection sizing: https://github.com/clojure/test.check/tree/TCHECK-106"><y>#</y><d>2017-06-19</d><h>13:21</h><w>gfredericks</w><a>@alexmiller</a> I have a branch with proposed changes to collection sizing: <a href="https://github.com/clojure/test.check/tree/TCHECK-106" target="_blank">https://github.com/clojure/test.check/tree/TCHECK-106</a></z><z id="t1497878526" t="gfredericks I&apos;m not sure if you are interested in the subtleties or not, but let me know if you have any thoughts or any other way of testing whether it improves the situation with spec&apos;s usage"><y>#</y><d>2017-06-19</d><h>13:22</h><w>gfredericks</w>I&apos;m not sure if you are interested in the subtleties or not, but let me know if you have any thoughts or any other way of testing whether it improves the situation with spec&apos;s usage</z><z id="t1497878568" t="gfredericks I think the biggest &quot;risk&quot; is in severely reducing the coverage of existing tests that make assumptions about the old distributions"><y>#</y><d>2017-06-19</d><h>13:22</h><w>gfredericks</w>I think the biggest &quot;risk&quot; is in severely reducing the coverage of existing tests that make assumptions about the old distributions</z><z id="t1497883928" t="gfredericks could easily just release another alpha and see how it goes"><y>#</y><d>2017-06-19</d><h>14:52</h><w>gfredericks</w>could easily just release another alpha and see how it goes</z><z id="t1497886671" t="Alex Miller (Clojure team) I would love to take a look, but won’t be today"><y>#</y><d>2017-06-19</d><h>15:37</h><w>Alex Miller (Clojure team)</w>I would love to take a look, but won’t be today</z><z id="t1497886859" t="gfredericks 👍 no rush"><y>#</y><d>2017-06-19</d><h>15:40</h><w>gfredericks</w><b>👍</b> no rush</z><z id="t1497977362" t="mfikes There is an evidently breaking change in the 0.10.0-alpha1 release, somehow related to the introduction of the result protocol ( https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179 ). Was it intentional that this be a breaking change (does it require clients to update?) Here is a related ticket in the ClojureScript compiler regarding it: https://dev.clojure.org/jira/browse/CLJS-2110"><y>#</y><d>2017-06-20</d><h>16:49</h><w>mfikes</w>There is an evidently breaking change in the <code>0.10.0-alpha1</code> release, somehow related to the introduction of the result protocol (<a href="https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179" target="_blank">https://github.com/clojure/test.check/commit/95112167af9636a48d3174ddd03409e8ac752179</a>). Was it intentional that this be a breaking change (does it require clients to update?)
Here is a related ticket in the ClojureScript compiler regarding it: <a href="https://dev.clojure.org/jira/browse/CLJS-2110" target="_blank">https://dev.clojure.org/jira/browse/CLJS-2110</a></z><z id="t1497977565" t="gfredericks [:attrs {:href &quot;/_/_/users/U04VDQDDY&quot;}] the issue is spec returning an exception object?"><y>#</y><d>2017-06-20</d><h>16:52</h><w>gfredericks</w><a>@mfikes</a> the issue is spec returning an exception object?</z><z id="t1497977591" t="mfikes To be honest, I haven’t sorted out why things are regressing."><y>#</y><d>2017-06-20</d><h>16:53</h><w>mfikes</w>To be honest, I haven’t sorted out why things are regressing.</z><z id="t1497977633" t="gfredericks So spec used a hacky workaround that the result protocol was meant to obviate"><y>#</y><d>2017-06-20</d><h>16:53</h><w>gfredericks</w>So spec used a hacky workaround that the result protocol was meant to obviate</z><z id="t1497977638" t="mfikes I only know empirically right now based on bisecting. I’ve read the code to at least attempt to grok why, but haven’t gained comprehension yet."><y>#</y><d>2017-06-20</d><h>16:53</h><w>mfikes</w>I only know empirically right now based on bisecting. I’ve read the code to at least attempt to grok why, but haven’t gained comprehension yet.</z><z id="t1497977676" t="gfredericks So ideally spec should change to the better version, but I don&apos;t think I meant it to break. Though I might have"><y>#</y><d>2017-06-20</d><h>16:54</h><w>gfredericks</w>So ideally spec should change to the better version, but I don&apos;t think I meant it to break. Though I might have</z><z id="t1497977706" t="mfikes (I also don’t know if this affects Clojure—my experience with it is with JVM and self-hosted ClojureScript, where it breaks in the same way for both.)"><y>#</y><d>2017-06-20</d><h>16:55</h><w>mfikes</w>(I also don’t know if this affects Clojure—my experience with it is with JVM and self-hosted ClojureScript, where it breaks in the same way for both.)</z><z id="t1497977708" t="gfredericks I don&apos;t have a sense for what parts are changing at what speed 😕 "><y>#</y><d>2017-06-20</d><h>16:55</h><w>gfredericks</w>I don&apos;t have a sense for what parts are changing at what speed <b>😕</b> </z><z id="t1497977749" t="gfredericks And whether it would be bad for spec to require tc alpha"><y>#</y><d>2017-06-20</d><h>16:55</h><w>gfredericks</w>And whether it would be bad for spec to require tc alpha</z><z id="t1497977749" t="mfikes Cool. If there was no clear intent to be a breaking change, I’ll dig further to see if can suss out what is going on."><y>#</y><d>2017-06-20</d><h>16:55</h><w>mfikes</w>Cool. If there was no clear intent to be a breaking change, I’ll dig further to see if can suss out what is going on.</z><z id="t1497977840" t="gfredericks I expect making it nonbreaking would consist of having t.c continue special-casing return values that are Exceptions"><y>#</y><d>2017-06-20</d><h>16:57</h><w>gfredericks</w>I expect making it nonbreaking would consist of having t.c continue special-casing return values that are Exceptions</z><z id="t1497977996" t="mfikes That helps… I’ll dig deeper—t.c. 0.10.0 is still alpha, after all."><y>#</y><d>2017-06-20</d><h>16:59</h><w>mfikes</w>That helps… I’ll dig deeper—t.c. 0.10.0 is still alpha, after all.</z><z id="t1497978334" t="Alex Miller (Clojure team) I would say it’s possible that spec.alpha could depend on an alpha"><y>#</y><d>2017-06-20</d><h>17:05</h><w>Alex Miller (Clojure team)</w>I would say it’s possible that spec.alpha could depend on an alpha</z><z id="t1497978346" t="Alex Miller (Clojure team) but that regardless of that, t.c shouldn’t introduce a breaking change"><y>#</y><d>2017-06-20</d><h>17:05</h><w>Alex Miller (Clojure team)</w>but that regardless of that, t.c shouldn’t introduce a breaking change</z><z id="t1497978369" t="Alex Miller (Clojure team) and if the semantics need to change, it should have a new name"><y>#</y><d>2017-06-20</d><h>17:06</h><w>Alex Miller (Clojure team)</w>and if the semantics need to change, it should have a new name</z><z id="t1497980182" t="mfikes FWIW, t.c 0.10.0-alpha1 has a breaking change for Clojure 1.9.0-alpha17 for this case as well: $ lein repl nREPL server started on port 55971 on host 127.0.0.1 - REPL-y 0.3.7, nREPL 0.2.12 Clojure 1.9.0-alpha17 Java HotSpot(TM) 64-Bit Server VM 1.8.0_131-b11 Docs: (doc function-name-here) (find-doc &quot;part-of-name-here&quot;) Source: (source function-name-here) Javadoc: (javadoc java-object-or-class-here) Exit: Control+D or (exit) or (quit) Results: Stored in vars *1, *2, *3, an exception in *e user=&gt; (require &apos;[clojure.spec.alpha :as s] #_=&gt; &apos;[clojure.spec.test.alpha :as st]) nil user=&gt; (defn ranged-rand [start end] 0) #&apos;user/ranged-rand user=&gt; (s/fdef ranged-rand #_=&gt; :args (s/and (s/cat :start int? :end int?) #_=&gt; #(&lt; (:start %) (:end %))) #_=&gt; :ret int? #_=&gt; :fn (s/and #(&gt;= (:ret %) (-&gt; % :args :start)) #_=&gt; #(&lt; (:ret %) (-&gt; % :args :end)))) user/ranged-rand user=&gt; (st/check `ranged-rand) ({:spec #object[clojure.spec.alpha$fspec_impl$reify__1215 0x2af92bb9 &quot;"><y>#</y><d>2017-06-20</d><h>17:36</h><w>mfikes</w>FWIW, t.c <code>0.10.0-alpha1</code> has a breaking change for Clojure <code>1.9.0-alpha17</code> for this case as well:
<pre>$ lein repl
nREPL server started on port 55971 on host 127.0.0.1 - 
REPL-y 0.3.7, nREPL 0.2.12
Clojure 1.9.0-alpha17
Java HotSpot(TM) 64-Bit Server VM 1.8.0_131-b11
    Docs: (doc function-name-here)
          (find-doc &quot;part-of-name-here&quot;)
  Source: (source function-name-here)
 Javadoc: (javadoc java-object-or-class-here)
    Exit: Control+D or (exit) or (quit)
 Results: Stored in vars *1, *2, *3, an exception in *e

user=&gt; (require &apos;[clojure.spec.alpha :as s]
  #_=&gt;   &apos;[clojure.spec.test.alpha :as st])
nil
user=&gt; (defn ranged-rand [start end] 0)
#&apos;user/ranged-rand
user=&gt; (s/fdef ranged-rand
  #_=&gt;   :args (s/and (s/cat :start int? :end int?)
  #_=&gt;                #(&lt; (:start %) (:end %)))
  #_=&gt;   :ret int?
  #_=&gt;   :fn (s/and #(&gt;= (:ret %) (-&gt; % :args :start))
  #_=&gt;              #(&lt; (:ret %) (-&gt; % :args :end))))
user/ranged-rand
user=&gt; (st/check `ranged-rand)
({:spec #object[clojure.spec.alpha$fspec_impl$reify__1215 0x2af92bb9 &quot;</pre></z><z id="t1497980321" t="Alex Miller (Clojure team) what’s the change?"><y>#</y><d>2017-06-20</d><h>17:38</h><w>Alex Miller (Clojure team)</w>what’s the change?</z><z id="t1497980362" t="Alex Miller (Clojure team) at a glance I don’t see anything amiss there"><y>#</y><d>2017-06-20</d><h>17:39</h><w>Alex Miller (Clojure team)</w>at a glance I don’t see anything amiss there</z><z id="t1497980411" t="mfikes Right, it might not be a breaking change, but an internal bug. Here is what it used to do…"><y>#</y><d>2017-06-20</d><h>17:40</h><w>mfikes</w>Right, it might not be a breaking change, but an internal bug. Here is what it used to do…</z><z id="t1497980470" t="mfikes Here is a gist… it is too big to really paste: https://gist.github.com/mfikes/1caa83751019495cfdda83e79ad7e3ed"><y>#</y><d>2017-06-20</d><h>17:41</h><w>mfikes</w>Here is a gist… it is too big to really paste: <a href="https://gist.github.com/mfikes/1caa83751019495cfdda83e79ad7e3ed" target="_blank">https://gist.github.com/mfikes/1caa83751019495cfdda83e79ad7e3ed</a></z><z id="t1497980597" t="mfikes Internal bug because: It doesn’t return a falsey :result Breaking change because the :result used to be much richer than just a Boolean value, and clients might not know to look for :result-data"><y>#</y><d>2017-06-20</d><h>17:43</h><w>mfikes</w>Internal bug because: It doesn’t return a falsey <code>:result</code>
Breaking change because the <code>:result</code> used to be much richer than just a Boolean value, and clients might not know to look for <code>:result-data</code></z><z id="t1497980654" t="Alex Miller (Clojure team) it just looks to me like it found a failing example in the old one but didn’t in the new one"><y>#</y><d>2017-06-20</d><h>17:44</h><w>Alex Miller (Clojure team)</w>it just looks to me like it found a failing example in the old one but didn’t in the new one</z><z id="t1497980677" t="Alex Miller (Clojure team) which might just be due to what the random seed turned up, not a real difference"><y>#</y><d>2017-06-20</d><h>17:44</h><w>Alex Miller (Clojure team)</w>which might just be due to what the random seed turned up, not a real difference</z><z id="t1497980687" t="mfikes Ahh. Right."><y>#</y><d>2017-06-20</d><h>17:44</h><w>mfikes</w>Ahh. Right.</z><z id="t1497980703" t="mfikes I’ll increase the number of tests to see what occurs."><y>#</y><d>2017-06-20</d><h>17:45</h><w>mfikes</w>I’ll increase the number of tests to see what occurs.</z><z id="t1497980807" t="Alex Miller (Clojure team) I guess maybe it’s surprising that t.c found 1000 successful cases with a hard-coded result in the new one"><y>#</y><d>2017-06-20</d><h>17:46</h><w>Alex Miller (Clojure team)</w>I guess maybe it’s surprising that t.c found 1000 successful cases with a hard-coded result in the new one</z><z id="t1497980852" t="mfikes True. Seems unlikely to have pulled that off 🙂"><y>#</y><d>2017-06-20</d><h>17:47</h><w>mfikes</w>True. Seems unlikely to have pulled that off <b>🙂</b></z><z id="t1497980906" t="Alex Miller (Clojure team) so maybe just looking at (gen/sample (s/gen (:args (s/get-spec user/ranged-rand))) 1000) might be interesting as a before / after"><y>#</y><d>2017-06-20</d><h>17:48</h><w>Alex Miller (Clojure team)</w>so maybe just looking at (gen/sample (s/gen (:args (s/get-spec user/ranged-rand))) 1000) might be interesting as a before / after</z><z id="t1497981017" t="mfikes user=&gt; (gen/sample (s/gen (:args (s/get-spec &apos;user/ranged-rand))) 10) ((0 1) (-1 0) (-1 2) (0 1) (-23 2) (1 3) (-16 -6) (-92 -10) (-1 2) (2 7)) "><y>#</y><d>2017-06-20</d><h>17:50</h><w>mfikes</w><pre>user=&gt; (gen/sample (s/gen (:args (s/get-spec &apos;user/ranged-rand))) 10)
((0 1) (-1 0) (-1 2) (0 1) (-23 2) (1 3) (-16 -6) (-92 -10) (-1 2) (2 7))
</pre></z><z id="t1497981038" t="mfikes (2 7) should fail, right?"><y>#</y><d>2017-06-20</d><h>17:50</h><w>mfikes</w><code>(2 7)</code> should fail, right?</z><z id="t1497981050" t="Alex Miller (Clojure team) yeah"><y>#</y><d>2017-06-20</d><h>17:50</h><w>Alex Miller (Clojure team)</w>yeah</z><z id="t1497981077" t="Alex Miller (Clojure team) as should (-92 -10)"><y>#</y><d>2017-06-20</d><h>17:51</h><w>Alex Miller (Clojure team)</w>as should (-92 -10)</z><z id="t1497981090" t="mfikes Yep… many don’t include 0"><y>#</y><d>2017-06-20</d><h>17:51</h><w>mfikes</w>Yep… many don’t include 0</z><z id="t1497981092" t="Alex Miller (Clojure team) or (1 3)"><y>#</y><d>2017-06-20</d><h>17:51</h><w>Alex Miller (Clojure team)</w>or (1 3)</z><z id="t1497981104" t="Alex Miller (Clojure team) or (-1 0) - which is the failing example in the old one"><y>#</y><d>2017-06-20</d><h>17:51</h><w>Alex Miller (Clojure team)</w>or (-1 0) - which is the failing example in the old one</z><z id="t1497981124" t="Alex Miller (Clojure team) so the generator seems fine"><y>#</y><d>2017-06-20</d><h>17:52</h><w>Alex Miller (Clojure team)</w>so the generator seems fine</z><z id="t1497981134" t="Alex Miller (Clojure team) and next we should suspect the prop checking"><y>#</y><d>2017-06-20</d><h>17:52</h><w>Alex Miller (Clojure team)</w>and next we should suspect the prop checking</z><z id="t1497981581" t="mfikes I revised my ranged-rand to prn its args, and also revised the :fn part of the fdef to print its argument, and at least those parts look correct user=&gt; (st/check `ranged-rand {:clojure.spec.test.check/opts {:num-tests 2}}) -1 1 {:args {:start -1, :end 1}, :ret 0} -4 -2 {:args {:start -4, :end -2}, :ret 0} ({:spec #object[clojure.spec.alpha$fspec_impl$reify__1215 0x77b18e9a &quot;"><y>#</y><d>2017-06-20</d><h>17:59</h><w>mfikes</w>I revised my <code>ranged-rand</code> to <code>prn</code> its args, and also revised the <code>:fn</code> part of the <code>fdef</code> to print its argument, and at least those parts look correct
<pre>user=&gt; (st/check `ranged-rand {:clojure.spec.test.check/opts {:num-tests 2}})
-1 1
{:args {:start -1, :end 1}, :ret 0}
-4 -2
{:args {:start -4, :end -2}, :ret 0}
({:spec #object[clojure.spec.alpha$fspec_impl$reify__1215 0x77b18e9a &quot;</pre></z><z id="t1497982094" t="gfredericks hi I&apos;m back"><y>#</y><d>2017-06-20</d><h>18:08</h><w>gfredericks</w>hi I&apos;m back</z><z id="t1497982117" t="mfikes TL;DR of the above is just reproing it in Clojure"><y>#</y><d>2017-06-20</d><h>18:08</h><w>mfikes</w>TL;DR of the above is just reproing it in Clojure</z><z id="t1497982230" t="mfikes I suppose there is the twist that there might be an internal bug in t.c (disregarding any potential interface changes)"><y>#</y><d>2017-06-20</d><h>18:10</h><w>mfikes</w>I suppose there is the twist that there might be an internal bug in t.c (disregarding any potential interface changes)</z><z id="t1497982261" t="gfredericks [:attrs {:href &quot;/_/_/users/U04VDQDDY&quot;}] regarding the first issue, it definitely looks like I didn&apos;t retain the old behavior; an extra clause here should fix it: https://github.com/clojure/test.check/blob/23e1fcc1bb7f3f2d0202ed99eee202a0b1f2c652/src/main/clojure/clojure/test/check/results.cljc#L18"><y>#</y><d>2017-06-20</d><h>18:11</h><w>gfredericks</w><a>@mfikes</a> regarding the first issue, it definitely looks like I didn&apos;t retain the old behavior; an extra clause here should fix it: <a href="https://github.com/clojure/test.check/blob/23e1fcc1bb7f3f2d0202ed99eee202a0b1f2c652/src/main/clojure/clojure/test/check/results.cljc#L18" target="_blank">https://github.com/clojure/test.check/blob/23e1fcc1bb7f3f2d0202ed99eee202a0b1f2c652/src/main/clojure/clojure/test/check/results.cljc#L18</a></z><z id="t1497982284" t="gfredericks I&apos;m assuming cljs has something like Throwable for extending error types, but maybe that&apos;s not true?"><y>#</y><d>2017-06-20</d><h>18:11</h><w>gfredericks</w>I&apos;m assuming cljs has something like <code>Throwable</code> for extending error types, but maybe that&apos;s not true?</z><z id="t1497982308" t="mfikes It might be possible to extend js/Error or somesuch"><y>#</y><d>2017-06-20</d><h>18:11</h><w>mfikes</w>It might be possible to extend js/Error or somesuch</z><z id="t1497982792" t="mfikes [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] Evidently you can. Not sure what the implications might be. cljs.user=&gt; (defprotocol Result #_=&gt; (passing? [result]) #_=&gt; (result-data [result] &quot;A map of data about the trial.&quot;)) nil cljs.user=&gt; (extend-protocol Result #_=&gt; js/Error #_=&gt; (passing? [this] false) #_=&gt; (result-data [this] (ex-data this))) #object[Function &quot;function (this$){ var this$__$1 = this; return cljs.core.ex_data.call(null,this$__$1); }&quot;] cljs.user=&gt; (result-data (ex-info &quot;hi&quot; {:a 1})) {:a 1} "><y>#</y><d>2017-06-20</d><h>18:19</h><w>mfikes</w><a>@gfredericks</a> Evidently you can. Not sure what the implications might be.
<pre>cljs.user=&gt; (defprotocol Result
       #_=&gt;   (passing? [result])
       #_=&gt;   (result-data [result] &quot;A map of data about the trial.&quot;))
nil
cljs.user=&gt; (extend-protocol Result
       #_=&gt;   js/Error
       #_=&gt;   (passing? [this] false)
       #_=&gt;   (result-data [this] (ex-data this)))
#object[Function &quot;function (this$){
var this$__$1 = this;
return cljs.core.ex_data.call(null,this$__$1);
}&quot;]
cljs.user=&gt; (result-data (ex-info &quot;hi&quot; {:a 1}))
{:a 1}
</pre></z><z id="t1497982810" t="mfikes ^ works in JVM and self-hosted ClojureScript"><y>#</y><d>2017-06-20</d><h>18:20</h><w>mfikes</w>^ works in JVM and self-hosted ClojureScript</z><z id="t1497982816" t="gfredericks [:attrs {:href &quot;/_/_/users/U04VDQDDY&quot;}] does it work for (throw &quot;some string&quot;) ?"><y>#</y><d>2017-06-20</d><h>18:20</h><w>gfredericks</w><a>@mfikes</a> does it work for <code>(throw &quot;some string&quot;)</code>?</z><z id="t1497982974" t="mfikes [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] If you extract using ex-message : cljs.user=&gt; (extend-protocol Result #_=&gt; js/Error #_=&gt; (passing? [this] false) #_=&gt; (result-data [this] (ex-message this))) #object[Function &quot;function (this$){ var this$__$1 = this; return cljs.core.ex_message.call(null,this$__$1); }&quot;] cljs.user=&gt; (result-data (js/Error. &quot;some string&quot;)) &quot;some string&quot; "><y>#</y><d>2017-06-20</d><h>18:22</h><w>mfikes</w><a>@gfredericks</a> If you extract using <code>ex-message</code>:
<pre>cljs.user=&gt; (extend-protocol Result
       #_=&gt;   js/Error
       #_=&gt;   (passing? [this] false)
       #_=&gt;   (result-data [this] (ex-message this)))
#object[Function &quot;function (this$){
var this$__$1 = this;
return cljs.core.ex_message.call(null,this$__$1);
}&quot;]
cljs.user=&gt; (result-data (js/Error. &quot;some string&quot;))
&quot;some string&quot;
</pre></z><z id="t1497983083" t="mfikes I’ll see what happens if I build a t.c that further extends Result to exceptions"><y>#</y><d>2017-06-20</d><h>18:24</h><w>mfikes</w>I’ll see what happens if I build a t.c that further extends <code>Result</code> to exceptions</z><z id="t1497983428" t="gfredericks I was just concerned that if you throw a string, the thrown thing is not a js/Error and so wouldn&apos;t match that clause"><y>#</y><d>2017-06-20</d><h>18:30</h><w>gfredericks</w>I was just concerned that if you throw a string, the thrown thing is not a <code>js/Error</code> and so wouldn&apos;t match that clause</z><z id="t1497983443" t="mfikes Ahh"><y>#</y><d>2017-06-20</d><h>18:30</h><w>mfikes</w>Ahh</z><z id="t1497984228" t="mfikes At least for the exception thrown for the case above, further extending does the trick"><y>#</y><d>2017-06-20</d><h>18:43</h><w>mfikes</w>At least for the exception thrown for the case above, further extending does the trick</z><z id="t1497984280" t="mfikes cljs.user=&gt; (st/check `ranged-rand) [{:spec #object[cljs.spec.alpha.t_cljs$spec$alpha5600], :clojure.test.check/ret {:result false, :result-data {:a 1}, :seed 1497984200982, :failing-size 0, :num-tests 1, :fail [(-1 0)], :shrunk {:total-nodes-visited 0, :depth 0, :result false, :result-data {:a 1}, :smallest [(-1 0)]}}, :sym cljs.user/ranged-rand, :failure false}] With this kind of extension: (passing? [this] false) - (result-data [this] {})) + (result-data [this] {}) + + #?(:clj Throwable :cljs js/Error) + (passing? [this] false) + (result-data [this] {:a 1})) "><y>#</y><d>2017-06-20</d><h>18:44</h><w>mfikes</w><pre>cljs.user=&gt; (st/check `ranged-rand)
[{:spec #object[cljs.spec.alpha.t_cljs$spec$alpha5600],
  :clojure.test.check/ret {:result false,
                           :result-data {:a 1},
                           :seed 1497984200982,
                           :failing-size 0,
                           :num-tests 1,
                           :fail [(-1 0)],
                           :shrunk {:total-nodes-visited 0,
                                    :depth 0,
                                    :result false,
                                    :result-data {:a 1},
                                    :smallest [(-1 0)]}},
  :sym cljs.user/ranged-rand,
  :failure false}]
</pre>

With this kind of extension:
<pre>(passing? [this] false)
-  (result-data [this] {}))
+  (result-data [this] {})
+
+  #?(:clj Throwable :cljs js/Error)
+  (passing? [this] false)
+  (result-data [this] {:a 1}))
</pre></z><z id="t1497984486" t="mfikes Perhaps :failure false is not what you’d want. Hrm."><y>#</y><d>2017-06-20</d><h>18:48</h><w>mfikes</w>Perhaps <code>:failure false</code> is not what you’d want. Hrm.</z><z id="t1497989708" t="mfikes Captured the above with https://dev.clojure.org/jira/browse/TCHECK-131"><y>#</y><d>2017-06-20</d><h>20:15</h><w>mfikes</w>Captured the above with <a href="https://dev.clojure.org/jira/browse/TCHECK-131" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-131</a></z><z id="t1497994484" t="gfredericks [:attrs {:href &quot;/_/_/users/U04VDQDDY&quot;}] great, thanks"><y>#</y><d>2017-06-20</d><h>21:34</h><w>gfredericks</w><a>@mfikes</a> great, thanks</z><z id="t1497994519" t="gfredericks I&apos;ll make sure to get another alpha out shortly"><y>#</y><d>2017-06-20</d><h>21:35</h><w>gfredericks</w>I&apos;ll make sure to get another alpha out shortly</z><z id="t1497995025" t="mfikes Thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] !"><y>#</y><d>2017-06-20</d><h>21:43</h><w>mfikes</w>Thanks <a>@gfredericks</a> !</z><z id="t1498506244" t="rabbitthirtyeight I&apos;m having trouble doing some seemingly basic stuff with test.check. Can someone point out where I&apos;m going wrong? Basically bind and large-integer* don&apos;t seem to be working as I expected. If I have the following in my property: (let [greater (gen/large-integer* {:min 0 :max 10}) lesser (gen/bind greater (fn [x] (gen/large-integer* {:min 0 :max x})))] (prop/for-all [less lesser great greater] (is (&lt;= less great))) when I run the test I always get the following failure: expected: (&lt;= less great) actual: (not (&lt;= 1 0)) "><y>#</y><d>2017-06-26</d><h>19:44</h><w>rabbitthirtyeight</w>I&apos;m having trouble doing some seemingly basic stuff with test.check. Can someone point out where I&apos;m going wrong? 

Basically <code>bind</code> and <code>large-integer*</code> don&apos;t seem to be working as I expected. 

If I have the following in my property:
<pre>(let  [greater (gen/large-integer* {:min 0 :max 10})
        lesser (gen/bind greater (fn [x] (gen/large-integer* {:min 0 :max x})))]


    (prop/for-all [less lesser
                   great greater]
                  (is (&lt;= less great)))
</pre>
when I run the test I always get the following failure:
<pre>expected: (&lt;= less great)
  actual: (not (&lt;= 1 0))
</pre></z><z id="t1498508928" t="gfredericks [:attrs {:href &quot;/_/_/users/U39J06WTF&quot;}] I know what&apos;s wrong, but don&apos;t know enough about what you&apos;re really doing to recommend an alternative"><y>#</y><d>2017-06-26</d><h>20:28</h><w>gfredericks</w><a>@rabbitthirtyeight</a> I know what&apos;s wrong, but don&apos;t know enough about what you&apos;re really doing to recommend an alternative</z><z id="t1498508942" t="gfredericks the reason it isn&apos;t doing what you think is that there&apos;s a different greater being generated for each of less and great"><y>#</y><d>2017-06-26</d><h>20:29</h><w>gfredericks</w>the reason it isn&apos;t doing what you think is that there&apos;s a different <code>greater</code> being generated for each of <code>less</code> and <code>great</code></z><z id="t1498538022" t="rabbitthirtyeight [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] ah. I see what you&apos;re saying. Thanks! Given that, I think I need to re-think what I was trying to do. If I&apos;m unable to figure it out I&apos;ll post back in here."><y>#</y><d>2017-06-27</d><h>04:33</h><w>rabbitthirtyeight</w><a>@gfredericks</a> ah. I see what you&apos;re saying. Thanks! Given that, I think I need to re-think what I was trying to do. If I&apos;m unable to figure it out I&apos;ll post back in here.</z><z id="t1498567158" t="gfredericks I&apos;m thinking of creating prop/for-all2 , or prop/for-all-2 , whichever name is better"><y>#</y><d>2017-06-27</d><h>12:39</h><w>gfredericks</w>I&apos;m thinking of creating <code>prop/for-all2</code>, or <code>prop/for-all-2</code>, whichever name is better</z><z id="t1498567212" t="gfredericks differences: - doesn&apos;t have the TCHECK-131 interpretation of returned exceptions - uses sequential bindings like gen/let , and has the map-binding syntax of gen/let as well for parallel bindings - any other improvements anybody would want?"><y>#</y><d>2017-06-27</d><h>12:40</h><w>gfredericks</w>differences:

- doesn&apos;t have the TCHECK-131 interpretation of returned exceptions
- uses sequential bindings like <code>gen/let</code>, and has the map-binding syntax of <code>gen/let</code> as well for parallel bindings
- any other improvements anybody would want?</z><z id="t1498570994" t="gfredericks test.check version 0.10.0-alpha2 was just released; changelog here: https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha2-2017-06-27"><y>#</y><d>2017-06-27</d><h>13:43</h><w>gfredericks</w>test.check version <code>0.10.0-alpha2</code> was just released; changelog here: <a href="https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha2-2017-06-27" target="_blank">https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha2-2017-06-27</a></z><z id="t1499202931" t="mattly so just as a testament to the power of property-based testing:"><y>#</y><d>2017-07-04</d><h>21:15</h><w>mattly</w>so just as a testament to the power of property-based testing:</z><z id="t1499202977" t="mattly the harness I have for testing calculations &amp; queries against the data warehouse I manage an application front-end for just caught a super-rare edge case"><y>#</y><d>2017-07-04</d><h>21:16</h><w>mattly</w>the harness I have for testing calculations &amp; queries against the data warehouse I manage an application front-end for just caught a super-rare edge case</z><z id="t1499202984" t="mattly doesn&apos;t actually happen against production data"><y>#</y><d>2017-07-04</d><h>21:16</h><w>mattly</w>doesn&apos;t actually happen against production data</z><z id="t1499202997" t="mattly but it could"><y>#</y><d>2017-07-04</d><h>21:16</h><w>mattly</w>but it could</z><z id="t1499203033" t="mattly my test suite started running monday morning, and test.check generated this edge case, and cranked on it for over 30 hours, approx 200k iterations, until it isolated the problem"><y>#</y><d>2017-07-04</d><h>21:17</h><w>mattly</w>my test suite started running monday morning, and test.check generated this edge case, and cranked on it for over 30 hours, approx 200k iterations, until it isolated the problem</z><z id="t1499203051" t="mattly and I look at it and go, oh, of course!"><y>#</y><d>2017-07-04</d><h>21:17</h><w>mattly</w>and I look at it and go, oh, of course!</z><z id="t1499203073" t="mattly and it was like one of these little 2 character fixes"><y>#</y><d>2017-07-04</d><h>21:17</h><w>mattly</w>and it was like one of these little 2 character fixes</z><z id="t1499203099" t="mattly but had the problem occurred against production data, nobody ever would have known"><y>#</y><d>2017-07-04</d><h>21:18</h><w>mattly</w>but had the problem occurred against production data, nobody ever would have known</z><z id="t1499203102" t="mattly so, thanks"><y>#</y><d>2017-07-04</d><h>21:18</h><w>mattly</w>so, thanks</z><z id="t1499203540" t="gfredericks &gt; doesn&apos;t actually happen against production data &gt; but had the problem occurred against production data, nobody ever would have known So how do you know it didn&apos;t?"><y>#</y><d>2017-07-04</d><h>21:25</h><w>gfredericks</w>&gt; doesn&apos;t actually happen against production data

&gt; but had the problem occurred against production data, nobody ever would have known

So how do you know it didn&apos;t?</z><z id="t1499226996" t="mattly I checked the source condition against our production set, it didn&apos;t exist"><y>#</y><d>2017-07-05</d><h>03:56</h><w>mattly</w>I checked the source condition against our production set, it didn&apos;t exist</z><z id="t1499227001" t="mattly but it could have"><y>#</y><d>2017-07-05</d><h>03:56</h><w>mattly</w>but it could have</z><z id="t1500066431" t="peeja I don&apos;t suppose there&apos;s a core.async &quot;mode&quot; I can run quick-check in in ClojureScript, is there?"><y>#</y><d>2017-07-14</d><h>21:07</h><w>peeja</w>I don&apos;t suppose there&apos;s a core.async &quot;mode&quot; I can run <code>quick-check</code> in in ClojureScript, is there?</z><z id="t1500066467" t="peeja Having the entire page lock up while test.check runs itself 100 times is crimping my style a bit"><y>#</y><d>2017-07-14</d><h>21:07</h><w>peeja</w>Having the entire page lock up while test.check runs itself 100 times is crimping my style a bit</z><z id="t1500066495" t="peeja I&apos;d love to get it to report its progress as it goes and let the page interrupt it"><y>#</y><d>2017-07-14</d><h>21:08</h><w>peeja</w>I&apos;d love to get it to report its progress as it goes and let the page interrupt it</z><z id="t1500066509" t="gfredericks Async tests are a high priority; I have a hacky branch you could try if you like"><y>#</y><d>2017-07-14</d><h>21:08</h><w>gfredericks</w>Async tests are a high priority; I have a hacky branch you could try if you like</z><z id="t1500066531" t="peeja Ooh, I&apos;d love to take a look, at least"><y>#</y><d>2017-07-14</d><h>21:08</h><w>peeja</w>Ooh, I&apos;d love to take a look, at least</z><z id="t1500066572" t="gfredericks It&apos;s called async-tests-POC on the main github repo"><y>#</y><d>2017-07-14</d><h>21:09</h><w>gfredericks</w>It&apos;s called async-tests-POC on the main github repo</z><z id="t1500066602" t="gfredericks Would be interested to know if it solves your problems"><y>#</y><d>2017-07-14</d><h>21:10</h><w>gfredericks</w>Would be interested to know if it solves your problems</z><z id="t1500066630" t="peeja I have a niggling feeling that there&apos;s a transducer in here somewhere"><y>#</y><d>2017-07-14</d><h>21:10</h><w>peeja</w>I have a niggling feeling that there&apos;s a transducer in here somewhere</z><z id="t1500066655" t="peeja That might abstract the testing itself from the synchrony choice"><y>#</y><d>2017-07-14</d><h>21:10</h><w>peeja</w>That might abstract the testing itself from the synchrony choice</z><z id="t1500066755" t="gfredericks You should talk to [:attrs {:href &quot;/_/_/users/U067S6YLW&quot;}] about that, he&apos;s been working on refactoring the core algorithm"><y>#</y><d>2017-07-14</d><h>21:12</h><w>gfredericks</w>You should talk to <a>@nberger</a> about that, he&apos;s been working on refactoring the core algorithm</z><z id="t1500066794" t="gfredericks The shrink algorithm might resist transducing"><y>#</y><d>2017-07-14</d><h>21:13</h><w>gfredericks</w>The shrink algorithm might resist transducing</z><z id="t1500066806" t="peeja BTW, what&apos;s future in CLJS?"><y>#</y><d>2017-07-14</d><h>21:13</h><w>peeja</w>BTW, what&apos;s <code>future</code> in CLJS?</z><z id="t1500066835" t="peeja That&apos;s not built in, is it?"><y>#</y><d>2017-07-14</d><h>21:13</h><w>peeja</w>That&apos;s not built in, is it?</z><z id="t1500066880" t="gfredericks It is. I think it just does settimeout"><y>#</y><d>2017-07-14</d><h>21:14</h><w>gfredericks</w>It is. I think it just does settimeout</z><z id="t1500066894" t="gfredericks ....I hope"><y>#</y><d>2017-07-14</d><h>21:14</h><w>gfredericks</w>....I hope</z><z id="t1500067048" t="peeja I don&apos;t see it anywhere…"><y>#</y><d>2017-07-14</d><h>21:17</h><w>peeja</w>I don&apos;t see it anywhere…</z><z id="t1500067337" t="gfredericks Are macros in a separate file?"><y>#</y><d>2017-07-14</d><h>21:22</h><w>gfredericks</w>Are macros in a separate file?</z><z id="t1500068334" t="peeja They are, but I don&apos;t see it there, and it&apos;s not documented"><y>#</y><d>2017-07-14</d><h>21:38</h><w>peeja</w>They are, but I don&apos;t see it there, and it&apos;s not documented</z><z id="t1500068389" t="peeja Ah, looks like it&apos;s not out yet?"><y>#</y><d>2017-07-14</d><h>21:39</h><w>peeja</w>Ah, looks like it&apos;s not out yet?</z><z id="t1500068406" t="peeja https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L6865-L6872"><y>#</y><d>2017-07-14</d><h>21:40</h><w>peeja</w><a href="https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L6865-L6872" target="_blank">https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L6865-L6872</a></z><z id="t1500068436" t="peeja No, that&apos;s clojure…"><y>#</y><d>2017-07-14</d><h>21:40</h><w>peeja</w>No, that&apos;s clojure…</z><z id="t1500068446" t="peeja Not sure how I got crossed over there"><y>#</y><d>2017-07-14</d><h>21:40</h><w>peeja</w>Not sure how I got crossed over there</z><z id="t1500068460" t="gfredericks Did you try running it?"><y>#</y><d>2017-07-14</d><h>21:41</h><w>gfredericks</w>Did you try running it?</z><z id="t1500068491" t="peeja https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/core.cljc"><y>#</y><d>2017-07-14</d><h>21:41</h><w>peeja</w><a href="https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/core.cljc" target="_blank">https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/core.cljc</a></z><z id="t1500068503" t="peeja Not yet"><y>#</y><d>2017-07-14</d><h>21:41</h><w>peeja</w>Not yet</z><z id="t1500068520" t="gfredericks Because I&apos;m not sure I did, in cljs 😶 "><y>#</y><d>2017-07-14</d><h>21:42</h><w>gfredericks</w>Because I&apos;m not sure I did, in cljs <b>😶</b> </z><z id="t1500068551" t="peeja Heh"><y>#</y><d>2017-07-14</d><h>21:42</h><w>peeja</w>Heh</z><z id="t1500068641" t="gfredericks So I take back everything i said about future"><y>#</y><d>2017-07-14</d><h>21:44</h><w>gfredericks</w>So I take back everything i said about future</z><z id="t1500068732" t="peeja I mean, it&apos;d be pretty sweet"><y>#</y><d>2017-07-14</d><h>21:45</h><w>peeja</w>I mean, it&apos;d be pretty sweet</z><z id="t1500069078" t="gfredericks Easy to write"><y>#</y><d>2017-07-14</d><h>21:51</h><w>gfredericks</w>Easy to write</z><z id="t1500073265" t="gfredericks Sorry about the code being even less in shape than I thought"><y>#</y><d>2017-07-14</d><h>23:01</h><w>gfredericks</w>Sorry about the code being even less in shape than I thought</z><z id="t1501018193" t="moxaj question: is there any way to control how a recursive generator shrinks? for example, the following can return [[[[false]]]] as the minimal failing example: (tc/quick-check 100 (tc.prop/for-all [value (tc.gen/recursive-gen tc.gen/vector tc.gen/boolean)] (every? true? (flatten value)))) "><y>#</y><d>2017-07-25</d><h>21:29</h><w>moxaj</w>question: is there any way to control how a recursive generator shrinks? for example, the following can return <code>[[[[false]]]]</code> as the minimal failing example:
<pre>(tc/quick-check 100
  (tc.prop/for-all [value (tc.gen/recursive-gen tc.gen/vector tc.gen/boolean)]
    (every? true? (flatten value))))
</pre></z><z id="t1501018279" t="moxaj however, if a recursive generator could shrink towards the children of the actual compound generator, it could produce [false] as the minimal failing value"><y>#</y><d>2017-07-25</d><h>21:31</h><w>moxaj</w>however, if a recursive generator could shrink towards the children of the actual compound generator, it could produce <code>[false]</code> as the minimal failing value</z><z id="t1501018284" t="gfredericks there&apos;s a ticket for that"><y>#</y><d>2017-07-25</d><h>21:31</h><w>gfredericks</w>there&apos;s a ticket for that</z><z id="t1501018294" t="gfredericks I&apos;m not sure if it&apos;s an easy fix or not"><y>#</y><d>2017-07-25</d><h>21:31</h><w>gfredericks</w>I&apos;m not sure if it&apos;s an easy fix or not</z><z id="t1501018330" t="gfredericks https://dev.clojure.org/jira/browse/TCHECK-110?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel"><y>#</y><d>2017-07-25</d><h>21:32</h><w>gfredericks</w><a href="https://dev.clojure.org/jira/browse/TCHECK-110?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-110?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel</a></z><z id="t1501018341" t="gfredericks according to the comments, my past self wasn&apos;t sure either"><y>#</y><d>2017-07-25</d><h>21:32</h><w>gfredericks</w>according to the comments, my past self wasn&apos;t sure either</z><z id="t1501018363" t="gfredericks my guess is that identifying subtrees in a generic way might be difficult or impossible"><y>#</y><d>2017-07-25</d><h>21:32</h><w>gfredericks</w>my guess is that identifying subtrees in a generic way might be difficult or impossible</z><z id="t1501018381" t="gfredericks but I&apos;d be happy to be wrong about that"><y>#</y><d>2017-07-25</d><h>21:33</h><w>gfredericks</w>but I&apos;d be happy to be wrong about that</z><z id="t1501018686" t="moxaj I see"><y>#</y><d>2017-07-25</d><h>21:38</h><w>moxaj</w>I see</z><z id="t1501020112" t="peeja When is [:shrink :smallest] not a vector of one element?"><y>#</y><d>2017-07-25</d><h>22:01</h><w>peeja</w>When is <code>[:shrink :smallest]</code> not a vector of one element?</z><z id="t1501020119" t="peeja Or: why is it a vector?"><y>#</y><d>2017-07-25</d><h>22:01</h><w>peeja</w>Or: why is it a vector?</z><z id="t1501020469" t="gfredericks [:attrs {:href &quot;/_/_/users/U0F4Q1Q3E&quot;}] when the prop/for-all has multiple clauses, the vector has more elements"><y>#</y><d>2017-07-25</d><h>22:07</h><w>gfredericks</w><a>@peeja</a> when the <code>prop/for-all</code> has multiple clauses, the vector has more elements</z><z id="t1501020484" t="peeja Ah, that makes sense. Thanks!"><y>#</y><d>2017-07-25</d><h>22:08</h><w>peeja</w>Ah, that makes sense. Thanks!</z><z id="t1501079331" t="nberger [:attrs {:href &quot;/_/_/users/U0F4Q1Q3E&quot;}] : I&apos;d love to help finding that transducer. I&apos;ve been working on a refactoring that might be of help. The main idea is to make it easier to see the quick-check loop as a state machine. I think we could be closer to extract a transducer from there. The changes are in the test.check.refactor branch in my fork, let me know if you have any questions or comments"><y>#</y><d>2017-07-26</d><h>14:28</h><w>nberger</w><a>@peeja</a>: I&apos;d love to help finding that transducer. I&apos;ve been working on a refactoring that might be of help. The main idea is to make it easier to see the quick-check loop as a state machine. I think we could be closer to extract a transducer from there. The changes are in the <code>test.check.refactor</code> branch in my fork, let me know if you have any questions or comments</z><z id="t1501080247" t="nberger -- that&apos;s related to your message from a few days ago 🙂"><y>#</y><d>2017-07-26</d><h>14:44</h><w>nberger</w>-- that&apos;s related to your message from a few days ago <b>🙂</b></z><z id="t1501706977" t="cddr How might you go about writing a generator of sequences of numbers which add up to n ?"><y>#</y><d>2017-08-02</d><h>20:49</h><w>cddr</w>How might you go about writing a generator of sequences of numbers which add up to <code>n</code>?</z><z id="t1501707085" t="gfredericks [:attrs {:href &quot;/_/_/users/U065JNAN8&quot;}] depends what kind of distribution you want"><y>#</y><d>2017-08-02</d><h>20:51</h><w>gfredericks</w><a>@cddr</a> depends what kind of distribution you want</z><z id="t1501707119" t="gfredericks the easy dumb way to do it is to generate a sequence of numbers and then append (- n sum) to them"><y>#</y><d>2017-08-02</d><h>20:51</h><w>gfredericks</w>the easy dumb way to do it is to generate a sequence of numbers and then append <code>(- n sum)</code> to them</z><z id="t1501707158" t="gfredericks also depends on what kind of numbers you mean"><y>#</y><d>2017-08-02</d><h>20:52</h><w>gfredericks</w>also depends on what kind of numbers you mean</z><z id="t1501707249" t="cddr This is related to my question over in #clojure-spec about a having relations between a top-level amount, and children that should add up to that amount https://clojurians.slack.com/archives/C1B1BB2Q3/p1501686285791508"><y>#</y><d>2017-08-02</d><h>20:54</h><w>cddr</w>This is related to my question over in #clojure-spec about a having relations between a top-level amount, and children that should add up to that amount

<a href="https://clojurians.slack.com/archives/C1B1BB2Q3/p1501686285791508" target="_blank">https://clojurians.slack.com/archives/C1B1BB2Q3/p1501686285791508</a></z><z id="t1501707294" t="gfredericks would it be weird to not generate the top-level amount?"><y>#</y><d>2017-08-02</d><h>20:54</h><w>gfredericks</w>would it be weird to not generate the top-level amount?</z><z id="t1501707309" t="gfredericks generate just the children, then set the top-level to the sum?"><y>#</y><d>2017-08-02</d><h>20:55</h><w>gfredericks</w>generate just the children, then set the top-level to the sum?</z><z id="t1501707518" t="cddr Yeah that was my first thought too. But then I thought I needed to solve this type of problem anyway but looking back at my code I can&apos;t remember why now 🙂"><y>#</y><d>2017-08-02</d><h>20:58</h><w>cddr</w>Yeah that was my first thought too. But then I thought I needed to solve this type of problem anyway but looking back at my code I can&apos;t remember why now <b>🙂</b></z><z id="t1501707575" t="cddr In the actual example there are a few more relationships between the top-level and the children"><y>#</y><d>2017-08-02</d><h>20:59</h><w>cddr</w>In the actual example there are a few more relationships between the top-level and the children</z><z id="t1501708094" t="gfredericks a very useful tactic as generating something related to what you want, and using gen/fmap to transform it"><y>#</y><d>2017-08-02</d><h>21:08</h><w>gfredericks</w>a very useful tactic as generating something related to what you want, and using <code>gen/fmap</code> to transform it</z><z id="t1501708122" t="gfredericks i.e., generate the information, then use fmap to get it into the right format"><y>#</y><d>2017-08-02</d><h>21:08</h><w>gfredericks</w>i.e., generate the information, then use <code>fmap</code> to get it into the right format</z><z id="t1502192682" t="gfredericks I&apos;ve occasionally had the idea of mitigating the &quot;some things don&apos;t shrink very well&quot; problem by allowing users to provide a fallback shrink strategy, where you just supply a function from x to a collection of smaller x s. Interestingly it looks like hedgehog has exactly that feature: https://hackage.haskell.org/package/hedgehog-0.5/docs/Hedgehog-Gen.html (see the shrink function)"><y>#</y><d>2017-08-08</d><h>11:44</h><w>gfredericks</w>I&apos;ve occasionally had the idea of mitigating the &quot;some things don&apos;t shrink very well&quot; problem by allowing users to provide a fallback shrink strategy, where you just supply a function from <code>x</code> to a collection of smaller <code>x</code>s.

Interestingly it looks like hedgehog has exactly that feature: <a href="https://hackage.haskell.org/package/hedgehog-0.5/docs/Hedgehog-Gen.html" target="_blank">https://hackage.haskell.org/package/hedgehog-0.5/docs/Hedgehog-Gen.html</a> (see the <code>shrink</code> function)</z><z id="t1502209686" t="lucasbradstreet Cool"><y>#</y><d>2017-08-08</d><h>16:28</h><w>lucasbradstreet</w>Cool</z><z id="t1502724083" t="frankitox Hi Frederick! Loved the lib, there&apos;s a couple of functions that I&apos;ve invented too for my project lol, but I think you took a much more clean approach."><y>#</y><d>2017-08-14</d><h>15:21</h><w>frankitox</w>Hi Frederick! Loved the lib, there&apos;s a couple of functions that I&apos;ve invented too for my project lol, but I think you took a much more clean approach.</z><z id="t1502724160" t="frankitox com.gfredericks.test.chuck.generators/string-from-regex can only be used in the JVM scope, right?"><y>#</y><d>2017-08-14</d><h>15:22</h><w>frankitox</w><code>com.gfredericks.test.chuck.generators/string-from-regex</code> can only be used in the JVM scope, right?</z><z id="t1502724223" t="gfredericks [:attrs {:href &quot;/_/_/users/U3UFFB420&quot;}] yes -- you&apos;ll see a pull request for a clojurescript port; I can&apos;t remember if it&apos;s usable or not"><y>#</y><d>2017-08-14</d><h>15:23</h><w>gfredericks</w><a>@franquito</a> yes -- you&apos;ll see a pull request for a clojurescript port; I can&apos;t remember if it&apos;s usable or not</z><z id="t1502724231" t="gfredericks if you end up trying it out, do leave feedback on that PR about how it goes"><y>#</y><d>2017-08-14</d><h>15:23</h><w>gfredericks</w>if you end up trying it out, do leave feedback on that PR about how it goes</z><z id="t1502724246" t="gfredericks I&apos;ve been meaning to review that PR for months now 😭"><y>#</y><d>2017-08-14</d><h>15:24</h><w>gfredericks</w>I&apos;ve been meaning to review that PR for months now <b>😭</b></z><z id="t1502724315" t="frankitox Oh, nice!"><y>#</y><d>2017-08-14</d><h>15:25</h><w>frankitox</w>Oh, nice!</z><z id="t1502724379" t="frankitox Well, then I&apos;ll give it a try and see what happens, I just need a simple regexp"><y>#</y><d>2017-08-14</d><h>15:26</h><w>frankitox</w>Well, then I&apos;ll give it a try and see what happens, I just need a simple regexp</z><z id="t1502724429" t="frankitox Haha I see! Yeah, It must be a huge pain to maintain some open source project"><y>#</y><d>2017-08-14</d><h>15:27</h><w>frankitox</w>Haha I see! Yeah, It must be a huge pain to maintain some open source project</z><z id="t1502724438" t="frankitox Apart from It&apos;s size"><y>#</y><d>2017-08-14</d><h>15:27</h><w>frankitox</w>Apart from It&apos;s size</z><z id="t1502724452" t="frankitox Its*"><y>#</y><d>2017-08-14</d><h>15:27</h><w>frankitox</w>Its*</z><z id="t1502736449" t="lucasbradstreet [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] did the fallback shrinking strategy end up going anywhere? I’ve actually used gen/return to prevent shrinking, and then shrunk manually myself in the past, so this is pretty interesting 🙂"><y>#</y><d>2017-08-14</d><h>18:47</h><w>lucasbradstreet</w><a>@gfredericks</a> did the fallback shrinking strategy end up going anywhere? I’ve actually used gen/return to prevent shrinking, and then shrunk manually myself in the past, so this is pretty interesting <b>🙂</b></z><z id="t1502736518" t="gfredericks [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] you prevented shrinking because it would spend a long time without getting very far?"><y>#</y><d>2017-08-14</d><h>18:48</h><w>gfredericks</w><a>@lucasbradstreet</a> you prevented shrinking because it would spend a long time without getting very far?</z><z id="t1502736625" t="lucasbradstreet Yeah, because testing my invariants was on the order of seconds, so I tried some more aggressive heuristics to reduce the search space."><y>#</y><d>2017-08-14</d><h>18:50</h><w>lucasbradstreet</w>Yeah, because testing my invariants was on the order of seconds, so I tried some more aggressive heuristics to reduce the search space.</z><z id="t1502736641" t="lucasbradstreet Maybe not a very typical example that you want to allow for though 😛"><y>#</y><d>2017-08-14</d><h>18:50</h><w>lucasbradstreet</w>Maybe not a very typical example that you want to allow for though <b>😛</b></z><z id="t1502736819" t="gfredericks I&apos;ve been in that situation before, I don&apos;t want to disregard it"><y>#</y><d>2017-08-14</d><h>18:53</h><w>gfredericks</w>I&apos;ve been in that situation before, I don&apos;t want to disregard it</z><z id="t1502736863" t="gfredericks my initial thought is that a fallback shrink would never speed up shrinking since it would only try it after it&apos;s tried everything else"><y>#</y><d>2017-08-14</d><h>18:54</h><w>gfredericks</w>my initial thought is that a fallback shrink would never speed up shrinking since it would only try it after it&apos;s tried everything else</z><z id="t1502736880" t="gfredericks but I suppose you could disable the default shrinking first, which you&apos;re already doing"><y>#</y><d>2017-08-14</d><h>18:54</h><w>gfredericks</w>but I suppose you could disable the default shrinking first, which you&apos;re already doing</z><z id="t1502736886" t="lucasbradstreet Ahhh. I missed that aspect of the word “fallback”"><y>#</y><d>2017-08-14</d><h>18:54</h><w>lucasbradstreet</w>Ahhh. I missed that aspect of the word “fallback”</z><z id="t1502736909" t="gfredericks [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] also FYI with a mild amount of assuming-implementation-details, you can do this already"><y>#</y><d>2017-08-14</d><h>18:55</h><w>gfredericks</w><a>@lucasbradstreet</a> also FYI with a mild amount of assuming-implementation-details, you can do this already</z><z id="t1502736977" t="gfredericks so if you want to try it out that would be informative for me"><y>#</y><d>2017-08-14</d><h>18:56</h><w>gfredericks</w>so if you want to try it out that would be informative for me</z><z id="t1502737114" t="lucasbradstreet Can you point me to where I should look?"><y>#</y><d>2017-08-14</d><h>18:58</h><w>lucasbradstreet</w>Can you point me to where I should look?</z><z id="t1502737130" t="gfredericks [:attrs {:href &quot;/_/_/users/U050Z29EM&quot;}] are you familiar with the idea of a shrink tree?"><y>#</y><d>2017-08-14</d><h>18:58</h><w>gfredericks</w><a>@lucasbradstreet</a> are you familiar with the idea of a shrink tree?</z><z id="t1502737139" t="lucasbradstreet At a high level yes."><y>#</y><d>2017-08-14</d><h>18:58</h><w>lucasbradstreet</w>At a high level yes.</z><z id="t1502737220" t="gfredericks the simpler thing is writing replace-shrink , that takes [g f] where f is a function from x to [x]"><y>#</y><d>2017-08-14</d><h>19:00</h><w>gfredericks</w>the simpler thing is writing <code>replace-shrink</code>, that takes <code>[g f]</code> where <code>f</code> is a function from <code>x</code> to <code>[x]</code></z><z id="t1502737227" t="lucasbradstreet Can’t say I’ve looked into exactly how rose trees work though."><y>#</y><d>2017-08-14</d><h>19:00</h><w>lucasbradstreet</w>Can’t say I’ve looked into exactly how rose trees work though.</z><z id="t1502737255" t="gfredericks it&apos;s just a tree of values; the root is the generated value, and the child of any node are the shrinks from that point"><y>#</y><d>2017-08-14</d><h>19:00</h><w>gfredericks</w>it&apos;s just a tree of values; the root is the generated value, and the child of any node are the shrinks from that point</z><z id="t1502737266" t="gfredericks and it&apos;s lazy because it&apos;s huge"><y>#</y><d>2017-08-14</d><h>19:01</h><w>gfredericks</w>and it&apos;s lazy because it&apos;s huge</z><z id="t1502737268" t="lucasbradstreet OK"><y>#</y><d>2017-08-14</d><h>19:01</h><w>lucasbradstreet</w>OK</z><z id="t1502737299" t="gfredericks so writing replace-shrink just involves figuring out the exact functions to call, and the algorithm that transforms x and f into a lazy tree"><y>#</y><d>2017-08-14</d><h>19:01</h><w>gfredericks</w>so writing <code>replace-shrink</code> just involves figuring out the exact functions to call, and the algorithm that transforms <code>x</code> and <code>f</code> into a lazy tree</z><z id="t1502737357" t="lucasbradstreet OK, with you up to here."><y>#</y><d>2017-08-14</d><h>19:02</h><w>lucasbradstreet</w>OK, with you up to here.</z><z id="t1502737375" t="gfredericks I&apos;ll spit something out real quick that will probably work"><y>#</y><d>2017-08-14</d><h>19:02</h><w>gfredericks</w>I&apos;ll spit something out real quick that will probably work</z><z id="t1502737473" t="lucasbradstreet Cool. I can set aside some time later today to give it some testing "><y>#</y><d>2017-08-14</d><h>19:04</h><w>lucasbradstreet</w>Cool. I can set aside some time later today to give it some testing </z><z id="t1502737497" t="gfredericks ⇑ just off the top of my head, I didn&apos;t run it or compile it or parse it or anything"><y>#</y><d>2017-08-14</d><h>19:04</h><w>gfredericks</w>⇑ just off the top of my head, I didn&apos;t run it or compile it or parse it or anything</z><z id="t1502737509" t="lucasbradstreet Sure thing :)"><y>#</y><d>2017-08-14</d><h>19:05</h><w>lucasbradstreet</w>Sure thing :)</z><z id="t1502737521" t="gfredericks but that should at least point you to the right functions, which would be the hard part otherwise"><y>#</y><d>2017-08-14</d><h>19:05</h><w>gfredericks</w>but that should at least point you to the right functions, which would be the hard part otherwise</z><z id="t1502737546" t="gfredericks feel free to ping me if you try it and can&apos;t get it to work"><y>#</y><d>2017-08-14</d><h>19:05</h><w>gfredericks</w>feel free to ping me if you try it and can&apos;t get it to work</z><z id="t1502737566" t="lucasbradstreet Will do. Thanks!"><y>#</y><d>2017-08-14</d><h>19:06</h><w>lucasbradstreet</w>Will do. Thanks!</z><z id="t1503183572" t="nwjsmith Is there a way to prevent test.check from printing to standard out on a clojure.test test run"><y>#</y><d>2017-08-19</d><h>22:59</h><w>nwjsmith</w>Is there a way to prevent test.check from printing to standard out on a clojure.test test run</z><z id="t1503183573" t="nwjsmith ?"><y>#</y><d>2017-08-19</d><h>22:59</h><w>nwjsmith</w>?</z><z id="t1503183745" t="gfredericks There&apos;s a ticket for that, I can&apos;t remember what state its in. But until that&apos;s through, only monkey-patching"><y>#</y><d>2017-08-19</d><h>23:02</h><w>gfredericks</w>There&apos;s a ticket for that, I can&apos;t remember what state its in. But until that&apos;s through, only monkey-patching</z><z id="t1503183781" t="nwjsmith ah, ok. Thanks Gary."><y>#</y><d>2017-08-19</d><h>23:03</h><w>nwjsmith</w>ah, ok. Thanks Gary.</z><z id="t1503183983" t="gfredericks You&apos;ll see an obvious prn call at the top of the clojure-test ns"><y>#</y><d>2017-08-19</d><h>23:06</h><w>gfredericks</w>You&apos;ll see an obvious prn call at the top of the clojure-test ns</z><z id="t1504128154" t="gfredericks I just realized you could parallelize the shrinking process using something like a branch predictor"><y>#</y><d>2017-08-30</d><h>21:22</h><w>gfredericks</w>I just realized you could parallelize the shrinking process using something like a branch predictor</z><z id="t1504128325" t="gfredericks but it could be more complex than a traditional branch predictor since you can execute multiple possibilities in parallel"><y>#</y><d>2017-08-30</d><h>21:25</h><w>gfredericks</w>but it could be more complex than a traditional branch predictor since you can execute multiple possibilities in parallel</z><z id="t1504128679" t="gfredericks the search strategies used in chess programs seem a bit related too, though maybe not helpfully"><y>#</y><d>2017-08-30</d><h>21:31</h><w>gfredericks</w>the search strategies used in chess programs seem a bit related too, though maybe not helpfully</z><z id="t1504185170" t="nberger That sounds pretty cool, parallel shrinking would be a neat feature"><y>#</y><d>2017-08-31</d><h>13:12</h><w>nberger</w>That sounds pretty cool, parallel shrinking would be a neat feature</z><z id="t1505300044" t="thedavidmeister hey, is there something generated by clojure.test.check.generators/any that can break the output of the test runner?"><y>#</y><d>2017-09-13</d><h>10:54</h><w>thedavidmeister</w>hey, is there something generated by <code>clojure.test.check.generators/any</code> that can break the output of the test runner?</z><z id="t1505300051" t="thedavidmeister i got this fail"><y>#</y><d>2017-09-13</d><h>10:54</h><w>thedavidmeister</w>i got this fail</z><z id="t1505300055" t="thedavidmeister FAIL in (??round-trip) (:) expected: (= e (parse (string d))) actual: (not (= [[&quot;_Iq1WSpRhKoq+0M?1?!CV-I+GD-ul?s**R?!*!6arO*hmmz!&quot; &quot;6KnðåómÔ(OD{hl$g\tÉ\&quot;²Å¹Þˆß’&quot; &quot;6 "><y>#</y><d>2017-09-13</d><h>10:54</h><w>thedavidmeister</w><pre>FAIL in (??round-trip) (:)
expected: (= e (parse (string d)))
  actual: (not (= [[&quot;_Iq1WSpRhKoq+0M?1?!CV-I+GD-ul?s**R?!*!6arO*hmmz!&quot; &quot;6KnðåómÔ(OD{hl$g\tÉ\&quot;²Å¹Þˆß’&quot; &quot;6
</pre></z><z id="t1505300083" t="thedavidmeister it&apos;s like the string somehow didn&apos;t finish or something"><y>#</y><d>2017-09-13</d><h>10:54</h><w>thedavidmeister</w>it&apos;s like the string somehow didn&apos;t finish or something</z><z id="t1505300157" t="gfredericks the string not finishing smells more like your output was truncated somehow"><y>#</y><d>2017-09-13</d><h>10:55</h><w>gfredericks</w>the string not finishing smells more like your output was truncated somehow</z><z id="t1505300193" t="gfredericks the worst thing about gen/any that could cause problems is that it can generate NaN s deep in the nested structure"><y>#</y><d>2017-09-13</d><h>10:56</h><w>gfredericks</w>the worst thing about <code>gen/any</code> that could cause problems is that it can generate <code>NaN</code>s deep in the nested structure</z><z id="t1505300216" t="gfredericks which causes the whole thing to not equal itself, but maybe only under certain conditions"><y>#</y><d>2017-09-13</d><h>10:56</h><w>gfredericks</w>which causes the whole thing to not equal itself, but maybe only under certain conditions</z><z id="t1505300232" t="thedavidmeister mmm"><y>#</y><d>2017-09-13</d><h>10:57</h><w>thedavidmeister</w>mmm</z><z id="t1505300282" t="thedavidmeister FAIL in (??round-trip) (:)expected: (= e (parse (string d))) actual: (not (= [[&quot;_Iq1WSpRhKoq+0M?1?!CV-I+GD-ul?s**R?!*!6arO*hmmz!&quot; &quot;6KnðåómÔ(OD{hl$g\tÉ\&quot;²Å¹Þˆß’&quot; &quot;6Testing wheel.stylesheet.hoplon"><y>#</y><d>2017-09-13</d><h>10:58</h><w>thedavidmeister</w><code>FAIL in (??round-trip) (:)expected: (= e (parse (string d)))  actual: (not (= [[&quot;_Iq1WSpRhKoq+0M?1?!CV-I+GD-ul?s**R?!*!6arO*hmmz!&quot; &quot;6KnðåómÔ(OD{hl$g\tÉ\&quot;²Å¹Þˆß’&quot; &quot;6Testing wheel.stylesheet.hoplon</code></z><z id="t1505300287" t="thedavidmeister it just stops..."><y>#</y><d>2017-09-13</d><h>10:58</h><w>thedavidmeister</w>it just stops...</z><z id="t1505300295" t="thedavidmeister and goes straight into the next test"><y>#</y><d>2017-09-13</d><h>10:58</h><w>thedavidmeister</w>and goes straight into the next test</z><z id="t1505300336" t="gfredericks you could bypass the test runner &amp; printing by calling clojure.test.check/quick-check directly with your property and inspecting the return value"><y>#</y><d>2017-09-13</d><h>10:58</h><w>gfredericks</w>you could bypass the test runner &amp; printing by calling <code>clojure.test.check/quick-check</code> directly with your property and inspecting the return value</z><z id="t1505300383" t="thedavidmeister yeah, also i think what you said about NaN is going to derail me anyway"><y>#</y><d>2017-09-13</d><h>10:59</h><w>thedavidmeister</w>yeah, also i think what you said about <code>NaN</code> is going to derail me anyway</z><z id="t1505300415" t="thedavidmeister i might need a different approach"><y>#</y><d>2017-09-13</d><h>11:00</h><w>thedavidmeister</w>i might need a different approach</z><z id="t1507254899" t="nwjsmith How would one generate a byte array of a specific length?"><y>#</y><d>2017-10-06</d><h>01:54</h><w>nwjsmith</w>How would one generate a byte array of a specific length?</z><z id="t1507255145" t="nwjsmith I’m a dingus, just found byte ."><y>#</y><d>2017-10-06</d><h>01:59</h><w>nwjsmith</w>I’m a dingus, just found <code>byte</code>.</z><z id="t1507998527" t="nwjsmith I have a function that takes as input a large set of uniformly distributed random numbers and a directed, acyclic graph. It returns a random topological ordering of the graph. I’d like to hook this into test.check such that if I run test.check/quick-check twice with the same seed parameter then the same topological orderings will be generated."><y>#</y><d>2017-10-14</d><h>16:28</h><w>nwjsmith</w>I have a function that takes as input a large set of uniformly distributed random numbers and a directed, acyclic graph. It returns a random topological ordering of the graph.

I’d like to hook this into <code>test.check</code> such that if I run <code>test.check/quick-check</code> twice with the same seed parameter then the same topological orderings will be generated.</z><z id="t1507998570" t="nwjsmith As I understand it, test.check ’s generators and combinators are designed to keep me from having to see the underlying RNG"><y>#</y><d>2017-10-14</d><h>16:29</h><w>nwjsmith</w>As I understand it, <code>test.check</code>’s generators and combinators are designed to keep me from having to see the underlying RNG</z><z id="t1507998657" t="nwjsmith and that’s worked really well until now, when I need a lot of uniformly distributed random numbers"><y>#</y><d>2017-10-14</d><h>16:30</h><w>nwjsmith</w>and that’s worked really well until now, when I need a lot of uniformly distributed random numbers</z><z id="t1507998742" t="nwjsmith Is the test.check.generators/-&gt;Generator function considered part of the public API?"><y>#</y><d>2017-10-14</d><h>16:32</h><w>nwjsmith</w>Is the <code>test.check.generators/-&gt;Generator</code> function considered part of the public API?</z><z id="t1507998810" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] so if you had a generator for uniformly distributed random numbers, would that solve it?"><y>#</y><d>2017-10-14</d><h>16:33</h><w>gfredericks</w><a>@nwjsmith</a> so if you had a generator for uniformly distributed random numbers, would that solve it?</z><z id="t1507998982" t="nwjsmith [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] yes, that would work beautifully"><y>#</y><d>2017-10-14</d><h>16:36</h><w>nwjsmith</w><a>@gfredericks</a> yes, that would work beautifully</z><z id="t1507999051" t="nwjsmith Then I could do a (gen/vector (gen/rand-int max) num-elements) and fmap my random-topological-ordering over it"><y>#</y><d>2017-10-14</d><h>16:37</h><w>nwjsmith</w>Then I could do a <code>(gen/vector (gen/rand-int max) num-elements)</code> and <code>fmap</code> my <code>random-topological-ordering</code> over it</z><z id="t1508000110" t="nwjsmith (def gen-rand-double (gen/no-shrink (gen/-&gt;Generator (fn [rnd _size] (rose/pure (random/rand-double rnd)))))) ?"><y>#</y><d>2017-10-14</d><h>16:55</h><w>nwjsmith</w><pre>(def gen-rand-double
  (gen/no-shrink
   (gen/-&gt;Generator
    (fn [rnd _size]
      (rose/pure (random/rand-double rnd))))))
</pre>
?</z><z id="t1508000285" t="nwjsmith Ah, there’s random/rand-long . (def gen-rand-long (gen/no-shrink (gen/-&gt;Generator (fn [rnd _size] (rose/pure (random/rand-long rnd)))))) (gen/generate (gen/vector gen-rand-long) 10 100) ;; =&gt; [6200754525179398429 -3542882520031353397] (gen/generate (gen/vector gen-rand-long) 10 100) ;; =&gt; [6200754525179398429 -3542882520031353397] "><y>#</y><d>2017-10-14</d><h>16:58</h><w>nwjsmith</w>Ah, there’s <code>random/rand-long</code>.

<pre>(def gen-rand-long
  (gen/no-shrink
   (gen/-&gt;Generator
    (fn [rnd _size]
      (rose/pure (random/rand-long rnd))))))

(gen/generate (gen/vector gen-rand-long) 10 100) ;; =&gt; [6200754525179398429 -3542882520031353397]
(gen/generate (gen/vector gen-rand-long) 10 100) ;; =&gt; [6200754525179398429 -3542882520031353397]
</pre></z><z id="t1508000315" t="nwjsmith That seems to do the trick"><y>#</y><d>2017-10-14</d><h>16:58</h><w>nwjsmith</w>That seems to do the trick</z><z id="t1508000475" t="nwjsmith I’m not really sure what the effects of no-shrink are here, or what rose/pure is doing. I’ll have to watch you’re old talk again to brush up on the internals."><y>#</y><d>2017-10-14</d><h>17:01</h><w>nwjsmith</w>I’m not really sure what the effects of <code>no-shrink</code> are here, or what <code>rose/pure</code> is doing. I’ll have to watch you’re old talk again to brush up on the internals.</z><z id="t1508000537" t="nwjsmith Your talk from this week was fantastic by the way, really good guide to building custom generators."><y>#</y><d>2017-10-14</d><h>17:02</h><w>nwjsmith</w>Your talk from this week was fantastic by the way, really good guide to building custom generators.</z><z id="t1508000641" t="gfredericks (also, why do they have to be uniformly distributed?)"><y>#</y><d>2017-10-14</d><h>17:04</h><w>gfredericks</w>(also, why do they have to be uniformly distributed?)</z><z id="t1508000718" t="nwjsmith http://alexander-karzanov.net/Publications/91_LEO11_N.pdf"><y>#</y><d>2017-10-14</d><h>17:05</h><w>nwjsmith</w><a href="http://alexander-karzanov.net/Publications/91_LEO11_N.pdf" target="_blank">http://alexander-karzanov.net/Publications/91_LEO11_N.pdf</a></z><z id="t1508000767" t="nwjsmith the algorithm is on page 2. I’ve got to generate a large number of random swaps of a topological ordering."><y>#</y><d>2017-10-14</d><h>17:06</h><w>nwjsmith</w>the algorithm is on page 2. I’ve got to generate a large number of random swaps of a topological ordering.</z><z id="t1508000779" t="nwjsmith (the bottom of page 2)"><y>#</y><d>2017-10-14</d><h>17:06</h><w>nwjsmith</w>(the bottom of page 2)</z><z id="t1508000866" t="nwjsmith At first I tried gen/choose , but I ended up with really bad distributions on the generator."><y>#</y><d>2017-10-14</d><h>17:07</h><w>nwjsmith</w>At first I tried <code>gen/choose</code>, but I ended up with really bad distributions on the generator.</z><z id="t1508000942" t="gfredericks Choose is uniform, unlike most other builtin generators"><y>#</y><d>2017-10-14</d><h>17:09</h><w>gfredericks</w>Choose is uniform, unlike most other builtin generators</z><z id="t1508000975" t="nwjsmith Hrm. Maybe I just thought I’d end up with really bad distributions"><y>#</y><d>2017-10-14</d><h>17:09</h><w>nwjsmith</w>Hrm. Maybe I just thought I’d end up with really bad distributions</z><z id="t1508000990" t="nwjsmith I’ll try choose again."><y>#</y><d>2017-10-14</d><h>17:09</h><w>nwjsmith</w>I’ll try choose again.</z><z id="t1508000993" t="gfredericks no-shrink is a noop in your code I believe"><y>#</y><d>2017-10-14</d><h>17:09</h><w>gfredericks</w>no-shrink is a noop in your code I believe</z><z id="t1508001072" t="gfredericks You need uniform ints or doubles?"><y>#</y><d>2017-10-14</d><h>17:11</h><w>gfredericks</w>You need uniform ints or doubles?</z><z id="t1508001083" t="nwjsmith ints"><y>#</y><d>2017-10-14</d><h>17:11</h><w>nwjsmith</w>ints</z><z id="t1508001092" t="gfredericks What range?"><y>#</y><d>2017-10-14</d><h>17:11</h><w>gfredericks</w>What range?</z><z id="t1508001166" t="nwjsmith between 0 and 2n-1, where n is the number of nodes in the graph."><y>#</y><d>2017-10-14</d><h>17:12</h><w>nwjsmith</w>between 0 and 2n-1, where n is the number of nodes in the graph.</z><z id="t1508001185" t="gfredericks Oooh, yeah, choose is bad for large n"><y>#</y><d>2017-10-14</d><h>17:13</h><w>gfredericks</w>Oooh, yeah, choose is bad for large n</z><z id="t1508001263" t="gfredericks Foolproof is (gen/vector (gen/choose 0 1) n), then fmap the bits to a bigint"><y>#</y><d>2017-10-14</d><h>17:14</h><w>gfredericks</w>Foolproof is (gen/vector (gen/choose 0 1) n), then fmap the bits to a bigint</z><z id="t1508001341" t="gfredericks But even if the algorithm demands uniform, I&apos;m curious if testing with a nonuniform generator would actually be bad"><y>#</y><d>2017-10-14</d><h>17:15</h><w>gfredericks</w>But even if the algorithm demands uniform, I&apos;m curious if testing with a nonuniform generator would actually be bad</z><z id="t1508001576" t="gfredericks But either way, there&apos;s no builtin bigint generator yet, which makes it harder for you :("><y>#</y><d>2017-10-14</d><h>17:19</h><w>gfredericks</w>But either way, there&apos;s no builtin bigint generator yet, which makes it harder for you :(</z><z id="t1508001807" t="nwjsmith Putting it together with the approach you suggested should work though. I’m going to experiment a bit with all of the approaches above. Will report back."><y>#</y><d>2017-10-14</d><h>17:23</h><w>nwjsmith</w>Putting it together with the approach you suggested should work though. I’m going to experiment a bit with all of the approaches above. Will report back.</z><z id="t1508001836" t="nwjsmith BTW do you have a strategy for testing generators? Specifically how they shrink, their distribution, performance etc."><y>#</y><d>2017-10-14</d><h>17:23</h><w>nwjsmith</w>BTW do you have a strategy for testing generators? Specifically how they shrink, their distribution, performance etc.</z><z id="t1508001972" t="nwjsmith Experimenting at the REPL has been working for me, but now I have all of these useful graph-related generators and I’m hoping to open source them. Might have to come up with my own strategy."><y>#</y><d>2017-10-14</d><h>17:26</h><w>nwjsmith</w>Experimenting at the REPL has been working for me, but now I have all of these useful graph-related generators and I’m hoping to open source them. Might have to come up with my own strategy.</z><z id="t1508002897" t="gfredericks No, that&apos;s an interesting idea. You can see examples in the tests of testing distribution &amp; shrinking a bit, but it&apos;s all ad-hoc"><y>#</y><d>2017-10-14</d><h>17:41</h><w>gfredericks</w>No, that&apos;s an interesting idea. You can see examples in the tests of testing distribution &amp; shrinking a bit, but it&apos;s all ad-hoc</z><z id="t1508002908" t="gfredericks Shrinking is particularly weird to test"><y>#</y><d>2017-10-14</d><h>17:41</h><w>gfredericks</w>Shrinking is particularly weird to test</z><z id="t1508002921" t="gfredericks Maybe..."><y>#</y><d>2017-10-14</d><h>17:42</h><w>gfredericks</w>Maybe...</z><z id="t1509641396" t="ghadi Is there any relationship between procedural generation techniques for computer graphics and test check generators? I&apos;m thinking in relation to stuff like Perlin noise"><y>#</y><d>2017-11-02</d><h>16:49</h><w>ghadi</w>Is there any relationship between procedural generation techniques for computer graphics and test check generators?  I&apos;m thinking in relation to stuff like Perlin noise</z><z id="t1509665182" t="gfredericks I&apos;ve generally been skeptical of using test.check generators for anything very far from testing (though I might be too deep into it to think more creatively) The primary reason is that the distributions are generally skewed with edge-case heuristics"><y>#</y><d>2017-11-02</d><h>23:26</h><w>gfredericks</w>I&apos;ve generally been skeptical of using test.check generators for anything very far from testing (though I might be too deep into it to think more creatively)

The primary reason is that the distributions are generally skewed with edge-case heuristics</z><z id="t1509677006" t="ghadi Oh, I meant the opposite: using techniques from procedural generation to inform the way generators explore the search space "><y>#</y><d>2017-11-03</d><h>02:43</h><w>ghadi</w>Oh, I meant the opposite: using techniques from procedural generation to inform the way generators explore the search space </z><z id="t1509677089" t="ghadi I know next to nothing about procgen, except that it is a large topic filled with interesting heuristics"><y>#</y><d>2017-11-03</d><h>02:44</h><w>ghadi</w>I know next to nothing about procgen, except that it is a large topic filled with interesting heuristics</z><z id="t1509677126" t="ghadi Like making trees look realistic. My coworker was describing Perlin noise today, and a lightbulb went off"><y>#</y><d>2017-11-03</d><h>02:45</h><w>ghadi</w>Like making trees look realistic.  My coworker was describing Perlin noise today, and a lightbulb went off</z><z id="t1509978209" t="gfredericks How do folks feel about test.check printing success summaries? I&apos;m processing a patch that makes this configurable, but didn&apos;t know whether it should stay on by default, since I don&apos;t know how many people like it."><y>#</y><d>2017-11-06</d><h>14:23</h><w>gfredericks</w>How do folks feel about test.check printing success summaries?

I&apos;m processing a patch that makes this configurable, but didn&apos;t know whether it should stay on by default, since I don&apos;t know how many people like it.</z><z id="t1509990965" t="lucasbradstreet I think I’d like it."><y>#</y><d>2017-11-06</d><h>17:56</h><w>lucasbradstreet</w>I think I’d like it.</z><z id="t1509992615" t="gfredericks To be clear, it already does this."><y>#</y><d>2017-11-06</d><h>18:23</h><w>gfredericks</w>To be clear, it already does this.</z><z id="t1509993005" t="gfredericks And currently it&apos;s not configurable I&apos;m trying to decide between A) make it configurable, defaulting to on B) make it configurable, defaulting to off"><y>#</y><d>2017-11-06</d><h>18:30</h><w>gfredericks</w>And currently it&apos;s not configurable

I&apos;m trying to decide between
A) make it configurable, defaulting to on
B) make it configurable, defaulting to off</z><z id="t1509993240" t="lucasbradstreet Oh, you mean printing the current summaries? Ah, I misread it. I think I prefer defaulting to on, especially since it’s the current behaviour."><y>#</y><d>2017-11-06</d><h>18:34</h><w>lucasbradstreet</w>Oh, you mean printing the current summaries? Ah, I misread it. I think I prefer defaulting to on, especially since it’s the current behaviour.</z><z id="t1509994616" t="mattly [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] can you provide an example of what you mean? I’m not entirely clear by “success sumaries”"><y>#</y><d>2017-11-06</d><h>18:56</h><w>mattly</w><a>@gfredericks</a> can you provide an example of what you mean? I’m not entirely clear by “success sumaries”</z><z id="t1509995103" t="gfredericks This is a defspec thing in particular Right now when a defspec test runs, and passes, it prints something like: {:result true, :num-tests 500, :seed 1509994998441, :test-var &quot;the-name-of-my-test&quot;} "><y>#</y><d>2017-11-06</d><h>19:05</h><w>gfredericks</w>This is a <code>defspec</code> thing in particular

Right now when a <code>defspec</code> test runs, and passes, it prints something like:

<pre>{:result true, :num-tests 500, :seed 1509994998441, :test-var &quot;the-name-of-my-test&quot;}
</pre></z><z id="t1509995134" t="gfredericks you can compare this to the behavior of a regular clojure.test test, which prints nothing on success"><y>#</y><d>2017-11-06</d><h>19:05</h><w>gfredericks</w>you can compare this to the behavior of a regular <code>clojure.test</code> test, which prints nothing on success</z><z id="t1510003795" t="mattly interesting. Is defspec new?"><y>#</y><d>2017-11-06</d><h>21:29</h><w>mattly</w>interesting. Is <code>defspec</code> new?</z><z id="t1510007855" t="gfredericks no, defspec is the standard clojure.test integration that&apos;s been around for quite a while"><y>#</y><d>2017-11-06</d><h>22:37</h><w>gfredericks</w>no, <code>defspec</code> is the standard <code>clojure.test</code> integration that&apos;s been around for quite a while</z><z id="t1510011147" t="mattly ah, I guess I’ve only really ever used test.check in the context of test.chuck’s checking"><y>#</y><d>2017-11-06</d><h>23:32</h><w>mattly</w>ah, I guess I’ve only really ever used test.check in the context of test.chuck’s <code>checking</code></z><z id="t1510011199" t="gfredericks Try to say &quot;test.check in the context of test.chuck&apos;s checking&quot; five times fast"><y>#</y><d>2017-11-06</d><h>23:33</h><w>gfredericks</w>Try to say &quot;test.check in the context of test.chuck&apos;s checking&quot; five times fast</z><z id="t1510011278" t="mattly 😄"><y>#</y><d>2017-11-06</d><h>23:34</h><w>mattly</w><b>😄</b></z><z id="t1510014884" t="aj taylor I&apos;d say default to on, but it may be just because I&apos;m used to it ha"><y>#</y><d>2017-11-07</d><h>00:34</h><w>aj taylor</w>I&apos;d say default to on, but it may be just because I&apos;m used to it ha</z><z id="t1510015089" t="aj taylor Also since each test is running multiple times it&apos;s nice to have an idea of what&apos;s currently being executed (even though I could just configure it I guess with that update)"><y>#</y><d>2017-11-07</d><h>00:38</h><w>aj taylor</w>Also since each test is running multiple times it&apos;s nice to have an idea of what&apos;s currently being executed (even though I could just configure it I guess with that update)</z><z id="t1510015278" t="gfredericks It&apos;s good to know that some people like it. I was mainly considering changing the default because I was assuming basically nobody liked it"><y>#</y><d>2017-11-07</d><h>00:41</h><w>gfredericks</w>It&apos;s good to know that some people like it. I was mainly considering changing the default because I was assuming basically nobody liked it</z><z id="t1510015302" t="gfredericks If it&apos;s roughly split I&apos;ll probably keep the default since that&apos;s less confusing"><y>#</y><d>2017-11-07</d><h>00:41</h><w>gfredericks</w>If it&apos;s roughly split I&apos;ll probably keep the default since that&apos;s less confusing</z><z id="t1510318246" t="borkdude How can I get a sequence of random numbers by providing a seed in clojure.test.check?"><y>#</y><d>2017-11-10</d><h>12:50</h><w>borkdude</w>How can I get a sequence of random numbers by providing a seed in clojure.test.check?</z><z id="t1510318351" t="gfredericks what sort of numbers?"><y>#</y><d>2017-11-10</d><h>12:52</h><w>gfredericks</w>what sort of numbers?</z><z id="t1510318412" t="gfredericks if you want to just use the raw RNG code it&apos;s pretty easy (map random/rand-long (random/split-n (random/make-random seed) 500))"><y>#</y><d>2017-11-10</d><h>12:53</h><w>gfredericks</w>if you want to just use the raw RNG code it&apos;s pretty easy

<code>(map random/rand-long (random/split-n (random/make-random seed) 500))</code></z><z id="t1510318429" t="borkdude thanks"><y>#</y><d>2017-11-10</d><h>12:53</h><w>borkdude</w>thanks</z><z id="t1510318463" t="gfredericks if you are using this for PBT I would probably recommend using generators instead, or would be interested in why you can&apos;t"><y>#</y><d>2017-11-10</d><h>12:54</h><w>gfredericks</w>if you are using this for PBT I would probably recommend using generators instead, or would be interested in why you can&apos;t</z><z id="t1510318539" t="borkdude I would like to use this for some graphical algorithm which needs random numbers, but I want to make it deterministic"><y>#</y><d>2017-11-10</d><h>12:55</h><w>borkdude</w>I would like to use this for some graphical algorithm which needs random numbers, but I want to make it deterministic</z><z id="t1510318576" t="gfredericks okay cool; yeah if it&apos;s not for testing then using the RNG directly is perfectly fine"><y>#</y><d>2017-11-10</d><h>12:56</h><w>gfredericks</w>okay cool; yeah if it&apos;s not for testing then using the RNG directly is perfectly fine</z><z id="t1510330128" t="borkdude I’m looking for examples online but can’t find it. Is there a way that I can express that I want ints in a range using the generators + a custom seed?"><y>#</y><d>2017-11-10</d><h>16:08</h><w>borkdude</w>I’m looking for examples online but can’t find it. Is there a way that I can express that I want ints in a range using the generators + a custom seed?</z><z id="t1510330141" t="borkdude or do I have to convert longs to a range myself, which is also possible"><y>#</y><d>2017-11-10</d><h>16:09</h><w>borkdude</w>or do I have to convert longs to a range myself, which is also possible</z><z id="t1510330422" t="gfredericks the rng only generates raw uniform longs; if your range isn&apos;t close to 64 bits, I&apos;d just use mod to get what you want"><y>#</y><d>2017-11-10</d><h>16:13</h><w>gfredericks</w>the rng only generates raw uniform longs; if your range isn&apos;t close to 64 bits, I&apos;d just use <code>mod</code> to get what you want</z><z id="t1510330474" t="borkdude yeah, cool"><y>#</y><d>2017-11-10</d><h>16:14</h><w>borkdude</w>yeah, cool</z><z id="t1510330683" t="borkdude Is there a way to get around the fixed size 500 in (map (comp #(mod % 1000) r/rand-long) (r/split-n (r/make-random 2) 500)) so I can get a lazy sequence of these numbers or do I need to specify this up front always?"><y>#</y><d>2017-11-10</d><h>16:18</h><w>borkdude</w>Is there a way to get around the fixed size 500 in 
<code>(map (comp #(mod % 1000) r/rand-long) (r/split-n (r/make-random 2) 500))</code> so I can get a lazy sequence of these numbers or do I need to specify this up front always?</z><z id="t1510330770" t="borkdude I guess I can calculate this up front"><y>#</y><d>2017-11-10</d><h>16:19</h><w>borkdude</w>I guess I can calculate this up front</z><z id="t1510332307" t="gfredericks you can make an infinite lazy seq"><y>#</y><d>2017-11-10</d><h>16:45</h><w>gfredericks</w>you can make an infinite lazy seq</z><z id="t1510332319" t="gfredericks there&apos;s a private(?) function in generators.cljc that does this"><y>#</y><d>2017-11-10</d><h>16:45</h><w>gfredericks</w>there&apos;s a private(?) function in <code>generators.cljc</code> that does this</z><z id="t1510332324" t="gfredericks lazy-random-states or something to that effect"><y>#</y><d>2017-11-10</d><h>16:45</h><w>gfredericks</w><code>lazy-random-states</code> or something to that effect</z><z id="t1510332698" t="borkdude Cool: https://clojure.github.io/test.check/clojure.test.check.generators.html#var-lazy-random-states"><y>#</y><d>2017-11-10</d><h>16:51</h><w>borkdude</w>Cool: <a href="https://clojure.github.io/test.check/clojure.test.check.generators.html#var-lazy-random-states" target="_blank">https://clojure.github.io/test.check/clojure.test.check.generators.html#var-lazy-random-states</a></z><z id="t1510332939" t="borkdude So this would be it right? (take 2 (map random/rand-long (gen/lazy-random-states (random/make-random 2))))"><y>#</y><d>2017-11-10</d><h>16:55</h><w>borkdude</w>So this would be it right? <code>(take 2 (map random/rand-long (gen/lazy-random-states (random/make-random 2))))</code></z><z id="t1510333009" t="gfredericks yep"><y>#</y><d>2017-11-10</d><h>16:56</h><w>gfredericks</w>yep</z><z id="t1510846057" t="gfredericks if anybody is in the mood to do random tedious OSS work, I would like to upgrade the version of cljs that test.check depends on in its project.clj but doing it causes some failures due to changes in the cljs compiler API"><y>#</y><d>2017-11-16</d><h>15:27</h><w>gfredericks</w>if anybody is in the mood to do random tedious OSS work, I would like to upgrade the version of cljs that test.check depends on in its <code>project.clj</code> but doing it causes some failures due to changes in the cljs compiler API</z><z id="t1510846109" t="gfredericks (if you plan to work on that, let me know so I don&apos;t do it too)"><y>#</y><d>2017-11-16</d><h>15:28</h><w>gfredericks</w>(if you plan to work on that, let me know so I don&apos;t do it too)</z><z id="t1510846300" t="nwjsmith [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I&apos;m in, will take a look later today"><y>#</y><d>2017-11-16</d><h>15:31</h><w>nwjsmith</w><a>@gfredericks</a> I&apos;m in, will take a look later today</z><z id="t1510848817" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] thanks!"><y>#</y><d>2017-11-16</d><h>16:13</h><w>gfredericks</w><a>@nwjsmith</a> thanks!</z><z id="t1510928254" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] do you have a jira account?"><y>#</y><d>2017-11-17</d><h>14:17</h><w>gfredericks</w><a>@nwjsmith</a> do you have a jira account?</z></g><g id="s5"><z id="t1510928427" t="gfredericks In any case I just created https://dev.clojure.org/jira/browse/TCHECK-135"><y>#</y><d>2017-11-17</d><h>14:20</h><w>gfredericks</w>In any case I just created <a href="https://dev.clojure.org/jira/browse/TCHECK-135" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-135</a></z><z id="t1510930935" t="nwjsmith [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] yes! I&apos;m nwjsmith in Clojure JIRA, and I&apos;ve signed the CLA"><y>#</y><d>2017-11-17</d><h>15:02</h><w>nwjsmith</w><a>@gfredericks</a> yes! I&apos;m <code>nwjsmith</code> in Clojure JIRA, and I&apos;ve signed the CLA</z><z id="t1510931236" t="nwjsmith Feel free to assign that to me. I got the tests running on the latest CLJS last night, but the approach I took might require a larger overhaul of how the tests are currently run. Do you mind if I make some substantial changes in that area?"><y>#</y><d>2017-11-17</d><h>15:07</h><w>nwjsmith</w>Feel free to assign that to me.

I got the tests running on the latest CLJS last night, but the approach I took might require a larger overhaul of how the tests are currently run. Do you mind if I make some substantial changes in that area?</z><z id="t1510934550" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] if you&apos;re confident that your changes are making the orchestration more idiomatic for lein-cljsbuild setups, then that&apos;s fine with me"><y>#</y><d>2017-11-17</d><h>16:02</h><w>gfredericks</w><a>@nwjsmith</a> if you&apos;re confident that your changes are making the orchestration more idiomatic for lein-cljsbuild setups, then that&apos;s fine with me</z><z id="t1510934564" t="gfredericks I don&apos;t use modern cljs much at all so I can&apos;t easily judge those things"><y>#</y><d>2017-11-17</d><h>16:02</h><w>gfredericks</w>I don&apos;t use modern cljs much at all so I can&apos;t easily judge those things</z><z id="t1510934686" t="nwjsmith I&apos;m confident that&apos;s the case. Will be taking my lead from Om&apos;s test running and some stuff we have internally"><y>#</y><d>2017-11-17</d><h>16:04</h><w>nwjsmith</w>I&apos;m confident that&apos;s the case. Will be taking my lead from Om&apos;s test running and some stuff we have internally</z><z id="t1510934690" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] I see your user page, but the full-name-based dropdown that jira gives me on the ticket edit page does not have your name under &apos;Nate Smith&apos; or anything similar; seems like a bug, but perhaps you can assign it to yourself? /cc [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}]"><y>#</y><d>2017-11-17</d><h>16:04</h><w>gfredericks</w><a>@nwjsmith</a> I see your user page, but the full-name-based dropdown that jira gives me on the ticket edit page does not have your name under &apos;Nate Smith&apos; or anything similar; seems like a bug, but perhaps you can assign it to yourself?

/cc <a>@alexmiller</a></z><z id="t1510934750" t="nwjsmith Weird. Not sure if this helps but here&apos;s a ticket I&apos;m the reporter on: https://dev.clojure.org/jira/browse/CLJ-2079"><y>#</y><d>2017-11-17</d><h>16:05</h><w>nwjsmith</w>Weird. Not sure if this helps but here&apos;s a ticket I&apos;m the reporter on: <a href="https://dev.clojure.org/jira/browse/CLJ-2079" target="_blank">https://dev.clojure.org/jira/browse/CLJ-2079</a></z><z id="t1510934774" t="nwjsmith Can&apos;t assign myself unfortunately."><y>#</y><d>2017-11-17</d><h>16:06</h><w>nwjsmith</w>Can&apos;t assign myself unfortunately.</z><z id="t1510934918" t="gfredericks haha great"><y>#</y><d>2017-11-17</d><h>16:08</h><w>gfredericks</w>haha great</z><z id="t1510934969" t="gfredericks I&apos;ll just keep it assigned to myself ¯\(ツ)/¯"><y>#</y><d>2017-11-17</d><h>16:09</h><w>gfredericks</w>I&apos;ll just keep it assigned to myself ¯\(ツ)/¯</z><z id="t1510935712" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] if there are any other contrib projects with cljs tests, those would be an interesting comparison point"><y>#</y><d>2017-11-17</d><h>16:21</h><w>gfredericks</w><a>@nwjsmith</a> if there are any other contrib projects with cljs tests, those would be an interesting comparison point</z><z id="t1510935856" t="nwjsmith Good call, looks like tools.reader is a good example"><y>#</y><d>2017-11-17</d><h>16:24</h><w>nwjsmith</w>Good call, looks like tools.reader is a good example</z><z id="t1510936065" t="gfredericks core.async and spec.alpha sound plausible also"><y>#</y><d>2017-11-17</d><h>16:27</h><w>gfredericks</w>core.async and spec.alpha sound plausible also</z><z id="t1510936171" t="Alex Miller (Clojure team) [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] your user wasn’t in the right groups to do edit/assign - I fixed and assigned that ticket"><y>#</y><d>2017-11-17</d><h>16:29</h><w>Alex Miller (Clojure team)</w><a>@gfredericks</a> <a>@nwjsmith</a> your user wasn’t in the right groups to do edit/assign - I fixed and assigned that ticket</z><z id="t1510936188" t="nwjsmith Thanks Alex!"><y>#</y><d>2017-11-17</d><h>16:29</h><w>nwjsmith</w>Thanks Alex!</z><z id="t1510936212" t="Alex Miller (Clojure team) re cljs tests, note that the official build file for all contrib projects is the pom.xml (as that’s what the CI build uses)"><y>#</y><d>2017-11-17</d><h>16:30</h><w>Alex Miller (Clojure team)</w>re cljs tests, note that the official build file for all contrib projects is the pom.xml (as that’s what the CI build uses)</z><z id="t1510936249" t="Alex Miller (Clojure team) and the pom.xml uses clojure-maven-plugin which doesn’t know or understand cljs (at least in the version we are forced to use due to jvm and maven versions)"><y>#</y><d>2017-11-17</d><h>16:30</h><w>Alex Miller (Clojure team)</w>and the pom.xml uses clojure-maven-plugin which doesn’t know or understand cljs (at least in the version we are forced to use due to jvm and maven versions)</z><z id="t1510936281" t="Alex Miller (Clojure team) many projects have parallel project.clj files which people use to run cljs tests locally"><y>#</y><d>2017-11-17</d><h>16:31</h><w>Alex Miller (Clojure team)</w>many projects have parallel project.clj files which people use to run cljs tests locally</z><z id="t1510936305" t="Alex Miller (Clojure team) a few projects have started to experiment with ways to integrate these - I think data.xml is the most robust example of that"><y>#</y><d>2017-11-17</d><h>16:31</h><w>Alex Miller (Clojure team)</w>a few projects have started to experiment with ways to integrate these - I think data.xml is the most robust example of that</z><z id="t1510936354" t="gfredericks 👍 thanks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] "><y>#</y><d>2017-11-17</d><h>16:32</h><w>gfredericks</w><b>👍</b> thanks <a>@alexmiller</a> </z><z id="t1510936360" t="Alex Miller (Clojure team) it’s done by integrating the cljs tests into the clojure tests directly"><y>#</y><d>2017-11-17</d><h>16:32</h><w>Alex Miller (Clojure team)</w>it’s done by integrating the cljs tests into the clojure tests directly</z><z id="t1510936385" t="Alex Miller (Clojure team) in this area https://github.com/clojure/data.xml/tree/master/src/test/clojurescript/clojure/data/xml"><y>#</y><d>2017-11-17</d><h>16:33</h><w>Alex Miller (Clojure team)</w>in this area <a href="https://github.com/clojure/data.xml/tree/master/src/test/clojurescript/clojure/data/xml" target="_blank">https://github.com/clojure/data.xml/tree/master/src/test/clojurescript/clojure/data/xml</a></z><z id="t1510936410" t="Alex Miller (Clojure team) uses nashorn I believe"><y>#</y><d>2017-11-17</d><h>16:33</h><w>Alex Miller (Clojure team)</w>uses nashorn I believe</z><z id="t1510936634" t="gfredericks Oh interesting [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] if you go the nashorn route I think it&apos;d be good to maintain the ability to easily run with node as well"><y>#</y><d>2017-11-17</d><h>16:37</h><w>gfredericks</w>Oh interesting

<a>@nwjsmith</a> if you go the nashorn route I think it&apos;d be good to maintain the ability to easily run with node as well</z><z id="t1510936696" t="nwjsmith [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] oops I think I got assigned to the wrong ticket, should be TCHECK-135"><y>#</y><d>2017-11-17</d><h>16:38</h><w>nwjsmith</w><a>@alexmiller</a> oops I think I got assigned to the wrong ticket, should be TCHECK-135</z><z id="t1510936755" t="Alex Miller (Clojure team) oops! reading comprehension fail. fixed."><y>#</y><d>2017-11-17</d><h>16:39</h><w>Alex Miller (Clojure team)</w>oops! reading comprehension fail. fixed.</z><z id="t1510936775" t="nwjsmith Thanks"><y>#</y><d>2017-11-17</d><h>16:39</h><w>nwjsmith</w>Thanks</z><z id="t1510936859" t="nwjsmith I&apos;ll look into integrating the CLJS tests with the Clojure ones as well."><y>#</y><d>2017-11-17</d><h>16:40</h><w>nwjsmith</w>I&apos;ll look into integrating the CLJS tests with the Clojure ones as well.</z><z id="t1510937075" t="gfredericks getting the cljs tests to run via maven is a nice-to-have; if it&apos;s much harder, just getting clojurescript upgraded is fine"><y>#</y><d>2017-11-17</d><h>16:44</h><w>gfredericks</w>getting the cljs tests to run via maven is a nice-to-have; if it&apos;s much harder, just getting clojurescript upgraded is fine</z><z id="t1511029136" t="nwjsmith [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] The patch ended up being much smaller that I had thought https://gist.github.com/nwjsmith/edd1ce97b9e5334ac3cbc49a77ffb339 I&apos;m trying to track down the other part of that ticket though. I can&apos;t seem to find any reader conditionals related to :/ in the tests. Did that already get fixed up?"><y>#</y><d>2017-11-18</d><h>18:18</h><w>nwjsmith</w><a>@gfredericks</a> 

The patch ended up being much smaller that I had thought <a href="https://gist.github.com/nwjsmith/edd1ce97b9e5334ac3cbc49a77ffb339" target="_blank">https://gist.github.com/nwjsmith/edd1ce97b9e5334ac3cbc49a77ffb339</a>

I&apos;m trying to track down the other part of that ticket though. I can&apos;t seem to find any reader conditionals related to <code>:/</code> in the tests. Did that already get fixed up?</z><z id="t1511029174" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] do you have the latest master?"><y>#</y><d>2017-11-18</d><h>18:19</h><w>gfredericks</w><a>@nwjsmith</a> do you have the latest master?</z><z id="t1511029237" t="nwjsmith facepalm"><y>#</y><d>2017-11-18</d><h>18:20</h><w>nwjsmith</w><b>facepalm</b></z><z id="t1511029243" t="nwjsmith I see it now"><y>#</y><d>2017-11-18</d><h>18:20</h><w>nwjsmith</w>I see it now</z><z id="t1511030018" t="nwjsmith I&apos;ve attached the patch to the ticket. Do I need to fiddle with the JIRA workflow of the ticket at all?"><y>#</y><d>2017-11-18</d><h>18:33</h><w>nwjsmith</w>I&apos;ve attached the patch to the ticket. Do I need to fiddle with the JIRA workflow of the ticket at all?</z><z id="t1511030213" t="gfredericks No -- you got both of the :/ things?"><y>#</y><d>2017-11-18</d><h>18:36</h><w>gfredericks</w>No -- you got both of the :/ things?</z><z id="t1511030632" t="nwjsmith Yeah, both of the keyword-symbol-serialization-roundtrip and edn-roundtrips tests"><y>#</y><d>2017-11-18</d><h>18:43</h><w>nwjsmith</w>Yeah, both of the <code>keyword-symbol-serialization-roundtrip</code> and <code>edn-roundtrips</code> tests</z><z id="t1511030640" t="nwjsmith and they both pass"><y>#</y><d>2017-11-18</d><h>18:44</h><w>nwjsmith</w>and they both pass</z><z id="t1511032398" t="gfredericks cool, taking a look now"><y>#</y><d>2017-11-18</d><h>19:13</h><w>gfredericks</w>cool, taking a look now</z><z id="t1511033127" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] looks great! will push as soon as the tests pass on my end and then close the ticket thanks again"><y>#</y><d>2017-11-18</d><h>19:25</h><w>gfredericks</w><a>@nwjsmith</a> looks great! will push as soon as the tests pass on my end and then close the ticket

thanks again</z><z id="t1511033848" t="nwjsmith No problem. Thanks for your help and let me know if there&apos;s anything else you&apos;d like me to take a crack at"><y>#</y><d>2017-11-18</d><h>19:37</h><w>nwjsmith</w>No problem. Thanks for your help and let me know if there&apos;s anything else you&apos;d like me to take a crack at</z><z id="t1511034098" t="gfredericks TCHECK-125 looks manageable, if you&apos;re interested"><y>#</y><d>2017-11-18</d><h>19:41</h><w>gfredericks</w>TCHECK-125 looks manageable, if you&apos;re interested</z><z id="t1511034157" t="gfredericks I&apos;d wrap all the defmethod s in an if that checks if clojure.test/report is a MultiFn or whatever that class is, and if it&apos;s not then just print a warning to *err*"><y>#</y><d>2017-11-18</d><h>19:42</h><w>gfredericks</w>I&apos;d wrap all the <code>defmethod</code>s in an <code>if</code> that checks if <code>clojure.test/report</code> is a <code>MultiFn</code> or whatever that class is, and if it&apos;s not then just print a warning to <code>*err*</code></z><z id="t1511911665" t="johanatan hi"><y>#</y><d>2017-11-28</d><h>23:27</h><w>johanatan</w>hi</z><z id="t1511911690" t="johanatan have you considered the utility of a gen/let which allows either generators or plain values on the right hand side?"><y>#</y><d>2017-11-28</d><h>23:28</h><w>johanatan</w>have you considered the utility of a <code>gen/let</code> which allows either generators or plain values on the right hand side?</z><z id="t1511911900" t="gfredericks there are a lot of places in the API where that sort of thing could be done; my feeling is that it would cause more confusion than it would add value; and the ambiguity of it (a generator is also a value, sort of) is off-putting to me a general rant about that sort of thing here: https://brehaut.net/blog/2013/duck_wrapping that said, I did do exactly that in the body of gen/let"><y>#</y><d>2017-11-28</d><h>23:31</h><w>gfredericks</w>there are a lot of places in the API where that sort of thing could be done; my feeling is that it would cause more confusion than it would add value; and the ambiguity of it (a generator is also a value, sort of) is off-putting to me

a general rant about that sort of thing here: <a href="https://brehaut.net/blog/2013/duck_wrapping" target="_blank">https://brehaut.net/blog/2013/duck_wrapping</a>

that said, I did do exactly that in the body of <code>gen/let</code></z><z id="t1511911908" t="gfredericks but I&apos;ve never liked it 🙂"><y>#</y><d>2017-11-28</d><h>23:31</h><w>gfredericks</w>but I&apos;ve never liked it <b>🙂</b></z><z id="t1511912015" t="gfredericks the most useful thing I can imagine in this direction is being able to create a complex nested data structure where some of the leaves are generators and others aren&apos;t but that sort of feature could be written as just a function that takes such a data structure and returns the generator you want, and calling an extra function wouldn&apos;t be much of a burden at than point since you by definition already have a big chunk of code"><y>#</y><d>2017-11-28</d><h>23:33</h><w>gfredericks</w>the most useful thing I can imagine in this direction is being able to create a complex nested data structure where some of the leaves are generators and others aren&apos;t

but that sort of feature could be written as just a function that takes such a data structure and returns the generator you want, and calling an extra function wouldn&apos;t be much of a burden at than point since you by definition already have a big chunk of code</z><z id="t1511912125" t="johanatan i&apos;m not seeing how that feature could be written as just a function? since there can be dependencies between the nodes of the let"><y>#</y><d>2017-11-28</d><h>23:35</h><w>johanatan</w>i&apos;m not seeing how that feature could be written as just a function? since there can be dependencies between the nodes of the let</z><z id="t1511912145" t="gfredericks not what you asked for exactly"><y>#</y><d>2017-11-28</d><h>23:35</h><w>gfredericks</w>not what you asked for exactly</z><z id="t1511912151" t="gfredericks I was talking about something else at that point"><y>#</y><d>2017-11-28</d><h>23:35</h><w>gfredericks</w>I was talking about something else at that point</z><z id="t1511912180" t="gfredericks you&apos;d have to write a macro that expands to gen/let if you wanted to implement the feature yourself"><y>#</y><d>2017-11-28</d><h>23:36</h><w>gfredericks</w>you&apos;d have to write a macro that expands to <code>gen/let</code> if you wanted to implement the feature yourself</z><z id="t1511912211" t="johanatan what was the something else you were talking about though? perhaps that would interest me if I understood it 🙂"><y>#</y><d>2017-11-28</d><h>23:36</h><w>johanatan</w>what was the something else you were talking about though? perhaps that would interest me if I understood it <b>🙂</b></z><z id="t1511912338" t="gfredericks a function that you could use for your use case like so: (gen/let [x (generatorfy something)] ...) which is no easier than writing gen/return ; but it would have additional magical features so that you could also write (generatorfy [:foo gen/nat 42]) and get a generator for things like [:foo 12 42] and [:foo 19 42] and etc."><y>#</y><d>2017-11-28</d><h>23:38</h><w>gfredericks</w>a function that you could use for your use case like so:

<pre>(gen/let [x (generatorfy something)]
  ...)
</pre>

which is no easier than writing <code>gen/return</code>; but it would have additional magical features so that you could also write <code>(generatorfy [:foo gen/nat 42])</code> and get a generator for things like <code>[:foo 12 42]</code> and <code>[:foo 19 42]</code> and etc.</z><z id="t1511912369" t="gfredericks and you can imagine more complex examples where the generators are buried deep in some gnarly data structure"><y>#</y><d>2017-11-28</d><h>23:39</h><w>gfredericks</w>and you can imagine more complex examples where the generators are buried deep in some gnarly data structure</z><z id="t1511912428" t="gfredericks btw if it would be useful for you to have anything of this sort in https://github.com/gfredericks/test.chuck so you don&apos;t have to maintain it yourself, I&apos;m happy to accept PRs"><y>#</y><d>2017-11-28</d><h>23:40</h><w>gfredericks</w>btw if it would be useful for you to have anything of this sort in <a href="https://github.com/gfredericks/test.chuck" target="_blank">https://github.com/gfredericks/test.chuck</a> so you don&apos;t have to maintain it yourself, I&apos;m happy to accept PRs</z><z id="t1511912467" t="johanatan ah, i see"><y>#</y><d>2017-11-28</d><h>23:41</h><w>johanatan</w>ah, i see</z><z id="t1511912471" t="johanatan makes sense."><y>#</y><d>2017-11-28</d><h>23:41</h><w>johanatan</w>makes sense.</z><z id="t1511912482" t="johanatan for now i&apos;ll probably just use gen/return as my need isn&apos;t too complicated"><y>#</y><d>2017-11-28</d><h>23:41</h><w>johanatan</w>for now i&apos;ll probably just use <code>gen/return</code> as my need isn&apos;t too complicated</z><z id="t1512078108" t="johanatan [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] are you aware that gen/list does not seem to be &quot;just like gen/vector &quot; in the sense that min and max arguments are not accepted?"><y>#</y><d>2017-11-30</d><h>21:41</h><w>johanatan</w><a>@gfredericks</a> are you aware that <code>gen/list</code> does not seem to be &quot;just like <code>gen/vector</code>&quot; in the sense that min and max arguments are not accepted?</z><z id="t1512078136" t="johanatan also, why does gen/double* accept its min and max as keys in an opts map rather than flat args as gen/vector does ?"><y>#</y><d>2017-11-30</d><h>21:42</h><w>johanatan</w>also, why does <code>gen/double*</code> accept its <code>min</code> and <code>max</code> as keys in an opts map rather than flat args as <code>gen/vector</code> does ?</z><z id="t1512078247" t="gfredericks 1) yes; gen/list is a bit second-class; I&apos;m happy to take a patch for the docstring if it&apos;s misleading. I&apos;d consider enhancing it to be like gen/vector , but that gets to 2) wherein the API is inconsistent, which is due to its being created in phases. I think opt maps everywhere would be ideal, and I suppose now that you have me thinking about it, gen/vector in particular could be evolved that way backwards compatibly"><y>#</y><d>2017-11-30</d><h>21:44</h><w>gfredericks</w>1) yes; <code>gen/list</code> is a bit second-class; I&apos;m happy to take a patch for the docstring if it&apos;s misleading. I&apos;d consider enhancing it to be like <code>gen/vector</code>, but that gets to 
2) wherein the API is inconsistent, which is due to its being created in phases. I think opt maps everywhere would be ideal, and I suppose now that you have me thinking about it, <code>gen/vector</code> in particular could be evolved that way backwards compatibly</z><z id="t1512078866" t="johanatan ok, cool. just wanted to make you aware (if not already)"><y>#</y><d>2017-11-30</d><h>21:54</h><w>johanatan</w>ok, cool. just wanted to make you aware (if not already)</z><z id="t1512078887" t="johanatan [not a huge deal to me personally but yea of course consistency is good where possible]"><y>#</y><d>2017-11-30</d><h>21:54</h><w>johanatan</w>[not a huge deal to me personally but yea of course consistency is good where possible]</z><z id="t1512087631" t="johanatan btw, is it generally considered bad practice to call gen/sample oneself nested within a huge gen/let (or other combinator construct)?"><y>#</y><d>2017-12-01</d><h>00:20</h><w>johanatan</w>btw, is it generally considered bad practice to call <code>gen/sample</code> oneself nested within a huge <code>gen/let</code> (or other combinator construct)?</z><z id="t1512087660" t="gfredericks Yes"><y>#</y><d>2017-12-01</d><h>00:21</h><w>gfredericks</w>Yes</z><z id="t1512087669" t="gfredericks Or in a generator at all"><y>#</y><d>2017-12-01</d><h>00:21</h><w>gfredericks</w>Or in a generator at all</z><z id="t1512087695" t="gfredericks Same with gen/generate"><y>#</y><d>2017-12-01</d><h>00:21</h><w>gfredericks</w>Same with gen/generate</z><z id="t1512087700" t="johanatan hmm, I have through discipline been able to almost always avoid this but sometimes things get so hairy that the way to avoid it is not easy to see."><y>#</y><d>2017-12-01</d><h>00:21</h><w>johanatan</w>hmm, I have through discipline been able to almost always avoid this but sometimes things get so hairy that the way to avoid it is not easy to see.</z><z id="t1512087716" t="johanatan is there any standard/general procedure one can apply to help escape that situation?"><y>#</y><d>2017-12-01</d><h>00:21</h><w>johanatan</w>is there any standard/general procedure one can apply to help escape that situation?</z><z id="t1512087859" t="gfredericks You&apos;re passing to sample a generator that&apos;s based on other things you generated?"><y>#</y><d>2017-12-01</d><h>00:24</h><w>gfredericks</w>You&apos;re passing to sample a generator that&apos;s based on other things you generated?</z><z id="t1512087864" t="johanatan yep"><y>#</y><d>2017-12-01</d><h>00:24</h><w>johanatan</w>yep</z><z id="t1512087871" t="Alex Miller (Clojure team) Use bind"><y>#</y><d>2017-12-01</d><h>00:24</h><w>Alex Miller (Clojure team)</w>Use bind</z><z id="t1512087872" t="gfredericks I think it can be hard to talk about these things abstractly, but I&apos;m happy to look at whatever code you can share"><y>#</y><d>2017-12-01</d><h>00:24</h><w>gfredericks</w>I think it can be hard to talk about these things abstractly, but I&apos;m happy to look at whatever code you can share</z><z id="t1512087891" t="johanatan [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] would bind work within a gen/let ?"><y>#</y><d>2017-12-01</d><h>00:24</h><w>johanatan</w><a>@alexmiller</a> would <code>bind</code> work within a <code>gen/let</code> ?</z><z id="t1512087918" t="johanatan ah, yep. that seems like it would work."><y>#</y><d>2017-12-01</d><h>00:25</h><w>johanatan</w>ah, yep. that seems like it would work.</z><z id="t1512087919" t="johanatan thx!"><y>#</y><d>2017-12-01</d><h>00:25</h><w>johanatan</w>thx!</z><z id="t1512087982" t="gfredericks Nice"><y>#</y><d>2017-12-01</d><h>00:26</h><w>gfredericks</w>Nice</z><z id="t1512088367" t="johanatan is there a function that goes from list of generators to generator of a list?"><y>#</y><d>2017-12-01</d><h>00:32</h><w>johanatan</w>is there a function that goes from list of generators to generator of a list?</z><z id="t1512088379" t="johanatan [there should be but i&apos;m not seeing it]"><y>#</y><d>2017-12-01</d><h>00:32</h><w>johanatan</w>[there should be but i&apos;m not seeing it]</z><z id="t1512088381" t="gfredericks Tuple"><y>#</y><d>2017-12-01</d><h>00:33</h><w>gfredericks</w>Tuple</z><z id="t1512088385" t="johanatan ah, cool. thx"><y>#</y><d>2017-12-01</d><h>00:33</h><w>johanatan</w>ah, cool. thx</z><z id="t1512088392" t="gfredericks Used with apply"><y>#</y><d>2017-12-01</d><h>00:33</h><w>gfredericks</w>Used with apply</z><z id="t1512088399" t="johanatan right"><y>#</y><d>2017-12-01</d><h>00:33</h><w>johanatan</w>right</z><z id="t1512104714" t="johanatan would it be possible to have a generator of an infinite/lazy sequence of arbitrary type?"><y>#</y><d>2017-12-01</d><h>05:05</h><w>johanatan</w>would it be possible to have a generator of an infinite/lazy sequence of arbitrary type?</z><z id="t1512104749" t="johanatan [like lazy-random-states but with an arbitrary generator for the values]"><y>#</y><d>2017-12-01</d><h>05:05</h><w>johanatan</w>[like <code>lazy-random-states</code> but with an arbitrary generator for the values]</z><z id="t1512104838" t="johanatan [the reason i&apos;d like this is i have some logic deeply nested inside a gnarly structure of gen/let , gen/bind , gen/fmap et al and realized in the very innermost loop that i need to pull N (dynamically determined) values of a particular type]"><y>#</y><d>2017-12-01</d><h>05:07</h><w>johanatan</w>[the reason i&apos;d like this is i have some logic deeply nested inside a gnarly structure of <code>gen/let</code>, <code>gen/bind</code>, <code>gen/fmap</code> et al and realized in the very innermost loop that i need to pull N (dynamically determined) values of a particular type]</z><z id="t1512104878" t="johanatan it&apos;s probably possible to restructure the code to generate these on the outside but it&apos;s a bit difficult given that the amount to be generated is dynamic/ computed/ derived from other values"><y>#</y><d>2017-12-01</d><h>05:07</h><w>johanatan</w>it&apos;s probably possible to restructure the code to generate these on the outside but it&apos;s a bit difficult given that the amount to be generated is dynamic/ computed/ derived from other values</z><z id="t1512104972" t="johanatan so, if i could at the outermost level bind to a lazy sequence, then inside the nests I could pull from that lazy sequence without violating &quot;thou shall not call gen/sample manually&quot;"><y>#</y><d>2017-12-01</d><h>05:09</h><w>johanatan</w>so, if i could at the outermost level <code>bind</code> to a lazy sequence, then inside the nests I could pull from that lazy sequence without violating &quot;thou shall not call <code>gen/sample</code> manually&quot;</z><z id="t1512105010" t="johanatan pull via a regular take that is"><y>#</y><d>2017-12-01</d><h>05:10</h><w>johanatan</w>pull via a regular <code>take</code> that is</z><z id="t1512129851" t="gfredericks I&apos;ve thought about use cases like that before the trickiest part is thinking about how you shrink that structure"><y>#</y><d>2017-12-01</d><h>12:04</h><w>gfredericks</w>I&apos;ve thought about use cases like that before

the trickiest part is thinking about how you shrink that structure</z><z id="t1512129889" t="gfredericks you could setup a generator of infinite lazy sequences using a recursive gen/bind , but I think it would never stop shrinking"><y>#</y><d>2017-12-01</d><h>12:04</h><w>gfredericks</w>you could setup a generator of infinite lazy sequences using a recursive <code>gen/bind</code>, but I think it would never stop shrinking</z><z id="t1512129951" t="gfredericks and even with lower-level help from the library, it still needs to have a strategy for that the tension comes from not easily being able to tell how much of the infinite source of data the user actually used"><y>#</y><d>2017-12-01</d><h>12:05</h><w>gfredericks</w>and even with lower-level help from the library, it still needs to have a strategy for that

the tension comes from not easily being able to tell how much of the infinite source of data the user actually used</z><z id="t1512130022" t="gfredericks there are certainly hacky ways to try to do that, and that might be the best answer, but the &quot;hacky&quot; part has made me hesitant to commit to anything"><y>#</y><d>2017-12-01</d><h>12:07</h><w>gfredericks</w>there are certainly hacky ways to try to do that, and that might be the best answer, but the &quot;hacky&quot; part has made me hesitant to commit to anything</z><z id="t1512130106" t="gfredericks one less hacky trade-off you can make is to relax the &quot;requirement&quot; that there actually be an infinite number of things generated -- e.g., if you generate a large vector of items and then use (gen/fmap cycle ...)"><y>#</y><d>2017-12-01</d><h>12:08</h><w>gfredericks</w>one less hacky trade-off you can make is to relax the &quot;requirement&quot; that there actually be an infinite number of things generated -- e.g., if you generate a large vector of items and then use <code>(gen/fmap cycle ...)</code></z><z id="t1512130137" t="gfredericks then that will naturally shrink to an infinite repetition of one very small piece of data so it only works if you can tolerate repeats"><y>#</y><d>2017-12-01</d><h>12:08</h><w>gfredericks</w>then that will naturally shrink to an infinite repetition of one very small piece of data

so it only works if you can tolerate repeats</z><z id="t1512130163" t="gfredericks I remember making this recommendation for spec when it generates function stubs"><y>#</y><d>2017-12-01</d><h>12:09</h><w>gfredericks</w>I remember making this recommendation for spec when it generates function stubs</z><z id="t1512153534" t="johanatan ah, nice thoughts. would definitely be cool if something like this can be added in a not-too-hacky way but for now yea i&apos;ll go with a finite but repeating structure"><y>#</y><d>2017-12-01</d><h>18:38</h><w>johanatan</w>ah, nice thoughts. would definitely be cool if something like this can be added in a not-too-hacky way but for now yea i&apos;ll go with a finite but repeating structure</z><z id="t1512155879" t="johanatan if i were to attempt a bind to the (gen/fmap cycle ...) structure you mentioned, that would be an infinite loop yea?"><y>#</y><d>2017-12-01</d><h>19:17</h><w>johanatan</w>if i were to attempt a <code>bind</code> to the <code>(gen/fmap cycle ...)</code> structure you mentioned, that would be an infinite loop yea?</z><z id="t1512156053" t="gfredericks no I don&apos;t think so"><y>#</y><d>2017-12-01</d><h>19:20</h><w>gfredericks</w>no I don&apos;t think so</z><z id="t1512156133" t="gfredericks unless the function that accepts the infinite sequence needs to consume the whole thing before returning a generator"><y>#</y><d>2017-12-01</d><h>19:22</h><w>gfredericks</w>unless the function that accepts the infinite sequence needs to consume the whole thing before returning a generator</z><z id="t1512168491" t="johanatan i made these helpers to realize your idea above: (defn- repeating-seq ([gen] (repeating-seq gen 1000)) ([gen size] (with-meta (gen/fmap cycle (gen/vector gen size size)) {:size size}))) (defn- take-repeating-seq [n seq] (gen/fmap #(take n (drop (%1 1) (%1 0))) (gen/tuple seq (gen/choose 1 ((meta seq) :size))))) "><y>#</y><d>2017-12-01</d><h>22:48</h><w>johanatan</w>i made these helpers to realize your idea above:
<pre>(defn- repeating-seq
  ([gen] (repeating-seq gen 1000))
  ([gen size] (with-meta (gen/fmap cycle (gen/vector gen size size)) {:size size})))

(defn- take-repeating-seq [n seq]
  (gen/fmap #(take n (drop (%1 1) (%1 0))) (gen/tuple seq (gen/choose 1 ((meta seq) :size)))))
</pre></z><z id="t1512170631" t="gfredericks Huh..."><y>#</y><d>2017-12-01</d><h>23:23</h><w>gfredericks</w>Huh...</z><z id="t1512170663" t="gfredericks So you&apos;d use take-repeating-seq several times on the same generated sequence?"><y>#</y><d>2017-12-01</d><h>23:24</h><w>gfredericks</w>So you&apos;d use take-repeating-seq several times on the same generated sequence?</z><z id="t1512171270" t="johanatan yea"><y>#</y><d>2017-12-01</d><h>23:34</h><w>johanatan</w>yea</z><z id="t1512171426" t="gfredericks You just don&apos;t know how many times you need to it until you&apos;re doing it?"><y>#</y><d>2017-12-01</d><h>23:37</h><w>gfredericks</w>You just don&apos;t know how many times you need to it until you&apos;re doing it?</z><z id="t1512171529" t="johanatan mm, well actually i&apos;ve restructured the code since i did that so haven&apos;t had to use it yet. but i see it as a sort of escape hatch if one gets too deep"><y>#</y><d>2017-12-01</d><h>23:38</h><w>johanatan</w>mm, well actually i&apos;ve restructured the code since i did that so haven&apos;t had to use it yet. but i see it as a sort of escape hatch if one gets too deep</z><z id="t1512171685" t="johanatan [of course i could be totally confused 🙂 ] i always feel about halfway confused when deep in generator code"><y>#</y><d>2017-12-01</d><h>23:41</h><w>johanatan</w>[of course i could be totally confused <b>🙂</b> ] i always feel about halfway confused when deep in generator code</z><z id="t1512173049" t="johanatan the above code is obviously not very efficient given that drop is O(n) so yea probably better ways exist"><y>#</y><d>2017-12-02</d><h>00:04</h><w>johanatan</w>the above code is obviously not very efficient given that <code>drop</code> is O(n) so yea probably better ways exist</z><z id="t1513002293" t="gfredericks Does anybody have opinions about the idea of adding a generators-2 namespace that attempts to address lots of confusion points and inconsistencies in the current namespace? I assume one big downside is the new confusion caused by having two namespaces forever"><y>#</y><d>2017-12-11</d><h>14:24</h><w>gfredericks</w>Does anybody have opinions about the idea of adding a <code>generators-2</code> namespace that attempts to address lots of confusion points and inconsistencies in the current namespace?

I assume one big downside is the new confusion caused by having two namespaces forever</z><z id="t1513002413" t="gfredericks And even more work required for a good release 😕 "><y>#</y><d>2017-12-11</d><h>14:26</h><w>gfredericks</w>And even more work required for a good release <b>😕</b> </z><z id="t1513002850" t="Alex Miller (Clojure team) Maybe start with a list of problems?"><y>#</y><d>2017-12-11</d><h>14:34</h><w>Alex Miller (Clojure team)</w>Maybe start with a list of problems?</z><z id="t1513003801" t="gfredericks yeah that&apos;s a good idea"><y>#</y><d>2017-12-11</d><h>14:50</h><w>gfredericks</w>yeah that&apos;s a good idea</z><z id="t1513139670" t="johanatan does anyone know how to diagnose the following error?"><y>#</y><d>2017-12-13</d><h>04:34</h><w>johanatan</w>does anyone know how to diagnose the following error?</z><z id="t1513139740" t="johanatan 1. Unhandled java.lang.IllegalArgumentException No implementation of method: :specize* of protocol: #&apos;clojure.spec.alpha/Specize found for class: nil "><y>#</y><d>2017-12-13</d><h>04:35</h><w>johanatan</w><pre>1. Unhandled java.lang.IllegalArgumentException
   No implementation of method: :specize* of protocol:
   #&apos;clojure.spec.alpha/Specize found for class: nil

</pre></z><z id="t1513139825" t="johanatan [sorry wrong channel. it&apos;s spec related; not test check related]"><y>#</y><d>2017-12-13</d><h>04:37</h><w>johanatan</w>[sorry wrong channel. it&apos;s spec related; not test check related]</z><z id="t1513346832" t="gfredericks As suggested, here is a list of problems that make me wonder about creating a generators-2 namespace: https://dev.clojure.org/display/design/Generators+Reboot Apparently my original question has already been lost to the black hole of slack, so that&apos;s pretty good."><y>#</y><d>2017-12-15</d><h>14:07</h><w>gfredericks</w>As suggested, here is a list of problems that make me wonder about creating a <code>generators-2</code> namespace:

<a href="https://dev.clojure.org/display/design/Generators+Reboot" target="_blank">https://dev.clojure.org/display/design/Generators+Reboot</a>

Apparently my original question has already been lost to the black hole of slack, so that&apos;s pretty good.</z><z id="t1516279476" t="gfredericks I reverted the changed that added map-bindings to gen/let"><y>#</y><d>2018-01-18</d><h>12:44</h><w>gfredericks</w>I reverted the changed that added map-bindings to <code>gen/let</code></z><z id="t1516986281" t="ghadi [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] can you check in a deps.edn ?"><y>#</y><d>2018-01-26</d><h>17:04</h><w>ghadi</w><a>@gfredericks</a> can you check in a deps.edn ?</z><z id="t1516986298" t="ghadi I&apos;d like to use test.check directly from git"><y>#</y><d>2018-01-26</d><h>17:04</h><w>ghadi</w>I&apos;d like to use test.check directly from git</z><z id="t1516987345" t="ghadi {:paths [&quot;src/main/clojure&quot;] :aliases {:test {:extra-paths [&quot;src/test/clojure&quot;]}}} "><y>#</y><d>2018-01-26</d><h>17:22</h><w>ghadi</w><pre>{:paths [&quot;src/main/clojure&quot;]
 :aliases {:test {:extra-paths [&quot;src/test/clojure&quot;]}}}
</pre></z><z id="t1516987895" t="Alex Miller (Clojure team) You don’t need one"><y>#</y><d>2018-01-26</d><h>17:31</h><w>Alex Miller (Clojure team)</w>You don’t need one</z><z id="t1516987902" t="Alex Miller (Clojure team) We support Pom manifests now"><y>#</y><d>2018-01-26</d><h>17:31</h><w>Alex Miller (Clojure team)</w>We support Pom manifests now</z><z id="t1516987920" t="Alex Miller (Clojure team) Although I guess you’re missing :paths"><y>#</y><d>2018-01-26</d><h>17:32</h><w>Alex Miller (Clojure team)</w>Although I guess you’re missing :paths</z><z id="t1516987925" t="Alex Miller (Clojure team) Unfortunate"><y>#</y><d>2018-01-26</d><h>17:32</h><w>Alex Miller (Clojure team)</w>Unfortunate</z><z id="t1516987962" t="Alex Miller (Clojure team) I’m going to add src/main/clojure automatically I think - then you won’t need one"><y>#</y><d>2018-01-26</d><h>17:32</h><w>Alex Miller (Clojure team)</w>I’m going to add src/main/clojure automatically I think - then you won’t need one</z><z id="t1516991811" t="ghadi Fancy"><y>#</y><d>2018-01-26</d><h>18:36</h><w>ghadi</w>Fancy</z><z id="t1516991852" t="ghadi We&apos;re beating Maven at its own game [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}]"><y>#</y><d>2018-01-26</d><h>18:37</h><w>ghadi</w>We&apos;re beating Maven at its own game <a>@alexmiller</a></z><z id="t1517020336" t="gfredericks huhwhat?"><y>#</y><d>2018-01-27</d><h>02:32</h><w>gfredericks</w>huhwhat?</z><z id="t1517020351" t="gfredericks like src/main/clojure is always on the path for every project and you can&apos;t turn it off?"><y>#</y><d>2018-01-27</d><h>02:32</h><w>gfredericks</w>like <code>src/main/clojure</code> is always on the path for every project and you can&apos;t turn it off?</z><z id="t1517056276" t="Alex Miller (Clojure team) Just for git and local deps with a Pom manifest"><y>#</y><d>2018-01-27</d><h>12:31</h><w>Alex Miller (Clojure team)</w>Just for git and local deps with a Pom manifest</z><z id="t1518058632" t="wilkerlucio hello, I&apos;m trying to limit the recursion of a generator, the problem is that the recursion is not &quot;direct&quot;, it generates something, that generates something else, and ends up in circle, but this kind of recursion seems to not be detected by test.check recursion limit"><y>#</y><d>2018-02-08</d><h>02:57</h><w>wilkerlucio</w>hello, I&apos;m trying to limit the recursion of a generator, the problem is that the recursion is not &quot;direct&quot;, it generates something, that generates something else, and ends up in circle, but this kind of recursion seems to not be detected by test.check recursion limit</z><z id="t1518058663" t="wilkerlucio I was thinking about using some dynamic var to track how many times my generator was called, and stop if goes after a number in a call stack"><y>#</y><d>2018-02-08</d><h>02:57</h><w>wilkerlucio</w>I was thinking about using some dynamic var to track how many times my generator was called, and stop if goes after a number in a call stack</z><z id="t1518058703" t="wilkerlucio I was trying something like this:"><y>#</y><d>2018-02-08</d><h>02:58</h><w>wilkerlucio</w>I was trying something like this:</z><z id="t1518058704" t="wilkerlucio (s/def ::query-root (s/coll-of ::query-expr-root :kind vector? :gen #(if (&gt; *max-depth* 0) (binding [*max-depth* (dec *max-depth*)] (s/gen (s/coll-of ::query-expr-root :kind vector? :max-count 5))) (s/gen #{[]}))))"><y>#</y><d>2018-02-08</d><h>02:58</h><w>wilkerlucio</w><pre>(s/def ::query-root
  (s/coll-of ::query-expr-root :kind vector?
    :gen #(if (&gt; *max-depth* 0)
            (binding [*max-depth* (dec *max-depth*)]
              (s/gen (s/coll-of ::query-expr-root :kind vector? :max-count 5)))
            (s/gen #{[]}))))</pre></z><z id="t1518058726" t="wilkerlucio but this doesn&apos;t work, because the binding is running on the generator definition, and not when the actual gen is running"><y>#</y><d>2018-02-08</d><h>02:58</h><w>wilkerlucio</w>but this doesn&apos;t work, because the binding is running on the generator definition, and not when the actual gen is running</z><z id="t1518058744" t="wilkerlucio I was trying to find a way to wrap some generator with this logic, but can&apos;t figure how to hook it up"><y>#</y><d>2018-02-08</d><h>02:59</h><w>wilkerlucio</w>I was trying to find a way to wrap some generator with this logic, but can&apos;t figure how to hook it up</z><z id="t1518058773" t="wilkerlucio how can I make this? because otherwise my generator fail about 80% of the time because of stack overflow =/"><y>#</y><d>2018-02-08</d><h>02:59</h><w>wilkerlucio</w>how can I make this? because otherwise my generator fail about 80% of the time because of stack overflow =/</z><z id="t1518100258" t="gfredericks by &quot;test.check recursion limit&quot; you&apos;re referring to the mechanism in clojure.spec that&apos;s used when generating generators?"><y>#</y><d>2018-02-08</d><h>14:30</h><w>gfredericks</w>by &quot;test.check recursion limit&quot; you&apos;re referring to the mechanism in clojure.spec that&apos;s used when generating generators?</z><z id="t1518100313" t="gfredericks have you tried expressing the generator for the whole thing using gen/recursive-gen ?"><y>#</y><d>2018-02-08</d><h>14:31</h><w>gfredericks</w>have you tried expressing the generator for the whole thing using <code>gen/recursive-gen</code>?</z><z id="t1518135296" t="wilkerlucio [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] sorry the delay, I&apos;m not sure I can use recursive-gen on this case"><y>#</y><d>2018-02-09</d><h>00:14</h><w>wilkerlucio</w><a>@gfredericks</a> sorry the delay, I&apos;m not sure I can use recursive-gen on this case</z><z id="t1518135300" t="wilkerlucio but I was able to make it work"><y>#</y><d>2018-02-09</d><h>00:15</h><w>wilkerlucio</w>but I was able to make it work</z><z id="t1518135319" t="wilkerlucio this how it ended up:"><y>#</y><d>2018-02-09</d><h>00:15</h><w>wilkerlucio</w>this how it ended up:</z><z id="t1518135322" t="wilkerlucio (s/def ::query (s/coll-of ::query-expr :kind vector? :gen #(let [g (s/gen (s/coll-of ::query-expr :kind vector? :max-count 5))] (gen/-&gt;Generator (fn [rdn size] (if (&gt; *query-gen-max-depth* 0) (binding [*query-gen-max-depth* (dec *query-gen-max-depth*)] (gen/call-gen g rdn size)) (gen/call-gen (gen/return []) rdn size)))))))"><y>#</y><d>2018-02-09</d><h>00:15</h><w>wilkerlucio</w><pre>(s/def ::query
  (s/coll-of ::query-expr :kind vector?
    :gen #(let [g (s/gen (s/coll-of ::query-expr :kind vector? :max-count 5))]
            (gen/-&gt;Generator
              (fn [rdn size]
                (if (&gt; *query-gen-max-depth* 0)
                  (binding [*query-gen-max-depth* (dec *query-gen-max-depth*)]
                    (gen/call-gen g rdn size))
                  (gen/call-gen (gen/return []) rdn size)))))))</pre></z><z id="t1518135351" t="wilkerlucio this limits the depth of the generator by using a dynamic var, was the best solution I could find"><y>#</y><d>2018-02-09</d><h>00:15</h><w>wilkerlucio</w>this limits the depth of the generator by using a dynamic var, was the best solution I could find</z><z id="t1518135609" t="gfredericks yeah, I think it&apos;s technically possible with recursive-gen but maybe not easy would definitely be better for spec to handle it without error"><y>#</y><d>2018-02-09</d><h>00:20</h><w>gfredericks</w>yeah, I think it&apos;s technically possible with recursive-gen but maybe not easy

would definitely be better for spec to handle it without error</z><z id="t1519409150" t="pablore Hi, how can I make a generator for a clojure.lang.PersistentQueue ?"><y>#</y><d>2018-02-23</d><h>18:05</h><w>pablore</w>Hi, how can I make a generator for a <code>clojure.lang.PersistentQueue</code>?</z><z id="t1519409640" t="pablore Already did it: (defn gen-queue [some-generator] (gen/bind (gen/vector some-generator)) #(into (clojure.lang.PersistentQueue/EMPTY) %))))) "><y>#</y><d>2018-02-23</d><h>18:14</h><w>pablore</w>Already did it:
<pre>(defn gen-queue
  [some-generator]
  (gen/bind  (gen/vector some-generator))
                     #(into (clojure.lang.PersistentQueue/EMPTY) %)))))
</pre></z><z id="t1519410587" t="gfredericks That shouldn&apos;t work"><y>#</y><d>2018-02-23</d><h>18:29</h><w>gfredericks</w>That shouldn&apos;t work</z><z id="t1519410616" t="gfredericks Should have to switch bind to fmap and swap the arg order"><y>#</y><d>2018-02-23</d><h>18:30</h><w>gfredericks</w>Should have to switch bind to fmap and swap the arg order</z><z id="t1520271852" t="ghadi [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] what&apos;s going on with https://dev.clojure.org/jira/browse/TCHECK-2 ? we just got bit by that"><y>#</y><d>2018-03-05</d><h>17:44</h><w>ghadi</w><a>@gfredericks</a> what&apos;s going on with <a href="https://dev.clojure.org/jira/browse/TCHECK-2" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-2</a> ? we just got bit by that</z><z id="t1520271918" t="gfredericks what&apos;s a good solution w.r.t. not breaking things? deprecate the old poorly named things and make new things with good names?"><y>#</y><d>2018-03-05</d><h>17:45</h><w>gfredericks</w>what&apos;s a good solution w.r.t. not breaking things? deprecate the old poorly named things and make new things with good names?</z><z id="t1520272088" t="ghadi i guess i&apos;m confused on how it&apos;s poorly named vs broken"><y>#</y><d>2018-03-05</d><h>17:48</h><w>ghadi</w>i guess i&apos;m confused on how it&apos;s poorly named vs broken</z><z id="t1520272127" t="ghadi (pos-int? 0) =&gt; false"><y>#</y><d>2018-03-05</d><h>17:48</h><w>ghadi</w>(pos-int? 0) =&gt; false</z><z id="t1520272203" t="ghadi IIRC it just so happens that spec filters out by doing (such-that pos-int? gen/pos-int) -- but if you use test.check directly you&apos;ll see 0"><y>#</y><d>2018-03-05</d><h>17:50</h><w>ghadi</w>IIRC it just so happens that spec filters out by doing (such-that pos-int? gen/pos-int) -- but if you use test.check directly you&apos;ll see 0</z><z id="t1520272542" t="ghadi yeah: user&gt; (clojure.spec.gen.alpha/sample (clojure.spec.alpha/gen pos-int?)) (1 1 1 4 2 4 31 1 8 4) user&gt; (clojure.test.check.generators/sample clojure.test.check.generators/pos-int) (0 0 1 1 0 5 1 2 1 4) "><y>#</y><d>2018-03-05</d><h>17:55</h><w>ghadi</w>yeah:

<pre>user&gt; (clojure.spec.gen.alpha/sample (clojure.spec.alpha/gen pos-int?))

(1 1 1 4 2 4 31 1 8 4)

user&gt; (clojure.test.check.generators/sample clojure.test.check.generators/pos-int)

(0 0 1 1 0 5 1 2 1 4)

</pre></z><z id="t1520273762" t="gfredericks I think it was always a case of a bad name; I have no idea where those names came from, but I think the docstrings have reflected the actual behavior"><y>#</y><d>2018-03-05</d><h>18:16</h><w>gfredericks</w>I think it was always a case of a bad name; I have no idea where those names came from, but I think the docstrings have reflected the actual behavior</z><z id="t1520273781" t="gfredericks so changing the behavior &amp; docstrings to match the names would potentially break anybody using them"><y>#</y><d>2018-03-05</d><h>18:16</h><w>gfredericks</w>so changing the behavior &amp; docstrings to match the names would potentially break anybody using them</z><z id="t1520273790" t="ghadi ugh"><y>#</y><d>2018-03-05</d><h>18:16</h><w>ghadi</w>ugh</z><z id="t1520273802" t="ghadi what does the s in s-pos-int mean?"><y>#</y><d>2018-03-05</d><h>18:16</h><w>ghadi</w>what does the s in s-pos-int mean?</z><z id="t1520273830" t="gfredericks &quot;strictly&quot; -- which points even more strongly to the bad names theory"><y>#</y><d>2018-03-05</d><h>18:17</h><w>gfredericks</w>&quot;strictly&quot; -- which points even more strongly to the bad names theory</z><z id="t1520273842" t="ghadi lmao"><y>#</y><d>2018-03-05</d><h>18:17</h><w>ghadi</w>lmao</z><z id="t1520273895" t="gfredericks there&apos;s a relevant section on integer generators here: https://dev.clojure.org/display/design/Generators+Reboot"><y>#</y><d>2018-03-05</d><h>18:18</h><w>gfredericks</w>there&apos;s a relevant section on integer generators here: <a href="https://dev.clojure.org/display/design/Generators+Reboot" target="_blank">https://dev.clojure.org/display/design/Generators+Reboot</a></z><z id="t1520273922" t="ghadi i see"><y>#</y><d>2018-03-05</d><h>18:18</h><w>ghadi</w>i see</z><z id="t1520274133" t="ghadi in rich&apos;s compatibility algebra of provides and requires -- is not returning 0 a breaking change? Is it possible that certain random seeds never see 0?"><y>#</y><d>2018-03-05</d><h>18:22</h><w>ghadi</w>in rich&apos;s compatibility algebra of provides and requires -- is not returning 0 a breaking change? Is it possible that certain random seeds never see 0?</z><z id="t1520274164" t="gfredericks I&apos;ve wondered about how the compatibility algebra applies to generators and distributions 😄"><y>#</y><d>2018-03-05</d><h>18:22</h><w>gfredericks</w>I&apos;ve wondered about how the compatibility algebra applies to generators and distributions <b>😄</b></z><z id="t1520274197" t="gfredericks I do think reducing the distribution is a breaking thing"><y>#</y><d>2018-03-05</d><h>18:23</h><w>gfredericks</w>I do think reducing the distribution is a breaking thing</z><z id="t1520274205" t="gfredericks you&apos;re silently causing users&apos; generators to test less than they used to"><y>#</y><d>2018-03-05</d><h>18:23</h><w>gfredericks</w>you&apos;re silently causing users&apos; generators to test less than they used to</z><z id="t1520274212" t="ghadi my 2c: this generator is busted and it&apos;s not that big of a deal to remove 0. (There is an argument around people relying on behavior whether correct or not)"><y>#</y><d>2018-03-05</d><h>18:23</h><w>ghadi</w>my 2c: this generator is busted and it&apos;s not that big of a deal to remove 0.

(There is an argument around people relying on behavior whether correct or not)</z><z id="t1520274251" t="ghadi i can be persuaded either way -- but not for a crappy name like s-pos-int"><y>#</y><d>2018-03-05</d><h>18:24</h><w>ghadi</w>i can be persuaded either way -- but not for a crappy name like s-pos-int</z><z id="t1520274354" t="gfredericks no I don&apos;t think &quot;leave everything as-is&quot; is a good solution"><y>#</y><d>2018-03-05</d><h>18:25</h><w>gfredericks</w>no I don&apos;t think &quot;leave everything as-is&quot; is a good solution</z><z id="t1520274399" t="gfredericks given zero is such an important edge case a lot of the time, silently making people&apos;s tests less effective is also a bad idea I think"><y>#</y><d>2018-03-05</d><h>18:26</h><w>gfredericks</w>given zero is such an important edge case a lot of the time, silently making people&apos;s tests less effective is also a bad idea I think</z><z id="t1520274448" t="gfredericks I think the bigger question that needs deciding is the one from the link above -- whether to start a new namespace or improve things by deprecating individual generators"><y>#</y><d>2018-03-05</d><h>18:27</h><w>gfredericks</w>I think the bigger question that needs deciding is the one from the link above -- whether to start a new namespace or improve things by deprecating individual generators</z><z id="t1520274467" t="gfredericks I feel like rich&apos;s paradigm could use some good deprecation tooling"><y>#</y><d>2018-03-05</d><h>18:27</h><w>gfredericks</w>I feel like rich&apos;s paradigm could use some good deprecation tooling</z><z id="t1520277275" t="gfredericks woah the spec alias of the exact same name has different behavior?"><y>#</y><d>2018-03-05</d><h>19:14</h><w>gfredericks</w>woah the spec alias of the exact same name has different behavior?</z><z id="t1520277285" t="gfredericks gee willickers"><y>#</y><d>2018-03-05</d><h>19:14</h><w>gfredericks</w>gee willickers</z><z id="t1520277531" t="ghadi yup"><y>#</y><d>2018-03-05</d><h>19:18</h><w>ghadi</w>yup</z><z id="t1520277563" t="ghadi maybe we should ask Rich on the mailing list"><y>#</y><d>2018-03-05</d><h>19:19</h><w>ghadi</w>maybe we should ask Rich on the mailing list</z><z id="t1520277710" t="gfredericks about deprecation or about generator aliasing?"><y>#</y><d>2018-03-05</d><h>19:21</h><w>gfredericks</w>about deprecation or about generator aliasing?</z><z id="t1520277816" t="ghadi The former"><y>#</y><d>2018-03-05</d><h>19:23</h><w>ghadi</w>The former</z><z id="t1520278170" t="gfredericks like whether deprecation is a good idea at all, or the specific question of how we should do it exactly?"><y>#</y><d>2018-03-05</d><h>19:29</h><w>gfredericks</w>like whether deprecation is a good idea at all, or the specific question of how we should do it exactly?</z><z id="t1520278451" t="ghadi what to do specifically"><y>#</y><d>2018-03-05</d><h>19:34</h><w>ghadi</w>what to do specifically</z><z id="t1520278465" t="ghadi need a third set of eyes"><y>#</y><d>2018-03-05</d><h>19:34</h><w>ghadi</w>need a third set of eyes</z><z id="t1522363870" t="grumplet Is there a reasonably simple way to implement generative tests on an async function? It looks like this might be impossible without reimplementing test.check or clojure.spec.test.alpha/check?"><y>#</y><d>2018-03-29</d><h>22:51</h><w>grumplet</w>Is there a reasonably simple way to implement generative tests on an async function? It looks like this might be impossible without reimplementing test.check or clojure.spec.test.alpha/check?</z><z id="t1522364908" t="hiredman it depends how you do your async functioning"><y>#</y><d>2018-03-29</d><h>23:08</h><w>hiredman</w>it depends how you do your async functioning</z><z id="t1522364962" t="hiredman if you just call async functions with abandon, it is hard, if create a an Executor that you can shutdown and run them on that Executor it is pretty easy"><y>#</y><d>2018-03-29</d><h>23:09</h><w>hiredman</w>if you just call async functions with abandon, it is hard, if create a an Executor that you can shutdown and run them on that Executor it is pretty easy</z><z id="t1522365128" t="hiredman basically, if you can put a function like interface on it, it doesn&apos;t matter if internally it does stuff asynchronously"><y>#</y><d>2018-03-29</d><h>23:12</h><w>hiredman</w>basically, if you can put a function like interface on it, it doesn&apos;t matter if internally it does stuff asynchronously</z><z id="t1522365667" t="gfredericks For cljs it&apos;s impossible"><y>#</y><d>2018-03-29</d><h>23:21</h><w>gfredericks</w>For cljs it&apos;s impossible</z><z id="t1522365759" t="grumplet [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] That&apos;s the conclusion I was coming to 😞"><y>#</y><d>2018-03-29</d><h>23:22</h><w>grumplet</w><a>@gfredericks</a> That&apos;s the conclusion I was coming to <b>😞</b></z><z id="t1522365818" t="gfredericks Yeah, it will take some work to add that"><y>#</y><d>2018-03-29</d><h>23:23</h><w>gfredericks</w>Yeah, it will take some work to add that</z><z id="t1522365827" t="gfredericks Definitely a priority"><y>#</y><d>2018-03-29</d><h>23:23</h><w>gfredericks</w>Definitely a priority</z><z id="t1522365843" t="grumplet I&apos;m trying to test a remote call to R against a cljs call which should return the same values and was hoping to get test.check style behaviour."><y>#</y><d>2018-03-29</d><h>23:24</h><w>grumplet</w>I&apos;m trying to test a remote call to R against a cljs call which should return the same values and was hoping to get test.check  style behaviour.</z><z id="t1522365865" t="gfredericks remote call = ajax?"><y>#</y><d>2018-03-29</d><h>23:24</h><w>gfredericks</w>remote call = ajax?</z><z id="t1522365869" t="grumplet yep"><y>#</y><d>2018-03-29</d><h>23:24</h><w>grumplet</w>yep</z><z id="t1522365986" t="gfredericks A couple heavy workarounds: test from clj, either by rewriting your logic in cljc or shelling out to node"><y>#</y><d>2018-03-29</d><h>23:26</h><w>gfredericks</w>A couple heavy workarounds: test from clj, either by rewriting your logic in cljc or shelling out to node</z><z id="t1522365999" t="gfredericks Neither of those are nice obviously"><y>#</y><d>2018-03-29</d><h>23:26</h><w>gfredericks</w>Neither of those are nice obviously</z><z id="t1522366047" t="grumplet Interesting idea though. I suspect the stats model would port to clj without too many problems."><y>#</y><d>2018-03-29</d><h>23:27</h><w>grumplet</w>Interesting idea though. I suspect the stats model would port to clj without too many problems.</z><z id="t1522366081" t="grumplet Thanks - I&apos;ll think about that approach."><y>#</y><d>2018-03-29</d><h>23:28</h><w>grumplet</w>Thanks - I&apos;ll think about that approach.</z><z id="t1523220435" t="gfredericks Would it be possible to have a generic test assertions library that plugs into both test.check and clojure.test and other testing libraries?"><y>#</y><d>2018-04-08</d><h>20:47</h><w>gfredericks</w>Would it be possible to have a generic test assertions library that plugs into both test.check and clojure.test and other testing libraries?</z><z id="t1523220487" t="gfredericks test.check and clojure.test both have an impoverishment of assertions, where testing-specific assertions are needed so that specific feedback can be given to the user about how it failed"><y>#</y><d>2018-04-08</d><h>20:48</h><w>gfredericks</w>test.check and clojure.test both have an impoverishment of assertions, where testing-specific assertions are needed so that specific feedback can be given to the user about how it failed</z><z id="t1523220510" t="gfredericks and it would be sad for that problem to be addressed in one library without the other"><y>#</y><d>2018-04-08</d><h>20:48</h><w>gfredericks</w>and it would be sad for that problem to be addressed in one library without the other</z><z id="t1523376249" t="Joe Lane Is there an api in test.check to get the collection of inputs and outputs used when exercising a test? For example, when running (defspec first-element-is-min-after-sorting ;; the name of the test 100 ;; the number of iterations for test.check to test (prop/for-all [v (gen/not-empty (gen/vector gen/int))] (= (apply min v) (first (sort v))))) getting a collection of ({:input [1] :output [1]}, {:input [2 1] :output [1 2]} ... I suspect it the data I’m looking for is :args and :result-data or :result from the quickcheck function in check.cljc . Is there a blessed way to get access to this information?"><y>#</y><d>2018-04-10</d><h>16:04</h><w>Joe Lane</w>Is there an api in test.check to get the collection of inputs and outputs used when exercising a test?
For example, when running
<pre>(defspec first-element-is-min-after-sorting ;; the name of the test
         100 ;; the number of iterations for test.check to test
         (prop/for-all [v (gen/not-empty (gen/vector gen/int))]
           (= (apply min v)
              (first (sort v)))))
</pre>
getting a collection of 
<pre>({:input [1] :output [1]},
 {:input [2 1] :output [1 2]}
 ...
</pre>

I suspect it the data I’m looking for is <code>:args</code> and <code>:result-data</code> or <code>:result</code> from the <code>quickcheck</code> function in <code>check.cljc</code>. 
Is there a blessed way to get access to this information?</z><z id="t1523376663" t="ghadi you can recreate it using the random seed that quickcheck gives you"><y>#</y><d>2018-04-10</d><h>16:11</h><w>ghadi</w>you can recreate it using the random seed that quickcheck gives you</z><z id="t1523377244" t="Joe Lane [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I can get the data literals using the seed? I know I can re-run the test again, i’m curious about the data itself though"><y>#</y><d>2018-04-10</d><h>16:20</h><w>Joe Lane</w><a>@ghadi</a> I can get the data literals using the seed? I know I can re-run the test again, i’m curious about the data itself though</z><z id="t1523377297" t="ghadi right, I&apos;m not sure the exact process"><y>#</y><d>2018-04-10</d><h>16:21</h><w>ghadi</w>right, I&apos;m not sure the exact process</z><z id="t1523377313" t="ghadi the seed is there so that you can get reproducibility"><y>#</y><d>2018-04-10</d><h>16:21</h><w>ghadi</w>the seed is there so that you can get reproducibility</z><z id="t1523377499" t="nberger [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] may I ask what do you plan to do with that data? I&apos;m truly curious, mostly because a while ago I wanted to add a way to get a glimpse on what&apos;s the distribution of the generated values"><y>#</y><d>2018-04-10</d><h>16:24</h><w>nberger</w><a>@lanejo01</a> may I ask what do you plan to do with that data? I&apos;m truly curious, mostly because a while ago I wanted to add a way to get a glimpse on what&apos;s the distribution of the generated values</z><z id="t1523377973" t="gfredericks args is the generated data"><y>#</y><d>2018-04-10</d><h>16:32</h><w>gfredericks</w>args is the generated data</z><z id="t1523378016" t="gfredericks The return value isn&apos;t given, you can just call your function yourself once you have the args"><y>#</y><d>2018-04-10</d><h>16:33</h><w>gfredericks</w>The return value isn&apos;t given, you can just call your function yourself once you have the args</z><z id="t1523378059" t="ghadi [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] can you do something like sample-seq while providing the seed?"><y>#</y><d>2018-04-10</d><h>16:34</h><w>ghadi</w><a>@gfredericks</a> can you do something like <code>sample-seq</code> while providing the seed?</z><z id="t1523380013" t="gfredericks It could exist, but might not be immediately useful since you couldn&apos;t easily pick out the failing args. Do you have another use case?"><y>#</y><d>2018-04-10</d><h>17:06</h><r>gfredericks</r>It could exist, but might not be immediately useful since you couldn&apos;t easily pick out the failing args. Do you have another use case?</z><z id="t1523378085" t="Joe Lane I had another instance of a recurring dream last night. The word cloud looks like this: clojure.spec generative testing + consumer driven contracts (like http://pact.io ) except for libraries, not web apis + spec-ish type-system-ish code inspection/analysis (e.g. (-&gt; (makes-random-int) expects-only-odds) would be analyzed and the system would show there is a problem) + service for publishing specs to a public repository. The big thing here is consumer driven contracts for function apis. A library author could know the expectations of its consumers based on properties they provide, and then know if they make a breaking change or not."><y>#</y><d>2018-04-10</d><h>16:34</h><w>Joe Lane</w>I had another instance of a recurring dream last night. The word cloud looks like this: clojure.spec generative testing + consumer driven contracts (like <a href="http://pact.io" target="_blank">http://pact.io</a>) except for libraries, not web apis + spec-ish type-system-ish code inspection/analysis (e.g. <code>(-&gt; (makes-random-int) expects-only-odds)</code> would be analyzed and the system would show there is a problem) + service for publishing specs to a public repository. 

The big thing here is consumer driven contracts for function apis. A library author could know the expectations of its consumers based on properties they provide, and then know if they make a breaking change or not.</z><z id="t1523378119" t="Joe Lane There are a LOT of conflated ideas here, please dont take this as a proper description of all goals."><y>#</y><d>2018-04-10</d><h>16:35</h><w>Joe Lane</w>There are a LOT of conflated ideas here, please dont take this as a proper description of all goals.</z><z id="t1523378353" t="Joe Lane I suppose the ideas are 1. consumer driven contracts for public library functions 2. analysis of clojure programs using spec to determine areas for potential bugs 3. maven for specs."><y>#</y><d>2018-04-10</d><h>16:39</h><w>Joe Lane</w>I suppose the ideas are 1. consumer driven contracts for public library functions 2. analysis of clojure programs using spec to determine areas for potential bugs 3. maven for specs.</z><z id="t1523378435" t="Joe Lane The reason I’m asking is about inputs and outputs is to create a system like haskell’s hoogle ( https://www.haskell.org/hoogle/ ) with spec."><y>#</y><d>2018-04-10</d><h>16:40</h><w>Joe Lane</w>The reason I’m asking is about inputs and outputs is to create a system like haskell’s hoogle (<a href="https://www.haskell.org/hoogle/" target="_blank">https://www.haskell.org/hoogle/</a>) with spec.</z><z id="t1523378487" t="Joe Lane Thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] !"><y>#</y><d>2018-04-10</d><h>16:41</h><w>Joe Lane</w>Thanks <a>@gfredericks</a>!</z><z id="t1523379312" t="grzm [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] The way something like that could work is if consumers published specs that the upstream author could consume, and those specs would have to be more constrained versions of the specs the author already publishes. The upstream author could swap those more specialized specs in their own tests. That reminds me of &quot;specialization by constraint&quot; in Date and Darwen&apos;s &quot;Databases, Types, and the Relational Model&quot;. I&apos;m not well-versed in type-theory in general, so it might have other names, but that&apos;s where I came across it."><y>#</y><d>2018-04-10</d><h>16:55</h><w>grzm</w><a>@lanejo01</a> The way something like that could work is if consumers published specs that the upstream author could consume, and those specs would have to be more constrained versions of the specs the author already publishes. The upstream author could swap those more specialized specs in their own tests. That reminds me of &quot;specialization by constraint&quot; in Date and Darwen&apos;s &quot;Databases, Types, and the Relational Model&quot;. I&apos;m not well-versed in type-theory in general, so it might have other names, but that&apos;s where I came across it.</z><z id="t1523379388" t="grzm The idea there is that any proper subtype is only a subtype if it satisfies the definition of its parent type plus some additional specialization constraint."><y>#</y><d>2018-04-10</d><h>16:56</h><w>grzm</w>The idea there is that any proper subtype is only a subtype if it satisfies the definition of its parent type plus some additional specialization constraint.</z><z id="t1523379431" t="Joe Lane That’s exactly how http://pact.io does it, except with json and regex, not something more expressive like spec + edn."><y>#</y><d>2018-04-10</d><h>16:57</h><w>Joe Lane</w>That’s exactly how <a href="http://pact.io" target="_blank">http://pact.io</a> does it, except with json and regex, not something more expressive like spec + edn.</z><z id="t1523379704" t="grzm How would &quot;maven for specs&quot; be different from maven (or similar tool) in general? Specs are code and just like when you use a library, you still need to know the names of the functions (or specs) once you have it."><y>#</y><d>2018-04-10</d><h>17:01</h><w>grzm</w>How would &quot;maven for specs&quot; be different from maven (or similar tool) in general? Specs are code and just like when you use a library, you still need to know the names of the functions (or specs) once you have it.</z><z id="t1523380426" t="Joe Lane It was a bit of a mischaracterization of what I’m going after ( which, is admittedly, a moving target). It’s more about a place for consumer “contracts” to be placed. In addition to that, the idea of a central place that I can look up what functions take this input and produce this output could be really exciting for a variety of reasons. Not so much maven for specs. Sorry for the confusion."><y>#</y><d>2018-04-10</d><h>17:13</h><w>Joe Lane</w>It was a bit of a mischaracterization of what I’m going after ( which, is admittedly, a moving target). It’s more about a place for consumer “contracts” to be placed. In addition to that, the idea of a central place that I can look up what functions take this input and produce this output could be really exciting for a variety of reasons. Not so much maven for specs. Sorry for the confusion.</z><z id="t1523728339" t="nwjsmith I think I&apos;ve asked this before, but I&apos;m writing some (non-shrinking) generators that rely on generating uniformly random numbers. Is there any way to get a uniformly random number generated?"><y>#</y><d>2018-04-14</d><h>17:52</h><w>nwjsmith</w>I think I&apos;ve asked this before, but I&apos;m writing some (non-shrinking) generators that rely on generating uniformly random numbers. Is there any way to get a uniformly random number generated?</z><z id="t1523728374" t="nwjsmith Are any of the provided generators uniformly random? (i.e. gen/bytes ?)"><y>#</y><d>2018-04-14</d><h>17:52</h><w>nwjsmith</w>Are any of the provided generators uniformly random? (i.e. <code>gen/bytes</code>?)</z><z id="t1523728391" t="nwjsmith If so, I might be able to fmap my way into a random number"><y>#</y><d>2018-04-14</d><h>17:53</h><w>nwjsmith</w>If so, I might be able to <code>fmap</code> my way into a random number</z><z id="t1523728715" t="nwjsmith Err, never mind. I might not want a uniform random number here"><y>#</y><d>2018-04-14</d><h>17:58</h><w>nwjsmith</w>Err, never mind. I might not want a uniform random number here</z><z id="t1523728871" t="gfredericks In any case, gen/choose is such a thing, for smaller ranges"><y>#</y><d>2018-04-14</d><h>18:01</h><w>gfredericks</w>In any case, gen/choose is such a thing, for smaller ranges</z><z id="t1523728886" t="gfredericks I&apos;ve thought about adding something more robust for integers and doubles"><y>#</y><d>2018-04-14</d><h>18:01</h><w>gfredericks</w>I&apos;ve thought about adding something more robust for integers and doubles</z><z id="t1523729174" t="nwjsmith FWIW I&apos;m generating a probability between 0.0 and 1.0, a double."><y>#</y><d>2018-04-14</d><h>18:06</h><w>nwjsmith</w>FWIW I&apos;m generating a probability between 0.0 and 1.0, a double.</z><z id="t1523729308" t="gfredericks But not uniform?"><y>#</y><d>2018-04-14</d><h>18:08</h><w>gfredericks</w>But not uniform?</z><z id="t1523729455" t="nwjsmith I don&apos;t think it needs to be. It&apos;s a generator for a graph&apos;s adjacency matrix. It is the probability that one vertex is adjacent to another."><y>#</y><d>2018-04-14</d><h>18:10</h><w>nwjsmith</w>I don&apos;t think it needs to be. It&apos;s a generator for a graph&apos;s adjacency matrix. It is the probability that one vertex is adjacent to another.</z><z id="t1523729480" t="nwjsmith So an argument could be made that the most simple graph is the fully disconnected one"><y>#</y><d>2018-04-14</d><h>18:11</h><w>nwjsmith</w>So an argument could be made that the most simple graph is the fully disconnected one</z><z id="t1523729492" t="nwjsmith (i.e. the probabilities are all 0.0"><y>#</y><d>2018-04-14</d><h>18:11</h><w>nwjsmith</w>(i.e. the probabilities are all 0.0</z><z id="t1523729494" t="gfredericks Yeah that makes sense"><y>#</y><d>2018-04-14</d><h>18:11</h><w>gfredericks</w>Yeah that makes sense</z><z id="t1523729518" t="gfredericks I wonder what gen/double does in that range"><y>#</y><d>2018-04-14</d><h>18:11</h><w>gfredericks</w>I wonder what gen/double does in that range</z><z id="t1523729534" t="gfredericks It might bias toward 1 at first"><y>#</y><d>2018-04-14</d><h>18:12</h><w>gfredericks</w>It might bias toward 1 at first</z><z id="t1523729574" t="gfredericks If so you can fmap with #(- 1 %) to get the opposite"><y>#</y><d>2018-04-14</d><h>18:12</h><w>gfredericks</w>If so you can fmap with #(- 1 %) to get the opposite</z><z id="t1523729682" t="nwjsmith Yeah, with a sample of 1000 I get 101 occurrences of 1.0 and 19 occurrences of 0.0 ."><y>#</y><d>2018-04-14</d><h>18:14</h><w>nwjsmith</w>Yeah, with a sample of 1000 I get 101 occurrences of <code>1.0</code> and 19 occurrences of <code>0.0</code>.</z><z id="t1523729730" t="gfredericks That might be misleading"><y>#</y><d>2018-04-14</d><h>18:15</h><w>gfredericks</w>That might be misleading</z><z id="t1523729757" t="gfredericks fmap to #(long (* 10 %)) and see what you get"><y>#</y><d>2018-04-14</d><h>18:15</h><w>gfredericks</w>fmap to #(long (* 10 %)) and see what you get</z><z id="t1523729784" t="gfredericks It probably considers 0 and 1 simpler than everything in between"><y>#</y><d>2018-04-14</d><h>18:16</h><w>gfredericks</w>It probably considers 0 and 1 simpler than everything in between</z><z id="t1523729819" t="nwjsmith {1 39, 0 698}"><y>#</y><d>2018-04-14</d><h>18:16</h><w>nwjsmith</w><code>{1 39, 0 698}</code></z><z id="t1523729869" t="gfredericks Nothing from 2 to 10?"><y>#</y><d>2018-04-14</d><h>18:17</h><w>gfredericks</w>Nothing from 2 to 10?</z><z id="t1523729894" t="nwjsmith {0 700, 7 25, 1 39, 4 23, 6 14, 3 26, 2 31, 9 6, 5 36, 10 87, 8 13}"><y>#</y><d>2018-04-14</d><h>18:18</h><w>nwjsmith</w><code>{0 700, 7 25, 1 39, 4 23, 6 14, 3 26, 2 31, 9 6, 5 36, 10 87, 8 13}</code></z><z id="t1523729906" t="nwjsmith Are the full frequencies"><y>#</y><d>2018-04-14</d><h>18:18</h><w>nwjsmith</w>Are the full frequencies</z><z id="t1523729973" t="gfredericks So mostly 0, because that&apos;s simpler, and next is 1.0, then 0.5, ..."><y>#</y><d>2018-04-14</d><h>18:19</h><w>gfredericks</w>So mostly 0, because that&apos;s simpler, and next is 1.0, then 0.5, ...</z><z id="t1523730041" t="nwjsmith Looks like gen/double* will do just fine"><y>#</y><d>2018-04-14</d><h>18:20</h><w>nwjsmith</w>Looks like <code>gen/double*</code> will do just fine</z><z id="t1523730464" t="gfredericks Are you actually trying to generate probabilities, or trying to generate the graph itself?"><y>#</y><d>2018-04-14</d><h>18:27</h><w>gfredericks</w>Are you actually trying to generate probabilities, or trying to generate the graph itself?</z><z id="t1523735290" t="nwjsmith Generate the graph itself. I generate an adjacency matrix like this: [[0.0 0.0 0.0 0.0] [P.1 0.0 0.0 0.0] [P.2 P.3 0.0 0.0] [P.4 P.5 P.6 0.0]] "><y>#</y><d>2018-04-14</d><h>19:48</h><w>nwjsmith</w>Generate the graph itself. I generate an adjacency matrix like this:

<pre>[[0.0 0.0 0.0 0.0]
 [P.1 0.0 0.0 0.0]
 [P.2 P.3 0.0 0.0]
 [P.4 P.5 P.6 0.0]]
</pre></z><z id="t1523735358" t="nwjsmith Where P1 -`P6` are probabilities. This adjacency matrix ends up representing a random DAG."><y>#</y><d>2018-04-14</d><h>19:49</h><w>nwjsmith</w>Where <code>P1</code>-`P6` are probabilities. This adjacency matrix ends up representing a random DAG.</z><z id="t1523735430" t="nwjsmith I map this probability matrix into a matrix where the values can be true /`false` based on whether or not the probability is above 0.5"><y>#</y><d>2018-04-14</d><h>19:50</h><w>nwjsmith</w>I map this probability matrix into a matrix where the values can be <code>true</code>/`false` based on whether or not the probability is above <code>0.5</code></z><z id="t1523735599" t="nwjsmith I have another generator that takes a DAG and generates a random topological ordering from it. It&apos;s also based on random number generation using gen/choose , but the range is small enough that it should be uniform."><y>#</y><d>2018-04-14</d><h>19:53</h><w>nwjsmith</w>I have another generator that takes a DAG and generates a random topological ordering from it. It&apos;s also based on random number generation using <code>gen/choose</code>, but the range is small enough that it should be uniform.</z><z id="t1523735862" t="nwjsmith Both are looking good: (let [g (gen/generate (gen-directed-acyclic-graph (seq &quot;ABCD&quot;))) t (frequencies (gen/sample (gen-topological-ordering g) 1000))] (when (not-empty g) (println t) ( (loom.graph/digraph g)))) Produced: https://www.dropbox.com/s/q0rkqfy7z0vffs6/png223331814782198197.png?dl=0 and the topological orderings: {[C B D A] 122, [D B A C] 117, [B D A C] 115, [D B C A] 127, [B D C A] 135, [C D B A] 132, [D C B A] 137, [B C D A] 115} "><y>#</y><d>2018-04-14</d><h>19:57</h><w>nwjsmith</w>Both are looking good:

<pre>(let [g (gen/generate (gen-directed-acyclic-graph (seq &quot;ABCD&quot;)))
       t (frequencies (gen/sample (gen-topological-ordering g) 1000))]
   (when (not-empty g)
     (println t)
     ( (loom.graph/digraph g))))
</pre>

Produced: <a href="https://www.dropbox.com/s/q0rkqfy7z0vffs6/png223331814782198197.png?dl=0" target="_blank">https://www.dropbox.com/s/q0rkqfy7z0vffs6/png223331814782198197.png?dl=0</a>

and the topological orderings:

<pre>{[C B D A] 122,
 [D B A C] 117,
 [B D A C] 115,
 [D B C A] 127,
 [B D C A] 135,
 [C D B A] 132,
 [D C B A] 137,
 [B C D A] 115}
</pre></z><z id="t1523735993" t="gfredericks Cool"><y>#</y><d>2018-04-14</d><h>19:59</h><w>gfredericks</w>Cool</z><z id="t1523886859" t="ghadi very cool. [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] could you share your code for the graph or topological-ordering?"><y>#</y><d>2018-04-16</d><h>13:54</h><w>ghadi</w>very cool. <a>@nwjsmith</a> could you share your code for the graph or topological-ordering?</z><z id="t1523886948" t="nwjsmith [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I&apos;ll try to get a repo up tonight or tomorrow, they should be fairly general-purpose. I&apos;ll ping you here when it&apos;s up"><y>#</y><d>2018-04-16</d><h>13:55</h><w>nwjsmith</w><a>@ghadi</a> I&apos;ll try to get a repo up tonight or tomorrow, they should be fairly general-purpose. I&apos;ll ping you here when it&apos;s up</z><z id="t1523937250" t="mathpunk I was trying to deal with this bug ( https://github.com/clojure-emacs/cider/issues/1841 ), and in investigating it I discovered that test.check refers to a namespace that it doesn&apos;t have in the definition of test-context-stacktrace : https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/clojure_test/assertions.cljc#L12"><y>#</y><d>2018-04-17</d><h>03:54</h><w>mathpunk</w>I was trying to deal with this bug (<a href="https://github.com/clojure-emacs/cider/issues/1841" target="_blank">https://github.com/clojure-emacs/cider/issues/1841</a>), and in investigating it I discovered that <code>test.check</code> refers to a namespace that it doesn&apos;t have in the definition of <code>test-context-stacktrace</code>: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/clojure_test/assertions.cljc#L12" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/clojure_test/assertions.cljc#L12</a></z><z id="t1523937307" t="mathpunk I commented that line out, and my problem went away. It&apos;s not clear to me how to contribute or report that so, I&apos;m mentioning it here"><y>#</y><d>2018-04-17</d><h>03:55</h><w>mathpunk</w>I commented that line out, and my problem went away. It&apos;s not clear to me how to contribute or report that so, I&apos;m mentioning it here</z><z id="t1523937477" t="mathpunk As I look at it more closely, I doubt it&apos;s that exact spot that helped; but, there are definitely several references to a clojure.test.check.clojure-test namespace. I see only a clojure_test directory, but no namespace"><y>#</y><d>2018-04-17</d><h>03:57</h><w>mathpunk</w>As I look at it more closely, I doubt it&apos;s that exact spot that helped; but, there are definitely several references to a <code>clojure.test.check.clojure-test</code> namespace. I see only a <code>clojure_test</code> directory, but no namespace</z><z id="t1523938733" t="Alex Miller (Clojure team) that’s due to someone monkey-patching clojure.test"><y>#</y><d>2018-04-17</d><h>04:18</h><w>Alex Miller (Clojure team)</w>that’s due to someone monkey-patching clojure.test</z><z id="t1523938737" t="Alex Miller (Clojure team) leiningen does that"><y>#</y><d>2018-04-17</d><h>04:18</h><w>Alex Miller (Clojure team)</w>leiningen does that</z><z id="t1523938740" t="Alex Miller (Clojure team) maybe others"><y>#</y><d>2018-04-17</d><h>04:19</h><w>Alex Miller (Clojure team)</w>maybe others</z><z id="t1523938805" t="Alex Miller (Clojure team) https://github.com/technomancy/leiningen/issues/2173"><y>#</y><d>2018-04-17</d><h>04:20</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/technomancy/leiningen/issues/2173" target="_blank">https://github.com/technomancy/leiningen/issues/2173</a></z><z id="t1523938838" t="Alex Miller (Clojure team) and https://dev.clojure.org/jira/browse/TCHECK-113"><y>#</y><d>2018-04-17</d><h>04:20</h><w>Alex Miller (Clojure team)</w>and <a href="https://dev.clojure.org/jira/browse/TCHECK-113" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-113</a></z><z id="t1523939343" t="mathpunk While I did see this, I don&apos;t quiiiiite know what it means, nor what it implies about my project being a boot project"><y>#</y><d>2018-04-17</d><h>04:29</h><w>mathpunk</w>While I did see this, I don&apos;t quiiiiite know what it means, nor what it implies about my project being a boot project</z><z id="t1523939424" t="mathpunk I&apos;ve heard the term but only the context of 1) Ruby objects and 2) disapproval. Sometimes at once~"><y>#</y><d>2018-04-17</d><h>04:30</h><w>mathpunk</w>I&apos;ve heard the term but only the context of 1) Ruby objects and 2) disapproval. Sometimes at once~</z><z id="t1523939535" t="Alex Miller (Clojure team) well this may be something similar but different, not sure. Leiningen reaches in and replaces the implementation of part of clojure.test, which breaks test.check’s expectation."><y>#</y><d>2018-04-17</d><h>04:32</h><w>Alex Miller (Clojure team)</w>well this may be something similar but different, not sure. Leiningen reaches in and replaces the implementation of part of clojure.test, which breaks test.check’s expectation.</z><z id="t1523939551" t="Alex Miller (Clojure team) that’s a pretty dirty trick imo :)"><y>#</y><d>2018-04-17</d><h>04:32</h><w>Alex Miller (Clojure team)</w>that’s a pretty dirty trick imo :)</z><z id="t1523975968" t="nwjsmith [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] https://github.com/nwjsmith/generators.graph"><y>#</y><d>2018-04-17</d><h>14:39</h><w>nwjsmith</w><a>@ghadi</a> <a href="https://github.com/nwjsmith/generators.graph" target="_blank">https://github.com/nwjsmith/generators.graph</a></z><z id="t1523976092" t="ghadi Nice [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] . That will be very useful, also good learning material."><y>#</y><d>2018-04-17</d><h>14:41</h><w>ghadi</w>Nice <a>@nwjsmith</a>. That will be very useful, also good learning material.</z><z id="t1523976160" t="nwjsmith I&apos;ll try to spruce it up a bit this week. I think there&apos;s a ton of performance improvements available too, so I&apos;d like to get some benchmarks around it."><y>#</y><d>2018-04-17</d><h>14:42</h><w>nwjsmith</w>I&apos;ll try to spruce it up a bit this week. I think there&apos;s a ton of performance improvements available too, so I&apos;d like to get some benchmarks around it.</z><z id="t1524254220" t="devn If i want to generate a double with limited precision, how do?"><y>#</y><d>2018-04-20</d><h>19:57</h><w>devn</w>If i want to generate a double with limited precision, how do?</z><z id="t1524254446" t="gfredericks Expressed in base 10 or base 2?"><y>#</y><d>2018-04-20</d><h>20:00</h><w>gfredericks</w>Expressed in base 10 or base 2?</z><z id="t1524254506" t="gfredericks And do you mean precision relative to the fixed decimal point, or in the floating point sense?"><y>#</y><d>2018-04-20</d><h>20:01</h><w>gfredericks</w>And do you mean precision relative to the fixed decimal point, or in the floating point sense?</z><z id="t1524254529" t="gfredericks (like is 1e-100 high precision?)"><y>#</y><d>2018-04-20</d><h>20:02</h><w>gfredericks</w>(like is 1e-100 high precision?)</z><z id="t1524254553" t="devn yes, relative to the fixed decimal point"><y>#</y><d>2018-04-20</d><h>20:02</h><w>devn</w>yes, relative to the fixed decimal point</z><z id="t1524254555" t="devn base 10"><y>#</y><d>2018-04-20</d><h>20:02</h><w>devn</w>base 10</z><z id="t1524254581" t="gfredericks I&apos;d generate an integer and divide it by 100.0 probably"><y>#</y><d>2018-04-20</d><h>20:03</h><w>gfredericks</w>I&apos;d generate an integer and divide it by 100.0 probably</z><z id="t1524254594" t="gfredericks With fmap"><y>#</y><d>2018-04-20</d><h>20:03</h><w>gfredericks</w>With fmap</z><z id="t1524254594" t="devn thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2018-04-20</d><h>20:03</h><w>devn</w>thanks <a>@gfredericks</a></z><z id="t1524254600" t="gfredericks 👍"><y>#</y><d>2018-04-20</d><h>20:03</h><w>gfredericks</w><b>👍</b></z><z id="t1524254632" t="gfredericks Obligatory warning about how doubles can&apos;t precisely represent most of those numbers"><y>#</y><d>2018-04-20</d><h>20:03</h><w>gfredericks</w>Obligatory warning about how doubles can&apos;t precisely represent most of those numbers</z><z id="t1524327939" t="mathpunk I found something unclear in the documentation for test.chuck . I guess it could be a bug but I think it&apos;s more likely I&apos;m holding generators wrong. In particular, I&apos;m trying out the checking macro"><y>#</y><d>2018-04-21</d><h>16:25</h><w>mathpunk</w>I found something unclear in the documentation for <code>test.chuck</code>. I guess it could be a bug but I think it&apos;s more likely I&apos;m holding generators wrong. In particular, I&apos;m trying out the <code>checking</code> macro</z><z id="t1524327992" t="mathpunk When I tested this myself---"><y>#</y><d>2018-04-21</d><h>16:26</h><w>mathpunk</w>When I tested this myself---</z><z id="t1524328164" t="mathpunk So the surprising bit is, why does it work fine if I get my generator with (s/gen int?) and fail if I get (what I think is) the same generator via gen/int ?"><y>#</y><d>2018-04-21</d><h>16:29</h><w>mathpunk</w>So the surprising bit is, why does it work fine if I get my generator with <code>(s/gen int?)</code> and fail if I get (what I think is) the same generator via <code>gen/int</code>?</z><z id="t1524328199" t="gfredericks how does it fail?"><y>#</y><d>2018-04-21</d><h>16:29</h><w>gfredericks</w>how does it fail?</z><z id="t1524328208" t="gfredericks oh sorry"><y>#</y><d>2018-04-21</d><h>16:30</h><w>gfredericks</w>oh sorry</z><z id="t1524328213" t="gfredericks only saw the first five lines of the snippet"><y>#</y><d>2018-04-21</d><h>16:30</h><w>gfredericks</w>only saw the first five lines of the snippet</z><z id="t1524328290" t="gfredericks I&apos;m guessing gen/ refers to clojure.spec.gen.alpha or something of that sort"><y>#</y><d>2018-04-21</d><h>16:31</h><w>gfredericks</w>I&apos;m guessing <code>gen/</code> refers to <code>clojure.spec.gen.alpha</code> or something of that sort</z><z id="t1524328309" t="gfredericks and that this is the inevitable confusion that stems from the fact that spec generally deals with 0-arg functions that return generators"><y>#</y><d>2018-04-21</d><h>16:31</h><w>gfredericks</w>and that this is the inevitable confusion that stems from the fact that spec generally deals with 0-arg functions that return generators</z><z id="t1524328326" t="gfredericks while http://test.ch[eu]ck deals with vanilla generators"><y>#</y><d>2018-04-21</d><h>16:32</h><w>gfredericks</w>while <a href="http://test.ch[eu]ck" target="_blank">http://test.ch[eu]ck</a> deals with vanilla generators</z><z id="t1524328332" t="gfredericks try (gen/int)"><y>#</y><d>2018-04-21</d><h>16:32</h><w>gfredericks</w>try <code>(gen/int)</code></z><z id="t1524328355" t="mathpunk yep, that did it"><y>#</y><d>2018-04-21</d><h>16:32</h><w>mathpunk</w>yep, that did it</z><z id="t1524328425" t="mathpunk i can attempt to fix that doc if you like, though I haven&apos;t forked-and-pulled much open source"><y>#</y><d>2018-04-21</d><h>16:33</h><w>mathpunk</w>i can attempt to fix that doc if you like, though I haven&apos;t forked-and-pulled much open source</z><z id="t1524328462" t="gfredericks which doc?"><y>#</y><d>2018-04-21</d><h>16:34</h><w>gfredericks</w>which doc?</z><z id="t1524328484" t="gfredericks the checking docs are referring to the clojure.test.check.generators namespace"><y>#</y><d>2018-04-21</d><h>16:34</h><w>gfredericks</w>the <code>checking</code> docs are referring to the <code>clojure.test.check.generators</code> namespace</z><z id="t1524328495" t="gfredericks if you used that namespace instead, gen/int would work and (gen/int) wouldn&apos;t"><y>#</y><d>2018-04-21</d><h>16:34</h><w>gfredericks</w>if you used that namespace instead, <code>gen/int</code> would work and <code>(gen/int)</code> wouldn&apos;t</z><z id="t1524328642" t="mathpunk I&apos;m looking here: https://github.com/gfredericks/test.chuck/blob/master/src/com/gfredericks/test/chuck/clojure_test.cljc#L108"><y>#</y><d>2018-04-21</d><h>16:37</h><w>mathpunk</w>I&apos;m looking here: <a href="https://github.com/gfredericks/test.chuck/blob/master/src/com/gfredericks/test/chuck/clojure_test.cljc#L108" target="_blank">https://github.com/gfredericks/test.chuck/blob/master/src/com/gfredericks/test/chuck/clojure_test.cljc#L108</a></z><z id="t1524328709" t="mathpunk Mind you I&apos;ve been working on untangling the differences among: - clojure.test - test.check - test.chuck - test.check.clojure-test - clojure.spec.alpha.test ...so maybe I&apos;m confusing the hammers I should be using"><y>#</y><d>2018-04-21</d><h>16:38</h><w>mathpunk</w>Mind you I&apos;ve been working on untangling the differences among:
- clojure.test
- test.check
- test.chuck
- test.check.clojure-test
- clojure.spec.alpha.test
...so maybe I&apos;m confusing the hammers I should be using</z><z id="t1524328899" t="gfredericks the problem is that there are two different namespaces that you&apos;ll see aliased as gen/"><y>#</y><d>2018-04-21</d><h>16:41</h><w>gfredericks</w>the problem is that there are two different namespaces that you&apos;ll see aliased as <code>gen/</code></z><z id="t1524328909" t="gfredericks one in test.check and one in clojure.spec"><y>#</y><d>2018-04-21</d><h>16:41</h><w>gfredericks</w>one in test.check and one in clojure.spec</z></g><g id="s6"><z id="t1524328931" t="gfredericks the namespace in clojure.spec mostly exists to alias the namespace in test.check"><y>#</y><d>2018-04-21</d><h>16:42</h><w>gfredericks</w>the namespace in clojure.spec mostly exists to alias the namespace in test.check</z><z id="t1524328955" t="gfredericks with the added confusion that it has functions that return generators instead of generators"><y>#</y><d>2018-04-21</d><h>16:42</h><w>gfredericks</w>with the added confusion that it has functions that return generators instead of generators</z><z id="t1524328995" t="gfredericks I would alias the clojure.spec namespace as sgen just to keep things straight"><y>#</y><d>2018-04-21</d><h>16:43</h><w>gfredericks</w>I would alias the clojure.spec namespace as <code>sgen</code> just to keep things straight</z><z id="t1524329011" t="gfredericks so gen/int is the same as (sgen/int)"><y>#</y><d>2018-04-21</d><h>16:43</h><w>gfredericks</w>so <code>gen/int</code> is the same as <code>(sgen/int)</code></z><z id="t1524329377" t="mathpunk I see. Do they have different purposes? Or is clojure.spec an alpha because it&apos;s absorbing test.check but hasn&apos;t fully digested it yet?"><y>#</y><d>2018-04-21</d><h>16:49</h><w>mathpunk</w>I see. Do they have different purposes? Or is clojure.spec an alpha because it&apos;s absorbing test.check but hasn&apos;t fully digested it yet?</z><z id="t1524329403" t="gfredericks the purpose of the spec namespace is to lazily load test.check only when necessary, so you don&apos;t need to have it as a production dependency"><y>#</y><d>2018-04-21</d><h>16:50</h><w>gfredericks</w>the purpose of the spec namespace is to lazily load test.check only when necessary, so you don&apos;t need to have it as a production dependency</z><z id="t1524329420" t="gfredericks that&apos;s also the reason for the functions-that-return-generators thing"><y>#</y><d>2018-04-21</d><h>16:50</h><w>gfredericks</w>that&apos;s also the reason for the functions-that-return-generators thing</z><z id="t1524329422" t="mathpunk ohhhhh huh, ok"><y>#</y><d>2018-04-21</d><h>16:50</h><w>mathpunk</w>ohhhhh huh, ok</z><z id="t1524329447" t="mathpunk because specs have some use in production code"><y>#</y><d>2018-04-21</d><h>16:50</h><w>mathpunk</w>because specs have some use in production code</z><z id="t1524329587" t="mathpunk Thanks--- there&apos;s a lot of polysemy going on in the terms test spec gen and check as I try and develop a sensible workflow for spec-driving"><y>#</y><d>2018-04-21</d><h>16:53</h><w>mathpunk</w>Thanks--- there&apos;s a lot of polysemy going on in the terms <code>test</code> <code>spec</code> <code>gen</code> and <code>check</code> as I try and develop a sensible workflow for spec-driving</z><z id="t1524329663" t="gfredericks it needs a good blog post or something"><y>#</y><d>2018-04-21</d><h>16:54</h><w>gfredericks</w>it needs a good blog post or something</z><z id="t1524330044" t="mathpunk I may be able to contribute to the beginners&apos; end of the topic. The comments I&apos;m writing to myself may become a post on a repl-to-gen-tests workflow with cognitect/transcriptor and test.chuck"><y>#</y><d>2018-04-21</d><h>17:00</h><w>mathpunk</w>I may be able to contribute to the beginners&apos; end of the topic. The comments I&apos;m writing to myself may become a post on a repl-to-gen-tests workflow with <code>cognitect/transcriptor</code> and <code>test.chuck</code></z><z id="t1524330064" t="mathpunk Not gonna touch when a gen is a gen and when a gen is a thunk"><y>#</y><d>2018-04-21</d><h>17:01</h><w>mathpunk</w>Not gonna touch when a gen is a gen and when a gen is a thunk</z><z id="t1527140337" t="flowthing Is there a better way to write this? (gen/fmap (partial reduce merge) (gen/vector (gen/let [id gen/uuid x (gen/hash-map :name gen/string)] {id (assoc x :id id)}))) That is, generate maps where the key is the same as the :id in the map in the value. That works fine and doesn&apos;t seem too bad to me — just wondering."><y>#</y><d>2018-05-24</d><h>05:38</h><w>flowthing</w>Is there a better way to write this?

<pre>(gen/fmap (partial reduce merge)
                          (gen/vector
                            (gen/let [id gen/uuid
                                      x  (gen/hash-map :name gen/string)]
                              {id (assoc x :id id)})))
</pre>

That is, generate maps where the key is the same as the <code>:id</code> in the map in the value. That works fine and doesn&apos;t seem too bad to me — just wondering.</z><z id="t1527158283" t="gfredericks if it were me I would be using plumbing and so I&apos;d have this function around to make it slightly cleaner: https://github.com/plumatic/plumbing/blob/6d713472f7324344545aa93597cb2a137b3404b3/src/plumbing/core.cljx#L91"><y>#</y><d>2018-05-24</d><h>10:38</h><w>gfredericks</w>if it were me I would be using plumbing and so I&apos;d have this function around to make it slightly cleaner: <a href="https://github.com/plumatic/plumbing/blob/6d713472f7324344545aa93597cb2a137b3404b3/src/plumbing/core.cljx#L91" target="_blank">https://github.com/plumatic/plumbing/blob/6d713472f7324344545aa93597cb2a137b3404b3/src/plumbing/core.cljx#L91</a></z><z id="t1527158341" t="gfredericks so it becomes (gen/fmap #(map-from-vals :id %) (gen/vector gen-a-map-with-an-id))"><y>#</y><d>2018-05-24</d><h>10:39</h><w>gfredericks</w>so it becomes <code>(gen/fmap #(map-from-vals :id %) (gen/vector gen-a-map-with-an-id))</code></z><z id="t1527158511" t="gfredericks which I guess means it also seems natural to me to pull out the map generator and give it a name"><y>#</y><d>2018-05-24</d><h>10:41</h><w>gfredericks</w>which I guess means it also seems natural to me to pull out the map generator and give it a name</z><z id="t1527455737" t="gfredericks 0.10.0-alpha3 is out https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha3-2018-05-27"><y>#</y><d>2018-05-27</d><h>21:15</h><w>gfredericks</w><code>0.10.0-alpha3</code> is out <a href="https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha3-2018-05-27" target="_blank">https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown#0100-alpha3-2018-05-27</a></z><z id="t1527455755" t="gfredericks it&apos;s crazy how much stuff can be done without doing any of the stuff I want to do"><y>#</y><d>2018-05-27</d><h>21:15</h><w>gfredericks</w>it&apos;s crazy how much stuff can be done without doing any of the stuff I want to do</z><z id="t1527455806" t="gfredericks thank you to everybody who&apos;s contributed"><y>#</y><d>2018-05-27</d><h>21:16</h><w>gfredericks</w>thank you to everybody who&apos;s contributed</z><z id="t1530035395" t="ghadi What&apos;s the most idiomatic way to make a generator from a source function (like a constructor)?"><y>#</y><d>2018-06-26</d><h>17:49</h><w>ghadi</w>What&apos;s the most idiomatic way to make a generator from a source function (like a constructor)?</z><z id="t1530037189" t="ghadi (gen/fmap (fn [f] (f)) (gen/return some-constructor)) Seems oblique to say fmap &quot;apply thyself&quot;"><y>#</y><d>2018-06-26</d><h>18:19</h><w>ghadi</w><pre>(gen/fmap (fn [f] (f)) (gen/return some-constructor))</pre>
Seems oblique to say fmap &quot;apply thyself&quot;</z><z id="t1530037565" t="gfredericks that example might be too simple to express your problem, because you can rewrite it as (gen/return (some-constructor))"><y>#</y><d>2018-06-26</d><h>18:26</h><w>gfredericks</w>that example might be too simple to express your problem, because you can rewrite it as <code>(gen/return (some-constructor))</code></z><z id="t1530037574" t="gfredericks unless the constructor is nondeterministic"><y>#</y><d>2018-06-26</d><h>18:26</h><w>gfredericks</w>unless the constructor is nondeterministic</z><z id="t1530037588" t="ghadi I want to generate fresh instances"><y>#</y><d>2018-06-26</d><h>18:26</h><w>ghadi</w>I want to generate fresh instances</z><z id="t1530037608" t="ghadi (the constructor returns a reify)"><y>#</y><d>2018-06-26</d><h>18:26</h><w>ghadi</w>(the constructor returns a reify)</z><z id="t1530037615" t="gfredericks is this with spec?"><y>#</y><d>2018-06-26</d><h>18:26</h><w>gfredericks</w>is this with spec?</z><z id="t1530037652" t="ghadi yes"><y>#</y><d>2018-06-26</d><h>18:27</h><w>ghadi</w>yes</z><z id="t1530037686" t="gfredericks in general it&apos;s not idiomatic in test.check to be generating non-values, so spec exposes a bit of a mismatch here"><y>#</y><d>2018-06-26</d><h>18:28</h><w>gfredericks</w>in general it&apos;s not idiomatic in test.check to be generating non-values, so spec exposes a bit of a mismatch here</z><z id="t1530037698" t="gfredericks but I suppose I&apos;ve heard similar things from alex about spec"><y>#</y><d>2018-06-26</d><h>18:28</h><w>gfredericks</w>but I suppose I&apos;ve heard similar things from alex about spec</z><z id="t1530037759" t="gfredericks so due to all that, there&apos;s not a more idiomatic way to do what you&apos;re doing"><y>#</y><d>2018-06-26</d><h>18:29</h><w>gfredericks</w>so due to all that, there&apos;s not a more idiomatic way to do what you&apos;re doing</z><z id="t1530037789" t="gfredericks you might even have to be careful about the same instance getting reused during shrinking"><y>#</y><d>2018-06-26</d><h>18:29</h><w>gfredericks</w>you might even have to be careful about the same instance getting reused during shrinking</z><z id="t1530037817" t="gfredericks I&apos;m 87% sure that&apos;s what would happen if you compose this with other generators"><y>#</y><d>2018-06-26</d><h>18:30</h><w>gfredericks</w>I&apos;m 87% sure that&apos;s what would happen if you compose this with other generators</z><z id="t1530037893" t="ghadi Interesting.... Thanks Gary"><y>#</y><d>2018-06-26</d><h>18:31</h><w>ghadi</w>Interesting.... Thanks Gary</z><z id="t1530038000" t="gfredericks 👍 this might be an interesting thing to point out in the spec channel"><y>#</y><d>2018-06-26</d><h>18:33</h><w>gfredericks</w><b>👍</b> this might be an interesting thing to point out in the spec channel</z><z id="t1530437916" t="jfacorro Hi 🙂 . I&apos;ve been working on porting test.check to Clojure on Erlang VM. I&apos;m pretty much done but I was wondering what&apos;s the relationship between test.check and test.generative . I&apos;ve noticed that spec.alpha uses test.check and that&apos;s partly why I ported the library (because I want to port spec.alpha as well), but test.generative seems to be used in tests for clojure-1.9.0 ."><y>#</y><d>2018-07-01</d><h>09:38</h><w>jfacorro</w>Hi <b>🙂</b>. I&apos;ve been working on porting <code>test.check</code> to Clojure on Erlang VM. I&apos;m pretty much done but I was wondering what&apos;s the relationship between <code>test.check</code> and <code>test.generative</code>. I&apos;ve noticed that <code>spec.alpha</code> uses <code>test.check</code> and that&apos;s partly why I ported the library (because I want to port <code>spec.alpha</code> as well), but <code>test.generative</code> seems to be used in tests for  <code>clojure-1.9.0</code>.</z><z id="t1530437982" t="jfacorro I guess what I&apos;m trying to ask is if test.check is a superset of test.generative (which I think it is) or if they are different in some fundamental way I&apos;m missing."><y>#</y><d>2018-07-01</d><h>09:39</h><w>jfacorro</w>I guess what I&apos;m trying to ask is if <code>test.check</code> is a superset of <code>test.generative</code> (which I think it is) or if they are different in some fundamental way I&apos;m missing.</z><z id="t1530440733" t="jfacorro I can see there is no shrinking in test.generative"><y>#</y><d>2018-07-01</d><h>10:25</h><w>jfacorro</w>I can see there is no shrinking in <code>test.generative</code></z><z id="t1530451292" t="gfredericks tg predates tc"><y>#</y><d>2018-07-01</d><h>13:21</h><w>gfredericks</w>tg predates tc</z><z id="t1530451304" t="gfredericks I don&apos;t think tg is used much anymore"><y>#</y><d>2018-07-01</d><h>13:21</h><w>gfredericks</w>I don&apos;t think tg is used much anymore</z><z id="t1530456286" t="jfacorro I see that c.t.g it is being used for tests in clojure/clojure , so is c.t.c it seems"><y>#</y><d>2018-07-01</d><h>14:44</h><w>jfacorro</w>I see that <code>c.t.g</code> it is being used for tests in <code>clojure/clojure</code>, so is <code>c.t.c</code> it seems</z><z id="t1530456288" t="jfacorro ¯\(ツ)/¯"><y>#</y><d>2018-07-01</d><h>14:44</h><w>jfacorro</w>¯\(ツ)/¯</z><z id="t1530456853" t="gfredericks yes, the tg tests were added before tc existed"><y>#</y><d>2018-07-01</d><h>14:54</h><w>gfredericks</w>yes, the tg tests were added before tc existed</z><z id="t1530456877" t="gfredericks I expect those could be converted, but changes to the core codebase aren&apos;t normally accepted unless they provide a lot of value"><y>#</y><d>2018-07-01</d><h>14:54</h><w>gfredericks</w>I expect those could be converted, but changes to the core codebase aren&apos;t normally accepted unless they provide a lot of value</z><z id="t1530457506" t="jfacorro I see, thank you 🙂"><y>#</y><d>2018-07-01</d><h>15:05</h><w>jfacorro</w>I see, thank you <b>🙂</b></z><z id="t1530880149" t="Hukka strgen helpfully mentions test.chuck for more comprehensive regex support. But is there then any reason to not use test.chuck always?"><y>#</y><d>2018-07-06</d><h>12:29</h><w>Hukka</w>strgen helpfully mentions test.chuck for more comprehensive regex support. But is there then any reason to not use test.chuck always?</z><z id="t1530881281" t="gfredericks test.chuck isn&apos;t an alternative to test.check, it&apos;s a pile of miscellaneous utilities to go with it"><y>#</y><d>2018-07-06</d><h>12:48</h><w>gfredericks</w>test.chuck isn&apos;t an alternative to test.check, it&apos;s a pile of miscellaneous utilities to go with it</z><z id="t1530881305" t="gfredericks so it&apos;s fine to have it around if you want, but if you&apos;re not using any of its parts then it&apos;s not providing any value"><y>#</y><d>2018-07-06</d><h>12:48</h><w>gfredericks</w>so it&apos;s fine to have it around if you want, but if you&apos;re not using any of its parts then it&apos;s not providing any value</z><z id="t1530881306" t="Hukka Sure. I&apos;m mostly looking for helpers to generate the input"><y>#</y><d>2018-07-06</d><h>12:48</h><w>Hukka</w>Sure. I&apos;m mostly looking for helpers to generate the input</z><z id="t1530881347" t="Hukka strgen is purely for making strings based on regexes, but mentions that test.chuck has more comprehensive support. I was just wondering is there ever any reason to use that, instead of test.chuck"><y>#</y><d>2018-07-06</d><h>12:49</h><w>Hukka</w>strgen is purely for making strings based on regexes, but mentions that test.chuck has more comprehensive support. I was just wondering is there ever any reason to use that, instead of test.chuck</z><z id="t1530881435" t="gfredericks oh I&apos;m sorry"><y>#</y><d>2018-07-06</d><h>12:50</h><w>gfredericks</w>oh I&apos;m sorry</z><z id="t1530881440" t="gfredericks I missed the part about strgen"><y>#</y><d>2018-07-06</d><h>12:50</h><w>gfredericks</w>I missed the part about strgen</z><z id="t1530881501" t="gfredericks it looks like strgen targets portability?"><y>#</y><d>2018-07-06</d><h>12:51</h><w>gfredericks</w>it looks like strgen targets portability?</z><z id="t1530881510" t="gfredericks i.e., it probably works in cljs"><y>#</y><d>2018-07-06</d><h>12:51</h><w>gfredericks</w>i.e., it probably works in cljs</z><z id="t1530881529" t="gfredericks there&apos;s a half-pull-request in test.chuck for adding cljs support, but it needs some more work"><y>#</y><d>2018-07-06</d><h>12:52</h><w>gfredericks</w>there&apos;s a half-pull-request in test.chuck for adding cljs support, but it needs some more work</z><z id="t1530881651" t="Hukka I see, thanks! Good to know – though for now I&apos;m just speccing the backend code, there&apos;s plenty of fiddly data munging on the frontend too"><y>#</y><d>2018-07-06</d><h>12:54</h><w>Hukka</w>I see, thanks! Good to know – though for now I&apos;m just speccing the backend code, there&apos;s plenty of fiddly data munging on the frontend too</z><z id="t1530890081" t="Hukka Not sure if this belongs here, as it&apos;s really a spec problem... but if running (stest/check) without any arguments gives an exception when check can&apos;t create any input that passes the input predicates, is there any way to know which specced function is causing problems?"><y>#</y><d>2018-07-06</d><h>15:14</h><w>Hukka</w>Not sure if this belongs here, as it&apos;s really a spec problem... but if running (stest/check) without any arguments gives an exception when check can&apos;t create any input that passes the input predicates, is there any way to know which specced function is causing problems?</z><z id="t1530917108" t="gfredericks lot more likely to be answered in the spec room I&apos;d wager"><y>#</y><d>2018-07-06</d><h>22:45</h><w>gfredericks</w>lot more likely to be answered in the spec room I&apos;d wager</z><z id="t1530917117" t="gfredericks they have over ten times more people"><y>#</y><d>2018-07-06</d><h>22:45</h><w>gfredericks</w>they have over ten times more people</z><z id="t1532104705" t="ghadi https://twitter.com/smashthepast/status/1020347051589144578"><y>#</y><d>2018-07-20</d><h>16:38</h><w>ghadi</w><a href="https://twitter.com/smashthepast/status/1020347051589144578" target="_blank">https://twitter.com/smashthepast/status/1020347051589144578</a></z><z id="t1532105005" t="gfredericks 👍"><y>#</y><d>2018-07-20</d><h>16:43</h><w>gfredericks</w><b>👍</b></z><z id="t1532110222" t="gfredericks not to mention if you get a rare failure you&apos;ll have a hard time reproducing it unless you&apos;re logging the generated value"><y>#</y><d>2018-07-20</d><h>18:10</h><w>gfredericks</w>not to mention if you get a rare failure you&apos;ll have a hard time reproducing it unless you&apos;re logging the generated value</z><z id="t1537277458" t="arohner Is there a good way to generate a lazy sequence? I want to reduce the seq until a specific condition is met"><y>#</y><d>2018-09-18</d><h>13:30</h><w>arohner</w>Is there a good way to generate a lazy sequence? I want to <code>reduce</code> the seq until a specific condition is met</z><z id="t1537311677" t="gfredericks what aspect of laziness is important to you in this case?"><y>#</y><d>2018-09-18</d><h>23:01</h><w>gfredericks</w>what aspect of laziness is important to you in this case?</z><z id="t1537311699" t="gfredericks you can make whatever you want with gen/fmap"><y>#</y><d>2018-09-18</d><h>23:01</h><w>gfredericks</w>you can make whatever you want with <code>gen/fmap</code></z><z id="t1537311717" t="gfredericks were you hoping for an infinitely random sequence?"><y>#</y><d>2018-09-18</d><h>23:01</h><w>gfredericks</w>were you hoping for an infinitely random sequence?</z><z id="t1539368326" t="Kayla In this snippet, frequency evals render too early. I think I need mutually recursive generators, and don’t want to lose the ability to shrink. If it actually ran it wouldn’t go on forever, but instead it explodes the stack. Anybody have any ideas? (letfn [(render [] (tcgen/frequency [[1 (gen/tuple (render))] [15 (gen/return [])]]))] (gen/generate (render))) "><y>#</y><d>2018-10-12</d><h>18:18</h><w>Kayla</w>In this snippet, <code>frequency</code> evals <code>render</code> too early. I think I need mutually recursive generators, and don’t want to lose the ability to shrink. If it actually ran it wouldn’t go on forever, but instead it explodes the stack. Anybody have any ideas?
<pre>(letfn [(render []
          (tcgen/frequency [[1 (gen/tuple (render))]
                            [15 (gen/return [])]]))]
  (gen/generate (render)))
</pre></z><z id="t1539371089" t="hiredman the problem isn&apos;t frequency"><y>#</y><d>2018-10-12</d><h>19:04</h><w>hiredman</w>the problem isn&apos;t frequency</z><z id="t1539371120" t="hiredman frequency is a function, so all the arguments are evaluated before the function is called"><y>#</y><d>2018-10-12</d><h>19:05</h><w>hiredman</w>frequency is a function, so all the arguments are evaluated before the function is called</z><z id="t1539371166" t="taylor what kinda output are you hoping to get out of that. nested, empty vectors? [:attrs {:href &quot;/_/_/users/U6K67AGSF&quot;}]"><y>#</y><d>2018-10-12</d><h>19:06</h><w>taylor</w>what kinda output are you hoping to get out of that. nested, empty vectors? <a>@sean</a></z><z id="t1539371168" t="hiredman you may want to checkout gen/recursive-gen"><y>#</y><d>2018-10-12</d><h>19:06</h><w>hiredman</w>you may want to checkout gen/recursive-gen</z><z id="t1539374411" t="Kayla [:attrs {:href &quot;/_/_/users/U3DAE8HMG&quot;}] I distilled my problem down to this. I am generating a tree where any given node’s children’s generator is dependent on the node that produces it. Also, some nodes must have children, and some must not. Also some of the data in the child needs to be consistent with what was generated the parent. Then the thing that breaks it is some nodes can have children of the same type, which use the same generator. I am trying to make a generator for the whole tree. So a generator for a node might produce something like: {:id 1 :parent-id 0 :type :foo} Nodes of type :foo can have children of types :bar and :foo . The generators for the potential children of this node would produce something that looks like: {:id 2 :parent-id 1 :type :foo} or {:id 2 :parent-id 1 :type :bar :another-quality &quot;junk&quot;}"><y>#</y><d>2018-10-12</d><h>20:00</h><w>Kayla</w><a>@taylor</a> I distilled my problem down to this.

I am generating a tree where any given node’s children’s generator is dependent on the node that produces it. Also, some nodes must have children, and some must not. Also some of the data in the child needs to be consistent with what was generated the parent. Then the thing that breaks it is some nodes can have children of the same type, which use the same generator.

I am trying to make a generator for the whole tree.

So a generator for a node might produce something like: <code>{:id 1 :parent-id 0 :type :foo}</code>
Nodes of type <code>:foo</code> can have children of types <code>:bar</code> and <code>:foo</code>.
The generators for the potential children of this node would produce something that looks like: <code>{:id 2 :parent-id 1 :type :foo}</code> or <code>{:id 2 :parent-id 1 :type :bar :another-quality &quot;junk&quot;}</code></z><z id="t1539375489" t="taylor are the child nodes associated inside the parent nodes? or are they all in one big sequence and only correlated by :id and :parent-id ?"><y>#</y><d>2018-10-12</d><h>20:18</h><r>taylor</r>are the child nodes associated inside the parent nodes? or are they all in one big sequence and only correlated by <code>:id</code> and <code>:parent-id</code>?</z><z id="t1539375509" t="Kayla One big sequence "><y>#</y><d>2018-10-12</d><h>20:18</h><r>Kayla</r>One big sequence </z><z id="t1539374464" t="Kayla :bar nodes have no children."><y>#</y><d>2018-10-12</d><h>20:01</h><w>Kayla</w><code>:bar</code> nodes have no children.</z><z id="t1539375414" t="gfredericks You could use recursive-gen to get the structure, then fmap the whole thing to fix up consistency issues"><y>#</y><d>2018-10-12</d><h>20:16</h><w>gfredericks</w>You could use recursive-gen to get the structure, then fmap the whole thing to fix up consistency issues</z><z id="t1539375583" t="hiredman (defn type-foo [g] (gen/let [children (gen/vector g)] (gen/return {:id 1 :parent-id 0 :type :foo :children children}))) (defn type-bar [g] (gen/return {:id 2 :parent-id 1 :type :bar :another-quality &quot;junk&quot;})) (defn foo-bar-tree [_] (gen/recursive (fn [g] (gen/one-of (type-foo g) (type-bar g))) (type-bar nil))) "><y>#</y><d>2018-10-12</d><h>20:19</h><w>hiredman</w><pre>(defn type-foo [g]
  (gen/let [children (gen/vector g)]
    (gen/return
     {:id 1 :parent-id 0 :type :foo :children children})))

(defn type-bar [g]
  (gen/return
   {:id 2 :parent-id 1 :type :bar :another-quality &quot;junk&quot;}))


(defn foo-bar-tree [_]
  (gen/recursive
   (fn [g]
     (gen/one-of (type-foo g)
                 (type-bar g)))
   (type-bar nil)))
</pre></z><z id="t1539376051" t="hiredman I will say often times it is easier to generate instructions to build a complex datastructure then it is to generate the datastructure. so for example if you wanted a tree of files in directories, it might be easier to generate a list of create file, move file, create directory, delete, etc, then just interpret that list to get some tree, instead of generating the tree"><y>#</y><d>2018-10-12</d><h>20:27</h><w>hiredman</w>I will say often times it is easier to generate instructions to build a complex datastructure then it is to generate the datastructure. so for example if you wanted a tree of files in directories, it might be easier to generate a list of create file, move file, create directory, delete, etc, then just interpret that list to get some tree, instead of generating the tree</z><z id="t1539377707" t="taylor [:attrs {:href &quot;/_/_/users/U6K67AGSF&quot;}] even though you want a flat sequence of maps, you could maybe do something like this with recursive-gen: (gen/sample (gen/recursive-gen (fn [g] (gen/let [{:keys [id type] :as m} (s/gen ::my-map) children (gen/vector g)] (if (= :bar type) m (update m :children concat (map #(assoc % :parent-id id) children))))) (s/gen ::my-map)) 100) then you could fmap over that generator to flatten and fix-up the ID relations: (gen/sample (gen/fmap (fn [m] (map #(dissoc % :children) (tree-seq #(seq (:children %)) :children m))) (gen/recursive-gen (fn [g] (gen/let [m (s/gen ::my-map) children (gen/vector g)] (if (= :bar (:type m)) m (update m :children concat (map #(assoc % :parent-id (:id m)) children))))) (s/gen ::my-map)))) although I think this still leaves you with a problem of non-unique IDs"><y>#</y><d>2018-10-12</d><h>20:55</h><w>taylor</w><a>@sean</a> even though you want a flat sequence of maps, you could maybe do something like this with recursive-gen:
<pre>(gen/sample
  (gen/recursive-gen
    (fn [g]
      (gen/let [{:keys [id type] :as m} (s/gen ::my-map)
                children (gen/vector g)]
        (if (= :bar type)
          m
          (update m :children concat (map #(assoc % :parent-id id) children)))))
    (s/gen ::my-map))
  100)</pre>
then you could <code>fmap</code> over that generator to flatten and fix-up the ID relations:
<pre>(gen/sample
  (gen/fmap
    (fn [m]
      (map #(dissoc % :children)
           (tree-seq #(seq (:children %)) :children m)))
    (gen/recursive-gen
      (fn [g]
        (gen/let [m (s/gen ::my-map)
                  children (gen/vector g)]
          (if (= :bar (:type m))
            m
            (update m :children concat (map #(assoc % :parent-id (:id m)) children)))))
      (s/gen ::my-map))))</pre>
although I think this still leaves you with a problem of non-unique IDs</z><z id="t1539377781" t="taylor oh and I used some specs for the map generator: (s/def ::id pos-int?) (s/def ::type #{:foo :bar}) (s/def ::parent-id ::id) (s/def ::my-map (s/keys :req-un [::id ::type ::parent-id])) "><y>#</y><d>2018-10-12</d><h>20:56</h><w>taylor</w>oh and I used some specs for the map generator:
<pre>(s/def ::id pos-int?)
(s/def ::type #{:foo :bar})
(s/def ::parent-id ::id)
(s/def ::my-map (s/keys :req-un [::id ::type ::parent-id]))
</pre></z><z id="t1539379355" t="Kayla Thanks Everybody for all the help. I’m signing off for the weekend. "><y>#</y><d>2018-10-12</d><h>21:22</h><w>Kayla</w>Thanks Everybody for all the help. I’m signing off for the weekend. </z><z id="t1542079977" t="steveb8n I find it tricky to quickly find the cause when I get “clojure.lang.ExceptionInfo: Couldn’t satisfy such-that predicate after 100 tries. {}” back from generators. I can find it using binary search but is there a better technique for debugging these generator errors?"><y>#</y><d>2018-11-13</d><h>03:32</h><w>steveb8n</w>I find it tricky to quickly find the cause when I get “clojure.lang.ExceptionInfo: Couldn’t satisfy such-that predicate after 100 tries. {}” back from generators. I can find it using binary search but is there a better technique for debugging these generator errors?</z><z id="t1542113536" t="gfredericks [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] is this a (gen/such-that ...) that you wrote yourself, or that spec wrote for you?"><y>#</y><d>2018-11-13</d><h>12:52</h><w>gfredericks</w><a>@steveb8n</a> is this a <code>(gen/such-that ...)</code> that you wrote yourself, or that spec wrote for you?</z><z id="t1542142979" t="steveb8n [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] using gens from specs (I hardly ever use such-that gens). To me this is the hardest part of using generators so any tricks (or context data in the error) would help"><y>#</y><d>2018-11-13</d><h>21:02</h><w>steveb8n</w><a>@gfredericks</a> using gens from specs (I hardly ever use such-that gens). To me this is the hardest part of using generators so any tricks (or context data in the error) would help</z><z id="t1542143723" t="gfredericks [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] there&apos;s a ticket somewhere describing that problem I think -- I added extra optional args to gen/such-that so that spec could add explanatory information to exceptions, but I don&apos;t believe that&apos;s been taken advantage of by spec."><y>#</y><d>2018-11-13</d><h>21:15</h><w>gfredericks</w><a>@steveb8n</a> there&apos;s a ticket somewhere describing that problem I think -- I added extra optional args to <code>gen/such-that</code> so that spec could add explanatory information to exceptions, but I don&apos;t believe that&apos;s been taken advantage of by spec.</z><z id="t1542143735" t="gfredericks and in any case it&apos;s only released in the alpha versions 😕"><y>#</y><d>2018-11-13</d><h>21:15</h><w>gfredericks</w>and in any case it&apos;s only released in the alpha versions <b>😕</b></z><z id="t1542143750" t="gfredericks someday I should just give up and release whatever&apos;s on master so at least there&apos;s not that problem anymore"><y>#</y><d>2018-11-13</d><h>21:15</h><w>gfredericks</w>someday I should just give up and release whatever&apos;s on master so at least there&apos;s not that problem anymore</z><z id="t1542143987" t="steveb8n hah, I thought this might be the case. I also thought that providing useful debug data would be tricky since specs can vary wildly. in lieu of that, how do you hunt these down? binary search (with knowledge of the specs to guide you) or some other cleverness?"><y>#</y><d>2018-11-13</d><h>21:19</h><w>steveb8n</w>hah, I thought this might be the case. I also thought that providing useful debug data would be tricky since specs can vary wildly. in lieu of that, how do you hunt these down? binary search (with knowledge of the specs to guide you) or some other cleverness?</z><z id="t1542144222" t="gfredericks I haven&apos;t personally used spec a lot I think knowing that s/and is the most likely culprit is usually helpful"><y>#</y><d>2018-11-13</d><h>21:23</h><w>gfredericks</w>I haven&apos;t personally used spec a lot

I think knowing that <code>s/and</code> is the most likely culprit is usually helpful</z><z id="t1542144314" t="gfredericks and thinking about generation whenever you write s/and in the first place"><y>#</y><d>2018-11-13</d><h>21:25</h><w>gfredericks</w>and thinking about generation whenever you write <code>s/and</code> in the first place</z><z id="t1542151427" t="steveb8n true that. I am using s/and extensively. I’ll ponder that a little. Thanks."><y>#</y><d>2018-11-13</d><h>23:23</h><w>steveb8n</w>true that. I am using s/and extensively. I’ll ponder that a little. Thanks.</z><z id="t1547364949" t="Ho0man Hi everyone, is there a way I could fill the :result-data field in test reports? (So when they fail I could have a structured failure report)"><y>#</y><d>2019-01-13</d><h>07:35</h><w>Ho0man</w>Hi everyone, is there a way I could fill the <code>:result-data</code> field in test reports?
(So when they fail I could have a structured failure report)</z><z id="t1547393449" t="gfredericks [:attrs {:href &quot;/_/_/users/U6CE37RK6&quot;}] yes, you have to return something that implements the protocol in clojure.test.check.results I think"><y>#</y><d>2019-01-13</d><h>15:30</h><w>gfredericks</w><a>@ho0man</a> yes, you have to return something that implements the protocol in <code>clojure.test.check.results</code>

I think</z><z id="t1547393464" t="gfredericks you could use (reify ...) for that"><y>#</y><d>2019-01-13</d><h>15:31</h><w>gfredericks</w>you could use <code>(reify ...)</code> for that</z><z id="t1547396141" t="Ho0man [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] , thanks I’ll try that"><y>#</y><d>2019-01-13</d><h>16:15</h><w>Ho0man</w><a>@gfredericks</a> , thanks I’ll try that</z><z id="t1548358438" t="pablore Hi. I need to generate some data based on a normal distribution. How can I do that with test.check?"><y>#</y><d>2019-01-24</d><h>19:33</h><w>pablore</w>Hi. I need to generate some data based on a normal distribution. How can I do that with test.check?</z><z id="t1548358630" t="gfredericks [:attrs {:href &quot;/_/_/users/U7V9HE682&quot;}] you want to ignore the size parameter, I imagine? any desired shrinking behavior?"><y>#</y><d>2019-01-24</d><h>19:37</h><w>gfredericks</w><a>@pablore</a> you want to ignore the <code>size</code> parameter, I imagine?

any desired shrinking behavior?</z><z id="t1548358664" t="pablore I dont understand what you mean"><y>#</y><d>2019-01-24</d><h>19:37</h><w>pablore</w>I dont understand what you mean</z><z id="t1548358697" t="gfredericks size controls how generated values start simple and get more complex as you run more trials"><y>#</y><d>2019-01-24</d><h>19:38</h><w>gfredericks</w><code>size</code> controls how generated values start simple and get more complex as you run more trials</z><z id="t1548358709" t="gfredericks more details here: https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md"><y>#</y><d>2019-01-24</d><h>19:38</h><w>gfredericks</w>more details here: <a href="https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md" target="_blank">https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md</a></z><z id="t1548358781" t="pablore Ok this is more complex than I thought xd. I&apos;ll give it a read, thanks!"><y>#</y><d>2019-01-24</d><h>19:39</h><w>pablore</w>Ok this is more complex than I thought xd. I&apos;ll give it a read, thanks!</z><z id="t1548358887" t="gfredericks if you don&apos;t care all that much, I&apos;d say the easiest thing is to use gen/choose with 0 and Integer/MAX_VALUE and the gen/fmap with some function that converts a uniform distribution to a normal one"><y>#</y><d>2019-01-24</d><h>19:41</h><w>gfredericks</w>if you don&apos;t care all that much, I&apos;d say the easiest thing is to use <code>gen/choose</code> with <code>0</code> and <code>Integer/MAX_VALUE</code> and the <code>gen/fmap</code> with some function that converts a uniform distribution to a normal one</z><z id="t1548358902" t="gfredericks might help to divide by Integer/MAX_VALUE first I guess"><y>#</y><d>2019-01-24</d><h>19:41</h><w>gfredericks</w>might help to divide by <code>Integer/MAX_VALUE</code> first I guess</z><z id="t1548358906" t="gfredericks to get it between 0 and 1"><y>#</y><d>2019-01-24</d><h>19:41</h><w>gfredericks</w>to get it between 0 and 1</z><z id="t1548358930" t="pablore thanks"><y>#</y><d>2019-01-24</d><h>19:42</h><w>pablore</w>thanks</z><z id="t1548358964" t="gfredericks (the fact that my initial questions don&apos;t have obvious answers is part of why this isn&apos;t built-in)"><y>#</y><d>2019-01-24</d><h>19:42</h><w>gfredericks</w>(the fact that my initial questions don&apos;t have obvious answers is part of why this isn&apos;t built-in)</z><z id="t1548365180" t="aisamu Hi! I&apos;m trying to integrate test.chuck&apos;s checking into a cljs.test project. The readme points to a blog post where there is an example showing the full report on errors (vs. just one wrong result) Was that ever integrated into the official checking macro? I can&apos;t seem to make it work here. (The full report is terribly useful for fixing things that went wrong!)"><y>#</y><d>2019-01-24</d><h>21:26</h><w>aisamu</w>Hi!
I&apos;m trying to integrate test.chuck&apos;s <code>checking</code> into a cljs.test project.
The readme points to a blog post where there is an example showing the full report on errors (vs. just one wrong result)
Was that ever integrated into the official checking macro? I can&apos;t seem to make it work here.
(The full report is terribly useful for fixing things that went wrong!)</z><z id="t1548366181" t="gfredericks what do you mean by &quot;full report&quot;? I.e., what information is there? (I&apos;m fuzzy on all this)"><y>#</y><d>2019-01-24</d><h>21:43</h><w>gfredericks</w>what do you mean by &quot;full report&quot;? I.e., what information is there?

(I&apos;m fuzzy on all this)</z><z id="t1548371509" t="aisamu Oh, sorry for the delay! Here&apos;s the linked page - on the section &quot;Including Results&quot; you can see an example: http://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html I&apos;m only getting the second kind of output, instead of both (or just the first)"><y>#</y><d>2019-01-24</d><h>23:11</h><r>aisamu</r>Oh, sorry for the delay!
Here&apos;s the linked page - on the section &quot;Including Results&quot; you can see an example:
 <a href="http://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html" target="_blank">http://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html</a>

I&apos;m only getting the second kind of output, instead of both (or just the first)</z><z id="t1548371983" t="gfredericks maybe this commit removed it by accident? https://github.com/gfredericks/test.chuck/commit/b45fb4db83f66"><y>#</y><d>2019-01-24</d><h>23:19</h><r>gfredericks</r>maybe this commit removed it by accident? <a href="https://github.com/gfredericks/test.chuck/commit/b45fb4db83f66" target="_blank">https://github.com/gfredericks/test.chuck/commit/b45fb4db83f66</a></z><z id="t1548371997" t="gfredericks it&apos;s probably easy to interpret the output as accidentally oververbose"><y>#</y><d>2019-01-24</d><h>23:19</h><r>gfredericks</r>it&apos;s probably easy to interpret the output as accidentally oververbose</z><z id="t1548372316" t="gfredericks looking more closely, it&apos;s possible that the addition of the not-falsey-or-exception? call meant that the output originally intended wasn&apos;t happening at that point, so it really did look redundant"><y>#</y><d>2019-01-24</d><h>23:25</h><r>gfredericks</r>looking more closely, it&apos;s possible that the addition of the <code>not-falsey-or-exception?</code> call meant that the output originally intended wasn&apos;t happening at that point, so it really did look redundant</z><z id="t1548372398" t="gfredericks I think a PR that adds it back in would be okay, but a PR that adds custom reporting so that there&apos;s only one FAIL line printed instead of two would be even better, probably"><y>#</y><d>2019-01-24</d><h>23:26</h><r>gfredericks</r>I think a PR that adds it back in would be okay, but a PR that adds custom reporting so that there&apos;s only one <code>FAIL</code> line printed instead of two would be even better, probably</z><z id="t1548419139" t="aisamu Great, thanks for the guidance!"><y>#</y><d>2019-01-25</d><h>12:25</h><r>aisamu</r>Great, thanks for the guidance!</z><z id="t1548595012" t="dangercoder Do you guys use any external stateful things like a database (Redis) or do you create simulators for all of it? Lets say you want to create property based tests for a sequence of function calls that uses Redis."><y>#</y><d>2019-01-27</d><h>13:16</h><w>dangercoder</w>Do you guys use any external stateful things like a database (Redis) or do you create simulators for all of it? Lets say you want to create property based tests for a sequence of function calls that uses Redis.</z><z id="t1548595081" t="dangercoder I was thinking of just having a redis-test-instance and then I will &quot;Clean&quot; it after all tests are done running."><y>#</y><d>2019-01-27</d><h>13:18</h><r>dangercoder</r>I was thinking of just having a redis-test-instance and then I will &quot;Clean&quot; it after all tests are done running.</z><z id="t1548596638" t="gfredericks yeah you&apos;d want to effectively reset the database as part of your trial"><y>#</y><d>2019-01-27</d><h>13:43</h><w>gfredericks</w>yeah you&apos;d want to effectively reset the database as part of your trial</z><z id="t1548596653" t="gfredericks I&apos;ve certainly done that before you can find bugs in your database that way 🙂"><y>#</y><d>2019-01-27</d><h>13:44</h><w>gfredericks</w>I&apos;ve certainly done that before

you can find bugs in your database that way <b>🙂</b></z><z id="t1548596695" t="gfredericks but having to reset something in a different process can definitely lead to fairly slow tests, so you have to have some tolerance for that"><y>#</y><d>2019-01-27</d><h>13:44</h><w>gfredericks</w>but having to reset something in a different process can definitely lead to fairly slow tests, so you have to have some tolerance for that</z><z id="t1548608293" t="hiredman a year (maybe two?) ago we switched out the redis library we used at work, and I took all the operations we did using an old redis library and defined them as a protocol, then implemented that protocol on a concurrent hashmap and on the new redis library, then I wrote the thunderdome, which would take a generated list of redis operations and two things that satisfied the redis protocol and run those operations against them comparing the results."><y>#</y><d>2019-01-27</d><h>16:58</h><w>hiredman</w>a year (maybe two?) ago we switched out the redis library we used at work, and I took all the operations we did using an old redis library and defined them as a protocol, then implemented that protocol on a concurrent hashmap and on the new redis library, then I wrote the thunderdome, which would take a generated list of redis operations and two  things that satisfied the redis protocol and run those operations against them comparing the results.</z><z id="t1548608409" t="hiredman https://github.com/advancedtelematic/quickcheck-state-machine is super interesting"><y>#</y><d>2019-01-27</d><h>17:00</h><w>hiredman</w><a href="https://github.com/advancedtelematic/quickcheck-state-machine" target="_blank">https://github.com/advancedtelematic/quickcheck-state-machine</a> is super interesting</z><z id="t1548610796" t="gfredericks [:attrs {:href &quot;/_/_/users/U0NCTKEV8&quot;}] did you find bugs in redis?"><y>#</y><d>2019-01-27</d><h>17:39</h><w>gfredericks</w><a>@hiredman</a> did you find bugs in redis?</z><z id="t1548612221" t="hiredman I did not, I wasn&apos;t really exercising redis, the kind of api layer I pulled out, we aren&apos;t (weren&apos;t?) using redis all that much, but I wanted to make sure the operations behaved the same when moving from a higher level library (lots of built in serialization magic) to a lower level library (doing all the serialization ourselves). I think the protocol I ended up defining to encapsulate our redis use was maybe 4 functions"><y>#</y><d>2019-01-27</d><h>18:03</h><w>hiredman</w>I did not, I wasn&apos;t really exercising redis, the kind of api layer I pulled out, we aren&apos;t (weren&apos;t?) using redis all that much, but I wanted to make sure the operations behaved the same when moving from a higher level library (lots of built in serialization magic) to a lower level library (doing all the serialization ourselves). I think the protocol I ended up defining to encapsulate our redis use was maybe 4 functions</z><z id="t1548699036" t="wilkerlucio hello people, I just like to share something that I done and found cool, its about how to setup complex configurable generators, in my case I did a generator setup for building random EQL queries (its like the datomic pull syntax), the way I done is by sending to generators thenselves a map environment so the user could replace parts of it when is needed, I posted some docs about it here https://github.com/edn-query-language/eql#generation . [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I would love to know what you think about this approach, its you see as a good pattern or maybe you have a better way to do it, thanks all!"><y>#</y><d>2019-01-28</d><h>18:10</h><w>wilkerlucio</w>hello people, I just like to share something that I done and found cool, its about how to setup complex configurable generators, in my case I did a generator setup for building random EQL queries (its like the datomic pull syntax), the way I done is by sending to generators thenselves a map environment so the user could replace parts of it when is needed, I posted some docs about it here <a href="https://github.com/edn-query-language/eql#generation" target="_blank">https://github.com/edn-query-language/eql#generation</a>. <a>@gfredericks</a> I would love to know what you think about this approach, its you see as a good pattern or maybe you have a better way to do it, thanks all!</z><z id="t1548700205" t="gfredericks [:attrs {:href &quot;/_/_/users/U066U8JQJ&quot;}] what&apos;s the arg to those functions that&apos;s being ignored?"><y>#</y><d>2019-01-28</d><h>18:30</h><w>gfredericks</w><a>@wilkerlucio</a> what&apos;s the arg to those functions that&apos;s being ignored?</z><z id="t1548700314" t="wilkerlucio [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] you mean in the default generators? if the arg is ignored it means that generator is not relying on anything that can be customised, usually the leaves in the process, makes sense?"><y>#</y><d>2019-01-28</d><h>18:31</h><w>wilkerlucio</w><a>@gfredericks</a> you mean in the default generators? if the arg is ignored it means that generator is not relying on anything that can be customised, usually the leaves in the process, makes sense?</z><z id="t1548700347" t="gfredericks in the examples, you customize things with (fn [_] ...)"><y>#</y><d>2019-01-28</d><h>18:32</h><w>gfredericks</w>in the examples, you customize things with <code>(fn [_] ...)</code></z><z id="t1548700365" t="wilkerlucio ah, take a look this: https://github.com/edn-query-language/eql/blob/master/src/edn_query_language/core.cljc#L10-L121"><y>#</y><d>2019-01-28</d><h>18:32</h><w>wilkerlucio</w>ah, take a look this: <a href="https://github.com/edn-query-language/eql/blob/master/src/edn_query_language/core.cljc#L10-L121" target="_blank">https://github.com/edn-query-language/eql/blob/master/src/edn_query_language/core.cljc#L10-L121</a></z><z id="t1548700372" t="wilkerlucio here you can see some usages of the params"><y>#</y><d>2019-01-28</d><h>18:32</h><w>wilkerlucio</w>here you can see some usages of the params</z><z id="t1548700385" t="wilkerlucio in case you wanted to re-use something on the map, you could pull it from that argument"><y>#</y><d>2019-01-28</d><h>18:33</h><w>wilkerlucio</w>in case you wanted to re-use something on the map, you could pull it from that argument</z><z id="t1548700433" t="gfredericks ah I see"><y>#</y><d>2019-01-28</d><h>18:33</h><w>gfredericks</w>ah I see</z><z id="t1548700460" t="gfredericks I think you could use (constantly ...) instead of (fn [_] ...) , which would be &quot;more performant&quot; in a maybe-doesn&apos;t-matter sense"><y>#</y><d>2019-01-28</d><h>18:34</h><w>gfredericks</w>I think you could use <code>(constantly ...)</code> instead of <code>(fn [_] ...)</code>, which would be &quot;more performant&quot; in a maybe-doesn&apos;t-matter sense</z><z id="t1548700487" t="gfredericks depends on if the function gets called multiple times or not"><y>#</y><d>2019-01-28</d><h>18:34</h><w>gfredericks</w>depends on if the function gets called multiple times or not</z><z id="t1548700492" t="gfredericks which I can&apos;t tell at a glance"><y>#</y><d>2019-01-28</d><h>18:34</h><w>gfredericks</w>which I can&apos;t tell at a glance</z><z id="t1548700514" t="wilkerlucio interesting, I didn&apos;t knew constantly was faster, but really this is only used to build the generators, which is a rather quick operation compared to how much takes to run (and you can cache the built generator if needed to)"><y>#</y><d>2019-01-28</d><h>18:35</h><w>wilkerlucio</w>interesting, I didn&apos;t knew constantly was faster, but really this is only used to build the generators, which is a rather quick operation compared to how much takes to run (and you can cache the built generator if needed to)</z><z id="t1548700518" t="gfredericks but the general idea of passing a map of generator options down a whole tree of generators is a really good one I think, and one I&apos;ve thought about for test.check"><y>#</y><d>2019-01-28</d><h>18:35</h><w>gfredericks</w>but the general idea of passing a map of generator options down a whole tree of generators is a really good one I think, and one I&apos;ve thought about for test.check</z><z id="t1548700544" t="wilkerlucio yeah, I also found that to be a good way to control for depth, it worked quite well"><y>#</y><d>2019-01-28</d><h>18:35</h><w>wilkerlucio</w>yeah, I also found that to be a good way to control for depth, it worked quite well</z><z id="t1548700545" t="gfredericks constantly just means that the return value gets created once, compared to a fn where it gets created every time"><y>#</y><d>2019-01-28</d><h>18:35</h><w>gfredericks</w>constantly just means that the return value gets created once, compared to a <code>fn</code> where it gets created every time</z><z id="t1548700648" t="wilkerlucio ah, makes sense, so the generator will be only instantiated once per process"><y>#</y><d>2019-01-28</d><h>18:37</h><w>wilkerlucio</w>ah, makes sense, so the generator will be only instantiated once per process</z><z id="t1548700693" t="wilkerlucio at same time it would be always instantiated, even if the user doesn&apos;t use anything, seems doesn&apos;t matter much in the end :man-shrugging:"><y>#</y><d>2019-01-28</d><h>18:38</h><w>wilkerlucio</w>at same time it would be always instantiated, even if the user doesn&apos;t use anything, seems doesn&apos;t matter much in the end <b>:man-shrugging:</b></z><z id="t1548701153" t="gfredericks yep"><y>#</y><d>2019-01-28</d><h>18:45</h><w>gfredericks</w>yep</z><z id="t1549101864" t="cheatex Hi. I try to write a test and stuck with generator/bind semantics. Say I want to write a test map&apos;s get (my actual goal is more complex, this one just a good showcase)."><y>#</y><d>2019-02-02</d><h>10:04</h><w>cheatex</w>Hi. I try to write a test and stuck with generator/bind semantics. Say I want to write a test map&apos;s get (my actual goal is more complex, this one just a good showcase).</z><z id="t1549101895" t="cheatex Here is a generator for keys (defn keys-from [map] (gen/elements (keys map))) "><y>#</y><d>2019-02-02</d><h>10:04</h><w>cheatex</w>Here is a generator for keys
<pre>(defn keys-from [map]
  (gen/elements (keys map)))
</pre></z><z id="t1549101925" t="cheatex and i can use it like this (gen/sample (keys-from (gen/generate (gen/map gen/keyword gen/nat))))"><y>#</y><d>2019-02-02</d><h>10:05</h><w>cheatex</w>and i can use it like this
<pre>(gen/sample (keys-from (gen/generate (gen/map gen/keyword gen/nat))))</pre></z><z id="t1549101978" t="cheatex Now I can write a property (def prop-test (prop/for-all [map (gen/map gen/keyword gen/nat) key (keys-from map)] (get map key))) "><y>#</y><d>2019-02-02</d><h>10:06</h><w>cheatex</w>Now I can write a property
<pre>(def prop-test
  (prop/for-all [map (gen/map gen/keyword gen/nat)
                 key (keys-from map)]
                (get map key)))
</pre></z><z id="t1549102005" t="cheatex But checking it fails, claiming map isn&apos;t a seq"><y>#</y><d>2019-02-02</d><h>10:06</h><w>cheatex</w>But checking it fails, claiming <code>map</code> isn&apos;t a seq</z><z id="t1549102328" t="cheatex More precisely: https://gist.github.com/CheatEx/91659e49e5f6964aaf8a7a74529af287"><y>#</y><d>2019-02-02</d><h>10:12</h><w>cheatex</w>More precisely: <a href="https://gist.github.com/CheatEx/91659e49e5f6964aaf8a7a74529af287" target="_blank">https://gist.github.com/CheatEx/91659e49e5f6964aaf8a7a74529af287</a></z><z id="t1549102490" t="cheatex This from (defspec ..), (tc/quick-check 1 prop-test) yields completely different failure."><y>#</y><d>2019-02-02</d><h>10:14</h><w>cheatex</w>This from (defspec ..), (tc/quick-check 1 prop-test) yields completely different failure.</z><z id="t1549103231" t="cheatex My another attempt (defn keys-from-gen [map-gen] (gen/let [map (gen/such-that (complement empty?) map-gen)] (gen/elements (keys map)))) (gen/sample (keys-from-gen (gen/map gen/keyword gen/nat))) ; works well (def prop-test-gen (prop/for-all [map (gen/map gen/keyword gen/nat) key (keys-from-gen map)] (get map key))) (defspec map-gen-test 2 prop-test-gen) fails with Uncaught Error: Assert failed: Second arg to such-that must be a generator"><y>#</y><d>2019-02-02</d><h>10:27</h><w>cheatex</w>My another attempt
<pre>(defn keys-from-gen [map-gen]
  (gen/let [map (gen/such-that (complement empty?) map-gen)]
    (gen/elements (keys map))))

(gen/sample (keys-from-gen (gen/map gen/keyword gen/nat))) ; works well

(def prop-test-gen
  (prop/for-all [map (gen/map gen/keyword gen/nat)
                 key (keys-from-gen map)]
                (get map key)))

(defspec map-gen-test 2 prop-test-gen)
</pre>
fails with
<pre>Uncaught Error: Assert failed: Second arg to such-that must be a generator</pre></z><z id="t1549103320" t="cheatex So symbols in for-all bound to neither real values nor generators. I am totally confused. How do I write such property?"><y>#</y><d>2019-02-02</d><h>10:28</h><w>cheatex</w>So symbols in <code>for-all</code> bound to neither real values nor generators. I am totally confused. How do I write such property?</z><z id="t1549119884" t="gfredericks [:attrs {:href &quot;/_/_/users/U4E4FRDV0&quot;}] the confusion comes from the fact that the binding names in prop/for-all aren&apos;t visible at all to the expressions for subsequent bindings"><y>#</y><d>2019-02-02</d><h>15:04</h><w>gfredericks</w><a>@cheatex</a> the confusion comes from the fact that the binding names in <code>prop/for-all</code> aren&apos;t visible at all to the expressions for subsequent bindings</z><z id="t1549119892" t="gfredericks (i.e., they&apos;re all done &quot;in parallel&quot;)"><y>#</y><d>2019-02-02</d><h>15:04</h><w>gfredericks</w>(i.e., they&apos;re all done &quot;in parallel&quot;)</z><z id="t1549119919" t="gfredericks normally you&apos;d get whatever error you normally get when you use a name that&apos;s not visible, but in this case you&apos;re getting more confusing errors because you&apos;re happening to use the name map , which already means cljs.core/map"><y>#</y><d>2019-02-02</d><h>15:05</h><w>gfredericks</w>normally you&apos;d get whatever error you normally get when you use a name that&apos;s not visible, but in this case you&apos;re getting more confusing errors because you&apos;re happening to use the name <code>map</code>, which already means <code>cljs.core/map</code></z><z id="t1549119928" t="gfredericks so you&apos;re passing the map function to get"><y>#</y><d>2019-02-02</d><h>15:05</h><w>gfredericks</w>so you&apos;re passing the <code>map</code> function to <code>get</code></z><z id="t1549119965" t="gfredericks prop/for-all doesn&apos;t have a way to get the bind semantics, so you have to do this with an additional generator to help you compose things"><y>#</y><d>2019-02-02</d><h>15:06</h><w>gfredericks</w><code>prop/for-all</code> doesn&apos;t have a way to get the <code>bind</code> semantics, so you have to do this with an additional generator to help you compose things</z><z id="t1549120008" t="gfredericks (def gen-map-and-key (gen/let [m (gen/map gen/keyword gen/nat), k (keys-from-gen m)] {:map m :key k}))"><y>#</y><d>2019-02-02</d><h>15:06</h><w>gfredericks</w><code>(def gen-map-and-key (gen/let [m (gen/map gen/keyword gen/nat), k (keys-from-gen m)] {:map m :key k}))</code></z><z id="t1549120660" t="cheatex Thanks for the explanation."><y>#</y><d>2019-02-02</d><h>15:17</h><w>cheatex</w>Thanks for the explanation.</z><z id="t1549120788" t="cheatex I&apos;ve made this kind of generator for my problem, but i&apos;m not perfectly happy with it. It basically needs to generate a huge data structure to create a key for it... and than throw it away and create a new one just to make another key."><y>#</y><d>2019-02-02</d><h>15:19</h><w>cheatex</w>I&apos;ve made this kind of generator for my problem, but i&apos;m not perfectly happy with it. It basically needs to generate a huge data structure to create a key for it... and than throw it away and create a new one just to make another key.</z><z id="t1549120843" t="gfredericks For each trial, you mean?"><y>#</y><d>2019-02-02</d><h>15:20</h><w>gfredericks</w>For each trial, you mean?</z><z id="t1549120846" t="cheatex Is there a way to make few keys out of single generated map?"><y>#</y><d>2019-02-02</d><h>15:20</h><w>cheatex</w>Is there a way to make few keys out of single generated map?</z><z id="t1549120850" t="cheatex Yes"><y>#</y><d>2019-02-02</d><h>15:20</h><w>cheatex</w>Yes</z><z id="t1549120910" t="cheatex Probably, not sure of precise meaning of &quot;trial&quot; in test.check 🙂"><y>#</y><d>2019-02-02</d><h>15:21</h><w>cheatex</w>Probably, not sure of precise meaning of &quot;trial&quot; in test.check <b>🙂</b></z><z id="t1549121003" t="cheatex I&apos;ve had idea of generating [map [&amp;keys]] but that would make properties to be a huge and and hard to find exact failing key."><y>#</y><d>2019-02-02</d><h>15:23</h><w>cheatex</w>I&apos;ve had idea of generating [map [&amp;keys]] but that would make properties to be a huge <code>and</code> and hard to find exact failing key.</z><z id="t1549121069" t="gfredericks you don&apos;t have to spell out the and , you could use every?"><y>#</y><d>2019-02-02</d><h>15:24</h><w>gfredericks</w>you don&apos;t have to spell out the <code>and</code>, you could use <code>every?</code></z><z id="t1549121073" t="gfredericks e.g., you could check every key"><y>#</y><d>2019-02-02</d><h>15:24</h><w>gfredericks</w>e.g., you could check every key</z><z id="t1549121089" t="gfredericks and as long as the failing map entry is independent of the others, it should shrink to a singleton map"><y>#</y><d>2019-02-02</d><h>15:24</h><w>gfredericks</w>and as long as the failing map entry is independent of the others, it should shrink to a singleton map</z><z id="t1549121288" t="cheatex They won&apos;t be independent in my case."><y>#</y><d>2019-02-02</d><h>15:28</h><w>cheatex</w>They won&apos;t be independent in my case.</z><z id="t1549121323" t="gfredericks will it be somewhat independent? like should shrinking remove most of the entries?"><y>#</y><d>2019-02-02</d><h>15:28</h><w>gfredericks</w>will it be somewhat independent? like should shrinking remove most of the entries?</z><z id="t1549121427" t="gfredericks if that&apos;s a big problem, you could use the subsequence generator from this library https://github.com/gfredericks/test.chuck"><y>#</y><d>2019-02-02</d><h>15:30</h><w>gfredericks</w>if that&apos;s a big problem, you could use the <code>subsequence</code> generator from this library <a href="https://github.com/gfredericks/test.chuck" target="_blank">https://github.com/gfredericks/test.chuck</a></z><z id="t1549121436" t="gfredericks to get a subset of the keys"><y>#</y><d>2019-02-02</d><h>15:30</h><w>gfredericks</w>to get a subset of the keys</z><z id="t1549121445" t="gfredericks and then that would shrink to a subset with only one failing key"><y>#</y><d>2019-02-02</d><h>15:30</h><w>gfredericks</w>and then that would shrink to a subset with only one failing key</z><z id="t1549121793" t="cheatex Looks like it could do the trick"><y>#</y><d>2019-02-02</d><h>15:36</h><w>cheatex</w>Looks like it could do the trick</z><z id="t1549122031" t="cheatex But generally. Is it impossible to use some generated value to set up other generator, use both value and generator in a property and than go to new one?"><y>#</y><d>2019-02-02</d><h>15:40</h><w>cheatex</w>But generally. Is it impossible to use some generated value to set up other generator, use both value and generator in a property and than go to new one?</z><z id="t1549122089" t="gfredericks I&apos;m not sure what you mean by &quot;and than than go to new one&quot;"><y>#</y><d>2019-02-02</d><h>15:41</h><w>gfredericks</w>I&apos;m not sure what you mean by &quot;and than than go to new one&quot;</z><z id="t1549122144" t="cheatex I mean new value and derived generator"><y>#</y><d>2019-02-02</d><h>15:42</h><w>cheatex</w>I mean new value and derived generator</z><z id="t1549122278" t="cheatex So in my example when I run property check with size 50 it (just sample numbers to show magnitudes) generates 5 maps and 10 keys for every map."><y>#</y><d>2019-02-02</d><h>15:44</h><w>cheatex</w>So in my example when I run property check with size 50 it (just sample numbers to show magnitudes) generates 5 maps and 10 keys for every map.</z><z id="t1549122327" t="cheatex e.g. number of calls to first generator &lt;&lt; than number of calls to derived"><y>#</y><d>2019-02-02</d><h>15:45</h><w>cheatex</w>e.g. number of calls to first generator &lt;&lt; than number of calls to derived</z><z id="t1549122386" t="gfredericks there&apos;s a lot of ways to control the size or complexity of a generator"><y>#</y><d>2019-02-02</d><h>15:46</h><w>gfredericks</w>there&apos;s a lot of ways to control the size or complexity of a generator</z><z id="t1549122395" t="gfredericks it might help to look at https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md"><y>#</y><d>2019-02-02</d><h>15:46</h><w>gfredericks</w>it might help to look at <a href="https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md" target="_blank">https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md</a></z><z id="t1549122439" t="cheatex I&apos;ve seen it..."><y>#</y><d>2019-02-02</d><h>15:47</h><w>cheatex</w>I&apos;ve seen it...</z><z id="t1549122459" t="cheatex Probably I need to work out better example and problem statement."><y>#</y><d>2019-02-02</d><h>15:47</h><w>cheatex</w>Probably I need to work out better example and problem statement.</z><z id="t1549122500" t="cheatex Thank you anyway!"><y>#</y><d>2019-02-02</d><h>15:48</h><w>cheatex</w>Thank you anyway!</z><z id="t1549313668" t="dtsiedel Is there some sort of workaround to test private functions?"><y>#</y><d>2019-02-04</d><h>20:54</h><w>dtsiedel</w>Is there some sort of workaround to test private functions?</z><z id="t1549313746" t="gfredericks [:attrs {:href &quot;/_/_/users/UFMHWUULB&quot;}] #&apos; is the general workaround for that, not specific to test.check"><y>#</y><d>2019-02-04</d><h>20:55</h><w>gfredericks</w><a>@dts.siedel</a> <code>#&apos;</code> is the general workaround for that, not specific to test.check</z><z id="t1549313963" t="dtsiedel Ah I was afraid of that, it is pretty hacky in my eyes. Thanks for quick response [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2019-02-04</d><h>20:59</h><w>dtsiedel</w>Ah I was afraid of that, it is pretty hacky in my eyes. Thanks for quick response <a>@gfredericks</a></z><z id="t1549657296" t="nwjsmith If I upgrade test.check from 0.9.0 to 0.10.0, will the same seed still produce the same test values?"><y>#</y><d>2019-02-08</d><h>20:21</h><w>nwjsmith</w>If I upgrade test.check from 0.9.0 to 0.10.0, will the same seed still produce the same test values?</z><z id="t1549657346" t="nwjsmith (not specifically thinking about those versions, just checking my gut feeling. My gut feeling is that they won’t stay the same across test.check versions)"><y>#</y><d>2019-02-08</d><h>20:22</h><w>nwjsmith</w>(not specifically thinking about those versions, just checking my gut feeling. My gut feeling is that they won’t stay the same across test.check versions)</z><z id="t1549662667" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V32P6U&quot;}] that gut feeling is right, there&apos;s no attempt to preserve that, since sometimes changes involve improvements to a generator&apos;s distribution but in this particular case I think a lot of the lower-level generators will stay the same"><y>#</y><d>2019-02-08</d><h>21:51</h><w>gfredericks</w><a>@nwjsmith</a> that gut feeling is right, there&apos;s no attempt to preserve that, since sometimes changes involve improvements to a generator&apos;s distribution

but in this particular case I think a lot of the lower-level generators will stay the same</z><z id="t1549662688" t="gfredericks recursive-gen is the only one that I know for sure would be different"><y>#</y><d>2019-02-08</d><h>21:51</h><w>gfredericks</w>recursive-gen is the only one that I know for sure would be different</z><z id="t1549662700" t="gfredericks which I guess extends to gen/any and friends as well"><y>#</y><d>2019-02-08</d><h>21:51</h><w>gfredericks</w>which I guess extends to gen/any and friends as well</z><z id="t1549664585" t="nwjsmith good to know, thanks!"><y>#</y><d>2019-02-08</d><h>22:23</h><w>nwjsmith</w>good to know, thanks!</z><z id="t1549899401" t="Ajay hi, is it possible to make a generator from a custom lazy sequence? For practice, I was trying to use test-check to test FizzBuzz problem - I want a generator that returns multiples of 3 but not of 5 or 15"><y>#</y><d>2019-02-11</d><h>15:36</h><w>Ajay</w>hi, is it possible to make a generator from a custom lazy sequence? For practice, I was trying to use test-check to test FizzBuzz problem - I want a generator that returns multiples of 3 but not of 5 or 15</z><z id="t1549899529" t="gfredericks gen/such-that would suffice here for casual use"><y>#</y><d>2019-02-11</d><h>15:38</h><w>gfredericks</w>gen/such-that would suffice here for casual use</z><z id="t1549899571" t="Ajay but it gave up when I tried"><y>#</y><d>2019-02-11</d><h>15:39</h><w>Ajay</w>but it gave up when I tried</z><z id="t1549899908" t="gfredericks Give it a higher max-tries, like 100"><y>#</y><d>2019-02-11</d><h>15:45</h><w>gfredericks</w>Give it a higher max-tries, like 100</z><z id="t1549899944" t="Alex Miller (Clojure team) it’s help to invert your thinking for stuff like this"><y>#</y><d>2019-02-11</d><h>15:45</h><w>Alex Miller (Clojure team)</w>it’s help to invert your thinking for stuff like this</z><z id="t1549899968" t="Alex Miller (Clojure team) generate a number, then use fmap to multiply by 3 so you always generate multiples of 3"><y>#</y><d>2019-02-11</d><h>15:46</h><w>Alex Miller (Clojure team)</w>generate a number, then use fmap to multiply by 3 so you always generate multiples of 3</z><z id="t1549899992" t="Alex Miller (Clojure team) could then use such-that over that to exclude multiples of 5 if needed"><y>#</y><d>2019-02-11</d><h>15:46</h><w>Alex Miller (Clojure team)</w>could then use such-that over that to exclude multiples of 5 if needed</z><z id="t1549900053" t="Ajay Ok I had tried generate a number, then use fmap to multiply by 3 so you always generate multiples of 3 but didn&apos;t apply such-that to exclude multiples of 5, let me try, thank you for all replies!"><y>#</y><d>2019-02-11</d><h>15:47</h><w>Ajay</w>Ok I had tried <code>generate a number, then use fmap to multiply by 3 so you always generate multiples of 3</code> but didn&apos;t apply such-that to exclude multiples of 5, let me try, thank you for all replies!</z><z id="t1549900178" t="gfredericks yeah I forgot to say the multiply part"><y>#</y><d>2019-02-11</d><h>15:49</h><w>gfredericks</w>yeah I forgot to say the multiply part</z><z id="t1549900199" t="gfredericks you could still use such-that without multiplying, it&apos;d just be even slower and you&apos;d probable need an even higher max-tries"><y>#</y><d>2019-02-11</d><h>15:49</h><w>gfredericks</w>you could still use such-that without multiplying, it&apos;d just be even slower and you&apos;d probable need an even higher max-tries</z><z id="t1549900261" t="gfredericks if you want to be fancy you can use some number theory to generate a good distribution of such numbers w/o filtering"><y>#</y><d>2019-02-11</d><h>15:51</h><w>gfredericks</w>if you want to be fancy you can use some number theory to generate a good distribution of such numbers w/o filtering</z><z id="t1549900726" t="Ajay could get it to work! thank you!"><y>#</y><d>2019-02-11</d><h>15:58</h><w>Ajay</w>could get it to work! thank you!</z><z id="t1549900838" t="Alex Miller (Clojure team) you could gen a set of non-5 numbers, then multiply all of them and by 3 to generate only numbers divisible by 3 but not 5 :)"><y>#</y><d>2019-02-11</d><h>16:00</h><w>Alex Miller (Clojure team)</w>you could gen a set of non-5 numbers, then multiply all of them and by 3 to generate only numbers divisible by 3 but not 5 :)</z><z id="t1549900868" t="gfredericks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] that&apos;s just moving the filtering to the first generator, right?"><y>#</y><d>2019-02-11</d><h>16:01</h><w>gfredericks</w><a>@alexmiller</a> that&apos;s just moving the filtering to the first generator, right?</z><z id="t1549900974" t="Alex Miller (Clojure team) yeah"><y>#</y><d>2019-02-11</d><h>16:02</h><w>Alex Miller (Clojure team)</w>yeah</z><z id="t1549901177" t="gfredericks the fancy thing I have in mind is basically (gen/let [fifteens gen/int, threes (gen/choose 1 4)] (+ (* 15 fifteens) (* 3 threes))) I think that&apos;d work"><y>#</y><d>2019-02-11</d><h>16:06</h><w>gfredericks</w>the fancy thing I have in mind is basically <code>(gen/let [fifteens gen/int, threes (gen/choose 1 4)] (+ (* 15 fifteens) (* 3 threes)))</code>

I think that&apos;d work</z><z id="t1550482594" t="borkdude I wanted to generate arguments for subs : (def subs-args-gen (gen/fmap (fn [[str [start end]]] (if end [str start end] [str start])) (gen/bind (gen/string) (fn [s] (gen/tuple (gen/return s) (gen/bind (gen/choose 0 (count s)) (fn [start] (gen/one-of [(gen/tuple (gen/return start)) (gen/tuple (gen/return start) (gen/choose start (count s)))])))))))) (comment (gen/sample subs-args-gen) ;; ([&quot;&quot; 0] [&quot;k&quot; 1 1] [&quot;&quot; 0] [&quot;…_&quot; 0 0] [&quot;&quot; 0] [&quot;¥/&quot; 0] [&quot;µ&quot; 0] [&quot;Þ¦\n&quot; 3] [&quot;&quot; 0] [&quot;\tsÈaíå&quot; 1]) ) It feels a bit verbose, maybe there was a nicer way to do this?"><y>#</y><d>2019-02-18</d><h>09:36</h><w>borkdude</w>I wanted to generate arguments for <code>subs</code>:
<pre>(def subs-args-gen
  (gen/fmap
   (fn [[str [start end]]]
     (if end
       [str start end]
       [str start]))
   (gen/bind
    (gen/string)
    (fn [s]
      (gen/tuple (gen/return s)
                 (gen/bind
                  (gen/choose 0 (count s))
                  (fn [start]
                    (gen/one-of
                     [(gen/tuple (gen/return start))
                      (gen/tuple (gen/return start)
                                 (gen/choose start (count s)))]))))))))
(comment
  (gen/sample subs-args-gen)
;;  ([&quot;&quot; 0] [&quot;k&quot; 1 1] [&quot;&quot; 0] [&quot;…_&quot; 0 0] [&quot;&quot; 0] [&quot;¥/&quot; 0] [&quot;µ&quot; 0] [&quot;Þ¦\n&quot; 3] [&quot;&quot; 0] [&quot;\tsÈaíå&quot; 1])
)
</pre>
It feels a bit verbose, maybe there was a nicer way to do this?</z><z id="t1550499670" t="gfredericks that&apos;s a good one"><y>#</y><d>2019-02-18</d><h>14:21</h><w>gfredericks</w>that&apos;s a good one</z><z id="t1550499696" t="gfredericks I&apos;m trying to think of something that shrinks better than all the gen/bind s"><y>#</y><d>2019-02-18</d><h>14:21</h><w>gfredericks</w>I&apos;m trying to think of something that shrinks better than all the <code>gen/bind</code>s</z><z id="t1550499765" t="gfredericks and has a good distribution"><y>#</y><d>2019-02-18</d><h>14:22</h><w>gfredericks</w>and has a good distribution</z><z id="t1550499773" t="gfredericks those things can trade off with readability/simplicity sometimes"><y>#</y><d>2019-02-18</d><h>14:22</h><w>gfredericks</w>those things can trade off with readability/simplicity sometimes</z><z id="t1550499956" t="gfredericks here&apos;s a relatively simple approach (gen/let [[s start end use-end?] (gen/tuple gen/string gen/nat gen/nat gen/boolean)] (let [start (min start (count s)) end (min end (count s)) [start end] (sort [start end])] (cond-&gt; [s start] use-end? (conj end)))) "><y>#</y><d>2019-02-18</d><h>14:25</h><w>gfredericks</w>here&apos;s a relatively simple approach

<pre>(gen/let [[s start end use-end?]
          (gen/tuple gen/string gen/nat gen/nat gen/boolean)]
  (let [start (min start (count s))
        end (min end (count s))
        [start end] (sort [start end])]
    (cond-&gt; [s start] use-end? (conj end))))
</pre></z><z id="t1550499989" t="gfredericks there might be edge cases there with (count s) , I&apos;m not sure how subs works"><y>#</y><d>2019-02-18</d><h>14:26</h><w>gfredericks</w>there might be edge cases there with <code>(count s)</code>, I&apos;m not sure how <code>subs</code> works</z><z id="t1550500035" t="gfredericks and you might complain that this will be more likely than you&apos;d want to generate args that are equal to (count s) , and if that bothers you then you could do something like use (gen/choose 0 1000000) for start and end and then scale them down to the size of the string"><y>#</y><d>2019-02-18</d><h>14:27</h><w>gfredericks</w>and you might complain that this will be more likely than you&apos;d want to generate args that are equal to <code>(count s)</code>, and if that bothers you then you could do something like use <code>(gen/choose 0 1000000)</code> for <code>start</code> and <code>end</code> and then scale them down to the size of the string</z><z id="t1550500069" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] ⇑"><y>#</y><d>2019-02-18</d><h>14:27</h><w>gfredericks</w><a>@borkdude</a> ⇑</z><z id="t1550500480" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] cool, I did not know about gen/let"><y>#</y><d>2019-02-18</d><h>14:34</h><w>borkdude</w><a>@gfredericks</a> cool, I did not know about <code>gen/let</code></z><z id="t1550500522" t="borkdude the edge cases for subs I’ve already worked out, 0 &lt;= start &lt;= end &lt;= (count s)"><y>#</y><d>2019-02-18</d><h>14:35</h><w>borkdude</w>the edge cases for subs I’ve already worked out, 0 &lt;= start &lt;= end &lt;= (count s)</z><z id="t1550500541" t="borkdude (yes even end equals to (count s) works)"><y>#</y><d>2019-02-18</d><h>14:35</h><w>borkdude</w>(yes even end equals to (count s) works)</z><z id="t1550500602" t="gfredericks So I got it right then I think"><y>#</y><d>2019-02-18</d><h>14:36</h><w>gfredericks</w>So I got it right then I think</z><z id="t1550500638" t="borkdude yeah, the distribution might be less nice, like you said"><y>#</y><d>2019-02-18</d><h>14:37</h><w>borkdude</w>yeah, the distribution might be less nice, like you said</z><z id="t1550501559" t="borkdude I like the boolean idea: (gen/bind (gen/tuple (gen/string) (gen/boolean)) (fn [[s end?]] (if end? (gen/bind (gen/choose 0 (count s)) (fn [start] (gen/tuple (gen/return s) (gen/return start) (gen/choose start (count s))))) (gen/tuple (gen/return s) (gen/choose 0 (count s)))))) "><y>#</y><d>2019-02-18</d><h>14:52</h><w>borkdude</w>I like the boolean idea:
<pre>(gen/bind
   (gen/tuple (gen/string) (gen/boolean))
   (fn [[s end?]]
     (if end?
       (gen/bind
        (gen/choose 0 (count s))
        (fn [start]
          (gen/tuple
           (gen/return s)
           (gen/return start)
           (gen/choose start (count s)))))
       (gen/tuple
        (gen/return s)
        (gen/choose 0 (count s))))))
</pre></z><z id="t1550501687" t="gfredericks the sorting trick is also good for generating ordered numbers w/o having to do it in stages"><y>#</y><d>2019-02-18</d><h>14:54</h><w>gfredericks</w>the sorting trick is also good for generating ordered numbers w/o having to do it in stages</z><z id="t1550501733" t="borkdude oh yeah."><y>#</y><d>2019-02-18</d><h>14:55</h><w>borkdude</w>oh yeah.</z><z id="t1550501799" t="gfredericks I probably go overboard on avoiding gen/bind"><y>#</y><d>2019-02-18</d><h>14:56</h><w>gfredericks</w>I probably go overboard on avoiding <code>gen/bind</code></z><z id="t1550501810" t="gfredericks you can actually write this fairly simply by using multiple clauses in gen/let"><y>#</y><d>2019-02-18</d><h>14:56</h><w>gfredericks</w>you can actually write this fairly simply by using multiple clauses in <code>gen/let</code></z><z id="t1550501832" t="gfredericks (which expands to gen/bind )"><y>#</y><d>2019-02-18</d><h>14:57</h><w>gfredericks</w>(which expands to <code>gen/bind</code>)</z><z id="t1550501881" t="gfredericks (gen/let [s gen-string, start (gen/choose 0 (count s)), end (gen/choose start (count s)), use-end? gen/boolean] (cond-&gt; [s start] use-end? (conj end)))"><y>#</y><d>2019-02-18</d><h>14:58</h><w>gfredericks</w><code>(gen/let [s gen-string, start (gen/choose 0 (count s)), end (gen/choose start (count s)), use-end? gen/boolean] (cond-&gt; [s start] use-end? (conj end)))</code></z><z id="t1550501909" t="borkdude if gen/tuple accepted nil, then you could write: (fn [start] (gen/tuple (gen/return s) (gen/return start) (when end? (gen/choose start (count s))))) "><y>#</y><d>2019-02-18</d><h>14:58</h><w>borkdude</w>if gen/tuple accepted nil, then you could write:
<pre>(fn [start]
          (gen/tuple
           (gen/return s)
           (gen/return start)
           (when end? (gen/choose start (count s)))))
</pre></z><z id="t1550501928" t="gfredericks I just have this instinct to not use gen/bind if it can be avoided, which is probably not worth the effort in a lot of cases"><y>#</y><d>2019-02-18</d><h>14:58</h><w>gfredericks</w>I just have this instinct to not use <code>gen/bind</code> if it can be avoided, which is probably not worth the effort in a lot of cases</z><z id="t1550502016" t="borkdude is gen/let a new thing? my REPL says it doesn’t exist"><y>#</y><d>2019-02-18</d><h>15:00</h><w>borkdude</w>is gen/let a new thing? my REPL says it doesn’t exist</z><z id="t1550502041" t="gfredericks not too new"><y>#</y><d>2019-02-18</d><h>15:00</h><w>gfredericks</w>not too new</z><z id="t1550502046" t="borkdude oh wait, gen from test.check, I think I’m using the one from spec"><y>#</y><d>2019-02-18</d><h>15:00</h><w>borkdude</w>oh wait, gen from test.check, I think I’m using the one from spec</z><z id="t1550502046" t="gfredericks maybe new in 0.9.0?"><y>#</y><d>2019-02-18</d><h>15:00</h><w>gfredericks</w>maybe new in 0.9.0?</z><z id="t1550502140" t="borkdude yeah: (g/let [s g/string start (gen/choose 0 (count s)) end (gen/choose start (count s)) use-end? (gen/boolean)] (cond-&gt; [s start] use-end? (conj end))) works. awesome."><y>#</y><d>2019-02-18</d><h>15:02</h><w>borkdude</w>yeah:
<pre>(g/let [s g/string
          start (gen/choose 0 (count s))
          end (gen/choose start (count s))
          use-end? (gen/boolean)]
    (cond-&gt; [s start] use-end? (conj end)))
</pre>
works. awesome.</z><z id="t1550502156" t="borkdude so g/let is the monad-ish thing in test.check"><y>#</y><d>2019-02-18</d><h>15:02</h><w>borkdude</w>so <code>g/let</code> is the monad-ish thing in test.check</z><z id="t1550502174" t="gfredericks yeah; it&apos;s just sugar over gen/fmap and gen/bind"><y>#</y><d>2019-02-18</d><h>15:02</h><w>gfredericks</w>yeah; it&apos;s just sugar over <code>gen/fmap</code> and <code>gen/bind</code></z><z id="t1550502249" t="borkdude totally useful sugar"><y>#</y><d>2019-02-18</d><h>15:04</h><w>borkdude</w>totally useful sugar</z><z id="t1550502588" t="borkdude this also works and avoids generating end if not needed: (g/let [s g/string start (g/choose 0 (count s)) use-end? g/boolean] (if use-end? (g/let [end (g/choose start (count s))] [s start end]) [s start])) "><y>#</y><d>2019-02-18</d><h>15:09</h><w>borkdude</w>this also works and avoids generating end if not needed:
<pre>(g/let [s g/string
          start (g/choose 0 (count s))
          use-end? g/boolean]
    (if use-end?
      (g/let [end (g/choose start (count s))]
        [s start end])
      [s start]))
</pre></z><z id="t1550502637" t="gfredericks Yep"><y>#</y><d>2019-02-18</d><h>15:10</h><w>gfredericks</w>Yep</z><z id="t1550741587" t="borkdude I get an error with let in clojurescript: $ clj -A:test -Sdeps &apos;{:deps {org.clojure/test.check {:mvn/version &quot;0.10.0-alpha3&quot;}}}&apos; -m cljs.main -re node ClojureScript 1.10.520 cljs.user=&gt; (require &apos;[clojure.test.check.generators :as g]) nil cljs.user=&gt; (g/let [n (g/choose 0 10)] n) WARNING: Use of undeclared Var cljs.user/n at line 1 &lt;cljs repl&gt; WARNING: Use of undeclared Var cljs.user/n at line 1 &lt;cljs repl&gt; Execution error (Error) at (&lt;cljs repl&gt;:1). Assert failed: First arg to gen/let must be a vector of bindings. "><y>#</y><d>2019-02-21</d><h>09:33</h><w>borkdude</w>I get an error with let in clojurescript:
<pre>$ clj -A:test -Sdeps &apos;{:deps {org.clojure/test.check {:mvn/version &quot;0.10.0-alpha3&quot;}}}&apos; -m cljs.main -re node
ClojureScript 1.10.520
cljs.user=&gt; (require &apos;[clojure.test.check.generators :as g])
nil
cljs.user=&gt; (g/let [n (g/choose 0 10)] n)
WARNING: Use of undeclared Var cljs.user/n at line 1 &lt;cljs repl&gt;
WARNING: Use of undeclared Var cljs.user/n at line 1 &lt;cljs repl&gt;
Execution error (Error) at (&lt;cljs repl&gt;:1).
Assert failed: First arg to gen/let must be a vector of bindings.
</pre></z><z id="t1550742731" t="borkdude fixed: https://dev.clojure.org/jira/browse/TCHECK-154"><y>#</y><d>2019-02-21</d><h>09:52</h><w>borkdude</w>fixed:
<a href="https://dev.clojure.org/jira/browse/TCHECK-154" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-154</a></z><z id="t1551123023" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] responding to this one: https://dev.clojure.org/jira/browse/TCHECK-154?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=51397#comment-51397 We don’t have to do anything funny. The only thing we should do to make this “testable” is to remove e.g. this line from the ns form: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L16"><y>#</y><d>2019-02-25</d><h>19:30</h><w>borkdude</w><a>@gfredericks</a> responding to this one: <a href="https://dev.clojure.org/jira/browse/TCHECK-154?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=51397#comment-51397" target="_blank">https://dev.clojure.org/jira/browse/TCHECK-154?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=51397#comment-51397</a>
We don’t have to do anything funny. The only thing we should do to make this “testable” is to remove e.g. this line from the ns form:
<a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L16" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L16</a></z><z id="t1551123058" t="borkdude Leaving that line in, will make it untestable in other namespaces as well, since it will be referred to as macro there too then (maybe depending on the order of loading of the namespaces, but that was the behavior I got when testing this in a different namespace with no change to the existing ones)."><y>#</y><d>2019-02-25</d><h>19:30</h><w>borkdude</w>Leaving that line in, will make it untestable in other namespaces as well, since it will be referred to as macro there too then (maybe depending on the order of loading of the namespaces, but that was the behavior I got when testing this in a different namespace with no change to the existing ones).</z><z id="t1551145241" t="gfredericks that is super weird"><y>#</y><d>2019-02-26</d><h>01:40</h><w>gfredericks</w>that is super weird</z><z id="t1551166364" t="borkdude It seems like a global thing"><y>#</y><d>2019-02-26</d><h>07:32</h><w>borkdude</w>It seems like a global thing</z><z id="t1551183520" t="gfredericks you&apos;re saying that whether or not the generators namespace wants to include macros from clojure.core determines whether or not other namespaces can implicitly include macros from generators ?"><y>#</y><d>2019-02-26</d><h>12:18</h><w>gfredericks</w>you&apos;re saying that whether or not the <code>generators</code> namespace wants to include macros from <code>clojure.core</code> determines whether or not other namespaces can implicitly include macros from <code>generators</code>?</z><z id="t1551183729" t="borkdude oh sorry, I was wrong there. I was looking for a test namespace that used gen/let in CLJS, but mistakingly pointed at the wrong line/namespace even. I’ll see if I can find a better example"><y>#</y><d>2019-02-26</d><h>12:22</h><w>borkdude</w>oh sorry, I was wrong there. I was looking for a test namespace that used <code>gen/let</code> in CLJS, but mistakingly pointed at the wrong line/namespace even. I’ll see if I can find a better example</z><z id="t1551183775" t="borkdude this is the better example: https://github.com/clojure/test.check/blob/88eebf105fbb01db17ce12a3bff207cc395270b9/src/test/clojure/clojure/test/check/test.cljc#L18"><y>#</y><d>2019-02-26</d><h>12:22</h><w>borkdude</w>this is the better example:
<a href="https://github.com/clojure/test.check/blob/88eebf105fbb01db17ce12a3bff207cc395270b9/src/test/clojure/clojure/test/check/test.cljc#L18" target="_blank">https://github.com/clojure/test.check/blob/88eebf105fbb01db17ce12a3bff207cc395270b9/src/test/clojure/clojure/test/check/test.cljc#L18</a></z><z id="t1551183804" t="borkdude sorry for the confusion"><y>#</y><d>2019-02-26</d><h>12:23</h><w>borkdude</w>sorry for the confusion</z><z id="t1551183824" t="gfredericks so you&apos;re saying removing that line would allow you to write what kind of test?"><y>#</y><d>2019-02-26</d><h>12:23</h><w>gfredericks</w>so you&apos;re saying removing that line would allow you to write what kind of test?</z><z id="t1551183862" t="borkdude removing the conditional cljs portions of these require clauses in the test namespaces would enable you test if the macros work correctly in CLJS (provided they add a self-require)"><y>#</y><d>2019-02-26</d><h>12:24</h><w>borkdude</w>removing the conditional cljs portions of these require clauses in the test namespaces would enable you test if the macros work correctly in CLJS (provided they add a self-require)</z><z id="t1551183924" t="borkdude you were asking for a way to test this behavior: this is a way to test it. another way would be to write a completely isolated test suite"><y>#</y><d>2019-02-26</d><h>12:25</h><w>borkdude</w>you were asking for a way to test this behavior: this is a way to test it. another way would be to write a completely isolated test suite</z><z id="t1551183938" t="gfredericks okay I think I get it"><y>#</y><d>2019-02-26</d><h>12:25</h><w>gfredericks</w>okay I think I get it</z><z id="t1551183970" t="gfredericks I suppose that&apos;s probably good enough"><y>#</y><d>2019-02-26</d><h>12:26</h><w>gfredericks</w>I suppose that&apos;s probably good enough</z><z id="t1551184008" t="gfredericks I can imagine somebody removing the line from src that looks redundant and then seeing the test failure and fixing it by adding :include-macros true , but that&apos;s starting to sound rather less likely"><y>#</y><d>2019-02-26</d><h>12:26</h><w>gfredericks</w>I can imagine somebody removing the line from <code>src</code> that looks redundant and then seeing the test failure and fixing it by adding <code>:include-macros true</code>, but that&apos;s starting to sound rather less likely</z><z id="t1551184071" t="gfredericks the thing I was imagining was something like (ns clojure.test.check.require-test (:require [clojure.test.check.generators :as gen])) (deftest can-still-use-let-without-include-macros (is (gen/let [x gen/nat] 42)))"><y>#</y><d>2019-02-26</d><h>12:27</h><w>gfredericks</w>the thing I was imagining was something like <code>(ns clojure.test.check.require-test (:require [clojure.test.check.generators :as gen])) (deftest can-still-use-let-without-include-macros (is (gen/let [x gen/nat] 42)))</code></z><z id="t1551184112" t="borkdude yes, but since it doesn’t seem a namespace local but a project-global inference thing, that doesn’t work if you combine it with the existing tests unchanged"><y>#</y><d>2019-02-26</d><h>12:28</h><w>borkdude</w>yes, but since it doesn’t seem a namespace local but a project-global inference thing, that doesn’t work if you combine it with the existing tests unchanged</z><z id="t1551184157" t="borkdude so adapting the existing tests to remove the :include-macros option would already be the test"><y>#</y><d>2019-02-26</d><h>12:29</h><w>borkdude</w>so adapting the existing tests to remove the :include-macros option would already be the test</z><z id="t1551184207" t="gfredericks I don&apos;t understand that first statement"><y>#</y><d>2019-02-26</d><h>12:30</h><w>gfredericks</w>I don&apos;t understand that first statement</z><z id="t1551184214" t="gfredericks how does it not work?"><y>#</y><d>2019-02-26</d><h>12:30</h><w>gfredericks</w>how does it not work?</z><z id="t1551184264" t="borkdude ok. say you would add (ns clojure.test.check.require-test (:require [clojure.test.check.generators :as gen])) (deftest can-still-use-let-without-include-macros (is (gen/let [x gen/nat] 42))) . this will already pass if clojure.test.check.generators :as gen has been required with :include-macros before."><y>#</y><d>2019-02-26</d><h>12:31</h><w>borkdude</w>ok. say you would add <code>(ns clojure.test.check.require-test (:require [clojure.test.check.generators :as gen])) (deftest can-still-use-let-without-include-macros (is (gen/let [x gen/nat] 42)))</code>. this will already pass if <code>clojure.test.check.generators :as gen</code> has been required with <code>:include-macros</code> before.</z><z id="t1551184266" t="gfredericks I feel like I&apos;m about to learn something terrible about clojurescript"><y>#</y><d>2019-02-26</d><h>12:31</h><w>gfredericks</w>I feel like I&apos;m about to learn something terrible about clojurescript</z><z id="t1551184288" t="borkdude in other words: that test already passes right now, without changing anything"><y>#</y><d>2019-02-26</d><h>12:31</h><w>borkdude</w>in other words: that test already passes right now, without changing anything</z><z id="t1551184320" t="gfredericks you&apos;re saying that if namespace A requires X and namespace B requires X , then what&apos;s visible from X in B is affected by how A required it?"><y>#</y><d>2019-02-26</d><h>12:32</h><w>gfredericks</w>you&apos;re saying that if namespace <code>A</code> requires <code>X</code> and namespace <code>B</code> requires <code>X</code>, then what&apos;s visible from <code>X</code> in <code>B</code> is affected by how <code>A</code> required it?</z><z id="t1551184385" t="borkdude I’m not an expert in CLJS macro resolution but that’s my understanding of it. If A requires X with include-macros first, then B requires X without include-macros, it will still be able to use the macros."><y>#</y><d>2019-02-26</d><h>12:33</h><w>borkdude</w>I’m not an expert in CLJS macro resolution but that’s my understanding of it. If A requires X with include-macros first, then B requires X without include-macros, it will still be able to use the macros.</z><z id="t1551184417" t="gfredericks I&apos;m willing to bet fives of dollars that this is not true, because if it&apos;s true then I&apos;ll be so sad that I won&apos;t think to miss my fives of dollars"><y>#</y><d>2019-02-26</d><h>12:33</h><w>gfredericks</w>I&apos;m willing to bet fives of dollars that this is not true, because if it&apos;s true then I&apos;ll be so sad that I won&apos;t think to miss my fives of dollars</z><z id="t1551184441" t="borkdude well, it’s easy to try out. just add this test namespace of yours and run the tests."><y>#</y><d>2019-02-26</d><h>12:34</h><w>borkdude</w>well, it’s easy to try out. just add this test namespace of yours and run the tests.</z><z id="t1551184519" t="borkdude I’m not saying that I want this to be true, just that I saw this behavior when adding a similar test 🙂"><y>#</y><d>2019-02-26</d><h>12:35</h><w>borkdude</w>I’m not saying that I want this to be true, just that I saw this behavior when adding a similar test <b>🙂</b></z><z id="t1551184620" t="borkdude On the other hand, I don’t see why this would be problematic. If you don’t add :include-macros true, the worst thing that will happen is that you will get a function instead of a macro resulting in an error (the original problem), so not getting the error as a side effect of some other namespace doing the require with include-macros, is a nice bonus."><y>#</y><d>2019-02-26</d><h>12:37</h><w>borkdude</w>On the other hand, I don’t see why this would be problematic. If you don’t add :include-macros true, the worst thing that will happen is that you will get a function instead of a macro resulting in an error (the original problem), so not getting the error as a side effect of some other namespace doing the require with include-macros, is a nice bonus.</z><z id="t1551184666" t="borkdude [:attrs {:href &quot;/_/_/users/U04VDQDDY&quot;}] or [:attrs {:href &quot;/_/_/users/U050B88UR&quot;}] could maybe explain how this works in detail"><y>#</y><d>2019-02-26</d><h>12:37</h><w>borkdude</w><a>@mfikes</a> or <a>@dnolen</a> could maybe explain how this works in detail</z><z id="t1551184794" t="gfredericks okay, I&apos;m running such a test now"><y>#</y><d>2019-02-26</d><h>12:39</h><w>gfredericks</w>okay, I&apos;m running such a test now</z><z id="t1551185382" t="gfredericks (ns clojure.test.check.test2 (:require [cljs.test :refer-macros [deftest is]] [clojure.test.check.generators :as gen])) (deftest can-use-gen-let-without-include-macros (is (gen/let [x gen/nat] 42))) I can&apos;t get this to fail even by removing every other test namespace"><y>#</y><d>2019-02-26</d><h>12:49</h><w>gfredericks</w><pre>(ns clojure.test.check.test2
  (:require [cljs.test :refer-macros [deftest is]]
            [clojure.test.check.generators :as gen]))

(deftest can-use-gen-let-without-include-macros
  (is (gen/let [x gen/nat] 42)))
</pre>

I can&apos;t get this to fail even by removing every other test namespace</z><z id="t1551185418" t="gfredericks at first I got a compiler warning about x not being defined, which I thought was a good sign, but haven&apos;t been getting that since"><y>#</y><d>2019-02-26</d><h>12:50</h><w>gfredericks</w>at first I got a compiler warning about <code>x</code> not being defined, which I thought was a good sign, but haven&apos;t been getting that since</z><z id="t1551185477" t="borkdude Have you cleared the target for?"><y>#</y><d>2019-02-26</d><h>12:51</h><w>borkdude</w>Have you cleared the target for?</z><z id="t1551185480" t="borkdude Dir"><y>#</y><d>2019-02-26</d><h>12:51</h><w>borkdude</w>Dir</z><z id="t1551185495" t="borkdude (Damn spelling corrector)"><y>#</y><d>2019-02-26</d><h>12:51</h><w>borkdude</w>(Damn spelling corrector)</z><z id="t1551185500" t="gfredericks yeah"><y>#</y><d>2019-02-26</d><h>12:51</h><w>gfredericks</w>yeah</z><z id="t1551185528" t="gfredericks and there&apos;s nothing else in the project that&apos;s requiring gen with :include-macros true"><y>#</y><d>2019-02-26</d><h>12:52</h><w>gfredericks</w>and there&apos;s nothing else in the project that&apos;s requiring gen with <code>:include-macros true</code></z><z id="t1551185596" t="gfredericks I just pushed this to the branch tmp-f5667927-abed-48d9-b5a8-7c7f0295b001 if you want to take a look"><y>#</y><d>2019-02-26</d><h>12:53</h><w>gfredericks</w>I just pushed this to the branch <code>tmp-f5667927-abed-48d9-b5a8-7c7f0295b001</code> if you want to take a look</z><z id="t1551185792" t="borkdude I’ll check it out, be back in a couple of hours"><y>#</y><d>2019-02-26</d><h>12:56</h><w>borkdude</w>I’ll check it out, be back in a couple of hours</z><z id="t1551190663" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] Change your test ns to something like: (ns clojure.test.check.test2 (:require [cljs.test :as t :refer-macros [deftest is]] [clojure.test.check.generators :as gen])) (deftest can-use-gen-let-without-include-macros (is (gen/let [x gen/nat] (number? x)))) (t/run-tests) Then I’m able to reproduce the error with: $ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs WARNING: Use of undeclared Var clojure.test.check.test2/x at line 6 test2.cljs WARNING: Use of undeclared Var clojure.test.check.test2/x at line 7 test2.cljs Testing clojure.test.check.test2 ERROR in (can-use-gen-let-without-include-macros) (Error:NaN:NaN) expected: (gen/let [x gen/nat] (number? x)) actual: #object[Error Error: Assert failed: First arg to gen/let must be a vector of bindings. (vector? bindings)] Ran 1 tests containing 1 assertions. 0 failures, 1 errors. "><y>#</y><d>2019-02-26</d><h>14:17</h><w>borkdude</w><a>@gfredericks</a>
Change your test ns to something like:

<pre>(ns clojure.test.check.test2
  (:require [cljs.test :as t :refer-macros [deftest is]]
            [clojure.test.check.generators :as gen]))

(deftest can-use-gen-let-without-include-macros
  (is (gen/let [x gen/nat]
        (number? x))))

(t/run-tests)
</pre>

Then I’m able to reproduce the error with:
<pre>$ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs
WARNING: Use of undeclared Var clojure.test.check.test2/x at line 6 test2.cljs
WARNING: Use of undeclared Var clojure.test.check.test2/x at line 7 test2.cljs

Testing clojure.test.check.test2

ERROR in (can-use-gen-let-without-include-macros) (Error:NaN:NaN)
expected: (gen/let [x gen/nat] (number? x))
  actual: #object[Error Error: Assert failed: First arg to gen/let must be a vector of bindings.
(vector? bindings)]

Ran 1 tests containing 1 assertions.
0 failures, 1 errors.
</pre></z><z id="t1551190793" t="borkdude We could just write a script for this to isolate it from the rest of the tests (if you still want this tested, I think it’s pretty rare that anyone does this in a CLJS lib)"><y>#</y><d>2019-02-26</d><h>14:19</h><w>borkdude</w>We could just write a script for this to isolate it from the rest of the tests (if you still want this tested, I think it’s pretty rare that anyone does this in a CLJS lib)</z><z id="t1551190890" t="gfredericks [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] But is it true that the test then passes if you revert the changes to the other test namespaces?"><y>#</y><d>2019-02-26</d><h>14:21</h><w>gfredericks</w><a>@borkdude</a> But is it true that the test then passes if you revert the changes to the other test namespaces?</z><z id="t1551190928" t="borkdude not in this case, since I only load that one namespace here. I could test it by also loading those first"><y>#</y><d>2019-02-26</d><h>14:22</h><w>borkdude</w>not in this case, since I only load that one namespace here. I could test it by also loading those first</z><z id="t1551191374" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] This branch: https://github.com/borkdude/test.check/tree/tmp-f5667927-abed-48d9-b5a8-7c7f0295b001 $ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs WARNING: Use of undeclared Var clojure.test.check.test2/x at line 6 test2.cljs WARNING: Use of undeclared Var clojure.test.check.test2/x at line 7 test2.cljs Testing clojure.test.check.test2 ERROR in (can-use-gen-let-without-include-macros) (Error:NaN:NaN) expected: (gen/let [x gen/nat] (number? x)) actual: #object[Error Error: Assert failed: First arg to gen/let must be a vector of bindings. (vector? bindings)] Ran 1 tests containing 1 assertions. 0 failures, 1 errors. $ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test.cljc -i src/test/clojure/clojure/test/check/test2.cljs WARNING: var: clojure.test.check.generators/gen-raw-long is not public at line 158 test.cljc WARNING: var: clojure.test.check.generators/gen-raw-long is not public at line 158 test.cljc Testing clojure.test.check.test2 Ran 1 tests containing 1 assertions. 0 failures, 0 errors. "><y>#</y><d>2019-02-26</d><h>14:29</h><w>borkdude</w><a>@gfredericks</a> This branch: <a href="https://github.com/borkdude/test.check/tree/tmp-f5667927-abed-48d9-b5a8-7c7f0295b001" target="_blank">https://github.com/borkdude/test.check/tree/tmp-f5667927-abed-48d9-b5a8-7c7f0295b001</a>
<pre>$ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs
WARNING: Use of undeclared Var clojure.test.check.test2/x at line 6 test2.cljs
WARNING: Use of undeclared Var clojure.test.check.test2/x at line 7 test2.cljs

Testing clojure.test.check.test2

ERROR in (can-use-gen-let-without-include-macros) (Error:NaN:NaN)
expected: (gen/let [x gen/nat] (number? x))
  actual: #object[Error Error: Assert failed: First arg to gen/let must be a vector of bindings.
(vector? bindings)]

Ran 1 tests containing 1 assertions.
0 failures, 1 errors.

$ clj -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test.cljc -i src/test/clojure/clojure/test/check/test2.cljs
WARNING: var: clojure.test.check.generators/gen-raw-long is not public at line 158 test.cljc
WARNING: var: clojure.test.check.generators/gen-raw-long is not public at line 158 test.cljc

Testing clojure.test.check.test2

Ran 1 tests containing 1 assertions.
0 failures, 0 errors.
</pre></z><z id="t1551191384" t="borkdude I guess I’m pretty close to winning that 5 dollars…"><y>#</y><d>2019-02-26</d><h>14:29</h><w>borkdude</w>I guess I’m pretty close to winning that 5 dollars…</z><z id="t1551191504" t="borkdude It seems that once the CLJS compiler knows something is a macro, it cannot unknow it?"><y>#</y><d>2019-02-26</d><h>14:31</h><w>borkdude</w>It seems that once the CLJS compiler knows something is a macro, it cannot unknow it?</z><z id="t1551191790" t="borkdude maybe that is what happens here (although that’s just me guessing): https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/analyzer.cljc#L629"><y>#</y><d>2019-02-26</d><h>14:36</h><w>borkdude</w>maybe that is what happens here (although that’s just me guessing): <a href="https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/analyzer.cljc#L629" target="_blank">https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/analyzer.cljc#L629</a></z><z id="t1551192279" t="borkdude so when you add a self-refer to a macro in a .cljc namespace, you effectively tell the CLJS compiler: I want to use this var as macro in CLJS. Any subsequent require to that namespace does not have to help CLJS with that anymore by adding include-macros true or refer-macros, it already knows."><y>#</y><d>2019-02-26</d><h>14:44</h><w>borkdude</w>so when you add a self-refer to a macro in a .cljc namespace, you effectively tell the CLJS compiler: I want to use this var as macro in CLJS. Any subsequent require to that namespace does not have to help CLJS with that anymore by adding include-macros true or refer-macros, it already knows.</z><z id="t1551192991" t="gfredericks I just asked in #cljs-dev about this"><y>#</y><d>2019-02-26</d><h>14:56</h><w>gfredericks</w>I just asked in #cljs-dev about this</z><z id="t1551193443" t="borkdude ok, so it’s confirmed that this behavior exists"><y>#</y><d>2019-02-26</d><h>15:04</h><w>borkdude</w>ok, so it’s confirmed that this behavior exists</z><z id="t1551193798" t="borkdude what about making a standalone script that just does this: clojure -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs That wouldn’t interfere with any other namespaces requiring these macros"><y>#</y><d>2019-02-26</d><h>15:09</h><w>borkdude</w>what about making a standalone script that just does this:
<pre>clojure -Sdeps &apos;{:deps {org.clojure/clojurescript {:mvn/version &quot;RELEASE&quot;}}}&apos; -m cljs.main -re node -i src/test/clojure/clojure/test/check/test2.cljs
</pre>
That wouldn’t interfere with any other namespaces requiring these macros</z><z id="t1551193963" t="borkdude test2 would be called test_macros.cljs then"><y>#</y><d>2019-02-26</d><h>15:12</h><w>borkdude</w>test2 would be called test_macros.cljs then</z><z id="t1551197089" t="gfredericks Blergh"><y>#</y><d>2019-02-26</d><h>16:04</h><w>gfredericks</w>Blergh</z><z id="t1551197102" t="gfredericks How about we just remove all the include-macro clauses from all src/test nses, except for the self ones"><y>#</y><d>2019-02-26</d><h>16:05</h><w>gfredericks</w>How about we just remove all the include-macro clauses from all src/test nses, except for the self ones</z><z id="t1551197437" t="borkdude yeah, that was my idea when I suggested that the tests already test this if they don’t add include-macros themselves"><y>#</y><d>2019-02-26</d><h>16:10</h><w>borkdude</w>yeah, that was my idea when I suggested that the tests already test this if they don’t add include-macros themselves</z><z id="t1551197450" t="borkdude but we could not reproduce this with lein cljsbuild"><y>#</y><d>2019-02-26</d><h>16:10</h><w>borkdude</w>but we could not reproduce this with lein cljsbuild</z><z id="t1551197459" t="borkdude maybe that build tool has some additional magic"><y>#</y><d>2019-02-26</d><h>16:10</h><w>borkdude</w>maybe that build tool has some additional magic</z><z id="t1551197503" t="borkdude but I’m fine with your proposal"><y>#</y><d>2019-02-26</d><h>16:11</h><w>borkdude</w>but I’m fine with your proposal</z></g><g id="s7"><z id="t1551198052" t="borkdude I’m looking at the cljsbuild code, but it seems there is some magic around macros in there: https://github.com/emezeske/lein-cljsbuild/blob/master/support/src/cljsbuild/crossover.clj"><y>#</y><d>2019-02-26</d><h>16:20</h><w>borkdude</w>I’m looking at the cljsbuild code, but it seems there is some magic around macros in there:
<a href="https://github.com/emezeske/lein-cljsbuild/blob/master/support/src/cljsbuild/crossover.clj" target="_blank">https://github.com/emezeske/lein-cljsbuild/blob/master/support/src/cljsbuild/crossover.clj</a></z><z id="t1551198178" t="borkdude I can see why the CLJS authors ask for repros not using these tools 🙂"><y>#</y><d>2019-02-26</d><h>16:22</h><w>borkdude</w>I can see why the CLJS authors ask for repros not using these tools <b>🙂</b></z><z id="t1551200009" t="gfredericks yeah I think a global policy of &quot;no other namespace should need to require-macros from a t.c namespace because they all do self-requiring&quot; is good enough"><y>#</y><d>2019-02-26</d><h>16:53</h><w>gfredericks</w>yeah I think a global policy of &quot;no other namespace should need to require-macros from a t.c namespace because they all do self-requiring&quot; is good enough</z><z id="t1551200040" t="gfredericks so the additions to your patch would be A) deleting redundant :include-macros B) doing this trick for the prop namespace too"><y>#</y><d>2019-02-26</d><h>16:54</h><w>gfredericks</w>so the additions to your patch would be A) deleting redundant <code>:include-macros</code> B) doing this trick for the <code>prop</code> namespace too</z><z id="t1551200455" t="borkdude ok, will do"><y>#</y><d>2019-02-26</d><h>17:00</h><w>borkdude</w>ok, will do</z><z id="t1551202114" t="borkdude also in clojure.test.check.clojure-test for defspec I presume"><y>#</y><d>2019-02-26</d><h>17:28</h><w>borkdude</w>also in <code>clojure.test.check.clojure-test</code> for <code>defspec</code> I presume</z><z id="t1551202879" t="gfredericks 👍 yep"><y>#</y><d>2019-02-26</d><h>17:41</h><w>gfredericks</w><b>👍</b> yep</z><z id="t1551202886" t="gfredericks thanks for tracking everything down"><y>#</y><d>2019-02-26</d><h>17:41</h><w>gfredericks</w>thanks for tracking everything down</z><z id="t1551203078" t="borkdude New patch uploaded"><y>#</y><d>2019-02-26</d><h>17:44</h><w>borkdude</w>New patch uploaded</z><z id="t1551203272" t="gfredericks okay, I should get to it sometime this week"><y>#</y><d>2019-02-26</d><h>17:47</h><w>gfredericks</w>okay, I should get to it sometime this week</z><z id="t1551203305" t="borkdude thanks 🙂"><y>#</y><d>2019-02-26</d><h>17:48</h><w>borkdude</w>thanks <b>🙂</b></z><z id="t1551627629" t="borkdude The last stable release of test.check has been 12 NOV 2015. What are the alpha releases waiting for to become stable?"><y>#</y><d>2019-03-03</d><h>15:40</h><w>borkdude</w>The last stable release of test.check has been 12 NOV 2015. What are the alpha releases waiting for to become stable?</z><z id="t1551627722" t="gfredericks a set of milestones I was asymptotically approaching for a while; most of them I gave up on, so the only reason I haven&apos;t cut a release is because of the things that seem too half-baked to release"><y>#</y><d>2019-03-03</d><h>15:42</h><w>gfredericks</w>a set of milestones I was asymptotically approaching for a while; most of them I gave up on, so the only reason I haven&apos;t cut a release is because of the things that seem too half-baked to release</z><z id="t1551627766" t="gfredericks I think the tickets tagged 0.10.0 reflected what I hadn&apos;t yet given up on"><y>#</y><d>2019-03-03</d><h>15:42</h><w>gfredericks</w>I think the tickets tagged 0.10.0 reflected what I hadn&apos;t yet given up on</z><z id="t1551627804" t="gfredericks https://dev.clojure.org/jira/secure/IssueNavigator.jspa?reset=true&amp;amp;jqlQuery=project+%3D+10470+AND+labels+%3D+%22release-0.10.0%22"><y>#</y><d>2019-03-03</d><h>15:43</h><w>gfredericks</w><a href="https://dev.clojure.org/jira/secure/IssueNavigator.jspa?reset=true&amp;amp;jqlQuery=project+%3D+10470+AND+labels+%3D+%22release-0.10.0%22" target="_blank">https://dev.clojure.org/jira/secure/IssueNavigator.jspa?reset=true&amp;amp;jqlQuery=project+%3D+10470+AND+labels+%3D+%22release-0.10.0%22</a></z><z id="t1551627836" t="gfredericks now that I look, it seems like it&apos;s just a documentation ticket"><y>#</y><d>2019-03-03</d><h>15:43</h><w>gfredericks</w>now that I look, it seems like it&apos;s just a documentation ticket</z><z id="t1551628179" t="gfredericks the big thing I wanted to do was write some guides, but that was apparently too much work, and arguably isn&apos;t related to a release"><y>#</y><d>2019-03-03</d><h>15:49</h><w>gfredericks</w>the big thing I wanted to do was write some guides, but that was apparently too much work, and arguably isn&apos;t related to a release</z><z id="t1551628297" t="gfredericks I think I also wanted to sync up with alex w.r.t. spec, and see if there was anything that&apos;d be super useful to change before a release"><y>#</y><d>2019-03-03</d><h>15:51</h><w>gfredericks</w>I think I also wanted to sync up with alex w.r.t. spec, and see if there was anything that&apos;d be super useful to change before a release</z><z id="t1551628319" t="gfredericks so that there aren&apos;t future compatibility issues"><y>#</y><d>2019-03-03</d><h>15:51</h><w>gfredericks</w>so that there aren&apos;t future compatibility issues</z><z id="t1551628347" t="borkdude did the lazy loading of generators in spec require changes to tc?"><y>#</y><d>2019-03-03</d><h>15:52</h><w>borkdude</w>did the lazy loading of generators in spec require changes to tc?</z><z id="t1551628363" t="gfredericks no, but there was a change to gen/such-that for spec"><y>#</y><d>2019-03-03</d><h>15:52</h><w>gfredericks</w>no, but there was a change to <code>gen/such-that</code> for spec</z><z id="t1551628392" t="borkdude is spec itself still using 0.9.0?"><y>#</y><d>2019-03-03</d><h>15:53</h><w>borkdude</w>is spec itself still using 0.9.0?</z><z id="t1551628418" t="gfredericks I guess? but if you depend on 0.10.0 yourself, that&apos;s what it&apos;ll be using"><y>#</y><d>2019-03-03</d><h>15:53</h><w>gfredericks</w>I guess? but if you depend on 0.10.0 yourself, that&apos;s what it&apos;ll be using</z><z id="t1551628426" t="gfredericks so people will conceivably be combining arbitrary pairs of versions"><y>#</y><d>2019-03-03</d><h>15:53</h><w>gfredericks</w>so people will conceivably be combining arbitrary pairs of versions</z><z id="t1551628481" t="borkdude so 0.9.0 already had a change to gen/such-that for spec in November 2015?"><y>#</y><d>2019-03-03</d><h>15:54</h><w>borkdude</w>so 0.9.0 already had a change to gen/such-that for spec in November 2015?</z><z id="t1551628627" t="borkdude It seems not."><y>#</y><d>2019-03-03</d><h>15:57</h><w>borkdude</w>It seems not.</z><z id="t1551628732" t="gfredericks yeah, I didn&apos;t mean to imply that"><y>#</y><d>2019-03-03</d><h>15:58</h><w>gfredericks</w>yeah, I didn&apos;t mean to imply that</z><z id="t1551628816" t="gfredericks I&apos;ll put out another alpha release this week for the cljs changes, and then I will plan on talking to alex in a few weeks when my free time clears up"><y>#</y><d>2019-03-03</d><h>16:00</h><w>gfredericks</w>I&apos;ll put out another alpha release this week for the cljs changes, and then I will plan on talking to alex in a few weeks when my free time clears up</z><z id="t1551628854" t="borkdude yeah, no hurry, just wanted to know the current state"><y>#</y><d>2019-03-03</d><h>16:00</h><w>borkdude</w>yeah, no hurry, just wanted to know the current state</z><z id="t1553959490" t="caio [:attrs {:href &quot;/_/_/users/UFC1M7UG3&quot;}] I think edge cases are pretty common within cycles. eg: repeating something until you get a memory error, rounding errors, etc"><y>#</y><d>2019-03-30</d><h>15:24</h><w>caio</w><a>@brewmasterv</a> I think edge cases are pretty common within cycles. eg: repeating something until you get a memory error, rounding errors, etc</z><z id="t1555339058" t="defndaines Recently learned that prn-str and edn/read-string are not symmetric, thanks to playing around with test.check. (defspec prop-symmetric ;; NOTE This actually fails. prn-str and read-string are not symmetric. 100 (prop/for-all [s gen/any] (let [encoded (prn-str s)] (and (string? encoded) (= s (edn/read-string encoded)))))) "><y>#</y><d>2019-04-15</d><h>14:37</h><w>defndaines</w>Recently learned that <code>prn-str</code> and <code>edn/read-string</code> are not symmetric, thanks to playing around with test.check.
<pre>(defspec prop-symmetric
  ;; NOTE This actually fails. prn-str and read-string are not symmetric.
  100
  (prop/for-all [s gen/any]
    (let [encoded (prn-str s)]
      (and (string? encoded)
           (= s (edn/read-string encoded))))))
</pre></z><z id="t1555339110" t="gfredericks this sounds like a good trivia question"><y>#</y><d>2019-04-15</d><h>14:38</h><w>gfredericks</w>this sounds like a good trivia question</z><z id="t1555339114" t="defndaines (Note, there isn’t any official documentation that they are supposed to be, if you exclude the comment here https://clojuredocs.org/clojure.edn/read-string#example-542dc112e4b05f4d257a2993 from phreed)"><y>#</y><d>2019-04-15</d><h>14:38</h><w>defndaines</w>(Note, there isn’t any official documentation that they are supposed to be, if you exclude the comment here <a href="https://clojuredocs.org/clojure.edn/read-string#example-542dc112e4b05f4d257a2993" target="_blank">https://clojuredocs.org/clojure.edn/read-string#example-542dc112e4b05f4d257a2993</a> from phreed)</z><z id="t1555339159" t="gfredericks the first thing I can think of is things like (keyword &quot; &quot;)"><y>#</y><d>2019-04-15</d><h>14:39</h><w>gfredericks</w>the first thing I can think of is things like <code>(keyword &quot;  &quot;)</code></z><z id="t1555339190" t="gfredericks I can&apos;t remember if gen/any tries to generate those though; I think it doesn&apos;t"><y>#</y><d>2019-04-15</d><h>14:39</h><w>gfredericks</w>I can&apos;t remember if <code>gen/any</code> tries to generate those though; I think it doesn&apos;t</z><z id="t1555339199" t="gfredericks I&apos;m 99.7% sure it doesn&apos;t after thinking about it for two more seconds"><y>#</y><d>2019-04-15</d><h>14:39</h><w>gfredericks</w>I&apos;m 99.7% sure it doesn&apos;t after thinking about it for two more seconds</z><z id="t1555339237" t="gfredericks (symbol &quot;true&quot;) would be problematic; I don&apos;t think it avoids that, but it&apos;s also probably highly unlikely to generate it by chance"><y>#</y><d>2019-04-15</d><h>14:40</h><w>gfredericks</w><code>(symbol &quot;true&quot;)</code> would be problematic; I don&apos;t think it avoids that, but it&apos;s also probably highly unlikely to generate it by chance</z><z id="t1555339244" t="defndaines I know that a Double/NAN is one thing that isn’t symmetric."><y>#</y><d>2019-04-15</d><h>14:40</h><w>defndaines</w>I know that a <code>Double/NAN</code> is one thing that isn’t symmetric.</z><z id="t1555339244" t="gfredericks I&apos;m sure there&apos;s something much more basic"><y>#</y><d>2019-04-15</d><h>14:40</h><w>gfredericks</w>I&apos;m sure there&apos;s something much more basic</z><z id="t1555339263" t="gfredericks oh, well that probably reads back in as the correct object but = won&apos;t be true"><y>#</y><d>2019-04-15</d><h>14:41</h><w>gfredericks</w>oh, well that probably reads back in as the correct object but <code>=</code> won&apos;t be true</z><z id="t1555339279" t="gfredericks that says more about = than it does about prn-str and edn/read-string"><y>#</y><d>2019-04-15</d><h>14:41</h><w>gfredericks</w>that says more about <code>=</code> than it does about <code>prn-str</code> and <code>edn/read-string</code></z><z id="t1555339309" t="defndaines Ah, true. Would have to use a specialized = to see what else pops up."><y>#</y><d>2019-04-15</d><h>14:41</h><w>defndaines</w>Ah, true. Would have to use a specialized <code>=</code> to see what else pops up.</z><z id="t1555339319" t="gfredericks (symbol &quot;nil&quot;) is easier to generate than (symbol &quot;true&quot;) I guess"><y>#</y><d>2019-04-15</d><h>14:41</h><w>gfredericks</w><code>(symbol &quot;nil&quot;)</code> is easier to generate than <code>(symbol &quot;true&quot;)</code> I guess</z><z id="t1555339404" t="gfredericks there&apos;s a lot more stuff that would come up if gen/any was more ambitious"><y>#</y><d>2019-04-15</d><h>14:43</h><w>gfredericks</w>there&apos;s a lot more stuff that would come up if <code>gen/any</code> was more ambitious</z><z id="t1555339436" t="gfredericks e.g., queues, sorted sets, sorted maps, ..."><y>#</y><d>2019-04-15</d><h>14:43</h><w>gfredericks</w>e.g., queues, sorted sets, sorted maps, ...</z><z id="t1556574621" t="kenny Is there any documentation on what each of the keys returned from quick-check mean?"><y>#</y><d>2019-04-29</d><h>21:50</h><w>kenny</w>Is there any documentation on what each of the keys returned from quick-check mean?</z><z id="t1556575851" t="gfredericks The docstring mentions some of them, doesn&apos;t it?"><y>#</y><d>2019-04-29</d><h>22:10</h><w>gfredericks</w>The docstring mentions some of them, doesn&apos;t it?</z><z id="t1556577682" t="kenny The API docs don&apos;t have it https://clojure.github.io/test.check/clojure.test.check.html . Looks like it&apos;s been added in the source in master. It&apos;d be useful to understand when certain attributes are a specific type. i.e. when :result is false or an exception . The :result-data map is doc&apos;ed as {...} . Is there a doc on that one elsewhere?"><y>#</y><d>2019-04-29</d><h>22:41</h><w>kenny</w>The API docs don&apos;t have it <a href="https://clojure.github.io/test.check/clojure.test.check.html" target="_blank">https://clojure.github.io/test.check/clojure.test.check.html</a>. Looks like it&apos;s been added in the source in master. It&apos;d be useful to understand when certain attributes are a specific type. i.e. when <code>:result</code> is <code>false</code> or an <code>exception</code>. The <code>:result-data</code> map is doc&apos;ed as <code>{...}</code>. Is there a doc on that one elsewhere?</z><z id="t1556583339" t="gfredericks yeah there&apos;s a lot of stuff there; the main reason it&apos;s confusing is because I was trying to add more useful and easy-to-use information without breaking stuff relying on the old keys"><y>#</y><d>2019-04-30</d><h>00:15</h><w>gfredericks</w>yeah there&apos;s a lot of stuff there; the main reason it&apos;s confusing is because I was trying to add more useful and easy-to-use information without breaking stuff relying on the old keys</z><z id="t1556583415" t="gfredericks :result is the worst part, since it has the truthy-or-exception thing going on; that&apos;s why I added the :pass? key, so you can tell with a straightforward check whether the test passed or not :result-data is customizable, if you write a property that returns something that satsifies the clojure.test.check.results/Result protocol"><y>#</y><d>2019-04-30</d><h>00:16</h><w>gfredericks</w><code>:result</code> is the worst part, since it has the truthy-or-exception thing going on; that&apos;s why I added the <code>:pass?</code> key, so you can tell with a straightforward check whether the test passed or not

<code>:result-data</code> is customizable, if you write a property that returns something that satsifies the <code>clojure.test.check.results/Result</code> protocol</z><z id="t1556583449" t="gfredericks the only specific use of it that&apos;s baked in is when a normal property throws an exception, the exception is added as a key in the result-data"><y>#</y><d>2019-04-30</d><h>00:17</h><w>gfredericks</w>the only specific use of it that&apos;s baked in is when a normal property throws an exception, the exception is added as a key in the result-data</z><z id="t1556583468" t="gfredericks which might currently have the unfortunate side effect of causing exceptions to be printed twice 😞"><y>#</y><d>2019-04-30</d><h>00:17</h><w>gfredericks</w>which might currently have the unfortunate side effect of causing exceptions to be printed twice <b>😞</b></z><z id="t1556583523" t="gfredericks [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] ^^"><y>#</y><d>2019-04-30</d><h>00:18</h><w>gfredericks</w><a>@kenny</a> ^^</z><z id="t1556583621" t="gfredericks I can see both parts are fairly undocumented 😕"><y>#</y><d>2019-04-30</d><h>00:20</h><w>gfredericks</w>I can see both parts are fairly undocumented <b>😕</b></z><z id="t1556583634" t="gfredericks I tried to spec things at some point I think; maybe that&apos;d be a good way to start"><y>#</y><d>2019-04-30</d><h>00:20</h><w>gfredericks</w>I tried to spec things at some point I think; maybe that&apos;d be a good way to start</z><z id="t1556584352" t="gfredericks Except they probably haven&apos;t added docstrings to specs yet have they"><y>#</y><d>2019-04-30</d><h>00:32</h><w>gfredericks</w>Except they probably haven&apos;t added docstrings to specs yet have they</z><z id="t1556584544" t="Alex Miller (Clojure team) not yet"><y>#</y><d>2019-04-30</d><h>00:35</h><w>Alex Miller (Clojure team)</w>not  yet</z><z id="t1557314040" t="ben I have a really basic question: If I want to test multiple assertions in a property test, what is the most idiomatic way to do it? Is it just to wrap each assertion in an all ? Or can I leave them as separate forms?"><y>#</y><d>2019-05-08</d><h>11:14</h><w>ben</w>I have a really basic question: If I want to test multiple assertions in a property test, what is the most idiomatic way to do it?

Is it just to wrap each assertion in an <code>all</code>? Or can I leave them as separate forms?</z><z id="t1557314433" t="ben I suppose I could wrap each in a clojure.test/is but that seems definitely wrong"><y>#</y><d>2019-05-08</d><h>11:20</h><w>ben</w>I suppose I could wrap each in a <code>clojure.test/is</code> but that seems definitely wrong</z><z id="t1557314676" t="gfredericks [:attrs {:href &quot;/_/_/users/UFUDSN6BE&quot;}] are you using defspec ?"><y>#</y><d>2019-05-08</d><h>11:24</h><w>gfredericks</w><a>@ben606</a> are you using <code>defspec</code>?</z><z id="t1557317485" t="ben yes"><y>#</y><d>2019-05-08</d><h>12:11</h><w>ben</w>yes</z><z id="t1557317728" t="gfredericks the main two options are 1) Multiple defspecs 2) an and inside a single defspec"><y>#</y><d>2019-05-08</d><h>12:15</h><w>gfredericks</w>the main two options are

1) Multiple defspecs
2) an <code>and</code> inside a single defspec</z><z id="t1557317738" t="gfredericks there&apos;s tradeoffs"><y>#</y><d>2019-05-08</d><h>12:15</h><w>gfredericks</w>there&apos;s tradeoffs</z><z id="t1557317755" t="gfredericks the and could be made nicer if somebody wrote a version of and that returned result-data about which branch failed"><y>#</y><d>2019-05-08</d><h>12:15</h><w>gfredericks</w>the <code>and</code> could be made nicer if somebody wrote a version of <code>and</code> that returned result-data about which branch failed</z><z id="t1557318239" t="ben Okay, thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] . I guess this isn’t good practice, but I am testing things that depend on each other (db write and read). Seems like the Right Way would be to use multiple defspecs with some additonal setup/teardown?"><y>#</y><d>2019-05-08</d><h>12:23</h><w>ben</w>Okay, thanks <a>@gfredericks</a>. I guess this isn’t good practice, but I am testing things that depend on each other (db write and read).

Seems like the Right Way would be to use multiple defspecs with some additonal setup/teardown?</z><z id="t1557353183" t="gfredericks [:attrs {:href &quot;/_/_/users/UFUDSN6BE&quot;}] if you&apos;re doing something like &quot;generate data, write it to the db, read it back, check that it&apos;s equivalent&quot;, then you&apos;d want to do all of that in one defspec"><y>#</y><d>2019-05-08</d><h>22:06</h><w>gfredericks</w><a>@ben606</a> if you&apos;re doing something like &quot;generate data, write it to the db, read it back, check that it&apos;s equivalent&quot;, then you&apos;d want to do all of that in one defspec</z><z id="t1557394820" t="ben Right, so that’s some of them. I also have a couple with • read from the db (inserted in test migration) • call a fn to modify the data • read from the db again • check that it has been modified as expected Do you think this should follow the same pattern, [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] ? Thanks"><y>#</y><d>2019-05-09</d><h>09:40</h><w>ben</w>Right, so that’s some of them. I also have a couple with

• read from the db (inserted in test migration)
• call a fn to modify the data
• read from the db again
• check that it has been modified as expected

Do you think this should follow the same pattern, <a>@gfredericks</a>?

Thanks</z><z id="t1557398657" t="gfredericks [:attrs {:href &quot;/_/_/users/UFUDSN6BE&quot;}] that&apos;s what I would do, yeah; do you reset the db from within the defspec also? I think you&apos;d want to"><y>#</y><d>2019-05-09</d><h>10:44</h><w>gfredericks</w><a>@ben606</a> that&apos;s what I would do, yeah; do you reset the db from within the defspec also? I think you&apos;d want to</z><z id="t1557398791" t="ben Yeah, it all takes place within a transaction, so none of the changes get persisted"><y>#</y><d>2019-05-09</d><h>10:46</h><w>ben</w>Yeah, it all takes place within a transaction, so none of the changes get persisted</z><z id="t1557398879" t="gfredericks that sounds good; the main thing dictating granularity is what things are dependent on what generated data"><y>#</y><d>2019-05-09</d><h>10:47</h><w>gfredericks</w>that sounds good; the main thing dictating granularity is what things are dependent on what generated data</z><z id="t1557399726" t="ben makes sense. Thank you"><y>#</y><d>2019-05-09</d><h>11:02</h><w>ben</w>makes sense. Thank you</z><z id="t1558973803" t="Ho0man Hi, everyone I was wondering how can I use clojure.test/use-fixture with test-check’s defspec ?"><y>#</y><d>2019-05-27</d><h>16:16</h><w>Ho0man</w>Hi, everyone 
I was wondering how can I use <code>clojure.test/use-fixture</code> with test-check’s <code>defspec</code>?</z><z id="t1658986776" t="ossoso How would I emulate the use of fixtures for each trial? Macro/higher order function?"><y>#</y><d>2022-07-28</d><h>05:39</h><r>ossoso</r>How would I emulate the use of fixtures for each trial? Macro/higher order function?</z><z id="t1659054399" t="colinkahn Higher order function is what I&apos;ve used before."><y>#</y><d>2022-07-29</d><h>00:26</h><r>colinkahn</r>Higher order function is what I&apos;ve used before.</z><z id="t1659085166" t="ossoso I ended up writing the following macro: (defmacro db-fixture [&amp; body] `(with-open [node# (db/start-node {})] (binding [*node* node#] "><y>#</y><d>2022-07-29</d><h>08:59</h><r>ossoso</r>I ended up writing the following macro:
<pre>(defmacro db-fixture [&amp; body]
  `(with-open [node# (db/start-node {})]
     (binding [*node* node#]
       </pre></z><z id="t1558974499" t="gfredericks [:attrs {:href &quot;/_/_/users/U6CE37RK6&quot;}] is your issue that you want the fixture to run around each trial?"><y>#</y><d>2019-05-27</d><h>16:28</h><w>gfredericks</w><a>@ho0man</a> is your issue that you want the fixture to run around each trial?</z><z id="t1558974545" t="Ho0man Nope, the whole test"><y>#</y><d>2019-05-27</d><h>16:29</h><w>Ho0man</w>Nope, the whole test</z><z id="t1558974618" t="Ho0man But separately for different tests in a single namespace"><y>#</y><d>2019-05-27</d><h>16:30</h><w>Ho0man</w>But separately for different tests in a single namespace</z><z id="t1558974655" t="gfredericks I think that should just work"><y>#</y><d>2019-05-27</d><h>16:30</h><w>gfredericks</w>I think that should just work</z><z id="t1558974659" t="gfredericks Does it not?"><y>#</y><d>2019-05-27</d><h>16:30</h><w>gfredericks</w>Does it not?</z><z id="t1558975031" t="Ho0man :)) Yeah It does Thanks [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] (Sorry to bother you)"><y>#</y><d>2019-05-27</d><h>16:37</h><w>Ho0man</w>:))
Yeah
It does
Thanks <a>@gfredericks</a> 
(Sorry to bother you)</z><z id="t1658986776" t="ossoso How would I emulate the use of fixtures for each trial? Macro/higher order function?"><y>#</y><d>2022-07-28</d><h>05:39</h><w>ossoso</w>How would I emulate the use of fixtures for each trial? Macro/higher order function?</z><z id="t1560149327" t="Shima Hi I want to rerun the test with the same seed field if the test had been failed, so I need to somehow have access to seed inside of the test defspec. Is there any way to do this?"><y>#</y><d>2019-06-10</d><h>06:48</h><w>Shima</w>Hi
I want to rerun the test with the same seed field if the test had been failed, so I need to somehow have access to seed inside of the test defspec.
Is there any way to do this?</z><z id="t1560162647" t="gfredericks [:attrs {:href &quot;/_/_/users/UGR3UQULA&quot;}] defspec should print the seed when there&apos;s a failure, and I believe you can call the test function that defspec creates with a seed, like: (defspec some-test ...) (some-test 100 {:seed 42}) "><y>#</y><d>2019-06-10</d><h>10:30</h><w>gfredericks</w><a>@tajoddin.shima</a> defspec should print the seed when there&apos;s a failure, and I believe you can call the test function that defspec creates with a seed, like:

<pre>(defspec some-test ...)

(some-test 100 {:seed 42})
</pre></z><z id="t1560169996" t="Shima Yes but I want to run the test with &quot;lein test&quot; and my test scenario needs to rerun the wrong tests with the same seed again. so I want to get the seed exactly inside of test/defspec, Is this even possible? Thanks for your answer [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2019-06-10</d><h>12:33</h><w>Shima</w>Yes but I want to run the test with &quot;lein test&quot; and my test scenario needs to rerun the wrong tests with the same seed again. so I want to get the seed exactly inside of test/defspec, Is this even possible?
Thanks for your answer <a>@gfredericks</a></z><z id="t1560170099" t="gfredericks [:attrs {:href &quot;/_/_/users/UGR3UQULA&quot;}] do you mean that you want to set the seed as an arg to lein test somehow? or to have it hard-coded in your test-file somewhere?"><y>#</y><d>2019-06-10</d><h>12:34</h><w>gfredericks</w><a>@tajoddin.shima</a> do you mean that you want to set the seed as an arg to <code>lein test</code> somehow? or to have it hard-coded in your test-file somewhere?</z><z id="t1560170462" t="Shima none of them :)) I need something like this : [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2019-06-10</d><h>12:41</h><w>Shima</w>none of them :)) I need something like this : <a>@gfredericks</a></z><z id="t1560170589" t="gfredericks I don&apos;t understand that; it looks like an infinite recursive loop"><y>#</y><d>2019-06-10</d><h>12:43</h><w>gfredericks</w>I don&apos;t understand that; it looks like an infinite recursive loop</z><z id="t1560170611" t="gfredericks Like, if the test fails, you just want to run it again?"><y>#</y><d>2019-06-10</d><h>12:43</h><w>gfredericks</w>Like, if the test fails, you just want to run it again?</z><z id="t1560170797" t="Shima I have some randomness out of test-check context in my generator I save the number of recursion in an atom and control this. I just want to make sure that when the test failed is because of randomness inside of my generators"><y>#</y><d>2019-06-10</d><h>12:46</h><w>Shima</w>I have some randomness out of test-check context in my generator
I save the number of recursion in an atom and control this.
I just want to make sure that when the test failed is because of randomness inside of my generators</z><z id="t1560170865" t="gfredericks would it work to run the individual trial multiple times instead of the whole run?"><y>#</y><d>2019-06-10</d><h>12:47</h><w>gfredericks</w>would it work to run the individual trial multiple times instead of the whole run?</z><z id="t1560170938" t="gfredericks something like (prop/for-all [test-suite (generator)] (loop [failures-left 5] (or (actual-test test-suite) (and (pos? failures-left) (recur (dec failures-left)))))) "><y>#</y><d>2019-06-10</d><h>12:48</h><w>gfredericks</w>something like

<pre>(prop/for-all [test-suite (generator)]
  (loop [failures-left 5]
    (or (actual-test test-suite)
        (and (pos? failures-left) (recur (dec failures-left))))))
</pre></z><z id="t1560171128" t="Shima exactly just instead of test-suite inside the loop, each time generate the new suite with the same seed"><y>#</y><d>2019-06-10</d><h>12:52</h><w>Shima</w>exactly
just instead of test-suite inside the loop, each time generate the new suite with the same seed</z><z id="t1560171251" t="Shima with generating the suite with same seed I want to bound the randomness to something that comes from out of test-check context"><y>#</y><d>2019-06-10</d><h>12:54</h><w>Shima</w>with generating the suite with same seed I want to bound the randomness to something that comes from out of test-check context</z><z id="t1560171714" t="gfredericks This extra randomness is used in the generator?"><y>#</y><d>2019-06-10</d><h>13:01</h><w>gfredericks</w>This extra randomness is used in the generator?</z><z id="t1560171808" t="Shima yes"><y>#</y><d>2019-06-10</d><h>13:03</h><w>Shima</w>yes</z><z id="t1560171882" t="Shima what about this? It would be enough that I have access to the seed inside of the defspec to save in DB and don&apos;t need to regenerate the test-suite in it."><y>#</y><d>2019-06-10</d><h>13:04</h><w>Shima</w>what about this? It would be enough that I have access to the seed inside of the defspec to save in DB and don&apos;t need to regenerate the test-suite in it.</z><z id="t1560171950" t="gfredericks I wonder whether you need the extra randomness at all That&apos;s the nonstandard part What is it accomplishing?"><y>#</y><d>2019-06-10</d><h>13:05</h><w>gfredericks</w>I wonder whether you need the extra randomness at all

That&apos;s the nonstandard part

What is it accomplishing?</z><z id="t1560280047" t="Shima Yes, you&apos;re right. There is no need for this extra randomness. but I still wondering is there any way to get seed of each run? maybe in use-fixture function ?( for example to save in DB) sorry for latency [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}]"><y>#</y><d>2019-06-11</d><h>19:07</h><w>Shima</w>Yes, you&apos;re right. There is no need for this extra randomness. 
but I still wondering is there any way to get seed of each run? maybe in use-fixture function ?( for example to save in DB)
sorry for latency <a>@gfredericks</a></z><z id="t1560280085" t="gfredericks the seed is printed after every defspec run"><y>#</y><d>2019-06-11</d><h>19:08</h><w>gfredericks</w>the seed is printed after every <code>defspec</code> run</z><z id="t1560280112" t="gfredericks if you want something more custom, you can always write your own code to call clojure.test.check/quickcheck"><y>#</y><d>2019-06-11</d><h>19:08</h><w>gfredericks</w>if you want something more custom, you can always write your own code to call <code>clojure.test.check/quickcheck</code></z><z id="t1560280132" t="gfredericks defspec is just a macro that does some stuff for you"><y>#</y><d>2019-06-11</d><h>19:08</h><w>gfredericks</w>defspec is just a macro that does some stuff for you</z><z id="t1561995125" t="gfredericks test.check version 0.10.0-RC1 was released yesterday Details: https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown"><y>#</y><d>2019-07-01</d><h>15:32</h><w>gfredericks</w>test.check version <code>0.10.0-RC1</code> was released yesterday

Details: <a href="https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown" target="_blank">https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown</a></z><z id="t1564769205" t="kenny Is there a way to create a generator from a list of generators such that when it generates, it returns the same list with each element in the list generated?"><y>#</y><d>2019-08-02</d><h>18:06</h><w>kenny</w>Is there a way to create a generator from a list of generators such that when it generates, it returns the same list with each element in the list generated?</z><z id="t1564769292" t="kenny Something like this: (gen/let [my-things (map (fn [thing] (get-gen-for thing)) my-things)]) "><y>#</y><d>2019-08-02</d><h>18:08</h><w>kenny</w>Something like this:
<pre>(gen/let [my-things (map (fn [thing]
                           (get-gen-for thing))
                         my-things)])
</pre></z><z id="t1564769423" t="gfredericks [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] is this different from (apply gen/tuple ...) ?"><y>#</y><d>2019-08-02</d><h>18:10</h><w>gfredericks</w><a>@kenny</a> is this different from <code>(apply gen/tuple ...)</code>?</z><z id="t1564769461" t="kenny Wow, so obvious haha. That&apos;s exactly it. Thanks 🙂"><y>#</y><d>2019-08-02</d><h>18:11</h><w>kenny</w>Wow, so obvious haha. That&apos;s exactly it. Thanks <b>🙂</b></z><z id="t1564770499" t="Alex Miller (Clojure team) or just s/gen of an s/tuple if you&apos;re using spec"><y>#</y><d>2019-08-02</d><h>18:28</h><w>Alex Miller (Clojure team)</w>or just s/gen of an s/tuple if you&apos;re using spec</z><z id="t1565636109" t="gfredericks test.check version 0.10.0 has been released; no differences from 0.10.0-RC1"><y>#</y><d>2019-08-12</d><h>18:55</h><w>gfredericks</w>test.check version <code>0.10.0</code> has been released; no differences from <code>0.10.0-RC1</code></z><z id="t1566329273" t="kenny Is there a good way to provide some initialization for a property when used with the clojure.test integration? For example, I have this code: (defspec my-gen-test 100 (kafka/with-driver [d (make-driver {})] (prop/for-all [record (my-record-gen)] (kafka/pipe-input d record)))) It needs to initialize a Kafka test driver and then run the property test. with-driver is basically the same as with-open (i.e. it will close a resource after the form&apos;s body completes). The problem I&apos;m running into is the property check doesn&apos;t appear to block until it&apos;s completed so the driver opens and then closes pretty quickly. Is there a way to work around this? Currently thinking to just make my own defspec that can handle this sort of thing."><y>#</y><d>2019-08-20</d><h>19:27</h><w>kenny</w>Is there a good way to provide some initialization for a property when used with the clojure.test integration? For example, I have this code:
<pre>(defspec my-gen-test
  100
  (kafka/with-driver [d (make-driver {})]
    (prop/for-all [record (my-record-gen)]
      (kafka/pipe-input d record))))
</pre>
It needs to initialize a Kafka test driver and then run the property test. <code>with-driver</code> is basically the same as <code>with-open</code> (i.e. it will close a resource after the form&apos;s body completes).  The problem I&apos;m running into is the property check doesn&apos;t appear to block until it&apos;s completed so the driver opens and then closes pretty quickly. Is there a way to work around this? Currently thinking to just make my own <code>defspec</code> that can handle this sort of thing.</z><z id="t1566329520" t="kenny I could write my own quick-check fn like this: (defn quick-check [num-tests property &amp; opts] (tc-test/assert-check (apply tc/quick-check num-tests property opts))) "><y>#</y><d>2019-08-20</d><h>19:32</h><w>kenny</w>I could write my own <code>quick-check</code> fn like this:
<pre>(defn quick-check
  [num-tests property &amp; opts]
  (tc-test/assert-check
    (apply tc/quick-check num-tests property opts)))
</pre></z><z id="t1566329652" t="gfredericks [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] you it to be opened/closed just once for the whole test run, across many trials?"><y>#</y><d>2019-08-20</d><h>19:34</h><w>gfredericks</w><a>@kenny</a> you it to be opened/closed just once for the whole test run, across many trials?</z><z id="t1566329668" t="kenny Yes. Open at the beginning, close at the end."><y>#</y><d>2019-08-20</d><h>19:34</h><w>kenny</w>Yes. Open at the beginning, close at the end.</z><z id="t1566329689" t="kenny It should run through all the properties using the same driver."><y>#</y><d>2019-08-20</d><h>19:34</h><w>kenny</w>It should run through all the properties using the same driver.</z><z id="t1566329743" t="gfredericks If you did it in a fixture and bound a dynamic var, would that be good enough?"><y>#</y><d>2019-08-20</d><h>19:35</h><w>gfredericks</w>If you did it in a fixture and bound a dynamic var, would that be good enough?</z><z id="t1566329782" t="kenny Yes but fixtures are icky. They either run with each deftest or only once. Neither of those choices are a good fit."><y>#</y><d>2019-08-20</d><h>19:36</h><w>kenny</w>Yes but fixtures are icky. They either run with each <code>deftest</code> or only once. Neither of those choices are a good fit.</z><z id="t1566329839" t="gfredericks Oh right"><y>#</y><d>2019-08-20</d><h>19:37</h><w>gfredericks</w>Oh right</z><z id="t1566329901" t="gfredericks Yeah I don&apos;t think there are any super clean options"><y>#</y><d>2019-08-20</d><h>19:38</h><w>gfredericks</w>Yeah I don&apos;t think there are any super clean options</z><z id="t1566330074" t="kenny That quick-check wrapper fn should work for now"><y>#</y><d>2019-08-20</d><h>19:41</h><w>kenny</w>That quick-check wrapper fn should work for now</z><z id="t1566416227" t="johanatan [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] any idea why gen&apos;/string-from-regex would be undefined when i have added test.chuck as a dep and required the chuck.generators namespace as gen&apos; ?"><y>#</y><d>2019-08-21</d><h>19:37</h><w>johanatan</w><a>@gfredericks</a> any idea why <code>gen&apos;/string-from-regex</code> would be undefined when i have added test.chuck as a dep and required the chuck.generators namespace as <code>gen&apos;</code> ?</z><z id="t1566416248" t="johanatan tried both 0.2.8 (which used to work for me) and 0.2.10"><y>#</y><d>2019-08-21</d><h>19:37</h><w>johanatan</w>tried both 0.2.8 (which used to work for me) and 0.2.10</z><z id="t1566416256" t="johanatan and this is with org.clojure/test.check v0.10.0"><y>#</y><d>2019-08-21</d><h>19:37</h><w>johanatan</w>and this is with org.clojure/test.check v0.10.0</z><z id="t1566416264" t="johanatan [using deps.edn]"><y>#</y><d>2019-08-21</d><h>19:37</h><w>johanatan</w>[using deps.edn]</z><z id="t1566416268" t="gfredericks Not at all"><y>#</y><d>2019-08-21</d><h>19:37</h><w>gfredericks</w>Not at all</z><z id="t1566416275" t="gfredericks It&apos;s a regular ole function"><y>#</y><d>2019-08-21</d><h>19:37</h><w>gfredericks</w>It&apos;s a regular ole function</z><z id="t1566416276" t="johanatan hmm 🙂"><y>#</y><d>2019-08-21</d><h>19:37</h><w>johanatan</w>hmm <b>🙂</b></z><z id="t1566416337" t="johanatan wow, must have been some weird fluke. restarting figwheel a few times resolved it"><y>#</y><d>2019-08-21</d><h>19:38</h><w>johanatan</w>wow, must have been some weird fluke. restarting figwheel a few times resolved it</z><z id="t1566416339" t="gfredericks Wait"><y>#</y><d>2019-08-21</d><h>19:38</h><w>gfredericks</w>Wait</z><z id="t1566416350" t="gfredericks It&apos;s not in cljs"><y>#</y><d>2019-08-21</d><h>19:39</h><w>gfredericks</w>It&apos;s not in cljs</z><z id="t1566416357" t="gfredericks Is that what you&apos;re using?"><y>#</y><d>2019-08-21</d><h>19:39</h><w>gfredericks</w>Is that what you&apos;re using?</z><z id="t1566416363" t="johanatan oh, yea this is cljs"><y>#</y><d>2019-08-21</d><h>19:39</h><w>johanatan</w>oh, yea this is cljs</z><z id="t1566416380" t="gfredericks Well now I don&apos;t know why it works 😂"><y>#</y><d>2019-08-21</d><h>19:39</h><w>gfredericks</w>Well now I don&apos;t know why it works <b>😂</b></z><z id="t1566416386" t="johanatan haha, yea same here"><y>#</y><d>2019-08-21</d><h>19:39</h><w>johanatan</w>haha, yea same here</z><z id="t1566416416" t="gfredericks There&apos;s s longstanding PR for porting it, but I don&apos;t think it&apos;s complete"><y>#</y><d>2019-08-21</d><h>19:40</h><w>gfredericks</w>There&apos;s s longstanding PR for porting it, but I don&apos;t think it&apos;s complete</z><z id="t1566416430" t="gfredericks It&apos;s very nontrivial, because different regex engines"><y>#</y><d>2019-08-21</d><h>19:40</h><w>gfredericks</w>It&apos;s very nontrivial, because different regex engines</z><z id="t1566416435" t="johanatan hmm ok. right"><y>#</y><d>2019-08-21</d><h>19:40</h><w>johanatan</w>hmm ok. right</z><z id="t1566417512" t="johanatan btw, should everything in clojure.test.check be in the clojure.spec.alpha namespace now?"><y>#</y><d>2019-08-21</d><h>19:58</h><w>johanatan</w>btw, should everything in clojure.test.check be in the clojure.spec.alpha namespace now?</z><z id="t1566417523" t="johanatan or should we continue using the former until v2 comes out?"><y>#</y><d>2019-08-21</d><h>19:58</h><w>johanatan</w>or should we continue using the former until v2 comes out?</z><z id="t1566417549" t="johanatan asking because gen/let doesn&apos;t appear to be there"><y>#</y><d>2019-08-21</d><h>19:59</h><w>johanatan</w>asking because <code>gen/let</code> doesn&apos;t appear to be there</z><z id="t1566418061" t="kenny [:attrs {:href &quot;/_/_/users/U0E98NQG2&quot;}] Several functions in test.check gen ns are not in the clojure.spec gen ns."><y>#</y><d>2019-08-21</d><h>20:07</h><w>kenny</w><a>@johanatan</a> Several functions in test.check gen ns are not in the clojure.spec gen ns.</z><z id="t1566418144" t="Alex Miller (Clojure team) gen/let is a macro and only the primary functions are being dynaloaded"><y>#</y><d>2019-08-21</d><h>20:09</h><w>Alex Miller (Clojure team)</w>gen/let is a macro and only the primary functions are being dynaloaded</z><z id="t1566418182" t="Alex Miller (Clojure team) it&apos;s not impossible to do so but not high on our list of things to do, so you should just continue using the one from test.check if you need it"><y>#</y><d>2019-08-21</d><h>20:09</h><w>Alex Miller (Clojure team)</w>it&apos;s not impossible to do so but not high on our list of things to do, so you should just continue using the one from test.check if you need it</z><z id="t1566419831" t="johanatan ok, thx"><y>#</y><d>2019-08-21</d><h>20:37</h><w>johanatan</w>ok, thx</z><z id="t1566442385" t="kenny [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] Adding gen/let to the spec gen ns would be quite helpful. It basically a copy paste (unless there&apos;s some smarter way to dynamically expose a macro). We use gen/let all over the place via a helper ns. We cannot require test.check because we don&apos;t want it on the classpath at runtime."><y>#</y><d>2019-08-22</d><h>02:53</h><w>kenny</w><a>@alexmiller</a> Adding gen/let to the spec gen ns would be quite helpful. It basically a copy paste (unless there&apos;s some smarter way to dynamically expose a macro). We use gen/let all over the place via a helper ns. We cannot require test.check because we don&apos;t want it on the classpath at runtime.</z><z id="t1566444012" t="Alex Miller (Clojure team) because you need macros at compile time, I don&apos;t think you can dynamically include it the way we dynamically load the other functions from gen"><y>#</y><d>2019-08-22</d><h>03:20</h><w>Alex Miller (Clojure team)</w>because you need macros at compile time, I don&apos;t think you can dynamically include it the way we dynamically load the other functions from gen</z><z id="t1566444050" t="Alex Miller (Clojure team) there is actually a ticket for this though with a patch, but I don&apos;t remember if it just recreates the macro or what"><y>#</y><d>2019-08-22</d><h>03:20</h><w>Alex Miller (Clojure team)</w>there is actually a ticket for this though with a patch, but I don&apos;t remember if it just recreates the macro or what</z><z id="t1572772641" t="leonoel does the empty generator exist ?"><y>#</y><d>2019-11-03</d><h>09:17</h><w>leonoel</w>does the empty generator exist ?</z><z id="t1572799643" t="andy.fingerhut meaning, fails to generate anything?"><y>#</y><d>2019-11-03</d><h>16:47</h><w>andy.fingerhut</w>meaning, fails to generate anything?</z><z id="t1572799664" t="leonoel yes"><y>#</y><d>2019-11-03</d><h>16:47</h><w>leonoel</w>yes</z><z id="t1572799683" t="andy.fingerhut What would you expect it to do if you tried to cause it to generate a value? Throw an exception?"><y>#</y><d>2019-11-03</d><h>16:48</h><w>andy.fingerhut</w>What would you expect it to do if you tried to cause it to generate a value?  Throw an exception?</z><z id="t1572799690" t="gfredericks Can make it with such-that, if so"><y>#</y><d>2019-11-03</d><h>16:48</h><w>gfredericks</w>Can make it with such-that, if so</z><z id="t1572799747" t="andy.fingerhut Can you describe a situation where it would be useful to have a generator that doesn&apos;t generate anything? I&apos;m lacking imagination there."><y>#</y><d>2019-11-03</d><h>16:49</h><w>andy.fingerhut</w>Can you describe a situation where it would be useful to have a generator that doesn&apos;t generate anything?  I&apos;m lacking imagination there.</z><z id="t1572799903" t="leonoel I&apos;m working on regular languages, and I&apos;m willing to construct a generator for words of a given language"><y>#</y><d>2019-11-03</d><h>16:51</h><w>leonoel</w>I&apos;m working on regular languages, and I&apos;m willing to construct a generator for words of a given language</z><z id="t1572799946" t="leonoel so, does it makes sense to have a generator for words of the empty language ?"><y>#</y><d>2019-11-03</d><h>16:52</h><w>leonoel</w>so, does it makes sense to have a generator for words of the empty language ?</z><z id="t1572799966" t="gfredericks Sure"><y>#</y><d>2019-11-03</d><h>16:52</h><w>gfredericks</w>Sure</z><z id="t1572799977" t="andy.fingerhut Would it just throw an exception when you tried to generate such a word?"><y>#</y><d>2019-11-03</d><h>16:52</h><w>andy.fingerhut</w>Would it just throw an exception when you tried to generate such a word?</z><z id="t1572799999" t="leonoel no, because it&apos;s not error"><y>#</y><d>2019-11-03</d><h>16:53</h><w>leonoel</w>no, because it&apos;s not error</z><z id="t1572800001" t="gfredericks I&apos;d hope so"><y>#</y><d>2019-11-03</d><h>16:53</h><w>gfredericks</w>I&apos;d hope so</z><z id="t1572800016" t="andy.fingerhut If it returns a value, that would be interpreted as a generated valid value, wouldn&apos;t it?"><y>#</y><d>2019-11-03</d><h>16:53</h><w>andy.fingerhut</w>If it returns a value, that would be interpreted as a generated valid value, wouldn&apos;t it?</z><z id="t1572800017" t="gfredericks What would it generate then?"><y>#</y><d>2019-11-03</d><h>16:53</h><w>gfredericks</w>What would it generate then?</z><z id="t1572800063" t="leonoel it would generate nothing"><y>#</y><d>2019-11-03</d><h>16:54</h><w>leonoel</w>it would generate nothing</z><z id="t1572800083" t="andy.fingerhut What would a call to samples return? (edit: I meant a call to gen/sample )"><y>#</y><d>2019-11-03</d><h>16:54</h><w>andy.fingerhut</w>What would a call to <code>samples</code> return?   (edit: I meant a call to <code>gen/sample</code>)</z><z id="t1572800097" t="leonoel an empty list"><y>#</y><d>2019-11-03</d><h>16:54</h><w>leonoel</w>an empty list</z><z id="t1572800112" t="gfredericks There&apos;s no such thing as generating nothing"><y>#</y><d>2019-11-03</d><h>16:55</h><w>gfredericks</w>There&apos;s no such thing as generating nothing</z><z id="t1572800157" t="gfredericks Similar to there&apos;s no such thing as a function that returns nothing"><y>#</y><d>2019-11-03</d><h>16:55</h><w>gfredericks</w>Similar to there&apos;s no such thing as a function that returns nothing</z><z id="t1572800241" t="andy.fingerhut e.g. a generator that returns nil is thereby indicating: nil is a value that satisfies the desired predicate. Not that there is no valid value satisfying the predicate."><y>#</y><d>2019-11-03</d><h>16:57</h><w>andy.fingerhut</w>e.g. a generator that returns <code>nil</code> is thereby indicating: <code>nil</code> is a value that satisfies the desired predicate.  Not that there is no valid value satisfying the predicate.</z><z id="t1572800502" t="gfredericks I guess a downside of using a throwing generator for the empty language is that test.check wouldn&apos;t let you do things like create a disjunction using gen/one-of like you&apos;d want to"><y>#</y><d>2019-11-03</d><h>17:01</h><w>gfredericks</w>I guess a downside of using a throwing generator for the empty language is that test.check wouldn&apos;t let you do things like create a disjunction using gen/one-of like you&apos;d want to</z><z id="t1572800526" t="gfredericks That would just give you a generator that threw half the time, which is obviously wrong"><y>#</y><d>2019-11-03</d><h>17:02</h><w>gfredericks</w>That would just give you a generator that threw half the time, which is obviously wrong</z><z id="t1572800534" t="leonoel I don&apos;t fully understand why it doesn&apos;t make sense, and why e.g (g/one-of []) is forbidden."><y>#</y><d>2019-11-03</d><h>17:02</h><w>leonoel</w>I don&apos;t fully understand why it doesn&apos;t make sense, and why e.g <code>(g/one-of [])</code> is forbidden.</z><z id="t1572800567" t="leonoel this is really a noob question, I&apos;m not really familiar with this topic"><y>#</y><d>2019-11-03</d><h>17:02</h><w>leonoel</w>this is really a noob question, I&apos;m not really familiar with this topic</z><z id="t1572800579" t="gfredericks This might be a feature that could be added, but it would have to pervade a lot of the combinators"><y>#</y><d>2019-11-03</d><h>17:02</h><w>gfredericks</w>This might be a feature that could be added, but it would have to pervade a lot of the combinators</z><z id="t1572800626" t="gfredericks Like one-of would have to filter out empty generators from its input, for example"><y>#</y><d>2019-11-03</d><h>17:03</h><w>gfredericks</w>Like one-of would have to filter out empty generators from its input, for example</z><z id="t1572800643" t="gfredericks fmap and bind would have to short circuit"><y>#</y><d>2019-11-03</d><h>17:04</h><w>gfredericks</w>fmap and bind would have to short circuit</z><z id="t1572800649" t="gfredericks And on and on"><y>#</y><d>2019-11-03</d><h>17:04</h><w>gfredericks</w>And on and on</z><z id="t1572800694" t="andy.fingerhut Well, if you used such-that with an arbitrary function predicate that always returned false, test.check would have no general way to identify all possible generate-nothing generators. It could only recognize ones that you made obvious were generating-nothing generators."><y>#</y><d>2019-11-03</d><h>17:04</h><w>andy.fingerhut</w>Well, if you used such-that with an arbitrary function predicate that always returned false, test.check would have no general way to identify all possible generate-nothing generators.  It could only recognize ones that you made obvious were generating-nothing generators.</z><z id="t1572800707" t="gfredericks Yes"><y>#</y><d>2019-11-03</d><h>17:05</h><w>gfredericks</w>Yes</z><z id="t1572800717" t="gfredericks Which is why the pervasive support is important"><y>#</y><d>2019-11-03</d><h>17:05</h><w>gfredericks</w>Which is why the pervasive support is important</z><z id="t1572800730" t="gfredericks To track emptiness"><y>#</y><d>2019-11-03</d><h>17:05</h><w>gfredericks</w>To track emptiness</z><z id="t1572800768" t="andy.fingerhut So one-of would have to try invoking empty generators, and have a way of getting back &quot;I didn&apos;t generate anything&quot;, wouldn&apos;t it? i.e. in order to enable arbitrary empty gens."><y>#</y><d>2019-11-03</d><h>17:06</h><w>andy.fingerhut</w>So one-of would have to try invoking empty generators, and have a way of getting back &quot;I didn&apos;t generate anything&quot;, wouldn&apos;t it?  i.e. in order to enable arbitrary empty gens.</z><z id="t1572800800" t="gfredericks I guess you could do it that way"><y>#</y><d>2019-11-03</d><h>17:06</h><r>gfredericks</r>I guess you could do it that way</z><z id="t1572800771" t="gfredericks And this would still be a generator that throws when you try to generate, so if that can&apos;t be useful to you, then even this idea wouldn&apos;t help"><y>#</y><d>2019-11-03</d><h>17:06</h><w>gfredericks</w>And this would still be a generator that throws when you try to generate, so if that can&apos;t be useful to you, then even this idea wouldn&apos;t help</z><z id="t1572800800" t="gfredericks I guess you could do it that way"><y>#</y><d>2019-11-03</d><h>17:06</h><w>gfredericks</w>I guess you could do it that way</z><z id="t1572800825" t="gfredericks Not sure how that would affect the usability of such-that"><y>#</y><d>2019-11-03</d><h>17:07</h><w>gfredericks</w>Not sure how that would affect the usability of such-that</z><z id="t1572800857" t="andy.fingerhut Not recommending that approach, necessarily, but it seems like one approach, the other being to say something like &quot;empty gens using such-that with arbitrary Clojure functions as predicates may throw exceptions, or some other behavior you might not like, if you try to use them&quot;"><y>#</y><d>2019-11-03</d><h>17:07</h><w>andy.fingerhut</w>Not recommending that approach, necessarily, but it seems like one approach, the other being to say something like &quot;empty gens using such-that with arbitrary Clojure functions as predicates may throw exceptions, or some other behavior you might not like, if you try to use them&quot;</z><z id="t1572800859" t="gfredericks That&apos;s a pretty deep breaking change, though, so I doubt it would be added as a feature"><y>#</y><d>2019-11-03</d><h>17:07</h><w>gfredericks</w>That&apos;s a pretty deep breaking change, though, so I doubt it would be added as a feature</z><z id="t1572801167" t="leonoel is (g/such-that (constantly false) generator) a terrible idea ?"><y>#</y><d>2019-11-03</d><h>17:12</h><w>leonoel</w>is <code>(g/such-that (constantly false) generator)</code> a terrible idea ?</z><z id="t1572801187" t="gfredericks No, but it throws, and you said you didn&apos;t want that"><y>#</y><d>2019-11-03</d><h>17:13</h><w>gfredericks</w>No, but it throws, and you said you didn&apos;t want that</z><z id="t1572801209" t="gfredericks Also it doesn&apos;t compose like I suspect you&apos;d want for regular languages"><y>#</y><d>2019-11-03</d><h>17:13</h><w>gfredericks</w>Also it doesn&apos;t compose like I suspect you&apos;d want for regular languages</z><z id="t1572801251" t="gfredericks But if you use it without composing, it&apos;d work fine"><y>#</y><d>2019-11-03</d><h>17:14</h><w>gfredericks</w>But if you use it without composing, it&apos;d work fine</z><z id="t1572801263" t="leonoel that matches my intuition"><y>#</y><d>2019-11-03</d><h>17:14</h><w>leonoel</w>that matches my intuition</z><z id="t1572801320" t="leonoel I ended up working with nil able generators, and it&apos;s not that clumsy so I&apos;ll keep it that way"><y>#</y><d>2019-11-03</d><h>17:15</h><w>leonoel</w>I ended up working with <code>nil</code>able generators, and it&apos;s not that clumsy so I&apos;ll keep it that way</z><z id="t1572801376" t="gfredericks Meaning a generator that generates nil, or a context where you either have a generator or you have nil?"><y>#</y><d>2019-11-03</d><h>17:16</h><w>gfredericks</w>Meaning a generator that generates nil, or a context where you either have a generator or you have nil?</z><z id="t1572801391" t="leonoel the latter"><y>#</y><d>2019-11-03</d><h>17:16</h><w>leonoel</w>the latter</z><z id="t1572801400" t="gfredericks Sounds fine"><y>#</y><d>2019-11-03</d><h>17:16</h><w>gfredericks</w>Sounds fine</z><z id="t1572801435" t="leonoel OK thank you for clarification"><y>#</y><d>2019-11-03</d><h>17:17</h><w>leonoel</w>OK thank you for clarification</z><z id="t1576542115" t="jvtrigueros Hi all, I&apos;m debugging a failing test that uses test.check &apos;s defspec . When my test fails, I&apos;m able to obtain the seed and I can see the value that caused the test to fail, however, neither the exact value or the reduced value produce the failure. I reckon it&apos;s the sequence of values that cause the failure Dx Is there a way that I can output the values so that I can execute them in order and see the failure? The only thing that comes to mind is spit ing the values inside the for-all closure."><y>#</y><d>2019-12-17</d><h>00:21</h><w>jvtrigueros</w>Hi all, I&apos;m debugging a failing test that uses <code>test.check</code>&apos;s <code>defspec</code>. When my test fails, I&apos;m able to obtain the seed and I can see the value that caused the test to fail, however, neither the exact value or the reduced value produce the failure.

I reckon it&apos;s the sequence of values that cause the failure Dx

Is there a way that I can output the values so that I can execute them in order and see the failure? The only thing that comes to mind is <code>spit</code>ing the values inside the <code>for-all</code> closure.</z><z id="t1576542557" t="gfredericks That would work. This isn&apos;t a &quot;supported&quot; scenario because it&apos;s assumed that your test passes or fails solely based on the generated values"><y>#</y><d>2019-12-17</d><h>00:29</h><w>gfredericks</w>That would work. This isn&apos;t a &quot;supported&quot; scenario because it&apos;s assumed that your test passes or fails solely based on the generated values</z><z id="t1576542592" t="gfredericks So if you don&apos;t get your test into that form you&apos;ll be fighting the system the whole time"><y>#</y><d>2019-12-17</d><h>00:29</h><w>gfredericks</w>So if you don&apos;t get your test into that form you&apos;ll be fighting the system the whole time</z><z id="t1576542920" t="jvtrigueros Right. In this case, I&apos;m doing a roundtrip test with a DynamoDBLocal instance so I bet I&apos;m overwritting something causing failure in the tests."><y>#</y><d>2019-12-17</d><h>00:35</h><w>jvtrigueros</w>Right. In this case, I&apos;m doing a roundtrip test with a DynamoDBLocal instance so I bet I&apos;m overwritting something causing failure in the tests.</z><z id="t1576543688" t="jvtrigueros Thanks! That helped, I had an issue in my generator."><y>#</y><d>2019-12-17</d><h>00:48</h><w>jvtrigueros</w>Thanks! That helped, I had an issue in my generator.</z><z id="t1576547215" t="gfredericks For db stuff, I&apos;d generally look for a way to reset the db at the beginning of each trial, or partition the data so it doesn&apos;t overlap"><y>#</y><d>2019-12-17</d><h>01:46</h><w>gfredericks</w>For db stuff, I&apos;d generally look for a way to reset the db at the beginning of each trial, or partition the data so it doesn&apos;t overlap</z><z id="t1578155725" t="bartuka hi ppl, how do you usually integrate test.check with deftesting or midje?"><y>#</y><d>2020-01-04</d><h>16:35</h><w>bartuka</w>hi ppl, how do you usually integrate test.check with deftesting or midje?</z><z id="t1578155763" t="bartuka I am slowly building some property-based tests in my code base to learn more about it, but I currently use midje to my tests and would like to have it more integrated"><y>#</y><d>2020-01-04</d><h>16:36</h><w>bartuka</w>I am slowly building some property-based tests in my code base to learn more about it, but I currently use <code>midje</code>to my tests and would like to have it more integrated</z><z id="t1578158848" t="gfredericks At worst you can call the quickcheck function and assert that the pass? key (or whatever it&apos;s called) is true"><y>#</y><d>2020-01-04</d><h>17:27</h><w>gfredericks</w>At worst you can call the quickcheck function and assert that the pass? key (or whatever it&apos;s called) is true</z><z id="t1578158890" t="gfredericks defspec is the normal integration point with clojure.test, I have no idea if that&apos;s usable with midje"><y>#</y><d>2020-01-04</d><h>17:28</h><w>gfredericks</w>defspec is the normal integration point with clojure.test, I have no idea if that&apos;s usable with midje</z><z id="t1578163366" t="bartuka I had done this macro to help me... it&apos;s working but not ideal (defmacro check-that [desc n property] `(fact ~desc (let [check# (tc/quick-check ~n ~property) passed# (:result check#)] (when-not passed# (clojure.pprint/pprint check#)) passed# =&gt; true)))"><y>#</y><d>2020-01-04</d><h>18:42</h><w>bartuka</w>I had done this macro to help me... it&apos;s working but not ideal
<pre>(defmacro check-that [desc n property]
  `(fact ~desc
     (let [check# (tc/quick-check ~n ~property)
           passed# (:result check#)]
       (when-not passed# (clojure.pprint/pprint check#))
       passed# =&gt; true)))</pre></z><z id="t1578163392" t="bartuka the message when error occur is not visible in the midje stack trace.. but I still get it."><y>#</y><d>2020-01-04</d><h>18:43</h><w>bartuka</w>the message when error occur is not visible in the <code>midje</code> stack trace.. but I still get it.</z><z id="t1578164279" t="gfredericks you&apos;re checking the wrong return key"><y>#</y><d>2020-01-04</d><h>18:57</h><w>gfredericks</w>you&apos;re checking the wrong return key</z><z id="t1578164286" t="gfredericks exceptions are exactly the edge case where that doesn&apos;t work"><y>#</y><d>2020-01-04</d><h>18:58</h><w>gfredericks</w>exceptions are exactly the edge case where that doesn&apos;t work</z><z id="t1578164325" t="gfredericks you want the :pass? key: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check.cljc#L108"><y>#</y><d>2020-01-04</d><h>18:58</h><w>gfredericks</w>you want the <code>:pass?</code> key: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check.cljc#L108" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check.cljc#L108</a></z><z id="t1578164371" t="gfredericks if you want exceptions reported the way midje would, you can also do something like (when (and (not (:pass? check#)) (:result check#)) (throw (:result check#)))"><y>#</y><d>2020-01-04</d><h>18:59</h><w>gfredericks</w>if you want exceptions reported the way midje would, you can also do something like

<pre>(when (and (not (:pass? check#)) (:result check#))
  (throw (:result check#)))</pre></z><z id="t1578164389" t="gfredericks or maybe midje has a less hacky way to do that"><y>#</y><d>2020-01-04</d><h>18:59</h><w>gfredericks</w>or maybe midje has a less hacky way to do that</z><z id="t1578164415" t="bartuka oh.. didn&apos;t know!! thanks"><y>#</y><d>2020-01-04</d><h>19:00</h><w>bartuka</w>oh.. didn&apos;t know!! thanks</z><z id="t1578164433" t="gfredericks the keys are a bit confusingly named for legacy reasons"><y>#</y><d>2020-01-04</d><h>19:00</h><w>gfredericks</w>the keys are a bit confusingly named for legacy reasons</z><z id="t1578164484" t="gfredericks but they&apos;re described in the docstring at least"><y>#</y><d>2020-01-04</d><h>19:01</h><w>gfredericks</w>but they&apos;re described in the docstring at least</z><z id="t1578164570" t="bartuka the :result key is not a boolean? So when an exception happen the result will be a keyword :exception something like that?"><y>#</y><d>2020-01-04</d><h>19:02</h><w>bartuka</w>the :result key is not a boolean? So when an exception happen the result will be a keyword :exception something like that?</z><z id="t1578164590" t="gfredericks no it&apos;ll be an actual exception object"><y>#</y><d>2020-01-04</d><h>19:03</h><w>gfredericks</w>no it&apos;ll be an actual exception object</z><z id="t1578164606" t="gfredericks :pass? is always a boolean"><y>#</y><d>2020-01-04</d><h>19:03</h><w>gfredericks</w><code>:pass?</code> is always a boolean</z><z id="t1578164668" t="bartuka got it! thanks for the hint"><y>#</y><d>2020-01-04</d><h>19:04</h><w>bartuka</w>got it! thanks for the hint</z><z id="t1578164718" t="bartuka just watched your presentation and started to write tests to a utils namespace I have in my current project"><y>#</y><d>2020-01-04</d><h>19:05</h><w>bartuka</w>just watched your presentation and started to write tests to a utils namespace I have in my current project</z><z id="t1578164740" t="bartuka interesting bits already pop out!! some edge cases dealing with dates 😃"><y>#</y><d>2020-01-04</d><h>19:05</h><w>bartuka</w>interesting bits already pop out!! some edge cases dealing with dates <b>😃</b></z><z id="t1578164820" t="bartuka and a performance issue as well. lol. The prod version of the code took 12secs to run 1000 times.. after some refactor it went down to 2sec. And it still works! I used to slow one to validate the fast impl. (Y)"><y>#</y><d>2020-01-04</d><h>19:07</h><w>bartuka</w>and a performance issue as well. lol. The prod version of the code took 12secs to run 1000 times.. after some refactor it went down to 2sec. And it still works! I used to slow one to validate the fast impl. (Y)</z><z id="t1578164847" t="gfredericks oh yeah, I love the before-and-after refactoring check"><y>#</y><d>2020-01-04</d><h>19:07</h><w>gfredericks</w>oh yeah, I love the before-and-after refactoring check</z><z id="t1578164925" t="gfredericks &quot;test.check as incentive to make your code faster&quot; is an angle I hadn&apos;t considered before 🙂"><y>#</y><d>2020-01-04</d><h>19:08</h><w>gfredericks</w>&quot;test.check as incentive to make your code faster&quot; is an angle I hadn&apos;t considered before <b>🙂</b></z><z id="t1578164962" t="gfredericks it&apos;s almost the opposite of the TDD people that put high effort into making the tests extremely fast"><y>#</y><d>2020-01-04</d><h>19:09</h><w>gfredericks</w>it&apos;s almost the opposite of the TDD people that put high effort into making the tests extremely fast</z><z id="t1578165034" t="bartuka that&apos;s true. I stumbled in test.check because I am really studying tests as a whole subject and experimenting it in my project here"><y>#</y><d>2020-01-04</d><h>19:10</h><w>bartuka</w>that&apos;s true. I stumbled in test.check because I am really studying tests as a whole subject and experimenting it in my project here</z><z id="t1578165059" t="bartuka this subject has people with very very strong opinions hehehe"><y>#</y><d>2020-01-04</d><h>19:10</h><w>bartuka</w>this subject has people with very very strong opinions hehehe</z><z id="t1578165103" t="bartuka saw some guy arguing that Golang was the standard language for TDD because of the incredible fast feedback you get from your entire suite running in ms"><y>#</y><d>2020-01-04</d><h>19:11</h><w>bartuka</w>saw some guy arguing that Golang was the standard language for TDD because of the incredible fast feedback you get from your entire suite running in ms</z><z id="t1578165114" t="bartuka o.O"><y>#</y><d>2020-01-04</d><h>19:11</h><w>bartuka</w>o.O</z><z id="t1578165135" t="gfredericks ¯\(ツ)/¯"><y>#</y><d>2020-01-04</d><h>19:12</h><w>gfredericks</w>¯\(ツ)/¯</z><z id="t1578165224" t="bartuka do you have more material about property-based tests to share? I am looking for something more conceptual about how to spot invariants"><y>#</y><d>2020-01-04</d><h>19:13</h><w>bartuka</w>do you have more material about property-based tests to share? I am looking for something more conceptual about how to spot invariants</z><z id="t1578165254" t="bartuka I know it is very context based, but some general concepts must be applicable"><y>#</y><d>2020-01-04</d><h>19:14</h><w>bartuka</w>I know it is very context based, but some general concepts must be applicable</z><z id="t1578165266" t="gfredericks there&apos;s language-agnostic material on that subject"><y>#</y><d>2020-01-04</d><h>19:14</h><w>gfredericks</w>there&apos;s language-agnostic material on that subject</z><z id="t1578165284" t="gfredericks or rather, any material on that subject regardless of language would be applicable"><y>#</y><d>2020-01-04</d><h>19:14</h><w>gfredericks</w>or rather, any material on that subject regardless of language would be applicable</z><z id="t1578165336" t="gfredericks e.g., a quick trip in the googlemobile suggested: https://fsharpforfunandprofit.com/posts/property-based-testing-2/"><y>#</y><d>2020-01-04</d><h>19:15</h><w>gfredericks</w>e.g., a quick trip in the googlemobile suggested: <a href="https://fsharpforfunandprofit.com/posts/property-based-testing-2/" target="_blank">https://fsharpforfunandprofit.com/posts/property-based-testing-2/</a></z><z id="t1578165489" t="bartuka cool, thanks! I will keep my search as well o/"><y>#</y><d>2020-01-04</d><h>19:18</h><w>bartuka</w>cool, thanks! I will keep my search as well o/</z><z id="t1578165719" t="Alex Miller (Clojure team) I spent a bit of time trying to talk about this in Clojure Applied, not sure I said anything revolutionary, but perhaps of interest"><y>#</y><d>2020-01-04</d><h>19:21</h><w>Alex Miller (Clojure team)</w>I spent a bit of time trying to talk about this in Clojure Applied, not sure I said anything revolutionary, but perhaps of interest</z><z id="t1578165920" t="bartuka I like when ppl suggest a book and I have it hehe. thanks for pointing out [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] Part III on Practices (Y)"><y>#</y><d>2020-01-04</d><h>19:25</h><w>bartuka</w>I like when ppl suggest a book and I have it hehe. thanks for pointing out <a>@alexmiller</a> Part III on Practices (Y)</z><z id="t1578166068" t="Alex Miller (Clojure team) yeah, it&apos;s chapter 8"><y>#</y><d>2020-01-04</d><h>19:27</h><w>Alex Miller (Clojure team)</w>yeah, it&apos;s chapter 8</z><z id="t1578168653" t="bartuka gosh, how can I work next monday o.O I just got this error from a test: There is insufficient memory for the Java Runtime Environment to continue. repl_1 | # Native memory allocation (malloc) failed to allocate 312 bytes for AllocateHeap repl_1 | # An error report file with more information is saved as: repl_1 | # /app/hs_err_pid46.log It is a simple code to add business days taking into account Brazilian holidays to an java.util.Date. But the generator is creating java.util.Date with any values for min,secs and millis. Then, this happened: (.equals #inst &quot;1980-02-02T00:01:01.000-00:00&quot; #inst &quot;1980-02-02T01:00:01.000-00:00&quot;)"><y>#</y><d>2020-01-04</d><h>20:10</h><w>bartuka</w>gosh, how can I work next monday o.O

I just got this error from a test:
<pre>There is insufficient memory for the Java Runtime Environment to continue.
 repl_1  | # Native memory allocation (malloc) failed to allocate 312 bytes for AllocateHeap
 repl_1  | # An error report file with more information is saved as:
 repl_1  | # /app/hs_err_pid46.log</pre>
It is a simple code to add business days taking into account Brazilian holidays to an java.util.Date. But the generator is creating java.util.Date with any values for min,secs and millis. Then, this happened:
<pre>(.equals #inst &quot;1980-02-02T00:01:01.000-00:00&quot; #inst &quot;1980-02-02T01:00:01.000-00:00&quot;)</pre></z><z id="t1578169808" t="bartuka I edit.. both were the same, year, month and day. But different hour."><y>#</y><d>2020-01-04</d><h>20:30</h><r>bartuka</r>I edit.. both were the same, year, month and day. But different hour.</z><z id="t1578168667" t="bartuka it was suppose to be true in the prod code =("><y>#</y><d>2020-01-04</d><h>20:11</h><w>bartuka</w>it was suppose to be true in the prod code =(</z><z id="t1578168698" t="gfredericks ... why?"><y>#</y><d>2020-01-04</d><h>20:11</h><w>gfredericks</w>... why?</z><z id="t1578168749" t="bartuka people [me probably] was imagining this code as a Date not DateTime inputs"><y>#</y><d>2020-01-04</d><h>20:12</h><w>bartuka</w>people [me probably] was imagining this code as a Date not DateTime inputs</z><z id="t1578168765" t="bartuka but some day this extension happened without proper care rsrs"><y>#</y><d>2020-01-04</d><h>20:12</h><w>bartuka</w>but some day this extension happened without proper care rsrs</z><z id="t1578168780" t="gfredericks LocalDate?"><y>#</y><d>2020-01-04</d><h>20:13</h><w>gfredericks</w>LocalDate?</z><z id="t1578168794" t="bartuka yes"><y>#</y><d>2020-01-04</d><h>20:13</h><w>bartuka</w>yes</z><z id="t1578168870" t="gfredericks so many languages/libraries seem to encourage people to think of datetimes as localdates with more resolution, but that&apos;s not at all the case"><y>#</y><d>2020-01-04</d><h>20:14</h><w>gfredericks</w>so many languages/libraries seem to encourage people to think of datetimes as localdates with more resolution, but that&apos;s not at all the case</z><z id="t1578168925" t="bartuka yeah, first few minutes and a lot of lessons. This year will be nice. haha"><y>#</y><d>2020-01-04</d><h>20:15</h><w>bartuka</w>yeah, first few minutes and a lot of lessons. This year will be nice. haha</z><z id="t1578168991" t="bartuka and funny enough, we had an example-based tests.. but the java.util.date passed around was all with T01:00:01.000-00:00"><y>#</y><d>2020-01-04</d><h>20:16</h><w>bartuka</w>and funny enough, we had an example-based tests.. but the java.util.date passed around was all with <code>T01:00:01.000-00:00</code></z><z id="t1578183020" t="bartuka my snippet.. found some edge cases with interest-rate computation. I made a gist to show to others later, very compact and sums up everything I learned today. 1) Modeling my problem domain with generators (unfortunately, we have interest rates up to 400% an year for some loans here in Brazil.. i&apos;m not too pessimistic in my model lol), 2) testing invariants [round-trips operations ] https://gist.github.com/wandersoncferreira/183c56da92c4fe388efef05ca51af4fa"><y>#</y><d>2020-01-05</d><h>00:10</h><w>bartuka</w>my snippet.. found some edge cases with interest-rate computation. I made a gist to show to others later, very compact and sums up everything I learned today. 1) Modeling my problem domain with generators (unfortunately, we have interest rates up to 400% an year for some loans here in Brazil.. i&apos;m not too pessimistic in my model lol), 2) testing invariants [round-trips operations ] <a href="https://gist.github.com/wandersoncferreira/183c56da92c4fe388efef05ca51af4fa" target="_blank">https://gist.github.com/wandersoncferreira/183c56da92c4fe388efef05ca51af4fa</a></z><z id="t1578183033" t="bartuka three namespaces all covered. thanks guys o/"><y>#</y><d>2020-01-05</d><h>00:10</h><w>bartuka</w>three namespaces all covered. thanks guys o/</z><z id="t1578399105" t="bartuka I need to generate a list of maps that have distinct :number key. For example [{:number 1 ..}, {:number 2 ..}] and I need these numbers to be sequential. I tried (gen/vector-distinct-by :number (gen/hash-map :number gen/pos-int ...) and it does work but not as sequential numbers. I don&apos;t know now if I should try to create a generator to replace gen/pos-int or the vector-distinct-by . rsrs"><y>#</y><d>2020-01-07</d><h>12:11</h><w>bartuka</w>I need to generate a list of maps that have distinct :number key. For example [{:number 1 ..}, {:number 2 ..}] and I need these numbers to be sequential. I tried <code>(gen/vector-distinct-by :number (gen/hash-map :number gen/pos-int ...)</code> and it does work but not as sequential numbers. I don&apos;t know now if I should  try to create a generator to replace <code>gen/pos-int</code> or the <code>vector-distinct-by</code>. rsrs</z><z id="t1578403679" t="Alex Miller (Clojure team) test.check generators are generally for creating random things, not sequential things like that"><y>#</y><d>2020-01-07</d><h>13:27</h><w>Alex Miller (Clojure team)</w>test.check generators are generally for creating random things, not sequential things like that</z><z id="t1578412398" t="bartuka I was thinking about that when I got into this problem. But I want to model a situation where does not make sense to have this kind of behavior for example, a list of installments for a loan. They are generally numbered here."><y>#</y><d>2020-01-07</d><h>15:53</h><r>bartuka</r>I was thinking about that when I got into this problem. But I want to model a situation where does not make sense to have this kind of behavior for example, a list of installments for a loan. They are generally numbered here.</z><z id="t1578403756" t="Alex Miller (Clojure team) there may be some way to do it (gen an int that&apos;s the size of the range, gen/fmap that with range, gen/bind that with something that makes coll of maps)"><y>#</y><d>2020-01-07</d><h>13:29</h><w>Alex Miller (Clojure team)</w>there may be some way to do it (gen an int that&apos;s the size of the range, gen/fmap that with range, gen/bind that with something that makes coll of maps)</z><z id="t1578403768" t="Alex Miller (Clojure team) but you&apos;re going to be fighting the tide there"><y>#</y><d>2020-01-07</d><h>13:29</h><w>Alex Miller (Clojure team)</w>but you&apos;re going to be fighting the tide there</z><z id="t1578405590" t="gfredericks gen the collection (w/o numbers) and the minimum number separately; then gen/fmap them both to set all the numbers"><y>#</y><d>2020-01-07</d><h>13:59</h><w>gfredericks</w>gen the collection (w/o numbers) and the minimum number separately; then <code>gen/fmap</code> them both to set all the numbers</z><z id="t1578405666" t="gfredericks (gen/fmap (fn [{:keys [list-of-maps min-number]}] (map #(assoc %1 :number %2) list-of-maps (iterate inc min-number))) (gen/tuple gen-list-of-maps-without-number gen/large-integer))"><y>#</y><d>2020-01-07</d><h>14:01</h><w>gfredericks</w><code>(gen/fmap (fn [{:keys [list-of-maps min-number]}] (map #(assoc %1 :number %2) list-of-maps (iterate inc min-number))) (gen/tuple gen-list-of-maps-without-number gen/large-integer))</code></z><z id="t1578413044" t="bartuka [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] thanks for the guidelines... I did some adaptations to work as I intended. (def gen-list-of-maps-without-number (gen/not-empty (gen/list (gen/hash-map :testing gen/string-alpha-numeric :values gen/double)))) (gen/fmap (fn [[list-of-maps min-number]] (map #(assoc %1 :number %2) list-of-maps (iterate inc min-number))) (gen/not-empty (gen/tuple gen-list-of-maps-without-number (gen/large-integer* {:min 1 :max 72}))))"><y>#</y><d>2020-01-07</d><h>16:04</h><w>bartuka</w><a>@gfredericks</a> thanks for the guidelines... I did some adaptations to work as I intended.
<pre>(def gen-list-of-maps-without-number (gen/not-empty (gen/list (gen/hash-map :testing gen/string-alpha-numeric
                                                                            :values gen/double))))
(gen/fmap (fn [[list-of-maps min-number]]
            (map #(assoc %1 :number %2) list-of-maps (iterate inc min-number)))
          (gen/not-empty (gen/tuple gen-list-of-maps-without-number (gen/large-integer* {:min 1 :max 72}))))</pre></z><z id="t1578413427" t="gfredericks [:attrs {:href &quot;/_/_/users/UBSREKQ5Q&quot;}] the not-empty around tuple can be removed"><y>#</y><d>2020-01-07</d><h>16:10</h><w>gfredericks</w><a>@iagwanderson</a> the not-empty around tuple can be removed</z><z id="t1578413471" t="gfredericks Otherwise looks good"><y>#</y><d>2020-01-07</d><h>16:11</h><w>gfredericks</w>Otherwise looks good</z><z id="t1578439839" t="bartuka When I ran a test using defspec , I tried two kind of conditionals: 1) Only using a (and .. form and returning true for all branches of the test and 2) using is from clojure.test inside the (and.. form. I did this because without the is I cannot see which branch actually failed, I only get back the map with the current output and the smallest input that provides the failure."><y>#</y><d>2020-01-07</d><h>23:30</h><w>bartuka</w>When I ran a test using <code>defspec</code> , I tried two kind of conditionals: 1) Only using a <code>(and ..</code> form and returning true for all branches of the test and 2) using <code>is</code> from <code>clojure.test</code>  inside the (and.. form. I did this because without the <code>is</code> I cannot see which branch actually failed, I only get back the map with the current output and the smallest input that provides the failure.</z><z id="t1578439847" t="bartuka I would like to know the branch that failed"><y>#</y><d>2020-01-07</d><h>23:30</h><w>bartuka</w>I would like to know the branch that failed</z><z id="t1578439909" t="bartuka the real problem is that I have 200+ assertions now being reported by clojure.test if I place the is inside it and I lose the smallest input that provided the failure"><y>#</y><d>2020-01-07</d><h>23:31</h><w>bartuka</w>the real problem is that I have 200+ assertions now being reported by clojure.test if I place the <code>is</code> inside it and I lose the smallest input that provided the failure</z><z id="t1578439988" t="hiredman make each branch a separate defspec"><y>#</y><d>2020-01-07</d><h>23:33</h><w>hiredman</w>make each branch a separate defspec</z><z id="t1578440117" t="bartuka I thought about that, in this case here, I am validating the size of the returned list and them some content in the list."><y>#</y><d>2020-01-07</d><h>23:35</h><w>bartuka</w>I thought about that, in this case here, I am validating the size of the returned list and them some content in the list.</z><z id="t1578440138" t="bartuka it seems a lot of duplication of code to test only the count for example"><y>#</y><d>2020-01-07</d><h>23:35</h><w>bartuka</w>it seems a lot of duplication of code to test only the count for example</z><z id="t1578440217" t="hiredman they are distinct properties however"><y>#</y><d>2020-01-07</d><h>23:36</h><w>hiredman</w>they are distinct properties however</z><z id="t1578440585" t="bartuka seems like [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] had some ideas about that in this library: https://github.com/gfredericks/test.chuck"><y>#</y><d>2020-01-07</d><h>23:43</h><w>bartuka</w>seems like <a>@gfredericks</a> had some ideas about that in this library: <a href="https://github.com/gfredericks/test.chuck" target="_blank">https://github.com/gfredericks/test.chuck</a></z><z id="t1578440624" t="bartuka https://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html"><y>#</y><d>2020-01-07</d><h>23:43</h><w>bartuka</w><a href="https://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html" target="_blank">https://blog.colinwilliams.name/clojure/testing/2015/01/26/alternative-clojure-dot-test-integration-with-test-dot-check.html</a></z><z id="t1578445087" t="gfredericks yep, that&apos;s what that stuff is about"><y>#</y><d>2020-01-08</d><h>00:58</h><w>gfredericks</w>yep, that&apos;s what that stuff is about</z><z id="t1578445113" t="gfredericks also, the newer version of test.check has a more flexible API that would support some kind of library for giving more information about what failed"><y>#</y><d>2020-01-08</d><h>00:58</h><w>gfredericks</w>also, the newer version of test.check has a more flexible API that would support some kind of library for giving more information about what failed</z><z id="t1578454360" t="bartuka cool! I will tinker around that later"><y>#</y><d>2020-01-08</d><h>03:32</h><w>bartuka</w>cool! I will tinker around that later</z><z id="t1579738104" t="kenny Is there a way to generate an alphanumeric string of a specific length?"><y>#</y><d>2020-01-23</d><h>00:08</h><w>kenny</w>Is there a way to generate an alphanumeric string of a specific length?</z><z id="t1579738814" t="gfredericks I think all the string generators have corresponding char generators"><y>#</y><d>2020-01-23</d><h>00:20</h><w>gfredericks</w>I think all the string generators have corresponding char generators</z><z id="t1579738831" t="gfredericks So you can use that with vector, fmap, and str"><y>#</y><d>2020-01-23</d><h>00:20</h><w>gfredericks</w>So you can use that with vector, fmap, and str</z><z id="t1582561198" t="kenny Is there a way to know if the output from quick-check was the result of a generator throwing an exception versus the function throwing an exception?"><y>#</y><d>2020-02-24</d><h>16:19</h><w>kenny</w>Is there a way to know if the output from quick-check was the result of a generator throwing an exception versus the function throwing an exception?</z><z id="t1582561350" t="gfredericks I don&apos;t think generator exceptions get caught"><y>#</y><d>2020-02-24</d><h>16:22</h><w>gfredericks</w>I don&apos;t think generator exceptions get caught</z><z id="t1582561390" t="kenny Ah. I&apos;m calling via spec&apos;s check which does not throw in that case which explains the weird looking output."><y>#</y><d>2020-02-24</d><h>16:23</h><w>kenny</w>Ah. I&apos;m calling via spec&apos;s <code>check</code> which does not throw in that case which explains the weird looking output.</z><z id="t1582561427" t="gfredericks Does it catch exceptions?"><y>#</y><d>2020-02-24</d><h>16:23</h><w>gfredericks</w>Does it catch exceptions?</z><z id="t1582561446" t="kenny It appears so. When a gen throws, it attaches the generator exception on the :result key and nothing else."><y>#</y><d>2020-02-24</d><h>16:24</h><w>kenny</w>It appears so. When a gen throws, it attaches the generator exception on the <code>:result</code> key and nothing else.</z><z id="t1582561478" t="gfredericks Is it calling the generator manually?"><y>#</y><d>2020-02-24</d><h>16:24</h><w>gfredericks</w>Is it calling the generator manually?</z><z id="t1582561490" t="gfredericks Or it just catches everything?"><y>#</y><d>2020-02-24</d><h>16:24</h><w>gfredericks</w>Or it just catches everything?</z><z id="t1582561571" t="kenny https://github.com/clojure/spec.alpha/blob/e89e294a3e28765c8758d6ac8569ff8c4eda76ef/src/main/clojure/clojure/spec/test/alpha.clj#L306"><y>#</y><d>2020-02-24</d><h>16:26</h><w>kenny</w><a href="https://github.com/clojure/spec.alpha/blob/e89e294a3e28765c8758d6ac8569ff8c4eda76ef/src/main/clojure/clojure/spec/test/alpha.clj#L306" target="_blank">https://github.com/clojure/spec.alpha/blob/e89e294a3e28765c8758d6ac8569ff8c4eda76ef/src/main/clojure/clojure/spec/test/alpha.clj#L306</a></z><z id="t1582561599" t="kenny Hmm actually that&apos;s not even a generator throwing. It&apos;s a gen throwing while being constructed."><y>#</y><d>2020-02-24</d><h>16:26</h><w>kenny</w>Hmm actually that&apos;s not even a generator throwing. It&apos;s a gen throwing while being constructed.</z><z id="t1582561612" t="gfredericks Yeah"><y>#</y><d>2020-02-24</d><h>16:26</h><w>gfredericks</w>Yeah</z><z id="t1582561639" t="kenny Bad test case. Will see what happens when a gen actually throws."><y>#</y><d>2020-02-24</d><h>16:27</h><w>kenny</w>Bad test case. Will see what happens when a gen actually throws.</z><z id="t1582561651" t="gfredericks I don&apos;t like that return value"><y>#</y><d>2020-02-24</d><h>16:27</h><w>gfredericks</w>I don&apos;t like that return value</z><z id="t1582561657" t="kenny Agreed"><y>#</y><d>2020-02-24</d><h>16:27</h><w>kenny</w>Agreed</z><z id="t1582561678" t="kenny I&apos;m checking for it like this haha (and (instance? Throwable (:result ret)) (nil? (:shrunk ret)))"><y>#</y><d>2020-02-24</d><h>16:27</h><w>kenny</w>I&apos;m checking for it like this haha
<pre>(and (instance? Throwable (:result ret))
     (nil? (:shrunk ret)))</pre></z><z id="t1582561695" t="gfredericks Uckh"><y>#</y><d>2020-02-24</d><h>16:28</h><w>gfredericks</w>Uckh</z><z id="t1582561759" t="kenny Same thing when the gen throws"><y>#</y><d>2020-02-24</d><h>16:29</h><w>kenny</w>Same thing when the gen throws</z><z id="t1582561796" t="gfredericks Different part of the code returns the same thing?"><y>#</y><d>2020-02-24</d><h>16:29</h><w>gfredericks</w>Different part of the code returns the same thing?</z><z id="t1582561803" t="kenny Yep"><y>#</y><d>2020-02-24</d><h>16:30</h><w>kenny</w>Yep</z><z id="t1582561872" t="kenny I don&apos;t think there&apos;s any way for me to differentiate an exception from a generator throwing while construction and a generator throwing while generating."><y>#</y><d>2020-02-24</d><h>16:31</h><w>kenny</w>I don&apos;t think there&apos;s any way for me to differentiate an exception from a generator throwing while construction and a generator throwing while generating.</z><z id="t1582561960" t="gfredericks Except the stack trace 😉"><y>#</y><d>2020-02-24</d><h>16:32</h><w>gfredericks</w>Except the stack trace <b>😉</b></z><z id="t1582561989" t="kenny Yeah... Not sure where it&apos;s catching the gen throwing case."><y>#</y><d>2020-02-24</d><h>16:33</h><w>kenny</w>Yeah... Not sure where it&apos;s catching the gen throwing case.</z><z id="t1582562032" t="kenny It&apos;s not in that ns. Must be doing it elsewhere."><y>#</y><d>2020-02-24</d><h>16:33</h><w>kenny</w>It&apos;s not in that ns. Must be doing it elsewhere.</z><z id="t1583361067" t="sparkofreason Is there any way to limit the size of generated strings? I see the :max-size stuff in the context of checking properties, but I want it for generating samples."><y>#</y><d>2020-03-04</d><h>22:31</h><w>sparkofreason</w>Is there any way to limit the size of generated strings? I see the <code>:max-size</code> stuff in the context of checking properties, but I want it for generating samples.</z></g><g id="s8"><z id="t1583361533" t="gfredericks You can control size for individual generators"><y>#</y><d>2020-03-04</d><h>22:38</h><w>gfredericks</w>You can control size for individual generators</z><z id="t1583361589" t="gfredericks See gen/scale"><y>#</y><d>2020-03-04</d><h>22:39</h><w>gfredericks</w>See gen/scale</z><z id="t1583361988" t="sparkofreason Is there anything that would cause thread contention? I&apos;m trying to generate samples of collections in parallel, behaving oddly."><y>#</y><d>2020-03-04</d><h>22:46</h><w>sparkofreason</w>Is there anything that would cause thread contention? I&apos;m trying to generate samples of collections in parallel, behaving oddly.</z><z id="t1583362214" t="sparkofreason Hmmm, maybe it was just the scale thing."><y>#</y><d>2020-03-04</d><h>22:50</h><w>sparkofreason</w>Hmmm, maybe it was just the <code>scale</code> thing.</z><z id="t1583363515" t="gfredericks I can&apos;t think of any threading pitfalls"><y>#</y><d>2020-03-04</d><h>23:11</h><w>gfredericks</w>I can&apos;t think of any threading pitfalls</z><z id="t1583420312" t="sparkofreason Using scale fixed it. Looked like threading because several threads would run and complete quickly, then appear to get increasingly bogged down, even if they weren&apos;t asking for a lot of samples. But I think it was just generating progressively large strings the longer it ran. Once I limited the size of the strings, everything went fine."><y>#</y><d>2020-03-05</d><h>14:58</h><w>sparkofreason</w>Using <code>scale</code> fixed it. Looked like threading because several threads would run and complete quickly, then appear to get increasingly bogged down, even if they weren&apos;t asking for a lot of samples. But I think it was just generating progressively large strings the longer it ran. Once I limited the size of the strings, everything went fine.</z><z id="t1585675744" t="Braden Shepherdson I&apos;m really struggling with an opaque such-that failure. the references for the failure are at generators.cljc line 416, but I&apos;m not explicitly calling elements anywhere and I&apos;m not sure what&apos;s up."><y>#</y><d>2020-03-31</d><h>17:29</h><w>Braden Shepherdson</w>I&apos;m really struggling with an opaque such-that failure. the references for the failure are at <code>generators.cljc</code> line 416, but I&apos;m not explicitly calling <code>elements</code> anywhere and I&apos;m not sure what&apos;s up.</z><z id="t1585675757" t="Braden Shepherdson if I run my own generators 100,000 times it works fine."><y>#</y><d>2020-03-31</d><h>17:29</h><w>Braden Shepherdson</w>if I run my own generators 100,000 times it works fine.</z><z id="t1585677518" t="gfredericks What version is this?"><y>#</y><d>2020-03-31</d><h>17:58</h><w>gfredericks</w>What version is this?</z><z id="t1585677549" t="gfredericks (So I can follow the line number)"><y>#</y><d>2020-03-31</d><h>17:59</h><w>gfredericks</w>(So I can follow the line number)</z><z id="t1585677748" t="gfredericks Now that I think about it I bet you&apos;re getting misled by line numbers across versions"><y>#</y><d>2020-03-31</d><h>18:02</h><w>gfredericks</w>Now that I think about it I bet you&apos;re getting misled by line numbers across versions</z><z id="t1585677773" t="Braden Shepherdson I think I tracked down the source of that error; which is that (s/and int? #(&lt; -30 % 30)) implicitly uses such-that internally."><y>#</y><d>2020-03-31</d><h>18:02</h><w>Braden Shepherdson</w>I think I tracked down the source of that error; which is that <code>(s/and int? #(&lt; -30 % 30))</code> implicitly uses <code>such-that</code> internally.</z><z id="t1585677788" t="gfredericks Yeah that&apos;s the usual culprit"><y>#</y><d>2020-03-31</d><h>18:03</h><w>gfredericks</w>Yeah that&apos;s the usual culprit</z><z id="t1585677867" t="Braden Shepherdson I also apparently managed to break my REPL, and it kept telling me that something wasn&apos;t a generator when it clearly was. reloading it fixed that, not sure what caused it."><y>#</y><d>2020-03-31</d><h>18:04</h><w>Braden Shepherdson</w>I also apparently managed to break my REPL, and it kept telling me that something wasn&apos;t a generator when it clearly was. reloading it fixed that, not sure what caused it.</z><z id="t1585677902" t="Braden Shepherdson anyway, now it&apos;s working nicely."><y>#</y><d>2020-03-31</d><h>18:05</h><w>Braden Shepherdson</w>anyway, now it&apos;s working nicely.</z><z id="t1585677910" t="gfredericks Reloading the generators namespace somehow?"><y>#</y><d>2020-03-31</d><h>18:05</h><w>gfredericks</w>Reloading the generators namespace somehow?</z><z id="t1585678117" t="Braden Shepherdson not sure. now that I&apos;ve fixed the problem with my generators, it&apos;s not happening anymore."><y>#</y><d>2020-03-31</d><h>18:08</h><w>Braden Shepherdson</w>not sure. now that I&apos;ve fixed the problem with my generators, it&apos;s not happening anymore.</z><z id="t1585678126" t="gfredericks 🤷"><y>#</y><d>2020-03-31</d><h>18:08</h><w>gfredericks</w><b>🤷</b></z><z id="t1585678431" t="Braden Shepherdson yeah, it&apos;s a mystery. I&apos;m really loving the generative testing for fuzzing some complicated file encoding code, though."><y>#</y><d>2020-03-31</d><h>18:13</h><w>Braden Shepherdson</w>yeah, it&apos;s a mystery. I&apos;m really loving the generative testing for fuzzing some complicated file encoding code, though.</z><z id="t1585678494" t="gfredericks Yeah it&apos;s fun"><y>#</y><d>2020-03-31</d><h>18:14</h><w>gfredericks</w>Yeah it&apos;s fun</z><z id="t1586623737" t="kenny Is there a way to get test-check to continue running a check even if one fails? I&apos;m looking to create a large list of failure values for further analysis. Going to try using with-redefs on results/pass? . Curious if anyone else has done something like this."><y>#</y><d>2020-04-11</d><h>16:48</h><w>kenny</w>Is there a way to get test-check to continue running a check even if one fails? I&apos;m looking to create a large list of failure values for further analysis. Going to try using with-redefs on <code>results/pass?</code> . Curious if anyone else has done something like this.</z><z id="t1586623865" t="gfredericks Are you using defspec in particular? Do you want shrunk values or just original failures?"><y>#</y><d>2020-04-11</d><h>16:51</h><w>gfredericks</w>Are you using defspec in particular? 

Do you want shrunk values or just original failures?</z><z id="t1586625757" t="kenny [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] Just quick-check on a prop/for-all ."><y>#</y><d>2020-04-11</d><h>17:22</h><w>kenny</w><a>@gfredericks</a> Just <code>quick-check</code> on a <code>prop/for-all</code>.</z><z id="t1586625799" t="kenny In this case, I don&apos;t really care all that much on shrunk vs original."><y>#</y><d>2020-04-11</d><h>17:23</h><w>kenny</w>In this case, I don&apos;t really care all that much on shrunk vs original.</z><z id="t1586625803" t="gfredericks Wouldn&apos;t it be pretty easy to run it in a loop then?"><y>#</y><d>2020-04-11</d><h>17:23</h><w>gfredericks</w>Wouldn&apos;t it be pretty easy to run it in a loop then?</z><z id="t1586625852" t="kenny Loop over quick-check N times, collecting failures? Would that cover a good amount of surface area if the iterations to failure is small?"><y>#</y><d>2020-04-11</d><h>17:24</h><w>kenny</w>Loop over quick-check N times, collecting failures? Would that cover a good amount of surface area if the iterations to failure is small?</z><z id="t1586625923" t="gfredericks You&apos;re worried about there being some small likely failure that keeps getting found and obscuring other larger failures?"><y>#</y><d>2020-04-11</d><h>17:25</h><w>gfredericks</w>You&apos;re worried about there being some small likely failure that keeps getting found and obscuring other larger failures?</z><z id="t1586625931" t="kenny Right"><y>#</y><d>2020-04-11</d><h>17:25</h><w>kenny</w>Right</z><z id="t1586625963" t="kenny I think it&apos;s likely to fail in &lt; 5 tests."><y>#</y><d>2020-04-11</d><h>17:26</h><w>kenny</w>I think it&apos;s likely to fail in &lt; 5 tests.</z><z id="t1586626010" t="kenny I&apos;m looking to find holes in my specs, verifying that the hole is correct or the spec is wrong."><y>#</y><d>2020-04-11</d><h>17:26</h><w>kenny</w>I&apos;m looking to find holes in my specs, verifying that the hole is correct or the spec is wrong.</z><z id="t1586626063" t="gfredericks So the tc failure doesn&apos;t represent an actual bug?"><y>#</y><d>2020-04-11</d><h>17:27</h><w>gfredericks</w>So the tc failure doesn&apos;t represent an actual bug?</z><z id="t1586626095" t="kenny Yes - it may or may not."><y>#</y><d>2020-04-11</d><h>17:28</h><w>kenny</w>Yes - it may or may not.</z><z id="t1586626133" t="gfredericks Getting a PBT library to generate distinct failures without iteratively fixing the earlier ones is pretty hard/advanced"><y>#</y><d>2020-04-11</d><h>17:28</h><w>gfredericks</w>Getting a PBT library to generate distinct failures without iteratively fixing the earlier ones is pretty hard/advanced</z><z id="t1586626158" t="gfredericks Any small failure is likely to be a component of larger failures"><y>#</y><d>2020-04-11</d><h>17:29</h><w>gfredericks</w>Any small failure is likely to be a component of larger failures</z><z id="t1586626213" t="kenny For sure. Distinct can be impossible to define too 🙂"><y>#</y><d>2020-04-11</d><h>17:30</h><w>kenny</w>For sure. Distinct can be impossible to define too <b>🙂</b></z><z id="t1586626234" t="gfredericks Yep that&apos;s part of it"><y>#</y><d>2020-04-11</d><h>17:30</h><w>gfredericks</w>Yep that&apos;s part of it</z><z id="t1586626373" t="gfredericks You can get it to start at larger sizes if you think that will help"><y>#</y><d>2020-04-11</d><h>17:32</h><w>gfredericks</w>You can get it to start at larger sizes if you think that will help</z><z id="t1586626386" t="gfredericks gen/scale"><y>#</y><d>2020-04-11</d><h>17:33</h><w>gfredericks</w>gen/scale</z><z id="t1586626437" t="gfredericks With min"><y>#</y><d>2020-04-11</d><h>17:33</h><w>gfredericks</w>With min</z><z id="t1586626458" t="kenny To be more specific about my problem... We have a wrapper around some data pulled from an external API. We query data out using flat maps. Sometimes your query may have no results. This is the &quot;problem&quot;. The solution is either: 1) Our generator for the query generated a map that should never be possible. We need to fix the generator (this can be hard) or acknowledge that this case will return no results 2) The external API is missing data for a particular query that should be there. We need to open a support case with the 3rd party, asking them why this is the case and what should be done."><y>#</y><d>2020-04-11</d><h>17:34</h><w>kenny</w>To be more specific about my problem... We have a wrapper around some data pulled from an external API. We query data out using flat maps. Sometimes your query may have no results. This is the &quot;problem&quot;. The solution is either: 1) Our generator for the query generated a map that should never be possible. We need to fix the generator (this can be hard) or acknowledge that this case will return no results 2) The external API is missing data for a particular query that should be there. We need to open a support case with the 3rd party, asking them why this is the case and what should be done.</z><z id="t1586626526" t="kenny Hmm, that&apos;s interesting. I&apos;ll try your loop approach first and see what results it brings. If it seems to be missing some cases I can try scaling the gen. Perhaps even using a random scale with each loop."><y>#</y><d>2020-04-11</d><h>17:35</h><w>kenny</w>Hmm, that&apos;s interesting. I&apos;ll try your loop approach first and see what results it brings. If it seems to be missing some cases I can try scaling the gen. Perhaps even using a random scale with each loop.</z><z id="t1586626568" t="gfredericks Sure"><y>#</y><d>2020-04-11</d><h>17:36</h><w>gfredericks</w>Sure</z><z id="t1586626593" t="kenny Thanks 🙂"><y>#</y><d>2020-04-11</d><h>17:36</h><w>kenny</w>Thanks <b>🙂</b></z><z id="t1587041101" t="Matheus Moreira hello! does anyone know if it is possible to use test.check’s let generator to create a spec using spec’s with-gen ? basically i am spec’ing a function and one for one of the args i use let to create the generator. the problem is that it doesn’t work if i try (spec/with-gen a-spec #(tcg/let…)) or (spec/with-gen a-spec (tcg/let…)) . it seems that something is missing to bridge from test.check to spec."><y>#</y><d>2020-04-16</d><h>12:45</h><w>Matheus Moreira</w>hello! does anyone know if it is possible to use test.check’s <code>let</code> generator to create a spec using spec’s <code>with-gen</code>? basically i am spec’ing a function and one for one of the args i use <code>let</code> to create the generator. the problem is that it doesn’t work if i try <code>(spec/with-gen a-spec #(tcg/let…))</code> or <code>(spec/with-gen a-spec (tcg/let…))</code>. it seems that something is missing to bridge from test.check to spec.</z><z id="t1587042272" t="gfredericks [:attrs {:href &quot;/_/_/users/UHHU84TKQ&quot;}] that first one should work; what happens when you try it?"><y>#</y><d>2020-04-16</d><h>13:04</h><w>gfredericks</w><a>@matheus.emm</a> that first one should work; what happens when you try it?</z><z id="t1587042350" t="Matheus Moreira this is the error that i see: Error printing return value (ClassCastException) at advent.code.2019.day4/fn$fn (day4.clj:48). class clojure.test.check.generators.Generator cannot be cast to class clojure.lang.IFn (clojure.test.check.generators.Generator is in unnamed module of loader clojure.lang.DynamicClassLoader @717f07d1; clojure.lang.IFn is in unnamed module of loader &apos;app&apos;)"><y>#</y><d>2020-04-16</d><h>13:05</h><r>Matheus Moreira</r>this is the error that i see:
<pre>Error printing return value (ClassCastException) at advent.code.2019.day4/fn$fn (day4.clj:48).
class clojure.test.check.generators.Generator cannot be cast to class clojure.lang.IFn (clojure.test.check.generators.Generator is in unnamed module of loader clojure.lang.DynamicClassLoader @717f07d1; clojure.lang.IFn is in unnamed module of loader &apos;app&apos;)</pre></z><z id="t1587042402" t="Matheus Moreira and this is the function spec: (spec/fdef repeated-consecutive-digits? :args (spec/cat :ds (spec/with-gen (spec/coll-of nat-int? :kind vector? :min-count 1) (fn [] (check.gen/let [n (check.gen/elements #{2 3 4 5 6}) x (check.gen/nat) d (check.gen/vector-distinct (check.gen/such-that #(not= % x) (check.gen/nat)) (- 6 n)) i (check.gen/elements (range (- 6 n)))] (concat (subvec d 0 i) (repeat n x) (subvec d (+ i n))))))))"><y>#</y><d>2020-04-16</d><h>13:06</h><r>Matheus Moreira</r>and this is the function spec:
<pre>(spec/fdef repeated-consecutive-digits?
  :args (spec/cat
         :ds
         (spec/with-gen
           (spec/coll-of nat-int? :kind vector? :min-count 1)
           (fn []
             (check.gen/let [n (check.gen/elements #{2 3 4 5 6})
                             x (check.gen/nat)
                             d (check.gen/vector-distinct
                                (check.gen/such-that #(not= % x)
                                                     (check.gen/nat))
                                (- 6 n))
                             i (check.gen/elements (range (- 6 n)))]
               (concat (subvec d 0 i)
                       (repeat n x)
                       (subvec d (+ i n))))))))</pre></z><z id="t1587042519" t="gfredericks nothing there looks weird to me"><y>#</y><d>2020-04-16</d><h>13:08</h><r>gfredericks</r>nothing there looks weird to me</z><z id="t1587042542" t="gfredericks well"><y>#</y><d>2020-04-16</d><h>13:09</h><r>gfredericks</r>well</z><z id="t1587042556" t="gfredericks maybe the problem is just (?&gt; "><y>#</y><d>2020-04-16</d><h>13:09</h><r>gfredericks</r>maybe the problem is just <code>(?&gt;</code><code></code><code></code></z><z id="t1587042567" t="gfredericks"><y>#</y><d>2020-04-16</d><h>13:09</h><r>gfredericks</r></z><z id="t1587042585" t="Matheus Moreira"><y>#</y><d>2020-04-16</d><h>13:09</h><r>Matheus Moreira</r></z><z id="t1587042718" t="Matheus Moreira"><y>#</y><d>2020-04-16</d><h>13:11</h><r>Matheus Moreira</r></z><z id="t1587042726" t="gfredericks"><y>#</y><d>2020-04-16</d><h>13:12</h><r>gfredericks</r></z><z id="t1587042769" t="Matheus Moreira"><y>#</y><d>2020-04-16</d><h>13:12</h><r>Matheus Moreira</r></z><z id="t1587502804" t="colinkahn [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] is this ticket still in consideration? https://clojure.atlassian.net/browse/TCHECK-147 Ran into this today which prompted a discussion in the #clojure channel and that ticket was linked."><y>#</y><d>2020-04-21</d><h>21:00</h><w>colinkahn</w><a>@gfredericks</a> is this ticket still in consideration? <a href="https://clojure.atlassian.net/browse/TCHECK-147" target="_blank">https://clojure.atlassian.net/browse/TCHECK-147</a> Ran into this today which prompted a discussion in the  #clojure channel and that ticket was linked.</z><z id="t1587503135" t="gfredericks I don&apos;t know why that ticket is still open"><y>#</y><d>2020-04-21</d><h>21:05</h><w>gfredericks</w>I don&apos;t know why that ticket is still open</z><z id="t1587503151" t="gfredericks See gen/any-equatable"><y>#</y><d>2020-04-21</d><h>21:05</h><w>gfredericks</w>See gen/any-equatable</z><z id="t1587503166" t="gfredericks I&apos;ll update the ticket sometime soon"><y>#</y><d>2020-04-21</d><h>21:06</h><w>gfredericks</w>I&apos;ll update the ticket sometime soon</z><z id="t1587503221" t="colinkahn I see, thanks. I saw any-equatable but was kind of hoping the scope was broader and that perhaps the defaults would not produce non-equatable things"><y>#</y><d>2020-04-21</d><h>21:07</h><w>colinkahn</w>I see, thanks. I saw any-equatable but was kind of hoping the scope was broader and that perhaps the defaults would not produce non-equatable things</z><z id="t1587503479" t="gfredericks See my comment in the thread in the other channel"><y>#</y><d>2020-04-21</d><h>21:11</h><w>gfredericks</w>See my comment in the thread in the other channel</z><z id="t1588255664" t="adamfrey When compiling an application including test.check in CLJS 1.10.597 I see this warning: WARNING: cljs.core/&lt;=, all arguments must be numbers, got [#{nil js/Number} number] instead at line 999 target/cljsbuild-compiler-2/clojure/test/check/generators.cljc googling that message shows me that it&apos;s been appearing in people&apos;s stack traces for years, but I couldn&apos;t find any discussion about that warning in particular on the slack archives or on JIRA. If anyone remembers prior discussion about this message would you mind pointing me to it or summarizing? Thanks."><y>#</y><d>2020-04-30</d><h>14:07</h><w>adamfrey</w>When compiling an application including test.check in CLJS <code>1.10.597</code> I see this warning:
<pre>WARNING: cljs.core/&lt;=, all arguments must be numbers, got [#{nil js/Number} number] instead at line 999 target/cljsbuild-compiler-2/clojure/test/check/generators.cljc</pre>
googling that message shows me that it&apos;s been appearing in people&apos;s stack traces for years, but I couldn&apos;t find any discussion about that warning in particular on the slack archives or on JIRA.
If anyone remembers prior discussion about this message would you mind pointing me to it or summarizing? Thanks.</z><z id="t1588255812" t="gfredericks I&apos;ve never heard of it"><y>#</y><d>2020-04-30</d><h>14:10</h><w>gfredericks</w>I&apos;ve never heard of it</z><z id="t1588255920" t="gfredericks What test.check version are you using?"><y>#</y><d>2020-04-30</d><h>14:12</h><w>gfredericks</w>What test.check version are you using?</z><z id="t1588255985" t="adamfrey I believe 1.0.0. This is all part of a big application, I think I&apos;ll try to recreate a minimal example"><y>#</y><d>2020-04-30</d><h>14:13</h><w>adamfrey</w>I believe 1.0.0. This is all part of a big application, I think I&apos;ll try to recreate a minimal example</z><z id="t1588255997" t="gfredericks That&apos;s not a version"><y>#</y><d>2020-04-30</d><h>14:13</h><w>gfredericks</w>That&apos;s not a version</z><z id="t1588256006" t="adamfrey oh, one sec"><y>#</y><d>2020-04-30</d><h>14:13</h><w>adamfrey</w>oh, one sec</z><z id="t1588256025" t="adamfrey https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown ?"><y>#</y><d>2020-04-30</d><h>14:13</h><w>adamfrey</w><a href="https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown" target="_blank">https://github.com/clojure/test.check/blob/master/CHANGELOG.markdown</a> ?</z><z id="t1588256087" t="gfredericks Woah"><y>#</y><d>2020-04-30</d><h>14:14</h><w>gfredericks</w>Woah</z><z id="t1588256109" t="adamfrey lol, I&apos;m bringing all the news today"><y>#</y><d>2020-04-30</d><h>14:15</h><w>adamfrey</w>lol, I&apos;m bringing all the news today</z><z id="t1588256111" t="gfredericks I guess Alex released it"><y>#</y><d>2020-04-30</d><h>14:15</h><w>gfredericks</w>I guess Alex released it</z><z id="t1588256665" t="Alex Miller (Clojure team) surprise!"><y>#</y><d>2020-04-30</d><h>14:24</h><r>Alex Miller (Clojure team)</r>surprise!</z><z id="t1588256120" t="gfredericks Okay well anyhow"><y>#</y><d>2020-04-30</d><h>14:15</h><w>gfredericks</w>Okay well anyhow</z><z id="t1588256154" t="gfredericks Line 999 doesn&apos;t have a &lt;= call"><y>#</y><d>2020-04-30</d><h>14:15</h><w>gfredericks</w>Line 999 doesn&apos;t have a &lt;= call</z><z id="t1588256182" t="gfredericks So I have no idea what it might be referring to"><y>#</y><d>2020-04-30</d><h>14:16</h><w>gfredericks</w>So I have no idea what it might be referring to</z><z id="t1588256221" t="gfredericks That line just defs a number to be the negation of another"><y>#</y><d>2020-04-30</d><h>14:17</h><w>gfredericks</w>That line just defs a number to be the negation of another</z><z id="t1588256239" t="gfredericks I&apos;d ask in #cljs"><y>#</y><d>2020-04-30</d><h>14:17</h><w>gfredericks</w>I&apos;d ask in #cljs</z><z id="t1588256319" t="adamfrey the difference in line numbers might be because of cljc but this is the line that 999 points to in my target directory: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1193"><y>#</y><d>2020-04-30</d><h>14:18</h><w>adamfrey</w>the difference in line numbers might be because of <code>cljc</code> but this is the line that 999 points to in my <code>target</code> directory: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1193" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1193</a></z><z id="t1588256564" t="ghadi cljc causes different line numbers?"><y>#</y><d>2020-04-30</d><h>14:22</h><w>ghadi</w><code>cljc</code> causes different line numbers?</z><z id="t1588256593" t="gfredericks Yeah that&apos;s news to me"><y>#</y><d>2020-04-30</d><h>14:23</h><w>gfredericks</w>Yeah that&apos;s news to me</z><z id="t1588256611" t="ghadi it shouldn&apos;t, and whether it does is a verifiable assertion"><y>#</y><d>2020-04-30</d><h>14:23</h><w>ghadi</w>it shouldn&apos;t, and whether it does is a verifiable assertion</z><z id="t1588256650" t="ghadi (i know you qualified it with &quot;might&quot; [:attrs {:href &quot;/_/_/users/U06060CK0&quot;}] )"><y>#</y><d>2020-04-30</d><h>14:24</h><w>ghadi</w>(i know you qualified it with &quot;might&quot; <a>@adamfrey</a> )</z><z id="t1588256658" t="adamfrey yeah, sorry, I threw that out there as an guess"><y>#</y><d>2020-04-30</d><h>14:24</h><w>adamfrey</w>yeah, sorry, I threw that out there as an guess</z><z id="t1588256674" t="gfredericks Looking at the code it&apos;s pretty obvious via human analysis that the args can&apos;t be nil"><y>#</y><d>2020-04-30</d><h>14:24</h><w>gfredericks</w>Looking at the code it&apos;s pretty obvious via human analysis that the args can&apos;t be nil</z><z id="t1588256700" t="gfredericks If those cljs warnings have false positives, maybe they have a way to suppress them?"><y>#</y><d>2020-04-30</d><h>14:25</h><w>gfredericks</w>If those cljs warnings have false positives, maybe they have a way to suppress them?</z><z id="t1588256797" t="adamfrey Adding to the false positives likelihood I found a recent message of a similar vein: https://clojurians.slack.com/archives/C07UQ678E/p1587734805230700"><y>#</y><d>2020-04-30</d><h>14:26</h><w>adamfrey</w>Adding to the false positives likelihood I found a recent message of a similar vein: <a href="https://clojurians.slack.com/archives/C07UQ678E/p1587734805230700" target="_blank">https://clojurians.slack.com/archives/C07UQ678E/p1587734805230700</a></z><z id="t1588256814" t="gfredericks I don&apos;t know what cljs wants us to do 🙂"><y>#</y><d>2020-04-30</d><h>14:26</h><w>gfredericks</w>I don&apos;t know what cljs wants us to do <b>🙂</b></z><z id="t1588256817" t="adamfrey so maybe this is a #cljs-dev question rather than #test-check"><y>#</y><d>2020-04-30</d><h>14:26</h><w>adamfrey</w>so maybe this is a #cljs-dev question rather than #test-check</z><z id="t1588256821" t="gfredericks Yeah"><y>#</y><d>2020-04-30</d><h>14:27</h><w>gfredericks</w>Yeah</z><z id="t1588256825" t="gfredericks At least initially"><y>#</y><d>2020-04-30</d><h>14:27</h><w>gfredericks</w>At least initially</z><z id="t1588256849" t="adamfrey Thanks for your help, Gary and Ghadi."><y>#</y><d>2020-04-30</d><h>14:27</h><w>adamfrey</w>Thanks for your help, Gary and Ghadi.</z><z id="t1588257156" t="adamfrey the difference in line numbers looks like it&apos;s because I&apos;m not actually getting 1.0.0 , but an older version in my compilation output even though 1.0.0 is in my project.clj . I&apos;ll figure that part out. Sorry for the wild speculation, ha"><y>#</y><d>2020-04-30</d><h>14:32</h><w>adamfrey</w>the difference in line numbers looks like it&apos;s because I&apos;m not actually getting <code>1.0.0</code> , but an older version in my compilation output even though <code>1.0.0</code> is in my <code>project.clj</code> . I&apos;ll figure that part out. Sorry for the wild speculation, ha</z><z id="t1589201815" t="arohner What’s the best way to test properties on a collection? I typically write (prop/for-all [in generator] (let [ret (foo in)] (every? (fn [r] ...) ret)) , and this works, but the output on failure isn’t very nice, because test.check doesn’t know how to show the offending element"><y>#</y><d>2020-05-11</d><h>12:56</h><w>arohner</w>What’s the best way to test properties on a collection? I typically write
<pre>(prop/for-all [in generator] (let [ret (foo in)] (every? (fn [r] ...) ret))</pre>
, and this works, but the output on failure isn’t very nice, because test.check doesn’t know how to show the offending element</z><z id="t1589201879" t="arohner oh, one other wrinkle, the spec for each item is dynamic: (every? (fn [m] (s/valid? (s/spec (::p/message-type m)) m)) msgs)"><y>#</y><d>2020-05-11</d><h>12:57</h><w>arohner</w>oh, one other wrinkle, the spec for each item is dynamic:
<pre>(every? (fn [m]
              (s/valid? (s/spec (::p/message-type m)) m)) msgs)</pre></z><z id="t1589201914" t="arohner so I can’t easily use (s/valid? (s/coll-of ::foo) msgs)"><y>#</y><d>2020-05-11</d><h>12:58</h><w>arohner</w>so I can’t easily use <code>(s/valid? (s/coll-of ::foo) msgs)</code></z><z id="t1589202946" t="gfredericks &gt; test.check doesn’t know how to show the offending element this can be remedied by returning a custom Result object"><y>#</y><d>2020-05-11</d><h>13:15</h><w>gfredericks</w>&gt; test.check doesn’t know how to show the offending element

this can be remedied by returning a custom Result object</z><z id="t1589202974" t="gfredericks you could imagine a helper for this, a variant of every? , provided by a library or test.check itself"><y>#</y><d>2020-05-11</d><h>13:16</h><w>gfredericks</w>you could imagine a helper for this, a variant of <code>every?</code> , provided by a library or test.check itself</z><z id="t1589202984" t="gfredericks but the plumbing is there for getting better output"><y>#</y><d>2020-05-11</d><h>13:16</h><w>gfredericks</w>but the plumbing is there for getting better output</z><z id="t1593941112" t="Vincent Cantin (I was unable to post on Jira, so I report here) in the docstring of tuple: (def t (tuple gen/small-integer gen/boolean)) should be (def t (gen/tuple gen/small-integer gen/boolean)) "><y>#</y><d>2020-07-05</d><h>09:25</h><w>Vincent Cantin</w>(I was unable to post on Jira, so I report here) in the docstring of tuple:
<pre>(def t (tuple gen/small-integer gen/boolean))</pre>
should be
<pre>(def t (gen/tuple gen/small-integer gen/boolean))</pre>
</z><z id="t1593967074" t="gfredericks let&apos;s see if I still have commit rights"><y>#</y><d>2020-07-05</d><h>16:37</h><w>gfredericks</w>let&apos;s see if I still have commit rights</z><z id="t1593967163" t="gfredericks I do! it&apos;s fixed, thanks"><y>#</y><d>2020-07-05</d><h>16:39</h><w>gfredericks</w>I do! it&apos;s fixed, thanks</z><z id="t1593967606" t="Vincent Cantin Yesterday I struggled with test.check’s API, I had to use a lot of internal functions and did not see a way to do otherwise. Here is my function: (defn- decreasing-sizes-gen &quot;Returns a generator of lazy sequence of decreasing sizes.&quot; [max-size] (#&apos;gen/make-gen (fn [rng _] (let [f (fn f [rng max-size] (when-not (neg? max-size) (lazy-seq (let [[r1 r2] (random/split rng) size (#&apos;gen/rand-range r1 0 max-size)] (cons size (f r2 (dec size)))))))] (rose/pure (f rng max-size)))))) #_(gen/sample (decreasing-sizes-gen 100) 1) "><y>#</y><d>2020-07-05</d><h>16:46</h><w>Vincent Cantin</w>Yesterday I struggled with test.check’s API, I had to use a lot of internal functions and did not see a way to do otherwise.

Here is my function:
<pre>(defn- decreasing-sizes-gen
  &quot;Returns a generator of lazy sequence of decreasing sizes.&quot;
  [max-size]
  (#&apos;gen/make-gen
    (fn [rng _]
      (let [f (fn f [rng max-size]
                (when-not (neg? max-size)
                  (lazy-seq
                    (let [[r1 r2] (random/split rng)
                          size (#&apos;gen/rand-range r1 0 max-size)]
                      (cons size (f r2 (dec size)))))))]
        (rose/pure (f rng max-size))))))

#_(gen/sample (decreasing-sizes-gen 100) 1)</pre>
</z><z id="t1593967792" t="Vincent Cantin • I had to make my own #&apos;gen/make-gen because gen/randomized is not public, • gen/lazy-random-states is not public either, • I did not find an easy way to recursively iterate between using a generated value and using it to feed a new generator."><y>#</y><d>2020-07-05</d><h>16:49</h><w>Vincent Cantin</w>• I had to make my own <code>#&apos;gen/make-gen</code> because <code>gen/randomized</code> is not public,
• <code>gen/lazy-random-states</code> is not public either,
• I did not find an easy way to recursively iterate between using a generated value and using it to feed a new generator.</z><z id="t1593968287" t="Vincent Cantin I am under the impression that, since the public API cannot be complete for sure, make-gen and rng should be exposed to the users."><y>#</y><d>2020-07-05</d><h>16:58</h><w>Vincent Cantin</w>I am under the impression that, since the public API cannot be complete for sure, <code>make-gen</code> and <code>rng</code> should be exposed to the users.</z><z id="t1593968350" t="Vincent Cantin If one day I am writing a successor to test.check, I would build it based on that."><y>#</y><d>2020-07-05</d><h>16:59</h><w>Vincent Cantin</w>If one day I am writing a successor to test.check, I would build it based on that.</z><z id="t1593968501" t="gfredericks You can&apos;t do this with the sizing combinators?"><y>#</y><d>2020-07-05</d><h>17:01</h><w>gfredericks</w>You can&apos;t do this with the sizing combinators?</z><z id="t1593968537" t="Vincent Cantin which ones?"><y>#</y><d>2020-07-05</d><h>17:02</h><w>Vincent Cantin</w>which ones?</z><z id="t1593968554" t="gfredericks sized and with-size, I think"><y>#</y><d>2020-07-05</d><h>17:02</h><w>gfredericks</w>sized and with-size, I think</z><z id="t1593968577" t="gfredericks One to get the size, the other to set them"><y>#</y><d>2020-07-05</d><h>17:02</h><w>gfredericks</w>One to get the size, the other to set them</z><z id="t1593968669" t="Vincent Cantin then I would still need a way to build my lazy sequence"><y>#</y><d>2020-07-05</d><h>17:04</h><w>Vincent Cantin</w>then I would still need a way to build my lazy sequence</z><z id="t1593968736" t="gfredericks map with range"><y>#</y><d>2020-07-05</d><h>17:05</h><w>gfredericks</w>map with range</z><z id="t1593968741" t="gfredericks And tuple"><y>#</y><d>2020-07-05</d><h>17:05</h><w>gfredericks</w>And tuple</z><z id="t1593968796" t="gfredericks It won&apos;t be lazy; is that important?"><y>#</y><d>2020-07-05</d><h>17:06</h><w>gfredericks</w>It won&apos;t be lazy; is that important?</z><z id="t1593968857" t="Vincent Cantin in my case, I could live without, but in the general case, lazy sequence is something with zero support in test.check"><y>#</y><d>2020-07-05</d><h>17:07</h><w>Vincent Cantin</w>in my case, I could live without, but in the general case, lazy sequence is something with zero support in test.check</z><z id="t1593968899" t="Vincent Cantin I will keep my function as is, but I wanted to report the limitations I found."><y>#</y><d>2020-07-05</d><h>17:08</h><w>Vincent Cantin</w>I will keep my function as is, but I wanted to report the limitations I found.</z><z id="t1593969035" t="gfredericks Yes. Should be easier to add laziness now that the rng is immutable"><y>#</y><d>2020-07-05</d><h>17:10</h><w>gfredericks</w>Yes. Should be easier to add laziness now that the rng is immutable</z><z id="t1594403049" t="Alex Miller (Clojure team) Released test.check 1.1.0, with https://clojure.atlassian.net/browse/TCHECK-155 (don&apos;t generate :/)"><y>#</y><d>2020-07-10</d><h>17:44</h><w>Alex Miller (Clojure team)</w>Released test.check 1.1.0, with <a href="https://clojure.atlassian.net/browse/TCHECK-155" target="_blank">https://clojure.atlassian.net/browse/TCHECK-155</a> (don&apos;t generate :/)</z><z id="t1594408655" t="gfredericks It also doesn&apos;t generate :-) or :-( or :&apos;( but I suspect it can generate :-P"><y>#</y><d>2020-07-10</d><h>19:17</h><w>gfredericks</w>It also doesn&apos;t generate :-) or :-( or :&apos;( but I suspect it can generate :-P</z><z id="t1594408669" t="gfredericks And :-D"><y>#</y><d>2020-07-10</d><h>19:17</h><w>gfredericks</w>And :-D</z><z id="t1594463507" t="sogaiu i am confused by this line of documentation: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L90 &gt; Takes a list of roses, not a rose Is it possible what was meant was actually: &gt; Takes a rose, not a list of roses as the functions that follow (i.e. permutations , zip , remove , etc.) all seem to take a list of roses, but filter does not?"><y>#</y><d>2020-07-11</d><h>10:31</h><w>sogaiu</w>i am confused by this line of documentation: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L90" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L90</a>

&gt; Takes a list of roses, not a rose
Is it possible what was meant was actually:

&gt; Takes a rose, not a list of roses
as the functions that follow (i.e. <code>permutations</code>, <code>zip</code>, <code>remove</code>, etc.) all seem to take a list of roses, but <code>filter</code> does not?</z><z id="t1594470665" t="gfredericks yep, that sounds wrong"><y>#</y><d>2020-07-11</d><h>12:31</h><w>gfredericks</w>yep, that sounds wrong</z><z id="t1594470679" t="gfredericks I pushed a commit that deletes that sentence."><y>#</y><d>2020-07-11</d><h>12:31</h><w>gfredericks</w>I pushed a commit that deletes that sentence.</z><z id="t1594470686" t="gfredericks according to git history, it was always wrong"><y>#</y><d>2020-07-11</d><h>12:31</h><w>gfredericks</w>according to git history, it was always wrong</z><z id="t1594471969" t="sogaiu [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] thanks! (i didn&apos;t chase down the full history, but i also found that as far back as a i looked the sentence was the same.)"><y>#</y><d>2020-07-11</d><h>12:52</h><w>sogaiu</w><a>@gfredericks</a> thanks!  (i didn&apos;t chase down the full history, but i also found that as far back as a i looked the sentence was the same.)</z><z id="t1594472091" t="gfredericks git log -S &quot;a list of roses&quot; is a good trick for finding where it came from"><y>#</y><d>2020-07-11</d><h>12:54</h><w>gfredericks</w><code>git log -S &quot;a list of roses&quot;</code> is a good trick for finding where it came from</z><z id="t1594548601" t="Vincent Cantin I think that the source code would have been easier to read if the rose tree was named after its purpose, for example shrink-tree"><y>#</y><d>2020-07-12</d><h>10:10</h><w>Vincent Cantin</w>I think that the source code would have been easier to read if the rose tree was named after its purpose, for example <code>shrink-tree</code></z><z id="t1594549168" t="sogaiu fwiw, quickcheck in haskell seems to use the term &quot;rose&quot; as well: https://hackage.haskell.org/package/QuickCheck-2.9/docs/Test-QuickCheck-Property.html#g:4 - i was initially puzzled but found a wikipedia page: https://en.m.wikipedia.org/wiki/Rose_tree"><y>#</y><d>2020-07-12</d><h>10:19</h><w>sogaiu</w>fwiw, quickcheck in haskell seems to use the term &quot;rose&quot; as well: <a href="https://hackage.haskell.org/package/QuickCheck-2.9/docs/Test-QuickCheck-Property.html#g:4" target="_blank">https://hackage.haskell.org/package/QuickCheck-2.9/docs/Test-QuickCheck-Property.html#g:4</a> - i was initially puzzled but found a wikipedia page: <a href="https://en.m.wikipedia.org/wiki/Rose_tree" target="_blank">https://en.m.wikipedia.org/wiki/Rose_tree</a></z><z id="t1594549202" t="sogaiu also the docs of the corr ns say: https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L11"><y>#</y><d>2020-07-12</d><h>10:20</h><w>sogaiu</w>also the docs of the corr ns say: <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L11" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/rose_tree.cljc#L11</a></z><z id="t1594549422" t="sogaiu in this case i was initially lost but the name actually helped me to find relevant related info"><y>#</y><d>2020-07-12</d><h>10:23</h><w>sogaiu</w>in this case i was initially lost but the name actually helped me to find relevant related info</z><z id="t1594556975" t="gfredericks yeah the initial draft of test.check was heavily based on quickcheck"><y>#</y><d>2020-07-12</d><h>12:29</h><w>gfredericks</w>yeah the initial draft of test.check was heavily based on quickcheck</z><z id="t1594852704" t="sogaiu i was fortunate to find: https://www.youtube.com/watch?v=u0t-6lUvXHo -- it&apos;s been helping me to understand some of test.check&apos;s internals better. i don&apos;t see this linked to from test.check&apos;s repository. if it isn&apos;t there somewhere, perhaps it would be worth mentioning it?"><y>#</y><d>2020-07-15</d><h>22:38</h><w>sogaiu</w>i was fortunate to find: <a href="https://www.youtube.com/watch?v=u0t-6lUvXHo" target="_blank">https://www.youtube.com/watch?v=u0t-6lUvXHo</a> -- it&apos;s been helping me to understand some of test.check&apos;s internals better.

i don&apos;t see this linked to from test.check&apos;s repository.  if it isn&apos;t there somewhere, perhaps it would be worth mentioning it?</z><z id="t1594853268" t="Alex Miller (Clojure team) definitely!"><y>#</y><d>2020-07-15</d><h>22:47</h><w>Alex Miller (Clojure team)</w>definitely!</z><z id="t1594853383" t="Alex Miller (Clojure team) https://github.com/clojure/test.check/commit/7e7c2116fa721211e8f5642a249e4a0f327445f4"><y>#</y><d>2020-07-15</d><h>22:49</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/clojure/test.check/commit/7e7c2116fa721211e8f5642a249e4a0f327445f4" target="_blank">https://github.com/clojure/test.check/commit/7e7c2116fa721211e8f5642a249e4a0f327445f4</a></z><z id="t1595231101" t="plexus WARNING: Use of undeclared Var goog.math.Long/fromBits at line 64 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs WARNING: Use of undeclared Var goog.math.Long/fromString at line 77 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs WARNING: Use of undeclared Var goog.math.Long/fromNumber at line 81 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs WARNING: Use of undeclared Var goog.math.Long/fromNumber at line 87 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs WARNING: Use of undeclared Var goog.math.Long/getOne at line 92 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs WARNING: cljs.core/&lt;=, all arguments must be numbers, got [#{nil js/Number} number] instead at line 1193 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/generators.cljc I&apos;m seeing these warnings when using test.check from ClojureScript. Not sure what&apos;s causing them, can&apos;t immediately see fault with the code."><y>#</y><d>2020-07-20</d><h>07:45</h><w>plexus</w><pre>WARNING: Use of undeclared Var goog.math.Long/fromBits at line 64 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs
WARNING: Use of undeclared Var goog.math.Long/fromString at line 77 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs                                                                                                                                    
WARNING: Use of undeclared Var goog.math.Long/fromNumber at line 81 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs                                                                                                                                    
WARNING: Use of undeclared Var goog.math.Long/fromNumber at line 87 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs
WARNING: Use of undeclared Var goog.math.Long/getOne at line 92 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/random/longs.cljs
WARNING: cljs.core/&lt;=, all arguments must be numbers, got [#{nil js/Number} number] instead at line 1193 file:/home/arne/.m2/repository/org/clojure/test.check/1.1.0/test.check-1.1.0.jar!/clojure/test/check/generators.cljc</pre>
I&apos;m seeing these warnings when using test.check from ClojureScript. Not sure what&apos;s causing them, can&apos;t immediately see fault with the code.</z><z id="t1595231133" t="plexus did some googling but only found this, which does seem to show at least one other person ran into this 🙂 https://github.com/AdamFrey/cljs-test-check-warning-example"><y>#</y><d>2020-07-20</d><h>07:45</h><w>plexus</w>did some googling but only found this, which does seem to show at least one other person ran into this <b>🙂</b> <a href="https://github.com/AdamFrey/cljs-test-check-warning-example" target="_blank">https://github.com/AdamFrey/cljs-test-check-warning-example</a></z><z id="t1595252364" t="Filipe Silva heya all"><y>#</y><d>2020-07-20</d><h>13:39</h><w>Filipe Silva</w>heya all</z><z id="t1595252427" t="Filipe Silva how are people using test.check with async code?"><y>#</y><d>2020-07-20</d><h>13:40</h><w>Filipe Silva</w>how are people using test.check with async code?</z><z id="t1595252517" t="Filipe Silva is there any pretty obvious way to do it?"><y>#</y><d>2020-07-20</d><h>13:41</h><w>Filipe Silva</w>is there any pretty obvious way to do it?</z><z id="t1595252548" t="Filipe Silva I saw [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] POC on https://github.com/clojure/test.check/commit/f90ee794dbe4dc766d91f9daa2160e8a8b0853be"><y>#</y><d>2020-07-20</d><h>13:42</h><w>Filipe Silva</w>I saw <a>@gfredericks</a> POC on <a href="https://github.com/clojure/test.check/commit/f90ee794dbe4dc766d91f9daa2160e8a8b0853be" target="_blank">https://github.com/clojure/test.check/commit/f90ee794dbe4dc766d91f9daa2160e8a8b0853be</a></z><z id="t1595252580" t="gfredericks Huh. Does that work? I don&apos;t remember it 🙃"><y>#</y><d>2020-07-20</d><h>13:43</h><w>gfredericks</w>Huh. Does that work? I don&apos;t remember it <b>🙃</b></z><z id="t1595252590" t="gfredericks In any case there&apos;s nothing more official than that"><y>#</y><d>2020-07-20</d><h>13:43</h><w>gfredericks</w>In any case there&apos;s nothing more official than that</z><z id="t1595252634" t="Filipe Silva ok, now I know"><y>#</y><d>2020-07-20</d><h>13:43</h><w>Filipe Silva</w>ok, now I know</z><z id="t1595252659" t="Filipe Silva I was asking because [:attrs {:href &quot;/_/_/users/U066U8JQJ&quot;}] actually did something similar to what you did, but with core.async channels"><y>#</y><d>2020-07-20</d><h>13:44</h><w>Filipe Silva</w>I was asking because <a>@wilkerlucio</a> actually did something similar to what you did, but with core.async channels</z><z id="t1595252660" t="Filipe Silva https://github.com/clojure/test.check/compare/master...wilkerlucio:async-check"><y>#</y><d>2020-07-20</d><h>13:44</h><w>Filipe Silva</w><a href="https://github.com/clojure/test.check/compare/master...wilkerlucio:async-check" target="_blank">https://github.com/clojure/test.check/compare/master...wilkerlucio:async-check</a></z><z id="t1595252714" t="Filipe Silva wilker and I were using it for test at http://roamresearch.com but now needed to extract it away from the official test.check"><y>#</y><d>2020-07-20</d><h>13:45</h><w>Filipe Silva</w>wilker and I were using it for test at <a href="http://roamresearch.com" target="_blank">http://roamresearch.com</a> but now needed to extract it away from the official test.check</z><z id="t1595252733" t="Filipe Silva so I was wondering if there was something around already that we should be using"><y>#</y><d>2020-07-20</d><h>13:45</h><w>Filipe Silva</w>so I was wondering if there was something around already that we should be using</z><z id="t1595252842" t="gfredericks It&apos;s possible there are other libraries. But I&apos;d say this is the most severe hole in test.check at the moment. That POC could be usable if the cljs.test details are worked out, and if it doesn&apos;t hurt perf for synchronous jvm use"><y>#</y><d>2020-07-20</d><h>13:47</h><w>gfredericks</w>It&apos;s possible there are other libraries. 

But I&apos;d say this is the most severe hole in test.check at the moment. That POC could be usable if the cljs.test details are worked out, and if it doesn&apos;t hurt perf for synchronous jvm use</z><z id="t1595252932" t="Filipe Silva what are the cljs.test details?"><y>#</y><d>2020-07-20</d><h>13:48</h><w>Filipe Silva</w>what are the cljs.test details?</z><z id="t1595253150" t="gfredericks just &quot;how should this be used from cljs.test?&quot;; ideally it&apos;d be similar or same as on the jvm e.g., can defspec work?"><y>#</y><d>2020-07-20</d><h>13:52</h><w>gfredericks</w>just &quot;how should this be used from cljs.test?&quot;; ideally it&apos;d be similar or same as on the jvm

e.g., can defspec work?</z><z id="t1595253201" t="Filipe Silva hm I see..."><y>#</y><d>2020-07-20</d><h>13:53</h><w>Filipe Silva</w>hm I see...</z><z id="t1595253217" t="Filipe Silva I was kinda focused on cljs so that didn&apos;t really come to mind"><y>#</y><d>2020-07-20</d><h>13:53</h><w>Filipe Silva</w>I was kinda focused on cljs so that didn&apos;t really come to mind</z><z id="t1595253236" t="Filipe Silva there I&apos;d just use an async deftest"><y>#</y><d>2020-07-20</d><h>13:53</h><w>Filipe Silva</w>there I&apos;d just use an async deftest</z><z id="t1595253376" t="gfredericks It might be easy. I just didn&apos;t know much about cljs testing when I made that commit"><y>#</y><d>2020-07-20</d><h>13:56</h><w>gfredericks</w>It might be easy. I just didn&apos;t know much about cljs testing when I made that commit</z><z id="t1595253397" t="Filipe Silva ok, will think about it some"><y>#</y><d>2020-07-20</d><h>13:56</h><w>Filipe Silva</w>ok, will think about it some</z><z id="t1595253403" t="Filipe Silva thank you for the insight on this"><y>#</y><d>2020-07-20</d><h>13:56</h><w>Filipe Silva</w>thank you for the insight on this</z><z id="t1596579953" t="kenny Is there a facility for writing a generator that generates the next value based on the previous? e.g., similar to iterate"><y>#</y><d>2020-08-04</d><h>22:25</h><w>kenny</w>Is there a facility for writing a generator that generates the next value based on the previous? e.g., similar to <code>iterate</code></z><z id="t1596580077" t="gfredericks Generators aren&apos;t meant to be aware of previously generated values. If this is part of a larger structure, you could describe that and there might be another way"><y>#</y><d>2020-08-04</d><h>22:27</h><w>gfredericks</w>Generators aren&apos;t meant to be aware of previously generated values. 

If this is part of a larger structure, you could describe that and there might be another way</z><z id="t1596580224" t="kenny The objective is to generate a seq of dates increasing over time separated by a bounded, random amount of time."><y>#</y><d>2020-08-04</d><h>22:30</h><w>kenny</w>The objective is to generate a seq of dates increasing over time separated by a bounded, random amount of time.</z><z id="t1596580257" t="kenny Trying to generate data that imitates what actual data will look like."><y>#</y><d>2020-08-04</d><h>22:30</h><w>kenny</w>Trying to generate data that imitates what actual data will look like.</z><z id="t1596580314" t="gfredericks Generate the start date and the increments, and then fmap the result to get what you&apos;re describing"><y>#</y><d>2020-08-04</d><h>22:31</h><w>gfredericks</w>Generate the start date and the increments, and then fmap the result to get what you&apos;re describing</z><z id="t1598527956" t="sogaiu i came across this: https://github.com/renatahodovan/grammarinator and started wondering if it is possible to take an antlr grammar of something and generate things based on it for use with test.check."><y>#</y><d>2020-08-27</d><h>11:32</h><w>sogaiu</w>i came across this: <a href="https://github.com/renatahodovan/grammarinator" target="_blank">https://github.com/renatahodovan/grammarinator</a> and started wondering if it is possible to take an antlr grammar of something and generate things based on it for use with test.check.</z><z id="t1598543825" t="gfredericks Should totally be possible. test.chuck&apos;s regex generator is similar"><y>#</y><d>2020-08-27</d><h>15:57</h><r>gfredericks</r>Should totally be possible. 

test.chuck&apos;s regex generator is similar</z><z id="t1598565328" t="sogaiu thanks! i was thinking about ashnur&apos;s email address problem being discussed on another channel and i noticed there is an antlr grammar for rfc822 email addresses: https://github.com/antlr/grammars-v4/tree/master/rfc822/rfc822-emailaddress"><y>#</y><d>2020-08-27</d><h>21:55</h><r>sogaiu</r>thanks!

i was thinking about ashnur&apos;s email address problem being discussed on another channel  and i noticed there is an antlr grammar for rfc822 email addresses: <a href="https://github.com/antlr/grammars-v4/tree/master/rfc822/rfc822-emailaddress" target="_blank">https://github.com/antlr/grammars-v4/tree/master/rfc822/rfc822-emailaddress</a></z><z id="t1598880667" t="sogaiu test.chuck&apos;s regex generator is quite neat! i also found instacheck and instagenerator. ha ha -- so late to the party 🙂"><y>#</y><d>2020-08-31</d><h>13:31</h><r>sogaiu</r>test.chuck&apos;s regex generator is quite neat!

i also found instacheck and instagenerator.

ha ha -- so late to the party <b>🙂</b></z><z id="t1598880897" t="gfredericks I hadn&apos;t heard of either of those"><y>#</y><d>2020-08-31</d><h>13:34</h><r>gfredericks</r>I hadn&apos;t heard of either of those</z><z id="t1598882178" t="sogaiu may be you have found them already, but fwiw: * https://github.com/Engelberg/instaparse/issues/82#issuecomment-57892866 * https://github.com/Engelberg/instaparse/issues/82#issuecomment-426022741"><y>#</y><d>2020-08-31</d><h>13:56</h><r>sogaiu</r>may be you have found them already, but fwiw:

* <a href="https://github.com/Engelberg/instaparse/issues/82#issuecomment-57892866" target="_blank">https://github.com/Engelberg/instaparse/issues/82#issuecomment-57892866</a>
* <a href="https://github.com/Engelberg/instaparse/issues/82#issuecomment-426022741" target="_blank">https://github.com/Engelberg/instaparse/issues/82#issuecomment-426022741</a></z><z id="t1598883437" t="gfredericks Cool. Apparently I must have seen the second one and forgot about it, since it mentions me"><y>#</y><d>2020-08-31</d><h>14:17</h><r>gfredericks</r>Cool. Apparently I must have seen the second one and forgot about it, since it mentions me</z><z id="t1598543723" t="arohner Before I embark on this journey, has anyone written a thing that combines prop/for-all and gen/let ?"><y>#</y><d>2020-08-27</d><h>15:55</h><w>arohner</w>Before I embark on this journey, has anyone written a thing that combines <code>prop/for-all</code> and <code>gen/let</code>?</z><z id="t1598543859" t="gfredericks Does test.chuck have something like that? I think so"><y>#</y><d>2020-08-27</d><h>15:57</h><r>gfredericks</r>Does test.chuck have something like that? I think so</z><z id="t1598543927" t="arohner Yeah, looks like test.chuck.gen/for is what I want, thanks"><y>#</y><d>2020-08-27</d><h>15:58</h><r>arohner</r>Yeah, looks like <code>test.chuck.gen/for</code> is what I want, thanks</z><z id="t1598544050" t="arohner Hrm, though I can’t stick it in the prop/for-all , which is what I wanted to solve: (prop/for-all [[a b c] (gen/let [a gen-a b gen-b c gen-c] [a b c] (do-test))"><y>#</y><d>2020-08-27</d><h>16:00</h><w>arohner</w>Hrm, though I can’t stick it in the <code>prop/for-all</code>, which is what I wanted to solve:

<pre>(prop/for-all [[a b c] (gen/let [a gen-a b gen-b c gen-c] [a b c] (do-test))</pre></z><z id="t1598544062" t="arohner I’m trying to avoid ^^ that boilerplate"><y>#</y><d>2020-08-27</d><h>16:01</h><w>arohner</w>I’m trying to avoid ^^ that boilerplate</z><z id="t1598544079" t="gfredericks Lemme see"><y>#</y><d>2020-08-27</d><h>16:01</h><w>gfredericks</w>Lemme see</z><z id="t1598544099" t="arohner oh, prop&apos;/for-all , I just have to keep reading"><y>#</y><d>2020-08-27</d><h>16:01</h><w>arohner</w>oh, <code>prop&apos;/for-all</code>, I just have to keep reading</z><z id="t1598544150" t="gfredericks Yep 🙂"><y>#</y><d>2020-08-27</d><h>16:02</h><w>gfredericks</w>Yep <b>🙂</b></z><z id="t1598787668" t="borkdude I hit a issue in test.check where a global object in clojure.test.check.random is initialized at compile time in GraalVM, so everytime you invoke the binary, you get the same random number. Strangely enough, I can&apos;t reproduce this with AOT-ing and running on the JVM"><y>#</y><d>2020-08-30</d><h>11:41</h><w>borkdude</w>I hit a issue in test.check where a global object in clojure.test.check.random is initialized at compile time in GraalVM, so everytime you invoke the binary, you get the same random number.
Strangely enough, I can&apos;t reproduce this with AOT-ing and running on the JVM</z><z id="t1598787692" t="borkdude I&apos;ve discussed this problem in #graalvm as well and posted a workaround for it"><y>#</y><d>2020-08-30</d><h>11:41</h><w>borkdude</w>I&apos;ve discussed this problem in #graalvm as well and posted a workaround for it</z><z id="t1598790297" t="borkdude I summarized the issue in this gist: https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a"><y>#</y><d>2020-08-30</d><h>12:24</h><w>borkdude</w>I summarized the issue in this gist: <a href="https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a" target="_blank">https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a</a></z><z id="t1598836723" t="gfredericks AOT wouldn&apos;t reproduce it because AOT doesn&apos;t run code at compile time"><y>#</y><d>2020-08-31</d><h>01:18</h><w>gfredericks</w>AOT wouldn&apos;t reproduce it because AOT doesn&apos;t run code at compile time</z><z id="t1598836733" t="gfredericks I mean maybe it runs it but it only compiles the code, not the result"><y>#</y><d>2020-08-31</d><h>01:18</h><w>gfredericks</w>I mean maybe it runs it but it only compiles the code, not the result</z><z id="t1598836773" t="gfredericks a fix would be something that lazy-initializes the global rng the first time you use it, I guess?"><y>#</y><d>2020-08-31</d><h>01:19</h><w>gfredericks</w>a fix would be something that lazy-initializes the global rng the first time you use it, I guess?</z><z id="t1598836823" t="gfredericks I don&apos;t think that&apos;s in a perf-sensitive codepath so I don&apos;t think there are any downsides"><y>#</y><d>2020-08-31</d><h>01:20</h><w>gfredericks</w>I don&apos;t think that&apos;s in a perf-sensitive codepath so I don&apos;t think there are any downsides</z><z id="t1598836860" t="gfredericks sounds like a legitimate jira ticket"><y>#</y><d>2020-08-31</d><h>01:21</h><w>gfredericks</w>sounds like a legitimate jira ticket</z><z id="t1598899486" t="Mitch Are there resources available for testing async code in cljs via test.check ? I see that there is an open ticket in jira for support, just wondering if there are any known workarounds that might allow me to still use defspec"><y>#</y><d>2020-08-31</d><h>18:44</h><w>Mitch</w>Are there resources available for testing async code in cljs via <code>test.check</code>? I see that there is an open ticket in jira for support, just wondering if there are any known workarounds that might allow me to still use <code>defspec</code></z><z id="t1598900112" t="gfredericks Does the ticket reference a branch with a proof-of-concept?"><y>#</y><d>2020-08-31</d><h>18:55</h><w>gfredericks</w>Does the ticket reference a branch with a proof-of-concept?</z><z id="t1598902529" t="Mitch I don&apos;t think the ticket references it, but I have seen that branch. Haven&apos;t tried the branch out yet, though. I can give it a roll and share how it works for our use case if you think that would be helpful"><y>#</y><d>2020-08-31</d><h>19:35</h><w>Mitch</w>I don&apos;t think the ticket references it, but I have seen that branch. Haven&apos;t tried the branch out yet, though. I can give it a roll and share how it works for our use case if you think that would be helpful</z><z id="t1598902668" t="gfredericks I was suggesting a &quot;workaround&quot; would be to just use that branch, if it works. Depends on your definition of workaround. I&apos;m not sure there are any other options short of somebody completing integrating that feature. Coverting to async is a pretty fundamental change."><y>#</y><d>2020-08-31</d><h>19:37</h><w>gfredericks</w>I was suggesting a &quot;workaround&quot; would be to just use that branch, if it works. 

Depends on your definition of workaround. 

I&apos;m not sure there are any other options short of somebody completing integrating that feature. Coverting to async is a pretty fundamental change.</z><z id="t1598902974" t="Mitch Cool, thanks for helping me out. I really appreciate it. I&apos;ll see how that goes. I&apos;m a little surprised that this seems to be a rare scenario 🤷"><y>#</y><d>2020-08-31</d><h>19:42</h><w>Mitch</w>Cool, thanks for helping me out. I really appreciate it. I&apos;ll see how that goes. I&apos;m a little surprised that this seems to be a rare scenario <b>🤷</b></z><z id="t1598903157" t="gfredericks I, also, am surprised"><y>#</y><d>2020-08-31</d><h>19:45</h><w>gfredericks</w>I, also, am surprised</z><z id="t1598903302" t="gfredericks I haven&apos;t done much professional clojure web dev; maybe people tend to use frameworks where the user code is just functions on data, and so those user functions are amenable to synchronous testing?"><y>#</y><d>2020-08-31</d><h>19:48</h><w>gfredericks</w>I haven&apos;t done much professional clojure web dev; maybe people tend to use frameworks where the user code is just functions on data, and so those user functions are amenable to synchronous testing?</z><z id="t1598903914" t="Mitch Yeah, I think that is a big part of it. Most of the time there is already a well-supported React component for whatever library you want to integrate, so you do not need to worry about testing its behavior"><y>#</y><d>2020-08-31</d><h>19:58</h><w>Mitch</w>Yeah, I think that is a big part of it. Most of the time there is already a well-supported React component for whatever library you want to integrate, so you do not need to worry about testing its behavior</z><z id="t1598910591" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] &gt; a fix would be something that lazy-initializes the global rng the first time you use it, I guess? https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a#workaround I&apos;ll make a JIRA ticket tomorrow"><y>#</y><d>2020-08-31</d><h>21:49</h><w>borkdude</w><a>@gfredericks</a>
&gt; a fix would be something that lazy-initializes the global rng the first time you use it, I guess?
<a href="https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a#workaround" target="_blank">https://gist.github.com/borkdude/768eb5d01085944190e5eb485fd4737a#workaround</a>
I&apos;ll make a JIRA ticket tomorrow</z><z id="t1598970567" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] done: https://clojure.atlassian.net/browse/TCHECK-157 (includes patch)"><y>#</y><d>2020-09-01</d><h>14:29</h><w>borkdude</w><a>@gfredericks</a> done: <a href="https://clojure.atlassian.net/browse/TCHECK-157" target="_blank">https://clojure.atlassian.net/browse/TCHECK-157</a> (includes patch)</z><z id="t1598971770" t="gfredericks LGTM I can&apos;t open jira on my computer for some reason, so can&apos;t comment on it"><y>#</y><d>2020-09-01</d><h>14:49</h><r>gfredericks</r>LGTM

I can&apos;t open jira on my computer for some reason, so can&apos;t comment on it</z><z id="t1601225395" t="colinkahn Is it possible to make a vector generator that always generates X number of items but can shrink down to only 1 of those items?"><y>#</y><d>2020-09-27</d><h>16:49</h><w>colinkahn</w>Is it possible to make a vector generator that always generates X number of items but can shrink down to only 1 of those items?</z><z id="t1601225440" t="gfredericks What&apos;s the use case?"><y>#</y><d>2020-09-27</d><h>16:50</h><w>gfredericks</w>What&apos;s the use case?</z><z id="t1601225537" t="colinkahn I have a test that has some expensive setup and I want to run the max items through it (each item of the vector) but still want to be able to get it to shrink to a single item if it fails"><y>#</y><d>2020-09-27</d><h>16:52</h><w>colinkahn</w>I have a test that has some expensive setup and I want to run the max items through it (each item of the vector) but still want to be able to get it to shrink to a single item if it fails</z><z id="t1601225637" t="gfredericks you can get approximately this behavior by modifying the size parameter that won&apos;t specifically guarantee large vectors, but it does express the idea of &quot;I want to generate big inputs for whatever reason&quot;"><y>#</y><d>2020-09-27</d><h>16:53</h><w>gfredericks</w>you can get approximately this behavior by modifying the <code>size</code> parameter

that won&apos;t specifically guarantee large vectors, but it does express the idea of &quot;I want to generate big inputs for whatever reason&quot;</z><z id="t1601225683" t="colinkahn But will that affect the size of other gens or can I modify per-gen?"><y>#</y><d>2020-09-27</d><h>16:54</h><w>colinkahn</w>But will that affect the size of other gens or can I modify per-gen?</z><z id="t1601225845" t="gfredericks ummmmmmhm let&apos;s see something like (defn gen-vector-with-shallow-min-size [min-size element-gen &amp; other-args] (gen/sized (fn [size] (gen/scale #(min min-size %) (apply gen/vector (gen/resize size element-gen) other-args)))))"><y>#</y><d>2020-09-27</d><h>16:57</h><w>gfredericks</w>ummmmmmhm

let&apos;s see

something like

<pre>(defn gen-vector-with-shallow-min-size
  [min-size element-gen &amp; other-args]
  (gen/sized (fn [size] (gen/scale #(min min-size %) (apply gen/vector (gen/resize size element-gen) other-args)))))</pre></z><z id="t1601225862" t="gfredericks kind of hairy, but I believe that&apos;s what you&apos;re describing"><y>#</y><d>2020-09-27</d><h>16:57</h><w>gfredericks</w>kind of hairy, but I believe that&apos;s what you&apos;re describing</z><z id="t1601225880" t="gfredericks again, doesn&apos;t guarantee any minimum number of elements, but it will skew the distribution larger"><y>#</y><d>2020-09-27</d><h>16:58</h><w>gfredericks</w>again, doesn&apos;t guarantee any minimum number of elements, but it will skew the distribution larger</z><z id="t1601225917" t="gfredericks (which is intentional -- it&apos;s nice to still test empty/small vectors occasionally just in case)"><y>#</y><d>2020-09-27</d><h>16:58</h><w>gfredericks</w>(which is intentional -- it&apos;s nice to still test empty/small vectors occasionally just in case)</z><z id="t1601225955" t="colinkahn Nice! Thanks! I’ll give it a shot!"><y>#</y><d>2020-09-27</d><h>16:59</h><w>colinkahn</w>Nice! Thanks! I’ll give it a shot!</z><z id="t1601296272" t="Saikyun is it possible to write a meaningful &quot;not&quot;-generator? in my case I have a bunch of specs and I use clojure.spec.gen.alpha/generate for automatic testing. it just struck me that it might sense for some falsifying tests, i.e. checking that my code actually throws exceptions on invalid data"><y>#</y><d>2020-09-28</d><h>12:31</h><w>Saikyun</w>is it possible to write a meaningful &quot;not&quot;-generator? in my case I have a bunch of specs and I use <code>clojure.spec.gen.alpha/generate</code> for automatic testing. it just struck me that it might sense for some falsifying tests, i.e. checking that my code actually throws exceptions on invalid data</z><z id="t1601297481" t="gfredericks if you have a spec you could do something like (gen/such-that (complement passes-the-spec?) gen/any)"><y>#</y><d>2020-09-28</d><h>12:51</h><w>gfredericks</w>if you have a spec you could do something like

<code>(gen/such-that (complement passes-the-spec?) gen/any)</code></z><z id="t1601297503" t="gfredericks kind of sloppy/stupid but also it&apos;s one line"><y>#</y><d>2020-09-28</d><h>12:51</h><w>gfredericks</w>kind of sloppy/stupid but also it&apos;s one line</z><z id="t1601313188" t="Saikyun haha, interesting. could be nice to just throw at the program to see what happens 🙂"><y>#</y><d>2020-09-28</d><h>17:13</h><w>Saikyun</w>haha, interesting. could be nice to just throw at the program to see what happens <b>🙂</b></z><z id="t1601313216" t="Saikyun I just started thinking that it might be too naive to only test for &quot;valid&quot; data (it&apos;s an input form)"><y>#</y><d>2020-09-28</d><h>17:13</h><w>Saikyun</w>I just started thinking that it might be too naive to only test for &quot;valid&quot; data (it&apos;s an input form)</z><z id="t1601313312" t="gfredericks Yeah that&apos;s a tough use case I think. There&apos;s a variety of options with different tradeoffs, and no holistic silver bullet thing"><y>#</y><d>2020-09-28</d><h>17:15</h><w>gfredericks</w>Yeah that&apos;s a tough use case I think.

There&apos;s a variety of options with different tradeoffs, and no holistic silver bullet thing</z><z id="t1601313353" t="Saikyun makes sense. I guess I could try generating random strings and just filter away the ones that are actually valid"><y>#</y><d>2020-09-28</d><h>17:15</h><w>Saikyun</w>makes sense. I guess I could try generating random strings and just filter away the ones that are actually valid</z><z id="t1601313357" t="gfredericks Two things are Just use examples Generate valid things and then tweak them in specific ways"><y>#</y><d>2020-09-28</d><h>17:15</h><w>gfredericks</w>Two things are

Just use examples
Generate valid things and then tweak them in specific ways</z><z id="t1601313367" t="Saikyun right"><y>#</y><d>2020-09-28</d><h>17:16</h><w>Saikyun</w>right</z><z id="t1601313389" t="Saikyun thanks for the input, will think a bit about it 🙂"><y>#</y><d>2020-09-28</d><h>17:16</h><w>Saikyun</w>thanks for the input, will think a bit about it <b>🙂</b></z><z id="t1601313453" t="Saikyun I&apos;m very happy because today I managed to create automatic gui / end-to-end testing by using cljs + spec generators 🙂"><y>#</y><d>2020-09-28</d><h>17:17</h><w>Saikyun</w>I&apos;m very happy because today I managed to create automatic gui / end-to-end testing by using cljs + spec generators <b>🙂</b></z><z id="t1601313475" t="Saikyun it looks very cool to have everything filled out for me. will be a nice demo to show when talking about clojure with my colleagues"><y>#</y><d>2020-09-28</d><h>17:17</h><w>Saikyun</w>it looks very cool to have everything filled out for me. will be a nice demo to show when talking about clojure with my colleagues</z><z id="t1601313527" t="gfredericks Nice"><y>#</y><d>2020-09-28</d><h>17:18</h><w>gfredericks</w>Nice</z><z id="t1601313800" t="andy.fingerhut As a maybe-already-obvious example, generating strings of 10 characters where each character is uniformly chosen from the set of all Unicode code points, and then filtering only the ones that contain only ASCII characters, is extremely unlikely to get past the ASCII filter."><y>#</y><d>2020-09-28</d><h>17:23</h><w>andy.fingerhut</w>As a maybe-already-obvious example, generating strings of 10 characters where each character is uniformly chosen from the set of all Unicode code points, and then filtering only the ones that contain only ASCII characters, is extremely unlikely to get past the ASCII filter.</z><z id="t1601313914" t="Saikyun [:attrs {:href &quot;/_/_/users/U0CMVHBL2&quot;}] was that aimed at me? 🙂"><y>#</y><d>2020-09-28</d><h>17:25</h><w>Saikyun</w><a>@andy.fingerhut</a> was that aimed at me? <b>🙂</b></z><z id="t1601313961" t="andy.fingerhut It was following up on your conversation, yes."><y>#</y><d>2020-09-28</d><h>17:26</h><w>andy.fingerhut</w>It was following up on your conversation, yes.</z><z id="t1601314197" t="Saikyun ah, okay. yeah, then I get what you mean 🙂 I was thinking if there might be something &quot;cleverer&quot;, or an obvious answer that I didn&apos;t know about. thanks ^^"><y>#</y><d>2020-09-28</d><h>17:29</h><w>Saikyun</w>ah, okay. yeah, then I get what you mean <b>🙂</b> I was thinking if there might be something &quot;cleverer&quot;, or an obvious answer that I didn&apos;t know about. thanks ^^</z><z id="t1601315246" t="andy.fingerhut Obviously for that simple example, if you want to guarantee all-ASCII strings, it is straightforward to generate them that way in the first place, and then no filter is needed. But when the condition you want to satisfy has more interdependence between the parts, it can get very tricky."><y>#</y><d>2020-09-28</d><h>17:47</h><w>andy.fingerhut</w>Obviously for that simple example, if you want to guarantee all-ASCII strings, it is straightforward to generate them that way in the first place, and then no filter is needed.  But when the condition you want to satisfy has more interdependence between the parts, it can get very tricky.</z><z id="t1601362029" t="Saikyun yeah, that makes sense. we&apos;ll see how I solve it then 🙂"><y>#</y><d>2020-09-29</d><h>06:47</h><w>Saikyun</w>yeah, that makes sense. we&apos;ll see how I solve it then <b>🙂</b></z><z id="t1601969228" t="Steven Deobald Hey folks. I have a friend who&apos;s looking to dig into some generative testing for a web service/app we&apos;re volunteering on. All the generative testing examples I have at hand are closed-source, from work done in another life. Does anyone have an open source project(s) they&apos;d recommend he read to see some examples of exercising a domain with test.check? Preferably apps or services, rather than libraries."><y>#</y><d>2020-10-06</d><h>07:27</h><w>Steven Deobald</w>Hey folks. I have a friend who&apos;s looking to dig into some generative testing for a web service/app we&apos;re volunteering on. All the generative testing examples I have at hand are closed-source, from work done in another life. Does anyone have an open source project(s) they&apos;d recommend he read to see some examples of exercising a domain with test.check? Preferably apps or services, rather than libraries.</z><z id="t1601986554" t="gfredericks that one conj keynote was about ostensibly testing dropbox I think there&apos;s a paper to go with it"><y>#</y><d>2020-10-06</d><h>12:15</h><w>gfredericks</w>that one conj keynote was about ostensibly testing dropbox

I think there&apos;s a paper to go with it</z><z id="t1601986639" t="gfredericks and there was a much earlier conj talk about testing a web UI; that probably doesn&apos;t qualify as a real code example though"><y>#</y><d>2020-10-06</d><h>12:17</h><w>gfredericks</w>and there was a much earlier conj talk about testing a web UI; that probably doesn&apos;t qualify as a real code example though</z><z id="t1602109484" t="Hugh Powell Morning folks, does anyone know if there&apos;s a simple way to run a `test.check` `defspec` with only the shrunk value of a failed run and without trying to further shrink it? I know I can just call the test itself with a `:seed` argument, but that runs it with the original data and all the subsequent runs to shrink it. This can make debugging harder than it feels it should be. The only way I can think to do this would be to factor out the test code into a function that takes the generated data."><y>#</y><d>2020-10-07</d><h>22:24</h><w>Hugh Powell</w>Morning folks, does anyone know if there&apos;s a simple way to run a `test.check` `defspec` with only the shrunk value of a failed run and without trying to further shrink it? I know I can just call the test itself with a `:seed` argument, but that runs it with the original data and all the subsequent runs to shrink it. This can make debugging harder than it feels it should be. The only way I can think to do this would be to factor out the test code into a function that takes the generated data.</z><z id="t1602109772" t="gfredericks This overlaps with the use case of wanting to add regression cases to a defspec. Both of those would not be hard features to implement, just need to decide on an api. But as of now it does not exist. I&apos;ve done the factoring you describe a number of times, and it fits well with adding a deftest with regression cases."><y>#</y><d>2020-10-07</d><h>22:29</h><w>gfredericks</w>This overlaps with the use case of wanting to add regression cases to a defspec.

Both of those would not be hard features to implement, just need to decide on an api.

But as of now it does not exist. I&apos;ve done the factoring you describe a number of times, and it fits well with adding a deftest with regression cases.</z><z id="t1602110027" t="Hugh Powell Awesome, thanks for that :thumbsup:"><y>#</y><d>2020-10-07</d><h>22:33</h><w>Hugh Powell</w>Awesome, thanks for that <b>:thumbsup:</b></z><z id="t1602111434" t="seancorfield That sounds like the same advice that Eric Normand gives in his Property-Based Testing course (on http://PurelyFunctional.tv )."><y>#</y><d>2020-10-07</d><h>22:57</h><w>seancorfield</w>That sounds like the same advice that Eric Normand gives in his Property-Based Testing course (on <a href="http://PurelyFunctional.tv" target="_blank">http://PurelyFunctional.tv</a>).</z><z id="t1602111481" t="seancorfield That allows him to take the shrunk failure from the output of defspec and just run that on its own through the test code in a Rich Comment Form in the same ns."><y>#</y><d>2020-10-07</d><h>22:58</h><w>seancorfield</w>That allows him to take the shrunk failure from the output of <code>defspec</code> and just run that on its own through the test code in a Rich Comment Form in the same ns.</z><z id="t1602535839" t="colinkahn is it possible to have a generator that doesn’t shrink at one level, but its children do shrink? For example: (commit-to (gen/one-of [gen-for-case-1 gen-for-case-2])) So once it chooses either case 1 or 2 it won’t try the other, but will shrink the things gen’d in them?"><y>#</y><d>2020-10-12</d><h>20:50</h><w>colinkahn</w>is it possible to have a generator that doesn’t shrink at one level, but its children do shrink? For example:

<pre>(commit-to (gen/one-of [gen-for-case-1 gen-for-case-2]))</pre>
So once it chooses either case 1 or 2 it won’t try the other, but will shrink the things gen’d in them?</z><z id="t1602535987" t="gfredericks Not using public functionality, I don&apos;t think"><y>#</y><d>2020-10-12</d><h>20:53</h><w>gfredericks</w>Not using public functionality, I don&apos;t think</z><z id="t1602536183" t="gfredericks A hacky idea is to have a predicate on the generated values to tell you what branch matched, and then wrap that in a such-that that insists it is something from that branch"><y>#</y><d>2020-10-12</d><h>20:56</h><w>gfredericks</w>A hacky idea is to have a predicate on the generated values to tell you what branch matched, and then wrap that in a such-that that insists it is something from that branch</z><z id="t1602536221" t="gfredericks Super goofy looking, and wastes a bit of cpu, but otherwise would do what you&apos;re describing"><y>#</y><d>2020-10-12</d><h>20:57</h><w>gfredericks</w>Super goofy looking, and wastes a bit of cpu, but otherwise would do what you&apos;re describing</z><z id="t1602536388" t="colinkahn Having a hard time imagining what that would look like, but I think if it’s not standard I can just duplicate my test 😅"><y>#</y><d>2020-10-12</d><h>20:59</h><w>colinkahn</w>Having a hard time imagining what that would look like, but I think if it’s not standard I can just duplicate my test <b>😅</b></z><z id="t1602538546" t="gfredericks Yeah I couldn&apos;t tell what your appetite for Weird was 🙂"><y>#</y><d>2020-10-12</d><h>21:35</h><w>gfredericks</w>Yeah I couldn&apos;t tell what your appetite for Weird was <b>🙂</b></z><z id="t1602673149" t="zclj Hi test.check users, I have released a library intended to provide insights on the values created by test.check generators. If that sounds interesting to you, I would appreciate any usage feedback you might have, with the hopes of making this useful to all test.check users. https://github.com/zclj/test.check.insights"><y>#</y><d>2020-10-14</d><h>10:59</h><w>zclj</w>Hi test.check users, I have released a library intended to provide insights on the values created by test.check generators. If that sounds interesting to you, I would appreciate any usage feedback you might have, with the hopes of making this useful to all test.check users.
<a href="https://github.com/zclj/test.check.insights" target="_blank">https://github.com/zclj/test.check.insights</a></z><z id="t1606058800" t="misha https://akovantsev.github.io/corpus/clojure-slack/test-check - filterable and explorable channels log on a single offline html page, cheers"><y>#</y><d>2020-11-22</d><h>15:26</h><w>misha</w><a href="https://akovantsev.github.io/corpus/clojure-slack/test-check" target="_blank">https://akovantsev.github.io/corpus/clojure-slack/test-check</a> - filterable and explorable channels log on a single offline html page, cheers</z><z id="t1607117765" t="andy.fingerhut I am using the collections-check library, which currently depends upon not-the-most-recent version of test.chuck and test.check libraries"><y>#</y><d>2020-12-04</d><h>21:36</h><w>andy.fingerhut</w>I am using the collections-check library, which currently depends upon not-the-most-recent version of test.chuck and test.check libraries</z><z id="t1607117819" t="andy.fingerhut In trying to verify that it can catch certain kinds of errors, I am intentionally introducing some small errors into a collection implementation. In one case, I make it throw an exception."><y>#</y><d>2020-12-04</d><h>21:36</h><w>andy.fingerhut</w>In trying to verify that it can catch certain kinds of errors, I am intentionally introducing some small errors into a collection implementation.  In one case, I make it throw an exception.</z><z id="t1607117901" t="andy.fingerhut collections-check makes a call to test.chuck&apos;s checking macro, like this: (chuck/checking &quot;vector-like&quot; num-tests-or-options [actions (gen-vector-actions element-generator (transient? empty-coll) ordered?)] (let [[a b actions] (build-collections empty-coll base true actions)] (assert-equivalent-vectors a b)))"><y>#</y><d>2020-12-04</d><h>21:38</h><w>andy.fingerhut</w>collections-check makes a call to test.chuck&apos;s checking macro, like this:
<pre>(chuck/checking &quot;vector-like&quot; num-tests-or-options
    [actions (gen-vector-actions element-generator (transient? empty-coll) ordered?)]
    (let [[a b actions] (build-collections empty-coll base true actions)]
      (assert-equivalent-vectors a b)))</pre></z><z id="t1607117932" t="andy.fingerhut The function assert-equivalent-vectors is a series of clojure.test is macro invocations."><y>#</y><d>2020-12-04</d><h>21:38</h><w>andy.fingerhut</w>The function <code>assert-equivalent-vectors</code> is a series of clojure.test <code>is</code> macro invocations.</z><z id="t1607117966" t="andy.fingerhut When I change the implementation so that it throws an exception, the exception comes not from calling assert-equivalent-vectors , but calling build-collections ."><y>#</y><d>2020-12-04</d><h>21:39</h><w>andy.fingerhut</w>When I change the implementation so that it throws an exception, the exception comes not from calling <code>assert-equivalent-vectors</code>, but calling <code>build-collections</code>.</z><z id="t1607118022" t="andy.fingerhut I put a print statement with a counter inside of assert-equivalent-vectors to see what parameters it was being called with, and how many times, and when there is no exception thrown, I see the checking macro limiting itself to num-tests-or-options iterations (100 or 200 in my short tests)."><y>#</y><d>2020-12-04</d><h>21:40</h><w>andy.fingerhut</w>I put a print statement with a counter inside of <code>assert-equivalent-vectors</code> to see what parameters it was being called with, and how many times, and when there is no exception thrown, I see the <code>checking</code> macro limiting itself to <code>num-tests-or-options</code> iterations (100 or 200 in my short tests).</z><z id="t1607118155" t="andy.fingerhut When build-collections throws an exception, something happens where I see assert-equivalent-vectors continue to be called many, many times, perhaps an infinite loop, but a println I added within test.check&apos;s quick-check macro (or function? I forget) no longer prints each time through the loop. Either the println gets messed up in some weird way (very odd if so), or somehow that quick-check loop is somehow causing assert-equivalent-vectors to be called in an infinite loop, without calling build-collections again."><y>#</y><d>2020-12-04</d><h>21:42</h><w>andy.fingerhut</w>When <code>build-collections</code> throws an exception, something happens where I see <code>assert-equivalent-vectors</code> continue to be called many, many times, perhaps an infinite loop, but a println I added within test.check&apos;s <code>quick-check</code> macro (or function? I forget) no longer prints each time through the loop.  Either the println gets messed up in some weird way (very odd if so), or somehow that <code>quick-check</code> loop is somehow causing <code>assert-equivalent-vectors</code> to be called in an infinite loop, without calling <code>build-collections</code> again.</z><z id="t1607118179" t="andy.fingerhut This may all be rubber ducking if I figure this out, but wanted to ask if:"><y>#</y><d>2020-12-04</d><h>21:42</h><w>andy.fingerhut</w>This may all be rubber ducking if I figure this out, but wanted to ask if:</z><z id="t1607118191" t="gfredericks Shrinking is part of this, right?"><y>#</y><d>2020-12-04</d><h>21:43</h><w>gfredericks</w>Shrinking is part of this, right?</z><z id="t1607118213" t="andy.fingerhut (a) Is test.chuck&apos;s checking macro intended to be used with a checking function that calls clojure.test/is one or more times, and its return value isn&apos;t important?"><y>#</y><d>2020-12-04</d><h>21:43</h><w>andy.fingerhut</w>(a) Is test.chuck&apos;s <code>checking</code> macro intended to be used with a checking function that calls <code>clojure.test/is</code> one or more times, and its return value isn&apos;t important?</z><z id="t1607118235" t="andy.fingerhut Is there a way I can tell whether shrinking is involved? I&apos;m happy adding extra println&apos;s anywhere here."><y>#</y><d>2020-12-04</d><h>21:43</h><w>andy.fingerhut</w>Is there a way I can tell whether shrinking is involved?  I&apos;m happy adding extra println&apos;s anywhere here.</z><z id="t1607118307" t="andy.fingerhut Oh, perhaps shrinking is causing many calls to assert-equivalent-vectors , and they are all failing, and shrinking is &quot;stuck&quot; somehow?"><y>#</y><d>2020-12-04</d><h>21:45</h><w>andy.fingerhut</w>Oh, perhaps shrinking is causing many calls to <code>assert-equivalent-vectors</code>, and they are all failing, and shrinking is &quot;stuck&quot; somehow?</z><z id="t1607118308" t="gfredericks is is the whole point of checking"><y>#</y><d>2020-12-04</d><h>21:45</h><w>gfredericks</w>is is the whole point of checking</z><z id="t1607118382" t="gfredericks I don&apos;t have any theories for why you&apos;d see it stop printing"><y>#</y><d>2020-12-04</d><h>21:46</h><w>gfredericks</w>I don&apos;t have any theories for why you&apos;d see it stop printing</z><z id="t1607118424" t="andy.fingerhut ok. Will keep looking a bit longer."><y>#</y><d>2020-12-04</d><h>21:47</h><w>andy.fingerhut</w>ok.  Will keep looking a bit longer.</z><z id="t1607118459" t="gfredericks You can money patch that to confirm it&apos;s shrinking"><y>#</y><d>2020-12-04</d><h>21:47</h><w>gfredericks</w>You can money patch that to confirm it&apos;s shrinking</z><z id="t1607118468" t="andy.fingerhut I was hoping that checking would quickly show some output of a failure if an exception was thrown, rather than going into an infinite loop (if it is infinite -- not sure whether it is infinite or just long)"><y>#</y><d>2020-12-04</d><h>21:47</h><w>andy.fingerhut</w>I was hoping that <code>checking</code> would quickly show some output of a failure if an exception was thrown, rather than going into an infinite loop (if it is infinite -- not sure whether it is infinite or just long)</z><z id="t1607118499" t="andy.fingerhut Phone handier than links today? 🙂"><y>#</y><d>2020-12-04</d><h>21:48</h><w>andy.fingerhut</w>Phone handier than links today? <b>🙂</b></z><z id="t1607118516" t="gfredericks Yep 🙂"><y>#</y><d>2020-12-04</d><h>21:48</h><w>gfredericks</w>Yep <b>🙂</b></z><z id="t1607118532" t="gfredericks That&apos;s in the base t.c namespace"><y>#</y><d>2020-12-04</d><h>21:48</h><w>gfredericks</w>That&apos;s in the base t.c namespace</z><z id="t1607118599" t="andy.fingerhut I can try updating to latest versions of test.chuck and test.check, but initially when I tried that there seemed to be some incorrect args being passed around somewhere, and hadn&apos;t figured that out yet to make it work well enough to debug."><y>#</y><d>2020-12-04</d><h>21:49</h><w>andy.fingerhut</w>I can try updating to latest versions of test.chuck and test.check, but initially when I tried that there seemed to be some incorrect args being passed around somewhere, and hadn&apos;t figured that out yet to make it work well enough to debug.</z><z id="t1607118619" t="andy.fingerhut Thanks for the leads"><y>#</y><d>2020-12-04</d><h>21:50</h><w>andy.fingerhut</w>Thanks for the leads</z><z id="t1607118734" t="gfredericks n.p.; happy to help out if you run into something"><y>#</y><d>2020-12-04</d><h>21:52</h><w>gfredericks</w>n.p.; happy to help out if you run into something</z><z id="t1607118800" t="andy.fingerhut Should latest test.check and test.chuck be compatible with each other, as far as you know?"><y>#</y><d>2020-12-04</d><h>21:53</h><w>andy.fingerhut</w>Should latest test.check and test.chuck be compatible with each other, as far as you know?</z><z id="t1607118855" t="andy.fingerhut I think collections-check may need some changes to work with latest test.chuck, but would prefer not to guess too many times at which pairs of test.chuck/test.check version combinations should work with each other."><y>#</y><d>2020-12-04</d><h>21:54</h><w>andy.fingerhut</w>I think collections-check may need some changes to work with latest test.chuck, but would prefer not to guess too many times at which pairs of test.chuck/test.check version combinations should work with each other.</z><z id="t1607118855" t="gfredericks Yes"><y>#</y><d>2020-12-04</d><h>21:54</h><w>gfredericks</w>Yes</z><z id="t1607118904" t="gfredericks Both libraries have generally avoided breaking changes"><y>#</y><d>2020-12-04</d><h>21:55</h><w>gfredericks</w>Both libraries have generally avoided breaking changes</z><z id="t1607120102" t="andy.fingerhut Wow. I think I found it. collections-check is passing a double for the num-tests-or-options, which test.chuck&apos;s times function in the latest version returns nil for."><y>#</y><d>2020-12-04</d><h>22:15</h><w>andy.fingerhut</w>Wow.  I think I found it.  collections-check is passing a double for the num-tests-or-options, which test.chuck&apos;s <code>times</code> function in the latest version returns <code>nil</code> for.</z><z id="t1607120123" t="andy.fingerhut I mean, I found the thing that I thought would take 30 seconds in about 20 mins 🙂 . Not the final answer."><y>#</y><d>2020-12-04</d><h>22:15</h><w>andy.fingerhut</w>I mean, I found the thing that I thought would take 30 seconds in about 20 mins <b>🙂</b>. Not the final answer.</z><z id="t1607120259" t="gfredericks This thing returns nil???"><y>#</y><d>2020-12-04</d><h>22:17</h><w>gfredericks</w>This thing returns nil???</z><z id="t1607120407" t="andy.fingerhut This thing: (defn times [num-tests-or-options] (cond (map? num-tests-or-options) (:num-tests num-tests-or-options tc.clojure-test/*default-test-count*) (integer? num-tests-or-options) num-tests-or-options))"><y>#</y><d>2020-12-04</d><h>22:20</h><w>andy.fingerhut</w>This thing:
<pre>(defn times [num-tests-or-options]
  (cond (map? num-tests-or-options)     (:num-tests num-tests-or-options tc.clojure-test/*default-test-count*)
        (integer? num-tests-or-options) num-tests-or-options))</pre></z><z id="t1607120565" t="gfredericks Oh geez there&apos;s two of them"><y>#</y><d>2020-12-04</d><h>22:22</h><w>gfredericks</w>Oh geez there&apos;s two of them</z><z id="t1607120625" t="andy.fingerhut It was weird that collection-check was using doubles anyway -- probably Zach T liked 1e2, 1e3 for brevity on test counts."><y>#</y><d>2020-12-04</d><h>22:23</h><w>andy.fingerhut</w>It was weird that collection-check was using doubles anyway -- probably Zach T liked 1e2, 1e3 for brevity on test counts.</z><z id="t1607120684" t="gfredericks This is why we can&apos;t have nice static type systems"><y>#</y><d>2020-12-04</d><h>22:24</h><w>gfredericks</w>This is why we can&apos;t have nice static type systems</z><z id="t1607123938" t="andy.fingerhut The shrink-loop is definitely going for far more iterations than I would have expected."><y>#</y><d>2020-12-04</d><h>23:18</h><w>andy.fingerhut</w>The shrink-loop is definitely going for far more iterations than I would have expected.</z><z id="t1607123970" t="gfredericks What sort of data is it?"><y>#</y><d>2020-12-04</d><h>23:19</h><w>gfredericks</w>What sort of data is it?</z><z id="t1607124037" t="andy.fingerhut collections-check generates sequences of operations on data structures, in this case on vectors, like assoc, conj, transient, persistent!, seq, etc."><y>#</y><d>2020-12-04</d><h>23:20</h><w>andy.fingerhut</w>collections-check generates sequences of operations on data structures, in this case on vectors, like assoc, conj, transient, persistent!, seq, etc.</z><z id="t1607124059" t="andy.fingerhut So I think it must be attempting to shrink that sequence of operations down to a case where it passes, and then increase it a bit?"><y>#</y><d>2020-12-04</d><h>23:20</h><w>andy.fingerhut</w>So I think it must be attempting to shrink that sequence of operations down to a case where it passes, and then increase it a bit?</z><z id="t1607124137" t="andy.fingerhut I am printing out the length of the vectors produced in the function that does multiple is calls to compare the results of two different vector implementations, each produced with two different vector implementations, and they do fluctuate a bit, but they are not getting consistently smaller."><y>#</y><d>2020-12-04</d><h>23:22</h><w>andy.fingerhut</w>I am printing out the length of the vectors produced in the function that does multiple <code>is</code> calls to compare the results of two different vector implementations, each produced with two different vector implementations, and they do fluctuate a bit, but they are not getting consistently smaller.</z><z id="t1607124167" t="andy.fingerhut I guess I could figure out how to look at the sequence of operations being tried in the shrink-loop to see if it is getting smaller/simpler"><y>#</y><d>2020-12-04</d><h>23:22</h><w>andy.fingerhut</w>I guess I could figure out how to look at the sequence of operations being tried in the shrink-loop to see if it is getting smaller/simpler</z><z id="t1607124281" t="gfredericks The pattern isn&apos;t necessarily simple"><y>#</y><d>2020-12-04</d><h>23:24</h><w>gfredericks</w>The pattern isn&apos;t necessarily simple</z><z id="t1607124334" t="gfredericks Especially if the generator uses bind"><y>#</y><d>2020-12-04</d><h>23:25</h><w>gfredericks</w>Especially if the generator uses bind</z><z id="t1607124383" t="andy.fingerhut This is a wild guess, but it also generates the values to be added to the vector via gen/int, and there are about 500 of them in the failing vector, so if it is spending any work trying to simplify those numeric values, most of those are going to give the same result, since the error I put into the bad vector implementation fails over about 520 vector elements, unless pretty much most of the vector elements are equal to each other."><y>#</y><d>2020-12-04</d><h>23:26</h><w>andy.fingerhut</w>This is a wild guess, but it also generates the values to be added to the vector via gen/int, and there are about 500 of them in the failing vector, so if it is spending any work trying to simplify those numeric values, most of those are going to give the same result, since the error I put into the bad vector implementation fails over about 520 vector elements, unless pretty much most of the vector elements are equal to each other.</z><z id="t1607124523" t="gfredericks What problem are you actually trying to solve?"><y>#</y><d>2020-12-04</d><h>23:28</h><w>gfredericks</w>What problem are you actually trying to solve?</z><z id="t1607124579" t="andy.fingerhut Good question. In this case, I wanted to verify that collections-check could detect a simple bug in an implementation, because I wanted to better trust the results when it returns no bugs found."><y>#</y><d>2020-12-04</d><h>23:29</h><w>andy.fingerhut</w>Good question.  In this case, I wanted to verify that collections-check could detect a simple bug in an implementation, because I wanted to better trust the results when it returns no bugs found.</z><z id="t1607124625" t="gfredericks Ah okay, and the fact that it&apos;s spinning instead of returning failure is concerning"><y>#</y><d>2020-12-04</d><h>23:30</h><w>gfredericks</w>Ah okay, and the fact that it&apos;s spinning instead of returning failure is concerning</z><z id="t1607124626" t="andy.fingerhut So I&apos;m really done verifying that it can find this example bug I&apos;ve introduced, but only because I&apos;ve added extra debug prints. If I don&apos;t have those, I just get what appears to be an infinite loop, with no failing test case given."><y>#</y><d>2020-12-04</d><h>23:30</h><w>andy.fingerhut</w>So I&apos;m really done verifying that it can find this example bug I&apos;ve introduced, but only because I&apos;ve added extra debug prints.  If I don&apos;t have those, I just get what appears to be an infinite loop, with no failing test case given.</z><z id="t1607124669" t="gfredericks Wrap the gen in gen/no-shrink 😛 😉"><y>#</y><d>2020-12-04</d><h>23:31</h><w>gfredericks</w>Wrap the gen in gen/no-shrink <b>😛</b> <b>😉</b></z><z id="t1607124681" t="andy.fingerhut I suppose I could eliminate the possibility of gen/int shrinking slowing things down, by forcing vector elements in the sequence of operations to be increasing numbers."><y>#</y><d>2020-12-04</d><h>23:31</h><w>andy.fingerhut</w>I suppose I could eliminate the possibility of gen/int shrinking slowing things down, by forcing vector elements in the sequence of operations to be increasing numbers.</z><z id="t1607124690" t="andy.fingerhut OK, didn&apos;t know about that, so thanks."><y>#</y><d>2020-12-04</d><h>23:31</h><w>andy.fingerhut</w>OK, didn&apos;t know about that, so thanks.</z><z id="t1607124692" t="andy.fingerhut will try"><y>#</y><d>2020-12-04</d><h>23:31</h><w>andy.fingerhut</w>will try</z><z id="t1607124698" t="gfredericks If there&apos;s not a feature for limiting shrink time then there oughta be"><y>#</y><d>2020-12-04</d><h>23:31</h><w>gfredericks</w>If there&apos;s not a feature for limiting shrink time then there oughta be</z><z id="t1607124719" t="andy.fingerhut Just (gen/no-shrink gen/int) where I currently have gen/int I guess?"><y>#</y><d>2020-12-04</d><h>23:31</h><w>andy.fingerhut</w>Just <code>(gen/no-shrink gen/int)</code> where I currently have <code>gen/int</code> I guess?</z><z id="t1607124753" t="gfredericks You could. Or you could wrap the whole collection generator"><y>#</y><d>2020-12-04</d><h>23:32</h><w>gfredericks</w>You could. Or you could wrap the whole collection generator</z><z id="t1607124793" t="gfredericks You get different effects for each"><y>#</y><d>2020-12-04</d><h>23:33</h><w>gfredericks</w>You get different effects for each</z><z id="t1607124949" t="andy.fingerhut Is there anything in shrink-loop that represents the value passed to the function being tested?"><y>#</y><d>2020-12-04</d><h>23:35</h><w>andy.fingerhut</w>Is there anything in shrink-loop that represents the value passed to the function being tested?</z><z id="t1607124960" t="andy.fingerhut i.e. that I could print and look at?"><y>#</y><d>2020-12-04</d><h>23:36</h><w>andy.fingerhut</w>i.e. that I could print and look at?</z><z id="t1607124996" t="andy.fingerhut I know it isn&apos;t head and it is not result because those have the wrong class"><y>#</y><d>2020-12-04</d><h>23:36</h><w>andy.fingerhut</w>I know it isn&apos;t <code>head</code> and it is not <code>result</code> because those have the wrong class</z><z id="t1607125268" t="gfredericks Actually no"><y>#</y><d>2020-12-04</d><h>23:41</h><w>gfredericks</w>Actually no</z><z id="t1607125273" t="gfredericks I thought so"><y>#</y><d>2020-12-04</d><h>23:41</h><w>gfredericks</w>I thought so</z><z id="t1607125291" t="gfredericks But the structure here is more function oriented than data oriented"><y>#</y><d>2020-12-04</d><h>23:41</h><w>gfredericks</w>But the structure here is more function oriented than data oriented</z></g><g id="s9"><z id="t1607125405" t="gfredericks You know what I think there&apos;s a callback feature you&apos;d like"><y>#</y><d>2020-12-04</d><h>23:43</h><w>gfredericks</w>You know what I think there&apos;s a callback feature you&apos;d like</z><z id="t1607125416" t="andy.fingerhut The value of (:args (rose/root head)) might be what I&apos;m seeking"><y>#</y><d>2020-12-04</d><h>23:43</h><w>andy.fingerhut</w>The value of <code>(:args (rose/root head))</code> might be what I&apos;m seeking</z><z id="t1607125429" t="gfredericks Use reporter-fn"><y>#</y><d>2020-12-04</d><h>23:43</h><w>gfredericks</w>Use reporter-fn</z><z id="t1607125432" t="gfredericks Pass one in"><y>#</y><d>2020-12-04</d><h>23:43</h><w>gfredericks</w>Pass one in</z><z id="t1607125459" t="andy.fingerhut I&apos;m comfortable hacking on my own modified copy of test.check and test.chuck if it helps, which is how I got to that result."><y>#</y><d>2020-12-04</d><h>23:44</h><w>andy.fingerhut</w>I&apos;m comfortable hacking on my own modified copy of test.check and test.chuck if it helps, which is how I got to that result.</z><z id="t1607125478" t="andy.fingerhut Thanks for the help. Will be away from keyboard for a bit here."><y>#</y><d>2020-12-04</d><h>23:44</h><w>andy.fingerhut</w>Thanks for the help.  Will be away from keyboard for a bit here.</z><z id="t1607176438" t="gfredericks `:reporter-fn` A callback function that will be called at various points in the test run, with a map like: ;; called after a passing trial {:type :trial :args [...] :num-tests &lt;number of tests run so far&gt; :num-tests-total &lt;total number of tests to be run&gt; :seed 42 :pass? true :property #&lt;...&gt; :result true :result-data {...}} ;; called after the first failing trial {:type :failure :fail [...failing args...] :failing-size 13 :num-tests &lt;tests ran before failure found&gt; :pass? false :property #&lt;...&gt; :result false/exception :result-data {...} :seed 42} It will also be called on :complete, :shrink-step and :shrunk. Many of the keys also appear in the quick-check return value, and are documented below. ☝️ an arg to clojure.test.check/quick-check , which you could monkey-patch if you aren&apos;t actually calling it directly"><y>#</y><d>2020-12-05</d><h>13:53</h><w>gfredericks</w><pre>`:reporter-fn`
    A callback function that will be called at various points in the test
    run, with a map like:
      ;; called after a passing trial
      {:type            :trial
       :args            [...]
       :num-tests       &lt;number of tests run so far&gt;
       :num-tests-total &lt;total number of tests to be run&gt;
       :seed            42
       :pass?           true
       :property        #&lt;...&gt;
       :result          true
       :result-data     {...}}
      ;; called after the first failing trial
      {:type         :failure
       :fail         [...failing args...]
       :failing-size 13
       :num-tests    &lt;tests ran before failure found&gt;
       :pass?        false
       :property     #&lt;...&gt;
       :result       false/exception
       :result-data  {...}
       :seed         42}
    It will also be called on :complete, :shrink-step and :shrunk. Many
    of the keys also appear in the quick-check return value, and are
    documented below.</pre>
<b>☝️</b> an arg to <code>clojure.test.check/quick-check</code> , which you could monkey-patch if you aren&apos;t actually calling it directly</z><z id="t1607181190" t="andy.fingerhut Thanks for that tip."><y>#</y><d>2020-12-05</d><h>15:13</h><w>andy.fingerhut</w>Thanks for that tip.</z><z id="t1607181222" t="andy.fingerhut I know that shrink-loop in my case is not finishing within 10,000 iterations, since I put in some logging and let it run for a while."><y>#</y><d>2020-12-05</d><h>15:13</h><w>andy.fingerhut</w>I know that shrink-loop in my case is not finishing within 10,000 iterations, since I put in some logging and let it run for a while.</z><z id="t1607181330" t="andy.fingerhut I guess I might let it run for a day or so, out of curiosity to see if it actually finishes. In the mean time, it does seem like some kind of option to force shrink-loop to return early would be useful in some cases, as I think you may have mentioned earlier."><y>#</y><d>2020-12-05</d><h>15:15</h><w>andy.fingerhut</w>I guess I might let it run for a day or so, out of curiosity to see if it actually finishes.  In the mean time, it does seem like some kind of option to force shrink-loop to return early would be useful in some cases, as I think you may have mentioned earlier.</z><z id="t1607181370" t="andy.fingerhut Or perhaps there is one, and I haven&apos;t read the docs yet."><y>#</y><d>2020-12-05</d><h>15:16</h><w>andy.fingerhut</w>Or perhaps there is one, and I haven&apos;t read the docs yet.</z><z id="t1607181402" t="gfredericks I would have added that feature a long time ago, but I got stuck being unable to decide on a coherent way of configuring test.check given the &gt;=2 different usage styles"><y>#</y><d>2020-12-05</d><h>15:16</h><w>gfredericks</w>I would have added that feature a long time ago, but I got stuck being unable to decide on a coherent way of configuring test.check given the &gt;=2 different usage styles</z><z id="t1607181437" t="gfredericks also once you start returning from shrinks early people will want a feature for resuming shrinks, and that&apos;s even more complicated"><y>#</y><d>2020-12-05</d><h>15:17</h><w>gfredericks</w>also once you start returning from shrinks early people will want a feature for resuming shrinks, and that&apos;s even more complicated</z><z id="t1607181506" t="gfredericks looks like there&apos;s no error-handling on the reporter-fn , so technically you could just throw an exception from there 😄"><y>#</y><d>2020-12-05</d><h>15:18</h><w>gfredericks</w>looks like there&apos;s no error-handling on the <code>reporter-fn</code> , so technically you could just throw an exception from there <b>😄</b></z><z id="t1607181531" t="andy.fingerhut That is certainly one way to do it. Let me try that."><y>#</y><d>2020-12-05</d><h>15:18</h><w>andy.fingerhut</w>That is certainly one way to do it.  Let me try that.</z><z id="t1607181649" t="gfredericks it might not be trivial to get it to accurately return a &quot;smallest failing case so far&quot;"><y>#</y><d>2020-12-05</d><h>15:20</h><w>gfredericks</w>it might not be trivial to get it to accurately return a &quot;smallest failing case so far&quot;</z><z id="t1607181670" t="gfredericks shouldn&apos;t be hard to get it to return a &quot;most recently failing case&quot;; maybe that&apos;s the same thing, I&apos;m not quite sure 🙂"><y>#</y><d>2020-12-05</d><h>15:21</h><w>gfredericks</w>shouldn&apos;t be hard to get it to return a &quot;most recently failing case&quot;; maybe that&apos;s the same thing, I&apos;m not quite sure <b>🙂</b></z><z id="t1607181679" t="andy.fingerhut I see current-smallest"><y>#</y><d>2020-12-05</d><h>15:21</h><w>andy.fingerhut</w>I see <code>current-smallest</code></z><z id="t1607181691" t="gfredericks oh, perfect"><y>#</y><d>2020-12-05</d><h>15:21</h><w>gfredericks</w>oh, perfect</z><z id="t1607181694" t="andy.fingerhut which seems to be passed to reporter-fn whenever a new one is found"><y>#</y><d>2020-12-05</d><h>15:21</h><w>andy.fingerhut</w>which seems to be passed to reporter-fn whenever a new one is found</z><z id="t1607235375" t="andy.fingerhut Thanks for pointing me in the direction of reporter-fn, and mentioning that having it throw an exception could terminate the shrinking early."><y>#</y><d>2020-12-06</d><h>06:16</h><w>andy.fingerhut</w>Thanks for pointing me in the direction of reporter-fn, and mentioning that having it throw an exception could terminate the shrinking early.</z><z id="t1607235610" t="andy.fingerhut [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] Would you be interested in some kind of patch for the test.check library, perhaps documentation only, with around 60 lines of code that is a sample reporter-fn that when given to quick-check, will print progress on the number of tests run so far, and throw an exception if shrinking takes more than 5000 iterations through the shrink loop, saving the smallest args ever encountered in an atom before throwing the exception?"><y>#</y><d>2020-12-06</d><h>06:20</h><w>andy.fingerhut</w><a>@gfredericks</a> Would you be interested in some kind of patch for the test.check library, perhaps documentation only, with around 60 lines of code that is a sample reporter-fn that when given to quick-check, will print progress on the number of tests run so far, and throw an exception if shrinking takes more than 5000 iterations through the shrink loop, saving the smallest args ever encountered in an atom before throwing the exception?</z><z id="t1607246179" t="andy.fingerhut In case you are curious, this is what the code looks like: https://github.com/jafingerhut/clj-2594/blob/master/src/com/fingerhutpress/clj_2594.clj#L135-L193"><y>#</y><d>2020-12-06</d><h>09:16</h><w>andy.fingerhut</w>In case you are curious, this is what the code looks like: <a href="https://github.com/jafingerhut/clj-2594/blob/master/src/com/fingerhutpress/clj_2594.clj#L135-L193" target="_blank">https://github.com/jafingerhut/clj-2594/blob/master/src/com/fingerhutpress/clj_2594.clj#L135-L193</a></z><z id="t1607309771" t="gfredericks I&apos;m not maintaining test.check anymore, so not my call, officially unofficially, documentation of a hack as a placeholder for a better-thought-out feature doesn&apos;t sound bad"><y>#</y><d>2020-12-07</d><h>02:56</h><w>gfredericks</w>I&apos;m not maintaining test.check anymore, so not my call, officially

unofficially, documentation of a hack as a placeholder for a better-thought-out feature doesn&apos;t sound bad</z><z id="t1607603495" t="borkdude [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] do you know who is maintaining test.check now? thanks for maintaining it for so long!"><y>#</y><d>2020-12-10</d><h>12:31</h><w>borkdude</w><a>@gfredericks</a> do you know who is maintaining test.check now? thanks for maintaining it for so long!</z><z id="t1607608993" t="gfredericks probably de facto alex miller"><y>#</y><d>2020-12-10</d><h>14:03</h><w>gfredericks</w>probably de facto alex miller</z><z id="t1607609149" t="gfredericks at the very least he&apos;d have a more official answer to that question"><y>#</y><d>2020-12-10</d><h>14:05</h><w>gfredericks</w>at the very least he&apos;d have a more official answer to that question</z><z id="t1607622817" t="seancorfield [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I guess I missed hearing you had stepped down from it until this discussion -- may I ask why?"><y>#</y><d>2020-12-10</d><h>17:53</h><w>seancorfield</w><a>@gfredericks</a> I guess I missed hearing you had stepped down from it until this discussion -- may I ask why?</z><z id="t1607623239" t="gfredericks I&apos;m just really bad at design tradeoffs. I did all the no brainer low hanging fruit stuff, and everything that&apos;s left induces lots of analysis paralysis"><y>#</y><d>2020-12-10</d><h>18:00</h><w>gfredericks</w>I&apos;m just really bad at design tradeoffs. I did all the no brainer low hanging fruit stuff, and everything that&apos;s left induces lots of analysis paralysis</z><z id="t1607623263" t="gfredericks I also have less time than I used to"><y>#</y><d>2020-12-10</d><h>18:01</h><w>gfredericks</w>I also have less time than I used to</z><z id="t1607623328" t="gfredericks So those two things pushed it into &quot;not personally worth it&quot; territory"><y>#</y><d>2020-12-10</d><h>18:02</h><w>gfredericks</w>So those two things pushed it into &quot;not personally worth it&quot; territory</z><z id="t1607623393" t="seancorfield Totally understand that! I&apos;ve been staring at a V2 of HoneySQL for months and I am now at a point where I think parts of my design are just dead ends and I need to start from scratch... which is kind of daunting... 😞"><y>#</y><d>2020-12-10</d><h>18:03</h><w>seancorfield</w>Totally understand that! I&apos;ve been staring at a V2 of HoneySQL for months and I am now at a point where I think parts of my design are just dead ends and I need to start from scratch... which is kind of daunting... <b>😞</b></z><z id="t1607623523" t="gfredericks Yeah, it&apos;s not easy work"><y>#</y><d>2020-12-10</d><h>18:05</h><w>gfredericks</w>Yeah, it&apos;s not easy work</z><z id="t1607623566" t="gfredericks Unless you just yolo it and embrace &quot;future people will hate this&quot; 🙂"><y>#</y><d>2020-12-10</d><h>18:06</h><w>gfredericks</w>Unless you just yolo it and embrace &quot;future people will hate this&quot; <b>🙂</b></z><z id="t1611524128" t="borkdude"><y>#</y><d>2021-01-24</d><h>21:35</h><w>borkdude</w></z><z id="t1614892892" t="hiredman it seems unlikely, but I think you should be able to get by with a single fmap"><y>#</y><d>2021-03-04</d><h>21:21</h><w>hiredman</w>it seems unlikely, but I think you should be able to get by with a single fmap</z><z id="t1614892943" t="gfredericks Equal length strings?"><y>#</y><d>2021-03-04</d><h>21:22</h><w>gfredericks</w>Equal length strings?</z><z id="t1614893053" t="hiredman generate a string of more than n characters, generate a vector of n characters and indices, then fmap over both of those producing a pair of the string, and the string with characters swapped at the indices"><y>#</y><d>2021-03-04</d><h>21:24</h><w>hiredman</w>generate a string of more than n characters, generate a vector of n characters and indices, then fmap over both of those producing a pair of the string, and the string with characters swapped at the indices</z><z id="t1614893096" t="hiredman (the indices will require some fiddling to work out right, but doable)"><y>#</y><d>2021-03-04</d><h>21:24</h><w>hiredman</w>(the indices will require some fiddling to work out right, but doable)</z><z id="t1614893105" t="gfredericks You could also generate edit operations"><y>#</y><d>2021-03-04</d><h>21:25</h><w>gfredericks</w>You could also generate edit operations</z><z id="t1614893135" t="hiredman yeah, characters + indices are an edit operation"><y>#</y><d>2021-03-04</d><h>21:25</h><w>hiredman</w>yeah, characters + indices are an edit operation</z><z id="t1614893255" t="murtaza What I&apos;ve done so far is generate a string, and then edit out parts of it at random start and end positions using subs, joins and replace"><y>#</y><d>2021-03-04</d><h>21:27</h><w>murtaza</w>What I&apos;ve done so far is generate a string, and then edit out parts of it at random start and end positions using subs, joins and replace</z><z id="t1614893255" t="hiredman no, I don&apos;t think you can do it without an fmap"><y>#</y><d>2021-03-04</d><h>21:27</h><w>hiredman</w>no, I don&apos;t think you can do it without an fmap</z><z id="t1614893300" t="gfredericks Random meaning calling rand-int or similar?"><y>#</y><d>2021-03-04</d><h>21:28</h><w>gfredericks</w>Random meaning calling rand-int or similar?</z><z id="t1614893643" t="gfredericks Tied together with bind and fmap?"><y>#</y><d>2021-03-04</d><h>21:34</h><r>gfredericks</r>Tied together with bind and fmap?</z><z id="t1614893746" t="gfredericks Ha"><y>#</y><d>2021-03-04</d><h>21:35</h><r>gfredericks</r>Ha</z><z id="t1614893930" t="gfredericks Sure"><y>#</y><d>2021-03-04</d><h>21:38</h><r>gfredericks</r>Sure</z><z id="t1614893307" t="hiredman in order for the generator to work at all, you need to at the base to be able to turn 1 string in to a pair of strings"><y>#</y><d>2021-03-04</d><h>21:28</h><w>hiredman</w>in order for the generator to work at all, you need to at the base to be able to turn 1 string in to a pair of strings</z><z id="t1614893322" t="hiredman that is gonna be an fmap"><y>#</y><d>2021-03-04</d><h>21:28</h><w>hiredman</w>that is gonna be an fmap</z><z id="t1614893974" t="gfredericks I think generating edits is pretty easy, though it might be harder to aim for exactly N differences if you need that"><y>#</y><d>2021-03-04</d><h>21:39</h><w>gfredericks</w>I think generating edits is pretty easy, though it might be harder to aim for exactly N differences if you need that</z><z id="t1614893994" t="gfredericks Generating edits would shrink nicely I think"><y>#</y><d>2021-03-04</d><h>21:39</h><w>gfredericks</w>Generating edits would shrink nicely I think</z><z id="t1614894007" t="gfredericks If you want to shrink toward fewer differences"><y>#</y><d>2021-03-04</d><h>21:40</h><w>gfredericks</w>If you want to shrink toward fewer differences</z><z id="t1614894692" t="hiredman ;; written but not run ;; assuming strings of length 5 and differences of 3 characters (gen/fmap (fn [string edits] (loop [[[shift index] &amp; es] edits s (vec string) editted #{}] (if e (let [i (mod index (count s))] (if (contains? editted i) (recur (cons [shift (inc index)] es) s editted) (recur es (update-in s [i] (fn [c] (char (+ 32 (mod (+ offset (- (int c) 32)) 126))))) (conj editted i)))) (apply str s)))) (gen/tuple (gen/resize 5 gen/string-ascii) (gen/tuple (gen/tuple s-pos-int s-pos-int) (gen/tuple s-pos-int s-pos-int) (gen/tuple s-pos-int s-pos-int)))) "><y>#</y><d>2021-03-04</d><h>21:51</h><w>hiredman</w><pre>;; written but not run
;; assuming strings of length 5 and differences of 3 characters
(gen/fmap
 (fn [string edits]
   (loop [[[shift index] &amp; es] edits
          s (vec string)
          editted #{}]
     (if e
       (let [i (mod index (count s))]
         (if (contains? editted i)
           (recur (cons [shift (inc index)] es) s editted)
           (recur es
                  (update-in s [i] (fn [c]
                                     (char (+ 32 (mod (+ offset (- (int c) 32)) 126)))))
                  (conj editted i))))
       (apply str s))))
 (gen/tuple (gen/resize 5 gen/string-ascii)
            (gen/tuple
             (gen/tuple s-pos-int s-pos-int)
             (gen/tuple s-pos-int s-pos-int)
             (gen/tuple s-pos-int s-pos-int))))</pre>
</z><z id="t1614895010" t="hiredman (that mod 126 should maybe be mod 126 - 32)"><y>#</y><d>2021-03-04</d><h>21:56</h><w>hiredman</w>(that mod 126 should maybe be mod 126 - 32)</z><z id="t1614895046" t="hiredman and the fn has to destructure the vector, etc"><y>#</y><d>2021-03-04</d><h>21:57</h><w>hiredman</w>and the fn has to destructure the vector, etc</z><z id="t1614895087" t="robertfw Can you recur from there?"><y>#</y><d>2021-03-04</d><h>21:58</h><w>robertfw</w>Can you <code>recur</code> from there?</z><z id="t1614895104" t="hiredman inside a loop? of course"><y>#</y><d>2021-03-04</d><h>21:58</h><w>hiredman</w>inside a loop? of course</z><z id="t1614895132" t="robertfw I meant from non-tail position"><y>#</y><d>2021-03-04</d><h>21:58</h><w>robertfw</w>I meant from non-tail position</z><z id="t1614895148" t="hiredman I am pretty sure those are all tails"><y>#</y><d>2021-03-04</d><h>21:59</h><w>hiredman</w>I am pretty sure those are all tails</z><z id="t1614895225" t="robertfw I thought I had run into not being able to recur from the first branch of if but I may well be getting mixed up with recur within try"><y>#</y><d>2021-03-04</d><h>22:00</h><w>robertfw</w>I thought I had run into not being able to recur from the first branch of if but I may well be getting mixed up with recur within try</z><z id="t1614895311" t="hiredman yes, you can&apos;t recur across a try, logically a try pushes an exception handler on to a stack, so recuring across a try grows the exception handling stack"><y>#</y><d>2021-03-04</d><h>22:01</h><w>hiredman</w>yes, you can&apos;t recur across a try, logically a try pushes an exception handler on to a stack, so recuring across a try grows the exception handling stack</z><z id="t1614895420" t="robertfw Thanks, that makes sense"><y>#</y><d>2021-03-04</d><h>22:03</h><w>robertfw</w>Thanks, that makes sense</z><z id="t1623630155" t="colinkahn I noticed a difference in using the for-all and checking forms available in com.gfredericks.test.chuck.clojure-test , seems that for-all will give one assertion error on the shrunk result where checking will give one for each failing is . Is that expected? I was hoping for-all would give the same kind of reporting. (defspec test-test (for-all [x (gen/return 1)] (is (zero? x)))) (deftest test-test (checking &quot;fails&quot; 1 [x (gen/return 1)] (is (zero? x)))) "><y>#</y><d>2021-06-14</d><h>00:22</h><w>colinkahn</w>I noticed a difference in using the <code>for-all</code> and <code>checking</code> forms available in <code>com.gfredericks.test.chuck.clojure-test</code>, seems that <code>for-all</code> will give one assertion error on the shrunk result where <code>checking</code> will give one for each failing <code>is</code>. Is that expected? I was hoping <code>for-all</code> would give the same kind of reporting.

<pre>(defspec test-test
  (for-all [x (gen/return 1)]
    (is (zero? x))))

(deftest test-test
  (checking &quot;fails&quot; 1 [x (gen/return 1)]
    (is (zero? x)))) </pre></z><z id="t1623631263" t="seancorfield [:attrs {:href &quot;/_/_/users/U0CLLU3QT&quot;}] It’s expected: for-all is a single assertion — that the property holds for all values tested — so it will either pass or fail as a whole: is just checks the expression; checking runs the whole body it is passed — which can contain any number of assertions — and in that context each is runs as a regular assertion. Does that help?"><y>#</y><d>2021-06-14</d><h>00:41</h><w>seancorfield</w><a>@colinkahn</a> It’s expected: <code>for-all</code> is a single assertion — that the property holds for all values tested — so it will either pass or fail as a whole: <code>is</code> just checks the expression; <code>checking</code> runs the whole body it is passed — which can contain any number of assertions — and in that context each <code>is</code> runs as a regular assertion. Does that help?</z><z id="t1623631779" t="colinkahn [:attrs {:href &quot;/_/_/users/U04V70XH6&quot;}] I knew for-all in test.check worked that way but figured the test.chuck one wasn&apos;t limited to a single assertion and would report them all. https://github.com/gfredericks/test.chuck#alternate-clojuretest-integration It is just a minor inconvenience if that&apos;s the case though, I like the fact that I can get the :smallest from the return of defspec in the REPL, but also wanted the reporting available in checking."><y>#</y><d>2021-06-14</d><h>00:49</h><w>colinkahn</w><a>@seancorfield</a> I knew <code>for-all</code> in <code>test.check</code> worked that way but figured the <code>test.chuck</code> one wasn&apos;t limited to a single assertion and would report them all. <a href="https://github.com/gfredericks/test.chuck#alternate-clojuretest-integration" target="_blank">https://github.com/gfredericks/test.chuck#alternate-clojuretest-integration</a>

It is just a minor inconvenience if that&apos;s the case though, I like the fact that I can get the <code>:smallest</code> from the return of <code>defspec</code> in the REPL, but also wanted the reporting available in <code>checking.</code></z><z id="t1623950509" t="Adam Helins [:attrs {:href &quot;/_/_/users/U0CLLU3QT&quot;}] I was in search of &quot;multiplexing&quot; a single property into several one while still tracking exactly what fails. checking does that using is but I wasn&apos;t so pleased with the internals and wanted something that worked without is , so I created this (in case you find that helpful): https://github.com/helins/mprop.cljc"><y>#</y><d>2021-06-17</d><h>17:21</h><w>Adam Helins</w><a>@colinkahn</a> I was in search of &quot;multiplexing&quot; a single property into several one while still tracking exactly what fails. <code>checking</code> does that using <code>is</code> but I wasn&apos;t so pleased with the internals and wanted something that worked without <code>is</code>, so I created this (in case you find that helpful): <a href="https://github.com/helins/mprop.cljc" target="_blank">https://github.com/helins/mprop.cljc</a></z><z id="t1623951091" t="colinkahn Cool, I’ll check this out!"><y>#</y><d>2021-06-17</d><h>17:31</h><r>colinkahn</r>Cool, I’ll check this out!</z><z id="t1646768017" t="dnolen maybe I&apos;m not looking in the right places - but there seems to be not much information about writing customer generators?"><y>#</y><d>2022-03-08</d><h>19:33</h><w>dnolen</w>maybe I&apos;m not looking in the right places - but there seems to be not much information about writing customer generators?</z><z id="t1646768070" t="dnolen Not knowing that much about custom generators, after auditing some repos I have a trivial stateful generator for producing commands to drive some test"><y>#</y><d>2022-03-08</d><h>19:34</h><w>dnolen</w>Not knowing that much about custom generators, after auditing some repos I have a trivial stateful generator for producing commands to drive some test</z><z id="t1646768088" t="dnolen it works by recursion by feeding the augmented state to produce the next command"><y>#</y><d>2022-03-08</d><h>19:34</h><w>dnolen</w>it works by recursion by feeding the augmented state to produce the next command</z><z id="t1646768117" t="dnolen by doing so then it becomes easy to make the command sequence more meaningful, by i.e. decreasing the frequency that the last command will be chosen, etc. etc."><y>#</y><d>2022-03-08</d><h>19:35</h><w>dnolen</w>by doing so then it becomes easy to make the command sequence more meaningful, by i.e. decreasing the frequency that the last command will be chosen, etc. etc.</z><z id="t1646768146" t="dnolen but before proceeding any further I did a quick check (ba-dum) and of course it did not shrink"><y>#</y><d>2022-03-08</d><h>19:35</h><w>dnolen</w>but before proceeding any further I did a quick check (ba-dum) and of course it did not shrink</z><z id="t1646768195" t="hiredman instead of generating a single command generate a list of commands, and statefully process each list, with a fresh state for each list"><y>#</y><d>2022-03-08</d><h>19:36</h><w>hiredman</w>instead of generating a single command generate a list of commands, and statefully process each list, with a fresh state for each list</z><z id="t1646768266" t="hiredman basically you want to generate programs, instead of generating a single command and building programs out of the generated command"><y>#</y><d>2022-03-08</d><h>19:37</h><w>hiredman</w>basically you want to generate programs, instead of generating a single command and building programs out of the generated command</z><z id="t1646768280" t="hiredman if you generate a whole program then the whole program can shrink"><y>#</y><d>2022-03-08</d><h>19:38</h><w>hiredman</w>if you generate a whole program then the whole program can shrink</z><z id="t1646768302" t="dnolen the recursive thing does indeed produce a list of commands - but that is what doesn&apos;t shrink"><y>#</y><d>2022-03-08</d><h>19:38</h><w>dnolen</w>the recursive thing does indeed produce a list of commands - but that is what doesn&apos;t shrink</z><z id="t1646768326" t="hiredman ah, I thought you where doing the recursive thing outside of generating"><y>#</y><d>2022-03-08</d><h>19:38</h><w>hiredman</w>ah, I thought you where doing the recursive thing outside of generating</z><z id="t1646768369" t="dnolen looking at the built in generators - it appears that shrinking might be a bit manual"><y>#</y><d>2022-03-08</d><h>19:39</h><w>dnolen</w>looking at the built in generators - it appears that shrinking might be a bit manual</z><z id="t1646768377" t="dnolen like you have to make the shrink tree yourself?"><y>#</y><d>2022-03-08</d><h>19:39</h><w>dnolen</w>like you have to make the shrink tree yourself?</z><z id="t1646768383" t="hiredman there is https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1641 which might help"><y>#</y><d>2022-03-08</d><h>19:39</h><w>hiredman</w>there is <a href="https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1641" target="_blank">https://github.com/clojure/test.check/blob/master/src/main/clojure/clojure/test/check/generators.cljc#L1641</a> which might help</z><z id="t1646768427" t="hiredman I&apos;ve never had to manually do shrinking"><y>#</y><d>2022-03-08</d><h>19:40</h><w>hiredman</w>I&apos;ve never had to manually do shrinking</z><z id="t1646768470" t="hiredman I usually generate programs then feed them into some interpreter, and that interpret might no-op some commands in certain states, instead of feeding the state through the generator"><y>#</y><d>2022-03-08</d><h>19:41</h><w>hiredman</w>I usually generate programs then feed them into some interpreter, and that interpret might no-op some commands in certain states, instead of feeding the state through the generator</z><z id="t1646768473" t="dnolen hrm really, in the (repo docs) the first thing that it says is that if you build a stateful generator via bind - it will not shrink very well"><y>#</y><d>2022-03-08</d><h>19:41</h><w>dnolen</w>hrm really, in the (repo docs) the first thing that it says is that if you build a stateful generator via bind - it will not shrink very well</z><z id="t1646768687" t="hiredman oh yeah, I&apos;ve had to massage things around to get good shrinking"><y>#</y><d>2022-03-08</d><h>19:44</h><w>hiredman</w>oh yeah, I&apos;ve had to massage things around to get good shrinking</z><z id="t1646768712" t="hiredman because bind is opaque"><y>#</y><d>2022-03-08</d><h>19:45</h><w>hiredman</w>because bind is opaque</z><z id="t1646768776" t="gfredericks I feel like [:attrs {:href &quot;/_/_/users/U050B88UR&quot;}] described this to me at a conference like five years ago"><y>#</y><d>2022-03-08</d><h>19:46</h><w>gfredericks</w>I feel like <a>@dnolen</a> described this to me at a conference like five years ago</z><z id="t1646768796" t="hiredman I think anything other than bind being a simple maping kind of operation (take a vector of numbers and produce a java.util.Date object) isn&apos;t going to shrink well"><y>#</y><d>2022-03-08</d><h>19:46</h><w>hiredman</w>I think anything other than bind being a simple maping kind of operation (take a vector of numbers and produce a java.util.Date object) isn&apos;t going to shrink well</z><z id="t1646768889" t="dnolen [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] haha we probably talked about it - but now I actually have a reason to use this approach at work"><y>#</y><d>2022-03-08</d><h>19:48</h><w>dnolen</w><a>@gfredericks</a> haha we probably talked about it - but now I actually have a reason to use this approach at work</z><z id="t1646768892" t="gfredericks I feel like maybe the best thought I had on this was that it&apos;d be useful to have a general framework for this style of generator Something that could be implemented once against the lower level primitives"><y>#</y><d>2022-03-08</d><h>19:48</h><w>gfredericks</w>I feel like maybe the best thought I had on this was that it&apos;d be useful to have a general framework for this style of generator

Something that could be implemented once against the lower level primitives</z><z id="t1646768955" t="dnolen only tangentially related but I found this interesting paper - https://proper-testing.github.io/papers/icst2018.pdf"><y>#</y><d>2022-03-08</d><h>19:49</h><w>dnolen</w>only tangentially related but I found this interesting paper - <a href="https://proper-testing.github.io/papers/icst2018.pdf" target="_blank">https://proper-testing.github.io/papers/icst2018.pdf</a></z><z id="t1646768959" t="gfredericks I assume the style is that you have a model of the state of the system at a given time, and can generate commands based on the current state, and each command transforms the current state to the next state?"><y>#</y><d>2022-03-08</d><h>19:49</h><w>gfredericks</w>I assume the style is that you have a model of the state of the system at a given time, and can generate commands based on the current state, and each command transforms the current state to the next state?</z><z id="t1646768992" t="dnolen PropEr is a open source Erlang framework for testing stateful systems, and they have been implementing things to make it easier to test stateful system"><y>#</y><d>2022-03-08</d><h>19:49</h><w>dnolen</w>PropEr is a open source Erlang framework for testing stateful systems, and they have been implementing things to make it easier to test stateful system</z><z id="t1646769014" t="dnolen both by providing a framework, but also integrated simulated annealing to control the search"><y>#</y><d>2022-03-08</d><h>19:50</h><w>dnolen</w>both by providing a framework, but also integrated simulated annealing to control the search</z><z id="t1646769032" t="hiredman I&apos;ve done that sort of thing, but without feeding the state through command generation, and then ignoring invalid commands in the interpreter"><y>#</y><d>2022-03-08</d><h>19:50</h><w>hiredman</w>I&apos;ve done that sort of thing, but without feeding the state through command generation, and  then ignoring invalid commands in the interpreter</z><z id="t1646769060" t="dnolen I don&apos;t really care one way or another about whether test-check provides such affordances"><y>#</y><d>2022-03-08</d><h>19:51</h><w>dnolen</w>I don&apos;t really care one way or another about whether test-check provides such affordances</z><z id="t1646769086" t="dnolen but rather some guidance on writing custom generators that might be influenced by above tactics"><y>#</y><d>2022-03-08</d><h>19:51</h><w>dnolen</w>but rather some guidance on writing custom generators that might be influenced by above tactics</z><z id="t1646769125" t="dnolen so if I recur on this generator, do I need to manually populate the rose tree w/ children for the previous state"><y>#</y><d>2022-03-08</d><h>19:52</h><w>dnolen</w>so if I recur on this generator, do I need to manually populate the rose tree w/ children for the previous state</z><z id="t1646769128" t="dnolen so it can shrink later?"><y>#</y><d>2022-03-08</d><h>19:52</h><w>dnolen</w>so it can shrink later?</z><z id="t1646769239" t="gfredericks Custom shrinks aren&apos;t available at all in the main user facing api I don&apos;t think"><y>#</y><d>2022-03-08</d><h>19:53</h><w>gfredericks</w>Custom shrinks aren&apos;t available at all in the main user facing api I don&apos;t think</z><z id="t1646769267" t="dnolen yes I know that 🙂"><y>#</y><d>2022-03-08</d><h>19:54</h><w>dnolen</w>yes I know that <b>🙂</b></z><z id="t1646769305" t="dnolen but the non-doc&apos;ed but not private internal helpers can be used as far as I can tell (to accomplish the goal, not future-proof)"><y>#</y><d>2022-03-08</d><h>19:55</h><w>dnolen</w>but the non-doc&apos;ed but not private internal helpers can be used as far as I can tell (to accomplish the goal, not future-proof)</z><z id="t1646769323" t="gfredericks actually"><y>#</y><d>2022-03-08</d><h>19:55</h><w>gfredericks</w>actually</z><z id="t1646769421" t="gfredericks By &quot;manually popular the rose tree&quot; do you mean something like the haskell quickcheck api where you provide a function X -&gt; [X] X being a list of commands"><y>#</y><d>2022-03-08</d><h>19:57</h><w>gfredericks</w>By &quot;manually popular the rose tree&quot; do you mean something like the haskell quickcheck api where you provide a function X -&gt; [X]

X being a list of commands</z><z id="t1646769434" t="dnolen (oh yeah, re: using test-check, I think that was about testing stateful UIs - barely remember that so long ago)"><y>#</y><d>2022-03-08</d><h>19:57</h><w>dnolen</w>(oh yeah, re: using test-check, I think that was about testing stateful UIs - barely remember that so long ago)</z><z id="t1646769477" t="dnolen [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] can you not just gen-fmap and create new rose w/ what you know should be the children?"><y>#</y><d>2022-03-08</d><h>19:57</h><w>dnolen</w><a>@gfredericks</a> can you not just <code>gen-fmap</code> and create new rose w/ what you know should be the children?</z><z id="t1646769485" t="gfredericks You can"><y>#</y><d>2022-03-08</d><h>19:58</h><w>gfredericks</w>You can</z><z id="t1646769539" t="Alex Miller (Clojure team) if you build out of fmap and bind, it will shrink"><y>#</y><d>2022-03-08</d><h>19:58</h><w>Alex Miller (Clojure team)</w>if you build out of fmap and bind, it will shrink</z><z id="t1646769647" t="Alex Miller (Clojure team) right? looks at gfredericks"><y>#</y><d>2022-03-08</d><h>20:00</h><w>Alex Miller (Clojure team)</w>right? looks at gfredericks</z><z id="t1646769697" t="gfredericks This kind of thing can definitely shrink, but often it&apos;s degenerate"><y>#</y><d>2022-03-08</d><h>20:01</h><w>gfredericks</w>This kind of thing can definitely shrink,  but often it&apos;s degenerate</z><z id="t1646769703" t="gfredericks If you generate 200 commands"><y>#</y><d>2022-03-08</d><h>20:01</h><w>gfredericks</w>If you generate 200 commands</z><z id="t1646769719" t="gfredericks And each is logically dependent on all the earlier ones"><y>#</y><d>2022-03-08</d><h>20:01</h><w>gfredericks</w>And each is logically dependent on all the earlier ones</z><z id="t1646769743" t="gfredericks Then shrinking command #7 invalidates the other 293 of them"><y>#</y><d>2022-03-08</d><h>20:02</h><w>gfredericks</w>Then shrinking command #7 invalidates the other 293 of them</z><z id="t1646769775" t="gfredericks So they have to be replaced with freshly generated commands based on the new state after the new command 7"><y>#</y><d>2022-03-08</d><h>20:02</h><w>gfredericks</w>So they have to be replaced with freshly generated commands based on the new state after the new command 7</z><z id="t1646769793" t="gfredericks Because TC can&apos;t do better than that generically"><y>#</y><d>2022-03-08</d><h>20:03</h><w>gfredericks</w>Because TC can&apos;t do better than that generically</z><z id="t1646769832" t="gfredericks But dnolen with his domain knowledge can describe more particularly when it&apos;s valid to shrink or delete intermediate commands"><y>#</y><d>2022-03-08</d><h>20:03</h><w>gfredericks</w>But dnolen with his domain knowledge can describe more particularly when it&apos;s valid to shrink or delete intermediate commands</z><z id="t1646769840" t="gfredericks And so can get much better results"><y>#</y><d>2022-03-08</d><h>20:04</h><w>gfredericks</w>And so can get much better results</z><z id="t1646769847" t="Alex Miller (Clojure team) :thumbsup:"><y>#</y><d>2022-03-08</d><h>20:04</h><w>Alex Miller (Clojure team)</w><b>:thumbsup:</b></z><z id="t1646769904" t="gfredericks So the choice is A) add a new feature for this situation that lets users express that domain knowledge B) dnolen does this particular case by hand"><y>#</y><d>2022-03-08</d><h>20:05</h><w>gfredericks</w>So the choice is

A) add a new feature for this situation that lets users express that domain knowledge
B) dnolen does this particular case by hand</z><z id="t1646769914" t="gfredericks (as I see it)"><y>#</y><d>2022-03-08</d><h>20:05</h><w>gfredericks</w>(as I see it)</z><z id="t1646769963" t="gfredericks Sometimes you can get by with tricks like this one https://clojurians.slack.com/archives/C0JKW8K62/p1646769032795009"><y>#</y><d>2022-03-08</d><h>20:06</h><w>gfredericks</w>Sometimes you can get by with tricks like this one <a href="https://clojurians.slack.com/archives/C0JKW8K62/p1646769032795009" target="_blank">https://clojurians.slack.com/archives/C0JKW8K62/p1646769032795009</a></z><z id="t1646770040" t="gfredericks Writing your own shrink tree can be laborious because it&apos;s hard to take advantage of the built in shrinking for the atomic types you&apos;re using"><y>#</y><d>2022-03-08</d><h>20:07</h><w>gfredericks</w>Writing your own shrink tree can be laborious because it&apos;s hard to take advantage of the built in shrinking for the atomic types you&apos;re using</z><z id="t1646770247" t="gfredericks I also had an idea for a user-enhanced shrinking, but not sure that&apos;s a comprehensive solution here"><y>#</y><d>2022-03-08</d><h>20:10</h><w>gfredericks</w>I also had an idea for a user-enhanced shrinking, but not sure that&apos;s a comprehensive solution here</z><z id="t1646770406" t="dnolen [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] design is hard ... I&apos;m curious as to why the shrinking stuff that&apos;s there is not just exposed and documented"><y>#</y><d>2022-03-08</d><h>20:13</h><w>dnolen</w><a>@gfredericks</a> design is hard ... I&apos;m curious as to why the shrinking stuff that&apos;s there is not just exposed and documented</z><z id="t1646770434" t="dnolen it seemed like one of the novel things about test-check was that shrinking was decoupled - but then somehow not a part of the api"><y>#</y><d>2022-03-08</d><h>20:13</h><w>dnolen</w>it seemed like one of the novel things about test-check was that shrinking was decoupled - but then somehow not a part of the api</z><z id="t1646770552" t="gfredericks I don&apos;t think that was too intentional I mean you could ask Reid if you want historical context I largely took the approach of not changing things without a really strong reason So I think it&apos;s totally valid to suggest exposing it"><y>#</y><d>2022-03-08</d><h>20:15</h><w>gfredericks</w>I don&apos;t think that was too intentional

I mean you could ask Reid if you want historical context

I largely took the approach of not changing things without a really strong reason

So I think it&apos;s totally valid to suggest exposing it</z><z id="t1646770779" t="gfredericks I think the hope was that the built in shrinking was high enough quality that users wouldn&apos;t have to think about it Probably not realistic, but it works much better than the QuickCheck approach I think"><y>#</y><d>2022-03-08</d><h>20:19</h><w>gfredericks</w>I think the hope was that the built in shrinking was high enough quality that users wouldn&apos;t have to think about it

Probably not realistic, but it works much better than the QuickCheck approach I think</z><z id="t1646770867" t="dnolen I think you don&apos;t really hit this problem until you want to write stateful generators"><y>#</y><d>2022-03-08</d><h>20:21</h><w>dnolen</w>I think you don&apos;t really hit this problem until you want to write stateful generators</z><z id="t1646770893" t="dnolen then the domain starts to dominate and the defaults just aren&apos;t that useful - because it&apos;s mostly junk"><y>#</y><d>2022-03-08</d><h>20:21</h><w>dnolen</w>then the domain starts to dominate and the defaults just aren&apos;t that useful - because it&apos;s mostly junk</z><z id="t1646771001" t="dnolen I will continue poke around at what&apos;s there for now - still barely know how to do anything so will probably say marginally more intelligent things later 😉"><y>#</y><d>2022-03-08</d><h>20:23</h><w>dnolen</w>I will continue poke around at what&apos;s there for now - still barely know how to do anything so will probably say marginally more intelligent things later <b>😉</b></z><z id="t1646771021" t="gfredericks Oh hey, I wrote something about this"><y>#</y><d>2022-03-08</d><h>20:23</h><w>gfredericks</w>Oh hey, I wrote something about this</z><z id="t1646771070" t="gfredericks https://github.com/clojure/test.check/blob/master/doc/old-confluence-notes.md#stateful-generators"><y>#</y><d>2022-03-08</d><h>20:24</h><w>gfredericks</w><a href="https://github.com/clojure/test.check/blob/master/doc/old-confluence-notes.md#stateful-generators" target="_blank">https://github.com/clojure/test.check/blob/master/doc/old-confluence-notes.md#stateful-generators</a></z><z id="t1646771083" t="dnolen yes already read that 🙂"><y>#</y><d>2022-03-08</d><h>20:24</h><w>dnolen</w>yes already read that <b>🙂</b></z><z id="t1646771086" t="dnolen several times"><y>#</y><d>2022-03-08</d><h>20:24</h><w>dnolen</w>several times</z><z id="t1646771092" t="gfredericks Hah"><y>#</y><d>2022-03-08</d><h>20:24</h><w>gfredericks</w>Hah</z><z id="t1646771131" t="hiredman it is iterate (unfold) for generators"><y>#</y><d>2022-03-08</d><h>20:25</h><w>hiredman</w>it is iterate (unfold) for generators</z><z id="t1646771237" t="gfredericks [:attrs {:href &quot;/_/_/users/U050B88UR&quot;}] does the idea there under &quot;general problem&quot; seem like it would cover your use?"><y>#</y><d>2022-03-08</d><h>20:27</h><w>gfredericks</w><a>@dnolen</a> does the idea there under &quot;general problem&quot; seem like it would cover your use?</z><z id="t1646771415" t="hiredman not entirely sure, but it seems like https://github.com/advancedtelematic/quickcheck-state-machine takes the approach of generating events without regard to state, but has you define preconditions which say if some event + state is well formed"><y>#</y><d>2022-03-08</d><h>20:30</h><w>hiredman</w>not entirely sure, but it seems like <a href="https://github.com/advancedtelematic/quickcheck-state-machine" target="_blank">https://github.com/advancedtelematic/quickcheck-state-machine</a> takes the approach of generating events without regard to state, but has you define preconditions which say if some event + state is well formed</z><z id="t1646771522" t="hiredman (I can tell the precondition is a thing, but my haskell is not good enough to immediate tell if the precondition stuff is somehow used as part of generation or just as a filter afterwards)"><y>#</y><d>2022-03-08</d><h>20:32</h><w>hiredman</w>(I can tell the precondition is a thing, but my haskell is not good enough to immediate tell if the precondition stuff is somehow used as part of generation or just as a filter afterwards)</z><z id="t1646771575" t="dnolen basically the problem that I&apos;ve encountered so far is as [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] alluded - steps depend on previous steps"><y>#</y><d>2022-03-08</d><h>20:32</h><w>dnolen</w>basically the problem that I&apos;ve encountered so far is as <a>@gfredericks</a> alluded - steps depend on previous steps</z><z id="t1646771579" t="hiredman &gt; The pre-conditions are used while generating programs (lists of actions)."><y>#</y><d>2022-03-08</d><h>20:32</h><w>hiredman</w>&gt; The pre-conditions are used while generating programs (lists of actions).</z><z id="t1646771604" t="dnolen as the command grows expecting to randomly line anything up is unlikely"><y>#</y><d>2022-03-08</d><h>20:33</h><w>dnolen</w>as the command grows expecting to randomly line anything up is unlikely</z><z id="t1646771630" t="dnolen instead we want to look at the previous state to make intelligent but not totally predetermined steps"><y>#</y><d>2022-03-08</d><h>20:33</h><w>dnolen</w>instead we want to look at the previous state to make intelligent but not totally predetermined steps</z><z id="t1646771642" t="dnolen at the same time, if something is found, we want to it to shrink"><y>#</y><d>2022-03-08</d><h>20:34</h><w>dnolen</w>at the same time, if something is found, we want to it to shrink</z><z id="t1646771925" t="dnolen ok manually managing the rose tree seems like it leads to better results here"><y>#</y><d>2022-03-08</d><h>20:38</h><w>dnolen</w>ok manually managing the rose tree seems like it leads to better results here</z><z id="t1646771995" t="dnolen [:attrs {:href &quot;/_/_/users/U0GN0S72R&quot;}] I do see that one irritation w/ the rose tree versions is that mixing things (on accident) leads to very cryptic problems"><y>#</y><d>2022-03-08</d><h>20:39</h><w>dnolen</w><a>@gfredericks</a> I do see that one irritation w/ the rose tree versions is that mixing things (on accident) leads to very cryptic problems</z><z id="t1646773333" t="hiredman Another option would be, given a state machine description S, generate a vector of numbers, and then in a map bind, from your start state, take the sorted possible transitions, mod the first integer and take the nth, then iterate that for each state and integer"><y>#</y><d>2022-03-08</d><h>21:02</h><w>hiredman</w>Another option would be, given a state machine description S, generate a vector of numbers, and then in a map bind, from your start state, take the sorted possible transitions, mod the first integer and take the nth, then iterate that for each state and integer</z><z id="t1646773502" t="hiredman Which would shrink based on vectors and int generators, which might not be the most intelligent shrinking, but avoids recursive generation passing the state through"><y>#</y><d>2022-03-08</d><h>21:05</h><w>hiredman</w>Which would shrink based on vectors and int generators, which might not be the most intelligent shrinking, but avoids recursive generation passing the state through</z><z id="t1646773566" t="dnolen hrm, the problem has more constraints then it may appear, so I don&apos;t see that approach as being less cumbersome?"><y>#</y><d>2022-03-08</d><h>21:06</h><w>dnolen</w>hrm, the problem has more constraints then it may appear, so I don&apos;t see that approach as being less cumbersome?</z><z id="t1646773585" t="dnolen in truth what I&apos;m interested in is simulation generation"><y>#</y><d>2022-03-08</d><h>21:06</h><w>dnolen</w>in truth what I&apos;m interested in is simulation generation</z><z id="t1646773593" t="dnolen that is there is some actor A, and then they do something"><y>#</y><d>2022-03-08</d><h>21:06</h><w>dnolen</w>that is there is some actor A, and then they do something</z><z id="t1646773605" t="dnolen well then maybe there is corresponding action for actor B"><y>#</y><d>2022-03-08</d><h>21:06</h><w>dnolen</w>well then maybe there is corresponding action for actor B</z><z id="t1646773614" t="dnolen and then also a corresponding action for actor C"><y>#</y><d>2022-03-08</d><h>21:06</h><w>dnolen</w>and then also a corresponding action for actor C</z><z id="t1646773614" t="hiredman Sure, and I guess you&apos;d get shrinking, but the behavior would be very odd"><y>#</y><d>2022-03-08</d><h>21:06</h><w>hiredman</w>Sure, and I guess you&apos;d get shrinking, but the behavior would be very odd</z><z id="t1646773693" t="dnolen because frequencies is dynamic - I&apos;m also interested in using the state at each step to dynamically bind new likelihoods"><y>#</y><d>2022-03-08</d><h>21:08</h><w>dnolen</w>because <code>frequencies</code> is dynamic - I&apos;m also interested in using the state at each step to dynamically bind new likelihoods</z><z id="t1646773715" t="dnolen so the tools in test.check at the moment seem sufficient to accomplish what I want, without going elsewhere"><y>#</y><d>2022-03-08</d><h>21:08</h><w>dnolen</w>so the tools in test.check at the moment seem sufficient to accomplish what I want, without going elsewhere</z><z id="t1646773762" t="dnolen I think probably only the command choice function (which generates the liklihoods and the command arguments) will be of any real interest"><y>#</y><d>2022-03-08</d><h>21:09</h><w>dnolen</w>I think probably only the command choice function (which generates the liklihoods and the command arguments) will be of any real interest</z><z id="t1646773767" t="dnolen the rest will probably be boring"><y>#</y><d>2022-03-08</d><h>21:09</h><w>dnolen</w>the rest will probably be boring</z><z id="t1646773804" t="Alex Miller (Clojure team) sounds like you are really doing simulation testing. we did several projects like this at Cognitect with Simulant (and other Simulant like things). there are a couple other open source things we made for those"><y>#</y><d>2022-03-08</d><h>21:10</h><w>Alex Miller (Clojure team)</w>sounds like you are really doing simulation testing. we did several projects like this at Cognitect with Simulant (and other Simulant like things). there are a couple other open source things we made for those</z><z id="t1646773820" t="Alex Miller (Clojure team) https://github.com/candera/causatum"><y>#</y><d>2022-03-08</d><h>21:10</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/candera/causatum" target="_blank">https://github.com/candera/causatum</a></z><z id="t1646773952" t="dnolen but we are not actually testing a whole system - we don&apos;t care about time"><y>#</y><d>2022-03-08</d><h>21:12</h><w>dnolen</w>but we are not actually testing a whole system - we don&apos;t care about time</z><z id="t1646773966" t="dnolen and we&apos;re going to drive anything that would be external"><y>#</y><d>2022-03-08</d><h>21:12</h><w>dnolen</w>and we&apos;re going to drive anything that would be external</z><z id="t1646773969" t="dnolen we don&apos;t even care about concurrency"><y>#</y><d>2022-03-08</d><h>21:12</h><w>dnolen</w>we don&apos;t even care about concurrency</z><z id="t1646773972" t="hiredman state is time 🙂"><y>#</y><d>2022-03-08</d><h>21:12</h><w>hiredman</w>state is time <b>🙂</b></z><z id="t1646773992" t="dnolen we really don&apos;t care about time"><y>#</y><d>2022-03-08</d><h>21:13</h><w>dnolen</w>we really don&apos;t care about time</z><z id="t1646774028" t="dnolen we have a purely functional system - for what we want to test - no externalities are of interest"><y>#</y><d>2022-03-08</d><h>21:13</h><w>dnolen</w>we have a purely functional system - for what we want to test - no externalities are of interest</z><z id="t1646774059" t="dnolen value to value only - including all storage of interest (Datomic and custom data structures for cryptographic purposes)"><y>#</y><d>2022-03-08</d><h>21:14</h><w>dnolen</w>value to value only - including all storage of interest (Datomic and custom data structures for cryptographic purposes)</z><z id="t1646774073" t="dnolen thus test.check is attractive"><y>#</y><d>2022-03-08</d><h>21:14</h><w>dnolen</w>thus test.check is attractive</z><z id="t1646774081" t="hiredman sure, but if you have a succession of states, that is a ticking clock (how things like event clocks work)"><y>#</y><d>2022-03-08</d><h>21:14</h><w>hiredman</w>sure, but if you have a succession of states, that is a ticking clock (how things like event clocks work)</z><z id="t1646774098" t="dnolen but it&apos;s not of any interest at all"><y>#</y><d>2022-03-08</d><h>21:14</h><w>dnolen</w>but it&apos;s not of any interest at all</z><z id="t1646774111" t="dnolen in fact what we are interested is only the cryptographic results at the end of sequence"><y>#</y><d>2022-03-08</d><h>21:15</h><w>dnolen</w>in fact what we are interested is only the cryptographic results at the end of sequence</z><z id="t1646774119" t="dnolen they must hold - nothing else really matters"><y>#</y><d>2022-03-08</d><h>21:15</h><w>dnolen</w>they must hold - nothing else really matters</z><z id="t1646774481" t="dnolen the key is actually we are in fact looking for the shortest sequences that would break some invariant - I don&apos;t think the simulation stuff can do that [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] ?"><y>#</y><d>2022-03-08</d><h>21:21</h><w>dnolen</w>the key is actually we are in fact looking for the shortest sequences that would break some invariant - I don&apos;t think the simulation stuff can do that <a>@alexmiller</a> ?</z><z id="t1646774739" t="Alex Miller (Clojure team) no, that&apos;s different use case"><y>#</y><d>2022-03-08</d><h>21:25</h><w>Alex Miller (Clojure team)</w>no, that&apos;s different use case</z><z id="t1646788595" t="hiredman Came across this http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/ which is basically a retread (pretread?) of the discussion but includes some code and custom shrinking stuff"><y>#</y><d>2022-03-09</d><h>01:16</h><w>hiredman</w>Came across this <a href="http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/" target="_blank">http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/</a> which is basically a retread (pretread?) of the discussion but includes some code and custom shrinking stuff</z><z id="t1646846008" t="dnolen [:attrs {:href &quot;/_/_/users/U0NCTKEV8&quot;}] that&apos;s a nice write up!"><y>#</y><d>2022-03-09</d><h>17:13</h><w>dnolen</w><a>@hiredman</a> that&apos;s a nice write up!</z><z id="t1646846012" t="dnolen thanks"><y>#</y><d>2022-03-09</d><h>17:13</h><w>dnolen</w>thanks</z><z id="t1648041706" t="jjttjj I want to make a generator for a string of an exact length where only certain letters are allowed. Is there an obvious better way than this that I&apos;m missing: (gen/generate (gen/fmap (fn [x] (apply str x)) (apply gen/tuple (repeat 10 (gen/elements (mapcat (juxt identity str/upper-case) &quot;abcdef&quot;))))))"><y>#</y><d>2022-03-23</d><h>13:21</h><w>jjttjj</w>I want to make a generator for a string of an exact length where only certain letters are allowed. Is there an obvious better way than this that I&apos;m missing:
<pre>(gen/generate
  (gen/fmap (fn [x] (apply str x))
    (apply gen/tuple
      (repeat 10
        (gen/elements
          (mapcat (juxt identity str/upper-case) &quot;abcdef&quot;))))))</pre></z><z id="t1648042342" t="gfredericks test.chuck can make a generator from a regex"><y>#</y><d>2022-03-23</d><h>13:32</h><w>gfredericks</w>test.chuck can make a generator from a regex</z><z id="t1652249862" t="Oliver George Hello. I&apos;m trying to get this going: http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/ There&apos;s a repo which works https://github.com/guilespi/fsm-test-check/ But when I update the deps (clojure 1.6.0-&gt; 1.11.1 &amp; test check 0.7.0-&gt;1.1.1) I get this error: class clojure.lang.PersistentVector cannot be cast to class clojure.test.check.rose_tree.RoseTree (clojure.lang.PersistentVector is in unnamed module of loader &apos;app&apos;; clojure.test.check.rose_tree.RoseTree is in unnamed module of loader clojure.lang.DynamicClassLoader @7d5508e0)"><y>#</y><d>2022-05-11</d><h>06:17</h><w>Oliver George</w>Hello.  I&apos;m trying to get this going: <a href="http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/" target="_blank">http://blog.guillermowinkler.com/blog/2015/04/12/verifying-state-machine-behavior-using-test-dot-check/</a>

There&apos;s a repo which works
<a href="https://github.com/guilespi/fsm-test-check/" target="_blank">https://github.com/guilespi/fsm-test-check/</a>

But when I update the deps (clojure 1.6.0-&gt; 1.11.1 &amp; test check 0.7.0-&gt;1.1.1)  I get this error:
class clojure.lang.PersistentVector cannot be cast to class clojure.test.check.rose_tree.RoseTree (clojure.lang.PersistentVector is in unnamed module of loader &apos;app&apos;; clojure.test.check.rose_tree.RoseTree is in unnamed module of loader clojure.lang.DynamicClassLoader @7d5508e0)</z><z id="t1652250445" t="hiredman https://github.com/clojure/test.check/commit/d2378b37f1185cc20efc2dd364042521b9abc30e"><y>#</y><d>2022-05-11</d><h>06:27</h><w>hiredman</w><a href="https://github.com/clojure/test.check/commit/d2378b37f1185cc20efc2dd364042521b9abc30e" target="_blank">https://github.com/clojure/test.check/commit/d2378b37f1185cc20efc2dd364042521b9abc30e</a></z><z id="t1652252497" t="Oliver George Thanks for the link. I think the implication is the code is old and the api has changed. I&apos;ll look more closely."><y>#</y><d>2022-05-11</d><h>07:01</h><w>Oliver George</w>Thanks for the link.  I think the implication is the code is old and the api has changed.  I&apos;ll look more closely.</z><z id="t1652258992" t="Oliver George Got it. Thanks."><y>#</y><d>2022-05-11</d><h>08:49</h><w>Oliver George</w>Got it.  Thanks.</z><z id="t1660326263" t="dnolen circling way back - we sorted out how to do stateful property based testing a way that suited our needs"><y>#</y><d>2022-08-12</d><h>17:44</h><w>dnolen</w>circling way back - we sorted out how to do stateful property based testing a way that suited our needs</z><z id="t1660326265" t="dnolen https://t.co/aIZX1W6ZLH"><y>#</y><d>2022-08-12</d><h>17:44</h><w>dnolen</w><a href="https://t.co/aIZX1W6ZLH" target="_blank">https://t.co/aIZX1W6ZLH</a></z><z id="t1660386149" t="teodorlu really exciting talk. I love how you connect data orientation, immutability and toy implementations. Thank you!"><y>#</y><d>2022-08-13</d><h>10:22</h><r>teodorlu</r>really exciting talk. I love how you connect data orientation, immutability and toy implementations. Thank you!</z><z id="t1660326321" t="dnolen getting a stateful generator w/ shrinking wasn’t so hard in the end after assessing what had been done before - we didn’t like the various non-symbolic things out there so we just wrote the ~120 lines ourselves"><y>#</y><d>2022-08-12</d><h>17:45</h><w>dnolen</w>getting a stateful generator w/ shrinking wasn’t so hard in the end after assessing what had been done before - we didn’t like the various non-symbolic things out there so we just wrote the ~120 lines ourselves</z><z id="t1660326363" t="dnolen one interesting thing was that it became obvious that search is a big issue - and lot of the literature is about pretty fancy stuff"><y>#</y><d>2022-08-12</d><h>17:46</h><w>dnolen</w>one interesting thing was that it became obvious that search is a big issue - and lot of the literature is about pretty fancy stuff</z><z id="t1660326402" t="dnolen one trick we employed that I think brings a lot of leverage is just bootstrap the initial world state so you don’t flounder in uninteresting spaces"><y>#</y><d>2022-08-12</d><h>17:46</h><w>dnolen</w>one trick we employed that I think brings a lot of leverage is just bootstrap the initial world state so you don’t flounder in uninteresting spaces</z><z id="t1660326434" t="dnolen maybe already covered by trivial unit tests (which never go very deep)"><y>#</y><d>2022-08-12</d><h>17:47</h><w>dnolen</w>maybe already covered by trivial unit tests (which never go very deep)</z><z id="t1661744467" t="Hugh Powell Is there any way to limit the number of shrinkages a failed test will do? On a fairly regular basis my REPL appears to hang, but I&apos;m pretty sure it&apos;s just taking a while to shrink. I&apos;d rather get a quicker response with a less than perfect shrink."><y>#</y><d>2022-08-29</d><h>03:41</h><w>Hugh Powell</w>Is there any way to limit the number of shrinkages a failed test will do? On a fairly regular basis my REPL appears to hang, but I&apos;m pretty sure it&apos;s just taking a while to shrink. I&apos;d rather get a quicker response with a less than perfect shrink.</z><z id="t1662068368" t="colinkahn I don&apos;t think anything built in. I&apos;ve made a &quot;liveliness&quot; reporter that will log the trial or shrink step the test is on so I get feedback. Also, judicious use of no-shrink around things can help."><y>#</y><d>2022-09-01</d><h>21:39</h><r>colinkahn</r>I don&apos;t think anything built in. I&apos;ve made a &quot;liveliness&quot; reporter that will log the trial or shrink step the test is on so I get feedback. Also, judicious use of no-shrink around things can help.</z><z id="t1662333518" t="Hugh Powell Aha, I didn&apos;t know about no-shrink , looks that should work for me. Thanks 🙇"><y>#</y><d>2022-09-04</d><h>23:18</h><r>Hugh Powell</r>Aha, I didn&apos;t know about <code>no-shrink</code>, looks that should work for me. Thanks <b>🙇</b></z><z id="t1662066726" t="Huahai what’s the syntax for generating a bigint without long in for-all ?"><y>#</y><d>2022-09-01</d><h>21:12</h><w>Huahai</w>what’s the syntax for generating a bigint without long in <code>for-all</code>?</z><z id="t1662130526" t="lread [:attrs {:href &quot;/_/_/users/U0A74MRCJ&quot;}] are you using size-bounded-bigint ? I find it a bit oddly named in that it does not always return BigInteger s. I’m not sure about for-all but you can use fmap to force all to BigInteger like so: (gen/sample (gen/fmap bigint gen/size-bounded-bigint)) ;; =&gt; (0N -41N -63N -58752N -421N -2818692N -6449877661N -111911828N 2341N 4730362N) Does that help at all?"><y>#</y><d>2022-09-02</d><h>14:55</h><w>lread</w><a>@huahaiy</a> are you using <code>size-bounded-bigint</code>?  I find it a bit oddly named in that it does not always return <code>BigInteger</code>s.  I’m not sure about <code>for-all</code> but you can use <code>fmap</code> to force all to <code>BigInteger</code> like so:
<pre>(gen/sample (gen/fmap bigint gen/size-bounded-bigint))
;; =&gt; (0N -41N -63N -58752N -421N -2818692N -6449877661N -111911828N 2341N 4730362N)</pre>
Does that help at all?</z><z id="t1662148017" t="Huahai Thanks. Yeah, it sometimes return longs. I just used such-that to fill them out."><y>#</y><d>2022-09-02</d><h>19:46</h><r>Huahai</r>Thanks. Yeah, it sometimes return longs. I just used <code>such-that</code> to fill them out.</z><z id="t1663931412" t="markgdawson Does anyone know a simple way to have test.check change one parameter more slowly than another? So for example, parameter B changes every test whilst parameter A changes only every 10 tests."><y>#</y><d>2022-09-23</d><h>11:10</h><w>markgdawson</w>Does anyone know a simple way to have test.check change one parameter more slowly than another? So for example, parameter B changes every test whilst parameter A changes only every 10 tests.</z><z id="t1663951128" t="colinkahn I don&apos;t know of any way to finely control generation per-test, but you could look at frequency"><y>#</y><d>2022-09-23</d><h>16:38</h><r>colinkahn</r>I don&apos;t know of any way to finely control generation per-test, but you could look at <code>frequency</code></z><z id="t1663951602" t="markgdawson Yeah, frequency isn&apos;t really what I&apos;m after here. What I&apos;d really like yo do is to spin up a system with generated config and then fire a request against the system. But the system is expensive to spin up, and I&apos;m happy with a small number of instances of it. So I want to bootstrap a single system, fire multiple samplings of the other params against it then move on to another generated system."><y>#</y><d>2022-09-23</d><h>16:46</h><r>markgdawson</r>Yeah, frequency isn&apos;t really what I&apos;m after here. What I&apos;d really like yo do is to spin up a system with generated config and then fire a request against the system. But the system is expensive to spin up, and I&apos;m happy with a small number of instances of it. So I want to bootstrap a single system, fire multiple samplings of the other params against it then move on to another generated system.</z><z id="t1663953165" t="colinkahn In that case I would write a test where your generator generators a collection that you can apply in loop over a single bootstrapped instance. I would make sure that you wrote it so it short circuits on the first failure. Shrinking might take a bit longer, but test check does a good job shrinking collections so you&apos;ll most likely end up just a vector of a single item."><y>#</y><d>2022-09-23</d><h>17:12</h><r>colinkahn</r>In that case I would write a test where your generator generators a collection that you can apply in loop over a single bootstrapped instance. I would make sure that you wrote it so it short circuits on the first failure. Shrinking might take a bit longer, but test check does a good job shrinking collections so you&apos;ll most likely end up just a vector of a single item.</z><z id="t1663953248" t="colinkahn There&apos;s also a trick to writing a collection generator that targets a certain size but shrinks to zero, I&apos;ll see if I can find it"><y>#</y><d>2022-09-23</d><h>17:14</h><r>colinkahn</r>There&apos;s also a trick to writing a collection generator that targets a certain size but shrinks to zero, I&apos;ll see if I can find it</z><z id="t1663953326" t="colinkahn https://clojurians.slack.com/archives/C0JKW8K62/p1601225845006100"><y>#</y><d>2022-09-23</d><h>17:15</h><r>colinkahn</r><a href="https://clojurians.slack.com/archives/C0JKW8K62/p1601225845006100" target="_blank">https://clojurians.slack.com/archives/C0JKW8K62/p1601225845006100</a></z><z id="t1663953836" t="markgdawson Ah, i see. I was worried this approach wouldn&apos;t point me at the exact failure scenario. But you&apos;re saying I could achieve that by having the collection of failing tests shrink to the failing one. Smart idea, I&apos;ll give it a go!!"><y>#</y><d>2022-09-23</d><h>17:23</h><r>markgdawson</r>Ah, i see. I was worried this approach wouldn&apos;t point me at the exact failure scenario. But you&apos;re saying I could achieve that by having the collection of failing tests shrink to the failing one. Smart idea, I&apos;ll give it a go!!</z><z id="t1663955119" t="colinkahn Yep. That generator function above will let you tune how many to start the collection with (it won&apos;t always be exact, so you&apos;ll have to play around to see what the resulting item counts are), while still shrinking towards zero."><y>#</y><d>2022-09-23</d><h>17:45</h><r>colinkahn</r>Yep. That generator function above will let you tune how many to start the collection with (it won&apos;t always be exact, so you&apos;ll have to play around to see what the resulting item counts are), while still shrinking towards zero.</z><z id="t1664541383" t="arohner Is there a way to get good logging about which property failed in a test? I have 4 conditions that all need to be true, so it would be nice to see after shrinking: “on the smallest failure, check 2 returned false”. I could println , but then it logs before shrinking"><y>#</y><d>2022-09-30</d><h>12:36</h><w>arohner</w>Is there a way to get good logging about which property failed in a test? I have 4 conditions that all need to be true, so it would be nice to see after shrinking: “on the smallest failure, check 2 returned false”. I could <code>println</code>, but then it logs before shrinking</z><z id="t1664542901" t="colinkahn You can use https://github.com/gfredericks/test.chuck which supports is assertions. That will report which ones failed."><y>#</y><d>2022-09-30</d><h>13:01</h><r>colinkahn</r>You can use <a href="https://github.com/gfredericks/test.chuck" target="_blank">https://github.com/gfredericks/test.chuck</a> which supports <code>is</code> assertions. That will report which ones failed.</z><z id="t1664542978" t="arohner oh very cool, thank you. I’m already using chuck, but didn’t know about that feature"><y>#</y><d>2022-09-30</d><h>13:02</h><r>arohner</r>oh very cool, thank you. I’m already using chuck, but didn’t know about that feature</z><z id="t1664807139" t="Brian Beckman SOLVED Hello, test.checkers. I am trying to understand the docs &amp; source for test.check.generators.size-bounded.bigint . It, and several of its sibling generators, mention a size parameter, but I don’t see where it’s defined, how I can inspect its value, how I can input new values for it, etc. Example from the source: #?(:clj (def ^{:added &quot;0.10.0&quot;} size-bounded-bigint ;; 2^(6*size) was chosen so that with size=200 the generator could ;; generate values larger than Double/MAX_VALUE &quot;Generates an integer (long or bigint) bounded exclusively by ±2^(6*size).&quot; (fmap (fn [[n negate? force-bigint?]] (cond-&gt; n negate? -&apos; ;; adds some exciting variety force-bigint? bigint)) (tuple size-bounded-bignat boolean boolean))))"><y>#</y><d>2022-10-03</d><h>14:25</h><w>Brian Beckman</w>SOLVED
Hello, test.checkers. I am trying to understand the docs &amp; source for <code>test.check.generators.size-bounded.bigint</code> . It, and several of its sibling generators, mention a <code>size</code> parameter, but I don’t see where it’s defined, how I can inspect its value, how I can input new values for it, etc. Example from the source:

<pre>#?(:clj
   (def ^{:added &quot;0.10.0&quot;} size-bounded-bigint
     ;; 2^(6*size) was chosen so that with size=200 the generator could
     ;; generate values larger than Double/MAX_VALUE
     &quot;Generates an integer (long or bigint) bounded exclusively by ±2^(6*size).&quot;
     (fmap (fn [[n negate? force-bigint?]]
             (cond-&gt; n
               negate? -&apos;
               ;; adds some exciting variety
               force-bigint? bigint))
           (tuple size-bounded-bignat
                  boolean
                  boolean))))</pre></z><z id="t1664807278" t="gfredericks [:attrs {:href &quot;/_/_/users/U03CZA5A539&quot;}] https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md"><y>#</y><d>2022-10-03</d><h>14:27</h><w>gfredericks</w><a>@bc.beckman</a> <a href="https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md" target="_blank">https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md</a></z><z id="t1666381305" t="Brian Beckman SELF-SOLVED Ha! My question had its own answer in it 🙂 It may not be stylish, but (tgen/fmap #(apply list %) (tgen/tuple …)) works. Hello test.checkers: I have a successful tgen/tuple generator, but it produces vectors and i want to produce lists. The following does not work: (tgen/fmap list (tgen/tuple …)) . I’m not surprised because the appropriate postprocessing would be something like (apply list (tgen/generate (tgen/tuple …))) , but I don’t want to exit the generators via something like tgen/generate and then produce a list, I want a generator that produces a tuple-like list. I’d be grateful for advice!"><y>#</y><d>2022-10-21</d><h>19:41</h><w>Brian Beckman</w>SELF-SOLVED

Ha! My question had its own answer in it <b>🙂</b> It may not be stylish, but <code>(tgen/fmap #(apply list %) (tgen/tuple …))</code> works.

Hello test.checkers: I have a successful <code>tgen/tuple</code> generator, but it produces vectors and i want to produce lists. The following does not work: <code>(tgen/fmap list (tgen/tuple …))</code> . I’m not surprised because the appropriate postprocessing would be something like <code>(apply list (tgen/generate (tgen/tuple …)))</code>, but I don’t want to exit the generators via something like <code>tgen/generate</code> and then produce a list, I want a generator that produces a tuple-like list. I’d be grateful for advice!</z><z id="t1666381495" t="Alex Miller (Clojure team) does list* work?"><y>#</y><d>2022-10-21</d><h>19:44</h><r>Alex Miller (Clojure team)</r>does <code>list*</code>  work?</z><z id="t1666381541" t="hiredman Or just comp apply list"><y>#</y><d>2022-10-21</d><h>19:45</h><r>hiredman</r>Or just comp apply list</z><z id="t1666381567" t="Alex Miller (Clojure team) there&apos;s not many good times to use list*, but this is maybe one of them"><y>#</y><d>2022-10-21</d><h>19:46</h><r>Alex Miller (Clojure team)</r>there&apos;s not many good times to use list*, but this is maybe one of them</z><z id="t1666381567" t="Brian Beckman you guys are fast :)"><y>#</y><d>2022-10-21</d><h>19:46</h><r>Brian Beckman</r>you guys are fast :)</z><z id="t1666381572" t="hiredman list* creates seqs 🤷"><y>#</y><d>2022-10-21</d><h>19:46</h><r>hiredman</r>list* creates seqs <b>🤷</b></z><z id="t1666381689" t="Brian Beckman my installation can’t find list* in either test.check.generators or in spec.gen.alpha"><y>#</y><d>2022-10-21</d><h>19:48</h><r>Brian Beckman</r>my installation can’t find list* in either test.check.generators or in spec.gen.alpha</z><z id="t1666381705" t="Brian Beckman but #(apply list #) works; (comp apply list) doesn’t quite because it only passes one arg to apply"><y>#</y><d>2022-10-21</d><h>19:48</h><r>Brian Beckman</r>but #(apply list #) works; (comp apply list) doesn’t quite because it only passes one arg to apply</z><z id="t1666381725" t="hiredman clojure.core/list*"><y>#</y><d>2022-10-21</d><h>19:48</h><r>hiredman</r>clojure.core/list*</z><z id="t1666381826" t="hiredman list* is sort of comp apply cons if cons did that"><y>#</y><d>2022-10-21</d><h>19:50</h><r>hiredman</r>list* is sort of comp apply cons if cons did that</z><z id="t1666382149" t="Brian Beckman list* seems stylish to me because it’s shorter than #(apply list %). The resulting seq is ok for my needs."><y>#</y><d>2022-10-21</d><h>19:55</h><r>Brian Beckman</r>list* seems stylish to me because it’s shorter than #(apply list %). The resulting seq is ok for my needs.</z><z id="t1666976982" t="Jared Langson If you&apos;re checking multiple related properties in one test, is better to use one = or multiple = ? Does which method you use affect shrinkage? tree/node-healthy? returns a boolean (defspec add-remove-node-maintains-health (prop/for-all [k gen/small-integer size gen/nat] ;; +1 to prevent removing nodes from empty trees (let [tree (make-integer-tree (+ 1 size))] (= (tree/node-healthy? (tree/node-add tree k)) (tree/node-healthy? (tree/node-remove-least tree)) (tree/node-healthy? (tree/node-remove-greatest tree)) (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree))))))) or (defspec add-remove-node-maintains-health (prop/for-all [k gen/small-integer size gen/nat] ;; +1 to prevent removing nodes from empty trees (let [tree (make-integer-tree (+ 1 size))] (= (tree/node-healthy? (tree/node-add tree k))) (= (tree/node-healthy? (tree/node-remove-least tree))) (= (tree/node-healthy? (tree/node-remove-greatest tree))) (= (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree))))))) or (defspec add-remove-node-maintains-health (prop/for-all [k gen/small-integer size gen/nat] ;; +1 to prevent removing nodes from empty trees (let [tree (make-integer-tree (+ 1 size))] (= (and (tree/node-healthy? (tree/node-add tree k)) (tree/node-healthy? (tree/node-remove-least tree)) (tree/node-healthy? (tree/node-remove-greatest tree)) (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree))))))))"><y>#</y><d>2022-10-28</d><h>17:09</h><w>Jared Langson</w>If you&apos;re checking multiple related properties in one test, is better to use one <code>=</code> or multiple <code>=</code>? Does which method you use affect shrinkage?  <code>tree/node-healthy?</code> returns a boolean

<pre>(defspec add-remove-node-maintains-health
  (prop/for-all [k gen/small-integer
                 size gen/nat]
    ;; +1 to prevent removing nodes from empty trees
    (let [tree (make-integer-tree (+ 1 size))]
      (=
        (tree/node-healthy? (tree/node-add tree k))
        (tree/node-healthy? (tree/node-remove-least tree))
        (tree/node-healthy? (tree/node-remove-greatest tree))
        (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree)))))))</pre>
or
<pre>(defspec add-remove-node-maintains-health
  (prop/for-all [k gen/small-integer
                 size gen/nat]
    ;; +1 to prevent removing nodes from empty trees
    (let [tree (make-integer-tree (+ 1 size))]
      (= (tree/node-healthy? (tree/node-add tree k)))
      (= (tree/node-healthy? (tree/node-remove-least tree)))
      (= (tree/node-healthy? (tree/node-remove-greatest tree)))
      (= (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree)))))))</pre>
or
<pre>(defspec add-remove-node-maintains-health
  (prop/for-all [k gen/small-integer
                 size gen/nat]
    ;; +1 to prevent removing nodes from empty trees
    (let [tree (make-integer-tree (+ 1 size))]
      (= (and
           (tree/node-healthy? (tree/node-add tree k))
           (tree/node-healthy? (tree/node-remove-least tree))
           (tree/node-healthy? (tree/node-remove-greatest tree))
           (tree/node-healthy? (-&gt;&gt; tree tree/node-random node/-k (tree/node-remove tree))))))))</pre></z><z id="t1666977830" t="hiredman doesn&apos;t matter"><y>#</y><d>2022-10-28</d><h>17:23</h><w>hiredman</w>doesn&apos;t matter</z><z id="t1666977851" t="Jared Langson Stylistically, is one preferred?"><y>#</y><d>2022-10-28</d><h>17:24</h><w>Jared Langson</w>Stylistically, is one preferred?</z><z id="t1666977872" t="hiredman the body of your property is basically just a predicate"><y>#</y><d>2022-10-28</d><h>17:24</h><w>hiredman</w>the body of your property is basically just a predicate</z><z id="t1666977913" t="hiredman and (= x) is always true"><y>#</y><d>2022-10-28</d><h>17:25</h><w>hiredman</w>and (= x) is always true</z><z id="t1666977921" t="dpsutton (= false) is true. And i’d worry if all of your predicates uniformly returned false and you misinterpreted this"><y>#</y><d>2022-10-28</d><h>17:25</h><w>dpsutton</w><code>(= false)</code> is true. And i’d worry if all of your predicates uniformly returned false and you misinterpreted this</z><z id="t1666977956" t="hiredman = doesn&apos;t do anything special"><y>#</y><d>2022-10-28</d><h>17:25</h><w>hiredman</w>= doesn&apos;t do anything special</z><z id="t1666977968" t="dpsutton (for the (= (pred) (pred) (pred))"><y>#</y><d>2022-10-28</d><h>17:26</h><w>dpsutton</w>(for the <code>(= (pred) (pred) (pred))</code></z><z id="t1666977968" t="hiredman so basically all 3 of your examples are bogus"><y>#</y><d>2022-10-28</d><h>17:26</h><w>hiredman</w>so basically all 3 of your examples are bogus</z><z id="t1666978033" t="hiredman the first sort of works, but will also report a success if all your node-healthy? calls return false"><y>#</y><d>2022-10-28</d><h>17:27</h><w>hiredman</w>the first sort of works, but will also report a success if all your node-healthy? calls return false</z><z id="t1666978049" t="hiredman the second always is a success"><y>#</y><d>2022-10-28</d><h>17:27</h><w>hiredman</w>the second always is a success</z><z id="t1666978061" t="hiredman and so is the third"><y>#</y><d>2022-10-28</d><h>17:27</h><w>hiredman</w>and so is the third</z><z id="t1666978154" t="hiredman if you remove the call to = the third is likely what you want"><y>#</y><d>2022-10-28</d><h>17:29</h><w>hiredman</w>if you remove the call to = the third is likely what you want</z><z id="t1666978208" t="Jared Langson regarding the first, if I add false or (&gt; size 10) inside the (= block it fails So why would it pass when it should fail, if node-healthy? is false?"><y>#</y><d>2022-10-28</d><h>17:30</h><w>Jared Langson</w>regarding the first, if I add <code>false</code> or <code>(&gt; size 10)</code> inside the <code>(=</code> block it fails So why would it pass when it should fail, if <code>node-healthy?</code> is false?</z><z id="t1666978318" t="hiredman because (= false false false) is true"><y>#</y><d>2022-10-28</d><h>17:31</h><w>hiredman</w>because <code>(= false false false)</code> is true</z><z id="t1666978432" t="Jared Langson appreciate it. Thanks 🙂"><y>#</y><d>2022-10-28</d><h>17:33</h><w>Jared Langson</w>appreciate it. Thanks <b>🙂</b></z><z id="t1667515932" t="Jared Langson Is there a way do this, but in a way that has shrinkage? I want to pull a random character from a random string and then do stuff. The random string is made from a generator. Is there a way to move the random character into the prop/for-all? (defspec split-functionality-test (prop/for-all [s (gen/not-empty gen/string-alphanumeric)] (let [split-on (rand-nth s) ;can this be done in the for-all binding? pattern (re-pattern (str split-on))] (= (cp-str/split s pattern) (str/split s pattern)))))"><y>#</y><d>2022-11-03</d><h>22:52</h><w>Jared Langson</w>Is there a way do this, but in a way that has shrinkage? I want to pull a random character from a random string and then do stuff. The random string is made from a generator. Is there a way to move the random character into the prop/for-all?

<pre>(defspec split-functionality-test
  (prop/for-all [s (gen/not-empty gen/string-alphanumeric)]
    (let [split-on (rand-nth s)                          ;can this be done in the for-all binding?
          pattern (re-pattern (str split-on))]
      (= (cp-str/split s pattern) (str/split s pattern)))))</pre></z><z id="t1667516049" t="hiredman it is complicated"><y>#</y><d>2022-11-03</d><h>22:54</h><w>hiredman</w>it is complicated</z><z id="t1667516095" t="hiredman you can, but the way to do it may make shrinking worse"><y>#</y><d>2022-11-03</d><h>22:54</h><w>hiredman</w>you can, but the way to do it may make shrinking worse</z><z id="t1667516276" t="hiredman I would try something like (defspec split-functionality-test (prop/for-all [i gen/nat s (gen/not-empty gen/string-alphanumeric)] (let [split-on (nth s (mod i (count s))) pattern (re-pattern (str split-on))] (= (cp-str/split s pattern) (str/split s pattern)))))"><y>#</y><d>2022-11-03</d><h>22:57</h><w>hiredman</w>I would try something like
<pre>(defspec split-functionality-test
  (prop/for-all [i gen/nat
                 s (gen/not-empty gen/string-alphanumeric)]
                (let [split-on (nth s (mod i (count s)))                         
                      pattern (re-pattern (str split-on))]
                  (= (cp-str/split s pattern) (str/split s pattern)))))</pre></z><z id="t1667516290" t="Alex Miller (Clojure team) sometimes it&apos;s helpful to build up the things you need rather than draw from one random thing"><y>#</y><d>2022-11-03</d><h>22:58</h><w>Alex Miller (Clojure team)</w>sometimes it&apos;s helpful to build up the things you need rather than draw from one random thing</z><z id="t1667516304" t="Alex Miller (Clojure team) yeah, that&apos;s a decent way"><y>#</y><d>2022-11-03</d><h>22:58</h><w>Alex Miller (Clojure team)</w>yeah, that&apos;s a decent way</z><z id="t1667516326" t="hiredman potentially moving the order of i and s if it isn&apos;t shrinking well (I forget which way test.check throws away shrinking when composing with bind)"><y>#</y><d>2022-11-03</d><h>22:58</h><w>hiredman</w>potentially moving the order of i and s if it isn&apos;t shrinking well (I forget which way test.check throws away shrinking when composing with bind)</z><z id="t1667516430" t="Jared Langson The other problem with my way is that because split-on is inside let , I don&apos;t know the value of split-on when the test fails. So even if the shrinkage is worse, moving split-on to the prop/for-all could be a good tradeoff"><y>#</y><d>2022-11-03</d><h>23:00</h><w>Jared Langson</w>The other problem with my way is that because split-on is inside <code>let</code>, I don&apos;t know the value of split-on when the test fails. So even if the shrinkage is worse, moving split-on to the prop/for-all could be a good tradeoff</z><z id="t1667516540" t="hiredman in theory the ideal would be something like (defspec split-functionality-test (prop/for-all [s (gen/not-empty gen/string-alphanumeric) i (gen/choose 0 (count s))] (let [split-on (nth s (mod i (count s))) pattern (re-pattern (str split-on))] (= (cp-str/split s pattern) (str/split s pattern))))) "><y>#</y><d>2022-11-03</d><h>23:02</h><w>hiredman</w>in theory the ideal would be something like
<pre>(defspec split-functionality-test
  (prop/for-all [s (gen/not-empty gen/string-alphanumeric)
                 i (gen/choose 0 (count s))]
                (let [split-on (nth s (mod i (count s)))
                      pattern (re-pattern (str split-on))]
                  (= (cp-str/split s pattern) (str/split s pattern)))))</pre>
</z><z id="t1667516586" t="hiredman so you only generate numbers from 0 to size of string, and those generated numbers also predictably shrink (throwing the mod in there can make things weird when shrinking)"><y>#</y><d>2022-11-03</d><h>23:03</h><w>hiredman</w>so you only generate numbers from 0 to size of string, and those generated numbers also predictably shrink (throwing the mod in there can make things weird when shrinking)</z><z id="t1667516646" t="hiredman but this is sort of like (gen/bind ..gen for s... (fn [s] .. gen for i ...))"><y>#</y><d>2022-11-03</d><h>23:04</h><w>hiredman</w>but this is sort of like <code>(gen/bind ..gen for s... (fn [s] .. gen for i ...))</code></z><z id="t1667516715" t="hiredman and when you compose things with bind like that in test.check(and anything modeled after the original quickcheck) you lose shrinking information for one or the other, and I forget which choice test.check makes"><y>#</y><d>2022-11-03</d><h>23:05</h><w>hiredman</w>and when you compose things with bind like that in test.check(and anything modeled after the original quickcheck)  you lose shrinking information for one or the other, and I forget which choice test.check makes</z><z id="t1667516819" t="Jared Langson When I ran your second version it complained about i (gen/choose 0 (count s))] . Said &quot;Unable to resolve symbol: s in this context&quot;"><y>#</y><d>2022-11-03</d><h>23:06</h><w>Jared Langson</w>When I ran your second version it complained about <code>i (gen/choose 0 (count s))]</code>. Said &quot;Unable to resolve symbol: s in this context&quot;</z><z id="t1667516912" t="hiredman oh, good, I guess test.check&apos;s for-all is optimized to get around the issue I mentioned, but as a result the generators cannot refer to each other"><y>#</y><d>2022-11-03</d><h>23:08</h><w>hiredman</w>oh, good, I guess test.check&apos;s for-all is optimized to get around the issue I mentioned, but as a result the generators cannot refer to each other</z><z id="t1667517365" t="hiredman not optimized so the issue isn&apos;t there, but optimized to try and avoid it"><y>#</y><d>2022-11-03</d><h>23:16</h><r>hiredman</r>not optimized so the issue isn&apos;t there, but optimized to try and avoid it</z><z id="t1667516944" t="hiredman for-all* is the one that would let you I think"><y>#</y><d>2022-11-03</d><h>23:09</h><w>hiredman</w>for-all* is the one that would let you I think</z><z id="t1667516954" t="hiredman nope"><y>#</y><d>2022-11-03</d><h>23:09</h><w>hiredman</w>nope</z><z id="t1667516999" t="hiredman huh, for some reason I thought for-all turned into a bind"><y>#</y><d>2022-11-03</d><h>23:09</h><w>hiredman</w>huh, for some reason I thought for-all turned into a bind</z><z id="t1667517030" t="hiredman I guess the second isn&apos;t directly expressible using for-all"><y>#</y><d>2022-11-03</d><h>23:10</h><w>hiredman</w>I guess the second isn&apos;t directly expressible using for-all</z><z id="t1667517288" t="hiredman I was looking at an old version of the code from before &gt; When there are multiple binding pairs, the earlier pairs are not &gt; visible to the later pairs. was added to the docstring for for-all"><y>#</y><d>2022-11-03</d><h>23:14</h><w>hiredman</w>I was looking at an old version of the code from before
&gt;   When there are multiple binding pairs, the earlier pairs are not
&gt;   visible to the later pairs.
was added to the docstring for for-all</z><z id="t1667518429" t="hiredman http://clojure.test.check.ge/let is what I am thinking of that allows for the dependencies between generators"><y>#</y><d>2022-11-03</d><h>23:33</h><w>hiredman</w><a href="http://clojure.test.check.ge/let" target="_blank">http://clojure.test.check.ge/let</a> is what I am thinking of that allows for the dependencies between generators</z><z id="t1667518923" t="Jared Langson Are there pitfalls/gotchas with using gen/let?"><y>#</y><d>2022-11-03</d><h>23:42</h><w>Jared Langson</w>Are there pitfalls/gotchas with using gen/let?</z><z id="t1667519060" t="hiredman the above mentioned lose of shrinkage, which is https://clojure.atlassian.net/browse/TCHECK-112"><y>#</y><d>2022-11-03</d><h>23:44</h><w>hiredman</w>the above mentioned lose of shrinkage, which is <a href="https://clojure.atlassian.net/browse/TCHECK-112" target="_blank">https://clojure.atlassian.net/browse/TCHECK-112</a></z><z id="t1668395681" t="skylize Seems like (despite the plural name) gen/elements only returns 1 element per gen? Is that right? How do I gen a random quantity of elements? (def map-and-1-key-from (gen/let [m (gen/not-empty (gen/map gen/keyword gen/any-equatable)) ;; Surprisingly works as name above describes. ;; How would I make `map-and-some-keys-from` instead? k (gen/elements (keys m))] [m k])) (def my-gen (map-and-1-key-from gen/keyword"><y>#</y><d>2022-11-14</d><h>03:14</h><w>skylize</w>Seems like (despite the plural name) <code>gen/elements</code> only returns 1 element per gen? Is that right? How do I gen a random quantity of elements?
<pre>(def map-and-1-key-from
  (gen/let [m (gen/not-empty
               (gen/map gen/keyword gen/any-equatable))
            ;; Surprisingly works as name above describes.
            ;; How would I make `map-and-some-keys-from` instead?
            k (gen/elements (keys m))]
    [m k]))

(def my-gen (map-and-1-key-from gen/keyword</pre></z><z id="t1668396130" t="hiredman vector of elements"><y>#</y><d>2022-11-14</d><h>03:22</h><w>hiredman</w>vector of elements</z><z id="t1670940700" t="skylize I don&apos;t understand why this causes &quot;Couldn&apos;t generate enough distinct elements!&quot; (defn foo [gen] (gen/vector-distinct gen {:num-elements 10})) (defspec foo-test (prop/for-all [x (gen/let [n (gen/resize 10 gen/nat)] (foo (gen/vector gen/any n)))] true)) (foo-test) Works fine if I replace the gen/let wrapper with an inline constant. (defspec foo-test (prop/for-all (fgen/foo (gen/vector gen/any 5)) true)) Is there a better way to do this? or some way to work around the problem?"><y>#</y><d>2022-12-13</d><h>14:11</h><w>skylize</w>I don&apos;t understand why this causes &quot;Couldn&apos;t generate enough distinct elements!&quot;
<pre>(defn foo [gen]
  (gen/vector-distinct gen {:num-elements 10}))

(defspec foo-test
  (prop/for-all [x (gen/let [n (gen/resize 10 gen/nat)]
                     (foo (gen/vector gen/any n)))]
    true))

(foo-test)</pre>
Works fine if I replace the <code>gen/let</code> wrapper with an inline constant.
<pre>(defspec foo-test
  (prop/for-all (fgen/foo (gen/vector gen/any 5))
    true))</pre>
 Is there a better way to do this?  or some way to work around the problem?</z><z id="t1670940778" t="gfredericks Does it happen when n is zero?"><y>#</y><d>2022-12-13</d><h>14:12</h><w>gfredericks</w>Does it happen when n is zero?</z><z id="t1670940814" t="skylize yes"><y>#</y><d>2022-12-13</d><h>14:13</h><r>skylize</r>yes</z><z id="t1670942176" t="skylize This was stripped way down to highlight the issue. Here is real code. unary , shown for easier explanation of the concept, takes gens for x and y , and generates a function f mapping x -&gt; y , (returning all 3 in a map). n-aries is the same basic idea. But the number of xs is variable (i.e. generating n-arity of function instead of unary) and the number of xs -&gt; y mappings is also variable, so the generated function can return different y s depending on specific inputs. The arity (or count of xs ) should be determined by xs-gen (which is the problematic n generated in the spec). The count of xs -&gt; y mappings is determined by count-gen . An empty xs should be a valid result from xs-gen . But xss needs to be a list of unique xs . ;; fgen.cljc ; unary (defn- x-y-&gt;map [X Y] {:x X :y Y :f (fn [x] (if (= X x) Y (throw (ex-info &quot;generated function called with incorrect arguments&quot; {:expected X :actual x}))))}) (defn unary [x-gen y-gen] (gen/let [x x-gen y y-gen] (x-y-&gt;map x y)) ; n-aries (defn- xss-ys-&gt;map [xss ys] (let [xss-ys (zipmap xss ys)] {:xss-ys xss-ys :f (fn [&amp; xs] (if (some #(= % xs) xss) (xss-ys xs) (throw (ex-info &quot;generated function called with incorrect arguments&quot; {:expected {:one-seq-of xs} :actual xs}))))})) (defn n-aries [count-gen xs-gen y-gen] (gen/let [n count-gen xss (gen/vector-distinct xs-gen {:num-elements n}) ys (gen/vector y-gen n)] (xss-ys-&gt;map xss ys))) ; fgen_test.cljc (defspec n-aries 200 (prop/for-all [{f :f {xs :xs ys :ys} :xs-ys} (gen/let [n (gen/resize 10 gen/nat)] (fgen/n-aries (gen/resize 10 gen/nat) (gen/vector gen/any n) gen/any))] (or (util/empties? xs ys) (= ys (map f xs)))))"><y>#</y><d>2022-12-13</d><h>14:36</h><r>skylize</r>This was stripped way down to highlight the issue.

Here is real code.

<code>unary</code>, shown for easier explanation of the concept, takes gens for <code>x</code> and <code>y</code>, and generates a function <code>f</code> mapping <code>x</code> -&gt; <code>y</code>, (returning all 3 in a map).

<code>n-aries</code> is the same basic idea. But the number of <code>xs</code> is variable (i.e. generating n-arity of function instead of unary) and the number of <code>xs</code> -&gt; <code>y</code> mappings is also variable, so the generated function can return different <code>y</code>s depending on specific inputs.

The arity (or count of <code>xs</code>) should be determined by <code>xs-gen</code> (which is the problematic <code>n</code> generated in the spec). The count of <code>xs</code>-&gt; <code>y</code> mappings is determined by <code>count-gen</code>. An empty <code>xs</code> should be a valid result from <code>xs-gen</code>. But <code>xss</code> needs to be a list of unique <code>xs</code>.
<pre>;; fgen.cljc

; unary

(defn- x-y-&gt;map [X Y]
  {:x X
   :y Y
   :f (fn [x]
        (if (= X x)
          Y
          (throw (ex-info &quot;generated function called with incorrect arguments&quot;
                          {:expected X
                           :actual x}))))})

(defn unary [x-gen y-gen]
  (gen/let [x x-gen
            y y-gen]
    (x-y-&gt;map x y))

; n-aries

(defn- xss-ys-&gt;map [xss ys] 
  (let [xss-ys (zipmap xss ys)]
    {:xss-ys xss-ys
     :f (fn [&amp; xs]
          (if (some #(= % xs) xss)
            (xss-ys xs)
            (throw (ex-info &quot;generated function called with incorrect arguments&quot;
                            {:expected {:one-seq-of xs}
                             :actual xs}))))}))

(defn n-aries [count-gen xs-gen y-gen]
  (gen/let [n count-gen
            xss (gen/vector-distinct xs-gen {:num-elements n})
            ys (gen/vector y-gen n)]
    (xss-ys-&gt;map xss ys)))</pre>
<pre>; fgen_test.cljc

(defspec n-aries
  200
  (prop/for-all [{f :f {xs :xs ys :ys} :xs-ys}
                 (gen/let [n (gen/resize 10 gen/nat)]
                   (fgen/n-aries
                    (gen/resize 10 gen/nat)
                    (gen/vector gen/any n)
                    gen/any))]
    (or (util/empties? xs ys)
        (= ys (map f xs)))))</pre></z><z id="t1670942342" t="gfredericks Why is uniqueness important?"><y>#</y><d>2022-12-13</d><h>14:39</h><r>gfredericks</r>Why is uniqueness important?</z><z id="t1670942429" t="skylize Because the goal is to generate a function f , which has deterministic behavior y based on its input value(s) xs ."><y>#</y><d>2022-12-13</d><h>14:40</h><r>skylize</r>Because the goal is to generate a function <code>f</code>, which has deterministic behavior <code>y</code> based on its input value(s) <code>xs</code>.</z><z id="t1670942471" t="gfredericks Then why is generating a minimum number of things important?"><y>#</y><d>2022-12-13</d><h>14:41</h><r>gfredericks</r>Then why is generating a minimum number of things important?</z><z id="t1670942471" t="skylize Additionally, I am representing that determinism internally as a map where xs is a key on a map of xs -&gt; ys ."><y>#</y><d>2022-12-13</d><h>14:41</h><r>skylize</r>Additionally, I am representing that determinism internally as a map where <code>xs</code> is a key on a map of <code>xs</code> -&gt; <code>ys</code>.</z><z id="t1670942508" t="skylize Who said anything about a minimum number of things?"><y>#</y><d>2022-12-13</d><h>14:41</h><r>skylize</r>Who said anything about a minimum number of things?</z><z id="t1670942531" t="gfredericks Your gen-vector-distinct call did"><y>#</y><d>2022-12-13</d><h>14:42</h><r>gfredericks</r>Your gen-vector-distinct call did</z><z id="t1670942631" t="skylize The gen-distinct call asks for a specific number of things, where that number is generated by a user-provided generator. The user could choose to provide (gen/return 0) or gen/nat . That is not for me to decide."><y>#</y><d>2022-12-13</d><h>14:43</h><r>skylize</r>The <code>gen-distinct</code> call asks for a specific number of things, where that number is generated by a user-provided generator. The user could choose to provide <code>(gen/return 0)</code> or <code>gen/nat</code>. That is not for me to decide.</z><z id="t1670942661" t="gfredericks What does n represent there, in the context of generating functions?"><y>#</y><d>2022-12-13</d><h>14:44</h><r>gfredericks</r>What does n represent there, in the context of generating functions?</z><z id="t1670942915" t="skylize n in n-aries (not causing problems and replaced by 10 in the foo example) is the number of mappings from xs -&gt; ys . n in the spec (which is causing problems) represents the arity of the target generated function. i.e (defn foo [x y z]) is (= n 3) , and (defn foo []) is (= n 0) . Again this will ultimately be provided by the user, when they define an xs-gen to pass into n-aries ."><y>#</y><d>2022-12-13</d><h>14:48</h><r>skylize</r><code>n</code> in <code>n-aries</code> (not causing problems and replaced by <code>10</code> in the <code>foo</code> example) is the number of mappings from <code>xs</code>-&gt; <code>ys</code>.

<code>n</code> in the spec (which is causing problems) represents the arity of the target generated function. i.e <code>(defn foo [x y z])</code> is <code>(= n 3)</code>, and <code>(defn foo [])</code> is <code>(= n 0)</code>. Again this will ultimately be provided by the user, when they define an <code>xs-gen</code> to pass into <code>n-aries</code>.</z><z id="t1670943087" t="gfredericks Do you at least agree that the error in your simplified example makes sense?"><y>#</y><d>2022-12-13</d><h>14:51</h><r>gfredericks</r>Do you at least agree that the error in your simplified example makes sense?</z><z id="t1670943227" t="skylize Yes. I see it now. In the case my test gens (= n 0) , foo cannot generate distinct data."><y>#</y><d>2022-12-13</d><h>14:53</h><r>skylize</r>Yes. I see it now. In the case my test gens <code>(= n 0)</code> , <code>foo</code> cannot generate distinct data.</z><z id="t1670943339" t="skylize But that still leaves me at a loss how to put n-aries through its paces, when (= n 0) for should be a valid possibility. 😞"><y>#</y><d>2022-12-13</d><h>14:55</h><r>skylize</r>But that still leaves me at a loss how to put <code>n-aries</code> through its paces, when <code>(= n 0)</code> for should be a valid possibility. <b>😞</b></z><z id="t1670943681" t="skylize Hmm. I think with that in mind, the issue is not the test. Somehow n-aries needs to be smarter about comparing the result of count-gen with the results of xs-gen to avoid nonsensical attempts at uniqueness."><y>#</y><d>2022-12-13</d><h>15:01</h><r>skylize</r>Hmm. I think with that in mind, the issue is not the test. Somehow <code>n-aries</code> needs to be smarter about comparing the result of <code>count-gen</code> with the results of <code>xs-gen</code> to avoid nonsensical attempts at uniqueness.</z><z id="t1670943868" t="gfredericks A 0-ary pure function can only have one input/output pair"><y>#</y><d>2022-12-13</d><h>15:04</h><r>gfredericks</r>A 0-ary pure function can only have one input/output pair</z><z id="t1670943884" t="gfredericks It&apos;s effectively a constant"><y>#</y><d>2022-12-13</d><h>15:04</h><r>gfredericks</r>It&apos;s effectively a constant</z><z id="t1670944294" t="skylize Yes. I don&apos;t know what that though. The fact a 0-arity pure function is a constant does not obviate the need for someone testing a higher-order function check how it handles being given a 0-arity function, among others."><y>#</y><d>2022-12-13</d><h>15:11</h><r>skylize</r>Yes. I don&apos;t know what that though.

The fact a 0-arity pure function is a constant does not obviate the need for someone testing a higher-order function check how it handles being given a 0-arity function, among others.</z><z id="t1670945679" t="gfredericks I haven&apos;t internalized the details of the situation, but if you&apos;re getting a &quot;can&apos;t generate enough distinct elements&quot; error because of a trivial generator, then you should probably either question the need for distinctness or minimum elements, or else consider that your api allows users to ask for impossible things"><y>#</y><d>2022-12-13</d><h>15:34</h><r>gfredericks</r>I haven&apos;t internalized the details of the situation, but if you&apos;re getting a &quot;can&apos;t generate enough distinct elements&quot; error because of a trivial generator, then you should probably either question the need for distinctness or minimum elements, or else consider that your api allows users to ask for impossible things</z><z id="t1670993080" t="skylize The problem was just the location of let . It should be wrapping the generator passed to foo to keep generating new n values, rather than binding a single n ahead of calling foo . (defspec foo-test (prop/for-all [x (foo (gen/let [n (gen/resize 10 gen/nat)] (gen/vector gen/any n)))] true)) ... instead of ... (defspec foo-test (prop/for-all [x (gen/let [n (gen/resize 10 gen/nat)] (foo (gen/vector gen/any n)))] true))"><y>#</y><d>2022-12-14</d><h>04:44</h><r>skylize</r>The problem was just the location of <code>let</code>. It should be wrapping the generator passed to <code>foo</code> to keep generating  new <code>n</code>values, rather than binding a single <code>n</code> ahead of calling <code>foo</code>.
<pre>(defspec foo-test
  (prop/for-all [x (foo (gen/let [n (gen/resize 10 gen/nat)]
                          (gen/vector gen/any n)))]
    true))</pre>
... instead of ...
<pre>(defspec foo-test
  (prop/for-all [x (gen/let [n (gen/resize 10 gen/nat)]
                     (foo (gen/vector gen/any n)))]
    true))</pre></z><z id="t1670940813" t="gfredericks If I&apos;m reading correctly, in that scenario you&apos;re asking it to generate ten distinct empty vectors"><y>#</y><d>2022-12-13</d><h>14:13</h><w>gfredericks</w>If I&apos;m reading correctly, in that scenario you&apos;re asking it to generate ten distinct empty vectors</z><z id="t1670940869" t="gfredericks I can&apos;t tell what you&apos;re actually trying to do, so it&apos;s not clear what would count as a fix"><y>#</y><d>2022-12-13</d><h>14:14</h><w>gfredericks</w>I can&apos;t tell what you&apos;re actually trying to do, so it&apos;s not clear what would count as a fix</z><z id="t1671506698" t="skylize Would happily take feedback, especially ideas for getting out of the way of shrinkage. https://clojurians.slack.com/archives/C06MAR553/p1671506574208579"><y>#</y><d>2022-12-20</d><h>03:24</h><w>skylize</w>Would happily take feedback, especially ideas for getting out of the way of shrinkage.
<a href="https://clojurians.slack.com/archives/C06MAR553/p1671506574208579" target="_blank">https://clojurians.slack.com/archives/C06MAR553/p1671506574208579</a></z><z id="t1693674731" t="Ben Sless What&apos;s the best way to generate any such that bigints are bounded?"><y>#</y><d>2023-09-02</d><h>17:12</h><w>Ben Sless</w>What&apos;s the best way to generate <code>any</code> such that bigints are bounded?</z></g></div></body>