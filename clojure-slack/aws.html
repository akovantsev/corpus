<!DOCTYPE html>
<head><title>aws</title><meta charset="UTF-8" /><style type="text/css">body {
    font-family: Monaco, Menlo, Consolas, "Courier New", sans-serif;
    font-size: 12px;
    margin: 15px;
}
h2 {text-align: center}
pre,
code {
    font-family: Monaco, Menlo, Consolas, "Courier New", monospace;
    color: #333;
    line-break: anywhere;
}
a {
    line-break: anywhere;
}
code {
    /*line-height: 1.2;*/
    white-space: normal;
    color: #c25;
    background-color: #f7f7f9;
    border: 1px solid #e1e1e8;
}
pre {
    margin: .5rem 0 .2rem;
    font-size: .75rem;
    /*line-height: 1.15rem;*/
    background: #fbfaf8;
    padding: .5rem;
    word-break: normal;
    display: block;
    border: 1px solid rgba(0, 0, 0, .15);
    white-space: pre-wrap;
    word-wrap: break-word;
    border-radius: 4px;
}
/*span {*/
z {
    white-space: pre-wrap;
}

d {padding-right: 8px;}
h {padding-right: 16px;}

w, r {
    margin-right: 10px;
    padding-right: 8px;
    text-align: right;
}

d,h,w,r {
    background-color: lavender;
    margin-top: 1px;
    display: inline-table; /* prevents doubleclick selection spillover into neighbour elements */
}

h:hover,
d:hover {
    text-decoration: underline;
    color: blue;
    cursor: row-resize;
}
d {padding-right: 8px;}
h {padding-right: 16px;}

z {display: block;}

z:target > r,
z:target > w,
z:target > d,
z:target > h {
    background-color: aquamarine
}

#filters-container {
    position: fixed;
    left: 50px;
    z-index: 1;
}
#filters-container > input {
    /*column:*/
    display: block;
    outline-color: aquamarine;
}

y {
    cursor: pointer;
    text-decoration: none;
    color: blue;
    position: absolute;
    left: 3px;
}

y:hover {
    text-decoration: underline;
    color: aquamarine;
}


</style></head><body><style id="css-username">w {min-width: 216px;} r {min-width: 248px;}</style><style id="css-text-filter"></style><style id="css-date-filter"></style><style id="css-filter-override"></style><p id="filters-container"><input id="text-filter" onkeyup="debtextfilter(this.value)" placeholder="filter text" type="string" /><button hidden="hidden" id="date-filter" onclick="cleardatefilter()"></button></p><h2>#aws</h2><pre><i>generated UTC: 2023-02-15 15:17</i><i>
latest data: <a href="https://clojurians-log.clojureverse.org/aws/2023-02-01">https://clojurians-log.clojureverse.org/aws/2023-02-01</a></i><i>
messages: 5588</i>
pro tips:
* Double click on text to filter by it. (doubleclick + cmd-f for extra points).
* Click on date to keep day visible regardless of filter.
* Click on time to keep hour visible regardless of filter.</pre><script>const textFilterInput = document.getElementById("text-filter");
const dateFilterInput = document.getElementById("date-filter");
const filterTextStyle = document.getElementById("css-text-filter");
const filterDateStyle = document.getElementById("css-date-filter");
const filterStyleOverride = document.getElementById("css-filter-override");



function textFilter2(text) {
    var style = '';
    if (text.trim() !== '') {
        text.split(' ').forEach(function (t) {
            if (t !== '') {
                style = style + "z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
            }
        });
    }
    filterTextStyle.innerHTML = style;
}
function textFilter(text) {
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (s){
            var sid = s.getAttribute("id");
            text.split(' ').forEach(function (t) {
                if (t !== '') {
                    filterTextStyle.innerHTML += "\ng#" + sid + " > z:not([t*='" + t + "' i]) {display: none; opacity: 0.6}";
                }
            });
        })
    }
}
function textFilter3(text) {
    console.time("text search");
    filterTextStyle.innerHTML = "";
    if (text.trim() !== '') {
        const re = new RegExp( text, "i");
        var sections = document.getElementsByTagName("g");
        var sectionsArr = Array.prototype.slice.call(sections);
        sectionsArr.forEach(function (w){
            var zs = w.getElementsByTagName ("z");
            var zsArr = Array.prototype.slice.call(zs);
            var ids = zsArr
                .filter(function (el) {
                    return !re.test(el.innerText);
                })
                .map(function (el){
                    return el.getAttribute("id");
                });
            if (ids) {
                filterTextStyle.innerHTML += "\n#" + ids.join(",#") + " {display: none; opacity: 0.6}";
            }
        })
    }
    console.timeEnd("text search");
}


function filterSelection (e) {
    let sel = document.getSelection();
    let txt = sel.toString();
    textFilterInput.value = (txt || "");
    textFilter(txt);
}
function debounce1(callback, delay) {
    let timeout;
    return function(arg) {
        clearTimeout(timeout);
        timeout = setTimeout(callback, delay, arg);
    }
}

function keyUp (e) {
    if (e.code === "KeyF" && e.ctrlKey) {
        let txt = document.getSelection().toString();
        if (txt.length > 0) {
            textFilterInput.value = (txt || "");
            textFilter(txt);
        }
    }
}


function showDateTimes (el, datestr, hourstr) {
    dateFilterInput.innerText = "clear: " + datestr + " " + hourstr;
    dateFilterInput.hidden = false;
    let ids = [];
    const clicked = el.parentElement;  // el = z#id/t
    ids.push(clicked.id);
    // var idbefore, idafter;
    let cursor = clicked;
    function nextCursor (cursor) {
        const id = (cursor && cursor.id);
        const d = (cursor && cursor.children[1]);
        const h = (cursor && cursor.children[2])
        if (id) {
            ids.push(id); //includes 1st next-id not matching date.
        } else {
            cursor = null;
        }
        if (d && (d.textContent === datestr) && (!hourstr || (h && h.textContent.startsWith(hourstr)))) {
        } else {
            cursor = null;
        }
        return cursor;
    }
    while (cursor) {
        cursor = nextCursor(cursor.previousElementSibling);
    }

    cursor = clicked;

    while (cursor) {
        cursor = nextCursor(cursor.nextElementSibling);
    }


    var style1 = '';
    var style2 = '';
    var content;
    if (datestr.includes(" ")) { //hour
        content = " *";
    } else {
        content = "**";
    }
    ids.forEach(function (id) {
        if (id) {
            style1 = style1 + ", #" + id;
            style2 = style2 + ", #" + id + " h:after";
        }
    })
    if (style1) {
        style1 = style1.substring(1) + " {display: block !important}";
    }
    if (style2) {
        style2 = style2.substring(1) + " {content: \"" + content + "\"; position: absolute}"
    }
    filterDateStyle.innerHTML = style1 + "\n" + style2;
}

// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView
function filterDay (el) {
    showDateTimes(el, el.textContent);
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function filterHours (el) {
    showDateTimes(el, el.previousElementSibling.textContent, el.textContent.substring(0, 2));
    el.scrollIntoView({behavior: "smooth", block: "center", inline: "center"});
}

function forceShowSelected (el) {
    var id = el.parentElement.id
    if (id) {
        window.location.hash = "#" + id;
        filterStyleOverride.innerHTML = ""
            + "#" + id
            + " {display: block !important;}"
            + "#" + id + " h:after"
            + " {content: \"  #\"; position: absolute}";

    } else {
        window.location.hash = "";
        filterStyleOverride.innerHTML = "";
    }
}


function cleardatefilter () {
    dateFilterInput.hidden = true;
    dateFilterInput.innerText = "";
    filterDateStyle.innerHTML = "";
}

const debtextfilter = debounce1(textFilter, 200);

function doubleClick (e) {
    if (e.target.tagName !== "INPUT"
        && e.target.tagName !== "D"
        && e.target.tagName !== "H") {

        filterSelection();
        e.target.scrollIntoView({behavior: "auto", block: "center", inline: "start"});
    }
}

function onclick(e) {
    if (e.target.tagName === "Y") {
        e.preventDefault();
        forceShowSelected(e.target);
    } else if (e.target.tagName === "D") {
        e.preventDefault();
        filterDay(e.target);
    } else if (e.target.tagName === "H") {
        e.preventDefault();
        filterHours(e.target);
    }
}

document.onclick = onclick;
document.ondblclick = doubleClick;
document.onkeyup = keyUp;
textFilterInput.focus();
</script><div><g id="s0"><z id="t1440681828" t="alandipert hi! welcome"><y>#</y><d>2015-08-27</d><h>13:23</h><w>alandipert</w>hi! welcome</z><z id="t1440681900" t="micha shalom"><y>#</y><d>2015-08-27</d><h>13:25</h><w>micha</w>shalom</z><z id="t1440682051" t="micha elastic beanstalk with docker images hosted on private s3 buckets, anyone?"><y>#</y><d>2015-08-27</d><h>13:27</h><w>micha</w>elastic beanstalk with docker images hosted on private s3 buckets, anyone?</z><z id="t1440682088" t="micha this is my dream and my purpose"><y>#</y><d>2015-08-27</d><h>13:28</h><w>micha</w>this is my dream and my purpose</z><z id="t1440682103" t="ragge we mainly build debian packages on ci box, push to private repo, deploy is apt-get update &amp;&amp; apt-get install"><y>#</y><d>2015-08-27</d><h>13:28</h><w>ragge</w>we mainly build debian packages on ci box, push to private repo, deploy is <code>apt-get update &amp;&amp; apt-get install</code></z><z id="t1440682126" t="ragge use fabric for orchestrating, some things behind elbs are updated in rolling manner"><y>#</y><d>2015-08-27</d><h>13:28</h><w>ragge</w>use fabric for orchestrating, some things behind elbs are updated in rolling manner</z><z id="t1440682455" t="ragge some people are using docker/ecs too"><y>#</y><d>2015-08-27</d><h>13:34</h><w>ragge</w>some people are using docker/ecs too</z><z id="t1440683209" t="andrewhr awesome idea [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] !"><y>#</y><d>2015-08-27</d><h>13:46</h><w>andrewhr</w>awesome idea <a>@alandipert</a>!</z><z id="t1440683480" t="alandipert [:attrs {:href &quot;/_/_/users/U051EUEUM&quot;}] : thanks, welcome! 👋"><y>#</y><d>2015-08-27</d><h>13:51</h><w>alandipert</w><a>@andrewhr</a>: thanks, welcome! <b>👋</b></z><z id="t1440683676" t="alandipert i&apos;m curious about the amazon codedeploy thing"><y>#</y><d>2015-08-27</d><h>13:54</h><w>alandipert</w>i&apos;m curious about the amazon codedeploy thing</z><z id="t1440684807" t="jakemcc [:attrs {:href &quot;/_/_/users/U055HMK9L&quot;}] : we’re using elastic beanstalk with docker images (multi-container ECS) hosted in Artifcatory."><y>#</y><d>2015-08-27</d><h>14:13</h><w>jakemcc</w><a>@micha</a>: we’re using elastic beanstalk with docker images (multi-container ECS) hosted in Artifcatory.</z><z id="t1440685573" t="micha [:attrs {:href &quot;/_/_/users/U06SWJ2RH&quot;}] : have you considered hosting your images on s3?"><y>#</y><d>2015-08-27</d><h>14:26</h><w>micha</w><a>@jakemcc</a>: have you considered hosting your images on s3?</z><z id="t1440685650" t="micha this multicontainer ecs thing looks great btw"><y>#</y><d>2015-08-27</d><h>14:27</h><w>micha</w>this multicontainer ecs thing looks great btw</z><z id="t1440685652" t="jakemcc [:attrs {:href &quot;/_/_/users/U055HMK9L&quot;}] : I’m not sure if we have, we used to host our private jars on s3, tried using dockerhub for a bit for docker images, ended up moving to artifactory for both"><y>#</y><d>2015-08-27</d><h>14:27</h><w>jakemcc</w><a>@micha</a>: I’m not sure if we have, we used to host our private jars on s3, tried using dockerhub for a bit for docker images, ended up moving to artifactory for both</z><z id="t1440685677" t="micha we&apos;re just using single containers and it&apos;s a pain"><y>#</y><d>2015-08-27</d><h>14:27</h><w>micha</w>we&apos;re just using single containers and it&apos;s a pain</z><z id="t1440746227" t="robert-stuttaford we’re using circleci + aws codedeploy"><y>#</y><d>2015-08-28</d><h>07:17</h><w>robert-stuttaford</w>we’re using circleci + aws codedeploy</z><z id="t1440746237" t="robert-stuttaford and cloudformation"><y>#</y><d>2015-08-28</d><h>07:17</h><w>robert-stuttaford</w>and cloudformation</z><z id="t1440746246" t="robert-stuttaford and a metric shit-ton of coffee"><y>#</y><d>2015-08-28</d><h>07:17</h><w>robert-stuttaford</w>and a metric shit-ton of coffee</z><z id="t1440763928" t="alandipert [:attrs {:href &quot;/_/_/users/U0509NKGK&quot;}] : wuold be curious to hear more about your experience with codedeploy"><y>#</y><d>2015-08-28</d><h>12:12</h><w>alandipert</w><a>@robert-stuttaford</a>: wuold be curious to hear more about your experience with codedeploy</z><z id="t1440764180" t="statonjr [:attrs {:href &quot;/_/_/users/U0509NKGK&quot;}] : We’re using TravisCI with CodeDeploy and CloudFormation."><y>#</y><d>2015-08-28</d><h>12:16</h><w>statonjr</w><a>@robert-stuttaford</a>: We’re using TravisCI with CodeDeploy and CloudFormation.</z><z id="t1440774610" t="alandipert is anyone using Spark in EMR by any chance?"><y>#</y><d>2015-08-28</d><h>15:10</h><w>alandipert</w>is anyone using Spark in EMR by any chance?</z><z id="t1440774838" t="alandipert experiencing what looks like JVM OOM death (&quot;ExecutorLostFailure&quot;), despite a strategic RDD persist and StorageLevel.MEMORY_AND_DISK_SER memory/spill setting"><y>#</y><d>2015-08-28</d><h>15:13</h><w>alandipert</w>experiencing what looks like JVM OOM death (&quot;ExecutorLostFailure&quot;), despite a strategic RDD <code>persist</code> and <code>StorageLevel.MEMORY_AND_DISK_SER</code> memory/spill setting</z><z id="t1440774880" t="alandipert vanilla yarn settings and only setting executor counts/memory max in spark config"><y>#</y><d>2015-08-28</d><h>15:14</h><w>alandipert</w>vanilla yarn settings and only setting executor counts/memory max in spark config</z><z id="t1440795091" t="lowl4tency AWS channel, awesome"><y>#</y><d>2015-08-28</d><h>20:51</h><w>lowl4tency</w>AWS channel, awesome</z><z id="t1440795767" t="lowl4tency statonjr: how do you release production? simple_smile"><y>#</y><d>2015-08-28</d><h>21:02</h><w>lowl4tency</w>statonjr: how do you release production? <b>simple_smile</b></z><z id="t1440796007" t="lowl4tency I mean workflow"><y>#</y><d>2015-08-28</d><h>21:06</h><w>lowl4tency</w>I mean workflow</z><z id="t1440797479" t="statonjr [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : Production releases are deployed manually using AWS Console or aws-cli ."><y>#</y><d>2015-08-28</d><h>21:31</h><w>statonjr</w><a>@lowl4tency</a>: Production releases are deployed manually using AWS Console or <code>aws-cli</code>.</z><z id="t1440797524" t="lowl4tency statonjr: what about git workflow? do you have separate branch for production?"><y>#</y><d>2015-08-28</d><h>21:32</h><w>lowl4tency</w>statonjr: what about git workflow? do you have separate branch for production?</z><z id="t1440797549" t="lowl4tency statonjr: yes, manually running deploy makes sense"><y>#</y><d>2015-08-28</d><h>21:32</h><w>lowl4tency</w>statonjr: yes, manually running deploy makes sense</z><z id="t1440797623" t="lowl4tency alandipert: you can ask me about codedeploy simple_smile"><y>#</y><d>2015-08-28</d><h>21:33</h><w>lowl4tency</w>alandipert: you can ask me about codedeploy <b>simple_smile</b></z><z id="t1440797625" t="statonjr Git workflow: GitHub -&gt; Travis -&gt; AWS Staging environment. If all looks good, then manual push. No separate production branch."><y>#</y><d>2015-08-28</d><h>21:33</h><w>statonjr</w>Git workflow: GitHub -&gt; Travis -&gt; AWS Staging environment. If all looks good, then manual push. No separate production branch.</z><z id="t1440797650" t="lowl4tency aha"><y>#</y><d>2015-08-28</d><h>21:34</h><w>lowl4tency</w>aha</z><z id="t1440797674" t="lowl4tency statonjr: so, do you run new build for production? or use exist bundle?"><y>#</y><d>2015-08-28</d><h>21:34</h><w>lowl4tency</w>statonjr: so, do you run new build for production? or use exist bundle?</z><z id="t1440797718" t="statonjr We use the existing bundle."><y>#</y><d>2015-08-28</d><h>21:35</h><w>statonjr</w>We use the existing bundle.</z><z id="t1440797728" t="lowl4tency Nice simple_smile"><y>#</y><d>2015-08-28</d><h>21:35</h><w>lowl4tency</w>Nice <b>simple_smile</b></z><z id="t1440797749" t="lowl4tency statonjr: ow do you manage environment variables for hosts?:)"><y>#</y><d>2015-08-28</d><h>21:35</h><w>lowl4tency</w>statonjr: ow do you manage environment variables for hosts?:)</z><z id="t1440797783" t="lowl4tency statonjr: I&apos;m asking because it&apos;s interesting how other people solve same tasks simple_smile"><y>#</y><d>2015-08-28</d><h>21:36</h><w>lowl4tency</w>statonjr: I&apos;m asking because it&apos;s interesting how other people solve same tasks <b>simple_smile</b></z><z id="t1440797825" t="statonjr We have some hacks for environment variables, but we’re transitioning to Consul."><y>#</y><d>2015-08-28</d><h>21:37</h><w>statonjr</w>We have some hacks for environment variables, but we’re transitioning to Consul.</z><z id="t1440797859" t="lowl4tency As far as I know, Consul is not best solution for this 😞"><y>#</y><d>2015-08-28</d><h>21:37</h><w>lowl4tency</w>As far as I know, Consul is not best solution for this <b>😞</b></z><z id="t1440797874" t="lowl4tency For managing variables for multiple hosts"><y>#</y><d>2015-08-28</d><h>21:37</h><w>lowl4tency</w>For managing variables for multiple hosts</z><z id="t1440798091" t="statonjr We’re happy with Hashicorp tools so far. I’ll report back any issues."><y>#</y><d>2015-08-28</d><h>21:41</h><w>statonjr</w>We’re happy with Hashicorp tools so far. I’ll report back any issues.</z><z id="t1440798146" t="lowl4tency statonjr: interestin to take a look on the solution"><y>#</y><d>2015-08-28</d><h>21:42</h><w>lowl4tency</w>statonjr: interestin to take a look on the solution</z><z id="t1442470640" t="luposlip Yo! Anyone using Docker on AWS ECS, and any experience with this vs. AWS Beanstalk?"><y>#</y><d>2015-09-17</d><h>06:17</h><w>luposlip</w>Yo! Anyone using Docker on AWS ECS, and any experience with this vs. AWS Beanstalk?</z><z id="t1442488639" t="alandipert i&apos;m curious about ECS also, do a lot of docker on beanstalk"><y>#</y><d>2015-09-17</d><h>11:17</h><w>alandipert</w>i&apos;m curious about ECS also, do a lot of docker on beanstalk</z><z id="t1442505036" t="luposlip You do docker on beanstalk already? Not using their container service?"><y>#</y><d>2015-09-17</d><h>15:50</h><w>luposlip</w>You do docker on beanstalk already? Not using their container service?</z><z id="t1442505113" t="alandipert correct"><y>#</y><d>2015-09-17</d><h>15:51</h><w>alandipert</w>correct</z><z id="t1442505136" t="alandipert actually we do both .war and docker deploys for beanstalk apps, but prefer docker"><y>#</y><d>2015-09-17</d><h>15:52</h><w>alandipert</w>actually we do both .war and docker deploys for beanstalk apps, but prefer docker</z><z id="t1442505294" t="alandipert it works pretty well, but beanstalk can be weird - so many services wired together by their crazy ruby and python scripts"><y>#</y><d>2015-09-17</d><h>15:54</h><w>alandipert</w>it works pretty well, but beanstalk can be weird - so many services wired together by their crazy ruby and python scripts</z><z id="t1442505317" t="alandipert although the docker part of beanstalk has been fine"><y>#</y><d>2015-09-17</d><h>15:55</h><w>alandipert</w>although the docker part of beanstalk has been fine</z><z id="t1442505608" t="luposlip Ok. But have you looked at ecs at all? I&apos;m coming from heroku, wanting to put everything in one place, looking at docker to make it easy to scale and possibly move it all easily out of aws some day. "><y>#</y><d>2015-09-17</d><h>16:00</h><w>luposlip</w>Ok. But have you looked at ecs at all? I&apos;m coming from heroku, wanting to put everything in one place, looking at docker to make it easy to scale and possibly move it all easily out of aws some day. </z><z id="t1442581376" t="alandipert [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] : ah, no, haven&apos;t looked at ECS in very much detail. scaling on beanstalk is very easy... but being able to leave AWS is not a goal for us"><y>#</y><d>2015-09-18</d><h>13:02</h><w>alandipert</w><a>@luposlip</a>: ah, no, haven&apos;t looked at ECS in very much detail. scaling on beanstalk is very easy... but being able to leave AWS is not a goal for us</z><z id="t1442581886" t="luposlip [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : it’s not a goal in itself for me, but having the possibility is really valuable, and it seems to me it’s easier if using docker as compared to plain Beanstalk?"><y>#</y><d>2015-09-18</d><h>13:11</h><w>luposlip</w><a>@alandipert</a>: it’s not a goal in itself for me, but having the possibility is really valuable, and it seems to me it’s easier if using docker as compared to plain Beanstalk?</z><z id="t1442581950" t="alandipert docker is definitely good, but you don&apos;t need ECS to use it - https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html"><y>#</y><d>2015-09-18</d><h>13:12</h><w>alandipert</w>docker is definitely good, but you don&apos;t need ECS to use it - <a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html</a></z><z id="t1442582041" t="luposlip right simple_smile Also considering trying out Lambda, just for the heck of it (to begin with just for some time scheduled jobs)"><y>#</y><d>2015-09-18</d><h>13:14</h><w>luposlip</w>right <b>simple_smile</b> Also considering trying out Lambda, just for the heck of it (to begin with just for some time scheduled jobs)</z><z id="t1442582053" t="alandipert we&apos;re also using that lol"><y>#</y><d>2015-09-18</d><h>13:14</h><w>alandipert</w>we&apos;re also using that lol</z><z id="t1442582107" t="alandipert after we went over the aws tipping point we&apos;re in a place where the best thing to do is leverage all their services maximally, even if it means we can never leave"><y>#</y><d>2015-09-18</d><h>13:15</h><w>alandipert</w>after we went over the aws tipping point we&apos;re in a place where the best thing to do is leverage all their services maximally, even if it means we can never leave</z><z id="t1442582146" t="alandipert speaking of, time to go to work, bbl simple_smile"><y>#</y><d>2015-09-18</d><h>13:15</h><w>alandipert</w>speaking of, time to go to work, bbl <b>simple_smile</b></z><z id="t1442582422" t="luposlip 😉 Later!"><y>#</y><d>2015-09-18</d><h>13:20</h><w>luposlip</w><b>😉</b> Later!</z><z id="t1442585053" t="upgradingdave Howdy aws clojure peeps"><y>#</y><d>2015-09-18</d><h>14:04</h><w>upgradingdave</w>Howdy aws clojure peeps</z><z id="t1442585095" t="upgradingdave Thought this article was a pretty good overview … although be careful because if you’re like me, you’ll have to read all about the aws services you didn’t know about: https://www.expeditedssl.com/aws-in-plain-english"><y>#</y><d>2015-09-18</d><h>14:04</h><w>upgradingdave</w>Thought this article was a pretty good overview … although be careful because if you’re like me, you’ll have to read all about the aws services you didn’t know about: <a href="https://www.expeditedssl.com/aws-in-plain-english" target="_blank">https://www.expeditedssl.com/aws-in-plain-english</a></z><z id="t1442599710" t="jgdavey Has anyone deployed immutant to AWS? Wondering if elasticbeanstalk is an option or not"><y>#</y><d>2015-09-18</d><h>18:08</h><w>jgdavey</w>Has anyone deployed immutant to AWS? Wondering if elasticbeanstalk is an option or not</z><z id="t1442602437" t="alandipert hm, last i looked into it, the way to do immutant in AWS was to cluster in EC2"><y>#</y><d>2015-09-18</d><h>18:53</h><w>alandipert</w>hm, last i looked into it, the way to do immutant in AWS was to cluster in EC2</z><z id="t1442602690" t="jgdavey :thumbsup: Thanks. Doing that now."><y>#</y><d>2015-09-18</d><h>18:58</h><w>jgdavey</w><b>:thumbsup:</b> Thanks. Doing that now.</z><z id="t1442604844" t="alandipert altho [:attrs {:href &quot;/_/_/users/U06SGCEHJ&quot;}] might know better, and #C085AR8RE on freenode is usually hoppin&apos;"><y>#</y><d>2015-09-18</d><h>19:34</h><w>alandipert</w>altho <a>@tcrawley</a> might know better, and #C085AR8RE on freenode is usually hoppin&apos;</z><z id="t1442607585" t="statonjr We deploy Immutant to AWS without a cluster. We do not use Elastic Beanstalk."><y>#</y><d>2015-09-18</d><h>20:19</h><w>statonjr</w>We deploy Immutant to AWS without a cluster. We do not use Elastic Beanstalk.</z><z id="t1442608069" t="jgdavey Thanks [:attrs {:href &quot;/_/_/users/U050XF47G&quot;}] . That’s the way I’m going"><y>#</y><d>2015-09-18</d><h>20:27</h><w>jgdavey</w>Thanks <a>@statonjr</a>. That’s the way I’m going</z><z id="t1442611349" t="alandipert are you using immutant messaging and cache stuff, or just the web bits?"><y>#</y><d>2015-09-18</d><h>21:22</h><w>alandipert</w>are you using immutant messaging and cache stuff, or just the web bits?</z><z id="t1442683361" t="jgdavey [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : Just the web"><y>#</y><d>2015-09-19</d><h>17:22</h><w>jgdavey</w><a>@alandipert</a>: Just the web</z><z id="t1442684634" t="alandipert ah cool"><y>#</y><d>2015-09-19</d><h>17:43</h><w>alandipert</w>ah cool</z><z id="t1442689228" t="kyle_schmidt anyone have experience writing clojure for lambda functions in AWS. Is it even possible? I think it is possible given lambda needs to be written in a language using the jvm..."><y>#</y><d>2015-09-19</d><h>19:00</h><w>kyle_schmidt</w>anyone have experience writing clojure for lambda functions in AWS. Is it even possible? I think it is possible given lambda needs to be written in a language using the jvm...</z><z id="t1442689297" t="jaen I think I&apos;ve seen some articles about that, but I don&apos;t have the bookmarks on me. I think using Clojurescript is also a possibility, and might be preferable due to lower startup time."><y>#</y><d>2015-09-19</d><h>19:01</h><w>jaen</w>I think I&apos;ve seen some articles about that, but I don&apos;t have the bookmarks on me. I think using Clojurescript is also a possibility, and might be preferable due to lower startup time.</z><z id="t1442689341" t="alandipert [:attrs {:href &quot;/_/_/users/U0AHGU9PV&quot;}] : it&apos;s possible and works pretty well"><y>#</y><d>2015-09-19</d><h>19:02</h><w>alandipert</w><a>@kyle_schmidt</a>: it&apos;s possible and works pretty well</z><z id="t1442689343" t="jaen First Google link seems like a nice introduction - https://nervous.io/clojure/clojurescript/aws/lambda/node/lein/2015/07/05/lambda/"><y>#</y><d>2015-09-19</d><h>19:02</h><w>jaen</w>First Google link seems like a nice introduction - <a href="https://nervous.io/clojure/clojurescript/aws/lambda/node/lein/2015/07/05/lambda/" target="_blank">https://nervous.io/clojure/clojurescript/aws/lambda/node/lein/2015/07/05/lambda/</a></z><z id="t1442689388" t="kyle_schmidt thanks [:attrs {:href &quot;/_/_/users/U0A727APP&quot;}] [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] !"><y>#</y><d>2015-09-19</d><h>19:03</h><w>kyle_schmidt</w>thanks <a>@jaen</a> <a>@alandipert</a> !</z><z id="t1442689441" t="alandipert we looked into it for making something like https://github.com/awslabs/aws-lambda-redshift-loader , but then discovered that project existed. so we just deplyoed their node thing"><y>#</y><d>2015-09-19</d><h>19:04</h><w>alandipert</w>we looked into it for making something like <a href="https://github.com/awslabs/aws-lambda-redshift-loader" target="_blank">https://github.com/awslabs/aws-lambda-redshift-loader</a>, but then discovered that project existed. so we just deplyoed their node thing</z><z id="t1442694233" t="donmullen [:attrs {:href &quot;/_/_/users/U0AHGU9PV&quot;}] : Looks like Ben Vandgrift / Adam Hunter are giving a talk on using AWS’ Lambda services with clojure at the conj."><y>#</y><d>2015-09-19</d><h>20:23</h><w>donmullen</w><a>@kyle_schmidt</a>: Looks like Ben Vandgrift / Adam Hunter are giving a talk on using AWS’ Lambda services with clojure at the conj.</z><z id="t1442694235" t="donmullen http://clojure-conj.org/speakers"><y>#</y><d>2015-09-19</d><h>20:23</h><w>donmullen</w><a href="http://clojure-conj.org/speakers" target="_blank">http://clojure-conj.org/speakers</a></z><z id="t1442699009" t="kyle_schmidt Awesome! Thanks [:attrs {:href &quot;/_/_/users/U09AQ4KB2&quot;}] "><y>#</y><d>2015-09-19</d><h>21:43</h><w>kyle_schmidt</w>Awesome! Thanks <a>@donmullen</a> </z><z id="t1442734166" t="luposlip I really hope they&apos;ll put up all of their slide decks afterwards. Can&apos;t make it there myself. "><y>#</y><d>2015-09-20</d><h>07:29</h><w>luposlip</w>I really hope they&apos;ll put up all of their slide decks afterwards. Can&apos;t make it there myself. </z><z id="t1442745137" t="alandipert anyone noticing problems with AWS console?"><y>#</y><d>2015-09-20</d><h>10:32</h><w>alandipert</w>anyone noticing problems with AWS console?</z><z id="t1442745153" t="alandipert also dynamo in us-east is having problems, wonder if they&apos;re related"><y>#</y><d>2015-09-20</d><h>10:32</h><w>alandipert</w>also dynamo in us-east is having  problems, wonder if they&apos;re related</z><z id="t1442748491" t="lowl4tency Yes"><y>#</y><d>2015-09-20</d><h>11:28</h><w>lowl4tency</w>Yes</z><z id="t1442748497" t="lowl4tency I &apos;m facing it"><y>#</y><d>2015-09-20</d><h>11:28</h><w>lowl4tency</w>I &apos;m facing it</z><z id="t1442748546" t="lowl4tency Cloudtrail also has troubles"><y>#</y><d>2015-09-20</d><h>11:29</h><w>lowl4tency</w>Cloudtrail also has troubles</z><z id="t1442750289" t="lowl4tency alandipert: di you have any official info about?"><y>#</y><d>2015-09-20</d><h>11:58</h><w>lowl4tency</w>alandipert: di you have any official info about?</z><z id="t1442750307" t="alandipert 3:00 AM PDT We are investigating increased error rates for API requests in the US-EAST-1 Region. 3:26 AM PDT We are continuing to see increased error rates for all API calls in DynamoDB in US-East-1. We are actively working on resolving the issue. 4:05 AM PDT We have identified the source of the issue. We are working on the recovery. 4:41 AM PDT We continue to work towards recovery of the issue causing increased error rates for the DynamoDB APIs in the US-EAST-1 Region. 4:52 AM PDT We want to give you more information about what is happening. The root cause began with a portion of our metadata service within DynamoDB. This is an internal sub-service which manages table and partition information. Our recovery efforts are now focused on restoring metadata operations. We will be throttling APIs as we work on recovery."><y>#</y><d>2015-09-20</d><h>11:58</h><w>alandipert</w>3:00 AM PDT We are investigating increased error rates for API requests in the US-EAST-1 Region.
3:26 AM PDT We are continuing to see increased error rates for all API calls in DynamoDB in US-East-1. We are actively working on resolving the issue.
4:05 AM PDT We have identified the source of the issue. We are working on the recovery.
4:41 AM PDT We continue to work towards recovery of the issue causing increased error rates for the DynamoDB APIs in the US-EAST-1 Region.
4:52 AM PDT We want to give you more information about what is happening. The root cause began with a portion of our metadata service within DynamoDB. This is an internal sub-service which manages table and partition information. Our recovery efforts are now focused on restoring metadata operations. We will be throttling APIs as we work on recovery.</z><z id="t1442750311" t="alandipert from https://status.aws.amazon.com/"><y>#</y><d>2015-09-20</d><h>11:58</h><w>alandipert</w>from <a href="https://status.aws.amazon.com/" target="_blank">https://status.aws.amazon.com/</a></z><z id="t1442750349" t="alandipert seems like autoscale uses dynamo underneath, because i&apos;m not able to execute any policies"><y>#</y><d>2015-09-20</d><h>11:59</h><w>alandipert</w>seems like autoscale uses dynamo underneath, because i&apos;m not able to execute any policies</z><z id="t1442750359" t="lowl4tency Thank you"><y>#</y><d>2015-09-20</d><h>11:59</h><w>lowl4tency</w>Thank you</z><z id="t1442750370" t="lowl4tency It&apos;s very sad"><y>#</y><d>2015-09-20</d><h>11:59</h><w>lowl4tency</w>It&apos;s very sad</z><z id="t1442752727" t="lowl4tency moving to oregon &gt;_&gt;"><y>#</y><d>2015-09-20</d><h>12:38</h><w>lowl4tency</w>moving to oregon &gt;_&gt;</z><z id="t1442752990" t="lowl4tency Thanks god we have cloudformation"><y>#</y><d>2015-09-20</d><h>12:43</h><w>lowl4tency</w>Thanks god we have cloudformation</z><z id="t1442755251" t="alandipert SQS in us-east also down afaict"><y>#</y><d>2015-09-20</d><h>13:20</h><w>alandipert</w>SQS in us-east also down afaict</z><z id="t1442755257" t="alandipert awspocalypse"><y>#</y><d>2015-09-20</d><h>13:20</h><w>alandipert</w>awspocalypse</z><z id="t1442756660" t="lowl4tency quoted!"><y>#</y><d>2015-09-20</d><h>13:44</h><w>lowl4tency</w>quoted!</z><z id="t1442759040" t="luposlip 8-O"><y>#</y><d>2015-09-20</d><h>14:24</h><w>luposlip</w>8-O</z><z id="t1442760164" t="alandipert quite the bloodbath"><y>#</y><d>2015-09-20</d><h>14:42</h><w>alandipert</w>quite the bloodbath</z><z id="t1442760183" t="alandipert we&apos;re seeing improvement now though"><y>#</y><d>2015-09-20</d><h>14:43</h><w>alandipert</w>we&apos;re seeing improvement now though</z><z id="t1442771921" t="alandipert just wrote http://adzerk.com/blog/2015/09/team-learning-by-aar/"><y>#</y><d>2015-09-20</d><h>17:58</h><w>alandipert</w>just wrote <a href="http://adzerk.com/blog/2015/09/team-learning-by-aar/" target="_blank">http://adzerk.com/blog/2015/09/team-learning-by-aar/</a></z><z id="t1442772748" t="lowl4tency aws works"><y>#</y><d>2015-09-20</d><h>18:12</h><w>lowl4tency</w>aws works</z><z id="t1442826356" t="luposlip How do you guys overcome the normal delay of update, when deploying new versions using Beanstalk?"><y>#</y><d>2015-09-21</d><h>09:05</h><w>luposlip</w>How do you guys overcome the normal delay of update, when deploying new versions using Beanstalk?</z><z id="t1442834655" t="alandipert i&apos;m not aware of a workaround"><y>#</y><d>2015-09-21</d><h>11:24</h><w>alandipert</w>i&apos;m not aware of a workaround</z><z id="t1442835055" t="luposlip Not even using docker containers on top? Coming from Heroku, this is what I’m really hoping to find a solution for."><y>#</y><d>2015-09-21</d><h>11:30</h><w>luposlip</w>Not even using docker containers on top? Coming from Heroku, this is what I’m really hoping to find a solution for.</z><z id="t1442835260" t="alandipert afaict using docker on beanstalk makes for no faster deploys"><y>#</y><d>2015-09-21</d><h>11:34</h><w>alandipert</w>afaict using docker on beanstalk makes for no faster deploys</z><z id="t1442835759" t="luposlip ok, tnx."><y>#</y><d>2015-09-21</d><h>11:42</h><w>luposlip</w>ok, tnx.</z><z id="t1442835851" t="luposlip Other known alternative for Heroku-like speedy updates in prod with AWS?"><y>#</y><d>2015-09-21</d><h>11:44</h><w>luposlip</w>Other known alternative for Heroku-like speedy updates in prod with AWS?</z><z id="t1442836225" t="alandipert there is Dokku, which would give you the ease and speed, but not really the scalability"><y>#</y><d>2015-09-21</d><h>11:50</h><w>alandipert</w>there is Dokku, which would give you the ease and speed, but not really the scalability</z><z id="t1442836244" t="alandipert we have dokku on an EC2 and use it for little low-use apps behind our VPN"><y>#</y><d>2015-09-21</d><h>11:50</h><w>alandipert</w>we have dokku on an EC2 and use it for little low-use apps behind our VPN</z><z id="t1442836530" t="luposlip alright, tnx again! So when you deploy, you simply wait for DNS changes?"><y>#</y><d>2015-09-21</d><h>11:55</h><w>luposlip</w>alright, tnx again! So when you deploy, you simply wait for DNS changes?</z><z id="t1442836807" t="alandipert well, for the stuff we use dokku for, the weird URLs are ok"><y>#</y><d>2015-09-21</d><h>12:00</h><w>alandipert</w>well, for the stuff we use dokku for, the weird URLs are ok</z><z id="t1442836828" t="alandipert i&apos;m not sure what&apos;s involved in hooking up dokku to dns on ec2. but when i was looking for stuff, i did find lots of blog posts etc. so maybe there&apos;s a way"><y>#</y><d>2015-09-21</d><h>12:00</h><w>alandipert</w>i&apos;m not sure what&apos;s involved in hooking up dokku to dns on ec2. but when i was looking for stuff, i did find lots of blog posts etc. so maybe there&apos;s a way</z><z id="t1442842716" t="alandipert we are seeing elevated dynamo errors in east, awspocalypse might not be over"><y>#</y><d>2015-09-21</d><h>13:38</h><w>alandipert</w>we are seeing elevated dynamo errors in east, awspocalypse might not be over</z><z id="t1442842936" t="lowl4tency alandipert: I don&apos;t see errors btw"><y>#</y><d>2015-09-21</d><h>13:42</h><w>lowl4tency</w>alandipert: I don&apos;t see errors btw</z><z id="t1442842949" t="lowl4tency I recovered service yesterday and it works as expected"><y>#</y><d>2015-09-21</d><h>13:42</h><w>lowl4tency</w>I recovered service yesterday and it works as expected</z><z id="t1442843061" t="lowl4tency Datadog? simple_smile"><y>#</y><d>2015-09-21</d><h>13:44</h><w>lowl4tency</w>Datadog? <b>simple_smile</b></z><z id="t1442843094" t="alandipert yeah, it&apos;s sweet, although parts of it also went down with cloudwatch 😞"><y>#</y><d>2015-09-21</d><h>13:44</h><w>alandipert</w>yeah, it&apos;s sweet, although parts of it also went down with cloudwatch <b>😞</b></z><z id="t1442843263" t="lowl4tency yeah, cloudwatch and cloudtrail didn&apos;t work for me esterday as well"><y>#</y><d>2015-09-21</d><h>13:47</h><w>lowl4tency</w>yeah, cloudwatch and cloudtrail didn&apos;t work for me esterday as well</z><z id="t1442873277" t="ragge kinesis anyone?"><y>#</y><d>2015-09-21</d><h>22:07</h><w>ragge</w>kinesis anyone?</z><z id="t1442876228" t="alandipert yup"><y>#</y><d>2015-09-21</d><h>22:57</h><w>alandipert</w>yup</z><z id="t1442905871" t="ragge [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : would love to hear more at some point if you have a few mins"><y>#</y><d>2015-09-22</d><h>07:11</h><w>ragge</w><a>@alandipert</a>: would love to hear more at some point if you have a few mins</z><z id="t1442905874" t="ragge [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : we currently lean heavily on kafka... love the idea, not too fond of operating the implementation"><y>#</y><d>2015-09-22</d><h>07:11</h><w>ragge</w><a>@alandipert</a>: we currently lean heavily on kafka... love the idea, not too fond of operating the implementation</z><z id="t1442923312" t="alandipert [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : re: kinesis, afaict it&apos;s all the affordances of kafka without the ops overhead"><y>#</y><d>2015-09-22</d><h>12:01</h><w>alandipert</w><a>@ragge</a>: re: kinesis, afaict it&apos;s all the affordances of kafka without the ops overhead</z><z id="t1442923324" t="alandipert i&apos;ve never run kafka, but i can say our experience with kinesis has been good so far"><y>#</y><d>2015-09-22</d><h>12:02</h><w>alandipert</w>i&apos;ve never run kafka, but i can say our experience with kinesis has been good so far</z><z id="t1442923381" t="alandipert we have run into two minor problems with clients; lambda functions can only receive a maximum of 10k kinesis events per invocation, so we&apos;re not able to use lambdas for doing meaningful aggregation"><y>#</y><d>2015-09-22</d><h>12:03</h><w>alandipert</w>we have run into two minor problems with clients; lambda functions can only receive a maximum of 10k kinesis events per invocation, so we&apos;re not able to use lambdas for doing meaningful aggregation</z><z id="t1442923392" t="alandipert also Spark 1.4 doesn&apos;t reliably consume from kinesis but a fix is coming in 1.5 next week"><y>#</y><d>2015-09-22</d><h>12:03</h><w>alandipert</w>also Spark 1.4 doesn&apos;t reliably consume from kinesis but a fix is coming in 1.5 next week</z><z id="t1442923402" t="alandipert (we&apos;re running spark in EMR)"><y>#</y><d>2015-09-22</d><h>12:03</h><w>alandipert</w>(we&apos;re running spark in EMR)</z><z id="t1442923405" t="ragge ok cool"><y>#</y><d>2015-09-22</d><h>12:03</h><w>ragge</w>ok cool</z><z id="t1442923414" t="ragge we use kafka for basically all data transportation; logs, metrics, application data"><y>#</y><d>2015-09-22</d><h>12:03</h><w>ragge</w>we use kafka for basically all data transportation; logs, metrics, application data</z><z id="t1442923425" t="ragge do you archive stuff to s3?"><y>#</y><d>2015-09-22</d><h>12:03</h><w>ragge</w>do you archive stuff to s3?</z><z id="t1442923444" t="ragge or do you have other ways to re-process a stream?"><y>#</y><d>2015-09-22</d><h>12:04</h><w>ragge</w>or do you have other ways to re-process a stream?</z><z id="t1442923500" t="alandipert our events come from ad servers, on these servers we both push to kinesis and store to s3"><y>#</y><d>2015-09-22</d><h>12:05</h><w>alandipert</w>our events come from ad servers, on these servers we both push to kinesis and store to s3</z><z id="t1442923509" t="alandipert also we store as much as possible on those machines&apos; disks"><y>#</y><d>2015-09-22</d><h>12:05</h><w>alandipert</w>also we store as much as possible on those machines&apos; disks</z><z id="t1442923530" t="alandipert the thing we do is collect ad impressions, aggregate, and report on them"><y>#</y><d>2015-09-22</d><h>12:05</h><w>alandipert</w>the thing we do is collect ad impressions, aggregate, and report on them</z><z id="t1442923556" t="alandipert for the &quot;new&quot; kinesis stuff we go from ad server -&gt; kinesis -&gt; spark aggregation -&gt; s3 -&gt; lambda &quot;loader&quot; function -&gt; redshift"><y>#</y><d>2015-09-22</d><h>12:05</h><w>alandipert</w>for the &quot;new&quot; kinesis stuff we go from ad server -&gt; kinesis -&gt; spark aggregation -&gt; s3 -&gt; lambda &quot;loader&quot; function -&gt; redshift</z><z id="t1442923588" t="ragge ok, interesting"><y>#</y><d>2015-09-22</d><h>12:06</h><w>ragge</w>ok, interesting</z><z id="t1442923619" t="ragge have you found the scaling ok to work with? increasing/decreasing shards"><y>#</y><d>2015-09-22</d><h>12:06</h><w>ragge</w>have you found the scaling ok to work with? increasing/decreasing shards</z><z id="t1442924416" t="alandipert we haven&apos;t done much scaling yet, the rate on the impressino stream is pretty constant"><y>#</y><d>2015-09-22</d><h>12:20</h><w>alandipert</w>we haven&apos;t done much scaling yet, the rate on the impressino stream is pretty constant</z><z id="t1442924437" t="alandipert we still need to test resharding though"><y>#</y><d>2015-09-22</d><h>12:20</h><w>alandipert</w>we still need to test resharding though</z><z id="t1442924462" t="alandipert because we&apos;ll eventually need to scale up. the KCL claims to handle this without intervention, but haven&apos;t seen it in action yet"><y>#</y><d>2015-09-22</d><h>12:21</h><w>alandipert</w>because we&apos;ll eventually need to scale up. the KCL claims to handle this without intervention, but haven&apos;t seen it in action yet</z><z id="t1442924776" t="ragge thanks for the info"><y>#</y><d>2015-09-22</d><h>12:26</h><w>ragge</w>thanks for the info</z><z id="t1442924842" t="erik_price alandipert: what serialization do you use to write your events to S3? (assuming you write multiple events to a single S3 object)"><y>#</y><d>2015-09-22</d><h>12:27</h><w>erik_price</w>alandipert: what serialization do you use to write your events to S3? (assuming you write multiple events to a single S3 object)</z><z id="t1442924871" t="alandipert [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : sure, be curious to hear how it goes for you and trade more notes"><y>#</y><d>2015-09-22</d><h>12:27</h><w>alandipert</w><a>@ragge</a>: sure, be curious to hear how it goes for you and trade more notes</z><z id="t1442924889" t="alandipert [:attrs {:href &quot;/_/_/users/U06C4SCQY&quot;}] : newline-delimited JSON... mostly for historical reasons"><y>#</y><d>2015-09-22</d><h>12:28</h><w>alandipert</w><a>@erik_price</a>: newline-delimited JSON... mostly for historical reasons</z><z id="t1442924921" t="erik_price one line per event, S3 objects aggregating by some time interval?"><y>#</y><d>2015-09-22</d><h>12:28</h><w>erik_price</w>one line per event, S3 objects aggregating by some time interval?</z><z id="t1442924989" t="alandipert the &quot;raw&quot; impression log is one per event which goes on Kinesis, and then Spark aggregates into 30 minute intervals"><y>#</y><d>2015-09-22</d><h>12:29</h><w>alandipert</w>the &quot;raw&quot; impression log is one per event which goes on Kinesis, and then Spark aggregates into 30 minute intervals</z><z id="t1442925011" t="erik_price gotcha"><y>#</y><d>2015-09-22</d><h>12:30</h><w>erik_price</w>gotcha</z><z id="t1442925038" t="alandipert are you working on a reporting pipeline of some kind also?"><y>#</y><d>2015-09-22</d><h>12:30</h><w>alandipert</w>are you working on a reporting pipeline of some kind also?</z><z id="t1442925346" t="erik_price Just want to learn more about how other real-world deployments are doing this. We’re not capturing analytics events, but we run ingestion jobs periodically and the data we pull in gets written to S3. In our case the data is big enough that we have a one-item-to-one-S3-object relationship, but I am interested in how people are doing it with a larger number of smaller events."><y>#</y><d>2015-09-22</d><h>12:35</h><w>erik_price</w>Just want to learn more about how other real-world deployments are doing this. We’re not capturing analytics events, but we run ingestion jobs periodically and the data we pull in gets written to S3. In our case the data is big enough that we have a one-item-to-one-S3-object relationship, but I am interested in how people are doing it with a larger number of smaller events.</z><z id="t1442925661" t="alandipert cool"><y>#</y><d>2015-09-22</d><h>12:41</h><w>alandipert</w>cool</z><z id="t1442928391" t="ragge [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : quick follow up: do you use kpl when producing events?"><y>#</y><d>2015-09-22</d><h>13:26</h><w>ragge</w><a>@alandipert</a>: quick follow up: do you use kpl when producing events?</z><z id="t1442929574" t="alandipert [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : yeah, the node one"><y>#</y><d>2015-09-22</d><h>13:46</h><w>alandipert</w><a>@ragge</a>: yeah, the node one</z><z id="t1443014989" t="lowl4tency https://aws.amazon.com/message/5467D2/"><y>#</y><d>2015-09-23</d><h>13:29</h><w>lowl4tency</w><a href="https://aws.amazon.com/message/5467D2/" target="_blank">https://aws.amazon.com/message/5467D2/</a></z><z id="t1443014993" t="lowl4tency Post-mortem"><y>#</y><d>2015-09-23</d><h>13:29</h><w>lowl4tency</w>Post-mortem</z><z id="t1443016079" t="alandipert &quot;6:33 AM PDT We are investigating increased error rates for API requests in the US-EAST-1 Region.&quot; re: dynamo"><y>#</y><d>2015-09-23</d><h>13:47</h><w>alandipert</w>&quot;6:33 AM PDT We are investigating increased error rates for API requests in the US-EAST-1 Region.&quot; re: dynamo</z><z id="t1443016241" t="alandipert autoscaling also affected"><y>#</y><d>2015-09-23</d><h>13:50</h><w>alandipert</w>autoscaling also affected</z><z id="t1443016588" t="lowl4tency Yes, I was killing my instances for hope it starts on dynamodb in another region simple_smile"><y>#</y><d>2015-09-23</d><h>13:56</h><w>lowl4tency</w>Yes, I was killing my instances for hope it starts on dynamodb in another region <b>simple_smile</b></z><z id="t1443016611" t="lowl4tency And was waiting 3h while they fixing autoscaling 😞"><y>#</y><d>2015-09-23</d><h>13:56</h><w>lowl4tency</w>And was waiting 3h while they fixing autoscaling <b>😞</b></z><z id="t1443017496" t="mitchelkuijpers It seems DynamoDB has issues again"><y>#</y><d>2015-09-23</d><h>14:11</h><w>mitchelkuijpers</w>It seems DynamoDB has issues again</z><z id="t1443018915" t="lowl4tency Yes, my apps again working"><y>#</y><d>2015-09-23</d><h>14:35</h><w>lowl4tency</w>Yes, my apps again working</z><z id="t1443018929" t="lowl4tency It was interrupted for 10 mins"><y>#</y><d>2015-09-23</d><h>14:35</h><w>lowl4tency</w>It was interrupted for 10 mins</z><z id="t1443020091" t="clojuregeek have any of you guys worked with TOSCA at all? I want to convert cloudtrail event json to TOSCA yaml"><y>#</y><d>2015-09-23</d><h>14:54</h><w>clojuregeek</w>have any of you guys worked with TOSCA at all? I want to convert cloudtrail event json to TOSCA yaml</z><z id="t1443104786" t="alandipert just made this thing for generating lambda functions that take in S3 events and push to datadog, in case anyone could use https://github.com/adzerk-oss/S3DatadogLambda"><y>#</y><d>2015-09-24</d><h>14:26</h><w>alandipert</w>just made this thing for generating lambda functions that take in S3 events and push to datadog, in case anyone could use <a href="https://github.com/adzerk-oss/S3DatadogLambda" target="_blank">https://github.com/adzerk-oss/S3DatadogLambda</a></z><z id="t1443109256" t="lowl4tency alandipert: what costs are for the job?"><y>#</y><d>2015-09-24</d><h>15:40</h><w>lowl4tency</w>alandipert: what costs are for the job?</z><z id="t1443109271" t="lowl4tency I mean how much aws charges simple_smile"><y>#</y><d>2015-09-24</d><h>15:41</h><w>lowl4tency</w>I mean how much aws charges <b>simple_smile</b></z><z id="t1443110669" t="alandipert would depend on s3 event numbers for you, but you do get 1M free invocations per month"><y>#</y><d>2015-09-24</d><h>16:04</h><w>alandipert</w>would depend on s3 event numbers for you, but you do get 1M free invocations per month</z><z id="t1443191484" t="lowl4tency Does anyone get same? No data for errors from DynamoDB"><y>#</y><d>2015-09-25</d><h>14:31</h><w>lowl4tency</w>Does anyone get same? No data for errors from DynamoDB</z><z id="t1443191523" t="alandipert hmm, checking"><y>#</y><d>2015-09-25</d><h>14:32</h><w>alandipert</w>hmm, checking</z><z id="t1443191735" t="lowl4tency hm hm hm"><y>#</y><d>2015-09-25</d><h>14:35</h><w>lowl4tency</w>hm hm hm</z><z id="t1443191742" t="alandipert it looks like the spikes and gap in our throttle graph correspond"><y>#</y><d>2015-09-25</d><h>14:35</h><w>alandipert</w>it looks like the spikes and gap in our throttle graph correspond</z><z id="t1443191750" t="alandipert accounting for TZ"><y>#</y><d>2015-09-25</d><h>14:35</h><w>alandipert</w>accounting for TZ</z><z id="t1443191861" t="lowl4tency errrr"><y>#</y><d>2015-09-25</d><h>14:37</h><w>lowl4tency</w>errrr</z><z id="t1443191867" t="lowl4tency Where&apos;s my metrics P_P"><y>#</y><d>2015-09-25</d><h>14:37</h><w>lowl4tency</w>Where&apos;s my metrics P_P</z><z id="t1443192375" t="alandipert spooky"><y>#</y><d>2015-09-25</d><h>14:46</h><w>alandipert</w>spooky</z><z id="t1443196629" t="lowl4tency https://forums.aws.amazon.com/thread.jspa?threadID=216792"><y>#</y><d>2015-09-25</d><h>15:57</h><w>lowl4tency</w><a href="https://forums.aws.amazon.com/thread.jspa?threadID=216792" target="_blank">https://forums.aws.amazon.com/thread.jspa?threadID=216792</a></z><z id="t1443198837" t="lowl4tency alandipert: could you show your cloudwatch graphic of system error metrics pls"><y>#</y><d>2015-09-25</d><h>16:33</h><w>lowl4tency</w>alandipert: could you show your cloudwatch graphic of system error metrics pls</z><z id="t1443201433" t="lowl4tency We can&apos;t fix dynamodb ok, turn off metrics!"><y>#</y><d>2015-09-25</d><h>17:17</h><w>lowl4tency</w>We can&apos;t fix dynamodb ok, turn off metrics!</z><z id="t1443201439" t="alandipert oh sorry, cloudwatch"><y>#</y><d>2015-09-25</d><h>17:17</h><w>alandipert</w>oh sorry, cloudwatch</z><z id="t1443201482" t="lowl4tency I &apos;ve got empty CW and datadog graphics for system errors"><y>#</y><d>2015-09-25</d><h>17:18</h><w>lowl4tency</w>I &apos;ve got empty  CW and datadog graphics for system errors</z><z id="t1443201483" t="lowl4tency 😞"><y>#</y><d>2015-09-25</d><h>17:18</h><w>lowl4tency</w><b>😞</b></z><z id="t1443201495" t="lowl4tency it&apos;s us-east-1 region?"><y>#</y><d>2015-09-25</d><h>17:18</h><w>lowl4tency</w>it&apos;s us-east-1 region?</z><z id="t1443201507" t="alandipert yeah"><y>#</y><d>2015-09-25</d><h>17:18</h><w>alandipert</w>yeah</z><z id="t1443266160" t="luposlip Right now I’m pretty happy I don’t use Dynamo yet. Would you guys still recommend me using it (I’m using Datomic already) going forward?"><y>#</y><d>2015-09-26</d><h>11:16</h><w>luposlip</w>Right now I’m pretty happy I don’t use Dynamo yet. Would you guys still recommend me using it (I’m using Datomic already) going forward?</z><z id="t1443278844" t="bhagany [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] : I&apos;m pretty much in the same place as you, happy I haven&apos;t deployed my Datomic project yet. fwiw, I&apos;m still planning on using Dynamo, but I would like to see a week or so of stability first."><y>#</y><d>2015-09-26</d><h>14:47</h><w>bhagany</w><a>@luposlip</a>: I&apos;m pretty much in the same place as you, happy I haven&apos;t deployed my Datomic project yet.  fwiw, I&apos;m still planning on using Dynamo, but I would like to see a week or so of stability first.</z><z id="t1443281041" t="ragge [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] [:attrs {:href &quot;/_/_/users/U051706GF&quot;}] Some things that are good to know about Datomic and Datomic on DynamoDB: https://martintrojer.github.io/clojure/2015/06/03/datomic-dos-and-donts/"><y>#</y><d>2015-09-26</d><h>15:24</h><w>ragge</w><a>@luposlip</a> <a>@bhagany</a> Some things that are good to know about Datomic and Datomic on DynamoDB: <a href="https://martintrojer.github.io/clojure/2015/06/03/datomic-dos-and-donts/" target="_blank">https://martintrojer.github.io/clojure/2015/06/03/datomic-dos-and-donts/</a></z><z id="t1443282415" t="luposlip :thumbsup: "><y>#</y><d>2015-09-26</d><h>15:46</h><w>luposlip</w><b>:thumbsup:</b> </z><z id="t1443292525" t="micha dynamo seems to have stabilized for the past couple of days"><y>#</y><d>2015-09-26</d><h>18:35</h><w>micha</w>dynamo seems to have stabilized for the past couple of days</z><z id="t1443387222" t="lowl4tency micha: yes, but I haven&apos;t got system errors metrics yet"><y>#</y><d>2015-09-27</d><h>20:53</h><w>lowl4tency</w>micha: yes, but I haven&apos;t got system errors metrics yet</z><z id="t1443387239" t="lowl4tency No metrics - no problems"><y>#</y><d>2015-09-27</d><h>20:53</h><w>lowl4tency</w>No metrics - no problems</z><z id="t1444135829" t="mitchelkuijpers Anybody running datomic on ECS / docker?"><y>#</y><d>2015-10-06</d><h>12:50</h><w>mitchelkuijpers</w>Anybody running datomic on ECS / docker?</z><z id="t1444151042" t="clojuregeek for those of you using aws lambda functions .. how is your gen-class setup? (:gen-class :methods [^:static [translate [Object] String]]) "><y>#</y><d>2015-10-06</d><h>17:04</h><w>clojuregeek</w>for those of you using aws lambda functions .. how is your gen-class setup? 
<pre>(:gen-class
   :methods [^:static [translate [Object] String]])
</pre></z><z id="t1444151095" t="clojuregeek i want to send the payload (chunk of json) to my translate function.. but.. i can&apos;t parse it... tried [String] String and [Object] String"><y>#</y><d>2015-10-06</d><h>17:04</h><w>clojuregeek</w>i want to send the payload (chunk of json) to my translate function.. but.. i can&apos;t parse it... tried [String] String   and [Object] String</z><z id="t1444716747" t="maleghast Anyone prepared to share what they are doing about repeatability and configuration on AWS..? Clearly OpsWorks is already there, and that’s Chef by another name as far as I can tell, but it’s clear that Puppet and Ansible are both becoming or are already very AWS friendly… I am planning a personal development that I want to be able to orchestrate, but I am new to doing the DevOps Toolchain for myself and I am hoping someone is prepared to state a preference based on having walked this road ahead of me..?"><y>#</y><d>2015-10-13</d><h>06:12</h><w>maleghast</w>Anyone prepared to share what they are doing about repeatability and configuration on AWS..?  Clearly OpsWorks is already there, and that’s Chef by another name as far as I can tell, but it’s clear that Puppet and Ansible are both becoming or are already very AWS friendly…  I am planning a personal development that I want to be able to orchestrate, but I am new to doing the DevOps Toolchain for myself and I am hoping someone is prepared to state a preference based on having walked this road ahead of me..?</z><z id="t1444735540" t="robert-stuttaford [:attrs {:href &quot;/_/_/users/U08ABGP70&quot;}] : we went with CloudFormation. more upfront work, but better long term, as it’s the most configurable. infrastructure as data."><y>#</y><d>2015-10-13</d><h>11:25</h><w>robert-stuttaford</w><a>@maleghast</a>: we went with CloudFormation. more upfront work, but better long term, as it’s the most configurable. infrastructure as data.</z><z id="t1444735567" t="robert-stuttaford we update and push github repo and circleci’s post-test hook invokes cfn and updates infra"><y>#</y><d>2015-10-13</d><h>11:26</h><w>robert-stuttaford</w>we update and push github repo and circleci’s post-test hook invokes cfn and updates infra</z><z id="t1444735617" t="robert-stuttaford our instances are very simple, so we didn’t need a whole abstraction for that. java + jar + monitoring and log-tail agents"><y>#</y><d>2015-10-13</d><h>11:26</h><w>robert-stuttaford</w>our instances are very simple, so we didn’t need a whole abstraction for that. java + jar + monitoring and log-tail agents</z><z id="t1444735637" t="robert-stuttaford [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] can answer in more detail simple_smile"><y>#</y><d>2015-10-13</d><h>11:27</h><w>robert-stuttaford</w><a>@lowl4tency</a> can answer in more detail <b>simple_smile</b></z><z id="t1444735836" t="lowl4tency Yes, Robert are right in main line of our processes."><y>#</y><d>2015-10-13</d><h>11:30</h><w>lowl4tency</w>Yes, Robert are right in main line of our processes.</z><z id="t1444735887" t="lowl4tency maleghast: i suggest to use same tools as you use for main development. I suggest also to take a look on containers"><y>#</y><d>2015-10-13</d><h>11:31</h><w>lowl4tency</w>maleghast: i suggest to use same tools as you use for main development. I suggest also to take a look on containers</z><z id="t1444742813" t="sarcilav as lowl4tency says try the containers thing (it was announced last week ECS), it uses CloudFormation beneath it"><y>#</y><d>2015-10-13</d><h>13:26</h><w>sarcilav</w>as lowl4tency says try the containers thing (it was announced last week ECS), it uses CloudFormation beneath it</z><z id="t1444744588" t="lowl4tency I suggest try it locally first, if it&apos;s your first expirience"><y>#</y><d>2015-10-13</d><h>13:56</h><w>lowl4tency</w>I suggest try it locally first, if it&apos;s your first expirience</z><z id="t1444744631" t="lowl4tency I also highly recommend to take a look on https://www.packer.io/docs/builders/docker.html"><y>#</y><d>2015-10-13</d><h>13:57</h><w>lowl4tency</w>I also highly recommend to take a look on <a href="https://www.packer.io/docs/builders/docker.html" target="_blank">https://www.packer.io/docs/builders/docker.html</a></z><z id="t1444744659" t="lowl4tency and other tools by hashicorp such as consul, vagrant etc"><y>#</y><d>2015-10-13</d><h>13:57</h><w>lowl4tency</w>and other tools by hashicorp such as consul, vagrant etc</z><z id="t1444749376" t="clojuregeek I&apos;ve been successful at making a clojure uberjar to run as a lambda function on AWS. Now trying to get it to post messages to SQS with not much success, but I&apos;m still working on it simple_smile"><y>#</y><d>2015-10-13</d><h>15:16</h><w>clojuregeek</w>I&apos;ve been successful at making a clojure uberjar to run as a lambda function on AWS. Now trying to get it to post messages to SQS with not much success, but I&apos;m still working on it <b>simple_smile</b></z><z id="t1444749509" t="sarcilav [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : does aws lambda preload the jvm for you? or do you have to count the jvm load time into your lambdas?"><y>#</y><d>2015-10-13</d><h>15:18</h><w>sarcilav</w><a>@clojuregeek</a>: does aws lambda preload the jvm for you? or do you have to count the jvm load time into your lambdas?</z><z id="t1444749597" t="clojuregeek [:attrs {:href &quot;/_/_/users/U0C5L73ST&quot;}] : i just choose java8 as my env and it works"><y>#</y><d>2015-10-13</d><h>15:19</h><w>clojuregeek</w><a>@sarcilav</a>: i just choose java8 as my env and it works</z><z id="t1444749599" t="alandipert they&apos;re doing something special, last i tried clojure + lambda it was quite snappy"><y>#</y><d>2015-10-13</d><h>15:19</h><w>alandipert</w>they&apos;re doing something special, last i tried clojure + lambda it was quite snappy</z><z id="t1444749610" t="clojuregeek yeah it seems to be good"><y>#</y><d>2015-10-13</d><h>15:20</h><w>clojuregeek</w>yeah it seems to be good</z><z id="t1444749674" t="sarcilav mmm, nice to know, going to try later today"><y>#</y><d>2015-10-13</d><h>15:21</h><w>sarcilav</w>mmm, nice to know, going to try later today</z><z id="t1444749675" t="sarcilav thanks"><y>#</y><d>2015-10-13</d><h>15:21</h><w>sarcilav</w>thanks</z><z id="t1444751735" t="clojuregeek i used this tutorial https://aws.amazon.com/blogs/compute/clojure/"><y>#</y><d>2015-10-13</d><h>15:55</h><w>clojuregeek</w>i used this tutorial <a href="https://aws.amazon.com/blogs/compute/clojure/" target="_blank">https://aws.amazon.com/blogs/compute/clojure/</a></z><z id="t1444751891" t="clojuregeek I have also made a lambda function with https://github.com/uswitch/lambada"><y>#</y><d>2015-10-13</d><h>15:58</h><w>clojuregeek</w>I have also made a lambda function with <a href="https://github.com/uswitch/lambada" target="_blank">https://github.com/uswitch/lambada</a></z><z id="t1444753393" t="tbrooke [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : Do you guys have a boot task for Clojure on Lambda? What about Castra and or Hoplon on Lambda"><y>#</y><d>2015-10-13</d><h>16:23</h><w>tbrooke</w><a>@alandipert</a>: Do you guys have a boot task for Clojure on Lambda? What about Castra and or Hoplon on Lambda</z><z id="t1444759449" t="alandipert [:attrs {:href &quot;/_/_/users/U054219BT&quot;}] : we don&apos;t have a boot task for it, but castra on lambda is very interesting indeed"><y>#</y><d>2015-10-13</d><h>18:04</h><w>alandipert</w><a>@tbrooke</a>: we don&apos;t have a boot task for it, but castra on lambda is very interesting indeed</z><z id="t1444760353" t="raywillig [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : notice the lambada docs: &quot;Simplest way to deploy is to create an uberjar using leiningen or boot &quot; 👍"><y>#</y><d>2015-10-13</d><h>18:19</h><w>raywillig</w><a>@alandipert</a>:  notice the lambada docs: &quot;Simplest way to deploy is to create an uberjar using leiningen or boot &quot; <b>👍</b></z><z id="t1444760380" t="erik_price We’re using CloudFormation too. At first we thought it was the bees’ knees, but we’ve run into some problems as we’ve tried to refactor it. First, we ran into the 200-resource limit per stack. Now we’re refactoring into multiple stacks, but it’s somewhat tricky, because many of the resources need to be unique (think DNS settings etc), and CloudFormation wants to create new instances of those resources for the new stacks before it deletes them from the old stack, etc."><y>#</y><d>2015-10-13</d><h>18:19</h><w>erik_price</w>We’re using CloudFormation too. At first we thought it was the bees’ knees, but we’ve run into some problems as we’ve tried to refactor it. First, we ran into the 200-resource limit per stack. Now we’re refactoring into multiple stacks, but it’s somewhat tricky, because many of the resources need to be unique (think DNS settings etc), and CloudFormation wants to create new instances of those resources for the new stacks before it deletes them from the old stack, etc.</z><z id="t1444803663" t="lowl4tency clojuregeek: is it opensource project? simple_smile"><y>#</y><d>2015-10-14</d><h>06:21</h><w>lowl4tency</w>clojuregeek: is it opensource project? <b>simple_smile</b></z><z id="t1444834453" t="clojuregeek [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : to what are you referring to?"><y>#</y><d>2015-10-14</d><h>14:54</h><w>clojuregeek</w><a>@lowl4tency</a>: to what are you referring to?</z><z id="t1444837106" t="upgradingdave hey all, just curious, is anyone using pallet to manage their ec2 instances?"><y>#</y><d>2015-10-14</d><h>15:38</h><w>upgradingdave</w>hey all, just curious, is anyone using pallet to manage their ec2 instances?</z><z id="t1444839108" t="lowl4tency I refer to clojure and lambda"><y>#</y><d>2015-10-14</d><h>16:11</h><w>lowl4tency</w>I refer to clojure and lambda</z><z id="t1444843781" t="clojuregeek [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : oh.. no... not open source yet.. maybe later ... i&apos;ll see if i can abstract the basics and put into a post on http://www.clojuregeek.com"><y>#</y><d>2015-10-14</d><h>17:29</h><w>clojuregeek</w><a>@lowl4tency</a>: oh.. no... not open source yet.. maybe later ... i&apos;ll see if i can abstract the basics and put into a post on <a href="http://www.clojuregeek.com" target="_blank">http://www.clojuregeek.com</a></z><z id="t1444945047" t="alandipert PSA cloudflare having problems on us east coast, https://www.cloudflarestatus.com/"><y>#</y><d>2015-10-15</d><h>21:37</h><w>alandipert</w>PSA cloudflare having problems on us east coast, <a href="https://www.cloudflarestatus.com/" target="_blank">https://www.cloudflarestatus.com/</a></z><z id="t1445009349" t="lowl4tency clojuregeek: just interesting to take a look on the solution. I&apos;ve saw only abstract posts about clojure code into aws lambda and very small examples"><y>#</y><d>2015-10-16</d><h>15:29</h><w>lowl4tency</w>clojuregeek: just interesting to take a look on the solution. I&apos;ve saw only abstract posts about clojure code into aws lambda and very small examples</z><z id="t1445009385" t="lowl4tency I want to try it, but don&apos;t see an usecase for my purposes"><y>#</y><d>2015-10-16</d><h>15:29</h><w>lowl4tency</w>I want to try it, but don&apos;t see an usecase for my purposes</z><z id="t1445009819" t="clojuregeek [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : so far i have used it for converting cloudtrail logs in json to tosca yaml ... so I post the json as input and convert it. A later version posted the converted yaml to SQS"><y>#</y><d>2015-10-16</d><h>15:36</h><w>clojuregeek</w><a>@lowl4tency</a>: so far i have used it for converting cloudtrail logs in json to tosca yaml  ... so I post the json as input and convert it. A later version posted the converted yaml to SQS</z><z id="t1445009840" t="lowl4tency clojuregeek: what about costs?"><y>#</y><d>2015-10-16</d><h>15:37</h><w>lowl4tency</w>clojuregeek: what about costs?</z><z id="t1445009845" t="lowl4tency is it cheap?"><y>#</y><d>2015-10-16</d><h>15:37</h><w>lowl4tency</w>is it cheap?</z><z id="t1445009901" t="clojuregeek have not been worried about it, we are doing a POC"><y>#</y><d>2015-10-16</d><h>15:38</h><w>clojuregeek</w>have not been worried about it, we are doing a POC</z><z id="t1445010371" t="lowl4tency clojuregeek: it&apos; interesting usecase, I&apos;ve got datomic logs on a s3 bucket and it would be nice to have it in another system like papertrail"><y>#</y><d>2015-10-16</d><h>15:46</h><w>lowl4tency</w>clojuregeek: it&apos; interesting usecase, I&apos;ve got datomic logs on a s3 bucket and it would be nice to have it in another system like papertrail</z><z id="t1445010409" t="clojuregeek have you considered Amazon Pipeline for that ?"><y>#</y><d>2015-10-16</d><h>15:46</h><w>clojuregeek</w>have you considered Amazon Pipeline for that ?</z><z id="t1445010439" t="lowl4tency nope"><y>#</y><d>2015-10-16</d><h>15:47</h><w>lowl4tency</w>nope</z><z id="t1445010456" t="lowl4tency haven&apos;t used pipeline at all hnestly"><y>#</y><d>2015-10-16</d><h>15:47</h><w>lowl4tency</w>haven&apos;t used pipeline at all hnestly</z><z id="t1445010459" t="clojuregeek I haven&apos;t used pipeline"><y>#</y><d>2015-10-16</d><h>15:47</h><w>clojuregeek</w>I haven&apos;t used pipeline</z><z id="t1445551345" t="clojuregeek Has anyone been able to use https://github.com/mcohen01/amazonica inside a lambda and it pick up the creds of the lambda key/secret??"><y>#</y><d>2015-10-22</d><h>22:02</h><w>clojuregeek</w>Has anyone been able to use <a href="https://github.com/mcohen01/amazonica" target="_blank">https://github.com/mcohen01/amazonica</a> inside a lambda and it pick up the creds of the lambda key/secret??</z><z id="t1445551425" t="clojuregeek this works (System/getenv &quot;AWS_SECRET_ACCESS_KEY&quot;) To print out to a log message.. but when i try to lein uberjar it seems like it is trying to read the env of my local machine (which is nil) and amazonica gives me &quot;no creds&quot; error"><y>#</y><d>2015-10-22</d><h>22:03</h><w>clojuregeek</w>this works
<pre>(System/getenv &quot;AWS_SECRET_ACCESS_KEY&quot;)
</pre>
To print out to a log message.. but when i try to <code>lein uberjar</code> it seems like it is trying to read the env of my local machine (which is nil) and amazonica gives me &quot;no creds&quot; error</z><z id="t1445572890" t="chris_johnson I could be wrong about this since I don’t know your use-case and haven’t done much with Lambda in anger, but should you not be assigning IAM roles to your Lamba functions that have the perms you need?"><y>#</y><d>2015-10-23</d><h>04:01</h><w>chris_johnson</w>I could be wrong about this since I don’t know your use-case and haven’t done much with Lambda in anger, but should you not be assigning IAM roles to your Lamba functions that have the perms you need?</z><z id="t1445572929" t="chris_johnson I fee like looking for key-pair creds inside a Lambda function is something of an anti-pattern"><y>#</y><d>2015-10-23</d><h>04:02</h><w>chris_johnson</w>I fee like looking for key-pair creds inside a Lambda function is something of an anti-pattern</z><z id="t1445587011" t="ragge [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : what [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] said, use an IAM profile with appropriate permissions, aws-sdk (through amazonica) should pick that up"><y>#</y><d>2015-10-23</d><h>07:56</h><w>ragge</w><a>@clojuregeek</a>: what <a>@chris_johnson</a> said, use an IAM profile with appropriate permissions, aws-sdk (through amazonica) should pick that up</z><z id="t1445587071" t="ragge [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : also, if you get your local machines env that means that you&apos;re calling System/getenv at compile-time, instead of runtime, which would happen if you for example had:"><y>#</y><d>2015-10-23</d><h>07:57</h><w>ragge</w><a>@clojuregeek</a>: also, if you get your local machines env that means that you&apos;re calling <code>System/getenv</code> at compile-time, instead of runtime, which would happen if you for example had:</z><z id="t1445587094" t="ragge (def aws-secret-access-key (System/getenv &quot;AWS_SECRET_ACCESS_KEY&quot;)) "><y>#</y><d>2015-10-23</d><h>07:58</h><w>ragge</w><pre>(def aws-secret-access-key  (System/getenv &quot;AWS_SECRET_ACCESS_KEY&quot;))
</pre></z><z id="t1445608339" t="clojuregeek [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] (def instances (ec2/describe-instances creds)) the code uses amazonica library"><y>#</y><d>2015-10-23</d><h>13:52</h><w>clojuregeek</w><a>@ragge</a>:   <a>@chris_johnson</a>    <code>(def instances (ec2/describe-instances creds))</code>   the code uses amazonica library</z><z id="t1445608443" t="clojuregeek I ended up passing the creds to the function which worked out better in the long run"><y>#</y><d>2015-10-23</d><h>13:54</h><w>clojuregeek</w>I ended up passing the creds to the function which worked out better in the long run</z><z id="t1445610527" t="chris_johnson [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : that’s an interesting case - do you expect the Lambda function to be getting instance metadata for some credentials, or always a known account/role/keypair?"><y>#</y><d>2015-10-23</d><h>14:28</h><w>chris_johnson</w><a>@clojuregeek</a>: that’s an interesting case - do you expect the Lambda function to be getting instance metadata for some credentials, or always a known account/role/keypair?</z><z id="t1445610552" t="chris_johnson Now I’m interested enough in this to try and work up an example, if time allows this afternoon. simple_smile"><y>#</y><d>2015-10-23</d><h>14:29</h><w>chris_johnson</w>Now I’m interested enough in this to try and work up an example, if time allows this afternoon. <b>simple_smile</b></z><z id="t1445610676" t="ragge [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : just be aware that if you do (def instances (ec2/describe-instances creds)) and that namespace is AOT compiled then the call to ec2 will be executed at compile time"><y>#</y><d>2015-10-23</d><h>14:31</h><w>ragge</w><a>@clojuregeek</a>: just be aware that if you do <code>(def instances (ec2/describe-instances creds))</code> and that namespace is AOT compiled then the call to ec2 will be executed at compile time</z><z id="t1445610702" t="ragge [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : just like (def x (println &quot;Hello&quot;))"><y>#</y><d>2015-10-23</d><h>14:31</h><w>ragge</w><a>@clojuregeek</a>: just like <code>(def x (println &quot;Hello&quot;))</code></z><z id="t1445807274" t="clojuregeek [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : ok yes, it is AOT compiled .. into a jar file that I host as lambda .."><y>#</y><d>2015-10-25</d><h>21:07</h><w>clojuregeek</w><a>@ragge</a>: ok yes, it is AOT compiled .. into a jar file that I host as lambda ..</z><z id="t1446053207" t="rasputnik I saw lambada the other day (for clojure on Lambda) - is there a similar library you can use with CLJS?"><y>#</y><d>2015-10-28</d><h>17:26</h><w>rasputnik</w>I saw lambada the other day (for clojure on Lambda) - is there a similar library you can use with CLJS?</z><z id="t1446059457" t="bhagany [:attrs {:href &quot;/_/_/users/U074280RE&quot;}] : there is - https://github.com/nervous-systems/cljs-lambda . I&apos;ve been using it successfully."><y>#</y><d>2015-10-28</d><h>19:10</h><w>bhagany</w><a>@rasputnik</a>: there is - <a href="https://github.com/nervous-systems/cljs-lambda" target="_blank">https://github.com/nervous-systems/cljs-lambda</a>.  I&apos;ve been using it successfully.</z><z id="t1446066348" t="rasputnik [:attrs {:href &quot;/_/_/users/U051706GF&quot;}] : nice one, thanks"><y>#</y><d>2015-10-28</d><h>21:05</h><w>rasputnik</w><a>@bhagany</a>: nice one, thanks</z><z id="t1446135704" t="tangrammer Hi guys, anyone knows about aws lambda with datomic ? I&apos;m struggling with this topic https://groups.google.com/forum/#!topic/datomic/OYJ4ghelmF0"><y>#</y><d>2015-10-29</d><h>16:21</h><w>tangrammer</w>Hi guys, anyone knows about aws lambda with datomic ? I&apos;m struggling with this topic <a href="https://groups.google.com/forum/#!topic/datomic/OYJ4ghelmF0" target="_blank">https://groups.google.com/forum/#!topic/datomic/OYJ4ghelmF0</a></z><z id="t1446436920" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : Ping"><y>#</y><d>2015-11-02</d><h>04:02</h><w>cfleming</w><a>@alandipert</a>: Ping</z><z id="t1446436924" t="alandipert here"><y>#</y><d>2015-11-02</d><h>04:02</h><w>alandipert</w>here</z><z id="t1446436934" t="cfleming I haven’t looked at Kinesis yet"><y>#</y><d>2015-11-02</d><h>04:02</h><w>cfleming</w>I haven’t looked at Kinesis yet</z><z id="t1446436984" t="alandipert it&apos;s pretty neat"><y>#</y><d>2015-11-02</d><h>04:03</h><w>alandipert</w>it&apos;s pretty neat</z><z id="t1446436990" t="alandipert basically kafka on AWS, if you are familiar"><y>#</y><d>2015-11-02</d><h>04:03</h><w>alandipert</w>basically kafka on AWS, if you are familiar</z><z id="t1446437088" t="cfleming Only vaguely."><y>#</y><d>2015-11-02</d><h>04:04</h><w>cfleming</w>Only vaguely.</z><z id="t1446437139" t="cfleming So would the best thing be to put data right into Kinesis from the API endpoint, and then pull off and only mark as processed when it’s successfully written?"><y>#</y><d>2015-11-02</d><h>04:05</h><w>cfleming</w>So would the best thing be to put data right into Kinesis from the API endpoint, and then pull off and only mark as processed when it’s successfully written?</z><z id="t1446437300" t="alandipert the cool thing is the various consumers of the kinesis stream you may have maintain their own idea of where in the stream they are"><y>#</y><d>2015-11-02</d><h>04:08</h><w>alandipert</w>the cool thing is the various consumers of the kinesis stream you may have maintain their own idea of where in the stream they are</z><z id="t1446437335" t="alandipert and if your consumers use the kinesis consumer library to do their receiving, this is handled automatically by the library, which stores things in dynamo"><y>#</y><d>2015-11-02</d><h>04:08</h><w>alandipert</w>and if your consumers use the kinesis consumer library to do their receiving, this is handled automatically by the library, which stores things in dynamo</z><z id="t1446437395" t="cfleming So if that stores in dynamo, do I actually gain any robustness by using kinesis?"><y>#</y><d>2015-11-02</d><h>04:09</h><w>cfleming</w>So if that stores in dynamo, do I actually gain any robustness by using kinesis?</z><z id="t1446437455" t="alandipert well, the robustness of aws things is a factor of scale"><y>#</y><d>2015-11-02</d><h>04:10</h><w>alandipert</w>well, the robustness of aws things is a factor of scale</z><z id="t1446437461" t="alandipert considering the scale it can go, it&apos;s very robust"><y>#</y><d>2015-11-02</d><h>04:11</h><w>alandipert</w>considering the scale it can go, it&apos;s very robust</z><z id="t1446437491" t="alandipert but maybe not as robust as a smaller thing with fewer AWS dependencies"><y>#</y><d>2015-11-02</d><h>04:11</h><w>alandipert</w>but maybe not as robust as a smaller thing with fewer AWS dependencies</z><z id="t1446437513" t="cfleming Yeah, I see."><y>#</y><d>2015-11-02</d><h>04:11</h><w>cfleming</w>Yeah, I see.</z><z id="t1446437555" t="cfleming It’s hard to tell whether it’s more or less robust than a single server with dodgy monitoring set up by a monkey (me)"><y>#</y><d>2015-11-02</d><h>04:12</h><w>cfleming</w>It’s hard to tell whether it’s more or less robust than a single server with dodgy monitoring set up by a monkey (me)</z><z id="t1446437642" t="cfleming Looks like I can’t shovel data from an API endpoint right into Kinesis, sadly"><y>#</y><d>2015-11-02</d><h>04:14</h><w>cfleming</w>Looks like I can’t shovel data from an API endpoint right into Kinesis, sadly</z><z id="t1446437666" t="cfleming If I have to worry about the data consumer going down anyway, I think I’d just put it right in Dynamo"><y>#</y><d>2015-11-02</d><h>04:14</h><w>cfleming</w>If I have to worry about the data consumer going down anyway, I think I’d just put it right in Dynamo</z><z id="t1446437684" t="cfleming And then on any error just send a detailed email via something non-AWS (mailgun)"><y>#</y><d>2015-11-02</d><h>04:14</h><w>cfleming</w>And then on any error just send a detailed email via something non-AWS (mailgun)</z><z id="t1446437759" t="alandipert that sounds legit"><y>#</y><d>2015-11-02</d><h>04:15</h><w>alandipert</w>that sounds legit</z><z id="t1446437860" t="cfleming Much as I would like to think that thousands of people will be purchasing Cursive per second, I suspect I’m unlikely to have a legitimate big data problem simple_smile"><y>#</y><d>2015-11-02</d><h>04:17</h><w>cfleming</w>Much as I would like to think that thousands of people will be purchasing Cursive per second, I suspect I’m unlikely to have a legitimate big data problem <b>simple_smile</b></z><z id="t1446437980" t="alandipert hehe"><y>#</y><d>2015-11-02</d><h>04:19</h><w>alandipert</w>hehe</z><z id="t1446437987" t="alandipert maybe immutant is in your ballpark?"><y>#</y><d>2015-11-02</d><h>04:19</h><w>alandipert</w>maybe immutant is in your ballpark?</z><z id="t1446437997" t="alandipert i&apos;ve looked at it for medium projects, seems like a nice way to arrange things"><y>#</y><d>2015-11-02</d><h>04:19</h><w>alandipert</w>i&apos;ve looked at it for medium projects, seems like a nice way to arrange things</z><z id="t1446438015" t="alandipert that also gives you a nice layer between you and the linode os"><y>#</y><d>2015-11-02</d><h>04:20</h><w>alandipert</w>that also gives you a nice layer between you and the linode os</z><z id="t1446438152" t="cfleming My main goal isn’t gigantic scale, it’s not having to maintain and monitor things."><y>#</y><d>2015-11-02</d><h>04:22</h><w>cfleming</w>My main goal isn’t gigantic scale, it’s not having to maintain and monitor things.</z><z id="t1446438187" t="cfleming I’m still fairly tempted by something bare-bones with just an embedded k/v store on my server, but Lambda seems like a pretty easy option."><y>#</y><d>2015-11-02</d><h>04:23</h><w>cfleming</w>I’m still fairly tempted by something bare-bones with just an embedded k/v store on my server, but Lambda seems like a pretty easy option.</z><z id="t1446438213" t="cfleming And in theory, it should just stay working once I have it set up."><y>#</y><d>2015-11-02</d><h>04:23</h><w>cfleming</w>And in theory, it should just stay working once I have it set up.</z><z id="t1446438302" t="alandipert one of my favorite things about lambda is it automatically does what most bad programs need done"><y>#</y><d>2015-11-02</d><h>04:25</h><w>alandipert</w>one of my favorite things about lambda is it automatically does what most bad programs need done</z><z id="t1446438306" t="alandipert on some basis"><y>#</y><d>2015-11-02</d><h>04:25</h><w>alandipert</w>on some basis</z><z id="t1446438308" t="alandipert which is, be restarted"><y>#</y><d>2015-11-02</d><h>04:25</h><w>alandipert</w>which is, be restarted</z><z id="t1446438362" t="cfleming Doesn’t it just get its dodgy state serialised?"><y>#</y><d>2015-11-02</d><h>04:26</h><w>cfleming</w>Doesn’t it just get its dodgy state serialised?</z><z id="t1446438437" t="alandipert heh, true"><y>#</y><d>2015-11-02</d><h>04:27</h><w>alandipert</w>heh, true</z><z id="t1446438447" t="alandipert especially if it&apos;s doing something useful and writing to dynamo"><y>#</y><d>2015-11-02</d><h>04:27</h><w>alandipert</w>especially if it&apos;s doing something useful and writing to dynamo</z><z id="t1446476568" t="erik_price &gt; My main goal isn’t gigantic scale, it’s not having to maintain and monitor things What about something like GAE?"><y>#</y><d>2015-11-02</d><h>15:02</h><w>erik_price</w>&gt; My main goal isn’t gigantic scale, it’s not having to maintain and monitor things

What about something like GAE?</z><z id="t1446476579" t="erik_price (I’ve never actually used GAE)"><y>#</y><d>2015-11-02</d><h>15:02</h><w>erik_price</w>(I’ve never actually used GAE)</z><z id="t1448038313" t="raywillig [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : are you using lambada for your lambda stuff?"><y>#</y><d>2015-11-20</d><h>16:51</h><w>raywillig</w><a>@alandipert</a>:  are you using lambada for your lambda stuff?</z><z id="t1448045132" t="lowl4tency raywillig: I&apos;ve started to use it"><y>#</y><d>2015-11-20</d><h>18:45</h><w>lowl4tency</w>raywillig: I&apos;ve started to use it</z><z id="t1448045149" t="lowl4tency Running a simple function for getting twilio integration"><y>#</y><d>2015-11-20</d><h>18:45</h><w>lowl4tency</w>Running a simple function for getting twilio integration</z><z id="t1448045163" t="raywillig how has your experience been with it?"><y>#</y><d>2015-11-20</d><h>18:46</h><w>raywillig</w>how has your experience been with it?</z><z id="t1448045182" t="lowl4tency Honestly I&apos;ve been working with it about 1 week"><y>#</y><d>2015-11-20</d><h>18:46</h><w>lowl4tency</w>Honestly I&apos;ve been working with it about 1 week</z><z id="t1448045208" t="lowl4tency It&apos;s pretty good. Just provide my code running on lambda"><y>#</y><d>2015-11-20</d><h>18:46</h><w>lowl4tency</w>It&apos;s pretty good. Just provide my code running on lambda</z><z id="t1448045221" t="lowl4tency Do you have a trouble with it?"><y>#</y><d>2015-11-20</d><h>18:47</h><w>lowl4tency</w>Do you have a trouble with it?</z><z id="t1448045381" t="raywillig not yet. i&apos;m just getting started on using lambda. trying to make good choices early on"><y>#</y><d>2015-11-20</d><h>18:49</h><w>raywillig</w>not yet. i&apos;m just getting started on using lambda. trying to make good choices early on</z><z id="t1448045441" t="lowl4tency raywillig: lambada is pretty good library. Enough simple and works"><y>#</y><d>2015-11-20</d><h>18:50</h><w>lowl4tency</w>raywillig: lambada is pretty good library. Enough simple and works</z><z id="t1448045473" t="lowl4tency Honestly, i&apos;m not ready yet to public my code simple_smile"><y>#</y><d>2015-11-20</d><h>18:51</h><w>lowl4tency</w>Honestly, i&apos;m not ready yet to public my code <b>simple_smile</b></z><z id="t1448045515" t="lowl4tency And I don&apos;t get any issues with using it"><y>#</y><d>2015-11-20</d><h>18:51</h><w>lowl4tency</w>And I don&apos;t get any issues with using it</z><z id="t1448045532" t="raywillig cool, thanks for the input"><y>#</y><d>2015-11-20</d><h>18:52</h><w>raywillig</w>cool, thanks for the input</z><z id="t1448045566" t="lowl4tency raywillig: feel free to ask me if you got a q"><y>#</y><d>2015-11-20</d><h>18:52</h><w>lowl4tency</w>raywillig: feel free to ask me if you got a q</z><z id="t1448045587" t="lowl4tency as far as a i remember, it was not so trivial to run first time simple_smile"><y>#</y><d>2015-11-20</d><h>18:53</h><w>lowl4tency</w>as far as a i remember, it was not so trivial to run first time <b>simple_smile</b></z><z id="t1448046133" t="raywillig thx for the offer. i will probably take you up on it"><y>#</y><d>2015-11-20</d><h>19:02</h><w>raywillig</w>thx for the offer. i will probably take you up on it</z></g><g id="s1"><z id="t1448046706" t="lowl4tency raywillig: happy lambda coding simple_smile"><y>#</y><d>2015-11-20</d><h>19:11</h><w>lowl4tency</w>raywillig: happy lambda coding <b>simple_smile</b></z><z id="t1448111763" t="bplatz Are you using clojure or clojurescript for lambda? What has been your experience with startup latency?"><y>#</y><d>2015-11-21</d><h>13:16</h><w>bplatz</w>Are you using clojure or clojurescript for lambda? What has been your experience with startup latency?</z><z id="t1448113095" t="martinklepsch (Thats a +1 as in &quot;interesting question&quot; :)"><y>#</y><d>2015-11-21</d><h>13:38</h><w>martinklepsch</w>(Thats a +1 as in &quot;interesting question&quot; :)</z><z id="t1448114080" t="lowl4tency bplatz: I&apos;m using clojure, i&apos;m not sure lambda has ability to run cljs"><y>#</y><d>2015-11-21</d><h>13:54</h><w>lowl4tency</w>bplatz: I&apos;m using clojure, i&apos;m not sure lambda has ability to run cljs</z><z id="t1448114105" t="lowl4tency only if cljs has ability to generate nodejs code simple_smile"><y>#</y><d>2015-11-21</d><h>13:55</h><w>lowl4tency</w>only if cljs has ability to generate nodejs code <b>simple_smile</b></z><z id="t1448114804" t="bplatz I&apos;ve heard the node.js response time is quite good, and seen a blog or something about some trial with cljs -&gt; node.js on lambda."><y>#</y><d>2015-11-21</d><h>14:06</h><w>bplatz</w>I&apos;ve heard the node.js response time is quite good, and seen a blog or something about some trial with cljs -&gt; node.js on lambda.</z><z id="t1448114868" t="bplatz I had also seen someone talk about using .clj, and sounded like a ~7s startup time... fine for batch stuff but nothing real-time."><y>#</y><d>2015-11-21</d><h>14:07</h><w>bplatz</w>I had also seen someone talk about using .clj, and sounded like a ~7s startup time... fine for batch stuff but nothing real-time.</z><z id="t1448114969" t="bplatz I&apos;ve been thinking about trying an experiment with Docker running .clj, and using the experimental checkpoint/restore capability. Basically warm booting the docker instance, checkpoint it, and then restore on-demand. I&apos;m thinking that has the potential of getting to &lt; 1s response times. Not lambda, but you could use a custom scheduler with Amazon ECS."><y>#</y><d>2015-11-21</d><h>14:09</h><w>bplatz</w>I&apos;ve been thinking about trying an experiment with Docker running .clj, and using the experimental checkpoint/restore capability. Basically warm booting the docker instance, checkpoint it, and then restore on-demand. I&apos;m thinking that has the potential of getting to &lt; 1s response times. Not lambda, but you could use a custom scheduler with Amazon ECS.</z><z id="t1448117831" t="lowl4tency Honestly, I didn&apos;t get any metrics about running time, but in my feelings it&apos;s pretty quick. And my app is not critical to start time"><y>#</y><d>2015-11-21</d><h>14:57</h><w>lowl4tency</w>Honestly, I didn&apos;t get any metrics about running time, but in my feelings it&apos;s pretty quick. And my app is not critical to start time</z><z id="t1448118023" t="lowl4tency cloudwatch doesn&apos;t have running time metrics by default 😞"><y>#</y><d>2015-11-21</d><h>15:00</h><w>lowl4tency</w>cloudwatch doesn&apos;t have running time metrics by default <b>😞</b></z><z id="t1448118038" t="lowl4tency s/running/starting/"><y>#</y><d>2015-11-21</d><h>15:00</h><w>lowl4tency</w>s/running/starting/</z><z id="t1448118069" t="alandipert we tested a lambada-based clj function and i was surprised at how quick the startup was, it was definitely &lt; 1 s. one thing we learned is that the memory setting is also the CPU setting"><y>#</y><d>2015-11-21</d><h>15:01</h><w>alandipert</w>we tested a lambada-based clj function and i was surprised at how quick the startup was, it was definitely &lt; 1 s. one thing we learned is that the memory setting is also the CPU setting</z><z id="t1448118096" t="alandipert so the amt of memory you allocated makes a big difference in speed"><y>#</y><d>2015-11-21</d><h>15:01</h><w>alandipert</w>so the amt of memory you allocated makes a big difference in speed</z><z id="t1448118097" t="lowl4tency agreed, it&apos;s very quick. And interesting issue for test"><y>#</y><d>2015-11-21</d><h>15:01</h><w>lowl4tency</w>agreed, it&apos;s very quick. And interesting issue for test</z><z id="t1448118120" t="alandipert but it&apos;s still too slow for us, we call the function a lot"><y>#</y><d>2015-11-21</d><h>15:02</h><w>alandipert</w>but it&apos;s still too slow for us, we call the function a lot</z><z id="t1448118135" t="lowl4tency alandipert: what use cases do you have?"><y>#</y><d>2015-11-21</d><h>15:02</h><w>lowl4tency</w>alandipert: what use cases do you have?</z><z id="t1448118155" t="alandipert the main one is consumign from kinesis, doing some light processing, and putting records on s3"><y>#</y><d>2015-11-21</d><h>15:02</h><w>alandipert</w>the main one is consumign from kinesis, doing some light processing, and putting records on s3</z><z id="t1448118385" t="alandipert the other use case is collecting metrics from s3 for monitoring, i made a thing to generate those - https://github.com/adzerk-oss/S3DatadogLambda"><y>#</y><d>2015-11-21</d><h>15:06</h><w>alandipert</w>the other use case is collecting metrics from s3 for monitoring, i made a thing to generate those - <a href="https://github.com/adzerk-oss/S3DatadogLambda" target="_blank">https://github.com/adzerk-oss/S3DatadogLambda</a></z><z id="t1448118459" t="lowl4tency uh, cool"><y>#</y><d>2015-11-21</d><h>15:07</h><w>lowl4tency</w>uh, cool</z><z id="t1448118466" t="lowl4tency You use datadog! simple_smile"><y>#</y><d>2015-11-21</d><h>15:07</h><w>lowl4tency</w>You use datadog! <b>simple_smile</b></z><z id="t1448118893" t="ragge [:attrs {:href &quot;/_/_/users/U06ATU50X&quot;}] : Let me know if you have any feedback/issues with lambada, I&apos;m the author. Mainly wrote it to get around the classloading issue I found, otherwise I wouldn&apos;t have made it into library..."><y>#</y><d>2015-11-21</d><h>15:14</h><w>ragge</w><a>@raywillig</a>: Let me know if you have any feedback/issues with lambada, I&apos;m the author. Mainly wrote it to get around the classloading issue I found, otherwise I wouldn&apos;t have made it into library...</z><z id="t1448119004" t="ragge when I tested lambada, startup time was a bit slow for first request (but still &lt;1s) then in the milliseconds, so I think aws is using the same instance for multiple requests"><y>#</y><d>2015-11-21</d><h>15:16</h><w>ragge</w>when I tested lambada, startup time was a bit slow for first request (but still &lt;1s) then in the milliseconds, so I think aws is using the same instance for multiple requests</z><z id="t1448124427" t="jaen [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : you can use Clojurescript to compile node code and some people seem to use that with lambda - https://github.com/nervous-systems/cljs-lambda"><y>#</y><d>2015-11-21</d><h>16:47</h><w>jaen</w><a>@lowl4tency</a>: you can use Clojurescript to compile node code and some people seem to use that with lambda - <a href="https://github.com/nervous-systems/cljs-lambda" target="_blank">https://github.com/nervous-systems/cljs-lambda</a></z><z id="t1448124522" t="lowl4tency jaen: yes, it exactly what i said early. Thanks for the link"><y>#</y><d>2015-11-21</d><h>16:48</h><w>lowl4tency</w>jaen: yes, it exactly what i said early. Thanks for the link</z><z id="t1448124581" t="jaen Ah, sorry, I misunderstood what you said then"><y>#</y><d>2015-11-21</d><h>16:49</h><w>jaen</w>Ah, sorry, I misunderstood what you said then</z><z id="t1448124657" t="lowl4tency what benefits are there to use cljs instead clojure? simple_smile"><y>#</y><d>2015-11-21</d><h>16:50</h><w>lowl4tency</w>what benefits are there to use cljs instead clojure? <b>simple_smile</b></z><z id="t1448124887" t="jaen I imagine it would be of benefit when having low start-up time is of importance."><y>#</y><d>2015-11-21</d><h>16:54</h><w>jaen</w>I imagine it would be of benefit when having low start-up time is of importance.</z><z id="t1448129577" t="ragge see my reply above, I don&apos;t think startup time is a problem even with clojure (unless you only invoke your function rarely, but require low startup time each invocation)"><y>#</y><d>2015-11-21</d><h>18:12</h><w>ragge</w>see my reply above, I don&apos;t think startup time is a problem even with clojure (unless you only invoke your function rarely, but require low startup time each invocation)</z><z id="t1448244780" t="alandipert [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : from your experiments, do you have a sense for how long they keep the jvm alive to reuse?"><y>#</y><d>2015-11-23</d><h>02:13</h><w>alandipert</w><a>@ragge</a>: from your experiments, do you have a sense for how long they keep the jvm alive to reuse?</z><z id="t1448533867" t="ragge [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : from memory, it was in the magnitude of a few minutes... but I wouldn&apos;t trust my memory"><y>#</y><d>2015-11-26</d><h>10:31</h><w>ragge</w><a>@alandipert</a>: from memory, it was in the magnitude of a few minutes... but I wouldn&apos;t trust my memory</z><z id="t1448843983" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Once those few minutes are up, do they then trash the instance so you’re paying the 1s startup with Clojure again, or do they serialise the JVM state somehow?"><y>#</y><d>2015-11-30</d><h>00:39</h><w>cfleming</w><a>@ragge</a>: Once those few minutes are up, do they then trash the instance so you’re paying the 1s startup with Clojure again, or do they serialise the JVM state somehow?</z><z id="t1448874694" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : again from memory and based on a few unscientific observations, but it seemed like a new JVM was started and the lambda function handler instantiated"><y>#</y><d>2015-11-30</d><h>09:11</h><w>ragge</w><a>@cfleming</a>: again from memory and based on a few unscientific observations, but it seemed like a new JVM was started and the lambda function handler instantiated</z><z id="t1448878352" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Interesting, thanks. It looks like CLJS is actually probably a better fit for Lambda since Node is first class there, but I haven’t tried it yet."><y>#</y><d>2015-11-30</d><h>10:12</h><w>cfleming</w><a>@ragge</a>: Interesting, thanks. It looks like CLJS is actually probably a better fit for Lambda since Node is first class there, but I haven’t tried it yet.</z><z id="t1448878470" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : i think it will depend a lot on your usage patterns, but yeah, generally quick startup might be a win"><y>#</y><d>2015-11-30</d><h>10:14</h><w>ragge</w><a>@cfleming</a>: i think it will depend a lot on your usage patterns, but yeah, generally quick startup might be a win</z><z id="t1448878518" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Right. I have one Lambda function right now that I need the JVM for because I’m using encryption (it’s just Java), but I think for most future things I’ll try CLJS first."><y>#</y><d>2015-11-30</d><h>10:15</h><w>cfleming</w><a>@ragge</a>: Right. I have one Lambda function right now that I need the JVM for because I’m using encryption (it’s just Java), but I think for most future things I’ll try CLJS first.</z><z id="t1448878686" t="cfleming Lambda is pretty cool actually, I have a lot of use cases I can use it for."><y>#</y><d>2015-11-30</d><h>10:18</h><w>cfleming</w>Lambda is pretty cool actually, I have a lot of use cases I can use it for.</z><z id="t1448878696" t="cfleming The API gateway mapping is a gigantic pain, though."><y>#</y><d>2015-11-30</d><h>10:18</h><w>cfleming</w>The API gateway mapping is a gigantic pain, though.</z><z id="t1448880466" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : yeah, that too me seems like a poor re-invention of an ESB"><y>#</y><d>2015-11-30</d><h>10:47</h><w>ragge</w><a>@cfleming</a>: yeah, that too me seems like a poor re-invention of an ESB</z><z id="t1448880489" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : but I really like the unit of execution with lambda, don&apos;t want to care about instances if i don&apos;t have to"><y>#</y><d>2015-11-30</d><h>10:48</h><w>ragge</w><a>@cfleming</a>: but I really like the unit of execution with lambda, don&apos;t want to care about instances if i don&apos;t have to</z><z id="t1448904268" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Right, it’s perfect for a lot of use cases."><y>#</y><d>2015-11-30</d><h>17:24</h><w>cfleming</w><a>@ragge</a>: Right, it’s perfect for a lot of use cases.</z><z id="t1448932768" t="alandipert anyone heard anything about lambda off sqs?"><y>#</y><d>2015-12-01</d><h>01:19</h><w>alandipert</w>anyone heard anything about lambda off sqs?</z><z id="t1448954286" t="lowl4tency as far as I know, lambda can&apos;t into sqs"><y>#</y><d>2015-12-01</d><h>07:18</h><w>lowl4tency</w>as far as I know, lambda can&apos;t into sqs</z><z id="t1448954299" t="lowl4tency You can configure SQS+SNS"><y>#</y><d>2015-12-01</d><h>07:18</h><w>lowl4tency</w>You can configure SQS+SNS</z><z id="t1448954304" t="lowl4tency and use lambda on sns"><y>#</y><d>2015-12-01</d><h>07:18</h><w>lowl4tency</w>and use lambda on sns</z><z id="t1449006449" t="cfleming Hi Lambda people, I’ve written a function which is driven by the API gateway. What I’m seeing is that the lambda function is being invoked twice even though I can’t see evidence of two requests in the API gateway logs."><y>#</y><d>2015-12-01</d><h>21:47</h><w>cfleming</w>Hi Lambda people, I’ve written a function which is driven by the API gateway. What I’m seeing is that the lambda function is being invoked twice even though I can’t see evidence of two requests in the API gateway logs.</z><z id="t1449006456" t="cfleming Is this expected? Any ideas?"><y>#</y><d>2015-12-01</d><h>21:47</h><w>cfleming</w>Is this expected? Any ideas?</z><z id="t1449006483" t="cfleming (slightly OT since this is written in Java, but hey)"><y>#</y><d>2015-12-01</d><h>21:48</h><w>cfleming</w>(slightly OT since this is written in Java, but hey)</z><z id="t1449006515" t="alandipert you are seeing the 2 invocations in cloudwatch for lambda?"><y>#</y><d>2015-12-01</d><h>21:48</h><w>alandipert</w>you are seeing the 2 invocations in cloudwatch for lambda?</z><z id="t1449006521" t="cfleming Yes"><y>#</y><d>2015-12-01</d><h>21:48</h><w>cfleming</w>Yes</z><z id="t1449006544" t="cfleming But not in the API gateway AFAICT, but I’m finding it difficult to search in CW"><y>#</y><d>2015-12-01</d><h>21:49</h><w>cfleming</w>But not in the API gateway AFAICT, but I’m finding it difficult to search in CW</z><z id="t1449006557" t="cfleming I can’t seem to easily search by request ID, for example"><y>#</y><d>2015-12-01</d><h>21:49</h><w>cfleming</w>I can’t seem to easily search by request ID, for example</z><z id="t1449006559" t="alandipert cloudwatch is the worst thing about lambda 😦"><y>#</y><d>2015-12-01</d><h>21:49</h><w>alandipert</w>cloudwatch is the worst thing about lambda <b>😦</b></z><z id="t1449006569" t="cfleming No lie"><y>#</y><d>2015-12-01</d><h>21:49</h><w>cfleming</w>No lie</z><z id="t1449006589" t="cfleming The alerting for errors is kind of wacky."><y>#</y><d>2015-12-01</d><h>21:49</h><w>cfleming</w>The alerting for errors is kind of wacky.</z><z id="t1449006592" t="cfleming Anyway"><y>#</y><d>2015-12-01</d><h>21:49</h><w>cfleming</w>Anyway</z><z id="t1449006605" t="alandipert i would encourage you to ask support, that&apos;s quite odd"><y>#</y><d>2015-12-01</d><h>21:50</h><w>alandipert</w>i would encourage you to ask support, that&apos;s quite odd</z><z id="t1449006606" t="cfleming I haven’t seen anything saying that lambda functions need to be idempotent"><y>#</y><d>2015-12-01</d><h>21:50</h><w>cfleming</w>I haven’t seen anything saying that lambda functions need to be idempotent</z><z id="t1449006621" t="alandipert i harrass our account guy about cloudwatch sucking regularly"><y>#</y><d>2015-12-01</d><h>21:50</h><w>alandipert</w>i harrass our account guy about cloudwatch sucking regularly</z><z id="t1449006625" t="cfleming Ok, where’s the best place to do that? On their forums?"><y>#</y><d>2015-12-01</d><h>21:50</h><w>cfleming</w>Ok, where’s the best place to do that? On their forums?</z><z id="t1449006630" t="alandipert but they seem particularly helpful wrt lambda because they want more feedback on it"><y>#</y><d>2015-12-01</d><h>21:50</h><w>alandipert</w>but they seem particularly helpful wrt lambda because they want more feedback on it</z><z id="t1449006644" t="alandipert at the top right, is a support thing... and a link to submit a ticket i think"><y>#</y><d>2015-12-01</d><h>21:50</h><w>alandipert</w>at the top right, is a support thing... and a link to submit a ticket i think</z><z id="t1449006658" t="alandipert &quot;Support Center&quot;"><y>#</y><d>2015-12-01</d><h>21:50</h><w>alandipert</w>&quot;Support Center&quot;</z><z id="t1449006711" t="cfleming “At the Basic Support level, you can create account and billing support cases and service limit increase requests, but you cannot create technical support cases.&quot;"><y>#</y><d>2015-12-01</d><h>21:51</h><w>cfleming</w>“At the Basic Support level, you can create account and billing support cases and service limit increase requests, but you cannot create technical support cases.&quot;</z><z id="t1449006763" t="cfleming It’s the forums for me, I guess."><y>#</y><d>2015-12-01</d><h>21:52</h><w>cfleming</w>It’s the forums for me, I guess.</z><z id="t1449039053" t="lowl4tency cfleming: yeah, use forum, but it&apos;s very slow 😞"><y>#</y><d>2015-12-02</d><h>06:50</h><w>lowl4tency</w>cfleming: yeah, use forum, but it&apos;s very slow <b>😞</b></z><z id="t1449042718" t="cfleming [:attrs {:href &quot;/_/_/users/U051Y7R2X&quot;}] : They probably have an anti-SLA to drive people to their support."><y>#</y><d>2015-12-02</d><h>07:51</h><w>cfleming</w><a>@lowl4tency</a>: They probably have an anti-SLA to drive people to their support.</z><z id="t1449043559" t="lowl4tency Honestly, I don&apos;t understand the policy, sometimes you need to post a bugreport"><y>#</y><d>2015-12-02</d><h>08:05</h><w>lowl4tency</w>Honestly, I don&apos;t understand the policy, sometimes you need to post a bugreport</z><z id="t1449043564" t="lowl4tency Or something like that"><y>#</y><d>2015-12-02</d><h>08:06</h><w>lowl4tency</w>Or something like that</z><z id="t1449043568" t="lowl4tency And you can&apos;t simple_smile"><y>#</y><d>2015-12-02</d><h>08:06</h><w>lowl4tency</w>And you can&apos;t <b>simple_smile</b></z><z id="t1449043586" t="lowl4tency You need buy subscription for submitting bugreports!"><y>#</y><d>2015-12-02</d><h>08:06</h><w>lowl4tency</w>You need buy subscription for submitting bugreports!</z><z id="t1449043953" t="cfleming I should think about doing that."><y>#</y><d>2015-12-02</d><h>08:12</h><w>cfleming</w>I should think about doing that.</z><z id="t1449043979" t="cfleming I have like 400 open issues in my tracker. At $5 an issue I’d be close to retiring."><y>#</y><d>2015-12-02</d><h>08:12</h><w>cfleming</w>I have like 400 open issues in my tracker. At $5 an issue I’d be close to retiring.</z><z id="t1449066690" t="alandipert workin on some lambda tooling that doesn&apos;t need AOT if anyone is interested.. basically you include adzerk/boot-aws-lambda as a dep, put a file like https://github.com/adzerk-oss/boot-aws-lambda/blob/master/example/src/adzerk.lambda.properties on your classpath, and uber it"><y>#</y><d>2015-12-02</d><h>14:31</h><w>alandipert</w>workin on some lambda tooling that doesn&apos;t need AOT if anyone is interested.. basically you include adzerk/boot-aws-lambda as a dep, put a file like <a href="https://github.com/adzerk-oss/boot-aws-lambda/blob/master/example/src/adzerk.lambda.properties" target="_blank">https://github.com/adzerk-oss/boot-aws-lambda/blob/master/example/src/adzerk.lambda.properties</a> on your classpath, and uber it</z><z id="t1449068435" t="tangrammer very interesting! thanks for sharing"><y>#</y><d>2015-12-02</d><h>15:00</h><w>tangrammer</w>very interesting! thanks for sharing</z><z id="t1449069670" t="alandipert sure. need to use it for a work thing, then will document. if you try it in the meantime and have probs happy to help"><y>#</y><d>2015-12-02</d><h>15:21</h><w>alandipert</w>sure. need to use it for a work thing, then will document. if you try it in the meantime and have probs happy to help</z><z id="t1449193835" t="alandipert anyone have stuff on beanstalk, worker tier?"><y>#</y><d>2015-12-04</d><h>01:50</h><w>alandipert</w>anyone have stuff on beanstalk, worker tier?</z><z id="t1449217238" t="lowl4tency My lambda function. https://github.com/Cognician/clj-notify"><y>#</y><d>2015-12-04</d><h>08:20</h><w>lowl4tency</w>My lambda function. <a href="https://github.com/Cognician/clj-notify" target="_blank">https://github.com/Cognician/clj-notify</a></z><z id="t1449217249" t="lowl4tency Now is open simple_smile"><y>#</y><d>2015-12-04</d><h>08:20</h><w>lowl4tency</w>Now is open <b>simple_smile</b></z><z id="t1449232905" t="alandipert nice!"><y>#</y><d>2015-12-04</d><h>12:41</h><w>alandipert</w>nice!</z><z id="t1449743545" t="martinklepsch [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : btw, did you end up using lambda for the license buying stuff?"><y>#</y><d>2015-12-10</d><h>10:32</h><w>martinklepsch</w><a>@cfleming</a>: btw, did you end up using lambda for the license buying stuff?</z><z id="t1449743638" t="cfleming [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] : Yeah, I did. It was a mixture of agony and ecstasy"><y>#</y><d>2015-12-10</d><h>10:33</h><w>cfleming</w><a>@martinklepsch</a>: Yeah, I did. It was a mixture of agony and ecstasy</z><z id="t1449743662" t="cfleming I love Lambda and Dynamo, but I hate CloudWatch and API gateway."><y>#</y><d>2015-12-10</d><h>10:34</h><w>cfleming</w>I love Lambda and Dynamo, but I hate CloudWatch and API gateway.</z><z id="t1449743863" t="martinklepsch Haven&apos;t used API gateway yet but everyone seems to hate it so already looking forward lol"><y>#</y><d>2015-12-10</d><h>10:37</h><w>martinklepsch</w>Haven&apos;t used API gateway yet but everyone seems to hate it so already looking forward lol</z><z id="t1449743909" t="martinklepsch This has been asked before I think but some more anecdotal knowledge would be interesting: how is startup time? [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}]"><y>#</y><d>2015-12-10</d><h>10:38</h><w>martinklepsch</w>This has been asked before I think but some more anecdotal knowledge would be interesting: how is startup time? <a>@cfleming</a></z><z id="t1449743933" t="martinklepsch (assuming you used Clojure not ClojureScript)"><y>#</y><d>2015-12-10</d><h>10:38</h><w>martinklepsch</w>(assuming you used Clojure not ClojureScript)</z><z id="t1449743966" t="cfleming [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] : Sorry, fighting a few release-related fires, will get whisky for war tales in a bit."><y>#</y><d>2015-12-10</d><h>10:39</h><w>cfleming</w><a>@martinklepsch</a>: Sorry, fighting a few release-related fires, will get whisky for war tales in a bit.</z><z id="t1449744000" t="martinklepsch sure, good luck 👍 congrats again, must be a really big day for you simple_smile"><y>#</y><d>2015-12-10</d><h>10:40</h><w>martinklepsch</w>sure, good luck <b>👍</b> congrats again, must be a really big day for you <b>simple_smile</b></z><z id="t1449744714" t="robert-stuttaford massive. congrats cfleming !"><y>#</y><d>2015-12-10</d><h>10:51</h><w>robert-stuttaford</w>massive. congrats cfleming !</z><z id="t1449744777" t="cfleming Thanks guys! It’s been a ton of work to get here, I can’t wait to work on functionality again!"><y>#</y><d>2015-12-10</d><h>10:52</h><w>cfleming</w>Thanks guys! It’s been a ton of work to get here, I can’t wait to work on functionality again!</z><z id="t1449748365" t="cfleming [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] : I don’t actually know about instance startup time, it’s actually fairly difficult to measure. You do get a total elapsed time in CloudWatch, so if you create a simple Java lambda that doesn’t do anything you could probably test it."><y>#</y><d>2015-12-10</d><h>11:52</h><w>cfleming</w><a>@martinklepsch</a>:  I don’t actually know about instance startup time, it’s actually fairly difficult to measure. You do get a total elapsed time in CloudWatch, so if you create a simple Java lambda that doesn’t do anything you could probably test it.</z><z id="t1449748476" t="cfleming That’s not my main problem though. The biggest pain point is that API gateway has a hard 10-sec timeout for Lambda backends. That sounds like a lot, but I’m getting a lot of timeouts when I access AWS services for the first time. Creating a DynamoDB client, finding a table and loading a single record out of it takes around 7.2 seconds when the instance is cold."><y>#</y><d>2015-12-10</d><h>11:54</h><w>cfleming</w>That’s not my main problem though. The biggest pain point is that API gateway has a hard 10-sec timeout for Lambda backends. That sounds like a lot, but I’m getting a lot of timeouts when I access AWS services for the first time. Creating a DynamoDB client, finding a table and loading a single record out of it takes around 7.2 seconds when the instance is cold.</z><z id="t1449748525" t="cfleming Once it’s warmed up a bit (interestingly, this isn’t true for the second request, more like the third or fourth) it starts to get a lot faster."><y>#</y><d>2015-12-10</d><h>11:55</h><w>cfleming</w>Once it’s warmed up a bit (interestingly, this isn’t true for the second request, more like the third or fourth) it starts to get a lot faster.</z><z id="t1449748525" t="robert-stuttaford that sucks"><y>#</y><d>2015-12-10</d><h>11:55</h><w>robert-stuttaford</w>that sucks</z><z id="t1449748538" t="cfleming Yeah"><y>#</y><d>2015-12-10</d><h>11:55</h><w>cfleming</w>Yeah</z><z id="t1449748558" t="cfleming It’s actually not a great fit for occasional requests, which is daft - that seems like its ideal use case."><y>#</y><d>2015-12-10</d><h>11:55</h><w>cfleming</w>It’s actually not a great fit for occasional requests, which is daft - that seems like its ideal use case.</z><z id="t1449748652" t="cfleming I actually put Dynamo in the mix to make the lambda idempotent because I was already seeing long timeouts for other services I use (KMS), but they’re faster once Dynamo is loaded first, so it must be some connection to AWS in general that’s taking the time."><y>#</y><d>2015-12-10</d><h>11:57</h><w>cfleming</w>I actually put Dynamo in the mix to make the lambda idempotent because I was already seeing long timeouts for other services I use (KMS), but they’re faster once Dynamo is loaded first, so it must be some connection to AWS in general that’s taking the time.</z><z id="t1449752160" t="alandipert not good for occasional web requests, but we&apos;re using it as a timer and it&apos;s great in that role"><y>#</y><d>2015-12-10</d><h>12:56</h><w>alandipert</w>not good for occasional web requests, but we&apos;re using it as a timer and it&apos;s great in that role</z><z id="t1449767016" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] Are you using DynamoDB? Faraday, or some other interface?"><y>#</y><d>2015-12-10</d><h>17:03</h><w>ricardo</w><a>@cfleming</a> Are you using DynamoDB? Faraday, or some other interface?</z><z id="t1449774819" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Um, some other interface: Java simple_smile"><y>#</y><d>2015-12-10</d><h>19:13</h><w>cfleming</w><a>@ricardo</a>: Um,  some other interface: Java <b>simple_smile</b></z><z id="t1449779397" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : The horror."><y>#</y><d>2015-12-10</d><h>20:29</h><w>ricardo</w><a>@cfleming</a>: The horror.</z><z id="t1449780971" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : I washed my hands afterwards, though."><y>#</y><d>2015-12-10</d><h>20:56</h><w>cfleming</w><a>@ricardo</a>: I washed my hands afterwards, though.</z><z id="t1449781118" t="ricardo Good, wouldn’t want bad codebase hygene."><y>#</y><d>2015-12-10</d><h>20:58</h><w>ricardo</w>Good, wouldn’t want bad codebase hygene.</z><z id="t1449790197" t="cfleming CloudWatch is truly pitiful."><y>#</y><d>2015-12-10</d><h>23:29</h><w>cfleming</w>CloudWatch is truly pitiful.</z><z id="t1449790222" t="cfleming Or I am extremely stupid, I guess is the other possibility."><y>#</y><d>2015-12-10</d><h>23:30</h><w>cfleming</w>Or I am extremely stupid, I guess is the other possibility.</z><z id="t1449821629" t="ricardo Haven’t used it myself. I was recently at an AWS even but they barely touched on it."><y>#</y><d>2015-12-11</d><h>08:13</h><w>ricardo</w>Haven’t used it myself. I was recently at an AWS even but they barely touched on it.</z><z id="t1450056565" t="micha i&apos;m definitely not sold on lambda"><y>#</y><d>2015-12-14</d><h>01:29</h><w>micha</w>i&apos;m definitely not sold on lambda</z><z id="t1450118490" t="alandipert anyone built/seen a datalog/alternate query library atop dynamo?"><y>#</y><d>2015-12-14</d><h>18:41</h><w>alandipert</w>anyone built/seen a datalog/alternate query library atop dynamo?</z><z id="t1450118500" t="alandipert (other than datomic)"><y>#</y><d>2015-12-14</d><h>18:41</h><w>alandipert</w>(other than datomic)</z><z id="t1450363960" t="bplatz [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : I have not but I&apos;ve looked around for one before. If you happen to find one please report back!"><y>#</y><d>2015-12-17</d><h>14:52</h><w>bplatz</w><a>@alandipert</a>: I have not but I&apos;ve looked around for one before. If you happen to find one please report back!</z><z id="t1451259015" t="clojuregeek have any of you figured out how to get the tags from a bucket on s3? trying with amazonica and listing all the functions in s3 namespace and nothing seems like it will work"><y>#</y><d>2016-12-27</d><h>23:30</h><w>clojuregeek</w>have any of you figured out how to get the tags from a bucket on s3? trying with amazonica and listing all the functions in s3 namespace and nothing seems like it will work</z><z id="t1451339354" t="alandipert [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : have you dipped into java at all? looks like this method on AmazonS3Client does the thing - https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Client.html#getBucketTaggingConfiguration(java.lang.String)"><y>#</y><d>2016-12-28</d><h>21:49</h><w>alandipert</w><a>@clojuregeek</a>: have you dipped into java at all? looks like this method on AmazonS3Client does the thing - <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Client.html#getBucketTaggingConfiguration(java.lang.String)" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/AmazonS3Client.html#getBucketTaggingConfiguration(java.lang.String)</a></z><z id="t1451339392" t="alandipert (perhaps amazonica isn&apos;t configured to generate proxy functions for the tag-related methods for some reason?)"><y>#</y><d>2016-12-28</d><h>21:49</h><w>alandipert</w>(perhaps amazonica isn&apos;t configured to generate proxy functions for the tag-related methods for some reason?)</z><z id="t1451339610" t="clojuregeek [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : i do have a method get-bucket-tagging-configuration when i do (dir amazonica.aws.s3)"><y>#</y><d>2016-12-28</d><h>21:53</h><w>clojuregeek</w><a>@alandipert</a>: i do have a method <code>get-bucket-tagging-configuration</code> when i do <code>(dir amazonica.aws.s3)</code></z><z id="t1451339668" t="clojuregeek I can&apos;t figure out how i need to call it though"><y>#</y><d>2016-12-28</d><h>21:54</h><w>clojuregeek</w>I can&apos;t figure out how i need to call it though</z><z id="t1451339690" t="alandipert i think maybe with the string name of the bucket, according to javadoc"><y>#</y><d>2016-12-28</d><h>21:54</h><w>alandipert</w>i think maybe with the string name of the bucket, according to javadoc</z><z id="t1451339701" t="alandipert another overload takes some configuration map"><y>#</y><d>2016-12-28</d><h>21:55</h><w>alandipert</w>another overload takes some configuration map</z><z id="t1451339712" t="clojuregeek dev&gt; (s3/get-bucket-tagging-configuration creds {:bucket &quot;mybucket&quot;}) IllegalArgumentException The bucket name must be specified when retrieving the bucket tagging configuration. com.amazonaws.services.s3.\ AmazonS3Client.rejectNull (AmazonS3Client.java:2847) "><y>#</y><d>2016-12-28</d><h>21:55</h><w>clojuregeek</w><pre>dev&gt; (s3/get-bucket-tagging-configuration creds {:bucket &quot;mybucket&quot;})
IllegalArgumentException The bucket name must be specified when retrieving the bucket tagging configuration.  com.amazonaws.services.s3.\
AmazonS3Client.rejectNull (AmazonS3Client.java:2847)
</pre></z><z id="t1451339729" t="alandipert try (s3/get-bucket-tagging-configuration creds &quot;mybucket&quot;)"><y>#</y><d>2016-12-28</d><h>21:55</h><w>alandipert</w>try <code> (s3/get-bucket-tagging-configuration creds &quot;mybucket&quot;)</code></z><z id="t1451339762" t="clojuregeek that gives me IllegalArgumentException wrong number of arguments sun.reflect.NativeMethodAccessorImpl.invoke0 (NativeMethodAccessorImpl.java:-2) "><y>#</y><d>2016-12-28</d><h>21:56</h><w>clojuregeek</w>that gives me
<pre>IllegalArgumentException wrong number of arguments  sun.reflect.NativeMethodAccessorImpl.invoke0 (NativeMethodAccessorImpl.java:-2)
</pre></z><z id="t1451339769" t="alandipert 😦"><y>#</y><d>2016-12-28</d><h>21:56</h><w>alandipert</w><b>😦</b></z><z id="t1451339791" t="alandipert ok last guess"><y>#</y><d>2016-12-28</d><h>21:56</h><w>alandipert</w>ok last guess</z><z id="t1451339803" t="alandipert (s3/get-bucket-tagging-configuration creds {:bucket-name &quot;mybucket&quot;})"><y>#</y><d>2016-12-28</d><h>21:56</h><w>alandipert</w><code>(s3/get-bucket-tagging-configuration creds {:bucket-name &quot;mybucket&quot;})</code></z><z id="t1451339826" t="alandipert (based on methods on https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/model/GetBucketTaggingConfigurationRequest.html )"><y>#</y><d>2016-12-28</d><h>21:57</h><w>alandipert</w>(based on methods on <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/model/GetBucketTaggingConfigurationRequest.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/model/GetBucketTaggingConfigurationRequest.html</a>)</z><z id="t1451339970" t="clojuregeek no 😞"><y>#</y><d>2016-12-28</d><h>21:59</h><w>clojuregeek</w>no <b>😞</b></z><z id="t1451340081" t="alandipert maybe call the java things directly?"><y>#</y><d>2016-12-28</d><h>22:01</h><w>alandipert</w>maybe call the java things directly?</z><z id="t1451340092" t="alandipert i find myself doing this now most of the time, for reasons like this"><y>#</y><d>2016-12-28</d><h>22:01</h><w>alandipert</w>i find myself doing this now most of the time, for reasons like this</z><z id="t1451340176" t="alandipert (def emr (if (resolve &apos;boot.core/*boot-version*) ;; If we&apos;re in boot, we&apos;re running locally (let [creds (com.amazonaws.auth.BasicAWSCredentials. (System/getenv &quot;ADZERK_AWS_ACCESS_KEY&quot;) (System/getenv &quot;ADZERK_AWS_SECRET_KEY&quot;))] (AmazonElasticMapReduceClient. creds)) ;; In Lambda, credentials come from role (AmazonElasticMapReduceClient.))) "><y>#</y><d>2016-12-28</d><h>22:02</h><w>alandipert</w><pre>(def emr
  (if (resolve &apos;boot.core/*boot-version*)
    ;; If we&apos;re in boot, we&apos;re running locally
    (let [creds (com.amazonaws.auth.BasicAWSCredentials.
                 (System/getenv &quot;ADZERK_AWS_ACCESS_KEY&quot;)
                 (System/getenv &quot;ADZERK_AWS_SECRET_KEY&quot;))]
      (AmazonElasticMapReduceClient. creds))
    ;; In Lambda, credentials come from role
    (AmazonElasticMapReduceClient.)))
</pre></z><z id="t1451340211" t="alandipert if you sub for AmazonS3Client there you&apos;ll have yourself a working client, just tweak the ADZERK_* creds for whatever you use"><y>#</y><d>2016-12-28</d><h>22:03</h><w>alandipert</w>if you sub for AmazonS3Client there you&apos;ll have yourself a working client, just tweak the ADZERK_* creds for whatever you use</z><z id="t1451340278" t="alandipert when you have a credentialed AmazonS3Client you can call getBucketTaggingConfiguration on it with the bucket name as string"><y>#</y><d>2016-12-28</d><h>22:04</h><w>alandipert</w>when you have a credentialed AmazonS3Client you can call <code>getBucketTaggingConfiguration</code> on it with the bucket name as string</z><z id="t1451340834" t="clojuregeek ok thanks for your help, i&apos;ll see if I can access the java directly. If I can figure it out, i&apos;ll write a blog post simple_smile"><y>#</y><d>2016-12-28</d><h>22:13</h><w>clojuregeek</w>ok thanks for your help, i&apos;ll see if I can access the java directly. If I can figure it out, i&apos;ll write a blog post <b>simple_smile</b></z><z id="t1451341612" t="alandipert [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : np! here is a self-contained script that gets the tags for a bucket - https://gist.github.com/alandipert/39c65618ecc716e38210"><y>#</y><d>2016-12-28</d><h>22:26</h><w>alandipert</w><a>@clojuregeek</a>: np! here is a self-contained script that gets the tags for a bucket - <a href="https://gist.github.com/alandipert/39c65618ecc716e38210" target="_blank">https://gist.github.com/alandipert/39c65618ecc716e38210</a></z><z id="t1451341670" t="clojuregeek thanks!"><y>#</y><d>2016-12-28</d><h>22:27</h><w>clojuregeek</w>thanks!</z><z id="t1451342452" t="alandipert no problem, see you later"><y>#</y><d>2016-12-28</d><h>22:40</h><w>alandipert</w>no problem, see you later</z><z id="t1451506051" t="clojuregeek BTW my questions the other day about getting s3 tags, I talked to the maintainer of amazonica and he said it should work passing in {:bucket-name &quot;mybucket&quot;} and said it was a bug, and fixed it. https://github.com/mcohen01/amazonica/commit/1acb86e1eed58ad9c4f380bad256b097cf254263 /cc [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}]"><y>#</y><d>2016-12-30</d><h>20:07</h><w>clojuregeek</w>BTW my questions the other day about getting s3 tags, I talked to the maintainer of amazonica and he said it should work passing in {:bucket-name &quot;mybucket&quot;} and said it was a bug, and fixed it. <a href="https://github.com/mcohen01/amazonica/commit/1acb86e1eed58ad9c4f380bad256b097cf254263" target="_blank">https://github.com/mcohen01/amazonica/commit/1acb86e1eed58ad9c4f380bad256b097cf254263</a>  /cc <a>@alandipert</a></z><z id="t1451507518" t="alandipert [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : cool, thanks for looking into it"><y>#</y><d>2016-12-30</d><h>20:31</h><w>alandipert</w><a>@clojuregeek</a>: cool, thanks for looking into it</z><z id="t1451507578" t="clojuregeek simple_smile i am going to submit PR with an example in the docs"><y>#</y><d>2016-12-30</d><h>20:32</h><w>clojuregeek</w><b>simple_smile</b> i am going to submit PR with an example in the docs</z><z id="t1451507789" t="alandipert speaking of amazonica, just cooked up this script that shows how to query EC2 stuff w/ datomic datalog - https://gist.github.com/alandipert/d2cb38ee869448182c4b"><y>#</y><d>2016-12-30</d><h>20:36</h><w>alandipert</w>speaking of amazonica, just cooked up this script that shows how to query EC2 stuff w/ datomic datalog - <a href="https://gist.github.com/alandipert/d2cb38ee869448182c4b" target="_blank">https://gist.github.com/alandipert/d2cb38ee869448182c4b</a></z><z id="t1451507823" t="alandipert the key to it is the paths function that pivots a nested map into a set of tuples, which i think should work with many other things amazonica can return beyond ec2 info"><y>#</y><d>2016-12-30</d><h>20:37</h><w>alandipert</w>the key to it is the <code>paths</code> function that pivots a nested map into a set of tuples, which i think should work with many other things amazonica can return beyond ec2 info</z><z id="t1451508311" t="clojuregeek cool!"><y>#</y><d>2016-12-30</d><h>20:45</h><w>clojuregeek</w>cool!</z><z id="t1451511966" t="clojuregeek [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : is + some kind of convention, for a constant? in def +instance-states+ ??"><y>#</y><d>2016-12-30</d><h>21:46</h><w>clojuregeek</w><a>@alandipert</a>: is + some kind of convention, for a constant? in <code>def +instance-states+</code>  ??</z><z id="t1451512388" t="alandipert i&apos;ve seen it around, and use it myself"><y>#</y><d>2016-12-30</d><h>21:53</h><w>alandipert</w>i&apos;ve seen it around, and use it myself</z><z id="t1451512403" t="alandipert i&apos;d use *earmuffs* but then clj complains when the thing isn&apos;t dynamic"><y>#</y><d>2016-12-30</d><h>21:53</h><w>alandipert</w>i&apos;d use <code>*earmuffs*</code> but then clj complains when the thing isn&apos;t dynamic</z><z id="t1451512423" t="alandipert but yeah that&apos;s the idea, +things+ are global constants"><y>#</y><d>2016-12-30</d><h>21:53</h><w>alandipert</w>but yeah that&apos;s the idea, <code>+things+</code> are global constants</z><z id="t1451775554" t="curtosis is there a cljs mapping for the js version of the aws-sdk?"><y>#</y><d>2016-01-02</d><h>22:59</h><w>curtosis</w>is there a cljs mapping for the js version of the aws-sdk?</z><z id="t1451775562" t="curtosis I didn&apos;t see it in cljsjs..."><y>#</y><d>2016-01-02</d><h>22:59</h><w>curtosis</w>I didn&apos;t see it in cljsjs...</z><z id="t1451775640" t="curtosis I could use s3-beam for the s3 part (though I&apos;m not sure how to get it to upload raw data rather than from the filesystem)"><y>#</y><d>2016-01-02</d><h>23:00</h><w>curtosis</w>I could use <code>s3-beam</code> for the s3 part (though I&apos;m not sure how to get it to upload raw data rather than from the filesystem)</z><z id="t1451775662" t="curtosis but I&apos;d like to be able to hit the other services too"><y>#</y><d>2016-01-02</d><h>23:01</h><w>curtosis</w>but I&apos;d like to be able to hit the other services too</z><z id="t1451947647" t="cfleming [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] : There’s https://github.com/nervous-systems/hildebrand and https://github.com/nervous-systems/eulalie - looks like eulalie is the AWS SDK substrate which hildebrand uses."><y>#</y><d>2016-01-04</d><h>22:47</h><w>cfleming</w><a>@curtosis</a>: There’s <a href="https://github.com/nervous-systems/hildebrand" target="_blank">https://github.com/nervous-systems/hildebrand</a> and <a href="https://github.com/nervous-systems/eulalie" target="_blank">https://github.com/nervous-systems/eulalie</a> - looks like eulalie is the AWS SDK substrate which hildebrand uses.</z><z id="t1451952324" t="curtosis excellent! looks like it will fit the bill nicely! Otherwise I was slowly leaning towards writing a couple Lambda functions in python."><y>#</y><d>2016-01-05</d><h>00:05</h><w>curtosis</w>excellent! looks like it will fit the bill nicely! Otherwise I was slowly leaning towards writing a couple Lambda functions in python.</z><z id="t1451952453" t="curtosis oh.. .hm... it doesn’t look like eulalie handles S3 yet. Might be possible to tack on."><y>#</y><d>2016-01-05</d><h>00:07</h><w>curtosis</w>oh.. .hm... it doesn’t look like eulalie handles S3 yet. Might be possible to tack on.</z><z id="t1451952703" t="curtosis my plan is cljs on the browser that generates a chunk of edn and dumps it into S3. Going thru API Gateway and a Lambda seems like it avoids the ugly S3 signed policy stuff."><y>#</y><d>2016-01-05</d><h>00:11</h><w>curtosis</w>my plan is cljs on the browser that generates a chunk of edn and dumps it into S3. Going thru API Gateway and a Lambda seems like it avoids the ugly S3 signed policy stuff.</z><z id="t1451953560" t="curtosis (and I still can&apos;t find any docs or examples on putting file contents instead of a file name into the S3 POST.)"><y>#</y><d>2016-01-05</d><h>00:26</h><w>curtosis</w>(and I still can&apos;t find any docs or examples on putting file contents instead of a file name into the S3 POST.)</z><z id="t1451971639" t="peterromfeld hi, anyone could get .createClient working with java-interop? every lib i’ve found so far they using .setRegion after the client got created i tried so far: (def creds (BasicAWSCredentials. aws-access-key-id aws-secret-access-key)) (def region (-&gt; &quot;AP_SOUTHEAST_1&quot; Regions/valueOf Region/getRegion)) (def cfn (.createClient region AmazonCloudFormationClient. creds)) and some trial and error with different versions of passing AmazonCloudFormationClient/class"><y>#</y><d>2016-01-05</d><h>05:27</h><w>peterromfeld</w>hi, anyone could get .createClient working with java-interop? every lib i’ve found so far they using .setRegion after the client got created
i tried so far:
<pre>(def creds (BasicAWSCredentials. aws-access-key-id aws-secret-access-key))
(def region (-&gt; &quot;AP_SOUTHEAST_1&quot; Regions/valueOf Region/getRegion))
(def cfn (.createClient region AmazonCloudFormationClient. creds))
</pre>
and some trial and error with different versions of passing <code>AmazonCloudFormationClient/class</code></z><z id="t1451971689" t="peterromfeld https://docs.aws.amazon.com/AWSSdkDocsJava/latest/DeveloperGuide/java-dg-region-selection.html#id2"><y>#</y><d>2016-01-05</d><h>05:28</h><w>peterromfeld</w><a href="https://docs.aws.amazon.com/AWSSdkDocsJava/latest/DeveloperGuide/java-dg-region-selection.html#id2" target="_blank">https://docs.aws.amazon.com/AWSSdkDocsJava/latest/DeveloperGuide/java-dg-region-selection.html#id2</a></z><z id="t1451971792" t="alandipert looks like maybe you can do (.. (AmazonCloudFormationClient. creds) (withRegion (Regions/fromName &quot;AP_SOUTHEAST_1&quot;)))"><y>#</y><d>2016-01-05</d><h>05:29</h><w>alandipert</w>looks like maybe you can do <code>(.. (AmazonCloudFormationClient. creds) (withRegion (Regions/fromName &quot;AP_SOUTHEAST_1&quot;)))</code></z><z id="t1451971874" t="alandipert the .. is a good match for the withX &quot;fluent&quot; stuff all over amazon sdks"><y>#</y><d>2016-01-05</d><h>05:31</h><w>alandipert</w>the <code>..</code> is a good match for the <code>withX</code> &quot;fluent&quot; stuff all over amazon sdks</z><z id="t1451971891" t="peterromfeld cool thanks, good to know"><y>#</y><d>2016-01-05</d><h>05:31</h><w>peterromfeld</w>cool thanks, good to know</z><z id="t1451971988" t="peterromfeld also clojures immutable data structures are also applied to java objects created via java interop in clojure? so the race condition documented about .setRegion afterwards shouldnt be a problem when running from clojure?"><y>#</y><d>2016-01-05</d><h>05:33</h><w>peterromfeld</w>also clojures immutable data structures are also applied to java objects created via java interop in clojure?
so the race condition documented about .setRegion afterwards shouldnt be a problem when running from clojure?</z><z id="t1451972133" t="alandipert that&apos;s not what i undertsand"><y>#</y><d>2016-01-05</d><h>05:35</h><w>alandipert</w>that&apos;s not what i undertsand</z><z id="t1451972140" t="alandipert seems more to be advice not to setRegion on an existing client"><y>#</y><d>2016-01-05</d><h>05:35</h><w>alandipert</w>seems more to be advice not to setRegion on an existing client</z><z id="t1451972151" t="alandipert instead creating a new client for that region"><y>#</y><d>2016-01-05</d><h>05:35</h><w>alandipert</w>instead creating a new client for that region</z><z id="t1451972160" t="peterromfeld https://github.com/aws/aws-sdk-java/blob/0d08bc14a249c071fb30b93b3294ee6d2772774f/aws-java-sdk-cloudformation/src/main/java/com/amazonaws/services/cloudformation/AmazonCloudFormation.java#L86"><y>#</y><d>2016-01-05</d><h>05:36</h><w>peterromfeld</w><a href="https://github.com/aws/aws-sdk-java/blob/0d08bc14a249c071fb30b93b3294ee6d2772774f/aws-java-sdk-cloudformation/src/main/java/com/amazonaws/services/cloudformation/AmazonCloudFormation.java#L86" target="_blank">https://github.com/aws/aws-sdk-java/blob/0d08bc14a249c071fb30b93b3294ee6d2772774f/aws-java-sdk-cloudformation/src/main/java/com/amazonaws/services/cloudformation/AmazonCloudFormation.java#L86</a></z><z id="t1451972181" t="alandipert yeah"><y>#</y><d>2016-01-05</d><h>05:36</h><w>alandipert</w>yeah</z><z id="t1451972190" t="alandipert so they&apos;re saying, don&apos;t create the client and start doing work with it, and then set the region"><y>#</y><d>2016-01-05</d><h>05:36</h><w>alandipert</w>so they&apos;re saying, don&apos;t create the client and start doing work with it, and then set the region</z><z id="t1451972204" t="peterromfeld ah ok thanks for clarification 😉"><y>#</y><d>2016-01-05</d><h>05:36</h><w>peterromfeld</w>ah ok thanks for clarification <b>😉</b></z><z id="t1451972209" t="alandipert np"><y>#</y><d>2016-01-05</d><h>05:36</h><w>alandipert</w>np</z><z id="t1451972307" t="peterromfeld i somehow missed the last part of the sentence :/ before any service requests are made"><y>#</y><d>2016-01-05</d><h>05:38</h><w>peterromfeld</w>i somehow missed the last part of the sentence :/ <code>before any service requests are made</code></z><z id="t1451972322" t="alandipert it&apos;s ok"><y>#</y><d>2016-01-05</d><h>05:38</h><w>alandipert</w>it&apos;s ok</z><z id="t1451972336" t="alandipert so many reams of docs with AWS it&apos;s easy to miss things 📚"><y>#</y><d>2016-01-05</d><h>05:38</h><w>alandipert</w>so many reams of docs with AWS it&apos;s easy to miss things <b>📚</b></z><z id="t1451972722" t="peterromfeld out of curiosity how would this translate to clojure interop? AmazonEC2 ec2 = Region.getRegion(Regions.US_WEST_2).createClient( AmazonEC2Client.class, credentials, clientConfig); the AmazonEC2Client.class is kind irritating (i have 0 java background)"><y>#</y><d>2016-01-05</d><h>05:45</h><w>peterromfeld</w>out of curiosity how would this translate to clojure interop?
<pre>AmazonEC2 ec2 = Region.getRegion(Regions.US_WEST_2).createClient(
  AmazonEC2Client.class, credentials, clientConfig);
</pre>
the <code>AmazonEC2Client.class</code> is kind irritating (i have 0 java background)</z><z id="t1451973269" t="alandipert (import com.amazonaws.regions.Region com.amazonaws.regions.Regions com.amazonaws.services.ec2.AmazonEC2Client) (.createClient (Region/getRegion Regions/US_WEST_2) AmazonEC2Client credentials clientConfig) "><y>#</y><d>2016-01-05</d><h>05:54</h><w>alandipert</w><pre>(import
 com.amazonaws.regions.Region
 com.amazonaws.regions.Regions
 com.amazonaws.services.ec2.AmazonEC2Client)

(.createClient (Region/getRegion Regions/US_WEST_2) AmazonEC2Client credentials clientConfig)
</pre></z><z id="t1451973375" t="alandipert wherever you see .class in Java you can just use the class name symbol in clj"><y>#</y><d>2016-01-05</d><h>05:56</h><w>alandipert</w>wherever you see <code>.class</code> in Java you can just use the class name symbol in clj</z><z id="t1451973390" t="alandipert in clj symbols that resolve to known classes resolve to the class value"><y>#</y><d>2016-01-05</d><h>05:56</h><w>alandipert</w>in clj symbols that resolve to known classes resolve to the class value</z><z id="t1451973400" t="alandipert e.g. AmazonEC2Client.class == AmazonEC2Client in clj"><y>#</y><d>2016-01-05</d><h>05:56</h><w>alandipert</w>e.g. <code>AmazonEC2Client.class == AmazonEC2Client in clj</code></z><z id="t1451973434" t="alandipert also in that code i&apos;m using / both to call a static method getRegion and to get a static field US_WEST_2"><y>#</y><d>2016-01-05</d><h>05:57</h><w>alandipert</w>also in that code i&apos;m using <code>/</code> both to call a static method <code>getRegion</code> and to get a static field <code>US_WEST_2</code></z><z id="t1451973464" t="alandipert .createClient is an instance method call to the object returned by (Region/getRegion ...)"><y>#</y><d>2016-01-05</d><h>05:57</h><w>alandipert</w><code>.createClient</code> is an instance method call to the object returned by <code>(Region/getRegion ...)</code></z><z id="t1451973522" t="peterromfeld got it, thanks!!"><y>#</y><d>2016-01-05</d><h>05:58</h><w>peterromfeld</w>got it, thanks!!</z><z id="t1451973564" t="alandipert cheers - i&apos;m off, see you later"><y>#</y><d>2016-01-05</d><h>05:59</h><w>alandipert</w>cheers - i&apos;m off, see you later</z><z id="t1452081583" t="luposlip OK, got my small clojure-test-project working with docker - yay! But I cannot get it to run on AWS ECS. I’ve pushed the docker image to docker hub, I’ve tried to pull the image on a fresh docker installation and it runs perfectly. But when I try to run it on ECS, and I SSH to the EC2 instance, and run a docker ps the only output I get is this: 0814c0db0a0f amazon/amazon-ecs-agent:latest &quot;/agent” Any ideas?"><y>#</y><d>2016-01-06</d><h>11:59</h><w>luposlip</w>OK, got my small clojure-test-project working with docker - yay! But I cannot get it to run on AWS ECS.
I’ve pushed the docker image to docker hub, I’ve tried to pull the image on a fresh docker installation and it runs perfectly.

But when I try to run it on ECS, and I SSH to the EC2 instance, and run a <pre>docker ps</pre> the only output I get is this: <pre>0814c0db0a0f        amazon/amazon-ecs-agent:latest   &quot;/agent”</pre>

Any ideas?</z><z id="t1452081660" t="luposlip (my docker image is private, unfortunately can’t share it at the moment, but if any of you have a public test docker clojure image with some web app serving some hello world thing, and can tell how to deploy it to ECS I’d highly appreciate it! simple_smile I can create a new public image, if there is noone to be found anywhere)"><y>#</y><d>2016-01-06</d><h>12:01</h><w>luposlip</w>(my docker image is private, unfortunately can’t share it at the moment, but if any of you have a public test docker clojure image with some web app serving some hello world thing, and can tell how to deploy it to ECS I’d highly appreciate it! <b>simple_smile</b> I can create a new public image, if there is noone to be found anywhere)</z><z id="t1452086508" t="ragge can you docker run the image on one of your ecs instances?"><y>#</y><d>2016-01-06</d><h>13:21</h><w>ragge</w>can you <code>docker run</code> the image on one of your ecs instances?</z><z id="t1452086819" t="luposlip haven’t tried that [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] ! In the meantime I’ve started all over. Will try when I get the instance up again!"><y>#</y><d>2016-01-06</d><h>13:26</h><w>luposlip</w>haven’t tried that <a>@ragge</a>! In the meantime I’ve started all over. Will try when I get the instance up again!</z><z id="t1452086962" t="ragge you can also do a docker ps -a to show all containers to see if ecs managed to start one"><y>#</y><d>2016-01-06</d><h>13:29</h><w>ragge</w>you can also do a <code>docker ps -a</code> to show all containers to see if ecs managed to start one</z><z id="t1452087407" t="luposlip Now I have a single EC2 instance, configured with the Container Agent (for accessing my private docker image)"><y>#</y><d>2016-01-06</d><h>13:36</h><w>luposlip</w>Now I have a single EC2 instance, configured with the Container Agent (for accessing my private docker image)</z><z id="t1452087421" t="luposlip How do I make sure ECS uses that EC2 instance?"><y>#</y><d>2016-01-06</d><h>13:37</h><w>luposlip</w>How do I make sure ECS uses that EC2 instance?</z><z id="t1452087750" t="luposlip OK, now I just ran my task again, pointing to my private repo."><y>#</y><d>2016-01-06</d><h>13:42</h><w>luposlip</w>OK, now I just ran my task again, pointing to my private repo.</z><z id="t1452087786" t="luposlip still, when logged on to the EC2 instance, docker ps -a only shows the amazon agent"><y>#</y><d>2016-01-06</d><h>13:43</h><w>luposlip</w>still, when logged on to the EC2 instance, <pre>docker ps -a</pre> only shows the amazon agent</z><z id="t1452087837" t="luposlip docker images show my private image, though!"><y>#</y><d>2016-01-06</d><h>13:43</h><w>luposlip</w><pre>docker images</pre> show my private image, though!</z><z id="t1452087861" t="ragge so if you run docker run -it $name-of-your-image"><y>#</y><d>2016-01-06</d><h>13:44</h><w>ragge</w>so if you run <code>docker run -it $name-of-your-image</code></z><z id="t1452087863" t="ragge does that work?"><y>#</y><d>2016-01-06</d><h>13:44</h><w>ragge</w>does that work?</z><z id="t1452087871" t="luposlip hey, it’s booting! simple_smile"><y>#</y><d>2016-01-06</d><h>13:44</h><w>luposlip</w>hey, it’s booting! <b>simple_smile</b></z><z id="t1452087889" t="luposlip It just took a while for the image to get downloaded 😄"><y>#</y><d>2016-01-06</d><h>13:44</h><w>luposlip</w>It just took a while for the image to get downloaded <b>😄</b></z><z id="t1452087897" t="ragge that&apos;s docker for you"><y>#</y><d>2016-01-06</d><h>13:44</h><w>ragge</w>that&apos;s docker for you</z><z id="t1452087917" t="luposlip docker ps -a now shows both the agent and my own image - thanks for your patience [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] !"><y>#</y><d>2016-01-06</d><h>13:45</h><w>luposlip</w><pre>docker ps -a</pre> now shows both the agent and my own image - thanks for your patience <a>@ragge</a>!</z><z id="t1452561553" t="clojuregeek Using cljs-lambda... i think i have everything set right ... trying to do a lambda function in a lambda with clojurescript ... getting this error: A client error (UnrecognizedClientException) occurred when calling the CreateFunction operation: The security token included in the request is invalid. "><y>#</y><d>2016-01-12</d><h>01:19</h><w>clojuregeek</w>Using cljs-lambda... i think i have everything set right ... trying to do a lambda function in a lambda with clojurescript ... getting this error:
<pre>A client error (UnrecognizedClientException) occurred when calling the CreateFunction operation: The security token included in the request is invalid.
</pre></z><z id="t1452561557" t="clojuregeek any ideas?"><y>#</y><d>2016-01-12</d><h>01:19</h><w>clojuregeek</w>any ideas?</z><z id="t1452561581" t="clojuregeek does it use the security token generated by a federated login?"><y>#</y><d>2016-01-12</d><h>01:19</h><w>clojuregeek</w>does it use the security token generated by a federated login?</z><z id="t1452566102" t="alandipert hm - i&apos;ve seen that when AWS creds are expired"><y>#</y><d>2016-01-12</d><h>02:35</h><w>alandipert</w>hm - i&apos;ve seen that when AWS creds are expired</z><z id="t1452566846" t="bhagany yeah, I saw that one when I was sending the wrong key and secret"><y>#</y><d>2016-01-12</d><h>02:47</h><w>bhagany</w>yeah, I saw that one when I was sending the wrong key and secret</z><z id="t1452566877" t="bhagany I have two in my ~/.aws/credentials, and switch between them with an environment variable"><y>#</y><d>2016-01-12</d><h>02:47</h><w>bhagany</w>I have two in my ~/.aws/credentials, and switch between them with an environment variable</z><z id="t1452634541" t="luposlip Hey, trying to deploy Datomic Pro Starter using DynamoDB, packaged with Docker, running on ECS based on https://hub.docker.com/r/pointslope/datomic-pro-starter/ ."><y>#</y><d>2016-01-12</d><h>21:35</h><w>luposlip</w>Hey, trying to deploy Datomic Pro Starter using DynamoDB, packaged with Docker, running on ECS based on <a href="https://hub.docker.com/r/pointslope/datomic-pro-starter/" target="_blank">https://hub.docker.com/r/pointslope/datomic-pro-starter/</a>.</z><z id="t1452634559" t="luposlip It works like a charm on my local environment (i.e. local docker machine)"><y>#</y><d>2016-01-12</d><h>21:35</h><w>luposlip</w>It works like a charm on my local environment (i.e. local docker machine)</z><z id="t1452634575" t="luposlip But on ECS it won’t start. Have anybody here done this?"><y>#</y><d>2016-01-12</d><h>21:36</h><w>luposlip</w>But on ECS it won’t start. Have anybody here done this?</z><z id="t1452634844" t="luposlip Like the idea of docker containers, service composing with docker etc., but I’m close to going back to CloudFormation.."><y>#</y><d>2016-01-12</d><h>21:40</h><w>luposlip</w>Like the idea of docker containers, service composing with docker etc., but I’m close to going back to CloudFormation..</z><z id="t1452850912" t="ricardo [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] Not seeing the issue myself, but in case I do… was it the expired credentials issue?"><y>#</y><d>2016-01-15</d><h>09:41</h><w>ricardo</w><a>@clojuregeek</a> Not seeing the issue myself, but in case I do… was it the expired credentials issue?</z><z id="t1452850955" t="ricardo And since we’re on the topic of lambda… is anyone using Clojure for lambdas? I’ve been doing some tests on Clojure vs. ClojureScript, and the warm up hit on the Clojure lambdas is significant."><y>#</y><d>2016-01-15</d><h>09:42</h><w>ricardo</w>And since we’re on the topic of lambda… is anyone using Clojure for lambdas?  I’ve been doing some tests on Clojure vs. ClojureScript, and the warm up hit on the Clojure lambdas is significant.</z><z id="t1452851078" t="jaen I think I remember something about Cursive licenses using lambdas with Clojure, but might be misremembering."><y>#</y><d>2016-01-15</d><h>09:44</h><w>jaen</w>I think I remember something about Cursive licenses using lambdas with Clojure, but might be misremembering.</z><z id="t1452852352" t="ricardo Hmm, thanks [:attrs {:href &quot;/_/_/users/U0A727APP&quot;}] , I’ll ping [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}]"><y>#</y><d>2016-01-15</d><h>10:05</h><w>ricardo</w>Hmm, thanks <a>@jaen</a>, I’ll ping <a>@cfleming</a></z><z id="t1452852742" t="ragge [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : we use clojure for a few lambda functions, see: https://github.com/uswitch/lambada"><y>#</y><d>2016-01-15</d><h>10:12</h><w>ragge</w><a>@ricardo</a>: we use clojure for a few lambda functions, see: <a href="https://github.com/uswitch/lambada" target="_blank">https://github.com/uswitch/lambada</a></z><z id="t1452852791" t="ragge [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : warm up hit comes up everytime, only a (potential) problem on the first invocation"><y>#</y><d>2016-01-15</d><h>10:13</h><w>ragge</w><a>@ricardo</a>: warm up hit comes up everytime, only a (potential) problem on the first invocation</z><z id="t1452852807" t="ragge [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : so depends very much on your use case"><y>#</y><d>2016-01-15</d><h>10:13</h><w>ragge</w><a>@ricardo</a>: so depends very much on your use case</z><z id="t1452853034" t="ricardo [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Thanks, I actually wrote my clj tests with lambada. Main cause for concern is that the first call seems to take on average ~9s, and API Gateway times you out at 10s."><y>#</y><d>2016-01-15</d><h>10:17</h><w>ricardo</w><a>@ragge</a>: Thanks, I actually wrote my clj tests with lambada.  Main cause for concern is that the first call seems to take on average ~9s, and API Gateway times you out at 10s.</z><z id="t1452853063" t="ragge yeah, for that kind of use case it might be problematic (~9s sounds slooow though)"><y>#</y><d>2016-01-15</d><h>10:17</h><w>ragge</w>yeah, for that kind of use case it might be problematic (~9s sounds slooow though)</z><z id="t1452853077" t="ragge i use it for batch processing s3 and similar"><y>#</y><d>2016-01-15</d><h>10:17</h><w>ragge</w>i use it for batch processing s3 and similar</z><z id="t1452853142" t="ricardo It’s calling to a couple external APIs which probably take 1-2s to complete. The rest should be its own time. What’s the usual memory you set up for your functions? I understand AWS scales the CPU accordingly, but haven’t seen a relation table anywhere."><y>#</y><d>2016-01-15</d><h>10:19</h><w>ricardo</w>It’s calling to a couple external APIs which probably take 1-2s to complete. The rest should be its own time.  What’s the usual memory you set up for your functions? I understand AWS scales the CPU accordingly, but haven’t seen a relation table anywhere.</z><z id="t1452853201" t="ricardo That was for 256MBs. At 1024 it warms up faster."><y>#</y><d>2016-01-15</d><h>10:20</h><w>ricardo</w>That was for 256MBs. At 1024 it warms up faster.</z><z id="t1452853444" t="ragge varies, but jvms like plenty of ram"><y>#</y><d>2016-01-15</d><h>10:24</h><w>ragge</w>varies, but jvms like plenty of ram</z><z id="t1452853476" t="ricardo That is… I haven’t seen a description for how the proportional scaling goes. In my test case the memory use is low, so it’s probably the CPU that’s affecting startup time."><y>#</y><d>2016-01-15</d><h>10:24</h><w>ricardo</w>That is… I haven’t seen a description for how the proportional scaling goes. In my test case the memory use is low, so it’s probably the CPU that’s affecting startup time.</z><z id="t1452853504" t="ragge could be, docs are definitely lacking in many areas"><y>#</y><d>2016-01-15</d><h>10:25</h><w>ragge</w>could be, docs are definitely lacking in many areas</z><z id="t1452853583" t="ricardo Thanks for the datapoint [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}]"><y>#</y><d>2016-01-15</d><h>10:26</h><w>ricardo</w>Thanks for the datapoint <a>@ragge</a></z><z id="t1452853607" t="luposlip Managed to get Datomic up and running on AWS ECS in a docker container. And I can connect to it from the EC2 host (so managed to get both host and alt-host set correctly, as well as the security settings of the AWS setup)."><y>#</y><d>2016-01-15</d><h>10:26</h><w>luposlip</w>Managed to get Datomic up and running on AWS ECS in a docker container. And I can connect to it from the EC2 host (so managed to get both host and alt-host set correctly, as well as the security settings of the AWS setup).</z><z id="t1452854819" t="luposlip Small POC container showing the trick with the IP adresses: https://github.com/enterlab/docker-aws-ecs-env"><y>#</y><d>2016-01-15</d><h>10:46</h><w>luposlip</w>Small POC container showing the trick with the IP adresses: <a href="https://github.com/enterlab/docker-aws-ecs-env" target="_blank">https://github.com/enterlab/docker-aws-ecs-env</a></z><z id="t1452864373" t="meow sharing is caring"><y>#</y><d>2016-01-15</d><h>13:26</h><w>meow</w>sharing is caring</z><z id="t1452870260" t="clojuregeek [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : yes i think it was, also I think my aws-cli was not set right which is what cljs-lambda uses"><y>#</y><d>2016-01-15</d><h>15:04</h><w>clojuregeek</w><a>@ricardo</a>: yes i think it was, also I think my aws-cli was not set right which is what cljs-lambda uses</z><z id="t1452922051" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Cursive does indeed use Lambda for licence generation. I see something similar to what you’re seeing, the first invocation in a while takes ~7.2 seconds to access dynamo."><y>#</y><d>2016-01-16</d><h>05:27</h><w>cfleming</w><a>@ricardo</a>: Cursive does indeed use Lambda for licence generation. I see something similar to what you’re seeing, the first invocation in a while takes ~7.2 seconds to access dynamo.</z><z id="t1452922101" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : But I put Dynamo in to fix the fact that accessing some other service (probably KMS) caused timeouts - I suspect it’s the first access to an AWS service."><y>#</y><d>2016-01-16</d><h>05:28</h><w>cfleming</w><a>@ricardo</a>: But I put Dynamo in to fix the fact that accessing some other service (probably KMS) caused timeouts - I suspect it’s the first access to an AWS service.</z><z id="t1452922128" t="cfleming This doesn’t have anything to do with instance startup time, it’s accessing AWS services."><y>#</y><d>2016-01-16</d><h>05:28</h><w>cfleming</w>This doesn’t have anything to do with instance startup time, it’s accessing AWS services.</z><z id="t1452931749" t="ricardo Thanks [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] . This is a pretty minimal example, since I wanted to do a basic start up time test that still called out to APIs of Clojure lambdas vs. ClojureScript. It does look like increasing the memory (and CPU along with it) is a workaround to improve the start up time, though."><y>#</y><d>2016-01-16</d><h>08:09</h><w>ricardo</w>Thanks <a>@cfleming</a>. This is a pretty minimal example, since I wanted to do a basic start up time test that still called out to APIs of Clojure lambdas vs. ClojureScript. It does look like increasing the memory (and CPU along with it) is a workaround to improve the start up time, though.</z><z id="t1452933866" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Ok, interesting. I’m going to do more systematic tests of this next week for another project, I’ll report back."><y>#</y><d>2016-01-16</d><h>08:44</h><w>cfleming</w><a>@ricardo</a>: Ok, interesting. I’m going to do more systematic tests of this next week for another project, I’ll report back.</z><z id="t1452938612" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : Perfect. I may do a small write-up on these, in case someone else in the community is considering it."><y>#</y><d>2016-01-16</d><h>10:03</h><w>ricardo</w><a>@cfleming</a>: Perfect. I may do a small write-up on these, in case someone else in the community is considering it.</z><z id="t1453017404" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Sounds great. Here’s what I’m planning to test. I’m going to set up a bunch of different lambda functions, all running the same code. I’ll call them at different intervals: every 30 sec, 1 min, 5 min, 15 min and see how that affects instance startup time. I’m also going to add some metrics to the lambda function itself to see if I can see how that affects the first access to an AWS service, since that’s my current problem (not instance startup)."><y>#</y><d>2016-01-17</d><h>07:56</h><w>cfleming</w><a>@ricardo</a>: Sounds great. Here’s what I’m planning to test. I’m going to set up a bunch of different lambda functions, all running the same code. I’ll call them at different intervals: every 30 sec, 1 min, 5 min, 15 min and see how that affects instance startup time. I’m also going to add some metrics to the lambda function itself to see if I can see how that affects the first access to an AWS service, since that’s my current problem (not instance startup).</z><z id="t1453017420" t="cfleming I’ll do that in both Java and JS."><y>#</y><d>2016-01-17</d><h>07:57</h><w>cfleming</w>I’ll do that in both Java and JS.</z><z id="t1453017446" t="cfleming Any other variables? Assigned memory, perhaps? Any suggestions for more data people would like to see while I’m at it?"><y>#</y><d>2016-01-17</d><h>07:57</h><w>cfleming</w>Any other variables? Assigned memory, perhaps? Any suggestions for more data people would like to see while I’m at it?</z><z id="t1453017485" t="cfleming I’ll be driving all this from the API gateway for now - later I’m going to test other invocation methods to see if that affects things."><y>#</y><d>2016-01-17</d><h>07:58</h><w>cfleming</w>I’ll be driving all this from the API gateway for now - later I’m going to test other invocation methods to see if that affects things.</z><z id="t1453017710" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : Assigned memory is definitely a factor. On the same low-memory-use operation, it’s made a significant difference on warm-up time for a Clojure lambda, since AWS also increases CPU “proportionally” (unclear what those proportions are)."><y>#</y><d>2016-01-17</d><h>08:01</h><w>ricardo</w><a>@cfleming</a>: Assigned memory is definitely a factor. On the same low-memory-use operation, it’s made a significant difference on warm-up time for a Clojure lambda, since AWS also increases CPU “proportionally” (unclear what those proportions are).</z><z id="t1453019259" t="ricardo So even if start up time is not your problem, it may have an effect on processing the response."><y>#</y><d>2016-01-17</d><h>08:27</h><w>ricardo</w>So even if start up time is not your problem, it may have an effect on processing the response.</z><z id="t1453020817" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Ok, I’ll test that too. I’m going to use straight Java and JS to test JVM vs Node without complicating things with Clojure’s startup time."><y>#</y><d>2016-01-17</d><h>08:53</h><w>cfleming</w><a>@ricardo</a>: Ok, I’ll test that too. I’m going to use straight Java and JS to test JVM vs Node without complicating things with Clojure’s startup time.</z><z id="t1453021224" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : FYI, this is the sort of thing I’m seeing at the moment for the licence generation:"><y>#</y><d>2016-01-17</d><h>09:00</h><w>cfleming</w><a>@ricardo</a>: FYI, this is the sort of thing I’m seeing at the moment for the licence generation:</z><z id="t1453021230" t="cfleming Intervals: 139, 7159, 0, 975, 0, 786, 71, 445, 145, 2840 Total: 12564 END RequestId: 91ed667e-bce7-11e5-9160-0f34ca00b376 REPORT RequestId: 91ed667e-bce7-11e5-9160-0f34ca00b376 Duration: 12658.36 ms Billed Duration: 12700 ms Memory Size: 512 MB Max Memory Used: 122 MB "><y>#</y><d>2016-01-17</d><h>09:00</h><w>cfleming</w><pre>Intervals: 139, 7159, 0, 975, 0, 786, 71, 445, 145, 2840
Total: 12564
END RequestId: 91ed667e-bce7-11e5-9160-0f34ca00b376
REPORT RequestId: 91ed667e-bce7-11e5-9160-0f34ca00b376	Duration: 12658.36 ms	Billed Duration: 12700 ms 	Memory Size: 512 MB	Max Memory Used: 122 MB	
</pre></z><z id="t1453021277" t="cfleming Those intervals are in ms, arbitrarily chosen as “significant” parts of the processing."><y>#</y><d>2016-01-17</d><h>09:01</h><w>cfleming</w>Those intervals are in ms, arbitrarily chosen as “significant” parts of the processing.</z><z id="t1453021417" t="cfleming The 7159 is the code that reads a single record from DynamoDB after making the initial connection to it."><y>#</y><d>2016-01-17</d><h>09:03</h><w>cfleming</w>The 7159 is the code that reads a single record from DynamoDB after making the initial connection to it.</z><z id="t1453021475" t="cfleming stamp[1] = System.nanoTime(); AmazonDynamoDBClient dynamoClient = new AmazonDynamoDBClient(); dynamoClient.setRegion(Region.getRegion(Regions.US_EAST_1)); DynamoDB dynamoDB = new DynamoDB(dynamoClient); Table orderTable = dynamoDB.getTable(&quot;LicenceOrder&quot;); Item item = orderTable.getItem(&quot;orderId&quot;, request.orderId); if (item != null) { logger.log(&quot;Duplicate request for order ID &quot; + request.orderId); return &quot;ok&quot;; } else { stamp[2] = System.nanoTime(); "><y>#</y><d>2016-01-17</d><h>09:04</h><w>cfleming</w><pre>stamp[1] = System.nanoTime();

      AmazonDynamoDBClient dynamoClient = new AmazonDynamoDBClient();

      dynamoClient.setRegion(Region.getRegion(Regions.US_EAST_1));
      DynamoDB dynamoDB = new DynamoDB(dynamoClient);

      Table orderTable = dynamoDB.getTable(&quot;LicenceOrder&quot;);

      Item item = orderTable.getItem(&quot;orderId&quot;, request.orderId);
      if (item != null) {
        logger.log(&quot;Duplicate request for order ID &quot; + request.orderId);
        return &quot;ok&quot;;
      } else {
        stamp[2] = System.nanoTime();
</pre></z><z id="t1453021575" t="cfleming 975 is initialising the KMS client and decrypting a short block"><y>#</y><d>2016-01-17</d><h>09:06</h><w>cfleming</w>975 is initialising the KMS client and decrypting a short block</z><z id="t1453021692" t="cfleming 71 and 145 are writing one data element each to DynamoDB"><y>#</y><d>2016-01-17</d><h>09:08</h><w>cfleming</w>71 and 145 are writing one data element each to DynamoDB</z><z id="t1453021716" t="cfleming The 2840 is sending an email using Mailgun"><y>#</y><d>2016-01-17</d><h>09:08</h><w>cfleming</w>The 2840 is sending an email using Mailgun</z><z id="t1453021787" t="cfleming Notice that even with a ridiculously bad response time, the difference between the entire time in the actual function and the total request duration is only about 100ms."><y>#</y><d>2016-01-17</d><h>09:09</h><w>cfleming</w>Notice that even with a ridiculously bad response time, the difference between the entire time in the actual function and the total request duration is only about 100ms.</z><z id="t1453021797" t="cfleming i.e. spinup time doesn’t seem to be a major factor."><y>#</y><d>2016-01-17</d><h>09:09</h><w>cfleming</w>i.e. spinup time doesn’t seem to be a major factor.</z><z id="t1453021996" t="cfleming I can’t find the corresponding event in CloudWatch for the API gateway log - CloudWatch is hilariously bad."><y>#</y><d>2016-01-17</d><h>09:13</h><w>cfleming</w>I can’t find the corresponding event in CloudWatch for the API gateway log - CloudWatch is hilariously bad.</z><z id="t1453025274" t="ricardo Man, no kidding. It might as well not exist."><y>#</y><d>2016-01-17</d><h>10:07</h><w>ricardo</w>Man, no kidding. It might as well not exist.</z><z id="t1453025303" t="ricardo Most of my reactions are “um… that’s a nice graph. What’s it showing again?&quot;"><y>#</y><d>2016-01-17</d><h>10:08</h><w>ricardo</w>Most of my reactions are “um… that’s a nice graph. What’s it showing again?&quot;</z><z id="t1453025405" t="ricardo Are you using API Gateway? Or directly invoking the lambda?"><y>#</y><d>2016-01-17</d><h>10:10</h><w>ricardo</w>Are you using API Gateway? Or directly invoking the lambda?</z><z id="t1453064059" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : API Gateway, so I have the problem that it has an enforced 10sec timeout."><y>#</y><d>2016-01-17</d><h>20:54</h><w>cfleming</w><a>@ricardo</a>: API Gateway, so I have the problem that it has an enforced 10sec timeout.</z><z id="t1453064106" t="cfleming Probably 50% or more of my calls time out, so I just made it idempotent so people didn’t get two licences with every order, and the payment processor just retries the webhook until it works."><y>#</y><d>2016-01-17</d><h>20:55</h><w>cfleming</w>Probably 50% or more of my calls time out, so I just made it idempotent so people didn’t get two licences with every order, and the payment processor just retries the webhook until it works.</z><z id="t1453064112" t="cfleming It’s pretty awful, actually."><y>#</y><d>2016-01-17</d><h>20:55</h><w>cfleming</w>It’s pretty awful, actually.</z><z id="t1453072535" t="clojuregeek do you guys know of a library for clojurescript to access ec2? and s3?"><y>#</y><d>2016-01-17</d><h>23:15</h><w>clojuregeek</w>do you guys know of a library for clojurescript to access ec2? and s3?</z><z id="t1453074665" t="bhagany [:attrs {:href &quot;/_/_/users/U053LLFPL&quot;}] : I use the official javascript SDK, no wrapper"><y>#</y><d>2016-01-17</d><h>23:51</h><w>bhagany</w><a>@clojuregeek</a>: I use the official javascript SDK, no wrapper</z><z id="t1453077281" t="clojuregeek Ok cool"><y>#</y><d>2016-01-18</d><h>00:34</h><w>clojuregeek</w>Ok cool</z><z id="t1453117123" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : My own results http://numergent.com/2016-01/AWS-Lambda-Clojure-and-ClojureScript.html"><y>#</y><d>2016-01-18</d><h>11:38</h><w>ricardo</w><a>@cfleming</a>: My own results <a href="http://numergent.com/2016-01/AWS-Lambda-Clojure-and-ClojureScript.html" target="_blank">http://numergent.com/2016-01/AWS-Lambda-Clojure-and-ClojureScript.html</a></z><z id="t1453123792" t="Alex Miller (Clojure team) those were pretty interesting. what version of Clojure were you using?"><y>#</y><d>2016-01-18</d><h>13:29</h><w>Alex Miller (Clojure team)</w>those were pretty interesting. what version of Clojure were you using?</z><z id="t1453123917" t="Alex Miller (Clojure team) I&apos;d be curious to see the timings with 1.8.0-RC5 (or soon 1.8.0) with a lambda compiled with direct linking"><y>#</y><d>2016-01-18</d><h>13:31</h><w>Alex Miller (Clojure team)</w>I&apos;d be curious to see the timings with 1.8.0-RC5 (or soon 1.8.0) with a lambda compiled with direct linking</z><z id="t1453124510" t="martinklepsch https://medium.com/@tjholowaychuk/introducing-apex-800824ffaa70"><y>#</y><d>2016-01-18</d><h>13:41</h><w>martinklepsch</w><a href="https://medium.com/@tjholowaychuk/introducing-apex-800824ffaa70" target="_blank">https://medium.com/@tjholowaychuk/introducing-apex-800824ffaa70</a></z><z id="t1453125143" t="ricardo [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : 1.7, didn’t try with 1.8"><y>#</y><d>2016-01-18</d><h>13:52</h><w>ricardo</w><a>@alexmiller</a>: 1.7, didn’t try with 1.8</z><z id="t1453125229" t="ricardo Didn’t think to try, actually, I’ll give it a shot."><y>#</y><d>2016-01-18</d><h>13:53</h><w>ricardo</w>Didn’t think to try, actually, I’ll give it a shot.</z><z id="t1453127039" t="Alex Miller (Clojure team) RC-4/5 improve startup time 10-15% is why I ask"><y>#</y><d>2016-01-18</d><h>14:23</h><w>Alex Miller (Clojure team)</w>RC-4/5 improve startup time 10-15% is why I ask</z><z id="t1453127063" t="Alex Miller (Clojure team) and AOT compiling your lambda with direct linking may improve it more"><y>#</y><d>2016-01-18</d><h>14:24</h><w>Alex Miller (Clojure team)</w>and AOT compiling your lambda with direct linking may improve it more</z><z id="t1453127185" t="ricardo The class is compiled AOT, but will look into RC5."><y>#</y><d>2016-01-18</d><h>14:26</h><w>ricardo</w>The class is compiled AOT, but will look into RC5.</z><z id="t1453127742" t="Alex Miller (Clojure team) you can enable direct linking with -Dclojure.compiler.direct-linking=true"><y>#</y><d>2016-01-18</d><h>14:35</h><w>Alex Miller (Clojure team)</w>you can enable direct linking with -Dclojure.compiler.direct-linking=true</z><z id="t1453128213" t="ricardo [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] : Will need more thorough testing, but right now averages are about the same with 1.8 RC5."><y>#</y><d>2016-01-18</d><h>14:43</h><w>ricardo</w><a>@alexmiller</a>: Will need more thorough testing, but right now averages are about the same with 1.8 RC5.</z><z id="t1453128237" t="Alex Miller (Clojure team) thx, probably dwarfed by other costs then"><y>#</y><d>2016-01-18</d><h>14:43</h><w>Alex Miller (Clojure team)</w>thx, probably dwarfed by other costs then</z><z id="t1453153254" t="cfleming [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] : I saw Apex on HN, it looks very nice."><y>#</y><d>2016-01-18</d><h>21:40</h><w>cfleming</w><a>@martinklepsch</a>: I saw Apex on HN, it looks very nice.</z><z id="t1453153399" t="cfleming Tailing CloudWatch logs is worth the price of admission alone."><y>#</y><d>2016-01-18</d><h>21:43</h><w>cfleming</w>Tailing CloudWatch logs is worth the price of admission alone.</z><z id="t1453153557" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : You’re measuring total RTT there from the API client, right?"><y>#</y><d>2016-01-18</d><h>21:45</h><w>cfleming</w><a>@ricardo</a>: You’re measuring total RTT there from the API client, right?</z><z id="t1453153609" t="cfleming Is the API client external to AWS, i.e. you’re not invoking from EC2?"><y>#</y><d>2016-01-18</d><h>21:46</h><w>cfleming</w>Is the API client external to AWS, i.e. you’re not invoking from EC2?</z><z id="t1453153624" t="cfleming Also, it looks like you’re not calling any other AWS services, correct?"><y>#</y><d>2016-01-18</d><h>21:47</h><w>cfleming</w>Also, it looks like you’re not calling any other AWS services, correct?</z><z id="t1453155348" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : It’s the billed duration, actually - I should have clarified that. The rest is correct, as far as the test numbers go. It’s also the time for invoking them directly, not through API Gateway. Full roundtrip through API gateway is a bit erratic - adds between 600ms-1200ms."><y>#</y><d>2016-01-18</d><h>22:15</h><w>ricardo</w><a>@cfleming</a>: It’s the billed duration, actually - I should have clarified that.   The rest is correct, as far as the test numbers go. It’s also the time for invoking them directly, not through API Gateway.  Full roundtrip through API gateway is a bit erratic - adds between 600ms-1200ms.</z><z id="t1453155460" t="ricardo Thanks for bringing it up, going to add a note to the article."><y>#</y><d>2016-01-18</d><h>22:17</h><w>ricardo</w>Thanks for bringing it up, going to add a note to the article.</z><z id="t1453157701" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Great, thanks for the details. Just working up my client now."><y>#</y><d>2016-01-18</d><h>22:55</h><w>cfleming</w><a>@ricardo</a>: Great, thanks for the details. Just working up my client now.</z><z id="t1453157735" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : How many iterations did you run for the stable times?"><y>#</y><d>2016-01-18</d><h>22:55</h><w>cfleming</w><a>@ricardo</a>: How many iterations did you run for the stable times?</z><z id="t1453157816" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Also, did you get the billed duration from CloudWatch automatically somehow, or by hand from the logs?"><y>#</y><d>2016-01-18</d><h>22:56</h><w>cfleming</w><a>@ricardo</a>: Also, did you get the billed duration from CloudWatch automatically somehow, or by hand from the logs?</z><z id="t1453167906" t="curtosis not sure if this is an #C09N0H1RB or #C03RZMDSH question ... I have an EC2 app that needs to start up a datomic instance and peer. Is it better to build an image (probably a docker container) with everything in it, or bundle just my code+peer and use the public datomic AMI?"><y>#</y><d>2016-01-19</d><h>01:45</h><w>curtosis</w>not sure if this is an #C09N0H1RB or #C03RZMDSH question ... I have an EC2 app that needs to start up a datomic instance and peer. Is it better to build an image (probably a docker container) with everything in it, or bundle just my code+peer and use the public datomic AMI?</z><z id="t1453167924" t="curtosis (presumably bundling them together in an eb environment)"><y>#</y><d>2016-01-19</d><h>01:45</h><w>curtosis</w>(presumably bundling them together in an eb environment)</z><z id="t1453186167" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : I settled on batches of 10 after some tests. It was pretty stable, usually with &lt; 200ms differences, but that might vary for non-glue code. I got the billed duration from the logs."><y>#</y><d>2016-01-19</d><h>06:49</h><w>ricardo</w><a>@cfleming</a>: I settled on batches of 10 after some tests. It was pretty stable, usually with &lt; 200ms differences, but that might vary for non-glue code.  I got the billed duration from the logs.</z><z id="t1453190501" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Ok, I have some results, I’ll post them here a bit later on."><y>#</y><d>2016-01-19</d><h>08:01</h><w>cfleming</w><a>@ricardo</a>: Ok, I have some results, I’ll post them here a bit later on.</z><z id="t1453190522" t="cfleming Spoiler: Lambda is (strangely) almost useless as an API gateway backend."><y>#</y><d>2016-01-19</d><h>08:02</h><w>cfleming</w>Spoiler: Lambda is (strangely) almost useless as an API gateway backend.</z><z id="t1453190587" t="cfleming (if you want to use other AWS services, that is)"><y>#</y><d>2016-01-19</d><h>08:03</h><w>cfleming</w>(if you want to use other AWS services, that is)</z><z id="t1453208693" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : I take it you’ve continued getting &gt;10s time responses."><y>#</y><d>2016-01-19</d><h>13:04</h><w>ricardo</w><a>@cfleming</a>: I take it you’ve continued getting &gt;10s time responses.</z><z id="t1453283272" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Here are some numbers from the Lambda testing I&apos;ve been doing:"><y>#</y><d>2016-01-20</d><h>09:47</h><w>cfleming</w><a>@ricardo</a>: Here are some numbers from the Lambda testing I&apos;ve been doing:</z><z id="t1453283299" t="cfleming Called every 60 seconds Interval 1 Interval 2 Interval 3 Total Duration RTT 4596 2678 121 7395 7678 9511 4936 2737 121 7794 8114 10579 55 256 61 372 372 457 6 154 39 199 199 238 119 319 29 467 467 497 7 150 59 216 216 266 7 152 23 182 182 227 6 103 40 149 149 186 19 141 40 200 199 228 7 183 74 264 264 324 Called every 5 mins Interval 1 Interval 2 Interval 3 Total Duration RTT 4457 3141 161 7759 8102 9279 4680 2840 101 7621 8018 9602 163 200 66 429 429 577 146 194 33 373 383 497 18 165 43 226 227 387 6 156 51 213 213 368 14 127 37 178 178 320 24 78 100 202 203 357 11 129 29 169 169 315 8 192 30 230 229 419 Called every 15 mins Interval 1 Interval 2 Interval 3 Total Duration RTT 4442 2664 120 7226 7517 8781 103 160 49 312 324 464 4839 3123 99 8061 8354 10834 19 162 42 223 223 412 160 161 36 357 357 514 6 172 36 214 214 370 37 131 30 198 199 351 4720 2959 162 7841 8135 9499 115 159 24 298 298 434 15 184 29 228 228 358 "><y>#</y><d>2016-01-20</d><h>09:48</h><w>cfleming</w><pre>Called every 60 seconds

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        4596         2678          121       7395       7678       9511
        4936         2737          121       7794       8114      10579
          55          256           61        372        372        457
           6          154           39        199        199        238
         119          319           29        467        467        497
           7          150           59        216        216        266
           7          152           23        182        182        227
           6          103           40        149        149        186
          19          141           40        200        199        228
           7          183           74        264        264        324

Called every 5 mins

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        4457         3141          161       7759       8102       9279
        4680         2840          101       7621       8018       9602
         163          200           66        429        429        577
         146          194           33        373        383        497
          18          165           43        226        227        387
           6          156           51        213        213        368
          14          127           37        178        178        320
          24           78          100        202        203        357
          11          129           29        169        169        315
           8          192           30        230        229        419

Called every 15 mins

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        4442         2664          120       7226       7517       8781
         103          160           49        312        324        464
        4839         3123           99       8061       8354      10834
          19          162           42        223        223        412
         160          161           36        357        357        514
           6          172           36        214        214        370
          37          131           30        198        199        351
        4720         2959          162       7841       8135       9499
         115          159           24        298        298        434
          15          184           29        228        228        358
</pre></z><z id="t1453283321" t="cfleming Interval 1 is creating the DynamoDB client and obtaining a table. Interval 2 is reading a single record from it. Interval 3 is updating a record atomically. Total is the total time measured inside the function. Duration is the billed duration from CloudWatch. RTT is the total round trip time."><y>#</y><d>2016-01-20</d><h>09:48</h><w>cfleming</w>Interval 1 is creating the DynamoDB client and obtaining a table.
Interval 2 is reading a single record from it.
Interval 3 is updating a record atomically.
Total is the total time measured inside the function.
Duration is the billed duration from CloudWatch.
RTT is the total round trip time.</z><z id="t1453283332" t="cfleming The Lambda is invoked directly from an EC2 instance in the same region. It&apos;s a 512 MB JVM instance running Java."><y>#</y><d>2016-01-20</d><h>09:48</h><w>cfleming</w>The Lambda is invoked directly from an EC2 instance in the same region. It&apos;s a 512 MB JVM instance running Java.</z><z id="t1453283343" t="cfleming I did a bunch of different runs testing this, and even calling the lambda every minute it&apos;s not uncommon to see an instance spun down between calls. The first two calls are almost always cold."><y>#</y><d>2016-01-20</d><h>09:49</h><w>cfleming</w>I did a bunch of different runs testing this, and even calling the lambda every minute it&apos;s not uncommon to see an instance spun down between calls. The first two calls are almost always cold.</z><z id="t1453283355" t="cfleming API gateway has a hard 10 sec timeout. This makes Lambda almost useless as an API gateway backend if you want to use more AWS services from it, unless the client is prepared to handle regular timeouts and retry. This is pretty consistent from what I&apos;ve seen in the Cursive licence generation too. Perhaps the instance would be kept warm more reliably under heavier load, I haven&apos;t tried that yet."><y>#</y><d>2016-01-20</d><h>09:49</h><w>cfleming</w>API gateway has a hard 10 sec timeout. This makes Lambda almost useless as an API gateway backend if you want to use more AWS services from it, unless the client is prepared to handle regular timeouts and retry. This is pretty consistent from what I&apos;ve seen in the Cursive licence generation too. Perhaps the instance would be kept warm more reliably under heavier load, I haven&apos;t tried that yet.</z><z id="t1453283370" t="cfleming I had assumed that the instance spin-up time when cold is included in the billed duration, which would mean that the difference between Total and Duration is the instance spin-up time, around 300ms or so. That would mean that the difference between RTT and Duration is the RPC latency, looks like about 150ms avg but I haven&apos;t had time to calculate it precisely. However that value is much larger on the cold instances, so perhaps the instance spin-up isn&apos;t billed? That makes the spin-up time for a cold instance from 1-2 sec, looks like."><y>#</y><d>2016-01-20</d><h>09:49</h><w>cfleming</w>I had assumed that the instance spin-up time when cold is included in the billed duration, which would mean that the difference between Total and Duration is the instance spin-up time, around 300ms or so. That would mean that the difference between RTT and Duration is the RPC latency, looks like about 150ms avg but I haven&apos;t had time to calculate it precisely. However that value is much larger on the cold instances, so perhaps the instance spin-up isn&apos;t billed? That makes the spin-up time for a cold instance from 1-2 sec, looks like.</z><z id="t1453283452" t="cfleming Even when the instance is warm RPC overhead is around 150ms."><y>#</y><d>2016-01-20</d><h>09:50</h><w>cfleming</w>Even when the instance is warm RPC overhead is around 150ms.</z><z id="t1453283535" t="cfleming I guess if the spin-up time isn’t billed, that 300ms might be classloading."><y>#</y><d>2016-01-20</d><h>09:52</h><w>cfleming</w>I guess if the spin-up time isn’t billed, that 300ms might be classloading.</z><z id="t1453283725" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : ^^"><y>#</y><d>2016-01-20</d><h>09:55</h><w>cfleming</w><a>@alandipert</a>: ^^</z><z id="t1453284141" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : thanks for sharing! was this using clojure or just java?"><y>#</y><d>2016-01-20</d><h>10:02</h><w>ragge</w><a>@cfleming</a>: thanks for sharing! was this using clojure or just java?</z><z id="t1453285459" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : Oh, it looks like you’re getting the same behavior I got, where often the first two calls behave as if it was cold."><y>#</y><d>2016-01-20</d><h>10:24</h><w>ricardo</w><a>@cfleming</a>: Oh, it looks like you’re getting the same behavior I got, where often the first two calls  behave as if it was cold.</z><z id="t1453285564" t="ricardo I didn’t know what to make of that, so I didn’t mention it on my article. Plus I figured it’s a lambda peculiarity, so it wasn’t directly related to what I was testing."><y>#</y><d>2016-01-20</d><h>10:26</h><w>ricardo</w>I didn’t know what to make of that, so I didn’t mention it on my article.  Plus I figured it’s a lambda peculiarity, so it wasn’t directly related to what I was testing.</z><z id="t1453298581" t="alandipert [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : thanks for sharing! [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] iirc, java"><y>#</y><d>2016-01-20</d><h>14:03</h><w>alandipert</w><a>@cfleming</a>: thanks for sharing! <a>@ragge</a> iirc, java</z></g><g id="s2"><z id="t1453308736" t="curtosis has there been any work on pulling the AWS SDK for Javascript into the CLJSJS system? (or, alternatively, has anyone successfully integrated it manually w/externs in a Clojurescript app?)"><y>#</y><d>2016-01-20</d><h>16:52</h><w>curtosis</w>has there been any work on pulling the AWS SDK for Javascript into the CLJSJS system?
(or, alternatively, has anyone successfully integrated it manually w/externs in a Clojurescript app?)</z><z id="t1453312836" t="bhagany [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] : if you&apos;re on node, I use lein-npm to install the SDK, and then just node/require it from cljs"><y>#</y><d>2016-01-20</d><h>18:00</h><w>bhagany</w><a>@curtosis</a>: if you&apos;re on node, I use lein-npm to install the SDK, and then just node/require it from cljs</z><z id="t1453312840" t="bhagany no externs or anything"><y>#</y><d>2016-01-20</d><h>18:00</h><w>bhagany</w>no externs or anything</z><z id="t1453312849" t="bhagany I don&apos;t have any experience doing that from the browser though"><y>#</y><d>2016-01-20</d><h>18:00</h><w>bhagany</w>I don&apos;t have any experience doing that from the browser though</z><z id="t1453313009" t="bhagany example: https://github.com/bhagany/thisonesforthegirls/blob/master/lambda-src/thisonesforthegirls/s3.cljs#L19"><y>#</y><d>2016-01-20</d><h>18:03</h><w>bhagany</w>example: <a href="https://github.com/bhagany/thisonesforthegirls/blob/master/lambda-src/thisonesforthegirls/s3.cljs#L19" target="_blank">https://github.com/bhagany/thisonesforthegirls/blob/master/lambda-src/thisonesforthegirls/s3.cljs#L19</a></z><z id="t1453313422" t="curtosis thanks.... unfortunately I need to do it from the browser (or write a Lambda block to do it from API Gateway (or directly))"><y>#</y><d>2016-01-20</d><h>18:10</h><w>curtosis</w>thanks.... unfortunately I need to do it from the browser (or write a Lambda block to do it from API Gateway (or directly))</z><z id="t1453313527" t="curtosis I think the aws-specific code looks the same, but the extern/compiler bits are still voodoo to me."><y>#</y><d>2016-01-20</d><h>18:12</h><w>curtosis</w>I think the aws-specific code looks the same, but the extern/compiler bits are still voodoo to me.</z><z id="t1453321616" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : This is using Java, I wanted to isolate the JVM effects without muddying the water with Clojure startup time"><y>#</y><d>2016-01-20</d><h>20:26</h><w>cfleming</w><a>@ragge</a>: This is using Java, I wanted to isolate the JVM effects without muddying the water with Clojure startup time</z><z id="t1453321685" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : https://forums.aws.amazon.com/thread.jspa?threadID=199685 This thread reaches the same conclusion - Lambda is basically unusable on the JVM unless you have enough volume to keep your instances hot always, or can handle retrying."><y>#</y><d>2016-01-20</d><h>20:28</h><w>cfleming</w><a>@ragge</a>: <a>@ricardo</a>: <a>@alandipert</a>: <a href="https://forums.aws.amazon.com/thread.jspa?threadID=199685" target="_blank">https://forums.aws.amazon.com/thread.jspa?threadID=199685</a> This thread reaches the same conclusion - Lambda is basically unusable on the JVM unless you have enough volume to keep your instances hot always, or can handle retrying.</z><z id="t1453321703" t="cfleming I’m planning to re-run those tests with a) JVM instance with 1.5G and b) Node"><y>#</y><d>2016-01-20</d><h>20:28</h><w>cfleming</w>I’m planning to re-run those tests with a) JVM instance with 1.5G and b) Node</z><z id="t1453321710" t="cfleming I’ll report back with numbers"><y>#</y><d>2016-01-20</d><h>20:28</h><w>cfleming</w>I’ll report back with numbers</z><z id="t1453324169" t="bhagany these lambda tests are really eye-opening"><y>#</y><d>2016-01-20</d><h>21:09</h><w>bhagany</w>these lambda tests are really eye-opening</z><z id="t1453324191" t="bhagany I&apos;m using it, but I don&apos;t care how long they take, so I never systematically timed it"><y>#</y><d>2016-01-20</d><h>21:09</h><w>bhagany</w>I&apos;m using it, but I don&apos;t care how long they take, so I never systematically timed it</z><z id="t1453324243" t="alandipert [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : interesting - still haven&apos;t used jvm lambdas in conjunction w/ api proxy myself"><y>#</y><d>2016-01-20</d><h>21:10</h><w>alandipert</w><a>@cfleming</a>: interesting - still haven&apos;t used jvm lambdas in conjunction w/ api proxy myself</z><z id="t1453324272" t="alandipert working great for us in a high-volume S3-event role, and also with the &apos;scheduled&apos; event for running every 30 mins"><y>#</y><d>2016-01-20</d><h>21:11</h><w>alandipert</w>working great for us in a high-volume S3-event role, and also with the &apos;scheduled&apos; event for running every 30 mins</z><z id="t1453324876" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : I guess with your scheduled event you don’t care if the operation takes 10 seconds, right?"><y>#</y><d>2016-01-20</d><h>21:21</h><w>cfleming</w><a>@alandipert</a>: I guess with your scheduled event you don’t care if the operation takes 10 seconds, right?</z><z id="t1453324895" t="alandipert [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : right - the thing starts an EMR cluster which takes like 15 mins"><y>#</y><d>2016-01-20</d><h>21:21</h><w>alandipert</w><a>@cfleming</a>: right - the thing starts an EMR cluster which takes like 15 mins</z><z id="t1453324956" t="cfleming Yeah. I hesitate to call Lambda totally useless, but a lot of use cases are ruled out by those times."><y>#</y><d>2016-01-20</d><h>21:22</h><w>cfleming</w>Yeah. I hesitate to call Lambda totally useless, but a lot of use cases are ruled out by those times.</z><z id="t1453325014" t="alandipert yeah, and certainly the ones that were the most exciting when i first heard about it"><y>#</y><d>2016-01-20</d><h>21:23</h><w>alandipert</w>yeah, and certainly the ones that were the most exciting when i first heard about it</z><z id="t1453325021" t="cfleming Right."><y>#</y><d>2016-01-20</d><h>21:23</h><w>cfleming</w>Right.</z><z id="t1453325052" t="alandipert as time goes on we find ourselves less and less attracted to the various &quot;add-on&quot; aws services"><y>#</y><d>2016-01-20</d><h>21:24</h><w>alandipert</w>as time goes on we find ourselves less and less attracted to the various &quot;add-on&quot; aws services</z><z id="t1453325071" t="alandipert i am marginally for, micha is increasingly against"><y>#</y><d>2016-01-20</d><h>21:24</h><w>alandipert</w>i am marginally for, micha is increasingly against</z><z id="t1453325116" t="cfleming And if you stick to just the core ones, IMO AWS gets less appealing when compared to some bare-metal cloud offering, especially for big systems."><y>#</y><d>2016-01-20</d><h>21:25</h><w>cfleming</w>And if you stick to just the core ones, IMO AWS gets less appealing when compared to some bare-metal cloud offering, especially for big systems.</z><z id="t1453325209" t="micha does anyone have experience with that kind of thing?"><y>#</y><d>2016-01-20</d><h>21:26</h><w>micha</w>does anyone have experience with that kind of thing?</z><z id="t1453325261" t="alandipert [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] yeah, altho we can definitely build anything we need out of some combination of s3, EC2, and dynamo"><y>#</y><d>2016-01-20</d><h>21:27</h><w>alandipert</w><a>@cfleming</a> yeah, altho we can definitely build anything we need out of some combination of s3, EC2, and dynamo</z><z id="t1453325308" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : Right, but how much it costs you at scale is more what I’m referring to."><y>#</y><d>2016-01-20</d><h>21:28</h><w>cfleming</w><a>@alandipert</a>: Right, but how much it costs you at scale is more what I’m referring to.</z><z id="t1453325329" t="cfleming It works well for me because at my pitiful scale it’s all basically free."><y>#</y><d>2016-01-20</d><h>21:28</h><w>cfleming</w>It works well for me because at my pitiful scale it’s all basically free.</z><z id="t1453325337" t="alandipert oh, right"><y>#</y><d>2016-01-20</d><h>21:28</h><w>alandipert</w>oh, right</z><z id="t1453325360" t="alandipert yeah we definitely use it for some things that we should not be, if we wanted to be maximally efficient"><y>#</y><d>2016-01-20</d><h>21:29</h><w>alandipert</w>yeah we definitely use it for some things that we should not be, if we wanted to be maximally efficient</z><z id="t1453325395" t="alandipert we have discussed going back to having a data center, for the ad servers"><y>#</y><d>2016-01-20</d><h>21:29</h><w>alandipert</w>we have discussed going back to having a data center, for the ad servers</z><z id="t1453325411" t="alandipert we just don&apos;t need the &quot;aglilty&quot; of cloud for the things we do that are very well defined and rarely change"><y>#</y><d>2016-01-20</d><h>21:30</h><w>alandipert</w>we just don&apos;t need the &quot;aglilty&quot; of cloud for the things we do that are very well defined and rarely change</z><z id="t1453325601" t="cfleming Right, and they must have pretty high volume and care about response time."><y>#</y><d>2016-01-20</d><h>21:33</h><w>cfleming</w>Right, and they must have pretty high volume and care about response time.</z><z id="t1453325666" t="alandipert yeah. very predictable volume also"><y>#</y><d>2016-01-20</d><h>21:34</h><w>alandipert</w>yeah. very predictable volume also</z><z id="t1453325695" t="alandipert we could easily estimate our hardware needs for a 6 month period, buy the boxes, and still be way cheaper than aws"><y>#</y><d>2016-01-20</d><h>21:34</h><w>alandipert</w>we could easily estimate our hardware needs for a 6 month period, buy the boxes, and still be way cheaper than aws</z><z id="t1453325724" t="alandipert but we&apos;d grow sysadmins and multi region would be a little tougher"><y>#</y><d>2016-01-20</d><h>21:35</h><w>alandipert</w>but we&apos;d grow sysadmins and multi region would be a little tougher</z><z id="t1453328641" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : What about softlayer or something similar?"><y>#</y><d>2016-01-20</d><h>22:24</h><w>cfleming</w><a>@alandipert</a>: What about softlayer or something similar?</z><z id="t1453328676" t="alandipert [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : could be an option, but haven&apos;t investigated"><y>#</y><d>2016-01-20</d><h>22:24</h><w>alandipert</w><a>@cfleming</a>: could be an option, but haven&apos;t investigated</z><z id="t1453328696" t="cfleming It’s probably getting a bit heretical for discussion in here too."><y>#</y><d>2016-01-20</d><h>22:24</h><w>cfleming</w>It’s probably getting a bit heretical for discussion in here too.</z><z id="t1453328703" t="alandipert haha"><y>#</y><d>2016-01-20</d><h>22:25</h><w>alandipert</w>haha</z><z id="t1453328708" t="alandipert take it to #softlayer, traitor!!"><y>#</y><d>2016-01-20</d><h>22:25</h><w>alandipert</w>take it to #softlayer, traitor!!</z><z id="t1453328726" t="alandipert but yeah i think ultimately we realized we could save loads just by using AWS smarter"><y>#</y><d>2016-01-20</d><h>22:25</h><w>alandipert</w>but yeah i think ultimately we realized we could save loads just by using AWS smarter</z><z id="t1453328740" t="alandipert so, we&apos;re starting with that, then maybe down the road take another look at providers"><y>#</y><d>2016-01-20</d><h>22:25</h><w>alandipert</w>so, we&apos;re starting with that, then maybe down the road take another look at providers</z><z id="t1453369440" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : Thanks for the link. I wouldn’t say it’s totally unusable, but it doesn’t seem like it’s suitable for something where you’d need realtime performance unless it’s kept warm."><y>#</y><d>2016-01-21</d><h>09:44</h><w>ricardo</w><a>@cfleming</a>: Thanks for the link. I wouldn’t say it’s totally unusable, but it doesn’t seem like it’s suitable for something where you’d need realtime performance unless it’s kept warm.</z><z id="t1453369666" t="ricardo But also, if one needs consistent API performance while keeping a low monthly cost, Linode and Digital Ocean are damned cheap. For something that’d fall under lambda’s free tier, they’d probably suffice."><y>#</y><d>2016-01-21</d><h>09:47</h><w>ricardo</w>But also, if one needs consistent API performance while keeping a low monthly cost, Linode and Digital Ocean are damned cheap. For something that’d fall under lambda’s free tier, they’d probably suffice.</z><z id="t1453369751" t="ricardo I see lambda as more appropriate for something where I don’t necessarily care about realtime performance - say, firing lambdas off events for processing something - or where you need to be able to scale a particular function without having to care about provisioning capacity in advance."><y>#</y><d>2016-01-21</d><h>09:49</h><w>ricardo</w>I see lambda as more appropriate for something where I don’t necessarily care about realtime performance - say, firing lambdas off events for processing something - or where you need to be able to scale a particular function without having to care about provisioning capacity in advance.</z><z id="t1453369775" t="ricardo But they’re clearly not a hammer I can use to hit every possible API with."><y>#</y><d>2016-01-21</d><h>09:49</h><w>ricardo</w>But they’re clearly not a hammer I can use to hit every possible API with.</z><z id="t1453370221" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : Right, but it’s a bummer that it’s so badly suited to the use case that I wanted to use it for."><y>#</y><d>2016-01-21</d><h>09:57</h><w>cfleming</w><a>@ricardo</a>: Right, but it’s a bummer that it’s so badly suited to the use case that I wanted to use it for.</z><z id="t1453370242" t="cfleming However, I’ve done a bunch more testing today, and the good news is that Node is radically better for that use case."><y>#</y><d>2016-01-21</d><h>09:57</h><w>cfleming</w>However, I’ve done a bunch more testing today, and the good news is that Node is radically better for that use case.</z><z id="t1453370259" t="cfleming I need to get to bed now, full details tomorrow sometime."><y>#</y><d>2016-01-21</d><h>09:57</h><w>cfleming</w>I need to get to bed now, full details tomorrow sometime.</z><z id="t1453437854" t="cfleming [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Here are some more numbers. I ran the tests again, with a 1.5GB JVM. The CPU speed is proportional to the RAM, so that&apos;s as fast as you can make them. It made a pretty big difference:"><y>#</y><d>2016-01-22</d><h>04:44</h><w>cfleming</w><a>@ricardo</a>: <a>@alandipert</a>: <a>@ragge</a>: Here are some more numbers. I ran the tests again, with a 1.5GB JVM. The CPU speed is proportional to the RAM, so that&apos;s as fast as you can make them. It made a pretty big difference:</z><z id="t1453437867" t="cfleming 1 min Interval 1 Interval 2 Interval 3 Total Duration RTT 1825 1098 27 2950 3083 6036 29 114 38 181 182 205 7 73 42 122 122 146 2209 1038 81 3328 3456 6070 7 67 30 104 104 144 7 65 31 103 104 139 13 89 24 126 126 161 61 61 27 149 149 217 7 45 21 73 73 92 7 75 37 119 119 149 5 min Interval 1 Interval 2 Interval 3 Total Duration RTT 1710 1218 100 3028 3102 4944 39 60 27 126 126 253 7 63 30 100 101 219 1590 1039 53 2682 2763 3937 72 97 24 193 192 332 6 76 34 116 116 264 6 60 22 88 88 207 8 68 24 100 99 241 7 47 30 84 85 236 9 61 37 107 107 246 15 min Interval 1 Interval 2 Interval 3 Total Duration RTT 2406 1281 43 3730 3775 6164 1995 867 69 2931 3049 5186 1697 1086 38 2821 2864 4386 22 116 14 152 152 287 4340 1671 55 6066 6181 14309 6 69 32 107 108 220 43 78 26 147 147 305 7 85 13 105 104 242 6 53 51 110 110 274 2065 947 53 3065 3165 5082 "><y>#</y><d>2016-01-22</d><h>04:44</h><w>cfleming</w><pre>1 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        1825         1098           27       2950       3083       6036
          29          114           38        181        182        205
           7           73           42        122        122        146
        2209         1038           81       3328       3456       6070
           7           67           30        104        104        144
           7           65           31        103        104        139
          13           89           24        126        126        161
          61           61           27        149        149        217
           7           45           21         73         73         92
           7           75           37        119        119        149

5 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        1710         1218          100       3028       3102       4944
          39           60           27        126        126        253
           7           63           30        100        101        219
        1590         1039           53       2682       2763       3937
          72           97           24        193        192        332
           6           76           34        116        116        264
           6           60           22         88         88        207
           8           68           24        100         99        241
           7           47           30         84         85        236
           9           61           37        107        107        246

15 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        2406         1281           43       3730       3775       6164
        1995          867           69       2931       3049       5186
        1697         1086           38       2821       2864       4386
          22          116           14        152        152        287
        4340         1671           55       6066       6181      14309
           6           69           32        107        108        220
          43           78           26        147        147        305
           7           85           13        105        104        242
           6           53           51        110        110        274
        2065          947           53       3065       3165       5082
</pre></z><z id="t1453437883" t="cfleming Much better numbers, but still pretty large RTTs given that it&apos;s not actually doing much. This time I ran the client on an m4.xlarge instance to get the fastest networking they offer for vanilla EC2, to see if that made any difference to the network RTT - not much. We&apos;re still looking at ~120ms minimum for a lambda call, looks like."><y>#</y><d>2016-01-22</d><h>04:44</h><w>cfleming</w>Much better numbers, but still pretty large RTTs given that it&apos;s not actually doing much. This time I ran the client on an m4.xlarge instance to get the fastest networking they offer for vanilla EC2, to see if that made any difference to the network RTT - not much. We&apos;re still looking at ~120ms minimum for a lambda call, looks like.</z><z id="t1453437892" t="cfleming I then ran the results on Node - these numbers are with a 128MB Lambda. The intervals are a bit different here because of differences in the way the API works - there&apos;s no getTable, so presumably that&apos;s implicitly within Interval 2 instead of 1:"><y>#</y><d>2016-01-22</d><h>04:44</h><w>cfleming</w>I then ran the results on Node - these numbers are with a 128MB Lambda. The intervals are a bit different here because of differences in the way the API works - there&apos;s no getTable, so presumably that&apos;s implicitly within Interval 2 instead of 1:</z><z id="t1453437908" t="cfleming 1 min Interval 1 Interval 2 Interval 3 Total Duration RTT 1906 703 220 2829 2830 3909 2442 744 297 3483 3484 4795 1 236 136 373 374 396 0 103 123 226 241 264 0 262 126 388 400 459 0 80 147 227 249 289 0 65 149 214 214 259 1 100 139 240 257 308 0 64 102 166 184 201 1 79 140 220 234 287 5 min Interval 1 Interval 2 Interval 3 Total Duration RTT 1799 804 277 2880 2897 3702 17 332 99 448 449 568 0 80 151 231 244 347 1323 700 258 2281 2389 3603 1 240 128 369 368 530 0 80 143 223 229 363 1 139 90 230 230 361 0 61 120 181 186 338 1 120 139 260 262 429 1 81 118 200 208 334 15 min Interval 1 Interval 2 Interval 3 Total Duration RTT 1623 820 299 2742 2796 3492 1501 720 240 2461 2498 2754 1 240 159 400 405 534 1 240 120 361 367 490 0 151 129 280 293 464 0 94 107 201 201 362 2081 761 277 3119 3125 4536 1 85 114 200 215 382 1943 740 239 2922 2942 4085 1 241 129 371 388 531 "><y>#</y><d>2016-01-22</d><h>04:45</h><w>cfleming</w><pre>1 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        1906          703          220       2829       2830       3909
        2442          744          297       3483       3484       4795
           1          236          136        373        374        396
           0          103          123        226        241        264
           0          262          126        388        400        459
           0           80          147        227        249        289
           0           65          149        214        214        259
           1          100          139        240        257        308
           0           64          102        166        184        201
           1           79          140        220        234        287

5 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        1799          804          277       2880       2897       3702
          17          332           99        448        449        568
           0           80          151        231        244        347
        1323          700          258       2281       2389       3603
           1          240          128        369        368        530
           0           80          143        223        229        363
           1          139           90        230        230        361
           0           61          120        181        186        338
           1          120          139        260        262        429
           1           81          118        200        208        334

15 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
        1623          820          299       2742       2796       3492
        1501          720          240       2461       2498       2754
           1          240          159        400        405        534
           1          240          120        361        367        490
           0          151          129        280        293        464
           0           94          107        201        201        362
        2081          761          277       3119       3125       4536
           1           85          114        200        215        382
        1943          740          239       2922       2942       4085
           1          241          129        371        388        531
</pre></z><z id="t1453437926" t="cfleming These are dramatically better than the 512MB Lambda, and are even better than the 1.5GB Lambda, when things are cold. This isn&apos;t just instance spinup time, which is much less for Node than the JVM, as expected, but also just the cost of accessing the first AWS service. The only thing I can think of is that the JVM takes a big hit for classloading - this isn&apos;t enough code to even hit the JIT, I&apos;m guessing. This costs 8% of the 1.5GB Lambda to run."><y>#</y><d>2016-01-22</d><h>04:45</h><w>cfleming</w>These are dramatically better than the 512MB Lambda, and are even better than the 1.5GB Lambda, when things are cold. This isn&apos;t just instance spinup time, which is much less for Node than the JVM, as expected, but also just the cost of accessing the first AWS service. The only thing I can think of is that the JVM takes a big hit for classloading - this isn&apos;t enough code to even hit the JIT, I&apos;m guessing. This costs 8% of the 1.5GB Lambda to run.</z><z id="t1453437937" t="cfleming Here&apos;s Node on the 1.5GB Lambda:"><y>#</y><d>2016-01-22</d><h>04:45</h><w>cfleming</w>Here&apos;s Node on the 1.5GB Lambda:</z><z id="t1453437951" t="cfleming 1 min Interval 1 Interval 2 Interval 3 Total Duration RTT 162 89 47 298 299 979 181 78 53 312 313 438 0 48 37 85 86 126 0 33 31 64 64 97 1 26 33 60 60 90 1 36 39 76 76 107 0 27 39 66 66 103 1 30 31 62 62 88 1 38 31 70 70 123 0 25 37 62 62 121 5 min Interval 1 Interval 2 Interval 3 Total Duration RTT 131 75 41 247 248 1065 1 43 34 78 78 171 0 30 34 64 64 168 235 80 43 358 359 838 0 37 45 82 82 215 1 36 39 76 76 322 1 34 39 74 73 188 1 32 29 62 62 369 1 28 35 64 64 280 15 min Interval 1 Interval 2 Interval 3 Total Duration RTT 411 63 36 510 511 2222 140 74 40 254 255 903 1 38 30 69 69 202 "><y>#</y><d>2016-01-22</d><h>04:45</h><w>cfleming</w><pre>1 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
         162           89           47        298        299        979
         181           78           53        312        313        438
           0           48           37         85         86        126
           0           33           31         64         64         97
           1           26           33         60         60         90
           1           36           39         76         76        107
           0           27           39         66         66        103
           1           30           31         62         62         88
           1           38           31         70         70        123
           0           25           37         62         62        121

5 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
         131           75           41        247        248       1065
           1           43           34         78         78        171
           0           30           34         64         64        168
         235           80           43        358        359        838
           0           37           45         82         82        215
           1           36           39         76         76        322
           1           34           39         74         73        188
           1           32           29         62         62        369
           1           28           35         64         64        280

15 min

  Interval 1   Interval 2   Interval 3      Total   Duration        RTT
         411           63           36        510        511       2222
         140           74           40        254        255        903
           1           38           30         69         69        202
</pre></z><z id="t1453437965" t="cfleming I wanted to shut down the large instance before going to bed so it doesn&apos;t have all the data, but you can see where this is going - it&apos;s way faster than any of the JVM options. Basically, unless you need to use a JVM API, or you&apos;re going to be running a long CPU-intensive process, I&apos;d use Node for pretty much everything."><y>#</y><d>2016-01-22</d><h>04:46</h><w>cfleming</w>I wanted to shut down the large instance before going to bed so it doesn&apos;t have all the data, but you can see where this is going - it&apos;s way faster than any of the JVM options. Basically, unless you need to use a JVM API, or you&apos;re going to be running a long CPU-intensive process, I&apos;d use Node for pretty much everything.</z><z id="t1453438068" t="cfleming I should really write this up in a blog, since the vengeful Slack god will have eaten it by this time tomorrow."><y>#</y><d>2016-01-22</d><h>04:47</h><w>cfleming</w>I should really write this up in a blog, since the vengeful Slack god will have eaten it by this time tomorrow.</z><z id="t1453451991" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : thanks again for sharing this, very useful"><y>#</y><d>2016-01-22</d><h>08:39</h><w>ragge</w><a>@cfleming</a>: thanks again for sharing this, very useful</z><z id="t1453452089" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : i think publishing the results in some form would be helpful, I could get our AWS account manager (or whatever it&apos;s called) to take a look and see if he can explain your findings"><y>#</y><d>2016-01-22</d><h>08:41</h><w>ragge</w><a>@cfleming</a>: i think publishing the results in some form would be helpful, I could get our AWS account manager (or whatever it&apos;s called) to take a look and see if he can explain your findings</z><z id="t1453452111" t="ragge [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : they&apos;ve been quite responsive with queries like this before"><y>#</y><d>2016-01-22</d><h>08:41</h><w>ragge</w><a>@cfleming</a>: they&apos;ve been quite responsive with queries like this before</z><z id="t1453452277" t="cfleming [:attrs {:href &quot;/_/_/users/U05267CJN&quot;}] : Ok, I’ll try to do that soon."><y>#</y><d>2016-01-22</d><h>08:44</h><w>cfleming</w><a>@ragge</a>: Ok, I’ll try to do that soon.</z><z id="t1453471529" t="alandipert Thanks again for sharing [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] very interesting "><y>#</y><d>2016-01-22</d><h>14:05</h><w>alandipert</w>Thanks again for sharing <a>@cfleming</a> very interesting </z><z id="t1453566130" t="micha hi, anyone around and want to hear my aws story?"><y>#</y><d>2016-01-23</d><h>16:22</h><w>micha</w>hi, anyone around and want to hear my aws story?</z><z id="t1453568323" t="jonahbenton hey [:attrs {:href &quot;/_/_/users/U055HMK9L&quot;}] am sure people would love to hear, but because slack loses history maybe better to write it as a blog and share a link here?"><y>#</y><d>2016-01-23</d><h>16:58</h><w>jonahbenton</w>hey <a>@micha</a> am sure people would love to hear, but because slack loses history maybe better to write it as a blog and share a link here?</z><z id="t1453568416" t="micha it&apos;s not really a story, i&apos;m looking for a sanity check of my unerstanding of how various aws things fit together"><y>#</y><d>2016-01-23</d><h>17:00</h><w>micha</w>it&apos;s not really a story, i&apos;m looking for a sanity check of my unerstanding of how various aws things fit together</z><z id="t1453569433" t="jonahbenton sure thing, am sure folks will be happy to chime in"><y>#</y><d>2016-01-23</d><h>17:17</h><w>jonahbenton</w>sure thing, am sure folks will be happy to chime in</z><z id="t1453575116" t="micha i want to make a service that is not exposed to the internet, a cluster of webservers in an ASG behind an internal ELB. i want to have a webserver in each of three availability zones. The webservice will use the private IP address of the client (the source IP of the request) to form its response. It will need to use classic link to be reachable by instances we have that aren&apos;t in a VPC yet. This webservice needs to be accessible from all of our VPCs, too."><y>#</y><d>2016-01-23</d><h>18:51</h><w>micha</w>i want to make a service that is not exposed to the internet, a cluster of webservers in an ASG behind an internal ELB. i want to have a webserver in each of three availability zones. The webservice will use the private IP address of the client (the source IP of the request) to form its response. It will need to use classic link to be reachable by instances we have that aren&apos;t in a VPC yet. This webservice needs to be accessible from all of our VPCs, too.</z><z id="t1453575346" t="micha so my understanding is that i can create a vpc with a subnet in each az, use a NAT device to allow outbound connections to the internet from the instances in the vpc. an asg in the vpc can be created that will create instances in each of the azs, and an internal elb that will be reached by a private ip address (not internet routable). then, classic link can be used to expose the internal elb to the ec2 classic network, and vpc peering can be used to expose it to all the other vpcs we may have"><y>#</y><d>2016-01-23</d><h>18:55</h><w>micha</w>so my understanding is that i can create a vpc with a subnet in each az, use a NAT device to allow outbound connections to the internet from the instances in the vpc. an asg in the vpc can be created that will create instances in each of the azs, and an internal elb that will be reached by a private ip address (not internet routable). then, classic link can be used to expose the internal elb to the ec2 classic network, and vpc peering can be used to expose it to all the other vpcs we may have</z><z id="t1453575380" t="micha is that more or less legit?"><y>#</y><d>2016-01-23</d><h>18:56</h><w>micha</w>is that more or less legit?</z><z id="t1453575720" t="bhagany There are bits that are outside my experience, eg. exposing the elb to classic link, but I don&apos;t see any red flags"><y>#</y><d>2016-01-23</d><h>19:02</h><w>bhagany</w>There are bits that are outside my experience, eg. exposing the elb to classic link, but I don&apos;t see any red flags</z><z id="t1453575789" t="micha [:attrs {:href &quot;/_/_/users/U051706GF&quot;}] : thanks! have you used internal elb before?"><y>#</y><d>2016-01-23</d><h>19:03</h><w>micha</w><a>@bhagany</a>: thanks! have you used internal elb before?</z><z id="t1453575796" t="micha like without classic link?"><y>#</y><d>2016-01-23</d><h>19:03</h><w>micha</w>like without classic link?</z><z id="t1453575832" t="bhagany all of our elb&apos;s are still on classic, so not really. we treat them as internal, but they are still publicly reachable"><y>#</y><d>2016-01-23</d><h>19:03</h><w>bhagany</w>all of our elb&apos;s are still on classic, so not really.  we treat them as internal, but they are still publicly reachable</z><z id="t1453575848" t="micha yeah same here"><y>#</y><d>2016-01-23</d><h>19:04</h><w>micha</w>yeah same here</z><z id="t1453655020" t="luposlip Anyone managed to setup a Clojure app with Sente ( https://github.com/ptaoussanis/sente/ ) based web sockets with AWS ELB in front?"><y>#</y><d>2016-01-24</d><h>17:03</h><w>luposlip</w>Anyone managed to setup a Clojure app with Sente (<a href="https://github.com/ptaoussanis/sente/" target="_blank">https://github.com/ptaoussanis/sente/</a>) based web sockets with AWS ELB in front?</z><z id="t1453655098" t="luposlip In my setup with HTTPS the browser never connects the web socket, and best case (without the SSL endpoint encryption) the server returns status 200 ok instead of 101 (changing protocols)."><y>#</y><d>2016-01-24</d><h>17:04</h><w>luposlip</w>In my setup with HTTPS the browser never connects the web socket, and best case (without the SSL endpoint encryption) the server returns status 200 ok instead of 101 (changing protocols).</z><z id="t1453655142" t="luposlip ..considering installing nginx and completely dropping the ELB"><y>#</y><d>2016-01-24</d><h>17:05</h><w>luposlip</w>..considering installing nginx and completely dropping the ELB</z><z id="t1453655718" t="jaen IIRC ELB cannot into websockets"><y>#</y><d>2016-01-24</d><h>17:15</h><w>jaen</w>IIRC ELB cannot into websockets</z><z id="t1453655766" t="jaen At best you can do a pass-through the load balancer"><y>#</y><d>2016-01-24</d><h>17:16</h><w>jaen</w>At best you can do a pass-through the load balancer</z><z id="t1453655813" t="jaen https://www.built.io/blog/2014/11/websockets-on-aws-elb/"><y>#</y><d>2016-01-24</d><h>17:16</h><w>jaen</w><a href="https://www.built.io/blog/2014/11/websockets-on-aws-elb/" target="_blank">https://www.built.io/blog/2014/11/websockets-on-aws-elb/</a></z><z id="t1453655845" t="luposlip Couldn’t get the pass-through to work, but will look at your link, thanks [:attrs {:href &quot;/_/_/users/U0A727APP&quot;}] ."><y>#</y><d>2016-01-24</d><h>17:17</h><w>luposlip</w>Couldn’t get the pass-through to work, but will look at your link, thanks <a>@jaen</a>.</z><z id="t1453655887" t="luposlip What setup would you suggest - ELB on port 80 through to a nginx with SSL, reverse proxying to the application?"><y>#</y><d>2016-01-24</d><h>17:18</h><w>luposlip</w>What setup would you suggest - ELB on port 80 through to a nginx with SSL, reverse proxying to the application?</z><z id="t1453655891" t="luposlip Or no ELB at all?"><y>#</y><d>2016-01-24</d><h>17:18</h><w>luposlip</w>Or no ELB at all?</z><z id="t1453655919" t="jaen I think I got to work with my previous Ruby+node/socket.io project, but can&apos;t check how it was setup now unfortunately. It was done similarly to the link above and it worked, so this hopefully should work for you."><y>#</y><d>2016-01-24</d><h>17:18</h><w>jaen</w>I think I got to work with my previous Ruby+node/socket.io project, but can&apos;t check how it was setup now unfortunately. It was done similarly to the link above and it worked, so this hopefully should work for you.</z><z id="t1453655925" t="jaen Depends if you plan to scale easily."><y>#</y><d>2016-01-24</d><h>17:18</h><w>jaen</w>Depends if you plan to scale easily.</z><z id="t1453655943" t="jaen If you do, then it makes sense to either a) keep using ELB, b) consider setting up something like HAProxy"><y>#</y><d>2016-01-24</d><h>17:19</h><w>jaen</w>If you do, then it makes sense to either a) keep using ELB, b) consider setting up something like HAProxy</z><z id="t1453655966" t="jaen And you can terminate SSL on ELB if you want, I think."><y>#</y><d>2016-01-24</d><h>17:19</h><w>jaen</w>And you can terminate SSL on ELB if you want, I think.</z><z id="t1453655994" t="jaen Though I think I was doing what you described and terminating SSL with nginx on the same machine Ruby was running on."><y>#</y><d>2016-01-24</d><h>17:19</h><w>jaen</w>Though I think I was doing what you described and terminating SSL with nginx on the same machine Ruby was running on.</z><z id="t1453656021" t="luposlip Yes, but I don’t think SSL termination on ELB works with websockets (as far as I’ve been able to read out there)."><y>#</y><d>2016-01-24</d><h>17:20</h><w>luposlip</w>Yes, but I don’t think SSL termination on ELB works with websockets (as far as I’ve been able to read out there).</z><z id="t1453656034" t="luposlip Well, on to the link simple_smile"><y>#</y><d>2016-01-24</d><h>17:20</h><w>luposlip</w>Well, on to the link <b>simple_smile</b></z><z id="t1453656179" t="jaen Also found this right now - https://blog.jverkamp.com/2015/07/20/configuring-websockets-behind-an-aws-elb/ . And this - http://spicefactory.co/blog/2015/09/17/aws-elb-wss/ . In case the above would not be enough."><y>#</y><d>2016-01-24</d><h>17:22</h><w>jaen</w>Also found this right now - <a href="https://blog.jverkamp.com/2015/07/20/configuring-websockets-behind-an-aws-elb/" target="_blank">https://blog.jverkamp.com/2015/07/20/configuring-websockets-behind-an-aws-elb/</a>. And this - <a href="http://spicefactory.co/blog/2015/09/17/aws-elb-wss/" target="_blank">http://spicefactory.co/blog/2015/09/17/aws-elb-wss/</a>. In case the above would not be enough.</z><z id="t1453656229" t="jaen As I understand, though it&apos;s been a while - you can terminate SSL on the ELB, but you can&apos;t do anything HTTP/WSS-specific (like adding headers), since you proxy on the transport layer (and I just may be mistaken and TLS is negotiated above that level, then you would be right)."><y>#</y><d>2016-01-24</d><h>17:23</h><w>jaen</w>As I understand, though it&apos;s been a while - you can terminate SSL on the ELB, but you can&apos;t do anything HTTP/WSS-specific (like adding headers), since you proxy on the transport layer (and I just may be mistaken and TLS is negotiated above that level, then you would be right).</z><z id="t1453656522" t="jaen Ha, and you seem to be right, TLS works on the layer above transport. My bad."><y>#</y><d>2016-01-24</d><h>17:28</h><w>jaen</w>Ha, and you seem to be right, TLS works on the layer above transport. My bad.</z><z id="t1453657421" t="luposlip simple_smile"><y>#</y><d>2016-01-24</d><h>17:43</h><w>luposlip</w><b>simple_smile</b></z><z id="t1453657464" t="luposlip Please bear in mind I’m sort-of a newbie with most of AWS. Have been using EC2 for a while, but not ECS/ELB etc."><y>#</y><d>2016-01-24</d><h>17:44</h><w>luposlip</w>Please bear in mind I’m sort-of a newbie with most of AWS. Have been using EC2 for a while, but not ECS/ELB etc.</z><z id="t1453657485" t="luposlip Could it be an idea to install nginx reverse proxy directly in my container instance running my app?"><y>#</y><d>2016-01-24</d><h>17:44</h><w>luposlip</w>Could it be an idea to install nginx reverse proxy directly in my container instance running my app?</z><z id="t1453659244" t="jaen Yup, I guess you could, and then just register that endpoint in ELB."><y>#</y><d>2016-01-24</d><h>18:14</h><w>jaen</w>Yup, I guess you could, and then just register that endpoint in ELB.</z><z id="t1453659287" t="jaen A thing to keep in mind - ELB treats only a direct 200 as a healthy instance. In particular a 3xx to a URL serving a 2xx will be considered unhealthy."><y>#</y><d>2016-01-24</d><h>18:14</h><w>jaen</w>A thing to keep in mind - ELB treats only a direct 200 as a healthy instance. In particular a 3xx to a URL serving a 2xx will be considered unhealthy.</z><z id="t1453659339" t="jaen I&apos;ve had to add a specific conditional for ELB in my nginx config."><y>#</y><d>2016-01-24</d><h>18:15</h><w>jaen</w>I&apos;ve had to add a specific conditional for ELB in my nginx config.</z><z id="t1453659526" t="jaen # if you&apos;re not ELB then here, have a redirect if ($http_user_agent !~* &quot;ELB-HealthChecker&quot;) { rewrite ^(.*) $scheme://&lt;%= fetch(:site_domain) %&gt;$1 permanent; } "><y>#</y><d>2016-01-24</d><h>18:18</h><w>jaen</w><pre># if you&apos;re not ELB then here, have a redirect
if ($http_user_agent !~* &quot;ELB-HealthChecker&quot;) {
    rewrite ^(.*) $scheme://&lt;%= fetch(:site_domain) %&gt;$1 permanent;
}
</pre></z><z id="t1453677015" t="luposlip Great news! The AWS ELB can actually be used with web sockets, if you set it to Secure TCP -&gt; TCP instead of HTTPS -&gt; HTTP. So everything works now, out of the box, no need for nginx or other low level tricks for SSL termination! simple_smile"><y>#</y><d>2016-01-24</d><h>23:10</h><w>luposlip</w>Great news! The AWS ELB can actually be used with web sockets, if you set it to Secure TCP -&gt; TCP instead of HTTPS -&gt; HTTP. So everything works now, out of the box, no need for nginx or other low level tricks for SSL termination! <b>simple_smile</b></z><z id="t1453765317" t="raywillig does anyone have experience getting a clojure application running on ELB/Tomcat to log to papertrail with clojure.tools.logging and logback?"><y>#</y><d>2016-01-25</d><h>23:41</h><w>raywillig</w>does anyone have experience getting a clojure application running on ELB/Tomcat to log to papertrail with clojure.tools.logging and logback?</z><z id="t1453765401" t="raywillig i&apos;m using boot and when i run locally with boot-jetty it logs to papertrail"><y>#</y><d>2016-01-25</d><h>23:43</h><w>raywillig</w>i&apos;m using boot and when i run locally with boot-jetty it logs to papertrail</z><z id="t1453807271" t="ricardo [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] : Thanks for posting them. Yes, a blog post would be great for people who don’t hang around the Slack channel. For me having access to the Java libraries is worth the trade-off from the higher cost, but it’s undeniably heavier."><y>#</y><d>2016-01-26</d><h>11:21</h><w>ricardo</w><a>@cfleming</a>: Thanks for posting them. Yes, a blog post would be great for people who don’t hang around the Slack channel. For me having access to the Java libraries is worth the trade-off from the higher cost, but it’s undeniably heavier.</z><z id="t1454164106" t="micha i wonder when amazon will provide health checks as a service"><y>#</y><d>2016-01-30</d><h>14:28</h><w>micha</w>i wonder when amazon will provide health checks as a service</z><z id="t1454164132" t="micha i can imagine guys in white lab coats with amazon badges coming to my home to remove me from my ASG when i die"><y>#</y><d>2016-01-30</d><h>14:28</h><w>micha</w>i can imagine guys in white lab coats with amazon badges coming to my home to remove me from my ASG when i die</z><z id="t1454164143" t="micha or maybe drones at that point"><y>#</y><d>2016-01-30</d><h>14:29</h><w>micha</w>or maybe drones at that point</z><z id="t1454167985" t="alandipert failing health checks but still alive because of a dynamo issue, drone don&apos;t care"><y>#</y><d>2016-01-30</d><h>15:33</h><w>alandipert</w>failing health checks but still alive because of a dynamo issue, drone don&apos;t care</z><z id="t1454169138" t="micha so when i create an ASG i can specify ELB healthchecks as an option"><y>#</y><d>2016-01-30</d><h>15:52</h><w>micha</w>so when i create an ASG i can specify ELB healthchecks as an option</z><z id="t1454169165" t="micha does this require that i also have the ASG linked to an ELB, or is it separate?"><y>#</y><d>2016-01-30</d><h>15:52</h><w>micha</w>does this require that i also have the ASG linked to an ELB, or is it separate?</z><z id="t1454257541" t="meow :drones:"><y>#</y><d>2016-01-31</d><h>16:25</h><w>meow</w><b>:drones:</b></z><z id="t1454272202" t="martinklepsch [:attrs {:href &quot;/_/_/users/U05370GCR&quot;}] : you can add custom ones but you might know that already"><y>#</y><d>2016-01-31</d><h>20:30</h><w>martinklepsch</w><a>@meow</a>: you can add custom ones but you might know that already</z><z id="t1454272248" t="meow [:attrs {:href &quot;/_/_/users/U050TNB9F&quot;}] : I kinda remember seeing that, but have never done it."><y>#</y><d>2016-01-31</d><h>20:30</h><w>meow</w><a>@martinklepsch</a>: I kinda remember seeing that, but have never done it.</z><z id="t1454489087" t="luposlip Just as an info, last weekend we successfully moved full-stack Clojure/ClojureScript/Datomic app MeeWee ( https://app.meewee.com ) from a combined Heroku/EC2 setup to 100% AWS/ECS (Docker)/ELB setup. Feel free to ping/PM me if you wanna know any details. We’re really happy about the move! simple_smile"><y>#</y><d>2016-02-03</d><h>08:44</h><w>luposlip</w>Just as an info, last weekend we successfully moved full-stack Clojure/ClojureScript/Datomic app MeeWee (<a href="https://app.meewee.com" target="_blank">https://app.meewee.com</a>) from a combined Heroku/EC2 setup to 100% AWS/ECS (Docker)/ELB setup.

Feel free to ping/PM me if you wanna know any details. We’re really happy about the move! <b>simple_smile</b></z><z id="t1454489117" t="luposlip (sorry about the huge logo..)"><y>#</y><d>2016-02-03</d><h>08:45</h><w>luposlip</w>(sorry about the huge logo..)</z><z id="t1454614328" t="micha i&apos;m curious why kinesis is so much cheaper than sqs, since they seem somewhat similar"><y>#</y><d>2016-02-04</d><h>19:32</h><w>micha</w>i&apos;m curious why kinesis is so much cheaper than sqs, since they seem somewhat similar</z><z id="t1454618892" t="curtosis couple of good answers here: https://aws.amazon.com/kinesis/streams/faqs/"><y>#</y><d>2016-02-04</d><h>20:48</h><w>curtosis</w>couple of good answers here: <a href="https://aws.amazon.com/kinesis/streams/faqs/" target="_blank">https://aws.amazon.com/kinesis/streams/faqs/</a></z><z id="t1454618920" t="curtosis well, not why it&apos;s cheaper, but how they&apos;re different. the short version is stream vs. message semantics, it seems."><y>#</y><d>2016-02-04</d><h>20:48</h><w>curtosis</w>well, not why it&apos;s cheaper, but how they&apos;re different. the short version is stream vs. message semantics, it seems.</z><z id="t1454633497" t="micha i guess the expensive operations happen when you are able to reorder the messages"><y>#</y><d>2016-02-05</d><h>00:51</h><w>micha</w>i guess the expensive operations happen when you are able to reorder the messages</z><z id="t1454670637" t="ricardo [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] : That sounds like the sort of thing that would be suitable for an article."><y>#</y><d>2016-02-05</d><h>11:10</h><w>ricardo</w><a>@luposlip</a>: That sounds like the sort of thing that would be suitable for an article.</z><z id="t1454670974" t="luposlip [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] - I guess you’re right simple_smile Wish I had the time. If enough request it, perhaps with pointers at what others find most interesting so I can focus the article on those topics, I might try and find the time simple_smile"><y>#</y><d>2016-02-05</d><h>11:16</h><w>luposlip</w><a>@ricardo</a> - I guess you’re right <b>simple_smile</b> Wish I had the time. If enough request it, perhaps with pointers at what others find most interesting so I can focus the article on those topics, I might try and find the time <b>simple_smile</b></z><z id="t1454672217" t="ricardo [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] : Why not do a brief “we moved, found these pros and cons, reach out of your want more details”?"><y>#</y><d>2016-02-05</d><h>11:36</h><w>ricardo</w><a>@luposlip</a>: Why not do a brief “we moved, found these pros and cons, reach out of your want more details”?</z><z id="t1454672230" t="ricardo I suspect that’s more generally useful than technical migration details."><y>#</y><d>2016-02-05</d><h>11:37</h><w>ricardo</w>I suspect that’s more generally useful than technical migration details.</z><z id="t1454672245" t="ricardo And will help you judge interest."><y>#</y><d>2016-02-05</d><h>11:37</h><w>ricardo</w>And will help you judge interest.</z><z id="t1454672506" t="luposlip [:attrs {:href &quot;/_/_/users/U054CPS0K&quot;}] : I’ll see if I can find the time next week, thanks for your input!"><y>#</y><d>2016-02-05</d><h>11:41</h><w>luposlip</w><a>@ricardo</a>: I’ll see if I can find the time next week, thanks for your input!</z><z id="t1454672543" t="ricardo No problem. If nothing else, it serves the purpose of having more Clojure-related articles out there."><y>#</y><d>2016-02-05</d><h>11:42</h><w>ricardo</w>No problem. If nothing else, it serves the purpose of having more Clojure-related articles out there.</z><z id="t1455638685" t="vikeri Has anyone worked with cljs-lambda?"><y>#</y><d>2016-02-16</d><h>16:04</h><w>vikeri</w>Has anyone worked with cljs-lambda?</z><z id="t1455713885" t="lowl4tency vikeri: Me!"><y>#</y><d>2016-02-17</d><h>12:58</h><w>lowl4tency</w>vikeri: Me!</z><z id="t1455713924" t="lowl4tency oh, sorry, I&apos;ve got clj simple_smile"><y>#</y><d>2016-02-17</d><h>12:58</h><w>lowl4tency</w>oh, sorry, I&apos;ve got clj <b>simple_smile</b></z><z id="t1455714312" t="lowl4tency Honestly I don&apos;t see any issues with cljs, just need to compile and deploy as ussually nodejs code"><y>#</y><d>2016-02-17</d><h>13:05</h><w>lowl4tency</w>Honestly I don&apos;t see any issues with cljs, just need to compile and deploy as ussually nodejs code</z><z id="t1455801204" t="vikeri I had one issue with node not having the XMLHttpRequest object which the major http(s) libraries in cljs are based on."><y>#</y><d>2016-02-18</d><h>13:13</h><w>vikeri</w>I had one issue with node not having the XMLHttpRequest object which the major http(s) libraries in cljs are based on.</z><z id="t1457249302" t="onetom It seems amazonica is the defacto aws sdk wrapper, but it&apos;s a bit complicated internally imho. I cant see a way to efficiently mock it either. As far as I understood the Java SDK doesn&apos;t lend itself to testing either. There is https://github.com/bizo/aws-java-sdk-stubs which shows some nice examples how should a mock/stub sdk look like but it&apos;s not very complete and it&apos;s still just java not clj(s)."><y>#</y><d>2016-03-06</d><h>07:28</h><w>onetom</w>It seems amazonica is the defacto aws sdk wrapper, but it&apos;s a bit complicated internally imho.
I cant see a way to efficiently mock it either.
As far as I understood the Java SDK doesn&apos;t lend itself to testing either.
There is <a href="https://github.com/bizo/aws-java-sdk-stubs" target="_blank">https://github.com/bizo/aws-java-sdk-stubs</a> which shows some nice examples how should a mock/stub sdk look like but it&apos;s not very complete and it&apos;s still just java not clj(s).</z><z id="t1457249398" t="onetom It does have an important tagline though: &gt; Services should come with stubs"><y>#</y><d>2016-03-06</d><h>07:29</h><w>onetom</w>It does have an important tagline though:
&gt; Services should come with stubs</z><z id="t1457249498" t="onetom I can totally agree with it because recently I had to use the Route53 API and I had to construct some stubs myself by try and capturing the behaviour of the real API"><y>#</y><d>2016-03-06</d><h>07:31</h><w>onetom</w>I can totally agree with it because recently I had to use the Route53 API and I had to construct some stubs myself by try and capturing the behaviour of the real API</z><z id="t1457249729" t="onetom I envision some AWS danielsz/system components - real and stub ones, maybe a separate credential provider component too - which provide an idiomatic clojure interface"><y>#</y><d>2016-03-06</d><h>07:35</h><w>onetom</w>I envision some AWS <code>danielsz/system</code> components - real and stub ones, maybe a separate credential provider component too - which provide an idiomatic clojure interface</z><z id="t1457249753" t="onetom Would anyone be interested helping out?"><y>#</y><d>2016-03-06</d><h>07:35</h><w>onetom</w>Would anyone be interested helping out?</z><z id="t1457249832" t="onetom I have a super specialized implementation which only satisfies the needs of a very constrained micro project, but i can probably share that to illustrate what am i talking about"><y>#</y><d>2016-03-06</d><h>07:37</h><w>onetom</w>I have a super specialized implementation which only satisfies the needs of a very constrained micro project, but i can probably share that to illustrate what am i talking about</z><z id="t1457282837" t="lmergen oh i hate amazonica! there&apos;s no documentation at all"><y>#</y><d>2016-03-06</d><h>16:47</h><w>lmergen</w>oh i hate amazonica! there&apos;s no documentation at all</z><z id="t1457284874" t="jonahbenton [:attrs {:href &quot;/_/_/users/U0M8Y3G6N&quot;}] [:attrs {:href &quot;/_/_/users/U086D6TBN&quot;}] i&apos;m wondering if you&apos;ve looked at the amazonica implementation? amazonica is largely just automatically generating clojure functions around the java apis. see how set-client: https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L911 iterates through client-methods, mechanically transforming them into clojure names, and then interning a fn that looks up and determines the best-method in the api to assign to the interned fn. You could probably implement a workable stub with a small fork of amazonica, to muck with the best-method wiring, perhaps changing it to a multimethod and so then you could extensibly return stubs"><y>#</y><d>2016-03-06</d><h>17:21</h><w>jonahbenton</w><a>@lmergen</a> <a>@onetom</a> i&apos;m wondering if you&apos;ve looked at the amazonica implementation? amazonica is largely just automatically generating clojure functions around the java apis. 
see how set-client: <a href="https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L911" target="_blank">https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L911</a>  iterates through client-methods, mechanically transforming them into clojure names, and then interning a fn that looks up and determines the best-method in the api to assign to the interned fn. 
You could probably implement a workable stub with a small fork of amazonica, to muck with the best-method wiring, perhaps changing it to a multimethod and so then you could extensibly return stubs</z><z id="t1457285361" t="lmergen yeah that&apos;s correct, i&apos;ve seen that"><y>#</y><d>2016-03-06</d><h>17:29</h><w>lmergen</w>yeah that&apos;s correct, i&apos;ve seen that</z><z id="t1457285376" t="lmergen but then the AWS java SDK has very little documentation either"><y>#</y><d>2016-03-06</d><h>17:29</h><w>lmergen</w>but then the AWS java SDK has very little documentation either</z><z id="t1457285388" t="lmergen and their whole API is... a bit weird, at some places"><y>#</y><d>2016-03-06</d><h>17:29</h><w>lmergen</w>and their whole API is... a bit weird, at some places</z><z id="t1457285400" t="lmergen and you can easily lose a day worth of productivity because of some weird bug"><y>#</y><d>2016-03-06</d><h>17:30</h><w>lmergen</w>and you can easily lose a day worth of productivity because of some weird bug</z><z id="t1457314821" t="lmergen also i have to say amazonica is quite elegant in itself, since it is the most perfect form of abstraction to the java sdk possible. so it&apos;s generally just a complaint about the aws java sdk, all documentation is soo scattered, and debugging protocol errors is a hell. i automatically create SQS queues and SNS topics, and subscribe the queues to certain topics, but after making these subscriptions, messages are just not appearing in the queue. after a bit of debugging, i suddenly find out there is some &quot;principal-id&quot; i have to provide in order for a queue to aubscribe to a queue. ok, fine, i provide my user id. nop. still nothing. no way to debug why my user id wasnt accepted, since the subscription is visible from the console, but still no messages coming in from the topic... ... ok. so lets create such a subscription from the web console, and see how that permission differs from my programmatically created one. ah! principal-id is ! of course, ive seen that before. ok, i use the api, sqs/add-permission, provide as principal id, and..... an error coming back from amazon&apos;s api. apparently * is not a valid principal id. after a bit of googling, i find out i have to manually call set-attribute :policy, attach the policy in string form (because fuck it, the json-capable REST server expects the nicely json formatted policy to be provided as a string, so in order not to lose my sanity, i use an intermediate nice object and then use chesire/format-string to convert it to a string). oh yeah, have i ranted yet about the idiotic, overengineered way that whole policy system works?! it feels like they intentionally tried to get rid of all the elegance and simplicity that json brings, and tried to get their java, xml-based thinking coming from XSLT. they should not consider json a programming language, but then why am i providing Statements and stuff in policy definitions. argh. sometimes i wonder why they come up with interfaces like that. is it just the enterprises&apos; pressure to come with an api like that, or is it just how they did it internally and then it just went out in the open..? anyway, it&apos;s been a fun week for me interacting with the aws api. :)"><y>#</y><d>2016-03-07</d><h>01:40</h><w>lmergen</w>also i have to say amazonica is quite elegant in itself, since it is the most perfect form of abstraction to the java sdk possible. so it&apos;s generally just a complaint about the aws java sdk, all documentation is soo scattered, and debugging protocol errors is a hell. 

i automatically create SQS queues and SNS topics, and subscribe the queues to certain topics, but after making these subscriptions, messages are just not appearing in the queue. after a bit of debugging, i suddenly find out there is some &quot;principal-id&quot; i have to provide in order for a queue to aubscribe to a queue. ok, fine, i provide my user id. nop. still nothing. no way to debug why my user id wasnt accepted, since the subscription is visible from the console, but still no messages coming in from the topic...

... ok. so lets create such a subscription from the web console, and see how that permission differs from my programmatically created one. ah! principal-id is ! of course, ive seen that before. ok, i use the api, sqs/add-permission, provide  as principal id, and..... an error coming back from amazon&apos;s api. apparently * is not a valid principal id. after a bit of googling, i find out i have to manually call set-attribute :policy, attach the policy in string form (because fuck it, the json-capable REST server expects the nicely json formatted policy to be provided as a string, so in order not to lose my sanity, i use an intermediate nice object and then use chesire/format-string to convert it to a string).

oh yeah, have i ranted yet about the idiotic, overengineered way that whole policy system works?! it feels like they intentionally tried to get rid of all the elegance and simplicity that json brings, and tried to get their java, xml-based thinking coming from XSLT. they should not consider json a programming language, but then why am i providing Statements and stuff in policy definitions. 

argh. sometimes i wonder why they come up with interfaces like that. is it just the enterprises&apos; pressure to come with an api like that, or is it just how they did it internally and then it just went out in the open..? 

anyway, it&apos;s been a fun week for me interacting with the aws api. :)</z><z id="t1457318153" t="onetom i agree that amazonica is implemented very elegantly, with minimal amount of logic, but it&apos;s hard to see thru it without knowing the java reflection api. even if it could be modified to produce some stub versions, those stubs wouldn&apos;t mimic the original behaviours. here is some explanation how a good stub should look like: http://www.draconianoverlord.com/2013/04/13/services-should-come-with-stubs.html"><y>#</y><d>2016-03-07</d><h>02:35</h><w>onetom</w>i agree that amazonica is implemented very elegantly, with minimal amount of logic, but it&apos;s hard to see thru it without knowing the  java reflection api.

even if it could be modified to produce some stub versions, those stubs wouldn&apos;t mimic the original behaviours.

here is some explanation how a good stub should look like:
<a href="http://www.draconianoverlord.com/2013/04/13/services-should-come-with-stubs.html" target="_blank">http://www.draconianoverlord.com/2013/04/13/services-should-come-with-stubs.html</a></z><z id="t1458809968" t="dottedmag Slightly offtopic -- is there a good Clojure client for Google Cloud (especially Storage)?"><y>#</y><d>2016-03-24</d><h>08:59</h><w>dottedmag</w>Slightly offtopic -- is there a good Clojure client for Google Cloud (especially Storage)?</z><z id="t1458837232" t="jamesleonis [:attrs {:href &quot;/_/_/users/U07HVGQJ3&quot;}] : The closest I’ve got was PalletOps, which wraps the JClouds Java client. I haven’t seen anything specific for GC."><y>#</y><d>2016-03-24</d><h>16:33</h><w>jamesleonis</w><a>@dottedmag</a>: The closest I’ve got was PalletOps, which wraps the JClouds Java client. I haven’t seen anything specific for GC.</z><z id="t1458837237" t="jamesleonis http://palletops.com/"><y>#</y><d>2016-03-24</d><h>16:33</h><w>jamesleonis</w><a href="http://palletops.com/" target="_blank">http://palletops.com/</a></z><z id="t1458897256" t="dottedmag [:attrs {:href &quot;/_/_/users/U0SCZ80LS&quot;}] : Thank you."><y>#</y><d>2016-03-25</d><h>09:14</h><w>dottedmag</w><a>@jamesleonis</a>: Thank you.</z><z id="t1460068004" t="timgilbert Has anyone had any luck deploying Clojure services to EC2 nodes using AWS CodeDeploy? I&apos;ve been struggling with it all day and CodeDeploy honestly seems fairly awful"><y>#</y><d>2016-04-07</d><h>22:26</h><w>timgilbert</w>Has anyone had any luck deploying Clojure services to EC2 nodes using AWS CodeDeploy? I&apos;ve been struggling with it all day and CodeDeploy honestly seems fairly awful</z><z id="t1460068424" t="clojuregeek haven&apos;t used codedeploy. Beanstalk works nice however"><y>#</y><d>2016-04-07</d><h>22:33</h><w>clojuregeek</w>haven&apos;t used codedeploy. Beanstalk works nice however</z><z id="t1460085410" t="Alex Miller (Clojure team) I looked at codedeploy a while back and then backed slowly away"><y>#</y><d>2016-04-08</d><h>03:16</h><w>Alex Miller (Clojure team)</w>I looked at codedeploy a while back and then backed slowly away</z><z id="t1460097302" t="lmergen [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] : we&apos;re using CodeDeploy and Clojure. what questions do you have?"><y>#</y><d>2016-04-08</d><h>06:35</h><w>lmergen</w><a>@timgilbert</a>: we&apos;re using CodeDeploy and Clojure. what questions do you have?</z><z id="t1460120265" t="statonjr [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] : We use CodeDeploy and Clojure, too."><y>#</y><d>2016-04-08</d><h>12:57</h><w>statonjr</w><a>@timgilbert</a>: We use CodeDeploy and Clojure, too.</z><z id="t1460122304" t="timgilbert I&apos;m having a lot of trouble getting it to play well with AutoScaling and ELBs, and it seems really hard to debug since I can&apos;t get the script output anywhere"><y>#</y><d>2016-04-08</d><h>13:31</h><w>timgilbert</w>I&apos;m having a lot of trouble getting it to play well with AutoScaling and ELBs, and it seems really hard to debug since I can&apos;t get the script output anywhere</z><z id="t1460124271" t="timgilbert Also if any of my ApplicationStop lifecycle hooks ever have an error, I can kiss CodeDeploy goodbye since it will just keep trying to run the script from the previous deploy over and over"><y>#</y><d>2016-04-08</d><h>14:04</h><w>timgilbert</w>Also if any of my ApplicationStop lifecycle hooks ever have an error, I can kiss CodeDeploy goodbye since it will just keep trying to run the script from the previous deploy over and over</z><z id="t1460648329" t="alandipert has anyone experimented with the way to write the fastest-startup lambda function possible?"><y>#</y><d>2016-04-14</d><h>15:38</h><w>alandipert</w>has anyone experimented with the way to write the fastest-startup lambda function possible?</z><z id="t1460648346" t="alandipert in particular is there a way to run a binary without exec-ing through node first?"><y>#</y><d>2016-04-14</d><h>15:39</h><w>alandipert</w>in particular is there a way to run a binary without exec-ing through node first?</z><z id="t1460652568" t="lumengxi [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : i have used python handler and it is pretty fast to start"><y>#</y><d>2016-04-14</d><h>16:49</h><w>lumengxi</w><a>@alandipert</a>: i have used python handler and it is pretty fast to start</z><z id="t1460690760" t="keeth [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : I think to run a binary you need a js shim layer. http://apex.run does this (for Go in particular)"><y>#</y><d>2016-04-15</d><h>03:26</h><w>keeth</w><a>@alandipert</a>: I think to run a binary you need a js shim layer. <a href="http://apex.run" target="_blank">http://apex.run</a> does this (for Go in particular)</z><z id="t1460691971" t="alandipert [:attrs {:href &quot;/_/_/users/U0EV13NKH&quot;}] : my finding as well, was hoping for a shim-less way"><y>#</y><d>2016-04-15</d><h>03:46</h><w>alandipert</w><a>@keeth</a>: my finding as well, was hoping for a shim-less way</z><z id="t1461766757" t="firstclassfunc Anyone have experience using AWS Lambda with Clojure?"><y>#</y><d>2016-04-27</d><h>14:19</h><w>firstclassfunc</w>Anyone have experience using AWS Lambda with Clojure?</z><z id="t1461768082" t="clojuregeek I have used it with clojure ... a little slow on startup time but works great..."><y>#</y><d>2016-04-27</d><h>14:41</h><w>clojuregeek</w>I have used it with clojure ... a little slow on startup time but works great...</z><z id="t1461823374" t="jetmind I&apos;m using it with ClojureScript on node runtime, works ok and there&apos;s a tooling to simplify development https://github.com/nervous-systems/cljs-lambda"><y>#</y><d>2016-04-28</d><h>06:02</h><w>jetmind</w>I&apos;m using it with ClojureScript on node runtime, works ok and there&apos;s a tooling to simplify development <a href="https://github.com/nervous-systems/cljs-lambda" target="_blank">https://github.com/nervous-systems/cljs-lambda</a></z><z id="t1461875368" t="firstclassfunc tks. I was getting class loader problems. Maybe I will switch to running JS over Clojurescirpt"><y>#</y><d>2016-04-28</d><h>20:29</h><w>firstclassfunc</w>tks. I was getting class loader problems. Maybe I will switch to running JS over Clojurescirpt</z><z id="t1461936945" t="lmergen interesting that people are choosing node.js over clojure because of speed... simple_smile"><y>#</y><d>2016-04-29</d><h>13:35</h><w>lmergen</w>interesting that people are choosing node.js over clojure because of speed... <b>simple_smile</b></z><z id="t1461936951" t="lmergen that&apos;s not good"><y>#</y><d>2016-04-29</d><h>13:35</h><w>lmergen</w>that&apos;s not good</z><z id="t1461937726" t="clojuregeek it depends .. if you need quick startup and short lived apps, then clojurescript lambdas is fine ..... if a little hit on startup and the lambda lives for awhile, and clojure is good"><y>#</y><d>2016-04-29</d><h>13:48</h><w>clojuregeek</w>it depends  .. if you need quick startup and short lived apps, then clojurescript lambdas is fine  ..... if a little hit on startup and the lambda lives for awhile, and clojure is good</z><z id="t1461937752" t="clojuregeek also depends if the libraries you need to use work with clojurescript or if they need java"><y>#</y><d>2016-04-29</d><h>13:49</h><w>clojuregeek</w>also depends if the libraries you need to use work with clojurescript or if they need java</z><z id="t1461937765" t="clojuregeek jvm ... its not surprising simple_smile"><y>#</y><d>2016-04-29</d><h>13:49</h><w>clojuregeek</w>jvm ... its not surprising  <b>simple_smile</b></z><z id="t1461937942" t="alandipert we have a lambda that&apos;s called about 1M times/day with an s3 event, all it does is put the event into dynamo"><y>#</y><d>2016-04-29</d><h>13:52</h><w>alandipert</w>we have a lambda that&apos;s called about 1M   times/day with an s3 event, all it does is put the event into dynamo</z><z id="t1461937965" t="alandipert the clj 95th run time was 10ms, the node version is about 20ms"><y>#</y><d>2016-04-29</d><h>13:52</h><w>alandipert</w>the clj 95th run time was 10ms, the node version is about 20ms</z><z id="t1461938006" t="alandipert we were being throttled and i thought it was because of clj startup, but really it was dynamo errors and retries causing the lambda to be alive too long"><y>#</y><d>2016-04-29</d><h>13:53</h><w>alandipert</w>we were being throttled and i thought it was because of clj startup, but really it was dynamo errors and retries causing the lambda to be alive too long</z><z id="t1461938029" t="alandipert ended up just using the node version because amazon support understood it better"><y>#</y><d>2016-04-29</d><h>13:53</h><w>alandipert</w>ended up just using the node version because amazon support understood it better</z><z id="t1461938047" t="alandipert the 10ms of addl overhead amounts to 3$/month in extra costs, which i am OK with"><y>#</y><d>2016-04-29</d><h>13:54</h><w>alandipert</w>the 10ms of addl overhead amounts to 3$/month in extra costs, which i am OK with</z><z id="t1464270101" t="lmergen so, apparently amazonica was updated and the latest version of either the java aws library or amazonica now require java8 ... just so you know"><y>#</y><d>2016-05-26</d><h>13:41</h><w>lmergen</w>so, apparently amazonica was updated and the latest version of either the java aws library or amazonica now require java8 ... just so you know</z><z id="t1464685177" t="onetom does anyone knows why amazonica &quot;0.3.58&quot; doesnt pick up the region settings from .aws/config ? (describe-availability-zones) =&gt; {:availability-zones [{:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1a&quot;} {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1b&quot;} {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1c&quot;} {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1e&quot;}]} but it works with explicit endpoint spec: (describe-availability-zones {:endpoint &quot;ap-southeast-1&quot;}) =&gt; {:availability-zones [{:state &quot;available&quot;, :region-name &quot;ap-southeast-1&quot;, :zone-name &quot;ap-southeast-1a&quot;, :messages []} {:state &quot;available&quot;, :region-name &quot;ap-southeast-1&quot;, :zone-name &quot;ap-southeast-1b&quot;, :messages []}]} my config file looks like: &gt; cat ~/.aws/config [default] region=ap-southeast-1 and awscli understands it: aws ec2 describe-availability-zones { &quot;AvailabilityZones&quot;: [ { &quot;State&quot;: &quot;available&quot;, &quot;RegionName&quot;: &quot;ap-southeast-1&quot;, &quot;Messages&quot;: [], &quot;ZoneName&quot;: &quot;ap-southeast-1a&quot; }, { &quot;State&quot;: &quot;available&quot;, &quot;RegionName&quot;: &quot;ap-southeast-1&quot;, &quot;Messages&quot;: [], &quot;ZoneName&quot;: &quot;ap-southeast-1b&quot; } ] } "><y>#</y><d>2016-05-31</d><h>08:59</h><w>onetom</w>does anyone knows why <code>amazonica &quot;0.3.58&quot;</code> doesnt pick up the region settings from <code>.aws/config</code>?
<pre>(describe-availability-zones)
=&gt;
{:availability-zones [{:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1a&quot;}
                      {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1b&quot;}
                      {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1c&quot;}
                      {:state &quot;available&quot;, :region-name &quot;us-east-1&quot;, :messages [], :zone-name &quot;us-east-1e&quot;}]}
</pre>
but it works with explicit endpoint spec:
<pre>(describe-availability-zones  {:endpoint &quot;ap-southeast-1&quot;})
=&gt;
{:availability-zones [{:state &quot;available&quot;, :region-name &quot;ap-southeast-1&quot;, :zone-name &quot;ap-southeast-1a&quot;, :messages []}
                      {:state &quot;available&quot;, :region-name &quot;ap-southeast-1&quot;, :zone-name &quot;ap-southeast-1b&quot;, :messages []}]}
</pre>
my config file looks like:
<pre>&gt; cat ~/.aws/config
[default]
region=ap-southeast-1
</pre>
and <code>awscli</code> understands it:
<pre>aws ec2 describe-availability-zones
{
    &quot;AvailabilityZones&quot;: [
        {
            &quot;State&quot;: &quot;available&quot;,
            &quot;RegionName&quot;: &quot;ap-southeast-1&quot;,
            &quot;Messages&quot;: [],
            &quot;ZoneName&quot;: &quot;ap-southeast-1a&quot;
        },
        {
            &quot;State&quot;: &quot;available&quot;,
            &quot;RegionName&quot;: &quot;ap-southeast-1&quot;,
            &quot;Messages&quot;: [],
            &quot;ZoneName&quot;: &quot;ap-southeast-1b&quot;
        }
    ]
}
</pre></z><z id="t1465356116" t="podviaznikov Did anyone try to programmatically create record set pointing to the alias (s3) using amazonica? I have following function: (defn configure-dns [zone-id domain] (let [resource-record-set {:name (str domain &quot;.&quot;) :type &quot;A&quot; ;:ttl 60 :alias-target { ;http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region :hosted-zone-id &quot;Z3AQBSTGFYJSTF&quot; :evaluate-target-health false :DNSName &quot;&quot; } :resource-records [{:value &quot;val&quot;}]} changes [{:action &quot;CREATE&quot; :resource-record-set resource-record-set}] batch {:changes changes} request {:hosted-zone-id zone-id :change-batch batch}] (route53/change-resource-record-sets request))) Calling this function gives not super helpful to me error: errorCode: &quot;InvalidInput&quot; errorMessage: &quot;Invalid request&quot; errorType: #object[com.amazonaws.AmazonServiceException$ErrorType 0x4d30c096 &quot;Client&quot;] requestId: &quot;cae553f0-2d27-11e6-b7d4-a968b96dda55&quot; retryable: true serviceName: &quot;AmazonRoute53&quot; statusCode: 400 All other calls: create hosted zone, create bucket - work for me so far"><y>#</y><d>2016-06-08</d><h>03:21</h><w>podviaznikov</w>Did anyone try to programmatically create record set pointing to the alias (s3) using amazonica?
I have following function:
<pre>(defn configure-dns [zone-id domain]
  (let [resource-record-set
        {:name (str domain &quot;.&quot;)
         :type &quot;A&quot;
         ;:ttl 60
         :alias-target
         {
          ;http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region
          :hosted-zone-id &quot;Z3AQBSTGFYJSTF&quot;
          :evaluate-target-health false
          :DNSName &quot;&quot;
          }
         :resource-records [{:value &quot;val&quot;}]}
        changes [{:action &quot;CREATE&quot;
                  :resource-record-set resource-record-set}]
        batch {:changes changes}
        request {:hosted-zone-id zone-id
                 :change-batch batch}]
    (route53/change-resource-record-sets request)))
</pre>
Calling this function gives not super helpful to me error:
<pre>errorCode: &quot;InvalidInput&quot;
    errorMessage: &quot;Invalid request&quot;
       errorType: #object[com.amazonaws.AmazonServiceException$ErrorType 0x4d30c096 &quot;Client&quot;]
       requestId: &quot;cae553f0-2d27-11e6-b7d4-a968b96dda55&quot;
       retryable: true
     serviceName: &quot;AmazonRoute53&quot;
      statusCode: 400
</pre>
All other calls: create hosted zone, create bucket - work for me so far</z><z id="t1465362120" t="podviaznikov found a problem. I shouldn’t specify :resource-records [{:value &quot;val&quot;}]}"><y>#</y><d>2016-06-08</d><h>05:02</h><w>podviaznikov</w>found a problem. I shouldn’t specify <code>:resource-records [{:value &quot;val&quot;}]}</code></z><z id="t1470941115" t="alandipert PSA: https://docs.aws.amazon.com/cli/latest/userguide/cli-command-completion.html"><y>#</y><d>2016-08-11</d><h>18:45</h><w>alandipert</w>PSA: <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-command-completion.html" target="_blank">https://docs.aws.amazon.com/cli/latest/userguide/cli-command-completion.html</a></z><z id="t1470941162" t="alandipert flexibility of CLI + discoverability. use with https://github.com/micha/json-table and 🍾"><y>#</y><d>2016-08-11</d><h>18:46</h><w>alandipert</w>flexibility of CLI + discoverability. use with <a href="https://github.com/micha/json-table" target="_blank">https://github.com/micha/json-table</a> and <b>🍾</b></z><z id="t1471104239" t="micha what do you guys user for collecting metrics? cloudwatch, datadog?"><y>#</y><d>2016-08-13</d><h>16:03</h><w>micha</w>what do you guys user for collecting metrics? cloudwatch, datadog?</z><z id="t1471104388" t="micha i&apos;m looking for something that can operate at scale and supports some advanced features like arbitrary quantiles, extensible aggregation functions, extensible &quot;combinator&quot; type things to combine metrics to form new metrics etc"><y>#</y><d>2016-08-13</d><h>16:06</h><w>micha</w>i&apos;m looking for something that can operate at scale and supports some advanced features like arbitrary quantiles, extensible aggregation functions, extensible &quot;combinator&quot; type things to combine metrics to form new metrics etc</z><z id="t1471104393" t="micha doesn&apos;t have to be hosted"><y>#</y><d>2016-08-13</d><h>16:06</h><w>micha</w>doesn&apos;t have to be hosted</z><z id="t1471104662" t="micha i&apos;m using datadog now, and one thing that&apos;s missing is boolean operators, like if metric.a == 0 then metric.b else metric.b / metric.a"><y>#</y><d>2016-08-13</d><h>16:11</h><w>micha</w>i&apos;m using datadog now, and one thing that&apos;s missing is boolean operators, like <code>if metric.a == 0 then metric.b else metric.b / metric.a</code></z><z id="t1471108624" t="lmergen I think logstash is a good solution"><y>#</y><d>2016-08-13</d><h>17:17</h><w>lmergen</w>I think logstash is a good solution</z><z id="t1472582913" t="luposlip Hi guys. I’m currently having 2 docker containers in AWS ECS serve the Clojure based backend for a service I’m developing. They have a HTTPS/WSS load balancer in front (`AWS ELB`). The backend is completely stateless, except of course for the database. This all works perfectly, until I need to push data to the connected users, via Sente ( https://github.com/ptaoussanis/sente ) based websockets based on recent changes. The changes come from a single user, and arrives via the connected websocket. The changes need to be communicated to the other connected users. Problem is that the other users sockets are connected to only one of the containers, which may not necessarily be the same container as the initiating user is connected to. In other words - the atom containing the connected users are split between the 2 containers. Do any of you guys have a simple way of centralizing this notion of connected users? I’m thinking about using Datomic to store the connected users (thus distributing the connected users via the Datomic Peers), but are there better/simpler ways of ensuring a single repository of websocket-connected users across containers?"><y>#</y><d>2016-08-30</d><h>18:48</h><w>luposlip</w>Hi guys.

I’m currently having 2 docker containers in <code>AWS ECS</code> serve the Clojure based backend for a service I’m developing. They have a HTTPS/WSS load balancer in front (`AWS ELB`). The backend is completely stateless, except of course for the database. This all works perfectly, until I need to push data to the connected users, via <code>Sente</code> (<a href="https://github.com/ptaoussanis/sente" target="_blank">https://github.com/ptaoussanis/sente</a>) based websockets based on recent changes. The changes come from a single user, and arrives via the connected websocket. The changes need to be communicated to the other connected users. Problem is that the other users sockets are connected to only one of the containers, which may not necessarily be the same container as the initiating user is connected to. In other words - the atom containing the connected users are split between the 2 containers.

Do any of you guys have a simple way of centralizing this notion of connected users? I’m thinking about using <code>Datomic</code> to store the connected users (thus distributing the connected users via the Datomic Peers), but are there better/simpler ways of ensuring a single repository of websocket-connected users across containers?</z><z id="t1472584979" t="alandipert [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] memcache or redis are good ways to store sessions"><y>#</y><d>2016-08-30</d><h>19:22</h><w>alandipert</w><a>@luposlip</a> memcache or redis are good ways to store sessions</z><z id="t1472585009" t="alandipert the simplest fix is to use polling, not websockets 😄"><y>#</y><d>2016-08-30</d><h>19:23</h><w>alandipert</w>the simplest fix is to use polling, not websockets <b>😄</b></z><z id="t1472585044" t="alandipert websockets can make session tracking pretty hairy, so i prefer polling unless there&apos;s a compelling reason not to"><y>#</y><d>2016-08-30</d><h>19:24</h><w>alandipert</w>websockets can make session tracking pretty hairy, so i prefer polling unless there&apos;s a compelling reason not to</z><z id="t1472585063" t="alandipert and with datomic especially, polling is an awesome way to do it"><y>#</y><d>2016-08-30</d><h>19:24</h><w>alandipert</w>and with datomic especially, polling is an awesome way to do it</z><z id="t1472585076" t="alandipert since the data you&apos;re polling via datomic query is automatically edge-cached, usually"><y>#</y><d>2016-08-30</d><h>19:24</h><w>alandipert</w>since the data you&apos;re polling via datomic query is automatically edge-cached, usually</z><z id="t1472585323" t="luposlip Thanks [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] . I’m not exactly sure I get what you mean about polling. Is it long polling vs. websockets you refer to? The auth part is working really fine, and everything works really nice with both push and pull, as long as the push/pull is only needed between the user(s) connected to the same container."><y>#</y><d>2016-08-30</d><h>19:28</h><w>luposlip</w>Thanks <a>@alandipert</a>. I’m not exactly sure I get what you mean about polling. Is it long polling vs. websockets you refer to? The auth part is working really fine, and everything works really nice with both push and pull, as long as the push/pull is only needed between the user(s) connected to the same container.</z><z id="t1472585342" t="alandipert right, long polling from browser to web server"><y>#</y><d>2016-08-30</d><h>19:29</h><w>alandipert</w>right, long polling from browser to web server</z><z id="t1472585365" t="luposlip ahh, but that will give me the same issue, because the user is still only connected to a single container, right?"><y>#</y><d>2016-08-30</d><h>19:29</h><w>luposlip</w>ahh, but that will give me the same issue, because the user is still only connected to a single container, right?</z><z id="t1472585391" t="luposlip &quot;Polling via Datomic Query&quot; - from the client?"><y>#</y><d>2016-08-30</d><h>19:29</h><w>luposlip</w>&quot;Polling via Datomic Query&quot; - from the client?</z><z id="t1472585446" t="alandipert long polling with a timeout of some kind, or just straight-up short polling even"><y>#</y><d>2016-08-30</d><h>19:30</h><w>alandipert</w>long polling with a timeout of some kind, or just straight-up short polling even</z><z id="t1472585481" t="alandipert but yeah, my experience with push has been: try to use websockets, sessions are hard, and i end up sending heartbeat messages anyway to show &quot;problems connecting&quot; flash msg in client"><y>#</y><d>2016-08-30</d><h>19:31</h><w>alandipert</w>but yeah, my experience with push has been: try to use websockets, sessions are hard, and i end up sending heartbeat messages anyway to show &quot;problems connecting&quot; flash msg in client</z><z id="t1472585497" t="alandipert then i figure if i&apos;m sending heartbeats, may as well just poll and simplify everything"><y>#</y><d>2016-08-30</d><h>19:31</h><w>alandipert</w>then i figure if i&apos;m sending heartbeats, may as well just poll and simplify everything</z><z id="t1472585521" t="alandipert when my poll hits the server, with datomic, to check if something is different is efficient, since the poll usually boils into a query that&apos;s been cached at that server"><y>#</y><d>2016-08-30</d><h>19:32</h><w>alandipert</w>when my poll hits the server, with datomic, to check if something is different is efficient, since the poll usually boils into a query that&apos;s been cached at that server</z><z id="t1472585572" t="alandipert it seems like that for most people websockets are an indirect way to escape the problems of the database they&apos;re using, since their database probably doesn&apos;t stream changes to connected peers soundly"><y>#</y><d>2016-08-30</d><h>19:32</h><w>alandipert</w>it seems like that for most people websockets are an indirect way to escape the problems of the database they&apos;re using, since their database probably doesn&apos;t stream changes to connected peers soundly</z><z id="t1472585749" t="luposlip well, perhaps you’re right. At least Datomic solves the synchronization of the connected peers (as in backend containers/servers). But not the one of the connected users 🙂"><y>#</y><d>2016-08-30</d><h>19:35</h><w>luposlip</w>well, perhaps you’re right. At least Datomic solves the synchronization of the connected peers (as in backend containers/servers). But not the one of the connected users <b>🙂</b></z><z id="t1472585786" t="alandipert whether a user is connected or not isn&apos;t something you can keep in datomic?"><y>#</y><d>2016-08-30</d><h>19:36</h><w>alandipert</w>whether a user is connected or not isn&apos;t something you can keep in datomic?</z><z id="t1472585831" t="luposlip I also use “heartbeat” pings every 15 seconds. But they aren’t that necessary, because the Sente socket library actually emit events to signal socket disconnection etc. If you haven’t tried Sente, I’ll recommend you to look at it 😉"><y>#</y><d>2016-08-30</d><h>19:37</h><w>luposlip</w>I also use “heartbeat” pings every 15 seconds. But they aren’t that necessary, because the Sente socket library actually emit events to signal socket disconnection etc. If you haven’t tried Sente, I’ll recommend you to look at it <b>😉</b></z><z id="t1472585853" t="alandipert i&apos;ll check it out sometime, it&apos;s been years since i made something like this"><y>#</y><d>2016-08-30</d><h>19:37</h><w>alandipert</w>i&apos;ll check it out sometime, it&apos;s been years since i made something like this</z><z id="t1472585857" t="alandipert the last thing was a video conference site"><y>#</y><d>2016-08-30</d><h>19:37</h><w>alandipert</w>the last thing was a video conference site</z><z id="t1472585877" t="luposlip Yes, I can keep that in Datomic. And I think that’s the way to go. Then I don’t have to introduce an extra component to the mix."><y>#</y><d>2016-08-30</d><h>19:37</h><w>luposlip</w>Yes, I can keep that in Datomic. And I think that’s the way to go. Then I don’t have to introduce an extra component to the mix.</z><z id="t1472585914" t="luposlip Let me know if you need input when you look at it, will happily return your favor! 🙂"><y>#</y><d>2016-08-30</d><h>19:38</h><w>luposlip</w>Let me know if you need input when you look at it, will happily return your favor! <b>🙂</b></z><z id="t1472585921" t="luposlip Thanks for your input."><y>#</y><d>2016-08-30</d><h>19:38</h><w>luposlip</w>Thanks for your input.</z><z id="t1472585978" t="kenny [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] If you need real time and don&apos;t want to manage the web socket infrastructure you could check out something like https://pusher.com/ or https://www.pubnub.com/"><y>#</y><d>2016-08-30</d><h>19:39</h><w>kenny</w><a>@luposlip</a> If you need real time and don&apos;t want to manage the web socket infrastructure you could check out something like <a href="https://pusher.com/" target="_blank">https://pusher.com/</a> or <a href="https://www.pubnub.com/" target="_blank">https://www.pubnub.com/</a></z><z id="t1472586111" t="luposlip Also nice input [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] , will take a look at them. In the current project I don’t think I’ll use them though, because I’ve built everything (and it works), except the shared-across-containers repository of connected users."><y>#</y><d>2016-08-30</d><h>19:41</h><w>luposlip</w>Also nice input <a>@kenny</a>, will take a look at them. In the current project I don’t think I’ll use them though, because I’ve built everything (and it works), except the shared-across-containers repository of connected users.</z><z id="t1472586186" t="alandipert yeah, for the project i cut my teeth on we looked at and were impressed by pusher, but couldn&apos;t use it because of HIPAA"><y>#</y><d>2016-08-30</d><h>19:43</h><w>alandipert</w>yeah, for the project i cut my teeth on we looked at and were impressed by pusher, but couldn&apos;t use it because of HIPAA</z><z id="t1472586257" t="luposlip ahh, good input. Can you use AWS in compliance with HIPAA?"><y>#</y><d>2016-08-30</d><h>19:44</h><w>luposlip</w>ahh, good input. Can you use AWS in compliance with HIPAA?</z><z id="t1472586281" t="alandipert parts of it, under various circumstances - depends what you need to store"><y>#</y><d>2016-08-30</d><h>19:44</h><w>alandipert</w>parts of it, under various circumstances - depends what you need to store</z><z id="t1472586288" t="alandipert we weren&apos;t on AWS either tho"><y>#</y><d>2016-08-30</d><h>19:44</h><w>alandipert</w>we weren&apos;t on AWS either tho</z><z id="t1472586339" t="alandipert it was a video chat app for doctors/patients, i&apos;m pretty sure unless you&apos;re a healthcare app of some kind hipaa isn&apos;t a concern"><y>#</y><d>2016-08-30</d><h>19:45</h><w>alandipert</w>it was a video chat app for doctors/patients, i&apos;m pretty sure unless you&apos;re a healthcare app of some kind hipaa isn&apos;t a concern</z><z id="t1472586359" t="alandipert and if it is, you need a lawyer to really know"><y>#</y><d>2016-08-30</d><h>19:45</h><w>alandipert</w>and if it is, you need a lawyer to really know</z><z id="t1472586382" t="luposlip right"><y>#</y><d>2016-08-30</d><h>19:46</h><w>luposlip</w>right</z><z id="t1472636119" t="luposlip I consider doing the following: 1. Each container maintains a list of users connected to it (this is already there with Sente ) 2. Whenever a user connects, a common list is maintained in Datomic 3. Whenever a user disconnects, the user is removed from the common list 4. Whenever an update from a user needs to be sent to other users, it starts by sending out the messages directly to the users connected to the same container. Then the container reads the common list of connected users from Datomic. If some connected users are connected to other containers, the messages for those users are stored in a common messages list (queue) in Datomic. 5. Workers on all containers regularly (say, every 15 seconds?) check this common message queue. If a message exist for a connected user, the message is sent to the user, and removed from the queue. 6. When a user disconnects/logs off, the list of waiting messages for that user is (permanently) removed from the message queue."><y>#</y><d>2016-08-31</d><h>09:35</h><w>luposlip</w>I consider doing the following:

1. Each container maintains a list of users connected to it (this is already there with <code>Sente</code>)
2. Whenever a user connects, a common list is maintained in Datomic
3. Whenever a user disconnects, the user is removed from the common list
4. Whenever an update from a user needs to be sent to other users, it starts by sending out the messages directly to the users connected to the same container. Then the container reads the common list of connected users from Datomic. If some connected users are connected to other containers, the messages for those users are stored in a common messages list (queue) in Datomic.
5. Workers on all containers regularly (say, every 15 seconds?) check this common message queue. If a message exist for a connected user, the message is sent to the user, and removed from the queue.
6. When a user disconnects/logs off, the list of waiting messages for that user is (permanently) removed from the message queue.</z><z id="t1472650226" t="alandipert [:attrs {:href &quot;/_/_/users/U06QS81LM&quot;}] what is the purpose of #4? also instead of polling datomic, you may consume the transaction report queue and look for the messages"><y>#</y><d>2016-08-31</d><h>13:30</h><w>alandipert</w><a>@luposlip</a> what is the purpose of #4? also instead of polling datomic, you may consume the transaction report queue and look for the messages</z><z id="t1472650536" t="luposlip [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : the purpose is for example: &quot;I&apos;ve changed this value that you are subscribing to&quot;. The server (containers) need to notify all subscribers (via push). Both the users connected to the same container that receives the event that changes the value (sent immediately), and the users connected to other containers. "><y>#</y><d>2016-08-31</d><h>13:35</h><w>luposlip</w><a>@alandipert</a>: the purpose is for example: &quot;I&apos;ve changed this value that you are subscribing to&quot;. The server (containers) need to notify all subscribers (via push). Both the users connected to the same container that receives the event that changes the value (sent immediately), and the users connected to other containers. </z><z id="t1472650626" t="alandipert so it&apos;s for reducing latency when users are adjacent?"><y>#</y><d>2016-08-31</d><h>13:37</h><w>alandipert</w>so it&apos;s for reducing latency when users are adjacent?</z><z id="t1472650636" t="luposlip What&apos;s the benefit of looking through the TX report queue? Can this be read directly from storage instead of waiting for the peer library to catch up? "><y>#</y><d>2016-08-31</d><h>13:37</h><w>luposlip</w>What&apos;s the benefit of looking through the TX report queue? Can this be read directly from storage instead of waiting for the peer library to catch up? </z><z id="t1472650657" t="luposlip Exactly! "><y>#</y><d>2016-08-31</d><h>13:37</h><w>luposlip</w>Exactly! </z><z id="t1472650659" t="alandipert well if you route everything through datomic instead of short circuting, than datomic is the data of record"><y>#</y><d>2016-08-31</d><h>13:37</h><w>alandipert</w>well if you route everything through datomic instead of short circuting, than datomic is the data of record</z><z id="t1472650669" t="alandipert and datomic already has a way to listen for changes, the tx queue"><y>#</y><d>2016-08-31</d><h>13:37</h><w>alandipert</w>and datomic already has a way to listen for changes, the tx queue</z><z id="t1472650692" t="alandipert latency is potentially higher but it&apos;s simpler imo"><y>#</y><d>2016-08-31</d><h>13:38</h><w>alandipert</w>latency is potentially higher but it&apos;s simpler imo</z><z id="t1472650707" t="alandipert also if you add logic to happen to the message, it goes in one place"><y>#</y><d>2016-08-31</d><h>13:38</h><w>alandipert</w>also if you add logic to happen to the message, it goes in one place</z><z id="t1472650731" t="luposlip So he TX queue is still relying on the peer library? "><y>#</y><d>2016-08-31</d><h>13:38</h><w>luposlip</w>So he TX queue is still relying on the peer library? </z><z id="t1472650738" t="alandipert it&apos;s a feature of the peer library, yeah"><y>#</y><d>2016-08-31</d><h>13:38</h><w>alandipert</w>it&apos;s a feature of the peer library, yeah</z><z id="t1472650750" t="luposlip Gotta look into that. "><y>#</y><d>2016-08-31</d><h>13:39</h><w>luposlip</w>Gotta look into that. </z><z id="t1472650751" t="alandipert in practice one consumes it in a thread, filtering out messages not interested in"><y>#</y><d>2016-08-31</d><h>13:39</h><w>alandipert</w>in practice one consumes it in a thread, filtering out messages not interested in</z><z id="t1472650792" t="alandipert in a system i work on today we&apos;ve built a really crappy datomic over a 10 yr period"><y>#</y><d>2016-08-31</d><h>13:39</h><w>alandipert</w>in a system i work on today we&apos;ve built a really crappy datomic over a 10 yr period</z><z id="t1472650797" t="alandipert various databases and queues spread around, piles of hacks"><y>#</y><d>2016-08-31</d><h>13:39</h><w>alandipert</w>various databases and queues spread around, piles of hacks</z><z id="t1472650811" t="alandipert if you buy totally into datomic features from the beginning though i think you can make some pretty clean stuff"><y>#</y><d>2016-08-31</d><h>13:40</h><w>alandipert</w>if you buy totally into datomic features from the beginning though i think you can make some pretty clean stuff</z><z id="t1472650840" t="alandipert i should mention i am not a paid spokesperson lol"><y>#</y><d>2016-08-31</d><h>13:40</h><w>alandipert</w>i should mention i am not a paid spokesperson lol</z><z id="t1472650847" t="alandipert just a big fan ™️"><y>#</y><d>2016-08-31</d><h>13:40</h><w>alandipert</w>just a big fan <b>™️</b></z><z id="t1472650911" t="luposlip Agreed. Do you use some scheduling library, or just plain Java threads? I&apos;ve been using at-at and and some other earlier (just forgot which) based on Quartz. "><y>#</y><d>2016-08-31</d><h>13:41</h><w>luposlip</w>Agreed. Do you use some scheduling library, or just plain Java threads? I&apos;ve been using at-at and and some other earlier (just forgot which) based on Quartz. </z><z id="t1472651646" t="alandipert you mean for the thread to consume the tx queue?"><y>#</y><d>2016-08-31</d><h>13:54</h><w>alandipert</w>you mean for the thread to consume the tx queue?</z><z id="t1472651676" t="alandipert i have used plain threads, since it&apos;s a blocking queue, the thread just blocks on the get call"><y>#</y><d>2016-08-31</d><h>13:54</h><w>alandipert</w>i have used plain threads, since it&apos;s a blocking queue, the thread just blocks on the get call</z><z id="t1472664007" t="luposlip Yes, that&apos;s what I meant. "><y>#</y><d>2016-08-31</d><h>17:20</h><w>luposlip</w>Yes, that&apos;s what I meant. </z><z id="t1472711889" t="luposlip Another option could be to use the streaming transaction report queue, and send that to all connected clients. There it could be stored in DataScript. But then it needs to be heavily filtered in a very sophisticated way, since not all client updates relate directly to the user, but loosely based on meta data such as vicinity (meters between users, relative speed etc.). I’m not sure there is an easy way to accomplish this."><y>#</y><d>2016-09-01</d><h>06:38</h><w>luposlip</w>Another option could be to use the streaming transaction report queue, and send that to all connected clients. There it could be stored in DataScript.
But then it needs to be heavily filtered in a very sophisticated way, since not all client updates relate directly to the user, but loosely based on meta data such as vicinity (meters between users, relative speed etc.). I’m not sure there is an easy way to accomplish this.</z><z id="t1475075861" t="alandipert here is something to consider if you&apos;ve noticed weird stuff about DNS in your jvm apps on amazon, https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-jvm-ttl.html"><y>#</y><d>2016-09-28</d><h>15:17</h><w>alandipert</w>here is something to consider if you&apos;ve noticed weird stuff about DNS in your jvm apps on amazon, <a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-jvm-ttl.html" target="_blank">https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-jvm-ttl.html</a></z><z id="t1475091175" t="gregnwosu ive noticed that s3 was giving me old object lists for a bucket"><y>#</y><d>2016-09-28</d><h>19:32</h><w>gregnwosu</w>ive noticed that s3 was giving me old object lists for a bucket</z><z id="t1475094171" t="alandipert i&apos;ve noticed inconsistencies in s3 also"><y>#</y><d>2016-09-28</d><h>20:22</h><w>alandipert</w>i&apos;ve noticed inconsistencies in s3 also</z><z id="t1475094192" t="alandipert for a few seconds after putting an object it toggles between visible and not"><y>#</y><d>2016-09-28</d><h>20:23</h><w>alandipert</w>for a few seconds after putting an object it toggles between visible and not</z><z id="t1475094223" t="alandipert i think it&apos;s &quot;eventually consistent&quot; but i&apos;m not sure exactly how long eventual is"><y>#</y><d>2016-09-28</d><h>20:23</h><w>alandipert</w>i think it&apos;s &quot;eventually consistent&quot; but i&apos;m not sure exactly how long eventual is</z><z id="t1475500869" t="shooodooken from https://aws.amazon.com/s3/faqs/ Q: What data consistency model does Amazon S3 employ? Amazon S3 buckets in all Regions provide read-after-write consistency for PUTS of new objects and eventual consistency for overwrite PUTS and DELETES. "><y>#</y><d>2016-10-03</d><h>13:21</h><w>shooodooken</w>from <a href="https://aws.amazon.com/s3/faqs/" target="_blank">https://aws.amazon.com/s3/faqs/</a>

<pre>Q: What data consistency model does Amazon S3 employ?

Amazon S3 buckets in all Regions provide read-after-write consistency for PUTS of new objects and eventual consistency for overwrite PUTS and DELETES. </pre></z><z id="t1477063322" t="timgilbert Hi all, does anyone use a hosted log-aggregation service that they like a lot? There seem to be approximately 7000 different SaaS options available and I&apos;m having a hard time sorting through them"><y>#</y><d>2016-10-21</d><h>15:22</h><w>timgilbert</w>Hi all, does anyone use a hosted log-aggregation service that they like a lot? There seem to be approximately 7000 different SaaS options available and I&apos;m having a hard time sorting through them</z><z id="t1477063358" t="timgilbert I&apos;m looking at something for application logs, ideally with an easy logback interface"><y>#</y><d>2016-10-21</d><h>15:22</h><w>timgilbert</w>I&apos;m looking at something for application logs, ideally with an easy logback interface</z><z id="t1477065167" t="alandipert we use papertrail and it&apos;s been OK, but we&apos;ve outgrown it and plan on moving to our own elasticsearch"><y>#</y><d>2016-10-21</d><h>15:52</h><w>alandipert</w>we use papertrail and it&apos;s been OK, but we&apos;ve outgrown it and plan on moving to our own elasticsearch</z><z id="t1477340384" t="candiedcode we are using ELK in AWS"><y>#</y><d>2016-10-24</d><h>20:19</h><w>candiedcode</w>we are using ELK in AWS</z><z id="t1477385051" t="ricardo [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] : ran into this recently, in case it&apos;s helpful. https://www.influxdata.com/influxdb-markedly-elasticsearch-in-time-series-data-metrics-benchmark/"><y>#</y><d>2016-10-25</d><h>08:44</h><w>ricardo</w><a>@alandipert</a>: ran into this recently, in case it&apos;s helpful. <a href="https://www.influxdata.com/influxdb-markedly-elasticsearch-in-time-series-data-metrics-benchmark/" target="_blank">https://www.influxdata.com/influxdb-markedly-elasticsearch-in-time-series-data-metrics-benchmark/</a></z><z id="t1477510054" t="timgilbert We wound up going with http://logz.io , which is basically just a bog-standard ELK stack that we don&apos;t have to manage ourselves"><y>#</y><d>2016-10-26</d><h>19:27</h><w>timgilbert</w>We wound up going with <a href="http://logz.io" target="_blank">http://logz.io</a>, which is basically just a bog-standard ELK stack that we don&apos;t have to manage ourselves</z><z id="t1478539829" t="bja Is there a well-behaved sqs worker component that can be started/stopped cleanly? I&apos;d essentially like to pass a function and then have it stop processing when I stop my system."><y>#</y><d>2016-11-07</d><h>17:30</h><w>bja</w>Is there a well-behaved sqs worker component that can be started/stopped cleanly? I&apos;d essentially like to pass a function and then have it stop processing when I stop my system.</z><z id="t1478539883" t="bja after light googling, found this which seems close enough: https://github.com/TheClimateCorporation/squeedo"><y>#</y><d>2016-11-07</d><h>17:31</h><w>bja</w>after light googling, found this which seems close enough: <a href="https://github.com/TheClimateCorporation/squeedo" target="_blank">https://github.com/TheClimateCorporation/squeedo</a></z><z id="t1478541183" t="alandipert i chose that one recently, kinda regretted it. wish i&apos;d just built my own stuff atop AWS sdk"><y>#</y><d>2016-11-07</d><h>17:53</h><w>alandipert</w>i chose that one recently, kinda regretted it. wish i&apos;d just built my own stuff atop AWS sdk</z><z id="t1478541222" t="alandipert it does a lot of stuff magically/automatically, like creating queues and setting their defaults. also brings in core.async and is oriented around throughput"><y>#</y><d>2016-11-07</d><h>17:53</h><w>alandipert</w>it does a lot of stuff magically/automatically, like creating queues and setting their defaults. also brings in core.async and is oriented around throughput</z><z id="t1478541274" t="alandipert might be good if you&apos;re going for high throughput... but our situation is usually small number of messages that absolutely must be tried/retried"><y>#</y><d>2016-11-07</d><h>17:54</h><w>alandipert</w>might be good if you&apos;re going for high throughput... but our situation is usually small number of messages that absolutely must be tried/retried</z><z id="t1478544438" t="bja good feedback, thanks"><y>#</y><d>2016-11-07</d><h>18:47</h><w>bja</w>good feedback, thanks</z><z id="t1478544616" t="bja I already have an abstraction that I was using with storm spouts. Actually core.async based already, a component that puts channels at :messages , :acks , :fails where you take from :messages [receipt-handle msg] and then put the receipt-handle back to :acks, :fails, but I never wrote in a layer to enable stopping (alting on a coordination channel). It might be worth it to just wrap that layer and do the work to enable cleanup of the goroutines/threads."><y>#</y><d>2016-11-07</d><h>18:50</h><w>bja</w>I already have an abstraction that I was using with storm spouts. Actually core.async based already, a component that puts channels at <code>:messages</code>, <code>:acks</code>, <code>:fails</code> where you take from <code>:messages</code> [receipt-handle msg] and then put the receipt-handle back to :acks, :fails, but I never wrote in a layer to enable stopping (alting on a coordination channel). It might be worth it to just wrap that layer and do the work to enable cleanup of the goroutines/threads.</z><z id="t1478545225" t="alandipert yeah - sounds like you already basically have what you want"><y>#</y><d>2016-11-07</d><h>19:00</h><w>alandipert</w>yeah - sounds like you already basically have what you want</z><z id="t1478622604" t="cfleming Does anyone know where the raw AWS API doc is? Most of what I can find are the language bindings."><y>#</y><d>2016-11-08</d><h>16:30</h><w>cfleming</w>Does anyone know where the raw AWS API doc is? Most of what I can find are the language bindings.</z><z id="t1478622646" t="cfleming I’m interesting in writing some services using https://github.com/nervous-systems/eulalie , and it would be helpful to see what the raw requests/responses look like."><y>#</y><d>2016-11-08</d><h>16:30</h><w>cfleming</w>I’m interesting in writing some services using <a href="https://github.com/nervous-systems/eulalie" target="_blank">https://github.com/nervous-systems/eulalie</a>, and it would be helpful to see what the raw requests/responses look like.</z><z id="t1478623038" t="cfleming Actually, never mind, I’m blind."><y>#</y><d>2016-11-08</d><h>16:37</h><w>cfleming</w>Actually, never mind, I’m blind.</z><z id="t1478652538" t="alandipert where did you find it? i&apos;ve had this problem too"><y>#</y><d>2016-11-09</d><h>00:48</h><w>alandipert</w>where did you find it? i&apos;ve had this problem too</z><z id="t1478694364" t="cfleming [:attrs {:href &quot;/_/_/users/U04VC31U8&quot;}] It’s linked from here: https://aws.amazon.com/documentation/"><y>#</y><d>2016-11-09</d><h>12:26</h><w>cfleming</w><a>@alandipert</a> It’s linked from here: <a href="https://aws.amazon.com/documentation/" target="_blank">https://aws.amazon.com/documentation/</a></z><z id="t1478694378" t="cfleming Basically, click on the service, and then “API Reference&quot;"><y>#</y><d>2016-11-09</d><h>12:26</h><w>cfleming</w>Basically, click on the service, and then “API Reference&quot;</z><z id="t1478791300" t="cfleming Developing CLJS lambda functions using cljs-lambda and associated projects is very nice."><y>#</y><d>2016-11-10</d><h>15:21</h><w>cfleming</w>Developing CLJS lambda functions using cljs-lambda and associated projects is very nice.</z><z id="t1478791333" t="cfleming API gateway is the big missing piece, but I can hack that for the meantime."><y>#</y><d>2016-11-10</d><h>15:22</h><w>cfleming</w>API gateway is the big missing piece, but I can hack that for the meantime.</z><z id="t1478792652" t="bja I&apos;ve always thought it would be nice to use one of the data-based routing libraries and retargeting it to API gateway"><y>#</y><d>2016-11-10</d><h>15:44</h><w>bja</w>I&apos;ve always thought it would be nice to use one of the data-based routing libraries and retargeting it to API gateway</z><z id="t1478792697" t="bja so that you had a good story for local development as well as being able to skip shed color choices for the api (IMO the least interesting piece)"><y>#</y><d>2016-11-10</d><h>15:44</h><w>bja</w>so that you had a good story for local development as well as being able to skip shed color choices for the api (IMO the least interesting piece)</z><z id="t1478792834" t="cfleming [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] Which routing libraries do you mean?"><y>#</y><d>2016-11-10</d><h>15:47</h><w>cfleming</w><a>@bja</a> Which routing libraries do you mean?</z><z id="t1478792847" t="cfleming The issue with API gateway is all the template malarkey"><y>#</y><d>2016-11-10</d><h>15:47</h><w>cfleming</w>The issue with API gateway is all the template malarkey</z><z id="t1478792893" t="bja I just mean, to declare what you want your api to look like using the same syntax/data as some routing library, and then let the library build out the templates for you"><y>#</y><d>2016-11-10</d><h>15:48</h><w>bja</w>I just mean, to declare what you want your api to look like using the same syntax/data as some routing library, and then let the library build out the templates for you</z><z id="t1478792903" t="bja I don&apos;t think such a thing exists"><y>#</y><d>2016-11-10</d><h>15:48</h><w>bja</w>I don&apos;t think such a thing exists</z><z id="t1478792913" t="cfleming No, it would certainly be nice."><y>#</y><d>2016-11-10</d><h>15:48</h><w>cfleming</w>No, it would certainly be nice.</z><z id="t1478792952" t="cfleming Any preference for routing library? I’m not familiar with them, and I might add something like that to cljs-lambda depending on how difficult it turns out to be"><y>#</y><d>2016-11-10</d><h>15:49</h><w>cfleming</w>Any preference for routing library? I’m not familiar with them, and I might add something like that to cljs-lambda depending on how difficult it turns out to be</z><z id="t1478792966" t="cfleming Do they support e.g. mapping parameters to JSON etc?"><y>#</y><d>2016-11-10</d><h>15:49</h><w>cfleming</w>Do they support e.g. mapping parameters to JSON etc?</z><z id="t1478792972" t="bja I don&apos;t have a particular preference, but one of the ones that is data-based instead of macro-based is probably a good start"><y>#</y><d>2016-11-10</d><h>15:49</h><w>bja</w>I don&apos;t have a particular preference, but one of the ones that is data-based instead of macro-based is probably a good start</z><z id="t1478792995" t="bja what do you mean mapping parameters to json?"><y>#</y><d>2016-11-10</d><h>15:49</h><w>bja</w>what do you mean mapping parameters to json?</z><z id="t1478793038" t="cfleming So with my existing API, it’s for a webhook that only sends POST params. I need to create a template that maps that to a JSON doc, since lambda receives JSON."><y>#</y><d>2016-11-10</d><h>15:50</h><w>cfleming</w>So with my existing API, it’s for a webhook that only sends POST params. I need to create a template that maps that to a JSON doc, since lambda receives JSON.</z><z id="t1478793063" t="bja one thing I could imagine would be doing something like this (using compojure-api syntax): (GET &quot;/add&quot; request :query-params [num :- s/Int] (ok (inc num)))"><y>#</y><d>2016-11-10</d><h>15:51</h><w>bja</w>one thing I could imagine would be doing something like this (using compojure-api syntax):

<pre>(GET &quot;/add&quot; request
           :query-params [num :- s/Int]
           (ok (inc num)))</pre></z><z id="t1478793115" t="bja theoretically, you could even use compojure-api (or ring-swagger, which is what it uses under the hood) to generate the swagger spec for that route for you"><y>#</y><d>2016-11-10</d><h>15:51</h><w>bja</w>theoretically, you could even use compojure-api (or ring-swagger, which is what it uses under the hood) to generate the swagger spec for that route for you</z><z id="t1478793124" t="bja and use that to build the api gateway definition"><y>#</y><d>2016-11-10</d><h>15:52</h><w>bja</w>and use that to build the api gateway definition</z><z id="t1478793133" t="bja then you can take the body and destructuring it generates, and turn that into a lambda"><y>#</y><d>2016-11-10</d><h>15:52</h><w>bja</w>then you can take the body and destructuring it generates, and turn that into a lambda</z><z id="t1478793179" t="bja with the upside of, if you did it &quot;right&quot;, you might be able to use compojure-api locally for development testing"><y>#</y><d>2016-11-10</d><h>15:52</h><w>bja</w>with the upside of, if you did it &quot;right&quot;, you might be able to use compojure-api locally for development testing</z><z id="t1478793202" t="bja (compojure-api is just a convenient example here since it already generates a swagger json/yaml spec for you)"><y>#</y><d>2016-11-10</d><h>15:53</h><w>bja</w>(compojure-api is just a convenient example here since it already generates a swagger json/yaml spec for you)</z><z id="t1478793273" t="bja there would obviously be a couple limitations (i.e. your whole routes have to defined at compile time)"><y>#</y><d>2016-11-10</d><h>15:54</h><w>bja</w>there would obviously be a couple limitations (i.e. your whole routes have to defined at compile time)</z><z id="t1478793294" t="cfleming compojure-api is macro-based though, right?"><y>#</y><d>2016-11-10</d><h>15:54</h><w>cfleming</w>compojure-api is macro-based though, right?</z><z id="t1478793310" t="bja the latest version uses a macro sugar layer on top of maps"><y>#</y><d>2016-11-10</d><h>15:55</h><w>bja</w>the latest version uses a macro sugar layer on top of maps</z><z id="t1478793312" t="bja IIRC"><y>#</y><d>2016-11-10</d><h>15:55</h><w>bja</w>IIRC</z><z id="t1478793327" t="bja I&apos;m actually still on their old 0.2x.x release at my job 😞"><y>#</y><d>2016-11-10</d><h>15:55</h><w>bja</w>I&apos;m actually still on their old 0.2x.x release at my job <b>😞</b></z><z id="t1478793340" t="bja #ring-swagger might know more"><y>#</y><d>2016-11-10</d><h>15:55</h><w>bja</w>#ring-swagger might know more</z><z id="t1478793405" t="cfleming Doesn’t look like it: “all compojure-api route functions &amp; macros return compojure.api.routes/Route-records”..."><y>#</y><d>2016-11-10</d><h>15:56</h><w>cfleming</w>Doesn’t look like it: “all compojure-api route functions &amp; macros return compojure.api.routes/Route-records”...</z><z id="t1478793412" t="cfleming https://github.com/metosin/compojure-api/wiki/Routing"><y>#</y><d>2016-11-10</d><h>15:56</h><w>cfleming</w><a href="https://github.com/metosin/compojure-api/wiki/Routing" target="_blank">https://github.com/metosin/compojure-api/wiki/Routing</a></z><z id="t1478793427" t="bja well, s/map/Route record/"><y>#</y><d>2016-11-10</d><h>15:57</h><w>bja</w>well, s/map/Route record/</z><z id="t1478793466" t="cfleming Ideally I’d be able to define the templates somewhere static so that the cljs-lambda lein plugin could build things based on the definition."><y>#</y><d>2016-11-10</d><h>15:57</h><w>cfleming</w>Ideally I’d be able to define the templates somewhere static so that the cljs-lambda lein plugin could build things based on the definition.</z></g><g id="s3"><z id="t1478793531" t="bja couldn&apos;t the cljs-lambda lein plugin just invoke whatever compojure.api.routes/get-routes and use the resulting info?"><y>#</y><d>2016-11-10</d><h>15:58</h><w>bja</w>couldn&apos;t the cljs-lambda lein plugin just invoke whatever <code>compojure.api.routes/get-routes</code> and use the resulting info?</z><z id="t1478793542" t="cfleming Maybe, I’m not sure."><y>#</y><d>2016-11-10</d><h>15:59</h><w>cfleming</w>Maybe, I’m not sure.</z><z id="t1478793544" t="bja (along with the route records)"><y>#</y><d>2016-11-10</d><h>15:59</h><w>bja</w>(along with the route records)</z><z id="t1478793593" t="bja I don&apos;t know if their wrap-routes stuff can be replaced or includes the right meta to lookup source code so that you could compile the bodies to lambdas"><y>#</y><d>2016-11-10</d><h>15:59</h><w>bja</w>I don&apos;t know if their wrap-routes stuff can be replaced or includes the right meta to lookup source code so that you could compile the bodies to lambdas</z><z id="t1478793672" t="bja but today is the first day of my vacation, so spinning up a project and a repl!"><y>#</y><d>2016-11-10</d><h>16:01</h><w>bja</w>but today is the first day of my vacation, so spinning up a project and a repl!</z><z id="t1478793697" t="cfleming I think that would be too much magic - I’d rather it referenced the lambda by name."><y>#</y><d>2016-11-10</d><h>16:01</h><w>cfleming</w>I think that would be too much magic - I’d rather it referenced the lambda by name.</z><z id="t1478793703" t="cfleming For my taste, at least."><y>#</y><d>2016-11-10</d><h>16:01</h><w>cfleming</w>For my taste, at least.</z><z id="t1478793715" t="bja one of the other routing libraries like bidi might be a good fit then"><y>#</y><d>2016-11-10</d><h>16:01</h><w>bja</w>one of the other routing libraries like bidi might be a good fit then</z><z id="t1478793735" t="cfleming And it would be a large change to the way things work right now AFAIK, but I’m not that familiar with it yet."><y>#</y><d>2016-11-10</d><h>16:02</h><w>cfleming</w>And it would be a large change to the way things work right now AFAIK, but I’m not that familiar with it yet.</z><z id="t1478793736" t="bja that one is more data based"><y>#</y><d>2016-11-10</d><h>16:02</h><w>bja</w>that one is more data based</z><z id="t1478793846" t="bja i.e. something like this: [&quot;/&quot; {&quot;blog&quot; {:get {&quot;/index&quot; (lambda-fn :my-index)}} {:request-method :post :server-name &quot;&quot;} {&quot;/zip&quot; (lambda-fn :zip)}}] "><y>#</y><d>2016-11-10</d><h>16:04</h><w>bja</w>i.e. something like this:

<pre>[&quot;/&quot; {&quot;blog&quot; {:get
                {&quot;/index&quot; (lambda-fn :my-index)}}
              {:request-method :post :server-name &quot;&quot;}
                {&quot;/zip&quot; (lambda-fn :zip)}}]
</pre></z><z id="t1478793891" t="bja that was just adapted from an example at https://github.com/juxt/bidi"><y>#</y><d>2016-11-10</d><h>16:04</h><w>bja</w>that was just adapted from an example at <a href="https://github.com/juxt/bidi" target="_blank">https://github.com/juxt/bidi</a></z><z id="t1478793923" t="cfleming Right, something like that would be preferable I think."><y>#</y><d>2016-11-10</d><h>16:05</h><w>cfleming</w>Right, something like that would be preferable I think.</z><z id="t1478794143" t="bja it does look like if you can find something with output to swagger 2.0, you can directly import that into API Gateway: https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-import-api.html"><y>#</y><d>2016-11-10</d><h>16:09</h><w>bja</w>it does look like if you can find something with output to swagger 2.0, you can directly import that into API Gateway: <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-import-api.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-import-api.html</a></z><z id="t1478794313" t="bja which seems at least like it&apos;s a bit more well-trodden of a path than trying to speak their rest api"><y>#</y><d>2016-11-10</d><h>16:11</h><w>bja</w>which seems at least like it&apos;s a bit more well-trodden of a path than trying to speak their rest api</z><z id="t1479421757" t="gnunes Hi! I&apos;m starting a new project and I&apos;m considering using Clojure, in docker-based microservices. What I&apos;m worried about is, will the JVM and its high memory allocation be an issue in the beginning, when I&apos;m planning to run on small/micro instances with not much RAM? I&apos;m thinking that I&apos;ll not be able to put too many containers in the same instances, as every container will run a JVM. Any one has experiences with this? Does fine tuning the JVM mitigate the issue? Should I set a low memory limit, monitor and scale when needed?"><y>#</y><d>2016-11-17</d><h>22:29</h><w>gnunes</w>Hi! I&apos;m starting a new project and I&apos;m considering using Clojure, in docker-based microservices.
What I&apos;m worried about is, will the JVM and its high memory allocation be an issue in the beginning, when I&apos;m planning to run on small/micro instances with not much RAM? 
I&apos;m thinking that I&apos;ll not be able to put too many containers in the same instances, as every container will run a JVM.

Any one has experiences with this? Does fine tuning the JVM mitigate the issue? Should I set a low memory limit, monitor and scale when needed?</z><z id="t1479422330" t="tom I have been able to run a heavy clojure application in a docker container alongside a postgres container on a micro instance fine. "><y>#</y><d>2016-11-17</d><h>22:38</h><w>tom</w>I have been able to run a heavy clojure application in a docker container alongside a postgres container on a micro instance fine. </z><z id="t1479422363" t="tom You can try different memory limits locally and load test if you need to of course. Might help color it in for you. "><y>#</y><d>2016-11-17</d><h>22:39</h><w>tom</w>You can try different memory limits locally and load test if you need to of course. Might help color it in for you. </z><z id="t1479467632" t="luposlip I’ve been running services based on Clojure in docker environments with less than 512MB RAM. No issue. I run docker instances with 1024 and 2048 MB RAM where I use Datomic for storage (with its caching Peer library - not being a problem at all)."><y>#</y><d>2016-11-18</d><h>11:13</h><w>luposlip</w>I’ve been running services based on Clojure in docker environments with less than 512MB RAM. No issue. I run docker instances with 1024 and 2048 MB RAM where I use Datomic for storage (with its caching Peer library - not being a problem at all).</z><z id="t1479930558" t="bja are there any other Factual/s3-journal users here?"><y>#</y><d>2016-11-23</d><h>19:49</h><w>bja</w>are there any other Factual/s3-journal users here?</z><z id="t1480487270" t="lumengxi [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] i have used it briefly in production"><y>#</y><d>2016-11-30</d><h>06:27</h><w>lumengxi</w><a>@bja</a> i have used it briefly in production</z><z id="t1481243816" t="ballpointcarrot for anyone keeping score, the Canada region launched today: https://aws.amazon.com/blogs/aws/now-open-aws-canada-central-region/"><y>#</y><d>2016-12-09</d><h>00:36</h><w>ballpointcarrot</w>for anyone keeping score, the Canada region launched today: <a href="https://aws.amazon.com/blogs/aws/now-open-aws-canada-central-region/" target="_blank">https://aws.amazon.com/blogs/aws/now-open-aws-canada-central-region/</a></z><z id="t1483737235" t="mattsfrey Has anyone used https://github.com/nervous-systems/eulalie at all? Wondering if anyone has insights in how to add another service to this"><y>#</y><d>2017-01-06</d><h>21:13</h><w>mattsfrey</w>Has anyone used <a href="https://github.com/nervous-systems/eulalie" target="_blank">https://github.com/nervous-systems/eulalie</a> at all? Wondering if anyone has insights in how to add another service to this</z><z id="t1483737251" t="mattsfrey i.e. s3"><y>#</y><d>2017-01-06</d><h>21:14</h><w>mattsfrey</w>i.e. s3</z><z id="t1483821798" t="chris_johnson I have looked at eulalie and am currently puttering around with cljs-lambda - I think the easiest thing to do would be to fork it, cp src/eulalie/dynamo.cljc src/eulalie/s3.cljc and re-customize the file"><y>#</y><d>2017-01-07</d><h>20:43</h><w>chris_johnson</w>I have looked at eulalie and am currently puttering around with cljs-lambda - I think the easiest thing to do would be to fork it, <code>cp src/eulalie/dynamo.cljc src/eulalie/s3.cljc</code> and re-customize the file</z><z id="t1483821878" t="chris_johnson which would primarily consist, I think, of s/dynamo/s3/g , looking up the right service prefix, and then in your client code building the right kind of request objects (`GetObject`, PutObject , etc.) - multipart uploads will certainly be the heaviest lifting from a complexity perspective"><y>#</y><d>2017-01-07</d><h>20:44</h><w>chris_johnson</w>which would primarily consist, I think, of <code>s/dynamo/s3/g</code>, looking up the right service prefix, and then in your client code building the right kind of request objects (`GetObject`, <code>PutObject</code>, etc.) - multipart uploads will certainly be the heaviest lifting from a complexity perspective</z><z id="t1483889822" t="mattsfrey Thanks chris, I actually ended up going exactly down that route haha"><y>#</y><d>2017-01-08</d><h>15:37</h><w>mattsfrey</w>Thanks chris, I actually ended up going exactly down that route haha</z><z id="t1483889896" t="mattsfrey seemed like the simplest one to modify - although its implementing the json request and I think most of the s3 requests use query params so i&apos;m trying to write it to function that way, content-type urlencoded etc"><y>#</y><d>2017-01-08</d><h>15:38</h><w>mattsfrey</w>seemed like the simplest one to modify - although its implementing the json request and I think most of the s3 requests use query params so i&apos;m trying to write it to function that way, content-type urlencoded etc</z><z id="t1483898286" t="chris_johnson so it turns out that the next step in the thing I’m working on involves interacting with S3 inside a cljs Lambda function 😄"><y>#</y><d>2017-01-08</d><h>17:58</h><w>chris_johnson</w>so it turns out that the next step in the thing I’m working on involves interacting with S3 inside a cljs Lambda function <b>😄</b></z><z id="t1483898338" t="chris_johnson the ‘get it done and move on’ way is just to pull in the Node AWS SDK and call it in an interop fashion, but if you’re interested, feel free to share your eulalie fork and I will contribute to it as I work with it hehe"><y>#</y><d>2017-01-08</d><h>17:58</h><w>chris_johnson</w>the ‘get it done and move on’ way is just to pull in the Node AWS SDK and call it in an interop fashion, but if you’re interested, feel free to share your <code>eulalie</code> fork and I will contribute to it as I work with it hehe</z><z id="t1484217815" t="dottedmag Does anyone know what happened to Pallet? Looks like it just died two years ago. Or has it achieved the &quot;finished&quot; status and does not need any further changes?"><y>#</y><d>2017-01-12</d><h>10:43</h><w>dottedmag</w>Does anyone know what happened to Pallet? Looks like it just died two years ago. Or has it achieved the &quot;finished&quot; status and does not need any further changes?</z><z id="t1484217833" t="dottedmag Also, what does one use instead? Back to shell scripts and CFEngine mess?"><y>#</y><d>2017-01-12</d><h>10:43</h><w>dottedmag</w>Also, what does one use instead? Back to shell scripts and CFEngine mess?</z><z id="t1484223539" t="mccraigmccraig [:attrs {:href &quot;/_/_/users/U07HVGQJ3&quot;}] i&apos;ve been using pallet - it seems pretty dead now though, and with systemd in ubuntu 16 lts i think it will stop working, so i&apos;m planning on migrating to terraform soon"><y>#</y><d>2017-01-12</d><h>12:18</h><w>mccraigmccraig</w><a>@dottedmag</a> i&apos;ve been using pallet - it seems pretty dead now though, and with systemd in ubuntu 16 lts i think it will stop working, so i&apos;m planning on migrating to terraform soon</z><z id="t1484223739" t="dottedmag [:attrs {:href &quot;/_/_/users/U0524B4UW&quot;}] Have you tried terraboot?"><y>#</y><d>2017-01-12</d><h>12:22</h><w>dottedmag</w><a>@mccraigmccraig</a> Have you tried terraboot?</z><z id="t1484223805" t="mccraigmccraig [:attrs {:href &quot;/_/_/users/U07HVGQJ3&quot;}] that was my planned interface to terraform, but i haven&apos;t found the time to investigate yet... [:attrs {:href &quot;/_/_/users/U0525KG62&quot;}] and the other mastodonc people are very helpful if you try it and have problems though"><y>#</y><d>2017-01-12</d><h>12:23</h><w>mccraigmccraig</w><a>@dottedmag</a> that was my planned interface to terraform, but i haven&apos;t found the time to investigate yet... <a>@otfrom</a> and the other mastodonc people are very helpful if you try it and have problems though</z><z id="t1484223814" t="dottedmag thanks"><y>#</y><d>2017-01-12</d><h>12:23</h><w>dottedmag</w>thanks</z><z id="t1484248008" t="curtosis I seem to be doing something really silly … I’m playing with faraday, the super basic intro stuff, and it keeps throwing exceptions. It’s really just: =&gt; (require &apos;[taoensso.faraday :as far]) =&gt; (def client-opts {:access-key &quot;...&quot; :secret-key &quot;...&quot; :endpoint &quot;&quot;}) =&gt; (far/list-tables client-opts) java.lang.NoSuchMethodError: com.fasterxml.jackson.core.JsonParser.setCurrentValue(Ljava/lang/Object;)V =&gt; (far/list-tables client-opts) java.lang.NoClassDefFoundError: Could not initialize class com.amazonaws.ClientConfiguration "><y>#</y><d>2017-01-12</d><h>19:06</h><w>curtosis</w>I seem to be doing something really silly … I’m playing with faraday, the super basic intro stuff, and it keeps throwing exceptions. It’s really just:
<pre>=&gt; (require &apos;[taoensso.faraday :as far])
=&gt; (def client-opts {:access-key &quot;...&quot; :secret-key &quot;...&quot; :endpoint &quot;&quot;})
=&gt; (far/list-tables client-opts)
java.lang.NoSuchMethodError: com.fasterxml.jackson.core.JsonParser.setCurrentValue(Ljava/lang/Object;)V
=&gt; (far/list-tables client-opts)

java.lang.NoClassDefFoundError: Could not initialize class com.amazonaws.ClientConfiguration
</pre></z><z id="t1484248138" t="curtosis I’m literally just starting up a repl (with faraday 1.9.0 in my dependencies) and that fails. Anyone seen this?"><y>#</y><d>2017-01-12</d><h>19:08</h><w>curtosis</w>I’m literally just starting up a repl (with faraday 1.9.0 in my dependencies) and that fails. Anyone seen this?</z><z id="t1484248474" t="curtosis I should probably also add that aws dynamodb list-tables works fine using the AWS CLI."><y>#</y><d>2017-01-12</d><h>19:14</h><w>curtosis</w>I should probably also add that <code>aws dynamodb list-tables</code> works fine using the AWS CLI.</z><z id="t1484248748" t="alandipert [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] are you sure you have no other deps? Looks to me like something brought in a conflicting version of Jackson. Either that or faraday itself has the conflict"><y>#</y><d>2017-01-12</d><h>19:19</h><w>alandipert</w><a>@curtosis</a> are you sure you have no other deps? Looks to me like something brought in a conflicting version of Jackson. Either that or faraday itself has the conflict</z><z id="t1484248775" t="alandipert usual culprit is cheshire"><y>#</y><d>2017-01-12</d><h>19:19</h><w>alandipert</w>
 usual culprit is cheshire</z><z id="t1484248802" t="curtosis hmmmmmm...."><y>#</y><d>2017-01-12</d><h>19:20</h><w>curtosis</w>hmmmmmm....</z><z id="t1484248835" t="curtosis data.json and pedestal."><y>#</y><d>2017-01-12</d><h>19:20</h><w>curtosis</w><code>data.json</code> and pedestal.</z><z id="t1484248867" t="alandipert If you&apos;re using boot you can do boot show -p to diagnose"><y>#</y><d>2017-01-12</d><h>19:21</h><w>alandipert</w>If you&apos;re using boot you can do boot show -p to diagnose</z><z id="t1484248882" t="alandipert Lein-pedantic on lein"><y>#</y><d>2017-01-12</d><h>19:21</h><w>alandipert</w>Lein-pedantic on lein</z><z id="t1484248908" t="alandipert I don&apos;t think data.json depends on anything so if I had to guess, pedestal is bringing Jackson in"><y>#</y><d>2017-01-12</d><h>19:21</h><w>alandipert</w>I don&apos;t think data.json depends on anything so if I had to guess, pedestal is bringing Jackson in</z><z id="t1484249176" t="curtosis of course, boot is new to me so I’ll have to learn how to read the show -p output 😛"><y>#</y><d>2017-01-12</d><h>19:26</h><w>curtosis</w>of course, boot is new to me so I’ll have to learn how to read the show -p output  <b>😛</b></z><z id="t1484249762" t="curtosis turns out I needed boot show -d to find it. pedestal.service 0.5.1 -&gt; transit-clj 0.8.285 -&gt; jackson-core 2.3.2, but aws-java-sdk-dynamodb loads 2.5.3. Fun."><y>#</y><d>2017-01-12</d><h>19:36</h><w>curtosis</w>turns out I needed <code>boot show -d</code> to find it. pedestal.service  0.5.1 -&gt; transit-clj 0.8.285 -&gt; jackson-core 2.3.2, but aws-java-sdk-dynamodb loads 2.5.3. Fun.</z><z id="t1484249768" t="curtosis thanks for the pointer!"><y>#</y><d>2017-01-12</d><h>19:36</h><w>curtosis</w>thanks for the pointer!</z><z id="t1484250497" t="alandipert Out of curiosity, how did you fix?"><y>#</y><d>2017-01-12</d><h>19:48</h><w>alandipert</w>Out of curiosity, how did you fix?</z><z id="t1484250751" t="curtosis added an :exclusion for jackson-core to pedestal.service"><y>#</y><d>2017-01-12</d><h>19:52</h><w>curtosis</w>added an <code>:exclusion</code> for jackson-core to pedestal.service</z><z id="t1484675669" t="hiredman I would check your dependencies in what ever build tool you are using"><y>#</y><d>2017-01-17</d><h>17:54</h><w>hiredman</w>I would check your dependencies in what ever build tool you are using</z><z id="t1484675678" t="hiredman whoops, behind the times"><y>#</y><d>2017-01-17</d><h>17:54</h><w>hiredman</w>whoops, behind the times</z><z id="t1484913142" t="singen Help, anyone? How do you set sqs message attributes in amazonica? I know how to set them, but the format is a complete mystery to me (sqs/send-message :queue-url a :message-body &quot;hello world!&quot; :message-attributes {”attr&quot; “value”}) results in an error."><y>#</y><d>2017-01-20</d><h>11:52</h><w>singen</w>Help, anyone? How do you set sqs message attributes in amazonica? I know how to set them, but the format is a complete mystery to me <code>(sqs/send-message :queue-url a :message-body &quot;hello world!&quot; :message-attributes {”attr&quot; “value”})</code> results in an error.</z><z id="t1484913917" t="singen Never mind, managed to reverse-engineer it. In case anyone is interested, it’s map like this: (sqs/send-message :queue-url a :message-body &quot;hello world!&quot; :message-attributes {:test {:string-value &quot;foo&quot;, :data-type &quot;String&quot;, :string-list-values [], :binary-list-values []}})"><y>#</y><d>2017-01-20</d><h>12:05</h><w>singen</w>Never mind, managed to reverse-engineer it. In case anyone is interested, it’s map like this: <code>(sqs/send-message :queue-url a :message-body &quot;hello world!&quot; :message-attributes {:test {:string-value &quot;foo&quot;, :data-type &quot;String&quot;, :string-list-values [], :binary-list-values []}})</code></z><z id="t1485196291" t="lmergen yeah Amazonica is not the most intuitive library"><y>#</y><d>2017-01-23</d><h>18:31</h><w>lmergen</w>yeah Amazonica is not the most intuitive library</z><z id="t1485370188" t="mobileink [com.amazon.alexa/alexa-skills-kit “1.2”] contains no code. anybody know what that’s all about? to get the jar I had to build https://github.com/amzn/alexa-skills-kit-java locally (by changing the src dir to maven standards). is this just a bug or am I doing something wrong?"><y>#</y><d>2017-01-25</d><h>18:49</h><w>mobileink</w>[com.amazon.alexa/alexa-skills-kit “1.2”] contains no code.  anybody know what that’s all about? to get the jar I had to build <a href="https://github.com/amzn/alexa-skills-kit-java" target="_blank">https://github.com/amzn/alexa-skills-kit-java</a> locally (by changing the src dir to maven standards). is this just a bug or am I doing something wrong?</z><z id="t1485383687" t="mobileink anybody know how to programmatically register alexa skilks? i hate web GUIs. 😉 "><y>#</y><d>2017-01-25</d><h>22:34</h><w>mobileink</w>anybody know how to programmatically register alexa skilks? i hate web GUIs. <b>😉</b> </z><z id="t1485635166" t="mobileink i could use some help debugging clojure alexa skills running on google app engine. anybody game? i&apos;ve got one running (hello), so i added a second (goodbye) but it ain&apos;t working. hard to see where the problem is. anybody have experience implementing skills as web services?"><y>#</y><d>2017-01-28</d><h>20:26</h><w>mobileink</w>i could use some help debugging clojure alexa skills running on google app engine. anybody game? i&apos;ve got one running (hello), so i added a second (goodbye) but it ain&apos;t working. hard to see where the problem is. anybody have experience implementing skills as web services?</z><z id="t1485648432" t="chris_johnson not yet, but that sounds super interesting to me. Maybe someday soon!"><y>#</y><d>2017-01-29</d><h>00:07</h><w>chris_johnson</w>not yet, but that sounds super interesting to me. Maybe someday soon!</z><z id="t1485973619" t="camille just sharing this https://blog.clubhouse.io/using-datomic-heres-how-to-move-from-postgresql-to-dynamodb-local-79ad32dae97f#.6nw05yw0c"><y>#</y><d>2017-02-01</d><h>18:26</h><w>camille</w>just sharing this <a href="https://blog.clubhouse.io/using-datomic-heres-how-to-move-from-postgresql-to-dynamodb-local-79ad32dae97f#.6nw05yw0c" target="_blank">https://blog.clubhouse.io/using-datomic-heres-how-to-move-from-postgresql-to-dynamodb-local-79ad32dae97f#.6nw05yw0c</a></z><z id="t1486409118" t="curtosis what’s the state of dynamodb-from-cljs these days? I’m looking to build an autocomplete lambda on top of a dynamodb table, and am curious what folks are using lately."><y>#</y><d>2017-02-06</d><h>19:25</h><w>curtosis</w>what’s the state of dynamodb-from-cljs these days? I’m looking to build an autocomplete lambda on top of a dynamodb table, and am curious what folks are using lately.</z><z id="t1486409163" t="curtosis (or I suppose could go direct from browser cljs to dynamodb? dunno. it’s a new chunk to design for me)"><y>#</y><d>2017-02-06</d><h>19:26</h><w>curtosis</w>(or I suppose could go direct from browser cljs to dynamodb? dunno. it’s a new chunk to design for me)</z><z id="t1486421997" t="villesv [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] Depending on your needs - have you looked att simply proxying dynamodb using API Gateway? I just happened to stumble across a blog post describing just that while looking for something completely different."><y>#</y><d>2017-02-06</d><h>22:59</h><w>villesv</w><a>@curtosis</a> Depending on your needs - have you looked att simply proxying dynamodb using API Gateway? I just happened to stumble across a blog post describing just that while looking for something completely different.</z><z id="t1486483317" t="curtosis Interesting… do you still have the link?"><y>#</y><d>2017-02-07</d><h>16:01</h><w>curtosis</w>Interesting… do you still have the link?</z><z id="t1486487594" t="villesv [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] Oh, sorry, didn&apos;t check in for a while. Hang on, see if I can dig through my history"><y>#</y><d>2017-02-07</d><h>17:13</h><w>villesv</w><a>@curtosis</a> Oh, sorry, didn&apos;t check in for a while. Hang on, see if I can dig through my history</z><z id="t1486487678" t="villesv [:attrs {:href &quot;/_/_/users/U050N4M9Z&quot;}] I think this was the one I stumbled over: https://noise.getoto.net/2016/02/26/using-amazon-api-gateway-as-a-proxy-for-dynamodb/"><y>#</y><d>2017-02-07</d><h>17:14</h><w>villesv</w><a>@curtosis</a> I think this was the one I stumbled over: <a href="https://noise.getoto.net/2016/02/26/using-amazon-api-gateway-as-a-proxy-for-dynamodb/" target="_blank">https://noise.getoto.net/2016/02/26/using-amazon-api-gateway-as-a-proxy-for-dynamodb/</a></z><z id="t1486487686" t="villesv Though, I think you can find plenty more"><y>#</y><d>2017-02-07</d><h>17:14</h><w>villesv</w>Though, I think you can find plenty more</z><z id="t1486487722" t="villesv API Gateway can generally be used (although I have not yet) as a custom proxy for most AWS services it seems"><y>#</y><d>2017-02-07</d><h>17:15</h><w>villesv</w>API Gateway can generally be used (although I have not yet) as a custom proxy for most AWS services it seems</z><z id="t1486488802" t="curtosis great, thanks!"><y>#</y><d>2017-02-07</d><h>17:33</h><w>curtosis</w>great, thanks!</z><z id="t1486488928" t="curtosis I’ll have to investigate how to map an autocomplete-style range query that way, but I sort of have to figure that out for DynamoDB anyway. (All the examples I can find use CloudSearch, which is totally wrong for me here.)"><y>#</y><d>2017-02-07</d><h>17:35</h><w>curtosis</w>I’ll have to investigate how to map an autocomplete-style range query that way, but I sort of have to figure that out for DynamoDB anyway. (All the examples I can find use CloudSearch, which is totally wrong for me here.)</z><z id="t1486593212" t="Geoffrey Gaillard Hi everybody ! I just saw that DynamoDB can now be used as a Titan storage. So I searched for a Titan library in Clojure and found Titanium, but it seems to have never broke out of the beta phase. Do some of you know a reliable way to use Titan from Clojure ?"><y>#</y><d>2017-02-08</d><h>22:33</h><w>Geoffrey Gaillard</w>Hi everybody !
I just saw that DynamoDB can now be used as a Titan storage. So I searched for a Titan library in Clojure and found Titanium, but it seems to have never broke out of the beta phase. 
Do some of you know a reliable way to use Titan from Clojure ?</z><z id="t1487031773" t="juliobarros Anyone using Amazonica know how to shutdown the S3 transfer manager worker pool?"><y>#</y><d>2017-02-14</d><h>00:22</h><w>juliobarros</w>Anyone using Amazonica know how to shutdown the S3 transfer manager worker pool?</z><z id="t1487166635" t="singen [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] No, but I’ve been using Amazonica for a while. Can you give an example of what you’ve tried out?"><y>#</y><d>2017-02-15</d><h>13:50</h><w>singen</w><a>@juliobarros</a> No, but I’ve been using Amazonica for a while. Can you give an example of what you’ve tried out?</z><z id="t1487969563" t="sirsean Hi all! I&apos;m trying to use amazonica with manifold and having a bit of trouble. Has anybody here done that before?"><y>#</y><d>2017-02-24</d><h>20:52</h><w>sirsean</w>Hi all! I&apos;m trying to use amazonica with manifold and having a bit of trouble. Has anybody here done that before?</z><z id="t1487970913" t="sirsean (Basically the problem I&apos;m having is that if I try to wrap a call to amazonica inside an md/future , I&apos;m getting a stack overflow error with some regularity.)"><y>#</y><d>2017-02-24</d><h>21:15</h><w>sirsean</w>(Basically the problem I&apos;m having is that if I try to wrap a call to amazonica inside an <code>md/future</code>, I&apos;m getting a stack overflow error with some regularity.)</z><z id="t1487971245" t="sirsean crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count) 36 crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count) StackOverflowError java.net.SocketInputStream.socketRead0 (SocketInputStream.java:-2) crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count) 36"><y>#</y><d>2017-02-24</d><h>21:20</h><w>sirsean</w><pre>crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count)
36
crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count)

StackOverflowError   java.net.SocketInputStream.socketRead0 (SocketInputStream.java:-2)
crapi.core=&gt; @(md/chain (md/future (s3/list-buckets creds)) count)
36</pre></z><z id="t1488304953" t="timgilbert S3 seems to be having an outage..."><y>#</y><d>2017-02-28</d><h>18:02</h><w>timgilbert</w>S3 seems to be having an outage...</z><z id="t1488309780" t="micha shh, i don&apos;t think anyone noticed"><y>#</y><d>2017-02-28</d><h>19:23</h><w>micha</w>shh, i don&apos;t think anyone noticed</z><z id="t1488309867" t="micha lol just kiddin"><y>#</y><d>2017-02-28</d><h>19:24</h><w>micha</w>lol just kiddin</z><z id="t1488314608" t="bja s3-journal is currently paying big dividends but I&apos;m starting to eye my disk usage nervously"><y>#</y><d>2017-02-28</d><h>20:43</h><w>bja</w><code>s3-journal</code> is currently paying big dividends but I&apos;m starting to eye my disk usage nervously</z><z id="t1488316570" t="dottedmag [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] Online EBS resize to the rescue!"><y>#</y><d>2017-02-28</d><h>21:16</h><w>dottedmag</w><a>@bja</a> Online EBS resize to the rescue!</z><z id="t1488316580" t="bja ooh, forgot that&apos;s a thing"><y>#</y><d>2017-02-28</d><h>21:16</h><w>bja</w>ooh, forgot that&apos;s a thing</z><z id="t1488316586" t="bja s3 appears to be back though"><y>#</y><d>2017-02-28</d><h>21:16</h><w>bja</w>s3 appears to be back though</z><z id="t1490474960" t="lvh hi"><y>#</y><d>2017-03-25</d><h>20:49</h><w>lvh</w>hi</z><z id="t1490549416" t="petr.mensik Hello, I have a problem with lein-beanstalk client which I can&apos;t really figure out. I have one project where I deploy to AWS via lein beanstalk deploy env and it just works. Now I copied aws plugin config from this project to new project and I am getting NPE exception like this"><y>#</y><d>2017-03-26</d><h>17:30</h><w>petr.mensik</w>Hello, I have a problem with lein-beanstalk client which I can&apos;t really figure out. I have one project where I deploy to AWS via <code>lein beanstalk deploy env</code> and it just works. Now I copied aws plugin config from this project to new project and I am getting NPE exception like this</z><z id="t1490549433" t="petr.mensik lein beanstalk info | head java.lang.NullPointerException: null at com.amazonaws.AmazonWebServiceClient.setEndpoint (AmazonWebServiceClient.java:97) leiningen.beanstalk.aws$beanstalk_client.invokeStatic (aws.clj:115) leiningen.beanstalk.aws$beanstalk_client.invoke (aws.clj:114) leiningen.beanstalk.aws$get_application.invokeStatic (aws.clj:145) leiningen.beanstalk.aws$get_application.invoke (aws.clj:142) leiningen.beanstalk$app_info.invokeStatic (beanstalk.clj:80) leiningen.beanstalk$app_info.invoke (beanstalk.clj:77) leiningen.beanstalk$info.invokeStatic (beanstalk.clj:111) leiningen.beanstalk$info.invoke (beanstalk.clj:108) "><y>#</y><d>2017-03-26</d><h>17:30</h><w>petr.mensik</w><pre>lein beanstalk info | head
java.lang.NullPointerException: null
 at com.amazonaws.AmazonWebServiceClient.setEndpoint (AmazonWebServiceClient.java:97)
    leiningen.beanstalk.aws$beanstalk_client.invokeStatic (aws.clj:115)
    leiningen.beanstalk.aws$beanstalk_client.invoke (aws.clj:114)
    leiningen.beanstalk.aws$get_application.invokeStatic (aws.clj:145)
    leiningen.beanstalk.aws$get_application.invoke (aws.clj:142)
    leiningen.beanstalk$app_info.invokeStatic (beanstalk.clj:80)
    leiningen.beanstalk$app_info.invoke (beanstalk.clj:77)
    leiningen.beanstalk$info.invokeStatic (beanstalk.clj:111)
    leiningen.beanstalk$info.invoke (beanstalk.clj:108)
</pre></z><z id="t1490549505" t="petr.mensik Configuration of the plugin itself looks like this https://pastebin.com/tL5xnxwh"><y>#</y><d>2017-03-26</d><h>17:31</h><w>petr.mensik</w>Configuration of the plugin itself looks like this <a href="https://pastebin.com/tL5xnxwh" target="_blank">https://pastebin.com/tL5xnxwh</a></z><z id="t1490549650" t="petr.mensik Only difference is basically that I am using different AWS accounts for those two projects. However I switched accounts manually in .aws/config and .aws/credentials with no success. It also doesn&apos;t explain such weird exception. So is there anyone who encountered this as well?"><y>#</y><d>2017-03-26</d><h>17:34</h><w>petr.mensik</w>Only difference is basically that I am using different AWS accounts for those two projects. However I switched accounts manually in <code>.aws/config</code> and <code>.aws/credentials</code> with no success. It also doesn&apos;t explain such weird exception. So is there anyone who encountered this as well?</z><z id="t1491247931" t="richiardiandrea has anyone messed around with Dynamodb Streams? It looks like it is super super slow to call my lambdas on puts (the latency of the put itself is very low). It takes 37 seconds!!"><y>#</y><d>2017-04-03</d><h>19:32</h><w>richiardiandrea</w>has anyone messed around with Dynamodb Streams? It looks like it is super super slow to call my lambdas on puts (the latency of the put itself is very low). It takes 37 seconds!!</z><z id="t1491249031" t="bhagany in my experience, going from lambda &lt;-&gt; any other aws service is kind of slow. 37 seconds seems excessive, though."><y>#</y><d>2017-04-03</d><h>19:50</h><w>bhagany</w>in my experience, going from lambda &lt;-&gt; any other aws service is kind of slow.  37 seconds seems excessive, though.</z><z id="t1491249383" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U051706GF&quot;}] thanks, basically I am doing a put in DynamoDB and triggering the same function using a Dynamo Stream trigger...if I do the diff between the put and the time when the triggered lambda starts I get 37 seconds...but maybe this is not an effective way to test this thing"><y>#</y><d>2017-04-03</d><h>19:56</h><w>richiardiandrea</w><a>@bhagany</a> thanks, basically I am doing a put in DynamoDB and triggering the same function using a Dynamo Stream trigger...if I do the diff between the put and the time when the triggered lambda starts I get 37 seconds...but maybe this is not an effective way to test this thing</z><z id="t1491249420" t="bhagany that seems reasonable to me"><y>#</y><d>2017-04-03</d><h>19:57</h><w>bhagany</w>that seems reasonable to me</z><z id="t1491251567" t="lvh [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] how big is your jar"><y>#</y><d>2017-04-03</d><h>20:32</h><w>lvh</w><a>@richiardiandrea</a> how big is your jar</z><z id="t1491251592" t="lvh I hear Zach is doing cool things with making proguard not suck with Clojure"><y>#</y><d>2017-04-03</d><h>20:33</h><w>lvh</w>I hear Zach is doing cool things with making proguard not suck with Clojure</z><z id="t1491251595" t="lvh I am very excited about this"><y>#</y><d>2017-04-03</d><h>20:33</h><w>lvh</w>I am very excited about this</z><z id="t1491251615" t="richiardiandrea I am using JavaScript, the lamdba is very little...Just a pic to in DynamoDB basically"><y>#</y><d>2017-04-03</d><h>20:33</h><w>richiardiandrea</w>I am using JavaScript, the lamdba is very little...Just a pic to in DynamoDB basically</z><z id="t1491251625" t="richiardiandrea Oh cool stuff ;) "><y>#</y><d>2017-04-03</d><h>20:33</h><w>richiardiandrea</w>Oh cool stuff ;) </z><z id="t1491331871" t="juliobarros I have a problem getting amazonica to list my cloud formation stacks (cf/list-stacks) I’m able to list them with the aws cli and I can list my s3 buckets with amazonica (so I don’t think its a permissions error). All I get back is {:stack-summaries []} … any ideas? Thanks in advance."><y>#</y><d>2017-04-04</d><h>18:51</h><w>juliobarros</w>I have a problem getting amazonica to list my cloud formation stacks (cf/list-stacks) I’m able to list them with the aws cli and I can list my s3 buckets with amazonica (so I don’t think its a permissions error). All I get back is {:stack-summaries []} … any ideas?  Thanks in advance.</z><z id="t1491332252" t="Ed [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] are you looking at the right region?"><y>#</y><d>2017-04-04</d><h>18:57</h><w>Ed</w><a>@juliobarros</a> are you looking at the right region?</z><z id="t1491332293" t="juliobarros Hmm … the aws cli works so I thought it would ‘inherit’ all the same settings."><y>#</y><d>2017-04-04</d><h>18:58</h><w>juliobarros</w>Hmm … the aws cli works so I thought it would ‘inherit’ all the same settings.</z><z id="t1491332319" t="juliobarros The config is set to the right region."><y>#</y><d>2017-04-04</d><h>18:58</h><w>juliobarros</w>The config is set to the right region.</z><z id="t1491332728" t="juliobarros [:attrs {:href &quot;/_/_/users/U0P0TMEFJ&quot;}] You were right. I wrapped an explicit with-credential around it and got my stacks. … I wonder how the region is set and why it works for S3 and not cloudformation."><y>#</y><d>2017-04-04</d><h>19:05</h><w>juliobarros</w><a>@l0st3d</a> You were right. I wrapped an explicit with-credential around it and got my stacks. … I wonder how the region is set and why it works for S3 and not cloudformation.</z><z id="t1491333276" t="Ed [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] amazonica is a bit inconsistent about using :region and :endpoint ... I think it comes from the underlying aws lib, and the fact that s3 is so old now 😉"><y>#</y><d>2017-04-04</d><h>19:14</h><w>Ed</w><a>@juliobarros</a> amazonica is a bit inconsistent about using :region and :endpoint ... I think it comes from the underlying aws lib, and the fact that s3 is so old now <b>😉</b></z><z id="t1491333321" t="Ed was just about to find some code where i had done that sort of thing and work out what i did ... but then you worked it out 😉"><y>#</y><d>2017-04-04</d><h>19:15</h><w>Ed</w>was just about to find some code where i had done that sort of thing and work out what i did ... but then you worked it out <b>😉</b></z><z id="t1491333322" t="juliobarros Thanks. I didn’t mention that it also works with (cf/list-stacks {:endpoint “us-west-2”})"><y>#</y><d>2017-04-04</d><h>19:15</h><w>juliobarros</w>Thanks.  I didn’t mention that it also works with (cf/list-stacks {:endpoint “us-west-2”})</z><z id="t1491426011" t="lboliveira Hello! What is the right way to add a .ebextensions directory into a jar that was generated by the lein jar command?"><y>#</y><d>2017-04-05</d><h>21:00</h><w>lboliveira</w>Hello! What is the right way to add a .ebextensions directory into a jar that was generated by the <code>lein jar</code> command?</z><z id="t1491486825" t="timgilbert [:attrs {:href &quot;/_/_/users/U067NFWUR&quot;}] : if you put your directory inside the resources directory of your project, it will be copied into the jar"><y>#</y><d>2017-04-06</d><h>13:53</h><w>timgilbert</w><a>@lboliveira</a>: if you put your directory inside the <code>resources</code> directory of your project, it will be copied into the jar</z><z id="t1491487397" t="lboliveira [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] every directory that starts with . will be ignored. I reached technomancy on irc yesterday. He confirmed it. He was very nice to release a patch to fix that behavior. https://github.com/technomancy/leiningen/commit/9e45977a4a2764f02a4f68b7ba2492ec210b78bb . Now we should use :jar-inclusions [“^\.ebextensions”] to allow this directory to be copied."><y>#</y><d>2017-04-06</d><h>14:03</h><w>lboliveira</w><a>@timgilbert</a> every directory that starts with . will be ignored. I reached technomancy on irc yesterday. He confirmed it.  He was very nice to release a patch to fix that behavior. <a href="https://github.com/technomancy/leiningen/commit/9e45977a4a2764f02a4f68b7ba2492ec210b78bb" target="_blank">https://github.com/technomancy/leiningen/commit/9e45977a4a2764f02a4f68b7ba2492ec210b78bb</a> . Now we should use :jar-inclusions [“^\.ebextensions”] to allow this directory to be copied.</z><z id="t1491487426" t="timgilbert Hmm, interesting"><y>#</y><d>2017-04-06</d><h>14:03</h><w>timgilbert</w>Hmm, interesting</z><z id="t1491487469" t="timgilbert Oh, yeah, I just realized actually that I put my .ebextensions in our application bundle (zip file), which includes the .jar file inside of it"><y>#</y><d>2017-04-06</d><h>14:04</h><w>timgilbert</w>Oh, yeah, I just realized actually that I put my .ebextensions in our application bundle (zip file), which includes the .jar file inside of it</z><z id="t1491487681" t="lboliveira Now we can use only the jar"><y>#</y><d>2017-04-06</d><h>14:08</h><w>lboliveira</w>Now we can use only the jar</z><z id="t1491488051" t="lboliveira I don’t know if it is good"><y>#</y><d>2017-04-06</d><h>14:14</h><w>lboliveira</w>I don’t know if it is good</z><z id="t1492666852" t="minikomi https://aws.amazon.com/blogs/aws/new-aws-codestar/ Interesting."><y>#</y><d>2017-04-20</d><h>05:40</h><w>minikomi</w><a href="https://aws.amazon.com/blogs/aws/new-aws-codestar/" target="_blank">https://aws.amazon.com/blogs/aws/new-aws-codestar/</a>
Interesting.</z><z id="t1492760884" t="grav Anyone played around with cljs-lambda?"><y>#</y><d>2017-04-21</d><h>07:48</h><w>grav</w>Anyone played around with cljs-lambda?</z><z id="t1494262379" t="derwolfe anyone using localstack with amazonica?"><y>#</y><d>2017-05-08</d><h>16:52</h><w>derwolfe</w>anyone using localstack with amazonica?</z><z id="t1494262412" t="derwolfe I’m having a bit of difficulty getting the incantation right that would allow me to point my aws calls to the local … localstack"><y>#</y><d>2017-05-08</d><h>16:53</h><w>derwolfe</w>I’m having a bit of difficulty getting the incantation right that would allow me to point my aws calls to the local … localstack</z><z id="t1494263132" t="lvh (I do not)"><y>#</y><d>2017-05-08</d><h>17:05</h><w>lvh</w>(I do not)</z><z id="t1494274164" t="derwolfe ah, I think I found the issue. The application from which I’m invoking my AWS code needs some exclusions; when used from a fresh repo, I simply need to use amazonica’s with-credential and then a fake key, secret, and the local url for the localstack service. Cool stuff 🙂"><y>#</y><d>2017-05-08</d><h>20:09</h><w>derwolfe</w>ah, I think I found the issue. The application from which I’m invoking my AWS code needs some exclusions; when used from a fresh repo, I simply need to use amazonica’s <code>with-credential</code> and then a fake key, secret, and the local url for the localstack service. Cool stuff <b>🙂</b></z><z id="t1494280257" t="derwolfe and my problem was solved by moving amazonica’s decl in project.clj nearer to the top, before several other libraries that depend on apache http libs - lesson which I didn’t know; ordering matters: )"><y>#</y><d>2017-05-08</d><h>21:50</h><w>derwolfe</w>and my problem was solved by moving amazonica’s decl in project.clj nearer to the top, before several other libraries that depend on apache http libs - lesson which I didn’t know; ordering matters: )</z><z id="t1494281663" t="mccraigmccraig [:attrs {:href &quot;/_/_/users/U0DU8TNKT&quot;}] if you specify :pedantic? :abort in your project.clj it will bork if there are any incompatible dependencies and ordering will stop mattering"><y>#</y><d>2017-05-08</d><h>22:14</h><w>mccraigmccraig</w><a>@derwolfe</a> if you specify <code>:pedantic? :abort</code> in your <code>project.clj</code> it will bork if there are any incompatible dependencies and ordering will stop mattering</z><z id="t1494284061" t="derwolfe [:attrs {:href &quot;/_/_/users/U0524B4UW&quot;}] oooh, good to know. I’ll give that a try 🙂"><y>#</y><d>2017-05-08</d><h>22:54</h><w>derwolfe</w><a>@mccraigmccraig</a> oooh, good to know. I’ll give that a try <b>🙂</b></z><z id="t1494284061" t="derwolfe thanks"><y>#</y><d>2017-05-08</d><h>22:54</h><w>derwolfe</w>thanks</z><z id="t1494284238" t="mccraigmccraig (you will then have to specify sufficient exclusions that there are no more incompatible dependencies to stop it borking - i prefer that you are forced to be explicit like this)"><y>#</y><d>2017-05-08</d><h>22:57</h><w>mccraigmccraig</w>(you will then have to specify sufficient exclusions that there are no more incompatible dependencies to stop it borking - i prefer that you are forced to be explicit like this)</z><z id="t1494339226" t="derwolfe lvh: are you using aws-java-sdk-stubs ?"><y>#</y><d>2017-05-09</d><h>14:13</h><w>derwolfe</w>lvh: are you using <code>aws-java-sdk-stubs</code>?</z><z id="t1494339419" t="lvh No, manual stubs"><y>#</y><d>2017-05-09</d><h>14:16</h><w>lvh</w>No, manual stubs</z><z id="t1494339542" t="derwolfe thanks 🙂"><y>#</y><d>2017-05-09</d><h>14:19</h><w>derwolfe</w>thanks <b>🙂</b></z><z id="t1494339649" t="lvh Which is good because odds I stop using the Java SDK in the next year &gt;90%"><y>#</y><d>2017-05-09</d><h>14:20</h><w>lvh</w>Which is good because odds I stop using the Java SDK in the next year &gt;90%</z><z id="t1494420835" t="mj_langford We&apos;re doing stuff with lambda, aws api gateway, S3, DynamoDB and a couple smaller things. Would you all recommend trying to use Amazonica Cloudformation, just straight AWS Cloudformation, or some other mix of things to regularlize deployments (like a serverless template or something). This is to deploy a clojure app"><y>#</y><d>2017-05-10</d><h>12:53</h><w>mj_langford</w>We&apos;re doing stuff with lambda, aws api gateway, S3, DynamoDB and a couple smaller things. Would you all recommend trying to use Amazonica Cloudformation, just straight AWS Cloudformation, or some other mix of things to regularlize deployments (like a serverless template or something). This is to deploy a clojure app</z><z id="t1494420924" t="mj_langford I have a tutorial [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] : https://github.com/langford/clj-aws-lambda-example https://github.com/langford/clj-aws-lambda-presentation"><y>#</y><d>2017-05-10</d><h>12:55</h><w>mj_langford</w>I have a tutorial <a>@sb</a>: <a href="https://github.com/langford/clj-aws-lambda-example" target="_blank">https://github.com/langford/clj-aws-lambda-example</a> <a href="https://github.com/langford/clj-aws-lambda-presentation" target="_blank">https://github.com/langford/clj-aws-lambda-presentation</a></z><z id="t1494420978" t="mj_langford Disclosure: I&apos;m personally investigating the cljs + serverless stack for the next project, or going to rewrite ring-aws-lambda-adapter a bit at least"><y>#</y><d>2017-05-10</d><h>12:56</h><w>mj_langford</w>Disclosure: I&apos;m personally investigating the cljs + serverless stack for the next project, or going to rewrite ring-aws-lambda-adapter  a bit at least</z><z id="t1495004850" t="qqq is it possible to send SMS directly from AWS (instead of having to use twilio)"><y>#</y><d>2017-05-17</d><h>07:07</h><w>qqq</w>is it possible to send SMS directly from AWS (instead of having to use twilio)</z><z id="t1495027415" t="olfal qqq: Yes! With the SNS service you can send notifications with the SMS protocol"><y>#</y><d>2017-05-17</d><h>13:23</h><r>olfal</r>qqq: Yes! With the SNS service you can send notifications with the SMS protocol</z><z id="t1495027485" t="olfal Here is a Java sample that you can easily wrap in Clojure : https://docs.aws.amazon.com/sns/latest/dg/sms_publish-to-phone.html#sms_publish_sdk"><y>#</y><d>2017-05-17</d><h>13:24</h><r>olfal</r>Here is a Java sample that you can easily wrap in Clojure :
<a href="https://docs.aws.amazon.com/sns/latest/dg/sms_publish-to-phone.html#sms_publish_sdk" target="_blank">https://docs.aws.amazon.com/sns/latest/dg/sms_publish-to-phone.html#sms_publish_sdk</a></z><z id="t1495032857" t="mj_langford You can def do SnS!"><y>#</y><d>2017-05-17</d><h>14:54</h><r>mj_langford</r>You can def do SnS!</z><z id="t1495032886" t="mj_langford I&apos;d argue, as a person who does both AWS and Twilio, Twilio is hands down easier to setup."><y>#</y><d>2017-05-17</d><h>14:54</h><r>mj_langford</r>I&apos;d argue, as a person who does both AWS and Twilio, Twilio is hands down easier to setup.</z><z id="t1495032891" t="mj_langford if that matters to you ;D"><y>#</y><d>2017-05-17</d><h>14:54</h><r>mj_langford</r>if that matters to you ;D</z><z id="t1495053575" t="olfal [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] what kind of setup are you referring to? You only need an AWS secret/pass and you can send an SMS right away. No configuration needed in the portal. I just made a light Clojure wrapper around the Java SDK, and you can just do (publish creds &quot;message&quot; &quot;phone-number&quot;) . Not sure how it could be easier 🙂"><y>#</y><d>2017-05-17</d><h>20:39</h><r>olfal</r><a>@U050B8Q1P</a> what kind of setup are you referring to? You only need an AWS secret/pass and you can send an SMS right away. No configuration needed in the portal. I just made a light Clojure wrapper around the Java SDK, and you can just do <code>(publish creds &quot;message&quot; &quot;phone-number&quot;)</code>. Not sure how it could be easier <b>🙂</b></z><z id="t1495082604" t="mj_langford &gt;You only need an AWS secret/pass Lets just say &quot;there are more steps&quot; when involving iOS in the process."><y>#</y><d>2017-05-18</d><h>04:43</h><r>mj_langford</r>&gt;You only need an AWS secret/pass

Lets just say &quot;there are more steps&quot; when involving iOS in the process.</z><z id="t1495084624" t="qqq I&apos;m sending the SMS from the server."><y>#</y><d>2017-05-18</d><h>05:17</h><r>qqq</r>I&apos;m sending the SMS from the server.</z><z id="t1495084628" t="qqq Why is iOS involved at all?"><y>#</y><d>2017-05-18</d><h>05:17</h><r>qqq</r>Why is iOS involved at all?</z><z id="t1495084646" t="qqq and if I was sending the SMS from a mobile device, why would it go through amazon instead of just using the phone&apos;s SMS ?"><y>#</y><d>2017-05-18</d><h>05:17</h><r>qqq</r>and if I was sending the SMS from a mobile device, why would it go through amazon instead of just using the phone&apos;s SMS ?</z><z id="t1495085345" t="sb I heard aws course and they talked about how to integrate with Twilio when you want send SMS (API gateway, lambda)"><y>#</y><d>2017-05-18</d><h>05:29</h><r>sb</r>I heard aws course and they talked about how to integrate with Twilio when you want send SMS (API gateway,  lambda)</z><z id="t1495085429" t="sb Aws have inbuilt integration to Twilio"><y>#</y><d>2017-05-18</d><h>05:30</h><r>sb</r>Aws have inbuilt integration to Twilio</z><z id="t1495085443" t="sb (Just SMS)"><y>#</y><d>2017-05-18</d><h>05:30</h><r>sb</r>(Just SMS)</z><z id="t1495095053" t="qqq Why do I need twilio if I am already using AWS?"><y>#</y><d>2017-05-18</d><h>08:10</h><r>qqq</r>Why do I need twilio if I am already using AWS?</z><z id="t1495117130" t="olfal Good question 😛"><y>#</y><d>2017-05-18</d><h>14:18</h><r>olfal</r>Good question <b>😛</b></z><z id="t1495235365" t="qqq is there a tutorial on aws + clojure? searching around, most google results are on laws lambda + cljs, which is not what I&apos;m after"><y>#</y><d>2017-05-19</d><h>23:09</h><w>qqq</w>is there a tutorial on aws + clojure? searching around, most google results are on laws lambda + cljs, which is not what I&apos;m after</z><z id="t1495255121" t="lumengxi what do you mean by clojure + aws? deploying a Clojure web app to AWS?"><y>#</y><d>2017-05-20</d><h>04:38</h><w>lumengxi</w>what do you mean by clojure + aws? deploying a Clojure web app to AWS?</z><z id="t1495255873" t="qqq Yes, deploying a clojure web app to AWS."><y>#</y><d>2017-05-20</d><h>04:51</h><w>qqq</w>Yes, deploying a clojure web app to AWS.</z><z id="t1495255891" t="qqq I used to use GAE, and wrote Clojure apps as Jetty Servlets, but am now looking into AWS instead."><y>#</y><d>2017-05-20</d><h>04:51</h><w>qqq</w>I used to use GAE, and wrote Clojure apps as Jetty Servlets, but am now looking into AWS instead.</z><z id="t1495267584" t="Geoffrey Gaillard Don&apos;t have a Clojure tutorial but the java documentation is pretty similar. For a simple deploy I recommend using AWS Elastic Beanstalk. You can create an app, configure it, then push an uberjar to it. If you want to see logs, connect to the instance, change environnement variables from a shell, install the eb command. If you want your code to watch a git referential and be built, you can create an AWS CodeBuild build and configure it with a buildspec.yml file at the root of your project. To automate deployments AWS CodePipeline can watch your Git repo, trigger the build, then push your uberjar to ElasticBeanstalk. ElasticBeanstalk will take care of load balancing, blue-green deployments etc… https://docs.aws.amazon.com/en_us/elasticbeanstalk/latest/dg/java-getstarted.html"><y>#</y><d>2017-05-20</d><h>08:06</h><w>Geoffrey Gaillard</w>Don&apos;t have a Clojure tutorial but the java documentation is pretty similar.
For a simple deploy I recommend using AWS Elastic Beanstalk. You can create an app, configure it, then push an uberjar to it.
If you want to see logs, connect to the instance, change environnement variables from a shell, install the <code>eb</code> command.
If you want your code to watch a git referential and be built, you can create an AWS CodeBuild build and configure it with a <code>buildspec.yml</code> file at the root of your project.
To automate deployments AWS CodePipeline can watch your Git repo, trigger the build, then push your uberjar to ElasticBeanstalk. ElasticBeanstalk will take care of load balancing, blue-green deployments etc…

<a href="https://docs.aws.amazon.com/en_us/elasticbeanstalk/latest/dg/java-getstarted.html" target="_blank">https://docs.aws.amazon.com/en_us/elasticbeanstalk/latest/dg/java-getstarted.html</a></z><z id="t1495267617" t="Geoffrey Gaillard BTW if you find a Clojure tutorial for this, I&apos;d like to read it too 🙂"><y>#</y><d>2017-05-20</d><h>08:06</h><w>Geoffrey Gaillard</w>BTW if you find a Clojure tutorial for this, I&apos;d like to read it too <b>🙂</b></z><z id="t1495268127" t="qqq [:attrs {:href &quot;/_/_/users/U2DART3HA&quot;}] : do you give up live nrepl ?"><y>#</y><d>2017-05-20</d><h>08:15</h><w>qqq</w><a>@ggaillard</a> : do you give up live nrepl ?</z><z id="t1495269821" t="Geoffrey Gaillard I dont use it, but you can open an SSH connection with $&gt; eb ssh , and then I guess you can open a REPL. If you have special needs, you can create an Amazon Machine Image (AMI) with all the tools you need (lein, emacs, &lt;you name it&gt;) and make ElasticBeanstalk use it as a base. I didn&apos;t tried, but I guess you can create a tunnel from your machine to the instance with port forwarding and give that local port to your repl. $&gt; eb ssh --help [...] -e CUSTOM, --custom CUSTOM Specify an SSH command to use instead of &apos;ssh -i keyfile&apos;. Do not include the remote user and hostname. "><y>#</y><d>2017-05-20</d><h>08:43</h><w>Geoffrey Gaillard</w>I dont use it, but you can open an SSH connection with <code>$&gt; eb ssh</code>, and then I guess you can open a REPL.
If you have special needs, you can create an Amazon Machine Image (AMI) with all the tools you need (lein, emacs, &lt;you name it&gt;) and make ElasticBeanstalk use it as a base. I didn&apos;t tried, but I guess you can create a tunnel from your machine to the instance with port forwarding and give that local port to your repl.
<pre>$&gt; eb ssh --help
[...]
-e CUSTOM, --custom CUSTOM
                        Specify an SSH command to use instead of &apos;ssh -i
                        keyfile&apos;. Do not include the remote user and hostname.
</pre></z><z id="t1495400457" t="qqq I have already run &quot;aws configure &quot;and setu the proper keys."><y>#</y><d>2017-05-21</d><h>21:00</h><w>qqq</w>I have already run &quot;aws configure &quot;and setu the proper keys.</z><z id="t1495400467" t="qqq I also have a war, and I know my application name / environment name."><y>#</y><d>2017-05-21</d><h>21:01</h><w>qqq</w>I also have a war, and I know my application name / environment name.</z><z id="t1495400483" t="qqq Which is the &quot;aws elasticbeanstalk &quot; command for uploading a new *.war file to use ?"><y>#</y><d>2017-05-21</d><h>21:01</h><w>qqq</w>Which is the &quot;aws elasticbeanstalk &quot; command for uploading a new *.war file to use ?</z><z id="t1495461540" t="Geoffrey Gaillard I don&apos;t use it this way. When I want to deploy something I just git push on a branch and CodePipeline take care of the rest. So I don&apos;t want to give you wrong information. But it seems that eb deploy is made for that. Be careful, there is two CLIs: - aws [command] [subcommand] that take care of the low level actions (creating EC2 instances, Load Balancers…) - eb [command] that take care of ElasticBeanstalk only, for higher level tasks (deploy, logs, environnement variables) https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html"><y>#</y><d>2017-05-22</d><h>13:59</h><w>Geoffrey Gaillard</w>I don&apos;t use it this way. When I want to deploy something I just <code>git push</code> on a branch and CodePipeline take care of the rest. So I don&apos;t want to give you wrong information. But it seems that <code>eb deploy</code> is made for that.
Be careful, there is two CLIs:
- <code>aws [command] [subcommand]</code> that take care of the low level actions (creating EC2 instances, Load Balancers…) 
- <code>eb [command]</code> that take care of ElasticBeanstalk only, for higher level tasks (deploy, logs, environnement variables)

<a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3.html</a></z><z id="t1495483803" t="timgilbert My setup is similar to the above, but I&apos;m using CircleCI to do the build/deploy step instead of CodePipeline"><y>#</y><d>2017-05-22</d><h>20:10</h><w>timgilbert</w>My setup is similar to the above, but I&apos;m using CircleCI to do the build/deploy step instead of CodePipeline</z><z id="t1495483972" t="timgilbert The build step is basically lein uberjar and then creating an ElasticBeanStalk &quot;application bundle&quot; - a zip file with the uberjar in it and some extra AWS stuff like a Procfile. Then the deploy step is basically eb deploy ."><y>#</y><d>2017-05-22</d><h>20:12</h><w>timgilbert</w>The build step is basically <code>lein uberjar</code> and then creating an ElasticBeanStalk &quot;application bundle&quot; - a zip file with the uberjar in it and some extra AWS stuff like a Procfile. Then the deploy step is basically <code>eb deploy</code>.</z><z id="t1495484036" t="timgilbert You can probably get away with a much simpler setup, but we needed to tweak some things for ~reasons"><y>#</y><d>2017-05-22</d><h>20:13</h><w>timgilbert</w>You can probably get away with a much simpler setup, but we needed to tweak some things for <code>~reasons</code></z><z id="t1495484216" t="timgilbert But I agree that Java SE ElasticBeanStalk is probably one of the simpler and most dev-friendly setups you can work with on AWS at the moment"><y>#</y><d>2017-05-22</d><h>20:16</h><w>timgilbert</w>But I agree that Java SE ElasticBeanStalk is probably one of the simpler and most dev-friendly setups you can work with on AWS at the moment</z><z id="t1495744438" t="sb somebody created this in clojure? here is the instructions https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html (signature calculation)?"><y>#</y><d>2017-05-25</d><h>20:33</h><w>sb</w>somebody created this in clojure? here is the instructions <a href="https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html" target="_blank">https://docs.aws.amazon.com/general/latest/gr/sigv4-calculate-signature.html</a> (signature calculation)?</z><z id="t1495744492" t="sb I would like to implement this lex/posttext flow, maybe with that I could solve this."><y>#</y><d>2017-05-25</d><h>20:34</h><w>sb</w>I would like to implement this lex/posttext flow, maybe with that I could solve this.</z><z id="t1495762668" t="danielcompton [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] you can probably just use the Java impl in the AWS Java libraries"><y>#</y><d>2017-05-26</d><h>01:37</h><w>danielcompton</w><a>@sb</a> you can probably just use the Java impl in the AWS Java libraries</z><z id="t1495762682" t="danielcompton although you might struggle to pull it in without bringing in loads of transitive deps"><y>#</y><d>2017-05-26</d><h>01:38</h><w>danielcompton</w>although you might struggle to pull it in without bringing in loads of transitive deps</z><z id="t1495762741" t="danielcompton There is also this you can look at https://github.com/martinklepsch/s3-beam/pull/36"><y>#</y><d>2017-05-26</d><h>01:39</h><w>danielcompton</w>There is also this you can look at <a href="https://github.com/martinklepsch/s3-beam/pull/36" target="_blank">https://github.com/martinklepsch/s3-beam/pull/36</a></z><z id="t1495765988" t="qqq [:attrs {:href &quot;/_/_/users/U2DART3HA&quot;}] : yeah, the &quot;eb ...&quot; instead of the &quot;aws ...&quot; are the tools I need"><y>#</y><d>2017-05-26</d><h>02:33</h><w>qqq</w><a>@ggaillard</a> : yeah, the &quot;eb ...&quot; instead of the &quot;aws ...&quot; are the tools I need</z><z id="t1495765997" t="qqq the aws ones work, but the &quot;eb&quot; ones are much higher level"><y>#</y><d>2017-05-26</d><h>02:33</h><w>qqq</w>the aws ones work, but the &quot;eb&quot; ones are much higher level</z><z id="t1495781270" t="sb [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] thanks, I check it! 👍"><y>#</y><d>2017-05-26</d><h>06:47</h><w>sb</w><a>@danielcompton</a> thanks, I check it!<b>👍</b></z><z id="t1495781290" t="sb I see you work on serverless things too 🙂"><y>#</y><d>2017-05-26</d><h>06:48</h><w>sb</w>I see you work on serverless things too <b>🙂</b></z><z id="t1496238896" t="singen [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] There’s a pretty easy implementation using buddy here https://github.com/sharetribe/aws-sig4/blob/master/src/aws_sig4/auth.clj"><y>#</y><d>2017-05-31</d><h>13:54</h><w>singen</w><a>@sb</a> There’s a pretty easy implementation using buddy here <a href="https://github.com/sharetribe/aws-sig4/blob/master/src/aws_sig4/auth.clj" target="_blank">https://github.com/sharetribe/aws-sig4/blob/master/src/aws_sig4/auth.clj</a></z><z id="t1496240088" t="sb [:attrs {:href &quot;/_/_/users/U27KSQZEC&quot;}] thank you for this link, very helpful! I solved now the access via CURL (I tested everything in this) what I started implement in Clojure so you shared this in the right time. 😉"><y>#</y><d>2017-05-31</d><h>14:14</h><w>sb</w><a>@singen</a> thank you for this link, very helpful! I solved now the access via CURL (I tested everything in this) what I started implement in Clojure so you shared this in the right time. <b>😉</b></z><z id="t1496240413" t="singen Np :)"><y>#</y><d>2017-05-31</d><h>14:20</h><w>singen</w>Np :)</z><z id="t1496242429" t="sb Unfortunately, that guy use so many library.. therefore the first init too slow for a lambda.."><y>#</y><d>2017-05-31</d><h>14:53</h><w>sb</w>Unfortunately, that guy use so many library.. therefore the first init too slow for a lambda..</z><z id="t1496242479" t="sb I will upload and I check it.. how much time.."><y>#</y><d>2017-05-31</d><h>14:54</h><w>sb</w>I will upload and I check it.. how much time..</z><z id="t1496601751" t="qqq what&apos;s recommended reading for figuring out how VPC / security groups work ?"><y>#</y><d>2017-06-04</d><h>18:42</h><w>qqq</w>what&apos;s recommended reading for figuring out how VPC / security groups work ?</z><z id="t1496601759" t="qqq I&apos;m seeing lots of tiny aspect tutorials"><y>#</y><d>2017-06-04</d><h>18:42</h><w>qqq</w>I&apos;m seeing lots of tiny aspect tutorials</z><z id="t1496601767" t="qqq but I really just want to understand this from the ground up part by part"><y>#</y><d>2017-06-04</d><h>18:42</h><w>qqq</w>but I really just want to understand this from the ground up part by part</z><z id="t1496652529" t="sb [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] acloud.guru?"><y>#</y><d>2017-06-05</d><h>08:48</h><w>sb</w><a>@qqq</a> acloud.guru?</z><z id="t1496652545" t="sb there is lot of course.. I don’t know.. there is VPC or not.."><y>#</y><d>2017-06-05</d><h>08:49</h><w>sb</w>there is lot of course.. I don’t know.. there is VPC or not..</z><z id="t1496657954" t="steveb8n [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] some good stuff here https://youtu.be/0VZrGo3txmA"><y>#</y><d>2017-06-05</d><h>10:19</h><w>steveb8n</w><a>@qqq</a> some good stuff here <a href="https://youtu.be/0VZrGo3txmA" target="_blank">https://youtu.be/0VZrGo3txmA</a></z><z id="t1496675875" t="ballpointcarrot [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] if you’re still looking - https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Subnets.html (wordy, but detailed)"><y>#</y><d>2017-06-05</d><h>15:17</h><w>ballpointcarrot</w><a>@qqq</a> if you’re still looking - <a href="https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Subnets.html" target="_blank">https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Subnets.html</a> (wordy, but detailed)</z><z id="t1496679657" t="qqq [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] [:attrs {:href &quot;/_/_/users/U116D37KN&quot;}] : thanks for all the resources"><y>#</y><d>2017-06-05</d><h>16:20</h><w>qqq</w><a>@sb</a> <a>@steveb8n</a> <a>@ballpointcarrot</a> : thanks for all the resources</z><z id="t1496679671" t="qqq apparently #aws is active; except for weekends"><y>#</y><d>2017-06-05</d><h>16:21</h><w>qqq</w>apparently #aws is active; except for weekends</z><z id="t1496861813" t="juliobarros I have a client with a java class they used to do custom credentials resolution and set up for fake aws services. It generates a configured aws client for each service you need. Is there a way to tell amazonica to use that client (and credentials) rather than the ones it creates and manages for you?"><y>#</y><d>2017-06-07</d><h>18:56</h><w>juliobarros</w>I have a client with a java class they used to do custom credentials resolution and set up for fake aws services. It generates a configured aws client for each service you need. Is there a way to tell amazonica to use that client (and credentials) rather than the ones it creates and manages for you?</z><z id="t1498514582" t="spieden we just released the library we wrote for AWS Step Functions, in case anyone’s interested: https://github.com/uwcpdx/stepwise"><y>#</y><d>2017-06-26</d><h>22:03</h><w>spieden</w>we just released the library we wrote for AWS Step Functions, in case anyone’s interested: <a href="https://github.com/uwcpdx/stepwise" target="_blank">https://github.com/uwcpdx/stepwise</a></z><z id="t1498731187" t="chrisblom does anyone know how to find AMI images by tag, using amazonica?"><y>#</y><d>2017-06-29</d><h>10:13</h><w>chrisblom</w>does anyone know how to find AMI images by tag, using amazonica?</z><z id="t1498731485" t="chrisblom i&apos;m able to do it using the aws cli, using aws ec2 describe-images --owners self --filters Name=tag:DeploymentSignature,Values=988tAHqBmbR3g--dST7ri4Fv7m7lOKZVEuUUOmpTQWE"><y>#</y><d>2017-06-29</d><h>10:18</h><w>chrisblom</w>i&apos;m able to do it using the aws cli, using <pre>aws ec2 describe-images --owners self --filters Name=tag:DeploymentSignature,Values=988tAHqBmbR3g--dST7ri4Fv7m7lOKZVEuUUOmpTQWE</pre></z><z id="t1498736754" t="chrisblom couldn&apos;t get it to work with amazonica, using the java sdk instead"><y>#</y><d>2017-06-29</d><h>11:45</h><w>chrisblom</w>couldn&apos;t get it to work with amazonica, using the java sdk instead</z><z id="t1498770527" t="spieden @chris if you get tired of constructing beans and want to get back to maps here’s the library we use to make clojure AWS clients with: https://github.com/uwcpdx/bean-dip/"><y>#</y><d>2017-06-29</d><h>21:08</h><w>spieden</w>@chris if you get tired of constructing beans and want to get back to maps here’s the library we use to make clojure AWS clients with: <a href="https://github.com/uwcpdx/bean-dip/" target="_blank">https://github.com/uwcpdx/bean-dip/</a></z><z id="t1498770533" t="spieden readme needs an update but basic usage is same"><y>#</y><d>2017-06-29</d><h>21:08</h><w>spieden</w>readme needs an update but basic usage is same</z><z id="t1498770553" t="spieden actually nevermind, readme is accurate to 0.5.0"><y>#</y><d>2017-06-29</d><h>21:09</h><w>spieden</w>actually nevermind, readme is accurate to 0.5.0</z><z id="t1498855761" t="candiedcode [:attrs {:href &quot;/_/_/users/U0P1MGUSX&quot;}] I tried this with amazonica and it worked for me"><y>#</y><d>2017-06-30</d><h>20:49</h><w>candiedcode</w><a>@chrisblom</a> I tried this with amazonica and it worked for me</z><z id="t1499072547" t="chrisblom [:attrs {:href &quot;/_/_/users/U1G4X90AE&quot;}] thanks!"><y>#</y><d>2017-07-03</d><h>09:02</h><w>chrisblom</w><a>@candiedcode</a> thanks!</z><z id="t1499770681" t="sb Hello, I would like to use first the Amazonica, how to add credentials … ?"><y>#</y><d>2017-07-11</d><h>10:58</h><w>sb</w>Hello, I would like to use first the Amazonica, how to add credentials … ?</z><z id="t1499771139" t="sb If I try to cat from source cat ~/.aws/credentials .. everything ok. What could be the problem?"><y>#</y><d>2017-07-11</d><h>11:05</h><w>sb</w>If I try to cat from source <code>cat ~/.aws/credentials</code> .. everything ok. What could be the problem?</z><z id="t1499771173" t="sb Could I give manually the credentials?"><y>#</y><d>2017-07-11</d><h>11:06</h><w>sb</w>Could I give manually the credentials?</z><z id="t1499771193" t="sb (without aws cli)"><y>#</y><d>2017-07-11</d><h>11:06</h><w>sb</w>(without aws cli)</z><z id="t1499788690" t="ballpointcarrot [:attrs {:href &quot;/_/_/users/U2T2ZEVPC&quot;}] check out https://github.com/mcohen01/amazonica#authentication - you can define a auth/config map, and pass that as the first argument to a call to a service, and that’ll use the provided creds."><y>#</y><d>2017-07-11</d><h>15:58</h><w>ballpointcarrot</w><a>@sb</a> check out <a href="https://github.com/mcohen01/amazonica#authentication" target="_blank">https://github.com/mcohen01/amazonica#authentication</a> - you can define a auth/config map, and pass that as the first argument to a call to a service, and that’ll use the provided creds.</z><z id="t1499788725" t="ballpointcarrot That said, if you’ve got them stored in .aws/credentials, they should be able to be read automatically without passing them (generally better, so that you’re not storing creds in your code)"><y>#</y><d>2017-07-11</d><h>15:58</h><w>ballpointcarrot</w>That said, if you’ve got them stored in .aws/credentials, they should be able to be read automatically without passing them (generally better, so that you’re not storing creds in your code)</z><z id="t1499790143" t="sb In remote mode not, I read a topic about (kinesis). Thx the help."><y>#</y><d>2017-07-11</d><h>16:22</h><w>sb</w>In remote mode not, I read a topic about (kinesis). Thx the help.</z><z id="t1499795397" t="candiedcode I&apos;m not sure what you mean by &quot;In remote mode not&quot;"><y>#</y><d>2017-07-11</d><h>17:49</h><w>candiedcode</w>I&apos;m not sure what you mean by &quot;In remote mode not&quot;</z><z id="t1499795521" t="candiedcode so here&apos;s a note I have in one of my projects. I use IAM roles in production to get AWS credentials"><y>#</y><d>2017-07-11</d><h>17:52</h><w>candiedcode</w>so here&apos;s a note I have in one of my projects.  I use IAM roles in production to get AWS credentials</z><z id="t1499795558" t="candiedcode but If I am running locally,"><y>#</y><d>2017-07-11</d><h>17:52</h><w>candiedcode</w>but If I am running locally,</z><z id="t1499795614" t="candiedcode i set AWS environment variables"><y>#</y><d>2017-07-11</d><h>17:53</h><w>candiedcode</w>i set AWS environment variables</z><z id="t1499795918" t="candiedcode just an fyi incase anyone is interested, if you have multiple AWS profiles and you want to use your .credentials file"><y>#</y><d>2017-07-11</d><h>17:58</h><w>candiedcode</w>just an fyi incase anyone is interested, if you have multiple AWS profiles and you want to use your .credentials file</z><z id="t1500456074" t="sb sorry, i see just now your response"><y>#</y><d>2017-07-19</d><h>09:21</h><r>sb</r>sorry, i see just now your response</z><z id="t1500456143" t="sb I switched computers.. and flag like read this channel. Thanks for your responses! I solved this via API setup."><y>#</y><d>2017-07-19</d><h>09:22</h><r>sb</r>I switched computers.. and flag like read this channel. Thanks for your responses! I solved this via API setup.</z><z id="t1499795950" t="candiedcode AWS_PROFILE=&quot;integrated&quot; lein run works as well"><y>#</y><d>2017-07-11</d><h>17:59</h><w>candiedcode</w><code>AWS_PROFILE=&quot;integrated&quot; lein run</code> works as well</z><z id="t1500456212" t="sb I try it, what you showed now!"><y>#</y><d>2017-07-19</d><h>09:23</h><w>sb</w>I try it, what you showed now!</z><z id="t1500630163" t="solve-calc.com I am considering switching from AWS Elastic Beanstalk to AWS Lambda. For those who are using AWS Lambda, are you writing your Lambda functions in Clojure/JVM or CLJS/Node.js ?"><y>#</y><d>2017-07-21</d><h>09:42</h><w>solve-calc.com</w>I am considering switching from AWS Elastic Beanstalk to AWS Lambda. For those who are using AWS Lambda, are you writing your Lambda functions in Clojure/JVM or CLJS/Node.js ?</z><z id="t1500680655" t="solve-calc.com [[ RESOLVED ]]"><y>#</y><d>2017-07-21</d><h>23:44</h><w>solve-calc.com</w>[[ RESOLVED ]]</z><z id="t1500751056" t="rarous Both because it depends what are your use cases."><y>#</y><d>2017-07-22</d><h>19:17</h><w>rarous</w>Both because it depends what are your use cases.</z><z id="t1500968381" t="sb I use JVM with multi-routes, because that is help keeping the lambda functions warm (JVM faster than CLJS). Sometimes.. when that is quite impossible.. I use cljs.. on nodejs or pure js code. By the way if you want to install something with shell.. then maybe better to use python (just for this function, I can’t find similar good Clojure solution)."><y>#</y><d>2017-07-25</d><h>07:39</h><w>sb</w>I use JVM with multi-routes, because that is help keeping the lambda functions warm (JVM faster than CLJS). Sometimes.. when that is quite impossible.. I use cljs.. on nodejs or pure js code. By the way if you want to install something with shell.. then maybe better to use python (just for this function, I can’t find similar good Clojure solution).</z><z id="t1500968561" t="sb ps. If you use multi-routes lambdas with API Gateway .. don’t forget max. 24 routes possible (in one lambda)."><y>#</y><d>2017-07-25</d><h>07:42</h><w>sb</w>ps. If you use multi-routes lambdas with API Gateway .. don’t forget max. 24 routes possible (in one lambda).</z><z id="t1502721087" t="richiardiandrea Has anyone got any library to deploy cljs lambdas that is not cljs-lambda ?"><y>#</y><d>2017-08-14</d><h>14:31</h><w>richiardiandrea</w>Has anyone got any library to deploy cljs lambdas that is not <code>cljs-lambda</code> ?</z><z id="t1503135783" t="qqq is there anyway to mimic lambda + aurora locally?"><y>#</y><d>2017-08-19</d><h>09:43</h><w>qqq</w>is there anyway to mimic lambda + aurora locally?</z><z id="t1503163421" t="lumengxi [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] check out this https://github.com/awslabs/aws-sam-local"><y>#</y><d>2017-08-19</d><h>17:23</h><w>lumengxi</w><a>@qqq</a> check out this <a href="https://github.com/awslabs/aws-sam-local" target="_blank">https://github.com/awslabs/aws-sam-local</a></z><z id="t1503169703" t="qqq [:attrs {:href &quot;/_/_/users/U0DTAQVT3&quot;}] : that looks really professional -- is it an official aws product ?"><y>#</y><d>2017-08-19</d><h>19:08</h><w>qqq</w><a>@lumengxi</a> : that looks really professional -- is it an official aws product ?</z><z id="t1503169765" t="lumengxi official as it is maintained by AWS? I would say yes since it is under awslabs github"><y>#</y><d>2017-08-19</d><h>19:09</h><w>lumengxi</w>official as it is maintained by AWS? I would say yes since it is under awslabs github</z><z id="t1503169777" t="lumengxi we just started trying this out, it is relatively new"><y>#</y><d>2017-08-19</d><h>19:09</h><w>lumengxi</w>we just started trying this out, it is relatively new</z><z id="t1503169782" t="lumengxi it has been working well"><y>#</y><d>2017-08-19</d><h>19:09</h><w>lumengxi</w>it has been working well</z><z id="t1503169932" t="sb interesting finding"><y>#</y><d>2017-08-19</d><h>19:12</h><w>sb</w>interesting finding</z><z id="t1503180785" t="richiardiandrea Serverless.js is a very complete package, I am also working on a lumo compiler for that. It allows local invoke."><y>#</y><d>2017-08-19</d><h>22:13</h><w>richiardiandrea</w>Serverless.js is a very complete package, I am also working on a lumo compiler for that. It allows local invoke.</z><z id="t1503181151" t="richiardiandrea Check serverless-cljs-lambda "><y>#</y><d>2017-08-19</d><h>22:19</h><w>richiardiandrea</w>Check serverless-cljs-lambda </z><z id="t1503574970" t="richiardiandrea Interesting addition to serverless-cljs-plugin : lumo compilation and no JVM required 😄 https://github.com/nervous-systems/serverless-cljs-plugin/tree/wip/lumo"><y>#</y><d>2017-08-24</d><h>11:42</h><w>richiardiandrea</w>Interesting addition to <code>serverless-cljs-plugin</code>: <code>lumo</code> compilation and no JVM required <b>😄</b> <a href="https://github.com/nervous-systems/serverless-cljs-plugin/tree/wip/lumo" target="_blank">https://github.com/nervous-systems/serverless-cljs-plugin/tree/wip/lumo</a></z><z id="t1503681081" t="ericfode +1000000"><y>#</y><d>2017-08-25</d><h>17:11</h><w>ericfode</w>+1000000</z><z id="t1504024664" t="timgilbert Say, is there an AWS API interface to do a recursive copy (like aws s3 sync )? Do people generally just shell out for this kind of thing?"><y>#</y><d>2017-08-29</d><h>16:37</h><w>timgilbert</w>Say, is there an AWS API interface to do a recursive copy (like <code>aws s3 sync  </code> )? Do people generally just shell out for this kind of thing?</z><z id="t1504103654" t="bja [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html?com/amazonaws/services/s3/transfer/TransferManager.html"><y>#</y><d>2017-08-30</d><h>14:34</h><w>bja</w><a>@timgilbert</a> <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html?com/amazonaws/services/s3/transfer/TransferManager.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/index.html?com/amazonaws/services/s3/transfer/TransferManager.html</a></z><z id="t1504103677" t="bja there&apos;s a method in TransferManager called uploadDirectory that has an optional flag to recurse into subdirectories"><y>#</y><d>2017-08-30</d><h>14:34</h><w>bja</w>there&apos;s a method in TransferManager called uploadDirectory that has an optional flag to recurse into subdirectories</z><z id="t1504887321" t="stvnmllr2 For anyone running an uberjar on an ec2 instance, behind AWS ELB, do you still put nginx in front of the app? Having a strange issue with infinite 301 redirect when trying it with ring-ssl, so thought that having nginx do the redirect might be better. It&apos;s an extra hop, but might be useful for other things i&apos;m not aware of yet."><y>#</y><d>2017-09-08</d><h>16:15</h><w>stvnmllr2</w>For anyone running an uberjar on an ec2 instance, behind AWS ELB,  do you still put nginx in front of the app? Having a strange issue with infinite 301 redirect when trying it with ring-ssl, so thought that having nginx do the redirect might be better. It&apos;s an extra hop, but might be useful for other things i&apos;m not aware of yet.</z><z id="t1504887666" t="mccraigmccraig [:attrs {:href &quot;/_/_/users/U2AAUNY7J&quot;}] i used to put nginx in front, but then i realised - there is no point"><y>#</y><d>2017-09-08</d><h>16:21</h><w>mccraigmccraig</w><a>@stvnmllr2</a> i used to put nginx in front, but then i realised - there is no point</z><z id="t1504887677" t="mccraigmccraig but i use the ELB to do the ssl termination"><y>#</y><d>2017-09-08</d><h>16:21</h><w>mccraigmccraig</w>but i use the ELB to do the ssl termination</z><z id="t1504887700" t="stvnmllr2 and how do you redirect from http to https?"><y>#</y><d>2017-09-08</d><h>16:21</h><w>stvnmllr2</w>and how do you redirect from http to https?</z><z id="t1504887780" t="mccraigmccraig i don&apos;t - the only port i have open is 443 - this is an API - all the html/js/css is static/SPA and served from s3/cloudfront, and cloudfront does the http-&gt;https redirect for free"><y>#</y><d>2017-09-08</d><h>16:23</h><w>mccraigmccraig</w>i don&apos;t - the only port i have open is 443 - this is an API - all the html/js/css is static/SPA and served from  s3/cloudfront, and cloudfront does the http-&gt;https redirect for free</z><z id="t1504887993" t="stvnmllr2 [:attrs {:href &quot;/_/_/users/U0524B4UW&quot;}] That sounds fun. I guess i could do that as well. Just more learning of aws first 🙂"><y>#</y><d>2017-09-08</d><h>16:26</h><w>stvnmllr2</w><a>@mccraigmccraig</a> That sounds fun. I guess i could do that as well. Just more learning of aws first <b>🙂</b></z><z id="t1504888051" t="mccraigmccraig oh, one final detail - we are using classic ELB, because history, and to get websockets to work we use ELB as a TCP proxy rather than an HTTP proxy... i think the newer ELB version says it will proxy websockets ok, but i haven&apos;t tried it"><y>#</y><d>2017-09-08</d><h>16:27</h><w>mccraigmccraig</w>oh, one final detail - we are using classic ELB, because history, and to get websockets to work we use ELB as a TCP proxy rather than an HTTP proxy... i think the newer ELB version says it will proxy websockets ok, but i haven&apos;t tried it</z><z id="t1504888314" t="mccraigmccraig cloudfront is pretty straightforward - it will proxy different paths to origins like S3 or your API as you configure, you can terminate ssl with it, do http-&gt;https redirect, and set caching policies for your different origins"><y>#</y><d>2017-09-08</d><h>16:31</h><w>mccraigmccraig</w>cloudfront is pretty straightforward - it will proxy different paths to origins like S3 or your API as you configure, you can terminate ssl with it, do http-&gt;https redirect, and set caching policies for your different origins</z><z id="t1504888385" t="stvnmllr2 guessing there is no lein task to bundle up static resources for me? To upload to s3"><y>#</y><d>2017-09-08</d><h>16:33</h><w>stvnmllr2</w>guessing there is no lein task to bundle up static resources for me? To upload to s3</z><z id="t1504888502" t="mccraigmccraig that&apos;s on my todo - i was looking at - https://github.com/martinklepsch/s3-beam , &apos;cos we use boot for building cljs stuff"><y>#</y><d>2017-09-08</d><h>16:35</h><w>mccraigmccraig</w>that&apos;s on my todo - i was looking at - <a href="https://github.com/martinklepsch/s3-beam" target="_blank">https://github.com/martinklepsch/s3-beam</a> , &apos;cos we use boot for building cljs stuff</z><z id="t1504888547" t="mccraigmccraig hmm. that&apos;s not what i was meaning to post"><y>#</y><d>2017-09-08</d><h>16:35</h><w>mccraigmccraig</w>hmm. that&apos;s not what i was meaning to post</z><z id="t1504888590" t="mccraigmccraig ah, it was this - https://github.com/martinklepsch/boot-s3"><y>#</y><d>2017-09-08</d><h>16:36</h><w>mccraigmccraig</w>ah, it was this - <a href="https://github.com/martinklepsch/boot-s3" target="_blank">https://github.com/martinklepsch/boot-s3</a></z><z id="t1504888604" t="mccraigmccraig but that refs https://github.com/kanej/lein-s3-sync so you may be in luck"><y>#</y><d>2017-09-08</d><h>16:36</h><w>mccraigmccraig</w>but that refs <a href="https://github.com/kanej/lein-s3-sync" target="_blank">https://github.com/kanej/lein-s3-sync</a> so you may be in luck</z><z id="t1504888758" t="stvnmllr2 nice. thx."><y>#</y><d>2017-09-08</d><h>16:39</h><w>stvnmllr2</w>nice. thx.</z><z id="t1504888777" t="bja I never used a lein task, we just use awscli via aws s3 cp ..."><y>#</y><d>2017-09-08</d><h>16:39</h><w>bja</w>I never used a lein task, we just use <code>awscli</code> via <code>aws s3 cp ...</code></z><z id="t1504888861" t="stvnmllr2 and what do you use to gather the static resources together? Might be obvious, but it&apos;s all new to me"><y>#</y><d>2017-09-08</d><h>16:41</h><w>stvnmllr2</w>and what do you use to gather the static resources together? Might be obvious, but it&apos;s all new to me</z><z id="t1504889299" t="mccraigmccraig our boot build compiles cljs, less and gathers all resources into an output dir"><y>#</y><d>2017-09-08</d><h>16:48</h><w>mccraigmccraig</w>our boot build compiles cljs, less and gathers all resources into an output dir</z><z id="t1504889346" t="mccraigmccraig i started with https://github.com/martinklepsch/tenzing and iterated from there"><y>#</y><d>2017-09-08</d><h>16:49</h><w>mccraigmccraig</w>i started with <a href="https://github.com/martinklepsch/tenzing" target="_blank">https://github.com/martinklepsch/tenzing</a> and iterated from there</z><z id="t1504891044" t="andrewhr [:attrs {:href &quot;/_/_/users/U2AAUNY7J&quot;}] for SPA deployments, I just put everything inside a single directory (using things like the cljsbuild ‘s :output-to ) then aws s3 sync like [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] mentioned. The end result was pretty clean and integrates well with my CI (I use CircleCI for instance)"><y>#</y><d>2017-09-08</d><h>17:17</h><w>andrewhr</w><a>@stvnmllr2</a> for SPA deployments, I just put everything inside a single directory (using things like the <code>cljsbuild</code>‘s <code>:output-to</code>) then <code>aws s3 sync</code> like <a>@bja</a> mentioned. The end result was pretty clean and integrates well with my CI (I use CircleCI for instance)</z><z id="t1504891445" t="stvnmllr2 Thanks [:attrs {:href &quot;/_/_/users/U051EUEUM&quot;}] , Still not sure i&apos;ll end up down the s3 road, but I&apos;ll definitely look into it. Doubt it&apos;d be that hard to put the output together manually even, but thought I&apos;d ask."><y>#</y><d>2017-09-08</d><h>17:24</h><w>stvnmllr2</w>Thanks <a>@andrewhr</a>, Still not sure i&apos;ll end up down the s3 road, but I&apos;ll definitely look into it. Doubt it&apos;d be that hard to put the output together manually even, but thought I&apos;d ask.</z><z id="t1504903442" t="timgilbert I also use aws s3 sync . I was using lein-essthree for a while, which is nice because it also handles the &quot;put your shared libraries onto S3&quot; bit of Clojure development, but it seems to be abandonware so we&apos;re moving off of it"><y>#</y><d>2017-09-08</d><h>20:44</h><w>timgilbert</w>I also use <code>aws s3 sync</code>. I was using <code>lein-essthree</code> for a while, which is nice because it also handles the &quot;put your shared libraries onto S3&quot; bit of Clojure development, but it seems to be abandonware so we&apos;re moving off of it</z><z id="t1505262394" t="nfisher I actually commit my libraries to a /libs folder in each project and :offline? true. Improves build times, minimises dependency on other pieces of infra (e.g. Nexus, Clojars, etc), and means everyone has the same build experience."><y>#</y><d>2017-09-13</d><h>00:26</h><w>nfisher</w>I actually commit my libraries to a /libs folder in each project and :offline? true. Improves build times, minimises dependency on other pieces of infra (e.g. Nexus, Clojars, etc), and means everyone has the same build experience.</z><z id="t1505505946" t="pandeiro Curious to hear any opinions on approaches to log aggregation (sys/app/custom) from AWS-hosted systems; anyone using CloudWatch? Amazon&apos;s hosted ES? Trying to understand the benefits/drawbacks to using Amazon&apos;s offerings vs other service providers (eg Splunk, Sumo Logic)."><y>#</y><d>2017-09-15</d><h>20:05</h><w>pandeiro</w>Curious to hear any opinions on approaches to log aggregation (sys/app/custom) from AWS-hosted systems; anyone using CloudWatch? Amazon&apos;s hosted ES? Trying to understand the benefits/drawbacks to using Amazon&apos;s offerings vs other service providers (eg Splunk, Sumo Logic).</z><z id="t1505748801" t="jakemcc CloudWatch logs works fine. Generally pretty straightforward to setup. It is what I would start with again if I were setting up log aggregation from scratch. It works well enough."><y>#</y><d>2017-09-18</d><h>15:33</h><r>jakemcc</r>CloudWatch logs works fine. Generally pretty straightforward to setup. It is what I would start with again if I were setting up log aggregation from scratch. It works well enough.</z><z id="t1505749045" t="jakemcc I haven’t used ES + things on top for log aggregation before though. I have used Splunk and really enjoyed it too. I moved to CloudWatch when I started a new company and wanted to get something up and running that had minimal moving parts and fit well with the AWS ecosystem. I’d make the same choice again."><y>#</y><d>2017-09-18</d><h>15:37</h><r>jakemcc</r>I haven’t used ES + things on top for log aggregation before though. I have used Splunk and really enjoyed it too. I moved to CloudWatch when I started a new company and wanted to get something up and running that had minimal moving parts and fit well with the AWS ecosystem. I’d make the same choice again.</z><z id="t1505776585" t="timgilbert At my company we are using http://logz.io (basically hosted ELK stack) for aggregation, it works fine but there are a bunch of deployment hoops to jump through to get it to work on AWS that I&apos;d just as soon avoid. I find the CloudWatch UI to be aesthetically not very appealing. I&apos;ve heard good things from other people though."><y>#</y><d>2017-09-18</d><h>23:16</h><r>timgilbert</r>At my company we are using <a href="http://logz.io" target="_blank">http://logz.io</a> (basically hosted ELK stack) for aggregation, it works fine but there are a bunch of deployment hoops to jump through to get it to work on AWS that I&apos;d just as soon avoid. I find the CloudWatch UI to be aesthetically not very appealing. I&apos;ve heard good things from other people though.</z><z id="t1505925657" t="pandeiro Thanks for the feedback, much appreciated."><y>#</y><d>2017-09-20</d><h>16:40</h><r>pandeiro</r>Thanks for the feedback, much appreciated.</z><z id="t1505531278" t="danielcompton I know Paul deGrandis recommends CloudWatch if you&apos;re already on AWS"><y>#</y><d>2017-09-16</d><h>03:07</h><w>danielcompton</w>I know Paul deGrandis recommends CloudWatch if you&apos;re already on AWS</z><z id="t1505531290" t="danielcompton OTOH I know others who really don&apos;t like it"><y>#</y><d>2017-09-16</d><h>03:08</h><w>danielcompton</w>OTOH I know others who really don&apos;t like it</z><z id="t1505745844" t="hlolli hi all, I&apos;m useing s3 for the first time, better late than never. I have a profile in ~/.aws/credentials (eg [my-profile] \n aws_access_key_id= .. etc..) but when I want to put an object on my s3 bucket, it&apos;s as if my credentials aren&apos;t found Unhandled com.amazonaws.SdkClientException Unable to load AWS credentials from any provider in the chain my command with amazonica is (s3/put-object :bucket-name &quot;hlolli&quot; :key &quot;throwme&quot; :file userscript-file) "><y>#</y><d>2017-09-18</d><h>14:44</h><w>hlolli</w>hi all, I&apos;m useing s3 for the first time, better late than never. I have a profile in ~/.aws/credentials (eg [my-profile] \n aws_access_key_id= .. etc..) but when I want to put an object on my s3 bucket, it&apos;s as if my credentials aren&apos;t found
<pre>Unhandled com.amazonaws.SdkClientException
   Unable to load AWS credentials from any provider in the chain
</pre>
my command with amazonica is
<pre>(s3/put-object :bucket-name &quot;hlolli&quot;
               :key &quot;throwme&quot;
               :file userscript-file)
</pre></z><z id="t1505746892" t="hlolli ah ok, I have to defcredentials and I can look it up from my profile via (def bucket-credentials (.getCredentials (amazonica.core/get-credentials {:profile &quot;my-profile&quot;}))) not so well documented (found this via issues)."><y>#</y><d>2017-09-18</d><h>15:01</h><w>hlolli</w>ah ok, I have to defcredentials and I can look it up from my profile via
<pre>(def bucket-credentials
  (.getCredentials
   (amazonica.core/get-credentials {:profile &quot;my-profile&quot;})))
</pre>
not so well documented (found this via issues).</z><z id="t1505751102" t="bja also, if you use com.amazonaws.auth.DefaultAWSCredentialsProviderChain you&apos;ll end up looking up in ~/.aws/credentials"><y>#</y><d>2017-09-18</d><h>16:11</h><w>bja</w>also, if you use <code>com.amazonaws.auth.DefaultAWSCredentialsProviderChain</code> you&apos;ll end up looking up in ~/.aws/credentials</z><z id="t1505751110" t="bja unsure if amazonica uses that under the hood or not (probably does)"><y>#</y><d>2017-09-18</d><h>16:11</h><w>bja</w>unsure if amazonica uses that under the hood or not (probably does)</z><z id="t1505821513" t="hlolli how does one put object into bucket that&apos;s public by default with amazonica?"><y>#</y><d>2017-09-19</d><h>11:45</h><w>hlolli</w>how does one put object into bucket that&apos;s public by default with amazonica?</z><z id="t1505821842" t="hlolli to answer my own question :access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;]} works. Hopefully there&apos;s no write access here."><y>#</y><d>2017-09-19</d><h>11:50</h><w>hlolli</w>to answer my own question
<code>:access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;]}</code> works. Hopefully there&apos;s no write access here.</z><z id="t1507205141" t="juliobarros Anybody have an Amazon Lex example working? Does Amazonica support it?"><y>#</y><d>2017-10-05</d><h>12:05</h><w>juliobarros</w>Anybody have an Amazon Lex example working? Does Amazonica support it?</z><z id="t1508298002" t="phinneas So is anybody here very familiar with /cdn-cgi/l/email-protection"><y>#</y><d>2017-10-18</d><h>03:40</h><w>phinneas</w>So is anybody here very familiar with <a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a></z><z id="t1508416385" t="chrisblom I have a question about amazonica: what the proper way to pass the content-length to s3/put-object?"><y>#</y><d>2017-10-19</d><h>12:33</h><w>chrisblom</w>I have a question about amazonica: what the proper way to pass the content-length to s3/put-object?</z><z id="t1508417400" t="msolli I do something like this: (s3/put-object {:metadata {:cache-control &quot;public,max-age:31536000,immutable&quot; ; One year :content-length content-length :content-type content-type} :bucket-name bucket-name ; etc. }) "><y>#</y><d>2017-10-19</d><h>12:50</h><w>msolli</w>I do something like this:
<pre>(s3/put-object
  {:metadata {:cache-control  &quot;public,max-age:31536000,immutable&quot; ; One year
              :content-length content-length
              :content-type   content-type}
   :bucket-name bucket-name
   ; etc.
})
</pre></z><z id="t1508423882" t="cgore Does anyone know if https://github.com/ptaoussanis/faraday is still alive? Or is someone else planning on picking it up?"><y>#</y><d>2017-10-19</d><h>14:38</h><w>cgore</w>Does anyone know if <a href="https://github.com/ptaoussanis/faraday" target="_blank">https://github.com/ptaoussanis/faraday</a> is still alive?  Or is someone else planning on picking it up?</z><z id="t1508423921" t="cgore Or is everyone just migrating to Amazonica or something else for DynamoDB?"><y>#</y><d>2017-10-19</d><h>14:38</h><w>cgore</w>Or is everyone just migrating to Amazonica or something else for DynamoDB?</z><z id="t1508639806" t="qqq is amazon elasti cache / redis always inmemory, or does it page stuff lke dbs ?"><y>#</y><d>2017-10-22</d><h>02:36</h><w>qqq</w>is amazon elasti cache / redis always inmemory, or does it page stuff lke dbs ?</z><z id="t1508654206" t="danielcompton [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] that&apos;s an incredibly vague question about serialisation, you&apos;ll need to give more context"><y>#</y><d>2017-10-22</d><h>06:36</h><w>danielcompton</w><a>@qqq</a> that&apos;s an incredibly vague question about serialisation, you&apos;ll need to give more context</z><z id="t1508654241" t="danielcompton Pretty sure elasticache is memory only by default. https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/RedisAOF.html"><y>#</y><d>2017-10-22</d><h>06:37</h><w>danielcompton</w>Pretty sure elasticache is memory only by default. <a href="https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/RedisAOF.html" target="_blank">https://docs.aws.amazon.com/AmazonElastiCache/latest/UserGuide/RedisAOF.html</a></z><z id="t1508676204" t="qqq [:attrs {:href &quot;/_/_/users/U051KLSJF&quot;}] : I called up aws business support; they agree with you -- elastic cache is in memory only so far"><y>#</y><d>2017-10-22</d><h>12:43</h><w>qqq</w><a>@danielcompton</a>: I called up aws business support; they agree with you -- elastic cache is in memory only so far</z><z id="t1508859752" t="qqq is there an amazonica/s3 builtin for &quot;rsyncing an directory to s3&quot; ?"><y>#</y><d>2017-10-24</d><h>15:42</h><w>qqq</w>is there an amazonica/s3 builtin for &quot;rsyncing an directory to s3&quot; ?</z><z id="t1508859764" t="qqq I see the put-object get-object files, but I want to do it to entire dir not a single object"><y>#</y><d>2017-10-24</d><h>15:42</h><w>qqq</w>I see the put-object get-object files, but I want to do it to entire dir not a single object</z><z id="t1508859882" t="qqq in particular, I&apos;m looking for the amazonica equiv of &apos;aws sync&apos;"><y>#</y><d>2017-10-24</d><h>15:44</h><w>qqq</w>in particular, I&apos;m looking for the amazonica equiv of &apos;aws sync&apos;</z><z id="t1508884218" t="bja yes"><y>#</y><d>2017-10-24</d><h>22:30</h><w>bja</w>yes</z><z id="t1508884296" t="bja https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html"><y>#</y><d>2017-10-24</d><h>22:31</h><w>bja</w><a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html</a></z><z id="t1508884346" t="bja there is an .uploadDirectory() and .uploadFileList()"><y>#</y><d>2017-10-24</d><h>22:32</h><w>bja</w>there is an .uploadDirectory() and .uploadFileList()</z><z id="t1508884475" t="bja it&apos;s not quite aws sync since it&apos;ll overwrite stuff that is already there. if you need aws sync I suggest just shelling out to it. I do that for deployments and I&apos;ve heard of several others doing the same thing."><y>#</y><d>2017-10-24</d><h>22:34</h><w>bja</w>it&apos;s not quite <code>aws sync</code> since it&apos;ll overwrite stuff that is already there. if you need <code>aws sync</code> I suggest just shelling out to it. I do that for deployments and I&apos;ve heard of several others doing the same thing.</z><z id="t1508960898" t="timgilbert Yeah, I shell out to aws sync , the TransferManager stuff seemed a little baroque for me"><y>#</y><d>2017-10-25</d><h>19:48</h><w>timgilbert</w>Yeah, I shell out to <code>aws sync</code>, the TransferManager stuff seemed a little baroque for me</z><z id="t1508965270" t="qqq [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] : I ended up using &quot;aws sync&quot; -- thanks!"><y>#</y><d>2017-10-25</d><h>21:01</h><w>qqq</w><a>@bja</a>  <a>@timgilbert</a>: I ended up using &quot;aws sync&quot; -- thanks!</z><z id="t1509041986" t="qqq I&apos;m trying to decide between using RDS Aurora vs DynamoDB. I have read a few blog posts + watched a few youtube videos. What would really help me would be seeing a list of sample apps, and how they would be implemented in Aurora / DynamoDB (or maybe only one of the two). Is there a list of this somewhere? (The impl does not have to be CLJS -- plain JS is fine -- I just need to see when Aurora is used vs when DynamoDB is used.)"><y>#</y><d>2017-10-26</d><h>18:19</h><w>qqq</w>I&apos;m trying to decide between using RDS Aurora vs DynamoDB. I have read a few blog posts + watched a few youtube videos.

What would really help me would be seeing a list of sample apps, and how they would be implemented in Aurora / DynamoDB (or maybe only one of the two).

Is there a list of this somewhere? (The impl does not have to be CLJS -- plain JS is fine -- I just need to see when Aurora is used vs when DynamoDB is used.)</z><z id="t1509090507" t="iaint Aurora is (more or less) an AWS-branded MySQL, i.e. a traditional relational database. Dynamo is basically an enhanced key-value store, optimised for manipulating JSON documents."><y>#</y><d>2017-10-27</d><h>07:48</h><w>iaint</w>Aurora is (more or less) an AWS-branded MySQL, i.e. a traditional relational database. Dynamo is basically an enhanced key-value store, optimised for manipulating JSON documents.</z><z id="t1509090539" t="iaint I&apos;m not sure there&apos;s much in the way of direct comparison of &quot;This app uses Aurora, This app uses Dynamo&quot; because every use-case should be deciding very early on if it needs a relational database model or not"><y>#</y><d>2017-10-27</d><h>07:48</h><w>iaint</w>I&apos;m not sure there&apos;s much in the way of direct comparison of &quot;This app uses Aurora, This app uses Dynamo&quot; because every use-case should be deciding very early on if it needs a relational database model or not</z><z id="t1509131046" t="qqq [:attrs {:href &quot;/_/_/users/U78960W3B&quot;}] : in theory, I agree with you, in practice, there are all these blog posts about &quot;we switched from aurora to dynamodb&quot; or &quot;we switched from dynamodb to aurora&quot; -- so in practice, it appears many apps can be designed either way"><y>#</y><d>2017-10-27</d><h>19:04</h><w>qqq</w><a>@iain.tatch</a>: in theory, I agree with you, in practice, there are all these blog posts about &quot;we switched from aurora to dynamodb&quot; or &quot;we switched from dynamodb to aurora&quot; -- so in practice, it appears many apps can be designed either way</z><z id="t1509179386" t="mccraigmccraig &quot;needs a relational database model&quot; is a difficult concept - you can often do just enough in non-relational stores to avoid needing a relational store e.g. cassandra doesn&apos;t support joins, but will sort by a key, so if you need a join you can merge streams of records sorted by the join key. similarly ES doesn&apos;t support joins, but a bit of denormalisation lets you use nested objects for many of the queries you might use a join for"><y>#</y><d>2017-10-28</d><h>08:29</h><w>mccraigmccraig</w>&quot;needs a relational database model&quot; is a difficult concept - you can often do just enough in non-relational stores to avoid needing a relational store e.g. cassandra doesn&apos;t support joins, but will sort by a key, so if you need a join you can merge streams of records sorted by the join key. similarly ES doesn&apos;t support joins, but a bit of denormalisation lets you use nested objects for many of the queries you might use a join for</z><z id="t1509179553" t="mccraigmccraig relational dbs shine for arbitrary ad-hoc analytic queries, but even there - i have spark in front of cassandra which effectively exposes an odbc interface to cassandra - boundaries are blurred"><y>#</y><d>2017-10-28</d><h>08:32</h><w>mccraigmccraig</w>relational dbs shine for arbitrary ad-hoc analytic queries, but even there - i have spark in front of cassandra which effectively exposes an odbc interface to cassandra - boundaries are blurred</z><z id="t1509179666" t="mccraigmccraig https://aws.amazon.com/blogs/big-data/analyze-your-data-on-amazon-dynamodb-with-apache-spark/"><y>#</y><d>2017-10-28</d><h>08:34</h><w>mccraigmccraig</w><a href="https://aws.amazon.com/blogs/big-data/analyze-your-data-on-amazon-dynamodb-with-apache-spark/" target="_blank">https://aws.amazon.com/blogs/big-data/analyze-your-data-on-amazon-dynamodb-with-apache-spark/</a></z><z id="t1509179707" t="mccraigmccraig https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/RedshiftforDynamoDB.html"><y>#</y><d>2017-10-28</d><h>08:35</h><w>mccraigmccraig</w><a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/RedshiftforDynamoDB.html" target="_blank">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/RedshiftforDynamoDB.html</a></z><z id="t1509235084" t="qqq some articles claim: relational is good for doing adhoc-queries, nonsql-denormalized-views is good for when you know your queries before hand question: when you&apos;re designing an webapp, how can you possibly NOT know your queries before hand? unless you&apos;re allowing users to specify arbitrary queries (seems like bad idea), you should always know queries beforehand -- what am I missing ?"><y>#</y><d>2017-10-28</d><h>23:58</h><w>qqq</w>some articles claim: relational is good for doing adhoc-queries, nonsql-denormalized-views is good for when you know your queries before hand

question: when you&apos;re designing an webapp, how can you possibly NOT know your queries before hand? unless you&apos;re allowing users to specify arbitrary queries (seems like bad idea), you should always know queries beforehand -- what am I missing ?</z><z id="t1509266207" t="dottedmag [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] Evolution of the application."><y>#</y><d>2017-10-29</d><h>08:36</h><w>dottedmag</w><a>@qqq</a> Evolution of the application.</z><z id="t1509266234" t="dottedmag Also, denormalized means headaches during updates (hello two-phase commits)."><y>#</y><d>2017-10-29</d><h>08:37</h><w>dottedmag</w>Also, denormalized means headaches during updates (hello two-phase commits).</z><z id="t1509371567" t="bja [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] my users would be very unhappy with me if I told them they could only build rigidly defined segments. I know most of their query patterns (and log/instrument everything for analysis), but they are constantly coming up with fancier ways of segmenting our users. It&apos;s nice that I can enable business to be very flexible with the way they use my system."><y>#</y><d>2017-10-30</d><h>13:52</h><w>bja</w><a>@qqq</a> my users would be very unhappy with me if I told them they could only build rigidly defined segments. I know most of their query patterns (and log/instrument everything for analysis), but they are constantly coming up with fancier ways of segmenting our users. It&apos;s nice that I can enable business to be very flexible with the way they use my system.</z><z id="t1509376422" t="qqq [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] : what does your software do? when I look at fb, pinterest, snapchat, slack, evernote, instagram, whatsapp;, it seems all their queries are well defined beforehand"><y>#</y><d>2017-10-30</d><h>15:13</h><w>qqq</w><a>@bja</a>: what does your software do? when I look at fb, pinterest, snapchat, slack, evernote, instagram, whatsapp;, it seems all their queries are well defined beforehand</z><z id="t1509376628" t="bja the end-users of my system have very well-defined queries against elasticsearch"><y>#</y><d>2017-10-30</d><h>15:17</h><w>bja</w>the end-users of my system have very well-defined queries against elasticsearch</z></g><g id="s4"><z id="t1509376689" t="bja the business users of the admin/analytics system want flexible ways to segment user behavior so that we can better personalize emails, push messages, and offer promotions"><y>#</y><d>2017-10-30</d><h>15:18</h><w>bja</w>the business users of the admin/analytics system want flexible ways to segment user behavior so that we can better personalize emails, push messages, and offer promotions</z><z id="t1509391339" t="qqq ah, so you&apos;re writing business intelligence / analytics software (for which adhoc queries makes sense), not consumer facing apps"><y>#</y><d>2017-10-30</d><h>19:22</h><w>qqq</w>ah, so you&apos;re writing business intelligence / analytics software (for which adhoc queries makes sense), not consumer facing apps</z><z id="t1509506699" t="richiardiandrea Newbie question, can I send SQL queries to Aurora using Javascript? Is there a service for that in the SDK, I am planning to use honeysql in lumo in order to produce the statements"><y>#</y><d>2017-11-01</d><h>03:24</h><w>richiardiandrea</w>Newbie question, can I send SQL queries to Aurora using Javascript? Is there a service for that in the SDK, I am planning to use <code>honeysql</code> in <code>lumo</code> in order to produce the statements</z><z id="t1509508368" t="richiardiandrea Well, I found https://github.com/brianc/node-postgres I will try it out"><y>#</y><d>2017-11-01</d><h>03:52</h><w>richiardiandrea</w>Well, I found <a href="https://github.com/brianc/node-postgres" target="_blank">https://github.com/brianc/node-postgres</a> I will try it out</z><z id="t1510344555" t="qqq is there a playlist of AWS OFFICIAL aws videos ? I want to youtube-dl a bunch and have them on background playlist"><y>#</y><d>2017-11-10</d><h>20:09</h><w>qqq</w>is there a playlist of AWS OFFICIAL aws videos ? I want to youtube-dl a bunch and have them on background playlist</z><z id="t1510344941" t="qqq https://www.youtube.com/playlist?list=PLhr1KZpdzukcMmx04RbtWuQ0yYOp1vQi4 &lt;-- what I was looking for"><y>#</y><d>2017-11-10</d><h>20:15</h><w>qqq</w><a href="https://www.youtube.com/playlist?list=PLhr1KZpdzukcMmx04RbtWuQ0yYOp1vQi4" target="_blank">https://www.youtube.com/playlist?list=PLhr1KZpdzukcMmx04RbtWuQ0yYOp1vQi4</a> &lt;-- what I was looking for</z><z id="t1510863929" t="qqq 1. Why does https://calculator.s3.amazonaws.com/index.html not include lambda ? 2. Are there other tools useful for estimating costs on AWS ?"><y>#</y><d>2017-11-16</d><h>20:25</h><w>qqq</w>1. Why does <a href="https://calculator.s3.amazonaws.com/index.html" target="_blank">https://calculator.s3.amazonaws.com/index.html</a> not include lambda ?

2. Are there other tools useful for estimating costs on AWS ?</z><z id="t1511392870" t="qmrw anyone here using amazonica?"><y>#</y><d>2017-11-22</d><h>23:21</h><w>qmrw</w>anyone here using amazonica?</z><z id="t1511423137" t="msolli Yes, I’m using it for S3 stuff."><y>#</y><d>2017-11-23</d><h>07:45</h><w>msolli</w>Yes, I’m using it for S3 stuff.</z><z id="t1511481478" t="qqq is there an aws lambda/java cookbook somewhere ?I&apos;m looking for a list of all AWS API calls: for example, here&apos;s how to send an email via SES"><y>#</y><d>2017-11-23</d><h>23:57</h><w>qqq</w>is there an aws lambda/java cookbook somewhere ?I&apos;m looking for a list of all AWS API calls: for example, here&apos;s how to send an email via SES</z><z id="t1511485910" t="ricardosllm Any clojurians heading to re:Invent next week? hit me up if you would like to meet 😸"><y>#</y><d>2017-11-24</d><h>01:11</h><w>ricardosllm</w>Any clojurians heading to re:Invent next week? hit me up if you would like to meet <b>😸</b></z><z id="t1511501474" t="valtteri [:attrs {:href &quot;/_/_/users/U3JURM9B6&quot;}] Node.js sdk documentation lists all AWS API calls in a clear way. https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/ I checked Java SDK docs but it’s horrible because you’d need to find the actual operations from the class-jungle. Node sdk is pretty much all about the operations (= actual API calls)."><y>#</y><d>2017-11-24</d><h>05:31</h><w>valtteri</w><a>@qqq</a> Node.js sdk documentation lists all AWS API calls in a clear way. <a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/" target="_blank">https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/</a> 

I checked Java SDK docs but it’s horrible because you’d need to find the actual operations from the class-jungle. Node sdk is pretty much all about the operations (= actual API calls).</z><z id="t1511501660" t="valtteri CLI docs is another option https://docs.aws.amazon.com/cli/latest/index.html# (this is actually even better)"><y>#</y><d>2017-11-24</d><h>05:34</h><w>valtteri</w>CLI docs is another option <a href="https://docs.aws.amazon.com/cli/latest/index.html#" target="_blank">https://docs.aws.amazon.com/cli/latest/index.html#</a> (this is actually even better)</z><z id="t1511501858" t="valtteri All the SDK’s and the CLI generate API-call to AWS.. With Java-sdk you probably need to use boilerplate such as builders and factories to construct and invoke the requests but the params are the same."><y>#</y><d>2017-11-24</d><h>05:37</h><w>valtteri</w>All the SDK’s and the CLI generate API-call to AWS.. With Java-sdk you probably need to use boilerplate such as builders and factories to construct and invoke the requests but the params are the same.</z><z id="t1511501995" t="valtteri And what comes to SES in particular.. You need to create a ‘sandbox’ environment in SES and verify recipient address before you can send any email."><y>#</y><d>2017-11-24</d><h>05:39</h><w>valtteri</w>And what comes to SES in particular.. You need to create a ‘sandbox’ environment in SES and verify recipient address before you can send any email.</z><z id="t1511502019" t="qqq I&apos;m new to this: cli documentatio n referring to cli man pages right ? node documentation = how does this help me if I&apos;m using Clojure ? is the idea to read the node documentation, guess the relevant Java class names, and use Clojure from there ?"><y>#</y><d>2017-11-24</d><h>05:40</h><w>qqq</w>I&apos;m new to this:

cli documentatio n referring to cli man pages right ?

node documentation = how does this help me if I&apos;m using Clojure ? is the idea to read the node documentation, guess the relevant Java class names, and use Clojure from there ?</z><z id="t1511502060" t="valtteri Yep, that’s what I would probably do because Java docs look pretty terrible."><y>#</y><d>2017-11-24</d><h>05:41</h><w>valtteri</w>Yep, that’s what I would probably do because Java docs look pretty terrible.</z><z id="t1511502103" t="valtteri And yes, cli documentation == man pages"><y>#</y><d>2017-11-24</d><h>05:41</h><w>valtteri</w>And yes, cli documentation == man pages</z><z id="t1511502122" t="qqq Interesting. I will try this. Thanks!"><y>#</y><d>2017-11-24</d><h>05:42</h><w>qqq</w>Interesting. I will try this. Thanks!</z><z id="t1511502162" t="valtteri I can help you with setting up SES.. Since I just did it a few weeks ago myself."><y>#</y><d>2017-11-24</d><h>05:42</h><w>valtteri</w>I can help you with setting up SES.. Since I just did it a few weeks ago myself.</z><z id="t1511502188" t="qqq wonderful -- could I take a rain check on this? 1. I&apos;m in the middle of hacking client side GUI right now and"><y>#</y><d>2017-11-24</d><h>05:43</h><w>qqq</w>wonderful -- could I take a rain check on this?

1. I&apos;m in the middle of hacking client side GUI right now and</z><z id="t1511502199" t="qqq 2. I&apos;m waiting on response from AWS Business Support Engineer"><y>#</y><d>2017-11-24</d><h>05:43</h><w>qqq</w>2. I&apos;m waiting on response from AWS Business Support Engineer</z><z id="t1511502266" t="valtteri Yep, sure!"><y>#</y><d>2017-11-24</d><h>05:44</h><w>valtteri</w>Yep, sure!</z><z id="t1511503192" t="valtteri In case someone else needs this: the solution was to use this to send the email https://github.com/mcohen01/amazonica#simpleemail"><y>#</y><d>2017-11-24</d><h>05:59</h><w>valtteri</w>In case someone else needs this: the solution was to use this to send the email <a href="https://github.com/mcohen01/amazonica#simpleemail" target="_blank">https://github.com/mcohen01/amazonica#simpleemail</a></z><z id="t1511974645" t="cgore We needed to update AWS libraries here at work but faraday development seems to have stopped, so I’ve rolled a personal v1.9.1 that just updates the dependencies over the upstream v1.9.0 and nothing else ( https://github.com/cgore/faraday [com.cgore/faraday &quot;1.9.1&quot;] ). If you are in the same boat it might help you too, and hopefully faraday development doesn’t stop permanently, it’s a great library."><y>#</y><d>2017-11-29</d><h>16:57</h><w>cgore</w>We needed to update AWS libraries here at work but faraday development seems to have stopped, so I’ve rolled a personal v1.9.1 that just updates the dependencies over the upstream v1.9.0 and nothing else (<a href="https://github.com/cgore/faraday" target="_blank">https://github.com/cgore/faraday</a> <code> [com.cgore/faraday &quot;1.9.1&quot;]</code>).  If you are in the same boat it might help you too, and hopefully faraday development doesn’t stop permanently, it’s a great library.</z><z id="t1512144812" t="stvnmllr2 What&apos;s the easiest way to run a nightly job on aws? I have a clojure webapp I&apos;m running currently. But don&apos;t know enough about devops to know the best way. Would have run a spring chron service pre-cloud."><y>#</y><d>2017-12-01</d><h>16:13</h><w>stvnmllr2</w>What&apos;s the easiest way to run a nightly job on aws? I have a clojure webapp I&apos;m running currently. But don&apos;t know enough about devops to know the best way.  Would have run a spring chron service pre-cloud.</z><z id="t1512144832" t="stvnmllr2 The job just sends out daily emails"><y>#</y><d>2017-12-01</d><h>16:13</h><w>stvnmllr2</w>The job just sends out daily emails</z><z id="t1512145210" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U2AAUNY7J&quot;}] there is a new cron-like trigger for lambda I think now"><y>#</y><d>2017-12-01</d><h>16:20</h><w>richiardiandrea</w><a>@stvnmllr2</a> there is a new cron-like trigger for lambda I think now</z><z id="t1512145265" t="stvnmllr2 yeah. I saw that I think. But apparently lambda doesn&apos;t easily talk to RDS?"><y>#</y><d>2017-12-01</d><h>16:21</h><w>stvnmllr2</w>yeah. I saw that I think. But apparently lambda doesn&apos;t easily talk to RDS?</z><z id="t1512145303" t="stvnmllr2 I did think of having the lambda job just call a url in my webapp that would then do the work. But seemed there had to be a better way."><y>#</y><d>2017-12-01</d><h>16:21</h><w>stvnmllr2</w>I did think of having the lambda job just call a url in my webapp that would then do the work. But seemed there had to be a better way.</z><z id="t1512145709" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U2AAUNY7J&quot;}] no? I am using node-postgres pretty well. True no connection pool but...it works.. depending on what performance you want to get .."><y>#</y><d>2017-12-01</d><h>16:28</h><w>richiardiandrea</w><a>@stvnmllr2</a> no? I am using <code>node-postgres</code> pretty well. True no connection pool but...it works.. depending on what performance you want to get ..</z><z id="t1512145844" t="stvnmllr2 Ok, I&apos;ll look down that road (though with java), performance is not a big deal in this case since it&apos;s a background thing. If anyone else has any non-lambda ideas, even if it&apos;s old school. let me know. thanks [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}]"><y>#</y><d>2017-12-01</d><h>16:30</h><w>stvnmllr2</w>Ok, I&apos;ll look down that road (though with java),  performance is not a big deal in this case since it&apos;s a background thing.  If anyone else has any non-lambda ideas, even if it&apos;s old school. let me know.  thanks <a>@richiardiandrea</a></z><z id="t1512149160" t="valtteri Lambda is the easiest and cheapest way to run scheduled jobs on AWS. If lambda is not optimal to execute your job then you can use the lambda just to invoke some other service that can run your stuff (AWS Batch for instance)."><y>#</y><d>2017-12-01</d><h>17:26</h><w>valtteri</w>Lambda is the easiest and cheapest way to run scheduled jobs on AWS. If lambda is not optimal to execute your job then you can use the lambda just to invoke some other service that can run your stuff (AWS Batch for instance).</z><z id="t1512488676" t="stvnmllr2 Thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] . Sort of what I was thinking. Appreciate the input."><y>#</y><d>2017-12-05</d><h>15:44</h><w>stvnmllr2</w>Thanks <a>@valtteri</a>. Sort of what I was thinking. Appreciate the input.</z><z id="t1512489383" t="plins Hello everyone, I’m having problems while using sqs… I have a queue with 100+ msgs and receive-message always returns the first SAME 10 msgs"><y>#</y><d>2017-12-05</d><h>15:56</h><w>plins</w>Hello everyone, I’m having problems while using sqs… I have a queue with 100+ msgs and <code>receive-message</code> always returns the first SAME 10 msgs</z><z id="t1512489438" t="plins after the first successful read the latter calls returns an empty list"><y>#</y><d>2017-12-05</d><h>15:57</h><w>plins</w>after the first successful read the latter calls returns an empty list</z><z id="t1512489798" t="valtteri Are you using some library or just making calls to SQS API with aws-sdk?"><y>#</y><d>2017-12-05</d><h>16:03</h><w>valtteri</w>Are you using some library or just making calls to SQS API with aws-sdk?</z><z id="t1512490124" t="valtteri I’m guessing that you’re not deleting messages from the queue after reading and therefore you’ll receive the same messages again and again. After you’ve successfully read the message, you have to tell SQS to delete the message from the queue (using receipt handle). See https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-message-lifecycle.html and https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ReceiveMessage.html"><y>#</y><d>2017-12-05</d><h>16:08</h><w>valtteri</w>I’m guessing that you’re not deleting messages from the queue after reading and therefore you’ll receive the same messages again and again. After you’ve successfully read the message, you have to tell SQS to delete the message from the queue (using receipt handle). See <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-message-lifecycle.html" target="_blank">https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-message-lifecycle.html</a> and <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ReceiveMessage.html" target="_blank">https://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ReceiveMessage.html</a></z><z id="t1512508760" t="Geoffrey Gaillard Hello ! I have a cluster of EC2 instances and I&apos;d like to broadcast messages between them. Redis pubsub feature is exactly what I need, but do any of you know a better &quot;clojure way&quot; ? I mean sending a copy of the message to every machines on the cluster except the sender itself. Besides it seems Redis pubsub do not scale linearly with cluster size…"><y>#</y><d>2017-12-05</d><h>21:19</h><w>Geoffrey Gaillard</w>Hello !
I have a cluster of EC2 instances and I&apos;d like to broadcast messages between them. Redis pubsub feature is exactly what I need, but do any of you know a better &quot;clojure way&quot; ? I mean sending a copy of the message to every machines on the cluster except the sender itself. Besides it seems Redis pubsub do not scale linearly with cluster size…</z><z id="t1512545870" t="valtteri [:attrs {:href &quot;/_/_/users/U2DART3HA&quot;}] How about https://github.com/mcohen01/amazonica#sns ? You could create a topic and subscribe to it in each instance. You can include “publisher” in the message attributes so you can make the publisher ignore messages from itself. If you just need pub/sub and you’re on AWS, I recommend SNS because it’s completely managed."><y>#</y><d>2017-12-06</d><h>07:37</h><w>valtteri</w><a>@ggaillard</a> How about <a href="https://github.com/mcohen01/amazonica#sns" target="_blank">https://github.com/mcohen01/amazonica#sns</a> ? You could create a topic and subscribe to it in each instance. You can include “publisher” in the message attributes so you can make the publisher ignore messages from itself. If you just need pub/sub and you’re on AWS, I recommend SNS because it’s completely managed.</z><z id="t1512558683" t="Geoffrey Gaillard I didn&apos;t knew sns supported this use case ! Thank you 🙂"><y>#</y><d>2017-12-06</d><h>11:11</h><w>Geoffrey Gaillard</w>I didn&apos;t knew sns supported this use case ! Thank you <b>🙂</b></z><z id="t1512579580" t="plins [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] , Im using amazonica and i suspect that theres a shared/cached AWS*Client, so all my threads are using the same client … not sure if there is an option to turn it off … ill try using the interop with java and create the client myself"><y>#</y><d>2017-12-06</d><h>16:59</h><w>plins</w><a>@valtteri</a>, Im using <code>amazonica</code> and i suspect that theres a shared/cached AWS*Client, so all my threads are using the same client … not sure if there is an option to turn it off … ill try using the interop with java and create the client myself</z><z id="t1512589848" t="valtteri [:attrs {:href &quot;/_/_/users/U3QUAHZJ6&quot;}] I’m sorry I don’t know Amazonica internals well enough to help you. Maybe someone else here knows if there’s a nice way to instantiate more clients?"><y>#</y><d>2017-12-06</d><h>19:50</h><w>valtteri</w><a>@plins</a> I’m sorry I don’t know Amazonica internals well enough to help you. Maybe someone else here knows if there’s a nice way to instantiate more clients?</z><z id="t1512591087" t="plins the reason I suspect this is on the docs Note: The first function called (for each distinct AWS service namespace, e.g. amazonica.aws.ec2) creates an Amazon*Client, which is effectively cached via memoization. Therefore, if you explicitly pass different credentials maps to different functions, you will effectively have different Clients."><y>#</y><d>2017-12-06</d><h>20:11</h><w>plins</w>the reason I suspect this is on the docs
<code>Note: The first function called (for each distinct AWS service namespace, e.g. amazonica.aws.ec2) creates an Amazon*Client, which is effectively cached via memoization. Therefore, if you explicitly pass different credentials maps to different functions, you will effectively have different Clients.</code></z><z id="t1512591143" t="plins there should be a better way beside creating one credential per thread (or the java approach)"><y>#</y><d>2017-12-06</d><h>20:12</h><w>plins</w>there should be a better way beside creating one credential per thread (or the <code>java</code> approach)</z><z id="t1513572076" t="qqq 1. I am not building Chatroulette. 2. If we were to build Chatroulete, it is possible to do so using only AWS Serverless? (if we uwe WebRTC, and both clients are behind NATs, we need stun servers -- I don&apos;t know if there is a way around this)"><y>#</y><d>2017-12-18</d><h>04:41</h><w>qqq</w>1. I am not building Chatroulette.
2. If we were to build Chatroulete, it is possible to do so using only AWS Serverless? (if we uwe WebRTC, and both clients are behind NATs, we need stun servers -- I don&apos;t know if there is a way around this)</z><z id="t1514403241" t="plins :W"><y>#</y><d>2017-12-27</d><h>19:34</h><w>plins</w>:W</z><z id="t1515028701" t="ghadi anyone here deploy to lambda but not AOTed?"><y>#</y><d>2018-01-04</d><h>01:18</h><w>ghadi</w>anyone here deploy to lambda but not AOTed?</z><z id="t1515028755" t="qqq how would that work? lambda loads up clojureinterpreter on every function invocation?"><y>#</y><d>2018-01-04</d><h>01:19</h><w>qqq</w>how would that work? lambda loads up clojureinterpreter on every function invocation?</z><z id="t1515029097" t="ghadi you could have a java method that implemented the right interface, with a static initializer that resolved the proper var, once."><y>#</y><d>2018-01-04</d><h>01:24</h><w>ghadi</w>you could have a java method that implemented the right interface, with a static initializer that resolved the proper var, once.</z><z id="t1515029123" t="ghadi (clojure doesn’t have an interpreter, btw)"><y>#</y><d>2018-01-04</d><h>01:25</h><w>ghadi</w>(clojure doesn’t have an interpreter, btw)</z><z id="t1515030739" t="qqq so whenever a lambda container is created, during the initialiaztion step, the clojure compiler is loaded"><y>#</y><d>2018-01-04</d><h>01:52</h><w>qqq</w>so whenever a lambda container is created, during the initialiaztion step, the clojure compiler is loaded</z><z id="t1515030752" t="qqq then at every function call, it recompiles your clojure code and runs it ?"><y>#</y><d>2018-01-04</d><h>01:52</h><w>qqq</w>then at every function call, it recompiles your clojure code and runs it ?</z><z id="t1515030768" t="qqq what flexibility does this buy you over AOT ?"><y>#</y><d>2018-01-04</d><h>01:52</h><w>qqq</w>what flexibility does this buy you over AOT ?</z><z id="t1515031437" t="ghadi slow down, that’s not what I meant."><y>#</y><d>2018-01-04</d><h>02:03</h><w>ghadi</w>slow down, that’s not what I meant.</z><z id="t1515031467" t="ghadi when the lambda deployment is spun up, it calls a single class that calls the clojure compiler once."><y>#</y><d>2018-01-04</d><h>02:04</h><w>ghadi</w>when the lambda deployment is spun up, it calls a single class that calls the clojure compiler once.</z><z id="t1515033711" t="qqq are you saying: 1. at container creation time: load clojure compiler, compile clojure code 2. at each function call, invoke already-compiled bytecode ?"><y>#</y><d>2018-01-04</d><h>02:41</h><w>qqq</w>are you saying:
1. at container creation time: load clojure compiler, compile clojure code
2. at each function call, invoke already-compiled bytecode
?</z><z id="t1515033723" t="qqq if so, what additional flexibility does this gain over plain AOT ?"><y>#</y><d>2018-01-04</d><h>02:42</h><w>qqq</w>if so, what additional flexibility does this gain over plain AOT ?</z><z id="t1515407748" t="Viktor Hi, has anyone used the amazonica library to sync files to S3? I’m trying to do the amazonica client equivalent to aws s3 sync with no luck.. I think I need to use the equivalent of this https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html#uploadDirectory-java.lang.String-java.lang.String-java.io.File-boolean- but I can’t figure out how that would look in amazonica…"><y>#</y><d>2018-01-08</d><h>10:35</h><w>Viktor</w>Hi, has anyone used the amazonica library to sync files to S3? I’m trying to do the amazonica client equivalent to <code>aws s3 sync</code> with no luck.. I think I need to use the equivalent of this <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html#uploadDirectory-java.lang.String-java.lang.String-java.io.File-boolean-" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/s3/transfer/TransferManager.html#uploadDirectory-java.lang.String-java.lang.String-java.io.File-boolean-</a> but I can’t figure out how that would look in amazonica…</z><z id="t1515426487" t="bja I&apos;ve never done it with Amazonica, but I used TransferManager directly and it was straight-foward. I stopped doing that because aws s3 sync was less complex (via a shell call)."><y>#</y><d>2018-01-08</d><h>15:48</h><w>bja</w>I&apos;ve never done it with Amazonica, but I used TransferManager directly and it was straight-foward. I stopped doing that because aws s3 sync was less complex (via a shell call).</z><z id="t1515426704" t="Viktor [:attrs {:href &quot;/_/_/users/U0K0TFQLW&quot;}] thanks, I’ll try that! 🙂 Was originally using shell as well but trying to make it not depend on things being installed on the host"><y>#</y><d>2018-01-08</d><h>15:51</h><w>Viktor</w><a>@bja</a> thanks, I’ll try that! <b>🙂</b> Was originally using shell as well but trying to make it not depend on things being installed on the host</z><z id="t1515439125" t="podviaznikov [:attrs {:href &quot;/_/_/users/U8QEVBC87&quot;}] checkout https://github.com/hashobject/boot-s3 and https://github.com/kanej/lein-s3-sync . Maybe you will find some relevant code"><y>#</y><d>2018-01-08</d><h>19:18</h><w>podviaznikov</w><a>@viktor.holmberg</a> checkout <a href="https://github.com/hashobject/boot-s3" target="_blank">https://github.com/hashobject/boot-s3</a> and <a href="https://github.com/kanej/lein-s3-sync" target="_blank">https://github.com/kanej/lein-s3-sync</a>. Maybe you will find some relevant code</z><z id="t1515442942" t="Viktor Thank [:attrs {:href &quot;/_/_/users/U050K462N&quot;}] ! I had a look through them and they’re both implementing the aws s3 sync functionality from scratch which is cool. But in the end I didn’t have that many files to sync, so I decided to just upload them all each time, overwriting them on the server each time. Not pretty but did the job for me!"><y>#</y><d>2018-01-08</d><h>20:22</h><w>Viktor</w>Thank <a>@podviaznikov</a>!  I had a look through them and they’re both implementing the aws s3 sync functionality from scratch which is cool. But in the end I didn’t have that many files to sync, so I decided to just upload them all each time, overwriting them on the server each time. Not pretty but did the job for me!</z><z id="t1515558690" t="timgilbert Yeah, there’s no built-in aws sync API, and the transfer API is unwieldy IMHO. I usually just shell out to aws sync when I need to deal with whole directory trees"><y>#</y><d>2018-01-10</d><h>04:31</h><w>timgilbert</w>Yeah, there’s no built-in aws sync API, and the transfer API is unwieldy IMHO. I usually just shell out to <code>aws sync</code> when I need to deal with whole directory trees</z><z id="t1515598438" t="Viktor [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] thanks, looks like that will be the way to go once I have enough files to upload that it gets annoying 🙂"><y>#</y><d>2018-01-10</d><h>15:33</h><w>Viktor</w><a>@timgilbert</a> thanks, looks like that will be the way to go once I have enough files to upload that it gets annoying <b>🙂</b></z><z id="t1515686986" t="ghadi Anyone know what latency is like on step functions between lambdas?"><y>#</y><d>2018-01-11</d><h>16:09</h><w>ghadi</w>Anyone know what latency is like on step functions between lambdas?</z><z id="t1515690583" t="valtteri Dunno, but I’m interested to know once you find out. :) I’d also like to know how’s the developer experience."><y>#</y><d>2018-01-11</d><h>17:09</h><w>valtteri</w>Dunno, but I’m interested to know once you find out. :) I’d also like to know how’s the developer experience.</z><z id="t1515777961" t="lilactown does anyone know how I can find out what packages are installed in Lambda?"><y>#</y><d>2018-01-12</d><h>17:26</h><w>lilactown</w>does anyone know how I can find out what packages are installed in Lambda?</z><z id="t1515777987" t="lilactown I’m getting errors trying to use ANTLR4 and I’m worried that AWS has their own version laying around somewhere"><y>#</y><d>2018-01-12</d><h>17:26</h><w>lilactown</w>I’m getting errors trying to use ANTLR4 and I’m worried that AWS has their own version laying around somewhere</z><z id="t1518053719" t="fedreg Needed an EC2 IAM policy set up. ☝️ Clear as day from the error message."><y>#</y><d>2018-02-08</d><h>01:35</h><w>fedreg</w>Needed an EC2 IAM policy set up.   <b>☝️</b> Clear as day from the error message.</z><z id="t1518449842" t="fabrao Hello all, is that possible to run my web application in aws?"><y>#</y><d>2018-02-12</d><h>15:37</h><w>fabrao</w>Hello all, is that possible to run my web application in aws?</z><z id="t1518464396" t="bja yes\"><y>#</y><d>2018-02-12</d><h>19:39</h><w>bja</w>yes\</z><z id="t1518464461" t="bja I&apos;ve used elastic beanstalk, alb/elb+ec2, and docker (ecs) all without much fanfare. No real difference from running java or python. I&apos;ve heard some people claim success with Lambda and API Gateway, although I haven&apos;t used those myself."><y>#</y><d>2018-02-12</d><h>19:41</h><w>bja</w>I&apos;ve used elastic beanstalk, alb/elb+ec2, and docker (ecs) all without much fanfare. No real difference from running java or python. I&apos;ve heard some people claim success with Lambda and API Gateway, although I haven&apos;t used those myself.</z><z id="t1519345473" t="Rohit Thadani hi, is this the right place to talk about the amazonica library?"><y>#</y><d>2018-02-23</d><h>00:24</h><w>Rohit Thadani</w>hi, is this the right place to talk about the amazonica library?</z><z id="t1519398906" t="alexk Plausible"><y>#</y><d>2018-02-23</d><h>15:15</h><w>alexk</w>Plausible</z><z id="t1520368427" t="donmullen What’s the preferred way to deploy clojure web servers to aws elastic beanstalk? https://github.com/ktgit/lein-elastic-beanstalk is very old and uses aws jdk 1.6.10 — latest is 1.11.x."><y>#</y><d>2018-03-06</d><h>20:33</h><w>donmullen</w>What’s the preferred way to deploy clojure web servers to aws elastic beanstalk?   <a href="https://github.com/ktgit/lein-elastic-beanstalk" target="_blank">https://github.com/ktgit/lein-elastic-beanstalk</a> is very old and uses aws jdk 1.6.10 — latest is 1.11.x.</z><z id="t1520368899" t="alexk I just did this last month - I packaged with ohpauleez/lein-pedestal and deployed with some custom Python scripts that I call from CircleCI"><y>#</y><d>2018-03-06</d><h>20:41</h><w>alexk</w>I just did this last month - I packaged with ohpauleez/lein-pedestal and deployed with some custom Python scripts that I call from CircleCI</z><z id="t1520368984" t="alexk I was forced to use lein-pedestal because….pedestal"><y>#</y><d>2018-03-06</d><h>20:43</h><w>alexk</w>I was forced to use lein-pedestal because….pedestal</z><z id="t1520408640" t="msolli [:attrs {:href &quot;/_/_/users/U09AQ4KB2&quot;}] We’re deploying using AWS Codebuild and CodePipeline: 1. On Git push, Codebuild runs tests and builds an uberjar, which is put in an S3 bucket. 2. CodePipeline picks up the jar and deploys it in your EB environment using whatever update strategy you’ve configured."><y>#</y><d>2018-03-07</d><h>07:44</h><w>msolli</w><a>@donmullen</a> We’re deploying using AWS Codebuild and CodePipeline:
1. On Git push, Codebuild runs tests and builds an uberjar, which is put in an S3 bucket.
2. CodePipeline picks up the jar and deploys it in your EB environment using whatever update strategy you’ve configured.</z><z id="t1520439599" t="donmullen I have a simple sample project up and running on AWS Elastic Beanstalk and would like to access Datomic Cloud. I’m relatively new to AWS — how straight-forward will it be to give my server access? Any pointers into sample configurations for beanstalk and/or docs before I dive in this afternoon? Being new to AWS - how realistic is it for me to ramp up and get connected today? AWS docs are pretty dense! I liked how straight-foward it was to get datomic cloud up an running locally - any similar guide available for a sample app running in elastic beanstalk to access Datomic Cloud? Cross posted to #datomic."><y>#</y><d>2018-03-07</d><h>16:19</h><w>donmullen</w>I have a simple sample project up and running on AWS Elastic Beanstalk and would like to access Datomic Cloud. I’m relatively new to AWS — how straight-forward will it be to give my server access? Any pointers into sample configurations for beanstalk and/or docs before I dive in this afternoon? Being new to AWS - how realistic is it for me to ramp up and get connected today? AWS docs are pretty dense! I liked how straight-foward it was to get datomic cloud up an running locally - any similar guide available for a sample app running in elastic beanstalk to access Datomic Cloud?  Cross posted to #datomic.</z><z id="t1520515185" t="maleghast Does anyone in here have any experience with the Byzantine process one has to go through to initiate manual snapshots of the AWS managed ElasticSearch service?"><y>#</y><d>2018-03-08</d><h>13:19</h><w>maleghast</w>Does anyone in here have any experience with the Byzantine process one has to go through to initiate manual snapshots of the AWS managed ElasticSearch service?</z><z id="t1520515215" t="maleghast I&apos;ve followed the documentation VERY carefully, twice, and I cannot get the request signing portion of the setup to work 😞"><y>#</y><d>2018-03-08</d><h>13:20</h><w>maleghast</w>I&apos;ve followed the documentation VERY carefully, twice, and I cannot get the request signing portion of the setup to work <b>😞</b></z><z id="t1520515275" t="maleghast I keep getting: b&apos;{&quot;Message&quot;:&quot;Cross-account pass role is not allowed.&quot;}&apos; "><y>#</y><d>2018-03-08</d><h>13:21</h><w>maleghast</w>I keep getting:
<pre>b&apos;{&quot;Message&quot;:&quot;Cross-account pass role is not allowed.&quot;}&apos;
</pre></z><z id="t1522166841" t="yogidevbear Hi everyone 👋 Not really a Clojure question, but more of an AWS-specific query. Does anyone here have experience with AWS ELB / auto-scaling and deploying code updates across load balanced instances? We&apos;ve been experimenting with CodeDeploy, CodePipeline and CodeBuild, but we&apos;re not quite getting the expected end result. I feel like we&apos;re missing a step somewhere to tell AWS to fetch our code from GitHub and potentially run a few other bash scripts, etc."><y>#</y><d>2018-03-27</d><h>16:07</h><w>yogidevbear</w>Hi everyone <b>👋</b> Not really a Clojure question, but more of an AWS-specific query. Does anyone here have experience with AWS ELB / auto-scaling and deploying code updates across load balanced instances? We&apos;ve been experimenting with CodeDeploy, CodePipeline and CodeBuild, but we&apos;re not quite getting the expected end result. I feel like we&apos;re missing a step somewhere to tell AWS to fetch our code from GitHub and potentially run a few other bash scripts, etc.</z><z id="t1522167654" t="danm Hmm. So you have a standard AMI and on startup it loads the code you want?"><y>#</y><d>2018-03-27</d><h>16:20</h><w>danm</w>Hmm. So you have a standard AMI and on startup it loads the code you want?</z><z id="t1522167757" t="danm I&apos;m probably not going to be so useful here 😞 We run an in-house system that bakes new AMI snapshots for code deploys, so the component comes online and already has the code in place, init scripts to run it on boot etc. Deploying a new version is a case of baking a new AMI and then doing a rolling update of all the instances to use the new AMI snapshot using CloudFormation"><y>#</y><d>2018-03-27</d><h>16:22</h><w>danm</w>I&apos;m probably not going to be so useful here <b>😞</b> We run an in-house system that bakes new AMI snapshots for code deploys, so the component comes online and already has the code in place, init scripts to run it on boot etc. Deploying a new version is a case of baking a new AMI and then doing a rolling update of all the instances to use the new AMI snapshot using CloudFormation</z><z id="t1522167788" t="yogidevbear I&apos;ve created an EBS backed AMI which would be used in the auto scaling process"><y>#</y><d>2018-03-27</d><h>16:23</h><w>yogidevbear</w>I&apos;ve created an EBS backed AMI which would be used in the auto scaling process</z><z id="t1522167854" t="yogidevbear And I need to run some steps to build and deploy an Angular app and an API to the var/.../... folders"><y>#</y><d>2018-03-27</d><h>16:24</h><w>yogidevbear</w>And I need to run some steps to build and deploy an Angular app and an API to the var/.../... folders</z><z id="t1522167910" t="yogidevbear Same update steps would need to be run code code commits in the git repos"><y>#</y><d>2018-03-27</d><h>16:25</h><w>yogidevbear</w>Same update steps would need to be run code code commits in the git repos</z><z id="t1522167926" t="yogidevbear For existing instances already running"><y>#</y><d>2018-03-27</d><h>16:25</h><w>yogidevbear</w>For existing instances already running</z><z id="t1522168000" t="danm Aah yeah, different pattern. We would bake the app and API pre-installed into the AMI, then just use EBS volumes for log storage or data or similar. So new code = new AMI, kill and replace the instances in the ASG X at a time"><y>#</y><d>2018-03-27</d><h>16:26</h><w>danm</w>Aah yeah, different pattern. We would bake the app and API pre-installed into the AMI, then just use EBS volumes for log storage or data or similar. So new code = new AMI, kill and replace the instances in the ASG X at a time</z><z id="t1522239462" t="yogidevbear Has anyone here made use of AWS CodeDeploy and app spec files? ( https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file.html )"><y>#</y><d>2018-03-28</d><h>12:17</h><w>yogidevbear</w>Has anyone here made use of AWS CodeDeploy and app spec files? (<a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file.html" target="_blank">https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file.html</a>)</z><z id="t1522348251" t="nfisher We use it at work with python code. I’ve setup CI with CodeBuild but not had the occasion to dig into CodeDeploy"><y>#</y><d>2018-03-29</d><h>18:30</h><w>nfisher</w>We use it at work with python code. I’ve setup CI with CodeBuild but not had the occasion to dig into CodeDeploy</z><z id="t1522348413" t="nfisher I would suggest you build a fat jar and push that to S3 or similar. Beanstalk ain’t pretty but it’s pretty effective for handling deployments, restarts, os updates, and logical groupings of apps."><y>#</y><d>2018-03-29</d><h>18:33</h><w>nfisher</w>I would suggest you build a fat jar and push that to S3 or similar. Beanstalk ain’t pretty but it’s pretty effective for handling deployments, restarts, os updates, and logical groupings of apps.</z><z id="t1522348456" t="nfisher Jar in CodeBuild and then use codedeploy to publish/deploy into Beanstalk or an env"><y>#</y><d>2018-03-29</d><h>18:34</h><w>nfisher</w>Jar in CodeBuild and then use codedeploy to publish/deploy into Beanstalk or an env</z><z id="t1522432221" t="sb Yes, I think so similar. Create instances with rsync /S3, and deploy to s3. With that ASG/Load balancer you can setup triggers and np. You can sync both way s3 (eg just SQLite things, cloudfront dir) or use db to store things"><y>#</y><d>2018-03-30</d><h>17:50</h><w>sb</w>Yes, I think so similar. Create instances with rsync /S3, and deploy to s3. With that ASG/Load balancer you can setup triggers and np. You can sync both way s3  (eg just SQLite things, cloudfront dir) or use db to store things</z><z id="t1522432505" t="sb I think, you didn’t use rsync —-delete or similar command plus a “cron job”"><y>#</y><d>2018-03-30</d><h>17:55</h><w>sb</w>I think, you didn’t use rsync —-delete or similar command plus a “cron job”</z><z id="t1522432590" t="sb But I don’t know that is helpful or not for you."><y>#</y><d>2018-03-30</d><h>17:56</h><w>sb</w>But I don’t know that is helpful or not for you.</z><z id="t1522436553" t="richiardiandrea Has anybody had experience with appending to S3 files continuously? I see one would need to read + append + write and I was wondering how slow that can be. Of course it depends on the payload and the goal is to split in sizeable ones, just was interested in understanding what are baseline numbers..."><y>#</y><d>2018-03-30</d><h>19:02</h><w>richiardiandrea</w>Has anybody had experience with appending to S3 files continuously? I see one would need to read + append + write and I was wondering how slow that can be. Of course it depends on the payload and the goal is to split in sizeable ones, just was interested in understanding what are baseline numbers...</z><z id="t1522475259" t="sb I didnt use with large files continuously. What I saw as a setup 50Mb/sec per thread (parallel processing, x20). I don’t know that is true or not, single process up to 100-150Mb/sec. depend on regions etc, and without pre-checkings.. maybe with data loss (?) in this case"><y>#</y><d>2018-03-31</d><h>05:47</h><w>sb</w>I didnt use with large files continuously. What I saw as a setup 50Mb/sec per thread (parallel processing, x20). I don’t know that is true or not, single process up to 100-150Mb/sec. depend on regions etc, and without pre-checkings.. maybe with data loss (?) in this case</z><z id="t1522789681" t="timgilbert [:attrs {:href &quot;/_/_/users/U0MFQNXFZ&quot;}] late reply, but we were trying to use AWS CodeDeploy to deploy Clojure code for a while and we basically hated it and ditched it. It seems to be kind of a weird forgotten stepchild in the AWS infrastructure, which for some reason has like 15 different solutions to deploy code, each with weird light variations."><y>#</y><d>2018-04-03</d><h>21:08</h><w>timgilbert</w><a>@yogidevbear</a> late reply, but we were trying to use AWS CodeDeploy to deploy Clojure code for a while and we basically hated it and ditched it. It seems to be kind of a weird forgotten stepchild in the AWS infrastructure, which for some reason has like 15 different solutions to deploy code, each with weird light variations.</z><z id="t1522789903" t="timgilbert What we do currently is build plain-vanilla uberjars from our CI env (CircleCI) and then load them into Elastic Beanstalk instances running the &quot;Java SE&quot; stack, which works fine and is not super complex. We were also experimenting with building Docker containers with the jars in them for a while, but getting compose to work locally wound up being too annoying for us because of {:tag :a, :attrs {:href &quot;/cdn-cgi/l/email-protection&quot;, :class &quot;__cf_email__&quot;, :data-cfemail &quot;433d03312622302c2d30&quot;}, :content (&quot;[email protected]&quot;)} ."><y>#</y><d>2018-04-03</d><h>21:11</h><w>timgilbert</w>What we do currently is build plain-vanilla uberjars from our CI env (CircleCI) and then load them into Elastic Beanstalk instances running the &quot;Java SE&quot; stack, which works fine and is not super complex. We were also experimenting with building Docker containers with the jars in them for a while, but getting compose to work locally wound up being too annoying for us because of <code>{:tag :a, :attrs {:href &quot;/cdn-cgi/l/email-protection&quot;, :class &quot;__cf_email__&quot;, :data-cfemail &quot;433d03312622302c2d30&quot;}, :content (&quot;[email protected]&quot;)}</code>.</z><z id="t1522790050" t="timgilbert I filed this ticket about CodeDeploy back in June 2016, it&apos;s indicative of the general care that AWS seems to have put into CodeDeploy: https://github.com/aws/aws-codedeploy-agent/issues/64"><y>#</y><d>2018-04-03</d><h>21:14</h><w>timgilbert</w>I filed this ticket about CodeDeploy back in June 2016, it&apos;s indicative of the general care that AWS seems to have put into CodeDeploy: <a href="https://github.com/aws/aws-codedeploy-agent/issues/64" target="_blank">https://github.com/aws/aws-codedeploy-agent/issues/64</a></z><z id="t1522792012" t="yogidevbear Thanks for the feedback [:attrs {:href &quot;/_/_/users/U08QZ7Y5S&quot;}] . Really appreciate it. I must admit that CodeDeploy does seem like it&apos;s not quite there in terms of doing what it says on the tin."><y>#</y><d>2018-04-03</d><h>21:46</h><w>yogidevbear</w>Thanks for the feedback <a>@timgilbert</a>. Really appreciate it. I must admit that CodeDeploy does seem like it&apos;s not quite there in terms of doing what it says on the tin.</z><z id="t1522792320" t="timgilbert We&apos;ve been reasonably happy with Elastic Beanstalk, it has its own little command-line tool eb which is handy for prototyping / debugging deployment stuff. There&apos;s still a large configuration/management overhead for it which might be easier to deal with via terraform or a similar project"><y>#</y><d>2018-04-03</d><h>21:52</h><w>timgilbert</w>We&apos;ve been reasonably happy with Elastic Beanstalk, it has its own little command-line tool <code>eb</code> which is handy for prototyping / debugging deployment stuff. There&apos;s still a large configuration/management overhead for it which might be easier to deal with via terraform or a similar project</z><z id="t1522832509" t="lloydshark We are in a slightly different boat in that we are entirely lambda based - no ec2. But we had a similar experience in that we tried codebuild / codepipeline / codedeploy combination(s) but found it a bit opaque and it didn&apos;t meet our needs. We ended up going with a very simple layering over the CloudFormation apis via the aws python sdk."><y>#</y><d>2018-04-04</d><h>09:01</h><w>lloydshark</w>We are in a slightly different boat in that we are entirely lambda based - no ec2.  But we had a similar experience in that we tried codebuild / codepipeline / codedeploy combination(s) but found it a bit opaque and it didn&apos;t meet our needs. We ended up going with a very simple layering over the CloudFormation apis via the aws python sdk.</z><z id="t1523379539" t="nfisher CodeBuild has been going through some changes. Up until November you couldn’t launch the build agents inside of a VPC. It’s still tricky to get it working. The easiest (but least secure) way to get it running is using the non-VPC configuration. We have reserved RDS instances that are public facing and restricted to the CodeBuild Network range that allow us to run our tests."><y>#</y><d>2018-04-10</d><h>16:58</h><w>nfisher</w>CodeBuild has been going through some changes. Up until November you couldn’t launch the build agents inside of a VPC. It’s still tricky to get it working. The easiest (but least secure) way to get it running is using the non-VPC configuration. We have reserved RDS instances that are public facing and restricted to the CodeBuild Network range that allow us to run our tests.</z><z id="t1523436180" t="danm [:attrs {:href &quot;/_/_/users/U4T99SHSB&quot;}] How do you find Clojure in Lambdas. I had heard the slow startup time caused issues"><y>#</y><d>2018-04-11</d><h>08:43</h><w>danm</w><a>@lloydshark</a> How do you find Clojure in Lambdas. I had heard the slow startup time caused issues</z><z id="t1523439259" t="lloydshark [:attrs {:href &quot;/_/_/users/U6SUWNB9N&quot;}] Hasn&apos;t been an issue for us. The Clojure lambdas we use for &quot;backend&quot; asynchronous processing. ie Responding to files landing in s3 / listening to dynamo streams etc."><y>#</y><d>2018-04-11</d><h>09:34</h><w>lloydshark</w><a>@carr0t</a> Hasn&apos;t been an issue for us. The Clojure lambdas we use for &quot;backend&quot; asynchronous processing. ie Responding to files landing in s3 / listening to dynamo streams etc.</z><z id="t1523439311" t="lloydshark The lambdas that are connected to our UI are written in javascript as they were more sensitive to startup time."><y>#</y><d>2018-04-11</d><h>09:35</h><w>lloydshark</w>The lambdas that are connected to our UI are written in javascript as they were more sensitive to startup time.</z><z id="t1523439537" t="lloydshark I personally have done some experimentation with ClojureScript on node (for Lambda), but it hasn&apos;t gone any further than that yet."><y>#</y><d>2018-04-11</d><h>09:38</h><w>lloydshark</w>I personally have done some experimentation with ClojureScript on node (for Lambda), but it hasn&apos;t gone any further than that yet.</z><z id="t1523440168" t="danm Fair enough"><y>#</y><d>2018-04-11</d><h>09:49</h><w>danm</w>Fair enough</z><z id="t1523457489" t="richiardiandrea I am using cljs lambdas with great results, behind API gateways, super smooth and no issues. I am using the Serverless Framework"><y>#</y><d>2018-04-11</d><h>14:38</h><w>richiardiandrea</w>I am using cljs lambdas with great results, behind API gateways, super smooth and no issues. I am using the Serverless Framework</z><z id="t1523912714" t="richiardiandrea Is there a way to produce cloud formation through data? At the repl or something?"><y>#</y><d>2018-04-16</d><h>21:05</h><w>richiardiandrea</w>Is there a way to produce cloud formation through data? At the repl or something?</z><z id="t1523932131" t="mynomoto [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] is something like https://github.com/brabster/crucible what are you asking about?"><y>#</y><d>2018-04-17</d><h>02:28</h><w>mynomoto</w><a>@richiardiandrea</a> is something like <a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a> what are you asking about?</z><z id="t1523932178" t="richiardiandrea Yeah I saw that, have you used it? I am still unsure if it makes sense to add a layer on top actually"><y>#</y><d>2018-04-17</d><h>02:29</h><w>richiardiandrea</w>Yeah I saw that, have you used it? I am still unsure if it makes sense to add a layer on top actually</z><z id="t1523932400" t="mynomoto I started doing something with the same idea based on plumatic/schema a couple of years ago but it got shelved before getting in a good shape. I like the idea, because I think it composes better than json and if we get some validation it&apos;s another plus."><y>#</y><d>2018-04-17</d><h>02:33</h><w>mynomoto</w>I started doing something with the same idea based on plumatic/schema a couple of years ago but it got shelved before getting in a good shape. I like the idea, because I think it composes better than json and if we get some validation it&apos;s another plus.</z><z id="t1523932579" t="richiardiandrea Yep validation is nice indeed"><y>#</y><d>2018-04-17</d><h>02:36</h><w>richiardiandrea</w>Yep validation is nice indeed</z><z id="t1523933238" t="mynomoto What triggered the start of writing that was that I got tired of rereading the aws cloudformation documentation to look at which combination of options were mandatory. I haven&apos;t look at what crucible does but it could validate lots of combinations with spec."><y>#</y><d>2018-04-17</d><h>02:47</h><w>mynomoto</w>What triggered the start of writing that was that I got tired of rereading the aws cloudformation documentation to look at which combination of options were mandatory. I haven&apos;t look at what crucible does but it could validate lots of combinations with spec.</z><z id="t1523938447" t="richiardiandrea Yeah if I had doc + better composition + validation then it&apos;s definitely worth"><y>#</y><d>2018-04-17</d><h>04:14</h><w>richiardiandrea</w>Yeah if I had doc + better composition + validation then it&apos;s definitely worth</z><z id="t1523960265" t="steveb8n [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] I’m using https://github.com/juxt/roll It generates terraform instead of cloud formation but same result. works great in bitbucket pipelines CI"><y>#</y><d>2018-04-17</d><h>10:17</h><w>steveb8n</w><a>@richiardiandrea</a> I’m using <a href="https://github.com/juxt/roll" target="_blank">https://github.com/juxt/roll</a> It generates terraform instead of cloud formation but same result. works great in bitbucket pipelines CI</z><z id="t1523969727" t="chris_johnson oh wow, yes - I’ve been on the “just write CloudFormation instead of using a tool” train for a long time because I’m generally in the position of wanting to use something that just got released and the lag of something like Terraform introduces impedance I don’t want. Being able to use spec as the validation tool AWS has never yet provided to avoid round-trips through standing up resources only to find that I forgot to set this or that key somewhere… that would be really nice"><y>#</y><d>2018-04-17</d><h>12:55</h><w>chris_johnson</w>oh wow, yes - I’ve been on the “just write CloudFormation instead of using a tool” train for a long time because I’m generally in the position of wanting to use something that just got released and the lag of something like Terraform introduces impedance I don’t want. Being able to use <code>spec</code> as the validation tool AWS has never yet provided to avoid round-trips through standing up resources only to find that I forgot to set this or that key somewhere… that would be really nice</z><z id="t1523990884" t="ghadi Anyone else use the AWS Java SDK v2 preview?"><y>#</y><d>2018-04-17</d><h>18:48</h><w>ghadi</w>Anyone else use the AWS Java SDK v2 preview?</z><z id="t1523990895" t="ghadi https://github.com/aws/aws-sdk-java-v2"><y>#</y><d>2018-04-17</d><h>18:48</h><w>ghadi</w><a href="https://github.com/aws/aws-sdk-java-v2" target="_blank">https://github.com/aws/aws-sdk-java-v2</a></z><z id="t1525143427" t="nfisher [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] not yet any particular highlights you’ve found interesting?"><y>#</y><d>2018-05-01</d><h>02:57</h><w>nfisher</w><a>@ghadi</a> not yet any particular highlights you’ve found interesting?</z><z id="t1525544992" t="grav Holy moly, is setting up an API gateway quite an experience in copy/pasting or am I totally not getting anything?"><y>#</y><d>2018-05-05</d><h>18:29</h><w>grav</w>Holy moly, is setting up an API gateway quite an experience in copy/pasting or am I totally not getting anything?</z><z id="t1525545069" t="grav Maybe it’s me, but it seems like there’s a whole lot of logic that suddenly has to be moved from the (clojure) application code to the api gateway in the form of mapping templates and what not."><y>#</y><d>2018-05-05</d><h>18:31</h><w>grav</w>Maybe it’s me, but it seems like there’s a whole lot of logic that suddenly has to be moved from the (clojure) application code to the api gateway in the form of mapping templates and what not.</z><z id="t1525547983" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] I can only praise terraform...it allows you to use a swagger file for creating the methods + integrations"><y>#</y><d>2018-05-05</d><h>19:19</h><w>richiardiandrea</w><a>@grav</a> I can only praise terraform...it allows you to use a swagger file for creating the methods + integrations</z><z id="t1525548012" t="richiardiandrea without it I don&apos;t know how people could survive the boredom 😄"><y>#</y><d>2018-05-05</d><h>19:20</h><w>richiardiandrea</w>without it I don&apos;t know how people could survive the boredom <b>😄</b></z><z id="t1525566952" t="lloydshark [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] Yeah, once we worked out an API gateway definition (inc custom authorisor &amp; cors protection) that worked for us defined in cloud formation (SAM) - it has been copy and paste since then, when we wanted to reuse it. That said - we use the proxy integration and try not to do very much in mapping in API gateway."><y>#</y><d>2018-05-06</d><h>00:35</h><w>lloydshark</w><a>@grav</a> Yeah, once we worked out an API gateway definition (inc custom authorisor &amp; cors protection) that worked for us defined in cloud formation (SAM) - it has been copy and paste since then, when we wanted to reuse it.  That said - we use the proxy integration and try not to do very much in mapping in API gateway.</z><z id="t1525600367" t="grav [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] Oh dear, another framework to understand 🙂 I just wanna code Clojure 😉 [:attrs {:href &quot;/_/_/users/U4T99SHSB&quot;}] Yes, using proxy integration is also what I’m considering. I did see that there’s a serverless plugin for cljs-lambda, which handles much of the API gw config and lambda deployment. It also supports Lumo as an alternative to cljs-build, so maybe it would be possible to plug in shadow-cljs as well."><y>#</y><d>2018-05-06</d><h>09:52</h><w>grav</w><a>@richiardiandrea</a> Oh dear, another framework to understand <b>🙂</b> I just wanna code Clojure <b>😉</b>

<a>@lloydshark</a> Yes, using proxy integration is also what I’m considering. 

I did see that there’s a serverless plugin for cljs-lambda, which handles much of the API gw config and lambda deployment. It also supports Lumo as an alternative to cljs-build, so maybe it would be possible to plug in shadow-cljs as well.</z><z id="t1525600377" t="grav https://groups.google.com/forum/#!topic/clojurescript/ag7qSnfWj5c"><y>#</y><d>2018-05-06</d><h>09:52</h><w>grav</w><a href="https://groups.google.com/forum/#!topic/clojurescript/ag7qSnfWj5c" target="_blank">https://groups.google.com/forum/#!topic/clojurescript/ag7qSnfWj5c</a></z><z id="t1525608499" t="valtteri 👍 for serverless-cljs plugin. Maybe the best thing in Serverless is that it configures the gateway for you."><y>#</y><d>2018-05-06</d><h>12:08</h><w>valtteri</w><b>👍</b>  for serverless-cljs plugin. Maybe the best thing in Serverless is that it configures the gateway for you.</z><z id="t1525621003" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] i was using Serverless and still am with lumo. So I actually agree with you. The one thing serverless does not do is to configure all-the-other-things. As our AWS resources started to grow it became obvious that serverless was not enough."><y>#</y><d>2018-05-06</d><h>15:36</h><w>richiardiandrea</w><a>@grav</a> i was using Serverless and still am with lumo. So I actually agree with you. The one thing serverless does not do is to configure all-the-other-things. As our AWS resources started to grow it became obvious that serverless was not enough.</z><z id="t1525623893" t="valtteri [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] what do you mean by all-the-other-things? Serverless supports arbitrary CloudFormation which covers &gt;95% of AWS infra."><y>#</y><d>2018-05-06</d><h>16:24</h><w>valtteri</w><a>@richiardiandrea</a> what do you mean by all-the-other-things? Serverless supports arbitrary CloudFormation which covers &gt;95% of AWS infra.</z><z id="t1525626014" t="richiardiandrea Yeah I don&apos;t consider CloudFormation very friendly, I tried working with it, Terraform has better composability"><y>#</y><d>2018-05-06</d><h>17:00</h><w>richiardiandrea</w>Yeah I don&apos;t consider CloudFormation very friendly, I tried working with it, Terraform has better composability</z><z id="t1525626251" t="richiardiandrea I moved all our infrastructure as code two weeks ago to Terraform following this https://libraries.io/github/robert-stuttaford/terraform-example"><y>#</y><d>2018-05-06</d><h>17:04</h><w>richiardiandrea</w>I moved all our infrastructure as code two weeks ago to Terraform following this <a href="https://libraries.io/github/robert-stuttaford/terraform-example" target="_blank">https://libraries.io/github/robert-stuttaford/terraform-example</a></z><z id="t1525627925" t="valtteri I agree that CloudFormation syntax is not the nicest to work with. 🙂 I’m looking forward to see how this turns out https://github.com/tatut/edn-to-cfn"><y>#</y><d>2018-05-06</d><h>17:32</h><w>valtteri</w>I agree that CloudFormation syntax is not the nicest to work with. <b>🙂</b> I’m looking forward to see how this turns out <a href="https://github.com/tatut/edn-to-cfn" target="_blank">https://github.com/tatut/edn-to-cfn</a></z><z id="t1525631650" t="chris_johnson Another way to think about API Gateway, that might not be desirable but is I think possible: there’s no reason you can’t set up your gateway to handle a single /* endpoint which dispatches to a lambda that is comprised of essentially your existing routes , modified slightly to have each handler dispatch to a second lambda where the application logic lives. That way you can keep your existing routing model and only have to write the one API Gateway config."><y>#</y><d>2018-05-06</d><h>18:34</h><w>chris_johnson</w>Another way to think about API Gateway, that might not be desirable but is I think possible: there’s no reason you can’t set up your gateway to handle a single <code>/*</code> endpoint which dispatches to a lambda that is comprised of essentially your existing <code>routes</code>, modified slightly to have each handler dispatch to a second lambda where the application logic lives. That way you can keep your existing routing model and only have to write the one API Gateway config.</z><z id="t1525632784" t="richiardiandrea Yes we actually do exactly that [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] cause we have a CQRS/event sourcing approach"><y>#</y><d>2018-05-06</d><h>18:53</h><w>richiardiandrea</w>Yes we actually do exactly that <a>@chris_johnson</a> cause we have a CQRS/event sourcing approach</z><z id="t1525871799" t="mj_langford serverless-cljs plugin works now? great. I didn&apos;t have a good result last time I tried. SLS worked fine with node, but for other stuff, it was not as good as terraform or other setup."><y>#</y><d>2018-05-09</d><h>13:16</h><w>mj_langford</w>serverless-cljs plugin works now? great. I didn&apos;t have a good result last time I tried. SLS worked fine with node, but for other stuff, it was not as good as terraform or other setup.</z><z id="t1525871843" t="mj_langford [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] The gateway is an enormous pain point. We did a app pre-proxy days and &quot;had a wonderful lesson&quot; in generating/composing yaml/json specs for that gateway"><y>#</y><d>2018-05-09</d><h>13:17</h><w>mj_langford</w><a>@grav</a> The gateway is an enormous pain point. We did a app pre-proxy days and &quot;had a wonderful lesson&quot; in generating/composing yaml/json specs for that gateway</z><z id="t1525871859" t="mj_langford Run screaming towards proxy is my strong advice."><y>#</y><d>2018-05-09</d><h>13:17</h><w>mj_langford</w>Run screaming towards proxy is my strong advice.</z><z id="t1526036434" t="grav Thanks for all the great advice regarding api gateway. Currently I’m back using the lambda proxy functionality so that I can code more Clojure and less API Gateway. I’m trying my luck with the serverless lumo plugin that nervous system has made, and it works up until I’m trying to package a dependency. Then I get a lein error. I have no idea about why Leiningen comes in to the picture: $ serverless package Serverless: Targeting [snip]... Command failed: lein update-in :cljs-lambda assoc :functions &apos;[{:name &quot;lumo-example-dev-example&quot; :invoke lumo-example.core/example}]&apos; -- cljs-lambda build :output /Users/grav/myapp/.serverless/lumo-example.zip :quiet &apos;cljs-lambda&apos; is not a task. See &apos;lein help&apos;. "><y>#</y><d>2018-05-11</d><h>11:00</h><w>grav</w>Thanks for all the great advice regarding api gateway. Currently I’m back using the lambda proxy functionality so that I can code more Clojure and less API Gateway.
I’m trying my luck with the serverless lumo plugin that nervous system has made, and it works up until I’m trying to package a dependency.  Then I get a <code>lein</code> error. I have no idea about why Leiningen comes in to the picture:

<pre>$ serverless package
Serverless: Targeting [snip]...
Command failed: lein update-in :cljs-lambda assoc :functions &apos;[{:name &quot;lumo-example-dev-example&quot; :invoke lumo-example.core/example}]&apos; -- cljs-lambda build :output /Users/grav/myapp/.serverless/lumo-example.zip :quiet
&apos;cljs-lambda&apos; is not a task. See &apos;lein help&apos;.
</pre></z><z id="t1526037514" t="grav Okay, seems the plugin is simply ignoring when I specify lumo as a map in the serverless.yaml . And even if I specify serverless package --lumo , it does use lumo, but does not use whatever options I specify in the yaml."><y>#</y><d>2018-05-11</d><h>11:18</h><w>grav</w>Okay, seems the plugin is simply ignoring when I specify <code>lumo</code> as a map in the <code>serverless.yaml</code>. And even if I specify <code>serverless package --lumo</code>, it does use lumo, but does not use whatever options I specify in the yaml.</z><z id="t1526038770" t="grav Oh … used old version of serverless-cljs-plugin … now it works."><y>#</y><d>2018-05-11</d><h>11:39</h><w>grav</w>Oh … used old version of serverless-cljs-plugin … now it works.</z><z id="t1526048970" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] yes i use it every day now and contributed the lumo part so feel free to ping me if something is not working ;)"><y>#</y><d>2018-05-11</d><h>14:29</h><w>richiardiandrea</w><a>@grav</a> yes i use it every day now and contributed the  lumo part so feel free to ping me if something is not working ;)</z><z id="t1526051592" t="grav [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] It’s working perfectly. What got me stuck is that the lumo-example on master is using 0.2.0 and not the newest 0.2.2 . Also thinking of contributing with an example that contains an API gw endpoint and uses some dependencies. That took me a bit to get working, so an example would be awesome for the next n00b :-)"><y>#</y><d>2018-05-11</d><h>15:13</h><w>grav</w><a>@richiardiandrea</a> It’s working perfectly. What got me stuck is that the lumo-example on <code>master</code> is using <code>0.2.0</code> and not the newest <code>0.2.2</code>. Also thinking of contributing with an example that contains an API gw endpoint and uses some dependencies. That took me a bit to get working, so an example would be awesome for the next n00b :-)</z><z id="t1526051948" t="richiardiandrea Totally"><y>#</y><d>2018-05-11</d><h>15:19</h><w>richiardiandrea</w>Totally</z><z id="t1526407743" t="mj_langford Thanks for putting your lessons here"><y>#</y><d>2018-05-15</d><h>18:09</h><w>mj_langford</w>Thanks for putting your lessons here</z><z id="t1526407762" t="mj_langford I&apos;m happy to report I finally got lumo + serverless-cljs-plugin working for me!"><y>#</y><d>2018-05-15</d><h>18:09</h><w>mj_langford</w>I&apos;m happy to report I finally got lumo + serverless-cljs-plugin working for me!</z><z id="t1526407786" t="mj_langford Thanks for bumping it to 0.2.2 [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}]"><y>#</y><d>2018-05-15</d><h>18:09</h><w>mj_langford</w>Thanks for bumping it to 0.2.2 <a>@grav</a></z><z id="t1526407854" t="mj_langford May even try clj on serverless via this again"><y>#</y><d>2018-05-15</d><h>18:10</h><w>mj_langford</w>May even try clj on serverless via this again</z><z id="t1526488009" t="juliobarros Anyone have a strategy/framework for developing a Clojure lambda function behind api-gateway that can also be developed/tested/used locally more like a regular ring function?"><y>#</y><d>2018-05-16</d><h>16:26</h><w>juliobarros</w>Anyone have a strategy/framework for developing a Clojure lambda function behind api-gateway that can also be developed/tested/used locally more like a regular ring function?</z><z id="t1526488911" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] I started to use terraform with a swagger template that is built manually atm...one could actually do it directly from spec 😉"><y>#</y><d>2018-05-16</d><h>16:41</h><w>richiardiandrea</w><a>@juliobarros</a> I started to use terraform with a swagger template that is built manually atm...one could actually do it directly from spec <b>😉</b></z><z id="t1526489087" t="juliobarros [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}] is that to specify the api gateway swagger? I’m using the proxy with a more command/query approach not to REST-ish so my question is more basic. I’d love something to translate a ring request into a lambda context (or the other way around) so that I can run my function locally to test and develop the front end cljs app."><y>#</y><d>2018-05-16</d><h>16:44</h><w>juliobarros</w><a>@richiardiandrea</a> is that to specify the api gateway swagger? I’m using the proxy with a more command/query approach not to REST-ish so my question is more basic. I’d love something to translate a ring request into a lambda context (or the other way around) so that I can run my function locally to test and develop the front end cljs app.</z><z id="t1526489708" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U050N5T47&quot;}] I think AWS allows it yes, you need to use their &quot;extensions&quot; though, so for instance I had to do this:"><y>#</y><d>2018-05-16</d><h>16:55</h><w>richiardiandrea</w><a>@juliobarros</a> I think AWS allows it yes, you need to use their &quot;extensions&quot; though, so for instance I had to do this:</z><z id="t1526489766" t="richiardiandrea &quot;/query-events&quot;: { &quot;post&quot;: { &quot;tags&quot;: [ &quot;Events&quot; ], ... &quot;x-amazon-apigateway-integration&quot;: { &quot;httpMethod&quot;: &quot;POST&quot;, &quot;requestParameters&quot;: &quot;body&quot;, &quot;type&quot;: &quot;aws_proxy&quot;, &quot;uri&quot;: &quot;arn:aws:apigateway:${aws_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${aws_region}:${aws_account_id}:function:${query_events_function_name}/invocations&quot; } "><y>#</y><d>2018-05-16</d><h>16:56</h><w>richiardiandrea</w><pre>&quot;/query-events&quot;: {
      &quot;post&quot;: {
        &quot;tags&quot;: [
          &quot;Events&quot;
        ],
        ...
        &quot;x-amazon-apigateway-integration&quot;: {
          &quot;httpMethod&quot;: &quot;POST&quot;,
          &quot;requestParameters&quot;: &quot;body&quot;,
          &quot;type&quot;: &quot;aws_proxy&quot;,
          &quot;uri&quot;: &quot;arn:aws:apigateway:${aws_region}:lambda:path/2015-03-31/functions/arn:aws:lambda:${aws_region}:${aws_account_id}:function:${query_events_function_name}/invocations&quot;
        }
</pre></z><z id="t1526489893" t="juliobarros Ok. Thanks. Its been a while since I looked at this, I’m considering it for a new project, and I’ll need to refresh my understanding. Thanks again."><y>#</y><d>2018-05-16</d><h>16:58</h><w>juliobarros</w>Ok. Thanks. Its been a while since I looked at this, I’m considering it for a new project, and I’ll need to refresh my understanding. Thanks again.</z><z id="t1526490023" t="richiardiandrea yeah, I am writing it manually now but it could be generated"><y>#</y><d>2018-05-16</d><h>17:00</h><w>richiardiandrea</w>yeah, I am writing it manually now but it could be generated</z><z id="t1526490070" t="richiardiandrea I have this as a swagger template at the moment and I don&apos;t have many lambdas, so I haven&apos;t had the need for automation"><y>#</y><d>2018-05-16</d><h>17:01</h><w>richiardiandrea</w>I have this as a swagger template at the moment and I don&apos;t have many lambdas, so I haven&apos;t had the need for automation</z><z id="t1526517213" t="cfleming Hi everyone"><y>#</y><d>2018-05-17</d><h>00:33</h><w>cfleming</w>Hi everyone</z><z id="t1526517225" t="cfleming Not really a Clojure/CLJS question here, but it is AWS related 🙂"><y>#</y><d>2018-05-17</d><h>00:33</h><w>cfleming</w>Not really a Clojure/CLJS question here, but it is AWS related <b>🙂</b></z><z id="t1526517253" t="cfleming Does anyone know how to invalidate the CloudFront distributions which are generated behind the scenes for API gateway?"><y>#</y><d>2018-05-17</d><h>00:34</h><w>cfleming</w>Does anyone know how to invalidate the CloudFront distributions which are generated behind the scenes for API gateway?</z><z id="t1526517489" t="cfleming Actually, don’t mind me - that wasn’t the problem at all."><y>#</y><d>2018-05-17</d><h>00:38</h><w>cfleming</w>Actually, don’t mind me - that wasn’t the problem at all.</z><z id="t1526645536" t="logistark Hi, anyone using https://github.com/ptaoussanis/faraday ?"><y>#</y><d>2018-05-18</d><h>12:12</h><w>logistark</w>Hi, anyone using <a href="https://github.com/ptaoussanis/faraday" target="_blank">https://github.com/ptaoussanis/faraday</a>?</z><z id="t1526658895" t="hiredman I started with it for a project, and ended up ripping it out in favor of the amazon dynamo java sdk"><y>#</y><d>2018-05-18</d><h>15:54</h><w>hiredman</w>I started with it for a project, and ended up ripping it out in favor of the amazon dynamo java sdk</z><z id="t1526658994" t="hiredman the main reason was because the automagic serializaiton stuff was a real pain to deal with when doing more complicated dynamo queries"><y>#</y><d>2018-05-18</d><h>15:56</h><w>hiredman</w>the main reason was because the automagic serializaiton stuff was a real pain to deal with when doing more complicated dynamo queries</z><z id="t1526891526" t="danm Yeah, we&apos;re just using the Java SDK. We&apos;ve actually written our on thin wrapper around them so we can build queries using function composition, but it&apos;s far from feature complete. We&apos;ve only ever implemented the bits we used"><y>#</y><d>2018-05-21</d><h>08:32</h><w>danm</w>Yeah, we&apos;re just using the Java SDK. We&apos;ve actually written our on thin wrapper around them so we can build queries using function composition, but it&apos;s far from feature complete. We&apos;ve only ever implemented the bits we used</z><z id="t1526904945" t="punit-naik Is anyone aware of any library which can create a kubernetes cluster on aws? Like Kops in Go?"><y>#</y><d>2018-05-21</d><h>12:15</h><w>punit-naik</w>Is anyone aware of any library which can create a kubernetes cluster on aws? Like Kops in Go?</z><z id="t1527015442" t="fabrao Hello all, I saw the project https://github.com/lambci/docker-lambda , do you think is a good choice for evaluate Aws Lambda without registering?"><y>#</y><d>2018-05-22</d><h>18:57</h><w>fabrao</w>Hello all, I saw the project <a href="https://github.com/lambci/docker-lambda" target="_blank">https://github.com/lambci/docker-lambda</a>, do you think is a good choice for evaluate Aws Lambda without registering?</z><z id="t1527024177" t="Geoffrey Gaillard I&apos;m trying to check a Cognito JWT using buddy-sign but it seems buddy is requiring a secret parameter, and AWS only provides a jwks.json file. Did some of you managed to use it ?"><y>#</y><d>2018-05-22</d><h>21:22</h><w>Geoffrey Gaillard</w>I&apos;m trying to check a Cognito JWT using buddy-sign but it seems buddy is requiring a <code>secret</code> parameter, and AWS only provides a jwks.json file. Did some of you managed to use it ?</z><z id="t1527024981" t="Geoffrey Gaillard Found a solution to my own problem. It seems I forgot how to google ^^. For log records: (def token &quot;HEADER.PAYLOAD.VERIFY&quot;) (defn decode-b64 [str] (String. (clojure.data.codec.base64/decode (.getBytes str)))) (let [[header payload verify] (clojure.string/split token #&quot;\.&quot;)] {:header (decode-b64 header) :payload (decode-b64 payload) :verify :not-meant-to-be-decoded}) "><y>#</y><d>2018-05-22</d><h>21:36</h><r>Geoffrey Gaillard</r>Found a solution to my own problem. It seems I forgot how to google ^^.
For log records:
<pre>(def token &quot;HEADER.PAYLOAD.VERIFY&quot;)

(defn decode-b64 [str] (String. (clojure.data.codec.base64/decode (.getBytes str))))

(let [[header payload verify] (clojure.string/split token #&quot;\.&quot;)]
  {:header  (decode-b64 header)
   :payload (decode-b64 payload)
   :verify  :not-meant-to-be-decoded})
</pre></z><z id="t1527062511" t="Geoffrey Gaillard Answer to the question above: how to decode/unsign a JWT in Clojure https://gist.github.com/ggeoffrey/b72ed568be4914a990790ea6b09c2c66"><y>#</y><d>2018-05-23</d><h>08:01</h><w>Geoffrey Gaillard</w>Answer to the question above: how to decode/unsign a JWT in Clojure <a href="https://gist.github.com/ggeoffrey/b72ed568be4914a990790ea6b09c2c66" target="_blank">https://gist.github.com/ggeoffrey/b72ed568be4914a990790ea6b09c2c66</a></z><z id="t1527067720" t="valtteri Good stuff. Another option is to let API-Gateway do the work. The GW knows out-of-box how to verify tokens from Cognito and it puts the payload into downstream requests."><y>#</y><d>2018-05-23</d><h>09:28</h><w>valtteri</w>Good stuff. Another option is to let API-Gateway do the work. The GW knows out-of-box how to verify tokens from Cognito and it puts the payload into downstream requests.</z><z id="t1527067841" t="valtteri That adds of course one more hop."><y>#</y><d>2018-05-23</d><h>09:30</h><w>valtteri</w>That adds of course one more hop.</z><z id="t1527070756" t="Geoffrey Gaillard Didn&apos;t knew that 😕 but anyway some of my client&lt;-&gt;server requests goes through websockets and my backend already runs on an EC2 cluster behind an ELB, so decoding JWT in my app seems to take me less time to add (better short-term ROI) then migrating the existing stuff to GW."><y>#</y><d>2018-05-23</d><h>10:19</h><w>Geoffrey Gaillard</w>Didn&apos;t knew that <b>😕</b> but anyway some of my client&lt;-&gt;server requests goes through websockets and my backend already runs on an EC2 cluster behind an ELB, so decoding JWT in my app seems to take me less time to add (better short-term ROI) then migrating the existing stuff to GW.</z><z id="t1527768850" t="donmullen I’m interested in setting up a simple HTTP basic auth password to a staging site. Using elasticbeanstalk running nginx. I’m relatively new to aws and my devops knowledge relatively weak - anyone have example of pushing relevant .ebextensions files to set up so that the health check works and the htaccess / password files put in the right place?"><y>#</y><d>2018-05-31</d><h>12:14</h><w>donmullen</w>I’m interested in setting up a simple HTTP basic auth password to a staging site.  Using elasticbeanstalk running nginx.  I’m relatively new to aws and my devops knowledge relatively weak - anyone have example of pushing relevant .ebextensions files to set up so that the health check works and the htaccess / password files put in the right place?</z><z id="t1527934789" t="Geoffrey Gaillard The first part of this tutorial worked for me http://sarahcassady.com/2016/09/18/deploy-aws-eb-app-with-auth-and-ssl/ If you are deploying a .zip archive to beanstalk make sure the .ebextensions folder is located at the archive&apos;s root. If you are deploying using the eb deploy shell tool, eb will build a zip file, so check what is inside to ensure your .ebextensions is correctly included. Same goes for an AWS Codepipeline deployment. If you never used eb I strongly encourage you to do so. I will make your life easier Hope it helps 😉"><y>#</y><d>2018-06-02</d><h>10:19</h><r>Geoffrey Gaillard</r>The first part of this tutorial worked for me <a href="http://sarahcassady.com/2016/09/18/deploy-aws-eb-app-with-auth-and-ssl/" target="_blank">http://sarahcassady.com/2016/09/18/deploy-aws-eb-app-with-auth-and-ssl/</a>

If you are deploying a <code>.zip</code> archive to  beanstalk make sure the <code>.ebextensions</code> folder is located at the archive&apos;s root.
If you are deploying using the <code>eb deploy</code> shell tool, <code>eb</code> will build a zip file, so check what is inside to ensure your <code>.ebextensions</code> is correctly included. Same goes for an AWS Codepipeline deployment.
If you never used <code>eb</code> I strongly encourage you to do so. I will make your life easier
Hope it helps <b>😉</b></z><z id="t1528760027" t="fiddlerwoaroof foo.core&gt; (set (map :namespace (:metrics (cw/list-metrics {:region &quot;us-east-1&quot;} :namespace &quot;AWS/EBS&quot;)))) #{&quot;AWS/DynamoDB&quot; &quot;AWS/EBS&quot; &quot;AWS/Events&quot; &quot;AWS/ECS&quot; &quot;AWS/NATGateway&quot; &quot;AWS/Lambda&quot; &quot;AWS/EC2&quot; &quot;&quot; &quot;AWS/ApplicationELB&quot; &quot;&quot; &quot;AWS/Logs&quot; &quot;AWS/S3&quot;} "><y>#</y><d>2018-06-11</d><h>23:33</h><w>fiddlerwoaroof</w><pre>foo.core&gt; (set (map :namespace (:metrics (cw/list-metrics {:region &quot;us-east-1&quot;} :namespace &quot;AWS/EBS&quot;))))
#{&quot;AWS/DynamoDB&quot; &quot;AWS/EBS&quot; &quot;AWS/Events&quot; &quot;AWS/ECS&quot; &quot;AWS/NATGateway&quot; &quot;AWS/Lambda&quot; &quot;AWS/EC2&quot; &quot;&quot; &quot;AWS/ApplicationELB&quot; &quot;&quot; &quot;AWS/Logs&quot; &quot;AWS/S3&quot;}
</pre></z><z id="t1528760040" t="fiddlerwoaroof amazonica doesn&apos;t seem to be making requests to the cloudwatch API correctly"><y>#</y><d>2018-06-11</d><h>23:34</h><w>fiddlerwoaroof</w>amazonica doesn&apos;t seem to be making requests to the cloudwatch API correctly</z><z id="t1528760186" t="fiddlerwoaroof It&apos;s returning all the metrics and ignoring the :namespace keyword"><y>#</y><d>2018-06-11</d><h>23:36</h><w>fiddlerwoaroof</w>It&apos;s returning all the metrics and ignoring the <code>:namespace</code> keyword</z><z id="t1528761446" t="fiddlerwoaroof nevermind"><y>#</y><d>2018-06-11</d><h>23:57</h><w>fiddlerwoaroof</w>nevermind</z><z id="t1529604799" t="ghadi https://clojurians.slack.com/archives/C1AL322AJ/p1529604673000550"><y>#</y><d>2018-06-21</d><h>18:13</h><w>ghadi</w><a href="https://clojurians.slack.com/archives/C1AL322AJ/p1529604673000550" target="_blank">https://clojurians.slack.com/archives/C1AL322AJ/p1529604673000550</a></z><z id="t1529604804" t="ghadi headsup"><y>#</y><d>2018-06-21</d><h>18:13</h><w>ghadi</w>headsup</z><z id="t1535544249" t="Nico Hello, is it there an easy/elegant way to sign a spandex (elasticsearch) request with an AWS signature? (I&apos;m using aws-sig4 + clj-http at the moment)"><y>#</y><d>2018-08-29</d><h>12:04</h><w>Nico</w>Hello, is it there an easy/elegant way to sign a spandex (elasticsearch) request with an AWS signature? (I&apos;m using aws-sig4 + clj-http at the moment)</z><z id="t1535545858" t="valtteri Hi [:attrs {:href &quot;/_/_/users/U97TP9F8R&quot;}] I’m not aware of any easy way but you can look for hints here https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/awssig.clj"><y>#</y><d>2018-08-29</d><h>12:30</h><w>valtteri</w>Hi <a>@n.duchenne</a> I’m not aware of any easy way but you can look for hints here <a href="https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/awssig.clj" target="_blank">https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/awssig.clj</a></z><z id="t1535546386" t="valtteri (assuming making the signature is the problem here)"><y>#</y><d>2018-08-29</d><h>12:39</h><w>valtteri</w>(assuming making the signature is the problem here)</z><z id="t1535546615" t="valtteri What comes to Spandex, I think you can slip in your custom headers when making the request"><y>#</y><d>2018-08-29</d><h>12:43</h><w>valtteri</w>What comes to Spandex, I think you can slip in your custom headers when making the request</z><z id="t1535546749" t="Nico Thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] , that&apos;s useful indeed; I had been looking for such functions. I&apos;ll check the custom headers. Otherwise, maybe I could use spandex&apos;s proxy feature, and either use one of the simple command-line AWS signing proxies that are around, or write my own proxy with the signing functions you pointed out. I&apos;d welcome recommendations/warning about ready-made signing proxies before I embark on coding mine though."><y>#</y><d>2018-08-29</d><h>12:45</h><w>Nico</w>Thanks <a>@valtteri</a>, that&apos;s useful indeed; I had been looking for such functions. I&apos;ll check the custom headers. Otherwise, maybe I could use spandex&apos;s proxy feature, and either use one of the simple command-line AWS signing proxies that are around, or write my own proxy with the signing functions you pointed out. I&apos;d welcome recommendations/warning about ready-made signing proxies before I embark on coding mine though.</z><z id="t1535547329" t="valtteri I have no experience on proxies, but it sounds like maybe a good idea if writing your own turns out nasty. One option is to ditch Spandex and use client that knows how to sign requests for AWS."><y>#</y><d>2018-08-29</d><h>12:55</h><w>valtteri</w>I have no experience on proxies, but it sounds like maybe a good idea if writing your own turns out nasty. One option is to ditch Spandex and use client that knows how to sign  requests for AWS.</z><z id="t1535548083" t="Nico Yes, given that it&apos;s just REST, using such a client might be the way to go. I&apos;m browsing the code of the aws-clj-sdk to see whether it does this. Do you know? Or any other client?"><y>#</y><d>2018-08-29</d><h>13:08</h><w>Nico</w>Yes, given that it&apos;s just REST, using such a client might be the way to go. I&apos;m browsing the code of the aws-clj-sdk to see whether it does this. Do you know? Or any other client?</z><z id="t1535548630" t="Nico portkey.aws/-rest-json-call looks promising. Thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] !"><y>#</y><d>2018-08-29</d><h>13:17</h><w>Nico</w>portkey.aws/-rest-json-call looks promising. Thanks <a>@valtteri</a>!</z><z id="t1535549011" t="valtteri I’ve used AWS ES only with Node where there are many client libs that can talk with AWS and currently I’m using non-AWS ES with Spandex. Nice that you found something useful and let me know if you get it to work with Spandex. 🙂"><y>#</y><d>2018-08-29</d><h>13:23</h><w>valtteri</w>I’ve used AWS ES only with Node where there are many client libs that can talk with AWS and currently I’m using non-AWS ES with Spandex. Nice that you found something useful and let me know if you get it to work with Spandex. <b>🙂</b></z><z id="t1535549550" t="Nico Looks like there are nice things in Node indeed, including a signing proxy that could work with Spandex https://www.npmjs.com/package/aws-es-proxy . Will investigate and let you know."><y>#</y><d>2018-08-29</d><h>13:32</h><w>Nico</w>Looks like there are nice things in Node indeed, including a signing proxy that could work with Spandex <a href="https://www.npmjs.com/package/aws-es-proxy" target="_blank">https://www.npmjs.com/package/aws-es-proxy</a>. Will investigate and let you know.</z><z id="t1535549566" t="valtteri When we were doing microservices we setup a lambda with API-GW and created custom REST-interface for ‘our search’ that hid the ES-interface and exposed only use-cases that were relevant to us. We also used lambdas to index docs into ES directly from DynamoDB streams."><y>#</y><d>2018-08-29</d><h>13:32</h><w>valtteri</w>When we were doing microservices we setup a lambda with API-GW and created custom REST-interface for ‘our search’ that hid the ES-interface and exposed only use-cases that were relevant to us. We also used lambdas to index docs into ES directly from DynamoDB streams.</z><z id="t1535549581" t="valtteri I think this was the client lib I used in the lambdas https://www.npmjs.com/package/aws-elasticsearch-client"><y>#</y><d>2018-08-29</d><h>13:33</h><w>valtteri</w>I think this was the client lib I used in the lambdas <a href="https://www.npmjs.com/package/aws-elasticsearch-client" target="_blank">https://www.npmjs.com/package/aws-elasticsearch-client</a></z><z id="t1535549623" t="Nico Cool, thanks!"><y>#</y><d>2018-08-29</d><h>13:33</h><w>Nico</w>Cool, thanks!</z><z id="t1535549745" t="valtteri Could have been this as well.. Can’t remember for sure 🙂 https://www.npmjs.com/package/http-aws-es"><y>#</y><d>2018-08-29</d><h>13:35</h><w>valtteri</w>Could have been this as well.. Can’t remember for sure <b>🙂</b> <a href="https://www.npmjs.com/package/http-aws-es" target="_blank">https://www.npmjs.com/package/http-aws-es</a></z><z id="t1535560764" t="Nico Well, [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] , using a third-party proxy proved straightforward. I installed node.js and the aws-es-proxy package on my EC2 instance, and then it was as simple as starting the proxy aws-es-proxy and then using localhost:9200 as host with spandex (require &apos;[qbits.spandex :as s]) (def c (s/client {:hosts [&quot;&quot;]})) (s/request c {:url [:testindex] :method :put :body {:settings {&quot;number_of_shards&quot; 1}}}) (s/request c {:url [:testindex] :method :get}) Not full clojure solution that I wished for, but it&apos;s so simple that I&apos;ll take it for now."><y>#</y><d>2018-08-29</d><h>16:39</h><w>Nico</w>Well, <a>@valtteri</a>, using a third-party proxy proved straightforward. I installed node.js and the aws-es-proxy package on my EC2 instance, and then it was as simple as starting the proxy
<pre>aws-es-proxy </pre>
and then using <code>localhost:9200</code> as host with spandex
<pre>(require &apos;[qbits.spandex :as s])
(def c (s/client {:hosts [&quot;&quot;]}))
(s/request c {:url [:testindex] :method :put :body {:settings {&quot;number_of_shards&quot; 1}}})
(s/request c {:url [:testindex] :method :get})</pre>
Not full clojure solution that I wished for, but it&apos;s so simple that I&apos;ll take it for now.</z><z id="t1535564684" t="valtteri Nice that you got it sorted out. 👍 Also good to know that there’s a proxy “escape hatch” for signing."><y>#</y><d>2018-08-29</d><h>17:44</h><w>valtteri</w>Nice that you got it sorted out. <b>👍</b> Also good to know that there’s a proxy “escape hatch” for signing.</z><z id="t1535825229" t="lilactown what do you all use for IaC?"><y>#</y><d>2018-09-01</d><h>18:07</h><w>lilactown</w>what do you all use for IaC?</z><z id="t1535825264" t="lilactown I’m getting started with building some new projects in AWS and trying to decide if I should invest in CloudFormation or something more generic"><y>#</y><d>2018-09-01</d><h>18:07</h><w>lilactown</w>I’m getting started with building some new projects in AWS and trying to decide if I should invest in CloudFormation or something more generic</z><z id="t1535825780" t="valtteri Some folks prefer Terraform over CloudFormation. Personally I learned to like CloudFormation. It has horrible learning curve and you have to really go deep into AWS mindset of doing things but I think it’s worth it if your infra is completely on AWS."><y>#</y><d>2018-09-01</d><h>18:16</h><w>valtteri</w>Some folks prefer Terraform over CloudFormation. Personally I learned to like CloudFormation. It has horrible learning curve and you have to really go deep into AWS mindset of doing things but I think it’s worth it if your infra is completely on AWS.</z><z id="t1535826276" t="lilactown I think the general feeling I have (and many other people have) is that my infra is all on AWS… for now 😂"><y>#</y><d>2018-09-01</d><h>18:24</h><w>lilactown</w>I think the general feeling I have (and many other people have) is that my infra is all on AWS… for now <b>😂</b></z><z id="t1535826405" t="valtteri 🙂"><y>#</y><d>2018-09-01</d><h>18:26</h><w>valtteri</w><b>🙂</b></z><z id="t1535826529" t="valtteri Well, for example at previous company we had a client with AWS + Heroku stack. Terraform could deal with both."><y>#</y><d>2018-09-01</d><h>18:28</h><w>valtteri</w>Well, for example at previous company we had a client with AWS + Heroku stack. Terraform could deal with both.</z><z id="t1535826674" t="valtteri Nice thing with CloudFormation is that it’s hosted service. With Terraform you need to maintain state ‘somewhere’."><y>#</y><d>2018-09-01</d><h>18:31</h><w>valtteri</w>Nice thing with CloudFormation is that it’s hosted service. With Terraform you need to maintain state ‘somewhere’.</z><z id="t1535897288" t="Nico [:attrs {:href &quot;/_/_/users/U4YGF4NGM&quot;}] : I found Terraform easy enough to start with, despite not having any prior experience of IaC. There&apos;s a learning curve, but it does make sense to me. I like that it is declarative (like CloudFormation if I understand correctly) and I&apos;ve liked its &apos;immutable&apos; paradigm (create-destroy-recreate), which I&apos;ve found reassuring. It forces me to consolidate everything back into my Terraform scripts, and any doubt about what might have gone wrong, kill the whole stack and restart. It&apos;s also okay for the level of provisioning/deprovisioning I&apos;m doing so far, but what I do is fairly modest. I like that I can tune my provisioning scripts with Terraform, and once I&apos;m happy with them then I move them to Packer. I don&apos;t have any experience of CloudFormation; however, I felt at the time that learning AWS via the Terraform abstractions might prove easier (although I can&apos;t vouch it was actually the case!)."><y>#</y><d>2018-09-02</d><h>14:08</h><w>Nico</w><a>@lilactown</a>: I found Terraform easy enough to start with, despite not having any prior experience of IaC. There&apos;s a learning curve, but it does make sense to me. I like that it is declarative (like CloudFormation if I understand correctly) and I&apos;ve liked its &apos;immutable&apos; paradigm (create-destroy-recreate), which I&apos;ve found reassuring. It forces me to consolidate everything back into my Terraform scripts, and any doubt about what might have gone wrong, kill the whole stack and restart. It&apos;s also okay for the level of provisioning/deprovisioning I&apos;m doing so far, but what I do is fairly modest. I like that I can tune my provisioning scripts with Terraform, and once I&apos;m happy with them then I move them to Packer. I don&apos;t have any experience of CloudFormation; however, I felt at the time that learning AWS via the Terraform abstractions might prove easier (although I can&apos;t vouch it was actually the case!).</z><z id="t1535899838" t="lilactown thanks [:attrs {:href &quot;/_/_/users/U97TP9F8R&quot;}] . I decided to use Datomic Ions for now, which while based on CloudFormation, most of it is handled for me 😛"><y>#</y><d>2018-09-02</d><h>14:50</h><w>lilactown</w>thanks <a>@n.duchenne</a>. I decided to use Datomic Ions for now, which while based on CloudFormation, most of it is handled for me <b>😛</b></z><z id="t1535899853" t="lilactown I think I’ll spend some time soon learning either Terraform or Ansible"><y>#</y><d>2018-09-02</d><h>14:50</h><w>lilactown</w>I think I’ll spend some time soon learning either Terraform or Ansible</z><z id="t1536165721" t="ericstewart I haven&apos;t used it yet because I have only recently begun to use terraform with AWS, but if you use terraform to manage infrastructure (presumably including some things that aren&apos;t in AWS) and need to automate a portion of infrastructure that is already covered by CloudFormation there is https://www.terraform.io/docs/providers/aws/r/cloudformation_stack.html"><y>#</y><d>2018-09-05</d><h>16:42</h><w>ericstewart</w>I haven&apos;t used it yet because I have only recently begun to use terraform with AWS, but if you use terraform to manage infrastructure (presumably including some things that aren&apos;t in AWS) and need to automate a portion of infrastructure that is already covered by CloudFormation there is <a href="https://www.terraform.io/docs/providers/aws/r/cloudformation_stack.html" target="_blank">https://www.terraform.io/docs/providers/aws/r/cloudformation_stack.html</a></z><z id="t1536302194" t="steveb8n [:attrs {:href &quot;/_/_/users/U4YGF4NGM&quot;}] In case you are still evaluating, I’ve had success with the Crucible lib generating CF templates. It’s much nicer to have fns/composition available for that stuff"><y>#</y><d>2018-09-07</d><h>06:36</h><w>steveb8n</w><a>@lilactown</a> In case you are still evaluating, I’ve had success with the Crucible lib generating CF templates. It’s much nicer to have fns/composition available for that stuff</z><z id="t1536302228" t="steveb8n here’s an e.g. https://github.com/hlprmnky/ion-appsync-example/blob/master/src-pages/cf/node_pages.clj"><y>#</y><d>2018-09-07</d><h>06:37</h><w>steveb8n</w>here’s an e.g. <a href="https://github.com/hlprmnky/ion-appsync-example/blob/master/src-pages/cf/node_pages.clj" target="_blank">https://github.com/hlprmnky/ion-appsync-example/blob/master/src-pages/cf/node_pages.clj</a></z><z id="t1536685119" t="mj_langford I&apos;ve had mixed results with Serverless, which I believe works via CF. It works better for JS that Clojure/clojurescript apps"><y>#</y><d>2018-09-11</d><h>16:58</h><w>mj_langford</w>I&apos;ve had mixed results with Serverless, which I believe works via CF. It works better for JS that Clojure/clojurescript apps</z><z id="t1536685135" t="mj_langford It&apos;s a lot better than hand rolling updates when it does work though."><y>#</y><d>2018-09-11</d><h>16:58</h><w>mj_langford</w>It&apos;s a lot better than hand rolling updates when it does work though.</z><z id="t1537214341" t="spieden we build up CF templates as Clojure data then serialize to JSON — works pretty well"><y>#</y><d>2018-09-17</d><h>19:59</h><w>spieden</w>we build up CF templates as Clojure data then serialize to JSON — works pretty well</z><z id="t1537214350" t="spieden been meaning to spin out a library"><y>#</y><d>2018-09-17</d><h>19:59</h><w>spieden</w>been meaning to spin out a library</z><z id="t1537246838" t="valtteri [:attrs {:href &quot;/_/_/users/U0HM5MJ5V&quot;}] sounds really interesting! Something similar to this? https://github.com/portkey-cloud/edn-to-cfn"><y>#</y><d>2018-09-18</d><h>05:00</h><w>valtteri</w><a>@spieden</a> sounds really interesting! Something similar to this? <a href="https://github.com/portkey-cloud/edn-to-cfn" target="_blank">https://github.com/portkey-cloud/edn-to-cfn</a></z><z id="t1537246963" t="valtteri The most painful part to me working with CF is the YAML/JSON editing. I know there are linters and other tools to help with that but I’d very much prefer working with Clojure data. 😉"><y>#</y><d>2018-09-18</d><h>05:02</h><w>valtteri</w>The most painful part to me working with CF is the YAML/JSON editing. I know there are linters and other tools to help with that but I’d very much prefer working with Clojure data. <b>😉</b></z><z id="t1537288893" t="spieden [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] that library looks cool! much more ambitious than what we have visa vie speccing everything. maybe we could merge efforts"><y>#</y><d>2018-09-18</d><h>16:41</h><w>spieden</w><a>@valtteri</a> that library looks cool! much more ambitious than what we have visa vie speccing everything. maybe we could merge efforts</z><z id="t1537449017" t="steveb8n I&apos;ve used crucible for CF templates. How&apos;s are these other lib different from crucible?"><y>#</y><d>2018-09-20</d><h>13:10</h><w>steveb8n</w>I&apos;ve used crucible for CF templates. How&apos;s are these other lib different from crucible?</z><z id="t1537467673" t="spieden [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] cool, hadn’t seen that — our codebase predates it. our edn looks like like the JSON and mostly we factor out functions to build up common things. also have some utilities for using their “intrinsic functions”"><y>#</y><d>2018-09-20</d><h>18:21</h><w>spieden</w><a>@steveb8n</a> cool, hadn’t seen that — our codebase predates it. our edn looks like like the JSON and mostly we factor out functions to build up common things. also have some utilities for using their “intrinsic functions”</z><z id="t1537477919" t="steveb8n Makes sense. Using functions for blocks of json was the big benefit for me too. Thanks for sharing"><y>#</y><d>2018-09-20</d><h>21:11</h><w>steveb8n</w>Makes sense. Using functions for blocks of json was the big benefit for me too. Thanks for sharing</z><z id="t1539010251" t="polymeris I have started playing around with creating a CLJS client for AWS: https://github.com/polymeris/cljs-aws Consider it a PoC -- I am not sure I am using the right approach, but would love to hear your opinion."><y>#</y><d>2018-10-08</d><h>14:50</h><w>polymeris</w>I have started playing around with creating a CLJS client for AWS: <a href="https://github.com/polymeris/cljs-aws" target="_blank">https://github.com/polymeris/cljs-aws</a>
Consider it a PoC -- I am not sure I am using the right approach, but would love to hear your opinion.</z><z id="t1539112606" t="mj_langford Glad to see this is becoming a thing. ClojureScript was a good candidate for lambda"><y>#</y><d>2018-10-09</d><h>19:16</h><w>mj_langford</w>Glad to see this is becoming a thing. ClojureScript was a good candidate for lambda</z><z id="t1539190779" t="Joe Lane [:attrs {:href &quot;/_/_/users/U0FTV149X&quot;}] I you’re going to do this please don’t make Node a requirement. There are a TON of scenarios where you would want to call aws from the browser directly. I’ve got a PoC calling an aws lambda from the browser, no apigateway or webserver in sight."><y>#</y><d>2018-10-10</d><h>16:59</h><w>Joe Lane</w><a>@polymeris</a> I you’re going to do this please don’t make Node a requirement. There are a TON of scenarios where you would want to call aws from the browser directly. I’ve got a PoC calling an aws lambda from the browser, no apigateway or webserver in sight.</z><z id="t1539191339" t="polymeris Hmm, interesting The cljsjs.aws-sdk-js I am depending on for the exerns already brings in the browser build of the SDK (which is apparently different from the node build). It would be a matter of switching to using the correct AWS object in the browser."><y>#</y><d>2018-10-10</d><h>17:08</h><r>polymeris</r>Hmm, interesting
The <code>cljsjs.aws-sdk-js</code> I am depending on for the exerns already brings in the browser build of the SDK (which is apparently different from the node build). It would be a matter of switching to using the correct <code>AWS</code> object in the browser.</z><z id="t1539191498" t="polymeris My use case is calling this from lambdas, so I haven&apos;t really given that much thought."><y>#</y><d>2018-10-10</d><h>17:11</h><r>polymeris</r>My use case is calling this from lambdas, so I haven&apos;t really given that much thought.</z><z id="t1539191790" t="mj_langford As a countercase: I would take an API that requires node. I think node is a better lambda backend than clojure on java due to startup times"><y>#</y><d>2018-10-10</d><h>17:16</h><r>mj_langford</r>As a countercase: I would take an API that requires node. I think node is a better lambda backend than clojure on java due to startup times</z><z id="t1539193255" t="Joe Lane In practice I havent found the java startup times to be an issue."><y>#</y><d>2018-10-10</d><h>17:40</h><r>Joe Lane</r>In practice I havent found the java startup times to be an issue.</z><z id="t1539193437" t="Joe Lane [:attrs {:href &quot;/_/_/users/U0FTV149X&quot;}] That library hasn’t been updated in a very long time. I ended up manually writing a foreign libs file because the sdk uses modules 3 levels deep and cljs has trouble requiring them (i believe because its not a valid symbol)"><y>#</y><d>2018-10-10</d><h>17:43</h><r>Joe Lane</r><a>@polymeris</a> That library hasn’t been updated in a very long time. I ended up manually writing a foreign libs file because the sdk uses modules 3 levels deep and cljs has trouble requiring them (i believe because its not a valid symbol)</z><z id="t1539194916" t="polymeris Well, the unit test work in the browser if I just replace (nodejs/require &quot;aws-sdk&quot;) with js/AWS , so that gives me some hope that we can support both"><y>#</y><d>2018-10-10</d><h>18:08</h><r>polymeris</r>Well, the unit test work in the browser if I just replace <code>(nodejs/require &quot;aws-sdk&quot;)</code> with <code>js/AWS</code>, so that gives me some hope that we can support both</z><z id="t1539195142" t="Joe Lane Cool! Great to hear!"><y>#</y><d>2018-10-10</d><h>18:12</h><r>Joe Lane</r>Cool! Great to hear!</z><z id="t1539199790" t="polymeris What&apos;s the best way to end-to-end test if it works in the browser? Do I have to create a cognito pool?"><y>#</y><d>2018-10-10</d><h>19:29</h><r>polymeris</r>What&apos;s the best way to end-to-end test if it works in the browser? Do I have to create a cognito pool?</z><z id="t1539199820" t="polymeris (looking at https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/getting-started-browser.html )"><y>#</y><d>2018-10-10</d><h>19:30</h><r>polymeris</r>(looking at <a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/getting-started-browser.html" target="_blank">https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/getting-started-browser.html</a>)</z><z id="t1539268572" t="Joe Lane Yeah, cognito identity pool."><y>#</y><d>2018-10-11</d><h>14:36</h><r>Joe Lane</r>Yeah, cognito identity pool.</z><z id="t1539225563" t="polymeris [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] https://github.com/polymeris/cljs-aws/blob/master/browser-examples/src/cljs_aws/lambda_example.cljs it does work in the browser"><y>#</y><d>2018-10-11</d><h>02:39</h><w>polymeris</w><a>@lanejo01</a> <a href="https://github.com/polymeris/cljs-aws/blob/master/browser-examples/src/cljs_aws/lambda_example.cljs" target="_blank">https://github.com/polymeris/cljs-aws/blob/master/browser-examples/src/cljs_aws/lambda_example.cljs</a> it does work in the browser</z><z id="t1539268533" t="Joe Lane this is great!"><y>#</y><d>2018-10-11</d><h>14:35</h><w>Joe Lane</w>this is great!</z><z id="t1539962702" t="donaldball I’ve just begun using micrometer to instrument a clojure application in pursuit of understanding a service’s memory utilization over time. Micrometer allows the use of cloudwatch metrics as a backend, that’s all fine, I have a nice cloudwatch dashboard now, but I’m puzzled by what appears to be an obvious lack: I see no way to create vertical annotations (e.g. for deployments or other interesting events) from e.g. metrics rather than hard-coded values. Is anyone aware of a way to handle that case?"><y>#</y><d>2018-10-19</d><h>15:25</h><w>donaldball</w>I’ve just begun using micrometer to instrument a clojure application in pursuit of understanding a service’s memory utilization over time. Micrometer allows the use of cloudwatch metrics as a backend, that’s all fine, I have a nice cloudwatch dashboard now, but I’m puzzled by what appears to be an obvious lack: I see no way to create vertical annotations (e.g. for deployments or other interesting events) from e.g. metrics rather than hard-coded values. Is anyone aware of a way to handle that case?</z><z id="t1540305195" t="dangercoder Are there any guides that you guys recommend for hosting/deploying a Clojure/Clojurescript based application on aws? Or any good aws reads overall?"><y>#</y><d>2018-10-23</d><h>14:33</h><w>dangercoder</w>Are there any guides that you guys recommend for hosting/deploying a Clojure/Clojurescript based application on aws? Or any good aws reads overall?</z><z id="t1540407809" t="mj_langford The forums for AWS are good to solve problems [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] . Lambda + Clojure is very slow to start without a keepalive timer to keep hot. APIGateway + clojure routing is iffy at times. I&apos;d love to read a good resource on that. The readme for lein-aws gateway has a decent amount of API Gateway json info in it: https://github.com/trieloff/lein-aws-apigateway"><y>#</y><d>2018-10-24</d><h>19:03</h><w>mj_langford</w>The forums for AWS are good to solve problems <a>@jarvinenemil</a>. Lambda + Clojure is very slow to start without a keepalive timer to keep hot. APIGateway  + clojure routing is iffy at times. I&apos;d love to read a good resource on that. The readme for lein-aws gateway has a decent amount of API Gateway json info in it: <a href="https://github.com/trieloff/lein-aws-apigateway" target="_blank">https://github.com/trieloff/lein-aws-apigateway</a></z><z id="t1540407875" t="mj_langford I mean https://github.com/jpb/ring-aws-lambda-adapter is the one with the good example of AWS API gateway + json."><y>#</y><d>2018-10-24</d><h>19:04</h><w>mj_langford</w>I mean <a href="https://github.com/jpb/ring-aws-lambda-adapter" target="_blank">https://github.com/jpb/ring-aws-lambda-adapter</a> is the one with the good example of AWS API gateway + json.</z><z id="t1540428716" t="lloydshark Lambda with Clojurescript is fine though. The startup time is decent and you get the serverless advantage of not really having to worry about managing the container."><y>#</y><d>2018-10-25</d><h>00:51</h><w>lloydshark</w>Lambda with Clojurescript is fine though. The startup time is decent and you get the serverless advantage of not really having to worry about managing the container.</z><z id="t1540428807" t="lloydshark That said, the typically web app might still have some asynchronous processing - so if you prefer to write that in Clojure then you can as the startup time is not an issue."><y>#</y><d>2018-10-25</d><h>00:53</h><w>lloydshark</w>That said, the typically web app might still have some asynchronous processing - so if you prefer to write that in Clojure then you can as the startup time is not an issue.</z><z id="t1541095020" t="mj_langford I&apos;m hoping for Clojurescript + shadow-cljs to end up working out well."><y>#</y><d>2018-11-01</d><h>17:57</h><w>mj_langford</w>I&apos;m hoping for Clojurescript + shadow-cljs to end up working out well.</z><z id="t1541095024" t="mj_langford (on lambda)"><y>#</y><d>2018-11-01</d><h>17:57</h><w>mj_langford</w>(on lambda)</z><z id="t1541095032" t="mj_langford Right now, it&apos;s a little fuzzily documented."><y>#</y><d>2018-11-01</d><h>17:57</h><w>mj_langford</w>Right now, it&apos;s a little fuzzily documented.</z><z id="t1541126960" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] doing the same on azure, all good"><y>#</y><d>2018-11-02</d><h>02:49</h><w>richiardiandrea</w><a>@mj_langford</a> doing the same on azure, all good</z><z id="t1541148078" t="valtteri What are the benefits of using shadow-cljs with Node/lambda? Are you running the code through advanced optimizations? Sorry for slight off-topic."><y>#</y><d>2018-11-02</d><h>08:41</h><w>valtteri</w>What are the benefits of using shadow-cljs with Node/lambda? Are you running the code through advanced optimizations? Sorry for slight off-topic.</z><z id="t1541156760" t="lloydshark [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] I agree. I wouldn&apos;t have thought there is any need for shadow-cljs when targeting lambda as you can simply package the node_modules directly. Targeting the browser - yeah that&apos;s another story."><y>#</y><d>2018-11-02</d><h>11:06</h><w>lloydshark</w><a>@valtteri</a> I agree. I wouldn&apos;t have thought there is any need for shadow-cljs when targeting lambda as you can simply package the node_modules directly. Targeting the browser - yeah that&apos;s another story.</z><z id="t1541157184" t="valtteri I’m just curious if there are some fancy built-in goodies in shadow-cljs for targeting node/lambda. 😉"><y>#</y><d>2018-11-02</d><h>11:13</h><w>valtteri</w>I’m just curious if there are some fancy built-in goodies in shadow-cljs for targeting node/lambda. <b>😉</b></z><z id="t1541157215" t="valtteri Never used it myself yet"><y>#</y><d>2018-11-02</d><h>11:13</h><w>valtteri</w>Never used it myself yet</z><z id="t1541173440" t="lilactown it&apos;s not really about node_modules at all. you still need a compiler to take your CLJS code and output JS code"><y>#</y><d>2018-11-02</d><h>15:44</h><w>lilactown</w>it&apos;s not really about node_modules at all. you still need a compiler to take your CLJS code and output JS code</z><z id="t1541173453" t="lilactown shadow-cljs has excellent out of the box support for targeting Node.js"><y>#</y><d>2018-11-02</d><h>15:44</h><w>lilactown</w>shadow-cljs has excellent out of the box support for targeting Node.js</z><z id="t1541173464" t="lilactown I think it even has an azure target?"><y>#</y><d>2018-11-02</d><h>15:44</h><w>lilactown</w>I think it even has an azure target?</z><z id="t1541173513" t="lilactown but for AWS I believe you can simply target a node lib and shadow-cljs will do the right things re: not bundling dependencies, optimizing correctly, etc."><y>#</y><d>2018-11-02</d><h>15:45</h><w>lilactown</w>but for AWS I believe you can simply target a node lib and shadow-cljs will do the right things re: not bundling dependencies, optimizing correctly, etc.</z><z id="t1541174040" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] yes in our case I contributed a shadow target that compiles things as Azure expect them. One of the nice nice things of shadow are also custom or built in &quot;targets&quot;"><y>#</y><d>2018-11-02</d><h>15:54</h><w>richiardiandrea</w><a>@valtteri</a> yes in our case I contributed a shadow target that compiles things as Azure expect them. One of the nice nice things of shadow are also custom or built in &quot;targets&quot;</z><z id="t1541174118" t="richiardiandrea Actually I think it was Thomas mainly who contributed that sorry I had to check - memory is failing 😉 "><y>#</y><d>2018-11-02</d><h>15:55</h><w>richiardiandrea</w>Actually I think it was Thomas mainly who contributed that sorry I had to check - memory is failing <b>😉</b> </z><z id="t1541179868" t="valtteri Good to know that shadow has extensible little ‘ecosystem’. It sounds interesting. Need to find time to look into it some day."><y>#</y><d>2018-11-02</d><h>17:31</h><w>valtteri</w>Good to know that shadow has extensible little ‘ecosystem’. It sounds interesting. Need to find time to look into it some day.</z><z id="t1541187128" t="mj_langford [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] The advantage of targeting shadow-cljs is finding a community committed to a specific stack so you don&apos;t have to handle the node/cljs glue yourself everywhere."><y>#</y><d>2018-11-02</d><h>19:32</h><w>mj_langford</w><a>@valtteri</a> The advantage of targeting shadow-cljs is finding a community committed to a specific stack so you don&apos;t have to handle the node/cljs glue yourself everywhere.</z><z id="t1543715354" t="richiardiandrea We should totally do this for Clojure! https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html"><y>#</y><d>2018-12-02</d><h>01:49</h><w>richiardiandrea</w>We should totally do this for Clojure! <a href="https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html" target="_blank">https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html</a></z><z id="t1543717327" t="lilactown Is there any benefit over the jvm runtime (other than some nicer DX)?"><y>#</y><d>2018-12-02</d><h>02:22</h><w>lilactown</w>Is there any benefit over the jvm runtime (other than some nicer DX)?</z><z id="t1543724159" t="chris_johnson It would be interesting to see if between this and layers it’s possible to craft a Lambda runtime that performs the “load the Clojure RT” part of the worker cold start at build time"><y>#</y><d>2018-12-02</d><h>04:15</h><w>chris_johnson</w>It would be interesting to see if between this and layers it’s possible to craft a Lambda runtime that performs the “load the Clojure RT” part of the worker cold start at build time</z><z id="t1543869854" t="mj_langford [:attrs {:href &quot;/_/_/users/U4YGF4NGM&quot;}] Yes, there would be a defined, clojure specific runtime with tests and things to build around."><y>#</y><d>2018-12-03</d><h>20:44</h><w>mj_langford</w><a>@lilactown</a> Yes, there would be a defined, clojure specific runtime with tests and things to build around.</z><z id="t1543869865" t="mj_langford That thing could be optimized, integrated with Ring, etc."><y>#</y><d>2018-12-03</d><h>20:44</h><w>mj_langford</w>That thing could be optimized, integrated with Ring, etc.</z><z id="t1543869908" t="mj_langford Right now it&apos;s yolotown, with everyone copying things partially or making frameworks, etc, where really a buildpack config might be a more minimal, stable, and dependency free situation."><y>#</y><d>2018-12-03</d><h>20:45</h><w>mj_langford</w>Right now it&apos;s yolotown, with everyone copying things partially or making frameworks, etc, where really a buildpack config might be a more minimal, stable, and dependency free situation.</z><z id="t1543870141" t="lispers-anonymous There would be a lot of benefit to using graalvm in lambda."><y>#</y><d>2018-12-03</d><h>20:49</h><w>lispers-anonymous</w>There would be a lot of benefit to using graalvm in lambda.</z><z id="t1543870263" t="lilactown I&apos;m on board the the developer experience improvements. but back when I tried it, the cold start times of a Clojure lambda was just too much"><y>#</y><d>2018-12-03</d><h>20:51</h><w>lilactown</w>I&apos;m on board the the developer experience improvements. but back when I tried it, the cold start times of a Clojure lambda was just too much</z><z id="t1543870320" t="lilactown unless graalvm or what [:attrs {:href &quot;/_/_/users/U07HA15PY&quot;}] said where we can optimize the Clojure runtime load process can be done, I still don&apos;t see much future of Clojure + Lambda"><y>#</y><d>2018-12-03</d><h>20:52</h><w>lilactown</w>unless graalvm or what <a>@chris_johnson</a> said where we can optimize the Clojure runtime load process can be done, I still don&apos;t see much future of Clojure + Lambda</z><z id="t1543872006" t="mj_langford Clojure + keepalive pings is an option"><y>#</y><d>2018-12-03</d><h>21:20</h><w>mj_langford</w>Clojure + keepalive pings is an option</z><z id="t1543872021" t="mj_langford Still can be economical for many tasks."><y>#</y><d>2018-12-03</d><h>21:20</h><w>mj_langford</w>Still can be economical for many tasks.</z><z id="t1543872042" t="mj_langford I personally want to see a well proven clojurescript stack built on it"><y>#</y><d>2018-12-03</d><h>21:20</h><w>mj_langford</w>I personally want to see a well proven clojurescript stack built on it</z><z id="t1543872066" t="mj_langford Waiting for just a bit better shadow-cljs/node doc to happen there myself"><y>#</y><d>2018-12-03</d><h>21:21</h><w>mj_langford</w>Waiting for just a bit better shadow-cljs/node doc to happen there myself</z><z id="t1543873608" t="richiardiandrea [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] the node-script target already serve that purpose"><y>#</y><d>2018-12-03</d><h>21:46</h><w>richiardiandrea</w><a>@mj_langford</a> the <code>node-script</code> target already serve that purpose</z><z id="t1543880227" t="dogenpunk Anyone using CodeCommit here? Wondering if there are any drawbacks for a private commercial project developed by a small (1-4) team. "><y>#</y><d>2018-12-03</d><h>23:37</h><w>dogenpunk</w>Anyone using CodeCommit here? Wondering if there are any drawbacks for a private commercial project developed by a small (1-4) team. </z><z id="t1543880567" t="aisamu It can be terribly slow at times..."><y>#</y><d>2018-12-03</d><h>23:42</h><r>aisamu</r>It can be terribly slow at times...</z><z id="t1543880690" t="dogenpunk Is that slow on just remote push/pull ops or is it also slow when used in conjunction with CodeBuild/Pipelines as well?"><y>#</y><d>2018-12-03</d><h>23:44</h><r>dogenpunk</r>Is that slow on just remote push/pull ops or is it also slow when used in conjunction with CodeBuild/Pipelines as well?</z><z id="t1543880808" t="dogenpunk Or both?"><y>#</y><d>2018-12-03</d><h>23:46</h><r>dogenpunk</r>Or both?</z><z id="t1543880871" t="aisamu I can&apos;t say for the Pipelines, since they lacked per-branch build or something like that the last time I investigated. Just push/pull, to the point I thought something was broken on my end."><y>#</y><d>2018-12-03</d><h>23:47</h><r>aisamu</r>I can&apos;t say for the Pipelines, since they lacked per-branch build or something like that the last time I investigated.
Just push/pull, to the point I thought something was broken on my end.</z><z id="t1543881042" t="dogenpunk Right on, thanks!"><y>#</y><d>2018-12-03</d><h>23:50</h><r>dogenpunk</r>Right on, thanks!</z><z id="t1543903138" t="steveb8n [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] Rich has stated that they are working on an update to Ions where Lambdas are not used as API-GW connective tissue i.e. no more VPC cold starts. Also, at ClojuTre one of the talks was about Graal and, while it speeds up start-time, it has approx 50% perf compared with jvm Clojure in Hotspot. For that reason, I’m not sure that Graal will be the long term solution to our performance concerns"><y>#</y><d>2018-12-04</d><h>05:58</h><w>steveb8n</w><a>@dannyfreeman</a> Rich has stated that they are working on an update to Ions where Lambdas are not used as API-GW connective tissue i.e. no more VPC cold starts. Also, at ClojuTre one of the talks was about Graal and, while it speeds up start-time, it has approx 50% perf compared with jvm Clojure in Hotspot. For that reason, I’m not sure that Graal will be the long term solution to our performance concerns</z><z id="t1543932769" t="lispers-anonymous I was unaware of the performance of graal [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] . That’s unfortunate. For similar reasons, clojurescript in lambdas isn’t a good solution for some users either. Cold starts are improved but in the long term they don’t perform as well compared to the JVM."><y>#</y><d>2018-12-04</d><h>14:12</h><w>lispers-anonymous</w>I was unaware of the performance of graal <a>@steveb8n</a>. That’s unfortunate. For similar reasons, clojurescript in lambdas isn’t a good solution for some users either. Cold starts are improved but in the long term they don’t perform as well compared to the JVM.</z><z id="t1543940425" t="Alex Miller (Clojure team) I don’t think there’s been any mention of it in this room, but we released a brand new direct Clojure API to AWS this week (does not go through the Java SDK) for all AWS services"><y>#</y><d>2018-12-04</d><h>16:20</h><w>Alex Miller (Clojure team)</w>I don’t think there’s been any mention of it in this room, but we released a brand new direct Clojure API to AWS this week (does not go through the Java SDK) for all AWS services</z><z id="t1543940449" t="Alex Miller (Clojure team) https://www.youtube.com/watch?v=ppDtDP0Rntw"><y>#</y><d>2018-12-04</d><h>16:20</h><w>Alex Miller (Clojure team)</w><a href="https://www.youtube.com/watch?v=ppDtDP0Rntw" target="_blank">https://www.youtube.com/watch?v=ppDtDP0Rntw</a></z><z id="t1543953168" t="polymeris Oh... I feel my approach of autogenerating interfaces from the SDK definition JSONs in https://github.com/polymeris/cljs-aws validated if cognitect does the same, otoh makes me realize I should have taken the concept further!"><y>#</y><d>2018-12-04</d><h>19:52</h><r>polymeris</r>Oh... I feel my approach of autogenerating interfaces from the SDK definition JSONs in <a href="https://github.com/polymeris/cljs-aws" target="_blank">https://github.com/polymeris/cljs-aws</a> validated if cognitect does the same, otoh makes me realize I should have taken the concept further!</z><z id="t1543953210" t="polymeris Any plans of adding cljs support?"><y>#</y><d>2018-12-04</d><h>19:53</h><r>polymeris</r>Any plans of adding cljs support?</z><z id="t1543953283" t="Alex Miller (Clojure team) feel free to file a github issue"><y>#</y><d>2018-12-04</d><h>19:54</h><r>Alex Miller (Clojure team)</r>feel free to file a github issue</z><z id="t1543953294" t="Alex Miller (Clojure team) has been explored, I’m not sure of the details"><y>#</y><d>2018-12-04</d><h>19:54</h><r>Alex Miller (Clojure team)</r>has been explored, I’m not sure of the details</z><z id="t1543940473" t="Alex Miller (Clojure team) https://github.com/cognitect-labs/aws-api"><y>#</y><d>2018-12-04</d><h>16:21</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a></z><z id="t1543940506" t="Alex Miller (Clojure team) I think it is a high-quality piece of work and if you need to access AWS you should check it out"><y>#</y><d>2018-12-04</d><h>16:21</h><w>Alex Miller (Clojure team)</w>I think it is a high-quality piece of work and if you need to access AWS you should check it out</z><z id="t1543940569" t="Alex Miller (Clojure team) since it’s generated, it already contains all the new services that were released at reinvent last week, for example"><y>#</y><d>2018-12-04</d><h>16:22</h><w>Alex Miller (Clojure team)</w>since it’s generated, it already contains all the new services that were released at reinvent last week, for example</z><z id="t1543957706" t="steveb8n [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] also relevant is that 50% of cold-start time is caused by VPC ENI init, so any process running in a VPC will suffer it. I’ve got some cljs lambdas outside of a VPC and they cold-start in 3 secs but they really need the VPC goodness too"><y>#</y><d>2018-12-04</d><h>21:08</h><w>steveb8n</w><a>@dannyfreeman</a> also relevant is that 50% of cold-start time is caused by VPC ENI init, so any process running in a VPC will suffer it. I’ve got some cljs lambdas outside of a VPC and they cold-start in 3 secs but they really need the VPC goodness too</z><z id="t1543961378" t="lispers-anonymous 3 seconds seems like a little much for a cljs lambda. You mean clj?"><y>#</y><d>2018-12-04</d><h>22:09</h><w>lispers-anonymous</w>3 seconds seems like a little much for a cljs lambda. You mean clj?</z><z id="t1543964960" t="steveb8n CLJS/node lambdas created using shadow. it has the aws js api deps so maybe that’s why 3 secs. either way, 3 secs is not too bad for my users. 10-20 for jvm lambdas in VPC is unacceptable so I’m looking forward to the new Ions feature which sounds like it will address this"><y>#</y><d>2018-12-04</d><h>23:09</h><w>steveb8n</w>CLJS/node lambdas created using shadow. it has the aws js api deps so maybe that’s why 3 secs. either way, 3 secs is not too bad for my users. 10-20 for jvm lambdas in VPC is unacceptable so I’m looking forward to the new Ions feature which sounds like it will address this</z><z id="t1543987341" t="chrisulloa Question about the cognitect-labs/aws-api, if I want to pass in a set of credentials (rather than setting env variables), doing something like this works: (require &apos;[cognitect.aws.credentials :refer [CredentialsProvider]] &apos;[cognitect.aws.api :as aws]) (defn credentials-provider [access-key secret-key] (reify CredentialsProvider (fetch [_] {:aws/access-key-id access-key :aws/secret-access-key secret-key}))) (def s3-client (aws/client {:api :s3 :region &quot;us-east-1&quot; :credentials (credentials-provider access-key secret-key)})) But is there any reason why it doesn’t allow us to just pass in a map with the credentials?"><y>#</y><d>2018-12-05</d><h>05:22</h><w>chrisulloa</w>Question about the cognitect-labs/aws-api, if I want to pass in a set of credentials (rather than setting env variables), doing something like this works:

<pre>(require &apos;[cognitect.aws.credentials :refer [CredentialsProvider]]
         &apos;[cognitect.aws.api :as aws])

(defn credentials-provider
  [access-key secret-key]
  (reify CredentialsProvider
    (fetch [_]
      {:aws/access-key-id access-key
       :aws/secret-access-key secret-key})))

(def s3-client (aws/client {:api :s3 :region &quot;us-east-1&quot;
                            :credentials (credentials-provider access-key secret-key)}))
</pre>

But is there any reason why it doesn’t allow us to just pass in a map with the credentials?</z><z id="t1543995572" t="dottedmag [:attrs {:href &quot;/_/_/users/UDBM9Q0VC&quot;}] Probably because nobody got around to implement CredentialsProvider via map. But you can do it yourself if you need, can&apos;t you?"><y>#</y><d>2018-12-05</d><h>07:39</h><w>dottedmag</w><a>@christian.gonzalez</a> Probably because nobody got around to implement <code>CredentialsProvider</code> via map. But you can do it yourself if you need, can&apos;t you?</z><z id="t1544015451" t="Alex Miller (Clojure team) Yes, can definitely do it yourself like that"><y>#</y><d>2018-12-05</d><h>13:10</h><w>Alex Miller (Clojure team)</w>Yes, can definitely do it yourself like that</z><z id="t1544015486" t="Alex Miller (Clojure team) Might be reasonable to have this in the api though - I’ve already written this code too"><y>#</y><d>2018-12-05</d><h>13:11</h><w>Alex Miller (Clojure team)</w>Might be reasonable to have this in the api though - I’ve already written this code too</z><z id="t1544015503" t="Alex Miller (Clojure team) Please file a github issue on the api..."><y>#</y><d>2018-12-05</d><h>13:11</h><w>Alex Miller (Clojure team)</w>Please file a github issue on the api...</z></g><g id="s5"><z id="t1544018066" t="chrisulloa Yeah I’ll file an issue thanks guys! I wasn’t sure if there was reasoning behind it. "><y>#</y><d>2018-12-05</d><h>13:54</h><w>chrisulloa</w>Yeah I’ll file an issue thanks guys! I wasn’t sure if there was reasoning behind it. </z><z id="t1544019353" t="Alex Miller (Clojure team) I think the priority was to match the Java SDK first"><y>#</y><d>2018-12-05</d><h>14:15</h><w>Alex Miller (Clojure team)</w>I think the priority was to match the Java SDK first</z><z id="t1544189439" t="chris_johnson I hope I’m not stealing the authors’ thunder by posting this here, but here is an article that crossed my Twitter feed this morning about custom Lambda runtime exposing GraalVM Clojure: https://twitter.com/crystoll/status/1071027945597210624?s=21"><y>#</y><d>2018-12-07</d><h>13:30</h><w>chris_johnson</w>I hope I’m not stealing the authors’ thunder by posting this here, but here is an article that crossed my Twitter feed this morning about custom Lambda runtime exposing GraalVM Clojure: <a href="https://twitter.com/crystoll/status/1071027945597210624?s=21" target="_blank">https://twitter.com/crystoll/status/1071027945597210624?s=21</a></z><z id="t1544189511" t="chris_johnson Performance numbers are encouraging, usual caveats about maturity of GraalVM and early-adopter challenges around what kinds of classes you can generate and still compile your code definitely apply."><y>#</y><d>2018-12-07</d><h>13:31</h><w>chris_johnson</w>Performance numbers are encouraging, usual caveats about maturity of GraalVM and early-adopter challenges around what kinds of classes you can generate and still compile your code definitely apply.</z><z id="t1544267101" t="kulminaator following the steps on aws-api , i guess with this was not supposed to happen =&gt; (def s3-client (aws/client {:api :s3})) 2018-12-08 13:02:49.534:INFO::async-dispatch-1: Logging initialized @58389ms WARNING: An illegal reflective access operation has occurred WARNING: Illegal reflective access by org.eclipse.jetty.util.BufferUtil (file:/home/martin/.m2/repository/org/eclipse/jetty/jetty-util/9.3.7.v20160115/jetty-util-9.3.7.v20160115.jar) to field java.nio.MappedByteBuffer.fd "><y>#</y><d>2018-12-08</d><h>11:05</h><w>kulminaator</w>following the steps on aws-api , i guess with this was not supposed to happen
<pre>=&gt; (def s3-client (aws/client {:api :s3}))
2018-12-08 13:02:49.534:INFO::async-dispatch-1: Logging initialized @58389ms
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.eclipse.jetty.util.BufferUtil (file:/home/martin/.m2/repository/org/eclipse/jetty/jetty-util/9.3.7.v20160115/jetty-util-9.3.7.v20160115.jar) to field java.nio.MappedByteBuffer.fd
</pre></z><z id="t1544267151" t="kulminaator :thinking_face: that also looks like a rather old jetty version it&apos;s trying to use under the hood"><y>#</y><d>2018-12-08</d><h>11:05</h><w>kulminaator</w><b>:thinking_face:</b> that also looks like a rather old jetty version it&apos;s trying to use under the hood</z><z id="t1544267377" t="kulminaator trying to use the newer jetty utils from 9.3.x or 9.4.x series are broken in different ways"><y>#</y><d>2018-12-08</d><h>11:09</h><w>kulminaator</w>trying to use the newer jetty utils from 9.3.x or 9.4.x series are broken in different ways</z><z id="t1544279557" t="Alex Miller (Clojure team) without using any external deps, you should be getting 9.3.7.v20160115"><y>#</y><d>2018-12-08</d><h>14:32</h><w>Alex Miller (Clojure team)</w>without using any external deps, you should be getting 9.3.7.v20160115</z><z id="t1544279569" t="Alex Miller (Clojure team) do you have other deps in use?"><y>#</y><d>2018-12-08</d><h>14:32</h><w>Alex Miller (Clojure team)</w>do you have other deps in use?</z><z id="t1544279719" t="Alex Miller (Clojure team) I guess that’s what you’re seeing above"><y>#</y><d>2018-12-08</d><h>14:35</h><w>Alex Miller (Clojure team)</w>I guess that’s what you’re seeing above</z><z id="t1544279769" t="Alex Miller (Clojure team) With Java 11, I’m not seeing that warning, would be curious what you’re on"><y>#</y><d>2018-12-08</d><h>14:36</h><w>Alex Miller (Clojure team)</w>With Java 11, I’m not seeing that warning, would be curious what you’re on</z><z id="t1544279927" t="Alex Miller (Clojure team) Although the reflector resolution can vary between JDKs and runs so it’s possible I’m just luckier. It’s important to note though that this is a warning, not an error and the code should work just fine."><y>#</y><d>2018-12-08</d><h>14:38</h><w>Alex Miller (Clojure team)</w>Although the reflector resolution can vary between JDKs and runs so it’s possible I’m just luckier. It’s important to note though that this is a warning, not an error and the code should work just fine.</z><z id="t1544279999" t="Alex Miller (Clojure team) I think it’d be helpful to leave a github issue at https://github.com/cognitect-labs/aws-api/issues - certainly worth doing whatever is needed to update the http-client deps"><y>#</y><d>2018-12-08</d><h>14:39</h><w>Alex Miller (Clojure team)</w>I think it’d be helpful to leave a github issue at <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> - certainly worth doing whatever is needed to update the http-client deps</z><z id="t1544286070" t="kulminaator i will try to reproduce and give the details there"><y>#</y><d>2018-12-08</d><h>16:21</h><w>kulminaator</w>i will try to reproduce and give the details there</z><z id="t1544287239" t="kulminaator reproduced on a clean sheet , https://github.com/cognitect-labs/aws-api/issues/19 added details here. not in a hurry with this for now, i will add a middle layer into my actual application so i could switch forth and back between aws-api and aws s3 sdk for a while 🙂"><y>#</y><d>2018-12-08</d><h>16:40</h><w>kulminaator</w>reproduced on a clean sheet , <a href="https://github.com/cognitect-labs/aws-api/issues/19" target="_blank">https://github.com/cognitect-labs/aws-api/issues/19</a>  added details here. not in a hurry with this for now, i will add a middle layer into my actual application so i could switch forth and back between aws-api and aws s3 sdk for a while <b>🙂</b></z><z id="t1544287400" t="kulminaator just in case you&apos;re wondering what i&apos;ll use the s3 for -&gt; i have to make copies of s3 buckets in a point of time ... buckets that reach a few terabytes and have millions of objects inside. multithreading of clojure comes in handy as a single s3 client on a single thread will never be able to finish stuff like that, even if stuff runs on aws ec2 machines &quot;next to the s3&quot; in the same region. latency is killing me there."><y>#</y><d>2018-12-08</d><h>16:43</h><w>kulminaator</w>just in case you&apos;re wondering what i&apos;ll use the s3 for -&gt; i have to make copies of s3 buckets in a point of time ... buckets that reach a few terabytes and have millions of objects inside. multithreading of clojure comes in handy as a single s3 client on a single thread will never be able to finish stuff like that, even if stuff runs on aws ec2 machines &quot;next to the s3&quot; in the same region. latency is killing me there.</z><z id="t1544742028" t="aaelony hi! I’m trying out cognitect.aws.credentials and cognitect.aws.client.api for the first time. I think I’ve constructed my creds map properly, but I get a stacktrace when I attempt to create the client: (type (credentials/basic-credentials-provider creds)) =&gt; cognitect.aws.credentials$basic_credentials_provider$reify__15156 (def client (aws/client {:api :ec2 :credentials-provider (credentials/basic-credentials-provider creds) })) Syntax error (ExceptionInfo) compiling at (REPL:31:13). Cannot find resource cognitect/aws/ec2/service.edn. Please lmk how to remedy?"><y>#</y><d>2018-12-13</d><h>23:00</h><w>aaelony</w>hi!  I’m trying out cognitect.aws.credentials and cognitect.aws.client.api for the first time.

I think I’ve constructed my creds map properly, but  I get a stacktrace when I attempt to create the client: <pre>(type (credentials/basic-credentials-provider creds)) =&gt; cognitect.aws.credentials$basic_credentials_provider$reify__15156

(def client (aws/client {:api :ec2
                         :credentials-provider (credentials/basic-credentials-provider creds)
                         }))
</pre>
<pre>Syntax error (ExceptionInfo) compiling at (REPL:31:13).
Cannot find resource cognitect/aws/ec2/service.edn. </pre>

Please lmk how to remedy?</z><z id="t1544742118" t="aaelony (keys creds) =&gt; (:access-key-id :secret-access-key)"><y>#</y><d>2018-12-13</d><h>23:01</h><w>aaelony</w><pre>(keys creds) =&gt; (:access-key-id :secret-access-key)</pre></z><z id="t1544742130" t="aaelony thanks in advance"><y>#</y><d>2018-12-13</d><h>23:02</h><w>aaelony</w>thanks in advance</z><z id="t1544742539" t="Alex Miller (Clojure team) Looks like maybe you don’t have the ec2 jar in your deps?"><y>#</y><d>2018-12-13</d><h>23:08</h><w>Alex Miller (Clojure team)</w>Looks like maybe you don’t have the ec2 jar in your deps?</z><z id="t1544742651" t="aaelony could be… my first foray using the deps.edn ecosystem rather than leiningen as well"><y>#</y><d>2018-12-13</d><h>23:10</h><w>aaelony</w>could be… my first foray using the deps.edn ecosystem rather than leiningen as well</z><z id="t1544742654" t="aaelony thanks"><y>#</y><d>2018-12-13</d><h>23:10</h><w>aaelony</w>thanks</z><z id="t1544742698" t="Alex Miller (Clojure team) You should have at least 3 deps - api, endpoints, and whatever service(s) you’re hitting"><y>#</y><d>2018-12-13</d><h>23:11</h><w>Alex Miller (Clojure team)</w>You should have at least 3 deps - api, endpoints, and whatever service(s) you’re hitting</z><z id="t1544814621" t="aaelony Hi Alex, I have the api and endpoints resolving well. Could you give me a hint as to the correct way to specify the ec2 service?"><y>#</y><d>2018-12-14</d><h>19:10</h><r>aaelony</r>Hi Alex, I have the api and endpoints resolving well. Could you give me a hint as to the correct way to specify the ec2 service?</z><z id="t1544814650" t="aaelony or a simple example that launches an ec2 instance that I can ssh into then shutdown?"><y>#</y><d>2018-12-14</d><h>19:10</h><r>aaelony</r>or a simple example that launches an ec2 instance that I can ssh into then shutdown?</z><z id="t1544815460" t="Alex Miller (Clojure team) sorry, I’m not an expert on ec2 - if you have something that isn’t working, you could post the code as an issue on the aws repo though"><y>#</y><d>2018-12-14</d><h>19:24</h><r>Alex Miller (Clojure team)</r>sorry, I’m not an expert on ec2 - if you have something that isn’t working, you could post the code as an issue on the aws repo though</z><z id="t1544815785" t="aaelony sure, will do. It’s basically the examples/ec2_examples.clj that doesn’t work"><y>#</y><d>2018-12-14</d><h>19:29</h><r>aaelony</r>sure, will do.  It’s basically the examples/ec2_examples.clj that doesn’t work</z><z id="t1544815814" t="aaelony (at least for me)"><y>#</y><d>2018-12-14</d><h>19:30</h><r>aaelony</r>(at least for me)</z><z id="t1544816167" t="Alex Miller (Clojure team) well please log so David or someone else can take a look"><y>#</y><d>2018-12-14</d><h>19:36</h><r>Alex Miller (Clojure team)</r>well please log so David or someone else can take a look</z><z id="t1544816174" t="aaelony will do"><y>#</y><d>2018-12-14</d><h>19:36</h><r>aaelony</r>will do</z><z id="t1544816182" t="Alex Miller (Clojure team) thx"><y>#</y><d>2018-12-14</d><h>19:36</h><r>Alex Miller (Clojure team)</r>thx</z><z id="t1544742730" t="aaelony ah - I only have api, and credentials"><y>#</y><d>2018-12-13</d><h>23:12</h><w>aaelony</w>ah - I only have api, and credentials</z><z id="t1544742737" t="aaelony that must be it"><y>#</y><d>2018-12-13</d><h>23:12</h><w>aaelony</w>that must be it</z><z id="t1544742818" t="aaelony btw, I was literally just following https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj"><y>#</y><d>2018-12-13</d><h>23:13</h><w>aaelony</w>btw, I was literally just following <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj</a></z><z id="t1544742882" t="chrisulloa To use s3 I had to bring this into my project.clj [com.cognitect.aws/s3 “680.2.370.0”]"><y>#</y><d>2018-12-13</d><h>23:14</h><w>chrisulloa</w>To use s3 I had to bring this into my project.clj [com.cognitect.aws/s3 “680.2.370.0”]</z><z id="t1544742891" t="chrisulloa Does adding [com.cognitect.aws/ec2 “681.2.373.0”] make this work for you?"><y>#</y><d>2018-12-13</d><h>23:14</h><w>chrisulloa</w>Does adding [com.cognitect.aws/ec2 “681.2.373.0”] make this work for you?</z><z id="t1544742998" t="chrisulloa Per https://github.com/cognitect-labs/aws-api/blob/a0d22509b06cb6c4823197988c77d2c8780981d4/latest-releases.edn"><y>#</y><d>2018-12-13</d><h>23:16</h><w>chrisulloa</w>Per <a href="https://github.com/cognitect-labs/aws-api/blob/a0d22509b06cb6c4823197988c77d2c8780981d4/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/a0d22509b06cb6c4823197988c77d2c8780981d4/latest-releases.edn</a></z><z id="t1544743153" t="chrisulloa You might also have to provide region as well, if your creds/region aren’t configured in your environment."><y>#</y><d>2018-12-13</d><h>23:19</h><w>chrisulloa</w>You might also have to provide region as well, if your creds/region aren’t configured in your environment.</z><z id="t1544743185" t="aaelony I’ll need to read up a bit more before proceeding…"><y>#</y><d>2018-12-13</d><h>23:19</h><w>aaelony</w>I’ll need to read up a bit more before proceeding…</z><z id="t1544743318" t="chrisulloa (aws/client {:api :ec2, :region &quot;us-east-1&quot;, :credentials-provider (basic-credentials-provider {:access-key-id &quot;&quot; :secret-access-key &quot;&quot;})})"><y>#</y><d>2018-12-13</d><h>23:21</h><w>chrisulloa</w><pre>(aws/client {:api :ec2, :region &quot;us-east-1&quot;, :credentials-provider (basic-credentials-provider {:access-key-id &quot;&quot; :secret-access-key &quot;&quot;})})</pre></z><z id="t1544744848" t="thedavidmeister [:attrs {:href &quot;/_/_/users/UEV2BNGFQ&quot;}]"><y>#</y><d>2018-12-13</d><h>23:47</h><w>thedavidmeister</w><a>@simon223</a></z><z id="t1544745153" t="simesy hey [:attrs {:href &quot;/_/_/users/U0D4G0Q4U&quot;}]"><y>#</y><d>2018-12-13</d><h>23:52</h><w>simesy</w>hey <a>@thedavidmeister</a></z><z id="t1544745165" t="thedavidmeister howdy"><y>#</y><d>2018-12-13</d><h>23:52</h><w>thedavidmeister</w>howdy</z><z id="t1544861184" t="viesti https://www.nuweba.com/AWS-Lambda-in-a-VPC-will-soon-be-faster"><y>#</y><d>2018-12-15</d><h>08:06</h><w>viesti</w><a href="https://www.nuweba.com/AWS-Lambda-in-a-VPC-will-soon-be-faster" target="_blank">https://www.nuweba.com/AWS-Lambda-in-a-VPC-will-soon-be-faster</a></z><z id="t1544963844" t="viesti hum, there’s com.cognitect.aws/apigateway but didn’t manage to list api gateway api’s with it"><y>#</y><d>2018-12-16</d><h>12:37</h><w>viesti</w>hum, there’s com.cognitect.aws/apigateway but didn’t manage to list api gateway api’s with it</z><z id="t1544963874" t="viesti was actually looking that is there HAL support in the lib"><y>#</y><d>2018-12-16</d><h>12:37</h><w>viesti</w>was actually looking that is there HAL support in the lib</z><z id="t1545159419" t="aaelony is there a way to retrieve the current instance type price via the ec2 API? Would be cool to compute an expected monetary cost before performing an action…"><y>#</y><d>2018-12-18</d><h>18:56</h><w>aaelony</w>is there a way to retrieve the current instance type price via the ec2 API?  Would be cool to compute an expected monetary cost before performing an action…</z><z id="t1545159445" t="aaelony I do see :DescribeSpotPriceHistory, which is a start"><y>#</y><d>2018-12-18</d><h>18:57</h><w>aaelony</w>I do see :DescribeSpotPriceHistory, which is a start</z><z id="t1545159539" t="aaelony I guess there must be a JSON spec for the pricing list ( https://aws.amazon.com/ec2/pricing/on-demand/ ) somewhere…"><y>#</y><d>2018-12-18</d><h>18:58</h><w>aaelony</w>I guess there must be a JSON spec for the pricing list (<a href="https://aws.amazon.com/ec2/pricing/on-demand/" target="_blank">https://aws.amazon.com/ec2/pricing/on-demand/</a>) somewhere…</z><z id="t1545163085" t="aaelony I found this: https://aws.amazon.com/blogs/aws/new-aws-price-list-api/"><y>#</y><d>2018-12-18</d><h>19:58</h><w>aaelony</w>I found this: <a href="https://aws.amazon.com/blogs/aws/new-aws-price-list-api/" target="_blank">https://aws.amazon.com/blogs/aws/new-aws-price-list-api/</a></z><z id="t1545163397" t="aaelony https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/index.json"><y>#</y><d>2018-12-18</d><h>20:03</h><w>aaelony</w><a href="https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/index.json" target="_blank">https://pricing.us-east-1.amazonaws.com/offers/v1.0/aws/AmazonEC2/current/index.json</a></z><z id="t1545230957" t="cjsauer It looks like API Gateway just received WebSocket support! https://aws.amazon.com/blogs/compute/announcing-websocket-apis-in-amazon-api-gateway/"><y>#</y><d>2018-12-19</d><h>14:49</h><w>cjsauer</w>It looks like API Gateway just received WebSocket support!
<a href="https://aws.amazon.com/blogs/compute/announcing-websocket-apis-in-amazon-api-gateway/" target="_blank">https://aws.amazon.com/blogs/compute/announcing-websocket-apis-in-amazon-api-gateway/</a></z><z id="t1545231055" t="cjsauer I see there are new descriptors for apigatewayv2, and apigatewaymanagementapi. Both 11-29-2018. https://github.com/aws/aws-sdk-js/tree/master/apis"><y>#</y><d>2018-12-19</d><h>14:50</h><w>cjsauer</w>I see there are new descriptors for apigatewayv2, and apigatewaymanagementapi. Both 11-29-2018. 
<a href="https://github.com/aws/aws-sdk-js/tree/master/apis" target="_blank">https://github.com/aws/aws-sdk-js/tree/master/apis</a></z><z id="t1545231633" t="cjsauer Issue for WebSocket support in the aws-api project: https://github.com/cognitect-labs/aws-api/issues/29"><y>#</y><d>2018-12-19</d><h>15:00</h><w>cjsauer</w>Issue for WebSocket support in the <code>aws-api</code> project: <a href="https://github.com/cognitect-labs/aws-api/issues/29" target="_blank">https://github.com/cognitect-labs/aws-api/issues/29</a></z><z id="t1545255348" t="aaelony I’m using the com.cognitect.aws/api library (which is fantastic). I’m seeing a “WARNING: An illegal reflective access operation has occurred” message. Everything works, but the message is annoying. Has anyone else encountered this?"><y>#</y><d>2018-12-19</d><h>21:35</h><w>aaelony</w>I’m using the com.cognitect.aws/api library (which is fantastic).  I’m seeing a “WARNING: An illegal reflective access operation has occurred” message.  Everything works, but the message is annoying. Has anyone else encountered this?</z><z id="t1545256942" t="chrisulloa [:attrs {:href &quot;/_/_/users/U0CDMAKD0&quot;}] What version of java are you running?"><y>#</y><d>2018-12-19</d><h>22:02</h><w>chrisulloa</w><a>@aaelony</a> What version of java are you running?</z><z id="t1545257619" t="aaelony $ java -version openjdk version &quot;11.0.1&quot; 2018-10-16 OpenJDK Runtime Environment 18.9 (build 11.0.1+13) OpenJDK 64-Bit Server VM 18.9 (build 11.0.1+13, mixed mode) "><y>#</y><d>2018-12-19</d><h>22:13</h><w>aaelony</w><pre>$ java -version
openjdk version &quot;11.0.1&quot; 2018-10-16
OpenJDK Runtime Environment 18.9 (build 11.0.1+13)
OpenJDK 64-Bit Server VM 18.9 (build 11.0.1+13, mixed mode) </pre></z><z id="t1545258455" t="chrisulloa Does it mention which dependency is the culprit? Moving over to Java 11 from Java 8 causes a lot of illegal reflective access op warnings for many libraries. For us it was specifically the protobuf library which isn’t fully supported for Java 11 yet. I’m not seeing this occur with com.cognitect.aws/api on java 11 however so it might be another dependency in your code."><y>#</y><d>2018-12-19</d><h>22:27</h><w>chrisulloa</w>Does it mention which dependency is the culprit? Moving over to Java 11 from Java 8 causes a lot of illegal reflective access op warnings for many libraries. For us it was specifically the protobuf library which isn’t fully supported for Java 11 yet. I’m not seeing this occur with com.cognitect.aws/api on java 11 however so it might be another dependency in your code.</z><z id="t1545258570" t="aaelony Here’s the full set of warnings to the console: WARNING: An illegal reflective access operation has occurred WARNING: Illegal reflective access by org.eclipse.jetty.util.BufferUtil (file:/Users/aaelony/.m2/repository/org/eclipse/jetty/jetty-util/9.3.7.v20160115/jetty-util-9.3.7.v20160115.jar) to field java.nio.MappedByteBuffer.fd WARNING: Please consider reporting this to the maintainers of org.eclipse.jetty.util.BufferUtil WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations WARNING: All illegal access operations will be denied in a future release "><y>#</y><d>2018-12-19</d><h>22:29</h><w>aaelony</w>Here’s the full set of warnings to the console: <pre>WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.eclipse.jetty.util.BufferUtil (file:/Users/aaelony/.m2/repository/org/eclipse/jetty/jetty-util/9.3.7.v20160115/jetty-util-9.3.7.v20160115.jar) to field java.nio.MappedByteBuffer.fd
WARNING: Please consider reporting this to the maintainers of org.eclipse.jetty.util.BufferUtil
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
</pre></z><z id="t1545258610" t="aaelony probably not the right place to post in the #aws channel, I suppose"><y>#</y><d>2018-12-19</d><h>22:30</h><w>aaelony</w>probably not the right place to post in the #aws channel, I suppose</z><z id="t1545264665" t="Alex Miller (Clojure team) https://clojure.org/guides/faq#illegal_access"><y>#</y><d>2018-12-20</d><h>00:11</h><w>Alex Miller (Clojure team)</w><a href="https://clojure.org/guides/faq#illegal_access" target="_blank">https://clojure.org/guides/faq#illegal_access</a></z><z id="t1545264698" t="Alex Miller (Clojure team) ^^ for general info"><y>#</y><d>2018-12-20</d><h>00:11</h><w>Alex Miller (Clojure team)</w>^^ for general info</z><z id="t1545264729" t="Alex Miller (Clojure team) I think in this particular case, it’s fixed in newer versions of jetty and those may get bumped in the deps chain soon"><y>#</y><d>2018-12-20</d><h>00:12</h><w>Alex Miller (Clojure team)</w>I think in this particular case, it’s fixed in newer versions of jetty and those may get bumped in the deps chain soon</z><z id="t1545267798" t="aaelony cool, thanks once again"><y>#</y><d>2018-12-20</d><h>01:03</h><w>aaelony</w>cool, thanks once again</z><z id="t1545268557" t="aaelony sheesh to illegal access... Clojure is not a crime! ;)"><y>#</y><d>2018-12-20</d><h>01:15</h><w>aaelony</w>sheesh to illegal access... Clojure is not a crime! ;)</z><z id="t1545315081" t="viesti hmm"><y>#</y><d>2018-12-20</d><h>14:11</h><w>viesti</w>hmm</z><z id="t1545315090" t="viesti 0% cat deps.edn {:deps {org.clojure/clojure {:mvn/version &quot;1.10.0&quot;} com.cognitect.aws/api {:mvn/version &quot;0.8.158&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.467&quot;} com.cognitect.aws/s3 {:mvn/version &quot;680.2.370.0&quot;} com.cognitect.aws/apigateway {:mvn/version &quot;668.2.364.0&quot;}}} "><y>#</y><d>2018-12-20</d><h>14:11</h><w>viesti</w><pre>0% cat deps.edn
{:deps {org.clojure/clojure {:mvn/version &quot;1.10.0&quot;}
        com.cognitect.aws/api {:mvn/version &quot;0.8.158&quot;}
        com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.467&quot;}
        com.cognitect.aws/s3 {:mvn/version &quot;680.2.370.0&quot;}
        com.cognitect.aws/apigateway {:mvn/version &quot;668.2.364.0&quot;}}}
</pre></z><z id="t1545315108" t="viesti wonder where to look next"><y>#</y><d>2018-12-20</d><h>14:11</h><w>viesti</w>wonder where to look next</z><z id="t1545315469" t="Alex Miller (Clojure team) is the problem that you don’t have any or that you can’t see them?"><y>#</y><d>2018-12-20</d><h>14:17</h><w>Alex Miller (Clojure team)</w>is the problem that you don’t have any or that you can’t see them?</z><z id="t1545315483" t="Alex Miller (Clojure team) a check with aws console would tell you the answer"><y>#</y><d>2018-12-20</d><h>14:18</h><w>Alex Miller (Clojure team)</w>a check with aws console would tell you the answer</z><z id="t1545315512" t="Alex Miller (Clojure team) iam may also be affecting what you see I presume"><y>#</y><d>2018-12-20</d><h>14:18</h><w>Alex Miller (Clojure team)</w>iam may also be affecting what you see I presume</z><z id="t1545315541" t="Alex Miller (Clojure team) oh, you checked at the end, I didn’t see that"><y>#</y><d>2018-12-20</d><h>14:19</h><w>Alex Miller (Clojure team)</w>oh, you checked at the end, I didn’t see that</z><z id="t1545315646" t="Alex Miller (Clojure team) I believe the request / response stuff is in the meta of the op return - that might tell you something"><y>#</y><d>2018-12-20</d><h>14:20</h><w>Alex Miller (Clojure team)</w>I believe the request / response stuff is in the meta of the op return - that might tell you something</z><z id="t1545322021" t="viesti haa, there’s stuff in the (-&gt; (meta response) :http-response :body slurp)"><y>#</y><d>2018-12-20</d><h>16:07</h><w>viesti</w>haa, there’s stuff in the <code>(-&gt; (meta response) :http-response :body slurp)</code></z><z id="t1545322032" t="viesti I guess it’s just not deserialized?"><y>#</y><d>2018-12-20</d><h>16:07</h><w>viesti</w>I guess it’s just not deserialized?</z><z id="t1545322070" t="viesti user=&gt; (-&gt; (meta response) :http-response :body slurp) &quot;{\&quot;_links\&quot;:{\&quot;curies\&quot;:[{\&quot;href\&quot;:\&quot;&quot;,\&quot;name\&quot;:\&quot;authorizer\&quot;,\... "><y>#</y><d>2018-12-20</d><h>16:07</h><w>viesti</w><pre>user=&gt; (-&gt; (meta response) :http-response :body slurp)
&quot;{\&quot;_links\&quot;:{\&quot;curies\&quot;:[{\&quot;href\&quot;:\&quot;&quot;,\&quot;name\&quot;:\&quot;authorizer\&quot;,\...
</pre></z><z id="t1545322479" t="chrisulloa In other SDKs like the javascript SDK, the http response body is a string. Probably makes sense because I don’t think response body is consistently json across all endpoints."><y>#</y><d>2018-12-20</d><h>16:14</h><w>chrisulloa</w>In other SDKs like the javascript SDK, the http response body is a string. Probably makes sense because I don’t think response body is consistently json across all endpoints.</z><z id="t1545322503" t="viesti yeah, S3 api is XML"><y>#</y><d>2018-12-20</d><h>16:15</h><w>viesti</w>yeah, S3 api is XML</z><z id="t1545322510" t="viesti over 10 years old"><y>#</y><d>2018-12-20</d><h>16:15</h><w>viesti</w>over 10 years old</z><z id="t1545322599" t="viesti Api Gateway is this funny Hypertext Application Language (HAL) thing https://docs.aws.amazon.com/apigateway/api-reference/index.html"><y>#</y><d>2018-12-20</d><h>16:16</h><w>viesti</w>Api Gateway is this funny Hypertext Application Language (HAL) thing <a href="https://docs.aws.amazon.com/apigateway/api-reference/index.html" target="_blank">https://docs.aws.amazon.com/apigateway/api-reference/index.html</a></z><z id="t1545322672" t="viesti would be well suited for Datafy/nav I guess 🙂"><y>#</y><d>2018-12-20</d><h>16:17</h><w>viesti</w>would be well suited for Datafy/nav I guess <b>🙂</b></z><z id="t1545322674" t="chrisulloa I’ve never seen HAL before interesting"><y>#</y><d>2018-12-20</d><h>16:17</h><w>chrisulloa</w>I’ve never seen HAL before interesting</z><z id="t1545322698" t="viesti some other aws api uses HAL too, don’t remember which now"><y>#</y><d>2018-12-20</d><h>16:18</h><w>viesti</w>some other aws api uses HAL too, don’t remember which now</z><z id="t1545322723" t="viesti where’s my rebl now"><y>#</y><d>2018-12-20</d><h>16:18</h><w>viesti</w>where’s my rebl now</z><z id="t1545323089" t="viesti maybe something like this to unhal: https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/aws.clj#L182-L197"><y>#</y><d>2018-12-20</d><h>16:24</h><w>viesti</w>maybe something like this to unhal: <a href="https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/aws.clj#L182-L197" target="_blank">https://github.com/portkey-cloud/aws-clj-sdk/blob/master/src/portkey/aws.clj#L182-L197</a></z><z id="t1545323198" t="viesti but hum, trying to grok how the deserialization is done in aws-api"><y>#</y><d>2018-12-20</d><h>16:26</h><w>viesti</w>but hum, trying to grok how the deserialization is done in aws-api</z><z id="t1545324356" t="viesti anyway, response in metadata is a neat thing, it means the lib is usable even though there isn’t a parser for the response yet"><y>#</y><d>2018-12-20</d><h>16:45</h><w>viesti</w>anyway, response in metadata is a neat thing, it means the lib is usable even though there isn’t a parser for the response yet</z><z id="t1545325712" t="Alex Miller (Clojure team) if it’s not yet, it would be good to file an issue for aws-api"><y>#</y><d>2018-12-20</d><h>17:08</h><w>Alex Miller (Clojure team)</w>if it’s not yet, it would be good to file an issue for aws-api</z><z id="t1545328499" t="viesti filed https://github.com/cognitect-labs/aws-api/issues/30 , just had to make sure I did’t do something foolish myself 🙂"><y>#</y><d>2018-12-20</d><h>17:54</h><w>viesti</w>filed <a href="https://github.com/cognitect-labs/aws-api/issues/30" target="_blank">https://github.com/cognitect-labs/aws-api/issues/30</a>, just had to make sure I did’t do something foolish myself <b>🙂</b></z><z id="t1546379223" t="kaffein hey guys!!!"><y>#</y><d>2019-01-01</d><h>21:47</h><w>kaffein</w>hey guys!!!</z><z id="t1546379254" t="kaffein not sure whether someone has already played with the aws-api but I have a question related to the client configuration please!!"><y>#</y><d>2019-01-01</d><h>21:47</h><w>kaffein</w>not sure whether someone has already played with the aws-api but I have a question related to the client configuration please!!</z><z id="t1546379336" t="kaffein while trying to configure an s3 client (based on the example on github), it seems that at some point, the lib is trying to look for a service description (an edn file according to the code)"><y>#</y><d>2019-01-01</d><h>21:48</h><w>kaffein</w>while trying to configure an s3 client (based on the example on github), it seems that at some point, the lib is trying to look for a service description (an edn file according to the code)</z><z id="t1546379437" t="kaffein Here it is from cognitect.aws.client.api"><y>#</y><d>2019-01-01</d><h>21:50</h><w>kaffein</w>Here it is from cognitect.aws.client.api</z><z id="t1546379489" t="kaffein And here is the function implementation"><y>#</y><d>2019-01-01</d><h>21:51</h><w>kaffein</w>And here is the function implementation</z><z id="t1546379550" t="kaffein the read-service-description function seems to be pointing to a file whose name is (str base-resource-path &quot;/&quot; service-name &quot;/service.edn&quot;)"><y>#</y><d>2019-01-01</d><h>21:52</h><w>kaffein</w>the <code>read-service-description</code> function seems to be pointing to a file whose name is <code>(str base-resource-path &quot;/&quot; service-name &quot;/service.edn&quot;)</code></z><z id="t1546379577" t="kaffein so for s3, it should be something like blabla/s3/service.edn ...though I couldn’t find any such file in the codebase"><y>#</y><d>2019-01-01</d><h>21:52</h><w>kaffein</w>so for s3, it should be something like <code>blabla/s3/service.edn</code> ...though I couldn’t find any such file in the codebase</z><z id="t1546379595" t="kaffein does anyone know where i’m missing something please 😉"><y>#</y><d>2019-01-01</d><h>21:53</h><w>kaffein</w>does anyone know where i’m missing something please <b>😉</b></z><z id="t1546381320" t="Alex Miller (Clojure team) Using one of the services requires three libs - the api, the endpoints, and the service"><y>#</y><d>2019-01-01</d><h>22:22</h><w>Alex Miller (Clojure team)</w>Using one of the services requires three libs - the api, the endpoints, and the service</z><z id="t1546381362" t="Alex Miller (Clojure team) Sounds to me like you have the first one but are missing one or both of the latter"><y>#</y><d>2019-01-01</d><h>22:22</h><w>Alex Miller (Clojure team)</w>Sounds to me like you have the first one but are missing one or both of the latter</z><z id="t1546381363" t="kaffein these 3 right ? [com.cognitect.aws/api “0.8.166”] [com.cognitect.aws/endpoints “1.1.11.475&quot;] [com.cognitect.aws/s3 “680.2.370.0”]"><y>#</y><d>2019-01-01</d><h>22:22</h><w>kaffein</w>these 3 right ? [com.cognitect.aws/api “0.8.166”]
                 [com.cognitect.aws/endpoints “1.1.11.475&quot;]
                 [com.cognitect.aws/s3 “680.2.370.0”]</z><z id="t1546381440" t="Alex Miller (Clojure team) Yes"><y>#</y><d>2019-01-01</d><h>22:24</h><w>Alex Miller (Clojure team)</w>Yes</z><z id="t1546381492" t="kaffein I have them but somehow I have this weird behaviour, I will review my configuration first then 😉 I may have made a mistake"><y>#</y><d>2019-01-01</d><h>22:24</h><w>kaffein</w>I have them but somehow I have this weird behaviour, I will review my configuration first then <b>😉</b> I may have made a mistake</z><z id="t1546381496" t="kaffein thanks a lot [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}]"><y>#</y><d>2019-01-01</d><h>22:24</h><w>kaffein</w>thanks a lot <a>@alexmiller</a></z><z id="t1546381516" t="Alex Miller (Clojure team) Those files that it’s trying to look up are in those jars"><y>#</y><d>2019-01-01</d><h>22:25</h><w>Alex Miller (Clojure team)</w>Those files that it’s trying to look up are in those jars</z><z id="t1546381552" t="Alex Miller (Clojure team) I assume that you’re using lein from your dep definition"><y>#</y><d>2019-01-01</d><h>22:25</h><w>Alex Miller (Clojure team)</w>I assume that you’re using lein from your dep definition</z><z id="t1546381567" t="kaffein I do indeed"><y>#</y><d>2019-01-01</d><h>22:26</h><w>kaffein</w>I do indeed</z><z id="t1546381587" t="kaffein I am*"><y>#</y><d>2019-01-01</d><h>22:26</h><w>kaffein</w>I am*</z><z id="t1546381610" t="kaffein but is shouldn’t be a problem whether I use deps or lein right ?"><y>#</y><d>2019-01-01</d><h>22:26</h><w>kaffein</w>but is shouldn’t be a problem whether I use deps or lein right ?</z><z id="t1546381620" t="Alex Miller (Clojure team) Nope"><y>#</y><d>2019-01-01</d><h>22:27</h><w>Alex Miller (Clojure team)</w>Nope</z><z id="t1546381629" t="Alex Miller (Clojure team) Just making sure"><y>#</y><d>2019-01-01</d><h>22:27</h><w>Alex Miller (Clojure team)</w>Just making sure</z><z id="t1546381675" t="Alex Miller (Clojure team) Might be helpful to drop the code"><y>#</y><d>2019-01-01</d><h>22:27</h><w>Alex Miller (Clojure team)</w>Might be helpful to drop the code</z><z id="t1546381712" t="kaffein good idea, I will ...give me a sec 😉"><y>#</y><d>2019-01-01</d><h>22:28</h><w>kaffein</w>good idea, I will ...give me a sec <b>😉</b></z><z id="t1546381820" t="kaffein Here it is"><y>#</y><d>2019-01-01</d><h>22:30</h><w>kaffein</w>Here it is</z><z id="t1546381840" t="kaffein oh jesus 😨"><y>#</y><d>2019-01-01</d><h>22:30</h><w>kaffein</w>oh jesus <b>😨</b></z><z id="t1546381882" t="kaffein do I have to require something else by the way ?"><y>#</y><d>2019-01-01</d><h>22:31</h><w>kaffein</w>do I have to <code>require</code> something else by the way ?</z><z id="t1546381927" t="kaffein"><y>#</y><d>2019-01-01</d><h>22:32</h><w>kaffein</w></z><z id="t1546474490" t="aaelony hi! Does anyone know if there is a programmatic way to discover what AMI s are available in the marketplace? e.g. the identifier of all deep learning AMI s?"><y>#</y><d>2019-01-03</d><h>00:14</h><w>aaelony</w>hi!  Does anyone know if there is a programmatic way to discover what  <code>AMI</code>s are available in the marketplace?  e.g. the identifier of all deep learning <code>AMI</code>s?</z><z id="t1546516793" t="dottedmag [:attrs {:href &quot;/_/_/users/U0CDMAKD0&quot;}] https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html ?"><y>#</y><d>2019-01-03</d><h>11:59</h><w>dottedmag</w><a>@aaelony</a> <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeImages.html</a> ?</z><z id="t1546532241" t="aaelony [:attrs {:href &quot;/_/_/users/U07HVGQJ3&quot;}] that looks interesting. I will check it out. Thank-you"><y>#</y><d>2019-01-03</d><h>16:17</h><w>aaelony</w><a>@dottedmag</a> that looks interesting.  I will check it out. Thank-you</z><z id="t1546539400" t="aaelony hmmm. not sure this is working well just yet, but something along these lines: (defn find-AMIs &quot;Search the `Name` field for a matching string in all available AMIs.&quot; ;; [regex-string] (let [re (re-pattern (str &quot;.*&quot; regex-string &quot;.*&quot;)) ami-maps (:Images (aws/invoke ec2-client {:op :DescribeImages :request {:Filters [{:Public true}] ;;:DryRun true }})) ami-names (-&gt;&gt; ami-maps (mapv :Name) (filterv #(not (nil? %)))) ami-name-matches (-&gt;&gt; ami-names (filterv #(re-matches re))) ] (vec ami-name-matches) ))"><y>#</y><d>2019-01-03</d><h>18:16</h><w>aaelony</w>hmmm.  not sure this is working well just yet, but something along these lines: <pre>(defn find-AMIs
  &quot;Search the `Name` field for a matching string in all available AMIs.&quot;
  ;; 
  [regex-string]
  (let [re (re-pattern (str &quot;.*&quot; regex-string &quot;.*&quot;))
        ami-maps (:Images (aws/invoke ec2-client {:op :DescribeImages
                                                  :request {:Filters [{:Public true}]
                                                            ;;:DryRun true
                                                            }}))
        ami-names (-&gt;&gt; ami-maps
                      (mapv :Name)
                      (filterv #(not (nil? %))))
        ami-name-matches (-&gt;&gt; ami-names
                              (filterv #(re-matches re)))
        ]
    (vec ami-name-matches)
    ))</pre></z><z id="t1546539466" t="aaelony the idea is that you could then seek out deeplearning AMI’s with (find-AMIs “deeplearning”) or so"><y>#</y><d>2019-01-03</d><h>18:17</h><w>aaelony</w>the idea is that you could then seek out deeplearning AMI’s with (find-AMIs “deeplearning”) or so</z><z id="t1546542274" t="gordon you can also use their filter syntax, this one filters on the Description field but you can do it with Name as well: aws ec2 describe-images --owners amazon --filters &apos;Name=description,Values=*deep learning*&apos; &apos;Name=state,Values=available&apos; --output json - it should be easy enough to do something like that with the function you have there"><y>#</y><d>2019-01-03</d><h>19:04</h><w>gordon</w>you can also use their filter syntax, this one filters on the Description field but you can do it with Name as well: <code>aws ec2 describe-images --owners amazon --filters &apos;Name=description,Values=*deep learning*&apos; &apos;Name=state,Values=available&apos; --output json</code> - it should be easy enough to do something like that with the function you have there</z><z id="t1546542363" t="aaelony I saw that but I didn’t have time to figure it out just yet. If you have a sense for it, please lmk"><y>#</y><d>2019-01-03</d><h>19:06</h><w>aaelony</w>I saw that but I didn’t have time to figure it out just yet.  If you have a sense for it, please lmk</z><z id="t1546542437" t="aaelony also, I believe the AMIs would need “deep*learning” since deeplearning strings are common"><y>#</y><d>2019-01-03</d><h>19:07</h><w>aaelony</w>also, I believe the AMIs would need “deep*learning” since deeplearning strings are common</z><z id="t1546542438" t="gordon Something like: {:Filters [{:State &quot;available&quot;} {:Description (str &quot;*&quot; regex-string &quot;*&quot;)}]}"><y>#</y><d>2019-01-03</d><h>19:07</h><w>gordon</w>Something like: <code>{:Filters [{:State &quot;available&quot;} {:Description (str &quot;*&quot; regex-string &quot;*&quot;)}]}</code></z><z id="t1546542465" t="gordon yeah, you can do that too"><y>#</y><d>2019-01-03</d><h>19:07</h><w>gordon</w>yeah, you can do that too</z><z id="t1546542468" t="aaelony I’ll give that a try"><y>#</y><d>2019-01-03</d><h>19:07</h><w>aaelony</w>I’ll give that a try</z><z id="t1546542696" t="gordon this helps explain what you can do: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Filtering.html#Filtering_Resources_CLI"><y>#</y><d>2019-01-03</d><h>19:11</h><w>gordon</w>this helps explain what you can do: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Filtering.html#Filtering_Resources_CLI" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Filtering.html#Filtering_Resources_CLI</a></z><z id="t1546542763" t="gordon it&apos;s a case-sensitive search, so you might still need to fetch all of them and run them through a filter as you&apos;ve done, just depends on your requirements"><y>#</y><d>2019-01-03</d><h>19:12</h><w>gordon</w>it&apos;s a case-sensitive search, so you might still need to fetch all of them and run them through a filter as you&apos;ve done, just depends on your requirements</z><z id="t1546542766" t="aaelony I recall now, I tried what you suggest and it doesn’t return any results"><y>#</y><d>2019-01-03</d><h>19:12</h><w>aaelony</w>I recall now, I tried what you suggest and it doesn’t return any results</z><z id="t1546542780" t="aaelony That’s why I opted to just use clojure’s filterv"><y>#</y><d>2019-01-03</d><h>19:13</h><w>aaelony</w>That’s why I opted to just use clojure’s filterv</z><z id="t1546542797" t="aaelony but I think it was an error on my part"><y>#</y><d>2019-01-03</d><h>19:13</h><w>aaelony</w>but I think it was an error on my part</z><z id="t1546542812" t="aaelony give me a few minutes, I think I can get it working"><y>#</y><d>2019-01-03</d><h>19:13</h><w>aaelony</w>give me a few minutes, I think I can get it working</z><z id="t1546543044" t="aaelony interesting. I ran one without the filter and one with the filter. Both return a count of 84214."><y>#</y><d>2019-01-03</d><h>19:17</h><w>aaelony</w>interesting.  I ran one without the filter and one with the filter.  Both return a count of 84214.</z><z id="t1546543072" t="aaelony I think there are roughly 116 or so deeplearning AMIs"><y>#</y><d>2019-01-03</d><h>19:17</h><w>aaelony</w>I think there are roughly 116 or so deeplearning AMIs</z><z id="t1546543220" t="aaelony …which is what the filterv version returns"><y>#</y><d>2019-01-03</d><h>19:20</h><w>aaelony</w>…which is what the filterv version returns</z><z id="t1546556217" t="gordon well feel free to ignore that suggestion if it doesn&apos;t work! I kind of want to know why now though, but there&apos;s nothing incorrect about the filter solution certainly, unless you&apos;re worried about API limits or conservation of network resources"><y>#</y><d>2019-01-03</d><h>22:56</h><w>gordon</w>well feel free to ignore that suggestion if it doesn&apos;t work! I kind of want to know why now though, but there&apos;s nothing incorrect about the <code>filter</code> solution certainly, unless you&apos;re worried about API limits or conservation of network resources</z><z id="t1546557186" t="grzm I think I must be missing it, but I don’t see Cloudwatch among the releases for the cognitect aws client api. https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2019-01-03</d><h>23:13</h><w>grzm</w>I think I must be missing it, but I don’t see Cloudwatch among the releases for the cognitect aws client api. <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1546557501" t="grzm Something that would correspond to https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/index.html or https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/cloudwatch/AmazonCloudWatchClient.html"><y>#</y><d>2019-01-03</d><h>23:18</h><w>grzm</w>Something that would correspond to <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/index.html" target="_blank">https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/index.html</a> or <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/cloudwatch/AmazonCloudWatchClient.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/cloudwatch/AmazonCloudWatchClient.html</a></z><z id="t1546558783" t="Alex Miller (Clojure team) Might be best to file a github issue so this doesn’t get lost - I don’t know off the top of my head"><y>#</y><d>2019-01-03</d><h>23:39</h><w>Alex Miller (Clojure team)</w>Might be best to file a github issue so this doesn’t get lost - I don’t know off the top of my head</z><z id="t1546559182" t="grzm https://github.com/cognitect-labs/aws-api/issues/32"><y>#</y><d>2019-01-03</d><h>23:46</h><w>grzm</w><a href="https://github.com/cognitect-labs/aws-api/issues/32" target="_blank">https://github.com/cognitect-labs/aws-api/issues/32</a></z><z id="t1546561358" t="grzm . [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] followed up in the ticket: it’s in the monitoring endpoint"><y>#</y><d>2019-01-04</d><h>00:22</h><r>grzm</r>.<a>@U0ENYLGTA</a> followed up in the ticket: it’s in the <code>monitoring</code> endpoint</z><z id="t1546559996" t="aaelony [:attrs {:href &quot;/_/_/users/U1GEY70F5&quot;}] , I don’t doubt there is a way to make the filter part work in the request. I just haven’t found it yet and the clojure side filter does in fact work. At some point, I hope to be able to devote time to figuring out the request side filter but can’t at the moment (and the workaround suffices)"><y>#</y><d>2019-01-03</d><h>23:59</h><w>aaelony</w><a>@gws</a>, I don’t doubt there is a way to make the filter part work in the request.  I just haven’t found it yet and the clojure side filter does in fact work.  At some point, I hope to be able to devote time to figuring out the request side filter but can’t at the moment (and the workaround suffices)</z><z id="t1546744252" t="caleb.macdonaldblack How could I do a &quot;stateful transducer&quot; at a cloud infrastructural level? I&apos;m thinking a lambda stores the new state in some states db then lookup the state value on each transformation step given some id that identifies the record in a collection/source. I would need to use SQS or Kinesis Data Streams to ensure the records are given to the lambda in the correct order. The lamdba would be transforming data from many sources and collections and would need to use the current state associated to the collection of that record being transformed. The streams would run indefinitely and so the state would never be deleted. So I guess my questions are: 1. Is this a good way of solving this problem? If not what are some alternatives? 2. What datastore should I use for storing the state. Everything seems overkill for just a single state value per collection on what is likely to be a few hundred collections 3. If a record ever lost, I couldn&apos;t simply just resend it as all later records would have been transformed with an out of sync state. Given the nature of the problem I&apos;ve solving this happening will have extremely little effect on the transformed data. But this seems like a red flag to me. Perhaps I&apos;m approaching this the wrong way? Any advice is appreciated"><y>#</y><d>2019-01-06</d><h>03:10</h><w>caleb.macdonaldblack</w>How could I do a &quot;stateful transducer&quot; at a cloud infrastructural level? I&apos;m thinking a lambda stores the new state in some states db then lookup the state value on each transformation step given some id that identifies the record in a collection/source. I would need to use SQS or Kinesis Data Streams to ensure the records are given to the lambda in the correct order. The lamdba would be transforming data from many sources and collections and would need to use the current state associated to the collection of that record being transformed. The streams would run indefinitely and so the state would never be deleted.

So I guess my questions are:
1. Is this a good way of solving this problem? If not what are some alternatives?
2. What datastore should I use for storing the state. Everything seems overkill for just a single state value per collection on what is likely to be a few hundred collections
3. If a record ever lost, I couldn&apos;t simply just resend it as all later records would have been transformed with an out of sync state. Given the nature of the problem I&apos;ve solving this happening will have extremely little effect on the transformed data. But this seems like a red flag to me. Perhaps I&apos;m approaching this the wrong way?

Any advice is appreciated</z><z id="t1546745720" t="lloydshark [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] Just FYI. You can also use a dynamo db stream as a mechanism to process the records in order."><y>#</y><d>2019-01-06</d><h>03:35</h><w>lloydshark</w><a>@caleb.macdonaldblack</a> Just FYI. You can also use a dynamo db stream as a mechanism to process the records in order.</z><z id="t1546972836" t="chris_johnson [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] What you are looking for is Step Functions, originally Simple Workflow"><y>#</y><d>2019-01-08</d><h>18:40</h><w>chris_johnson</w><a>@caleb.macdonaldblack</a> What you are looking for is Step Functions, originally Simple Workflow</z><z id="t1547168650" t="kenny Anyone know how the com.cognitect.aws/endpoints artifact is generated?"><y>#</y><d>2019-01-11</d><h>01:04</h><w>kenny</w>Anyone know how the <code>com.cognitect.aws/endpoints</code> artifact is generated?</z><z id="t1547474321" t="dazld hey hey, anyone alive? 😉"><y>#</y><d>2019-01-14</d><h>13:58</h><w>dazld</w>hey hey, anyone alive? <b>😉</b></z><z id="t1547474331" t="dazld been trying out the cognitect library"><y>#</y><d>2019-01-14</d><h>13:58</h><w>dazld</w>been trying out the cognitect library</z><z id="t1547474335" t="dazld specifically the KMS part"><y>#</y><d>2019-01-14</d><h>13:58</h><w>dazld</w>specifically the KMS part</z><z id="t1547475421" t="dazld so - anyone know where I can find a bit more info about this error? {__type&quot; &quot;InvalidCiphertextException&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}"><y>#</y><d>2019-01-14</d><h>14:17</h><w>dazld</w>so - anyone know where I can find a bit more info about this error? <code>{__type&quot; &quot;InvalidCiphertextException&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}</code></z><z id="t1547552982" t="rickmoynihan what convention are people using to check for errors with cognitects aws-api ?"><y>#</y><d>2019-01-15</d><h>11:49</h><w>rickmoynihan</w>what convention are people using to check for errors with cognitects <code>aws-api</code>?</z><z id="t1547552999" t="rickmoynihan I can’t see it mentioned in the docs"><y>#</y><d>2019-01-15</d><h>11:49</h><w>rickmoynihan</w>I can’t see it mentioned in the docs</z><z id="t1547821859" t="Deano Hi everyone, I hope you are well. I am using the new Cognitect AWS-SDK, I would like to filter on running machines from a specific auto scaling group. The scaling group is stored as a tag on the EC2 machine This is what I have so far, could anyone nudge me in the right direction? (def aws-ec2 (aws/client {:api :ec2})) (aws/invoke aws-ec2 {:op :DescribeInstances :Filter [{:State &quot;running&quot;}]}) I have not included the tag in the example as I am trying to work out how to structure the code"><y>#</y><d>2019-01-18</d><h>14:30</h><w>Deano</w>Hi everyone, I hope you are well. I am using the new Cognitect AWS-SDK, I would like to filter on running machines from a specific auto scaling group. The scaling group is stored as a tag on the EC2 machine

This is what I have so far, could anyone nudge me in the right direction?

<pre>(def aws-ec2 (aws/client {:api :ec2}))
(aws/invoke aws-ec2 {:op :DescribeInstances :Filter [{:State &quot;running&quot;}]})</pre>

I have not included the tag in the example as I am trying to work out how to structure the code</z><z id="t1547824015" t="gordon you should structure the filters according to this: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstances.html"><y>#</y><d>2019-01-18</d><h>15:06</h><w>gordon</w>you should structure the filters according to this: <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstances.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstances.html</a></z><z id="t1547824089" t="gordon does the code you wrote work as written? I&apos;d guess that it wouldn&apos;t because &quot;State&quot; is not a valid filter key"><y>#</y><d>2019-01-18</d><h>15:08</h><w>gordon</w>does the code you wrote work as written? I&apos;d guess that it wouldn&apos;t because &quot;State&quot; is not a valid filter key</z><z id="t1547830492" t="aaelony something akin to (-&gt; % :State :Name) could have the value of “running”"><y>#</y><d>2019-01-18</d><h>16:54</h><w>aaelony</w>something akin to (-&gt; % :State :Name)  could have the value of “running”</z><z id="t1548202340" t="lilactown I’m trying to use the S3 API: (aws/invoke s3 {:op :CreateBucket :request {:Bucket bucket-name}}) but I’m getting: {:Code &quot;IllegalLocationConstraintException&quot;, :Message &quot;The unspecified location constraint is incompatible for the region specific endpoint this request was sent to.&quot;, :RequestId &quot;8542E011B3C15E87&quot;, :HostId &quot;25VZAk6+s/7WJBfr2vHu4TOL36kJo0EXR9eMz1maK4OCanDnGQjU1cZeNPbtbGTxwUAwOPg1Xrc=&quot;} "><y>#</y><d>2019-01-23</d><h>00:12</h><w>lilactown</w>I’m trying to use the S3 API:
<pre>(aws/invoke s3 {:op :CreateBucket :request {:Bucket bucket-name}})
</pre>
but I’m getting:
<pre>{:Code &quot;IllegalLocationConstraintException&quot;,
 :Message
 &quot;The unspecified location constraint is incompatible for the region specific endpoint this request was sent to.&quot;,
 :RequestId &quot;8542E011B3C15E87&quot;,
 :HostId
 &quot;25VZAk6+s/7WJBfr2vHu4TOL36kJo0EXR9eMz1maK4OCanDnGQjU1cZeNPbtbGTxwUAwOPg1Xrc=&quot;}
</pre></z><z id="t1548202356" t="lilactown I’m pretty sure my env defaults to us-west-2"><y>#</y><d>2019-01-23</d><h>00:12</h><w>lilactown</w>I’m pretty sure my env defaults to us-west-2</z><z id="t1548202380" t="lilactown it sounds like I need to specify the LocationConstraint but I can’t figure out how to do that with aws/invoke"><y>#</y><d>2019-01-23</d><h>00:13</h><w>lilactown</w>it sounds like I need to specify the <code>LocationConstraint</code> but I can’t figure out how to do that with <code>aws/invoke</code></z><z id="t1548202466" t="lilactown (aws/invoke s3 {:op :CreateBucket :request {:Bucket bucket-name :LocationConstraint &quot;us-west-2&quot;}}) "><y>#</y><d>2019-01-23</d><h>00:14</h><w>lilactown</w><pre>(aws/invoke s3 {:op :CreateBucket :request {:Bucket bucket-name
                                            :LocationConstraint &quot;us-west-2&quot;}})
</pre></z><z id="t1548202470" t="lilactown doesn’t seem to work 😕"><y>#</y><d>2019-01-23</d><h>00:14</h><w>lilactown</w>doesn’t seem to work <b>😕</b></z><z id="t1548202719" t="lilactown ah: (aws/invoke s3-client {:op :CreateBucket :request {:Bucket &quot;my-unique-bucket-name&quot; :CreateBucketConfiguration {:LocationConstraint &quot;us-west-2&quot;}}}) found in https://github.com/cognitect-labs/aws-api/pull/28/files &gt;_&lt;"><y>#</y><d>2019-01-23</d><h>00:18</h><w>lilactown</w>ah:
<pre>(aws/invoke s3-client {:op :CreateBucket :request {:Bucket &quot;my-unique-bucket-name&quot;
                                                   :CreateBucketConfiguration {:LocationConstraint &quot;us-west-2&quot;}}})
</pre>
found in <a href="https://github.com/cognitect-labs/aws-api/pull/28/files" target="_blank">https://github.com/cognitect-labs/aws-api/pull/28/files</a>
&gt;_&lt;</z><z id="t1548202755" t="lilactown is there a place where I should have seen that in the docs?"><y>#</y><d>2019-01-23</d><h>00:19</h><w>lilactown</w>is there a place where I should have seen that in the docs?</z><z id="t1548672364" t="Deano Hey everyone, I hope you are well! We are writing a Clojure app which will run in an AWS container. We would like to be able to write logs from Clojure into Cloudwatch so we can get to all the logs from one place. I have been reading the AWS documentation and I am not seeing any way of doing this effectively. Could someone point me in the right direction?"><y>#</y><d>2019-01-28</d><h>10:46</h><w>Deano</w>Hey everyone, I hope you are well! We are writing a Clojure app which will run in an AWS container. We would like to be able to write logs from Clojure into Cloudwatch so we can get to all the logs from one place. I have been reading the AWS documentation and I am not seeing any way of doing this effectively. Could someone point me in the right direction?</z><z id="t1548672697" t="dottedmag [:attrs {:href &quot;/_/_/users/UCRFJH56C&quot;}] https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_PutLogEvents.html ?"><y>#</y><d>2019-01-28</d><h>10:51</h><w>dottedmag</w><a>@deanjohnson03</a> <a href="https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_PutLogEvents.html" target="_blank">https://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/API_PutLogEvents.html</a> ?</z><z id="t1548672723" t="dottedmag Here&apos;s Go tool that pushes logs to CloudWatch for the reference: https://github.com/boxfuse/cloudwatchlogs-agent"><y>#</y><d>2019-01-28</d><h>10:52</h><w>dottedmag</w>Here&apos;s Go tool that pushes logs to CloudWatch for the reference: <a href="https://github.com/boxfuse/cloudwatchlogs-agent" target="_blank">https://github.com/boxfuse/cloudwatchlogs-agent</a></z><z id="t1548676746" t="Deano [:attrs {:href &quot;/_/_/users/U07HVGQJ3&quot;}] Thank you, I will check out the links you sent me 🙂"><y>#</y><d>2019-01-28</d><h>11:59</h><w>Deano</w><a>@dottedmag</a> Thank you, I will check out the links you sent me <b>🙂</b></z><z id="t1548678411" t="viesti If you run in ECS, you can use the awslogs docker log driver and stdout/stderr will be shipped to Cloudwatch"><y>#</y><d>2019-01-28</d><h>12:26</h><w>viesti</w>If you run in ECS, you can use the awslogs docker  log driver and stdout/stderr will be shipped to Cloudwatch</z><z id="t1548678482" t="viesti probably good to let someone else than your app to take care of shipping logs to the Cloudwatch service"><y>#</y><d>2019-01-28</d><h>12:28</h><w>viesti</w>probably good to let someone else than your app to take care of shipping logs to the Cloudwatch service</z><z id="t1548685541" t="dottedmag On a regular EC2 their agent can also read and submit logs from files."><y>#</y><d>2019-01-28</d><h>14:25</h><w>dottedmag</w>On a regular EC2 their agent can also read and submit logs from files.</z><z id="t1548687116" t="valtteri ElasticBeanstalk also provides pre-configured log streaming to CloudWatch."><y>#</y><d>2019-01-28</d><h>14:51</h><w>valtteri</w>ElasticBeanstalk also provides pre-configured log streaming to CloudWatch.</z><z id="t1548687152" t="valtteri It might be the easiest one to get started with."><y>#</y><d>2019-01-28</d><h>14:52</h><w>valtteri</w>It might be the easiest one to get started with.</z><z id="t1548687188" t="valtteri https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html"><y>#</y><d>2019-01-28</d><h>14:53</h><w>valtteri</w><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/AWSHowTo.cloudwatchlogs.html</a></z><z id="t1548696198" t="ghadi [:attrs {:href &quot;/_/_/users/UCRFJH56C&quot;}] are you using normal ECS or Fargate?"><y>#</y><d>2019-01-28</d><h>17:23</h><w>ghadi</w><a>@deanjohnson03</a> are you using normal ECS or Fargate?</z><z id="t1548696290" t="Deano Thank you everyone"><y>#</y><d>2019-01-28</d><h>17:24</h><w>Deano</w>Thank you everyone</z><z id="t1548696305" t="Deano [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] we are using Fargate at the moment"><y>#</y><d>2019-01-28</d><h>17:25</h><w>Deano</w><a>@ghadi</a> we are using Fargate at the moment</z><z id="t1548696358" t="ghadi Me too. No agent or API interaction is necessary. If you write your logs to stdout it will go to the configured CloudWatch group/stream"><y>#</y><d>2019-01-28</d><h>17:25</h><w>ghadi</w>Me too. No agent or API interaction is necessary.  If you write your logs to stdout it will go to the configured CloudWatch group/stream</z><z id="t1548696538" t="Deano Oh! Well that makes things a lot simpler 😄"><y>#</y><d>2019-01-28</d><h>17:28</h><w>Deano</w>Oh! Well that makes things a lot simpler <b>😄</b></z><z id="t1548696581" t="Deano Thank you very much, for your help. Thank you everyone for your responses they have been really helpful. I appreciate it 🙂"><y>#</y><d>2019-01-28</d><h>17:29</h><w>Deano</w>Thank you very much, for your help. Thank you everyone for your responses they have been really helpful. I appreciate it <b>🙂</b></z><z id="t1548765553" t="kaffein hi guys"><y>#</y><d>2019-01-29</d><h>12:39</h><w>kaffein</w>hi guys</z><z id="t1548765593" t="kaffein has anyone ever experienced an SSL issue using the aws-api please ?"><y>#</y><d>2019-01-29</d><h>12:39</h><w>kaffein</w>has anyone ever experienced an SSL issue using the aws-api please ?</z><z id="t1548765787" t="kaffein when trying to create an AMI group on AWS, here is my stacktrace"><y>#</y><d>2019-01-29</d><h>12:43</h><w>kaffein</w>when trying to create an AMI group on AWS, here is my stacktrace</z><z id="t1548765926" t="ghadi EC2 API [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}] ?"><y>#</y><d>2019-01-29</d><h>12:45</h><w>ghadi</w>EC2 API <a>@kaffein</a> ?</z><z id="t1548766069" t="kaffein IAM api [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2019-01-29</d><h>12:47</h><w>kaffein</w>IAM api <a>@ghadi</a></z><z id="t1548766170" t="ghadi Which jdk and platform and can you provide any code snippets?"><y>#</y><d>2019-01-29</d><h>12:49</h><w>ghadi</w>Which jdk and platform and can you provide any code snippets?</z><z id="t1548766321" t="kaffein i&apos;m on jdk 10 with clj 1.10 on mac os x"><y>#</y><d>2019-01-29</d><h>12:52</h><w>kaffein</w>i&apos;m on jdk 10 with clj 1.10 on mac os x</z><z id="t1548766346" t="kaffein yes I can provide a snippet, just give me a second so that I can find it please 😉"><y>#</y><d>2019-01-29</d><h>12:52</h><w>kaffein</w>yes I can provide a snippet, just give me a second so that I can find it please <b>😉</b></z><z id="t1548767039" t="kaffein I forgot to push my code so the only thing I&apos;m not sure of is the syntax for the api call on the last line ... but it kinda looks like this [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2019-01-29</d><h>13:03</h><w>kaffein</w>I forgot to push my code so the only thing I&apos;m not sure of is the syntax for the api call on the last line ... but it kinda looks like this <a>@ghadi</a></z><z id="t1548771189" t="ghadi Hmmm I can&apos;t reproduce that [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}] Are you in osx or on a container?"><y>#</y><d>2019-01-29</d><h>14:13</h><w>ghadi</w>Hmmm I can&apos;t reproduce that <a>@kaffein</a>  Are you in osx or on a container?</z><z id="t1548771239" t="kaffein i&apos;m not on a container"><y>#</y><d>2019-01-29</d><h>14:13</h><w>kaffein</w>i&apos;m not on a container</z><z id="t1548771252" t="kaffein that&apos;s weird"><y>#</y><d>2019-01-29</d><h>14:14</h><w>kaffein</w>that&apos;s weird</z><z id="t1548771266" t="kaffein I should check one more time on my side perhaps"><y>#</y><d>2019-01-29</d><h>14:14</h><w>kaffein</w>I should check one more time on my side perhaps</z><z id="t1548771271" t="kaffein maybe I made a mistake somewhere"><y>#</y><d>2019-01-29</d><h>14:14</h><w>kaffein</w>maybe I made a mistake somewhere</z><z id="t1548771293" t="ghadi any custom thing you&apos;re hitting, or a corporate proxy or something? (IAM is global service, so it&apos;s probably not something region specific)"><y>#</y><d>2019-01-29</d><h>14:14</h><w>ghadi</w>any custom thing you&apos;re hitting, or a corporate proxy or something? (IAM is global service, so it&apos;s probably not something region specific)</z><z id="t1548771336" t="kaffein no corporate or specific settings I think since I&apos;m using it from home"><y>#</y><d>2019-01-29</d><h>14:15</h><w>kaffein</w>no corporate or specific settings I think since I&apos;m using it from home</z><z id="t1548771361" t="kaffein I may have missed something then : I will check it one more time this evening"><y>#</y><d>2019-01-29</d><h>14:16</h><w>kaffein</w>I may have missed something then : I will check it one more time this evening</z><z id="t1548771408" t="kaffein thanks a lot for your help [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] appreciate it"><y>#</y><d>2019-01-29</d><h>14:16</h><w>kaffein</w>thanks a lot for your help <a>@ghadi</a>appreciate it</z><z id="t1548771414" t="ghadi no problem"><y>#</y><d>2019-01-29</d><h>14:16</h><w>ghadi</w>no problem</z><z id="t1548780432" t="gordon [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}] https://github.com/aws/aws-sdk-java/issues/1778 it looks like others have had a similar issue with Java 10 and macOS, where it seems the Amazon certificates didn&apos;t get shipped with the JDK. are you able to try Java 11?"><y>#</y><d>2019-01-29</d><h>16:47</h><w>gordon</w><a>@kaffein</a> <a href="https://github.com/aws/aws-sdk-java/issues/1778" target="_blank">https://github.com/aws/aws-sdk-java/issues/1778</a> it looks like others have had a similar issue with Java 10 and macOS, where it seems the Amazon certificates didn&apos;t get shipped with the JDK. are you able to try Java 11?</z><z id="t1548780791" t="ghadi that was my next thought!"><y>#</y><d>2019-01-29</d><h>16:53</h><w>ghadi</w>that was my next thought!</z><z id="t1548780811" t="ghadi I know they restored some certificates from JDK9-&gt;JDK10... didn&apos;t realize there was a secondary problem!"><y>#</y><d>2019-01-29</d><h>16:53</h><w>ghadi</w>I know they restored some certificates from JDK9-&gt;JDK10... didn&apos;t realize there was a secondary problem!</z><z id="t1548781162" t="kaffein Thanks a lot [:attrs {:href &quot;/_/_/users/U1GEY70F5&quot;}] and [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I can try to upgrade to java 11 to see if that solves the problem"><y>#</y><d>2019-01-29</d><h>16:59</h><w>kaffein</w>Thanks a lot <a>@gws</a> and <a>@ghadi</a> I can try to upgrade to java 11 to see if that solves the problem</z><z id="t1548781174" t="kaffein Will let you guys know "><y>#</y><d>2019-01-29</d><h>16:59</h><w>kaffein</w>Will let you guys know </z><z id="t1548781200" t="ghadi cool brew cask install adoptopenjdk11"><y>#</y><d>2019-01-29</d><h>17:00</h><w>ghadi</w>cool
<code>brew cask install adoptopenjdk11</code></z><z id="t1548785025" t="devn [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] oh, hello. looks like some new stuff has been added for credential refresh?"><y>#</y><d>2019-01-29</d><h>18:03</h><w>devn</w><a>@ghadi</a> oh, hello. looks like some new stuff has been added for credential refresh?</z><z id="t1548785053" t="devn was getting an expired token exception, just bumped libs to see if the recent auto-refreshing-credentials stuff fixes my wagon"><y>#</y><d>2019-01-29</d><h>18:04</h><w>devn</w>was getting an expired token exception, just bumped libs to see if the recent auto-refreshing-credentials stuff fixes my wagon</z><z id="t1548785184" t="ghadi Yeah we fixed a nasty bug"><y>#</y><d>2019-01-29</d><h>18:06</h><w>ghadi</w>Yeah we fixed a nasty bug</z><z id="t1548785255" t="ghadi It wasn&apos;t refreshing properly before [:attrs {:href &quot;/_/_/users/U06DQC6MA&quot;}] "><y>#</y><d>2019-01-29</d><h>18:07</h><w>ghadi</w>It wasn&apos;t refreshing properly before <a>@devn</a> </z><z id="t1548785278" t="devn [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] sweet, thanks!"><y>#</y><d>2019-01-29</d><h>18:07</h><w>devn</w><a>@ghadi</a> sweet, thanks!</z><z id="t1548785452" t="devn yep, that did the trick."><y>#</y><d>2019-01-29</d><h>18:10</h><w>devn</w>yep, that did the trick.</z><z id="t1548797396" t="kaffein I&apos;ve upgraded my java install to use jdk 11 and it indeed solved the SSL issue!!again thanks a lot [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] 👍"><y>#</y><d>2019-01-29</d><h>21:29</h><w>kaffein</w>I&apos;ve upgraded my java install to use jdk 11 and it indeed solved the SSL issue!!again thanks a lot <a>@ghadi</a> <b>👍</b></z><z id="t1548798173" t="ghadi thank you for following up [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}]"><y>#</y><d>2019-01-29</d><h>21:42</h><w>ghadi</w>thank you for following up <a>@kaffein</a></z><z id="t1548798197" t="ghadi really appreciated! (grumble....I wish AWS services used a common trust chain)"><y>#</y><d>2019-01-29</d><h>21:43</h><w>ghadi</w>really appreciated!  (grumble....I wish AWS services used a common trust chain)</z><z id="t1548839600" t="Deano [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] your solution to write to stdout worked a treat! Thank you for your help"><y>#</y><d>2019-01-30</d><h>09:13</h><w>Deano</w><a>@ghadi</a> your solution to write to stdout worked a treat! Thank you for your help</z><z id="t1548839686" t="Deano I now have logs in cloudwatch from Fargate 🙂"><y>#</y><d>2019-01-30</d><h>09:14</h><w>Deano</w>I now have logs in cloudwatch from Fargate <b>🙂</b></z><z id="t1548951587" t="ben Has anyone had any success with using Squeedo for working with SQS? I’m having a bit of trouble working out how to mock the queue or otherwise set up for local development"><y>#</y><d>2019-01-31</d><h>16:19</h><w>ben</w>Has anyone had any success with using Squeedo for working with SQS?

I’m having a bit of trouble working out how to mock the queue or otherwise set up for local development</z><z id="t1548984107" t="caleb.macdonaldblack Where can I get AWS credentials to sign requests for elasticsearch in my containers?"><y>#</y><d>2019-02-01</d><h>01:21</h><w>caleb.macdonaldblack</w>Where can I get AWS credentials to sign requests for elasticsearch in my containers?</z><z id="t1549027141" t="Wes Hall [:attrs {:href &quot;/_/_/users/U3XCG2GBZ&quot;}] Ultimately, IAM, but assuming you are running your ES client codes within the AWS infrastructure, you should be able to set a &quot;role&quot; for your machines so that they are given creds automatically."><y>#</y><d>2019-02-01</d><h>13:19</h><w>Wes Hall</w><a>@caleb.macdonaldblack</a> Ultimately, IAM, but assuming you are running your ES client codes within the AWS infrastructure, you should be able to set a &quot;role&quot; for your machines so that they are given creds automatically.</z><z id="t1549041387" t="David Reno just filed this issue on lein-beanstalk not supporting current AWS platforms: https://github.com/weavejester/lein-beanstalk/issues/55 Does anyone have a work-around?"><y>#</y><d>2019-02-01</d><h>17:16</h><w>David Reno</w>just filed this issue on lein-beanstalk not supporting current AWS platforms: <a href="https://github.com/weavejester/lein-beanstalk/issues/55" target="_blank">https://github.com/weavejester/lein-beanstalk/issues/55</a>

Does anyone have a work-around?</z><z id="t1549228922" t="dchelimsky [ANN] com.cognitect.aws/api-0.8.243 is released: https://groups.google.com/forum/#!topic/clojure/wzEy8tSSKF0"><y>#</y><d>2019-02-03</d><h>21:22</h><w>dchelimsky</w>[ANN] com.cognitect.aws/api-0.8.243  is released: <a href="https://groups.google.com/forum/#!topic/clojure/wzEy8tSSKF0" target="_blank">https://groups.google.com/forum/#!topic/clojure/wzEy8tSSKF0</a></z><z id="t1549656772" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.253 is now available! https://groups.google.com/forum/#!topic/clojure/T2DxXK8qTDU"><y>#</y><d>2019-02-08</d><h>20:12</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.253 is now available! <a href="https://groups.google.com/forum/#!topic/clojure/T2DxXK8qTDU" target="_blank">https://groups.google.com/forum/#!topic/clojure/T2DxXK8qTDU</a></z><z id="t1550278658" t="taylor I have a long-running app using aws-api, and it seems like the S3 client (and maybe any other client) needs to be refreshed/recreated periodically. I eventually start getting ExpiredToken errors. I didn’t see anything in the docs about this. Is there guidance for how long I can use the same client?"><y>#</y><d>2019-02-16</d><h>00:57</h><w>taylor</w>I have a long-running app using aws-api, and it seems like the S3 client (and maybe any other client) needs to be refreshed/recreated periodically. I eventually start getting <code>ExpiredToken</code> errors. I didn’t see anything in the docs about this. Is there guidance for how long I can use the same client?</z><z id="t1550278991" t="ghadi are you using latest [:attrs {:href &quot;/_/_/users/U3DAE8HMG&quot;}] ? there was a bug in the previous release"><y>#</y><d>2019-02-16</d><h>01:03</h><w>ghadi</w>are you using latest <a>@taylor</a>? there was a bug in the previous release</z><z id="t1550279011" t="taylor maybe not very latest, I’ll upgrade"><y>#</y><d>2019-02-16</d><h>01:03</h><w>taylor</w>maybe not very latest, I’ll upgrade</z><z id="t1550279031" t="taylor should I be able to use the same client instance indefinitely though?"><y>#</y><d>2019-02-16</d><h>01:03</h><w>taylor</w>should I be able to use the same client instance indefinitely though?</z><z id="t1550279046" t="ghadi should be yes"><y>#</y><d>2019-02-16</d><h>01:04</h><w>ghadi</w>should be yes</z><z id="t1550279059" t="ghadi the credentials will refresh in the background, like other clients"><y>#</y><d>2019-02-16</d><h>01:04</h><w>ghadi</w>the credentials will refresh in the background, like other clients</z><z id="t1550504317" t="dogenpunk Has anyone here used Cognito with Datomic Ions? I’m curious as to how people have dealt with creating user accounts in Cognito and linking them to a entity in Datomic."><y>#</y><d>2019-02-18</d><h>15:38</h><w>dogenpunk</w>Has anyone here used Cognito with Datomic Ions? I’m curious as to how people have dealt with creating user accounts in Cognito and linking them to a entity in Datomic.</z><z id="t1550504409" t="dogenpunk I was thinking that I could use a lambda trigger to link accounts, but there doesn’t seem to be one that runs when an account is created via the Cognito console. It also seems that neither amazonica nor cognitect’s aws lib handle the cognito user pool API."><y>#</y><d>2019-02-18</d><h>15:40</h><w>dogenpunk</w>I was thinking that I could use a lambda trigger to link accounts, but there doesn’t seem to be one that runs when an account is created via the Cognito console. It also seems that neither amazonica nor cognitect’s aws lib handle the cognito user pool API.</z><z id="t1550505999" t="dogenpunk Oh, I see that the cognitect aws lib actually does support the user pool API. It’s just in the cognito-idp API."><y>#</y><d>2019-02-18</d><h>16:06</h><w>dogenpunk</w>Oh, I see that the cognitect aws lib actually does support the user pool API. It’s just in the cognito-idp API.</z><z id="t1550586385" t="lispers-anonymous I asked this question on zulip the other day and wasn’t able to get very far: https://clojurians.zulipchat.com/#narrow/stream/151168-clojure/topic/cognitect.20aws.20api/near/158088908 I’m going to try my luck reposting it here: I’m trying to see if the cognitect’s aws api will fit my needs as a dynamoDB client. I’d like to be able to run dynamoDB locally with https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html But I can’t figure out how to connect to my local instance with the clojure client. There is an option to pass in an endpoint override, but it doesn’t like it when I specify the port for my local instance like so (def ddb (aws/client {:api :dynamodb :endpoint-override &quot;localhost:8000&quot; :credentials-provider #_blahblahblah })) Which will give me this error, obviously trying to tack in the port that I guess is provided by the AWS API spec { :cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Malformed IPv6 address at index 8: http://[localhost:3000]:443&quot;, :cognitect.http-client/throwable java.lang.IllegalArgumentException: Malformed IPv6 address at index 8: http://[localhost:3000]:443, :body } Trying without the port like so :endpoint-override &quot;localhost&quot; and running the local dynamoDB (via docker) configured to listen on port 443 gives me an SSL exception { :cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Unrecognized SSL message, plaintext connection?&quot;, :cognitect.http-client/throwable javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection?, :body } Has anyone here had any luck getting something like this to work, even on a different aws service? I’ve tried all the values I can for endpoint-override and none of them will work. I have a feeling that this isn’t what the override is intended for."><y>#</y><d>2019-02-19</d><h>14:26</h><w>lispers-anonymous</w>I asked this question on zulip the other day and wasn’t able to get very far: <a href="https://clojurians.zulipchat.com/#narrow/stream/151168-clojure/topic/cognitect.20aws.20api/near/158088908" target="_blank">https://clojurians.zulipchat.com/#narrow/stream/151168-clojure/topic/cognitect.20aws.20api/near/158088908</a>
I’m going to try my luck reposting it here:



I’m trying to see if the cognitect’s aws api will fit my needs as a dynamoDB client. I’d like to be able to run dynamoDB locally with <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html" target="_blank">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html</a>

But I can’t figure out how to connect to my local instance with the clojure client. There is an option to pass in an endpoint override, but it doesn’t like it when I specify the port for my local instance like so

<pre>(def ddb (aws/client {:api :dynamodb
                      :endpoint-override &quot;localhost:8000&quot;
                      :credentials-provider #_blahblahblah }))
</pre>

Which will give me this error, obviously trying to tack in the port that I guess is provided by the AWS API spec

<pre>{ :cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Malformed IPv6 address at index 8: http://[localhost:3000]:443&quot;, :cognitect.http-client/throwable java.lang.IllegalArgumentException: Malformed IPv6 address at index 8: http://[localhost:3000]:443, :body  }
</pre>

Trying without the port like so <code>:endpoint-override &quot;localhost&quot;</code> and running the local dynamoDB (via docker) configured to listen on port 443 gives me an SSL exception

<pre>{ :cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Unrecognized SSL message, plaintext connection?&quot;, :cognitect.http-client/throwable javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection?, :body  }
</pre>

Has anyone here had any luck getting something like this to work, even on a different aws service? I’ve tried all the values I can for <code>endpoint-override</code> and none of them will work. I have a feeling that this isn’t what the override is intended for.</z><z id="t1550586773" t="Alex Miller (Clojure team) I can&apos;t answer your question, but posting an issue at https://github.com/cognitect-labs/aws-api/issues is where the aws-api maintainers work from"><y>#</y><d>2019-02-19</d><h>14:32</h><w>Alex Miller (Clojure team)</w>I can&apos;t answer your question, but posting an issue at <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> is where the aws-api maintainers work from</z><z id="t1550588240" t="ghadi [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] seems like DDB local doesn&apos;t use SSL, right?"><y>#</y><d>2019-02-19</d><h>14:57</h><w>ghadi</w><a>@dannyfreeman</a>  seems like DDB local doesn&apos;t use SSL, right?</z><z id="t1550588434" t="lispers-anonymous No it doesn’t"><y>#</y><d>2019-02-19</d><h>15:00</h><w>lispers-anonymous</w>No it doesn’t</z><z id="t1550588455" t="ghadi the error you received indicates that aws-api is connecting to a plaintext http port and attempting to negotiate a TLS handshake"><y>#</y><d>2019-02-19</d><h>15:00</h><w>ghadi</w>the error you received indicates that aws-api is connecting to a plaintext http port and attempting to negotiate a TLS handshake</z><z id="t1550588499" t="ghadi I don&apos;t think the endpoint override functionality in aws-api can do plain http"><y>#</y><d>2019-02-19</d><h>15:01</h><w>ghadi</w>I don&apos;t think the endpoint override functionality in aws-api can do plain http</z><z id="t1550588650" t="lispers-anonymous Sounds like I need to go the route that [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] suggested and post an issue on github to see if I can find a way to override that as well"><y>#</y><d>2019-02-19</d><h>15:04</h><w>lispers-anonymous</w>Sounds like I need to go the route that <a>@alexmiller</a> suggested and post an issue on github to see if I can find a way to override that as well</z><z id="t1550588718" t="ghadi yes please -- there isn&apos;t a hook for it"><y>#</y><d>2019-02-19</d><h>15:05</h><w>ghadi</w>yes please -- there isn&apos;t a hook for it</z><z id="t1550588990" t="lispers-anonymous Thanks guys. I’ll work on that later today"><y>#</y><d>2019-02-19</d><h>15:09</h><w>lispers-anonymous</w>Thanks guys. I’ll work on that later today</z><z id="t1551317535" t="devn i think the answer here is no, but: I saw cognitect.aws.credentials/auto-refreshing-credentials and wondered if there was anything I might reuse in there to have an atom containing up-to-date temporary credentials."><y>#</y><d>2019-02-28</d><h>01:32</h><w>devn</w>i think the answer here is no, but: <code></code>

I saw <code>cognitect.aws.credentials/auto-refreshing-credentials</code> and wondered if there was anything I might reuse in there to have an atom containing up-to-date temporary credentials.</z><z id="t1551317913" t="devn I wrote a little (future (while true (reset! credentials (fetch-credentials ...)) (Thread/sleep ...))) thing, but having retry, backoff, etc. managed by the lib would be nice, since some of the sauce is already in the client API."><y>#</y><d>2019-02-28</d><h>01:38</h><w>devn</w>I wrote a little <code>(future (while true (reset! credentials (fetch-credentials ...)) (Thread/sleep ...)))</code> thing, but having retry, backoff, etc. managed by the lib would be nice, since some of the sauce is already in the client API.</z><z id="t1551352634" t="viesti yeah, for STS temporary creds, there needs to be a refresh, on some interval or maybe even a HTTP lib middleware, which would check against the expiration time (given some buffer to cover cock drift)"><y>#</y><d>2019-02-28</d><h>11:17</h><w>viesti</w>yeah, for STS temporary creds, there needs to be a refresh, on some interval or maybe even a HTTP lib middleware, which would check against the expiration time (given some buffer to cover cock drift)</z><z id="t1551352696" t="viesti AWS Java libs encompass this via a refresh() method that the user is required to call on the background: https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/AWSCredentialsProvider.html#refresh--"><y>#</y><d>2019-02-28</d><h>11:18</h><w>viesti</w>AWS Java libs encompass this via a <code>refresh()</code> method that the user is required to call on the background: <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/AWSCredentialsProvider.html#refresh--" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/auth/AWSCredentialsProvider.html#refresh--</a></z><z id="t1551352726" t="viesti haven’t really looked into what would be most suitable place for such in the aws-api"><y>#</y><d>2019-02-28</d><h>11:18</h><w>viesti</w>haven’t really looked  into what would be most suitable place for such in the aws-api</z><z id="t1551352762" t="viesti on the AWS Java libs: &gt; Forces this credentials provider to refresh its credentials. For many implementations of credentials provider, this method may simply be a no-op, such as any credentials provider implementation that vends static/non-changing credentials. For other implementations that vend different credentials through out their lifetime, this method should force the credentials provider to refresh its credentials."><y>#</y><d>2019-02-28</d><h>11:19</h><w>viesti</w>on the AWS Java libs:
&gt; Forces this credentials provider to refresh its credentials. For many implementations of credentials provider, this method may simply be a no-op, such as any credentials provider implementation that vends static/non-changing credentials. For other implementations that vend different credentials through out their lifetime, this method should force the credentials provider to refresh its credentials.</z><z id="t1551352797" t="viesti Thinking that in this way, they push the refresh responsibility to the clients"><y>#</y><d>2019-02-28</d><h>11:19</h><w>viesti</w>Thinking that in this way, they push the refresh responsibility to the clients</z><z id="t1551352818" t="viesti I’d kinda like to try the middleware approach"><y>#</y><d>2019-02-28</d><h>11:20</h><w>viesti</w>I’d kinda like to try the middleware approach</z><z id="t1551352834" t="viesti to check the creds expiration “on the way out”"><y>#</y><d>2019-02-28</d><h>11:20</h><w>viesti</w>to check the creds expiration “on the way out”</z><z id="t1551352846" t="viesti just that one would have to know the type of the creds then"><y>#</y><d>2019-02-28</d><h>11:20</h><w>viesti</w>just that one would have to know the type of the creds then</z><z id="t1551352877" t="viesti how do people deal with these expiring credentials elsewhere? 🙂"><y>#</y><d>2019-02-28</d><h>11:21</h><w>viesti</w>how do people deal with these expiring credentials elsewhere? <b>🙂</b></z><z id="t1551363786" t="ghadi https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj"><y>#</y><d>2019-02-28</d><h>14:23</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj</a></z><z id="t1551364036" t="ghadi [:attrs {:href &quot;/_/_/users/U06DQC6MA&quot;}] [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] "><y>#</y><d>2019-02-28</d><h>14:27</h><w>ghadi</w><a>@devn</a> <a>@viesti</a> </z><z id="t1551365647" t="viesti whoa ❤️ "><y>#</y><d>2019-02-28</d><h>14:54</h><w>viesti</w>whoa <b>❤️</b> </z><z id="t1551365670" t="viesti damn, this has been thought out well :) "><y>#</y><d>2019-02-28</d><h>14:54</h><w>viesti</w>damn, this has been thought out well :) </z><z id="t1551365704" t="viesti 🙇 "><y>#</y><d>2019-02-28</d><h>14:55</h><w>viesti</w><b>🙇</b> </z><z id="t1551368864" t="devn [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] nice, but this wouldn&apos;t really apply to the get-cluster-credentials call, right? it retrieves a DbPassword and DbUser, but maybe I&apos;m missing something"><y>#</y><d>2019-02-28</d><h>15:47</h><w>devn</w><a>@ghadi</a> nice, but this wouldn&apos;t really apply to the get-cluster-credentials call, right? it retrieves a DbPassword and DbUser, but maybe I&apos;m missing something</z><z id="t1551368910" t="ghadi oh those are redshift creds, not AWS creds"><y>#</y><d>2019-02-28</d><h>15:48</h><w>ghadi</w>oh those are redshift creds, not AWS creds</z><z id="t1551369122" t="devn [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] yessir, which is why i assume it&apos;s not a covered case, but i wondered if there were enough versions of same floating around that something could be provided to handle autorefresh for me"><y>#</y><d>2019-02-28</d><h>15:52</h><w>devn</w><a>@ghadi</a> yessir, which is why i assume it&apos;s not a covered case, but i wondered if there were enough versions of same floating around that something could be provided to handle autorefresh for me</z><z id="t1551369146" t="ghadi you can steal the skeleton from credentials.clj"><y>#</y><d>2019-02-28</d><h>15:52</h><w>ghadi</w>you can steal the skeleton from credentials.clj</z><z id="t1551369201" t="devn word, yeah, gonna take that as a &quot;not in my AWS API&quot; 😄"><y>#</y><d>2019-02-28</d><h>15:53</h><w>devn</w>word, yeah, gonna take that as a &quot;not in my AWS API&quot; <b>😄</b></z><z id="t1551369352" t="viesti hum, the Redshift jdbc driver is able to fetch credentials when establishing a connection "><y>#</y><d>2019-02-28</d><h>15:55</h><w>viesti</w>hum, the Redshift jdbc driver is able to fetch credentials when establishing a connection </z><z id="t1551369395" t="viesti if you provide a suitable jdbc url that tells the cluster id"><y>#</y><d>2019-02-28</d><h>15:56</h><w>viesti</w>if you provide a suitable jdbc url that tells the cluster id</z><z id="t1551369589" t="viesti it&apos;s simple to just fetch new credentials when making a connection"><y>#</y><d>2019-02-28</d><h>15:59</h><w>viesti</w>it&apos;s simple to just fetch new credentials when making a connection</z><z id="t1551369608" t="viesti no need to cache"><y>#</y><d>2019-02-28</d><h>16:00</h><w>viesti</w>no need to cache</z><z id="t1551370443" t="devn [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] have a link to where you see that by any chance?"><y>#</y><d>2019-02-28</d><h>16:14</h><w>devn</w><a>@viesti</a> have a link to where you see that by any chance?</z><z id="t1551370630" t="viesti sure https://docs.aws.amazon.com/redshift/latest/mgmt/generating-iam-credentials-configure-jdbc-odbc.html"><y>#</y><d>2019-02-28</d><h>16:17</h><w>viesti</w>sure <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/generating-iam-credentials-configure-jdbc-odbc.html" target="_blank">https://docs.aws.amazon.com/redshift/latest/mgmt/generating-iam-credentials-configure-jdbc-odbc.html</a></z><z id="t1551371009" t="viesti user name and groups to join and whether to create the user while connecting can be specified options in the jdbc url https://docs.aws.amazon.com/redshift/latest/mgmt/jdbc-and-odbc-options-for-database-credentials.html"><y>#</y><d>2019-02-28</d><h>16:23</h><w>viesti</w>user name and groups to join and whether to create the user while connecting can be specified options in the jdbc url <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/jdbc-and-odbc-options-for-database-credentials.html" target="_blank">https://docs.aws.amazon.com/redshift/latest/mgmt/jdbc-and-odbc-options-for-database-credentials.html</a></z><z id="t1551371176" t="viesti user creation and joining groups needs permissions that can be specified via policies attached to the role/user using the jdbc driver"><y>#</y><d>2019-02-28</d><h>16:26</h><w>viesti</w>user creation and joining groups needs permissions that can be specified via policies attached to the role/user using the jdbc driver</z><z id="t1551371338" t="viesti one could call the redshift get-cluster-credentials api, but at least in our case, it&apos;s been easier to let the aws provided jdbc driver do so"><y>#</y><d>2019-02-28</d><h>16:28</h><w>viesti</w>one could call the redshift get-cluster-credentials api, but at least in our case, it&apos;s been easier to let the aws provided jdbc driver do so</z><z id="t1551371436" t="viesti although the driver seems to have a bug which prevents this working in a lambda (tried filing a support ticket but this never got fixed) "><y>#</y><d>2019-02-28</d><h>16:30</h><w>viesti</w>although the driver seems to have a bug which prevents this working in a lambda (tried filing a support ticket but this never got fixed) </z><z id="t1551371774" t="viesti but in general, was thinking that redshift connections aren&apos;t probably made that often that credentials would need to be cached"><y>#</y><d>2019-02-28</d><h>16:36</h><w>viesti</w>but in general, was thinking that redshift connections aren&apos;t probably made that often that credentials would need to be cached</z><z id="t1551375768" t="devn [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] wow, can&apos;t believe i missed that. thank you!"><y>#</y><d>2019-02-28</d><h>17:42</h><w>devn</w><a>@viesti</a> wow, can&apos;t believe i missed that. thank you!</z><z id="t1551375790" t="viesti 😄"><y>#</y><d>2019-02-28</d><h>17:43</h><w>viesti</w><b>😄</b></z><z id="t1551375846" t="devn I remember seeing autocreate=true and tossing it aside as something related to db or cluster creation"><y>#</y><d>2019-02-28</d><h>17:44</h><w>devn</w>I remember seeing <code>autocreate=true</code> and tossing it aside as something related to db or cluster creation</z><z id="t1551474085" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.273 is now available: https://groups.google.com/forum/#!topic/clojure/PgnJxiam_qk"><y>#</y><d>2019-03-01</d><h>21:01</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.273 is now available: <a href="https://groups.google.com/forum/#!topic/clojure/PgnJxiam_qk" target="_blank">https://groups.google.com/forum/#!topic/clojure/PgnJxiam_qk</a></z><z id="t1551650716" t="cfleming Does anyone know if Cognitect’s AWS API can be compiled using Graal’s native-image?"><y>#</y><d>2019-03-03</d><h>22:05</h><w>cfleming</w>Does anyone know if Cognitect’s AWS API can be compiled using Graal’s native-image?</z><z id="t1551650734" t="cfleming I’d like to use it in a lambda, but the Clojure startup time is a problem there."><y>#</y><d>2019-03-03</d><h>22:05</h><w>cfleming</w>I’d like to use it in a lambda, but the Clojure startup time is a problem there.</z><z id="t1551650779" t="cfleming I seem to recall seeing that SSL (and thus HTTPS) was a problem with Graal, which I guess would affect it, but I don’t know what the state of that is."><y>#</y><d>2019-03-03</d><h>22:06</h><w>cfleming</w>I seem to recall seeing that SSL (and thus HTTPS) was a problem with Graal, which I guess would affect it, but I don’t know what the state of that is.</z><z id="t1551651794" t="ghadi Dunno [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] "><y>#</y><d>2019-03-03</d><h>22:23</h><w>ghadi</w>Dunno <a>@cfleming</a> </z><z id="t1551651814" t="ghadi native-image is highly overrated, IMHO"><y>#</y><d>2019-03-03</d><h>22:23</h><w>ghadi</w>native-image is highly overrated, IMHO</z><z id="t1551651832" t="ghadi Too many restrictions, it&apos;s not Java"><y>#</y><d>2019-03-03</d><h>22:23</h><w>ghadi</w>Too many restrictions, it&apos;s not Java</z><z id="t1551651856" t="ghadi jaotc is Java however. Have you tried it?"><y>#</y><d>2019-03-03</d><h>22:24</h><w>ghadi</w>jaotc is Java however.  Have you tried it?</z><z id="t1551651887" t="ghadi It uses Graal under the hood but with a different strategy"><y>#</y><d>2019-03-03</d><h>22:24</h><w>ghadi</w>It uses Graal under the hood but with a different strategy</z><z id="t1551652001" t="cfleming [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I haven’t, no - I’ll check it out."><y>#</y><d>2019-03-03</d><h>22:26</h><w>cfleming</w><a>@ghadi</a> I haven’t, no - I’ll check it out.</z><z id="t1551661158" t="taylor [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] GraalVM added HTTPS support a few months ago, but it looks like there’s another issue here https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/util.clj#L286 preventing native image generation: Error: unbalanced monitors: mismatch at monitorexit, 96|LoadField#lockee__5699__auto__ != 3|LoadField#lockee__5699__auto__ Call path from entry point to cognitect.aws.util$dynaload$fn__637.invoke(): at cognitect.aws.util$dynaload$fn__637.invoke(util.clj:265) at clojure.lang.AFn.applyToHelper(AFn.java:152) at clojure.lang.Ref.applyTo(Ref.java:366) at aws_api_cli.core.main(Unknown Source) at com.oracle.svm.core.JavaMainWrapper.run(JavaMainWrapper.java:152) IIRC there was a ticket/patch for this in Clojure? I tried with 1.9 and 1.10 but got the same error (w/diff stack traces)"><y>#</y><d>2019-03-04</d><h>00:59</h><w>taylor</w><a>@cfleming</a> GraalVM added HTTPS support a few months ago, but it looks like there’s another issue here <a href="https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/util.clj#L286" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/util.clj#L286</a> preventing native image generation:
<pre>Error: unbalanced monitors: mismatch at monitorexit, 96|LoadField#lockee__5699__auto__ != 3|LoadField#lockee__5699__auto__
Call path from entry point to cognitect.aws.util$dynaload$fn__637.invoke():
	at cognitect.aws.util$dynaload$fn__637.invoke(util.clj:265)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.Ref.applyTo(Ref.java:366)
	at aws_api_cli.core.main(Unknown Source)
	at com.oracle.svm.core.JavaMainWrapper.run(JavaMainWrapper.java:152)</pre>
IIRC there was a ticket/patch for this in Clojure? I tried with 1.9 and 1.10 but got the same error (w/diff stack traces)</z><z id="t1551661620" t="taylor https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510 this is the patch I was thinking of, and this ticket isn’t the one I remember but seems relevant https://dev.clojure.org/jira/browse/CLJ-1472"><y>#</y><d>2019-03-04</d><h>01:07</h><r>taylor</r><a href="https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510" target="_blank">https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510</a> this is the patch I was thinking of, and this ticket isn’t the one I remember but seems relevant <a href="https://dev.clojure.org/jira/browse/CLJ-1472" target="_blank">https://dev.clojure.org/jira/browse/CLJ-1472</a></z><z id="t1551663354" t="taylor FWIW I was able to build a native image after replacing that dynaload with a patched version, but then it fails at run-time with Cannot find resource cognitect/aws/s3/service.edn. {} (because I used S3 as an example call). I might take a deeper look at this if I have time later this week :man-shrugging:"><y>#</y><d>2019-03-04</d><h>01:35</h><r>taylor</r>FWIW I was able to build a native image after replacing that <code>dynaload</code> with a patched version, but then it fails at run-time with <code>Cannot find resource cognitect/aws/s3/service.edn. {}</code> (because I used S3 as an example call). I might take a deeper look at this if I have time later this week <b>:man-shrugging:</b></z><z id="t1551663795" t="cfleming [:attrs {:href &quot;/_/_/users/U3DAE8HMG&quot;}] Thanks! I’d appreciate any info you can provide after digging a bit."><y>#</y><d>2019-03-04</d><h>01:43</h><r>cfleming</r><a>@U3DAE8HMG</a> Thanks! I’d appreciate any info you can provide after digging a bit.</z><z id="t1551665811" t="Alex Miller (Clojure team) 1472 is the relevant ticket"><y>#</y><d>2019-03-04</d><h>02:16</h><r>Alex Miller (Clojure team)</r>1472 is the relevant ticket</z><z id="t1551665842" t="Alex Miller (Clojure team) that service.edn is from one of the other deps that needs to be included as a resource on the classpath (not sure what graal does about stuff like that)"><y>#</y><d>2019-03-04</d><h>02:17</h><r>Alex Miller (Clojure team)</r>that service.edn is from one of  the other deps that needs  to be included as a resource on the classpath (not sure what graal does about stuff like that)</z><z id="t1551693975" t="viesti thinking that resources looked up at runtime are out of scope of the static analysis that Graal native images performs"><y>#</y><d>2019-03-04</d><h>10:06</h><r>viesti</r>thinking that resources looked up at runtime are out of scope of the static analysis that Graal native images performs</z><z id="t1551694008" t="viesti so those should be instructed for graal to keep"><y>#</y><d>2019-03-04</d><h>10:06</h><r>viesti</r>so those should be instructed for graal to keep</z><z id="t1551694199" t="viesti Not of immediate gain regarding graal/aws-api, but [:attrs {:href &quot;/_/_/users/U3E46Q1DG&quot;}] did something a bit similar with bytecode analysis in the #portkey project, in which we had an option to specify keeps for resources/classes that were dynamically loaded. I think some forms can be captured by static analysis, say .getResource(&quot;path/to/resources&quot;) , where the resource is a compile time literal"><y>#</y><d>2019-03-04</d><h>10:09</h><r>viesti</r>Not of immediate gain regarding graal/aws-api, but <a>@U3E46Q1DG</a> did something a bit similar with bytecode analysis in the #portkey project, in which we had an option to specify keeps for resources/classes that were dynamically loaded. I think some forms can be captured by static analysis, say <code>.getResource(&quot;path/to/resources&quot;)</code>, where the resource is a compile time literal</z><z id="t1551707418" t="ghadi https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510 clj-1472"><y>#</y><d>2019-03-04</d><h>13:50</h><r>ghadi</r><a href="https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510" target="_blank">https://github.com/ghadishayban/clojure/commit/8acb995853761bc48b62190fe7005b70da692510</a>
clj-1472</z><z id="t1551662205" t="steveb8n [:attrs {:href &quot;/_/_/users/U0567Q30W&quot;}] I presume CLJS is not an option? I have a couple of CLJS/Shadow lambdas that do AWS calls and cold start in a couple of seconds"><y>#</y><d>2019-03-04</d><h>01:16</h><w>steveb8n</w><a>@cfleming</a> I presume CLJS is not an option? I have a couple of CLJS/Shadow lambdas that do AWS calls and cold start in a couple of seconds</z><z id="t1551662332" t="steveb8n they are not in a VPC which dramatically improves cold-start. The VPC ENI cold start can add up to 8 secs to a cold start. I suspect a Graal based Lambda would suffer that as well if VPC is required in your case"><y>#</y><d>2019-03-04</d><h>01:18</h><w>steveb8n</w>they are not in a VPC which dramatically improves cold-start. The VPC ENI cold start can add up to 8 secs to a cold start. I suspect a Graal based Lambda would suffer that as well if VPC is required in your case</z><z id="t1551663882" t="cfleming [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] Yes, I’m currently using CLJS for my lambdas. But I like the new Cognitect API and AFAIK that’s not available for CLJS yet. And I would dearly love to leave all the funky async bit behind me forever (promesa helps, but it’s still not as nice as blocking)"><y>#</y><d>2019-03-04</d><h>01:44</h><w>cfleming</w><a>@steveb8n</a> Yes, I’m currently using CLJS for my lambdas. But I like the new Cognitect API and AFAIK that’s not available for CLJS yet. And I would dearly love to leave all the funky async bit behind me forever (promesa helps, but it’s still not as nice as blocking)</z><z id="t1551663988" t="steveb8n I agree with that. The new AWS lib is much nicer. I’ll be interested to hear how fast you can make the cold start work. Although nothing we can do about ENI - for that we (keep on) wait for AWS"><y>#</y><d>2019-03-04</d><h>01:46</h><w>steveb8n</w>I agree with that. The new AWS lib is much nicer. I’ll be interested to hear how fast you can make the cold start work. Although nothing we can do about ENI - for that we (keep on) wait for AWS</z><z id="t1551664018" t="cfleming Yeah, I’d like to switch from Dynamo to RDS but the VPC has put me off."><y>#</y><d>2019-03-04</d><h>01:46</h><w>cfleming</w>Yeah, I’d like to switch from Dynamo to RDS but the VPC has put me off.</z></g><g id="s6"><z id="t1551666548" t="steveb8n Also interesting is that Graal is 50% slower than JVM once loaded (was mentioned at ClojuTre last year) so by using Graal we are favouring cold starts over warmed up invocations. I suppose 50% slower is ok if total time is some 100&apos;s of ms, users won’t notice that"><y>#</y><d>2019-03-04</d><h>02:29</h><w>steveb8n</w>Also interesting is that Graal is 50% slower than JVM once loaded (was mentioned at ClojuTre last year) so by using Graal we are favouring cold starts over warmed up invocations. I suppose 50% slower is ok if total time is some 100&apos;s of ms, users won’t notice that</z><z id="t1551699191" t="viesti hum, isn’t jaotc is running on the c2/hotspot and the graalvm throughput is probably going to be better in the future?"><y>#</y><d>2019-03-04</d><h>11:33</h><w>viesti</w>hum, isn’t jaotc is running on the c2/hotspot and the graalvm throughput is probably going to be better in the future?</z><z id="t1551699327" t="viesti was remembering this 🙂 https://www.graalvm.org/docs/reference-manual/aot-compilation/ &gt; What is the typical performance profile on the SVM? &gt; Right now peak performance is a bit worse than HotSpot, but we don’t want to advertise that (and we want to fix it of course)."><y>#</y><d>2019-03-04</d><h>11:35</h><w>viesti</w>was remembering this <b>🙂</b> <a href="https://www.graalvm.org/docs/reference-manual/aot-compilation/" target="_blank">https://www.graalvm.org/docs/reference-manual/aot-compilation/</a>
&gt; What is the typical performance profile on the SVM?
&gt; Right now peak performance is a bit worse than HotSpot, but we don’t want to advertise that (and we want to fix it of course).</z><z id="t1551825501" t="devn curious about error handling. I am doing something like this: (defn log-error-response [response] (let [throwable (:cognitect.aws.client/throwable response) category (:cognitect.anomalies/category response) default-message &quot;An error occurred during AWS client invocation.&quot; message (or (:message response) default-message)] (when category (let [e (ex-info message response)] (if throwable (log/error throwable message) (log/error e message)))) response)) Is this good enough to &quot;catch &apos;em all&quot;?"><y>#</y><d>2019-03-05</d><h>22:38</h><w>devn</w>curious about error handling. I am doing something like this:

<pre>(defn log-error-response [response]
  (let [throwable (:cognitect.aws.client/throwable response)
        category (:cognitect.anomalies/category response)
        default-message &quot;An error occurred during AWS client invocation.&quot;
        message (or (:message response) default-message)]
    (when category
      (let [e (ex-info message response)]
        (if throwable
          (log/error throwable message)
          (log/error e message))))
    response))
</pre>

Is this good enough to &quot;catch &apos;em all&quot;?</z><z id="t1551826620" t="devn I tossed throwable in there because I saw for instance, when an unbound var was referenced in the body of a call to aws/invoke, I got one of these: {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;Don&apos;t know how to write JSON of class clojure.lang.Var$Unbound&quot; which contains no :message key. I suppose the other question is where I can rely on :message to be there."><y>#</y><d>2019-03-05</d><h>22:57</h><w>devn</w>I tossed <code>throwable</code> in there because I saw for instance, when an unbound var was referenced in the body of a call to aws/invoke, I got one of these:
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error {
 :cause &quot;Don&apos;t know how to write JSON of class clojure.lang.Var$Unbound&quot;
</pre>

which contains no <code>:message</code> key. I suppose the other question is where I can rely on <code>:message</code> to be there.</z><z id="t1553888714" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.283 is now available! https://groups.google.com/forum/#!topic/clojure/cOIF5cjAecI"><y>#</y><d>2019-03-29</d><h>19:45</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.283 is now available! <a href="https://groups.google.com/forum/#!topic/clojure/cOIF5cjAecI" target="_blank">https://groups.google.com/forum/#!topic/clojure/cOIF5cjAecI</a></z><z id="t1554256340" t="hadils Hi I need to know if/how to send email with com.cognitect.aws/email?"><y>#</y><d>2019-04-03</d><h>01:52</h><w>hadils</w>Hi I need to know if/how to send email with com.cognitect.aws/email?</z><z id="t1555102830" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.292 https://groups.google.com/forum/#!topic/clojure/uvOzyfBrbyc"><y>#</y><d>2019-04-12</d><h>21:00</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.292 <a href="https://groups.google.com/forum/#!topic/clojure/uvOzyfBrbyc" target="_blank">https://groups.google.com/forum/#!topic/clojure/uvOzyfBrbyc</a></z><z id="t1555528966" t="richiardiandrea has anybody here implemented a custom runtime for AWS lambda?"><y>#</y><d>2019-04-17</d><h>19:22</h><w>richiardiandrea</w>has anybody here implemented a custom runtime for AWS lambda?</z><z id="t1555529663" t="ghadi https://github.com/ghadishayban/lambdaclj-jdk11"><y>#</y><d>2019-04-17</d><h>19:34</h><w>ghadi</w><a href="https://github.com/ghadishayban/lambdaclj-jdk11" target="_blank">https://github.com/ghadishayban/lambdaclj-jdk11</a></z><z id="t1555529668" t="ghadi [:attrs {:href &quot;/_/_/users/U0C8489U6&quot;}]"><y>#</y><d>2019-04-17</d><h>19:34</h><w>ghadi</w><a>@richiardiandrea</a></z><z id="t1555529684" t="ghadi that should give a flavor"><y>#</y><d>2019-04-17</d><h>19:34</h><w>ghadi</w>that should give a flavor</z><z id="t1555529732" t="richiardiandrea awesome thanks! I want to check how responses other from 20X are treated in general 😉"><y>#</y><d>2019-04-17</d><h>19:35</h><w>richiardiandrea</w>awesome thanks! I want to check how responses other from 20X are treated in general <b>😉</b></z><z id="t1555530368" t="richiardiandrea for reference, working on the lumo layer - https://github.com/grav/aws-lumo-cljs-runtime/pull/3"><y>#</y><d>2019-04-17</d><h>19:46</h><w>richiardiandrea</w>for reference, working on the <code>lumo</code> layer - <a href="https://github.com/grav/aws-lumo-cljs-runtime/pull/3" target="_blank">https://github.com/grav/aws-lumo-cljs-runtime/pull/3</a></z><z id="t1555542888" t="gzmask I am getting Cannot find resource cognitect/aws/dynamodb/service.edn from making an AWS-api client"><y>#</y><d>2019-04-17</d><h>23:14</h><w>gzmask</w>I am getting <code>Cannot find resource cognitect/aws/dynamodb/service.edn</code> from making an AWS-api client</z><z id="t1555542902" t="gzmask Any pointers?"><y>#</y><d>2019-04-17</d><h>23:15</h><w>gzmask</w>Any pointers?</z><z id="t1555542921" t="gzmask :api is dynamodb"><y>#</y><d>2019-04-17</d><h>23:15</h><w>gzmask</w>:api is dynamodb</z><z id="t1555543322" t="ghadi [:attrs {:href &quot;/_/_/users/U0JFG0ZU5&quot;}] what do your dependencies look like?"><y>#</y><d>2019-04-17</d><h>23:22</h><w>ghadi</w><a>@gzmask</a> what do your dependencies look like?</z><z id="t1555543354" t="gzmask just [com.cognitect.aws/api &quot;0.8.292&quot;] in my lein project.clj"><y>#</y><d>2019-04-17</d><h>23:22</h><w>gzmask</w>just <code>[com.cognitect.aws/api &quot;0.8.292&quot;]</code> in my lein project.clj</z><z id="t1555543366" t="gzmask should I include the other two deps?"><y>#</y><d>2019-04-17</d><h>23:22</h><w>gzmask</w>should I include the other two deps?</z><z id="t1555543395" t="ghadi You&apos;ll need endpoints, and the dynamodb dep"><y>#</y><d>2019-04-17</d><h>23:23</h><w>ghadi</w>You&apos;ll need endpoints, and the dynamodb dep</z><z id="t1555543426" t="ghadi Should be on the README. Let me know if it&apos;s unclear, and maybe we can reword"><y>#</y><d>2019-04-17</d><h>23:23</h><w>ghadi</w>Should be on the README. Let me know if it&apos;s unclear, and maybe we can reword</z><z id="t1555543470" t="gzmask where is the dynamodb dep ?"><y>#</y><d>2019-04-17</d><h>23:24</h><w>gzmask</w>where is the dynamodb dep ?</z><z id="t1555543553" t="ghadi https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2019-04-17</d><h>23:25</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1555543778" t="gzmask 🆗 thanks, like you said I missed two deps."><y>#</y><d>2019-04-17</d><h>23:29</h><w>gzmask</w><b>🆗</b> thanks, like you said I missed two deps.</z><z id="t1555608719" t="gzmask Just a minor thing, the readme could use more attention on the service dep part, such that it’s not obvious at first glance."><y>#</y><d>2019-04-18</d><h>17:31</h><w>gzmask</w>Just a minor thing, the readme could use more attention on the service dep part, such that it’s not obvious at first glance.</z><z id="t1555608740" t="gzmask Also filed an issue with solution PR: https://github.com/cognitect-labs/aws-api/issues/71"><y>#</y><d>2019-04-18</d><h>17:32</h><w>gzmask</w>Also filed an issue with solution PR: <a href="https://github.com/cognitect-labs/aws-api/issues/71" target="_blank">https://github.com/cognitect-labs/aws-api/issues/71</a></z><z id="t1555609866" t="ghadi Thanks [:attrs {:href &quot;/_/_/users/U0JFG0ZU5&quot;}] . Can you post the full stacktrace into the ticket please?"><y>#</y><d>2019-04-18</d><h>17:51</h><w>ghadi</w>Thanks <a>@gzmask</a> .  Can you post the full stacktrace into the ticket please?</z><z id="t1555609880" t="ghadi with the request payload"><y>#</y><d>2019-04-18</d><h>17:51</h><w>ghadi</w>with the request payload</z><z id="t1555609910" t="ghadi *e should provide the data representation of the trace"><y>#</y><d>2019-04-18</d><h>17:51</h><w>ghadi</w><code>*e</code> should provide the data representation of the trace</z><z id="t1555610126" t="gzmask sure, updated the ticket with cider inspector error trace."><y>#</y><d>2019-04-18</d><h>17:55</h><w>gzmask</w>sure, updated the ticket with cider inspector error trace.</z><z id="t1555610435" t="ghadi i&apos;m sorry to be a pest, but can you reformat it?"><y>#</y><d>2019-04-18</d><h>18:00</h><w>ghadi</w>i&apos;m sorry to be a pest, but can you reformat it?</z><z id="t1555610459" t="gzmask yeah, I am replacing the \n s"><y>#</y><d>2019-04-18</d><h>18:00</h><w>gzmask</w>yeah, I am replacing the <code>\n</code>s</z><z id="t1555610472" t="ghadi user=&gt; (throw (Exception. &quot;foo&quot;)) Execution error at user/eval1 (REPL:1). foo user=&gt; *e #error { :cause &quot;foo&quot; :via [{:type java.lang.Exception :message &quot;foo&quot; :at [user$eval1 invokeStatic &quot;NO_SOURCE_FILE&quot; 1]}] :trace [[user$eval1 invokeStatic &quot;NO_SOURCE_FILE&quot; 1] [user$eval1 invoke &quot;NO_SOURCE_FILE&quot; 1] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7176] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7131] [clojure.core$eval invokeStatic &quot;core.clj&quot; 3214] [clojure.core$eval invoke &quot;core.clj&quot; 3210] [clojure.main$repl$read_eval_print__9088$fn__9091 invoke &quot;main.clj&quot; 437] [clojure.main$repl$read_eval_print__9088 invoke &quot;main.clj&quot; 437] [clojure.main$repl$fn__9097 invoke &quot;main.clj&quot; 458] [clojure.main$repl invokeStatic &quot;main.clj&quot; 458] [clojure.main$repl_opt invokeStatic &quot;main.clj&quot; 522] [clojure.main$main invokeStatic &quot;main.clj&quot; 667] [clojure.main$main doInvoke &quot;main.clj&quot; 618] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 397] [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 152] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 132] [clojure.lang.Var applyTo &quot;Var.java&quot; 705] [clojure.main main &quot;main.java&quot; 40]]} user=&gt; "><y>#</y><d>2019-04-18</d><h>18:01</h><w>ghadi</w><pre>user=&gt; (throw (Exception. &quot;foo&quot;))
Execution error at user/eval1 (REPL:1).
foo
user=&gt; *e
#error {
 :cause &quot;foo&quot;
 :via
 [{:type java.lang.Exception
   :message &quot;foo&quot;
   :at [user$eval1 invokeStatic &quot;NO_SOURCE_FILE&quot; 1]}]
 :trace
 [[user$eval1 invokeStatic &quot;NO_SOURCE_FILE&quot; 1]
  [user$eval1 invoke &quot;NO_SOURCE_FILE&quot; 1]
  [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7176]
  [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7131]
  [clojure.core$eval invokeStatic &quot;core.clj&quot; 3214]
  [clojure.core$eval invoke &quot;core.clj&quot; 3210]
  [clojure.main$repl$read_eval_print__9088$fn__9091 invoke &quot;main.clj&quot; 437]
  [clojure.main$repl$read_eval_print__9088 invoke &quot;main.clj&quot; 437]
  [clojure.main$repl$fn__9097 invoke &quot;main.clj&quot; 458]
  [clojure.main$repl invokeStatic &quot;main.clj&quot; 458]
  [clojure.main$repl_opt invokeStatic &quot;main.clj&quot; 522]
  [clojure.main$main invokeStatic &quot;main.clj&quot; 667]
  [clojure.main$main doInvoke &quot;main.clj&quot; 618]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 397]
  [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 152]
  [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 132]
  [clojure.lang.Var applyTo &quot;Var.java&quot; 705]
  [clojure.main main &quot;main.java&quot; 40]]}
user=&gt;
</pre></z><z id="t1555610496" t="ghadi having readable error data is useful to us"><y>#</y><d>2019-04-18</d><h>18:01</h><w>ghadi</w>having readable error data is useful to us</z><z id="t1555610519" t="ghadi (Throwable-&gt;map the-exception) if you&apos;ve caught it already ^"><y>#</y><d>2019-04-18</d><h>18:01</h><w>ghadi</w><code>(Throwable-&gt;map the-exception)</code>
if you&apos;ve caught it already ^</z><z id="t1555610566" t="gzmask yup, the exception is just data and not thrown into the repl"><y>#</y><d>2019-04-18</d><h>18:02</h><w>gzmask</w>yup, the exception is just data and not thrown into the repl</z><z id="t1555610706" t="ghadi thanks!"><y>#</y><d>2019-04-18</d><h>18:05</h><w>ghadi</w>thanks!</z><z id="t1555709334" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.301 https://groups.google.com/forum/#!topic/clojure/TXxEx-2OV2s"><y>#</y><d>2019-04-19</d><h>21:28</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.301 <a href="https://groups.google.com/forum/#!topic/clojure/TXxEx-2OV2s" target="_blank">https://groups.google.com/forum/#!topic/clojure/TXxEx-2OV2s</a></z><z id="t1556218010" t="souenzzo Can I do this https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html via aws-api?"><y>#</y><d>2019-04-25</d><h>18:46</h><w>souenzzo</w>Can I do this <a href="https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html" target="_blank">https://docs.aws.amazon.com/cli/latest/reference/s3/presign.html</a> via aws-api?</z><z id="t1556218031" t="ghadi not directly"><y>#</y><d>2019-04-25</d><h>18:47</h><w>ghadi</w>not directly</z><z id="t1556218057" t="ghadi there are some internal function you can assemble that from"><y>#</y><d>2019-04-25</d><h>18:47</h><w>ghadi</w>there are some internal function you can assemble that from</z><z id="t1556218085" t="ghadi fundamentally presigned URLs are signed requests that aren&apos;t sent off, but we haven&apos;t exposed anything to make those"><y>#</y><d>2019-04-25</d><h>18:48</h><w>ghadi</w>fundamentally presigned URLs are signed requests that aren&apos;t sent off, but we haven&apos;t exposed anything to make those</z><z id="t1556218329" t="souenzzo From JS api https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#getSignedUrl-property"><y>#</y><d>2019-04-25</d><h>18:52</h><w>souenzzo</w>From JS api
<a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#getSignedUrl-property" target="_blank">https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#getSignedUrl-property</a></z><z id="t1556218494" t="ghadi https://github.com/cognitect-labs/aws-api/issues/5"><y>#</y><d>2019-04-25</d><h>18:54</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a></z><z id="t1556745772" t="wei any recommendations for scheduling one-time events in a system built on AWS? I was looking at CloudWatch events but they&apos;re limited to 100 rules. other ideas are Quartzite persisted in RDS, or abusing the Dynamo TTL feature. curious if anyone&apos;s done something similar?"><y>#</y><d>2019-05-01</d><h>21:22</h><w>wei</w>any recommendations for scheduling one-time events in a system built on AWS? I was looking at CloudWatch events but they&apos;re limited to 100 rules. other ideas are Quartzite persisted in RDS, or abusing the Dynamo TTL feature. curious if anyone&apos;s done something similar?</z><z id="t1556758714" t="hiredman Step functions can wait till a certain time or until an amount of time elapses then call a lambda"><y>#</y><d>2019-05-02</d><h>00:58</h><w>hiredman</w>Step functions can wait till a certain time or until an amount of time elapses then call a lambda</z><z id="t1556758750" t="hiredman https://docs.aws.amazon.com/step-functions/latest/dg/amazon-states-language-wait-state.html"><y>#</y><d>2019-05-02</d><h>00:59</h><w>hiredman</w><a href="https://docs.aws.amazon.com/step-functions/latest/dg/amazon-states-language-wait-state.html" target="_blank">https://docs.aws.amazon.com/step-functions/latest/dg/amazon-states-language-wait-state.html</a></z><z id="t1556769403" t="wei will check out AWS step functions, thanks."><y>#</y><d>2019-05-02</d><h>03:56</h><w>wei</w>will check out AWS step functions, thanks.</z><z id="t1556781748" t="lloydshark [:attrs {:href &quot;/_/_/users/U066TMAKS&quot;}] AWS Lambda can be triggered by CloudWatch events (could easily add extra logic inside the lambda if needed)."><y>#</y><d>2019-05-02</d><h>07:22</h><w>lloydshark</w><a>@wei</a> AWS Lambda can be triggered by CloudWatch events (could easily add extra logic inside the lambda if needed).</z><z id="t1556782948" t="lloydshark We used Lambda via CloudWatch for any time based triggering at my last work."><y>#</y><d>2019-05-02</d><h>07:42</h><w>lloydshark</w>We used Lambda via CloudWatch for any time based triggering at my last work.</z><z id="t1556783014" t="wei [:attrs {:href &quot;/_/_/users/U4T99SHSB&quot;}] thanks, I&apos;m concerned about the 100 rule limit on cloudwatch events though, seems better suited for recurring events. for my use case I&apos;d need to schedule thousands of one-time events"><y>#</y><d>2019-05-02</d><h>07:43</h><w>wei</w><a>@lloydshark</a> thanks, I&apos;m concerned about the 100 rule limit on cloudwatch events though, seems better suited for recurring events. for my use case I&apos;d need to schedule thousands of one-time events</z><z id="t1556783164" t="valtteri What is the timespan? I mean, how long time there’s between receiving the event and handling it?"><y>#</y><d>2019-05-02</d><h>07:46</h><w>valtteri</w>What is the timespan? I mean, how long time there’s between receiving the event and handling it?</z><z id="t1556786759" t="wei could be weeks or months"><y>#</y><d>2019-05-02</d><h>08:45</h><r>wei</r>could be weeks or months</z><z id="t1556798086" t="valtteri In that case probably the simplest solution is to use Step Functions as hiredman mentioned. If the timespan was less than 30 days you could’ve abused SQS as well. DynamoDB TTL feature sounds like an interesting alternative though! Is the idea that you use delete events in the DDB Stream as triggers?"><y>#</y><d>2019-05-02</d><h>11:54</h><r>valtteri</r>In that case probably the simplest solution is to use Step Functions as hiredman mentioned. If the timespan was less than 30 days you could’ve abused SQS as well. DynamoDB TTL feature sounds like an interesting alternative though! Is the idea that you use delete events in the DDB Stream as triggers?</z><z id="t1556783174" t="valtteri (in case it’s known)"><y>#</y><d>2019-05-02</d><h>07:46</h><w>valtteri</w>(in case it’s known)</z><z id="t1556783218" t="valtteri And how precise does the triggering need to be?"><y>#</y><d>2019-05-02</d><h>07:46</h><w>valtteri</w>And how precise does the triggering need to be?</z><z id="t1556783278" t="lloydshark If it really suits you can ask for an increase in the 100 rule limit."><y>#</y><d>2019-05-02</d><h>07:47</h><w>lloydshark</w>If it really suits you can ask for an increase in the 100 rule limit.</z><z id="t1556786790" t="wei I&apos;ve applied so we&apos;ll see what they say, not sure if I&apos;ll be able to get an order of magnitude more though"><y>#</y><d>2019-05-02</d><h>08:46</h><r>wei</r>I&apos;ve applied so we&apos;ll see what they say, not sure if I&apos;ll be able to get an order of magnitude more though</z><z id="t1556794004" t="lloydshark Yeah I don&apos;t know what the hard limit is..."><y>#</y><d>2019-05-02</d><h>10:46</h><r>lloydshark</r>Yeah I don&apos;t know what the hard limit is...</z><z id="t1556783321" t="lloydshark But like [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] says - there might be other options depending on what you actually need to do."><y>#</y><d>2019-05-02</d><h>07:48</h><w>lloydshark</w>But like <a>@valtteri</a> says - there might be other options depending on what you actually need to do.</z><z id="t1556804474" t="viesti step functions have some limits too https://docs.aws.amazon.com/step-functions/latest/dg/limits.html"><y>#</y><d>2019-05-02</d><h>13:41</h><w>viesti</w>step functions have some limits too <a href="https://docs.aws.amazon.com/step-functions/latest/dg/limits.html" target="_blank">https://docs.aws.amazon.com/step-functions/latest/dg/limits.html</a></z><z id="t1556804524" t="viesti while googling around, ran into aws simple workflow, which has eerily ~similar limits https://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-dg-limits.html"><y>#</y><d>2019-05-02</d><h>13:42</h><w>viesti</w>while googling around, ran into aws simple workflow, which has eerily ~similar limits <a href="https://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-dg-limits.html" target="_blank">https://docs.aws.amazon.com/amazonswf/latest/developerguide/swf-dg-limits.html</a></z><z id="t1556804587" t="viesti don&apos;t know how the cost of quartz + ec2 compare to these, probably depends on the number of tasks to be scheduled"><y>#</y><d>2019-05-02</d><h>13:43</h><w>viesti</w>don&apos;t know how the cost of quartz + ec2 compare to these, probably depends on the number of tasks to be scheduled</z><z id="t1557173869" t="mss using cognitect’s aws api for the first time, and getting an error: Exception in thread &quot;async-dispatch-1&quot; java.lang.NoClassDefFoundError: org/eclipse/jetty/util/thread/NonBlockingThread when attempting to invoke (def s3 (aws/client {:api :s3})) per the example in the readme. if anyone has any ideas what could be causing that, I’m all ears"><y>#</y><d>2019-05-06</d><h>20:17</h><w>mss</w>using cognitect’s aws api for the first time, and getting an error: <code>Exception in thread &quot;async-dispatch-1&quot; java.lang.NoClassDefFoundError: org/eclipse/jetty/util/thread/NonBlockingThread</code> when attempting to invoke  <code>(def s3 (aws/client {:api :s3}))</code> per the example in the readme. if anyone has any ideas what could be causing that, I’m all ears</z><z id="t1557173963" t="Alex Miller (Clojure team) what are your deps?"><y>#</y><d>2019-05-06</d><h>20:19</h><w>Alex Miller (Clojure team)</w>what are your deps?</z><z id="t1557174036" t="mss using a lein project.clj, which I assume is the root of the issue"><y>#</y><d>2019-05-06</d><h>20:20</h><w>mss</w>using a lein project.clj, which I assume is the root of the issue</z><z id="t1557174054" t="mss first time using a lib that declares its deps using deps.edn afaik, so if I’m missing something about how those might fit together that’s likely it"><y>#</y><d>2019-05-06</d><h>20:20</h><w>mss</w>first time using a lib that declares its deps using deps.edn afaik, so if I’m missing something about how those might fit together that’s likely it</z><z id="t1557174096" t="ghadi [:attrs {:href &quot;/_/_/users/U04V5HFPU&quot;}] lein is fine, paste your deps --- you&apos;ll need three"><y>#</y><d>2019-05-06</d><h>20:21</h><w>ghadi</w><a>@mss</a> lein is fine, paste your deps --- you&apos;ll need three</z><z id="t1557174121" t="mss [com.cognitect.aws/api &quot;0.8.301&quot;] [com.cognitect.aws/endpoints &quot;1.1.11.537&quot;] [com.cognitect.aws/s3 &quot;714.2.430.0&quot;] "><y>#</y><d>2019-05-06</d><h>20:22</h><w>mss</w><pre>[com.cognitect.aws/api &quot;0.8.301&quot;]
[com.cognitect.aws/endpoints &quot;1.1.11.537&quot;]
[com.cognitect.aws/s3 &quot;714.2.430.0&quot;]
</pre></z><z id="t1557174187" t="ghadi that seems correct"><y>#</y><d>2019-05-06</d><h>20:23</h><w>ghadi</w>that seems correct</z><z id="t1557174206" t="mss yeah no weird exclusions that I can tell either"><y>#</y><d>2019-05-06</d><h>20:23</h><w>mss</w>yeah no weird exclusions that I can tell either</z><z id="t1557174278" t="ghadi can you paste the output of lein deps :tree"><y>#</y><d>2019-05-06</d><h>20:24</h><w>ghadi</w>can you paste the output of <code>lein deps :tree</code></z><z id="t1557174511" t="mss"><y>#</y><d>2019-05-06</d><h>20:28</h><w>mss</w></z><z id="t1557174538" t="mss get the same error regardless of whether I add the ring/jetty-io exclusion or not"><y>#</y><d>2019-05-06</d><h>20:28</h><w>mss</w>get the same error regardless of whether I add the ring/jetty-io exclusion or not</z><z id="t1557174638" t="ghadi are you sure?"><y>#</y><d>2019-05-06</d><h>20:30</h><w>ghadi</w>are you sure?</z><z id="t1557174656" t="mss lemme sanity check it just to be sure. gimme a sec"><y>#</y><d>2019-05-06</d><h>20:30</h><w>mss</w>lemme sanity check it just to be sure. gimme a sec</z><z id="t1557174657" t="ghadi it looks like ring-jetty-adapter is forcing an older version of jetty (9.2)"><y>#</y><d>2019-05-06</d><h>20:30</h><w>ghadi</w>it looks like ring-jetty-adapter is forcing an older version of jetty (9.2)</z><z id="t1557174659" t="mss thank you for the help btw!"><y>#</y><d>2019-05-06</d><h>20:30</h><w>mss</w>thank you for the help btw!</z><z id="t1557174662" t="ghadi n.p."><y>#</y><d>2019-05-06</d><h>20:31</h><w>ghadi</w>n.p.</z><z id="t1557174671" t="ghadi aws-api needs jetty 9.3 IIRC"><y>#</y><d>2019-05-06</d><h>20:31</h><w>ghadi</w>aws-api needs jetty 9.3 IIRC</z><z id="t1557174709" t="mss fwiw, if I bump my ring version to 1.7.1 (latest IIRC) and it defaults to using the cognitect jetty-io version, I get a different error about thread pool exhaustion"><y>#</y><d>2019-05-06</d><h>20:31</h><w>mss</w>fwiw, if I bump my ring version to 1.7.1 (latest IIRC) and it defaults to using the cognitect jetty-io version, I get a different error about thread pool exhaustion</z><z id="t1557174769" t="mss lemme run through the with/without exclusion on ring 1.6.3 and I can get you the error message on ring 1.7.1"><y>#</y><d>2019-05-06</d><h>20:32</h><w>mss</w>lemme run through the with/without exclusion on ring 1.6.3 and I can get you the error message on ring 1.7.1</z><z id="t1557174784" t="ghadi jetty should be at &quot;9.3.7.v20160115&quot; when you&apos;ll have everything working correctly"><y>#</y><d>2019-05-06</d><h>20:33</h><w>ghadi</w>jetty should be at  &quot;9.3.7.v20160115&quot; when you&apos;ll have everything working correctly</z><z id="t1557174898" t="mss yep, just went ahead and added that specific version to my deps and all is well"><y>#</y><d>2019-05-06</d><h>20:34</h><w>mss</w>yep, just went ahead and added that specific version to my deps and all is well</z><z id="t1557174901" t="mss thanks for the help troubleshooting"><y>#</y><d>2019-05-06</d><h>20:35</h><w>mss</w>thanks for the help troubleshooting</z><z id="t1557174917" t="ghadi my pleasure"><y>#</y><d>2019-05-06</d><h>20:35</h><w>ghadi</w>my pleasure</z><z id="t1557329505" t="viesti Randomly thinking out loud, would be neat to have dependency free http client (like https://github.com/schmee/java-http-clj , but that is on Java 11)"><y>#</y><d>2019-05-08</d><h>15:31</h><w>viesti</w>Randomly thinking out loud, would be neat to have dependency free http client (like <a href="https://github.com/schmee/java-http-clj" target="_blank">https://github.com/schmee/java-http-clj</a>, but that is on Java 11)</z><z id="t1557329565" t="viesti I guess https://github.com/cognitect-labs/aws-api/issues/11 could put thoughts on that track"><y>#</y><d>2019-05-08</d><h>15:32</h><w>viesti</w>I guess <a href="https://github.com/cognitect-labs/aws-api/issues/11" target="_blank">https://github.com/cognitect-labs/aws-api/issues/11</a> could put thoughts on that track</z><z id="t1557329636" t="viesti The Java sdk v2 intends to have pluggable http implementation https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/welcome.html#whats-new"><y>#</y><d>2019-05-08</d><h>15:33</h><w>viesti</w>The Java sdk v2 intends to have pluggable http implementation <a href="https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/welcome.html#whats-new" target="_blank">https://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/welcome.html#whats-new</a></z><z id="t1557329731" t="viesti Don&apos;t want to sound like I&apos;m reaching for the sky, we don&apos;t have as much devs as AWS :)"><y>#</y><d>2019-05-08</d><h>15:35</h><w>viesti</w>Don&apos;t want to sound like I&apos;m reaching for the sky, we don&apos;t have as much devs as AWS :)</z><z id="t1557594590" t="Kari Marttila A question regarding Cognitect AWS library ( https://github.com/cognitect-labs/aws-api ): This deps.edn works: { :deps {org.clojure/clojure {:mvn/version &quot;1.10.0&quot;} org.clojure/core.async {:mvn/version &quot;0.4.490&quot;} org.clojure/data.json {:mvn/version &quot;0.2.6&quot;} com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.549&quot;} com.cognitect.aws/dynamodb {:mvn/version &quot;697.2.391.0&quot;} ring/ring-core {:mvn/version &quot;1.7.1&quot;} ;; ring/ring-jetty-adapter {:mvn/version &quot;1.7.1&quot;} ring-cors/ring-cors {:mvn/version &quot;0.1.13&quot;} ring/ring-json {:mvn/version &quot;0.4.0&quot;} ring/ring-defaults {:mvn/version &quot;0.3.2&quot;} } } But if I remove the comment away and use ring/ring-jetty-adapter dependency I get an exception: (do (require &apos;[clojure.core.async :as a] &apos;[ :as io] &apos;[clojure.data.json :as json] &apos;[cognitect.aws.client.api :as aws] &apos;[cognitect.aws.client.api.async :as aws.async]) (def ddb (aws/client {:api :dynamodb})) (aws/invoke ddb {:op :ListTables}) ) =&gt; {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot;, :cognitect.http-client/throwable #error { :cause &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot; :via [{:type java.lang.NoSuchMethodError :message &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot; :at [org.eclipse.jetty.client.AbstractHttpClientTransport connect &quot;AbstractHttpClientTransport.java&quot; 118]}] :trace [[org.eclipse.jetty.client.AbstractHttpClientTransport connect &quot;AbstractHttpClientTransport.java&quot; 118] [org.eclipse.jetty.client.HttpClient$1 connect &quot;HttpClient.java&quot; 580] [org.eclipse.jetty.client.HttpClient$1 succeeded &quot;HttpClient.java&quot; 551] [org.eclipse.jetty.client.HttpClient$1 succeeded &quot;HttpClient.java&quot; 545] [org.eclipse.jetty.util.SocketAddressResolver$Async lambda$resolve$1 &quot;SocketAddressResolver.java&quot; 181] [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 765] [org.eclipse.jetty.util.thread.QueuedThreadPool$2 run &quot;QueuedThreadPool.java&quot; 683] [java.lang.Thread run &quot;Thread.java&quot; 834]]}} Sadly, this is a bit showstopper since I&apos;m using Ring in my web app. Is it possible to use Ring together with Cognitect&apos;s AWS library? If yes, what dependencies should I use?"><y>#</y><d>2019-05-11</d><h>17:09</h><w>Kari Marttila</w>A question regarding Cognitect AWS library ( <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a> ):
This deps.edn works:
<pre>{ :deps    {org.clojure/clojure         {:mvn/version &quot;1.10.0&quot;}
            org.clojure/core.async      {:mvn/version &quot;0.4.490&quot;}
            org.clojure/data.json       {:mvn/version &quot;0.2.6&quot;}
            com.cognitect.aws/api       {:mvn/version &quot;0.8.305&quot;}
            com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.549&quot;}
            com.cognitect.aws/dynamodb  {:mvn/version &quot;697.2.391.0&quot;}
            ring/ring-core                  {:mvn/version &quot;1.7.1&quot;}
;;            ring/ring-jetty-adapter         {:mvn/version &quot;1.7.1&quot;}
            ring-cors/ring-cors             {:mvn/version &quot;0.1.13&quot;}
            ring/ring-json                  {:mvn/version &quot;0.4.0&quot;}
            ring/ring-defaults              {:mvn/version &quot;0.3.2&quot;}
           }
 }
</pre>
But if I remove the comment away and use ring/ring-jetty-adapter dependency I get an exception:
<pre>(do (require &apos;[clojure.core.async :as a] &apos;[ :as io] &apos;[clojure.data.json :as json] &apos;[cognitect.aws.client.api :as aws] &apos;[cognitect.aws.client.api.async :as aws.async]) (def ddb (aws/client {:api :dynamodb})) (aws/invoke ddb {:op :ListTables}) )
=&gt;
{:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot;, :cognitect.http-client/throwable #error {
 :cause &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot;
 :via
 [{:type java.lang.NoSuchMethodError
   :message &quot;org.eclipse.jetty.io.SelectorManager.connect(Ljava/nio/channels/SocketChannel;Ljava/lang/Object;)V&quot;
   :at [org.eclipse.jetty.client.AbstractHttpClientTransport connect &quot;AbstractHttpClientTransport.java&quot; 118]}]
 :trace
 [[org.eclipse.jetty.client.AbstractHttpClientTransport connect &quot;AbstractHttpClientTransport.java&quot; 118]
  [org.eclipse.jetty.client.HttpClient$1 connect &quot;HttpClient.java&quot; 580]
  [org.eclipse.jetty.client.HttpClient$1 succeeded &quot;HttpClient.java&quot; 551]
  [org.eclipse.jetty.client.HttpClient$1 succeeded &quot;HttpClient.java&quot; 545]
  [org.eclipse.jetty.util.SocketAddressResolver$Async lambda$resolve$1 &quot;SocketAddressResolver.java&quot; 181]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 765]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$2 run &quot;QueuedThreadPool.java&quot; 683]
  [java.lang.Thread run &quot;Thread.java&quot; 834]]}}

</pre>
Sadly, this is a bit showstopper since I&apos;m using Ring in my web app.
Is it possible to use Ring together with Cognitect&apos;s AWS library? If yes, what dependencies should I use?</z><z id="t1557597010" t="Kari Marttila [:attrs {:href &quot;/_/_/users/U04V70XH6&quot;}] kindly told me to check the jetty versions of Cognitect&apos;s AWS library and Ring. I used clj -Stree: com.cognitect.aws/api 0.8.305 ... com.cognitect/http-client 0.1.87 org.eclipse.jetty/jetty-client 9.3.7.v20160115 ... ring/ring-jetty-adapter 1.7.1 ring/ring-servlet 1.7.1 org.eclipse.jetty/jetty-server 9.4.12.v20180830 ... I&apos;m just wondering how am I able to resolve this? I&apos;m using deps.edn."><y>#</y><d>2019-05-11</d><h>17:50</h><w>Kari Marttila</w><a>@seancorfield</a> kindly told me to check the jetty versions of Cognitect&apos;s AWS library and Ring. I used clj -Stree:
<pre>com.cognitect.aws/api 0.8.305
...
  com.cognitect/http-client 0.1.87
    org.eclipse.jetty/jetty-client 9.3.7.v20160115
...
ring/ring-jetty-adapter 1.7.1
  ring/ring-servlet 1.7.1
  org.eclipse.jetty/jetty-server 9.4.12.v20180830
...
</pre>
I&apos;m just wondering how am I able to resolve this? I&apos;m using deps.edn.</z><z id="t1557600365" t="thegeez [:attrs {:href &quot;/_/_/users/U76D9RZRR&quot;}] having the same version for jetty-client and jetty-server might work: com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot; :exclusions [org.eclipse.jetty/jetty-client]} org.eclipse.jetty/jetty-client {:mvn/version &quot;9.4.12.v20180830&quot;}"><y>#</y><d>2019-05-11</d><h>18:46</h><w>thegeez</w><a>@kari.marttila</a> having the same version for jetty-client and jetty-server might work: <pre>com.cognitect.aws/api       {:mvn/version &quot;0.8.305&quot; :exclusions [org.eclipse.jetty/jetty-client]}
            org.eclipse.jetty/jetty-client {:mvn/version &quot;9.4.12.v20180830&quot;}</pre></z><z id="t1557605129" t="Kari Marttila Ok. That&apos;s the way to do it. Thanks [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] ! I&apos;ll try it tomorrow!"><y>#</y><d>2019-05-11</d><h>20:05</h><w>Kari Marttila</w>Ok. That&apos;s the way to do it. Thanks <a>@thegeez</a>  ! I&apos;ll try it tomorrow!</z><z id="t1557648335" t="Kari Marttila [:attrs {:href &quot;/_/_/users/U06D9RGQM&quot;}] and [:attrs {:href &quot;/_/_/users/U04V70XH6&quot;}] : thanks for your help! Adding the exclusion and the jetty-client dependency with the same version as the server worked! I can now continue using Cognitect&apos;s AWS library with my latest Clojure learning project! This Clojurians Slack is really great and it is really nice that there are people like you who are willing to help us beginners!"><y>#</y><d>2019-05-12</d><h>08:05</h><w>Kari Marttila</w><a>@thegeez</a> and <a>@seancorfield</a>: thanks for your help! Adding the exclusion and the jetty-client dependency with the same version as the server worked! I can now continue using Cognitect&apos;s AWS library with my latest Clojure learning project!  This Clojurians Slack is really great and it is really nice that there are people like you who are willing to help us beginners!</z><z id="t1557754143" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.305 https://groups.google.com/forum/#!topic/clojure/rKAbv6-U3CM"><y>#</y><d>2019-05-13</d><h>13:29</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.305 <a href="https://groups.google.com/forum/#!topic/clojure/rKAbv6-U3CM" target="_blank">https://groups.google.com/forum/#!topic/clojure/rKAbv6-U3CM</a></z><z id="t1557903884" t="orestis I’d like to use SQS for a low-traffic mail-sending queue (say less than 5k emails/day), but both the producers and the consumers would not be running on AWS (yet, they will in 6 months time). Is this a crazy idea or pretty normal?"><y>#</y><d>2019-05-15</d><h>07:04</h><w>orestis</w>I’d like to use SQS for a low-traffic mail-sending queue (say less than 5k emails/day), but both the producers and the consumers would not be running on AWS (yet, they will in 6 months time). Is this a crazy idea or pretty normal?</z><z id="t1557923289" t="ghadi Normal [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] "><y>#</y><d>2019-05-15</d><h>12:28</h><w>ghadi</w>Normal <a>@orestis</a> </z><z id="t1557923835" t="orestis Cool! I see that they say latency is at most low hundred ms so for an email queue that sounds acceptable. "><y>#</y><d>2019-05-15</d><h>12:37</h><w>orestis</w>Cool! I see that they say latency is at most low hundred ms so for an email queue that sounds acceptable. </z><z id="t1557940188" t="kenny What are valid blob types I can pass to aws-api?"><y>#</y><d>2019-05-15</d><h>17:09</h><w>kenny</w>What are valid <code>blob</code> types I can pass to aws-api?</z><z id="t1557940339" t="kenny Ah, the specs are useful 🙂"><y>#</y><d>2019-05-15</d><h>17:12</h><w>kenny</w>Ah, the specs are useful <b>🙂</b></z><z id="t1557940341" t="kenny (s/form :cognitect.aws.s3.PutObjectRequest/Body) =&gt; (clojure.spec.alpha/or :byte-array clojure.core/bytes? :input-stream (clojure.core/fn [%] (clojure.core/instance? java.io.InputStream %))) "><y>#</y><d>2019-05-15</d><h>17:12</h><w>kenny</w><pre>(s/form :cognitect.aws.s3.PutObjectRequest/Body)
=&gt;
(clojure.spec.alpha/or
 :byte-array
 clojure.core/bytes?
 :input-stream
 (clojure.core/fn [%] (clojure.core/instance? java.io.InputStream %)))
</pre></z><z id="t1557940375" t="ghadi we might expand that in the future"><y>#</y><d>2019-05-15</d><h>17:12</h><w>ghadi</w>we might expand that in the future</z><z id="t1557940389" t="ghadi specifically to handle larger than memory objects"><y>#</y><d>2019-05-15</d><h>17:13</h><w>ghadi</w>specifically to handle larger than memory objects</z><z id="t1557940470" t="kenny If my :PutObject request fails, does aws-api automatically retry the request?"><y>#</y><d>2019-05-15</d><h>17:14</h><w>kenny</w>If my <code>:PutObject</code> request fails, does aws-api automatically retry the request?</z><z id="t1557940592" t="kenny Ah I see - it&apos;s set on the client and, optionally, on the individual request. Nice."><y>#</y><d>2019-05-15</d><h>17:16</h><w>kenny</w>Ah I see - it&apos;s set on the client and, optionally, on the individual request. Nice.</z><z id="t1557940783" t="kenny Has it been considered to have the client implement Closable?"><y>#</y><d>2019-05-15</d><h>17:19</h><w>kenny</w>Has it been considered to have the client implement Closable?</z><z id="t1557941083" t="kenny Also could a client? function be added?"><y>#</y><d>2019-05-15</d><h>17:24</h><w>kenny</w>Also could a <code>client?</code> function be added?</z><z id="t1557941107" t="ghadi why the predicate?"><y>#</y><d>2019-05-15</d><h>17:25</h><w>ghadi</w>why the predicate?</z><z id="t1557941115" t="kenny Spec"><y>#</y><d>2019-05-15</d><h>17:25</h><w>kenny</w>Spec</z><z id="t1557941134" t="kenny i.e. right now I need to do this: (s/def ::s3-client #(satisfies? aws-client/ClientSPI %)) "><y>#</y><d>2019-05-15</d><h>17:25</h><w>kenny</w>i.e. right now I need to do this:
<pre>(s/def ::s3-client #(satisfies? aws-client/ClientSPI %))
</pre></z><z id="t1557948568" t="kenny Out of curiosity, does anyone know if Azure or GCP expose their APIs via data files like AWS does?"><y>#</y><d>2019-05-15</d><h>19:29</h><w>kenny</w>Out of curiosity, does anyone know if Azure or GCP expose their APIs via data files like AWS does?</z><z id="t1557949106" t="kenny Looks like they do provide swagger JSON files for all their APIs."><y>#</y><d>2019-05-15</d><h>19:38</h><w>kenny</w>Looks like they do provide swagger JSON files for all their APIs.</z><z id="t1557949337" t="kenny If you could transform the AWS API JSONs into the OpenAPI format, it seems like the aws-api concept could work for multiple cloud providers."><y>#</y><d>2019-05-15</d><h>19:42</h><w>kenny</w>If you could transform the AWS API JSONs into the OpenAPI format, it seems like the aws-api concept could work for multiple cloud providers.</z><z id="t1557949433" t="kenny Looks like someone has already done this: https://github.com/APIs-guru/openapi-directory/tree/master/APIs/amazonaws.com"><y>#</y><d>2019-05-15</d><h>19:43</h><w>kenny</w>Looks like someone has already done this: <a href="https://github.com/APIs-guru/openapi-directory/tree/master/APIs/amazonaws.com" target="_blank">https://github.com/APIs-guru/openapi-directory/tree/master/APIs/amazonaws.com</a></z><z id="t1557949482" t="ghadi there&apos;s a lot of little exceptions to the AWS APIs"><y>#</y><d>2019-05-15</d><h>19:44</h><w>ghadi</w>there&apos;s a lot of little exceptions to the AWS APIs</z><z id="t1557949535" t="kenny Kinda figured. Know any examples offhand?"><y>#</y><d>2019-05-15</d><h>19:45</h><w>kenny</w>Kinda figured. Know any examples offhand?</z><z id="t1557949652" t="ghadi almost all of s3"><y>#</y><d>2019-05-15</d><h>19:47</h><w>ghadi</w>almost all of s3</z><z id="t1557949668" t="ghadi some apis require extra headers with md5 of body"><y>#</y><d>2019-05-15</d><h>19:47</h><w>ghadi</w>some apis require extra headers with md5 of body</z><z id="t1557949689" t="ghadi S3 is the &quot;weird API&quot;"><y>#</y><d>2019-05-15</d><h>19:48</h><w>ghadi</w>S3 is the &quot;weird API&quot;</z><z id="t1557949691" t="kenny Oh, that stuff can&apos;t be documented with openapi?"><y>#</y><d>2019-05-15</d><h>19:48</h><w>kenny</w>Oh, that stuff can&apos;t be documented with openapi?</z><z id="t1557949704" t="ghadi dunno"><y>#</y><d>2019-05-15</d><h>19:48</h><w>ghadi</w>dunno</z><z id="t1557949723" t="ghadi it&apos;s not in the amazon descriptors, so it wouldn&apos;t be in any translation of those descriptors"><y>#</y><d>2019-05-15</d><h>19:48</h><w>ghadi</w>it&apos;s not in the amazon descriptors, so it wouldn&apos;t be in any translation of those descriptors</z><z id="t1557949789" t="kenny How does aws-api handle it?"><y>#</y><d>2019-05-15</d><h>19:49</h><w>kenny</w>How does aws-api handle it?</z><z id="t1557949812" t="ghadi special code that runs on particular requests"><y>#</y><d>2019-05-15</d><h>19:50</h><w>ghadi</w>special code that runs on particular requests</z><z id="t1557949829" t="ghadi there&apos;s an private extension point through a multimethod"><y>#</y><d>2019-05-15</d><h>19:50</h><w>ghadi</w>there&apos;s an private extension point through a multimethod</z><z id="t1557949863" t="kenny Ah. You don&apos;t think you&apos;d be able to do the same thing with multiple cloud providers?"><y>#</y><d>2019-05-15</d><h>19:51</h><w>kenny</w>Ah. You don&apos;t think you&apos;d be able to do the same thing with multiple cloud providers?</z><z id="t1557949926" t="ghadi sure. I&apos;m just trying to say that json descriptors isn&apos;t enough for at least AWS"><y>#</y><d>2019-05-15</d><h>19:52</h><w>ghadi</w>sure.  I&apos;m just trying to say that json descriptors isn&apos;t enough for at least AWS</z><z id="t1557949942" t="ghadi there&apos;s particular API domain knowledge necessary, unfortunately"><y>#</y><d>2019-05-15</d><h>19:52</h><w>ghadi</w>there&apos;s particular API domain knowledge necessary, unfortunately</z><z id="t1557949961" t="ghadi you may want to look at official GCP client sdks and look for these exceptional cases"><y>#</y><d>2019-05-15</d><h>19:52</h><w>ghadi</w>you may want to look at official GCP client sdks and look for these exceptional cases</z><z id="t1557949981" t="ghadi searching for interceptors, request transformers, stuff like that"><y>#</y><d>2019-05-15</d><h>19:53</h><w>ghadi</w>searching for interceptors, request transformers, stuff like that</z><z id="t1557950050" t="kenny It seems like you&apos;d be able to handle that in a similar manner to how aws-api handles &quot;special&quot; apis"><y>#</y><d>2019-05-15</d><h>19:54</h><w>kenny</w>It seems like you&apos;d be able to handle that in a similar manner to how aws-api handles &quot;special&quot; apis</z><z id="t1557950065" t="ghadi yup"><y>#</y><d>2019-05-15</d><h>19:54</h><w>ghadi</w>yup</z><z id="t1557950234" t="kenny Interesting. My company is adding support for additional cloud providers and we really enjoy working with aws-api. Any thoughts on how difficult it&apos;d be to change aws-api to take in OpenAPI JSON instead of the aws-specific JSON files?"><y>#</y><d>2019-05-15</d><h>19:57</h><w>kenny</w>Interesting. My company is adding support for additional cloud providers and we really enjoy working with aws-api. Any thoughts on how difficult it&apos;d be to change aws-api to take in OpenAPI JSON instead of the aws-specific JSON files?</z><z id="t1557950318" t="ghadi personally I wouldn&apos;t try to modify, but I&apos;d take the same approach. input = descriptors -&gt; output = functions that can assemble and disassemble request/response maps"><y>#</y><d>2019-05-15</d><h>19:58</h><w>ghadi</w>personally I wouldn&apos;t try to modify, but I&apos;d take the same approach.

input = descriptors <code>-&gt;</code> output = functions that can assemble and disassemble request/response maps</z><z id="t1557950379" t="ghadi then you wire the functions with an HTTP client"><y>#</y><d>2019-05-15</d><h>19:59</h><w>ghadi</w>then you wire the functions with an HTTP client</z><z id="t1557950422" t="kenny Too many things coupled to aws in aws-api to try and modify it?"><y>#</y><d>2019-05-15</d><h>20:00</h><w>kenny</w>Too many things coupled to aws in aws-api to try and modify it?</z><z id="t1557950525" t="ghadi the descriptor transforming code isn&apos;t open source"><y>#</y><d>2019-05-15</d><h>20:02</h><w>ghadi</w>the descriptor transforming code isn&apos;t open source</z><z id="t1557950633" t="kenny Oh really? Is that non-trivial to do?"><y>#</y><d>2019-05-15</d><h>20:03</h><w>kenny</w>Oh really? Is that non-trivial to do?</z><z id="t1557950653" t="ghadi but mainly I wouldn&apos;t try to modify the client because it&apos;s conceptually a simple thing"><y>#</y><d>2019-05-15</d><h>20:04</h><w>ghadi</w>but mainly I wouldn&apos;t try to modify the client because it&apos;s conceptually a simple thing</z><z id="t1557950664" t="ghadi you get descriptors from google, and you shred them into functions"><y>#</y><d>2019-05-15</d><h>20:04</h><w>ghadi</w>you get descriptors from google, and you shred them into functions</z><z id="t1557950679" t="ghadi functions that operate on maps"><y>#</y><d>2019-05-15</d><h>20:04</h><w>ghadi</w>functions that operate on maps</z><z id="t1557950691" t="ghadi I&apos;m doing something similar with a native protocol buffer client"><y>#</y><d>2019-05-15</d><h>20:04</h><w>ghadi</w>I&apos;m doing something similar with a native protocol buffer client</z><z id="t1557950708" t="kenny Right. The main thing that will differ, I think, is the authentication."><y>#</y><d>2019-05-15</d><h>20:05</h><w>kenny</w>Right. The main thing that will differ, I think, is the authentication.</z><z id="t1557950719" t="ghadi something that takes .proto files and builds functions from maps -&gt; bytes and bytes -&gt; maps"><y>#</y><d>2019-05-15</d><h>20:05</h><w>ghadi</w>something that takes <code>.proto</code> files and builds functions from maps -&gt; bytes and bytes -&gt; maps</z><z id="t1557951380" t="kenny It almost seems like this version of aws-api that is cloud provider independent is simply an OpenAPI HTTP client."><y>#</y><d>2019-05-15</d><h>20:16</h><w>kenny</w>It almost seems like this version of aws-api that is cloud provider independent is simply an OpenAPI HTTP client.</z><z id="t1557951410" t="ghadi i don&apos;t follow"><y>#</y><d>2019-05-15</d><h>20:16</h><w>ghadi</w>i don&apos;t follow</z><z id="t1557951667" t="kenny You could write a library that exposes any OpenAPI spec&apos;ed API in the same format that aws-api takes."><y>#</y><d>2019-05-15</d><h>20:21</h><w>kenny</w>You could write a library that exposes any OpenAPI spec&apos;ed API in the same format that aws-api takes.</z><z id="t1558021256" t="mj_langford AWS JSON files are swagger2.0 right?"><y>#</y><d>2019-05-16</d><h>15:40</h><w>mj_langford</w>AWS JSON files are swagger2.0 right?</z><z id="t1558021397" t="ghadi I don&apos;t think so"><y>#</y><d>2019-05-16</d><h>15:43</h><w>ghadi</w>I don&apos;t think so</z><z id="t1558021552" t="mj_langford Just checked, yup, swagger:"><y>#</y><d>2019-05-16</d><h>15:45</h><w>mj_langford</w>Just checked, yup, swagger:</z><z id="t1558021554" t="mj_langford --- swagger: &quot;2.0&quot;"><y>#</y><d>2019-05-16</d><h>15:45</h><w>mj_langford</w>---
swagger: &quot;2.0&quot;</z><z id="t1558021599" t="mj_langford So OpenAPI is basically the 3.0 version of swagger...so, no, aws doesn&apos;t take open api because swagger is version 2.0 of that"><y>#</y><d>2019-05-16</d><h>15:46</h><w>mj_langford</w>So OpenAPI is basically the 3.0 version of swagger...so, no, aws doesn&apos;t take open api because swagger is version 2.0 of that</z><z id="t1558021700" t="mj_langford You can generate the large body of swagger 2.0 spec for import if you spend time getting all your URIs setup, and you also take time to get your transformations working."><y>#</y><d>2019-05-16</d><h>15:48</h><w>mj_langford</w>You can generate the large body of swagger 2.0 spec for import if you spend time getting  all your URIs setup, and  you  also take time to get your transformations working.</z><z id="t1558021724" t="mj_langford (We have done this on a clojure project that used a swagger-codegen generated test client)"><y>#</y><d>2019-05-16</d><h>15:48</h><w>mj_langford</w>(We have  done this on a clojure project that used a swagger-codegen generated test client)</z><z id="t1558021776" t="kenny [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] Where are you seeing the swagger: &quot;2.0&quot;?"><y>#</y><d>2019-05-16</d><h>15:49</h><w>kenny</w><a>@mj_langford</a> Where are you seeing the swagger: &quot;2.0&quot;?</z><z id="t1558021844" t="mj_langford I went to an api I made last year about this time, went to &quot;Stages&quot; then picked export."><y>#</y><d>2019-05-16</d><h>15:50</h><w>mj_langford</w>I went to an api I made last year about this time, went to &quot;Stages&quot; then  picked export.</z><z id="t1558021847" t="mj_langford Oh look!"><y>#</y><d>2019-05-16</d><h>15:50</h><w>mj_langford</w>Oh look!</z><z id="t1558021854" t="mj_langford They have an OpenApi3 there too"><y>#</y><d>2019-05-16</d><h>15:50</h><w>mj_langford</w>They have an OpenApi3 there too</z><z id="t1558021867" t="mj_langford openapi: &quot;3.0.1&quot;"><y>#</y><d>2019-05-16</d><h>15:51</h><w>mj_langford</w>openapi: &quot;3.0.1&quot;</z><z id="t1558021912" t="mj_langford https://console.aws.amazon.com/apigateway/home?region=YOUR-REGION#/apis/YOURAPIADDRESS/stages/YOURSTAGE"><y>#</y><d>2019-05-16</d><h>15:51</h><w>mj_langford</w><a href="https://console.aws.amazon.com/apigateway/home?region=YOUR-REGION#/apis/YOURAPIADDRESS/stages/YOURSTAGE" target="_blank">https://console.aws.amazon.com/apigateway/home?region=YOUR-REGION#/apis/YOURAPIADDRESS/stages/YOURSTAGE</a></z><z id="t1558021923" t="mj_langford go to the export tab"><y>#</y><d>2019-05-16</d><h>15:52</h><w>mj_langford</w>go to the export tab</z><z id="t1558021935" t="mj_langford You can redploy from these files too"><y>#</y><d>2019-05-16</d><h>15:52</h><w>mj_langford</w>You can redploy from these files too</z><z id="t1558021952" t="ghadi which files are you looking at [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] ?"><y>#</y><d>2019-05-16</d><h>15:52</h><w>ghadi</w>which files are you looking at <a>@mj_langford</a>?</z><z id="t1558022030" t="ghadi https://github.com/aws/aws-sdk-js/blob/master/apis/cloudhsm-2014-05-30.normal.json these are the files that cognitect-labs/aws-api come from"><y>#</y><d>2019-05-16</d><h>15:53</h><w>ghadi</w><a href="https://github.com/aws/aws-sdk-js/blob/master/apis/cloudhsm-2014-05-30.normal.json" target="_blank">https://github.com/aws/aws-sdk-js/blob/master/apis/cloudhsm-2014-05-30.normal.json</a>
these are the files that cognitect-labs/aws-api come from</z><z id="t1558022124" t="mj_langford I don&apos;t know what that file is"><y>#</y><d>2019-05-16</d><h>15:55</h><w>mj_langford</w>I don&apos;t know what that file is</z><z id="t1558022135" t="mj_langford I use yaml, so am used to seeing comments, etc."><y>#</y><d>2019-05-16</d><h>15:55</h><w>mj_langford</w>I use yaml,  so am used to seeing  comments, etc.</z><z id="t1558022149" t="mj_langford Is that a swagger file?"><y>#</y><d>2019-05-16</d><h>15:55</h><w>mj_langford</w>Is that a swagger file?</z><z id="t1558022174" t="ghadi it is not a swagger file"><y>#</y><d>2019-05-16</d><h>15:56</h><w>ghadi</w>it is not a swagger file</z><z id="t1558022184" t="ghadi i think you are talking about something different"><y>#</y><d>2019-05-16</d><h>15:56</h><w>ghadi</w>i think you are talking about something different</z><z id="t1558022224" t="ghadi yesterday someone brought up mechanically generating clients from the metadata that AWS / GCP / Azure provide"><y>#</y><d>2019-05-16</d><h>15:57</h><w>ghadi</w>yesterday someone brought up mechanically generating clients from the metadata that AWS / GCP / Azure provide</z><z id="t1558022235" t="ghadi AWS&apos;s aren&apos;t swagger/openapi"><y>#</y><d>2019-05-16</d><h>15:57</h><w>ghadi</w>AWS&apos;s aren&apos;t swagger/openapi</z><z id="t1558022250" t="mj_langford AWS provides API files from another place, which was the JSON I believed you were speaking of"><y>#</y><d>2019-05-16</d><h>15:57</h><w>mj_langford</w>AWS provides API files from another place, which was the JSON I believed you were speaking of</z><z id="t1558022253" t="mj_langford Apologies."><y>#</y><d>2019-05-16</d><h>15:57</h><w>mj_langford</w>Apologies.</z><z id="t1558022275" t="mj_langford https://console.aws.amazon.com/apigateway/ literally exports OpenAPI/Swagger files for apis we write"><y>#</y><d>2019-05-16</d><h>15:57</h><w>mj_langford</w><a href="https://console.aws.amazon.com/apigateway/" target="_blank">https://console.aws.amazon.com/apigateway/</a> literally exports OpenAPI/Swagger files for apis we write</z><z id="t1558022275" t="ghadi it&apos;s cool that APIGateway appears to export openapi/swagger though"><y>#</y><d>2019-05-16</d><h>15:57</h><w>ghadi</w>it&apos;s cool that APIGateway appears to export openapi/swagger though</z><z id="t1558022496" t="mj_langford https://apigility.org/documentation/api-doc/swagger looks promising for your goals"><y>#</y><d>2019-05-16</d><h>16:01</h><w>mj_langford</w><a href="https://apigility.org/documentation/api-doc/swagger" target="_blank">https://apigility.org/documentation/api-doc/swagger</a> looks promising for your goals</z><z id="t1558022537" t="mj_langford They seem to use HAL, which appears it may be way that json spec you&apos;re pointing at could be"><y>#</y><d>2019-05-16</d><h>16:02</h><w>mj_langford</w>They seem to use HAL, which appears it may be  way that json spec you&apos;re pointing at could be</z><z id="t1558031968" t="zlrth this might be an easy amazonica question for y&apos;all: i&apos;d like to enable bucket-versioning. Here it is &quot;Off&quot;: c.s3&gt; (amazonica.aws.s3/get-bucket-versioning-configuration {:bucket-name &quot;my-bucket&quot;}) {:status &quot;Off&quot;} I try to enable it, but it wants an object, not a string: c.s3&gt; (amazonica.aws.s3/set-bucket-versioning-configuration {:bucket-name &quot;my-bucket&quot; :versioning-configuration &quot;Enabled&quot;} ) IllegalArgumentException No coercion is available to turn Enabled into an object of type class com.amazonaws.services.s3.model.BucketVersioningConfiguration amazonica.core/coerce-value (core.clj:399) "><y>#</y><d>2019-05-16</d><h>18:39</h><w>zlrth</w>this might be an easy amazonica question for y&apos;all:
i&apos;d like to enable bucket-versioning. Here it is &quot;Off&quot;:
<pre>c.s3&gt; (amazonica.aws.s3/get-bucket-versioning-configuration {:bucket-name &quot;my-bucket&quot;})
{:status &quot;Off&quot;}</pre>
I try to enable it, but it wants an object, not a string:
<pre>c.s3&gt;  (amazonica.aws.s3/set-bucket-versioning-configuration {:bucket-name &quot;my-bucket&quot; :versioning-configuration &quot;Enabled&quot;} )
IllegalArgumentException No coercion is available to turn Enabled into an object of type class com.amazonaws.services.s3.model.BucketVersioningConfiguration  amazonica.core/coerce-value (core.clj:399)
</pre></z><z id="t1558032221" t="zlrth BucketVersioningConfiguration isn&apos;t mentioned in Amazonica, so i&apos;m unsure how to set-bucket-versioning-configuration without cloning Amazonica, adding the importing of BucketVersioningConfiguration myself, and doing it inside a repl under Amazonica, instead of in my project. i suspect i&apos;m missing something"><y>#</y><d>2019-05-16</d><h>18:43</h><w>zlrth</w>BucketVersioningConfiguration isn&apos;t mentioned in Amazonica, so i&apos;m unsure how to <code>set-bucket-versioning-configuration</code> without cloning Amazonica, adding the importing of BucketVersioningConfiguration myself, and doing it inside a <code>repl</code> under Amazonica, instead of in my project.
i suspect i&apos;m missing something</z><z id="t1558088396" t="Jakub Holý (HolyJak) doesn&apos;t Amazonica use magic and reflection to turn Clj data into the expected AWS classes? What if you pass in a clojure map with keys corresponding to the bean&apos;s properties?"><y>#</y><d>2019-05-17</d><h>10:19</h><r>Jakub Holý (HolyJak)</r>doesn&apos;t Amazonica use magic and reflection to turn Clj data into the expected AWS classes? What if you pass in a clojure map with keys corresponding to the bean&apos;s properties?</z><z id="t1558035037" t="zlrth i did all those things, and they worked fwiw."><y>#</y><d>2019-05-16</d><h>19:30</h><w>zlrth</w>i did all those things, and they worked fwiw.</z><z id="t1558072399" t="viesti on OpenAPI and AWS, for example S3 was released 13 years ago, so API spec wise things were a bit different back then 🙂"><y>#</y><d>2019-05-17</d><h>05:53</h><w>viesti</w>on OpenAPI and AWS, for example S3 was released 13 years ago, so API spec wise things were a bit different back then <b>🙂</b></z><z id="t1558072493" t="viesti and AWS is quite backward compatible, they don&apos;t usually remove stuff from APIs"><y>#</y><d>2019-05-17</d><h>05:54</h><w>viesti</w>and AWS is quite backward compatible, they don&apos;t usually remove stuff from APIs</z><z id="t1558072530" t="viesti API Gateway is quite swagger/openapi friendly, but then again, it is an API service itself"><y>#</y><d>2019-05-17</d><h>05:55</h><w>viesti</w>API Gateway is quite swagger/openapi friendly, but then again, it is an API service itself</z><z id="t1558175368" t="kulminaator just a report from the field. i used the cognitect-labs/aws-api for some reasonably heavyweight stuff yesterday for the first time and the thing just worked. very nice &amp; thank you to the authors of that code 🙂 . long version of what i did: we have a big set of json files stored on s3 (every file holds multiple s3 objects) and i needed a quick indexing engine for it that can scale beyond of what i want to host on actual hard disks, so figured i will store the indices on s3 as well. i implemented a proof of concept in our one day hacking marathon that indexed 800 megabytes of json records (just a day of sample data from our datastore) downloaded them with aws api, parsed with data.json, hashed the things and fitted them into index nodes (resulted in 1.5 million tiny index files) and pushed the index nodes back into aws (for reasonable performance used 16 parallel threads to do the latter). the only issues i met along the way were my own typos (oh boy typos are annoying if you splash 60 megabytes of data into your terminal 😄 ). finished the proof of concept in one working day, good stuff."><y>#</y><d>2019-05-18</d><h>10:29</h><w>kulminaator</w>just a report from the field. i used the cognitect-labs/aws-api for some reasonably heavyweight stuff yesterday for the first time and the thing just worked. very nice &amp; thank you to the authors of that code <b>🙂</b>.  long version of what i did: we have a big set of json files stored on s3 (every file holds multiple s3 objects) and i needed a quick indexing engine for it that can scale beyond of what i want to host on actual hard disks, so figured i will store the indices on s3 as well. i implemented a proof of concept in our one day hacking marathon that indexed 800 megabytes of json records (just a day of sample data from our datastore)  downloaded them with aws api, parsed with data.json, hashed the things and fitted them into index nodes (resulted in 1.5 million tiny index files) and pushed the index nodes back into aws (for reasonable performance used 16 parallel threads to do the latter). the only issues i met along the way were my own typos (oh boy typos are annoying if you splash 60 megabytes of data into your terminal <b>😄</b>). finished the proof of concept in one working day, good stuff.</z><z id="t1558184898" t="Alex Miller (Clojure team) Nice!"><y>#</y><d>2019-05-18</d><h>13:08</h><w>Alex Miller (Clojure team)</w>Nice!</z><z id="t1558372539" t="kenny Interestingly, the docs from aws-api do not always match the HTML reference docs. For example (aws-api/doc c :PutObjectTagging) ... omitted for brevity ------------------------- Response {:VersionId string} claims the response will have a map with :VersionId . According to https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUTtagging.html#RESTObjectPUTtagging-responses , &gt; This operation does not return response elements."><y>#</y><d>2019-05-20</d><h>17:15</h><w>kenny</w>Interestingly, the docs from aws-api do not always match the HTML reference docs. For example
<pre>(aws-api/doc c :PutObjectTagging)
... omitted for brevity
-------------------------
Response

{:VersionId string}
</pre>
claims the response will have a map with <code>:VersionId</code>. According to <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUTtagging.html#RESTObjectPUTtagging-responses" target="_blank">https://docs.aws.amazon.com/AmazonS3/latest/API/RESTObjectPUTtagging.html#RESTObjectPUTtagging-responses</a>,
&gt; This operation does not return response elements.</z><z id="t1558450163" t="aaelony uncertain if this is true any more, but at one point if I recall correctly if you stored the data in the key with an empty value it was free of charge... 😁"><y>#</y><d>2019-05-21</d><h>14:49</h><w>aaelony</w>uncertain if this is true any more, but at one point if I recall correctly if you stored the data in the key with an empty value it was free of charge... <b>😁</b></z><z id="t1559006906" t="caleb.macdonaldblack What do people use to manage environment variables, parameters and secrets? I have a full stack app using terraform. So I&apos;m dealing with: - Building a shadow-cljs project, injecting env vars for auth, backend, google api keys, - Running a backend service that needs api keys, database credentials - Managing CI which need access to parameters and secrets for builds and deployment - Managing terraform which requires input variables for my terraform configuration and also outputs that are passed into other services (for example frontend and backend) - Developing locally where I need access to those variables, parameters and secrets in some capacity - Right now I&apos;ve hacked together a combination of: - Terraform passing vars, parameters and secrets into services such as the backend - Defining env vars into my CI using their environment variable store - Pulling env vars from terraform outputs when needed for building and deploying. Ideally I&apos;d like to manage all this centrally some how. What have people use in the past for consolidating all this?"><y>#</y><d>2019-05-28</d><h>01:28</h><w>caleb.macdonaldblack</w>What do people use to manage environment variables, parameters and secrets?
I have a full stack app using terraform. So I&apos;m dealing with:
- Building a shadow-cljs project, injecting env vars for auth, backend, google api keys,
- Running a backend service that needs api keys, database credentials
- Managing CI which need access to parameters and secrets for builds and deployment
- Managing terraform which requires input variables for my terraform configuration and also outputs that are passed into other services (for example frontend and backend)
- Developing locally where I need access to those variables, parameters and secrets in some capacity
-
Right now I&apos;ve hacked together a combination of:
- Terraform passing vars, parameters and secrets into services such as the backend
- Defining env vars into my CI using their environment variable store
- Pulling env vars from terraform outputs when needed for building and deploying.

Ideally I&apos;d like to manage all this centrally some how. What have people use in the past for consolidating all this?</z><z id="t1559013760" t="ghadi SSM Parameter store"><y>#</y><d>2019-05-28</d><h>03:22</h><w>ghadi</w>SSM Parameter store</z><z id="t1559023009" t="orestis How do you do local (offline?) development when your stack depends on AWS stuff? "><y>#</y><d>2019-05-28</d><h>05:56</h><w>orestis</w>How do you do local (offline?) development when your stack depends on AWS stuff? </z><z id="t1559023055" t="orestis I can see some things (e.g. SQS) can be reasonably abstracted out via an interface that has a local naive implementation. "><y>#</y><d>2019-05-28</d><h>05:57</h><w>orestis</w>I can see some things (e.g. SQS) can be reasonably abstracted out via an interface that has a local naive implementation. </z><z id="t1559023410" t="valtteri I usually have dev account(s) on AWS and I use real services when developing. In simple cases I have used DynamoDB local and local Postgres. Mocking all the services seems too much hassle to me."><y>#</y><d>2019-05-28</d><h>06:03</h><w>valtteri</w>I usually have dev account(s) on AWS and I use real services when developing. In simple cases I have used DynamoDB local and local Postgres. Mocking all the services seems too much hassle to me.</z><z id="t1559023511" t="orestis How is the experience of doing that? In terms of network issues, delays, latency etc. "><y>#</y><d>2019-05-28</d><h>06:05</h><w>orestis</w>How is the experience of doing that? In terms of network issues, delays, latency etc. </z><z id="t1559030942" t="valtteri Network hasn’t been an issue to me but at last job we had some trouble with having dangling left-over resources after developers who didn’t clean up after themselves. 🙂 Nowadays AWS offers nice ways to monitor this kind of issues. Creating dev “sub-accounts” that can be safely pruned is a good option."><y>#</y><d>2019-05-28</d><h>08:09</h><r>valtteri</r>Network hasn’t been an issue to me but at last job we had some trouble with having dangling left-over resources after developers who didn’t clean up after themselves. <b>🙂</b> Nowadays AWS offers nice ways to monitor this kind of issues. Creating dev “sub-accounts” that can be safely pruned is a good option.</z><z id="t1559030957" t="valtteri I’ve used dynamodb local mostly for unit tests and such."><y>#</y><d>2019-05-28</d><h>08:09</h><r>valtteri</r>I’ve used dynamodb local mostly for unit tests and such.</z><z id="t1559030967" t="valtteri But my emphasis is usually more on integration tests and there you want to have the real thing. Or as real as it gets."><y>#</y><d>2019-05-28</d><h>08:09</h><r>valtteri</r>But my emphasis is usually more on integration tests and there you want to have the real thing. Or as real as it gets.</z><z id="t1559031776" t="viesti CI running on cloud has fast latency too"><y>#</y><d>2019-05-28</d><h>08:22</h><r>viesti</r>CI running on cloud has fast latency too</z><z id="t1559031861" t="viesti one probably doesn&apos;t want to move a lot of data back and forth between own laptop and the cloud, in cases like that, running a job in the CI (or on some node in the cloud) makes sense"><y>#</y><d>2019-05-28</d><h>08:24</h><r>viesti</r>one probably doesn&apos;t want to move a lot of data back and forth between own laptop and the cloud, in cases like that, running a job in the CI (or on some node in the cloud) makes sense</z><z id="t1559023685" t="caleb.macdonaldblack I use a develop account for stuff I cannot easily replicate locally. My webapp, backend and db is local."><y>#</y><d>2019-05-28</d><h>06:08</h><w>caleb.macdonaldblack</w>I use a develop account for stuff I cannot easily replicate locally. My webapp, backend and db is local.</z><z id="t1559023737" t="caleb.macdonaldblack When we have another dev helping we step on each other&apos;s toes though. Ideally we would each have their own account and environment"><y>#</y><d>2019-05-28</d><h>06:08</h><w>caleb.macdonaldblack</w>When we have another dev helping we step on each other&apos;s toes though. Ideally we would each have their own account and environment</z><z id="t1559028849" t="viesti haven&apos;t gotten to it, but namespacing resources via Terraform would be neat in shared dev account."><y>#</y><d>2019-05-28</d><h>07:34</h><w>viesti</w>haven&apos;t gotten to it, but namespacing resources via Terraform would be neat in shared dev account.</z><z id="t1559029004" t="viesti I guess it depends on the case/project, if there isn&apos;t any costly infrastructure, then separated accounts for each dev would be maximum isolation, but in a bigger system, one might want to share data sources, which means cross account policies"><y>#</y><d>2019-05-28</d><h>07:36</h><w>viesti</w>I guess it depends on the case/project, if there isn&apos;t any costly infrastructure, then separated accounts for each dev would be maximum isolation, but in a bigger system, one might want to share data sources, which means cross account policies</z><z id="t1559029029" t="viesti separate account per stage is good for hygiene anyway"><y>#</y><d>2019-05-28</d><h>07:37</h><w>viesti</w>separate account per stage is good for hygiene anyway</z><z id="t1559030490" t="viesti in a previous project, we used Kinesis from https://github.com/localstack/localstack in tests, but it was a bit of a hassle to avoid timing related brittleness"><y>#</y><d>2019-05-28</d><h>08:01</h><w>viesti</w>in a previous project, we used Kinesis from <a href="https://github.com/localstack/localstack" target="_blank">https://github.com/localstack/localstack</a> in tests, but it was a bit of a hassle to avoid timing related brittleness</z><z id="t1559030622" t="viesti but also used resources in dev account for running tests, since running tests against real infrastructure made sense in a data pipeline (Redshift+S3)"><y>#</y><d>2019-05-28</d><h>08:03</h><w>viesti</w>but also used resources in dev account for running tests, since running tests against real infrastructure made sense in a data pipeline (Redshift+S3)</z><z id="t1559031072" t="viesti in that project, we used Ansible Vault for keeping secrets in version control (a tad bit legacy, since we initially started with Ansible), passed secrets to Terraform in a runner script via -var-file + process substitution ( http://tldp.org/LDP/abs/html/process-sub.html ) and stored state files in S3 with KMS encryption. We had utility libraries to read parameters from SSM, Terraform state and local per-env config files. Config files were merged so that overrides could be defined (in TF, passing first the prod config var file, then env specific var file. Same done in libraries)."><y>#</y><d>2019-05-28</d><h>08:11</h><w>viesti</w>in that project, we used Ansible Vault for keeping secrets in version control (a tad bit legacy, since we initially started with Ansible), passed secrets to Terraform in a runner script via <code>-var-file</code> + process substitution (<a href="http://tldp.org/LDP/abs/html/process-sub.html" target="_blank">http://tldp.org/LDP/abs/html/process-sub.html</a>) and stored state files in S3 with KMS encryption. We had utility libraries to read parameters from SSM, Terraform state and local per-env config files. Config files were merged so that overrides could be defined (in TF, passing first the prod config var file, then env specific var file. Same done in libraries).</z><z id="t1559047348" t="dangercoder Does anyone know if you can use AWS cognito with your own front-end forms (login/sign-up)?"><y>#</y><d>2019-05-28</d><h>12:42</h><w>dangercoder</w>Does anyone know if you can use AWS cognito with your own front-end forms (login/sign-up)?</z><z id="t1559049995" t="valtteri Yes"><y>#</y><d>2019-05-28</d><h>13:26</h><w>valtteri</w>Yes</z><z id="t1559050285" t="valtteri You can use the JavaScript SDK to chat with Cognito directly from the browser. There are quite many moving parts so it’s probably a good idea to try find a reference implementation somewhere."><y>#</y><d>2019-05-28</d><h>13:31</h><w>valtteri</w>You can use the JavaScript SDK to chat with Cognito directly from the browser. There are quite many moving parts so it’s probably a good idea to try find a reference implementation somewhere.</z><z id="t1559050458" t="valtteri Oh wow, AWS has good examples nowadays https://docs.aws.amazon.com/cognito/latest/developerguide/using-amazon-cognito-user-identity-pools-javascript-examples.html"><y>#</y><d>2019-05-28</d><h>13:34</h><w>valtteri</w>Oh wow, AWS has good examples nowadays <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/using-amazon-cognito-user-identity-pools-javascript-examples.html" target="_blank">https://docs.aws.amazon.com/cognito/latest/developerguide/using-amazon-cognito-user-identity-pools-javascript-examples.html</a></z><z id="t1559157065" t="dangercoder [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] is this Javascript which is used in the front end or is it node.js? 😄 I want my users to go to my controller and then my application calls aws for sign up"><y>#</y><d>2019-05-29</d><h>19:11</h><r>dangercoder</r><a>@valtteri</a> is this Javascript which is used in the front end or is it node.js? <b>😄</b> I want my users to go to my controller and then my application calls aws for sign up</z><z id="t1559159194" t="dangercoder ah yes I can use https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_SignUp.html"><y>#</y><d>2019-05-29</d><h>19:46</h><r>dangercoder</r>ah yes I can use
<a href="https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_SignUp.html" target="_blank">https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_SignUp.html</a></z><z id="t1559159197" t="dangercoder for sign up etc."><y>#</y><d>2019-05-29</d><h>19:46</h><r>dangercoder</r>for sign up etc.</z><z id="t1559197918" t="valtteri Most operations are possible both client and server-side. You just need to configure your user-pool accordingly. There used to be a separate SDK for browser JavaScript but I think they’ve combined Node/Browser stuff under one JavaScript SDK nowadays."><y>#</y><d>2019-05-30</d><h>06:31</h><r>valtteri</r>Most operations are possible both client and server-side. You just need to configure your user-pool accordingly. There used to be a separate SDK for browser JavaScript but I think they’ve combined Node/Browser stuff under one JavaScript SDK nowadays.</z><z id="t1559198192" t="valtteri It’s possible to implement many kinds of scenarios using Cognito. You can handle signup/login/forgot-password/managing user-data directly in the browser if you wish or you can choose to do all that on the backend side (or mix &amp; match)."><y>#</y><d>2019-05-30</d><h>06:36</h><r>valtteri</r>It’s possible to implement many kinds of scenarios using Cognito. You can handle signup/login/forgot-password/managing user-data directly in the browser if you wish or you can choose to do all that on the backend side (or mix &amp; match).</z><z id="t1559213528" t="dangercoder Yeah im communicating with Cognito using the cognitect aws-api now. Got the sign up working really nice 🙂"><y>#</y><d>2019-05-30</d><h>10:52</h><r>dangercoder</r>Yeah im communicating with Cognito using the cognitect aws-api now. Got the sign up working really nice <b>🙂</b></z><z id="t1559084815" t="dangercoder thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] !"><y>#</y><d>2019-05-28</d><h>23:06</h><w>dangercoder</w>thanks <a>@valtteri</a>!</z><z id="t1559161679" t="dangercoder Do people use amazonica or aws-api by Cognitect?"><y>#</y><d>2019-05-29</d><h>20:27</h><w>dangercoder</w>Do people use <code>amazonica</code> or  <code>aws-api</code> by Cognitect?</z><z id="t1559208020" t="orestis As a first time AWS user, I went with aws-api and loved the discoverability through the REPL. "><y>#</y><d>2019-05-30</d><h>09:20</h><w>orestis</w>As a first time AWS user, I went with aws-api and loved the discoverability through the REPL. </z><z id="t1559222942" t="mynomoto [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] aws-api is newer and probably simpler. amazonica has been used for a long time by the community and it works."><y>#</y><d>2019-05-30</d><h>13:29</h><w>mynomoto</w><a>@jarvinenemil</a> <code>aws-api</code> is newer and probably simpler. <code>amazonica</code> has been used for a long time by the community and it works.</z><z id="t1559223203" t="dangercoder yeah the api was really good. &quot;It&apos;s all data&quot; 😉"><y>#</y><d>2019-05-30</d><h>13:33</h><w>dangercoder</w>yeah the api was really good. &quot;It&apos;s all data&quot; <b>😉</b></z><z id="t1559226824" t="viesti also discovering the request forms is quite nice, with amazonica one has keep the javadocs open to &quot;guess&quot; the argument forms"><y>#</y><d>2019-05-30</d><h>14:33</h><w>viesti</w>also discovering the request forms is quite nice, with amazonica one has keep the javadocs open to &quot;guess&quot; the argument forms</z><z id="t1559227009" t="viesti user&gt; (-&gt; cfn-client aws/ops keys) ;; looks up op key... user&gt; (-&gt; cfn-client (aws/doc :CreateStack)) ;; shows request form, and what is minimum required "><y>#</y><d>2019-05-30</d><h>14:36</h><w>viesti</w><pre>user&gt; (-&gt; cfn-client aws/ops keys) ;; looks up op key...
user&gt; (-&gt; cfn-client (aws/doc :CreateStack)) ;; shows request form, and what is minimum required
</pre></z><z id="t1559946094" t="dangercoder when uploading a .jar file to elastic bean stalk (manually) will it run java -jar ?"><y>#</y><d>2019-06-07</d><h>22:21</h><w>dangercoder</w>when uploading a .jar file to elastic bean stalk (manually) will it run java -jar ?</z><z id="t1559946464" t="dangercoder ah, I checked the logs and I had this exception: No region found by any region provider. {:providers (cognitect.aws.region$environment_region_provider$reify__17294 cognitect.aws.region$system_property_region_provider$reify__17297 cognitect.aws.region$profile_region_provider$reify__17300 cognitect.aws.region$instance_region_provider$reify__17308)} at cognitect.aws.region$chain_region_provider$reify__17290.fetch(region.clj:37) at cognitect.aws.client.api$client.invokeStatic(api.clj:70) at cognitect.aws.client.api$client.invoke(api.clj:22) ... 98 more "><y>#</y><d>2019-06-07</d><h>22:27</h><w>dangercoder</w>ah, I checked the logs and I had this exception:

<pre>No region found by any region provider. {:providers (cognitect.aws.region$environment_region_provider$reify__17294 cognitect.aws.region$system_property_region_provider$reify__17297 cognitect.aws.region$profile_region_provider$reify__17300 cognitect.aws.region$instance_region_provider$reify__17308)}
        at cognitect.aws.region$chain_region_provider$reify__17290.fetch(region.clj:37)
        at cognitect.aws.client.api$client.invokeStatic(api.clj:70)
        at cognitect.aws.client.api$client.invoke(api.clj:22)
       
        ... 98 more
</pre></z><z id="t1560088891" t="futuro Is your ~/.aws/config file set up?"><y>#</y><d>2019-06-09</d><h>14:01</h><w>futuro</w>Is your <code>~/.aws/config</code> file set up?</z><z id="t1560111322" t="dangercoder I had to set an environment variable [:attrs {:href &quot;/_/_/users/U0JJ68RBR&quot;}]"><y>#</y><d>2019-06-09</d><h>20:15</h><w>dangercoder</w>I had to set an environment variable <a>@futuro</a></z><z id="t1560156212" t="orestis I’d like to handle user uploads and downloads by proxying to s3, but wrapped in an authentication/authorization layer. Would prefer to be an async/streaming solution so that I don’t have to deal with memory issues and managing threads. From a little bit of research, there’s a lot of moving parts that have to align to make this happen... Any pointers on this?"><y>#</y><d>2019-06-10</d><h>08:43</h><w>orestis</w>I’d like to handle user uploads and downloads by proxying to s3, but wrapped in an authentication/authorization layer. Would prefer to be an async/streaming solution so that I don’t have to deal with memory issues and managing threads. From a little bit of research, there’s a lot of moving parts that have to align to make this happen... Any pointers on this?</z><z id="t1560156293" t="orestis I mean, cognitect’s AWS api doesn’t handle streaming yet. The popular http libraries are blocking. Most http servers support async responses but making sure a slow client doesn’t starve everything else is also tricky to get right. "><y>#</y><d>2019-06-10</d><h>08:44</h><w>orestis</w>I mean, cognitect’s AWS api doesn’t handle streaming yet. The popular http libraries are blocking. Most http servers support async responses but making sure a slow client doesn’t starve everything else is also tricky to get right. </z><z id="t1560156319" t="orestis I’m using pedestal/jetty as web server at the moment. Not wedded to Jetty but keeping pedestal around would be nice. "><y>#</y><d>2019-06-10</d><h>08:45</h><w>orestis</w>I’m using pedestal/jetty as web server at the moment. Not wedded to Jetty but keeping pedestal around would be nice. </z><z id="t1560160669" t="valtteri [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] AFAIK the best way to do this is to use pre-signed upload/download urls. You can have an endpoint on your server that checks for authentication and authorization, generates the URL and returns it to the client. The client can then push the file directly to S3 without you needing to proxy it through your servers. Official AWS-sdk’s have utils for creating the url’s but I don’t know about Cognitect’s AWS lib."><y>#</y><d>2019-06-10</d><h>09:57</h><w>valtteri</w><a>@orestis</a> AFAIK the best way to do this is to use pre-signed upload/download urls. You can have an endpoint on your server that checks for authentication and authorization, generates the URL and returns it to the client. The client can then push the file directly to S3 without you needing to proxy it through your servers. Official AWS-sdk’s have utils for creating the url’s but I don’t know about Cognitect’s AWS lib.</z><z id="t1560162382" t="orestis [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] right, and I presume that these URLs expire after some time, right? I wonder how that works in practice. This content is embedded on a web application and i don’t want to risk having broken links... But for the upload it makes sense, you are essentially making a write-only url that the browser can just POST to, that then expires after some time. I’ll dig more into that. "><y>#</y><d>2019-06-10</d><h>10:26</h><w>orestis</w><a>@valtteri</a> right, and I presume that these URLs expire after some time, right? I wonder how that works in practice. This content is embedded on a web application and i don’t want to risk having broken links... But for the upload it makes sense, you are essentially making a write-only url that the browser can just POST to, that then expires after some time. I’ll dig more into that. </z><z id="t1560162560" t="valtteri Yes, you can set expiration to be whatever is good for your use-case."><y>#</y><d>2019-06-10</d><h>10:29</h><w>valtteri</w>Yes, you can set expiration to be whatever is good for your use-case.</z><z id="t1560164111" t="orestis This is an interesting approach for the downloads: https://www.mediasuite.co.nz/blog/proxying-s3-downloads-nginx/"><y>#</y><d>2019-06-10</d><h>10:55</h><w>orestis</w>This is an interesting approach for the downloads: <a href="https://www.mediasuite.co.nz/blog/proxying-s3-downloads-nginx/" target="_blank">https://www.mediasuite.co.nz/blog/proxying-s3-downloads-nginx/</a></z><z id="t1560164179" t="orestis Essentially, generate the presigned url, pass it to nginx, let nginx do the proxying for you. The presigned url is never visible to the end-user, and you can also control headers. "><y>#</y><d>2019-06-10</d><h>10:56</h><w>orestis</w>Essentially, generate the presigned url, pass it to nginx, let nginx do the proxying for you. The presigned url is never visible to the end-user, and you can also control headers. </z><z id="t1560164807" t="valtteri Interesting indeed! However I’d still use the simple “handing the pre-signed s3 download url to the client” approach unless the files contain something super sensitive."><y>#</y><d>2019-06-10</d><h>11:06</h><w>valtteri</w>Interesting indeed! However I’d still use the simple “handing the pre-signed s3 download url to the client” approach unless the files contain something super sensitive.</z><z id="t1560164965" t="valtteri There’s quite a lot hassle with all the headers, retries etc. if you go down that route. I once wrote a thing that streams several files from S3 and aggregates them into a single zip-file in flight while the client is downloading. It eventually worked amazingly well but it required several days of fiddling with semi low-level transportation stuff."><y>#</y><d>2019-06-10</d><h>11:09</h><w>valtteri</w>There’s quite a lot hassle with all the headers, retries etc. if you go down that route. I once wrote a thing that streams several files from S3 and aggregates them into a single zip-file in flight while the client is downloading. It eventually worked amazingly well but it required several days of fiddling with semi low-level transportation stuff.</z><z id="t1560165439" t="orestis The files do contain sensitive stuff - our clients are not technical but they make us jump through a thousand hoops before they trust us with their data. So even if I think a 60 second pre-signed url would be acceptable, if it comes up on a review there will be questions. "><y>#</y><d>2019-06-10</d><h>11:17</h><w>orestis</w>The files do contain sensitive stuff - our clients are not technical but they make us jump through a thousand hoops before they trust us with their data. So even if I think a 60 second pre-signed url would be acceptable, if it comes up on a review there will be questions. </z><z id="t1560165552" t="orestis The one thing I don’t want to do is to write the proxying code - I’ve done similar things in the past and it was always a pain in the butt to fine tune and harden everything for production. For development, it’s not too bad though. "><y>#</y><d>2019-06-10</d><h>11:19</h><w>orestis</w>The one thing I don’t want to do is to write the proxying code - I’ve done similar things in the past and it was always a pain in the butt to fine tune and harden everything for production. For development, it’s not too bad though. </z><z id="t1560534385" t="kenny Is there a reason aws-api is on an old version of com.cognitect/http-client ?"><y>#</y><d>2019-06-14</d><h>17:46</h><w>kenny</w>Is there a reason aws-api is on an old version of <code>com.cognitect/http-client</code>?</z><z id="t1560539958" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] we talked this morning about http-client in general"><y>#</y><d>2019-06-14</d><h>19:19</h><w>ghadi</w><a>@kenny</a> we talked this morning about http-client in general</z><z id="t1560539966" t="ghadi is the old version causing you pain?"><y>#</y><d>2019-06-14</d><h>19:19</h><w>ghadi</w>is the old version causing you pain?</z><z id="t1560540032" t="kenny Yes - the old version of jetty aws-api uses is not compatible with the latest version of jetty. "><y>#</y><d>2019-06-14</d><h>19:20</h><w>kenny</w>Yes - the old version of jetty aws-api uses is not compatible with the latest version of jetty. </z><z id="t1560540065" t="kenny I explicitly updated http-client to the latest and it fixes the conflict. Seems like aws-api should update to the latest as well. "><y>#</y><d>2019-06-14</d><h>19:21</h><w>kenny</w>I explicitly updated http-client to the latest and it fixes the conflict. Seems like aws-api should update to the latest as well. </z><z id="t1560540092" t="ghadi we can&apos;t do a newer http-client than what datomic uses yet"><y>#</y><d>2019-06-14</d><h>19:21</h><w>ghadi</w>we can&apos;t do a newer http-client than what datomic uses yet</z><z id="t1560540128" t="ghadi another way to handle is to explicitly depend on latest Jetty, I think that http-client is compatible with it"><y>#</y><d>2019-06-14</d><h>19:22</h><w>ghadi</w>another way to handle is to explicitly depend on latest Jetty, I think that http-client is compatible with it</z><z id="t1560540156" t="ghadi we&apos;re considering a model for BYOHttpClient too"><y>#</y><d>2019-06-14</d><h>19:22</h><w>ghadi</w>we&apos;re considering a model for BYOHttpClient too</z><z id="t1560962214" t="viesti cljc and ClojureScript would be most interesting thing to offer, thinking about React Native"><y>#</y><d>2019-06-19</d><h>16:36</h><r>viesti</r>cljc and ClojureScript would be most interesting thing to offer, thinking about React Native</z><z id="t1560540164" t="ghadi still early"><y>#</y><d>2019-06-14</d><h>19:22</h><w>ghadi</w>still early</z><z id="t1560540223" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] what are you using that pulls in Jetty 9.4?"><y>#</y><d>2019-06-14</d><h>19:23</h><w>ghadi</w><a>@kenny</a> what are you using that pulls in Jetty 9.4?</z><z id="t1560540270" t="kenny Using a http client that doesn’t use jetty (i.e. http-kit) would be great. Ring pulls in 9.4."><y>#</y><d>2019-06-14</d><h>19:24</h><w>kenny</w>Using a http client that doesn’t use jetty (i.e. http-kit) would be great. 

Ring pulls in 9.4.</z><z id="t1560962214" t="viesti cljc and ClojureScript would be most interesting thing to offer, thinking about React Native"><y>#</y><d>2019-06-19</d><h>16:36</h><w>viesti</w>cljc and ClojureScript would be most interesting thing to offer, thinking about React Native</z><z id="t1560585344" t="orestis Is the cognitect http client open source? Meant to be used by standalone projects?"><y>#</y><d>2019-06-15</d><h>07:55</h><w>orestis</w>Is the cognitect http client open source? Meant to be used by standalone projects?</z><z id="t1560826388" t="bmaddy I&apos;m trying to give aws-api a try and can&apos;t seem to get anywhere. Does anyone have any idea how to start debugging this error? I do have a [default] section in my ~/.aws/credentials file and it doesn&apos;t appear to be a credentials issue."><y>#</y><d>2019-06-18</d><h>02:53</h><w>bmaddy</w>I&apos;m trying to give aws-api a try and can&apos;t seem to get anywhere. Does anyone have any idea how to start debugging this error? I do have a <code>[default]</code> section in my <code>~/.aws/credentials</code> file and it doesn&apos;t appear to be a credentials issue.</z><z id="t1560826674" t="Alexander Stavonin do you have all required dependencies like com.cognitect.aws/endpoints and com.cognitect.aws/s3 ?"><y>#</y><d>2019-06-18</d><h>02:57</h><r>Alexander Stavonin</r>do you have all required dependencies like <code>com.cognitect.aws/endpoints</code> and <code>com.cognitect.aws/s3</code>?</z><z id="t1560826681" t="bmaddy Oh, and my deps are: :deps {org.clojure/clojure {:mvn/version &quot;RELEASE&quot;} metasoarous/oz {:mvn/version &quot;1.6.0-alpha3&quot;} com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.568&quot;} com.cognitect.aws/s3 {:mvn/version &quot;722.2.468.0&quot;}} "><y>#</y><d>2019-06-18</d><h>02:58</h><w>bmaddy</w>Oh, and my deps are:
<pre>:deps {org.clojure/clojure {:mvn/version &quot;RELEASE&quot;}
        metasoarous/oz {:mvn/version &quot;1.6.0-alpha3&quot;}
        com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot;}
        com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.568&quot;}
        com.cognitect.aws/s3 {:mvn/version &quot;722.2.468.0&quot;}}
</pre></z><z id="t1560826887" t="ghadi [:attrs {:href &quot;/_/_/users/U067Q76EP&quot;}] oz is pulling down 90000000 dependencies, almost certainly jetty is in conflict"><y>#</y><d>2019-06-18</d><h>03:01</h><w>ghadi</w><a>@bmaddy</a> oz is pulling down 90000000 dependencies, almost certainly jetty is in conflict</z><z id="t1560826959" t="bmaddy Ah, ok. I&apos;ll look into how to that tomorrow. Thanks [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] --I appreciate it!"><y>#</y><d>2019-06-18</d><h>03:02</h><w>bmaddy</w>Ah, ok. I&apos;ll look into how to that tomorrow. Thanks <a>@ghadi</a>--I appreciate it!</z><z id="t1560826985" t="ghadi add com.cognitect/http-client &quot;0.1.99&quot; top-level"><y>#</y><d>2019-06-18</d><h>03:03</h><w>ghadi</w>add com.cognitect/http-client &quot;0.1.99&quot; top-level</z><z id="t1560826986" t="Alexander Stavonin [:attrs {:href &quot;/_/_/users/U067Q76EP&quot;}] what is your JVM version? I had issues with cognitect.aws for JVM &gt; 8"><y>#</y><d>2019-06-18</d><h>03:03</h><w>Alexander Stavonin</w><a>@bmaddy</a> what is your JVM version? I had issues with <code>cognitect.aws</code> for JVM &gt; 8</z><z id="t1560827038" t="bmaddy ;; Clojure 1.10.1, Java 1.8.0_192"><y>#</y><d>2019-06-18</d><h>03:03</h><r>bmaddy</r><code>;; Clojure 1.10.1, Java 1.8.0_192</code></z><z id="t1560827002" t="ghadi that&apos;s not it [:attrs {:href &quot;/_/_/users/UHVP2JABV&quot;}] ."><y>#</y><d>2019-06-18</d><h>03:03</h><w>ghadi</w>that&apos;s not it <a>@s-a-n-9</a>.</z><z id="t1560827063" t="ghadi {:deps {org.clojure/clojure {:mvn/version &quot;1.10.1&quot;} metasoarous/oz {:mvn/version &quot;1.6.0-alpha3&quot;} com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.568&quot;} com.cognitect/http-client {:mvn/version &quot;0.1.99&quot;} com.cognitect.aws/s3 {:mvn/version &quot;722.2.468.0&quot;}}} "><y>#</y><d>2019-06-18</d><h>03:04</h><w>ghadi</w><pre>{:deps {org.clojure/clojure {:mvn/version &quot;1.10.1&quot;}
        metasoarous/oz {:mvn/version &quot;1.6.0-alpha3&quot;}
        com.cognitect.aws/api {:mvn/version &quot;0.8.305&quot;}
        com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.568&quot;}
        com.cognitect/http-client {:mvn/version &quot;0.1.99&quot;}
        com.cognitect.aws/s3 {:mvn/version &quot;722.2.468.0&quot;}}}
</pre></z><z id="t1560827065" t="ghadi should get you going."><y>#</y><d>2019-06-18</d><h>03:04</h><w>ghadi</w>should get you going.</z><z id="t1560827199" t="bmaddy Indeed it does--thank you!"><y>#</y><d>2019-06-18</d><h>03:06</h><r>bmaddy</r>Indeed it does--thank you!</z><z id="t1561705499" t="dangercoder How do you guys use aws cognito? I built my own UI and used the adminApi to signup, verify signup and login through my own servers"><y>#</y><d>2019-06-28</d><h>07:04</h><w>dangercoder</w>How do you guys use aws cognito? I built my own UI and used the adminApi to signup, verify signup and login through my own servers</z><z id="t1561725456" t="dogenpunk [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] I’m working on an app that uses Cognito in much the same way. I hope we’ll eventually store all “personally identifying information” there as well. "><y>#</y><d>2019-06-28</d><h>12:37</h><w>dogenpunk</w><a>@jarvinenemil</a> I’m working on an app that uses Cognito in much the same way. I hope we’ll eventually store all “personally identifying information” there as well. </z><z id="t1561745565" t="dangercoder [:attrs {:href &quot;/_/_/users/U0E0553EF&quot;}] do you also had the issue that the token is not valid if you use it directly after authenticating an user? from my logs: Time is: 2019-06-28T20:11:42 The Token can&apos;t be used before Fri Jun 28 20:11:48 CEST 2019."><y>#</y><d>2019-06-28</d><h>18:12</h><w>dangercoder</w><a>@dogenpunk</a> do you also had the issue that the <code>token</code> is not valid if you use it directly after authenticating an user?
from my logs:
<code>Time is: 2019-06-28T20:11:42</code>
<code>The Token can&apos;t be used before Fri Jun 28 20:11:48 CEST 2019.</code></z><z id="t1561745668" t="dangercoder I don&apos;t want to log in my user, and then wait for a few seconds until I can begin to hit my controllers with their tokens 😣"><y>#</y><d>2019-06-28</d><h>18:14</h><w>dangercoder</w>I don&apos;t want to log in my user, and then wait for a few seconds until I can begin to hit my controllers with their tokens <b>😣</b></z><z id="t1561748775" t="valtteri Check your server clock."><y>#</y><d>2019-06-28</d><h>19:06</h><r>valtteri</r>Check your server clock.</z><z id="t1561748842" t="valtteri ... assuming you’re validating the token on your server."><y>#</y><d>2019-06-28</d><h>19:07</h><r>valtteri</r>... assuming you’re validating the token on your server.</z><z id="t1561749508" t="dangercoder ah yes... I am doing the validation of the token locally atm so that might be the reason why 🙂 thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] !"><y>#</y><d>2019-06-28</d><h>19:18</h><r>dangercoder</r>ah yes... I am doing the validation of the token locally atm so that might be the reason why <b>🙂</b> thanks <a>@U6N4HSMFW</a>!</z><z id="t1561749536" t="dangercoder It&apos;s off by a few seconds. But i&apos;ll be on elastic beanstalk in prod so i think it will work properly"><y>#</y><d>2019-06-28</d><h>19:18</h><r>dangercoder</r>It&apos;s off by a few seconds. But i&apos;ll be on elastic beanstalk in prod so i think it will work properly</z><z id="t1562355939" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.335 https://groups.google.com/forum/#!topic/clojure/I9d3xSORVMQ"><y>#</y><d>2019-07-05</d><h>19:45</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.335 <a href="https://groups.google.com/forum/#!topic/clojure/I9d3xSORVMQ" target="_blank">https://groups.google.com/forum/#!topic/clojure/I9d3xSORVMQ</a></z><z id="t1562411719" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.342 https://groups.google.com/forum/#!topic/clojure/_Fc0__RZbss"><y>#</y><d>2019-07-06</d><h>11:15</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.342  <a href="https://groups.google.com/forum/#!topic/clojure/_Fc0__RZbss" target="_blank">https://groups.google.com/forum/#!topic/clojure/_Fc0__RZbss</a></z><z id="t1562440562" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.345 https://groups.google.com/forum/#!topic/clojure/BxdZUPh7_d8"><y>#</y><d>2019-07-06</d><h>19:16</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.345 <a href="https://groups.google.com/forum/#!topic/clojure/BxdZUPh7_d8" target="_blank">https://groups.google.com/forum/#!topic/clojure/BxdZUPh7_d8</a></z><z id="t1562440601" t="dchelimsky Sorry for the noise, but 0.8.335 introduced a couple of bugs and the were discovered one at a time and I wanted to get the fixes out quickly. Use 0.8.345. Thanks!"><y>#</y><d>2019-07-06</d><h>19:16</h><w>dchelimsky</w>Sorry for the noise, but 0.8.335  introduced a couple of bugs and the were discovered one at a time and I wanted to get the fixes out quickly. Use 0.8.345. Thanks!</z><z id="t1562654480" t="dangercoder Is anyone running Redis on AWS? Which provider are you using?"><y>#</y><d>2019-07-09</d><h>06:41</h><w>dangercoder</w>Is anyone running Redis on AWS? Which provider are you using?</z><z id="t1562669082" t="viesti first thought: AWS ElastiCache: https://aws.amazon.com/elasticache/redis/"><y>#</y><d>2019-07-09</d><h>10:44</h><r>viesti</r>first thought: AWS ElastiCache: <a href="https://aws.amazon.com/elasticache/redis/" target="_blank">https://aws.amazon.com/elasticache/redis/</a></z><z id="t1562669148" t="dangercoder ahhhh yes, I am using carmine , this will work. Thanks [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] !"><y>#</y><d>2019-07-09</d><h>10:45</h><r>dangercoder</r>ahhhh yes, I am using <code>carmine</code>, this will work. Thanks <a>@U06QSF3BK</a>!</z><z id="t1562669187" t="viesti np 🙂"><y>#</y><d>2019-07-09</d><h>10:46</h><r>viesti</r>np <b>🙂</b></z><z id="t1562857482" t="jvtrigueros I used cognitect/aws yesterday for the first time, and it was very straightforward to use. So come here to say thank you! aws/doc is superb 🙇"><y>#</y><d>2019-07-11</d><h>15:04</h><w>jvtrigueros</w>I used <code>cognitect/aws</code> yesterday for the first time, and it was very straightforward to use. So come here to say thank you!
<code>aws/doc</code> is superb <b>🙇</b></z><z id="t1562857563" t="ghadi Sweet [:attrs {:href &quot;/_/_/users/U0JAE119P&quot;}] . What did you do with it?"><y>#</y><d>2019-07-11</d><h>15:06</h><w>ghadi</w>Sweet <a>@jvtrigueros</a>.  What did you do with it?</z><z id="t1562857756" t="jvtrigueros Using it for DynamoDB, simply trying out the API 🙂 I&apos;ve used Amazonica and Faraday before. Faraday is fine, but it comes with it&apos;s own API. Amazonica does some reflection stuff that matches the Amazon API but it&apos;s not super clear. That&apos;s where aws/doc shines, not to mention, the :op and :request is just a map, easy does it."><y>#</y><d>2019-07-11</d><h>15:09</h><w>jvtrigueros</w>Using it for DynamoDB, simply trying out the API <b>🙂</b>

I&apos;ve used Amazonica and Faraday before. Faraday is fine, but it comes with it&apos;s own API. Amazonica does some reflection stuff that matches the Amazon API but it&apos;s not super clear. That&apos;s where <code>aws/doc</code> shines, not to mention, the <code>:op</code> and <code>:request</code> is just a map, easy does it.</z><z id="t1563389539" t="dnolen does the Cognitect aws-api library support CloudWatch?"><y>#</y><d>2019-07-17</d><h>18:52</h><w>dnolen</w>does the Cognitect <code>aws-api</code> library support CloudWatch?</z><z id="t1563389549" t="dnolen I don&apos;t see it in the list of relases"><y>#</y><d>2019-07-17</d><h>18:52</h><w>dnolen</w>I don&apos;t see it in the list of relases</z><z id="t1563389613" t="ghadi it&apos;s there but has a weird name... one sec [:attrs {:href &quot;/_/_/users/U050B88UR&quot;}]"><y>#</y><d>2019-07-17</d><h>18:53</h><w>ghadi</w>it&apos;s there but has a weird name... one sec <a>@dnolen</a></z><z id="t1563389632" t="ghadi the logs part of cloudwatch has the name logs"><y>#</y><d>2019-07-17</d><h>18:53</h><w>ghadi</w>the logs part of cloudwatch has the name <code>logs</code></z><z id="t1563389637" t="ghadi the metrics part of cloudwatch...."><y>#</y><d>2019-07-17</d><h>18:53</h><w>ghadi</w>the metrics part of cloudwatch....</z><z id="t1563389680" t="ghadi is called monitoring"><y>#</y><d>2019-07-17</d><h>18:54</h><w>ghadi</w>is called <code>monitoring</code></z><z id="t1563852713" t="dchelimsky you can see this now here: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333"><y>#</y><d>2019-07-23</d><h>03:31</h><r>dchelimsky</r>you can see this now here: <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333</a></z><z id="t1563389729" t="Alex Miller (Clojure team) must have been created before they hired a product manager"><y>#</y><d>2019-07-17</d><h>18:55</h><w>Alex Miller (Clojure team)</w>must have been created before they hired a product manager</z><z id="t1563389753" t="ghadi it&apos;s an artifact of the aws-sdk-js artifacts from which this stuff is produced"><y>#</y><d>2019-07-17</d><h>18:55</h><w>ghadi</w>it&apos;s an artifact of the aws-sdk-js artifacts from which this stuff is produced</z><z id="t1563389757" t="Alex Miller (Clojure team) gotta come up with all those fun names"><y>#</y><d>2019-07-17</d><h>18:55</h><w>Alex Miller (Clojure team)</w>gotta come up with all those fun names</z><z id="t1563389844" t="dnolen ah"><y>#</y><d>2019-07-17</d><h>18:57</h><w>dnolen</w>ah</z><z id="t1563389848" t="dnolen [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] thanks!"><y>#</y><d>2019-07-17</d><h>18:57</h><w>dnolen</w><a>@ghadi</a> thanks!</z><z id="t1563852713" t="dchelimsky you can see this now here: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333"><y>#</y><d>2019-07-23</d><h>03:31</h><w>dchelimsky</w>you can see this now here: <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn#L331-L333</a></z></g><g id="s7"><z id="t1563555088" t="kulminaator aws itself has a nice set of skeletons in the closet with naming indeed"><y>#</y><d>2019-07-19</d><h>16:51</h><w>kulminaator</w>aws itself has a nice set of skeletons in the closet with naming indeed</z><z id="t1563636421" t="fmnoise hi everyone, is there any way to generate s3 presigned url with aws-api lib?"><y>#</y><d>2019-07-20</d><h>15:27</h><w>fmnoise</w>hi everyone, is there any way to generate s3 presigned url with <code>aws-api</code> lib?</z><z id="t1563645203" t="hiredman Presigned urls are entirely a client side operation (you don&apos;t communicate with the server to do it) so the data describing the aws apis that the library is generated from don&apos;t describe it"><y>#</y><d>2019-07-20</d><h>17:53</h><w>hiredman</w>Presigned urls are entirely a client side operation (you don&apos;t communicate with the server to do it) so the data describing the aws apis that the library is generated from don&apos;t describe it</z><z id="t1563645257" t="hiredman https://github.com/cognitect-labs/aws-api/issues/5"><y>#</y><d>2019-07-20</d><h>17:54</h><w>hiredman</w><a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a></z><z id="t1563823496" t="chadhs curious how many folks in the channel are attending re:invent this year"><y>#</y><d>2019-07-22</d><h>19:24</h><w>chadhs</w>curious how many folks in the channel are attending re:invent this year</z><z id="t1564167895" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.352 https://groups.google.com/forum/#!topic/clojure/-PfzmhtiFrY"><y>#</y><d>2019-07-26</d><h>19:04</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.352 <a href="https://groups.google.com/forum/#!topic/clojure/-PfzmhtiFrY" target="_blank">https://groups.google.com/forum/#!topic/clojure/-PfzmhtiFrY</a></z><z id="t1567183870" t="kenny Has anyone worked with the AWS KMS API and Cognitect&apos;s aws-api? I&apos;m having trouble reading the :Plaintext key from the response. (let [r (aws-api/invoke c {:op :GenerateDataKey :request {:KeyId cmk-arn :KeySpec &quot;AES_256&quot;}}) plaintext (:Plaintext r)] (with-open [p plaintext out (io/output-stream &quot;test.txt&quot;)] (clojure.data.codec.base64/decoding-transfer p out))) java.lang.ArrayIndexOutOfBoundsException: Index -7 out of bounds for length 123 The AWS docs say Plaintext is a &quot;Base64-encoded binary data object.&quot; If I slurp plaintext , I get &quot;�$���r*�!��8yS�x;�\f�@\r� returned which is definitely not base64. Is aws-api doing something with the response before I get it?"><y>#</y><d>2019-08-30</d><h>16:51</h><w>kenny</w>Has anyone worked with the AWS KMS API and Cognitect&apos;s aws-api? I&apos;m having trouble reading the <code>:Plaintext</code> key from the response.
<pre>(let [r (aws-api/invoke c {:op      :GenerateDataKey
                           :request {:KeyId   cmk-arn
                                     :KeySpec &quot;AES_256&quot;}})
      plaintext (:Plaintext r)]
  (with-open [p plaintext
              out (io/output-stream &quot;test.txt&quot;)]
    (clojure.data.codec.base64/decoding-transfer p out)))
java.lang.ArrayIndexOutOfBoundsException: Index -7 out of bounds for length 123
</pre>

The AWS docs say <code>Plaintext</code> is a &quot;Base64-encoded binary data object.&quot; If I <code>slurp</code> <code>plaintext</code>, I get <code>&quot;�$���r*�!��8yS�x;�\f�@\r�</code> returned which is definitely not base64. Is aws-api doing something with the response before I get it?</z><z id="t1567184343" t="hiredman when you call the aws-api doc function for the operation what does it say?"><y>#</y><d>2019-08-30</d><h>16:59</h><w>hiredman</w>when you call the aws-api doc function for the operation what does it say?</z><z id="t1567582247" t="orestis Is there a trivial way to wrap an SQS queue with a core.async channel? There are various libraries that do that, but either are receive-only (squeedo) or are archived (fink-nottle)."><y>#</y><d>2019-09-04</d><h>07:30</h><w>orestis</w>Is there a trivial way to wrap an SQS queue with a core.async channel? There are various libraries that do that, but either are receive-only (squeedo) or are archived (fink-nottle).</z><z id="t1567582304" t="orestis I&apos;d like to use the Cognitect AWS API if possible but I believe it&apos;s HTTP client is synchronous, so I can&apos;t just use a go-loop, I need to think about threads and executors etc."><y>#</y><d>2019-09-04</d><h>07:31</h><w>orestis</w>I&apos;d like to use the Cognitect AWS API if possible but I believe it&apos;s HTTP client is synchronous, so I can&apos;t just use a go-loop, I need to think about threads and executors etc.</z><z id="t1567603224" t="Joe Lane My understanding is that aws-api is both sync and async"><y>#</y><d>2019-09-04</d><h>13:20</h><w>Joe Lane</w>My understanding is that aws-api is both sync and async</z><z id="t1567603253" t="ghadi that&apos;s right"><y>#</y><d>2019-09-04</d><h>13:20</h><w>ghadi</w>that&apos;s right</z><z id="t1567607430" t="jaihindhreddy There&apos;s no streaming AFAIK but aws-api has both sync and async."><y>#</y><d>2019-09-04</d><h>14:30</h><w>jaihindhreddy</w>There&apos;s no streaming AFAIK but aws-api has both sync and async.</z><z id="t1567608540" t="orestis After further digging in the library I see that the sync client wraps the async one - but there’s no detail on how the underlying http library handles things. Is there a threadpool involved, is it truly async etc?"><y>#</y><d>2019-09-04</d><h>14:49</h><w>orestis</w>After further digging in the library I see that the sync client wraps the async one - but there’s no detail on how the underlying http library handles things. Is there a threadpool involved, is it truly async etc?</z><z id="t1567608591" t="Joe Lane Can you define &quot;truly async&quot;?"><y>#</y><d>2019-09-04</d><h>14:49</h><w>Joe Lane</w>Can you define &quot;truly async&quot;?</z><z id="t1567609031" t="orestis Async IO eg with using callbacks vs non-blocking IO where the IO takes place in a (new) background thread. "><y>#</y><d>2019-09-04</d><h>14:57</h><w>orestis</w>Async IO eg with using callbacks vs non-blocking IO where the IO takes place in a (new) background thread. </z><z id="t1567609109" t="orestis Both have their issues when overloaded, eg if you try to put 10000 messages in a queue, you will either overload your CPU with pending callbacks etc or blow up your memory with 10000 threads. "><y>#</y><d>2019-09-04</d><h>14:58</h><w>orestis</w>Both have their issues when overloaded, eg if you try to put 10000 messages in a queue, you will either overload your CPU with pending callbacks etc or blow up your memory with 10000 threads. </z><z id="t1567609238" t="orestis I’m trying to write to SQS which in theory has infinite capacity, so I don’t worry about overloading it, only my own system :)"><y>#</y><d>2019-09-04</d><h>15:00</h><w>orestis</w>I’m trying to write to SQS which in theory has infinite capacity, so I don’t worry about overloading it, only my own system :)</z><z id="t1567613783" t="Alex Miller (Clojure team) the http lib source is in the jar I believe"><y>#</y><d>2019-09-04</d><h>16:16</h><w>Alex Miller (Clojure team)</w>the http lib source is in the jar I believe</z><z id="t1567613934" t="Alex Miller (Clojure team) https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.99/http-client-0.1.99.jar"><y>#</y><d>2019-09-04</d><h>16:18</h><w>Alex Miller (Clojure team)</w><a href="https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.99/http-client-0.1.99.jar" target="_blank">https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.99/http-client-0.1.99.jar</a></z><z id="t1568723425" t="gerred is there an SSM parameter store lib people like? ednism looks nice, but was just thinking of using aws-api directly"><y>#</y><d>2019-09-17</d><h>12:30</h><w>gerred</w>is there an SSM parameter store lib people like? ednism looks nice, but was just thinking of using <code>aws-api</code> directly</z><z id="t1568723462" t="gerred eh maybe I just re-build the functionality of ednism with aws-api, it brings in the whole aws-java-sdk-ssm and some other stuff."><y>#</y><d>2019-09-17</d><h>12:31</h><w>gerred</w>eh maybe I just re-build the functionality of ednism with aws-api, it brings in the whole aws-java-sdk-ssm and some other stuff.</z><z id="t1568725757" t="chris_johnson My experience so far has been that I use env vars for everything, and just write shell scripts to handle putting things into parameter store, and use the AWS infrastructure itself (mainly CloudFormation) to get the correct parameter store values into the process environment of my running code."><y>#</y><d>2019-09-17</d><h>13:09</h><w>chris_johnson</w>My experience so far has been that I use env vars for everything, and just write shell scripts to handle putting things into parameter store, and use the AWS infrastructure itself (mainly CloudFormation) to get the correct parameter store values into the process environment of my running code.</z><z id="t1568726001" t="gerred ^ that, unfortunately, will not work for my use case but that totally makes sense. that integration has helped me in the past. 😄"><y>#</y><d>2019-09-17</d><h>13:13</h><w>gerred</w>^ that, unfortunately, will not work for my use case but that totally makes sense. that integration has helped me in the past. <b>😄</b></z><z id="t1568726054" t="gerred I&apos;m building a package for those who can&apos;t do that (say, Kubernetes users) to be able to resolve configs with aero or configuration other tooling from SSM instead of local EDN."><y>#</y><d>2019-09-17</d><h>13:14</h><w>gerred</w>I&apos;m building a package for those who can&apos;t do that (say, Kubernetes users) to be able to resolve configs with aero or configuration other tooling from SSM instead of local EDN.</z><z id="t1568726085" t="gerred if I was just using ECS alternately I&apos;d just use the built-in injections"><y>#</y><d>2019-09-17</d><h>13:14</h><w>gerred</w>if I was just using ECS alternately I&apos;d just use the built-in injections</z><z id="t1568726194" t="gerred plus what&apos;s nice about a lib like this is that I can eventually make it an adapter so Vault and conjur users can also use the same API."><y>#</y><d>2019-09-17</d><h>13:16</h><w>gerred</w>plus what&apos;s nice about a lib like this is that I can eventually make it an adapter so Vault and conjur users can also use the same API.</z><z id="t1569797969" t="clojer New to AWS. eb create dev1 with a Rails app resulted in bundler version error. I’ve found a fix but now don’t know how to fix dev1 which now has a Red health status."><y>#</y><d>2019-09-29</d><h>22:59</h><w>clojer</w>New to AWS. <code>eb create dev1</code> with a Rails app resulted in bundler version error. I’ve found a fix but now don’t know how to fix dev1 which now has a Red health status.</z><z id="t1569798004" t="clojer I don’t see any thing like eb update"><y>#</y><d>2019-09-29</d><h>23:00</h><w>clojer</w>I don’t see any thing like eb update</z><z id="t1569802415" t="gerred [:attrs {:href &quot;/_/_/users/U0CLQ83LZ&quot;}] this seems like...the wrong place for this with too little information. want to support you in your deployments, but there&apos;s a devops hangout slack, an aws slack, and an infra engineering slack"><y>#</y><d>2019-09-30</d><h>00:13</h><w>gerred</w><a>@clojer</a> this seems like...the wrong place for this with too little information. want to support you in your deployments, but there&apos;s a devops hangout slack, an aws slack, and an infra engineering slack</z><z id="t1569802444" t="gerred nobody here (incl me) and nobody but you knonws what dev1 even is."><y>#</y><d>2019-09-30</d><h>00:14</h><w>gerred</w>nobody here (incl me) and nobody but you knonws what dev1 even is.</z><z id="t1569802485" t="gerred i&apos;ll help you deploy a rails app all day but you might want to back up a few steps and let us join you in your journey here and in #cloud-native and in #docker and probably a few other places."><y>#</y><d>2019-09-30</d><h>00:14</h><w>gerred</w>i&apos;ll help you deploy a rails app all day but you might want to back up a few steps and let us join you in your journey here and in #cloud-native and in #docker and probably a few other places.</z><z id="t1569802500" t="gerred but i&apos;m trying to establish the base level of information here as #cloud-native"><y>#</y><d>2019-09-30</d><h>00:15</h><w>gerred</w>but i&apos;m trying to establish the base level of information here as #cloud-native</z><z id="t1569941391" t="dotemacs [:attrs {:href &quot;/_/_/users/U05509S91&quot;}] this might be a good starting point for SSM + aero: https://www.1729.org.uk/posts/aero-ssm/"><y>#</y><d>2019-10-01</d><h>14:49</h><w>dotemacs</w><a>@gerred</a> this might be a good starting point for SSM + aero: <a href="https://www.1729.org.uk/posts/aero-ssm/" target="_blank">https://www.1729.org.uk/posts/aero-ssm/</a></z><z id="t1571331736" t="kenny If I&apos;m using a shared http-client with Cognitect&apos;s aws-api, is it ok to create many client records without calling stop ?"><y>#</y><d>2019-10-17</d><h>17:02</h><w>kenny</w>If I&apos;m using a shared http-client with Cognitect&apos;s aws-api, is it ok to create many client records without calling <code>stop</code>?</z><z id="t1571331776" t="ghadi yeah if you&apos;re making many aws-api clients, calling stop will bork you"><y>#</y><d>2019-10-17</d><h>17:02</h><w>ghadi</w>yeah if you&apos;re making many aws-api clients, calling stop will bork you</z><z id="t1571331789" t="ghadi we&apos;re working on this problem actively"><y>#</y><d>2019-10-17</d><h>17:03</h><w>ghadi</w>we&apos;re working on this problem actively</z><z id="t1571331827" t="ghadi we&apos;re trying to slowly divorce ourselves from the current http-client, and have a BYO model"><y>#</y><d>2019-10-17</d><h>17:03</h><w>ghadi</w>we&apos;re trying to slowly divorce ourselves from the current http-client, and have a BYO model</z><z id="t1571331858" t="kenny Sorry, so it&apos;s ok to do as I said?"><y>#</y><d>2019-10-17</d><h>17:04</h><w>kenny</w>Sorry, so it&apos;s ok to do as I said?</z><z id="t1571331864" t="ghadi yup"><y>#</y><d>2019-10-17</d><h>17:04</h><w>ghadi</w>yup</z><z id="t1571331876" t="ghadi if you are sharing http-clients, you should avoid calling stop"><y>#</y><d>2019-10-17</d><h>17:04</h><w>ghadi</w>if you are sharing http-clients, you should avoid calling <code>stop</code></z><z id="t1571331909" t="kenny Got it. With that BYO model, seems like this lib could be easily used in CLJS too."><y>#</y><d>2019-10-17</d><h>17:05</h><w>kenny</w>Got it. With that BYO model, seems like this lib could be easily used in CLJS too.</z><z id="t1571331930" t="ghadi slow your roll 😉"><y>#</y><d>2019-10-17</d><h>17:05</h><w>ghadi</w>slow your roll <b>😉</b></z><z id="t1571331964" t="ghadi there are other concerns for CLJS, like signing routines"><y>#</y><d>2019-10-17</d><h>17:06</h><w>ghadi</w>there are other concerns for CLJS, like signing routines</z><z id="t1571331974" t="ghadi porting to CLJS has not been fully evaluated"><y>#</y><d>2019-10-17</d><h>17:06</h><w>ghadi</w>porting to CLJS has not been fully evaluated</z><z id="t1571332001" t="kenny Mostly interested in use in AWS Lambda."><y>#</y><d>2019-10-17</d><h>17:06</h><w>kenny</w>Mostly interested in use in AWS Lambda.</z><z id="t1571332003" t="ghadi there is a ticket if you&apos;d like to register your interest or a motivating case"><y>#</y><d>2019-10-17</d><h>17:06</h><w>ghadi</w>there is a ticket if you&apos;d like to register your interest or a motivating case</z><z id="t1571332013" t="ghadi Cool, I suspected so. Is that because of startup time?"><y>#</y><d>2019-10-17</d><h>17:06</h><w>ghadi</w>Cool, I suspected so.  Is that because of startup time?</z><z id="t1571332017" t="kenny Yes"><y>#</y><d>2019-10-17</d><h>17:06</h><w>kenny</w>Yes</z><z id="t1571332045" t="ghadi what would be an acceptable startup time for CLJ lambda?"><y>#</y><d>2019-10-17</d><h>17:07</h><w>ghadi</w>what would be an acceptable startup time for CLJ lambda?</z><z id="t1571332098" t="kenny For this particular app, under 10s is ok. Cold starts result in 20-30s execution time with production deps."><y>#</y><d>2019-10-17</d><h>17:08</h><w>kenny</w>For this particular app, under 10s is ok. Cold starts result in 20-30s execution time with production deps.</z><z id="t1571332148" t="kenny Almost everything is written in vanilla clojure so getting it to work in Node would be somewhat easy."><y>#</y><d>2019-10-17</d><h>17:09</h><w>kenny</w>Almost everything is written in vanilla clojure so getting it to work in Node would be somewhat easy.</z><z id="t1571332172" t="ghadi yeah we can get there, my goal is under 2s for clojure + core.async + aws-api"><y>#</y><d>2019-10-17</d><h>17:09</h><w>ghadi</w>yeah we can get there, my goal is under 2s for clojure + core.async + aws-api</z><z id="t1571332198" t="ghadi can&apos;t vouch for external deps, most are pigs"><y>#</y><d>2019-10-17</d><h>17:09</h><w>ghadi</w>can&apos;t vouch for external deps, most are pigs</z><z id="t1571332239" t="ghadi might need a custom lambda runtime + JDK11"><y>#</y><d>2019-10-17</d><h>17:10</h><w>ghadi</w>might need a custom lambda runtime + JDK11</z><z id="t1571332249" t="kenny 2s would be fantastic. 10s is really pushing the limit for us but would likely be acceptable for a while."><y>#</y><d>2019-10-17</d><h>17:10</h><w>kenny</w>2s would be fantastic. 10s is really pushing the limit for us but would likely be acceptable for a while.</z><z id="t1571332266" t="ghadi what are the deps you&apos;re pulling in, if you can share?"><y>#</y><d>2019-10-17</d><h>17:11</h><w>ghadi</w>what are the deps you&apos;re pulling in, if you can share?</z><z id="t1571332432" t="kenny Pretty much everything in there is either cljc or has a JS client available. Largest missing piece is Datomic. Hoping they publish a protocol definition for the client API so we can have JS clients."><y>#</y><d>2019-10-17</d><h>17:13</h><w>kenny</w>Pretty much everything in there is either cljc or has a JS client available. Largest missing piece is Datomic. Hoping they publish a protocol definition for the client API so we can have JS clients.</z><z id="t1571332465" t="ghadi that is a ton"><y>#</y><d>2019-10-17</d><h>17:14</h><w>ghadi</w>that is a ton</z><z id="t1571332484" t="kenny Yep, tis&apos; the world we live in haha."><y>#</y><d>2019-10-17</d><h>17:14</h><w>kenny</w>Yep, tis&apos; the world we live in haha.</z><z id="t1571332534" t="ghadi the #1 thing you can do for startup time is to load less code"><y>#</y><d>2019-10-17</d><h>17:15</h><w>ghadi</w>the #1 thing you can do for startup time is to load less code</z><z id="t1571332551" t="ghadi datomic in a lambda is super weird"><y>#</y><d>2019-10-17</d><h>17:15</h><w>ghadi</w>datomic in a lambda is super weird</z><z id="t1571332573" t="ghadi if you need to connect to Datomic, consider running in an Ion -- free lambda"><y>#</y><d>2019-10-17</d><h>17:16</h><w>ghadi</w>if you need to connect to Datomic, consider running in an Ion -- free lambda</z><z id="t1571332580" t="kenny I actually don&apos;t think any one of those deps could be removed unfortunately. The only alternative is removing deps. Removing deps means writing the code ourselves which is sometimes hard to justify the engineering time."><y>#</y><d>2019-10-17</d><h>17:16</h><w>kenny</w>I actually don&apos;t think any one of those deps could be removed unfortunately. The only alternative is removing deps. Removing deps means writing the code ourselves which is sometimes hard to justify the engineering time.</z><z id="t1571332671" t="ghadi I just want to paint a realistic image that it is impossible to get fast startup time with bloated deps"><y>#</y><d>2019-10-17</d><h>17:17</h><w>ghadi</w>I just want to paint a realistic image that it is impossible to get fast startup time with bloated deps</z><z id="t1571332703" t="kenny Ions are too restrictive. There&apos;s no great way to instrument code in them. You&apos;re stuck with CW logs (unfortunately same applies with Lambda though). We have several extremely expensive, somewhat long-running ops that would almost certainly have a large impact on the Datomic instances."><y>#</y><d>2019-10-17</d><h>17:18</h><w>kenny</w>Ions are too restrictive. There&apos;s no great way to instrument code in them. You&apos;re stuck with CW logs (unfortunately same applies with Lambda though). We have several extremely expensive, somewhat long-running ops that would almost certainly have a large impact on the Datomic instances.</z><z id="t1571332763" t="ghadi long-running ops -&gt; not a good use case for lambdas either impact on datomic instances -&gt; use a query group"><y>#</y><d>2019-10-17</d><h>17:19</h><w>ghadi</w>long-running ops -&gt; not a good use case for lambdas either
impact on datomic instances -&gt; use a query group</z><z id="t1571332776" t="ghadi can you elaborate on code instrumentation?"><y>#</y><d>2019-10-17</d><h>17:19</h><w>ghadi</w>can you elaborate on code instrumentation?</z><z id="t1571332834" t="ghadi using honeycomb?"><y>#</y><d>2019-10-17</d><h>17:20</h><w>ghadi</w>using honeycomb?</z><z id="t1571333360" t="kenny Long running = 5-10 min highly CPU intensive task. Yes"><y>#</y><d>2019-10-17</d><h>17:29</h><w>kenny</w>Long running = 5-10 min highly CPU intensive task.

Yes</z><z id="t1571333612" t="ghadi seems really appropriate for an Ion, IMHO"><y>#</y><d>2019-10-17</d><h>17:33</h><w>ghadi</w>seems really appropriate for an Ion, IMHO</z><z id="t1571333620" t="ghadi you can use honeycomb within an Ion"><y>#</y><d>2019-10-17</d><h>17:33</h><w>ghadi</w>you can use honeycomb within an Ion</z><z id="t1571333659" t="ghadi Query Groups allow you to isolate the CPU intensive part so that it&apos;s not running on the Primary Group"><y>#</y><d>2019-10-17</d><h>17:34</h><w>ghadi</w>Query Groups allow you to isolate the CPU intensive part so that it&apos;s not running on the Primary Group</z><z id="t1571333692" t="ghadi but you get the benefit of any queries happening locally instead of across the wire"><y>#</y><d>2019-10-17</d><h>17:34</h><w>ghadi</w>but you get the benefit of any queries happening locally instead of across the wire</z><z id="t1571349368" t="kenny [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] Sorry, had to step out for a while. Couple things there: - We&apos;re actually using Datadog APM right now, not honeycomb, but I assumed the usage was similar -- you need to start the jvm process with a java agent. I don&apos;t think Ions allow you to change the JVM args. - Running in an Ion requires you to run infrastructure 24/7. A huge benefit to running in Lambda is you only pay for execution time. - The Ion deployment model does not fit in very well with existing infrastructure tools (e.g., Terraform, Pulumi, AWS CDK, etc)."><y>#</y><d>2019-10-17</d><h>21:56</h><w>kenny</w><a>@ghadi</a> Sorry, had to step out for a while. Couple things there:
- We&apos;re actually using Datadog APM right now, not honeycomb, but I assumed the usage was similar -- you need to start the jvm process with a java agent. I don&apos;t think Ions allow you to change the JVM args.
- Running in an Ion requires you to run infrastructure 24/7. A huge benefit to running in Lambda is you only pay for execution time.
- The Ion deployment model does not fit in very well with existing infrastructure tools (e.g., Terraform, Pulumi, AWS CDK, etc).</z><z id="t1571349509" t="ghadi honeycomb doesn’t use an agent, but agents are possible with Datomic Zion’s"><y>#</y><d>2019-10-17</d><h>21:58</h><w>ghadi</w>honeycomb doesn’t use an agent, but agents are possible with Datomic Zion’s</z><z id="t1571349575" t="ghadi But I get you, there’s a ton of crap to consider"><y>#</y><d>2019-10-17</d><h>21:59</h><w>ghadi</w>But I get you, there’s a ton of crap to consider</z><z id="t1571349666" t="kenny Oh they are? I didn&apos;t realize you could use Java agents with Ions."><y>#</y><d>2019-10-17</d><h>22:01</h><w>kenny</w>Oh they are? I didn&apos;t realize you could use Java agents with Ions.</z><z id="t1571398344" t="dotemacs Hi, any of you have any experience with AWS’ Cognito ? Any pros/cons that you’d like to share? Thanks in advance"><y>#</y><d>2019-10-18</d><h>11:32</h><w>dotemacs</w>Hi, any of you have any experience with AWS’ <code>Cognito</code>?
Any pros/cons that you’d like to share?
Thanks in advance</z><z id="t1571398808" t="dangercoder Hi [:attrs {:href &quot;/_/_/users/U3SG7RX7A&quot;}] , I&apos;ve used AWS Cognito for a side project of mine. It was not a great fit since I wanted a single page login/registration flow. I ended up building my own UI and back-end which communicated with the aws cognito endpoints, it took longer than expected. I looked for other providers and ended up using Auth0 instead. Auth0&apos;s documentation is a lot nicer imo and the integration took a lot less time, less custom code. I am using their &quot;Lock&quot;-library through Clojurescript."><y>#</y><d>2019-10-18</d><h>11:40</h><w>dangercoder</w>Hi <a>@dotemacs</a>, I&apos;ve used AWS Cognito for a side project of mine. It was not a great fit since I wanted a single page login/registration flow. I ended up building my own UI and back-end which communicated with the aws cognito endpoints, it took longer than expected.

I looked for other providers and ended up using Auth0 instead. Auth0&apos;s documentation is a lot nicer imo and the integration took a lot less time, less custom code. I am using their &quot;Lock&quot;-library through Clojurescript.</z><z id="t1571398999" t="dotemacs Thanks for the reply [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] ! Let me ask you some, maybe obvious questions, that I’m not getting, these OAuth aggregate providers like Cognito, Auth0 and others, they just provide a single point where you initially authenticate. But then for any further interaction, are you speaking to their APIs and they “proxy” the data for that third party or do you have an individual auth token for every service your user authenticates with and you use that auth token to talk directly to that third party service, say Google or Facebook … ? Thanks"><y>#</y><d>2019-10-18</d><h>11:43</h><r>dotemacs</r>Thanks for the reply <a>@UBN9SNVB4</a>!

Let me ask you some, maybe obvious questions, that I’m not getting, these OAuth aggregate providers like Cognito, Auth0 and others, they just provide a single point where you initially authenticate. But then for any further interaction, are you speaking to their APIs and they “proxy” the data for that third party or do you have an individual auth token for every service your user authenticates with and you use that auth token to talk directly to that third party service, say Google or Facebook … ? Thanks</z><z id="t1571399001" t="dangercoder my pros/cons Pros of Cognito: • Cheap • Works together with AWS Gateway etc. Cons: • Docs weren&apos;t great (imo) • If you wan to do something custom it can get troublesome."><y>#</y><d>2019-10-18</d><h>11:43</h><r>dangercoder</r>my pros/cons

Pros of Cognito:
• Cheap
• Works together with AWS Gateway etc.

Cons:
• Docs weren&apos;t great (imo)
• If you wan to do something custom it can get troublesome.</z><z id="t1571401916" t="dangercoder access_token will be returned and it&apos;s only for the chosen provider. So if your user logs in with Facebook you&apos;ll get a facebook_access_token which you can use to call some of their api-endpoints to fetch user information. the result also contains an id_token which contains the requested user data. (at least for open id connect). 🙂 [:attrs {:href &quot;/_/_/users/U3SG7RX7A&quot;}]"><y>#</y><d>2019-10-18</d><h>12:31</h><r>dangercoder</r><code>access_token</code> will be returned and it&apos;s only for the chosen provider. So if your user logs in with Facebook you&apos;ll get a facebook_access_token which you can use to call some of their api-endpoints to fetch user information.

the result also contains an <code>id_token</code> which contains the requested user data.  (at least for open id connect). <b>🙂</b>

<a>@dotemacs</a></z><z id="t1571405146" t="dotemacs Thanks [:attrs {:href &quot;/_/_/users/UBN9SNVB4&quot;}] !"><y>#</y><d>2019-10-18</d><h>13:25</h><r>dotemacs</r>Thanks <a>@UBN9SNVB4</a> !</z><z id="t1571581243" t="bskinny Late reply [:attrs {:href &quot;/_/_/users/U3SG7RX7A&quot;}] , I use Cognito Identity Pools for S3 access control allowing cljs web app users to interact directly to S3. It is important to understand the difference between the User and Identity Pools and also to get your User Pool attribute mapping configured correctly before production use as any configuration changes are not allowed after user pool creation. While Auth0 has a much more mature developer experience, they deprecated their SAML-based approach to integrating with AWS services such as S3 (in short, the ability to reference a OIDC ‘sub’ value in the IAM role, such as ’“arn:aws:s3: :: bucket-name/${ http://cognito-identity.amazonaws.com:sub }/*“’). If you don’t plan to have your web app interact directly with AWS services then Auth0 may be a better choice."><y>#</y><d>2019-10-20</d><h>14:20</h><r>bskinny</r>Late reply <a>@dotemacs</a>, I use Cognito Identity Pools for S3 access control allowing cljs web app users to interact directly to S3. It is important to understand the difference between the User and Identity Pools and also to get your User Pool attribute mapping configured correctly before production use as any configuration changes are not allowed after user pool creation.

While Auth0 has a much more mature developer experience, they deprecated their SAML-based approach to integrating with AWS services such as S3 (in short, the ability to reference a OIDC ‘sub’ value in the IAM role, such as ’“arn:aws:s3:<b>::</b>bucket-name/${<a href="http://cognito-identity.amazonaws.com:sub" target="_blank">http://cognito-identity.amazonaws.com:sub</a>}/*“’). If you don’t plan to have your web app interact directly with AWS services then Auth0 may be a better choice.</z><z id="t1571588641" t="dotemacs [:attrs {:href &quot;/_/_/users/U0NRHH607&quot;}] thanks for the answer :)"><y>#</y><d>2019-10-20</d><h>16:24</h><r>dotemacs</r><a>@U0NRHH607</a> thanks for the answer :)</z><z id="t1571400846" t="danielstockton Non-clojure question: Anyone using a firehose to send data to redshift? I added a column to redshift and the firehose COPY command (json formatted files on S3), but the column isn&apos;t receiving the data."><y>#</y><d>2019-10-18</d><h>12:14</h><w>danielstockton</w>Non-clojure question: Anyone using a firehose to send data to redshift? I added a column to redshift and the firehose COPY command (json formatted files on S3), but the column isn&apos;t receiving the data.</z><z id="t1571402882" t="danielstockton Nevermind, they started appearing ^^"><y>#</y><d>2019-10-18</d><h>12:48</h><w>danielstockton</w>Nevermind, they started appearing ^^</z><z id="t1571667935" t="Brian I created two stages in API Gateway. One called &quot;dev&quot; and one called &quot;prod&quot;. I am satisfied with how dev is and would like to roll that into prod which seems to me like a very simple/common task but I can&apos;t seem to figure out how to do that. 1. Is that possible? 2. Is it best practice?"><y>#</y><d>2019-10-21</d><h>14:25</h><w>Brian</w>I created two stages in API Gateway. One called &quot;dev&quot; and one called &quot;prod&quot;. I am satisfied with how dev is and would like to roll that into prod which seems to me like a very simple/common task but I can&apos;t seem to figure out how to do that.

1. Is that possible?
2. Is it best practice?</z><z id="t1571672509" t="dmarjenburgh That should just be a matter of deploying the api to the prod stage."><y>#</y><d>2019-10-21</d><h>15:41</h><r>dmarjenburgh</r>That should just be a matter of deploying the api to the prod stage.</z><z id="t1571672592" t="dmarjenburgh Are you using the console for this or something else?"><y>#</y><d>2019-10-21</d><h>15:43</h><r>dmarjenburgh</r>Are you using the console for this or something else?</z><z id="t1571687838" t="Brian The console [:attrs {:href &quot;/_/_/users/U05469DKJ&quot;}] . I think I understand the flow now though =]"><y>#</y><d>2019-10-21</d><h>19:57</h><r>Brian</r>The console <a>@U05469DKJ</a>. I think I understand the flow now though =]</z><z id="t1571688292" t="Brian I have a javascript front end which I want to enable to authenticate through Cognito when it hits an endpoint in API Gateway. Should I hard code user credentials into my js in order to get a token and hit our resources? Or is there a different solution for doing server to server authentication? I&apos;ve looked into server to server authentication but I&apos;m not able to find much on it. If someone had an idea of what is best-practice for this situation I&apos;d really appreciate it!"><y>#</y><d>2019-10-21</d><h>20:04</h><w>Brian</w>I have a javascript front end which I want to enable to authenticate through Cognito when it hits an endpoint in API Gateway. Should I hard code user credentials into my js in order to get a token and hit our resources? Or is there a different solution for doing server to server authentication? I&apos;ve looked into server to server authentication but I&apos;m not able to find much on it. If someone had an idea of what is best-practice for this situation I&apos;d really appreciate it!</z><z id="t1571688754" t="Joe Lane [:attrs {:href &quot;/_/_/users/UN1E6R822&quot;}] Look at aws-amplify. Never hard code your credentials."><y>#</y><d>2019-10-21</d><h>20:12</h><w>Joe Lane</w><a>@brian.rogers</a> Look at aws-amplify. Never hard code your credentials.</z><z id="t1571690749" t="Brian [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] This doesn&apos;t look a whole lot different to me. I might be missing something but all their examples have to to with users using usernames and passwords. I can&apos;t quite see how I might use Amplify to give my js front end access to my back end resources without hard coding a username and password. The use case here is that we want to pull data from our database before a user signs in. So at the point we don&apos;t yet have any creds. I was hoping for a way of authenticating with Cognito without a user providing credentials"><y>#</y><d>2019-10-21</d><h>20:45</h><w>Brian</w><a>@lanejo01</a> This doesn&apos;t look a whole lot different to me. I might be missing something but all their examples have to to with users using usernames and passwords. I can&apos;t quite see how I might use Amplify to give my js front end access to my back end resources without hard coding a username and password.

The use case here is that we want to pull data from our database before a user signs in. So at the point we don&apos;t yet have any creds. I was hoping for a way of authenticating with Cognito without a user providing credentials</z><z id="t1571690832" t="Joe Lane Should said data in the database be considered safe for public display?"><y>#</y><d>2019-10-21</d><h>20:47</h><w>Joe Lane</w>Should said data in the database be considered safe for public display?</z><z id="t1571691355" t="kulminaator whatever your frontend exposes to the enduser should be considered public information"><y>#</y><d>2019-10-21</d><h>20:55</h><w>kulminaator</w>whatever your frontend exposes to the enduser should be considered public information</z><z id="t1571691371" t="kulminaator no point of putting usernames or passwords there, might just as well drop the auth from the server"><y>#</y><d>2019-10-21</d><h>20:56</h><w>kulminaator</w>no point of putting usernames or passwords there, might just as well drop the auth from the server</z><z id="t1571691418" t="Brian I suppose it could be... But there has to be a way to do server-server authentication right? Removing the fact that this is .js and front end from the conversation, if I know a server will always be in our hands and I want that server to pull data from our server in AWS, how should I go about doing that authentication?"><y>#</y><d>2019-10-21</d><h>20:56</h><w>Brian</w>I suppose it could be... But there has to be a way to do server-server authentication right? Removing the fact that this is .js and front end from the conversation, if I know a server will always be in our hands and I want that server to pull data from our server in AWS, how should I go about doing that authentication?</z><z id="t1571691435" t="kulminaator when you&apos;re talking server to server stuff and all your stuff is inside of aws - use instance profile &amp; the credentials that are provided by that, everything else ends up being a worse idea"><y>#</y><d>2019-10-21</d><h>20:57</h><w>kulminaator</w>when you&apos;re talking server to server stuff and all your stuff is inside of aws - use instance profile &amp; the credentials that are provided by that, everything else ends up being a worse idea</z><z id="t1571691560" t="Brian What if my other server I not running in AWS? Would it not make sense to do that?"><y>#</y><d>2019-10-21</d><h>20:59</h><w>Brian</w>What if my other server I not running in AWS? Would it not make sense to do that?</z><z id="t1571691620" t="kulminaator well then you&apos;re either going to have shared credentials or a public-private key pair / certificate stuff (and the latter is definitely the better option, but only if you know what you are doing)"><y>#</y><d>2019-10-21</d><h>21:00</h><w>kulminaator</w>well then you&apos;re either going to have shared credentials or  a public-private key pair / certificate stuff (and the latter is definitely the better option, but only if you know what you are doing)</z><z id="t1571691700" t="kulminaator which ever you choose - make sure they have a different path of getting to your server than your code does"><y>#</y><d>2019-10-21</d><h>21:01</h><w>kulminaator</w>which ever you choose - make sure they have a different path of getting to your server than your code does</z><z id="t1571691711" t="kulminaator so you can&apos;t accidentally commit them into your repo and miss out on it"><y>#</y><d>2019-10-21</d><h>21:01</h><w>kulminaator</w>so you can&apos;t accidentally commit them into your repo and miss out on it</z><z id="t1571691802" t="kulminaator europe says it&apos;s late, time to sleep 🙂 read up on how rsa based jwt or ssl client cert auth works (i guess the latter is still not support on api gw). for a good solution i&apos;d say these are the way to go to secure your things without going custom custom"><y>#</y><d>2019-10-21</d><h>21:03</h><w>kulminaator</w>europe says it&apos;s late, time to sleep <b>🙂</b>   read up on how rsa based jwt or ssl client cert auth works (i guess the latter is still not support on api gw). for a good solution i&apos;d say these are the way to go to secure your things without going custom custom</z><z id="t1571691817" t="Brian I&apos;ve never been able to find a means of authentication with Cognito using keys or certs. Is it called something special? Just a man page or something would be really helpful"><y>#</y><d>2019-10-21</d><h>21:03</h><w>Brian</w>I&apos;ve never been able to find a means of authentication with Cognito using keys or certs. Is it called something special? Just a man page or something would be really helpful</z><z id="t1571691835" t="kulminaator that being said - i&apos;m working my way towards removing the apigw and web app lambdas from my architecture - just not worth the extra hustle"><y>#</y><d>2019-10-21</d><h>21:03</h><w>kulminaator</w>that being said - i&apos;m working my way towards removing the apigw and web app lambdas from my architecture - just not worth the extra hustle</z><z id="t1571692067" t="kulminaator you were talking server to server stuff 🙂 ... but by all the looks cognito is just something oauth-isch for enduser authentications"><y>#</y><d>2019-10-21</d><h>21:07</h><w>kulminaator</w>you were talking server to server stuff <b>🙂</b> ... but by all the looks cognito is just something oauth-isch for enduser authentications</z><z id="t1571692113" t="kulminaator i&apos;m off to sleep, i guess you have to read more to navigate around in the space 🙂"><y>#</y><d>2019-10-21</d><h>21:08</h><w>kulminaator</w>i&apos;m off to sleep, i guess you have to read more to navigate around in the space <b>🙂</b></z><z id="t1571692415" t="Brian Thanks for your help!!"><y>#</y><d>2019-10-21</d><h>21:13</h><w>Brian</w>Thanks for your help!!</z><z id="t1571692513" t="mj_langford Brian: What&apos;s wrong with keys for this situation?"><y>#</y><d>2019-10-21</d><h>21:15</h><w>mj_langford</w>Brian: What&apos;s wrong with keys for this situation?</z><z id="t1571692525" t="mj_langford I feel like I missed something here"><y>#</y><d>2019-10-21</d><h>21:15</h><w>mj_langford</w>I feel like I missed something here</z><z id="t1571692569" t="mj_langford Server to server you def auth via cognito"><y>#</y><d>2019-10-21</d><h>21:16</h><w>mj_langford</w>Server to server you def auth via cognito</z><z id="t1571692679" t="Brian I just haven&apos;t been able to find a single page anywhere that talks about actually doing key based authentication with Cognito. I have apigw endpoint I want to hit and it currently has an authorizer attached to a user pool. And I want a server that is 100% mine to be able to use that endpoint"><y>#</y><d>2019-10-21</d><h>21:17</h><w>Brian</w>I just haven&apos;t been able to find a single page anywhere that talks about actually doing key based authentication with Cognito. I have apigw endpoint I want to hit and it currently has an authorizer attached to a user pool. And I want a server that is 100% mine to be able to use that endpoint</z><z id="t1571692723" t="mj_langford https://docs.aws.amazon.com/en_pv/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-with-identity-providers.html https://lobster1234.github.io/2018/05/31/server-to-server-auth-with-amazon-cognito/"><y>#</y><d>2019-10-21</d><h>21:18</h><r>mj_langford</r><a href="https://docs.aws.amazon.com/en_pv/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-with-identity-providers.html" target="_blank">https://docs.aws.amazon.com/en_pv/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-with-identity-providers.html</a>

<a href="https://lobster1234.github.io/2018/05/31/server-to-server-auth-with-amazon-cognito/" target="_blank">https://lobster1234.github.io/2018/05/31/server-to-server-auth-with-amazon-cognito/</a></z><z id="t1571692848" t="mj_langford What you&apos;re trying to do isn&apos;t that uncommon. The Manish Pandit article looks a lot alike what we&apos;ve done a few times."><y>#</y><d>2019-10-21</d><h>21:20</h><w>mj_langford</w>What you&apos;re trying to do isn&apos;t that uncommon. The Manish Pandit article looks a lot alike what we&apos;ve done a few times.</z><z id="t1571692975" t="timcreasy https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/s3-example-photo-album.html is a good example of using Identity Pools for that [:attrs {:href &quot;/_/_/users/UN1E6R822&quot;}] ."><y>#</y><d>2019-10-21</d><h>21:22</h><w>timcreasy</w><a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/s3-example-photo-album.html" target="_blank">https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/s3-example-photo-album.html</a> is a good example of using Identity Pools for that <a>@brian.rogers</a>.</z><z id="t1571693129" t="timcreasy The Identity Pool has an IAM role for authenticated users, which allows access to other resources (in that example putting to an S3 bucket). Can authenticate a user with a user pool (or another identity provider) and then use the identity pool for authentication."><y>#</y><d>2019-10-21</d><h>21:25</h><r>timcreasy</r>The Identity Pool has an IAM role for authenticated users, which allows access to other resources (in that example putting to an S3 bucket).   Can authenticate a user with a user pool (or another identity provider) and then use the identity pool for authentication.</z><z id="t1571693198" t="Brian Here they are talking directly to S3. I was hoping to use a web request with API Gateway. Would this still make sense here? It doesn&apos;t seem like it would"><y>#</y><d>2019-10-21</d><h>21:26</h><r>Brian</r>Here they are talking directly to S3. I was hoping to use a web request with API Gateway. Would this still make sense here? It doesn&apos;t seem like it would</z><z id="t1571693148" t="Brian [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] I&apos;d tried using the lobster server-to-server tutorial but I got errors halfway through the I wasn&apos;t sure how to solve. If you are familiar with that tutorial, might you take a look at the error I am getting?"><y>#</y><d>2019-10-21</d><h>21:25</h><w>Brian</w><a>@mj_langford</a> I&apos;d tried using the lobster server-to-server tutorial but I got errors halfway through the I wasn&apos;t sure how to solve. If you are familiar with that tutorial, might you take a look at the error I am getting?</z><z id="t1571693452" t="mj_langford I have done this a couple times, happy to look at your error"><y>#</y><d>2019-10-21</d><h>21:30</h><w>mj_langford</w>I have done this a couple times, happy to look at your error</z><z id="t1571693722" t="Brian Firstly lets look at my request to make sure that&apos;s ok: curl -X POST \ https://&lt;my-domain&gt;. \ -H &apos;authorization: Basic &lt;4 character base64&apos;d version of &quot;&lt;id&gt;:&lt;secret-id&gt;&quot;&apos; \ -H &apos;content-type: application/x-www-form-urlencoded&apos; \ -d &apos;grant_type=client_credentials&amp;scope=transactions%2Fpost&apos; My base 64&apos;d authorization is waaaay shorter than the example but that&apos;s what the echo -n &apos;x:y&apos; | openssl base64 command gives me. When I run that above command, I get {&quot;error&quot;:&quot;invalid_client&quot;}"><y>#</y><d>2019-10-21</d><h>21:35</h><w>Brian</w>Firstly lets look at my request to make sure that&apos;s ok:
<pre>curl -X POST \
          https://&lt;my-domain&gt;. \
          -H &apos;authorization: Basic &lt;4 character base64&apos;d version of &quot;&lt;id&gt;:&lt;secret-id&gt;&quot;&apos; \
          -H &apos;content-type: application/x-www-form-urlencoded&apos; \
          -d &apos;grant_type=client_credentials&amp;scope=transactions%2Fpost&apos;
</pre>

My base 64&apos;d authorization is waaaay shorter than the example but that&apos;s what the <code>echo -n &apos;x:y&apos; | openssl base64</code> command gives me. When I run that above command, I get <code>{&quot;error&quot;:&quot;invalid_client&quot;}</code></z><z id="t1571693742" t="Brian There could be some misconfigured Cognito stuff if that command looks okay"><y>#</y><d>2019-10-21</d><h>21:35</h><w>Brian</w>There could be some misconfigured Cognito stuff if that command looks okay</z><z id="t1571694857" t="mj_langford invalid client = that client doesn&apos;t match."><y>#</y><d>2019-10-21</d><h>21:54</h><w>mj_langford</w>invalid client = that client doesn&apos;t match.</z><z id="t1571695127" t="mj_langford I believe you&apos;re not getting a real authorization hash from your client id and secret"><y>#</y><d>2019-10-21</d><h>21:58</h><w>mj_langford</w>I believe you&apos;re not getting a real authorization hash from your client id and secret</z><z id="t1571695198" t="mj_langford How long are your x and y in that?"><y>#</y><d>2019-10-21</d><h>21:59</h><w>mj_langford</w>How long are your x and y in that?</z><z id="t1571755556" t="Brian [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] x is 26 characters and y is 51 characters. I was very surprised that this narrowed down to 4 characters"><y>#</y><d>2019-10-22</d><h>14:45</h><w>Brian</w><a>@mj_langford</a> x is 26 characters and y is 51 characters. I was very surprised that this narrowed down to 4 characters</z><z id="t1571755976" t="Brian Wait never mind I sorted that out and the encoded hash now looks much better. Now I am getting {&quot;error&quot;:&quot;invalid_grant&quot;}"><y>#</y><d>2019-10-22</d><h>14:52</h><w>Brian</w>Wait never mind I sorted that out and the encoded hash now looks much better. Now I am getting <code>{&quot;error&quot;:&quot;invalid_grant&quot;}</code></z><z id="t1571756200" t="Brian I already have a user pool that I am trying to use. I did not set one up following the instructions in this blog post. I checked through their code to the best of my ability and believe my user pool is properly configured but it might not be"><y>#</y><d>2019-10-22</d><h>14:56</h><w>Brian</w>I already have a user pool that I am trying to use. I did not set one up following the instructions in this blog post. I checked through their code to the best of my ability and believe my user pool is properly configured but it might not be</z><z id="t1571757114" t="bskinny [:attrs {:href &quot;/_/_/users/UN1E6R822&quot;}] That error means your app is not allowed to use the Client Credential Oauth2 flow - a configuration setting in the Cognito User Pool. I doubt you should be using Client Credentials though. The point of a User Pool is to let Cognito handle your Oauth login flow, either through the authorization code or implicit grant types, the former being preferred. This means your JS frontend is built to route your users to Cognito for authorization (login screen) and eventually send your server application (API Gateway in this case) a access token with requests. I have not used API Gateway but can imagine it simply refers to Cognito for the validity of the received token. A more fine-grained approach is the use of Identity Pools for letting your users access AWS services with Identity Ids which can be referenced in IAM Role definitions to control access at the level of individual identity. In this scenario your frontend JS has to perform another AWS request to retrieve temporary credentials which are passed to AWS services (such as S3 and DynamoDB) instead of the access token. In short, you need to perform the proper routing on the frontend side to get an access token (try the implicit flow first), send the token within a header to API Gateway when making requests, configure API Gateway with the header-to-UserPool mapping."><y>#</y><d>2019-10-22</d><h>15:11</h><r>bskinny</r><a>@UN1E6R822</a> That error means your app is not allowed to use the Client Credential Oauth2 flow - a configuration setting in the Cognito User Pool. I doubt you should be using Client Credentials though. The point of a User Pool is to let Cognito handle your Oauth login flow, either through the authorization code or implicit grant types, the former being preferred. This means your JS frontend is built to route your users to Cognito for authorization (login screen) and eventually send your server application (API Gateway in this case) a access token with requests.  I have not used API Gateway but can imagine it simply refers to Cognito for the validity of the received token.

A more fine-grained approach is the use of Identity Pools for letting your users access AWS services with Identity Ids which can be referenced in IAM Role definitions to control access at the level of individual identity. In this scenario your frontend JS has to perform another AWS request to retrieve temporary credentials which are passed to AWS services (such as S3 and DynamoDB) instead of the access token.

In short, you need to perform the proper routing on the frontend side to get an access token (try the implicit flow first), send the token within a header to API Gateway when making requests, configure API Gateway with the header-to-UserPool mapping.</z><z id="t1571757233" t="Brian I&apos;ll take a look at this. Thanks!"><y>#</y><d>2019-10-22</d><h>15:13</h><r>Brian</r>I&apos;ll take a look at this. Thanks!</z><z id="t1571757039" t="Brian I trimmed the grant_type from client_credentials&amp;scope=transactions%2Fpost to client_credentials and I&apos;m getting a token back! The token isn&apos;t allowing me quite to do what I want and unfortunately I&apos;m getting pulled into a meeting. Will report back!"><y>#</y><d>2019-10-22</d><h>15:10</h><w>Brian</w>I trimmed the <code>grant_type</code> from <code>client_credentials&amp;scope=transactions%2Fpost</code> to <code>client_credentials</code> and I&apos;m getting a token back! The token isn&apos;t allowing me quite to do what I want and unfortunately I&apos;m getting pulled into a meeting. Will report back!</z><z id="t1571772186" t="Brian [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] (or anyone) I&apos;m getting a token back using the command curl -X POST \ https://&lt;my-domain&gt;. \ -H &apos;authorization: Basic &lt;base64&apos;d version of &quot;&lt;id&gt;:&lt;secret-id&gt;&quot;&apos;&gt; \ -H &apos;content-type: application/x-www-form-urlencoded&apos; \ -d &apos;grant_type=client_credentials&apos; However I then go to try and validate the token in apigw I get unauthorized: https://gyazo.com/b818c99e2acd46bcf3e185f20e1c2b28 I don&apos;t quite understand how I could be getting a token back from my user pool which is then rejected a moment later"><y>#</y><d>2019-10-22</d><h>19:23</h><w>Brian</w><a>@mj_langford</a> (or anyone) I&apos;m getting a token back using the command

<pre>curl -X POST \
          https://&lt;my-domain&gt;. \
          -H &apos;authorization: Basic &lt;base64&apos;d version of &quot;&lt;id&gt;:&lt;secret-id&gt;&quot;&apos;&gt; \
          -H &apos;content-type: application/x-www-form-urlencoded&apos; \
          -d &apos;grant_type=client_credentials&apos;
</pre>

However I then go to try and validate the token in apigw I get unauthorized: <a href="https://gyazo.com/b818c99e2acd46bcf3e185f20e1c2b28" target="_blank">https://gyazo.com/b818c99e2acd46bcf3e185f20e1c2b28</a>

I don&apos;t quite understand how I could be getting a token back from my user pool which is then rejected a moment later</z><z id="t1571937699" t="mruzekw For those who use AWS, which of these is the preferable lib to use? https://github.com/cognitect-labs/aws-api https://github.com/mcohen01/amazonica"><y>#</y><d>2019-10-24</d><h>17:21</h><w>mruzekw</w>For those who use AWS, which of these is the preferable lib to use?

<a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a>
<a href="https://github.com/mcohen01/amazonica" target="_blank">https://github.com/mcohen01/amazonica</a></z><z id="t1571937771" t="Alex Miller (Clojure team) they are very different approaches"><y>#</y><d>2019-10-24</d><h>17:22</h><w>Alex Miller (Clojure team)</w>they are very different approaches</z><z id="t1571937808" t="Alex Miller (Clojure team) amazonica is a clojure wrapper for the Java SDK"><y>#</y><d>2019-10-24</d><h>17:23</h><w>Alex Miller (Clojure team)</w>amazonica is a clojure wrapper for the Java SDK</z><z id="t1571937854" t="Alex Miller (Clojure team) aws-api is a data-oriented and data-driven Clojure API directly to the AWS http api"><y>#</y><d>2019-10-24</d><h>17:24</h><w>Alex Miller (Clojure team)</w>aws-api is a data-oriented and data-driven Clojure API directly to the AWS http api</z><z id="t1571938025" t="mruzekw Would it be possible to adapt aws-api for cljs?"><y>#</y><d>2019-10-24</d><h>17:27</h><w>mruzekw</w>Would it be possible to adapt aws-api for cljs?</z><z id="t1571938042" t="Alex Miller (Clojure team) that has been discussed"><y>#</y><d>2019-10-24</d><h>17:27</h><w>Alex Miller (Clojure team)</w>that has been discussed</z><z id="t1571938055" t="Alex Miller (Clojure team) I don&apos;t know the status of it"><y>#</y><d>2019-10-24</d><h>17:27</h><w>Alex Miller (Clojure team)</w>I don&apos;t know the status of it</z><z id="t1571938058" t="mruzekw My use case would be using CLJS for AWS lambda"><y>#</y><d>2019-10-24</d><h>17:27</h><w>mruzekw</w>My use case would be using CLJS for AWS lambda</z><z id="t1571938071" t="Alex Miller (Clojure team) https://github.com/cognitect-labs/aws-api/issues/11"><y>#</y><d>2019-10-24</d><h>17:27</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/cognitect-labs/aws-api/issues/11" target="_blank">https://github.com/cognitect-labs/aws-api/issues/11</a></z><z id="t1571938080" t="Alex Miller (Clojure team) ^^ the issue to follow"><y>#</y><d>2019-10-24</d><h>17:28</h><w>Alex Miller (Clojure team)</w>^^ the issue to follow</z><z id="t1571938085" t="mruzekw Nice, thanks"><y>#</y><d>2019-10-24</d><h>17:28</h><w>mruzekw</w>Nice, thanks</z><z id="t1571938118" t="mruzekw Would it just take converting clj files to cljc?"><y>#</y><d>2019-10-24</d><h>17:28</h><w>mruzekw</w>Would it just take converting clj files to cljc?</z><z id="t1571938122" t="mruzekw “just”"><y>#</y><d>2019-10-24</d><h>17:28</h><w>mruzekw</w>“just”</z><z id="t1571938129" t="Alex Miller (Clojure team) no"><y>#</y><d>2019-10-24</d><h>17:28</h><w>Alex Miller (Clojure team)</w>no</z><z id="t1571938159" t="Alex Miller (Clojure team) you would need a cljs http library instead (maybe other things too, I don&apos;t know)"><y>#</y><d>2019-10-24</d><h>17:29</h><w>Alex Miller (Clojure team)</w>you would need a cljs http library instead (maybe other things too, I don&apos;t know)</z><z id="t1571938168" t="mruzekw Makes sense"><y>#</y><d>2019-10-24</d><h>17:29</h><w>mruzekw</w>Makes sense</z><z id="t1571938212" t="Alex Miller (Clojure team) conceptually there is no reason that can&apos;t work afaik"><y>#</y><d>2019-10-24</d><h>17:30</h><w>Alex Miller (Clojure team)</w>conceptually there is no reason that can&apos;t work afaik</z><z id="t1571938250" t="ghadi we are making moves towards being able to being able to support cljs but cljs isn’t in the short term milestones"><y>#</y><d>2019-10-24</d><h>17:30</h><w>ghadi</w>we are making moves towards being able to being able to support cljs but cljs isn’t in the short term milestones</z><z id="t1571938285" t="mruzekw Is there an existing cljs solution for the AWS api?"><y>#</y><d>2019-10-24</d><h>17:31</h><w>mruzekw</w>Is there an existing cljs solution for the AWS api?</z><z id="t1571938296" t="Alex Miller (Clojure team) I don&apos;t think amazonica does that for cljs"><y>#</y><d>2019-10-24</d><h>17:31</h><w>Alex Miller (Clojure team)</w>I don&apos;t think amazonica does that for cljs</z><z id="t1571938308" t="mruzekw Maybe interop with aws-sdk-js?"><y>#</y><d>2019-10-24</d><h>17:31</h><w>mruzekw</w>Maybe interop with aws-sdk-js?</z><z id="t1571938324" t="Alex Miller (Clojure team) seems like that would be the obvious thing to do"><y>#</y><d>2019-10-24</d><h>17:32</h><w>Alex Miller (Clojure team)</w>seems like that would be the obvious thing to do</z><z id="t1571938329" t="ghadi Apart from http there are also signing routines that need porting to cljs"><y>#</y><d>2019-10-24</d><h>17:32</h><w>ghadi</w>Apart from http there are also signing routines that need porting to cljs</z><z id="t1571938353" t="mruzekw Is that done on a clj reader level or a namespace level?"><y>#</y><d>2019-10-24</d><h>17:32</h><w>mruzekw</w>Is that done on a clj reader level or a namespace level?</z><z id="t1571938379" t="ghadi Signing routines are not terribly complicated, but we’re trying to move forward everything compatibly"><y>#</y><d>2019-10-24</d><h>17:32</h><w>ghadi</w>Signing routines are not terribly complicated, but we’re trying to move forward everything compatibly</z><z id="t1571938421" t="ghadi And that can be tricky"><y>#</y><d>2019-10-24</d><h>17:33</h><w>ghadi</w>And that can be tricky</z><z id="t1571938466" t="ghadi [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] what makes you interested in cljs over clj?"><y>#</y><d>2019-10-24</d><h>17:34</h><w>ghadi</w><a>@mruzekw</a> what makes you interested in cljs over clj?</z><z id="t1571938487" t="mruzekw I plan on using AWS Lambda"><y>#</y><d>2019-10-24</d><h>17:34</h><w>mruzekw</w>I plan on using AWS Lambda</z><z id="t1571938501" t="mruzekw Though I’m not opposed to using CLJ with GraalVM"><y>#</y><d>2019-10-24</d><h>17:35</h><w>mruzekw</w>Though I’m not opposed to using CLJ with GraalVM</z><z id="t1571938532" t="ghadi GraalVM is not possible with these dependencies AFAIK"><y>#</y><d>2019-10-24</d><h>17:35</h><w>ghadi</w>GraalVM is not possible with these dependencies AFAIK</z><z id="t1571938541" t="ghadi Native-image, that is"><y>#</y><d>2019-10-24</d><h>17:35</h><w>ghadi</w>Native-image, that is</z><z id="t1571938608" t="ghadi What is your SLA for startup time?"><y>#</y><d>2019-10-24</d><h>17:36</h><w>ghadi</w>What is your SLA for startup time?</z><z id="t1571938686" t="mruzekw I mean, I’d like to get cold start to &lt;= 500ms and warm &lt;=200ms"><y>#</y><d>2019-10-24</d><h>17:38</h><w>mruzekw</w>I mean, I’d like to get cold start to &lt;= 500ms and warm &lt;=200ms</z><z id="t1571938883" t="ghadi What sorts of dependencies are you interested in running within lambda? Sorry for the 20 questions, doing research :)"><y>#</y><d>2019-10-24</d><h>17:41</h><w>ghadi</w>What sorts of dependencies are you interested in running within lambda? Sorry for the 20 questions, doing research :)</z><z id="t1571938929" t="mruzekw haha no worries"><y>#</y><d>2019-10-24</d><h>17:42</h><w>mruzekw</w>haha no worries</z><z id="t1571938983" t="mruzekw I’m in the preliminary infra planning stages so this may change and may be incomplete, but I’m mainly looking at using the RDSDataServer API to access an Aurora Serverless SQL cluster"><y>#</y><d>2019-10-24</d><h>17:43</h><w>mruzekw</w>I’m in the preliminary infra planning stages so this may change and may be incomplete, but I’m mainly looking at using the RDSDataServer API to access an Aurora Serverless SQL cluster</z><z id="t1571939026" t="mruzekw This is just for now. I could see a use for a queue component"><y>#</y><d>2019-10-24</d><h>17:43</h><w>mruzekw</w>This is just for now. I could see a use for a queue component</z><z id="t1571939034" t="jsyrjala One thing to consider is if you need to run lambdas in VPC, which would increase the cold start time"><y>#</y><d>2019-10-24</d><h>17:43</h><w>jsyrjala</w>One thing to consider is if you need to run lambdas in VPC, which would increase the cold start time</z><z id="t1571939073" t="mruzekw Hmm good to know, VPC restricts public access?"><y>#</y><d>2019-10-24</d><h>17:44</h><w>mruzekw</w>Hmm good to know, VPC restricts public access?</z><z id="t1571939140" t="jsyrjala It allows lambda to talk to services that are inside a VPC that are not accessible from outside"><y>#</y><d>2019-10-24</d><h>17:45</h><w>jsyrjala</w>It allows lambda to talk to services that are inside a VPC that are not accessible from outside</z><z id="t1571939167" t="mruzekw Okay, will have to think that through"><y>#</y><d>2019-10-24</d><h>17:46</h><w>mruzekw</w>Okay, will have to think that through</z><z id="t1571939193" t="mruzekw Do you know how much ms on average accessing through a VPC is?"><y>#</y><d>2019-10-24</d><h>17:46</h><w>mruzekw</w>Do you know how much ms on average accessing through a VPC is?</z><z id="t1571939334" t="jsyrjala AWS launched optimizations for cold starts for lambdas in VPC few weeks ago, so I don’t know the current situation. It used to be in order of few seconds for cold starts and no difference in warm starts, if I remember correctly."><y>#</y><d>2019-10-24</d><h>17:48</h><w>jsyrjala</w>AWS launched optimizations for cold starts for lambdas in VPC few weeks ago, so I don’t know the current situation. It used to be in order of few seconds for cold starts and no difference in warm starts, if I remember correctly.</z><z id="t1571939351" t="Joe Lane https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/"><y>#</y><d>2019-10-24</d><h>17:49</h><w>Joe Lane</w><a href="https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/" target="_blank">https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/</a></z><z id="t1571939380" t="mruzekw Wow a few seconds is significant"><y>#</y><d>2019-10-24</d><h>17:49</h><w>mruzekw</w>Wow a few seconds is significant</z><z id="t1571939472" t="mruzekw 933 ms is better but not great"><y>#</y><d>2019-10-24</d><h>17:51</h><w>mruzekw</w>933 ms is better but not great</z><z id="t1571939496" t="mruzekw But I guess that’s just on cold"><y>#</y><d>2019-10-24</d><h>17:51</h><w>mruzekw</w>But I guess that’s just on cold</z><z id="t1571939560" t="mruzekw Is there a good doc ref for the AWS HTTP level API?"><y>#</y><d>2019-10-24</d><h>17:52</h><w>mruzekw</w>Is there a good doc ref for the AWS HTTP level API?</z><z id="t1571939565" t="mruzekw All I can find are the SDK docs"><y>#</y><d>2019-10-24</d><h>17:52</h><w>mruzekw</w>All I can find are the SDK docs</z><z id="t1571939586" t="Joe Lane That is what aws-api solves for you."><y>#</y><d>2019-10-24</d><h>17:53</h><w>Joe Lane</w>That is what aws-api solves for you.</z><z id="t1571939631" t="Joe Lane basically there is a json based datastructure for all the api&apos;s but I&apos;m not aware of a complete doc reference."><y>#</y><d>2019-10-24</d><h>17:53</h><w>Joe Lane</w>basically there is a json based datastructure for all the api&apos;s but I&apos;m not aware of a complete doc reference.</z><z id="t1571939653" t="mruzekw Hmm alright"><y>#</y><d>2019-10-24</d><h>17:54</h><w>mruzekw</w>Hmm alright</z><z id="t1571939720" t="mruzekw &gt; Each AWS SDK has its own copy of the data descriptions in their github repos. We use aws-sdk-js as the source for these, and release individual artifacts for each api."><y>#</y><d>2019-10-24</d><h>17:55</h><w>mruzekw</w>&gt; Each AWS SDK has its own copy of the data descriptions in their github repos. We use aws-sdk-js as the source for these, and release individual artifacts for each api.</z><z id="t1571939723" t="mruzekw Gotcha"><y>#</y><d>2019-10-24</d><h>17:55</h><w>mruzekw</w>Gotcha</z><z id="t1571939735" t="Joe Lane I prefer the aws-api because then i&apos;m not stuck using builders like the java sdk"><y>#</y><d>2019-10-24</d><h>17:55</h><w>Joe Lane</w>I prefer the aws-api because then i&apos;m not stuck using builders like the java sdk</z><z id="t1571939782" t="mruzekw query.firstParam().secondParam().build() type API?"><y>#</y><d>2019-10-24</d><h>17:56</h><w>mruzekw</w><code>query.firstParam().secondParam().build()</code> type API?</z><z id="t1571939811" t="Joe Lane One word, RequestBuilder ."><y>#</y><d>2019-10-24</d><h>17:56</h><w>Joe Lane</w>One word, <code>RequestBuilder</code>.</z><z id="t1571940003" t="mruzekw Does aws-api take outside PRs?"><y>#</y><d>2019-10-24</d><h>18:00</h><w>mruzekw</w>Does aws-api take outside PRs?</z><z id="t1571940013" t="Joe Lane No, but they take issues"><y>#</y><d>2019-10-24</d><h>18:00</h><w>Joe Lane</w>No, but they take issues</z><z id="t1571940018" t="mruzekw Kk"><y>#</y><d>2019-10-24</d><h>18:00</h><w>mruzekw</w>Kk</z><z id="t1571940058" t="mruzekw I may just use aws/aws-sdk-js in the mean time"><y>#</y><d>2019-10-24</d><h>18:00</h><w>mruzekw</w>I may just use <code>aws/aws-sdk-js</code> in the mean time</z><z id="t1571940114" t="ghadi Editorial: I’m all for faster startup times, but cold start is talked about way too much without surrounding use-cases"><y>#</y><d>2019-10-24</d><h>18:01</h><w>ghadi</w>Editorial: I’m all for faster startup times, but cold start is talked about way too much without surrounding use-cases</z><z id="t1571940172" t="ghadi (That’s why I’m probing for details)"><y>#</y><d>2019-10-24</d><h>18:02</h><w>ghadi</w>(That’s why I’m probing for details)</z><z id="t1571940178" t="mruzekw Well I’m hoping to have lambdas that serve API responses"><y>#</y><d>2019-10-24</d><h>18:02</h><w>mruzekw</w>Well I’m hoping to have lambdas that serve API responses</z><z id="t1571940184" t="mruzekw Servicing a frontend SPA"><y>#</y><d>2019-10-24</d><h>18:03</h><w>mruzekw</w>Servicing a frontend SPA</z><z id="t1571940194" t="mruzekw I’d like the user operations to be quick"><y>#</y><d>2019-10-24</d><h>18:03</h><w>mruzekw</w>I’d like the user operations to be quick</z><z id="t1571940199" t="mruzekw Thus below 1s"><y>#</y><d>2019-10-24</d><h>18:03</h><w>mruzekw</w>Thus below 1s</z><z id="t1571940213" t="Alex Miller (Clojure team) if people are using it, then things aren&apos;t cold right?"><y>#</y><d>2019-10-24</d><h>18:03</h><w>Alex Miller (Clojure team)</w>if people are using it, then things aren&apos;t cold right?</z><z id="t1571940233" t="mruzekw Right, within a timeout"><y>#</y><d>2019-10-24</d><h>18:03</h><w>mruzekw</w>Right, within a timeout</z><z id="t1571940297" t="mruzekw If people don’t use it for say 10 mins it destructs"><y>#</y><d>2019-10-24</d><h>18:04</h><w>mruzekw</w>If people don’t use it for say 10 mins it destructs</z><z id="t1571940297" t="Joe Lane Set a cloudwatch event to ping your stuff every n minutes. Then it&apos;s never cold."><y>#</y><d>2019-10-24</d><h>18:04</h><w>Joe Lane</w>Set a cloudwatch event to ping your stuff every n minutes. Then it&apos;s never cold.</z><z id="t1571940308" t="mruzekw Sure, not a bad idea"><y>#</y><d>2019-10-24</d><h>18:05</h><w>mruzekw</w>Sure, not a bad idea</z><z id="t1571940324" t="mruzekw It doesn’t cost to keep a fn warm?"><y>#</y><d>2019-10-24</d><h>18:05</h><w>mruzekw</w>It doesn’t cost to keep a fn warm?</z><z id="t1571940329" t="Joe Lane nope"><y>#</y><d>2019-10-24</d><h>18:05</h><w>Joe Lane</w>nope</z><z id="t1571940332" t="mruzekw Nice"><y>#</y><d>2019-10-24</d><h>18:05</h><w>mruzekw</w>Nice</z><z id="t1571940348" t="jsyrjala That keeps one lambda instance warm, you’ll get cold starts if you happen to need more than one simultaneously."><y>#</y><d>2019-10-24</d><h>18:05</h><w>jsyrjala</w>That keeps one lambda instance warm, you’ll get cold starts if you happen to need more than one simultaneously.</z><z id="t1571940363" t="Joe Lane you can invoke a lambda to invoke your lambdas"><y>#</y><d>2019-10-24</d><h>18:06</h><w>Joe Lane</w>you can invoke a lambda to invoke your lambdas</z><z id="t1571940373" t="mruzekw Dynamically?"><y>#</y><d>2019-10-24</d><h>18:06</h><w>mruzekw</w>Dynamically?</z><z id="t1571940384" t="mruzekw Like it knows which are warm already?"><y>#</y><d>2019-10-24</d><h>18:06</h><w>mruzekw</w>Like it knows which are warm already?</z><z id="t1571940459" t="Joe Lane This coldstart thing is almost never an issue unless you have a thundering herd scenario."><y>#</y><d>2019-10-24</d><h>18:07</h><w>Joe Lane</w>This coldstart thing is almost never an issue unless you have a thundering herd scenario.</z><z id="t1571940502" t="Joe Lane If you make a heartbeat lambda which heartbeats all your other possible lambdas then this is solved, right?"><y>#</y><d>2019-10-24</d><h>18:08</h><w>Joe Lane</w>If you make a heartbeat lambda which heartbeats all your other possible lambdas then this is solved, right?</z><z id="t1571940578" t="mruzekw Where does the heartbeat originate?"><y>#</y><d>2019-10-24</d><h>18:09</h><w>mruzekw</w>Where does the heartbeat originate?</z><z id="t1571940587" t="Joe Lane cloudwatch event rule"><y>#</y><d>2019-10-24</d><h>18:09</h><w>Joe Lane</w>cloudwatch event rule</z><z id="t1571940589" t="mruzekw I think there’s a timelimit on a running lamnda"><y>#</y><d>2019-10-24</d><h>18:09</h><w>mruzekw</w>I think there’s a timelimit on a running lamnda</z><z id="t1571940591" t="mruzekw Ohhh"><y>#</y><d>2019-10-24</d><h>18:09</h><w>mruzekw</w>Ohhh</z><z id="t1571940706" t="mruzekw https://mikhail.io/serverless/coldstarts/aws/"><y>#</y><d>2019-10-24</d><h>18:11</h><w>mruzekw</w><a href="https://mikhail.io/serverless/coldstarts/aws/" target="_blank">https://mikhail.io/serverless/coldstarts/aws/</a></z><z id="t1571940716" t="mruzekw Last heading: &gt; What Is The Effect Of VPC Access?"><y>#</y><d>2019-10-24</d><h>18:11</h><w>mruzekw</w>Last heading: &gt; What Is The Effect Of VPC Access?</z><z id="t1571940771" t="mruzekw Looks like VPC only slows a cold start by about 0.1s"><y>#</y><d>2019-10-24</d><h>18:12</h><w>mruzekw</w>Looks like VPC only slows a cold start by about 0.1s</z><z id="t1571940824" t="jsyrjala That is a new feature. It used to be a lot worse."><y>#</y><d>2019-10-24</d><h>18:13</h><w>jsyrjala</w>That is a new feature. It used to be a lot worse.</z><z id="t1571940846" t="mruzekw I am grateful"><y>#</y><d>2019-10-24</d><h>18:14</h><w>mruzekw</w>I am grateful</z><z id="t1571940891" t="jsyrjala https://www.youtube.com/watch?v=GINI0T8FPD4"><y>#</y><d>2019-10-24</d><h>18:14</h><w>jsyrjala</w><a href="https://www.youtube.com/watch?v=GINI0T8FPD4" target="_blank">https://www.youtube.com/watch?v=GINI0T8FPD4</a></z><z id="t1571940942" t="mruzekw That’s on my list to watch"><y>#</y><d>2019-10-24</d><h>18:15</h><w>mruzekw</w>That’s on my list to watch</z><z id="t1571940950" t="mruzekw Do you have a tldr/w?"><y>#</y><d>2019-10-24</d><h>18:15</h><w>mruzekw</w>Do you have a tldr/w?</z><z id="t1571941139" t="jsyrjala start times depend on lot of things, like jar size. cold starts are faster in clojurescript, and warm starts are faster in clojure. Clojure(script) has some extra start time cost on top of nodejs/jvm."><y>#</y><d>2019-10-24</d><h>18:18</h><w>jsyrjala</w>start times depend on lot of things, like jar size. cold starts are faster in clojurescript, and warm starts are faster in clojure. Clojure(script) has some extra start time cost on top of nodejs/jvm.</z><z id="t1571941166" t="mruzekw Sure, matches with my research so far"><y>#</y><d>2019-10-24</d><h>18:19</h><w>mruzekw</w>Sure, matches with my research so far</z><z id="t1571941376" t="mruzekw Thanks for all your input all 🙏 🙂"><y>#</y><d>2019-10-24</d><h>18:22</h><w>mruzekw</w>Thanks for all your input all <b>🙏</b> <b>🙂</b></z><z id="t1571941414" t="jsyrjala also low memory lambdas have more varying performance than higher memory (more expensive) lambdas. That is you get some minimum amount of cpu but might get more if you are lucky."><y>#</y><d>2019-10-24</d><h>18:23</h><w>jsyrjala</w>also low memory lambdas have more varying performance than higher memory (more expensive) lambdas. That is you get some minimum amount of cpu but might get more if you are lucky.</z><z id="t1571941472" t="Alex Miller (Clojure team) if cold starts are your problem, then isn&apos;t the real problem no one is using your stuff?"><y>#</y><d>2019-10-24</d><h>18:24</h><w>Alex Miller (Clojure team)</w>if cold starts are your problem, then isn&apos;t the real problem no one is using your stuff?</z><z id="t1571941486" t="ghadi given settings also affect how fast the code slugs are pulled down"><y>#</y><d>2019-10-24</d><h>18:24</h><w>ghadi</w>given settings also affect how fast the code slugs are pulled down</z><z id="t1571941498" t="ghadi and larger code slugs =&gt; slower to pull"><y>#</y><d>2019-10-24</d><h>18:24</h><w>ghadi</w>and larger code slugs =&gt; slower to pull</z><z id="t1571941508" t="ghadi that&apos;s partly what Lambda Layers help with"><y>#</y><d>2019-10-24</d><h>18:25</h><w>ghadi</w>that&apos;s partly what Lambda Layers help with</z><z id="t1571941524" t="ghadi coldstart is but one aspect"><y>#</y><d>2019-10-24</d><h>18:25</h><w>ghadi</w>coldstart is but one aspect</z><z id="t1571941532" t="ghadi of a much larger picture"><y>#</y><d>2019-10-24</d><h>18:25</h><w>ghadi</w>of a much larger picture</z><z id="t1571941749" t="jsyrjala I’ve made this leiningen template to help creating lambda projects for clojure: https://github.com/jsyrjala/aws-lambda-serverless/"><y>#</y><d>2019-10-24</d><h>18:29</h><w>jsyrjala</w>I’ve made this leiningen template to help creating lambda projects for clojure: <a href="https://github.com/jsyrjala/aws-lambda-serverless/" target="_blank">https://github.com/jsyrjala/aws-lambda-serverless/</a></z><z id="t1571947702" t="mruzekw [:attrs {:href &quot;/_/_/users/U1G5P6G0L&quot;}] Do you know of any other Clojure on Lambda resources?"><y>#</y><d>2019-10-24</d><h>20:08</h><w>mruzekw</w><a>@jsyrjala</a> Do you know of any other Clojure on Lambda resources?</z><z id="t1571948118" t="jsyrjala Can’t remember anything else that I have used."><y>#</y><d>2019-10-24</d><h>20:15</h><w>jsyrjala</w>Can’t remember anything else that I  have used.</z><z id="t1571948221" t="jsyrjala Mostly lambdas I have done are backend stuff where cold starts do not matter at all."><y>#</y><d>2019-10-24</d><h>20:17</h><w>jsyrjala</w>Mostly lambdas I have done are backend stuff where cold starts do not matter at all.</z><z id="t1571948376" t="kenny [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] I was pointed to this repo recently when looking for clj on AWS Lambda resources: https://github.com/StediInc/lambda . Looks useful, haven&apos;t used it."><y>#</y><d>2019-10-24</d><h>20:19</h><w>kenny</w><a>@mruzekw</a> I was pointed to this repo recently when looking for clj on AWS Lambda resources: <a href="https://github.com/StediInc/lambda" target="_blank">https://github.com/StediInc/lambda</a>. Looks useful, haven&apos;t used it.</z><z id="t1571948397" t="mruzekw Thanks!"><y>#</y><d>2019-10-24</d><h>20:19</h><w>mruzekw</w>Thanks!</z><z id="t1571949780" t="mruzekw I’m trying to follow this tutorial, but they don’t provide how to correctly invoke the lambda from the AWS CLI"><y>#</y><d>2019-10-24</d><h>20:43</h><w>mruzekw</w>I’m trying to follow this tutorial, but they don’t provide how to correctly invoke the lambda from the AWS CLI</z><z id="t1571949807" t="mruzekw I’m using: aws lambda invoke --function-name clj-hello --payload &apos;{&quot;body&quot;: &quot;Will&quot;}&apos; /dev/stdout "><y>#</y><d>2019-10-24</d><h>20:43</h><w>mruzekw</w>I’m using:

<pre>aws lambda invoke --function-name clj-hello --payload &apos;{&quot;body&quot;: &quot;Will&quot;}&apos; /dev/stdout
</pre></z><z id="t1571949840" t="mruzekw But I get back: {&quot;errorMessage&quot;:&quot;An error occurred during JSON parsing&quot;,&quot;errorType&quot;:&quot;java.lang.RuntimeException&quot;,&quot;stackTrace&quot;:[],&quot;cause&quot;:{&quot;errorMessage&quot;:&quot;com.fasterxml.jackson.databind.JsonMappingException: Can not deserialize instance of java.lang.String out of START_OBJECT token\n at [Source: "><y>#</y><d>2019-10-24</d><h>20:44</h><w>mruzekw</w>But I get back:
<pre>{&quot;errorMessage&quot;:&quot;An error occurred during JSON parsing&quot;,&quot;errorType&quot;:&quot;java.lang.RuntimeException&quot;,&quot;stackTrace&quot;:[],&quot;cause&quot;:{&quot;errorMessage&quot;:&quot;com.fasterxml.jackson.databind.JsonMappingException: Can not deserialize instance of java.lang.String out of START_OBJECT token\n at [Source: </pre></z><z id="t1571949863" t="mruzekw Does anyone know the expected shape of the JSON payload given: (ns hello (:gen-class :methods [^:static [handler [String] String]])) (defn -handler [s] (str &quot;Hello &quot; s &quot;!&quot;)) "><y>#</y><d>2019-10-24</d><h>20:44</h><w>mruzekw</w>Does anyone know the expected shape of the JSON payload given:

<pre>(ns hello
  (:gen-class
   :methods [^:static [handler [String] String]]))

(defn -handler [s]
  (str &quot;Hello &quot; s &quot;!&quot;))
</pre></z><z id="t1571949878" t="mruzekw Tutorial: https://aws.amazon.com/blogs/compute/clojure/"><y>#</y><d>2019-10-24</d><h>20:44</h><w>mruzekw</w>Tutorial: <a href="https://aws.amazon.com/blogs/compute/clojure/" target="_blank">https://aws.amazon.com/blogs/compute/clojure/</a></z><z id="t1571950894" t="jsyrjala try returning JSON formatted string from the -handler"><y>#</y><d>2019-10-24</d><h>21:01</h><w>jsyrjala</w>try returning JSON formatted string from the -handler</z><z id="t1571950924" t="mruzekw (defn -handler [s] s) ?"><y>#</y><d>2019-10-24</d><h>21:02</h><w>mruzekw</w><code>(defn -handler [s] s)</code>?</z><z id="t1571950949" t="jsyrjala for example"><y>#</y><d>2019-10-24</d><h>21:02</h><w>jsyrjala</w>for example</z><z id="t1571951087" t="mruzekw Same error"><y>#</y><d>2019-10-24</d><h>21:04</h><w>mruzekw</w>Same error</z><z id="t1571951185" t="mruzekw I technically uploaded: (defn -handler [s] (str &quot;Hello &quot; s &quot;!&quot;) s) "><y>#</y><d>2019-10-24</d><h>21:06</h><w>mruzekw</w>I technically uploaded:
<pre>(defn -handler [s]
  (str &quot;Hello &quot; s &quot;!&quot;)
  s)
</pre></z><z id="t1571951246" t="jsyrjala I am wondering why it is complaining about JSON at all."><y>#</y><d>2019-10-24</d><h>21:07</h><w>jsyrjala</w>I am wondering why it is complaining about JSON at all.</z><z id="t1571951257" t="kenny I&apos;ve hit that before. It has to do with the signature of your Java lambda fn. I remember having to switch to the input/output stream signature. Googling that exception gives you some answers IIRC."><y>#</y><d>2019-10-24</d><h>21:07</h><w>kenny</w>I&apos;ve hit that before. It has to do with the signature of your Java lambda fn. I remember having to switch to the input/output stream signature. Googling that exception gives you some answers IIRC.</z><z id="t1571951291" t="mruzekw Huh, I thought AWS could infer what to parse given the handler signature"><y>#</y><d>2019-10-24</d><h>21:08</h><w>mruzekw</w>Huh, I thought AWS could infer what to parse given the handler signature</z><z id="t1571951294" t="mruzekw (ns hello (:gen-class :methods [^:static [handler [String] String]])) "><y>#</y><d>2019-10-24</d><h>21:08</h><w>mruzekw</w><pre>(ns hello
  (:gen-class
   :methods [^:static [handler [String] String]]))
</pre></z><z id="t1571951330" t="kenny https://stackoverflow.com/questions/37155595/aws-can-not-deserialize-instance-of-java-lang-string-out-of-start-object/37168362"><y>#</y><d>2019-10-24</d><h>21:08</h><w>kenny</w><a href="https://stackoverflow.com/questions/37155595/aws-can-not-deserialize-instance-of-java-lang-string-out-of-start-object/37168362" target="_blank">https://stackoverflow.com/questions/37155595/aws-can-not-deserialize-instance-of-java-lang-string-out-of-start-object/37168362</a></z><z id="t1571951338" t="kenny The handler is expecting a pojo."><y>#</y><d>2019-10-24</d><h>21:08</h><w>kenny</w>The handler is expecting a pojo.</z><z id="t1571951366" t="jsyrjala I have done handlers always like this."><y>#</y><d>2019-10-24</d><h>21:09</h><w>jsyrjala</w>I have done handlers always like this.</z><z id="t1571951385" t="mruzekw I’m not going through the API Gateway"><y>#</y><d>2019-10-24</d><h>21:09</h><w>mruzekw</w>I’m not going through the API Gateway</z><z id="t1571951387" t="mruzekw ➜ aws lambda invoke --function-name clj-helloooo --payload &apos;Will&apos; /dev/stdout An error occurred (InvalidRequestContentException) when calling the Invoke operation: Could not parse request body into json: Unrecognized token &apos;Will&apos;: was expecting (&apos;true&apos;, &apos;false&apos; or &apos;null&apos;) at [Source: (byte[])&quot;Will&quot;; line: 1, column: 9] "><y>#</y><d>2019-10-24</d><h>21:09</h><w>mruzekw</w><pre>➜ aws lambda invoke --function-name clj-helloooo --payload &apos;Will&apos; /dev/stdout

An error occurred (InvalidRequestContentException) when calling the Invoke operation: Could not parse request body into json: Unrecognized token &apos;Will&apos;: was expecting (&apos;true&apos;, &apos;false&apos; or &apos;null&apos;)
 at [Source: (byte[])&quot;Will&quot;; line: 1, column: 9]
</pre></z><z id="t1571951433" t="kenny I do the same as [:attrs {:href &quot;/_/_/users/U1G5P6G0L&quot;}] . More general that way too."><y>#</y><d>2019-10-24</d><h>21:10</h><w>kenny</w>I do the same as <a>@jsyrjala</a>. More general that way too.</z><z id="t1571951444" t="mruzekw Okay, I’ll try that"><y>#</y><d>2019-10-24</d><h>21:10</h><w>mruzekw</w>Okay, I’ll try that</z><z id="t1571951454" t="mruzekw Thanks y’all"><y>#</y><d>2019-10-24</d><h>21:10</h><w>mruzekw</w>Thanks y’all</z><z id="t1571951548" t="jsyrjala And you can use also non-json messages like that."><y>#</y><d>2019-10-24</d><h>21:12</h><w>jsyrjala</w>And you can use also non-json messages like that.</z><z id="t1571951761" t="mruzekw Quick question/poll: Which would you all choose for a lambda with an avg response time &lt;300ms, CLJ (with or without heartbeat warmer) or CLJS?"><y>#</y><d>2019-10-24</d><h>21:16</h><w>mruzekw</w>Quick question/poll: Which would you all choose for a lambda with an avg response time &lt;300ms, CLJ (with or without heartbeat warmer) or CLJS?</z><z id="t1571951851" t="ghadi don&apos;t focus on time -- it all depends on what it&apos;s doing. You will find a richer ecosystem of libraries on the JVM imho, and the warm speeds will be faster"><y>#</y><d>2019-10-24</d><h>21:17</h><w>ghadi</w>don&apos;t focus on time --
it all depends on what it&apos;s doing.
You will find a richer ecosystem of libraries on the JVM imho, and the warm speeds will be faster</z><z id="t1571952218" t="mruzekw Would a Lumo runtime have a faster startup time than a CLJS fn compiled to JS?"><y>#</y><d>2019-10-24</d><h>21:23</h><w>mruzekw</w>Would a Lumo runtime have a faster startup time than a CLJS fn compiled to JS?</z><z id="t1571952264" t="mruzekw ala https://github.com/grav/aws-lumo-cljs-runtime"><y>#</y><d>2019-10-24</d><h>21:24</h><w>mruzekw</w>ala <a href="https://github.com/grav/aws-lumo-cljs-runtime" target="_blank">https://github.com/grav/aws-lumo-cljs-runtime</a></z><z id="t1571952264" t="ghadi ......."><y>#</y><d>2019-10-24</d><h>21:24</h><w>ghadi</w>.......</z><z id="t1571952277" t="mruzekw I’m just curious"><y>#</y><d>2019-10-24</d><h>21:24</h><w>mruzekw</w>I’m just curious</z><z id="t1571952280" t="ghadi focusing on startup time is misguided"><y>#</y><d>2019-10-24</d><h>21:24</h><w>ghadi</w>focusing on startup time is misguided</z><z id="t1571952296" t="ghadi but super popular 😉"><y>#</y><d>2019-10-24</d><h>21:24</h><w>ghadi</w>but super popular <b>😉</b></z><z id="t1572035224" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.0.8.391 https://groups.google.com/forum/#!topic/clojure/j3rBeZHHtHs"><y>#</y><d>2019-10-25</d><h>20:27</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.0.8.391 <a href="https://groups.google.com/forum/#!topic/clojure/j3rBeZHHtHs" target="_blank">https://groups.google.com/forum/#!topic/clojure/j3rBeZHHtHs</a></z><z id="t1572192272" t="kulminaator well if you build an web application with aws lambdas as a backend ... startup time is actually super important"><y>#</y><d>2019-10-27</d><h>16:04</h><w>kulminaator</w>well if you build an web application with aws lambdas as a backend ... startup time is actually super important</z><z id="t1572211501" t="mruzekw Considering that would you do CLJ with a warming heartbeat or CLJS?"><y>#</y><d>2019-10-27</d><h>21:25</h><r>mruzekw</r>Considering that would you do CLJ with a warming heartbeat or CLJS?</z><z id="t1572245256" t="viesti not too fond of warming heartbeat myself, kind of misses the point of scaling, lower CO2 emission 🙂"><y>#</y><d>2019-10-28</d><h>06:47</h><r>viesti</r>not too fond of warming heartbeat myself, kind of misses the point of scaling, lower CO2 emission <b>🙂</b></z><z id="t1572271709" t="cjsauer Yeah, it also gunks up logs a bit, and requires every lambda to “short circuit” warmer requests so that they don’t cause errors. "><y>#</y><d>2019-10-28</d><h>14:08</h><r>cjsauer</r>Yeah, it also gunks up logs a bit, and requires every lambda to “short circuit” warmer requests so that they don’t cause errors. </z><z id="t1572272029" t="cjsauer Agreed tho that startup time totally does matter...these conversations frequently end in “it’s not an issue”. It is an issue that the first request to my app after 10 minutes shows a loading spinner for 25 seconds, sometimes even timeout errors if there are 2+ lambdas involved. For a startup that is fighting for users, that is guaranteed to turn people away. "><y>#</y><d>2019-10-28</d><h>14:13</h><r>cjsauer</r>Agreed tho that startup time totally does matter...these conversations frequently end in “it’s not an issue”. It is an issue that the first request to my app after 10 minutes shows a loading spinner for 25 seconds, sometimes even timeout errors if there are 2+ lambdas involved. 
For a startup that is fighting for users, that is guaranteed to turn people away. </z><z id="t1572272692" t="cjsauer [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] I think warmers are the best answer at the moment. In my case I’m using Datomic tho, so CLJS isn’t really an option. "><y>#</y><d>2019-10-28</d><h>14:24</h><r>cjsauer</r><a>@U1RCQD0UE</a> I think warmers are the best answer at the moment. In my case I’m using Datomic tho, so CLJS isn’t really an option. </z><z id="t1572277584" t="mruzekw Thanks, yeah. I’m probably going with another DB, so I’m leaning towards CLJS atm. That and my background is in JS"><y>#</y><d>2019-10-28</d><h>15:46</h><r>mruzekw</r>Thanks, yeah. I’m probably going with another DB, so I’m leaning towards CLJS atm. That and my background is in JS</z><z id="t1572330793" t="viesti yeah, Clojure is a hosted language, there&apos;s quite a lot of things to look into on JVM side for fast startup: Graal/native-image, jaotc, AppCDS (for cases where Graal/native-image is too restrictive and you still want to use jvm ecosystem)"><y>#</y><d>2019-10-29</d><h>06:33</h><r>viesti</r>yeah, Clojure is a hosted language, there&apos;s quite a lot of things to look into on JVM side for fast startup: Graal/native-image, jaotc, AppCDS (for cases where Graal/native-image is too restrictive and you still want to use jvm ecosystem)</z><z id="t1572330843" t="viesti I quite liked the lumo as Lambda layer idea, you can keep the sorce even visible in Cloud9, but didn&apos;t look into how well it plays out with npm deps"><y>#</y><d>2019-10-29</d><h>06:34</h><r>viesti</r>I quite liked the lumo as Lambda layer idea, you can keep the sorce even visible in Cloud9, but didn&apos;t look into how well it plays out with npm deps</z><z id="t1572353485" t="mj_langford We did a warmer, I disliked the experiences around that so much I just wrote java, javascript and more while trying to get CJLS expertise high enough to avoid any of the other 3 alternatives I mentioned/used."><y>#</y><d>2019-10-29</d><h>12:51</h><r>mj_langford</r>We did a warmer, I disliked the experiences around that so much I just wrote java, javascript and more while trying to get CJLS expertise high enough to avoid any of the other 3 alternatives I mentioned/used.</z><z id="t1572353558" t="mj_langford lumo, shadow-cljs, and more are my &quot;hopeful alternatives to a warmer, eventually&quot; for the next clojure oriented system I go with on lambda"><y>#</y><d>2019-10-29</d><h>12:52</h><r>mj_langford</r>lumo, shadow-cljs, and more are my &quot;hopeful alternatives to a warmer, eventually&quot; for the next clojure oriented system I go with on lambda</z><z id="t1572360960" t="mruzekw [:attrs {:href &quot;/_/_/users/U050B8Q1P&quot;}] Are you using ‘more’ as a general term or as a specific tool?"><y>#</y><d>2019-10-29</d><h>14:56</h><r>mruzekw</r><a>@U050B8Q1P</a> Are you using ‘more’ as a general term or as a specific tool?</z><z id="t1572361180" t="mruzekw [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] Didn’t know about AppCDS. Will keep that in mind while tinkering. Thanks"><y>#</y><d>2019-10-29</d><h>14:59</h><r>mruzekw</r><a>@U06QSF3BK</a> Didn’t know about AppCDS. Will keep that in mind while tinkering. Thanks</z><z id="t1572361200" t="viesti np :)"><y>#</y><d>2019-10-29</d><h>15:00</h><r>viesti</r>np :)</z><z id="t1572361239" t="viesti would love hearing on tinkering with AppCDS, if you get to it :)"><y>#</y><d>2019-10-29</d><h>15:00</h><r>viesti</r>would love hearing on tinkering with AppCDS, if you get to it :)</z><z id="t1572361275" t="mruzekw Sure! I can even post some benchmarks"><y>#</y><d>2019-10-29</d><h>15:01</h><r>mruzekw</r>Sure! I can even post some benchmarks</z><z id="t1572542505" t="mj_langford Generically"><y>#</y><d>2019-10-31</d><h>17:21</h><r>mj_langford</r>Generically</z><z id="t1573575097" t="mruzekw Does cognitect-labs/aws-api support the AWS CDK?"><y>#</y><d>2019-11-12</d><h>16:11</h><w>mruzekw</w>Does cognitect-labs/aws-api support the AWS CDK?</z><z id="t1573575126" t="ghadi CDK is a totally different thing"><y>#</y><d>2019-11-12</d><h>16:12</h><w>ghadi</w>CDK is a totally different thing</z><z id="t1573575183" t="ghadi aws-api is for talking to the http service endpoints"><y>#</y><d>2019-11-12</d><h>16:13</h><w>ghadi</w>aws-api is for talking to the http service endpoints</z><z id="t1573575206" t="ghadi CDK makes CloudFormation stacklets"><y>#</y><d>2019-11-12</d><h>16:13</h><w>ghadi</w>CDK makes CloudFormation stacklets</z><z id="t1573575236" t="mruzekw Cool, was just curious"><y>#</y><d>2019-11-12</d><h>16:13</h><w>mruzekw</w>Cool, was just curious</z><z id="t1573794995" t="dchelimsky [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] you may interested in https://github.com/stediinc/cdk-clj ."><y>#</y><d>2019-11-15</d><h>05:16</h><w>dchelimsky</w><a>@mruzekw</a> you may interested in <a href="https://github.com/stediinc/cdk-clj" target="_blank">https://github.com/stediinc/cdk-clj</a>.</z><z id="t1573828850" t="kulminaator Trying to do S3 listing from within of an aws lambda fails for me with aws/api and aws/s3"><y>#</y><d>2019-11-15</d><h>14:40</h><w>kulminaator</w>Trying to do S3 listing from within of an aws lambda fails for me with aws/api and aws/s3</z><z id="t1573828962" t="kulminaator {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer;, :cognitect.http-client/throwable #error { :cause java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer; :via [{:type java.lang.NoSuchMethodError :message java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer; :at [cognitect.http_client$empty_bbuf invokeStatic http_client.clj 37]}] :trace [[cognitect.http_client$empty_bbuf invokeStatic http_client.clj 37] [cognitect.http_client$empty_bbuf invoke http_client.clj 34] [cognitect.http_client$on_content$fn__10264 invoke http_client.clj 140] [clojure.core$update invokeStatic core.clj 6196] [clojure.core$update invoke core.clj 6188] [cognitect.http_client$on_content invokeStatic http_client.clj 139] [cognitect.http_client$on_content invoke http_client.clj 136] [clojure.lang.Atom swap Atom.java 51]"><y>#</y><d>2019-11-15</d><h>14:42</h><r>kulminaator</r><pre>{:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer;, :cognitect.http-client/throwable #error {
 :cause java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer;
 :via
 [{:type java.lang.NoSuchMethodError
   :message java.nio.ByteBuffer.flip()Ljava/nio/ByteBuffer;
   :at [cognitect.http_client$empty_bbuf invokeStatic http_client.clj 37]}]
 :trace
 [[cognitect.http_client$empty_bbuf invokeStatic http_client.clj 37]
  [cognitect.http_client$empty_bbuf invoke http_client.clj 34]
  [cognitect.http_client$on_content$fn__10264 invoke http_client.clj 140]
  [clojure.core$update invokeStatic core.clj 6196]
  [clojure.core$update invoke core.clj 6188]
  [cognitect.http_client$on_content invokeStatic http_client.clj 139]
  [cognitect.http_client$on_content invoke http_client.clj 136]
  [clojure.lang.Atom swap Atom.java 51]</pre></z><z id="t1573828996" t="kulminaator ;; code starting like (let [s3-listing (aws/invoke s3 {:op :ListObjectsV2 :request {:Bucket bucket-name :Prefix files-prefix}}) s3-files (map :Key (:Contents s3-listing))] (println s3-listing)"><y>#</y><d>2019-11-15</d><h>14:43</h><r>kulminaator</r><pre>;; code starting like

(let [s3-listing (aws/invoke s3 {:op :ListObjectsV2 :request
                                   {:Bucket bucket-name
                                    :Prefix files-prefix}})
        s3-files (map :Key (:Contents s3-listing))]
    (println s3-listing)</pre></z></g><g id="s8"><z id="t1573829526" t="Alex Miller (Clojure team) which JDK?"><y>#</y><d>2019-11-15</d><h>14:52</h><r>Alex Miller (Clojure team)</r>which JDK?</z><z id="t1573829571" t="Alex Miller (Clojure team) and you are aot&apos;ing"><y>#</y><d>2019-11-15</d><h>14:52</h><r>Alex Miller (Clojure team)</r>and you are aot&apos;ing</z><z id="t1573829578" t="Alex Miller (Clojure team) and if so with what jdk"><y>#</y><d>2019-11-15</d><h>14:52</h><r>Alex Miller (Clojure team)</r>and if so with what jdk</z><z id="t1573830171" t="kulminaator Will report a little later"><y>#</y><d>2019-11-15</d><h>15:02</h><r>kulminaator</r>Will report a little later</z><z id="t1573833601" t="kulminaator I was compiling with leiningen on java11 openjdk, and Amazon is running java8 openjdk for java lambdas"><y>#</y><d>2019-11-15</d><h>16:00</h><r>kulminaator</r>I was compiling with leiningen on java11 openjdk, and Amazon is running java8 openjdk for java lambdas</z><z id="t1573833644" t="kulminaator Once I convinced leiningen to run with java8 for uberjar build the problem seemed to go away"><y>#</y><d>2019-11-15</d><h>16:00</h><r>kulminaator</r>Once I convinced leiningen to run with java8 for uberjar build the problem seemed to go away</z><z id="t1573834315" t="Alex Miller (Clojure team) yeah, that&apos;s what I would have recommended"><y>#</y><d>2019-11-15</d><h>16:11</h><r>Alex Miller (Clojure team)</r>yeah, that&apos;s what I would have recommended</z><z id="t1573834373" t="Alex Miller (Clojure team) there have been some changes in the jdk that affect the compiled method invocation here. I don&apos;t remember the details but it is pretty subtle"><y>#</y><d>2019-11-15</d><h>16:12</h><r>Alex Miller (Clojure team)</r>there have been some changes in the jdk that affect the compiled method invocation here. I don&apos;t remember the details but  it is pretty subtle</z><z id="t1573829060" t="kulminaator Any advice is welcome, some parts of the internet suggest a jdk version issue, aws lambda is running java8"><y>#</y><d>2019-11-15</d><h>14:44</h><w>kulminaator</w>Any advice is welcome, some parts of the internet suggest a jdk version issue, aws lambda is running java8</z><z id="t1573837000" t="kenny The aws-api readme says: &gt; specs which are generated from the source descriptions There&apos;s no obvious documentation on how to use these. How do I access these generated specs?"><y>#</y><d>2019-11-15</d><h>16:56</h><w>kenny</w>The aws-api readme says:
&gt; specs which are generated from the source descriptions
There&apos;s no obvious documentation on how to use these. How do I access these generated specs?</z><z id="t1573837157" t="kenny Ah found it. You&apos;re supposed to use response-spec-key ."><y>#</y><d>2019-11-15</d><h>16:59</h><w>kenny</w>Ah found it. You&apos;re supposed to use <code>response-spec-key</code>.</z><z id="t1573837276" t="kenny How come enum values are not enumerated in the generated specs?"><y>#</y><d>2019-11-15</d><h>17:01</h><w>kenny</w>How come enum values are not enumerated in the generated specs?</z><z id="t1573837346" t="kenny The actual AWS API reference docs seem to have access to enum values."><y>#</y><d>2019-11-15</d><h>17:02</h><w>kenny</w>The actual AWS API reference docs seem to have access to enum values.</z><z id="t1573839150" t="ghadi (s/def :cognitect.aws.kinesis/ConsumerStatus #{&quot;DELETING&quot; &quot;CREATING&quot; &quot;ACTIVE&quot;}) enums are there"><y>#</y><d>2019-11-15</d><h>17:32</h><w>ghadi</w><pre>(s/def :cognitect.aws.kinesis/ConsumerStatus #{&quot;DELETING&quot; &quot;CREATING&quot; &quot;ACTIVE&quot;})</pre>
enums are there</z><z id="t1573839180" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] can you post stuff you tried, whether you were successful or not?"><y>#</y><d>2019-11-15</d><h>17:33</h><w>ghadi</w><a>@kenny</a> can you post stuff you tried, whether you were successful or not?</z><z id="t1573839221" t="kenny Not all of them are like that: (s/def :cognitect.aws.workspaces/WorkspaceState string?) Reference docs: https://docs.aws.amazon.com/workspaces/latest/api/API_Workspace.html?shortFooter=true"><y>#</y><d>2019-11-15</d><h>17:33</h><w>kenny</w>Not all of them are like that:
<pre>(s/def :cognitect.aws.workspaces/WorkspaceState string?)
</pre>
Reference docs: <a href="https://docs.aws.amazon.com/workspaces/latest/api/API_Workspace.html?shortFooter=true" target="_blank">https://docs.aws.amazon.com/workspaces/latest/api/API_Workspace.html?shortFooter=true</a></z><z id="t1573839249" t="kenny &gt; Valid Values: PENDING | AVAILABLE | IMPAIRED | UNHEALTHY | REBOOTING | STARTING | REBUILDING | RESTORING | MAINTENANCE | ADMIN_MAINTENANCE | TERMINATING | TERMINATED | SUSPENDED | UPDATING | STOPPING | STOPPED | ERROR"><y>#</y><d>2019-11-15</d><h>17:34</h><w>kenny</w>&gt; Valid Values: PENDING | AVAILABLE | IMPAIRED | UNHEALTHY | REBOOTING | STARTING | REBUILDING | RESTORING | MAINTENANCE | ADMIN_MAINTENANCE | TERMINATING | TERMINATED | SUSPENDED | UPDATING | STOPPING | STOPPED | ERROR</z><z id="t1573839266" t="ghadi looking -- what&apos;s the mvn coordinate you&apos;re using?"><y>#</y><d>2019-11-15</d><h>17:34</h><w>ghadi</w>looking -- what&apos;s the mvn coordinate you&apos;re using?</z><z id="t1573839274" t="kenny com.cognitect.aws/workspaces {:mvn/version &quot;758.2.549.0&quot;}"><y>#</y><d>2019-11-15</d><h>17:34</h><w>kenny</w>com.cognitect.aws/workspaces {:mvn/version &quot;758.2.549.0&quot;}</z><z id="t1573839285" t="ghadi thx"><y>#</y><d>2019-11-15</d><h>17:34</h><w>ghadi</w>thx</z><z id="t1573839351" t="kenny Just tried the latest 770.2.568.0 and same thing."><y>#</y><d>2019-11-15</d><h>17:35</h><w>kenny</w>Just tried the latest 770.2.568.0 and same thing.</z><z id="t1573839480" t="kenny Same thing for (s/def :cognitect.aws.workspaces/ConnectionState string?)"><y>#</y><d>2019-11-15</d><h>17:38</h><w>kenny</w>Same thing for <code>(s/def :cognitect.aws.workspaces/ConnectionState string?)</code></z><z id="t1573839484" t="kenny https://docs.aws.amazon.com/workspaces/latest/api/API_WorkspaceConnectionStatus.html?shortFooter=true"><y>#</y><d>2019-11-15</d><h>17:38</h><w>kenny</w><a href="https://docs.aws.amazon.com/workspaces/latest/api/API_WorkspaceConnectionStatus.html?shortFooter=true" target="_blank">https://docs.aws.amazon.com/workspaces/latest/api/API_WorkspaceConnectionStatus.html?shortFooter=true</a></z><z id="t1573839550" t="ghadi investigating"><y>#</y><d>2019-11-15</d><h>17:39</h><w>ghadi</w>investigating</z><z id="t1573839615" t="kenny The generators for these specs also don&apos;t work. (gen/generate (s/gen :cognitect.aws.workspaces.Workspace/DirectoryId)) Execution error (ExceptionInfo) at clojure.test.check.generators/fn (generators.cljc:435). Couldn&apos;t satisfy such-that predicate after 100 tries. That&apos;s a bit harder to solve given the spec is a regex."><y>#</y><d>2019-11-15</d><h>17:40</h><w>kenny</w>The generators for these specs also don&apos;t work.
<pre>(gen/generate (s/gen :cognitect.aws.workspaces.Workspace/DirectoryId))
Execution error (ExceptionInfo) at clojure.test.check.generators/fn (generators.cljc:435).
Couldn&apos;t satisfy such-that predicate after 100 tries.
</pre>
That&apos;s a bit harder to solve given the spec is a regex.</z><z id="t1573839715" t="ghadi regex specs is a known problem that [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] is working on"><y>#</y><d>2019-11-15</d><h>17:41</h><w>ghadi</w>regex specs is a known problem that <a>@dchelimsky</a> is working on</z><z id="t1573839729" t="ghadi not all regexes are invertible, even if we use a library like test.chuck"><y>#</y><d>2019-11-15</d><h>17:42</h><w>ghadi</w>not all regexes are invertible, even if we use a library like test.chuck</z><z id="t1573839761" t="ghadi i&apos;m looking into why (s/def :cognitect.aws.workspaces/ConnectionState string?) is not an enum"><y>#</y><d>2019-11-15</d><h>17:42</h><w>ghadi</w>i&apos;m looking into why <code>(s/def :cognitect.aws.workspaces/ConnectionState string?)</code> is not an enum</z><z id="t1573839768" t="kenny True. Seems like test.chuck may be good enough for most/all of the aws cases though?"><y>#</y><d>2019-11-15</d><h>17:42</h><w>kenny</w>True. Seems like test.chuck may be good enough for most/all of the aws cases though?</z><z id="t1573839815" t="ghadi you would think but [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] tested it and it&apos;s about 50/50 from what I recall"><y>#</y><d>2019-11-15</d><h>17:43</h><w>ghadi</w>you would think but <a>@dchelimsky</a> tested it and it&apos;s about 50/50 from what I recall</z><z id="t1573843472" t="dchelimsky Far less than 50/50."><y>#</y><d>2019-11-15</d><h>18:44</h><r>dchelimsky</r>Far less than 50/50.</z><z id="t1573839830" t="ghadi some of the regexes AWS has are truly bizarre"><y>#</y><d>2019-11-15</d><h>17:43</h><w>ghadi</w>some of the regexes AWS has are truly bizarre</z><z id="t1573839842" t="kenny Not surprised haha"><y>#</y><d>2019-11-15</d><h>17:44</h><w>kenny</w>Not surprised haha</z><z id="t1573840107" t="kenny test.check doesn&apos;t work on the DirectoryId regex. Oh well."><y>#</y><d>2019-11-15</d><h>17:48</h><w>kenny</w>test.check doesn&apos;t work on the DirectoryId regex. Oh well.</z><z id="t1573840288" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] it turns out that the enum excludes values that the api actually responds to"><y>#</y><d>2019-11-15</d><h>17:51</h><w>ghadi</w><a>@kenny</a> it turns out that the enum excludes values that the api actually responds to</z><z id="t1573840311" t="ghadi we found that to be the case on some APIs"><y>#</y><d>2019-11-15</d><h>17:51</h><w>ghadi</w>we found that to be the case on some APIs</z><z id="t1573840349" t="kenny Geez. Does the enum def match the api doc reference?"><y>#</y><d>2019-11-15</d><h>17:52</h><w>kenny</w>Geez. Does the enum def match the api doc reference?</z><z id="t1573840364" t="ghadi which enum def?"><y>#</y><d>2019-11-15</d><h>17:52</h><w>ghadi</w>which enum def?</z><z id="t1573840375" t="kenny The one you looked at"><y>#</y><d>2019-11-15</d><h>17:52</h><w>kenny</w>The one you looked at</z><z id="t1573840400" t="kenny ConnectionState"><y>#</y><d>2019-11-15</d><h>17:53</h><w>kenny</w>ConnectionState</z><z id="t1573840407" t="ghadi i didn&apos;t look at a specific one, I just found out the history for the change"><y>#</y><d>2019-11-15</d><h>17:53</h><w>ghadi</w>i didn&apos;t look at a specific one, I just found out the history for the change</z><z id="t1573840428" t="ghadi it probably matches in 95% of the cases, if I were to guess"><y>#</y><d>2019-11-15</d><h>17:53</h><w>ghadi</w>it probably matches in 95% of the cases, if I were to guess</z><z id="t1573840440" t="kenny How do you know it doesn&apos;t match?"><y>#</y><d>2019-11-15</d><h>17:54</h><w>kenny</w>How do you know it doesn&apos;t match?</z><z id="t1573840449" t="ghadi matching meaning the API documentation (non-canonical) and the service descriptor (non-canonical)"><y>#</y><d>2019-11-15</d><h>17:54</h><w>ghadi</w>matching meaning the API documentation (non-canonical) and the service descriptor (non-canonical)</z><z id="t1573840463" t="ghadi the truth is what the API accepts and returns"><y>#</y><d>2019-11-15</d><h>17:54</h><w>ghadi</w>the truth is what the API accepts and returns</z><z id="t1573840476" t="ghadi which might not be in sync with descriptors or documentation"><y>#</y><d>2019-11-15</d><h>17:54</h><w>ghadi</w>which might not be in sync with descriptors or documentation</z><z id="t1573840495" t="ghadi these specs are mechanically generated from json descriptors"><y>#</y><d>2019-11-15</d><h>17:54</h><w>ghadi</w>these specs are mechanically generated from json descriptors</z><z id="t1573840514" t="kenny The only was you&apos;d know &quot;the truth&quot; is by executing API calls, right?"><y>#</y><d>2019-11-15</d><h>17:55</h><w>kenny</w>The only was you&apos;d know &quot;the truth&quot; is by executing API calls, right?</z><z id="t1573840518" t="ghadi yeah"><y>#</y><d>2019-11-15</d><h>17:55</h><w>ghadi</w>yeah</z><z id="t1573840540" t="kenny So these specs have been manually overridden?"><y>#</y><d>2019-11-15</d><h>17:55</h><w>kenny</w>So these specs have been manually overridden?</z><z id="t1573840562" t="ghadi If I were to guess what happened: someone tried to hit an API with the library&apos;s validation turned on, and a value was rejected because it wasn&apos;t in the enum spec"><y>#</y><d>2019-11-15</d><h>17:56</h><w>ghadi</w>If I were to guess what happened: someone tried to hit an API with the library&apos;s validation turned on, and a value was rejected because it wasn&apos;t in the enum spec</z><z id="t1573840568" t="ghadi enums are closed specs"><y>#</y><d>2019-11-15</d><h>17:56</h><w>ghadi</w>enums are closed specs</z><z id="t1573840626" t="ghadi (value rejected by the library&apos;s validation)"><y>#</y><d>2019-11-15</d><h>17:57</h><w>ghadi</w>(value rejected by the library&apos;s validation)</z><z id="t1573840634" t="ghadi not by the service itself"><y>#</y><d>2019-11-15</d><h>17:57</h><w>ghadi</w>not by the service itself</z><z id="t1573840653" t="kenny Interesting. A bit surprised someone else is using Clojure &amp; WorkSpaces haha. So then you guys must be storing which specs do not match and overriding with the &quot;open&quot; enum -- string?."><y>#</y><d>2019-11-15</d><h>17:57</h><w>kenny</w>Interesting. A bit surprised someone else is using Clojure &amp; WorkSpaces haha. So then you guys must be storing which specs do not match and overriding with the &quot;open&quot; enum -- string?.</z><z id="t1573840673" t="ghadi i never said anything about Workspaces"><y>#</y><d>2019-11-15</d><h>17:57</h><w>ghadi</w>i never said anything about Workspaces</z><z id="t1573840715" t="ghadi it&apos;s a general issue we hit somewhere else, that made us re-examine how we emit specs"><y>#</y><d>2019-11-15</d><h>17:58</h><w>ghadi</w>it&apos;s a general issue we hit somewhere else, that made us re-examine how we emit specs</z><z id="t1573840732" t="kenny So all enums are open?"><y>#</y><d>2019-11-15</d><h>17:58</h><w>kenny</w>So all enums are open?</z><z id="t1573840807" t="ghadi are enums in AWS specced as string? ?"><y>#</y><d>2019-11-15</d><h>18:00</h><w>ghadi</w>are enums in AWS specced as <code>string?</code> ?</z><z id="t1573840833" t="kenny But this one isn&apos;t? https://clojurians.slack.com/archives/C09N0H1RB/p1573839150185200"><y>#</y><d>2019-11-15</d><h>18:00</h><w>kenny</w>But this one isn&apos;t? <a href="https://clojurians.slack.com/archives/C09N0H1RB/p1573839150185200" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1573839150185200</a></z><z id="t1573840883" t="ghadi yeah that might be a stale artifact, I&apos;ll confirm on a more recent mvn"><y>#</y><d>2019-11-15</d><h>18:01</h><w>ghadi</w>yeah that might be a stale artifact, I&apos;ll confirm on a more recent mvn</z><z id="t1573840918" t="kenny So all AWS enums are supposed to be specced as string? ?"><y>#</y><d>2019-11-15</d><h>18:01</h><w>kenny</w>So all AWS enums are supposed to be specced as <code>string?</code>?</z><z id="t1573840976" t="ghadi (s/def :cognitect.aws.kinesis/ConsumerStatus string?)"><y>#</y><d>2019-11-15</d><h>18:02</h><w>ghadi</w><pre>(s/def :cognitect.aws.kinesis/ConsumerStatus string?)</pre></z><z id="t1573840980" t="ghadi on latest ^"><y>#</y><d>2019-11-15</d><h>18:03</h><w>ghadi</w>on latest ^</z><z id="t1573841075" t="kenny I understand. It&apos;s kinda a tricky situation. I&apos;m planning to have functions that operate over certain AWS properties. Having generators generate relevant values is important. Seems like the enum values should be worked into the generated generators."><y>#</y><d>2019-11-15</d><h>18:04</h><w>kenny</w>I understand. It&apos;s kinda a tricky situation. I&apos;m planning to have functions that operate over certain AWS properties. Having generators generate relevant values is important. Seems like the enum values should be worked into the generated generators.</z><z id="t1573841178" t="ghadi understood"><y>#</y><d>2019-11-15</d><h>18:06</h><w>ghadi</w>understood</z><z id="t1573841219" t="kenny If the gens for things like ConsumerStatus always generate a random string it will not hit all the code paths, making the gen test bad. For now I can do something like this for all the enum specs: (s/def :workspace-info/State (s/with-gen :cognitect.aws.workspaces/WorkspaceState #(gen/one-of [(s/gen #{&quot;PENDING&quot; &quot;AVAILABLE&quot; &quot;IMPAIRED&quot; &quot;UNHEALTHY&quot; &quot;REBOOTING&quot; &quot;STARTING&quot; &quot;REBUILDING&quot; &quot;RESTORING&quot; &quot;MAINTENANCE&quot; &quot;ADMIN_MAINTENANCE&quot; &quot;TERMINATING&quot; &quot;TERMINATED&quot; &quot;SUSPENDED&quot; &quot;UPDATING&quot; &quot;STOPPING&quot; &quot;STOPPED&quot; &quot;ERROR&quot;}) (s/gen string?)]))) It&apos;d be nice to have something like that build in."><y>#</y><d>2019-11-15</d><h>18:06</h><w>kenny</w>If the gens for things like <code>ConsumerStatus</code> always generate a random string it will not hit all the code paths, making the gen test bad. For now I can do something like this for all the enum specs:
<pre>(s/def :workspace-info/State
  (s/with-gen
    :cognitect.aws.workspaces/WorkspaceState
    #(gen/one-of [(s/gen #{&quot;PENDING&quot;
                           &quot;AVAILABLE&quot;
                           &quot;IMPAIRED&quot;
                           &quot;UNHEALTHY&quot;
                           &quot;REBOOTING&quot;
                           &quot;STARTING&quot;
                           &quot;REBUILDING&quot;
                           &quot;RESTORING&quot;
                           &quot;MAINTENANCE&quot;
                           &quot;ADMIN_MAINTENANCE&quot;
                           &quot;TERMINATING&quot;
                           &quot;TERMINATED&quot;
                           &quot;SUSPENDED&quot;
                           &quot;UPDATING&quot;
                           &quot;STOPPING&quot;
                           &quot;STOPPED&quot;
                           &quot;ERROR&quot;})
                  (s/gen string?)])))
</pre>
It&apos;d be nice to have something like that build in.</z><z id="t1573843620" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] side note: you&apos;ll get better feedback (s/describe and s/explain) if you use the s/spec macro with :gen than the s/with-gen function."><y>#</y><d>2019-11-15</d><h>18:47</h><r>dchelimsky</r><a>@kenny</a> side note: you&apos;ll get better feedback (s/describe and s/explain) if you use the <code>s/spec</code> macro with <code>:gen</code> than the <code>s/with-gen</code> function.</z><z id="t1573853106" t="kenny Weird. That doesn&apos;t seem like the intended use for s/spec ."><y>#</y><d>2019-11-15</d><h>21:25</h><r>kenny</r>Weird. That doesn&apos;t seem like the intended use for <code>s/spec</code>.</z><z id="t1573841333" t="kenny Also would be great to have a note in the readme or, even better, next to the enum specs noting why it is specced as an open enum."><y>#</y><d>2019-11-15</d><h>18:08</h><w>kenny</w>Also would be great to have a note in the readme or, even better, next to the enum specs noting why it is specced as an open enum.</z><z id="t1573841396" t="ghadi can you assist us by capturing a github issue with details?"><y>#</y><d>2019-11-15</d><h>18:09</h><w>ghadi</w>can you assist us by capturing a github issue with details?</z><z id="t1573841420" t="ghadi the concerns are documentation/discovery of enums, and associated gen of enum specs"><y>#</y><d>2019-11-15</d><h>18:10</h><w>ghadi</w>the concerns are documentation/discovery of enums, and associated gen of enum specs</z><z id="t1573841930" t="kenny Sure"><y>#</y><d>2019-11-15</d><h>18:18</h><w>kenny</w>Sure</z><z id="t1573842000" t="ghadi thanks!"><y>#</y><d>2019-11-15</d><h>18:20</h><w>ghadi</w>thanks!</z><z id="t1573842299" t="kenny https://github.com/cognitect-labs/aws-api/issues/104"><y>#</y><d>2019-11-15</d><h>18:24</h><w>kenny</w><a href="https://github.com/cognitect-labs/aws-api/issues/104" target="_blank">https://github.com/cognitect-labs/aws-api/issues/104</a></z><z id="t1573843472" t="dchelimsky Far less than 50/50."><y>#</y><d>2019-11-15</d><h>18:44</h><w>dchelimsky</w>Far less than 50/50.</z><z id="t1574216138" t="kenny The doc function for AWS Lambda&apos;s InvokeAsync is missing some important info. The InvokeAsync description says: InvokeAsync &lt;important&gt; &lt;p&gt;For asynchronous function invocation, use &lt;a&gt;Invoke&lt;/a&gt;.&lt;/p&gt; &lt;/important&gt; &lt;p&gt;Invokes a function asynchronously.&lt;/p&gt; If you go to the AWS Reference docs for this action ( https://docs.aws.amazon.com/lambda/latest/dg/API_InvokeAsync.html ), you&apos;ll see that the action has been deprecated in the description."><y>#</y><d>2019-11-20</d><h>02:15</h><w>kenny</w>The <code>doc</code> function for AWS Lambda&apos;s <code>InvokeAsync</code> is missing some important info. The <code>InvokeAsync</code> description says:
<pre>InvokeAsync

&lt;important&gt; &lt;p&gt;For asynchronous function invocation, use &lt;a&gt;Invoke&lt;/a&gt;.&lt;/p&gt; &lt;/important&gt; &lt;p&gt;Invokes a function asynchronously.&lt;/p&gt;
</pre>
If you go to the AWS Reference docs for this action (<a href="https://docs.aws.amazon.com/lambda/latest/dg/API_InvokeAsync.html" target="_blank">https://docs.aws.amazon.com/lambda/latest/dg/API_InvokeAsync.html</a>), you&apos;ll see that the action has been deprecated in the description.</z><z id="t1574236216" t="kulminaator Aws lambda announced java11 support, nice"><y>#</y><d>2019-11-20</d><h>07:50</h><w>kulminaator</w>Aws lambda announced java11 support, nice</z><z id="t1574240265" t="orestis Sigh, still nothing for Elastic beanstalk "><y>#</y><d>2019-11-20</d><h>08:57</h><w>orestis</w>Sigh, still nothing for Elastic beanstalk </z><z id="t1574267772" t="viesti https://aws.amazon.com/blogs/aws/new-application-load-balancer-simplifies-deployment-with-weighted-target-groups/"><y>#</y><d>2019-11-20</d><h>16:36</h><w>viesti</w><a href="https://aws.amazon.com/blogs/aws/new-application-load-balancer-simplifies-deployment-with-weighted-target-groups/" target="_blank">https://aws.amazon.com/blogs/aws/new-application-load-balancer-simplifies-deployment-with-weighted-target-groups/</a></z><z id="t1574267795" t="viesti I wonder how long it takes for weights to take effect"><y>#</y><d>2019-11-20</d><h>16:36</h><w>viesti</w>I wonder how long it takes for weights to take effect</z><z id="t1574268186" t="viesti re:Invent nearing, the what&apos;s new rss feed getting crowded"><y>#</y><d>2019-11-20</d><h>16:43</h><w>viesti</w>re:Invent nearing, the what&apos;s new rss feed getting crowded</z><z id="t1574764424" t="orestis https://aws.amazon.com/about-aws/whats-new/2019/11/aws-elastic-beanstalk-launches-public-beta-corretto-al2-platforms/"><y>#</y><d>2019-11-26</d><h>10:33</h><w>orestis</w><a href="https://aws.amazon.com/about-aws/whats-new/2019/11/aws-elastic-beanstalk-launches-public-beta-corretto-al2-platforms/" target="_blank">https://aws.amazon.com/about-aws/whats-new/2019/11/aws-elastic-beanstalk-launches-public-beta-corretto-al2-platforms/</a></z><z id="t1574764435" t="orestis &gt; You can now run your Java applications on AWS Elastic Beanstalk using Corretto 8 on Amazon Linux 2, and Corretto 11 on Amazon Linux 2 beta platforms."><y>#</y><d>2019-11-26</d><h>10:33</h><w>orestis</w>&gt; You can now run your Java applications on AWS Elastic Beanstalk using Corretto 8 on Amazon Linux 2, and Corretto 11 on Amazon Linux 2 beta platforms.</z><z id="t1574764600" t="orestis Still a beta (and with missing features, so I’m not jumping there yet) https://docs.aws.amazon.com/elasticbeanstalk/latest/relnotes/release-2019-11-25-al2-beta.html"><y>#</y><d>2019-11-26</d><h>10:36</h><w>orestis</w>Still a beta (and with missing features, so I’m not jumping there yet) <a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/relnotes/release-2019-11-25-al2-beta.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/relnotes/release-2019-11-25-al2-beta.html</a></z><z id="t1574786488" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.408 https://groups.google.com/forum/#!topic/clojure/yRAr6e9kAoE"><y>#</y><d>2019-11-26</d><h>16:41</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.408 <a href="https://groups.google.com/forum/#!topic/clojure/yRAr6e9kAoE" target="_blank">https://groups.google.com/forum/#!topic/clojure/yRAr6e9kAoE</a></z><z id="t1575038541" t="orestis I’m pulling events from SQS in an infinite loop and wanted to make sure that if something goes wrong, the loop restarts. It seems though that I can’t make things break because the http client behind the scenes also does retries and backoff etc, so I wonder if that’s guaranteed behaviour?"><y>#</y><d>2019-11-29</d><h>14:42</h><w>orestis</w>I’m pulling events from SQS in an infinite loop and wanted to make sure that if something goes wrong, the loop restarts. It seems though that I can’t make things break because the http client behind the scenes also does retries and backoff etc, so I wonder if that’s guaranteed behaviour?</z><z id="t1575061907" t="dchelimsky If you&apos;re talking about the aws-api, you can supply your own retriable? and backoff functions: https://cognitect-labs.github.io/aws-api/cognitect.aws.client.api-api.html#cognitect.aws.client.api/client"><y>#</y><d>2019-11-29</d><h>21:11</h><w>dchelimsky</w>If you&apos;re talking about the aws-api, you can supply your own <code>retriable?</code> and <code>backoff</code> functions: <a href="https://cognitect-labs.github.io/aws-api/cognitect.aws.client.api-api.html#cognitect.aws.client.api/client" target="_blank">https://cognitect-labs.github.io/aws-api/cognitect.aws.client.api-api.html#cognitect.aws.client.api/client</a></z><z id="t1575241438" t="cfleming Hi everyone, I’m running some CLJS in AWS Lambda, and I’m keen to automate my deployment using either serverless or AWS SAM. I’ve spent some time looking at them, and they both seem to have problems. My current attempt is using serverless, cljs-lambda (which I was already using) and serverless-cljs-plugin. This seems to work ok, except that serverless-cljs-plugin isn’t invoked when using serverless offline."><y>#</y><d>2019-12-01</d><h>23:03</h><w>cfleming</w>Hi everyone, I’m running some CLJS in AWS Lambda, and I’m keen to automate my deployment using either serverless or AWS SAM. I’ve spent some time looking at them, and they both seem to have problems. My current attempt is using serverless, cljs-lambda (which I was already using) and serverless-cljs-plugin. This seems to work ok, except that serverless-cljs-plugin isn’t invoked when using serverless offline.</z><z id="t1575241487" t="cfleming I’ve tried to patch the plugin to make that happen but I can’t make it work, and there’s very little support available for serverless. Their forums and slack channel are very quiet."><y>#</y><d>2019-12-01</d><h>23:04</h><w>cfleming</w>I’ve tried to patch the plugin to make that happen but I can’t make it work, and there’s very little support available for serverless. Their forums and slack channel are very quiet.</z><z id="t1575241589" t="cfleming So I looked at AWS SAM, but from what I can tell, sam build is totally non-extensible, so I can’t even figure out how to make it compile CLJS before packaging."><y>#</y><d>2019-12-01</d><h>23:06</h><w>cfleming</w>So I looked at AWS SAM, but from what I can tell, <code>sam build</code> is totally non-extensible, so I can’t even figure out how to make it compile CLJS before packaging.</z><z id="t1575241603" t="cfleming Has anyone done anything similar and could share some ideas?"><y>#</y><d>2019-12-01</d><h>23:06</h><w>cfleming</w>Has anyone done anything similar and could share some ideas?</z><z id="t1575245328" t="steveb8n I’m doing this right now. I’m using the new clj-cdk lib which makes it really easy to upload a shadow-cljs zip as part of a generated cloudformation template. really nice experience"><y>#</y><d>2019-12-02</d><h>00:08</h><r>steveb8n</r>I’m doing this right now. I’m using the new clj-cdk lib which makes it really easy to upload a shadow-cljs zip as part of a generated cloudformation template. really nice experience</z><z id="t1575245343" t="steveb8n happy to talk you through it if you want"><y>#</y><d>2019-12-02</d><h>00:09</h><r>steveb8n</r>happy to talk you through it if you want</z><z id="t1575245424" t="steveb8n TLDR; it creates an API gateway with a Lambda proxy automatically attached with all the necessary perms etc. In my case they are deployed into a Datomic VPC as well but maybe you don’t need that"><y>#</y><d>2019-12-02</d><h>00:10</h><r>steveb8n</r>TLDR; it creates an API gateway with a Lambda proxy automatically attached with all the necessary perms etc. In my case they are deployed into a Datomic VPC as well but maybe you don’t need that</z><z id="t1575245479" t="steveb8n https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-apigateway.LambdaRestApi.html"><y>#</y><d>2019-12-02</d><h>00:11</h><r>steveb8n</r><a href="https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-apigateway.LambdaRestApi.html" target="_blank">https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-apigateway.LambdaRestApi.html</a></z><z id="t1575245528" t="steveb8n I can run this locally using node, no need for SAM"><y>#</y><d>2019-12-02</d><h>00:12</h><r>steveb8n</r>I can run this locally using node, no need for SAM</z><z id="t1575245758" t="steveb8n I haven’t done CI yet but the sdk CLI “works on my machine” so should go well in a docker container"><y>#</y><d>2019-12-02</d><h>00:15</h><r>steveb8n</r>I haven’t done CI yet but the sdk CLI “works on my machine” so should go well in a docker container</z><z id="t1575246138" t="cfleming [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] Thanks, that’s very interesting, I hadn’t heard of CDK. I’ll read up on that and let you know if I have questions."><y>#</y><d>2019-12-02</d><h>00:22</h><r>cfleming</r><a>@U0510KXTU</a> Thanks, that’s very interesting, I hadn’t heard of CDK. I’ll read up on that and let you know if I have questions.</z><z id="t1575246185" t="steveb8n the conj video is a quick way to pick it up"><y>#</y><d>2019-12-02</d><h>00:23</h><r>steveb8n</r>the conj video is a quick way to pick it up</z><z id="t1575246197" t="cfleming Ohhh… this is the one with the funky imports"><y>#</y><d>2019-12-02</d><h>00:23</h><r>cfleming</r>Ohhh… this is the one with the funky imports</z><z id="t1575246205" t="steveb8n yes, that’s the one 🙂"><y>#</y><d>2019-12-02</d><h>00:23</h><r>steveb8n</r>yes, that’s the one <b>🙂</b></z><z id="t1575246221" t="cfleming Haha, your chance of getting support added to Cursive just went way up 🙂"><y>#</y><d>2019-12-02</d><h>00:23</h><r>cfleming</r>Haha, your chance of getting support added to Cursive just went way up <b>🙂</b></z><z id="t1575246309" t="steveb8n there’s a few rough edges but works really well. I owe them a blog post once I get it fully working but, for now, I’m happy to help a fellow Kiwi"><y>#</y><d>2019-12-02</d><h>00:25</h><r>steveb8n</r>there’s a few rough edges but works really well. I owe them a blog post once I get it fully working but, for now, I’m happy to help a fellow Kiwi</z><z id="t1575246337" t="cfleming Ok, let me do some reading/watching and playing around, I’ll let you know if I have questions."><y>#</y><d>2019-12-02</d><h>00:25</h><r>cfleming</r>Ok, let me do some reading/watching and playing around, I’ll let you know if I have questions.</z><z id="t1575265546" t="jsyrjala Here is a leiningen template I made for creating clojure lambdas with http://serverless.com . You are using clojurescript but it might be helpful anyways: https://github.com/jsyrjala/aws-lambda-serverless with this: https://www.npmjs.com/package/serverless-scriptable-plugin"><y>#</y><d>2019-12-02</d><h>05:45</h><r>jsyrjala</r>Here is a leiningen template I made for creating clojure lambdas with <a href="http://serverless.com" target="_blank">http://serverless.com</a>. You are using clojurescript but it  might be helpful anyways: <a href="https://github.com/jsyrjala/aws-lambda-serverless" target="_blank">https://github.com/jsyrjala/aws-lambda-serverless</a> with this: <a href="https://www.npmjs.com/package/serverless-scriptable-plugin" target="_blank">https://www.npmjs.com/package/serverless-scriptable-plugin</a></z><z id="t1575268321" t="valtteri clj-sdk looks really cool! However here’s yet another (minimal but simple) example how to use shadow-cljs with Serverless Framework https://github.com/vharmain/serverless-healthcheck"><y>#</y><d>2019-12-02</d><h>06:32</h><r>valtteri</r><code>clj-sdk</code>  looks really cool! However here’s yet another (minimal but simple) example how to use <code>shadow-cljs</code>  with Serverless Framework <a href="https://github.com/vharmain/serverless-healthcheck" target="_blank">https://github.com/vharmain/serverless-healthcheck</a></z><z id="t1575268454" t="valtteri Basically npm run deploy boils down to just npx shadow-cljs release :lib &amp;&amp; npx serverless deploy"><y>#</y><d>2019-12-02</d><h>06:34</h><r>valtteri</r>Basically <code>npm run deploy</code>  boils down to just <code>npx shadow-cljs release :lib &amp;&amp; npx serverless deploy</code></z><z id="t1575270043" t="viesti I&apos;ve previously used Terraform to deploy Lambdas, it also has a nice support for uploading the code as zip artifact, based of sha of the file"><y>#</y><d>2019-12-02</d><h>07:00</h><r>viesti</r>I&apos;ve previously used Terraform to deploy Lambdas, it also has a nice support for uploading the code as zip artifact, based of sha of the file</z><z id="t1575270112" t="viesti and you can do other necessary infrastructure configuration with Terraform too (Intelli Idea has nice Terraform support)"><y>#</y><d>2019-12-02</d><h>07:01</h><r>viesti</r>and you can do other necessary infrastructure configuration with Terraform too (Intelli Idea has nice Terraform support)</z><z id="t1575270211" t="viesti of course it depends on how one wants to do things, Terraform is a broad avenue to other IaC too, which might be more than just serverless thing, but comes handy if you end up configuring other infrastructure too :)"><y>#</y><d>2019-12-02</d><h>07:03</h><r>viesti</r>of course it depends on how one wants to do things, Terraform is a broad avenue to other IaC too, which might be more than just serverless thing, but comes handy if you end up configuring other infrastructure too :)</z><z id="t1575281402" t="lloydshark Hi Colin, This was our experience (from a couple of years ago so things may have changed). Here&apos;s a super short summary. We used SAM. We kept our lambda build separate and published direct to S3 using standard clojurescript build tooling. We produced a separate build artefact for the SAM artefacts also published to a well defined S3 location. For the SAM template we parameterised the lambda location in S3 (based on the version number). So then for deployment we wrote some simple scripts to call cloud formation directly and reference the SAM template and the lambdas we had previously published to S3. We were in quite corporate environment so this gave us a good way to control / separate the build, deployment and promotion between environments. This system worked pretty well for us as the pieces were pretty simple. Main drawbacks with SAM was the fact that it is cloudformation so you suffer the normal issue which is needing to split up your stacks to avoid problems if you need to destroy one. ie If your critical data stores are also wrapped up in the same stack then you could be in for some trouble. This might be a lot more than you were after - but hey maybe some of this is of use depending on your context."><y>#</y><d>2019-12-02</d><h>10:10</h><r>lloydshark</r>Hi Colin,

This was our experience (from a couple of years ago so things may have changed).

Here&apos;s a super short summary.

We used SAM.

We kept our lambda build separate and published direct to S3 using standard clojurescript build tooling.

We produced a separate build artefact for the SAM artefacts also published to a well defined S3 location.

For the SAM template we parameterised the lambda location in S3 (based on the version number).

So then for deployment we wrote some simple scripts to call cloud formation directly and reference the SAM template and the lambdas we had previously published to S3.

We were in quite corporate environment so this gave us a good way to control / separate the build, deployment and promotion between environments.

This system worked pretty well for us as the pieces were pretty simple.

Main drawbacks with SAM was the fact that it is cloudformation so you suffer the normal issue which is needing to split up your stacks to avoid problems if you need to destroy one.  ie If your critical data stores are also wrapped up in the same stack then you could be in for some trouble.

This might be a lot more than you were after - but hey maybe some of this is of use depending on your context.</z><z id="t1575281728" t="lloydshark Tooling for SAM / Cloudformation authoring was also a bit of an issue."><y>#</y><d>2019-12-02</d><h>10:15</h><r>lloydshark</r>Tooling for SAM / Cloudformation authoring was also a bit of an issue.</z><z id="t1575319702" t="mj_langford [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] that&apos;s a fascinating stack. Thanks for sharing, and please share with the channel the blog article if you have time to after you write it"><y>#</y><d>2019-12-02</d><h>20:48</h><r>mj_langford</r><a>@U0510KXTU</a> that&apos;s a fascinating stack. Thanks for sharing, and please share with the channel the blog article if you have time to after you write it</z><z id="t1575329091" t="cfleming Thanks for the replies everyone, I’ll read through all that. There are tons of different approaches here, and it’s hard to figure out the pros and cons without trying them all."><y>#</y><d>2019-12-02</d><h>23:24</h><r>cfleming</r>Thanks for the replies everyone, I’ll read through all that. There are tons of different approaches here, and it’s hard to figure out the pros and cons without trying them all.</z><z id="t1575275405" t="orestis Any news on https://github.com/cognitect-labs/aws-api/issues/5 ?"><y>#</y><d>2019-12-02</d><h>08:30</h><w>orestis</w>Any news on <a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a> ?</z><z id="t1575383558" t="dchelimsky [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] it&apos;s definitely on the radar, but not currently in progress."><y>#</y><d>2019-12-03</d><h>14:32</h><w>dchelimsky</w><a>@orestis</a> it&apos;s definitely on the radar, but not currently in progress.</z><z id="t1575384333" t="orestis Thanks for the update, much appreciated."><y>#</y><d>2019-12-03</d><h>14:45</h><r>orestis</r>Thanks for the update, much appreciated.</z><z id="t1575383932" t="dchelimsky In other news, I just pushed releases of the latest updates to the aws-api service libs, including some new libs that were just announced at AWS re:Invent. See https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn for all of the latest releases."><y>#</y><d>2019-12-03</d><h>14:38</h><w>dchelimsky</w>In other news, I just pushed releases of the latest updates to the aws-api service libs, including some new libs that were just announced at AWS re:Invent. See <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a> for all of the latest releases.</z><z id="t1575670227" t="kenny It may be worth adding another function to cognitect.aws.retry that includes jitter. Seems like a fairly common use case."><y>#</y><d>2019-12-06</d><h>22:10</h><w>kenny</w>It may be worth adding another function to cognitect.aws.retry that includes jitter. Seems like a fairly common use case.</z><z id="t1575671203" t="kenny https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/ I&apos;d probably recommend that to be the default."><y>#</y><d>2019-12-06</d><h>22:26</h><r>kenny</r><a href="https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/" target="_blank">https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/</a>

I&apos;d probably recommend that to be the default.</z><z id="t1575671243" t="kenny It&apos;s easy enough to write your own and pass it to the client for now though."><y>#</y><d>2019-12-06</d><h>22:27</h><r>kenny</r>It&apos;s easy enough to write your own and pass it to the client for now though.</z><z id="t1575907740" t="mruzekw We can worry less about AWS Lambda + JVM 🎉 https://serverless.com/blog/aws-lambda-provisioned-concurrency/"><y>#</y><d>2019-12-09</d><h>16:09</h><w>mruzekw</w>We can worry less about AWS Lambda + JVM <b>🎉</b>
<a href="https://serverless.com/blog/aws-lambda-provisioned-concurrency/" target="_blank">https://serverless.com/blog/aws-lambda-provisioned-concurrency/</a></z><z id="t1575907870" t="ghadi yup"><y>#</y><d>2019-12-09</d><h>16:11</h><w>ghadi</w>yup</z><z id="t1575956334" t="kulminaator I have fallen back to identical jetty machines instead of lambdas for real time applications. Much more predictable for me (also my ops are remote io related, so a threading jetty is more cost effective)."><y>#</y><d>2019-12-10</d><h>05:38</h><w>kulminaator</w>I have fallen back to identical jetty machines instead of lambdas for real time applications. Much more predictable for me (also my ops are remote io related, so a threading jetty is more cost effective).</z><z id="t1575957560" t="kulminaator And the provisioned concurrency does not win money wise either. You pay the fair ec2 price for the wait time."><y>#</y><d>2019-12-10</d><h>05:59</h><w>kulminaator</w>And the provisioned concurrency does not win money wise either. You pay the fair ec2 price for the wait time.</z><z id="t1575957645" t="kulminaator For unpredictable loads where load time doesn&apos;t matter lambdas are great though. Especially when you can launch hundreds at a time."><y>#</y><d>2019-12-10</d><h>06:00</h><w>kulminaator</w>For unpredictable loads where load time doesn&apos;t matter lambdas are great though. Especially when you can launch hundreds at a time.</z><z id="t1576613153" t="thomascothran Is there a recommended way to be able to call large numbers (more than 64) of lambdas with aws-api ? Initially I ran into the limit from Cognitect&apos;s HttpClient, and I tried creating more AWS lambda clients (suggested in this issue: https://github.com/cognitect-labs/aws-api/issues/98 ) However, we&apos;ve had servers falling over in production because the file descriptor limit is exceeded. Testing at the REPL, it does look like when a client is created for AWS lambda, file descriptors are not released. Should I be doing something to close the client? (Doesn&apos;t look like there&apos;s a .close method.) on the aws client. Might be related to this issue: https://github.com/cognitect-labs/aws-api/issues/109"><y>#</y><d>2019-12-17</d><h>20:05</h><w>thomascothran</w>Is there a recommended way to be able to call large numbers (more than 64) of lambdas with <code>aws-api</code>?

Initially I ran into the limit from Cognitect&apos;s HttpClient, and I tried creating more AWS lambda clients (suggested in this issue: <a href="https://github.com/cognitect-labs/aws-api/issues/98" target="_blank">https://github.com/cognitect-labs/aws-api/issues/98</a>)

However, we&apos;ve had servers falling over in production because the file descriptor limit is exceeded. Testing at the REPL, it does look like when a client is created for AWS lambda, file descriptors are not released. Should I be doing something to close the client? (Doesn&apos;t look like there&apos;s a <code>.close</code> method.) on the aws client.

Might be related to this issue: <a href="https://github.com/cognitect-labs/aws-api/issues/109" target="_blank">https://github.com/cognitect-labs/aws-api/issues/109</a></z><z id="t1576615747" t="kulminaator i ran into the same issue 🙂"><y>#</y><d>2019-12-17</d><h>20:49</h><w>kulminaator</w>i ran into the same issue <b>🙂</b></z><z id="t1576615834" t="kulminaator tried to run 128 lambdas at once and results were failures to execute them 😞"><y>#</y><d>2019-12-17</d><h>20:50</h><w>kulminaator</w>tried to run 128 lambdas at once and results were failures to execute them <b>😞</b></z><z id="t1576616628" t="kulminaator for the leaks of filehandles, doesn&apos;t (aws/stop s3) release them ?"><y>#</y><d>2019-12-17</d><h>21:03</h><w>kulminaator</w>for the leaks of filehandles, doesn&apos;t <code>(aws/stop s3)</code>   release them ?</z><z id="t1576616636" t="kulminaator rather unconventional ..."><y>#</y><d>2019-12-17</d><h>21:03</h><w>kulminaator</w>rather unconventional ...</z><z id="t1576616779" t="kulminaator seems to do it for me"><y>#</y><d>2019-12-17</d><h>21:06</h><w>kulminaator</w>seems to do it for me</z><z id="t1576616865" t="kulminaator small test i ran"><y>#</y><d>2019-12-17</d><h>21:07</h><r>kulminaator</r>small test i ran</z><z id="t1576616883" t="kulminaator [:attrs {:href &quot;/_/_/users/U7GK705MM&quot;}] i think this should at least help you put out the fire 🙂"><y>#</y><d>2019-12-17</d><h>21:08</h><r>kulminaator</r><a>@U7GK705MM</a> i think this should at least help you put out the fire <b>🙂</b></z><z id="t1576620016" t="thomascothran Looks like aws/stop does the trick. Thanks [:attrs {:href &quot;/_/_/users/U6MHHF36J&quot;}] ."><y>#</y><d>2019-12-17</d><h>22:00</h><r>thomascothran</r>Looks like <code>aws/stop</code> does the trick. Thanks <a>@kulminaator</a>.</z><z id="t1576620540" t="thomascothran Right there in the README too, I just missed it. &quot;Invoke cognitect.aws.client.api/stop on the client if you want it to shut down any resources it and its http-client are using.&quot;"><y>#</y><d>2019-12-17</d><h>22:09</h><r>thomascothran</r>Right there in the README too, I just missed it. &quot;Invoke <code>cognitect.aws.client.api/stop</code> on the client if you want it to shut down any resources it and its http-client are using.&quot;</z><z id="t1576618485" t="ghadi I can’t type now but we’ll systematically fix this"><y>#</y><d>2019-12-17</d><h>21:34</h><w>ghadi</w>I can’t type now but we’ll systematically fix this</z><z id="t1576620016" t="thomascothran Looks like aws/stop does the trick. Thanks [:attrs {:href &quot;/_/_/users/U6MHHF36J&quot;}] ."><y>#</y><d>2019-12-17</d><h>22:00</h><w>thomascothran</w>Looks like <code>aws/stop</code> does the trick. Thanks <a>@kulminaator</a>.</z><z id="t1576809669" t="kenny I&apos;m building a version of aws-api for gcp. There&apos;s actually a nice openapi spec for the gcp api. Cognitect&apos;s aws-api merges parameters in all locations (headers, query string, path, &amp; body) into a single map. Were there any cases where there was a clash (e.g., a param was named the same thing but located in a different place)? If so, how did you handle it?"><y>#</y><d>2019-12-20</d><h>02:41</h><w>kenny</w>I&apos;m building a version of aws-api for gcp. There&apos;s actually a nice openapi spec for the gcp api. Cognitect&apos;s aws-api merges parameters in all locations (headers, query string, path, &amp; body) into a single map. Were there any cases where there was a clash (e.g., a param was named the same thing but located in a different place)? If so, how did you handle it?</z><z id="t1576877993" t="kenny For the GCP Compute API, this occurs 50 times. Curious about approaches on how to handle this."><y>#</y><d>2019-12-20</d><h>21:39</h><r>kenny</r>For the GCP Compute API, this occurs 50 times. Curious about approaches on how to handle this.</z><z id="t1576874583" t="viesti How does the bring-your-own http client landscape of work look like? Have been thinking about the HTTP client in Java 11... https://github.com/schmee/java-http-clj"><y>#</y><d>2019-12-20</d><h>20:43</h><w>viesti</w>How does the bring-your-own http client landscape of work look like? Have been thinking about the HTTP client in Java 11... <a href="https://github.com/schmee/java-http-clj" target="_blank">https://github.com/schmee/java-http-clj</a></z><z id="t1576874732" t="viesti another thing: now that I say this out loud, I should try it out, but does aws-api survive graalvm native-image compilation?"><y>#</y><d>2019-12-20</d><h>20:45</h><w>viesti</w>another thing: now that I say this out loud, I should try it out, but does aws-api survive graalvm native-image compilation?</z><z id="t1577087308" t="kulminaator :thinking_face: right now the aws api from cognitect is hardlinked to http api from cognitect which in turn pulls in a bunch of jetty stuff, did i undestand it right from the sourcecode ?"><y>#</y><d>2019-12-23</d><h>07:48</h><w>kulminaator</w><b>:thinking_face:</b> right now the aws api from cognitect is hardlinked to http api from cognitect which in turn pulls in a bunch of jetty stuff, did i undestand it right from the sourcecode ?</z><z id="t1577087487" t="kulminaator whilst i may be able to ship my own http client i can&apos;t get rid of the jetty baggage"><y>#</y><d>2019-12-23</d><h>07:51</h><w>kulminaator</w>whilst i may be able to ship my own http client i can&apos;t get rid of the jetty baggage</z><z id="t1577087508" t="kulminaator any way we could make it more plug and play ?"><y>#</y><d>2019-12-23</d><h>07:51</h><w>kulminaator</w>any way we could make it more plug and play ?</z><z id="t1577108142" t="Alex Miller (Clojure team) That’s in work"><y>#</y><d>2019-12-23</d><h>13:35</h><w>Alex Miller (Clojure team)</w>That’s in work</z><z id="t1577201820" t="Jakub Holý (HolyJak) I&apos;ve just published https://blog.jakubholy.net/2019/secure-repl-for-aws-fargate-services/ Feedback and improvements welcome! Also, Merry 🎄 !"><y>#</y><d>2019-12-24</d><h>15:37</h><w>Jakub Holý (HolyJak)</w>I&apos;ve just published <a href="https://blog.jakubholy.net/2019/secure-repl-for-aws-fargate-services/" target="_blank">https://blog.jakubholy.net/2019/secure-repl-for-aws-fargate-services/</a> Feedback and improvements welcome! Also, Merry <b>🎄</b>!</z><z id="t1577202431" t="ghadi [:attrs {:href &quot;/_/_/users/U0522TWDA&quot;}] I enjoyed that, thanks!"><y>#</y><d>2019-12-24</d><h>15:47</h><w>ghadi</w><a>@holyjak</a> I enjoyed that, thanks!</z><z id="t1577212859" t="Jakub Holý (HolyJak) Thank you! I&apos;ve now fixed links to the Tf modules"><y>#</y><d>2019-12-24</d><h>18:40</h><r>Jakub Holý (HolyJak)</r>Thank you! I&apos;ve now fixed links to the Tf modules</z><z id="t1577219109" t="danielglauser Trying to use the Cognitect aws-api project to interact with S3. I can invoke ListBuckets however if I try anything else like ListObjectsV2 or PutObject all I get back is: {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable nil} "><y>#</y><d>2019-12-24</d><h>20:25</h><w>danielglauser</w>Trying to use the Cognitect <code>aws-api</code> project to interact with S3. I can invoke <code>ListBuckets</code> however if I try anything else like <code>ListObjectsV2</code> or <code>PutObject</code> all I get back is:
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable nil}</pre>
</z><z id="t1577219135" t="danielglauser Does anyone know how I can get more information to see what’s failing?"><y>#</y><d>2019-12-24</d><h>20:25</h><w>danielglauser</w>Does anyone know how I can get more information to see what’s failing?</z><z id="t1577219154" t="ghadi Need more info. Can you post your client construction and invocation?"><y>#</y><d>2019-12-24</d><h>20:25</h><w>ghadi</w>Need more info. Can you post your client construction and invocation?</z><z id="t1577219358" t="danielglauser (def s3 (aws/client {:api :s3 | :credentials-provider (credentials/basic-credentials-provider creds)})) (aws/invoke s3 {:op :ListBuckets}) &lt;correct response&gt; (aws/invoke s3 {:op :ListObjectsV2 :request {:Bucket &quot;valid-bucket-name&quot;}}) {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable nil}"><y>#</y><d>2019-12-24</d><h>20:29</h><w>danielglauser</w><pre>(def s3 (aws/client {:api :s3                                                |
                        :credentials-provider (credentials/basic-credentials-provider
                                               creds)}))

(aws/invoke s3 {:op :ListBuckets})
&lt;correct response&gt;

(aws/invoke s3 {:op :ListObjectsV2 :request {:Bucket &quot;valid-bucket-name&quot;}})
{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable nil}</pre></z><z id="t1577219458" t="ghadi What region is the bucket in?"><y>#</y><d>2019-12-24</d><h>20:30</h><w>ghadi</w>What region is the bucket in?</z><z id="t1577219506" t="danielglauser US West (N. California)"><y>#</y><d>2019-12-24</d><h>20:31</h><w>danielglauser</w>US West (N. California)</z><z id="t1577220028" t="ghadi What region is the client/code in?"><y>#</y><d>2019-12-24</d><h>20:40</h><w>ghadi</w>What region is the client/code in?</z><z id="t1577220036" t="ghadi They have to match"><y>#</y><d>2019-12-24</d><h>20:40</h><w>ghadi</w>They have to match</z><z id="t1577220089" t="ghadi Is AWS_REGION is set in your env?"><y>#</y><d>2019-12-24</d><h>20:41</h><w>ghadi</w>Is AWS_REGION is set in your env?</z><z id="t1577220101" t="ghadi [:attrs {:href &quot;/_/_/users/U086KE6TX&quot;}] "><y>#</y><d>2019-12-24</d><h>20:41</h><w>ghadi</w><a>@danielglauser</a> </z><z id="t1577220117" t="ghadi Alternatively you can pass an option on the client constructor"><y>#</y><d>2019-12-24</d><h>20:41</h><w>ghadi</w>Alternatively you can pass an option on the client constructor</z><z id="t1577220349" t="danielglauser I have not set the region anywhere, didn’t think I needed to because ListBuckets worked with out it. I’ll try setting it in the client constructor."><y>#</y><d>2019-12-24</d><h>20:45</h><w>danielglauser</w>I have not set the region anywhere, didn’t think I needed to because <code>ListBuckets</code> worked with out it. I’ll try setting it in the client constructor.</z><z id="t1577220378" t="ghadi ListBuckets is a global op, the others are bucket (region-bound) ops"><y>#</y><d>2019-12-24</d><h>20:46</h><w>ghadi</w>ListBuckets is a global op, the others are bucket (region-bound) ops</z><z id="t1577220398" t="ghadi but the error is not helpful, I&apos;ll see if we can tighten that up"><y>#</y><d>2019-12-24</d><h>20:46</h><w>ghadi</w>but the error is not helpful, I&apos;ll see if we can tighten that up</z><z id="t1577220439" t="ghadi in general if you are running in AWS (EC2, Lambda, ECS) the client ctor doesn&apos;t need any options because everything is autodiscovered"><y>#</y><d>2019-12-24</d><h>20:47</h><w>ghadi</w>in general if you are running in AWS (EC2, Lambda, ECS) the client ctor doesn&apos;t need any options because everything is autodiscovered</z><z id="t1577220512" t="ghadi locally I set AWS_PROFILE and have the region+creds in ~/.aws/"><y>#</y><d>2019-12-24</d><h>20:48</h><w>ghadi</w>locally I set AWS_PROFILE and have the region+creds in ~/.aws/</z><z id="t1577220528" t="ghadi hope that helps"><y>#</y><d>2019-12-24</d><h>20:48</h><w>ghadi</w>hope that helps</z><z id="t1577220598" t="danielglauser Adding :region &quot;us-west-1&quot; to the client constructor did the trick. Thanks [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] !"><y>#</y><d>2019-12-24</d><h>20:49</h><w>danielglauser</w>Adding <code>:region &quot;us-west-1&quot;</code> to the client constructor did the trick. Thanks <a>@ghadi</a>!</z><z id="t1577960736" t="kirill.salykin I am trying to use aws-api as the sts client, but it doesnt work, please advice what is wrong (require &apos;[cognitect.aws.client.api :as aws]) (def sts (aws/client {:api :sts})) Cannot find resource cognitect/aws/sts/service.edn."><y>#</y><d>2020-01-02</d><h>10:25</h><w>kirill.salykin</w>I am trying to use <code>aws-api</code> as the <code>sts</code> client, but it doesnt work, please advice what is wrong

<pre>(require &apos;[cognitect.aws.client.api :as aws])
(def sts (aws/client {:api :sts}))</pre>
<pre>Cannot find resource cognitect/aws/sts/service.edn.</pre></z><z id="t1577967939" t="jaihindhreddy Did you add the artefact for STS to your deps.edn? com.cognitect.aws/sts {:mvn/version &quot;773.2.578.0&quot;, :aws/serviceFullName &quot;AWS Security Token Service&quot;}"><y>#</y><d>2020-01-02</d><h>12:25</h><r>jaihindhreddy</r>Did you add the artefact for STS to your deps.edn?
<pre>com.cognitect.aws/sts
 {:mvn/version &quot;773.2.578.0&quot;, :aws/serviceFullName &quot;AWS Security Token Service&quot;}</pre></z><z id="t1577967963" t="jaihindhreddy You need to add one dependency per AWS service. You can find a list of all the latest ones here: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2020-01-02</d><h>12:26</h><r>jaihindhreddy</r>You need to add one dependency per AWS service. You can find a list of all the latest ones here:
<a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1577967987" t="kirill.salykin oh, of course, makes sense thanks!"><y>#</y><d>2020-01-02</d><h>12:26</h><r>kirill.salykin</r>oh, of course, makes sense

thanks!</z><z id="t1577967996" t="kirill.salykin (and of course I didnt)"><y>#</y><d>2020-01-02</d><h>12:26</h><r>kirill.salykin</r>(and of course I didnt)</z><z id="t1578271607" t="cfleming Hi everyone. I have an issue with an existing static website on S3 fronted by CloudFront. I’m migrating it to use CDK for deployment. I redirect www to apex domain, so I have both https://domain.com and https://www.domain.com buckets set up, and the www one redirects to the apex address. This all worked fine when set up manually but when deploying via CDK I get AccessDenied errors when accessing the www address. The apex one works fine."><y>#</y><d>2020-01-06</d><h>00:46</h><w>cfleming</w>Hi everyone. I have an issue with an existing static website on S3 fronted by CloudFront. I’m migrating it to use CDK for deployment. I redirect www to apex domain, so I have both <a href="https://domain.com" target="_blank">https://domain.com</a> and <a href="https://www.domain.com" target="_blank">https://www.domain.com</a> buckets set up, and the www one redirects to the apex address. This all worked fine when set up manually but when deploying via CDK I get AccessDenied errors when accessing the www address. The apex one works fine.</z><z id="t1578278560" t="kenny Tangent: we switched from an s3 hosted website to Netlify and it&apos;s fantastic. Big win over s3."><y>#</y><d>2020-01-06</d><h>02:42</h><r>kenny</r>Tangent: we switched from an s3 hosted website to Netlify and it&apos;s fantastic. Big win over s3.</z><z id="t1578278804" t="cfleming I looked at Netlify, but I’d also have to migrate my lambda functions, Dynamo DB etc, it would end up being a pretty big rewrite. CDK actually makes AWS much more palatable once all the bits are figured out."><y>#</y><d>2020-01-06</d><h>02:46</h><r>cfleming</r>I looked at Netlify, but I’d also have to migrate my lambda functions, Dynamo DB etc, it would end up being a pretty big rewrite. CDK actually makes AWS much more palatable once all the bits are figured out.</z><z id="t1578278845" t="cfleming Plus I’m increasingly reluctant to build infrastructure on venture-backed startups. At least I know AWS isn’t going anywhere."><y>#</y><d>2020-01-06</d><h>02:47</h><r>cfleming</r>Plus I’m increasingly reluctant to build infrastructure on venture-backed startups. At least I know AWS isn’t going anywhere.</z><z id="t1578337762" t="kenny Haha that&apos;s fair. For us it&apos;s simply static website hosting -- no code changes needed. Switching Netlify &lt;-&gt; S3 would take no time at all. The automatic build previews and rollback features are fantastic."><y>#</y><d>2020-01-06</d><h>19:09</h><r>kenny</r>Haha that&apos;s fair. For us it&apos;s simply static website hosting -- no code changes needed. Switching Netlify &lt;-&gt; S3 would take no time at all. The automatic build previews and rollback features are fantastic.</z><z id="t1578342674" t="cfleming Yeah, I’ve heard nice things about Netlify from a few people now."><y>#</y><d>2020-01-06</d><h>20:31</h><r>cfleming</r>Yeah, I’ve heard nice things about Netlify from a few people now.</z><z id="t1578271796" t="cfleming The s3 bucket endpoint address looks like http://www.domain.com.s3-website-us-east-1.amazonaws.com . If I hit that address manually it works fine. However looking at the CloudFront configuration, the origin is being set up using an address like http://www.domain.com.s3.us-east-1.amazonaws.com - previously when I set CloudFront up by hand I used the endpoint address from the S3 console, and it all worked ok."><y>#</y><d>2020-01-06</d><h>00:49</h><w>cfleming</w>The s3 bucket endpoint address looks like <a href="http://www.domain.com.s3-website-us-east-1.amazonaws.com" target="_blank">http://www.domain.com.s3-website-us-east-1.amazonaws.com</a>. If I hit that address manually it works fine. However looking at the CloudFront configuration, the origin is being set up using an address like <a href="http://www.domain.com.s3.us-east-1.amazonaws.com" target="_blank">http://www.domain.com.s3.us-east-1.amazonaws.com</a> - previously when I set CloudFront up by hand I used the endpoint address from the S3 console, and it all worked ok.</z><z id="t1578272480" t="cfleming Actually, the origin address seems to be a red herring. The issue seems to be that the bucket is being treated as a content bucket even though the console says it’s configured to redirect all requests. But this only happens when I access it via CloudFront. Directly hitting the endpoint URL works."><y>#</y><d>2020-01-06</d><h>01:01</h><w>cfleming</w>Actually, the origin address seems to be a red herring. The issue seems to be that the bucket is being treated as a content bucket even though the console says it’s configured to redirect all requests. But this only happens when I access it via CloudFront. Directly hitting the endpoint URL works.</z><z id="t1578274915" t="cfleming Ok, TIL that S3 has a website mode and a REST mode, and that the REST mode doesn’t do website-like things such as redirects: https://stackoverflow.com/a/22750923"><y>#</y><d>2020-01-06</d><h>01:41</h><w>cfleming</w>Ok, TIL that S3 has a website mode and a REST mode, and that the REST mode doesn’t do website-like things such as redirects: <a href="https://stackoverflow.com/a/22750923" target="_blank">https://stackoverflow.com/a/22750923</a></z><z id="t1578775722" t="fmnoise hi everyone got some reflection warnings recently with [com.cognitect.aws/api &quot;0.8.408&quot;] Reflection warning, cognitect/aws/protocols/rest.clj:29:26 - call to method endsWith on java.lang.Object can&apos;t be resolved (no such method). Reflection warning, cognitect/aws/protocols/rest.clj:31:46 - call to method substring on java.lang.Object can&apos;t be resolved (no such method). Reflection warning, cognitect/aws/protocols/rest.clj:33:32 - call to method replace can&apos;t be resolved (target class is unknown). Reflection warning, cognitect/aws/protocols/rest.clj:34:32 - call to method replace can&apos;t be resolved (target class is unknown). Reflection warning, cognitect/aws/protocols/rest.clj:61:18 - call to method contains can&apos;t be resolved (target class is unknown)"><y>#</y><d>2020-01-11</d><h>20:48</h><w>fmnoise</w>hi everyone
got some reflection warnings recently with  <code>[com.cognitect.aws/api &quot;0.8.408&quot;]</code>
<pre>Reflection warning, cognitect/aws/protocols/rest.clj:29:26 - call to method endsWith on java.lang.Object can&apos;t be resolved (no such method).
Reflection warning, cognitect/aws/protocols/rest.clj:31:46 - call to method substring on java.lang.Object can&apos;t be resolved (no such method).
Reflection warning, cognitect/aws/protocols/rest.clj:33:32 - call to method replace can&apos;t be resolved (target class is unknown).
Reflection warning, cognitect/aws/protocols/rest.clj:34:32 - call to method replace can&apos;t be resolved (target class is unknown).
Reflection warning, cognitect/aws/protocols/rest.clj:61:18 - call to method contains can&apos;t be resolved (target class is unknown)</pre></z><z id="t1578909779" t="kirill.salykin hi, I am trying to upload big file (150mb) to the s3 using input-stream , but seems that it is being consumed into byte-array with cognitect.aws.util/input-stream-&gt;byte-array"><y>#</y><d>2020-01-13</d><h>10:02</h><w>kirill.salykin</w>hi,

I am trying to upload big file (150mb) to the s3 using <code>input-stream</code>, but seems that it is being consumed into byte-array with <code>cognitect.aws.util/input-stream-&gt;byte-array</code></z><z id="t1578909787" t="kirill.salykin is there a way to use stream?"><y>#</y><d>2020-01-13</d><h>10:03</h><w>kirill.salykin</w>is there a way to use stream?</z><z id="t1578909826" t="kirill.salykin (with-open [stream (io/input-stream tempfile)] let [response (aws/invoke s3 {:op :PutObject :request {:Bucket (:bucket (config/aws)) :Key bucket-key :ContentType content-type :ContentLength size :ACL &quot;public-read&quot; :Body stream}})])"><y>#</y><d>2020-01-13</d><h>10:03</h><w>kirill.salykin</w><pre>(with-open [stream (io/input-stream tempfile)]
                let [response (aws/invoke s3 {:op      :PutObject
                                               :request {:Bucket        (:bucket (config/aws))
                                                         :Key           bucket-key
                                                         :ContentType   content-type
                                                         :ContentLength size
                                                         :ACL           &quot;public-read&quot;
                                                         :Body          stream}})])</pre></z><z id="t1578909934" t="kirill.salykin Should I provide ByteBuffer to the s3 client?"><y>#</y><d>2020-01-13</d><h>10:05</h><w>kirill.salykin</w>Should I provide ByteBuffer to the s3 client?</z><z id="t1578916628" t="kirill.salykin I’ve tried with MappedByteBuffer - doesnt work (with-open [stream (.FileInputStream. tempfile)] (let [channel (.getChannel stream) buffer (.map channel java.nio.channels.FileChannel$MapMode/READ_ONLY 0 (.size channel)) response (aws/invoke s3 {:op :PutObject :request {:Bucket (:bucket (config/aws)) :Key bucket-key :ContentType content-type :ContentLength size :ACL &quot;public-read&quot; :Body buffer}})]))"><y>#</y><d>2020-01-13</d><h>11:57</h><w>kirill.salykin</w>I’ve tried with MappedByteBuffer - doesnt work
<pre>(with-open [stream (.FileInputStream. tempfile)]
                (let [channel  (.getChannel stream)
                      buffer   (.map channel java.nio.channels.FileChannel$MapMode/READ_ONLY 0 (.size channel))
                      response (aws/invoke s3 {:op      :PutObject
                                               :request {:Bucket        (:bucket (config/aws))
                                                         :Key           bucket-key
                                                         :ContentType   content-type
                                                         :ContentLength size
                                                         :ACL           &quot;public-read&quot;
                                                         :Body          buffer}})]))</pre></z><z id="t1578938364" t="kulminaator aws s3 expects big uploads to be happening in chunks"><y>#</y><d>2020-01-13</d><h>17:59</h><w>kulminaator</w>aws s3 expects big uploads to be happening in chunks</z><z id="t1578938389" t="kulminaator not as one long long stream (if you put yourself in their shoes you wouldn&apos;t want to wait for long and possibly slow uploads either)"><y>#</y><d>2020-01-13</d><h>17:59</h><w>kulminaator</w>not as one long long stream (if you put yourself in their shoes you wouldn&apos;t want to wait for long and possibly slow uploads either)</z><z id="t1578938408" t="kulminaator see multipart upload docs , i think you should rather refer to that ..."><y>#</y><d>2020-01-13</d><h>18:00</h><w>kulminaator</w>see multipart upload docs , i think you should rather refer to that ...</z><z id="t1578970314" t="kennytilton Anyone using Amazonica with localstack? It seems to work well for the first few simple things I have tried, but list-buckets seems to have a problem returning info. At startup when the result is empty [], all goes well. After creating a bucket I get: Invalid format: &quot;2020-01-14 02:45:53.833082&quot; is malformed at &quot; 02:45:53.833082&quot; Any insights are welcome! Thx."><y>#</y><d>2020-01-14</d><h>02:51</h><w>kennytilton</w>Anyone using Amazonica with localstack? It seems to work well for the first few simple things I have tried, but <code>list-buckets</code> seems to have a problem returning info. At startup when the result is empty [], all goes well. After creating a bucket I get:
<pre>Invalid format: &quot;2020-01-14 02:45:53.833082&quot; is malformed at &quot; 02:45:53.833082&quot;</pre>
Any insights are welcome! Thx.</z><z id="t1578971232" t="hiredman https://github.com/localstack/localstack/issues/1899 appears to be a known issue with localstack"><y>#</y><d>2020-01-14</d><h>03:07</h><w>hiredman</w><a href="https://github.com/localstack/localstack/issues/1899" target="_blank">https://github.com/localstack/localstack/issues/1899</a> appears to be a known issue with localstack</z><z id="t1578972297" t="kennytilton Oh, wow, I missed that. Thx!"><y>#</y><d>2020-01-14</d><h>03:24</h><w>kennytilton</w>Oh, wow, I missed that. Thx!</z><z id="t1579076278" t="viesti Re: AWS S3 big files. I&apos;ve seen multi gigabyte objects uploads, so single large files can be done, but the size of the object needs to be known beforehand, which might be a reason that libs tend to keep the data in memory"><y>#</y><d>2020-01-15</d><h>08:17</h><w>viesti</w>Re: AWS S3 big files. I&apos;ve seen multi gigabyte objects uploads, so single large files can be done, but the size of the object needs to be known beforehand, which might be a reason that libs tend to keep the data in memory</z><z id="t1579078677" t="jsyrjala I think that S3 has limit of 5G for file transfer in one request. If the file is bigger than that then you must use multipart upload."><y>#</y><d>2020-01-15</d><h>08:57</h><r>jsyrjala</r>I think that S3 has limit of 5G for file transfer  in one request. If the file is bigger than that then you must use multipart upload.</z><z id="t1579109461" t="viesti yeah, I think the limit used to be lower, but got raised at some point"><y>#</y><d>2020-01-15</d><h>17:31</h><r>viesti</r>yeah, I think the limit used to be lower, but got raised at some point</z><z id="t1579076303" t="viesti for multipart uploads, the size of the part needs probably be known beforehand"><y>#</y><d>2020-01-15</d><h>08:18</h><w>viesti</w>for multipart uploads, the size of the part needs probably be known beforehand</z><z id="t1579076457" t="viesti the Java libs have a nice TransferManager, that can do parallel multipart downloads, if the object was uploaded in multipart fashion"><y>#</y><d>2020-01-15</d><h>08:20</h><w>viesti</w>the Java libs have a nice TransferManager, that can do parallel multipart downloads, if the object was uploaded in multipart fashion</z><z id="t1579076467" t="viesti would be need to add such support for aws-api too 🙂"><y>#</y><d>2020-01-15</d><h>08:21</h><w>viesti</w>would be need to add such support for aws-api too <b>🙂</b></z><z id="t1579078741" t="jsyrjala https://github.com/cognitect-labs/aws-api/issues/107"><y>#</y><d>2020-01-15</d><h>08:59</h><r>jsyrjala</r><a href="https://github.com/cognitect-labs/aws-api/issues/107" target="_blank">https://github.com/cognitect-labs/aws-api/issues/107</a></z><z id="t1579109422" t="viesti so we need a name for a support lib :)"><y>#</y><d>2020-01-15</d><h>17:30</h><r>viesti</r>so we need a name for a support lib :)</z><z id="t1579077268" t="jsyrjala If I remember correclty current aws-api wants to keep the whole file in memory at least when downloading. http client used by aws-api does not support streaming. amazon java sdk do not have that limitation."><y>#</y><d>2020-01-15</d><h>08:34</h><w>jsyrjala</w>If I remember correclty current aws-api wants to keep the whole file in memory at least when downloading. http client used by aws-api does not support streaming. amazon java sdk do not have that limitation.</z><z id="t1579077982" t="kirill.salykin Indeed, with java sdk it doesnt keep all content in memory during upload"><y>#</y><d>2020-01-15</d><h>08:46</h><r>kirill.salykin</r>Indeed, with java sdk it doesnt keep all content in memory during upload</z><z id="t1579078911" t="steveb8n what would go around all this big file stuff would be support for pre-signed upload requests in the aws-api client. I’m hoping to see this soon"><y>#</y><d>2020-01-15</d><h>09:01</h><w>steveb8n</w>what would go around all this big file stuff would be support for pre-signed upload requests in the aws-api client. I’m hoping to see this soon</z><z id="t1579100309" t="Linus Ericsson Dito. I think the new SDK for Java (from Aws) will solve this, but maybe It’s just wishful thinking."><y>#</y><d>2020-01-15</d><h>14:58</h><r>Linus Ericsson</r>Dito. I think the new SDK for Java (from Aws) will solve this, but maybe It’s just wishful thinking.</z><z id="t1579109576" t="viesti the bring-your-own http client will help :)"><y>#</y><d>2020-01-15</d><h>17:32</h><w>viesti</w>the bring-your-own http client will help :)</z><z id="t1579109747" t="ghadi [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] [:attrs {:href &quot;/_/_/users/U1G5P6G0L&quot;}] multipart uploads are already supported. Call the various Multipart operations with your input split into chunks downloading large files is problematic because of no streaming"><y>#</y><d>2020-01-15</d><h>17:35</h><w>ghadi</w><a>@viesti</a> <a>@jsyrjala</a> multipart uploads are already supported.  Call the various Multipart operations with your input split into chunks

downloading large files is problematic because of no streaming</z><z id="t1579109811" t="ghadi CreateMultipartUpload -&gt; UploadPart (many, you can do it concurrently) -&gt; CompleteMultipartUpload"><y>#</y><d>2020-01-15</d><h>17:36</h><w>ghadi</w>CreateMultipartUpload -&gt; UploadPart (many, you can do it concurrently) -&gt; CompleteMultipartUpload</z><z id="t1579110911" t="hiredman we have some code at work to do this for staging build artifacts. reduces over the chunks of a file, starts a future uploading a part for each one, then waits for all the futures to complete and completes the multipart upload. works great."><y>#</y><d>2020-01-15</d><h>17:55</h><r>hiredman</r>we have some code at work to do this  for staging build artifacts. reduces over the chunks of a file, starts a future uploading a part for each one, then waits for all the futures to complete and completes the multipart upload. works great.</z><z id="t1579109857" t="viesti ah, true"><y>#</y><d>2020-01-15</d><h>17:37</h><w>viesti</w>ah, true</z><z id="t1579109913" t="viesti have used only multipart download via the java libs in the past, since had a Redshift cluster write data to S3 in parallel :)"><y>#</y><d>2020-01-15</d><h>17:38</h><w>viesti</w>have used only multipart download via the java libs in the past, since had a Redshift cluster write data to S3 in parallel :)</z><z id="t1579109948" t="ghadi there is no multipart download"><y>#</y><d>2020-01-15</d><h>17:39</h><w>ghadi</w>there is no multipart download</z><z id="t1579109957" t="viesti yup"><y>#</y><d>2020-01-15</d><h>17:39</h><w>viesti</w>yup</z><z id="t1579109968" t="ghadi you can do byte range requests on S3 objects in parallel, though. Similar effect 🙂"><y>#</y><d>2020-01-15</d><h>17:39</h><w>ghadi</w>you can do byte range requests on S3 objects in parallel, though. Similar effect <b>🙂</b></z><z id="t1579109974" t="viesti got carried away remembering old project :)"><y>#</y><d>2020-01-15</d><h>17:39</h><w>viesti</w>got carried away remembering old project :)</z><z id="t1579109983" t="viesti nice point"><y>#</y><d>2020-01-15</d><h>17:39</h><w>viesti</w>nice point</z><z id="t1579110011" t="ghadi we&apos;ve thought about some &quot;userspace helpers&quot; for aws-api, like paginators, etc. but so far we&apos;re focusing on the raw operations"><y>#</y><d>2020-01-15</d><h>17:40</h><w>ghadi</w>we&apos;ve thought about some &quot;userspace helpers&quot; for aws-api, like paginators, etc. but so far we&apos;re focusing on the raw operations</z><z id="t1579110056" t="ghadi (presigning URLs is in that ballpark too)"><y>#</y><d>2020-01-15</d><h>17:40</h><w>ghadi</w>(presigning URLs is in that ballpark too)</z><z id="t1579110096" t="viesti if there would be 3rd psrty &quot;userspace&quot; libs, would it be ok to use aws-api as name prefix?"><y>#</y><d>2020-01-15</d><h>17:41</h><w>viesti</w>if there would be 3rd psrty &quot;userspace&quot; libs, would it be ok to use aws-api as name prefix?</z><z id="t1579110124" t="ghadi I can&apos;t stop you, but viesti.aws-api would be better 🙂"><y>#</y><d>2020-01-15</d><h>17:42</h><w>ghadi</w>I can&apos;t stop you, but viesti.aws-api would be better <b>🙂</b></z><z id="t1579110132" t="viesti :D"><y>#</y><d>2020-01-15</d><h>17:42</h><w>viesti</w>:D</z><z id="t1579110161" t="viesti liking that already :)"><y>#</y><d>2020-01-15</d><h>17:42</h><w>viesti</w>liking that already :)</z><z id="t1579110196" t="viesti would have to do some explaining on that particular name though :)"><y>#</y><d>2020-01-15</d><h>17:43</h><w>viesti</w>would have to do some explaining on that particular name though :)</z><z id="t1579173221" t="Kari Marttila (require &apos;[cognitect.aws.client.api :as aws]) (def kafka-client (aws/client {:api :kafka})) (aws/invoke kafka-client {:op :ListClusters } ) =&gt; {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error{:cause &quot;Unparseable date: \&quot;2020-01-13T12:45:44.63Z\&quot;&quot;, :via [{:type java.text.ParseException, :message &quot;Unparseable date: \&quot;2020-01-13T12:45:44.63Z\&quot;&quot;, ... Is this some known issue?"><y>#</y><d>2020-01-16</d><h>11:13</h><w>Kari Marttila</w><pre>(require &apos;[cognitect.aws.client.api :as aws])
(def kafka-client (aws/client {:api :kafka}))
(aws/invoke kafka-client {:op :ListClusters } )
=&gt;
{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error{:cause &quot;Unparseable date: \&quot;2020-01-13T12:45:44.63Z\&quot;&quot;,
                                        :via [{:type java.text.ParseException,
                                               :message &quot;Unparseable date: \&quot;2020-01-13T12:45:44.63Z\&quot;&quot;,
...</pre>
Is this some known issue?</z><z id="t1579174056" t="Kari Marttila (aws/invoke kafka-client {:op :DescribeCluster :request {:ClusterArn &quot;arn:aws:kafka:eu-west-1:99999999:cluster/MY-SECRET-MSK-NAME/999999999999&quot;}} ) =&gt; {:message &quot;The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details. (anonymized the arn a bit above, in my REPL the arn is right, AWS_PROFILE is fine (the same credentials work e.g. with cognitect aws kinesis client just fine...)"><y>#</y><d>2020-01-16</d><h>11:27</h><r>Kari Marttila</r><pre>(aws/invoke kafka-client {:op :DescribeCluster :request {:ClusterArn &quot;arn:aws:kafka:eu-west-1:99999999:cluster/MY-SECRET-MSK-NAME/999999999999&quot;}} )
=&gt;
{:message &quot;The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.</pre>
(anonymized the arn a bit above, in my REPL the arn is right, AWS_PROFILE is fine (the same credentials work e.g. with cognitect aws kinesis client just fine...)</z><z id="t1579283521" t="grounded_sage Execution error (FileNotFoundException) at cognitect.aws.dynaload/load-ns (dynaload.clj:8). Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath. class clojure.lang.Compiler$CompilerException I&apos;m getting this error from aws-api"><y>#</y><d>2020-01-17</d><h>17:52</h><w>grounded_sage</w><pre>Execution error (FileNotFoundException) at cognitect.aws.dynaload/load-ns (dynaload.clj:8).
Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath.
class clojure.lang.Compiler$CompilerException</pre>
I&apos;m getting this error from <code>aws-api</code></z><z id="t1579284224" t="ghadi Paste a full trace in a snippet please [:attrs {:href &quot;/_/_/users/U05095F2K&quot;}] "><y>#</y><d>2020-01-17</d><h>18:03</h><w>ghadi</w>Paste a full trace in a snippet please <a>@grounded_sage</a> </z><z id="t1579284289" t="grounded_sage [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] updated the snippet."><y>#</y><d>2020-01-17</d><h>18:04</h><w>grounded_sage</w><a>@ghadi</a> updated the snippet.</z><z id="t1579284324" t="ghadi need a full stacktrace please"><y>#</y><d>2020-01-17</d><h>18:05</h><w>ghadi</w>need a full stacktrace please</z><z id="t1579284337" t="ghadi or the output of *e"><y>#</y><d>2020-01-17</d><h>18:05</h><w>ghadi</w>or the output of <code>*e</code></z><z id="t1579284422" t="ghadi also, what was called to create a client?"><y>#</y><d>2020-01-17</d><h>18:07</h><w>ghadi</w>also, what was called to create a client?</z><z id="t1579284621" t="grounded_sage (def kms (aws/client {:api :kms :region &quot;&quot; :credentials-provider (credentials/basic-credentials-provider {:access-key-id &quot;&quot; :secret-access-key &quot;&quot;})})) "><y>#</y><d>2020-01-17</d><h>18:10</h><w>grounded_sage</w><pre>(def kms (aws/client {:api                   :kms
                      :region               &quot;&quot;
                      :credentials-provider (credentials/basic-credentials-provider
                                               {:access-key-id     &quot;&quot;
                                                :secret-access-key &quot;&quot;})}))</pre>
</z><z id="t1579284652" t="grounded_sage I&apos;m doing stuff in the REPL. Where do I put *e ?"><y>#</y><d>2020-01-17</d><h>18:10</h><w>grounded_sage</w>I&apos;m doing stuff in the REPL. Where do I put <code>*e</code> ?</z><z id="t1579284666" t="ghadi in the repl when you get an error"><y>#</y><d>2020-01-17</d><h>18:11</h><w>ghadi</w>in the repl when you get an error</z><z id="t1579284673" t="ghadi you can get the full trace with *e"><y>#</y><d>2020-01-17</d><h>18:11</h><w>ghadi</w>you can get the full trace with <code>*e</code></z><z id="t1579284681" t="ghadi or (prn *e)"><y>#</y><d>2020-01-17</d><h>18:11</h><w>ghadi</w>or <code>(prn *e)</code></z><z id="t1579284705" t="ghadi need versions of api + endpoints + kms dep"><y>#</y><d>2020-01-17</d><h>18:11</h><w>ghadi</w>need versions of api + endpoints + kms dep</z><z id="t1579284780" t="grounded_sage #error { :cause &quot;Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath.&quot; :via [{:type clojure.lang.Compiler$CompilerException :message &quot;Syntax error macroexpanding at (NO_SOURCE_FILE:1:10).&quot; :data #:clojure.error{:phase :execution, :line 1, :column 10, :source &quot;NO_SOURCE_FILE&quot;} :at [clojure.lang.Compiler$InvokeExpr eval &quot;Compiler.java&quot; 3707]} {:type .FileNotFoundException :message &quot;Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath.&quot; :at [clojure.lang.RT load &quot;RT.java&quot; 462]}] :trace [[clojure.lang.RT load &quot;RT.java&quot; 462] [clojure.lang.RT load &quot;RT.java&quot; 424] [clojure.core$load$fn__6839 invoke &quot;core.clj&quot; 6126] [clojure.core$load invokeStatic &quot;core.clj&quot; 6125] [clojure.core$load doInvoke &quot;core.clj&quot; 6109] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 408] [clojure.core$load_one invokeStatic &quot;core.clj&quot; 5908] [clojure.core$loa d_one invoke &quot;core.clj&quot; 5903] [clojure.core$load_lib$fn__6780 invoke &quot;core.clj&quot; 5948] [clojure.core$load_lib invokeStatic &quot;core.clj&quot; 5947] [clojure.core$load_lib doInvoke &quot;core.clj&quot; 5928] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 142] [clojure.core$apply invokeStatic &quot;core.clj&quot; 667] [clojure.core$load_libs invokeStatic &quot;core.clj&quot; 5985] [clojure.core$load_libs doInvoke &quot;core.clj&quot; 5969] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 137] [clojure.core$apply invokeStatic &quot;core.clj&quot; 667] [clojure.core$require invokeStatic &quot;core.clj&quot; 6007] [clojure.core$require doInvoke &quot;core.clj&quot; 6007] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 408] [cognitect.aws.dynaload$load_ns invokeStatic &quot;dynaload.clj&quot; 8] [cognitect.aws.dynaload$load_ns invoke &quot;dynaload.clj&quot; 5] [cognitect.aws.client.api$client invokeStatic &quot;api.clj&quot; 78] [cognitect.aws.client.api$client invoke &quot;api.clj&quot; 23] [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 154] [clojure.lang.AFn applyTo &quot;AFn.java&quot; 144] [clojure.lang.Compiler$Invoke Expr eval &quot;Compiler.java&quot; 3702] [clojure.lang.Compiler$DefExpr eval &quot;Compiler.java&quot; 457] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7182] [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7132] [clojure.core$eval invokeStatic &quot;core.clj&quot; 3214] [clojure.core$eval invoke &quot;core.clj&quot; 3210] [clojure.main$repl$read_eval_print__9086$fn__9089 invoke &quot;main.clj&quot; 437] [clojure.main$repl$read_eval_print__9086 invoke &quot;main.clj&quot; 437] [clojure.main$repl$fn__9095 invoke &quot;main.clj&quot; 458] [clojure.main$repl invokeStatic &quot;main.clj&quot; 458] [clojure.main$repl doInvoke &quot;main.clj&quot; 368] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 1523] [nrepl.middleware.interruptible_eval$evaluate invokeStatic &quot;interruptible_eval.clj&quot; 79] [nrepl.middleware.interruptible_eval$evaluate invoke &quot;interruptible_eval.clj&quot; 55] [nrepl.middleware.interruptible_eval$interruptible_eval$fn__935$fn__939 invoke &quot;interruptible_eval.clj&quot; 142] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [nrepl.middleware.session$session_exec$main_loop__1036$fn__1040 inv oke &quot;session.clj&quot; 171] [nrepl.middleware.session$session_exec$main_loop__1036 invoke &quot;session.clj&quot; 170] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.lang.Thread run &quot;Thread.java&quot; 834]]}"><y>#</y><d>2020-01-17</d><h>18:13</h><w>grounded_sage</w><pre>#error {
 :cause &quot;Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath.&quot;
 :via
 [{:type clojure.lang.Compiler$CompilerException
   :message &quot;Syntax error macroexpanding at (NO_SOURCE_FILE:1:10).&quot;
   :data #:clojure.error{:phase :execution, :line 1, :column 10, :source &quot;NO_SOURCE_FILE&quot;}
   :at [clojure.lang.Compiler$InvokeExpr eval &quot;Compiler.java&quot; 3707]}
  {:type .FileNotFoundException
   :message &quot;Could not locate cognitect/aws/protocols/__init.class, cognitect/aws/protocols/.clj or cognitect/aws/protocols/.cljc on classpath.&quot;
   :at [clojure.lang.RT load &quot;RT.java&quot; 462]}]
 :trace
 [[clojure.lang.RT load &quot;RT.java&quot; 462]
  [clojure.lang.RT load &quot;RT.java&quot; 424]
  [clojure.core$load$fn__6839 invoke &quot;core.clj&quot; 6126]
  [clojure.core$load invokeStatic &quot;core.clj&quot; 6125]
  [clojure.core$load doInvoke &quot;core.clj&quot; 6109]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 408]
  [clojure.core$load_one invokeStatic &quot;core.clj&quot; 5908]
  [clojure.core$loa
d_one invoke &quot;core.clj&quot; 5903]
  [clojure.core$load_lib$fn__6780 invoke &quot;core.clj&quot; 5948]
  [clojure.core$load_lib invokeStatic &quot;core.clj&quot; 5947]
  [clojure.core$load_lib doInvoke &quot;core.clj&quot; 5928]
  [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 142]
  [clojure.core$apply invokeStatic &quot;core.clj&quot; 667]
  [clojure.core$load_libs invokeStatic &quot;core.clj&quot; 5985]
  [clojure.core$load_libs doInvoke &quot;core.clj&quot; 5969]
  [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 137]
  [clojure.core$apply invokeStatic &quot;core.clj&quot; 667]
  [clojure.core$require invokeStatic &quot;core.clj&quot; 6007]
  [clojure.core$require doInvoke &quot;core.clj&quot; 6007]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 408]
  [cognitect.aws.dynaload$load_ns invokeStatic &quot;dynaload.clj&quot; 8]
  [cognitect.aws.dynaload$load_ns invoke &quot;dynaload.clj&quot; 5]
  [cognitect.aws.client.api$client invokeStatic &quot;api.clj&quot; 78]
  [cognitect.aws.client.api$client invoke &quot;api.clj&quot; 23]
  [clojure.lang.AFn applyToHelper &quot;AFn.java&quot; 154]
  [clojure.lang.AFn applyTo &quot;AFn.java&quot; 144]
  [clojure.lang.Compiler$Invoke
Expr eval &quot;Compiler.java&quot; 3702]
  [clojure.lang.Compiler$DefExpr eval &quot;Compiler.java&quot; 457]
  [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7182]
  [clojure.lang.Compiler eval &quot;Compiler.java&quot; 7132]
  [clojure.core$eval invokeStatic &quot;core.clj&quot; 3214]
  [clojure.core$eval invoke &quot;core.clj&quot; 3210]
  [clojure.main$repl$read_eval_print__9086$fn__9089 invoke &quot;main.clj&quot; 437]
  [clojure.main$repl$read_eval_print__9086 invoke &quot;main.clj&quot; 437]
  [clojure.main$repl$fn__9095 invoke &quot;main.clj&quot; 458]
  [clojure.main$repl invokeStatic &quot;main.clj&quot; 458]
  [clojure.main$repl doInvoke &quot;main.clj&quot; 368]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 1523]
  [nrepl.middleware.interruptible_eval$evaluate invokeStatic &quot;interruptible_eval.clj&quot; 79]
  [nrepl.middleware.interruptible_eval$evaluate invoke &quot;interruptible_eval.clj&quot; 55]
  [nrepl.middleware.interruptible_eval$interruptible_eval$fn__935$fn__939 invoke &quot;interruptible_eval.clj&quot; 142]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [nrepl.middleware.session$session_exec$main_loop__1036$fn__1040 inv
oke &quot;session.clj&quot; 171]
  [nrepl.middleware.session$session_exec$main_loop__1036 invoke &quot;session.clj&quot; 170]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.lang.Thread run &quot;Thread.java&quot; 834]]}</pre></z><z id="t1579284866" t="grounded_sage I&apos;ve also got an empty service.edn file.. I don&apos;t know what is supposed to be in there. The documentation is a bit sparse for a beginner on AWS stuff."><y>#</y><d>2020-01-17</d><h>18:14</h><w>grounded_sage</w>I&apos;ve also got an empty <code>service.edn</code>  file.. I don&apos;t know what is supposed to be in there. The documentation is a bit sparse for a beginner on AWS stuff.</z><z id="t1579284893" t="ghadi need the versions please"><y>#</y><d>2020-01-17</d><h>18:14</h><w>ghadi</w>need the versions please</z><z id="t1579284907" t="ghadi service.edn should come from the maven dependency automatically"><y>#</y><d>2020-01-17</d><h>18:15</h><w>ghadi</w>service.edn should come from the maven dependency automatically</z><z id="t1579284927" t="grounded_sage com.cognitect.aws/api {:mvn/version &quot;0.8.408&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.705&quot;} com.cognitect.aws/s3 {:mvn/version &quot;784.2.593.0&quot;} "><y>#</y><d>2020-01-17</d><h>18:15</h><w>grounded_sage</w><pre>com.cognitect.aws/api       {:mvn/version &quot;0.8.408&quot;}
  com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.705&quot;}
  com.cognitect.aws/s3        {:mvn/version &quot;784.2.593.0&quot;}</pre>
</z><z id="t1579284933" t="grounded_sage It wasn&apos;t...."><y>#</y><d>2020-01-17</d><h>18:15</h><w>grounded_sage</w>It wasn&apos;t....</z><z id="t1579284935" t="ghadi no kms dependency?"><y>#</y><d>2020-01-17</d><h>18:15</h><w>ghadi</w>no kms dependency?</z><z id="t1579284961" t="ghadi you&apos;re creating a client for kms"><y>#</y><d>2020-01-17</d><h>18:16</h><w>ghadi</w>you&apos;re creating a client for kms</z><z id="t1579284988" t="grounded_sage I was just following this and just trying to get something running https://github.com/cognitect-labs/aws-api#credentials"><y>#</y><d>2020-01-17</d><h>18:16</h><w>grounded_sage</w>I was just following this and just trying to get something running <a href="https://github.com/cognitect-labs/aws-api#credentials" target="_blank">https://github.com/cognitect-labs/aws-api#credentials</a></z><z id="t1579285036" t="ghadi so you need two dependencies for anything /api and /endpoints"><y>#</y><d>2020-01-17</d><h>18:17</h><w>ghadi</w>so you need two dependencies for anything /api and /endpoints</z><z id="t1579285039" t="grounded_sage The repl runs fine on my machine where I have aws cli and set up the aws config . I was able to poke around at the buckets with the repl. Now I am trying to get it working on a remote server and am lost."><y>#</y><d>2020-01-17</d><h>18:17</h><w>grounded_sage</w>The repl runs fine on my machine where I have <code>aws cli</code> and set up the <code>aws config</code> . I was able to poke around at the buckets with the repl. Now I am trying to get it working on a remote server and am lost.</z><z id="t1579285049" t="ghadi then you need a dependency for the service you&apos;re trying to hit"><y>#</y><d>2020-01-17</d><h>18:17</h><w>ghadi</w>then you need a dependency for the service you&apos;re trying to hit</z><z id="t1579285052" t="ghadi in this case /kms"><y>#</y><d>2020-01-17</d><h>18:17</h><w>ghadi</w>in this case /kms</z><z id="t1579285089" t="ghadi the readme is more of an overview than a walkthrough guide"><y>#</y><d>2020-01-17</d><h>18:18</h><w>ghadi</w>the readme is more of an overview than a walkthrough guide</z><z id="t1579285103" t="ghadi com.cognitect.aws/kms {:mvn/version &quot;782.2.586.0&quot;} is what I used for the kms service"><y>#</y><d>2020-01-17</d><h>18:18</h><w>ghadi</w><pre>com.cognitect.aws/kms        {:mvn/version         &quot;782.2.586.0&quot;}</pre>
is what I used for the kms service</z><z id="t1579285119" t="ghadi https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2020-01-17</d><h>18:18</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1579285131" t="ghadi has all the latest versions of each api"><y>#</y><d>2020-01-17</d><h>18:18</h><w>ghadi</w>has all the latest versions of each api</z><z id="t1579285193" t="grounded_sage Yea I don&apos;t even know what the kms was until recently."><y>#</y><d>2020-01-17</d><h>18:19</h><w>grounded_sage</w>Yea I don&apos;t even know what the kms was until recently.</z><z id="t1579285208" t="grounded_sage Was wondering if it needed to actually be ec2 ?"><y>#</y><d>2020-01-17</d><h>18:20</h><w>grounded_sage</w>Was wondering if it needed to actually be <code>ec2</code> ?</z><z id="t1579285249" t="ghadi it could be any service you have a dependency to"><y>#</y><d>2020-01-17</d><h>18:20</h><w>ghadi</w>it could be any service you have a dependency to</z><z id="t1579285283" t="ghadi that section of the readme is trying to show how to use create a client with credentials"><y>#</y><d>2020-01-17</d><h>18:21</h><w>ghadi</w>that section of the readme is trying to show how to use create a client with credentials</z><z id="t1579285292" t="ghadi we can make it clearer"><y>#</y><d>2020-01-17</d><h>18:21</h><w>ghadi</w>we can make it clearer</z><z id="t1579285379" t="grounded_sage Ok so I have the kms dependency now. Do I need to require it?"><y>#</y><d>2020-01-17</d><h>18:22</h><w>grounded_sage</w>Ok so I have the kms dependency now. Do I need to require it?</z><z id="t1579285439" t="ghadi no"><y>#</y><d>2020-01-17</d><h>18:23</h><w>ghadi</w>no</z><z id="t1579285450" t="ghadi just run what you were running before"><y>#</y><d>2020-01-17</d><h>18:24</h><w>ghadi</w>just run what you were running before</z><z id="t1579285856" t="grounded_sage Compiling now 🙂 Still got to test if it works but it&apos;s looking good so far"><y>#</y><d>2020-01-17</d><h>18:30</h><w>grounded_sage</w>Compiling now <b>🙂</b> Still got to test if it works but it&apos;s looking good so far</z><z id="t1579286278" t="grounded_sage I&apos;m getting back this. {:Error {:HostIdAttrs {}, :Message &quot;The AWS Access Key Id you provided does not exist in our records.&quot;, :CodeAttrs {}, :RequestIdAttrs {}, :HostId &quot;.....&quot;, :MessageAttrs {}, :RequestId &quot;.....&quot;, :Code &quot;InvalidAccessKeyId&quot;, :AWSAccessKeyIdAttrs {}, :AWSAccessKeyId &quot;null&quot;}, :ErrorAttrs {}, :cognitect.anomalies/category :cognitect.anomalies/forbidden}"><y>#</y><d>2020-01-17</d><h>18:37</h><w>grounded_sage</w>I&apos;m getting back this.
<pre>{:Error
 {:HostIdAttrs {},
  :Message &quot;The AWS Access Key Id you provided does not exist in our records.&quot;,
  :CodeAttrs {},
  :RequestIdAttrs {},
  :HostId &quot;.....&quot;,
  :MessageAttrs {},
  :RequestId &quot;.....&quot;,
  :Code &quot;InvalidAccessKeyId&quot;,
  :AWSAccessKeyIdAttrs {},
  :AWSAccessKeyId &quot;null&quot;},
 :ErrorAttrs {},
 :cognitect.anomalies/category :cognitect.anomalies/forbidden}</pre></z><z id="t1579286322" t="grounded_sage Do I have to provide a :user-name ?"><y>#</y><d>2020-01-17</d><h>18:38</h><w>grounded_sage</w>Do I have to provide a <code>:user-name</code>  ?</z><z id="t1579286356" t="ghadi Check for a typo in your credentials "><y>#</y><d>2020-01-17</d><h>18:39</h><w>ghadi</w>Check for a typo in your credentials </z><z id="t1579286387" t="grounded_sage It&apos;s strange. I did a straight copy and paste from the same thing I have on my machine."><y>#</y><d>2020-01-17</d><h>18:39</h><w>grounded_sage</w>It&apos;s strange. I did a straight copy and paste from the same thing I have on my machine.</z><z id="t1579287681" t="grounded_sage Thank you for your help [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] !"><y>#</y><d>2020-01-17</d><h>19:01</h><w>grounded_sage</w>Thank you for your help <a>@ghadi</a> !</z><z id="t1579616909" t="dchelimsky For those of you using aws-api, we&apos;re planning improvements to resource management in the next release. By default, all aws-clients in a process will share a single http-client, region-provider and credentials-provider. This alleviates the need to manually share these resources across aws clients to keep the thread count low, and also reduces the number of http calls for fetching region and credentials (when running in AWS) to 1 each per refresh cycle. If anybody is interested in trying it out, set your dep to com.cognitect.aws/api {:git/url &quot;&quot; :sha &quot;2fe2c6b2219b1d18355160c46d8585fda6994ffa&quot;}"><y>#</y><d>2020-01-21</d><h>14:28</h><w>dchelimsky</w>For those of you using aws-api, we&apos;re planning improvements to resource management in the next release. By default, all aws-clients in a process will share a single http-client, region-provider and credentials-provider. This alleviates the need to manually share these resources across aws clients to keep the thread count low, and also reduces the number of http calls for fetching region and credentials (when running in AWS) to 1 each per refresh cycle. If anybody is interested in trying it out, set your dep to
<pre>com.cognitect.aws/api {:git/url &quot;&quot; :sha &quot;2fe2c6b2219b1d18355160c46d8585fda6994ffa&quot;}</pre></z><z id="t1579616961" t="dchelimsky Please report back here (@ dchelimsky, please) if you have any issues (and if you don&apos;t!). Thanks!"><y>#</y><d>2020-01-21</d><h>14:29</h><w>dchelimsky</w>Please report back here (@ dchelimsky, please) if you have any issues (and if you don&apos;t!). Thanks!</z><z id="t1579705447" t="dchelimsky I&apos;m glad to be seeing some :thumbsup: s, but I don&apos;t know if that&apos;s because you like the idea or you&apos;ve checked it out. If you&apos;ve checked it out and it&apos;s working well for you, please let me know (either say so or give me a ✅ on the message above). Thanks!"><y>#</y><d>2020-01-22</d><h>15:04</h><w>dchelimsky</w>I&apos;m glad to be seeing some <b>:thumbsup:</b> s, but I don&apos;t know if that&apos;s because you like the idea or you&apos;ve checked it out. If you&apos;ve checked it out and it&apos;s working well for you, please let me know (either say so or give me a <b>✅</b> on the message above). Thanks!</z><z id="t1579709975" t="orestis I’m happy to test, I guess the main thing is if my code creates two different clients (e.g. one Route53 and one Cloudwatch) and things keep working, right? I don’t have much instrumentation in this code about threads so I wouldn’t know where to look. "><y>#</y><d>2020-01-22</d><h>16:19</h><r>orestis</r>I’m happy to test, I guess the main thing is if my code creates two different clients (e.g. one Route53 and one Cloudwatch) and things keep working, right? I don’t have much instrumentation in this code about threads so I wouldn’t know where to look. </z><z id="t1579712096" t="dchelimsky Any explicit feedback is helpful at this point, so yes, please! Don&apos;t worry about instrumentation."><y>#</y><d>2020-01-22</d><h>16:54</h><r>dchelimsky</r>Any explicit feedback is helpful at this point, so yes, please! Don&apos;t worry about instrumentation.</z><z id="t1579717877" t="chrisulloa Planning to test this later today and give some feedback."><y>#</y><d>2020-01-22</d><h>18:31</h><r>chrisulloa</r>Planning to test this later today and give some feedback.</z><z id="t1579719201" t="dchelimsky Thanks [:attrs {:href &quot;/_/_/users/UDBM9Q0VC&quot;}]"><y>#</y><d>2020-01-22</d><h>18:53</h><r>dchelimsky</r>Thanks <a>@UDBM9Q0VC</a></z><z id="t1579729901" t="kenny Is there some way to add middleware to a client? If a request fails, I&apos;d like to include the &quot;x-amzn-requestid&quot; header in the resulting anomaly."><y>#</y><d>2020-01-22</d><h>21:51</h><w>kenny</w>Is there some way to add middleware to a client? If a request fails, I&apos;d like to include the <code>&quot;x-amzn-requestid&quot;</code> header in the resulting anomaly.</z><z id="t1579730402" t="ghadi the metadata of the response should have a key :http-response with all the relevant details [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}]"><y>#</y><d>2020-01-22</d><h>22:00</h><w>ghadi</w>the metadata of the response should have a key <code>:http-response</code> with all the relevant details <a>@kenny</a></z><z id="t1579730423" t="kenny Yes. I&apos;d like to always attach the request-id header if the request resulted in an anomaly."><y>#</y><d>2020-01-22</d><h>22:00</h><w>kenny</w>Yes. I&apos;d like to always attach the request-id header if the request resulted in an anomaly.</z><z id="t1579730449" t="kenny The only obvious way to do that right now is to write my own invoke function and use that everywhere."><y>#</y><d>2020-01-22</d><h>22:00</h><w>kenny</w>The only obvious way to do that right now is to write my own invoke function and use that everywhere.</z><z id="t1579730526" t="ghadi that seems like the right thing to do"><y>#</y><d>2020-01-22</d><h>22:02</h><w>ghadi</w>that seems like the right thing to do</z><z id="t1579730557" t="ghadi the data is already exposed"><y>#</y><d>2020-01-22</d><h>22:02</h><w>ghadi</w>the data is already exposed</z><z id="t1579730569" t="ghadi and aws/invoke has a uniform interface across all services"><y>#</y><d>2020-01-22</d><h>22:02</h><w>ghadi</w>and aws/invoke has a uniform interface across all services</z><z id="t1579730642" t="kenny It&apos;d just be nice to have a way to ensure the request-id is always included. Developers may forget to use our own invoke function instead of the built-in one."><y>#</y><d>2020-01-22</d><h>22:04</h><w>kenny</w>It&apos;d just be nice to have a way to ensure the request-id is always included. Developers may forget to use our own invoke function instead of the built-in one.</z><z id="t1579730691" t="kenny If invoke was exposed on the Client protocol, that&apos;d be easy to do."><y>#</y><d>2020-01-22</d><h>22:04</h><w>kenny</w>If <code>invoke</code> was exposed on the Client protocol, that&apos;d be easy to do.</z><z id="t1579730838" t="mruzekw Has anyone had any success with JVM/CLJ + Lambda + Provisioned Currency?"><y>#</y><d>2020-01-22</d><h>22:07</h><w>mruzekw</w>Has anyone had any success with JVM/CLJ + Lambda + Provisioned Currency?</z><z id="t1579730995" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] you&apos;re in solution space, but I only deal in problem space 🙂"><y>#</y><d>2020-01-22</d><h>22:09</h><w>ghadi</w><a>@kenny</a> you&apos;re in solution space, but I only deal in problem space <b>🙂</b></z><z id="t1579731023" t="ghadi what&apos;s the actual problem without presuming a solution?"><y>#</y><d>2020-01-22</d><h>22:10</h><w>ghadi</w>what&apos;s the actual problem without presuming a solution?</z><z id="t1579731087" t="ghadi is it inconvenient to reach into grab the x-amzn-requestid header?"><y>#</y><d>2020-01-22</d><h>22:11</h><w>ghadi</w>is it inconvenient to reach into grab the x-amzn-requestid header?</z><z id="t1579731190" t="ghadi (inconvenience is legit IMHO)"><y>#</y><d>2020-01-22</d><h>22:13</h><w>ghadi</w>(inconvenience is legit IMHO)</z><z id="t1579731257" t="kenny Haha. The problem is ensuring the amzn-request-id is always included in the result if an anomaly occurred. Writing our own invoke function works but has the fatal flaw of humans being forgetful. There&apos;s no way to ensure that our invoke function is always used instead of the built-in invoke function. This is, of course, a classic case of &quot;don&apos;t do that&quot;. While that&apos;s fair in some cases, I don&apos;t think that&apos;s a great solution here. It seems far better to have a solution that will ensure all of our code follows the conventions mandated."><y>#</y><d>2020-01-22</d><h>22:14</h><w>kenny</w>Haha. The problem is ensuring the amzn-request-id is always included in the result if an anomaly occurred. Writing our own <code>invoke</code> function works but has the fatal flaw of humans being forgetful. There&apos;s no way to ensure that our <code>invoke</code> function is always used instead of the built-in <code>invoke</code> function. This is, of course, a classic case of &quot;don&apos;t do that&quot;. While that&apos;s fair in some cases, I don&apos;t think that&apos;s a great solution here. It seems far better to have a solution that will ensure all of our code follows the conventions mandated.</z><z id="t1579731366" t="kenny The arises because we are hitting some cases where amazon is not returning values that pass their spec. Their support team requires the request-id. We like to log as much information as we possibly can to make these issues easier to figure out retractively. Therefore it seems to make sense to always include a request-id if an anomaly occurs."><y>#</y><d>2020-01-22</d><h>22:16</h><w>kenny</w>The arises because we are hitting some cases where amazon is not returning values that pass their spec. Their support team requires the request-id. We like to log as much information as we possibly can to make these issues easier to figure out retractively. Therefore it seems to make sense to always include a request-id if an anomaly occurs.</z><z id="t1579731411" t="ghadi thanks this is more helpful"><y>#</y><d>2020-01-22</d><h>22:16</h><w>ghadi</w>thanks this is more helpful</z><z id="t1579731413" t="ghadi do all errors have a amzn reqid? do all requests have a amzn reqid? are there other headers that come back that are of general use?"><y>#</y><d>2020-01-22</d><h>22:16</h><w>ghadi</w>do all errors have a amzn reqid?
do all requests have a amzn reqid?
are there other headers that come back that are of general use?</z><z id="t1579731416" t="kenny In this particular case, I have no way to reproduce the issue we were seeing because it doesn&apos;t seem possible. If the request-id was logged amazon could have debugged further."><y>#</y><d>2020-01-22</d><h>22:16</h><w>kenny</w>In this particular case, I have no way to reproduce the issue we were seeing because it doesn&apos;t seem possible. If the request-id was logged amazon could have debugged further.</z><z id="t1579731448" t="ghadi &gt; amazon is not returning values that pass their spec ^ very interested in this"><y>#</y><d>2020-01-22</d><h>22:17</h><w>ghadi</w>&gt; amazon is not returning values that pass their spec
^ very interested in this</z><z id="t1579731521" t="kenny Those are all great questions and I don&apos;t know the answer. I did some brief googling a bit ago and couldn&apos;t find anything that ensured amazon always included the request-id in the response headers. The function I would write would include the &quot;x-amzn-requestid&quot; in the anomaly if it existed in the header map."><y>#</y><d>2020-01-22</d><h>22:18</h><w>kenny</w>Those are all great questions and I don&apos;t know the answer. I did some brief googling a bit ago and couldn&apos;t find anything that ensured amazon always included the request-id in the response headers. The function I would write would include the <code>&quot;x-amzn-requestid&quot;</code> in the anomaly if it existed in the header map.</z><z id="t1579731660" t="kenny The case we hit was a pagination token was returned that was not valid. We didn&apos;t log the pagination token so we couldn&apos;t send it to amazon. We did log the anomaly which has basically no useful info besides saying the NextToken was invalid. If the anomaly had the request-id, Amazon said they could dig in further."><y>#</y><d>2020-01-22</d><h>22:21</h><w>kenny</w>The case we hit was a pagination token was returned that was not valid. We didn&apos;t log the pagination token so we couldn&apos;t send it to amazon. We did log the anomaly which has basically no useful info besides saying the NextToken was invalid. If the anomaly had the request-id, Amazon said they could dig in further.</z><z id="t1579731682" t="ghadi in what way was the token invalid?"><y>#</y><d>2020-01-22</d><h>22:21</h><w>ghadi</w>in what way was the token invalid?</z><z id="t1579731696" t="ghadi some pagination tokens expire, for example"><y>#</y><d>2020-01-22</d><h>22:21</h><w>ghadi</w>some pagination tokens expire, for example</z></g><g id="s9"><z id="t1579731698" t="kenny The entire message was this &quot;Invalid NextToken provided.&quot;"><y>#</y><d>2020-01-22</d><h>22:21</h><w>kenny</w>The entire message was this &quot;Invalid NextToken provided.&quot;</z><z id="t1579731728" t="kenny There&apos;s no way this expired. The code executes sequentially in a very short period of time."><y>#</y><d>2020-01-22</d><h>22:22</h><w>kenny</w>There&apos;s no way this expired. The code executes sequentially in a very short period of time.</z><z id="t1579731746" t="kenny Well, if it did expire, the token would have an expiry of less than 10s."><y>#</y><d>2020-01-22</d><h>22:22</h><w>kenny</w>Well, if it did expire, the token would have an expiry of less than 10s.</z><z id="t1579731849" t="kenny Anyway, we are now logging the pagination token to hopefully debug further. I would&apos;ve liked to had a better answer from amazon by providing the request-id."><y>#</y><d>2020-01-22</d><h>22:24</h><w>kenny</w>Anyway, we are now logging the pagination token to hopefully debug further. I would&apos;ve liked to had a better answer from amazon by providing the request-id.</z><z id="t1579732412" t="ghadi You had other requests successful with the continuation tokens?"><y>#</y><d>2020-01-22</d><h>22:33</h><w>ghadi</w>You had other requests successful with the continuation tokens?</z><z id="t1579732420" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] "><y>#</y><d>2020-01-22</d><h>22:33</h><w>ghadi</w><a>@kenny</a> </z><z id="t1579732437" t="kenny Yes. This code executes often so it was very strange that one failed like this."><y>#</y><d>2020-01-22</d><h>22:33</h><w>kenny</w>Yes. This code executes often so it was very strange that one failed like this.</z><z id="t1579732454" t="ghadi weird"><y>#</y><d>2020-01-22</d><h>22:34</h><w>ghadi</w>weird</z><z id="t1579732479" t="kenny Very. The next-tokens are a bit strange with this api too. They look like uuids."><y>#</y><d>2020-01-22</d><h>22:34</h><w>kenny</w>Very. The next-tokens are a bit strange with this api too. They look like uuids.</z><z id="t1580146038" t="souenzzo Hello I&apos;m curentilty using logback for logging, what is the easiest path to get my logging into CloudWatch? I see that there is many paths: log to file &gt; file to cloudwatch, logback provider, slf4j provider ...."><y>#</y><d>2020-01-27</d><h>17:27</h><w>souenzzo</w>Hello
I&apos;m curentilty using <code>logback</code> for logging, what is the easiest path to get my logging into CloudWatch?
I see that there is many paths: log to file &gt; file to cloudwatch, logback provider, slf4j provider ....</z><z id="t1580146321" t="viesti if you run in Docker, there&apos;s awslogs driver (comes with Docker) which can ship logs to Cloudwatch"><y>#</y><d>2020-01-27</d><h>17:32</h><w>viesti</w>if you run in Docker, there&apos;s awslogs driver (comes with Docker) which can ship logs to Cloudwatch</z><z id="t1580146361" t="viesti if you run in EC2, there&apos;s Cloudwatch logs agent, which can ship logs to Cloudwatch: https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/QuickStartEC2Instance.html"><y>#</y><d>2020-01-27</d><h>17:32</h><w>viesti</w>if you run in EC2, there&apos;s Cloudwatch logs agent, which can ship logs to Cloudwatch: <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/QuickStartEC2Instance.html" target="_blank">https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/QuickStartEC2Instance.html</a></z><z id="t1580146424" t="viesti agent is good in that if the app goes wonky, then logs will still probably be shipped"><y>#</y><d>2020-01-27</d><h>17:33</h><w>viesti</w>agent is good in that if the app goes wonky, then logs will still probably be shipped</z><z id="t1580146480" t="viesti but if in docker land, I&apos;d go for awslogs agent"><y>#</y><d>2020-01-27</d><h>17:34</h><w>viesti</w>but if in docker land, I&apos;d go for awslogs agent</z><z id="t1580147693" t="ghadi I use Fargate, and send my logs to stdout"><y>#</y><d>2020-01-27</d><h>17:54</h><w>ghadi</w>I use Fargate, and send my logs to stdout</z><z id="t1580153871" t="viesti this is the case handled by awslogs driver (from user point of view, logging happens to stdout)"><y>#</y><d>2020-01-27</d><h>19:37</h><r>viesti</r>this is the case handled by awslogs driver (from user point of view, logging happens to stdout)</z><z id="t1580147747" t="jsyrjala There are logback appenders that send logs to CloudWatch Logs, for example: https://github.com/dibog/cloudwatch-logback-appender"><y>#</y><d>2020-01-27</d><h>17:55</h><w>jsyrjala</w>There are logback appenders that send logs to CloudWatch Logs, for example: <a href="https://github.com/dibog/cloudwatch-logback-appender" target="_blank">https://github.com/dibog/cloudwatch-logback-appender</a></z><z id="t1580148146" t="jsyrjala You can configure it via logback.xml ."><y>#</y><d>2020-01-27</d><h>18:02</h><r>jsyrjala</r>You can configure it via <code>logback.xml</code> .</z><z id="t1580148182" t="jsyrjala This can be used if you have normal java process running on EC2 instance."><y>#</y><d>2020-01-27</d><h>18:03</h><r>jsyrjala</r>This can be used if you have normal java process running on EC2 instance.</z><z id="t1580154509" t="ghadi those appenders tend to pull in a lot of dependencies"><y>#</y><d>2020-01-27</d><h>19:48</h><r>ghadi</r>those appenders tend to pull in a lot of dependencies</z><z id="t1580316002" t="Bingen Galartza Iparragirre https://medium.com/magnetcoop/monitoring-iot-devices-with-amazon-cloudwatch-in-clojure-9f7b2b6c2c66"><y>#</y><d>2020-01-29</d><h>16:40</h><w>Bingen Galartza Iparragirre</w><a href="https://medium.com/magnetcoop/monitoring-iot-devices-with-amazon-cloudwatch-in-clojure-9f7b2b6c2c66" target="_blank">https://medium.com/magnetcoop/monitoring-iot-devices-with-amazon-cloudwatch-in-clojure-9f7b2b6c2c66</a></z><z id="t1580334510" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] I got bit by an AWS paginator today"><y>#</y><d>2020-01-29</d><h>21:48</h><w>ghadi</w><a>@kenny</a> I got bit by an AWS paginator today</z><z id="t1580334515" t="ghadi I received :PaginationToken &quot;&quot;"><y>#</y><d>2020-01-29</d><h>21:48</h><w>ghadi</w>I received <code>:PaginationToken &quot;&quot;</code></z><z id="t1580334541" t="ghadi at the end of a series of API calls"><y>#</y><d>2020-01-29</d><h>21:49</h><w>ghadi</w>at the end of a series of API calls</z><z id="t1580334552" t="ghadi (for the resourcegroupstaggingapi )"><y>#</y><d>2020-01-29</d><h>21:49</h><w>ghadi</w>(for the <code>resourcegroupstaggingapi</code>)</z><z id="t1580334761" t="kenny Oh shoot. I&apos;ve hit that before too and thought we had a check for that. Just looked and it&apos;s not there anymore! The original page following code I wrote definitely checked for that. A month or so ago I rewrote it so it could follow pages from any source and I left that str/blank? check out! Ahh. Does that api consistently return &quot;&quot; for the pagination token when there are no more next pages?"><y>#</y><d>2020-01-29</d><h>21:52</h><w>kenny</w>Oh shoot. I&apos;ve hit that before too and thought we had a check for that. Just looked and it&apos;s not there anymore! The original page following code I wrote definitely checked for that. A month or so ago I rewrote it so it could follow pages from any source and I left that str/blank? check out! Ahh.

Does that api consistently return <code>&quot;&quot;</code> for the pagination token when there are no more next pages?</z><z id="t1580334790" t="ghadi depends on the API"><y>#</y><d>2020-01-29</d><h>21:53</h><w>ghadi</w>depends on the API</z><z id="t1580334797" t="ghadi that one does"><y>#</y><d>2020-01-29</d><h>21:53</h><w>ghadi</w>that one does</z><z id="t1580334812" t="ghadi other APIs seem to omit the key entirely"><y>#</y><d>2020-01-29</d><h>21:53</h><w>ghadi</w>other APIs seem to omit the key entirely</z><z id="t1580334848" t="kenny Have you seen an api that does both -- sometimes blank and sometimes omitted?"><y>#</y><d>2020-01-29</d><h>21:54</h><w>kenny</w>Have you seen an api that does both -- sometimes blank and sometimes omitted?</z><z id="t1580334898" t="ghadi haven&apos;t looked"><y>#</y><d>2020-01-29</d><h>21:54</h><w>ghadi</w>haven&apos;t looked</z><z id="t1580335030" t="kenny That might&apos;ve been what happened to us last week. Same code has been running since then and has not hit that issue. Thanks for that info though! Just added the str/blank? check back in. I&apos;m sure that will save some time in the future 🙂"><y>#</y><d>2020-01-29</d><h>21:57</h><w>kenny</w>That might&apos;ve been what happened to us last week. Same code has been running since then and has not hit that issue.

Thanks for that info though! Just added the str/blank? check back in. I&apos;m sure that will save some time in the future <b>🙂</b></z><z id="t1580584739" t="ghadi We are considering adding a new function to Clojure called iteration , and it would be very useful for consuming paginated APIs like Amazon&apos;s (defn log-groups &quot;gets all CloudWatch Log Groups&quot; [client] (-&gt;&gt; (iteration (fn [token] (aws/invoke client (cond-&gt; {:op :DescribeLogGroups} token (assoc :request {:nextToken token})))) :kf :nextToken :vf :logGroups) (into [] cat))) ^ here&apos;s how it could work with Cognitect Labs&apos; aws-api"><y>#</y><d>2020-02-01</d><h>19:18</h><w>ghadi</w>We are considering adding a new function to Clojure called <code>iteration</code>, and it would be very useful for consuming paginated APIs like Amazon&apos;s
<pre>(defn log-groups
  &quot;gets all CloudWatch Log Groups&quot;
  [client]
  (-&gt;&gt; (iteration
        (fn [token]
          (aws/invoke client (cond-&gt; {:op :DescribeLogGroups}
                               token (assoc :request {:nextToken token}))))
        :kf :nextToken
        :vf :logGroups)
       (into [] cat)))</pre>
^ here&apos;s how it could work with Cognitect Labs&apos; <code>aws-api</code></z><z id="t1580584768" t="ghadi https://clojure.atlassian.net/browse/CLJ-2555"><y>#</y><d>2020-02-01</d><h>19:19</h><w>ghadi</w><a href="https://clojure.atlassian.net/browse/CLJ-2555" target="_blank">https://clojure.atlassian.net/browse/CLJ-2555</a></z><z id="t1580584844" t="ghadi (still WIP, reserve the right to not do it, ymmv, etc.)"><y>#</y><d>2020-02-01</d><h>19:20</h><w>ghadi</w>(still WIP, reserve the right to not do it, ymmv, etc.)</z><z id="t1580586271" t="kenny Nice. First thought is how do I handle anomalies? Sometimes (most times) I&apos;d like to essentially have a reduced if an anomaly occurs, returning the anomaly."><y>#</y><d>2020-02-01</d><h>19:44</h><w>kenny</w>Nice. First thought is how do I handle anomalies? Sometimes (most times) I&apos;d like to essentially have a <code>reduced</code> if an anomaly occurs, returning the anomaly.</z><z id="t1580586522" t="ghadi the iteration above will terminate on anomalies (because :kf won&apos;t return anything from an anomaly) -- the (into [] cat) is swallowing it though"><y>#</y><d>2020-02-01</d><h>19:48</h><w>ghadi</w>the iteration above will terminate on anomalies (because :kf won&apos;t return anything from an anomaly) -- the (into [] cat) is swallowing it though</z><z id="t1580586542" t="ghadi you take out :vf or pass in a smarter :vf"><y>#</y><d>2020-02-01</d><h>19:49</h><w>ghadi</w>you take out :vf or pass in a smarter :vf</z><z id="t1580586566" t="ghadi then could check for the anomaly on the outside"><y>#</y><d>2020-02-01</d><h>19:49</h><w>ghadi</w>then could check for the anomaly on the outside</z><z id="t1580586619" t="ghadi (into [] (halt-when anomaly? retf) (iteration....))"><y>#</y><d>2020-02-01</d><h>19:50</h><w>ghadi</w><code>(into [] (halt-when anomaly? retf) (iteration....))</code></z><z id="t1580587010" t="ghadi halt-when will return the failing input when the retf isn&apos;t given"><y>#</y><d>2020-02-01</d><h>19:56</h><w>ghadi</w>halt-when will return the failing input when the retf isn&apos;t given</z><z id="t1580587452" t="kenny Hmm, I see. Clever. Looking at the pagination code we are using, the only other thing we keep track of is page-count. In some cases we use that for logging when certain page counts are hit for long running iterations &amp; other cases for capping pages followed. Seems like you can do that here by returning a different data structure from :kf. I think this would cover our use case."><y>#</y><d>2020-02-01</d><h>20:04</h><w>kenny</w>Hmm, I see. Clever.

Looking at the pagination code we are using, the only other thing we keep track of is page-count. In some cases we use that for logging when certain page counts are hit for long running iterations &amp; other cases for capping pages followed. Seems like you can do that here by returning a different data structure from :kf. I think this would cover our use case.</z><z id="t1580587453" t="ghadi probably better to pass in a smarter :vf (for the anomaly case)"><y>#</y><d>2020-02-01</d><h>20:04</h><w>ghadi</w>probably better to pass in a smarter <code>:vf</code> (for the anomaly case)</z><z id="t1580587589" t="kenny The only other comment is I almost always prefer apis where the function takes its options in a map instead of the variadic approach. Easer to programmatically build up when needed. Was there a reason you chose the variadic args?"><y>#</y><d>2020-02-01</d><h>20:06</h><w>kenny</w>The only other comment is I almost always prefer apis where the function takes its options in a map instead of the variadic approach. Easer to programmatically build up when needed. Was there a reason you chose the variadic args?</z><z id="t1580587748" t="ghadi I suspect that this isn&apos;t going to be a case where calls are programmatically built up, but I&apos;ll take that feedback back."><y>#</y><d>2020-02-01</d><h>20:09</h><w>ghadi</w>I suspect that this isn&apos;t going to be a case where calls are programmatically built up, but I&apos;ll take that feedback back.</z><z id="t1580587826" t="ghadi my suggestion for halt-when isn&apos;t useful for (into []) but is for transduce"><y>#</y><d>2020-02-01</d><h>20:10</h><w>ghadi</w>my suggestion for halt-when isn&apos;t useful for <code>(into [])</code> but is for <code>transduce</code></z><z id="t1580587865" t="ghadi user=&gt; (transduce (halt-when odd?) (completing conj! persistent!) (transient []) [2 2 2 3]) 3 user=&gt; (into [] (halt-when odd?) [2 2 2 3]) Execution error (ClassCastException) at user/eval197 (REPL:1). class java.lang.Long cannot be cast to class clojure.lang.ITransientCollection (java.lang.Long is in module java.base of loader &apos;bootstrap&apos;; clojure.lang.ITransientCollection is in unnamed module of loader &apos;app&apos;)"><y>#</y><d>2020-02-01</d><h>20:11</h><w>ghadi</w><pre>user=&gt; (transduce (halt-when odd?) (completing conj! persistent!) (transient []) [2 2 2 3])
3
user=&gt; (into [] (halt-when odd?) [2 2 2 3])
Execution error (ClassCastException) at user/eval197 (REPL:1).
class java.lang.Long cannot be cast to class clojure.lang.ITransientCollection (java.lang.Long is in module java.base of loader &apos;bootstrap&apos;; clojure.lang.ITransientCollection is in unnamed module of loader &apos;app&apos;)</pre></z><z id="t1580589057" t="kenny That’s far less clean looking"><y>#</y><d>2020-02-01</d><h>20:30</h><w>kenny</w>That’s far less clean looking</z><z id="t1580589095" t="ghadi if into was redefined slightly it would be possible"><y>#</y><d>2020-02-01</d><h>20:31</h><w>ghadi</w>if <code>into</code> was redefined slightly it would be possible</z><z id="t1580589172" t="kenny It does seem like into should support halt-when. "><y>#</y><d>2020-02-01</d><h>20:32</h><w>kenny</w>It does seem like into should support halt-when. </z><z id="t1580589323" t="ghadi (defn into&apos; ([to xform from] (let [add-meta #(with-meta % (meta to))] (if (instance? clojure.lang.IEditableCollection to) (transduce xform (completing conj! (comp add-meta persistent!)) (transient to) from) (transduce xform (completing conj add-meta) to from)))))"><y>#</y><d>2020-02-01</d><h>20:35</h><w>ghadi</w><pre>(defn into&apos;
  ([to xform from]
   (let [add-meta #(with-meta % (meta to))]
     (if (instance? clojure.lang.IEditableCollection to)
       (transduce xform (completing conj! (comp add-meta persistent!)) (transient to) from)
       (transduce xform (completing conj add-meta) to from)))))</pre></z><z id="t1580589332" t="ghadi redefined like that ^ it supports it"><y>#</y><d>2020-02-01</d><h>20:35</h><w>ghadi</w>redefined like that ^ it supports it</z><z id="t1580589356" t="ghadi user=&gt; (into&apos; [] (halt-when #{:anomaly} (fn [&amp; args] (zipmap [:result :failing-input] args))) [1 2 3 :anomaly 4]) {:result [1 2 3], :failing-input :anomaly}"><y>#</y><d>2020-02-01</d><h>20:35</h><w>ghadi</w><pre>user=&gt; (into&apos; [] (halt-when #{:anomaly} (fn [&amp; args] (zipmap [:result :failing-input] args))) [1 2 3 :anomaly 4])
{:result [1 2 3], :failing-input :anomaly}</pre></z><z id="t1580589511" t="kenny Any idea if there’s a reason into wasn’t written to support halt-when from the start?"><y>#</y><d>2020-02-01</d><h>20:38</h><w>kenny</w>Any idea if there’s a reason into wasn’t written to support halt-when from the start?</z><z id="t1580589556" t="ghadi if that problem is valid, it&apos;s an oversight or bug"><y>#</y><d>2020-02-01</d><h>20:39</h><w>ghadi</w>if that problem is valid, it&apos;s an oversight or bug</z><z id="t1580718773" t="grounded_sage I am doing a :PutObject as described here. https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58 Though I would like to see the response I get back to confirm that there was no errors. I can see this in the readme but don’t understand how I use it. https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58"><y>#</y><d>2020-02-03</d><h>08:32</h><w>grounded_sage</w>I am doing a <code>:PutObject</code> as described here. <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58</a>
Though I would like to see the response I get back to confirm that there was no errors. I can see this in the readme but don’t understand how I use it. <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/s3_examples.clj#L58</a></z><z id="t1580752011" t="dchelimsky The response is in the metadata of the return of invoke (used here in the same example file: https://github.com/cognitect-labs/aws-api/blob/5cad085173df0ab48d64823b8a9692b73a3b4ab7/examples/s3_examples.clj#L47 )"><y>#</y><d>2020-02-03</d><h>17:46</h><w>dchelimsky</w>The response is in the metadata of the return of <code>invoke</code>  (used here in the same example file: <a href="https://github.com/cognitect-labs/aws-api/blob/5cad085173df0ab48d64823b8a9692b73a3b4ab7/examples/s3_examples.clj#L47" target="_blank">https://github.com/cognitect-labs/aws-api/blob/5cad085173df0ab48d64823b8a9692b73a3b4ab7/examples/s3_examples.clj#L47</a>)</z><z id="t1580752082" t="dchelimsky [:attrs {:href &quot;/_/_/users/U05095F2K&quot;}] ^^"><y>#</y><d>2020-02-03</d><h>17:48</h><w>dchelimsky</w><a>@grounded_sage</a> ^^</z><z id="t1580753989" t="grounded_sage But that is only for the repl [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}]"><y>#</y><d>2020-02-03</d><h>18:19</h><w>grounded_sage</w>But that is only for the repl <a>@dchelimsky</a></z><z id="t1580754142" t="chrisulloa ^ (meta (aws/invoke client op))"><y>#</y><d>2020-02-03</d><h>18:22</h><w>chrisulloa</w>^
<pre>(meta (aws/invoke client op))</pre></z><z id="t1580754174" t="chrisulloa I think you’ll find an :http-response key in the meta where you can check the status code"><y>#</y><d>2020-02-03</d><h>18:22</h><w>chrisulloa</w>I think you’ll find an :http-response key in the meta where you can check the status code</z><z id="t1580757177" t="grounded_sage ah! makes total sense."><y>#</y><d>2020-02-03</d><h>19:12</h><w>grounded_sage</w>ah! makes total sense.</z><z id="t1580757268" t="ghadi In general you don’t have to do that"><y>#</y><d>2020-02-03</d><h>19:14</h><w>ghadi</w>In general you don’t have to do that</z><z id="t1580757285" t="ghadi Responses return maps, which may include a cognitect/anomaly"><y>#</y><d>2020-02-03</d><h>19:14</h><w>ghadi</w>Responses return maps, which may include a cognitect/anomaly</z><z id="t1580757286" t="grounded_sage Realised I shared the same links. Was meaning to reference this in the readme. (-&gt; client aws/ops op :response) So I thought there must be some key I can use to get the response. https://github.com/cognitect-labs/aws-api#responses-success-failure"><y>#</y><d>2020-02-03</d><h>19:14</h><w>grounded_sage</w>Realised I shared the same links. Was meaning to reference this in the readme. <code>(-&gt; client aws/ops op :response)</code> So I thought there must be some key I can use to get the response. <a href="https://github.com/cognitect-labs/aws-api#responses-success-failure" target="_blank">https://github.com/cognitect-labs/aws-api#responses-success-failure</a></z><z id="t1580757300" t="ghadi If you see an anomaly, it means something failed"><y>#</y><d>2020-02-03</d><h>19:15</h><w>ghadi</w>If you see an anomaly, it means something failed</z><z id="t1580757305" t="grounded_sage How do I get that map?"><y>#</y><d>2020-02-03</d><h>19:15</h><w>grounded_sage</w>How do I get that map?</z><z id="t1580757322" t="ghadi It’s the return value of invoke"><y>#</y><d>2020-02-03</d><h>19:15</h><w>ghadi</w>It’s the return value of invoke</z><z id="t1580757382" t="grounded_sage I ended up doing this… (-&gt; (S3-writer! file-path id (:body response)) (contains? :ETag))"><y>#</y><d>2020-02-03</d><h>19:16</h><w>grounded_sage</w>I ended up doing this… <code>(-&gt; (S3-writer! file-path id (:body response)) (contains? :ETag))</code></z><z id="t1580757394" t="grounded_sage because I couldn’t get a map back"><y>#</y><d>2020-02-03</d><h>19:16</h><w>grounded_sage</w>because I couldn’t get a map back</z><z id="t1580757427" t="ghadi What do you mean you couldn’t get a map back?"><y>#</y><d>2020-02-03</d><h>19:17</h><w>ghadi</w>What do you mean you couldn’t get a map back?</z><z id="t1580757463" t="grounded_sage Give me a sec. Was about to go home. Will boot up quick and see if I can try what you are saying."><y>#</y><d>2020-02-03</d><h>19:17</h><w>grounded_sage</w>Give me a sec. Was about to go home. Will boot up quick and see if I can try what you are saying.</z><z id="t1580757577" t="grounded_sage Doing this in the repl (S3-writer! &quot;/test/&quot; &quot;hello.txt&quot; (.getBytes &quot;Oh hai!&quot;)) Returns an {:ETag &quot;\&quot;.........\&quot;&quot;}"><y>#</y><d>2020-02-03</d><h>19:19</h><w>grounded_sage</w>Doing this in the repl  <code>(S3-writer! &quot;/test/&quot; &quot;hello.txt&quot; (.getBytes &quot;Oh hai!&quot;))</code>
Returns an <code>{:ETag &quot;\&quot;.........\&quot;&quot;}</code></z><z id="t1580757625" t="grounded_sage This is how S3-writer! is defined. (defn S3-writer! [file-path file-name data] (aws/invoke s3 {:op :PutObject :request {:Bucket bucket-name :Key (str partner-folder-name file-path file-name) :Body data}})) "><y>#</y><d>2020-02-03</d><h>19:20</h><w>grounded_sage</w>This is how S3-writer! is defined.
<pre>(defn S3-writer!
  [file-path file-name data]
  (aws/invoke s3 {:op :PutObject :request {:Bucket bucket-name
                                           :Key (str partner-folder-name file-path file-name)
                                           :Body data}}))</pre>
</z><z id="t1580757805" t="ghadi (aws/doc s3client :PutObject) -&gt; ------------------------- Response {:RequestCharged [:one-of [&quot;requester&quot;]], :ETag string, :SSECustomerKeyMD5 string, :SSEKMSEncryptionContext string, :ServerSideEncryption [:one-of [&quot;AES256&quot; &quot;aws:kms&quot;]], :SSECustomerAlgorithm string, :SSEKMSKeyId string, :Expiration string, :VersionId string}"><y>#</y><d>2020-02-03</d><h>19:23</h><w>ghadi</w>(aws/doc s3client :PutObject) -&gt;
<pre>-------------------------
Response

{:RequestCharged [:one-of [&quot;requester&quot;]],
 :ETag string,
 :SSECustomerKeyMD5 string,
 :SSEKMSEncryptionContext string,
 :ServerSideEncryption [:one-of [&quot;AES256&quot; &quot;aws:kms&quot;]],
 :SSECustomerAlgorithm string,
 :SSEKMSKeyId string,
 :Expiration string,
 :VersionId string}</pre></z><z id="t1580757828" t="ghadi if it doesn&apos;t return a subset of that stuff directly, there&apos;s a bug"><y>#</y><d>2020-02-03</d><h>19:23</h><w>ghadi</w>if it doesn&apos;t return a subset of that stuff directly, there&apos;s a bug</z><z id="t1580758082" t="ghadi if the map has a key :cognitect.anomalies/category , that means something has gone wrong"><y>#</y><d>2020-02-03</d><h>19:28</h><w>ghadi</w>if the map has a key <code>:cognitect.anomalies/category</code>, that means something has gone wrong</z><z id="t1580761957" t="grounded_sage When I run this from the S3 examples aws-api/examples/s3_examples.clj (aws/invoke s3 {:op :PutObject :request {:Bucket bucket-name :Key &quot;hello.txt&quot; :Body (.getBytes &quot;Oh hai!&quot;)}}) I only get back the :ETag in the repl."><y>#</y><d>2020-02-03</d><h>20:32</h><w>grounded_sage</w>When I run this from the S3 examples <code>aws-api/examples/s3_examples.clj</code>
<pre>(aws/invoke s3 {:op :PutObject :request {:Bucket bucket-name :Key &quot;hello.txt&quot;
                                           :Body (.getBytes &quot;Oh hai!&quot;)}}) </pre>
I only get back the <code>:ETag</code> in the repl.</z><z id="t1580761992" t="ghadi map with {:ETag &quot;something&quot;} in it ?"><y>#</y><d>2020-02-03</d><h>20:33</h><w>ghadi</w>map with <code>{:ETag &quot;something&quot;}</code> in it ?</z><z id="t1580762011" t="grounded_sage yes"><y>#</y><d>2020-02-03</d><h>20:33</h><w>grounded_sage</w>yes</z><z id="t1580762081" t="ghadi yes, that is correct https://clojurians.slack.com/archives/C09N0H1RB/p1580757828051300"><y>#</y><d>2020-02-03</d><h>20:34</h><w>ghadi</w>yes, that is correct
<a href="https://clojurians.slack.com/archives/C09N0H1RB/p1580757828051300" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1580757828051300</a></z><z id="t1580762084" t="grounded_sage As referenced above. I ended up piping it into a contains? to check for the tag. But it seems like the wrong way to be checking…"><y>#</y><d>2020-02-03</d><h>20:34</h><w>grounded_sage</w>As referenced above. I ended up piping it into a <code>contains?</code>to check for the tag. But it seems like the wrong way to be checking…</z><z id="t1580762120" t="ghadi personally I would check for the presence of error, instead of the presence of the ETag"><y>#</y><d>2020-02-03</d><h>20:35</h><w>ghadi</w>personally I would check for the presence of error, instead of the presence of the ETag</z><z id="t1580762128" t="ghadi it depends on what you&apos;re doing"><y>#</y><d>2020-02-03</d><h>20:35</h><w>ghadi</w>it depends on what you&apos;re doing</z><z id="t1580762178" t="ghadi (defn anomaly? [m] (:cognitect.anomalies/category m))"><y>#</y><d>2020-02-03</d><h>20:36</h><w>ghadi</w><code>(defn anomaly? [m] (:cognitect.anomalies/category m))</code></z><z id="t1580762705" t="dchelimsky or (def anomaly? :cognitect.anomalies/category) :)"><y>#</y><d>2020-02-03</d><h>20:45</h><r>dchelimsky</r>or <code>(def anomaly? :cognitect.anomalies/category)</code> :)</z><z id="t1580762183" t="ghadi or make a helper ^"><y>#</y><d>2020-02-03</d><h>20:36</h><w>ghadi</w>or make a helper ^</z><z id="t1580762207" t="ghadi different inputs to PutObject will produce different subsets of the response spec"><y>#</y><d>2020-02-03</d><h>20:36</h><w>ghadi</w>different inputs to PutObject will produce different subsets of the response spec</z><z id="t1580762226" t="ghadi and I can&apos;t say for certain that there&apos;s not a request that might not return an ETag at all"><y>#</y><d>2020-02-03</d><h>20:37</h><w>ghadi</w>and I can&apos;t say for certain that there&apos;s not a request that might not return an ETag at all</z><z id="t1580762272" t="grounded_sage Ok thanks. That makes sense."><y>#</y><d>2020-02-03</d><h>20:37</h><w>grounded_sage</w>Ok thanks. That makes sense.</z><z id="t1580762540" t="grounded_sage Looks more sane wrapping it with anomaly? than what I had."><y>#</y><d>2020-02-03</d><h>20:42</h><w>grounded_sage</w>Looks more sane wrapping it with <code>anomaly?</code> than what I had.</z><z id="t1580824721" t="slipset For the cognitect-labs/aws-api, the code that actually consumes stuff like https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json and creates specs and the stuff that&apos;s needed to run aws-api , is that proprietary?"><y>#</y><d>2020-02-04</d><h>13:58</h><w>slipset</w>For the cognitect-labs/aws-api, the code that actually consumes stuff like <a href="https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json" target="_blank">https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json</a> and creates specs and the stuff that&apos;s needed to run <code>aws-api</code>, is that proprietary?</z><z id="t1580833564" t="dchelimsky Yes"><y>#</y><d>2020-02-04</d><h>16:26</h><r>dchelimsky</r>Yes</z><z id="t1580842192" t="slipset The reason I’m asking is that we need to talk to azure, and they have their api specs in swagger, so it’d be fun to use the same approach. "><y>#</y><d>2020-02-04</d><h>18:49</h><r>slipset</r>The reason I’m asking is that we need to talk to azure, and they have their api specs in swagger, so it’d be fun to use the same approach. </z><z id="t1580886337" t="lispyclouds [:attrs {:href &quot;/_/_/users/U04V5VAUN&quot;}] I was inspired by the aws lib to make a docker client: https://github.com/lispyclouds/clj-docker-client This uses docker API&apos;s swagger to do its things. This may be of interest? Also I could use some improvements in the process too 😄"><y>#</y><d>2020-02-05</d><h>07:05</h><r>lispyclouds</r><a>@U04V5VAUN</a> I was inspired by the aws lib to make a docker client: <a href="https://github.com/lispyclouds/clj-docker-client" target="_blank">https://github.com/lispyclouds/clj-docker-client</a>
This uses docker API&apos;s swagger to do its things. This may be of interest? Also I could use some improvements in the process too <b>😄</b></z><z id="t1580886457" t="slipset Sweet! I’ll have a look."><y>#</y><d>2020-02-05</d><h>07:07</h><r>slipset</r>Sweet! I’ll have a look.</z><z id="t1580918473" t="kenny [:attrs {:href &quot;/_/_/users/U04V5VAUN&quot;}] It&apos;s pretty straightforward to do. We have also written an api that is very similar to aws-api for GCP: https://github.com/ComputeSoftware/gcp-api"><y>#</y><d>2020-02-05</d><h>16:01</h><r>kenny</r><a>@U04V5VAUN</a> It&apos;s pretty straightforward to do. We have also written an api that is very similar to aws-api for GCP: <a href="https://github.com/ComputeSoftware/gcp-api" target="_blank">https://github.com/ComputeSoftware/gcp-api</a></z><z id="t1580918621" t="kenny gcp-api takes in swagger and transforms it into descriptor files (it only does this to minimize the size of the final artifact). I&apos;m somewhat sure a generic client could be made to take in Swagger and call a service. We&apos;re also going to need to build one of these for k8s soon. Once I have a better understanding of where things are common, I may pull the swagger part out into a separate library."><y>#</y><d>2020-02-05</d><h>16:03</h><r>kenny</r>gcp-api takes in swagger and transforms it into descriptor files (it only does this to minimize the size of the final artifact).

I&apos;m somewhat sure a generic client could be made to take in Swagger and call a service. We&apos;re also going to need to build one of these for k8s soon. Once I have a better understanding of where things are common, I may pull the swagger part out into a separate library.</z><z id="t1580991883" t="defa Is cognitect.aws.client supposed to work with other S3 providers than amazon? I’m trying to connect to a NetApp StorageGRID S3 endpoint but don’t know how. (aws/client {:api :s3 :endpoint-override {:hostname &quot;&quot;}}) gives me an error: Execution error (ExceptionInfo) at cognitect.aws.client.api/client (api.clj:94). No known endpoint."><y>#</y><d>2020-02-06</d><h>12:24</h><w>defa</w>Is <code>cognitect.aws.client</code> supposed to work with other S3 providers than amazon? I’m trying to connect to a NetApp StorageGRID S3 endpoint but don’t know how.
<pre>(aws/client {:api :s3
             :endpoint-override {:hostname &quot;&quot;}})</pre>
gives me an error:
<pre>Execution error (ExceptionInfo) at cognitect.aws.client.api/client (api.clj:94).
No known endpoint.</pre></z><z id="t1580995753" t="jsyrjala ;; Mock S3 Service ;; https://github.com/adobe/S3Mock ;; https://github.com/adobe/S3Mock/blob/master/server/src/main/java/com/adobe/testing/s3mock/S3MockApplication.java (def props {S3MockApplication/PROP_HTTPS_PORT S3MockApplication/RANDOM_PORT       S3MockApplication/PROP_HTTP_PORT S3MockApplication/RANDOM_PORT       S3MockApplication/PROP_INITIAL_BUCKETS bucket       S3MockApplication/PROP_SILENT “true”       }) (def s3mock (S3MockApplication/start (HashMap. props) (into-array String []))) (def s3 (aws-api/client {:api :s3               :endpoint-override {:protocol :http                        :hostname “localhost”                        :port  (.getHttpPort s3mock)}}))"><y>#</y><d>2020-02-06</d><h>13:29</h><r>jsyrjala</r>;; Mock S3 Service
;; <a href="https://github.com/adobe/S3Mock" target="_blank">https://github.com/adobe/S3Mock</a>
;; <a href="https://github.com/adobe/S3Mock/blob/master/server/src/main/java/com/adobe/testing/s3mock/S3MockApplication.java" target="_blank">https://github.com/adobe/S3Mock/blob/master/server/src/main/java/com/adobe/testing/s3mock/S3MockApplication.java</a>
(def props {S3MockApplication/PROP_HTTPS_PORT S3MockApplication/RANDOM_PORT
      S3MockApplication/PROP_HTTP_PORT S3MockApplication/RANDOM_PORT
      S3MockApplication/PROP_INITIAL_BUCKETS bucket
      S3MockApplication/PROP_SILENT “true”
      })

(def s3mock (S3MockApplication/start (HashMap. props) (into-array String [])))

(def s3 (aws-api/client {:api :s3 
             :endpoint-override {:protocol :http
                       :hostname “localhost”
                       :port  (.getHttpPort s3mock)}}))</z><z id="t1580995791" t="jsyrjala I think I got it working against locally running mock server"><y>#</y><d>2020-02-06</d><h>13:29</h><r>jsyrjala</r>I think I got it working against locally running mock server</z><z id="t1581060209" t="defa Haven not yet looked into what S3MockApplication really does but for me :endpoint-override seems not to work."><y>#</y><d>2020-02-07</d><h>07:23</h><r>defa</r>Haven not yet looked into what <code>S3MockApplication</code> really does but for me <code>:endpoint-override</code> seems not to work.</z><z id="t1581087908" t="dchelimsky aws-api&apos;s interactions with aws are based on data descriptions of their apis: ( https://github.com/aws/aws-sdk-js/tree/master/apis )"><y>#</y><d>2020-02-07</d><h>15:05</h><r>dchelimsky</r>aws-api&apos;s interactions with aws are based on data descriptions of their apis: (<a href="https://github.com/aws/aws-sdk-js/tree/master/apis" target="_blank">https://github.com/aws/aws-sdk-js/tree/master/apis</a>)</z><z id="t1581088042" t="dchelimsky AWS does not make any promises about those descriptions aligning with specs that other vendors use to make s3-compatible services, so neither can we."><y>#</y><d>2020-02-07</d><h>15:07</h><r>dchelimsky</r>AWS does not make any promises about those descriptions aligning with specs that other vendors use to make s3-compatible services, so neither can we.</z><z id="t1581088174" t="dchelimsky Actually, looking at the error you posted above, &quot;no known endpoint&quot;, that comes from aws-api even before trying to send a request out."><y>#</y><d>2020-02-07</d><h>15:09</h><r>dchelimsky</r>Actually, looking at the error you posted above, &quot;no known endpoint&quot;, that comes from aws-api even before trying to send a request out.</z><z id="t1581090277" t="dchelimsky OK, so the answer to your original question is that no, aws api does not promise to work with endpoints outside of aws. Please feel free to submit an issue https://github.com/cognitect-labs/aws-api/issues and we can continue the convo there."><y>#</y><d>2020-02-07</d><h>15:44</h><r>dchelimsky</r>OK, so the answer to your original question is that no, aws api does not promise to work with endpoints outside of aws. Please feel free to submit an issue <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> and we can continue the convo there.</z><z id="t1581092302" t="defa When supplying a valid :region I manged to connect to a NetApp StorageGRID S3 endpoint. (def s3 (aws/client {:api :s3 :region &quot;us-west-1&quot; :endpoint-override {:protocol :https :hostname &quot;&quot;} :credentials-provider (credentials/basic-credentials-provider {:access-key-id ACCESS_KEY :secret-access-key SECRET_KEY})})) (aws/invoke s3 {:op :ListBuckets}) "><y>#</y><d>2020-02-07</d><h>16:18</h><r>defa</r>When supplying a valid <code>:region</code> I manged to connect to a NetApp StorageGRID S3 endpoint.
<pre>(def s3 (aws/client {:api                  :s3
                     :region               &quot;us-west-1&quot;
                     :endpoint-override    {:protocol :https
                                            :hostname &quot;&quot;}
                     :credentials-provider (credentials/basic-credentials-provider
                                             {:access-key-id     ACCESS_KEY
                                              :secret-access-key SECRET_KEY})}))
(aws/invoke s3 {:op :ListBuckets})</pre>
</z><z id="t1581092476" t="defa withou :region the aws/client runs for a while an than failes with an error: Execution error (ExceptionInfo) at cognitect.aws.region$chain_region_provider$reify__13062/fetch (region.clj:37). No region found by any region provider."><y>#</y><d>2020-02-07</d><h>16:21</h><r>defa</r>withou <code>:region</code> the <code>aws/client</code> runs for a while an than failes with an error:
<pre>Execution error (ExceptionInfo) at cognitect.aws.region$chain_region_provider$reify__13062/fetch (region.clj:37).
No region found by any region provider.</pre></z><z id="t1581092543" t="defa with :region &quot;foo&quot; the error is a little misleading: Execution error (ExceptionInfo) at cognitect.aws.client.api/client (api.clj:94). No known endpoint. "><y>#</y><d>2020-02-07</d><h>16:22</h><r>defa</r>with <code>:region &quot;foo&quot;</code> the error is a little misleading:
<pre>Execution error (ExceptionInfo) at cognitect.aws.client.api/client (api.clj:94).
No known endpoint. </pre></z><z id="t1581092638" t="defa … but with :region &quot;eu-central-1&quot; the client is created and (aws/invoke s3 {:op :ListBuckets}) successfully delivers the expected results"><y>#</y><d>2020-02-07</d><h>16:23</h><r>defa</r>… but with <code>:region &quot;eu-central-1&quot;</code> the client is created and <code>(aws/invoke s3 {:op :ListBuckets})</code> successfully delivers the expected results</z><z id="t1581095890" t="dchelimsky Did you have a region configured in your environment? https://github.com/cognitect-labs/aws-api#region-lookup https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-region-selection.html"><y>#</y><d>2020-02-07</d><h>17:18</h><r>dchelimsky</r>Did you have a region configured in your environment? <a href="https://github.com/cognitect-labs/aws-api#region-lookup" target="_blank">https://github.com/cognitect-labs/aws-api#region-lookup</a> <a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-region-selection.html" target="_blank">https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/java-dg-region-selection.html</a></z><z id="t1581006702" t="kenny Can you create a presigned url with aws-api?"><y>#</y><d>2020-02-06</d><h>16:31</h><w>kenny</w>Can you create a presigned url with aws-api?</z><z id="t1581006919" t="kenny Ah https://github.com/cognitect-labs/aws-api/issues/5 . Anyone have a workaround for now?"><y>#</y><d>2020-02-06</d><h>16:35</h><r>kenny</r>Ah <a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a>. Anyone have a workaround for now?</z><z id="t1581007008" t="kenny It sounds like the pieces are there and just need to be assembled."><y>#</y><d>2020-02-06</d><h>16:36</h><r>kenny</r>It sounds like the pieces are there and just need to be assembled.</z><z id="t1581011502" t="ghadi the s3 v4 signing api is really straightforward"><y>#</y><d>2020-02-06</d><h>17:51</h><r>ghadi</r>the s3 v4 signing api is really straightforward</z><z id="t1581011508" t="ghadi (the non-streaming variant)"><y>#</y><d>2020-02-06</d><h>17:51</h><r>ghadi</r>(the non-streaming variant)</z><z id="t1581177321" t="MatthewLisp Hello everyone!"><y>#</y><d>2020-02-08</d><h>15:55</h><w>MatthewLisp</w>Hello everyone!</z><z id="t1581177398" t="MatthewLisp I&apos;m using the com.cognitect.aws/api library, and i wonder if any of you used lambda to upload your jar via cognitect&apos;s library"><y>#</y><d>2020-02-08</d><h>15:56</h><w>MatthewLisp</w>I&apos;m using the <code>com.cognitect.aws/api</code>  library, and i wonder if any of you used lambda to upload your jar via cognitect&apos;s library</z><z id="t1581188126" t="hiredman Not sure what you mean by using lambda, but part of our deployment process at work uses cognitects library to push jars to s3 (uploading to s3 and then downloading turns out to be faster than pushing jars through our VPN)."><y>#</y><d>2020-02-08</d><h>18:55</h><w>hiredman</w>Not sure what you mean by using lambda, but part of our deployment process at work uses cognitects library to push jars to s3 (uploading to s3 and then downloading turns out to be faster than pushing jars through our VPN).</z><z id="t1581441386" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.430 https://groups.google.com/forum/#!topic/clojure/U9chWFVDC_g"><y>#</y><d>2020-02-11</d><h>17:16</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.430 <a href="https://groups.google.com/forum/#!topic/clojure/U9chWFVDC_g" target="_blank">https://groups.google.com/forum/#!topic/clojure/U9chWFVDC_g</a></z><z id="t1581460287" t="include I would be very grateful if someone ELI5 this to me 🙂 “(…) support automatic resource management (…) anything you’ve been doing to manually manage resources is probably unnecessary now.” 😅 thnx"><y>#</y><d>2020-02-11</d><h>22:31</h><r>include</r>I would be very grateful if someone ELI5 this to me <b>🙂</b> “(…) support automatic resource management (…) anything you’ve been doing to manually manage resources is probably unnecessary now.” <b>😅</b> thnx</z><z id="t1581468166" t="kenny [:attrs {:href &quot;/_/_/users/U3NP9AM0S&quot;}] We have a wrapper client function that always passes (def default-http-client (delay (aws/default-http-client))) to the call to cognitect.aws.client.api/client . That means we don&apos;t need this anymore."><y>#</y><d>2020-02-12</d><h>00:42</h><r>kenny</r><a>@U3NP9AM0S</a> We have a wrapper <code>client</code> function that always passes
<pre>(def default-http-client
  (delay (aws/default-http-client)))</pre>
to the call to <code>cognitect.aws.client.api/client</code>. That means we don&apos;t need this anymore.</z><z id="t1581470487" t="include perhaps ELI4? 🙂 kidding - thank you for the explanation. It’s a mechanism to simplify that operation."><y>#</y><d>2020-02-12</d><h>01:21</h><r>include</r>perhaps ELI4? <b>🙂</b> kidding - thank you for the explanation. It’s a mechanism to simplify that operation.</z><z id="t1581468278" t="kenny Weird learning of the day: EBS volume prices are based on the month of the year. i.e., the cost per volume gib changes based on the length of the month. Very strange."><y>#</y><d>2020-02-12</d><h>00:44</h><w>kenny</w>Weird learning of the day: EBS volume prices are based on the month of the year. i.e., the cost per volume gib changes based on the length of the month. Very strange.</z><z id="t1581468333" t="Alex Miller (Clojure team) maybe lots of end-of-the-month batch processing?"><y>#</y><d>2020-02-12</d><h>00:45</h><w>Alex Miller (Clojure team)</w>maybe lots of end-of-the-month batch processing?</z><z id="t1581471029" t="kenny Could we perhaps have the ability to specify the :api as a part of the op-map? We have tons of code that ends up looking like this: {::ec2-client (aws/new-client {:api :ec2}) ::rds-client (aws/new-client {:api :rds}) ::cw-client (aws/new-client {:api :monitoring}) ::autoscaling-client (aws/new-client {:api :autoscaling}) ::lb-v1-client (aws/new-client {:api :elasticloadbalancing}) ::lb-v2-client (aws/new-client {:api :elasticloadbalancingv2})} There doesn&apos;t seem to be a reason for keeping them separate. I suppose we could implement this ourselves."><y>#</y><d>2020-02-12</d><h>01:30</h><w>kenny</w>Could we perhaps have the ability to specify the :api as a part of the op-map? We have tons of code that ends up looking like this:
<pre>{::ec2-client         (aws/new-client {:api :ec2})
 ::rds-client         (aws/new-client {:api :rds})
 ::cw-client          (aws/new-client {:api :monitoring})
 ::autoscaling-client (aws/new-client {:api :autoscaling})
 ::lb-v1-client       (aws/new-client {:api :elasticloadbalancing})
 ::lb-v2-client       (aws/new-client {:api :elasticloadbalancingv2})}</pre>
There doesn&apos;t seem to be a reason for keeping them separate. I suppose we could implement this ourselves.</z><z id="t1581471255" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] would appreciate a GitHub issue describing that"><y>#</y><d>2020-02-12</d><h>01:34</h><w>ghadi</w><a>@kenny</a> would appreciate a GitHub issue describing that</z><z id="t1581471284" t="kenny Will do tomorrow"><y>#</y><d>2020-02-12</d><h>01:34</h><r>kenny</r>Will do tomorrow</z><z id="t1581473778" t="ghadi thank you sir"><y>#</y><d>2020-02-12</d><h>02:16</h><r>ghadi</r>thank you sir</z><z id="t1581562677" t="kenny https://github.com/cognitect-labs/aws-api/issues/125"><y>#</y><d>2020-02-13</d><h>02:57</h><r>kenny</r><a href="https://github.com/cognitect-labs/aws-api/issues/125" target="_blank">https://github.com/cognitect-labs/aws-api/issues/125</a></z><z id="t1581564308" t="kenny Why would :Body be nil on a S3 GetObject request? (aws-api/invoke s3-client {:op :GetObject :request {:Bucket billing-s3-bucket :Key &quot;hourly-cur/hourly-cur/20200201-20200301/fc247861-fb77-460c-9f91/hourly-cur-7.csv.gz&quot;}}) =&gt; {:LastModified #inst&quot;2020-02-04T09:04:14.000-00:00&quot;, :ETag &quot;\&quot;d41d8cd98f00b204e9800998ecf8427e\&quot;&quot;, :Metadata {}, :ServerSideEncryption &quot;AES256&quot;, :ContentLength 0, :ContentType &quot;application/octet-stream&quot;, :AcceptRanges &quot;bytes&quot;, :Body nil}"><y>#</y><d>2020-02-13</d><h>03:25</h><w>kenny</w>Why would :Body be nil on a S3 GetObject request?
<pre>(aws-api/invoke
    s3-client
    {:op      :GetObject
     :request {:Bucket billing-s3-bucket
               :Key    &quot;hourly-cur/hourly-cur/20200201-20200301/fc247861-fb77-460c-9f91/hourly-cur-7.csv.gz&quot;}})
=&gt;
{:LastModified #inst&quot;2020-02-04T09:04:14.000-00:00&quot;,
 :ETag &quot;\&quot;d41d8cd98f00b204e9800998ecf8427e\&quot;&quot;,
 :Metadata {},
 :ServerSideEncryption &quot;AES256&quot;,
 :ContentLength 0,
 :ContentType &quot;application/octet-stream&quot;,
 :AcceptRanges &quot;bytes&quot;,
 :Body nil}</pre></z><z id="t1581600089" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] you can have keys that have no associated content. That :ContentLength is 0 suggests that is the case, in which case s3 sends back no body. You can see this if you eval (:http-response (meta *1)) (assuming your last exp was the invoke call you posted)."><y>#</y><d>2020-02-13</d><h>13:21</h><w>dchelimsky</w><a>@kenny</a> you can have keys that have no associated content. That <code>:ContentLength</code> is 0 suggests that is the case, in which case s3 sends back no body. You can see this if you eval <code>(:http-response (meta *1))</code> (assuming your last exp was the invoke call you posted).</z><z id="t1581608969" t="kenny Ah yes, that was it. Thanks."><y>#</y><d>2020-02-13</d><h>15:49</h><r>kenny</r>Ah yes, that was it. Thanks.</z><z id="t1581610012" t="kenny I believe there is an issue with S3 returning a key that looks like this // . If you create a CUR with no prefix set, AWS will store the CURs under the path //&lt;report name&gt;/&lt;date range&gt;/&lt;assembly id&gt;/&lt;report item&gt; . If I call :ListObjectsV2 on this bucket, I get a list of objects returned but the :Key is not correct. For example, one key returned looks like this &quot;/test/20190501-20190601/7c0795d3-9b7e-438b-bb5d-de3ead37baad/test-1.csv.gz&quot; when its actual key should be &quot;//test/20190501-20190601/7c0795c3-9b7e-437b-bb5d-de3ead37baad/test-1.csv.gz&quot; . If I call :GetObject on the key returned by aws-api, I get a NoSuchKey anomaly. If I try using the actual key with the // , I get a forbidden anomaly: {:Error {:HostIdAttrs {}, :StringToSignBytes &quot;...&quot;, :CanonicalRequestBytes &quot;...&quot;, :CanonicalRequestAttrs {}, :Message &quot;The request signature we calculated does not match the signature you provided. Check your key and signing method.&quot;, :StringToSign &quot;AWS4-HMAC-SHA256 20200213T160537Z 20200213/us-west-2/s3/aws4_request ...&quot;, :CodeAttrs {}, :RequestIdAttrs {}, :SignatureProvidedAttrs {}, :HostId &quot;...&quot;, :StringToSignBytesAttrs {}, :MessageAttrs {}, :RequestId &quot;E92073AA791F0EB6&quot;, :Code &quot;SignatureDoesNotMatch&quot;, :SignatureProvided &quot;...&quot;, :AWSAccessKeyIdAttrs {}, :CanonicalRequest &quot;GET /compute-cost-reports//test/20190501-20190601/7c0795c3-9b7e-437b-bb5d-de3ead37baad/test-1.csv.gz host: x-amz-content-sha256:... x-amz-date:20200213T160537Z host;x-amz-content-sha256;x-amz-date ...&quot;, :CanonicalRequestBytesAttrs {}, :StringToSignAttrs {}, :AWSAccessKeyId &quot;...&quot;}, :ErrorAttrs {}, :cognitect.anomalies/category :cognitect.anomalies/forbidden} The object does actually exist under that path -- I can see it in the S3 console."><y>#</y><d>2020-02-13</d><h>16:06</h><w>kenny</w>I believe there is an issue with S3 returning a key that looks like this <code>//</code> . If you create a CUR with no prefix set, AWS will store the CURs under the path <code>//&lt;report name&gt;/&lt;date range&gt;/&lt;assembly id&gt;/&lt;report item&gt;</code>. If I call <code>:ListObjectsV2</code> on this bucket, I get a list of objects returned but the <code>:Key</code> is not correct. For example, one key returned looks like this <code>&quot;/test/20190501-20190601/7c0795d3-9b7e-438b-bb5d-de3ead37baad/test-1.csv.gz&quot;</code> when its actual key should be <code>&quot;//test/20190501-20190601/7c0795c3-9b7e-437b-bb5d-de3ead37baad/test-1.csv.gz&quot;</code> .

If I call <code>:GetObject</code> on the key returned by aws-api, I get a NoSuchKey anomaly. If I try using the actual key with the <code>//</code>, I get a forbidden anomaly:
<pre>{:Error {:HostIdAttrs {},
         :StringToSignBytes &quot;...&quot;,
         :CanonicalRequestBytes &quot;...&quot;,
         :CanonicalRequestAttrs {},
         :Message &quot;The request signature we calculated does not match the signature you provided. Check your key and signing method.&quot;,
         :StringToSign &quot;AWS4-HMAC-SHA256
                        20200213T160537Z
                        20200213/us-west-2/s3/aws4_request
                        ...&quot;,
         :CodeAttrs {},
         :RequestIdAttrs {},
         :SignatureProvidedAttrs {},
         :HostId &quot;...&quot;,
         :StringToSignBytesAttrs {},
         :MessageAttrs {},
         :RequestId &quot;E92073AA791F0EB6&quot;,
         :Code &quot;SignatureDoesNotMatch&quot;,
         :SignatureProvided &quot;...&quot;,
         :AWSAccessKeyIdAttrs {},
         :CanonicalRequest &quot;GET
                            /compute-cost-reports//test/20190501-20190601/7c0795c3-9b7e-437b-bb5d-de3ead37baad/test-1.csv.gz
                            
                            host:
                            x-amz-content-sha256:...
                            x-amz-date:20200213T160537Z
                            
                            host;x-amz-content-sha256;x-amz-date
                            ...&quot;,
         :CanonicalRequestBytesAttrs {},
         :StringToSignAttrs {},
         :AWSAccessKeyId &quot;...&quot;},
 :ErrorAttrs {},
 :cognitect.anomalies/category :cognitect.anomalies/forbidden}</pre>
The object does actually exist under that path -- I can see it in the S3 console.</z><z id="t1581615327" t="dchelimsky What happens if you do the same with the aws cli?"><y>#</y><d>2020-02-13</d><h>17:35</h><w>dchelimsky</w>What happens if you do the same with the aws cli?</z><z id="t1581627938" t="kenny Listing: aws s3 ls PRE / 2020-02-12 19:22:09 4 aws-programmatic-access-test-object Get object: aws s3 cp . download: to ./test-Manifest.json"><y>#</y><d>2020-02-13</d><h>21:05</h><w>kenny</w>Listing:
<pre>aws s3 ls 
                           PRE /
2020-02-12 19:22:09          4 aws-programmatic-access-test-object</pre>
Get object:
<pre>aws s3 cp  .
download:  to ./test-Manifest.json</pre></z><z id="t1581627959" t="kenny It appears to work. The file is downloaded on my computer."><y>#</y><d>2020-02-13</d><h>21:05</h><w>kenny</w>It appears to work. The file is downloaded on my computer.</z><z id="t1581628190" t="kenny This is what it looks like in the console. It&apos;s definitely a strange case. However, it is the default for creating a CUR without a prefix so I&apos;d expect this to work."><y>#</y><d>2020-02-13</d><h>21:09</h><w>kenny</w>This is what it looks like in the console. It&apos;s definitely a strange case. However, it is the default for creating a CUR without a prefix so I&apos;d expect this to work.</z><z id="t1581628563" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] would you kindly submit another issue?"><y>#</y><d>2020-02-13</d><h>21:16</h><w>dchelimsky</w><a>@kenny</a> would you kindly submit another issue?</z><z id="t1581628906" t="ghadi what is a CUR?"><y>#</y><d>2020-02-13</d><h>21:21</h><w>ghadi</w>what is a CUR?</z><z id="t1581628910" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}]"><y>#</y><d>2020-02-13</d><h>21:21</h><w>ghadi</w><a>@kenny</a></z><z id="t1581628918" t="kenny cost and usage report"><y>#</y><d>2020-02-13</d><h>21:21</h><w>kenny</w>cost and usage report</z><z id="t1581629013" t="ghadi GetObjects shouldn&apos;t have leading slashes in the keys"><y>#</y><d>2020-02-13</d><h>21:23</h><w>ghadi</w>GetObjects shouldn&apos;t have leading slashes in the keys</z><z id="t1581629104" t="kenny It appears to work :man-shrugging: :skin-tone-2: Apparently the aws billing team thinks it&apos;s okay. It certainly seems very odd to me."><y>#</y><d>2020-02-13</d><h>21:25</h><w>kenny</w>It appears to work <b>:man-shrugging:</b><b>:skin-tone-2:</b> Apparently the aws billing team thinks it&apos;s okay. It certainly seems very odd to me.</z><z id="t1581629134" t="ghadi i thought you&apos;re posting because it doesn&apos;t appear to work"><y>#</y><d>2020-02-13</d><h>21:25</h><w>ghadi</w>i thought you&apos;re posting because it doesn&apos;t appear to work</z><z id="t1581629175" t="ghadi Note the aws cli is baroque &amp; does some unspecified transforms of cmdline arguments, and is not a canonical guide"><y>#</y><d>2020-02-13</d><h>21:26</h><w>ghadi</w>Note the aws cli is baroque &amp; does some unspecified transforms of cmdline arguments, and is not a canonical guide</z><z id="t1581629233" t="kenny aws-api does not support keys with a path like this //test/20190501-20190601/test-Manifest.json . The aws billing team stores CURs under that path if you don&apos;t specify a prefix."><y>#</y><d>2020-02-13</d><h>21:27</h><w>kenny</w>aws-api does not support keys with a path like this <code>//test/20190501-20190601/test-Manifest.json</code>. The aws billing team stores CURs under that path if you don&apos;t specify a prefix.</z><z id="t1581629258" t="ghadi there&apos;s no such thing as that path AFAIK"><y>#</y><d>2020-02-13</d><h>21:27</h><w>ghadi</w>there&apos;s no such thing as that path AFAIK</z><z id="t1581629269" t="kenny There is. Create a CUR with no prefix."><y>#</y><d>2020-02-13</d><h>21:27</h><w>kenny</w>There is. Create a CUR with no prefix.</z><z id="t1581629269" t="ghadi I think aws cli eats the //"><y>#</y><d>2020-02-13</d><h>21:27</h><w>ghadi</w>I think aws cli eats the <code>//</code></z><z id="t1581629303" t="ghadi please create a CUR and then aws s3 ls the bucket"><y>#</y><d>2020-02-13</d><h>21:28</h><w>ghadi</w>please create a CUR and then <code>aws s3 ls</code> the bucket</z><z id="t1581629322" t="kenny I think I did that above?"><y>#</y><d>2020-02-13</d><h>21:28</h><w>kenny</w>I think I did that above?</z><z id="t1581629342" t="ghadi the listing above says aws-programmatic-access-test-object"><y>#</y><d>2020-02-13</d><h>21:29</h><w>ghadi</w>the listing above says <code>aws-programmatic-access-test-object</code></z><z id="t1581629347" t="ghadi is that the one?"><y>#</y><d>2020-02-13</d><h>21:29</h><w>ghadi</w>is that the one?</z><z id="t1581629364" t="kenny Yes. There&apos;s 2 keys there. One that is / and one that is aws-programmatic-access-test-object"><y>#</y><d>2020-02-13</d><h>21:29</h><w>kenny</w>Yes. There&apos;s 2 keys there. One that is <code>/</code> and one that is <code>aws-programmatic-access-test-object</code></z><z id="t1581629460" t="ghadi I see"><y>#</y><d>2020-02-13</d><h>21:31</h><w>ghadi</w>I see</z><z id="t1581630028" t="kenny https://github.com/cognitect-labs/aws-api/issues/126"><y>#</y><d>2020-02-13</d><h>21:40</h><w>kenny</w><a href="https://github.com/cognitect-labs/aws-api/issues/126" target="_blank">https://github.com/cognitect-labs/aws-api/issues/126</a></z><z id="t1581630187" t="ghadi thanks, I added to it"><y>#</y><d>2020-02-13</d><h>21:43</h><w>ghadi</w>thanks, I added to it</z><z id="t1581630425" t="kenny This is what it looks like in the S3 console folders list. The first time I saw this, I didn&apos;t even think it was a folder."><y>#</y><d>2020-02-13</d><h>21:47</h><w>kenny</w>This is what it looks like in the S3 console folders list. The first time I saw this, I didn&apos;t even think it was a folder.</z><z id="t1581630522" t="ghadi https://github.com/cognitect-labs/aws-api/blob/5cf8f6c3a86392fa74423906bfe19685875f781f/src/cognitect/aws/signers.clj#L54"><y>#</y><d>2020-02-13</d><h>21:48</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/blob/5cf8f6c3a86392fa74423906bfe19685875f781f/src/cognitect/aws/signers.clj#L54" target="_blank">https://github.com/cognitect-labs/aws-api/blob/5cf8f6c3a86392fa74423906bfe19685875f781f/src/cognitect/aws/signers.clj#L54</a></z><z id="t1581630537" t="ghadi storing stuff with the / prefix is not a great idea 🙂"><y>#</y><d>2020-02-13</d><h>21:48</h><w>ghadi</w>storing stuff with the <code>/</code> prefix is not a great idea <b>🙂</b></z><z id="t1581630816" t="kenny Lovely"><y>#</y><d>2020-02-13</d><h>21:53</h><w>kenny</w>Lovely</z><z id="t1581630928" t="ghadi not sure if that&apos;s related, but it&apos;s suspect"><y>#</y><d>2020-02-13</d><h>21:55</h><w>ghadi</w>not sure if that&apos;s related, but it&apos;s suspect</z><z id="t1581631207" t="kenny Curious what the potential solution is if that&apos;s the problem. Not use https://java.net .URI?"><y>#</y><d>2020-02-13</d><h>22:00</h><r>kenny</r>Curious what the potential solution is if that&apos;s the problem. Not use <a href="https://java.net" target="_blank">https://java.net</a>.URI?</z><z id="t1581631828" t="dchelimsky I&apos;m sure that was chosen for a reason. I&apos;m pretty sure I added the (str/replace #&quot;//+&quot; &quot;/&quot;) when I was refactoring some things, but didn&apos;t question the choice of URI at the time."><y>#</y><d>2020-02-13</d><h>22:10</h><r>dchelimsky</r>I&apos;m sure that was chosen for a reason. I&apos;m pretty sure I added the <code>(str/replace #&quot;//+&quot; &quot;/&quot;)</code>  when I was refactoring some things, but didn&apos;t question the choice of URI at the time.</z><z id="t1581631877" t="dchelimsky More context: (-&gt; uri (str/replace #&quot;//+&quot; &quot;/&quot;) ; (URI.) throws Exception on &apos;//&apos;. (str/replace #&quot;\s&quot; &quot;%20&quot;); (URI.) throws Exception on space. (URI.) (.normalize) (.getPath) (uri-encode &quot;/&quot;))"><y>#</y><d>2020-02-13</d><h>22:11</h><r>dchelimsky</r>More context:
<pre>(-&gt; uri
                         (str/replace #&quot;//+&quot; &quot;/&quot;) ; (URI.) throws Exception on &apos;//&apos;.
                         (str/replace #&quot;\s&quot; &quot;%20&quot;); (URI.) throws Exception on space.
                         (URI.)
                         (.normalize)
                         (.getPath)
                         (uri-encode &quot;/&quot;))</pre></z><z id="t1581631928" t="dchelimsky So it looks like we&apos;re using URI to avoid having to do the work done in .normalize"><y>#</y><d>2020-02-13</d><h>22:12</h><r>dchelimsky</r>So it looks like we&apos;re using URI to avoid having to do the work done in <code>.normalize</code></z><z id="t1581631999" t="ghadi it might be a red herring"><y>#</y><d>2020-02-13</d><h>22:13</h><r>ghadi</r>it might be a red herring</z><z id="t1581632018" t="ghadi or URI might be doing unwanted things"><y>#</y><d>2020-02-13</d><h>22:13</h><r>ghadi</r>or URI might be doing unwanted things</z><z id="t1581632094" t="kenny FWIW, it sounds like // is a legal path https://stackoverflow.com/questions/20523318/is-a-url-with-in-the-path-section-valid"><y>#</y><d>2020-02-13</d><h>22:14</h><r>kenny</r>FWIW, it sounds like // is a legal path <a href="https://stackoverflow.com/questions/20523318/is-a-url-with-in-the-path-section-valid" target="_blank">https://stackoverflow.com/questions/20523318/is-a-url-with-in-the-path-section-valid</a></z><z id="t1581632180" t="dchelimsky &quot;So: yes, it is valid, no, don&apos;t use it.&quot; 🙂"><y>#</y><d>2020-02-13</d><h>22:16</h><r>dchelimsky</r>&quot;So: yes, it is valid, no, don&apos;t use it.&quot; <b>🙂</b></z><z id="t1581632343" t="ghadi user=&gt; (.normalize (.URI/create &quot;&quot;)) #object[.URI 0x54e81b21 &quot;&quot;]"><y>#</y><d>2020-02-13</d><h>22:19</h><r>ghadi</r><pre>user=&gt; (.normalize (.URI/create &quot;&quot;))
#object[.URI 0x54e81b21 &quot;&quot;]</pre></z><z id="t1581632400" t="dchelimsky You spelled foo wrong"><y>#</y><d>2020-02-13</d><h>22:20</h><r>dchelimsky</r>You spelled foo wrong</z><z id="t1581632409" t="ghadi my b"><y>#</y><d>2020-02-13</d><h>22:20</h><r>ghadi</r>my b</z><z id="t1581632612" t="dchelimsky From https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html : In exception to this, you do not normalize URI paths for requests to Amazon S3. For example, if you have a bucket with an object named my-object//example//photo.user, use that path. Normalizing the path to my-object/example/photo.user will cause the request to fail. For more information, see Task 1: Create a Canonical Request in the Amazon Simple Storage Service API Reference. "><y>#</y><d>2020-02-13</d><h>22:23</h><r>dchelimsky</r>From <a href="https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html" target="_blank">https://docs.aws.amazon.com/general/latest/gr/sigv4-create-canonical-request.html</a>:
<pre>In exception to this, you do not normalize URI paths for requests to Amazon S3. For example, if you have a bucket with an object named my-object//example//photo.user, use that path. Normalizing the path to my-object/example/photo.user will cause the request to fail. For more information, see Task 1: Create a Canonical Request in the Amazon Simple Storage Service API Reference. </pre></z><z id="t1581632620" t="dchelimsky We don&apos;t make that exception."><y>#</y><d>2020-02-13</d><h>22:23</h><r>dchelimsky</r>We don&apos;t make that exception.</z><z id="t1581632800" t="ghadi yup"><y>#</y><d>2020-02-13</d><h>22:26</h><r>ghadi</r>yup</z><z id="t1581632978" t="dchelimsky We do need to do it everywhere else, however."><y>#</y><d>2020-02-13</d><h>22:29</h><r>dchelimsky</r>We do need to do it everywhere else, however.</z><z id="t1581697216" t="agilecreativity Hi I trying to stream the result from aws s3 and process it. What I am trying is something like (def s3-result (aws/invoke client {:op :GetObject :request {:Bucket &quot;my-bucket&quot; :Key &quot;path/to/some/big-file.csv&quot; :Range &quot;bytes=0-30000&quot; ;; just an example })) ;; I want to process the file as it come in line-by-line without holding the things in memory (-&gt; s3-result :Body) ;;=&gt; this is of the type .BufferedInputStream I know that the result is available in the :Body after the request. Now does anyone know how to do this lazily?"><y>#</y><d>2020-02-14</d><h>16:20</h><w>agilecreativity</w>Hi
I  trying to stream the result from aws s3 and process it.
What I am trying is something like

<pre>(def s3-result (aws/invoke client {:op :GetObject 
                    :request {:Bucket &quot;my-bucket&quot;
                              :Key &quot;path/to/some/big-file.csv&quot;
                              :Range &quot;bytes=0-30000&quot; ;; just an example
                              }))

;; I want to process the file as it come in line-by-line without holding the things in memory

(-&gt; s3-result 
    :Body)
;;=&gt; this is of the type .BufferedInputStream</pre>
I know that the result is available in the <code>:Body</code> after the request.

Now does anyone know how to do this lazily?</z><z id="t1581697980" t="dchelimsky aws-api doesn&apos;t support streaming yet. https://github.com/cognitect-labs/aws-api/issues/14"><y>#</y><d>2020-02-14</d><h>16:33</h><w>dchelimsky</w>aws-api doesn&apos;t support streaming yet. <a href="https://github.com/cognitect-labs/aws-api/issues/14" target="_blank">https://github.com/cognitect-labs/aws-api/issues/14</a></z><z id="t1581698445" t="agilecreativity [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] Thanks for the clarification."><y>#</y><d>2020-02-14</d><h>16:40</h><r>agilecreativity</r><a>@U0ENYLGTA</a>
Thanks for the clarification.</z><z id="t1581698474" t="dchelimsky You&apos;re welcome."><y>#</y><d>2020-02-14</d><h>16:41</h><r>dchelimsky</r>You&apos;re welcome.</z><z id="t1581698128" t="dchelimsky We do plan to support &quot;bring your own http-client&quot; in the future, but there is no timeline for that."><y>#</y><d>2020-02-14</d><h>16:35</h><w>dchelimsky</w>We do plan to support &quot;bring your own http-client&quot; in the future, but there is no timeline for that.</z><z id="t1581709370" t="dchelimsky [ANN] Cognitect Labs&apos; aws-api 0.8.437 is now available! https://groups.google.com/forum/#!topic/clojure/AIQzOkhUDBU"><y>#</y><d>2020-02-14</d><h>19:42</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; aws-api 0.8.437 is now available! <a href="https://groups.google.com/forum/#!topic/clojure/AIQzOkhUDBU" target="_blank">https://groups.google.com/forum/#!topic/clojure/AIQzOkhUDBU</a></z><z id="t1581713923" t="souenzzo !Ref &quot;#off-topic&quot;"><y>#</y><d>2020-02-14</d><h>20:58</h><w>souenzzo</w>!Ref &quot;#off-topic&quot;</z><z id="t1581788872" t="kulminaator uh, the can-not-stream-s3 results is quite a mishap 😞 i have often objects that are hundreds of megs or even a few gigs in s3 that i access. no streaming is a no-go on these."><y>#</y><d>2020-02-15</d><h>17:47</h><w>kulminaator</w>uh, the can-not-stream-s3 results is quite a mishap <b>😞</b> i have often objects that are hundreds of megs or even a few gigs in s3 that i access. no streaming is a no-go on these.</z><z id="t1581793990" t="ghadi For now, you can hit the S3 GetObject and pass in a byte range (can do that concurrently)"><y>#</y><d>2020-02-15</d><h>19:13</h><w>ghadi</w>For now, you can hit the S3 GetObject and pass in a byte range (can do that concurrently)</z><z id="t1581794014" t="ghadi Upload is trickier"><y>#</y><d>2020-02-15</d><h>19:13</h><w>ghadi</w>Upload is trickier</z><z id="t1581849742" t="kulminaator big uploads are supposed to be in chunks anyway"><y>#</y><d>2020-02-16</d><h>10:42</h><w>kulminaator</w>big uploads are supposed to be in chunks anyway</z><z id="t1581849749" t="kulminaator even their own api suggests that"><y>#</y><d>2020-02-16</d><h>10:42</h><w>kulminaator</w>even their own api suggests that</z><z id="t1581946643" t="dchelimsky &gt; even their own api suggests that Unfortunately, their machine-readable API descriptor does not, so chunked uploads are a special case that we have to handle explicitly. It&apos;s on the list, but not alone. We&apos;ll get there sooner or later."><y>#</y><d>2020-02-17</d><h>13:37</h><w>dchelimsky</w>&gt;  even their own api suggests that
Unfortunately, their machine-readable API descriptor does not, so chunked uploads are a special case that we have to handle explicitly. It&apos;s on the list, but not alone. We&apos;ll get there sooner or later.</z><z id="t1581949329" t="ghadi [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] chunked uploads don&apos;t exist, but what was being referred to is Multipart upload, which we do support already. It&apos;s non-multipart, streamed upload (with the funky singing) that we don&apos;t support yet."><y>#</y><d>2020-02-17</d><h>14:22</h><w>ghadi</w><a>@dchelimsky</a> chunked uploads don&apos;t exist, but what was being referred to is Multipart upload, which we do support already.   It&apos;s non-multipart, streamed upload (with the funky singing) that we don&apos;t support yet.</z><z id="t1581949411" t="dchelimsky By &quot;funky singing&quot;, do you mean singing poorly or with a groove?"><y>#</y><d>2020-02-17</d><h>14:23</h><w>dchelimsky</w>By &quot;funky singing&quot;, do you mean singing poorly or with a groove?</z><z id="t1581949415" t="dchelimsky 😉"><y>#</y><d>2020-02-17</d><h>14:23</h><w>dchelimsky</w><b>😉</b></z><z id="t1581949424" t="ghadi lol"><y>#</y><d>2020-02-17</d><h>14:23</h><w>ghadi</w>lol</z><z id="t1581949433" t="ghadi need my coffee to start working 🙂"><y>#</y><d>2020-02-17</d><h>14:23</h><w>ghadi</w>need my coffee to start working <b>🙂</b></z><z id="t1581949450" t="ghadi s/sing/sign"><y>#</y><d>2020-02-17</d><h>14:24</h><w>ghadi</w>s/sing/sign</z><z id="t1581949485" t="dchelimsky Oh, now I get it! 😄"><y>#</y><d>2020-02-17</d><h>14:24</h><w>dchelimsky</w>Oh, now I get it! <b>😄</b></z><z id="t1581949537" t="ghadi :CreateMultipartUpload -*&gt; :UploadPart -&gt; :CompleteMultipartUpload"><y>#</y><d>2020-02-17</d><h>14:25</h><w>ghadi</w><code>:CreateMultipartUpload</code> -*&gt; <code>:UploadPart</code> -&gt;  <code>:CompleteMultipartUpload</code></z><z id="t1581953845" t="dchelimsky &gt; which we do support already To be clear - &quot;we do support&quot; it because the aws service descriptor describes it."><y>#</y><d>2020-02-17</d><h>15:37</h><w>dchelimsky</w>&gt; which we do support already
To be clear - &quot;we do support&quot; it because the aws service descriptor describes it.</z><z id="t1581953860" t="dchelimsky i.e. we&apos;re not doing anything special to do that"><y>#</y><d>2020-02-17</d><h>15:37</h><w>dchelimsky</w>i.e. we&apos;re not doing anything special to do that</z><z id="t1581953911" t="andrea.crotti anyone using the cognitec aws-api would have an idea what this means? {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;Property null is not supported&quot; :via [{:type java.lang.IllegalArgumentException :message &quot;Property null is not supported&quot; :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}] :trace [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246] [clojure.data.xml$new_xml_input_factory invokeStatic &quot;xml.clj&quot; 323] [clojure.data.xml$new_xml_input_factory invoke &quot;xml.clj&quot; 319] [clojure.data.xml$source_seq invokeStatic &quot;xml.clj&quot; 332] [clojure.data.xml$source_seq doInvoke &quot;xml.clj&quot; 326] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139] [clojure.core$apply invokeStatic &quot;core.clj&quot; 667] [clojure.core$apply invoke &quot;core.clj&quot; 660] [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 346] [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 340] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486] [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 137] [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 134] [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217] [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214] [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 247] [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235] [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260] [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249] [cognitect.aws.protocols.rest_xml$eval16877$fn__16878 invoke &quot;rest_xml.clj&quot; 23] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239] [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 48] [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 42] [cognitect.aws.client$send_request_STAR_$fn__15799 invoke &quot;client.clj&quot; 82] [clojure.core.async.impl.channels.ManyToManyChannel$fn__4659$fn__4660 invoke &quot;channels.clj&quot; 95] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628] [java.lang.Thread run &quot;Thread.java&quot; 835]]}}"><y>#</y><d>2020-02-17</d><h>15:38</h><w>andrea.crotti</w>anyone using the cognitec aws-api would have an idea what this means?

<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error {
 :cause &quot;Property null is not supported&quot;
 :via
 [{:type java.lang.IllegalArgumentException
   :message &quot;Property null is not supported&quot;
   :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}]
 :trace
 [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]
  [clojure.data.xml$new_xml_input_factory invokeStatic &quot;xml.clj&quot; 323]
  [clojure.data.xml$new_xml_input_factory invoke &quot;xml.clj&quot; 319]
  [clojure.data.xml$source_seq invokeStatic &quot;xml.clj&quot; 332]
  [clojure.data.xml$source_seq doInvoke &quot;xml.clj&quot; 326]
  [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139]
  [clojure.core$apply invokeStatic &quot;core.clj&quot; 667]
  [clojure.core$apply invoke &quot;core.clj&quot; 660]
  [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 346]
  [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 340]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486]
  [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 137]
  [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 134]
  [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217]
  [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214]
  [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 247]
  [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235]
  [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260]
  [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249]
  [cognitect.aws.protocols.rest_xml$eval16877$fn__16878 invoke &quot;rest_xml.clj&quot; 23]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239]
  [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 48]
  [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 42]
  [cognitect.aws.client$send_request_STAR_$fn__15799 invoke &quot;client.clj&quot; 82]
  [clojure.core.async.impl.channels.ManyToManyChannel$fn__4659$fn__4660 invoke &quot;channels.clj&quot; 95]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628]
  [java.lang.Thread run &quot;Thread.java&quot; 835]]}}</pre></z><z id="t1581953936" t="andrea.crotti I&apos;m trying to connect to a local minio server, and the config I copied exactly the same code from another project that actually works"><y>#</y><d>2020-02-17</d><h>15:38</h><w>andrea.crotti</w>I&apos;m trying to connect to a local minio server, and the config I copied exactly the same code from another project that actually works</z><z id="t1581953951" t="andrea.crotti the config passed to aws/client is identical as well, as the libraries versions"><y>#</y><d>2020-02-17</d><h>15:39</h><w>andrea.crotti</w>the config passed to <code>aws/client</code> is identical as well, as the libraries versions</z><z id="t1581953974" t="andrea.crotti if I upgrade the aws-api libraries it actually hangs forever instead and not even show this error"><y>#</y><d>2020-02-17</d><h>15:39</h><w>andrea.crotti</w>if I upgrade the aws-api libraries it actually hangs forever instead and not even show this error</z><z id="t1581954001" t="andrea.crotti the config is just something like {:api :s3, :region :eu-west-1, :endpoint-override {:protocol &quot;http&quot;, :hostname &quot;localhost&quot;, :port 9000}, :credentials-provider #object[cognitect.aws.credentials$basic_credentials_provider$reify__15734 0x695418f5 &quot;co and from the other project it still works perfectly fine"><y>#</y><d>2020-02-17</d><h>15:40</h><w>andrea.crotti</w>the config is just something like
<pre>{:api :s3,
 :region :eu-west-1,
 :endpoint-override
 {:protocol &quot;http&quot;, :hostname &quot;localhost&quot;, :port 9000},
 :credentials-provider
 #object[cognitect.aws.credentials$basic_credentials_provider$reify__15734 0x695418f5 &quot;co</pre>
and from the other project it still works perfectly fine</z><z id="t1581954715" t="andrea.crotti the weird thing is that not all operations fail, I can for example create a bucket"><y>#</y><d>2020-02-17</d><h>15:51</h><w>andrea.crotti</w>the weird thing is that not all operations fail, I can for example create a bucket</z><z id="t1581954784" t="dchelimsky &gt; if I upgrade the aws-api libraries it actually hangs forever instead and not even show this error Are you using aws-api 0.8.437?"><y>#</y><d>2020-02-17</d><h>15:53</h><w>dchelimsky</w>&gt;  if I upgrade the aws-api libraries it actually hangs forever instead and not even show this error
Are you using aws-api 0.8.437?</z><z id="t1581954892" t="dchelimsky &gt; the weird thing is that not all operations fail, I can for example create a bucket which op is causing that error?"><y>#</y><d>2020-02-17</d><h>15:54</h><w>dchelimsky</w>&gt; the weird thing is that not all operations fail, I can for example create a bucket
which op is causing that error?</z><z id="t1581955433" t="andrea.crotti ah yes ListBuckets is failing, and yeah it hangs with the latest version, but blow up with with &quot;0.8.408&quot;"><y>#</y><d>2020-02-17</d><h>16:03</h><w>andrea.crotti</w>ah yes <code>ListBuckets</code> is failing, and yeah it hangs with the latest version, but blow up with with &quot;0.8.408&quot;</z><z id="t1581955439" t="andrea.crotti I got the other ops to work though so I think it&apos;s all fine"><y>#</y><d>2020-02-17</d><h>16:03</h><w>andrea.crotti</w>I got the other ops to work though so I think it&apos;s all fine</z><z id="t1581955457" t="dchelimsky &quot;the latest version&quot; - you mean 0.8.437?"><y>#</y><d>2020-02-17</d><h>16:04</h><w>dchelimsky</w>&quot;the latest version&quot; - you mean 0.8.437?</z><z id="t1581955465" t="andrea.crotti yes sorry"><y>#</y><d>2020-02-17</d><h>16:04</h><w>andrea.crotti</w>yes sorry</z><z id="t1581955468" t="dchelimsky Thanks"><y>#</y><d>2020-02-17</d><h>16:04</h><w>dchelimsky</w>Thanks</z><z id="t1581955508" t="andrea.crotti they both don&apos;t work though, in different ways, but the same thing works on another project, so something funny in this project, just would be curious to know what that error could mean"><y>#</y><d>2020-02-17</d><h>16:05</h><w>andrea.crotti</w>they both don&apos;t work though, in different ways, but the same thing works on another project, so something funny in this project, just would be curious to know what that error could mean</z><z id="t1581955538" t="dchelimsky The error means that aws-api can&apos;t parse it&apos;s getting back from the server"><y>#</y><d>2020-02-17</d><h>16:05</h><w>dchelimsky</w>The error means that aws-api can&apos;t parse it&apos;s getting back from the server</z><z id="t1581955734" t="dchelimsky What do you get (in the repl) if you do this: (with-redefs [cognitect.aws.protocols.rest/parse-body (fn [_ body _] (println (cognitect.aws.util/bbuf-&gt;str body)))] (aws/invoke s3 {:op :ListBuckets}))"><y>#</y><d>2020-02-17</d><h>16:08</h><w>dchelimsky</w>What do you get (in the repl) if you do this:
<pre>(with-redefs [cognitect.aws.protocols.rest/parse-body (fn [_ body _] (println (cognitect.aws.util/bbuf-&gt;str body)))]
  (aws/invoke s3 {:op :ListBuckets}))</pre></z><z id="t1581956130" t="andrea.crotti &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;ListAllMyBucketsResult xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;&lt;Owner&gt;&lt;ID&gt;02d6176db174dc93cb1b899f7c6078f08654445fe8cf1b6ce98d8855f66bdbf4&lt;/ID&gt;&lt;DisplayName&gt;&lt;/DisplayName&gt;&lt;/Owner&gt;&lt;Buckets&gt;&lt;Bucket&gt;&lt;Name&gt;hello&lt;/Name&gt;&lt;CreationDate&gt;2020-02-17T15:45:02.969Z&lt;/CreationDate&gt;&lt;/Bucket&gt;&lt;Bucket&gt;&lt;Name&gt;test-bucket&lt;/Name&gt;&lt;CreationDate&gt;2020-02-17T16:11:46.874Z&lt;/CreationDate&gt;&lt;/Bucket&gt;&lt;/Buckets&gt;&lt;/ListAllMyBucketsResult&gt;"><y>#</y><d>2020-02-17</d><h>16:15</h><w>andrea.crotti</w><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ListAllMyBucketsResult xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;&lt;Owner&gt;&lt;ID&gt;02d6176db174dc93cb1b899f7c6078f08654445fe8cf1b6ce98d8855f66bdbf4&lt;/ID&gt;&lt;DisplayName&gt;&lt;/DisplayName&gt;&lt;/Owner&gt;&lt;Buckets&gt;&lt;Bucket&gt;&lt;Name&gt;hello&lt;/Name&gt;&lt;CreationDate&gt;2020-02-17T15:45:02.969Z&lt;/CreationDate&gt;&lt;/Bucket&gt;&lt;Bucket&gt;&lt;Name&gt;test-bucket&lt;/Name&gt;&lt;CreationDate&gt;2020-02-17T16:11:46.874Z&lt;/CreationDate&gt;&lt;/Bucket&gt;&lt;/Buckets&gt;&lt;/ListAllMyBucketsResult&gt;</pre></z><z id="t1581956173" t="andrea.crotti there is some content"><y>#</y><d>2020-02-17</d><h>16:16</h><w>andrea.crotti</w>there is some content</z><z id="t1581957112" t="dchelimsky I think the problem is the empty DisplayName."><y>#</y><d>2020-02-17</d><h>16:31</h><w>dchelimsky</w>I think the problem is the empty DisplayName.</z><z id="t1581957578" t="andrea.crotti interestingly now all my tests work locally, but it doesn&apos;t work on CI (just doesn&apos;t fetch an object after creating it), and trying again from the repl I get again that same problem"><y>#</y><d>2020-02-17</d><h>16:39</h><w>andrea.crotti</w>interestingly now all my tests work locally, but it doesn&apos;t work on CI (just doesn&apos;t fetch an object after creating it), and trying again from the repl I get again that same problem</z><z id="t1581957590" t="andrea.crotti where should the DisplayName come from btw?"><y>#</y><d>2020-02-17</d><h>16:39</h><w>andrea.crotti</w>where should the DisplayName come from btw?</z><z id="t1581957642" t="andrea.crotti the test is just (defn- create-test-bucket [] (aws/invoke (s3-client) {:op :CreateBucket :request {:Bucket (config/value [:s3 :bucket])}})) (deftest list-files-test (testing &quot;Uploading and fetching a file works&quot; (create-test-bucket) (sut/put-key &quot;resources/sample.txt&quot; &quot;sample.txt&quot;) (let [tmp-path (sut/fetch-key &quot;sample.txt&quot;)] (is (some? tmp-path)) (is (= (slurp tmp-path) (slurp &quot;resources/sample.txt&quot;))))))"><y>#</y><d>2020-02-17</d><h>16:40</h><w>andrea.crotti</w>the test is just
<pre>(defn- create-test-bucket
  []
  (aws/invoke (s3-client)
              {:op :CreateBucket
               :request {:Bucket (config/value [:s3 :bucket])}}))

(deftest list-files-test
  (testing &quot;Uploading and fetching a file works&quot;
    (create-test-bucket)
    (sut/put-key &quot;resources/sample.txt&quot; &quot;sample.txt&quot;)
    (let [tmp-path (sut/fetch-key &quot;sample.txt&quot;)]
      (is (some? tmp-path))
      (is (= (slurp tmp-path) (slurp &quot;resources/sample.txt&quot;))))))</pre></z><z id="t1581957678" t="dchelimsky I need to roll off here - wanna submit a github issue w/ all this info to keep it on the radar?"><y>#</y><d>2020-02-17</d><h>16:41</h><w>dchelimsky</w>I need to roll off here - wanna submit a github issue w/ all this info to keep it on the radar?</z><z id="t1581957687" t="dchelimsky https://github.com/cognitect-labs/aws-api/issues"><y>#</y><d>2020-02-17</d><h>16:41</h><w>dchelimsky</w><a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a></z><z id="t1581957736" t="andrea.crotti yeah if I can reproduce it enough, but one stupid question, I use (s3-client) to create the client more dynamically, maybe should I just have a global s3 as in the examples?"><y>#</y><d>2020-02-17</d><h>16:42</h><w>andrea.crotti</w>yeah if I can reproduce it enough, but one stupid question, I use
<code>(s3-client)</code> to create the client more dynamically, maybe should I just have a global <code>s3</code> as in the examples?</z><z id="t1581957742" t="andrea.crotti it should not matter right?"><y>#</y><d>2020-02-17</d><h>16:42</h><w>andrea.crotti</w>it should not matter right?</z><z id="t1581957773" t="dchelimsky I don&apos;t think that should matter for this issue."><y>#</y><d>2020-02-17</d><h>16:42</h><w>dchelimsky</w>I don&apos;t think that should matter for this issue.</z><z id="t1581961125" t="andrea.crotti uhm ok it turns out the problem on CI was just other AWS_* env variables shadowing the ones I was trying to set"><y>#</y><d>2020-02-17</d><h>17:38</h><w>andrea.crotti</w>uhm ok it turns out the problem on CI was just other AWS_* env variables shadowing the ones I was trying to set</z><z id="t1581961139" t="andrea.crotti that makes sense I guess but I should have ideally got some unauthorized error right?"><y>#</y><d>2020-02-17</d><h>17:38</h><w>andrea.crotti</w>that makes sense I guess but I should have ideally got some unauthorized error right?</z><z id="t1582037810" t="dchelimsky It sounds like you should, yes. Please submit a github issue."><y>#</y><d>2020-02-18</d><h>14:56</h><w>dchelimsky</w>It sounds like you should, yes. Please submit a github issue.</z><z id="t1582046018" t="gerred is com.cognitect/http-client open source? i couldn&apos;t find it. if it&apos;s not, how is it licensed wrt aws-api and are users of aws-api granted a license to re-distribute?"><y>#</y><d>2020-02-18</d><h>17:13</h><w>gerred</w>is <code>com.cognitect/http-client</code> open source? i couldn&apos;t find it. if it&apos;s not, how is it licensed wrt aws-api and are users of aws-api granted a license to re-distribute?</z><z id="t1582046057" t="ghadi it&apos;s open source but there&apos;s no github"><y>#</y><d>2020-02-18</d><h>17:14</h><w>ghadi</w>it&apos;s open source but there&apos;s no github</z><z id="t1582046061" t="gerred got it 👍"><y>#</y><d>2020-02-18</d><h>17:14</h><w>gerred</w>got it <b>👍</b></z><z id="t1582046077" t="gerred i&apos;m just putting together a list for a project. 🙂"><y>#</y><d>2020-02-18</d><h>17:14</h><w>gerred</w>i&apos;m just putting together a list for a project. <b>🙂</b></z><z id="t1582046080" t="ghadi also it&apos;s not a generic http client, and we&apos;re actively trying to get rid of it within aws-api"><y>#</y><d>2020-02-18</d><h>17:14</h><w>ghadi</w>also it&apos;s not a generic http client, and we&apos;re actively trying to get rid of it within aws-api</z><z id="t1582046085" t="gerred ahh ok"><y>#</y><d>2020-02-18</d><h>17:14</h><w>gerred</w>ahh ok</z><z id="t1582046094" t="ghadi it was made with datomic client in mind -- probably shouldn&apos;t have been used for aws-api"><y>#</y><d>2020-02-18</d><h>17:14</h><w>ghadi</w>it was made with datomic client in mind -- probably shouldn&apos;t have been used for aws-api</z><z id="t1582046178" t="gerred until it&apos;s removed, what&apos;s the license for it just so I can make sure I list it for now? is it covered in the scope of AWS API&apos;s copyright and license?"><y>#</y><d>2020-02-18</d><h>17:16</h><w>gerred</w>until it&apos;s removed, what&apos;s the license for it just so I can make sure I list it for now? is it covered in the scope of AWS API&apos;s copyright and license?</z><z id="t1582047413" t="Alex Miller (Clojure team) it&apos;s in the pom - it&apos;s ASL 2"><y>#</y><d>2020-02-18</d><h>17:36</h><w>Alex Miller (Clojure team)</w>it&apos;s in the pom - it&apos;s ASL 2</z><z id="t1582047444" t="Alex Miller (Clojure team) and the license file is in the jar"><y>#</y><d>2020-02-18</d><h>17:37</h><w>Alex Miller (Clojure team)</w>and the license file is in the jar</z><z id="t1582047713" t="gerred [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] AH thank you"><y>#</y><d>2020-02-18</d><h>17:41</h><w>gerred</w><a>@alexmiller</a> AH thank you</z><z id="t1582047714" t="gerred 👍"><y>#</y><d>2020-02-18</d><h>17:41</h><w>gerred</w><b>👍</b></z><z id="t1582047755" t="gerred [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] oh I should be clear"><y>#</y><d>2020-02-18</d><h>17:42</h><w>gerred</w><a>@alexmiller</a> oh I should be clear</z><z id="t1582047763" t="gerred this dependency, https://github.com/cognitect-labs/aws-api/blob/master/pom.xml#L46-L50 - I know about aws-api 😄"><y>#</y><d>2020-02-18</d><h>17:42</h><w>gerred</w>this dependency, <a href="https://github.com/cognitect-labs/aws-api/blob/master/pom.xml#L46-L50" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/pom.xml#L46-L50</a> - I know about aws-api <b>😄</b></z><z id="t1582047789" t="Alex Miller (Clojure team) that&apos;s what I&apos;m talking about"><y>#</y><d>2020-02-18</d><h>17:43</h><w>Alex Miller (Clojure team)</w>that&apos;s what I&apos;m talking about</z><z id="t1582047789" t="gerred i just have to check the box 😕"><y>#</y><d>2020-02-18</d><h>17:43</h><w>gerred</w>i just have to check the box <b>😕</b></z><z id="t1582047792" t="gerred is it in the pom?"><y>#</y><d>2020-02-18</d><h>17:43</h><w>gerred</w>is it in the pom?</z><z id="t1582047794" t="Alex Miller (Clojure team) yes"><y>#</y><d>2020-02-18</d><h>17:43</h><w>Alex Miller (Clojure team)</w>yes</z><z id="t1582047798" t="Alex Miller (Clojure team) and the jar"><y>#</y><d>2020-02-18</d><h>17:43</h><w>Alex Miller (Clojure team)</w>and the jar</z><z id="t1582047819" t="gerred yeah totally got you on the jar, I&apos;ll grab it from there"><y>#</y><d>2020-02-18</d><h>17:43</h><w>gerred</w>yeah totally got you on the jar, I&apos;ll grab it from there</z><z id="t1582047852" t="Alex Miller (Clojure team) https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.104/http-client-0.1.104.pom"><y>#</y><d>2020-02-18</d><h>17:44</h><w>Alex Miller (Clojure team)</w><a href="https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.104/http-client-0.1.104.pom" target="_blank">https://repo1.maven.org/maven2/com/cognitect/http-client/0.1.104/http-client-0.1.104.pom</a></z><z id="t1582047854" t="gerred oh"><y>#</y><d>2020-02-18</d><h>17:44</h><w>gerred</w>oh</z><z id="t1582047859" t="gerred i&apos;m a dunce"><y>#</y><d>2020-02-18</d><h>17:44</h><w>gerred</w>i&apos;m a dunce</z><z id="t1582047860" t="gerred sorry"><y>#</y><d>2020-02-18</d><h>17:44</h><w>gerred</w>sorry</z><z id="t1582047861" t="Alex Miller (Clojure team) and .jar"><y>#</y><d>2020-02-18</d><h>17:44</h><w>Alex Miller (Clojure team)</w>and .jar</z><z id="t1582047864" t="gerred i clearly need coffee."><y>#</y><d>2020-02-18</d><h>17:44</h><w>gerred</w>i clearly need coffee.</z><z id="t1582047898" t="gerred thank you. my brain couldn&apos;t make the mental jump to maven for whatever reason this morning. 😉"><y>#</y><d>2020-02-18</d><h>17:44</h><w>gerred</w>thank you. my brain couldn&apos;t make the mental jump to maven for whatever reason this morning. <b>😉</b></z><z id="t1582106152" t="andrea.crotti [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] should I report the auth bug even if it&apos;s not the latest version? I&apos;m trying to upgrade to the latest but again I have the same problem I had a few months ago in another project, finding the right version of the jetty packages that makes every dependency happy is a massive pain"><y>#</y><d>2020-02-19</d><h>09:55</h><w>andrea.crotti</w><a>@dchelimsky</a> should I report the auth bug even if it&apos;s not the latest version?
I&apos;m trying to upgrade to the latest but again I have the same problem I had a few months ago in another project, finding the right version of the jetty packages that makes every dependency happy is a massive pain</z><z id="t1582122048" t="dchelimsky I don&apos;t think this issue is affected by changes in recent versions, so yes, please go ahead."><y>#</y><d>2020-02-19</d><h>14:20</h><w>dchelimsky</w>I don&apos;t think this issue is affected by changes in recent versions, so yes, please go ahead.</z><z id="t1582122058" t="dchelimsky [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] ^^"><y>#</y><d>2020-02-19</d><h>14:20</h><w>dchelimsky</w><a>@andrea.crotti</a> ^^</z><z id="t1582284891" t="andrea.crotti any idea why I would get java.lang.Exception: Failed with error {:cognitect.anomalies/category :cognitect.anomalies/unavailable, :cognitect.aws.client/throwable nil} ? I&apos;m just doing a GetObject"><y>#</y><d>2020-02-21</d><h>11:34</h><w>andrea.crotti</w>any idea why I would get <code>java.lang.Exception: Failed with error {:cognitect.anomalies/category :cognitect.anomalies/unavailable, :cognitect.aws.client/throwable nil}</code> ? I&apos;m just doing a <code>GetObject</code></z><z id="t1582284954" t="andrea.crotti looking at the code it looks like it maps to a 504 from S3, which seems very weird?"><y>#</y><d>2020-02-21</d><h>11:35</h><w>andrea.crotti</w>looking at the code it looks like it maps to a 504 from S3, which seems very weird?</z><z id="t1582284969" t="andrea.crotti from the same machine accessing another bucket (with a different library) works fine"><y>#</y><d>2020-02-21</d><h>11:36</h><w>andrea.crotti</w>from the same machine accessing another bucket (with a different library) works fine</z><z id="t1582285001" t="andrea.crotti not sure it&apos;s really a S3 transient error since it always happens"><y>#</y><d>2020-02-21</d><h>11:36</h><w>andrea.crotti</w>not sure it&apos;s really a S3 transient error since it always happens</z><z id="t1582285146" t="ghadi Please inspect the metadata on the response"><y>#</y><d>2020-02-21</d><h>11:39</h><w>ghadi</w>Please inspect the metadata on the response</z><z id="t1582285223" t="andrea.crotti I can&apos;t do it easily where it fails since it fails only on staging, but well I&apos;ll have to add some logging I guess"><y>#</y><d>2020-02-21</d><h>11:40</h><w>andrea.crotti</w>I can&apos;t do it easily where it fails since it fails only on staging, but well I&apos;ll have to add some logging I guess</z><z id="t1582285266" t="andrea.crotti and sadly on staging we use ecs roles which also makes it harder to test from local, but thanks for the hint I&apos;ll log the meta data"><y>#</y><d>2020-02-21</d><h>11:41</h><w>andrea.crotti</w>and sadly on staging we use ecs roles which also makes it harder to test from local, but thanks for the hint I&apos;ll log the meta data</z><z id="t1582300353" t="andrea.crotti ok it was actually a connection refused"><y>#</y><d>2020-02-21</d><h>15:52</h><w>andrea.crotti</w>ok it was actually a connection refused</z><z id="t1582300373" t="andrea.crotti because I was trying to access the port 9000 on staging, just a config error"><y>#</y><d>2020-02-21</d><h>15:52</h><w>andrea.crotti</w>because I was trying to access the port 9000 on staging, just a config error</z><z id="t1582511896" t="kenny I updated to aws-api 0.8.437 and it appears to hang forever under certain conditions. Going down to 423 resolves the hang. I did take a thread dump during a hang. The below seems suspicious. I&apos;m still digging in to try and get a minimal repro."><y>#</y><d>2020-02-24</d><h>02:38</h><w>kenny</w>I updated to aws-api 0.8.437 and it appears to hang forever under certain conditions. Going down to 423 resolves the hang. I did take a thread dump during a hang. The below seems suspicious. I&apos;m still digging in to try and get a minimal repro.</z><z id="t1582512044" t="dchelimsky related? https://github.com/cognitect-labs/aws-api/issues/130"><y>#</y><d>2020-02-24</d><h>02:40</h><r>dchelimsky</r>related? <a href="https://github.com/cognitect-labs/aws-api/issues/130" target="_blank">https://github.com/cognitect-labs/aws-api/issues/130</a></z><z id="t1582512072" t="kenny Ah, we do assume a role."><y>#</y><d>2020-02-24</d><h>02:41</h><r>kenny</r>Ah, we do assume a role.</z><z id="t1582512101" t="dchelimsky I&apos;m looking at this right now, though I won&apos;t be for much longer tonight."><y>#</y><d>2020-02-24</d><h>02:41</h><r>dchelimsky</r>I&apos;m looking at this right now, though I won&apos;t be for much longer tonight.</z><z id="t1582512106" t="dchelimsky I&apos;ll let you know if I find anything."><y>#</y><d>2020-02-24</d><h>02:41</h><r>dchelimsky</r>I&apos;ll let you know if I find anything.</z><z id="t1582512131" t="kenny Haha. Ok great. Thank you."><y>#</y><d>2020-02-24</d><h>02:42</h><r>kenny</r>Haha. Ok great. Thank you.</z><z id="t1582512412" t="dchelimsky Found the problem"><y>#</y><d>2020-02-24</d><h>02:46</h><r>dchelimsky</r>Found the problem</z><z id="t1582512449" t="kenny What is it?"><y>#</y><d>2020-02-24</d><h>02:47</h><r>kenny</r>What is it?</z><z id="t1582512531" t="dchelimsky Actually, I&apos;m not quite sure I understand it yet, but the source is the thread pool of size 1 here: https://github.com/cognitect-labs/aws-api/blob/2d57c12218ed4cdc1bc8584ab2a1ecf689aff3f3/src/cognitect/aws/credentials.clj#L42"><y>#</y><d>2020-02-24</d><h>02:48</h><r>dchelimsky</r>Actually, I&apos;m not quite sure I understand it yet, but the source is the thread pool of size 1 here: <a href="https://github.com/cognitect-labs/aws-api/blob/2d57c12218ed4cdc1bc8584ab2a1ecf689aff3f3/src/cognitect/aws/credentials.clj#L42" target="_blank">https://github.com/cognitect-labs/aws-api/blob/2d57c12218ed4cdc1bc8584ab2a1ecf689aff3f3/src/cognitect/aws/credentials.clj#L42</a></z><z id="t1582512567" t="dchelimsky If I change that to size 2 it doesn&apos;t hang, so it appears that it&apos;s locking up when the one credentials provider is wrapped within the other."><y>#</y><d>2020-02-24</d><h>02:49</h><r>dchelimsky</r>If I change that to size 2 it doesn&apos;t hang, so it appears that it&apos;s locking up when the one credentials provider is wrapped within the other.</z><z id="t1582512588" t="dchelimsky Oh, I get it."><y>#</y><d>2020-02-24</d><h>02:49</h><r>dchelimsky</r>Oh, I get it.</z><z id="t1582512635" t="dchelimsky The outer provider&apos;s request happens first and can&apos;t return until the inner provider&apos;s request, which is issued second, returns."><y>#</y><d>2020-02-24</d><h>02:50</h><r>dchelimsky</r>The outer provider&apos;s request happens first and can&apos;t return until the inner provider&apos;s request, which is issued second, returns.</z><z id="t1582512733" t="kenny Ah"><y>#</y><d>2020-02-24</d><h>02:52</h><r>kenny</r>Ah</z><z id="t1582512956" t="dchelimsky Writing up a workaround in that issue ...."><y>#</y><d>2020-02-24</d><h>02:55</h><r>dchelimsky</r>Writing up a workaround in that issue ....</z><z id="t1582642767" t="dchelimsky I just released a fix for this: https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md#08445--2020-02-25"><y>#</y><d>2020-02-25</d><h>14:59</h><r>dchelimsky</r>I just released a fix for this: <a href="https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md#08445--2020-02-25" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md#08445--2020-02-25</a></z><z id="t1582644487" t="kenny Thanks!"><y>#</y><d>2020-02-25</d><h>15:28</h><r>kenny</r>Thanks!</z><z id="t1582644665" t="dchelimsky Sure. Please confirm it works for you."><y>#</y><d>2020-02-25</d><h>15:31</h><r>dchelimsky</r>Sure. Please confirm it works for you.</z><z id="t1582645277" t="kenny Ok, looking into it now."><y>#</y><d>2020-02-25</d><h>15:41</h><r>kenny</r>Ok, looking into it now.</z><z id="t1582647158" t="kenny Our tests are all passing. Going to deploy and let this marinate in the dev environment for a day."><y>#</y><d>2020-02-25</d><h>16:12</h><r>kenny</r>Our tests are all passing. Going to deploy and let this marinate in the dev environment for a day.</z><z id="t1582647391" t="dchelimsky Much appreciated!"><y>#</y><d>2020-02-25</d><h>16:16</h><r>dchelimsky</r>Much appreciated!</z><z id="t1582574470" t="slipset Quick question, We’re changing from using the aws java sdk for aws-ses. For logging/auditing we’ve been storing the messageId which the java sdk returns for a sent message. Is that available from the cognitect aws lib as well?"><y>#</y><d>2020-02-24</d><h>20:01</h><w>slipset</w>Quick question, We’re changing from using the aws java sdk for aws-ses. For logging/auditing we’ve been storing the <code>messageId</code> which the java sdk returns for a sent message. Is that available from the cognitect aws lib as well?</z><z id="t1582574576" t="ghadi [:attrs {:href &quot;/_/_/users/U04V5VAUN&quot;}] create an SES client, call (keys (aws/ops client)) to list the APIs you can call, then select the API you&apos;re calling and call (aws/doc client :APIYouWantToCall) . It will show you what it takes / returns"><y>#</y><d>2020-02-24</d><h>20:02</h><w>ghadi</w><a>@slipset</a> create an SES client, call <code>(keys (aws/ops client))</code> to list the APIs you can call, then select the API you&apos;re calling and call <code>(aws/doc client :APIYouWantToCall)</code>.  It will show you what it takes / returns</z><z id="t1582574765" t="dchelimsky [:attrs {:href &quot;/_/_/users/U04V5VAUN&quot;}] FYI although it is correct about what fields it accepts, it is not 100% correct about which fields are required, because AWS docs are not 100% correct about it. See https://github.com/cognitect-labs/aws-api/issues/129 /cc [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2020-02-24</d><h>20:06</h><w>dchelimsky</w><a>@slipset</a> FYI although it is correct about what fields it accepts, it is not 100% correct about which fields are required, because AWS docs are not 100% correct about it. See <a href="https://github.com/cognitect-labs/aws-api/issues/129" target="_blank">https://github.com/cognitect-labs/aws-api/issues/129</a> /cc <a>@ghadi</a></z><z id="t1582575653" t="slipset Thanks! Help appreciated."><y>#</y><d>2020-02-24</d><h>20:20</h><w>slipset</w>Thanks! Help appreciated.</z><z id="t1582647109" t="kenny Oh wow. Just noticed a bunch of functions in cognitect.aws.credentials have been pulled out into nice helpers. This cleans up a ton of code. Thank you!"><y>#</y><d>2020-02-25</d><h>16:11</h><w>kenny</w>Oh wow. Just noticed a bunch of functions in <code>cognitect.aws.credentials</code> have been pulled out into nice helpers. This cleans up a ton of code. Thank you!</z><z id="t1582647450" t="dchelimsky Just be sure to rely only on the documented functions 🙂"><y>#</y><d>2020-02-25</d><h>16:17</h><w>dchelimsky</w>Just be sure to rely only on the documented functions <b>🙂</b></z><z id="t1582647507" t="dchelimsky Functions with &quot;For internal use. Do not call directly.&quot; may change without warning."><y>#</y><d>2020-02-25</d><h>16:18</h><w>dchelimsky</w>Functions with &quot;For internal use. Do not call directly.&quot; may change without warning.</z><z id="t1582649708" t="andrea.crotti the aws libraries don&apos;t seem to be on Clojars, is that correct?"><y>#</y><d>2020-02-25</d><h>16:55</h><w>andrea.crotti</w>the aws libraries don&apos;t seem to be on Clojars, is that correct?</z><z id="t1582649734" t="dchelimsky Correct."><y>#</y><d>2020-02-25</d><h>16:55</h><w>dchelimsky</w>Correct.</z><z id="t1582649743" t="dchelimsky Just maven"><y>#</y><d>2020-02-25</d><h>16:55</h><w>dchelimsky</w>Just maven</z></g><g id="s10"><z id="t1582649758" t="andrea.crotti yeah ok cool, why if I may ask?"><y>#</y><d>2020-02-25</d><h>16:55</h><w>andrea.crotti</w>yeah ok cool, why if I may ask?</z><z id="t1582649763" t="andrea.crotti easier to have just in one place?"><y>#</y><d>2020-02-25</d><h>16:56</h><w>andrea.crotti</w>easier to have just in one place?</z><z id="t1582649789" t="dchelimsky Honestly, it was a decision made over a year ago. Don&apos;t remember why."><y>#</y><d>2020-02-25</d><h>16:56</h><w>dchelimsky</w>Honestly, it was a decision made over a year ago. Don&apos;t remember why.</z><z id="t1582649823" t="andrea.crotti yeah sure, the clojars badge saves some work imho for the readme"><y>#</y><d>2020-02-25</d><h>16:57</h><w>andrea.crotti</w>yeah sure, the  clojars badge saves some work imho for the readme</z><z id="t1582649876" t="ghadi [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] what badge?"><y>#</y><d>2020-02-25</d><h>16:57</h><w>ghadi</w><a>@andrea.crotti</a>  what badge?</z><z id="t1582650052" t="andrea.crotti this one for example"><y>#</y><d>2020-02-25</d><h>17:00</h><w>andrea.crotti</w>this one for example</z><z id="t1582650072" t="andrea.crotti you see it lots of libraries, just keeps track of the latest version automatically"><y>#</y><d>2020-02-25</d><h>17:01</h><w>andrea.crotti</w>you see it lots of libraries, just keeps track of the latest version automatically</z><z id="t1582650124" t="ghadi aws-api uses at least three artifacts to do anything useful"><y>#</y><d>2020-02-25</d><h>17:02</h><w>ghadi</w>aws-api uses at least three artifacts to do anything useful</z><z id="t1582650141" t="ghadi the client, the endpoints, and N&gt;=1 services that you&apos;re using"><y>#</y><d>2020-02-25</d><h>17:02</h><w>ghadi</w>the client, the endpoints, and N&gt;=1 services that you&apos;re using</z><z id="t1582650277" t="andrea.crotti kaocha does something similar, and with a nice table https://github.com/lambdaisland/kaocha"><y>#</y><d>2020-02-25</d><h>17:04</h><w>andrea.crotti</w>kaocha does something similar, and with a nice table
<a href="https://github.com/lambdaisland/kaocha" target="_blank">https://github.com/lambdaisland/kaocha</a></z><z id="t1582650544" t="dchelimsky There are badges for maven too, https://github.com/softwaremill/maven-badges"><y>#</y><d>2020-02-25</d><h>17:09</h><w>dchelimsky</w>There are badges for maven too, <a href="https://github.com/softwaremill/maven-badges" target="_blank">https://github.com/softwaremill/maven-badges</a></z><z id="t1582650578" t="dchelimsky The problem with them, however, is that you can&apos;t copy and paste from them into your deps.edn 😉"><y>#</y><d>2020-02-25</d><h>17:09</h><w>dchelimsky</w>The problem with them, however, is that you can&apos;t copy and paste from them into your deps.edn <b>😉</b></z><z id="t1582650592" t="ghadi i don&apos;t find this very useful unless it&apos;s copypastable, and I&apos;d prefer it to be in deps.edn format"><y>#</y><d>2020-02-25</d><h>17:09</h><w>ghadi</w>i don&apos;t find this very useful unless it&apos;s copypastable, and I&apos;d prefer it to be in deps.edn format</z><z id="t1582650592" t="dchelimsky What we have on aws-api is less pretty, but more useful IMO."><y>#</y><d>2020-02-25</d><h>17:09</h><w>dchelimsky</w>What we have on aws-api is less pretty, but more useful IMO.</z><z id="t1582650594" t="ghadi jinx"><y>#</y><d>2020-02-25</d><h>17:09</h><w>ghadi</w>jinx</z><z id="t1582650635" t="dchelimsky What [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] said (after I said it) 😉"><y>#</y><d>2020-02-25</d><h>17:10</h><w>dchelimsky</w>What <a>@ghadi</a> said (after I said it) <b>😉</b></z><z id="t1582650644" t="dchelimsky https://github.com/cognitect-labs/aws-api#deps and https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2020-02-25</d><h>17:10</h><w>dchelimsky</w><a href="https://github.com/cognitect-labs/aws-api#deps" target="_blank">https://github.com/cognitect-labs/aws-api#deps</a> and <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1582650773" t="andrea.crotti 👍"><y>#</y><d>2020-02-25</d><h>17:12</h><w>andrea.crotti</w><b>👍</b></z><z id="t1582650877" t="andrea.crotti I&apos;m struggling again with the same error {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;Property null is not supported&quot; :via"><y>#</y><d>2020-02-25</d><h>17:14</h><w>andrea.crotti</w>I&apos;m struggling again with the same error
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error {
 :cause &quot;Property null is not supported&quot;
 :via</pre></z><z id="t1582650894" t="andrea.crotti but this time when I try to do a ListObjects operation like (aws/invoke (s3-client) {:op :ListObjectsV2 :request {:Bucket &quot;bucket&quot;}})"><y>#</y><d>2020-02-25</d><h>17:14</h><w>andrea.crotti</w>but this time when I try to do a <code>ListObjects</code> operation like
<pre>(aws/invoke (s3-client) {:op :ListObjectsV2
                           :request {:Bucket &quot;bucket&quot;}})</pre></z><z id="t1582650914" t="andrea.crotti the returned XML seem to be something like &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;ListBucketResult xmlns=&quot;&quot;&gt;&lt;Name&gt;bucket&lt;/Name&gt;&lt;Prefix&gt;&lt;/Prefix&gt;&lt;KeyCount&gt;0&lt;/KeyCount&gt;&lt;MaxKeys&gt;10000&lt;/MaxKeys&gt;&lt;Delimiter&gt;&lt;/Delimiter&gt;&lt;IsTruncated&gt;false&lt;/IsTruncated&gt;&lt;/ListBucketResult&gt;"><y>#</y><d>2020-02-25</d><h>17:15</h><w>andrea.crotti</w>the returned XML seem to be something like
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;ListBucketResult xmlns=&quot;&quot;&gt;&lt;Name&gt;bucket&lt;/Name&gt;&lt;Prefix&gt;&lt;/Prefix&gt;&lt;KeyCount&gt;0&lt;/KeyCount&gt;&lt;MaxKeys&gt;10000&lt;/MaxKeys&gt;&lt;Delimiter&gt;&lt;/Delimiter&gt;&lt;IsTruncated&gt;false&lt;/IsTruncated&gt;&lt;/ListBucketResult&gt;</pre></z><z id="t1582650947" t="andrea.crotti with the same client/config putting and fetching an object works fine"><y>#</y><d>2020-02-25</d><h>17:15</h><w>andrea.crotti</w>with the same client/config putting and fetching an object works fine</z><z id="t1582650956" t="ghadi do you have the full :via stacktrace?"><y>#</y><d>2020-02-25</d><h>17:15</h><w>ghadi</w>do you have the full <code>:via</code> stacktrace?</z><z id="t1582650989" t="andrea.crotti [{:type java.lang.IllegalArgumentException :message &quot;Property null is not supported&quot; :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}] :trace [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246] [clojure.data.xml$new_xml_input_factory invokeStatic &quot;xml.clj&quot; 323] [clojure.data.xml$new_xml_input_factory invoke &quot;xml.clj&quot; 319] [clojure.data.xml$source_seq invokeStatic &quot;xml.clj&quot; 332] [clojure.data.xml$source_seq doInvoke &quot;xml.clj&quot; 326] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139] [clojure.core$apply invokeStatic &quot;core.clj&quot; 667] [clojure.core$apply invoke &quot;core.clj&quot; 660] [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 346] [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 340] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486] [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 137] [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 134] [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217] [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214] [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 247] [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235] [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260] [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249] [cognitect.aws.protocols.rest_xml$eval17611$fn__17612 invoke &quot;rest_xml.clj&quot; 23] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239] [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 48] [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 42] [cognitect.aws.client$send_request_STAR_$fn__24125 invoke &quot;client.clj&quot; 82] [clojure.core.async.impl.channels.ManyToManyChannel$fn__4659$fn__4660 invoke &quot;channels.clj&quot; 95] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628] [java.lang.Thread run &quot;Thread.java&quot; 835]]"><y>#</y><d>2020-02-25</d><h>17:16</h><w>andrea.crotti</w><pre>[{:type java.lang.IllegalArgumentException
   :message &quot;Property null is not supported&quot;
   :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}]
 :trace
 [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]
  [clojure.data.xml$new_xml_input_factory invokeStatic &quot;xml.clj&quot; 323]
  [clojure.data.xml$new_xml_input_factory invoke &quot;xml.clj&quot; 319]
  [clojure.data.xml$source_seq invokeStatic &quot;xml.clj&quot; 332]
  [clojure.data.xml$source_seq doInvoke &quot;xml.clj&quot; 326]
  [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139]
  [clojure.core$apply invokeStatic &quot;core.clj&quot; 667]
  [clojure.core$apply invoke &quot;core.clj&quot; 660]
  [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 346]
  [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 340]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486]
  [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 137]
  [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 134]
  [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217]
  [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214]
  [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 247]
  [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235]
  [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260]
  [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249]
  [cognitect.aws.protocols.rest_xml$eval17611$fn__17612 invoke &quot;rest_xml.clj&quot; 23]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239]
  [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 48]
  [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 42]
  [cognitect.aws.client$send_request_STAR_$fn__24125 invoke &quot;client.clj&quot; 82]
  [clojure.core.async.impl.channels.ManyToManyChannel$fn__4659$fn__4660 invoke &quot;channels.clj&quot; 95]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628]
  [java.lang.Thread run &quot;Thread.java&quot; 835]]</pre></z><z id="t1582651012" t="andrea.crotti same thing as what I had a few days ago, the error just says it can&apos;t parse the XML"><y>#</y><d>2020-02-25</d><h>17:16</h><w>andrea.crotti</w>same thing as what I had a few days ago, the error just says it can&apos;t parse the XML</z><z id="t1582651100" t="ghadi can you file an issue with this info and we can take a look at it?"><y>#</y><d>2020-02-25</d><h>17:18</h><w>ghadi</w>can you file an issue with this info and we can take a look at it?</z><z id="t1582651116" t="ghadi this stacktrace helps"><y>#</y><d>2020-02-25</d><h>17:18</h><w>ghadi</w>this stacktrace helps</z><z id="t1582651222" t="ghadi also [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] need the computed deps versions from your project (specifically for clojure.data.xml)"><y>#</y><d>2020-02-25</d><h>17:20</h><w>ghadi</w>also <a>@andrea.crotti</a> need the computed deps versions from your project (specifically for clojure.data.xml)</z><z id="t1582651274" t="andrea.crotti looks like it [org.clojure/data.xml &quot;0.0.8&quot;]"><y>#</y><d>2020-02-25</d><h>17:21</h><w>andrea.crotti</w>looks like it [org.clojure/data.xml &quot;0.0.8&quot;]</z><z id="t1582651298" t="andrea.crotti which should be the latest"><y>#</y><d>2020-02-25</d><h>17:21</h><w>andrea.crotti</w>which should be the latest</z><z id="t1582651304" t="ghadi https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L9"><y>#</y><d>2020-02-25</d><h>17:21</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L9" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L9</a></z><z id="t1582651312" t="ghadi 0.0.8 doesn&apos;t seem right"><y>#</y><d>2020-02-25</d><h>17:21</h><w>ghadi</w>0.0.8 doesn&apos;t seem right</z><z id="t1582651331" t="andrea.crotti latest stable at least"><y>#</y><d>2020-02-25</d><h>17:22</h><w>andrea.crotti</w>latest stable at least</z><z id="t1582651339" t="andrea.crotti from https://github.com/clojure/data.xml , but I can try to change it"><y>#</y><d>2020-02-25</d><h>17:22</h><w>andrea.crotti</w>from <a href="https://github.com/clojure/data.xml" target="_blank">https://github.com/clojure/data.xml</a>, but I can try to change it</z><z id="t1582651420" t="ghadi I wonder how your deps are getting overridden to the wrong version"><y>#</y><d>2020-02-25</d><h>17:23</h><w>ghadi</w>I wonder how your deps are getting overridden to the wrong version</z><z id="t1582651437" t="dchelimsky That&apos;s ~definitely~ most likely the issue."><y>#</y><d>2020-02-25</d><h>17:23</h><w>dchelimsky</w>That&apos;s ~definitely~ most likely the issue.</z><z id="t1582651541" t="dchelimsky And even though the data.xml version is alpha6, it&apos;s been that way since Nov 2018. That&apos;s one definition of stable 😉"><y>#</y><d>2020-02-25</d><h>17:25</h><w>dchelimsky</w>And even though the data.xml version is alpha6, it&apos;s been that way since Nov 2018. That&apos;s one definition of stable <b>😉</b></z><z id="t1582651605" t="dchelimsky [:attrs {:href &quot;/_/_/users/U0524T275&quot;}] are you using tools.deps, leiningen, other?"><y>#</y><d>2020-02-25</d><h>17:26</h><w>dchelimsky</w><a>@andrea.crotti</a> are you using tools.deps, leiningen, other?</z><z id="t1582651672" t="andrea.crotti ah well sadly upgrading data.xml makes something else blow up"><y>#</y><d>2020-02-25</d><h>17:27</h><w>andrea.crotti</w>ah well sadly upgrading data.xml makes something else blow up</z><z id="t1582651675" t="andrea.crotti so I can&apos;t try it directly"><y>#</y><d>2020-02-25</d><h>17:27</h><w>andrea.crotti</w>so I can&apos;t try it directly</z><z id="t1582651683" t="andrea.crotti but I&apos;ll keep digging"><y>#</y><d>2020-02-25</d><h>17:28</h><w>andrea.crotti</w>but I&apos;ll keep digging</z><z id="t1582651689" t="andrea.crotti thanks in the meanwhile"><y>#</y><d>2020-02-25</d><h>17:28</h><w>andrea.crotti</w>thanks in the meanwhile</z><z id="t1582651696" t="ghadi you should inspect your lein deps :tree for conflicts"><y>#</y><d>2020-02-25</d><h>17:28</h><w>ghadi</w>you should inspect your <code>lein deps :tree</code> for conflicts</z><z id="t1582652350" t="andrea.crotti no it&apos;s just some code we have in a utils.clj file"><y>#</y><d>2020-02-25</d><h>17:39</h><w>andrea.crotti</w>no it&apos;s just some code we have in a utils.clj file</z><z id="t1582697553" t="mbbaldwin I&apos;m trying to save multiple records to DynamoDB using cognitect-labs/aws-api (as per example found here https://github.com/cognitect-labs/aws-api/blob/master/examples/dynamodb_examples.clj ) but while it seems that it&apos;s set up the same as the examples I&apos;m clearly doing something wrong. The image shows &quot;user errors&quot; which are described as 400 errors due to poor formatting. My code is similar to this: (def ddb (aws/client {:api :dynamodb})) (defn save-stuff [] (aws/invoke ddb {:op :BatchWriteItem, :request {:RequestItems {&quot;twitter-sentiment&quot; [{&quot;PutRequest&quot; {&quot;Item&quot; {&quot;twitter-id&quot; {:S &quot;1232539310127140864&quot;}, &quot;lang&quot; {:S &quot;en&quot;}}}} {&quot;PutRequest&quot; {&quot;Item&quot; {&quot;twitter-id&quot; {:S &quot;1232539306297823232&quot;}, &quot;lang&quot; {:S &quot;en&quot;}}}}]}}} Any idea what I&apos;m doing wrong?"><y>#</y><d>2020-02-26</d><h>06:12</h><w>mbbaldwin</w>I&apos;m trying to save multiple records to DynamoDB using cognitect-labs/aws-api (as per example found here <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/dynamodb_examples.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/dynamodb_examples.clj</a>) but while it seems that it&apos;s set up the same as the examples I&apos;m clearly doing something wrong. The image shows &quot;user errors&quot; which are described as <code>400</code> errors due to poor formatting. My code is similar to this:
<pre>(def ddb (aws/client {:api :dynamodb}))

(defn save-stuff []
  (aws/invoke ddb {:op :BatchWriteItem,
                   :request
                     {:RequestItems
                      {&quot;twitter-sentiment&quot;
                        [{&quot;PutRequest&quot;
                           {&quot;Item&quot;
                             {&quot;twitter-id&quot; {:S &quot;1232539310127140864&quot;}, &quot;lang&quot; {:S &quot;en&quot;}}}}
                         {&quot;PutRequest&quot;
                           {&quot;Item&quot;
                             {&quot;twitter-id&quot; {:S &quot;1232539306297823232&quot;}, &quot;lang&quot; {:S &quot;en&quot;}}}}]}}}</pre>
Any idea what I&apos;m doing wrong?</z><z id="t1582726474" t="dchelimsky [:attrs {:href &quot;/_/_/users/U0Q032M8B&quot;}] what is the output of invoking save-stuff ? Also, what is the metadata of that output? (meta (save-stuff)) ."><y>#</y><d>2020-02-26</d><h>14:14</h><r>dchelimsky</r><a>@U0Q032M8B</a> what is the output of invoking <code>save-stuff</code>? Also, what is the metadata of that output? <code>(meta (save-stuff))</code>.</z><z id="t1582732274" t="mbbaldwin [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] Oh sorry I should have mentioned that (late night with a sick kid put it out of my mind). There is no console output. The metadata for the fn is: {:http-request {:request-method :post, :scheme :https, :server-port 443, :uri &quot;/&quot;, :headers {&quot;x-amz-date&quot; &quot;20200226T154816Z&quot;, &quot;x-amz-target&quot; &quot;DynamoDB_20120810.BatchWriteItem&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;, &quot;host&quot; &quot;&quot;, &quot;x-amz-security-token&quot; [really long token], &quot;authorization&quot; [authorization-stuff]}, :body #object[java.nio.HeapByteBuffer 0x587a1cfb &quot;java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]&quot;], :server-name &quot;&quot;}, :http-response {:status 400, :headers {&quot;server&quot; &quot;Server&quot;, &quot;connection&quot; &quot;keep-alive&quot;, &quot;x-amzn-requestid&quot; &quot;KTLRO9VJ2L47DJAV84A3QT7UDFVV4KQNSO5AEMVJF66Q9ASUAAJG&quot;, &quot;x-amz-crc32&quot; &quot;3101795386&quot;, &quot;content-length&quot; &quot;179&quot;, &quot;date&quot; &quot;Wed, 26 Feb 2020 15:48:16 GMT&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;}, :body #object[.BufferedInputStream 0x5fa23c &quot;"><y>#</y><d>2020-02-26</d><h>15:51</h><r>mbbaldwin</r><a>@U0ENYLGTA</a> Oh sorry I should have mentioned that (late night with a sick kid put it out of my mind).
There is no console output. The metadata for the fn is:
<pre>{:http-request
 {:request-method :post,
  :scheme :https,
  :server-port 443,
  :uri &quot;/&quot;,
  :headers
  {&quot;x-amz-date&quot; &quot;20200226T154816Z&quot;,
   &quot;x-amz-target&quot; &quot;DynamoDB_20120810.BatchWriteItem&quot;,
   &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;,
   &quot;host&quot; &quot;&quot;,
   &quot;x-amz-security-token&quot; [really long token],
   &quot;authorization&quot; [authorization-stuff]},
  :body
  #object[java.nio.HeapByteBuffer 0x587a1cfb &quot;java.nio.HeapByteBuffer[pos=0 lim=46 cap=46]&quot;],
  :server-name &quot;&quot;},
 :http-response
 {:status 400,
  :headers
  {&quot;server&quot; &quot;Server&quot;,
   &quot;connection&quot; &quot;keep-alive&quot;,
   &quot;x-amzn-requestid&quot;
   &quot;KTLRO9VJ2L47DJAV84A3QT7UDFVV4KQNSO5AEMVJF66Q9ASUAAJG&quot;,
   &quot;x-amz-crc32&quot; &quot;3101795386&quot;,
   &quot;content-length&quot; &quot;179&quot;,
   &quot;date&quot; &quot;Wed, 26 Feb 2020 15:48:16 GMT&quot;,
   &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;},
  :body
  #object[.BufferedInputStream 0x5fa23c &quot;</pre></z><z id="t1582732447" t="mbbaldwin FYI: I&apos;m also not setting up the tables in the code, and the lang field doesn&apos;t exist on the table yet. Not sure if that&apos;s pertinent or not."><y>#</y><d>2020-02-26</d><h>15:54</h><r>mbbaldwin</r>FYI: I&apos;m also not setting up the tables in the code, and the <code>lang</code> field doesn&apos;t exist on the table yet. Not sure if that&apos;s pertinent or not.</z><z id="t1582733946" t="dchelimsky I tried BatchWriteItem with a missing attribute and got back error information."><y>#</y><d>2020-02-26</d><h>16:19</h><r>dchelimsky</r>I tried <code>BatchWriteItem</code> with a missing attribute and got back error information.</z><z id="t1582734233" t="mbbaldwin A missing attribute? Since DynamoDB is a schema-less db, shouldn&apos;t it not matter what objects you put in it (as long as it has the required id specified for the table)? (Meaning you can add attributes or leave them off as needed.)"><y>#</y><d>2020-02-26</d><h>16:23</h><r>mbbaldwin</r>A missing attribute? Since DynamoDB is a schema-less db, shouldn&apos;t it not matter what objects you put in it (as long as it has the required <code>id</code> specified for the table)? (Meaning you can add attributes or leave them off as needed.)</z><z id="t1582735226" t="dchelimsky If I comment out the &quot;Subject&quot; attribute when creating the &quot;Thread&quot; table in the ddb example ( https://github.com/cognitect-labs/aws-api/blob/2e4bca75d51e9557608071d061db985e38dc005d/examples/dynamodb_examples.clj#L44 ), then I get {:__type &quot;com.amazon.coral.validate#ValidationException&quot;, :message &quot;Provided list of item keys contains duplicates&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} back from WriteBatchItem . Not clear on why that is yet, but the point is that I&apos;m getting some feedback and you&apos;re saying you&apos;re not getting any."><y>#</y><d>2020-02-26</d><h>16:40</h><r>dchelimsky</r>If I comment out the &quot;Subject&quot; attribute when creating the &quot;Thread&quot; table in the ddb example (<a href="https://github.com/cognitect-labs/aws-api/blob/2e4bca75d51e9557608071d061db985e38dc005d/examples/dynamodb_examples.clj#L44" target="_blank">https://github.com/cognitect-labs/aws-api/blob/2e4bca75d51e9557608071d061db985e38dc005d/examples/dynamodb_examples.clj#L44</a>), then I get
<pre>{:__type &quot;com.amazon.coral.validate#ValidationException&quot;,
  :message &quot;Provided list of item keys contains duplicates&quot;,
  :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre>
back from <code>WriteBatchItem</code>. Not clear on why that is yet, but the point is that I&apos;m getting some feedback and you&apos;re saying you&apos;re not getting any.</z><z id="t1582735936" t="mbbaldwin Correct. I&apos;m calling it from AWS Lambda, but I&apos;m still expecting something."><y>#</y><d>2020-02-26</d><h>16:52</h><r>mbbaldwin</r>Correct. I&apos;m calling it from AWS Lambda, but I&apos;m still expecting something.</z><z id="t1582736156" t="dchelimsky Please submit an issue for this, and include all the dependency information, etc."><y>#</y><d>2020-02-26</d><h>16:55</h><r>dchelimsky</r>Please submit an issue for this, and include all the dependency information, etc.</z><z id="t1582736322" t="mbbaldwin Okay, will do when I&apos;m done with work or during lunch."><y>#</y><d>2020-02-26</d><h>16:58</h><r>mbbaldwin</r>Okay, will do when I&apos;m done with work or during lunch.</z><z id="t1582736752" t="mbbaldwin An unrelated question I had that I couldn&apos;t find any examples for, when adding a sub-map is the proper syntax to add a vector of attribute maps? Like this: ... {&quot;PutRequest&quot; {&quot;Item&quot; {&quot;id&quot; {:S id} &quot;x&quot; {:M [{:height {:N &quot;16&quot;}} {:name {:S &quot;John&quot;}}]}}} ..."><y>#</y><d>2020-02-26</d><h>17:05</h><r>mbbaldwin</r>An unrelated question I had that I couldn&apos;t find any examples for, when adding a sub-map is the proper syntax to add a vector of attribute maps? Like this:
<pre>...
{&quot;PutRequest&quot; {&quot;Item&quot; {&quot;id&quot; {:S id}
                       &quot;x&quot; {:M [{:height {:N &quot;16&quot;}} {:name {:S &quot;John&quot;}}]}}}
...</pre></z><z id="t1582736918" t="dchelimsky Does this help? https://github.com/cognitect-labs/aws-api/blob/master/examples/resources/dynamodb/Thread.json#L30-L42"><y>#</y><d>2020-02-26</d><h>17:08</h><r>dchelimsky</r>Does this help? <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/resources/dynamodb/Thread.json#L30-L42" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/resources/dynamodb/Thread.json#L30-L42</a></z><z id="t1582736977" t="dchelimsky That&apos;s json from examples from AWS. In aws-api, keys like &quot;L&quot; need to be keywords like :L ."><y>#</y><d>2020-02-26</d><h>17:09</h><r>dchelimsky</r>That&apos;s json from examples from AWS. In aws-api, keys like &quot;L&quot; need to be keywords like <code>:L</code> .</z><z id="t1582737435" t="mbbaldwin Oh, okay. That thought that was &quot;L&quot; for &quot;List&quot;. Yes that helps."><y>#</y><d>2020-02-26</d><h>17:17</h><r>mbbaldwin</r>Oh, okay. That thought that was &quot;L&quot; for &quot;List&quot;. Yes that helps.</z><z id="t1582752189" t="mbbaldwin https://github.com/cognitect-labs/aws-api/issues/131"><y>#</y><d>2020-02-26</d><h>21:23</h><r>mbbaldwin</r><a href="https://github.com/cognitect-labs/aws-api/issues/131" target="_blank">https://github.com/cognitect-labs/aws-api/issues/131</a></z><z id="t1582752321" t="dchelimsky Thx"><y>#</y><d>2020-02-26</d><h>21:25</h><r>dchelimsky</r>Thx</z><z id="t1582752387" t="mbbaldwin No, thank you! 🙂"><y>#</y><d>2020-02-26</d><h>21:26</h><r>mbbaldwin</r>No, thank you! <b>🙂</b></z><z id="t1582842170" t="kennytilton Has anyone had any luck computing a :content-md5 satisfactory to Amazon S3, via Amazonica? One twist is that I am gzipping my content, but I tried computing the MD5 off both the gzipped and ungzipped content, no luck. The google got me this far computing the md5 param: (-&gt; (util/json-to-gzip-bytearray &quot;helloworld&quot;) digest/md5 bs/to-byte-array (bt/encode :base64 {:url-safe? false}) bs/to-string) FWIW, I stored once without the MD5 and then got back S3s MD5, &quot;gwD+BwffF71J92+mTz2LPA==&quot;, and that works dandy. My code above yields &quot;ODMwMGZlMDcwN2RmMTdiZDQ5Zjc2ZmE2NGYzZDhiM2M=&quot;. Just a hair off. : I also saw somewhere that the MD5 digest must be converted from hex to integer and _that_ converted to base64. Tried that, no luck. Any tips, links, guesses are welcome! Thx."><y>#</y><d>2020-02-27</d><h>22:22</h><w>kennytilton</w><pre>Has anyone had any luck computing a :content-md5 satisfactory to Amazon S3, via Amazonica?

One twist is that I am gzipping my content, but I tried computing the MD5 off both the gzipped and ungzipped content, no luck. 

The google got me this far computing the md5 param:

(-&gt; (util/json-to-gzip-bytearray &quot;helloworld&quot;)
      digest/md5
      bs/to-byte-array
      (bt/encode :base64 {:url-safe? false})
      bs/to-string)

FWIW, I stored once without the MD5 and then got back S3s MD5, &quot;gwD+BwffF71J92+mTz2LPA==&quot;, and that works dandy. My code above yields &quot;ODMwMGZlMDcwN2RmMTdiZDQ5Zjc2ZmE2NGYzZDhiM2M=&quot;. Just a hair off. :

I also saw somewhere that the MD5 digest must be converted from hex to integer and _that_ converted to base64. Tried that, no luck.

Any tips, links, guesses are welcome! Thx.</pre></z><z id="t1582842489" t="hiredman I would be very suspicious of all that code"><y>#</y><d>2020-02-27</d><h>22:28</h><w>hiredman</w>I would be very suspicious of  all that code</z><z id="t1582842499" t="hiredman very easy to get encoding, or bytes vs. characters wrong"><y>#</y><d>2020-02-27</d><h>22:28</h><w>hiredman</w>very easy to get encoding, or bytes vs. characters wrong</z><z id="t1582842532" t="hiredman the java code for getting an md5sum should just return a byte array"><y>#</y><d>2020-02-27</d><h>22:28</h><w>hiredman</w>the java code for getting an md5sum should just return a byte array</z><z id="t1582842565" t="shaun-mahood [:attrs {:href &quot;/_/_/users/U0PUGPSFR&quot;}] I&apos;ve been able to calculate matching MD5s using https://github.com/tebeka/clj-digest , comparing my local files with what comes back from https://github.com/cognitect-labs/aws-api/"><y>#</y><d>2020-02-27</d><h>22:29</h><w>shaun-mahood</w><a>@hiskennyness</a> I&apos;ve been able to calculate matching MD5s using <a href="https://github.com/tebeka/clj-digest" target="_blank">https://github.com/tebeka/clj-digest</a>, comparing my local files with what comes back from <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a></z><z id="t1582842703" t="shaun-mahood Here&apos;s my comparison code (defn duplicate-file? [s3-file local-file] (when (some? s3-file) (let [s3-md5 (str/replace (:ETag s3-file) &quot;\&quot;&quot; &quot;&quot;) local-md5 (digest/md5 local-file)] (= local-md5 s3-md5))))"><y>#</y><d>2020-02-27</d><h>22:31</h><r>shaun-mahood</r>Here&apos;s my comparison code
<pre>(defn duplicate-file? [s3-file local-file]
  (when (some? s3-file)
    (let [s3-md5 (str/replace (:ETag s3-file) &quot;\&quot;&quot; &quot;&quot;)
          local-md5 (digest/md5 local-file)]
      (= local-md5 s3-md5))))</pre></z><z id="t1582843001" t="kennytilton Interesting. I will explore that. But S3 wants a base64 encoding passed to it if I want it to validate my upload, and I think that is where I am stuck. Thx, tho! I will learn sth playing with that."><y>#</y><d>2020-02-27</d><h>22:36</h><r>kennytilton</r>Interesting. I will explore that. But S3 wants a base64 encoding passed to it if I want it to validate my upload, and I think that is where I am stuck. Thx, tho! I will learn sth playing with that.</z><z id="t1582843336" t="shaun-mahood I think you should be able to use digest to calculate the correct md5, at least assuming that AWS wants it in the same format as they pass back to you. I struggled with this quite a bit and it was all related to how I was reading and writing my files - when I brought it in to Clojure to calculate the md5 I was screwing something up and calculating the hash on the wrong data. Had to get it pulling out a byte-array properly, and for most of my troubleshooting I thought I was performing an incorrect hash on the correct data."><y>#</y><d>2020-02-27</d><h>22:42</h><r>shaun-mahood</r>I think you should be able to use digest to calculate the correct md5, at least assuming that AWS wants it in the same format as they pass back to you.
I struggled with this quite a bit and it was all related to how I was reading and writing my files - when I brought it in to Clojure to calculate the md5 I was screwing something up and calculating the hash on the wrong data. Had to get it pulling out a byte-array properly, and for most of my troubleshooting I thought I was performing an incorrect hash on the correct data.</z><z id="t1582843904" t="ghadi [:attrs {:href &quot;/_/_/users/U054BUGT4&quot;}] do you have to strip those quotes in other libraries, or just aws-api?"><y>#</y><d>2020-02-27</d><h>22:51</h><r>ghadi</r><a>@U054BUGT4</a> do you have to strip those quotes in other libraries, or just aws-api?</z><z id="t1582844022" t="shaun-mahood I&apos;ve only used aws-api to get that data, so I&apos;m not sure how the etag data is returned in other libraries"><y>#</y><d>2020-02-27</d><h>22:53</h><r>shaun-mahood</r>I&apos;ve only used aws-api to get that data, so I&apos;m not sure how the etag data is returned in other libraries</z><z id="t1582844763" t="hiredman I recall s3 adding extra quotes around the etag header you get back"><y>#</y><d>2020-02-27</d><h>23:06</h><r>hiredman</r>I recall s3 adding extra quotes around the etag header you get back</z><z id="t1582844915" t="hiredman https://github.com/hiredman/propS3t/blob/master/src/propS3t/core.clj#L189 is where I had to slice them off for multipart uploads when doing the s3 thing via the rest api (but that is super old code, I haven&apos;t looked at the s3 rest api in a long time)"><y>#</y><d>2020-02-27</d><h>23:08</h><r>hiredman</r><a href="https://github.com/hiredman/propS3t/blob/master/src/propS3t/core.clj#L189" target="_blank">https://github.com/hiredman/propS3t/blob/master/src/propS3t/core.clj#L189</a> is where I had to slice them off for multipart uploads when doing the s3 thing via the rest api (but that is super old code, I haven&apos;t looked at the s3 rest api in a long time)</z><z id="t1582845467" t="ghadi ok cool... I know aws-api handles all string datatypes in the same way..."><y>#</y><d>2020-02-27</d><h>23:17</h><r>ghadi</r>ok cool... I know aws-api handles all string datatypes in the same way...</z><z id="t1582845485" t="ghadi so it probably wasn&apos;t the lib"><y>#</y><d>2020-02-27</d><h>23:18</h><r>ghadi</r>so it probably wasn&apos;t the lib</z><z id="t1582882633" t="kennytilton OMG. (:import [com.amazonaws.util Md5Utils]) ..... (Md5Utils/md5AsBase64 data-gzipped)"><y>#</y><d>2020-02-28</d><h>09:37</h><r>kennytilton</r>OMG.
<pre>(:import [com.amazonaws.util Md5Utils])
.....
(Md5Utils/md5AsBase64 data-gzipped)</pre></z><z id="t1582882880" t="kennytilton After a day of googling &quot;Clojure S3 content MD5&quot; and not doing very well it occurred to me to try other languages. Including Java. 🙂 https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/util/Md5Utils.html Bingo."><y>#</y><d>2020-02-28</d><h>09:41</h><r>kennytilton</r>After a day of googling &quot;Clojure S3 content MD5&quot; and not doing very well it occurred to me to try other languages. Including Java. <b>🙂</b> <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/util/Md5Utils.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/util/Md5Utils.html</a> Bingo.</z><z id="t1582882914" t="kennytilton Too easy. 🙂 Thanks for pitching in, all!"><y>#</y><d>2020-02-28</d><h>09:41</h><r>kennytilton</r>Too easy. <b>🙂</b> Thanks for pitching in, all!</z><z id="t1582883099" t="kennytilton Oh, one more thing. I was wondering if I should compute the MD5 off the gzip I was uploading or the data I gzipped. Turned out it was the gzip."><y>#</y><d>2020-02-28</d><h>09:44</h><r>kennytilton</r>Oh, one more thing. I was wondering if I should compute the MD5 off the gzip I was uploading or the data I gzipped. Turned out it was the gzip.</z><z id="t1582927272" t="mariorz Hi! Anyone know any common gotchas in getting aws sdk metrics to cloudwatch using lein? the cwagent is currently running on my ec2 and reporting its metrics, csm is enabled, and am including Dcom.amazonaws.sdk.enableDefaultMetrics and Dcom.amazonaws.sdk.csm.enabled in jvm-opts map"><y>#</y><d>2020-02-28</d><h>22:01</h><w>mariorz</w>Hi! Anyone know any common gotchas in getting aws sdk metrics to cloudwatch using lein? the cwagent is currently running on my ec2 and reporting its metrics, csm is enabled, and am including Dcom.amazonaws.sdk.enableDefaultMetrics and Dcom.amazonaws.sdk.csm.enabled in jvm-opts map</z><z id="t1582927311" t="mariorz but not getting the expected aws/sdk namespace in cloudwatch metrics"><y>#</y><d>2020-02-28</d><h>22:01</h><w>mariorz</w>but not getting the expected aws/sdk namespace in cloudwatch metrics</z><z id="t1583351076" t="lgouger Are the paginators for an operation available via the Clojure AWS api?"><y>#</y><d>2020-03-04</d><h>19:44</h><w>lgouger</w>Are the paginators for an operation available via the Clojure AWS api?</z><z id="t1583351119" t="lgouger In Javascript API they’re in client specific data files, eg. aws-sdk-js/apis/logs-2014-03-28.paginators.json"><y>#</y><d>2020-03-04</d><h>19:45</h><w>lgouger</w>In Javascript API they’re in client specific data files, eg.  <code>aws-sdk-js/apis/logs-2014-03-28.paginators.json</code></z><z id="t1583351158" t="lgouger (this happens to be the one for the Amazon CloudWatch Logs service)"><y>#</y><d>2020-03-04</d><h>19:45</h><w>lgouger</w>(this happens to be the one for the Amazon CloudWatch Logs service)</z><z id="t1583351202" t="kenny No, nothing is built in for pagination right now."><y>#</y><d>2020-03-04</d><h>19:46</h><w>kenny</w>No, nothing is built in for pagination right now.</z><z id="t1583351248" t="lgouger ok, I’ve been making op specific lazy pagers. I’ll continue on that path for now."><y>#</y><d>2020-03-04</d><h>19:47</h><w>lgouger</w>ok, I’ve been making op specific lazy pagers.   I’ll continue on that path for now.</z><z id="t1583351286" t="kenny Yep, we have the same."><y>#</y><d>2020-03-04</d><h>19:48</h><w>kenny</w>Yep, we have the same.</z><z id="t1583351405" t="ghadi there is a function being considered for inclusion in clojure 1.11 that helps with pagination [:attrs {:href &quot;/_/_/users/U7ALJ0E10&quot;}]"><y>#</y><d>2020-03-04</d><h>19:50</h><w>ghadi</w>there is a function being considered for inclusion in clojure 1.11 that helps with pagination <a>@lgouger</a></z><z id="t1583351412" t="ghadi https://clojure.atlassian.net/browse/CLJ-2555"><y>#</y><d>2020-03-04</d><h>19:50</h><w>ghadi</w><a href="https://clojure.atlassian.net/browse/CLJ-2555" target="_blank">https://clojure.atlassian.net/browse/CLJ-2555</a></z><z id="t1583351468" t="ghadi (defn filter-log-events &quot;Issues a CloudWatch Logs query (with the filter syntax {$...}, not the CW Insights syntax. Collects all pages of results. `client` is an aws-api client `request` argument is passed directly as the initial request to the :FilterLogEvents op&quot; [client request] (iteration (fn [token] (aws/invoke client {:op :FilterLogEvents :request (if token {:nextToken token} request)})) :kf :nextToken))"><y>#</y><d>2020-03-04</d><h>19:51</h><w>ghadi</w><pre>(defn filter-log-events
  &quot;Issues a CloudWatch Logs query (with the filter syntax {$...}, not the CW Insights syntax.

   Collects all pages of results.

   `client` is an aws-api client
   `request` argument is passed directly as the initial request to the :FilterLogEvents op&quot;
  [client request]
  (iteration (fn [token]
               (aws/invoke client
                           {:op :FilterLogEvents
                            :request (if token {:nextToken token} request)}))
             :kf :nextToken))</pre></z><z id="t1583351492" t="ghadi example usage ^"><y>#</y><d>2020-03-04</d><h>19:51</h><w>ghadi</w>example usage ^</z><z id="t1583351544" t="kenny I think he may be talking about a mapping of op -&gt; request &amp; response next token keys"><y>#</y><d>2020-03-04</d><h>19:52</h><w>kenny</w>I think he may be talking about a mapping of op -&gt; request &amp; response next token keys</z><z id="t1583351660" t="kenny If so, there is this: https://github.com/iann0036/aws-pagination-rules . Not sure how accurate it is."><y>#</y><d>2020-03-04</d><h>19:54</h><r>kenny</r>If so, there is this: <a href="https://github.com/iann0036/aws-pagination-rules" target="_blank">https://github.com/iann0036/aws-pagination-rules</a>. Not sure how accurate it is.</z><z id="t1583351727" t="lgouger yeah, different apis use different names for nextToken in the request and response and where the results are. For example S3&apos;s listObjectsV2 vs logs DescribeLogGroups &quot;ListObjectsV2&quot;: { &quot;input_token&quot;: &quot;ContinuationToken&quot;, &quot;limit_key&quot;: &quot;MaxKeys&quot;, &quot;output_token&quot;: &quot;NextContinuationToken&quot;, &quot;result_key&quot;: [ &quot;Contents&quot;, &quot;CommonPrefixes&quot; ] } and &quot;DescribeLogGroups&quot;: { &quot;input_token&quot;: &quot;nextToken&quot;, &quot;limit_key&quot;: &quot;limit&quot;, &quot;output_token&quot;: &quot;nextToken&quot;, &quot;result_key&quot;: &quot;logGroups&quot; }"><y>#</y><d>2020-03-04</d><h>19:55</h><w>lgouger</w>yeah, different apis use different names for nextToken in the request and response and where the results are.
For example S3&apos;s listObjectsV2 vs logs DescribeLogGroups
<pre>&quot;ListObjectsV2&quot;: {
      &quot;input_token&quot;: &quot;ContinuationToken&quot;,
      &quot;limit_key&quot;: &quot;MaxKeys&quot;,
      &quot;output_token&quot;: &quot;NextContinuationToken&quot;,
      &quot;result_key&quot;: [
        &quot;Contents&quot;,
        &quot;CommonPrefixes&quot;
      ]
    }</pre>
and
<pre>&quot;DescribeLogGroups&quot;: {
      &quot;input_token&quot;: &quot;nextToken&quot;,
      &quot;limit_key&quot;: &quot;limit&quot;,
      &quot;output_token&quot;: &quot;nextToken&quot;,
      &quot;result_key&quot;: &quot;logGroups&quot;
    }</pre></z><z id="t1583351821" t="ghadi Yeah - right now the paginator descriptors aren’t exposed"><y>#</y><d>2020-03-04</d><h>19:57</h><w>ghadi</w>Yeah - right now the paginator descriptors aren’t exposed</z><z id="t1583370412" t="kenny Got this anomaly once earlier today. The code the resulted in this exception was retried ~45 seconds later and succeeded. Any idea why this would happen? {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot;, :cognitect.http-client/throwable #error { :cause &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot; :via [{:type .ssl.SSLException :message &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot; :at [sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 98]}] :trace [[sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 98] [sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 64] [sun.security.ssl.SSLEngineImpl readRecord &quot;SSLEngineImpl.java&quot; 548] [sun.security.ssl.SSLEngineImpl unwrap &quot;SSLEngineImpl.java&quot; 443] [sun.security.ssl.SSLEngineImpl unwrap &quot;SSLEngineImpl.java&quot; 422] [.ssl.SSLEngine unwrap &quot;SSLEngine.java&quot; 634] [.ssl.SslConnection unwrap &quot;SslConnection.java&quot; 417] [.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 705] [org.eclipse.jetty.client.http.HttpReceiverOverHTTP process &quot;HttpReceiverOverHTTP.java&quot; 159] [org.eclipse.jetty.client.http.HttpReceiverOverHTTP receive &quot;HttpReceiverOverHTTP.java&quot; 75] [org.eclipse.jetty.client.http.HttpChannelOverHTTP receive &quot;HttpChannelOverHTTP.java&quot; 133] [org.eclipse.jetty.client.http.HttpConnectionOverHTTP onFillable &quot;HttpConnectionOverHTTP.java&quot; 151] [.AbstractConnection$ReadCallback succeeded &quot;AbstractConnection.java&quot; 311] [.FillInterest fillable &quot;FillInterest.java&quot; 103] [.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 543] [.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 398] [.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 161] [.FillInterest fillable &quot;FillInterest.java&quot; 103] [.ChannelEndPoint$2 run &quot;ChannelEndPoint.java&quot; 117] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 336] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 313] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 171] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 129] [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 388] [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 806] [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 938]"><y>#</y><d>2020-03-05</d><h>01:06</h><w>kenny</w>Got this anomaly once earlier today. The code the resulted in this exception was retried ~45 seconds later and succeeded. Any idea why this would happen?
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot;, :cognitect.http-client/throwable #error {
 :cause &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot;
 :via
 [{:type .ssl.SSLException
   :message &quot;Unrecognized record version (D)TLS-0.0 , plaintext connection?&quot;
   :at [sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 98]}]
 :trace
 [[sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 98]
  [sun.security.ssl.SSLEngineInputRecord bytesInCompletePacket &quot;SSLEngineInputRecord.java&quot; 64]
  [sun.security.ssl.SSLEngineImpl readRecord &quot;SSLEngineImpl.java&quot; 548]
  [sun.security.ssl.SSLEngineImpl unwrap &quot;SSLEngineImpl.java&quot; 443]
  [sun.security.ssl.SSLEngineImpl unwrap &quot;SSLEngineImpl.java&quot; 422]
  [.ssl.SSLEngine unwrap &quot;SSLEngine.java&quot; 634]
  [.ssl.SslConnection unwrap &quot;SslConnection.java&quot; 417]
  [.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 705]
  [org.eclipse.jetty.client.http.HttpReceiverOverHTTP process &quot;HttpReceiverOverHTTP.java&quot; 159]
  [org.eclipse.jetty.client.http.HttpReceiverOverHTTP receive &quot;HttpReceiverOverHTTP.java&quot; 75]
  [org.eclipse.jetty.client.http.HttpChannelOverHTTP receive &quot;HttpChannelOverHTTP.java&quot; 133]
  [org.eclipse.jetty.client.http.HttpConnectionOverHTTP onFillable &quot;HttpConnectionOverHTTP.java&quot; 151]
  [.AbstractConnection$ReadCallback succeeded &quot;AbstractConnection.java&quot; 311]
  [.FillInterest fillable &quot;FillInterest.java&quot; 103]
  [.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 543]
  [.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 398]
  [.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 161]
  [.FillInterest fillable &quot;FillInterest.java&quot; 103]
  [.ChannelEndPoint$2 run &quot;ChannelEndPoint.java&quot; 117]
  [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 336]
  [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 313]
  [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 171]
  [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 129]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 388]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 806]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 938]</pre></z><z id="t1583517757" t="kenny Sometimes aws-api will return an anomaly with an incorrect category (e.g., incorrect or fault) when the actual category should be busy. This is on AWS for returning the wrong status code. We would, however, like to change the categories of these anomalies to the correct category. For example, the CloudWatch API will indicate a throttling error like so #(= &quot;Throttling&quot; (get-in % [:ErrorResponse :Error :Code])) . Is there any thinking on the best way to do this? It would seem like the best way is to create our own invoke function and ensure every caller uses that instead of cognitect.aws.client.api/invoke ."><y>#</y><d>2020-03-06</d><h>18:02</h><w>kenny</w>Sometimes aws-api will return an anomaly with an incorrect category (e.g., incorrect or fault) when the actual category should be busy. This is on AWS for returning the wrong status code. We would, however, like to change the categories of these anomalies to the correct category. For example, the CloudWatch API will indicate a throttling error like so <code>#(= &quot;Throttling&quot; (get-in % [:ErrorResponse :Error :Code]))</code>. Is there any thinking on the best way to do this? It would seem like the best way is to create our own invoke function and ensure every caller uses that instead of <code>cognitect.aws.client.api/invoke</code>.</z><z id="t1583520641" t="jimmy When trying to use s3 :SelectObjectContent I get an error about failing to parse xml "><y>#</y><d>2020-03-06</d><h>18:50</h><w>jimmy</w>When trying to use s3 <code>:SelectObjectContent</code> I get an error about failing to parse xml

</z><z id="t1583520641" t="jimmy (aws/invoke s3 {:op :SelectObjectContent :request {:Bucket bucket :Key my-key :Expression &quot;select * from S3Object s&quot; :ExpressionType &quot;SQL&quot; :InputSerialization {:CSV {:RecordDelimiter &quot;\r\n&quot;}} :OutputSerialization {:JSON {:Type &quot;LINES&quot;}}}}) ;; =&gt; {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;ParseError at [row,col]:[1,1]\nMessage: Content is not allowed in prolog.&quot; :via [{:type javax.xml.stream.XMLStreamException :message &quot;ParseError at [row,col]:[1,1]\nMessage: Content is not allowed in prolog.&quot; :at [.apache.xerces.internal.impl.XMLStreamReaderImpl next &quot;XMLStreamReaderImpl.java&quot; 652]}] :trace [[.apache.xerces.internal.impl.XMLStreamReaderImpl next &quot;XMLStreamReaderImpl.java&quot; 652] [clojure.data.xml.jvm.parse$pull_seq$fn__29940 invoke &quot;parse.clj&quot; 78] [clojure.lang.LazySeq sval &quot;LazySeq.java&quot; 42] [clojure.lang.LazySeq seq &quot;LazySeq.java&quot; 51] [clojure.lang.RT seq &quot;RT.java&quot; 535] [clojure.core$seq__5402 invokeStatic &quot;core.clj&quot; 137] [clojure.core$seq__5402 invoke &quot;core.clj&quot; 137] [clojure.data.xml.tree$seq_tree$fn__29773 invoke &quot;tree.clj&quot; 39] [clojure.lang.LazySeq sval &quot;LazySeq.java&quot; 42] [clojure.lang.LazySeq seq &quot;LazySeq.java&quot; 51] [clojure.lang.LazySeq first &quot;LazySeq.java&quot; 73] [clojure.lang.RT first &quot;RT.java&quot; 692] [clojure.core$first__5384 invokeStatic &quot;core.clj&quot; 55] [clojure.core$ffirst__5394 invokeStatic &quot;core.clj&quot; 103] [clojure.core$ffirst__5394 invoke &quot;core.clj&quot; 103] [clojure.data.xml.tree$event_tree invokeStatic &quot;tree.clj&quot; 70] [clojure.data.xml.tree$event_tree invoke &quot;tree.clj&quot; 66] [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 109] [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 84] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486] [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 148] [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 145] [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217] [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214] [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 243] [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235] [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260] [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249] [cognitect.aws.protocols.rest_xml$eval32111$fn__32112 invoke &quot;rest_xml.clj&quot; 23] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239] [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 49] [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 44] [cognitect.aws.client$send_request$fn__31513$state_machine__20194__auto____31540$fn__31543 invoke &quot;client.clj&quot; 112] [cognitect.aws.client$send_request$fn__31513$state_machine__20194__auto____31540 invoke &quot;client.clj&quot; 108] [clojure.core.async.impl.ioc_macros$run_state_machine invokeStatic &quot;ioc_macros.clj&quot; 973] [clojure.core.async.impl.ioc_macros$run_state_machine invoke &quot;ioc_macros.clj&quot; 972] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invokeStatic &quot;ioc_macros.clj&quot; 977] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invoke &quot;ioc_macros.clj&quot; 975] [clojure.core.async.impl.ioc_macros$take_BANG_$fn__20212 invoke &quot;ioc_macros.clj&quot; 986] [clojure.core.async.impl.channels.ManyToManyChannel$fn__15077$fn__15078 invoke &quot;channels.clj&quot; 95] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628] [clojure.core.async.impl.concurrent$counted_thread_factory$reify__14946$fn__14947 invoke &quot;concurrent.clj&quot; 29] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.lang.Thread run &quot;Thread.java&quot; 830]]}}"><y>#</y><d>2020-03-06</d><h>18:50</h><w>jimmy</w><pre>(aws/invoke s3
            {:op :SelectObjectContent
             :request
             {:Bucket bucket
              :Key my-key
              :Expression &quot;select * from S3Object s&quot;
              :ExpressionType &quot;SQL&quot;
              :InputSerialization {:CSV {:RecordDelimiter &quot;\r\n&quot;}}
              :OutputSerialization {:JSON {:Type &quot;LINES&quot;}}}})

;; =&gt;

{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error {
 :cause &quot;ParseError at [row,col]:[1,1]\nMessage: Content is not allowed in prolog.&quot;
 :via
 [{:type javax.xml.stream.XMLStreamException
   :message &quot;ParseError at [row,col]:[1,1]\nMessage: Content is not allowed in prolog.&quot;
   :at [.apache.xerces.internal.impl.XMLStreamReaderImpl next &quot;XMLStreamReaderImpl.java&quot; 652]}]
 :trace
 [[.apache.xerces.internal.impl.XMLStreamReaderImpl next &quot;XMLStreamReaderImpl.java&quot; 652]
  [clojure.data.xml.jvm.parse$pull_seq$fn__29940 invoke &quot;parse.clj&quot; 78]
  [clojure.lang.LazySeq sval &quot;LazySeq.java&quot; 42]
  [clojure.lang.LazySeq seq &quot;LazySeq.java&quot; 51]
  [clojure.lang.RT seq &quot;RT.java&quot; 535]
  [clojure.core$seq__5402 invokeStatic &quot;core.clj&quot; 137]
  [clojure.core$seq__5402 invoke &quot;core.clj&quot; 137]
  [clojure.data.xml.tree$seq_tree$fn__29773 invoke &quot;tree.clj&quot; 39]
  [clojure.lang.LazySeq sval &quot;LazySeq.java&quot; 42]
  [clojure.lang.LazySeq seq &quot;LazySeq.java&quot; 51]
  [clojure.lang.LazySeq first &quot;LazySeq.java&quot; 73]
  [clojure.lang.RT first &quot;RT.java&quot; 692]
  [clojure.core$first__5384 invokeStatic &quot;core.clj&quot; 55]
  [clojure.core$ffirst__5394 invokeStatic &quot;core.clj&quot; 103]
  [clojure.core$ffirst__5394 invoke &quot;core.clj&quot; 103]
  [clojure.data.xml.tree$event_tree invokeStatic &quot;tree.clj&quot; 70]
  [clojure.data.xml.tree$event_tree invoke &quot;tree.clj&quot; 66]
  [clojure.data.xml$parse invokeStatic &quot;xml.clj&quot; 109]
  [clojure.data.xml$parse doInvoke &quot;xml.clj&quot; 84]
  [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 486]
  [cognitect.aws.util$xml_read invokeStatic &quot;util.clj&quot; 148]
  [cognitect.aws.util$xml_read invoke &quot;util.clj&quot; 145]
  [cognitect.aws.shape$xml_parse invokeStatic &quot;shape.clj&quot; 217]
  [cognitect.aws.shape$xml_parse invoke &quot;shape.clj&quot; 214]
  [cognitect.aws.protocols.rest$parse_body invokeStatic &quot;rest.clj&quot; 243]
  [cognitect.aws.protocols.rest$parse_body invoke &quot;rest.clj&quot; 235]
  [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 260]
  [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249]
  [cognitect.aws.protocols.rest_xml$eval32111$fn__32112 invoke &quot;rest_xml.clj&quot; 23]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239]
  [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 49]
  [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 44]
  [cognitect.aws.client$send_request$fn__31513$state_machine__20194__auto____31540$fn__31543 invoke &quot;client.clj&quot; 112]
  [cognitect.aws.client$send_request$fn__31513$state_machine__20194__auto____31540 invoke &quot;client.clj&quot; 108]
  [clojure.core.async.impl.ioc_macros$run_state_machine invokeStatic &quot;ioc_macros.clj&quot; 973]
  [clojure.core.async.impl.ioc_macros$run_state_machine invoke &quot;ioc_macros.clj&quot; 972]
  [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invokeStatic &quot;ioc_macros.clj&quot; 977]
  [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invoke &quot;ioc_macros.clj&quot; 975]
  [clojure.core.async.impl.ioc_macros$take_BANG_$fn__20212 invoke &quot;ioc_macros.clj&quot; 986]
  [clojure.core.async.impl.channels.ManyToManyChannel$fn__15077$fn__15078 invoke &quot;channels.clj&quot; 95]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 628]
  [clojure.core.async.impl.concurrent$counted_thread_factory$reify__14946$fn__14947 invoke &quot;concurrent.clj&quot; 29]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.lang.Thread run &quot;Thread.java&quot; 830]]}}</pre></z><z id="t1583520641" t="jimmy I&apos;m guessing that because the aws-api is generic it assuming this endpoint returns xml when it does not. Is there anyway to make it not try to parse the body as xml?"><y>#</y><d>2020-03-06</d><h>18:50</h><w>jimmy</w>
I&apos;m guessing that because the aws-api is generic it assuming this endpoint returns xml when it does not. Is there anyway to make it not try to parse the body as xml?</z><z id="t1583520696" t="ghadi [:attrs {:href &quot;/_/_/users/U5K8NTHEZ&quot;}] capture the (meta response)"><y>#</y><d>2020-03-06</d><h>18:51</h><w>ghadi</w><a>@jimmy</a> capture the <code>(meta response)</code></z><z id="t1583520704" t="ghadi should have a response body that might be helpful"><y>#</y><d>2020-03-06</d><h>18:51</h><w>ghadi</w>should have a response body that might be helpful</z><z id="t1583520732" t="ghadi (but obviously it&apos;s CSV)"><y>#</y><d>2020-03-06</d><h>18:52</h><w>ghadi</w>(but obviously it&apos;s CSV)</z><z id="t1583520783" t="ghadi can you file an issue? In the meantime, maybe try re-reading the response inputstream body correctly in userspace"><y>#</y><d>2020-03-06</d><h>18:53</h><w>ghadi</w>can you file an issue? In the meantime, maybe try re-reading the response inputstream body correctly in userspace</z><z id="t1583520792" t="ghadi as a workaround"><y>#</y><d>2020-03-06</d><h>18:53</h><w>ghadi</w>as a workaround</z><z id="t1583520820" t="jimmy Thanks for the work around. I will definitely file an issue about it"><y>#</y><d>2020-03-06</d><h>18:53</h><w>jimmy</w>Thanks for the work around. I will definitely file an issue about it</z><z id="t1583520833" t="jimmy Any info you want me to capture other than what I&apos;ve provided?"><y>#</y><d>2020-03-06</d><h>18:53</h><w>jimmy</w>Any info you want me to capture other than what I&apos;ve provided?</z><z id="t1583520835" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] same request for you -- is &quot;Throttling&quot; represented as an http status code, or only within [:ErrorResponse :Error :Code]) ?"><y>#</y><d>2020-03-06</d><h>18:53</h><w>ghadi</w><a>@kenny</a> same request for you -- is &quot;Throttling&quot; represented as an http status code, or only within  [:ErrorResponse :Error :Code]) ?</z><z id="t1583520867" t="ghadi [:attrs {:href &quot;/_/_/users/U5K8NTHEZ&quot;}] any setup code necessary to make an object that is readable in this way"><y>#</y><d>2020-03-06</d><h>18:54</h><w>ghadi</w><a>@jimmy</a> any setup code necessary to make an object that is readable in this way</z><z id="t1583520880" t="dchelimsky Before you file an issue - please check your dependencies."><y>#</y><d>2020-03-06</d><h>18:54</h><w>dchelimsky</w>Before you file an issue - please check your dependencies.</z><z id="t1583520923" t="ghadi this one isn&apos;t probably our favorite data.xml dep issue --"><y>#</y><d>2020-03-06</d><h>18:55</h><w>ghadi</w>this one isn&apos;t probably our favorite data.xml dep issue  --</z><z id="t1583520933" t="dchelimsky no?"><y>#</y><d>2020-03-06</d><h>18:55</h><w>dchelimsky</w>no?</z><z id="t1583520936" t="ghadi but knowing the deps will be useful"><y>#</y><d>2020-03-06</d><h>18:55</h><w>ghadi</w>but knowing the deps will be useful</z><z id="t1583520953" t="ghadi no, he&apos;s asking for a special response handling from S3: :InputSerialization {:CSV {:RecordDelimiter &quot;\r\n&quot;}} :OutputSerialization {:JSON {:Type &quot;LINES&quot;}}}})"><y>#</y><d>2020-03-06</d><h>18:55</h><w>ghadi</w>no, he&apos;s asking for a special response handling from S3:
<pre>:InputSerialization {:CSV {:RecordDelimiter &quot;\r\n&quot;}}
              :OutputSerialization {:JSON {:Type &quot;LINES&quot;}}}})</pre></z><z id="t1583520968" t="ghadi dunno if that conflicts with the client&apos;s reading of the service descriptor"><y>#</y><d>2020-03-06</d><h>18:56</h><w>ghadi</w>dunno if that conflicts with the client&apos;s reading of the service descriptor</z><z id="t1583521116" t="dchelimsky It does"><y>#</y><d>2020-03-06</d><h>18:58</h><w>dchelimsky</w>It does</z><z id="t1583521145" t="dchelimsky"><y>#</y><d>2020-03-06</d><h>18:59</h><w>dchelimsky</w></z><z id="t1583521148" t="ghadi https://docs.aws.amazon.com/AmazonS3/latest/API/RESTSelectObjectAppendix.html"><y>#</y><d>2020-03-06</d><h>18:59</h><w>ghadi</w><a href="https://docs.aws.amazon.com/AmazonS3/latest/API/RESTSelectObjectAppendix.html" target="_blank">https://docs.aws.amazon.com/AmazonS3/latest/API/RESTSelectObjectAppendix.html</a></z><z id="t1583521159" t="ghadi looks like this is a Two-fer Tuesday"><y>#</y><d>2020-03-06</d><h>18:59</h><w>ghadi</w>looks like this is a Two-fer Tuesday</z><z id="t1583521218" t="dchelimsky Type is not part of the JSON map under OutputSerialization"><y>#</y><d>2020-03-06</d><h>19:00</h><w>dchelimsky</w><code>Type</code> is not part of the <code>JSON</code> map under <code>OutputSerialization</code></z><z id="t1583521345" t="jimmy True, but changing that does not make a difference."><y>#</y><d>2020-03-06</d><h>19:02</h><w>jimmy</w>True, but changing that does not make a difference.</z><z id="t1583521384" t="dchelimsky Are you using lein or tools.deps or other?"><y>#</y><d>2020-03-06</d><h>19:03</h><w>dchelimsky</w>Are you using lein or tools.deps or other?</z><z id="t1583521390" t="jimmy tools.deps"><y>#</y><d>2020-03-06</d><h>19:03</h><w>jimmy</w>tools.deps</z><z id="t1583521437" t="dchelimsky what version clojure/data.xml is in clj -Spath"><y>#</y><d>2020-03-06</d><h>19:03</h><w>dchelimsky</w>what version clojure/data.xml is in <code>clj -Spath</code></z><z id="t1583521627" t="dchelimsky OK - never mind. I see I&apos;m barking up the wrong tree."><y>#</y><d>2020-03-06</d><h>19:07</h><w>dchelimsky</w>OK - never mind. I see I&apos;m barking up the wrong tree.</z><z id="t1583521753" t="jimmy It is 0.2.0-alpha6 . But yeah, if you look at the response body it isn&apos;t just straight forward xml. I&apos;ll file an issue that given a bucket you should be able to test it and recreate it. Sadly the body is complicated enough, probably not worth me trying to do the work around right now."><y>#</y><d>2020-03-06</d><h>19:09</h><w>jimmy</w>It is <code>0.2.0-alpha6</code>. But yeah, if you look at the response body it isn&apos;t just straight forward xml. I&apos;ll file an issue that given a bucket you should be able to test it and recreate it. Sadly the body is complicated enough, probably not worth me trying to do the work around right now.</z><z id="t1583521787" t="ghadi the response format is..... artisanal"><y>#</y><d>2020-03-06</d><h>19:09</h><w>ghadi</w>the response format is..... artisanal</z><z id="t1583521846" t="dchelimsky Or custom, in which case you could customize it. But how do you artisanize it?"><y>#</y><d>2020-03-06</d><h>19:10</h><r>dchelimsky</r>Or custom, in which case you could customize it. But how do you artisanize it?</z><z id="t1583521904" t="ghadi https://github.com/aws/aws-sdk-java-v2/blob/master/services/s3/src/main/resources/codegen-resources/service-2.json#L7710-L7735"><y>#</y><d>2020-03-06</d><h>19:11</h><r>ghadi</r><a href="https://github.com/aws/aws-sdk-java-v2/blob/master/services/s3/src/main/resources/codegen-resources/service-2.json#L7710-L7735" target="_blank">https://github.com/aws/aws-sdk-java-v2/blob/master/services/s3/src/main/resources/codegen-resources/service-2.json#L7710-L7735</a></z><z id="t1583521911" t="ghadi :eventstream true"><y>#</y><d>2020-03-06</d><h>19:11</h><r>ghadi</r><code>:eventstream true</code></z><z id="t1583521922" t="ghadi fun"><y>#</y><d>2020-03-06</d><h>19:12</h><r>ghadi</r>fun</z><z id="t1583522441" t="jimmy Made the issue https://github.com/cognitect-labs/aws-api/issues/132 Thanks for the help [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2020-03-06</d><h>19:20</h><w>jimmy</w>Made the issue <a href="https://github.com/cognitect-labs/aws-api/issues/132" target="_blank">https://github.com/cognitect-labs/aws-api/issues/132</a>

Thanks for the help <a>@ghadi</a></z><z id="t1583791104" t="kenny is &quot;Throttling&quot; represented as an http status code, or only within [:ErrorResponse :Error :Code]) ? [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] You asked the above. Throttling is only represented via that path. Here&apos;s a simple example: (def c (aws-api/client {:api :workspaces})) (def results (vec (pmap (fn [_] (aws-api/invoke c {:op :DescribeWorkspaceDirectories})) (range 20)))) (first (filter anom/anomaly? results)) =&gt; {:__type &quot;ThrottlingException&quot;, :message &quot;Rate exceeded&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} (get-in (meta *1) [:http-response :status]) =&gt; 400"><y>#</y><d>2020-03-09</d><h>21:58</h><w>kenny</w> is &quot;Throttling&quot; represented as an http status code, or only within  [:ErrorResponse :Error :Code]) ?<a>@ghadi</a> You asked the above. Throttling is only represented via that path. Here&apos;s a simple example:

<pre>(def c (aws-api/client {:api :workspaces}))
(def results
  (vec (pmap (fn [_]
               (aws-api/invoke c {:op :DescribeWorkspaceDirectories}))
             (range 20))))

(first (filter anom/anomaly? results))
=&gt;
{:__type &quot;ThrottlingException&quot;, :message &quot;Rate exceeded&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}

(get-in (meta *1) [:http-response :status])
=&gt; 400</pre></z><z id="t1583791131" t="ghadi do you have the complete response headers?"><y>#</y><d>2020-03-09</d><h>21:58</h><w>ghadi</w>do you have the complete response headers?</z><z id="t1583791135" t="kenny Yes"><y>#</y><d>2020-03-09</d><h>21:58</h><w>kenny</w>Yes</z><z id="t1583791168" t="kenny {&quot;x-amz-date&quot; &quot;20200309T215544Z&quot;, &quot;x-amz-target&quot; &quot;WorkspacesService.DescribeWorkspaceDirectories&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;, &quot;host&quot; &quot;&quot;, &quot;authorization&quot; &quot;...&quot;}"><y>#</y><d>2020-03-09</d><h>21:59</h><w>kenny</w><pre>{&quot;x-amz-date&quot; &quot;20200309T215544Z&quot;,
 &quot;x-amz-target&quot; &quot;WorkspacesService.DescribeWorkspaceDirectories&quot;,
 &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;,
 &quot;host&quot; &quot;&quot;,
 &quot;authorization&quot; &quot;...&quot;}</pre></z><z id="t1583791185" t="ghadi that&apos;s the response?"><y>#</y><d>2020-03-09</d><h>21:59</h><w>ghadi</w>that&apos;s the response?</z><z id="t1583791203" t="ghadi seems like the request"><y>#</y><d>2020-03-09</d><h>22:00</h><w>ghadi</w>seems like the request</z><z id="t1583791203" t="kenny Headers"><y>#</y><d>2020-03-09</d><h>22:00</h><w>kenny</w>Headers</z><z id="t1583791209" t="kenny Oops, yeah"><y>#</y><d>2020-03-09</d><h>22:00</h><w>kenny</w>Oops, yeah</z><z id="t1583791218" t="kenny {&quot;x-amzn-requestid&quot; &quot;59bbfe02-e3b0-49fa-a2cb-2027a236531a&quot;, &quot;connection&quot; &quot;close&quot;, &quot;content-length&quot; &quot;58&quot;, &quot;date&quot; &quot;Mon, 09 Mar 2020 21:55:44 GMT&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;}"><y>#</y><d>2020-03-09</d><h>22:00</h><w>kenny</w><pre>{&quot;x-amzn-requestid&quot; &quot;59bbfe02-e3b0-49fa-a2cb-2027a236531a&quot;,
 &quot;connection&quot; &quot;close&quot;,
 &quot;content-length&quot; &quot;58&quot;,
 &quot;date&quot; &quot;Mon, 09 Mar 2020 21:55:44 GMT&quot;,
 &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;}</pre></z><z id="t1583791256" t="kenny We also have to use this for :retriable? for the apis we use. (def api-&gt;retriable-fn &quot;Map of AWS API to a fn that will be called to see if the request should be retried based on the HTTP response. This is needed because various AWS APIs indicate failures in non-standard ways.&quot; {:workspaces #(= &quot;ThrottlingException&quot; (:__type %)) :pricing #(= &quot;ThrottlingException&quot; (:__type %)) :monitoring #(= &quot;Throttling&quot; (get-in % [:ErrorResponse :Error :Code]))}) "><y>#</y><d>2020-03-09</d><h>22:00</h><w>kenny</w>We also have to use this for <code>:retriable?</code> for the apis we use.
<pre>(def api-&gt;retriable-fn
  &quot;Map of AWS API to a fn that will be called to see if the request should be retried
  based on the HTTP response. This is needed because various AWS APIs indicate
  failures in non-standard ways.&quot;
  {:workspaces #(= &quot;ThrottlingException&quot; (:__type %))
   :pricing    #(= &quot;ThrottlingException&quot; (:__type %))
   :monitoring #(= &quot;Throttling&quot; (get-in % [:ErrorResponse :Error :Code]))})</pre>
</z><z id="t1583791265" t="ghadi what else is in the json response?"><y>#</y><d>2020-03-09</d><h>22:01</h><w>ghadi</w>what else is in the json response?</z><z id="t1583791291" t="ghadi I&apos;m trying to see if there is something generic we can detect and return a :busy anomaly"><y>#</y><d>2020-03-09</d><h>22:01</h><w>ghadi</w>I&apos;m trying to see if there is something generic we can detect and return a :busy anomaly</z><z id="t1583791299" t="kenny The body is this: {: type &quot;ThrottlingException&quot;, :message &quot;Rate exceeded&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}"><y>#</y><d>2020-03-09</d><h>22:01</h><w>kenny</w>The body is this: {:type &quot;ThrottlingException&quot;, :message &quot;Rate exceeded&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}</z><z id="t1583791311" t="kenny From my experience, I don&apos;t think there is 😞"><y>#</y><d>2020-03-09</d><h>22:01</h><w>kenny</w>From my experience, I don&apos;t think there is <b>😞</b></z><z id="t1583791312" t="ghadi what about the raw response JSON?"><y>#</y><d>2020-03-09</d><h>22:01</h><w>ghadi</w>what about the raw response JSON?</z><z id="t1583791324" t="kenny Just slurping the :body?"><y>#</y><d>2020-03-09</d><h>22:02</h><w>kenny</w>Just slurping the :body?</z><z id="t1583791334" t="ghadi yeah, should be available"><y>#</y><d>2020-03-09</d><h>22:02</h><w>ghadi</w>yeah, should be available</z><z id="t1583791352" t="kenny (slurp (:body (:http-response (meta (first (filter anom/anomaly? results)))))) =&gt; &quot;{\&quot;__type\&quot;:\&quot;ThrottlingException\&quot;,\&quot;message\&quot;:\&quot;Rate exceeded\&quot;}&quot;"><y>#</y><d>2020-03-09</d><h>22:02</h><w>kenny</w><pre>(slurp (:body (:http-response (meta (first (filter anom/anomaly? results))))))
=&gt; &quot;{\&quot;__type\&quot;:\&quot;ThrottlingException\&quot;,\&quot;message\&quot;:\&quot;Rate exceeded\&quot;}&quot;</pre></z><z id="t1583791365" t="ghadi Thanks AWS™"><y>#</y><d>2020-03-09</d><h>22:02</h><w>ghadi</w>Thanks AWS™</z><z id="t1583791422" t="kenny Yep... It&apos;s frustrating. The above retry works but it results in incorrect anomalies getting returned. In the above example, it returns incorrect when it should be busy."><y>#</y><d>2020-03-09</d><h>22:03</h><w>kenny</w>Yep... It&apos;s frustrating. The above retry works but it results in incorrect anomalies getting returned. In the above example, it returns incorrect when it should be busy.</z><z id="t1583791458" t="ghadi should really send back a status 429"><y>#</y><d>2020-03-09</d><h>22:04</h><w>ghadi</w>should really send back a status 429</z><z id="t1583791476" t="kenny Agreed. This happens in several of their apis though."><y>#</y><d>2020-03-09</d><h>22:04</h><w>kenny</w>Agreed. This happens in several of their apis though.</z><z id="t1583791483" t="ghadi yeah"><y>#</y><d>2020-03-09</d><h>22:04</h><w>ghadi</w>yeah</z><z id="t1583791577" t="ghadi [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] do we read :errors from the descriptors?"><y>#</y><d>2020-03-09</d><h>22:06</h><w>ghadi</w><a>@dchelimsky</a> do we read :errors from the descriptors?</z><z id="t1583791653" t="dchelimsky Not yet. We looked at it as a means of normalizing error handling, but there is nothing normalizable (every service does its own thing)."><y>#</y><d>2020-03-09</d><h>22:07</h><w>dchelimsky</w>Not yet. We looked at it as a means of normalizing error handling, but there is nothing normalizable (every service does its own thing).</z><z id="t1583791968" t="dchelimsky Also, I ran into a few cases in which the descriptors themselves listed error shapes in operation maps, but those weren&apos;t present in the shapes map."><y>#</y><d>2020-03-09</d><h>22:12</h><w>dchelimsky</w>Also, I ran into a few cases in which the descriptors themselves listed error shapes in operation maps, but those weren&apos;t present in the shapes map.</z><z id="t1583792017" t="dchelimsky [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] am I missing some value we&apos;d get from reading them anyway?"><y>#</y><d>2020-03-09</d><h>22:13</h><w>dchelimsky</w><a>@ghadi</a> <a>@kenny</a> am I missing some value we&apos;d get from reading them anyway?</z><z id="t1583792055" t="ghadi just need to be able to dispatch on the error shape name"><y>#</y><d>2020-03-09</d><h>22:14</h><w>ghadi</w>just need to be able to dispatch on the error shape name</z><z id="t1583792069" t="ghadi is that always in __type ?"><y>#</y><d>2020-03-09</d><h>22:14</h><w>ghadi</w>is that always in <code>__type</code>?</z><z id="t1583792084" t="ghadi we can&apos;t generically understand the errors without a lookup table"><y>#</y><d>2020-03-09</d><h>22:14</h><w>ghadi</w>we can&apos;t generically understand the errors without a lookup table</z><z id="t1583792086" t="dchelimsky That&apos;s only a thing in some json services."><y>#</y><d>2020-03-09</d><h>22:14</h><w>dchelimsky</w>That&apos;s only a thing in some json services.</z><z id="t1583792104" t="dchelimsky There is no spec for this [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2020-03-09</d><h>22:15</h><w>dchelimsky</w>There is no spec for this <a>@ghadi</a></z><z id="t1583792113" t="dchelimsky No consistency across services."><y>#</y><d>2020-03-09</d><h>22:15</h><w>dchelimsky</w>No consistency across services.</z><z id="t1583792113" t="ghadi right."><y>#</y><d>2020-03-09</d><h>22:15</h><w>ghadi</w>right.</z><z id="t1583792138" t="dchelimsky The error shape name is in the operation, which is already part of the model we use."><y>#</y><d>2020-03-09</d><h>22:15</h><w>dchelimsky</w>The error shape name is in the operation, which is already part of the model we use.</z><z id="t1583792162" t="ghadi error shape name is useful enough"><y>#</y><d>2020-03-09</d><h>22:16</h><w>ghadi</w>error shape name is useful enough</z><z id="t1583792175" t="dchelimsky I think that should be in (ops client)"><y>#</y><d>2020-03-09</d><h>22:16</h><w>dchelimsky</w>I think that should be in <code>(ops client)</code></z><z id="t1583792189" t="dchelimsky (don&apos;t have a repl up for this at the moment)"><y>#</y><d>2020-03-09</d><h>22:16</h><w>dchelimsky</w>(don&apos;t have a repl up for this at the moment)</z><z id="t1583792226" t="ghadi the ThrottlingException [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] encountered isn&apos;t even in the workspaces service descriptor :)"><y>#</y><d>2020-03-09</d><h>22:17</h><w>ghadi</w>the ThrottlingException <a>@kenny</a> encountered isn&apos;t even in the workspaces service descriptor :)</z><z id="t1583792237" t="dchelimsky That&apos;s what I&apos;m talking about 😕"><y>#</y><d>2020-03-09</d><h>22:17</h><w>dchelimsky</w>That&apos;s what I&apos;m talking about <b>😕</b></z><z id="t1583792292" t="dchelimsky Can&apos;t exactly knock AWS for this. Nobody said &quot;hey, use these descriptors to build your own SDKs&quot; 😉"><y>#</y><d>2020-03-09</d><h>22:18</h><w>dchelimsky</w>Can&apos;t exactly knock AWS for this. Nobody said &quot;hey, use these descriptors to build your own SDKs&quot; <b>😉</b></z><z id="t1583792323" t="kenny They should return standard http status codes though"><y>#</y><d>2020-03-09</d><h>22:18</h><r>kenny</r>They should return standard http status codes though</z><z id="t1583792349" t="ghadi https://docs.aws.amazon.com/workspaces/latest/api/CommonErrors.html"><y>#</y><d>2020-03-09</d><h>22:19</h><w>ghadi</w><a href="https://docs.aws.amazon.com/workspaces/latest/api/CommonErrors.html" target="_blank">https://docs.aws.amazon.com/workspaces/latest/api/CommonErrors.html</a></z><z id="t1583792375" t="ghadi it doesn&apos;t say s* about how those errors are encoded on the wire"><y>#</y><d>2020-03-09</d><h>22:19</h><w>ghadi</w>it doesn&apos;t say s* about how those errors are encoded on the wire</z><z id="t1583792406" t="dchelimsky Can&apos;t break promises you don&apos;t make!"><y>#</y><d>2020-03-09</d><h>22:20</h><w>dchelimsky</w>Can&apos;t break promises you don&apos;t make!</z><z id="t1583792506" t="dchelimsky This all came up recently, btw: https://github.com/cognitect-labs/aws-api/issues/123"><y>#</y><d>2020-03-09</d><h>22:21</h><w>dchelimsky</w>This all came up recently, btw: <a href="https://github.com/cognitect-labs/aws-api/issues/123" target="_blank">https://github.com/cognitect-labs/aws-api/issues/123</a></z><z id="t1583792742" t="kenny Having the ability to manually transform response bodies before the :retriable? call would help us in this situation. The transformed response would also need to be returned to the caller. I realize it&apos;s not a general solution, but it&apos;s sounding like there is not one."><y>#</y><d>2020-03-09</d><h>22:25</h><w>kenny</w>Having the ability to manually transform response bodies before the <code>:retriable?</code> call would help us in this situation. The transformed response would also need to be returned to the caller. I realize it&apos;s not a general solution, but it&apos;s sounding like there is not one.</z><z id="t1583793393" t="dchelimsky https://github.com/cognitect-labs/aws-api/issues/134"><y>#</y><d>2020-03-09</d><h>22:36</h><w>dchelimsky</w><a href="https://github.com/cognitect-labs/aws-api/issues/134" target="_blank">https://github.com/cognitect-labs/aws-api/issues/134</a></z><z id="t1583793408" t="dchelimsky Please feel free to make suggestions there in comments."><y>#</y><d>2020-03-09</d><h>22:36</h><w>dchelimsky</w>Please feel free to make suggestions there in comments.</z><z id="t1583794434" t="kenny On a totally unrelated note, [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] you may recall I brought up the issue of an AWS API returning an invalid next-token. After a month or so, I finally got it again! Unfortunately the code to log the request-id had a typo in the key to lookup so I didn&apos;t get a request-id from the failure 😞 The next-token looks totally standard for this API. The system retrying the same call ~30s later and it worked. Quite odd behavior. Wonder if AWS has some sort of race condition. {:__type &quot;InvalidParameterValuesException&quot;, :message &quot;Invalid NextToken provided.&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect, :next-token &quot;af286f1d-36ac-4fd2-bd5a-fa79fbb72f4b&quot;, :page-count 4}"><y>#</y><d>2020-03-09</d><h>22:53</h><w>kenny</w>On a totally unrelated note, <a>@ghadi</a> you may recall I brought up the issue of an AWS API returning an invalid next-token. After a month or so, I finally got it again! Unfortunately the code to log the request-id had a typo in the key to lookup so I didn&apos;t get a request-id from the failure <b>😞</b> The next-token looks totally standard for this API. The system retrying the same call ~30s later and it worked. Quite odd behavior. Wonder if AWS has some sort of race condition.
<pre>{:__type &quot;InvalidParameterValuesException&quot;,
 :message &quot;Invalid NextToken provided.&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect,
 :next-token &quot;af286f1d-36ac-4fd2-bd5a-fa79fbb72f4b&quot;,
 :page-count 4}</pre></z><z id="t1583794478" t="kenny I am determined to get AWS to fix this issue. Hopefully next time this error occurs I&apos;ll have a request id for them to debug this!"><y>#</y><d>2020-03-09</d><h>22:54</h><r>kenny</r>I am determined to get AWS to fix this issue. Hopefully next time this error occurs I&apos;ll have a request id for them to debug this!</z><z id="t1583935268" t="Jakub Holý (HolyJak) Hello! Any idea why a DynamoDB :PutItem fails with &gt; DynamoDB operation failed: NUMBER_VALUE cannot be converted to String &gt; (com.amazon.coral.service#SerializationException) ? I know the issue is with my autoDeleteAfter property for removing it fixes the problem. This is defined as the TTL property of the table and thus should be a number of epoch seconds. Adding it manually via AWS Console works. This is the request: {:op :PutItem, :request {:TableName &quot;offboarding&quot;, :Item {&quot;offboardingId&quot; {:S &quot;3fb36a75-2957-44a0-9b16-f6cd4a565547&quot;}, &quot;d&quot; {:S &quot;:not-relevant&quot;}, &quot;autoDeleteAfter&quot; {:N 1591574400}}, :ConditionExpression &quot;attribute_not_exists(offboardingId)&quot;}} (I am using com.cognitect.aws/dynamodb &quot;726.2.484.0&quot;, com.cognitect.aws/api &quot;0.8.352&quot;) Thank you!!!"><y>#</y><d>2020-03-11</d><h>14:01</h><w>Jakub Holý (HolyJak)</w>Hello! Any idea why a DynamoDB <code>:PutItem</code> fails with
&gt; DynamoDB operation failed: NUMBER_VALUE cannot be converted to String
&gt; (com.amazon.coral.service#SerializationException)
? I know the issue is with my <code>autoDeleteAfter</code> property for removing it fixes the problem. This is defined as the TTL property of the table and thus should be a number of epoch seconds. Adding it manually via AWS Console works. This is the request:
<pre>{:op :PutItem, :request {:TableName &quot;offboarding&quot;, :Item {&quot;offboardingId&quot; {:S &quot;3fb36a75-2957-44a0-9b16-f6cd4a565547&quot;}, &quot;d&quot; {:S &quot;:not-relevant&quot;}, &quot;autoDeleteAfter&quot; {:N 1591574400}}, :ConditionExpression &quot;attribute_not_exists(offboardingId)&quot;}}</pre>
(I am using com.cognitect.aws/dynamodb &quot;726.2.484.0&quot;, com.cognitect.aws/api &quot;0.8.352&quot;)
Thank you!!!</z><z id="t1583936872" t="Jakub Holý (HolyJak) My bad I have to wrap the number with &quot; , ie &quot;N&quot;: &quot;string&quot;"><y>#</y><d>2020-03-11</d><h>14:27</h><r>Jakub Holý (HolyJak)</r>My bad I have to wrap the number with <code>&quot;</code> , ie
<pre>&quot;N&quot;: &quot;string&quot;</pre></z><z id="t1584039589" t="ghadi Curious if 1) you use Cognitect Labs&apos; aws-api in Lambdas 2) you get java.lang.IOExceptions thrown in the lambdas &quot;AT HERE&quot;"><y>#</y><d>2020-03-12</d><h>18:59</h><w>ghadi</w>Curious if 1)  you use Cognitect Labs&apos; aws-api in Lambdas
2) you get java.lang.IOExceptions thrown in the lambdas

&quot;AT HERE&quot;</z><z id="t1584121411" t="salam [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] 1) yes, we do (the latest release) 2) nope, not yet"><y>#</y><d>2020-03-13</d><h>17:43</h><w>salam</w><a>@ghadi</a>
1) yes, we do (the latest release)
2) nope, not yet</z><z id="t1584121425" t="ghadi [:attrs {:href &quot;/_/_/users/UDCGPTV9R&quot;}] Java 8 or Java 11?"><y>#</y><d>2020-03-13</d><h>17:43</h><w>ghadi</w><a>@abdusalam</a> Java 8 or Java 11?</z><z id="t1584121435" t="salam Java 11"><y>#</y><d>2020-03-13</d><h>17:43</h><w>salam</w>Java 11</z><z id="t1584121439" t="ghadi weird"><y>#</y><d>2020-03-13</d><h>17:43</h><w>ghadi</w>weird</z><z id="t1584121459" t="ghadi I&apos;m investigating an issue where TLS connections break after about 240 seconds idle between invokes"><y>#</y><d>2020-03-13</d><h>17:44</h><w>ghadi</w>I&apos;m investigating an issue where TLS connections break after about 240 seconds idle between invokes</z><z id="t1584272682" t="danielstockton To those super familiar with cloudfront, has anyone ever successfully put one cloudfront distribution in front of another?"><y>#</y><d>2020-03-15</d><h>11:44</h><w>danielstockton</w>To those super familiar with cloudfront, has anyone ever successfully put one cloudfront distribution in front of another?</z><z id="t1584297006" t="kaffein Hey friends!!! has everyone every stumbled upon the following weird error on s3 when using the cognitect/aws-api lib CopyObject operation please ? I have tried to use it to copy an object from one bucket to another : • the copy action worked perfectly as intended : the object is copied to the destination bucket • but as a response to the call, I received an error : {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;Property null is not supported&quot; :via [{:type java.lang.IllegalArgumentException :message &quot;Property null is not supported&quot; :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}] :trace [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246] ..."><y>#</y><d>2020-03-15</d><h>18:30</h><w>kaffein</w>Hey friends!!!
has everyone every stumbled upon the following weird error on s3 when using the <code>cognitect/aws-api</code> lib <code>CopyObject</code> operation please ?
I have tried to use it to copy an object from one bucket to another :
• the copy action worked perfectly as intended : the object is copied to the destination bucket
• but as a response to the call, I received an error : 
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error {
 :cause &quot;Property null is not supported&quot;
 :via
 [{:type java.lang.IllegalArgumentException
   :message &quot;Property null is not supported&quot;
   :at [com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]}]
 :trace
 [[com.sun.xml.internal.stream.XMLInputFactoryImpl setProperty &quot;XMLInputFactoryImpl.java&quot; 246]
...</pre></z><z id="t1584297042" t="kaffein it is a little bit puzzling since I am not sure how to investigate this case : the “Property null is not supported” message does not help that much"><y>#</y><d>2020-03-15</d><h>18:30</h><w>kaffein</w>it is a little bit puzzling since I am not sure how to investigate this case : the “Property null is not supported” message does not help that much</z><z id="t1584297153" t="ghadi similarly, pasting the error doesn&apos;t help that much without the input request"><y>#</y><d>2020-03-15</d><h>18:32</h><w>ghadi</w>similarly, pasting the error doesn&apos;t help that much without the input request</z><z id="t1584297177" t="ghadi also need your dependencies too, clj -Stree please [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}]"><y>#</y><d>2020-03-15</d><h>18:32</h><w>ghadi</w>also need your dependencies too, <code>clj -Stree</code> please <a>@kaffein</a></z><z id="t1584297229" t="kaffein my bad : I will give you the details in a sec"><y>#</y><d>2020-03-15</d><h>18:33</h><w>kaffein</w>my bad : I will give you the details in a sec</z><z id="t1584297309" t="kaffein [com.cognitect.aws/api &quot;0.8.391&quot;] [com.cognitect.aws/endpoints &quot;1.1.11.670&quot;] [com.cognitect.aws/iam &quot;746.2.533.0&quot;] [com.cognitect.aws/ec2 &quot;770.2.568.0&quot;] [com.cognitect.aws/s3 &quot;762.2.561.0&quot;]]"><y>#</y><d>2020-03-15</d><h>18:35</h><w>kaffein</w><pre>[com.cognitect.aws/api &quot;0.8.391&quot;]
[com.cognitect.aws/endpoints &quot;1.1.11.670&quot;]
[com.cognitect.aws/iam &quot;746.2.533.0&quot;]
[com.cognitect.aws/ec2 &quot;770.2.568.0&quot;]
[com.cognitect.aws/s3 &quot;762.2.561.0&quot;]]</pre></z><z id="t1584297368" t="ghadi no problem. Can you provide the resolved deps, not the declared deps?"><y>#</y><d>2020-03-15</d><h>18:36</h><w>ghadi</w>no problem.  Can you provide the resolved deps, not the declared deps?</z><z id="t1584297382" t="ghadi you look like you&apos;re using lein , so lein deps :tree or whatever"><y>#</y><d>2020-03-15</d><h>18:36</h><w>ghadi</w>you look like you&apos;re using <code>lein</code>, so <code>lein deps :tree</code> or whatever</z><z id="t1584297393" t="ghadi looking for the version of clojure.data.xml specifically"><y>#</y><d>2020-03-15</d><h>18:36</h><w>ghadi</w>looking for the version of clojure.data.xml specifically</z><z id="t1584297428" t="kaffein oh ok"><y>#</y><d>2020-03-15</d><h>18:37</h><w>kaffein</w>oh ok</z><z id="t1584297669" t="kaffein I don’t seem to have found clojure.data.xml while greping it from the output [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2020-03-15</d><h>18:41</h><w>kaffein</w>I don’t seem to have found <code>clojure.data.xml</code> while greping it from the output <a>@ghadi</a></z><z id="t1584297682" t="ghadi org.clojure/data.xml ?"><y>#</y><d>2020-03-15</d><h>18:41</h><w>ghadi</w><code>org.clojure/data.xml</code> ?</z><z id="t1584297700" t="ghadi I gave you the wrong lib to grep for"><y>#</y><d>2020-03-15</d><h>18:41</h><w>ghadi</w>I gave you the wrong lib to grep for</z><z id="t1584297713" t="kaffein oh I gave it the wrong argument indeed"><y>#</y><d>2020-03-15</d><h>18:41</h><w>kaffein</w>oh I gave it the wrong argument indeed</z><z id="t1584297730" t="kaffein there we go : [org.clojure/data.xml &quot;0.0.8&quot;] "><y>#</y><d>2020-03-15</d><h>18:42</h><w>kaffein</w>there we go :
<pre>[org.clojure/data.xml &quot;0.0.8&quot;]</pre>
</z><z id="t1584297737" t="ghadi ok that&apos;s what I thought"><y>#</y><d>2020-03-15</d><h>18:42</h><w>ghadi</w>ok that&apos;s what I thought</z><z id="t1584297759" t="ghadi somewhere in your dependencies it is asking for an older version of data.xml (0.0.8) instead of the one aws-api needs"><y>#</y><d>2020-03-15</d><h>18:42</h><w>ghadi</w>somewhere in your dependencies it is asking for an older version of data.xml (0.0.8) instead of the one aws-api needs</z><z id="t1584297762" t="ghadi (which I can&apos;t remember)"><y>#</y><d>2020-03-15</d><h>18:42</h><w>ghadi</w>(which I can&apos;t remember)</z><z id="t1584297788" t="ghadi in the output for lein deps :tree there should be some warnings about conflicts"><y>#</y><d>2020-03-15</d><h>18:43</h><w>ghadi</w>in the output for <code>lein deps :tree</code> there should be some warnings about conflicts</z><z id="t1584297803" t="ghadi you should do :exclusions for whatever is pulling the old version of data.xml"><y>#</y><d>2020-03-15</d><h>18:43</h><w>ghadi</w>you should do :exclusions for whatever is pulling the old version of data.xml</z><z id="t1584297812" t="ghadi then re-test"><y>#</y><d>2020-03-15</d><h>18:43</h><w>ghadi</w>then re-test</z><z id="t1584297824" t="kaffein awesome [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] thanks a lot for your help"><y>#</y><d>2020-03-15</d><h>18:43</h><w>kaffein</w>awesome <a>@ghadi</a> thanks a lot for your help</z><z id="t1584297846" t="ghadi This is a Frequently Encountered Problem™ and I want to make it go away... will consult with the crew"><y>#</y><d>2020-03-15</d><h>18:44</h><w>ghadi</w>This is a Frequently Encountered Problem™ and I want to make it go away... will consult with the crew</z><z id="t1584297855" t="kaffein cool thanks a lot"><y>#</y><d>2020-03-15</d><h>18:44</h><w>kaffein</w>cool thanks a lot</z><z id="t1584369178" t="ghadi did that :exclusions fix work? [:attrs {:href &quot;/_/_/users/U0DTAJS3Y&quot;}]"><y>#</y><d>2020-03-16</d><h>14:32</h><w>ghadi</w>did that <code>:exclusions</code> fix work? <a>@kaffein</a></z><z id="t1584369291" t="kaffein hey [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I have to test it this evening, it was actually a dependency that we had on a core module we depend on, I had to submit a small PR yesterday evening to bump the version o nthis core module so fortunately I can re-test it tonight"><y>#</y><d>2020-03-16</d><h>14:34</h><w>kaffein</w>hey <a>@ghadi</a> I have to test it this evening, it was actually a dependency that we had on a core module we depend on, I had to submit a small PR yesterday evening to bump the version o nthis core module so fortunately I can re-test it tonight</z><z id="t1584369310" t="kaffein thanks a lot for the follow-up ... I will provide you with some feedback as soon as I have tested it 😉"><y>#</y><d>2020-03-16</d><h>14:35</h><w>kaffein</w>thanks a lot for the follow-up ... I will provide you with some feedback as soon as I have tested it <b>😉</b></z><z id="t1584369350" t="ghadi ack, thanks!"><y>#</y><d>2020-03-16</d><h>14:35</h><w>ghadi</w>ack, thanks!</z><z id="t1584390454" t="kaffein hey [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] thanks a lot, I have tested it and it works like a charm ^^ 🙏"><y>#</y><d>2020-03-16</d><h>20:27</h><w>kaffein</w>hey <a>@ghadi</a> thanks a lot, I have tested it and it works like a charm ^^ <b>🙏</b></z><z id="t1584390486" t="ghadi cool, thanks for following up."><y>#</y><d>2020-03-16</d><h>20:28</h><w>ghadi</w>cool, thanks for following up.</z><z id="t1584646995" t="grounded_sage How does one get a more detailed error message for S3 anomalies?"><y>#</y><d>2020-03-19</d><h>19:43</h><w>grounded_sage</w>How does one get a more detailed error message for S3 anomalies?</z><z id="t1584647350" t="kenny My guess is you don&apos;t 😬 You can get the full response from the anomaly&apos;s metadata to see if there&apos;s anything else that may be interesting. What operation are you doing and what is the anomaly?"><y>#</y><d>2020-03-19</d><h>19:49</h><r>kenny</r>My guess is you don&apos;t <b>😬</b>

You can get the full response from the anomaly&apos;s metadata to see if there&apos;s anything else that may be interesting. What operation are you doing and what is the anomaly?</z><z id="t1584647790" t="grounded_sage I found it. Was just (-&gt; S3-response :Error :Message)"><y>#</y><d>2020-03-19</d><h>19:56</h><r>grounded_sage</r>I found it. Was just <code>(-&gt; S3-response :Error :Message)</code></z><z id="t1584647802" t="grounded_sage But it seems that it’s straight up returning a nil."><y>#</y><d>2020-03-19</d><h>19:56</h><r>grounded_sage</r>But it seems that it’s straight up returning a nil.</z><z id="t1584647838" t="grounded_sage We are getting a failure in the tests in our CI but not locally. Difficult to debug this lol"><y>#</y><d>2020-03-19</d><h>19:57</h><r>grounded_sage</r>We are getting a failure in the tests in our CI but not locally. Difficult to debug this lol</z><z id="t1584647853" t="grounded_sage I am using cognitects aws-api btw"><y>#</y><d>2020-03-19</d><h>19:57</h><r>grounded_sage</r>I am using cognitects aws-api btw</z><z id="t1584647856" t="kenny Perhaps S3-response isn&apos;t what you expect? I suggest logging the whole anomaly map if it is one."><y>#</y><d>2020-03-19</d><h>19:57</h><r>kenny</r>Perhaps S3-response isn&apos;t what you expect? I suggest logging the whole anomaly map if it is one.</z><z id="t1584647962" t="kenny Perhaps CI doesn&apos;t have the proper creds?"><y>#</y><d>2020-03-19</d><h>19:59</h><r>kenny</r>Perhaps CI doesn&apos;t have the proper creds?</z><z id="t1584648090" t="grounded_sage Had to print the whole response. Was nothing in the errors"><y>#</y><d>2020-03-19</d><h>20:01</h><r>grounded_sage</r>Had to print the whole response. Was nothing in the errors</z><z id="t1584648103" t="grounded_sage Found the issue 🙂"><y>#</y><d>2020-03-19</d><h>20:01</h><r>grounded_sage</r>Found the issue <b>🙂</b></z><z id="t1584721612" t="kenny The information in the endpoints.edn file is extremely useful. We&apos;ve been depending on it in many of our specs for aws resources. Is the format in this file something we should be depending on?"><y>#</y><d>2020-03-20</d><h>16:26</h><w>kenny</w>The information in the endpoints.edn file is extremely useful. We&apos;ve been depending on it in many of our specs for aws resources. Is the format in this file something we should be depending on?</z><z id="t1584721791" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] we won&apos;t guarantee it&apos;s format at this point, as it&apos;s sourced from aws"><y>#</y><d>2020-03-20</d><h>16:29</h><r>dchelimsky</r><a>@U083D6HK9</a> we won&apos;t guarantee it&apos;s format at this point, as it&apos;s sourced from aws</z><z id="t1584721835" t="dchelimsky https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-core/src/main/resources/com/amazonaws/partitions/endpoints.json"><y>#</y><d>2020-03-20</d><h>16:30</h><r>dchelimsky</r><a href="https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-core/src/main/resources/com/amazonaws/partitions/endpoints.json" target="_blank">https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-core/src/main/resources/com/amazonaws/partitions/endpoints.json</a></z><z id="t1584721852" t="kenny Ah. That seems unlikely to change."><y>#</y><d>2020-03-20</d><h>16:30</h><r>kenny</r>Ah. That seems unlikely to change.</z><z id="t1584721877" t="dchelimsky Agreed, but there is nobody committing to that (not aws, not cognitect)."><y>#</y><d>2020-03-20</d><h>16:31</h><r>dchelimsky</r>Agreed, but there is nobody committing to that (not aws, not cognitect).</z><z id="t1584721928" t="dchelimsky That said, if you think there&apos;s a good case to be made for an endpoints API, please feel free to submit an issue. We&apos;d be happy to discuss it, at the very least."><y>#</y><d>2020-03-20</d><h>16:32</h><r>dchelimsky</r>That said, if you think there&apos;s a good case to be made for an endpoints API, please feel free to submit an issue. We&apos;d be happy to discuss it, at the very least.</z><z id="t1584722069" t="kenny Depending on it seems better than having to manually write &amp; update these specs. To be clear, I&apos;m not necessarily after an endpoints API, per se. We are using the data in that file to create specs for AWS partitions, services, services in a region, regions in a partition, etc."><y>#</y><d>2020-03-20</d><h>16:34</h><r>kenny</r>Depending on it seems better than having to manually write &amp; update these specs. To be clear, I&apos;m not necessarily after an endpoints API, per se. We are using the data in that file to create specs for AWS partitions, services, services in a region, regions in a partition, etc.</z><z id="t1584722169" t="kenny Having these sort of specs built into aws-api could be useful but potentially a non-goal for the project."><y>#</y><d>2020-03-20</d><h>16:36</h><r>kenny</r>Having these sort of specs built into aws-api could be useful but potentially a non-goal for the project.</z><z id="t1584722932" t="dchelimsky Understood."><y>#</y><d>2020-03-20</d><h>16:48</h><r>dchelimsky</r>Understood.</z><z id="t1584722968" t="dchelimsky But if you&apos;re using it for something broadly applicable, it&apos;s worth some thought."><y>#</y><d>2020-03-20</d><h>16:49</h><r>dchelimsky</r>But if you&apos;re using it for something broadly applicable, it&apos;s worth some thought.</z><z id="t1584722984" t="dchelimsky Even if not for aws-api, but for a separate project."><y>#</y><d>2020-03-20</d><h>16:49</h><r>dchelimsky</r>Even if not for aws-api, but for a separate project.</z><z id="t1585162517" t="kenny [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] The deadlock issue reported https://github.com/cognitect-labs/aws-api/issues/130 was fixed, but I think I&apos;m still seeing something related. We have a SQS message processing service that runs 10 processing threads. All 10 of those threads are currently deadlocked on calls to aws-api. Is there a potential issue with the fix applied for #130 when running lots of requests in parallel? I have a thread dump as well. 4 cognitect-aws-send-* threads are paused on refresh! call https://github.com/cognitect-labs/aws-api/blob/0dc6c388d45a7ebe09a3f147481c61aeaa6e1846/src/cognitect/aws/credentials.clj#L96 ."><y>#</y><d>2020-03-25</d><h>18:55</h><w>kenny</w><a>@dchelimsky</a> The deadlock issue reported <a href="https://github.com/cognitect-labs/aws-api/issues/130" target="_blank">https://github.com/cognitect-labs/aws-api/issues/130</a> was fixed, but I think I&apos;m still seeing something related. We have a SQS message processing service that runs 10 processing threads. All 10 of those threads are currently deadlocked on calls to aws-api. Is there a potential issue with the fix applied for #130 when running lots of requests in parallel? I have a thread dump as well. 4 cognitect-aws-send-* threads are paused on refresh! call <a href="https://github.com/cognitect-labs/aws-api/blob/0dc6c388d45a7ebe09a3f147481c61aeaa6e1846/src/cognitect/aws/credentials.clj#L96" target="_blank">https://github.com/cognitect-labs/aws-api/blob/0dc6c388d45a7ebe09a3f147481c61aeaa6e1846/src/cognitect/aws/credentials.clj#L96</a>.</z><z id="t1585162748" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] there&apos;s always potential! I can&apos;t look at this until Friday, but please feel free to post more information here as you learn more and/or submit an issue."><y>#</y><d>2020-03-25</d><h>18:59</h><r>dchelimsky</r><a>@U083D6HK9</a> there&apos;s always potential! I can&apos;t look at this until Friday, but please feel free to post more information here as you learn more and/or submit an issue.</z><z id="t1585162915" t="kenny Pasted the cognitect-aws-send-* threads here"><y>#</y><d>2020-03-25</d><h>19:01</h><r>kenny</r>Pasted the cognitect-aws-send-* threads here</z><z id="t1585163316" t="kenny All the aws-send threads have been waiting almost exactly the same amount of time. I&apos;ll bet a repro would be running 3 assume role calls in parallel."><y>#</y><d>2020-03-25</d><h>19:08</h><r>kenny</r>All the aws-send threads have been waiting almost exactly the same amount of time. I&apos;ll bet a repro would be running 3 assume role calls in parallel.</z><z id="t1585163420" t="kenny I could forcibly serialize calls to fetch-creds for now."><y>#</y><d>2020-03-25</d><h>19:10</h><r>kenny</r>I could forcibly serialize calls to fetch-creds for now.</z><z id="t1585163941" t="kenny The repro would probably need to be 3 assume role calls with different CredentialsProvider objects since https://github.com/cognitect-labs/aws-api/blob/aff9028757189f9875e8b3ebed18a8f07b624327/src/cognitect/aws/util.clj#L320 code is serializing calls for the same creds provider."><y>#</y><d>2020-03-25</d><h>19:19</h><r>kenny</r>The repro would probably need to be 3 assume role calls with different <code>CredentialsProvider</code> objects since <a href="https://github.com/cognitect-labs/aws-api/blob/aff9028757189f9875e8b3ebed18a8f07b624327/src/cognitect/aws/util.clj#L320" target="_blank">https://github.com/cognitect-labs/aws-api/blob/aff9028757189f9875e8b3ebed18a8f07b624327/src/cognitect/aws/util.clj#L320</a> code is serializing calls for the same creds provider.</z><z id="t1585164041" t="kenny And yes, that could happen in our code. We&apos;re making calls to our customers&apos; AWS accounts. Parallel calls to multiple AWS accounts using different creds providers could easily happen."><y>#</y><d>2020-03-25</d><h>19:20</h><r>kenny</r>And yes, that could happen in our code. We&apos;re making calls to our customers&apos; AWS accounts. Parallel calls to multiple AWS accounts using different creds providers could easily happen.</z><z id="t1585164945" t="kenny Got a repro 🙂"><y>#</y><d>2020-03-25</d><h>19:35</h><r>kenny</r>Got a repro <b>🙂</b></z><z id="t1585165860" t="kenny Repro here: https://github.com/kennyjwilli/aws-api-deadlock"><y>#</y><d>2020-03-25</d><h>19:51</h><r>kenny</r>Repro here: <a href="https://github.com/kennyjwilli/aws-api-deadlock" target="_blank">https://github.com/kennyjwilli/aws-api-deadlock</a></z><z id="t1585168500" t="kenny I think the problem is the same and the fix only made it less likely. This is what is happening in each thread. | invoke DescribeInstances | fetch-creds (AssumeRole) | invoke STS AssumeRole | fetch-creds (implicit) The fetch-creds calls go through the async-fetch-pool which is size 4. If you launch N threads to run the above flow, where N &gt;= async-fetch-pool size, you will get a deadlock. This occurs because the inner fetch-creds call is sitting in the async-fetch-pool&apos;s queue."><y>#</y><d>2020-03-25</d><h>20:35</h><r>kenny</r>I think the problem is the same and the fix only made it less likely. This is what is happening in each thread.
| invoke DescribeInstances
  | fetch-creds (AssumeRole)
    | invoke STS AssumeRole
      | fetch-creds (implicit)

The fetch-creds calls go through the <code>async-fetch-pool</code> which is size 4. If you launch N threads to run the above flow, where N &gt;= async-fetch-pool size, you will get a deadlock. This occurs because the inner fetch-creds call is sitting in the async-fetch-pool&apos;s queue.</z><z id="t1585179327" t="kenny I have created an issue here: https://github.com/cognitect-labs/aws-api/issues/137"><y>#</y><d>2020-03-25</d><h>23:35</h><r>kenny</r>I have created an issue here: <a href="https://github.com/cognitect-labs/aws-api/issues/137" target="_blank">https://github.com/cognitect-labs/aws-api/issues/137</a></z><z id="t1585179380" t="kenny I think the best solution for us near-term is to fork aws-api and set the async-fetch-pool size to 10. I&apos;m sure there is a better, more general solution but we need something to work for the time being."><y>#</y><d>2020-03-25</d><h>23:36</h><r>kenny</r>I think the best solution for us near-term is to fork aws-api and set the async-fetch-pool size to 10. I&apos;m sure there is a better, more general solution but we need something to work for the time being.</z><z id="t1585183120" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] seems like a reasonable near term approach."><y>#</y><d>2020-03-26</d><h>00:38</h><r>dchelimsky</r><a>@U083D6HK9</a> seems like a reasonable near term approach.</z><z id="t1585183853" t="kenny When you have free time, curious about your thoughts on the real solution."><y>#</y><d>2020-03-26</d><h>00:50</h><r>kenny</r>When you have free time, curious about your thoughts on the real solution.</z><z id="t1585183959" t="kenny Implicit creds fetch to a separate pool? "><y>#</y><d>2020-03-26</d><h>00:52</h><r>kenny</r>Implicit creds fetch to a separate pool? </z><z id="t1585184229" t="kenny Separate pool for creds fetch is a half solution too. I suppose you could have arbitrarily nested cred fetching that needs to run. "><y>#</y><d>2020-03-26</d><h>00:57</h><r>kenny</r>Separate pool for creds fetch is a half solution too. I suppose you could have arbitrarily nested cred fetching that needs to run. </z><z id="t1585184651" t="kenny Returning a channel would probably fix this entirely, but I’m assuming there’s a reason it’s run in a thread. "><y>#</y><d>2020-03-26</d><h>01:04</h><r>kenny</r>Returning a channel would probably fix this entirely, but I’m assuming there’s a reason it’s run in a thread. </z><z id="t1585185760" t="dchelimsky It does return a channel - we&apos;re just putting on that channel in a thread from that pool. Making that async/thread is my first instinct. So it&apos;s obviously wrong 😉 If you have an opinion about that, I&apos;m all ears. Also want to hear from [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] ."><y>#</y><d>2020-03-26</d><h>01:22</h><r>dchelimsky</r>It does return a channel - we&apos;re just putting on that channel in a thread from that pool. Making that  <code>async/thread</code> is my first instinct. So it&apos;s obviously wrong <b>😉</b> If you have an opinion about that, I&apos;m all ears. Also want to hear from <a>@U050ECB92</a>.</z><z id="t1585238284" t="kenny I deployed workaround with async-fetch-pool set to 10 yesterday evening. The service has been healthy since. For those looking for a workaround, I can say with high certainty that this will fix it. Wrapping in async/thread as [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] says sounds like another potential solution. I do believe that results in an unbounded number of potential threads to be created. In this case, that should always be small I think."><y>#</y><d>2020-03-26</d><h>15:58</h><r>kenny</r>I deployed workaround with async-fetch-pool set to 10 yesterday evening. The service has been healthy since. For those looking for a workaround, I can say with high certainty that this will fix it. Wrapping in <code>async/thread</code> as <a>@dchelimsky</a> says sounds like another potential solution. I do believe that results in an unbounded number of potential threads to be created. In this case, that should always be small I think.</z><z id="t1585239768" t="dchelimsky It&apos;s bound by core.async&apos;s threadpool size, which defaults to 8, but you can configure it via the clojure.core.async.pool-size system property: https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async/impl/exec/threadpool.clj"><y>#</y><d>2020-03-26</d><h>16:22</h><r>dchelimsky</r>It&apos;s bound by core.async&apos;s threadpool size, which defaults to 8, but you can configure it via the <code>clojure.core.async.pool-size</code> system property: <a href="https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async/impl/exec/threadpool.clj" target="_blank">https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async/impl/exec/threadpool.clj</a></z><z id="t1585241481" t="kenny I don&apos;t think async/thread is bound by that. That&apos;s for the go blocks."><y>#</y><d>2020-03-26</d><h>16:51</h><r>kenny</r>I don&apos;t think async/thread is bound by that. That&apos;s for the go blocks.</z><z id="t1585241532" t="kenny thread calls thread-call which uses thread-macro-executor , defined as a CachedThreadPool https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async.clj#L471 ."><y>#</y><d>2020-03-26</d><h>16:52</h><r>kenny</r><code>thread</code> calls <code>thread-call</code> which uses <code>thread-macro-executor</code>, defined as a CachedThreadPool <a href="https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async.clj#L471" target="_blank">https://github.com/clojure/core.async/blob/1c5efa72ebf65cd23315311d2bc3d890b780696e/src/main/clojure/clojure/core/async.clj#L471</a>.</z><z id="t1585241580" t="kenny The maximumPoolSize for core.async&apos;s call to newCachedThreadPool is Integer.MAX_VALUE ."><y>#</y><d>2020-03-26</d><h>16:53</h><r>kenny</r>The <code>maximumPoolSize</code> for core.async&apos;s call to <code>newCachedThreadPool</code> is <code>Integer.MAX_VALUE</code>.</z><z id="t1585242890" t="dchelimsky So it is bounded 😉 . But yeah, we&apos;ll need to constrain that a bit more."><y>#</y><d>2020-03-26</d><h>17:14</h><r>dchelimsky</r>So it is bounded <b>😉</b>. But yeah, we&apos;ll need to constrain that a bit more.</z><z id="t1585246216" t="kenny I think CredentialsProvider fetch needs to return a channel. That would move the problem to the user. "><y>#</y><d>2020-03-26</d><h>18:10</h><r>kenny</r>I think CredentialsProvider fetch needs to return a channel. That would move the problem to the user. </z><z id="t1585246265" t="kenny Also, I think that is effectively the same as unbounded. Fairly certain bad things will happen as you approach the max int value. "><y>#</y><d>2020-03-26</d><h>18:11</h><r>kenny</r>Also, I think that is effectively the same as unbounded. Fairly certain bad things will happen as you approach the max int value. </z><z id="t1585256565" t="dchelimsky Oh yeah, I was making a joke about it being bounded."><y>#</y><d>2020-03-26</d><h>21:02</h><r>dchelimsky</r>Oh yeah, I was making a joke about it being bounded.</z><z id="t1585256602" t="kenny Ohh, got it 🙂"><y>#</y><d>2020-03-26</d><h>21:03</h><r>kenny</r>Ohh, got it <b>🙂</b></z><z id="t1585256608" t="dchelimsky re: returning a channel from fetch, that would be a breaking change so we won&apos;t do that, but we could add fetch-async to the CredentialsProvider and return a channel from that (and use that in our implementations)."><y>#</y><d>2020-03-26</d><h>21:03</h><r>dchelimsky</r>re: returning a channel from fetch, that would be a breaking change so we won&apos;t do that, but we could add fetch-async to the CredentialsProvider and return a channel from that (and use that in our implementations).</z><z id="t1585256683" t="kenny It would indeed. Deprecating the current method seems like a good idea since it can result in a deadlock. Deadlocks are one of the worst problems to hit."><y>#</y><d>2020-03-26</d><h>21:04</h><r>kenny</r>It would indeed. Deprecating the current method seems like a good idea since it can result in a deadlock. Deadlocks are one of the worst problems to hit.</z><z id="t1585256694" t="dchelimsky I&apos;ll have some time to look at this and talk some things over with other contributors tomorrow so we should have at least a direction. I&apos;ll follow up on the issue at that point."><y>#</y><d>2020-03-26</d><h>21:04</h><r>dchelimsky</r>I&apos;ll have some time to look at this and talk some things over with other contributors tomorrow so we should have at least a direction. I&apos;ll follow up on the issue at that point.</z><z id="t1585329384" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] : [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] and I reviewed this together and think the simplest solution is https://github.com/cognitect-labs/aws-api/commit/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a"><y>#</y><d>2020-03-27</d><h>17:16</h><r>dchelimsky</r><a>@U083D6HK9</a>: <a>@U050ECB92</a> and I reviewed this together and think the simplest solution is <a href="https://github.com/cognitect-labs/aws-api/commit/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a" target="_blank">https://github.com/cognitect-labs/aws-api/commit/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a</a></z><z id="t1585329459" t="dchelimsky Yes, that does use core.async&apos;s thread pool, which is effectively onbounded, but threads are reclaimed after 60 seconds, and we think the risk is very low of this causing any real problems. If you disagree, please explain."><y>#</y><d>2020-03-27</d><h>17:17</h><r>dchelimsky</r>Yes, that does use core.async&apos;s thread pool, which is effectively onbounded, but threads are reclaimed after 60 seconds, and we think the risk is very low of this causing any real problems. If you disagree, please explain.</z><z id="t1585329528" t="dchelimsky re: making fetch async, it already is, effectively. Even though a user implements fetch , it is only ever called via fetch-async . Make sense?"><y>#</y><d>2020-03-27</d><h>17:18</h><r>dchelimsky</r>re: making <code>fetch</code> async, it already is, effectively. Even though a user implements <code>fetch</code>, it is only ever called via <code>fetch-async</code>. Make sense?</z><z id="t1585331411" t="kenny I think this will probably work for pretty much all use cases and don&apos;t have any arguments against using an unbounded pool at this time. Although, I think I would much prefer these threads to be named something more relevent to make for clearer thread dumps. Right, it is async but it is managed implicitly -- the user cannot manage the threads used to fetch credentials if desired. Returning a channel gives the api consumer control over how the credential fetching manages the threads. Perhaps no one would ever want that level of control. Not sure."><y>#</y><d>2020-03-27</d><h>17:50</h><r>kenny</r>I think this will probably work for pretty much all use cases and don&apos;t have any arguments against using an unbounded pool at this time. Although, I think I would much prefer these threads to be named something more relevent to make for clearer thread dumps.

Right, it is async but it is managed implicitly -- the user cannot manage the threads used to fetch credentials if desired. Returning a channel gives the api consumer control over how the credential fetching manages the threads. Perhaps no one would ever want that level of control. Not sure.</z><z id="t1585331800" t="kenny Tangentially, could we remove or change this sentence &quot;See log for more details.&quot; in the anomaly message https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/util.clj#L310 ? {:cognitect.anomalies/category :cognitect.anomalies/fault :cognitect.anomalies/message (format &quot;Unable to fetch %s. See log for more details.&quot; item)} Although the fetch did fail, it may or may not have logged any information about the error. I suggest something like this: &quot;Failed fetching %s. Fetch result was nil. &quot;"><y>#</y><d>2020-03-27</d><h>17:56</h><r>kenny</r>Tangentially, could we remove or change this sentence &quot;See log for more details.&quot; in the anomaly message <a href="https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/util.clj#L310" target="_blank">https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/util.clj#L310</a>?
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault
 :cognitect.anomalies/message (format &quot;Unable to fetch %s. See log for more details.&quot; item)}</pre>
Although the fetch did fail, it may or may not have logged any information about the error. I suggest something like this: &quot;Failed fetching %s. Fetch result was nil. &quot;</z><z id="t1585332272" t="kenny For that matter, why does fetch not support returning an anomaly and nil as failure conditions?"><y>#</y><d>2020-03-27</d><h>18:04</h><r>kenny</r>For that matter, why does fetch not support returning an anomaly and nil as failure conditions?</z><z id="t1585332318" t="kenny It would seem the anomaly response from the AssumeRole call would provide far better information than the current anomaly returned."><y>#</y><d>2020-03-27</d><h>18:05</h><r>kenny</r>It would seem the anomaly response from the AssumeRole call would provide far better information than the current anomaly returned.</z><z id="t1585332910" t="dchelimsky My guess is that was an effort to keep the implementation of https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/credentials.clj#L132 simple, but I agree that anomalies would be better. The problem right now is fetch has &quot;Return the credentials found by this provider, or nil.&quot; in the docstring, and changing implementations to return an anomaly instead risks breaking custom implementations that call fetch directly."><y>#</y><d>2020-03-27</d><h>18:15</h><r>dchelimsky</r>My guess is that was an effort to keep the implementation of <a href="https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/credentials.clj#L132" target="_blank">https://github.com/cognitect-labs/aws-api/blob/d1bfbef63e3d17d6f66fb88d38daf500ced27e9a/src/cognitect/aws/credentials.clj#L132</a> simple, but I agree that anomalies would be better. The problem right now is <code>fetch</code> has &quot;Return the credentials found by this provider, or nil.&quot; in the docstring, and changing implementations to return an anomaly instead risks breaking custom implementations that call fetch directly.</z><z id="t1585332949" t="dchelimsky That said, an anomaly would definitely give us more control and more information!"><y>#</y><d>2020-03-27</d><h>18:15</h><r>dchelimsky</r>That said, an anomaly would definitely give us more control and more information!</z><z id="t1585333142" t="kenny Right. I&apos;m thinking we may even want this in the near future to inform a user of our product that we are unable to authenticate using an IAM role they provided and giving them the AWS returned error message. Actually, I&apos;m pretty sure returning an anomaly as is would already result in an anomaly getting returned haha"><y>#</y><d>2020-03-27</d><h>18:19</h><r>kenny</r>Right. I&apos;m thinking we may even want this in the near future to inform a user of our product that we are unable to authenticate using an IAM role they provided and giving them the AWS returned error message.

Actually, I&apos;m pretty sure returning an anomaly as is would already result in an anomaly getting returned haha</z><z id="t1585333183" t="kenny ... result in the anomaly you returned getting returned to the caller. It just happens as an implementation detail though."><y>#</y><d>2020-03-27</d><h>18:19</h><r>kenny</r>... result in the anomaly you returned getting returned to the caller. It just happens as an implementation detail though.</z><z id="t1585333328" t="dchelimsky Within the aws-api implementation, yes. And we could always update fetch-async to decorate an anomaly with more info."><y>#</y><d>2020-03-27</d><h>18:22</h><r>dchelimsky</r>Within the aws-api implementation, yes. And we could always update <code>fetch-async</code> to decorate an anomaly with more info.</z><z id="t1585333384" t="dchelimsky My concern is for the end user who wrote anything custom that dispatches on nil coming back directly from fetch ."><y>#</y><d>2020-03-27</d><h>18:23</h><r>dchelimsky</r>My concern is for the end user who wrote anything custom that dispatches on <code>nil</code> coming back directly from <code>fetch</code>.</z><z id="t1585333401" t="dchelimsky The likelihood of that is probably very low, but I can&apos;t be sure."><y>#</y><d>2020-03-27</d><h>18:23</h><r>dchelimsky</r>The likelihood of that is probably very low, but I can&apos;t be sure.</z><z id="t1585333441" t="kenny Oh, I see. Oof."><y>#</y><d>2020-03-27</d><h>18:24</h><r>kenny</r>Oh, I see. Oof.</z><z id="t1585333506" t="kenny CredentialsProvider2? 🙂"><y>#</y><d>2020-03-27</d><h>18:25</h><r>kenny</r>CredentialsProvider2? <b>🙂</b></z><z id="t1585333516" t="dchelimsky No joke!"><y>#</y><d>2020-03-27</d><h>18:25</h><r>dchelimsky</r>No joke!</z><z id="t1585333603" t="dchelimsky Though that needs to be reviewed through a more holistic lens."><y>#</y><d>2020-03-27</d><h>18:26</h><r>dchelimsky</r>Though that needs to be reviewed through a more holistic lens.</z><z id="t1585333674" t="kenny As in other things that could be included in this addition?"><y>#</y><d>2020-03-27</d><h>18:27</h><r>kenny</r>As in other things that could be included in this addition?</z><z id="t1585327562" t="ghadi thanks for the clear repro [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}]"><y>#</y><d>2020-03-27</d><h>16:46</h><w>ghadi</w>thanks for the clear repro <a>@kenny</a></z><z id="t1585333600" t="kenny Why does aws-api use put! instead of &gt;! https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L90 ?"><y>#</y><d>2020-03-27</d><h>18:26</h><w>kenny</w>Why does aws-api use <code>put!</code> instead of <code>&gt;!</code> <a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L90" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L90</a>?</z><z id="t1585333649" t="dchelimsky I think that was a refactoring oversight."><y>#</y><d>2020-03-27</d><h>18:27</h><w>dchelimsky</w>I think that was a refactoring oversight.</z><z id="t1585333661" t="dchelimsky That wasn&apos;t all inside a go block before."><y>#</y><d>2020-03-27</d><h>18:27</h><w>dchelimsky</w>That wasn&apos;t all inside a go block before.</z><z id="t1585334024" t="kenny Does response-ch https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82 get garbage collected if region, creds, or endpoint result an anomaly? It seems like a bunch of channels could end up getting built up due to https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107-L115 running even when region/creds/endpoint fetch result in an anomaly."><y>#</y><d>2020-03-27</d><h>18:33</h><w>kenny</w>Does response-ch <a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82</a> get garbage collected if region, creds, or endpoint result an anomaly? It seems like a bunch of channels could end up getting built up due to <a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107-L115" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107-L115</a> running even when region/creds/endpoint fetch result in an anomaly.</z><z id="t1585334434" t="hiredman channels are not special with regards to gc"><y>#</y><d>2020-03-27</d><h>18:40</h><w>hiredman</w>channels are not special with regards to gc</z><z id="t1585334502" t="kenny Then I&apos;m pretty sure this code could result in a large amount of unused channels."><y>#</y><d>2020-03-27</d><h>18:41</h><w>kenny</w>Then I&apos;m pretty sure this code could result in a large amount of unused channels.</z></g><g id="s11"><z id="t1585334511" t="hiredman in this case you can think of response-ch as being a promise, which will be gc&apos;ed when there are no references to it"><y>#</y><d>2020-03-27</d><h>18:41</h><w>hiredman</w>in this case you can think of response-ch as being a promise, which will be gc&apos;ed when there are no references to it</z><z id="t1585334561" t="kenny Isn&apos;t https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L109 going to hold a reference to it forever if any branch besides the :else is hit?"><y>#</y><d>2020-03-27</d><h>18:42</h><w>kenny</w>Isn&apos;t <a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L109" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L109</a> going to hold a reference to it forever if any branch besides the <code>:else</code> is hit?</z><z id="t1585334609" t="hiredman no"><y>#</y><d>2020-03-27</d><h>18:43</h><w>hiredman</w>no</z><z id="t1585334651" t="hiredman go blocks are not gc roots like threads are"><y>#</y><d>2020-03-27</d><h>18:44</h><w>hiredman</w>go blocks are not gc roots like threads are</z><z id="t1585334717" t="hiredman a go block is transformed in to a callback that is registered on a channel, so if there are no other references to a channel, a channel will get gc&apos;ed even if a go block is waiting to put or take from it"><y>#</y><d>2020-03-27</d><h>18:45</h><w>hiredman</w>a go block is transformed in to a callback  that is registered on a channel, so if there are no other references to a channel, a channel will get gc&apos;ed even if a go block is waiting to put or take from it</z><z id="t1585334838" t="kenny Ah, makes sense! Thanks for that explanation. So in this case, the gc will know immediately there will be no references to response-ch since the :else branch was not run, marking the channel for gc?"><y>#</y><d>2020-03-27</d><h>18:47</h><w>kenny</w>Ah, makes sense! Thanks for that explanation. So in this case, the gc will know immediately there will be no references to response-ch since the :else branch was not run, marking the channel for gc?</z><z id="t1585334943" t="hiredman whenever the gc happens to run, if it decides to collect more garbage, it might eventually notice the channel is garbage"><y>#</y><d>2020-03-27</d><h>18:49</h><w>hiredman</w>whenever the gc happens to run, if it decides to collect more garbage, it might eventually notice the channel is garbage</z><z id="t1585335083" t="kenny So it would follow, why is this code written this way instead of with a transducer?"><y>#</y><d>2020-03-27</d><h>18:51</h><w>kenny</w>So it would follow, why is this code written this way instead of with a transducer?</z><z id="t1585335149" t="hiredman that question makes no sense"><y>#</y><d>2020-03-27</d><h>18:52</h><w>hiredman</w>that question makes no sense</z><z id="t1585335238" t="kenny Passing a transducer to the response-ch chan https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82 that does the mapping written in the https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107 ."><y>#</y><d>2020-03-27</d><h>18:53</h><w>kenny</w>Passing a transducer to the response-ch <code>chan</code><a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L82</a> that does the mapping written in the <a href="https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107" target="_blank">https://github.com/cognitect-labs/aws-api/blob/954bd3c0376d84a7defe5215b9f2dee3059e421f/src/cognitect/aws/client.clj#L107</a>.</z><z id="t1585335325" t="kenny i.e., that second go block seems unnecessary"><y>#</y><d>2020-03-27</d><h>18:55</h><w>kenny</w>i.e., that second go block seems unnecessary</z><z id="t1585336009" t="kenny Like this"><y>#</y><d>2020-03-27</d><h>19:06</h><w>kenny</w>Like this</z><z id="t1585336171" t="kenny Or, perhaps even better, this."><y>#</y><d>2020-03-27</d><h>19:09</h><w>kenny</w>Or, perhaps even better, this.</z><z id="t1585336233" t="kenny Easier to read a patch..."><y>#</y><d>2020-03-27</d><h>19:10</h><r>kenny</r>Easier to read a patch...</z><z id="t1585336430" t="kenny This impl seems cleaner &amp; more efficient."><y>#</y><d>2020-03-27</d><h>19:13</h><r>kenny</r>This impl seems cleaner &amp; more efficient.</z><z id="t1585337368" t="dchelimsky Cleaner is subjective. For me the separation of &quot;here&apos;s all the stuff we do to make a request&quot; from &quot;here&apos;s what we do with a response&quot; is easier to reason about."><y>#</y><d>2020-03-27</d><h>19:29</h><r>dchelimsky</r>Cleaner is subjective. For me the separation of &quot;here&apos;s all the stuff we do to make a request&quot; from &quot;here&apos;s what we do with a response&quot; is easier to reason about.</z><z id="t1585337382" t="dchelimsky &quot;more efficient&quot; is less so, of course 🙂"><y>#</y><d>2020-03-27</d><h>19:29</h><r>dchelimsky</r>&quot;more efficient&quot; is less so, of course <b>🙂</b></z><z id="t1585337399" t="dchelimsky Are you just thinking of the extra go block, or something else?"><y>#</y><d>2020-03-27</d><h>19:29</h><r>dchelimsky</r>Are you just thinking of the extra go block, or something else?</z><z id="t1585337726" t="kenny Fair. And yes, the extra go block."><y>#</y><d>2020-03-27</d><h>19:35</h><r>kenny</r>Fair. And yes, the extra go block.</z><z id="t1585337733" t="dchelimsky Got it."><y>#</y><d>2020-03-27</d><h>19:35</h><r>dchelimsky</r>Got it.</z><z id="t1585337747" t="dchelimsky I&apos;m going to leave it as/is for now and get out the change to the thread pool."><y>#</y><d>2020-03-27</d><h>19:35</h><r>dchelimsky</r>I&apos;m going to leave it as/is for now and get out the change to the thread pool.</z><z id="t1585337787" t="dchelimsky I appreciate the input, [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] . Thanks."><y>#</y><d>2020-03-27</d><h>19:36</h><r>dchelimsky</r>I appreciate the input, <a>@kenny</a>. Thanks.</z><z id="t1585337996" t="kenny Of course! This library is great. Thanks for taking the time for discussion &amp; maintenance."><y>#</y><d>2020-03-27</d><h>19:39</h><r>kenny</r>Of course! This library is great. Thanks for taking the time for discussion &amp; maintenance.</z><z id="t1585338516" t="dchelimsky Time well invested. I learn things."><y>#</y><d>2020-03-27</d><h>19:48</h><r>dchelimsky</r>Time well invested. I learn things.</z><z id="t1585671745" t="husayn hello …. has anyone had issues with using cloudfront presigned urls with paths which have whitespaces ?"><y>#</y><d>2020-03-31</d><h>16:22</h><w>husayn</w>hello …. has anyone had issues with using cloudfront presigned urls with paths which have whitespaces ?</z><z id="t1585774529" t="jjttjj I&apos;m attempting to deploy an uberjar to elastic beanstalk for the first time. I&apos;m using the preconfigured Java platform. I have a main class compiled in my jar and working properly on my local machine, ie I can just do java -jar MyProject.jar And it starts up properly (locally). I have uploaded this jar to my beanstalk app. But when I visit the URL I just get a 502 Bad Gateway. the web.log is showing ------------------------------------- /var/log/web-1.log ------------------------------------- Clojure 1.6.0 user=&gt; I&apos;m not seeing clojure 1.6 at all in my deps tree. Any tips on how I can start to debug this? Is there anything else I need to do to prepare the jar?"><y>#</y><d>2020-04-01</d><h>20:55</h><w>jjttjj</w>I&apos;m attempting to deploy an uberjar to elastic beanstalk for the first time. I&apos;m using the preconfigured Java platform.
I have a main class compiled in my jar and working properly on my local machine, ie I can just do
<pre>java -jar MyProject.jar</pre>
And it starts up properly (locally).
I have uploaded this jar to my beanstalk app. But when I visit the URL I just get a 502 Bad Gateway.
the web.log is showing
<pre>-------------------------------------
/var/log/web-1.log
-------------------------------------
Clojure 1.6.0
user=&gt;</pre>
I&apos;m not seeing clojure 1.6 at all in my deps tree.
Any tips on how I can start to debug this? Is there anything else I need to do to prepare the jar?</z><z id="t1585780713" t="hiredman I bet I know"><y>#</y><d>2020-04-01</d><h>22:38</h><w>hiredman</w>I bet I know</z><z id="t1585780743" t="hiredman a jar often has a thing called a manifest in it"><y>#</y><d>2020-04-01</d><h>22:39</h><w>hiredman</w>a jar often has a thing called a manifest in it</z><z id="t1585780761" t="hiredman and in the manifest it might have a Main-Class specified"><y>#</y><d>2020-04-01</d><h>22:39</h><w>hiredman</w>and in the manifest it might have a Main-Class specified</z><z id="t1585780779" t="hiredman java -jar looks for the Main-Class in the manifest and runs that"><y>#</y><d>2020-04-01</d><h>22:39</h><w>hiredman</w>java -jar looks for the Main-Class in the manifest and runs that</z><z id="t1585780805" t="hiredman it looks like your jar is specifying clojure.main as the Main-Class, which just starts the clojure repl"><y>#</y><d>2020-04-01</d><h>22:40</h><w>hiredman</w>it looks like your jar is specifying clojure.main as the Main-Class, which just starts the clojure repl</z><z id="t1585780818" t="hiredman which is why you get the repl starting output in the log there"><y>#</y><d>2020-04-01</d><h>22:40</h><w>hiredman</w>which is why you get the repl starting output in the log there</z><z id="t1585780863" t="hiredman so however you are building your jar isn&apos;t setting the Main-Class attribute to whatever your main class is"><y>#</y><d>2020-04-01</d><h>22:41</h><w>hiredman</w>so however you are building your jar isn&apos;t setting the Main-Class attribute to whatever your main class is</z><z id="t1585784543" t="jjttjj My manifest.mf in the jar looks like this Manifest-Version: 1.0 Built-By: depstar Build-Jdk: 13.0.1 Multi-Release: true Main-Class: main where the main namespace is indeed the correct main class (yeah I know horrible name and single segment namespaces are not a good practice... that shouldn&apos;t be the issue though right?)"><y>#</y><d>2020-04-01</d><h>23:42</h><w>jjttjj</w>My manifest.mf in the jar looks like this
<pre>Manifest-Version: 1.0
Built-By: depstar
Build-Jdk: 13.0.1
Multi-Release: true
Main-Class: main</pre>
where the <code>main</code> namespace is indeed the correct main class (yeah I know horrible name and single segment namespaces are not a good practice... that shouldn&apos;t be the issue though right?)</z><z id="t1585784711" t="jjttjj I think I might have to do additional config related stuff for beanstalk instead of just using the regular jar"><y>#</y><d>2020-04-01</d><h>23:45</h><w>jjttjj</w>I think I might have to do additional config related stuff for beanstalk instead of just using the regular jar</z><z id="t1585785406" t="hiredman I would double check that the beanstalk jar is the same one you are looking at locally, because that looks like a jar launched with a main class of clojure.main"><y>#</y><d>2020-04-01</d><h>23:56</h><w>hiredman</w>I would double check that the beanstalk jar is the same one you are looking at locally, because that looks like a jar launched with a main class of clojure.main</z><z id="t1585788363" t="Alex Miller (Clojure team) it would say clojure.main then"><y>#</y><d>2020-04-02</d><h>00:46</h><r>Alex Miller (Clojure team)</r>it would say clojure.main then</z><z id="t1585785457" t="hiredman or look back over whatever tutorial you are looking at (I assume you are working from some tutorial because you are using clojure 1.6.0)"><y>#</y><d>2020-04-01</d><h>23:57</h><w>hiredman</w>or look back over whatever tutorial you are looking at (I assume you are working from some tutorial because you are using clojure 1.6.0)</z><z id="t1585785527" t="jjttjj that&apos;s the thing though I&apos;m not using clojure 1.6, and it doesn&apos;t appear in my deps tree via clj -Stree"><y>#</y><d>2020-04-01</d><h>23:58</h><w>jjttjj</w>that&apos;s the thing though I&apos;m not using clojure 1.6, and it doesn&apos;t appear in my deps tree via <code>clj -Stree</code></z><z id="t1585785541" t="hiredman you should check what java version you are using locally and in beanstalk"><y>#</y><d>2020-04-01</d><h>23:59</h><w>hiredman</w>you should check what java version you are using locally and in beanstalk</z><z id="t1585785556" t="hiredman the multi-release thing could trip you up"><y>#</y><d>2020-04-01</d><h>23:59</h><w>hiredman</w>the multi-release thing could trip you up</z><z id="t1585785574" t="jjttjj Using 1.13 locally but I also have it working on another server (via the jar) on 1.8 with no issues"><y>#</y><d>2020-04-01</d><h>23:59</h><w>jjttjj</w>Using 1.13 locally but I also have it working on another server (via the jar) on 1.8 with no issues</z><z id="t1585785587" t="jjttjj beanstalk is 1.8 I believe"><y>#</y><d>2020-04-01</d><h>23:59</h><w>jjttjj</w>beanstalk is 1.8 I believe</z><z id="t1585785671" t="hiredman the multi-release: true can make the jar behave differently on different versions of java"><y>#</y><d>2020-04-02</d><h>00:01</h><w>hiredman</w>the multi-release: true can make the jar behave differently on different versions of java</z><z id="t1585785832" t="hiredman I really would double check the jar that is running matches the jar you have locally, like if (I haven&apos;t used beanstalk) beanstalk has the concept of staging a new version before switching to it, could you have staged a version of the jar without deploying it"><y>#</y><d>2020-04-02</d><h>00:03</h><w>hiredman</w>I really would double check the jar that is running matches the jar you have locally, like if (I haven&apos;t used beanstalk) beanstalk has the concept of staging a new version before switching to it, could you have staged a version of the jar without deploying it</z><z id="t1585785867" t="jjttjj yeah I&apos;ll try that once more"><y>#</y><d>2020-04-02</d><h>00:04</h><w>jjttjj</w>yeah I&apos;ll try that once more</z><z id="t1585785931" t="jjttjj grasping at straws, but do you think it could be due to the case difference in the meta-inf directory name?"><y>#</y><d>2020-04-02</d><h>00:05</h><w>jjttjj</w>grasping at straws, but do you think it could be due to the case difference in the meta-inf directory name?</z><z id="t1585785987" t="hiredman yes, but I would expect there to be another manifest under META-INF"><y>#</y><d>2020-04-02</d><h>00:06</h><w>hiredman</w>yes, but I would expect there to be another manifest under META-INF</z><z id="t1585786022" t="hiredman are you on osx and inspecting the jar contents by unzipping?"><y>#</y><d>2020-04-02</d><h>00:07</h><w>hiredman</w>are you on osx and inspecting the jar contents by unzipping?</z><z id="t1585786143" t="jjttjj Ah, actually on windows, looking inside with emacs, but yeah there is an identical manifest in the capitalized directory"><y>#</y><d>2020-04-02</d><h>00:09</h><w>jjttjj</w>Ah, actually on windows, looking inside with emacs, but yeah there is an identical manifest in the capitalized directory</z><z id="t1585786255" t="hiredman Identical contents"><y>#</y><d>2020-04-02</d><h>00:10</h><w>hiredman</w>Identical contents</z><z id="t1585786260" t="hiredman ?"><y>#</y><d>2020-04-02</d><h>00:11</h><w>hiredman</w>?</z><z id="t1585786282" t="jjttjj yes exactly the same"><y>#</y><d>2020-04-02</d><h>00:11</h><w>jjttjj</w>yes exactly the same</z><z id="t1585786839" t="hiredman Try repackaging the jar, unzip remove the lower case meta inf, and zip it all back up"><y>#</y><d>2020-04-02</d><h>00:20</h><w>hiredman</w>Try repackaging the jar, unzip remove the lower case meta inf, and zip it all back up</z><z id="t1585787016" t="jjttjj giving that a shot now"><y>#</y><d>2020-04-02</d><h>00:23</h><w>jjttjj</w>giving that a shot now</z><z id="t1585787057" t="hiredman My current guess is something about the case change is still messing things up, maybe however you are inspect file contents is also tripping over it"><y>#</y><d>2020-04-02</d><h>00:24</h><w>hiredman</w>My current guess is something about the case change is still messing things up, maybe however you are inspect file contents is also tripping over it</z><z id="t1585787101" t="hiredman The case thing is so weird"><y>#</y><d>2020-04-02</d><h>00:25</h><w>hiredman</w>The case thing is so weird</z><z id="t1585787140" t="jjttjj It must stem from this"><y>#</y><d>2020-04-02</d><h>00:25</h><w>jjttjj</w>It must stem from this</z><z id="t1585787141" t="jjttjj https://issues.apache.org/jira/browse/MJAR-73?attachmentOrder=desc"><y>#</y><d>2020-04-02</d><h>00:25</h><w>jjttjj</w><a href="https://issues.apache.org/jira/browse/MJAR-73?attachmentOrder=desc" target="_blank">https://issues.apache.org/jira/browse/MJAR-73?attachmentOrder=desc</a></z><z id="t1585787201" t="hiredman One of your dependencies may be badly packaged"><y>#</y><d>2020-04-02</d><h>00:26</h><w>hiredman</w>One of your dependencies may be badly packaged</z><z id="t1585787488" t="jjttjj No dice. Gonna give up for tonight, but thanks for the help"><y>#</y><d>2020-04-02</d><h>00:31</h><w>jjttjj</w>No dice. Gonna give up for tonight, but thanks for the help</z><z id="t1585799192" t="jumar [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] Check the app logs first! Yesterday, I was troubleshooting a very similar issue for somebody on another slack team and it was indeed because of a mismatch between build JDK version (13) and beanstalk java version (8). I know you menteiond it&apos;s running fine elsewhere but the logs should definitely give you the answer."><y>#</y><d>2020-04-02</d><h>03:46</h><w>jumar</w><a>@jjttjj</a> Check the app logs first! Yesterday, I was troubleshooting a very similar issue for somebody on another slack team and it was indeed because of a mismatch between build JDK version (13) and beanstalk java version (8).
I know you menteiond it&apos;s running fine elsewhere but the logs should definitely give you the answer.</z><z id="t1585802356" t="orestis FWIW I install Clojure tools and run stuff in Beanstalk directly from source. Wrote a post here https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161"><y>#</y><d>2020-04-02</d><h>04:39</h><w>orestis</w>FWIW I install Clojure tools and run stuff in Beanstalk directly from source. Wrote a post here <a href="https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161" target="_blank">https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161</a></z><z id="t1585992915" t="jjttjj This worked great thanks!"><y>#</y><d>2020-04-04</d><h>09:35</h><r>jjttjj</r>This worked great thanks!</z><z id="t1585933474" t="arohner does anyone have an example of downloading a binary file from S3? I’ve attempted to use cognitect, amazonica, and clj-aws-s3, and all download a file, but with different MD5s than aws-cli"><y>#</y><d>2020-04-03</d><h>17:04</h><w>arohner</w>does anyone have an example of downloading a binary file from S3? I’ve attempted to use cognitect, amazonica, and clj-aws-s3, and all download a file, but with different MD5s than <code>aws-cli</code></z><z id="t1585933533" t="arohner what I’m doing seems pretty simple: (let [resp (aws/invoke s3-client {:op :GetObject :request {:Bucket bucket :Key filename}})] (io/copy (:Body resp) (io/output-stream (io/file filename))) resp)"><y>#</y><d>2020-04-03</d><h>17:05</h><w>arohner</w>what I’m doing seems pretty simple:
<pre>(let [resp (aws/invoke s3-client {:op :GetObject :request {:Bucket bucket :Key filename}})]
    (io/copy (:Body resp) (io/output-stream (io/file filename)))
    resp)</pre></z><z id="t1585935338" t="arohner hrm, the pure java version works: (let [java-client (com.amazonaws.services.s3.AmazonS3ClientBuilder/defaultClient)] (with-open [obj (.getObject java-client (com.amazonaws.services.s3.model.GetObjectRequest. bucket key))] (java.nio.file.Files/copy (.getObjectContent obj) (.toPath (io/file dest-path)) (into-array java.nio.file.CopyOption [java.nio.file.StandardCopyOption/REPLACE_EXISTING]))))"><y>#</y><d>2020-04-03</d><h>17:35</h><w>arohner</w>hrm, the pure java version works:
<pre>(let [java-client (com.amazonaws.services.s3.AmazonS3ClientBuilder/defaultClient)]
    (with-open [obj (.getObject java-client (com.amazonaws.services.s3.model.GetObjectRequest. bucket key))]
      (java.nio.file.Files/copy (.getObjectContent obj) (.toPath (io/file dest-path)) (into-array java.nio.file.CopyOption [java.nio.file.StandardCopyOption/REPLACE_EXISTING]))))</pre></z><z id="t1585935634" t="ghadi different MD5s from different clients is suspicious"><y>#</y><d>2020-04-03</d><h>17:40</h><w>ghadi</w>different MD5s from different clients is suspicious</z><z id="t1585936357" t="arohner $ md5 datomic-pro-*.zip MD5 (datomic-pro-0.9.6045-amazonica.zip) = 9b1c544ce7b68a6d4bcc7477c501cf6a MD5 (datomic-pro-0.9.6045-aws-cli.zip) = 50d60403c5cf505ac12f31a7081995b5 MD5 (datomic-pro-0.9.6045-clj-s3.zip) = 9b1c544ce7b68a6d4bcc7477c501cf6a MD5 (datomic-pro-0.9.6045-cognitect.zip) = 3d95d706e81ea53363b2c3f29b64ec74 MD5 (datomic-pro-0.9.6045-java.zip) = 50d60403c5cf505ac12f31a7081995b5"><y>#</y><d>2020-04-03</d><h>17:52</h><w>arohner</w><pre>$ md5 datomic-pro-*.zip
MD5 (datomic-pro-0.9.6045-amazonica.zip) = 9b1c544ce7b68a6d4bcc7477c501cf6a
MD5 (datomic-pro-0.9.6045-aws-cli.zip) = 50d60403c5cf505ac12f31a7081995b5
MD5 (datomic-pro-0.9.6045-clj-s3.zip) = 9b1c544ce7b68a6d4bcc7477c501cf6a
MD5 (datomic-pro-0.9.6045-cognitect.zip) = 3d95d706e81ea53363b2c3f29b64ec74
MD5 (datomic-pro-0.9.6045-java.zip) = 50d60403c5cf505ac12f31a7081995b5</pre></z><z id="t1585936383" t="arohner aws-cli and java are correct. Unsure why the others are wrong"><y>#</y><d>2020-04-03</d><h>17:53</h><w>arohner</w><code>aws-cli</code> and <code>java</code> are correct. Unsure why the others are wrong</z><z id="t1585936692" t="hiredman try it without the io/output-stream around the io/file"><y>#</y><d>2020-04-03</d><h>17:58</h><w>hiredman</w>try it without the io/output-stream around the io/file</z><z id="t1585936712" t="hiredman are the file sizes different?"><y>#</y><d>2020-04-03</d><h>17:58</h><w>hiredman</w>are the file sizes different?</z><z id="t1585936719" t="arohner yes"><y>#</y><d>2020-04-03</d><h>17:58</h><w>arohner</w>yes</z><z id="t1585936739" t="hiredman copy doesn&apos;t close streams that are passed in to it if I recall"><y>#</y><d>2020-04-03</d><h>17:58</h><w>hiredman</w>copy doesn&apos;t close streams that are passed in to it if I recall</z><z id="t1585936753" t="arohner -rw-r--r-- 1 arohner staff 333382279 Apr 3 10:57 datomic-pro-0.9.6045-amazonica.zip -rw-r--r-- 1 arohner staff 333390244 Apr 3 10:12 datomic-pro-0.9.6045-aws-cli.zip -rw-r--r-- 1 arohner staff 333382279 Apr 3 11:12 datomic-pro-0.9.6045-clj-s3.zip -rw-r--r-- 1 arohner staff 333389824 Apr 3 11:29 datomic-pro-0.9.6045-cognitect.zip -rw-r--r-- 1 arohner staff 333390244 Apr 3 12:33 datomic-pro-0.9.6045-java.zip"><y>#</y><d>2020-04-03</d><h>17:59</h><w>arohner</w><pre>-rw-r--r--   1 arohner  staff  333382279 Apr  3 10:57 datomic-pro-0.9.6045-amazonica.zip
-rw-r--r--   1 arohner  staff  333390244 Apr  3 10:12 datomic-pro-0.9.6045-aws-cli.zip
-rw-r--r--   1 arohner  staff  333382279 Apr  3 11:12 datomic-pro-0.9.6045-clj-s3.zip
-rw-r--r--   1 arohner  staff  333389824 Apr  3 11:29 datomic-pro-0.9.6045-cognitect.zip
-rw-r--r--   1 arohner  staff  333390244 Apr  3 12:33 datomic-pro-0.9.6045-java.zip</pre></z><z id="t1585936968" t="ghadi ([input output &amp; opts]) Copies input to output. Returns nil or throws IOException. Input may be an InputStream, Reader, File, byte[], char[], or String. Output may be an OutputStream, Writer, or File. Options are key/value pairs and may be one of :buffer-size buffer size to use, default is 1024. :encoding encoding to use if converting between byte and char streams. Does not close any streams except those it opens itself (on a File)."><y>#</y><d>2020-04-03</d><h>18:02</h><w>ghadi</w><pre>
([input output &amp; opts])
  Copies input to output.  Returns nil or throws IOException.
  Input may be an InputStream, Reader, File, byte[], char[], or String.
  Output may be an OutputStream, Writer, or File.

  Options are key/value pairs and may be one of

    :buffer-size  buffer size to use, default is 1024.
    :encoding     encoding to use if converting between
                  byte and char streams.

  Does not close any streams except those it opens itself
  (on a File).</pre></z><z id="t1585937792" t="arohner yeah, that was it, thanks"><y>#</y><d>2020-04-03</d><h>18:16</h><w>arohner</w>yeah, that was it, thanks</z><z id="t1586463176" t="kenny Curious how folks who use Cognitect&apos;s aws-api handle testing. We are currently using with-redefs on invoke while testing. This feels gross. I&apos;m considering creating a protocol that has an invoke method. We&apos;d then extend the Client type to use this protocol and use our own invoke method instead of the invoke function in aws-api. This would let us create mock clients during tests, removing the need for with-redefs."><y>#</y><d>2020-04-09</d><h>20:12</h><w>kenny</w>Curious how folks who use Cognitect&apos;s aws-api handle testing. We are currently using <code>with-redefs</code> on <code>invoke</code> while testing. This feels gross. I&apos;m considering creating a protocol that has an <code>invoke</code> method. We&apos;d then extend the Client type to use this protocol and use our own <code>invoke</code> method instead of the invoke function in aws-api. This would let us create mock clients during tests, removing the need for with-redefs.</z><z id="t1586463536" t="thegeez (aws/invoke (aws/client {:api :dynamodb :http-client MY_MOCK_HTTP_CLIENT}) {:op :ListTables}) Something like that ^ ?"><y>#</y><d>2020-04-09</d><h>20:18</h><w>thegeez</w><pre>(aws/invoke (aws/client {:api :dynamodb :http-client MY_MOCK_HTTP_CLIENT}) {:op :ListTables})</pre>
Something like that ^ ?</z><z id="t1586463607" t="kenny I suppose. I&apos;d prefer to work at the aws-api client level than the request level."><y>#</y><d>2020-04-09</d><h>20:20</h><r>kenny</r>I suppose. I&apos;d prefer to work at the aws-api client level than the request level.</z><z id="t1586463601" t="ghadi IMHO you should abstract in front of aws-api and let it be an impl detail"><y>#</y><d>2020-04-09</d><h>20:20</h><w>ghadi</w>IMHO you should abstract in front of aws-api and let it be an impl detail</z><z id="t1586463618" t="ghadi don&apos;t try to intercept individual ops, but make pluggable application level things"><y>#</y><d>2020-04-09</d><h>20:20</h><w>ghadi</w>don&apos;t try to intercept individual ops, but make pluggable application level things</z><z id="t1586463760" t="ghadi"><y>#</y><d>2020-04-09</d><h>20:22</h><w>ghadi</w></z><z id="t1586809876" t="kenny Have you applied something similar to Datomic?"><y>#</y><d>2020-04-13</d><h>20:31</h><r>kenny</r>Have you applied something similar to Datomic?</z><z id="t1586810045" t="ghadi no, mostly because the API to datomic is already pretty generic data"><y>#</y><d>2020-04-13</d><h>20:34</h><r>ghadi</r>no, mostly because the API to datomic is already pretty generic data</z><z id="t1586463770" t="ghadi small example of pluggable impls ^"><y>#</y><d>2020-04-09</d><h>20:22</h><w>ghadi</w>small example of pluggable impls ^</z><z id="t1586463850" t="kenny Hmm. That&apos;s an interesting pattern. Essentially all effects become protocols?"><y>#</y><d>2020-04-09</d><h>20:24</h><w>kenny</w>Hmm. That&apos;s an interesting pattern. Essentially all effects become protocols?</z><z id="t1586465349" t="ghadi i&apos;m not making prescriptions about all"><y>#</y><d>2020-04-09</d><h>20:49</h><w>ghadi</w>i&apos;m not making prescriptions about all</z><z id="t1586465377" t="ghadi but i do think that coupling to aws-api, or clj-http, or any X library, is a bad idea"><y>#</y><d>2020-04-09</d><h>20:49</h><w>ghadi</w>but i do think that coupling to aws-api, or clj-http, or any X library, is a bad idea</z><z id="t1586465499" t="ghadi program to abstractions, not concretions"><y>#</y><d>2020-04-09</d><h>20:51</h><w>ghadi</w>program to abstractions, not concretions</z><z id="t1586465974" t="kenny I could swear I&apos;ve head this elsewhere 🙂 I quite like this train of thought. Is this from a talk or blog or simply a product of your own creation?"><y>#</y><d>2020-04-09</d><h>20:59</h><r>kenny</r>I could swear I&apos;ve head this elsewhere <b>🙂</b> I quite like this train of thought. Is this from a talk or blog or simply a product of your own creation?</z><z id="t1586471569" t="mruzekw Sounds like something Rich Hickey would say"><y>#</y><d>2020-04-09</d><h>22:32</h><r>mruzekw</r>Sounds like something Rich Hickey would say</z><z id="t1586519200" t="jaihindhreddy It is something similar to what Rich Hickey said a lot of times. Clojure is an improvement on the classic Perlis quote &quot;It is better to have 100 functions operate on one data structure than to have 10 functions operate on 10 data structures.&quot; Clojure improves this by providing 100 fns on no data structure. The fns instead depend on abstractions like clojure.lang.IPersistentMap , clojure.lang.ISeq etc."><y>#</y><d>2020-04-10</d><h>11:46</h><r>jaihindhreddy</r>It is something similar to what Rich Hickey said a lot of times. Clojure is an improvement on the classic Perlis quote &quot;It is better to have 100 functions operate on one data structure than to have 10 functions operate on 10 data structures.&quot;
Clojure improves this by providing 100 fns on no data structure. The fns instead depend on abstractions like <code>clojure.lang.IPersistentMap</code>, <code>clojure.lang.ISeq</code> etc.</z><z id="t1586535396" t="dchelimsky https://en.wikipedia.org/wiki/Dependency_inversion_principle (program to abstractions, not concretions). You can apply this principle to &quot;abstraction&quot; in this conversation, i.e. Clojure Protocols or Java Interfaces are implementation details of the abstract concept of &quot;abstraction&quot; 🙂"><y>#</y><d>2020-04-10</d><h>16:16</h><r>dchelimsky</r><a href="https://en.wikipedia.org/wiki/Dependency_inversion_principle" target="_blank">https://en.wikipedia.org/wiki/Dependency_inversion_principle</a> (program to abstractions, not concretions). You can apply this principle to &quot;abstraction&quot; in this conversation, i.e. Clojure Protocols or Java Interfaces are implementation details of the abstract concept of &quot;abstraction&quot; <b>🙂</b></z><z id="t1586810182" t="kenny [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] Are there any other resources on that pattern that you know of that apply to functional programming and/or Clojure?"><y>#</y><d>2020-04-13</d><h>20:36</h><r>kenny</r><a>@U0ENYLGTA</a> Are there any other resources on that pattern that you know of that apply to functional programming and/or Clojure?</z><z id="t1586810565" t="kenny Looking for things that help me think about what the abstractions are. A good point in the wiki is: &gt; Implementing generic interfaces everywhere in a project makes it harder to understand and maintain. At each step the reader will ask themself what are the other implementations of this interface and the response is generally: only mocks."><y>#</y><d>2020-04-13</d><h>20:42</h><r>kenny</r>Looking for things that help me think about what the abstractions are.

A good point in the wiki is:
&gt; Implementing generic interfaces everywhere in a project makes it harder to understand and maintain. At each step the reader will ask themself what are the other implementations of this interface and the response is generally: only mocks.</z><z id="t1586840884" t="jaihindhreddy I feel it&apos;s a bad abstraction if it&apos;s not self-explanatory and requires readers to ponder the possible implementations to understand the abstraction. Where and how to abstract is a very hard problem indeed. Zach Tellman gave an excellent talk on the topic: https://www.youtube.com/watch?v=x9pxbnFC4aQ Rich Hickey&apos;s talks have also help me a lot in thinking about these things. These in particular: Simple Made Easy: https://www.youtube.com/watch?v=kGlVcSMgtV4 Design, Composition, and Performance: https://www.youtube.com/watch?v=MCZ3YgeEUPg"><y>#</y><d>2020-04-14</d><h>05:08</h><r>jaihindhreddy</r>I feel it&apos;s a bad abstraction if it&apos;s not self-explanatory and requires readers to ponder the possible implementations to understand the abstraction. Where and how to abstract is a very hard problem indeed.
Zach Tellman gave an excellent talk on the topic: <a href="https://www.youtube.com/watch?v=x9pxbnFC4aQ" target="_blank">https://www.youtube.com/watch?v=x9pxbnFC4aQ</a>
Rich Hickey&apos;s talks have also help me a lot in thinking about these things. These in particular:
Simple Made Easy: <a href="https://www.youtube.com/watch?v=kGlVcSMgtV4" target="_blank">https://www.youtube.com/watch?v=kGlVcSMgtV4</a>
Design, Composition, and Performance: <a href="https://www.youtube.com/watch?v=MCZ3YgeEUPg" target="_blank">https://www.youtube.com/watch?v=MCZ3YgeEUPg</a></z><z id="t1586465799" t="ghadi actually I will make a prescription [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] :"><y>#</y><d>2020-04-09</d><h>20:56</h><w>ghadi</w>actually I will make a prescription <a>@kenny</a> :</z><z id="t1586465835" t="ghadi grep for with-redefs in your projects and parameterize those things you find"><y>#</y><d>2020-04-09</d><h>20:57</h><w>ghadi</w>grep for <code>with-redefs</code> in your projects and parameterize those things you find</z><z id="t1586577494" t="Jin I have some urgent problem I created new instance (ubuntu ) on AWS ec2 and I forgot the .pem file is there any way to access on this current instance?"><y>#</y><d>2020-04-11</d><h>03:58</h><w>Jin</w>I have some urgent problem
I created new instance (ubuntu ) on AWS ec2
and I forgot the .pem file
is there any way to access on this current instance?</z><z id="t1586578270" t="hiredman &quot;Amazon EC2 doesn&apos;t keep a copy of your private key; therefore, if you lose a private key, there is no way to recover it.&quot; https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html"><y>#</y><d>2020-04-11</d><h>04:11</h><w>hiredman</w>&quot;Amazon EC2 doesn&apos;t keep a copy of your private key; therefore, if you lose a private key, there is no way to recover it.&quot; <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html</a></z><z id="t1586595784" t="include ^ 1) stop instance, create a snapshot, from snapshot create a volume. 2) create new key, create new instance with that key, attach and mount new volume using the volume created above."><y>#</y><d>2020-04-11</d><h>09:03</h><w>include</w>^ 1) stop instance, create a snapshot, from snapshot create a volume. 2) create new key, create new instance with that key, attach and mount new volume using the volume created above.</z><z id="t1587741724" t="souenzzo What are the options for logging clojure into aws? logback appender to s3? logback appender to cloudwatch?"><y>#</y><d>2020-04-24</d><h>15:22</h><w>souenzzo</w>What are the options for logging clojure into aws?
logback appender to s3? logback appender to cloudwatch?</z><z id="t1587742064" t="viesti run stuff via ECS and just println JSON 🙂"><y>#</y><d>2020-04-24</d><h>15:27</h><w>viesti</w>run stuff via ECS and just println JSON <b>🙂</b></z><z id="t1587742083" t="viesti docker log driver will then push stdout/stderr to cloudwatch, cloudwatch parses the json even"><y>#</y><d>2020-04-24</d><h>15:28</h><w>viesti</w>docker log driver will then push stdout/stderr to cloudwatch, cloudwatch parses the json even</z><z id="t1587742141" t="viesti that is if you&apos;r in dockerlandia"><y>#</y><d>2020-04-24</d><h>15:29</h><w>viesti</w>that is if you&apos;r in dockerlandia</z><z id="t1587747987" t="souenzzo [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] I&apos;m running in EC2 and I can&apos;t change that (there is no c5 class in ECS) I&apos;m right that I want something like a appender to cloudwatch service. but still looking for possible implementations"><y>#</y><d>2020-04-24</d><h>17:06</h><w>souenzzo</w><a>@viesti</a> I&apos;m running in <code>EC2</code> and I can&apos;t change that (there is no <code>c5</code> class in ECS)
I&apos;m right that I want something like a appender to cloudwatch service. but still looking for possible implementations</z><z id="t1587749182" t="viesti hmm, if you can install cloudwatch agent (or Fluentbit) to the machine, then you could log to a file and let the agent tail it and push to CloudWatch"><y>#</y><d>2020-04-24</d><h>17:26</h><w>viesti</w>hmm, if you can install cloudwatch agent (or Fluentbit) to the machine, then you could log to a file and let the agent tail it and push to CloudWatch</z><z id="t1587749731" t="viesti seems that there are multiple logback appenders for cloudwatch (google brought up com.j256.cloudwatchlogbackappender/cloudwatchlogbackappender for example), I haven&apos;t used them but they might also be of use"><y>#</y><d>2020-04-24</d><h>17:35</h><w>viesti</w>seems that there are multiple logback appenders for cloudwatch (google brought up com.j256.cloudwatchlogbackappender/cloudwatchlogbackappender for example), I haven&apos;t used them but they might also be of use</z><z id="t1587749858" t="viesti extra log shipping agent might sound a bit much, but then again, that puts the error handling of pushing logs to a remote service, out from the JVM of the application"><y>#</y><d>2020-04-24</d><h>17:37</h><w>viesti</w>extra log shipping agent might sound a bit much, but then again, that puts the error handling of pushing logs to a remote service, out from the JVM of the application</z><z id="t1587749992" t="viesti on ECS, I&apos;d think that just running the ECS agent and configuring the cluster it checks into should make the box available to ECS, but yeah, there&apos;s more to it if the application isn&apos;t on docker (and might be more stuff I don&apos;t know about)"><y>#</y><d>2020-04-24</d><h>17:39</h><w>viesti</w>on ECS, I&apos;d think that just running the ECS agent and configuring the cluster it checks into should make the box available to ECS, but yeah, there&apos;s more to it if the application isn&apos;t on docker (and might be more stuff I don&apos;t know about)</z><z id="t1587751487" t="orestis Amazon is doing something for Elastic Beanstalk, I think installing the cloud watch agent? "><y>#</y><d>2020-04-24</d><h>18:04</h><w>orestis</w>Amazon is doing something for Elastic Beanstalk, I think installing the cloud watch agent? </z><z id="t1587754115" t="valtteri CloudWatch Agent is simple to install and it comes with a nice wizard that creates the config file for you. You can tell it which log files you want to start tailing."><y>#</y><d>2020-04-24</d><h>18:48</h><w>valtteri</w>CloudWatch Agent is simple to install and it comes with a nice wizard that creates the config file for you. You can tell it which log files you want to start tailing.</z><z id="t1587754126" t="valtteri And yes, I think Beanstalk uses CloudWatch agent as well"><y>#</y><d>2020-04-24</d><h>18:48</h><w>valtteri</w>And yes, I think Beanstalk uses CloudWatch agent as well</z><z id="t1587775115" t="include ^ yes it comes and it delivers logs and monitoring automatically to EBs dashboard."><y>#</y><d>2020-04-25</d><h>00:38</h><w>include</w>^ yes it comes and it delivers logs and monitoring automatically to EBs dashboard.</z><z id="t1587903242" t="solf Re-asking this here: Anyone knows what is this error when using aws-cli? (def s3 (aws/client {:api :s3})) (aws/validate-requests s3 true) (aws/invoke s3 {:op :ListBuckets}) =&gt; {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message nil, :cognitect.http-client/throwable #error { :cause nil :via [{:type java.nio.channels.ClosedChannelException :message nil :at [.FillInterest onClose &quot;FillInterest.java&quot; 150]}] :trace [[.FillInterest onClose &quot;FillInterest.java&quot; 150] [.AbstractEndPoint onClose &quot;AbstractEndPoint.java&quot; 354] [.ChannelEndPoint onClose &quot;ChannelEndPoint.java&quot; 216] [.AbstractEndPoint doOnClose &quot;AbstractEndPoint.java&quot; 225] [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 192] [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 175] [.ssl.SslConnection$DecryptedEndPoint doClose &quot;SslConnection.java&quot; 1132] [.AbstractEndPoint doOnClose &quot;AbstractEndPoint.java&quot; 220] [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 192] [.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 425] [.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 305] [.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 159] [.FillInterest fillable &quot;FillInterest.java&quot; 103] [.ChannelEndPoint$2 run &quot;ChannelEndPoint.java&quot; 118] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 336] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 313] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 171] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 129] [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 388] [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 806] [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 938] [java.lang.Thread run &quot;Thread.java&quot; 834]]}}"><y>#</y><d>2020-04-26</d><h>12:14</h><w>solf</w>Re-asking this here:
Anyone knows what is this error when using aws-cli?
<pre>(def s3 (aws/client {:api :s3}))
(aws/validate-requests s3 true)

(aws/invoke s3 {:op :ListBuckets})

=&gt;
{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.anomalies/message nil,
 :cognitect.http-client/throwable
 #error
 {
  :cause nil
  :via
  [{:type java.nio.channels.ClosedChannelException
    :message nil
    :at [.FillInterest onClose &quot;FillInterest.java&quot; 150]}]
  :trace
  [[.FillInterest onClose &quot;FillInterest.java&quot; 150]
   [.AbstractEndPoint onClose &quot;AbstractEndPoint.java&quot; 354]
   [.ChannelEndPoint onClose &quot;ChannelEndPoint.java&quot; 216]
   [.AbstractEndPoint doOnClose &quot;AbstractEndPoint.java&quot; 225]
   [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 192]
   [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 175]
   [.ssl.SslConnection$DecryptedEndPoint doClose &quot;SslConnection.java&quot; 1132]
   [.AbstractEndPoint doOnClose &quot;AbstractEndPoint.java&quot; 220]
   [.AbstractEndPoint close &quot;AbstractEndPoint.java&quot; 192]
   [.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 425]
   [.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 305]
   [.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 159]
   [.FillInterest fillable &quot;FillInterest.java&quot; 103]
   [.ChannelEndPoint$2 run &quot;ChannelEndPoint.java&quot; 118]
   [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 336]
   [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 313]
   [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 171]
   [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 129]
   [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 388]
   [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 806]
   [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 938]
   [java.lang.Thread run &quot;Thread.java&quot; 834]]}}</pre></z><z id="t1587903276" t="solf I think it might be some kind of SSL issue? But I have no idea how to solve it. I can list the buckets using aws-cli on the command line without issue"><y>#</y><d>2020-04-26</d><h>12:14</h><w>solf</w>I think it might be some kind of SSL issue? But I have no idea how to solve it. I can list the buckets using aws-cli on the command line without issue</z><z id="t1587910912" t="Aleed anyone else here have a bad experience with Cognito? did you stick with it? i’m finding there’s a lot of quirks you have to workaround, e.g., username can’t be changed so you have to use preferred_username for that but then Cognito doesn’t let you add that attribute on signup until user has been confirmed, etc. and finding this out as I go cause docs aren’t too great"><y>#</y><d>2020-04-26</d><h>14:21</h><w>Aleed</w>anyone else here have a bad experience with Cognito? did you stick with it?
i’m finding there’s a lot of quirks you have to workaround, e.g., <code>username</code> can’t be changed so you have to use <code>preferred_username</code> for that but then Cognito doesn’t let you add that attribute on signup until user has been confirmed, etc. and finding this out as I go cause docs aren’t too great</z><z id="t1587914069" t="valtteri Cognito is pain. However once you figure it out it works. Also it’s cheaper than Auth0 and other more friendly alternatives."><y>#</y><d>2020-04-26</d><h>15:14</h><w>valtteri</w>Cognito is pain. However once you figure it out it works. Also it’s cheaper than Auth0 and other more friendly alternatives.</z><z id="t1587914630" t="Aleed yeah already getting the hang of it, just surprised - didn’t expect it to have so many kinks since AWS is well regarded. it’s also my first Clojure/Datomic API so it’s been quite a hurdle"><y>#</y><d>2020-04-26</d><h>15:23</h><w>Aleed</w>yeah already getting the hang of it, just surprised -  didn’t expect it to have so many kinks since AWS is well regarded. it’s also my first Clojure/Datomic API so it’s been quite a hurdle</z><z id="t1587954324" t="steveb8n I’m using Cognito. It was nasty to set up but (as you say) is good to keep everything with one vendor. I eventually set it up using CDK"><y>#</y><d>2020-04-27</d><h>02:25</h><w>steveb8n</w>I’m using Cognito. It was nasty to set up but (as you say) is good to keep everything with one vendor. I eventually set it up using CDK</z><z id="t1587954350" t="steveb8n I plan to move to Keycloak in the future though: better features and docs all around. Can still run that on AWS"><y>#</y><d>2020-04-27</d><h>02:25</h><w>steveb8n</w>I plan to move to Keycloak in the future though: better features and docs all around. Can still run that on AWS</z><z id="t1587971100" t="Ahmed Hassan There&apos;s library named `keycloak-clojure` to wrap the Keycloak Java Adapter https://github.com/jgrodziski/keycloak-clojure"><y>#</y><d>2020-04-27</d><h>07:05</h><r>Ahmed Hassan</r>There&apos;s library named `keycloak-clojure` to wrap the Keycloak Java Adapter
<a href="https://github.com/jgrodziski/keycloak-clojure" target="_blank">https://github.com/jgrodziski/keycloak-clojure</a></z><z id="t1587971401" t="Ahmed Hassan How much feasible is setting up Keycloak for a single developer? vs using sessions and PostgreSQL tables for user&apos;s email/username, roles, hashed password and permissions? Using Buddy and Permissions ( https://github.com/tuhlmann/permissions ) for this purpose. I&apos;m asking from the perspective of operational cost, complexity, barriers versus benefit."><y>#</y><d>2020-04-27</d><h>07:10</h><r>Ahmed Hassan</r>How much feasible is setting up Keycloak for a single developer? vs using sessions and PostgreSQL tables for user&apos;s email/username, roles, hashed password and permissions? Using Buddy and Permissions (<a href="https://github.com/tuhlmann/permissions" target="_blank">https://github.com/tuhlmann/permissions</a>) for this purpose.
I&apos;m asking from the perspective of operational cost, complexity, barriers versus benefit.</z><z id="t1587976589" t="Ahmed Hassan [:attrs {:class &quot;username&quot;}] "><y>#</y><d>2020-04-27</d><h>08:36</h><r>Ahmed Hassan</r><span>{:tag :a, :attrs {:href &quot;/_/_/users/U8P40TFSR&quot;}, :content (&quot;@U8P40TFSR&quot;)}</span> </z><z id="t1587976932" t="ackerleytng I&apos;ve not used keycloak with clojure before, but i&apos;ve used it with a python webapp"><y>#</y><d>2020-04-27</d><h>08:42</h><r>ackerleytng</r>I&apos;ve not used keycloak with clojure before, but i&apos;ve used it with a python webapp</z><z id="t1587976965" t="ackerleytng i liked not having to worry about sessions, and getting to offload a lot of the security stuff to gatekeeper"><y>#</y><d>2020-04-27</d><h>08:42</h><r>ackerleytng</r>i liked not having to worry about sessions, and getting to offload a lot of the security stuff to gatekeeper</z><z id="t1587977050" t="Ahmed Hassan How did you setup keycloak? is it feasible to do it on same machine on DO droplet on which app installed (with postgresql for app data)?"><y>#</y><d>2020-04-27</d><h>08:44</h><r>Ahmed Hassan</r>How did you setup keycloak? is it feasible to do it on same machine on DO droplet on which app installed (with postgresql for app data)?</z><z id="t1587977061" t="ackerleytng actually the nice part is more gatekeeper than keycloak! not sure if AWS has a similar setup, but the idea behind gatekeeper is that it takes client traffic like a reverse proxy, and only forwards it upstream if it passes validation"><y>#</y><d>2020-04-27</d><h>08:44</h><r>ackerleytng</r>actually the nice part is more gatekeeper than keycloak! not sure if AWS has a similar setup, but the idea behind gatekeeper is that it takes client traffic like a reverse proxy, and only forwards it upstream if it passes validation</z><z id="t1587977105" t="ackerleytng i set it up on another VM"><y>#</y><d>2020-04-27</d><h>08:45</h><r>ackerleytng</r>i set it up on another VM</z><z id="t1587977133" t="ackerleytng if you set it up on the same machine, you&apos;ll have to deal with routing the client requests between keycloak and your app"><y>#</y><d>2020-04-27</d><h>08:45</h><r>ackerleytng</r>if you set it up on the same machine, you&apos;ll have to deal with routing the client requests between keycloak and your app</z><z id="t1587977171" t="ackerleytng the client will need to be redirected to keycloak, that&apos;s the way OAuth works"><y>#</y><d>2020-04-27</d><h>08:46</h><r>ackerleytng</r>the client will need to be redirected to keycloak, that&apos;s the way OAuth works</z><z id="t1587977312" t="Ahmed Hassan so request would go like nginx -&gt; keycloak -&gt; keycloak gatekeeper -&gt; clojure app"><y>#</y><d>2020-04-27</d><h>08:48</h><r>Ahmed Hassan</r>so request would go like nginx -&gt; keycloak -&gt; keycloak gatekeeper -&gt; clojure app</z><z id="t1587977424" t="ackerleytng nope, it&apos;ll be something like nginx -&gt; keycloak | V gatekeeper -&gt; clojure app"><y>#</y><d>2020-04-27</d><h>08:50</h><r>ackerleytng</r>nope, it&apos;ll be something like
<pre>nginx -&gt; keycloak
  |
  V
gatekeeper -&gt; clojure app</pre></z><z id="t1587977505" t="ackerleytng happen to be working on this recently: https://github.com/ackerleytng/keycloak-quickstarts/tree/latest/app-authz-uma-photoz#scripted-quickstart"><y>#</y><d>2020-04-27</d><h>08:51</h><r>ackerleytng</r>happen to be working on this recently: <a href="https://github.com/ackerleytng/keycloak-quickstarts/tree/latest/app-authz-uma-photoz#scripted-quickstart" target="_blank">https://github.com/ackerleytng/keycloak-quickstarts/tree/latest/app-authz-uma-photoz#scripted-quickstart</a></z><z id="t1587977529" t="ackerleytng this isn&apos;t the python app, it&apos;s a quickstart that keycloak provided"><y>#</y><d>2020-04-27</d><h>08:52</h><r>ackerleytng</r>this isn&apos;t the python app, it&apos;s a quickstart that keycloak provided</z><z id="t1587977550" t="ackerleytng i modified it to work in docker and added further instructions to make it a quicker quickstart"><y>#</y><d>2020-04-27</d><h>08:52</h><r>ackerleytng</r>i modified it to work in docker and added further instructions to make it a quicker quickstart</z><z id="t1587977576" t="ackerleytng I used caddy to route between keycloak and the java app (this one doesn&apos;t use gatekeeper)"><y>#</y><d>2020-04-27</d><h>08:52</h><r>ackerleytng</r>I used caddy to route between keycloak and the java app (this one doesn&apos;t use gatekeeper)</z><z id="t1587977594" t="ackerleytng not sure if this is such a good idea for a production service though"><y>#</y><d>2020-04-27</d><h>08:53</h><r>ackerleytng</r>not sure if this is such a good idea for a production service though</z><z id="t1588103255" t="FlavaDave So i have a reagent app in an S3 and am trying to hit it with a Lambda (defn handle-event [event] (let [s3 (aws/client {:api :s3}) file (aws/invoke s3 {:op :GetObject :request {:Bucket &quot;my-bucket&quot; :Key &quot;public/index.html&quot;}})] (pprint event) { &quot;statusCode&quot; 200, &quot;statusDescription&quot; &quot;200 OK&quot; &quot;isBase64Encoded&quot; false &quot;headers&quot; { &quot;Content-Type&quot; &quot;text/html&quot;} &quot;body&quot; (slurp (:Body file))})) (defn key-&gt;keyword [key-string] (-&gt; key-string (st/replace #&quot;([a-z])([A-Z])&quot; &quot;$1-$2&quot;) (st/replace #&quot;([A-Z]+)([A-Z])&quot; &quot;$1-$2&quot;) (st/lower-case) (keyword))) (defn -handleRequest [this is os context] (let [w (io/writer os)] (-&gt; (json/read (io/reader is) :key-fn key-&gt;keyword) (handle-event) (json/write w)) (.flush w))) i originally just had “index.html” in the handle event function but was getting 502 no that i have “public/index.html” it hits but it comes up blank and the console says Uncaught SyntaxError: Unexpected token &apos;&lt;&apos;"><y>#</y><d>2020-04-28</d><h>19:47</h><w>FlavaDave</w>So i have a reagent app in an S3 and am trying to hit it with a Lambda
<pre>(defn handle-event [event]
  (let [s3   (aws/client {:api :s3})
        file (aws/invoke s3 {:op :GetObject :request {:Bucket &quot;my-bucket&quot; :Key &quot;public/index.html&quot;}})]
    (pprint event)
    {
     &quot;statusCode&quot;        200,
     &quot;statusDescription&quot; &quot;200 OK&quot;
     &quot;isBase64Encoded&quot;   false
     &quot;headers&quot;           {
                          &quot;Content-Type&quot; &quot;text/html&quot;}

     &quot;body&quot; (slurp (:Body file))}))




(defn key-&gt;keyword [key-string]
  (-&gt; key-string
      (st/replace #&quot;([a-z])([A-Z])&quot; &quot;$1-$2&quot;)
      (st/replace #&quot;([A-Z]+)([A-Z])&quot; &quot;$1-$2&quot;)
      (st/lower-case)
      (keyword)))

(defn -handleRequest [this is os context]
  (let [w (io/writer os)]
    (-&gt; (json/read (io/reader is) :key-fn key-&gt;keyword)
        (handle-event)
        (json/write w))
    (.flush w)))</pre>
i originally just had “index.html” in the <code>handle event</code> function but was getting 502

no that i have “public/index.html” it hits but it comes up blank and the console says
<code>Uncaught SyntaxError: Unexpected token &apos;&lt;&apos;</code></z><z id="t1588103333" t="FlavaDave I’ve tried changing the content-type to text/javascript and application/javascript but then it just displays the literal html in the browser"><y>#</y><d>2020-04-28</d><h>19:48</h><w>FlavaDave</w>I’ve tried changing the content-type to text/javascript and application/javascript but then it just displays the literal html in the browser</z><z id="t1588178868" t="kenny Is it safe to assume cognitect.aws.client.api/client is non-blocking?"><y>#</y><d>2020-04-29</d><h>16:47</h><w>kenny</w>Is it safe to assume <code>cognitect.aws.client.api/client</code> is non-blocking?</z><z id="t1588178993" t="Alex Miller (Clojure team) ^^ [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}]"><y>#</y><d>2020-04-29</d><h>16:49</h><w>Alex Miller (Clojure team)</w>^^ <a>@ghadi</a> <a>@dchelimsky</a></z><z id="t1588179302" t="dchelimsky It reads from the file system."><y>#</y><d>2020-04-29</d><h>16:55</h><w>dchelimsky</w>It reads from the file system.</z><z id="t1588179885" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] does that answer your question?"><y>#</y><d>2020-04-29</d><h>17:04</h><w>dchelimsky</w><a>@kenny</a> does that answer your question?</z><z id="t1588180022" t="kenny I think so. Probably safest to create client s not in a go block then, right?"><y>#</y><d>2020-04-29</d><h>17:07</h><w>kenny</w>I think so. Probably safest to create <code>client</code>s not in a go block then, right?</z><z id="t1588184971" t="kenny I&apos;ve seen https://github.com/cognitect-labs/aws-api/issues/41 on no current support for timeouts in aws-api. Is there a workaround? This seems like a big hole. Am I supposed to let requests hang around forever if AWS would let them?"><y>#</y><d>2020-04-29</d><h>18:29</h><w>kenny</w>I&apos;ve seen <a href="https://github.com/cognitect-labs/aws-api/issues/41" target="_blank">https://github.com/cognitect-labs/aws-api/issues/41</a> on no current support for timeouts in aws-api. Is there a workaround? This seems like a big hole. Am I supposed to let requests hang around forever if AWS would let them?</z><z id="t1588185222" t="ghadi we&apos;re planning on supporting this explicitly, but for now you can use the async API and put an external timeout on your call"><y>#</y><d>2020-04-29</d><h>18:33</h><w>ghadi</w>we&apos;re planning on supporting this explicitly, but for now you can use the async API and put an external timeout on your call</z><z id="t1588185268" t="ghadi (async/alts! [aws-response your-timeout])"><y>#</y><d>2020-04-29</d><h>18:34</h><w>ghadi</w><code>(async/alts! [aws-response your-timeout])</code></z><z id="t1588185282" t="kenny Couldn&apos;t this result in lots of resources left hanging though?"><y>#</y><d>2020-04-29</d><h>18:34</h><w>kenny</w>Couldn&apos;t this result in lots of resources left hanging though?</z><z id="t1588185338" t="ghadi meaning open http connections?"><y>#</y><d>2020-04-29</d><h>18:35</h><w>ghadi</w>meaning open http connections?</z><z id="t1588185342" t="kenny Yes"><y>#</y><d>2020-04-29</d><h>18:35</h><w>kenny</w>Yes</z><z id="t1588185372" t="ghadi right"><y>#</y><d>2020-04-29</d><h>18:36</h><w>ghadi</w>right</z><z id="t1588185381" t="ghadi quantifying it will depend on your use-case"><y>#</y><d>2020-04-29</d><h>18:36</h><w>ghadi</w>quantifying it will depend on your use-case</z><z id="t1588185437" t="ghadi my guess is that we can/will use the http client library&apos;s timeout mechanism"><y>#</y><d>2020-04-29</d><h>18:37</h><w>ghadi</w>my guess is that we can/will use the http client library&apos;s timeout mechanism</z><z id="t1588185455" t="ghadi what APIs are you using, or is this an abstract question?"><y>#</y><d>2020-04-29</d><h>18:37</h><w>ghadi</w>what APIs are you using, or is this an abstract question?</z><z id="t1588185472" t="ghadi SQS ReceiveMessage offers a explicit long-polling timeout"><y>#</y><d>2020-04-29</d><h>18:37</h><w>ghadi</w>SQS ReceiveMessage offers a explicit long-polling timeout</z><z id="t1588185494" t="ghadi for example"><y>#</y><d>2020-04-29</d><h>18:38</h><w>ghadi</w>for example</z><z id="t1588185640" t="kenny Both, I suppose. I slept my computer and went for lunch. When I came back, I ran an API call to AWS lambda with a &lt;!! around the aws-api response. It sat for several minutes with no response. I don&apos;t know exactly what caused this, but it made the issue very obvious and quite frightening. If that could happen, it could (we must assume it will) lock up the calling thread for who knows how long. I can, and should, add the alts! but if something like this were to happen often in production, it could easily eat up lots of resources."><y>#</y><d>2020-04-29</d><h>18:40</h><w>kenny</w>Both, I suppose. I slept my computer and went for lunch. When I came back, I ran an API call to AWS lambda with a <code>&lt;!!</code> around the aws-api response. It sat for several minutes with no response. I don&apos;t know exactly what caused this, but it made the issue very obvious and quite frightening. If that could happen, it could (we must assume it will) lock up the calling thread for who knows how long. I can, and should, add the alts! but if something like this were to happen often in production, it could easily eat up lots of resources.</z><z id="t1588188395" t="hiredman I bet this isn&apos;t an http timeout issue at all, my guess is a deadlock core async threadpool"><y>#</y><d>2020-04-29</d><h>19:26</h><r>hiredman</r>I bet this isn&apos;t an http timeout issue at all, my guess is a deadlock core async threadpool</z><z id="t1588188461" t="kenny Certainly possible. From the REPL history, I had only ran the code 3 times: twice before lunch and the 1 after. That wouldn&apos;t deadlock the threadpool, right?"><y>#</y><d>2020-04-29</d><h>19:27</h><r>kenny</r>Certainly possible. From the REPL history, I had only ran the code 3 times: twice before lunch and the 1 after. That wouldn&apos;t deadlock the threadpool, right?</z><z id="t1588188500" t="kenny This code is also incredibly simple. No obvious blocking calls."><y>#</y><d>2020-04-29</d><h>19:28</h><r>kenny</r>This code is also incredibly simple. No obvious blocking calls.</z><z id="t1588188564" t="hiredman It depends on what other code is running. You can look at thread dumps or manually schedule a job on the core async threadpool to see if it runs"><y>#</y><d>2020-04-29</d><h>19:29</h><r>hiredman</r>It depends on what other code is running. You can look at thread dumps or manually schedule a job on the core async threadpool to see if it runs</z><z id="t1588188763" t="hiredman The async API will also retry operations with some kind of backoff for certain errors"><y>#</y><d>2020-04-29</d><h>19:32</h><r>hiredman</r>The async API will also retry operations with some kind of backoff for certain errors</z><z id="t1588188804" t="kenny That could have brought the total time to return above 5 mins if the Lambda kept timing out."><y>#</y><d>2020-04-29</d><h>19:33</h><r>kenny</r>That could have brought the total time to return above 5 mins if the Lambda kept timing out.</z><z id="t1588188853" t="hiredman It doesn&apos;t tell you if that is happening, but you can configure that stuff when creating a client, so you could pass it a function that logs something"><y>#</y><d>2020-04-29</d><h>19:34</h><r>hiredman</r>It doesn&apos;t tell you if that is happening, but you can configure that stuff when creating a client, so you could pass it a function that logs something</z><z id="t1588185708" t="ghadi InvokeLambda?"><y>#</y><d>2020-04-29</d><h>18:41</h><w>ghadi</w>InvokeLambda?</z><z id="t1588185723" t="kenny :op :Invoke"><y>#</y><d>2020-04-29</d><h>18:42</h><w>kenny</w><code>:op      :Invoke</code></z><z id="t1588185755" t="kenny Like so (aws-api-async/invoke (async/&lt;! @*lambda-client) {:op :Invoke :request {:FunctionName function-name :InvocationType &quot;RequestResponse&quot; :Payload (transit/encode-transit query-request)}})"><y>#</y><d>2020-04-29</d><h>18:42</h><w>kenny</w>Like so
<pre>(aws-api-async/invoke
  (async/&lt;! @*lambda-client)
  {:op      :Invoke
   :request {:FunctionName   function-name
             :InvocationType &quot;RequestResponse&quot;
             :Payload        (transit/encode-transit query-request)}})</pre></z><z id="t1588185799" t="kenny Well, that&apos;s newer. The weird (async/&lt;! @*lambda-client) wasn&apos;t there before."><y>#</y><d>2020-04-29</d><h>18:43</h><w>kenny</w>Well, that&apos;s newer. The weird <code>(async/&lt;! @*lambda-client)</code> wasn&apos;t there before.</z><z id="t1588185807" t="ghadi if you care about the lambda response, you have to wait for it though"><y>#</y><d>2020-04-29</d><h>18:43</h><w>ghadi</w>if you care about the lambda response, you have to wait for it though</z><z id="t1588185820" t="kenny I care about it but not enough to wait minutes 🙂"><y>#</y><d>2020-04-29</d><h>18:43</h><w>kenny</w>I care about it but not enough to wait minutes <b>🙂</b></z><z id="t1588185833" t="ghadi in that case put a timeout on the Lambda itself"><y>#</y><d>2020-04-29</d><h>18:43</h><w>ghadi</w>in that case put a timeout on the Lambda itself</z><z id="t1588185848" t="kenny It should never take that long. After the lambda is hot, it executes in 10s of millis."><y>#</y><d>2020-04-29</d><h>18:44</h><w>kenny</w>It should never take that long. After the lambda is hot, it executes in 10s of millis.</z><z id="t1588185871" t="ghadi default timeout is 3 seconds on a lambda"><y>#</y><d>2020-04-29</d><h>18:44</h><w>ghadi</w>default timeout is 3 seconds on a lambda</z><z id="t1588185877" t="ghadi max is 15 minutes"><y>#</y><d>2020-04-29</d><h>18:44</h><w>ghadi</w>max is 15 minutes</z><z id="t1588185893" t="kenny This is a Datomic Ion. Guessing there&apos;s some default timeout on it."><y>#</y><d>2020-04-29</d><h>18:44</h><w>kenny</w>This is a Datomic Ion. Guessing there&apos;s some default timeout on it.</z><z id="t1588185914" t="kenny I see 1 min in the AWS console. I waited at least 5 mins."><y>#</y><d>2020-04-29</d><h>18:45</h><w>kenny</w>I see 1 min in the AWS console. I waited at least 5 mins.</z><z id="t1588185937" t="ghadi that would be an interesting repro for the datomic team"><y>#</y><d>2020-04-29</d><h>18:45</h><w>ghadi</w>that would be an interesting repro for the datomic team</z><z id="t1588185953" t="ghadi the lambda proxies that Ions spin up have a default 60s timeout"><y>#</y><d>2020-04-29</d><h>18:45</h><w>ghadi</w>the lambda proxies that Ions spin up have a default 60s timeout</z><z id="t1588186033" t="kenny So for whatever reason, it sat for 5 mins before I restarted the REPL."><y>#</y><d>2020-04-29</d><h>18:47</h><w>kenny</w>So for whatever reason, it sat for 5 mins before I restarted the REPL.</z><z id="t1588453219" t="ghadi been working on streaming responses for aws-api"><y>#</y><d>2020-05-02</d><h>21:00</h><w>ghadi</w>been working on streaming responses for aws-api</z><z id="t1588453237" t="ghadi"><y>#</y><d>2020-05-02</d><h>21:00</h><w>ghadi</w></z><z id="t1588453241" t="ghadi utility function of the day"><y>#</y><d>2020-05-02</d><h>21:00</h><w>ghadi</w>utility function of the day</z><z id="t1588778394" t="kenny aws-api doesn&apos;t seem to be mapping a 429 -&gt; busy anomaly. Bug? {:Reason &quot;ReservedFunctionConcurrentInvocationLimitExceeded&quot;, :Type &quot;User&quot;, :message &quot;Rate Exceeded.&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} (meta *1) =&gt; {:http-request {:request-method :post, :scheme :https, :server-port 443, :uri &quot;&quot;, :headers {}, :body &quot;&quot;, :server-name &quot;&quot;}, :http-response {:status 429, :headers {&quot;connection&quot; &quot;keep-alive&quot;, &quot;x-amzn-requestid&quot; &quot;&quot;, &quot;x-amzn-errortype&quot; &quot;TooManyRequestsException&quot;, &quot;content-length&quot; &quot;103&quot;, &quot;date&quot; &quot;Wed, 06 May 2020 15:16:56 GMT&quot;, &quot;content-type&quot; &quot;application/json&quot;}, :body &quot;&quot;}}"><y>#</y><d>2020-05-06</d><h>15:19</h><w>kenny</w>aws-api doesn&apos;t seem to be mapping a 429 -&gt; busy anomaly. Bug?
<pre>{:Reason &quot;ReservedFunctionConcurrentInvocationLimitExceeded&quot;,
 :Type &quot;User&quot;,
 :message &quot;Rate Exceeded.&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}

(meta *1)
=&gt;
{:http-request  {:request-method :post,
                 :scheme         :https,
                 :server-port    443,
                 :uri            &quot;&quot;,
                 :headers        {},
                 :body           &quot;&quot;,
                 :server-name    &quot;&quot;},
 :http-response {:status  429,
                 :headers {&quot;connection&quot;       &quot;keep-alive&quot;,
                           &quot;x-amzn-requestid&quot; &quot;&quot;,
                           &quot;x-amzn-errortype&quot; &quot;TooManyRequestsException&quot;,
                           &quot;content-length&quot;   &quot;103&quot;,
                           &quot;date&quot;             &quot;Wed, 06 May 2020 15:16:56 GMT&quot;,
                           &quot;content-type&quot;     &quot;application/json&quot;},
                 :body    &quot;&quot;}}</pre></z><z id="t1588779977" t="jaihindhreddy Busy would be 503 wouldn&apos;t it? 429 is the service refusing your request rate, not being unable to serve it cuz they&apos;re busy. Of course, what we might choose to do when we counter either might be the same, but they&apos;re two different things, aren&apos;t they?"><y>#</y><d>2020-05-06</d><h>15:46</h><w>jaihindhreddy</w>Busy would be 503 wouldn&apos;t it? 429 is the service refusing your request rate, not being unable to serve it cuz they&apos;re busy.
Of course, what we might choose to do when we counter either might be the same, but they&apos;re two different things, aren&apos;t they?</z><z id="t1588780084" t="kenny Perhaps. Either way, incorrect is not the correct category. This request should be marked as a category that is retriable."><y>#</y><d>2020-05-06</d><h>15:48</h><w>kenny</w>Perhaps. Either way, incorrect is not the correct category. This request should be marked as a category that is retriable.</z><z id="t1588780901" t="kenny From an end user perspective, I think 429 = 503."><y>#</y><d>2020-05-06</d><h>16:01</h><w>kenny</w>From an end user perspective, I think 429 = 503.</z><z id="t1588782097" t="ghadi we only map whatever is in the AWS provided descriptors"><y>#</y><d>2020-05-06</d><h>16:21</h><w>ghadi</w>we only map whatever is in the AWS provided descriptors</z><z id="t1588782113" t="ghadi which we know isn&apos;t comprehensive w.r.t. errors"><y>#</y><d>2020-05-06</d><h>16:21</h><w>ghadi</w>which we know isn&apos;t comprehensive w.r.t. errors</z><z id="t1588782154" t="ghadi we&apos;re working on some functionality that would, among other things, potentially make it easier to fill in gaps where the service descriptors are insufficient"><y>#</y><d>2020-05-06</d><h>16:22</h><w>ghadi</w>we&apos;re working on some functionality that would, among other things, potentially make it easier to fill in gaps where the service descriptors are insufficient</z><z id="t1588782208" t="kenny Oh, didn&apos;t realize this was how it worked. Why not map http request statuses?"><y>#</y><d>2020-05-06</d><h>16:23</h><w>kenny</w>Oh, didn&apos;t realize this was how it worked. Why not map http request statuses?</z><z id="t1588795529" t="dchelimsky We map some statuses that map clearly to anomaly categories: https://github.com/cognitect-labs/aws-api/blob/5e1a88a1f5bba49a2a235336f8f59b81ca89b944/src/cognitect/aws/protocols/common.clj#L10-L14"><y>#</y><d>2020-05-06</d><h>20:05</h><w>dchelimsky</w>We map some statuses that map clearly to anomaly categories: <a href="https://github.com/cognitect-labs/aws-api/blob/5e1a88a1f5bba49a2a235336f8f59b81ca89b944/src/cognitect/aws/protocols/common.clj#L10-L14" target="_blank">https://github.com/cognitect-labs/aws-api/blob/5e1a88a1f5bba49a2a235336f8f59b81ca89b944/src/cognitect/aws/protocols/common.clj#L10-L14</a></z><z id="t1588800381" t="kenny [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] I think 429 = busy. Thoughts?"><y>#</y><d>2020-05-06</d><h>21:26</h><w>kenny</w><a>@dchelimsky</a> I think 429 = busy. Thoughts?</z><z id="t1588801066" t="dchelimsky 429 is about rate limiting, which could be happening based on e.g. a service contract (you&apos;re allowed n requests) even if the server could handle them."><y>#</y><d>2020-05-06</d><h>21:37</h><w>dchelimsky</w>429 is about rate limiting, which could be happening based on e.g. a service contract (you&apos;re allowed n requests) even if the server could handle them.</z><z id="t1588802072" t="kenny I realize that but the end user effect is identical."><y>#</y><d>2020-05-06</d><h>21:54</h><w>kenny</w>I realize that but the end user effect is identical.</z><z id="t1588802176" t="kenny i.e., both use the Retry-After header and represent temporary conditions. I think they should be treated the same."><y>#</y><d>2020-05-06</d><h>21:56</h><w>kenny</w>i.e., both use the Retry-After header and represent temporary conditions. I think they should be treated the same.</z><z id="t1588832820" t="jaihindhreddy In a multi-tenant system for example, you might want to flow rate-limiting upstream to the tenants, whereas 503 is almost always reacted to with a retry with backoff."><y>#</y><d>2020-05-07</d><h>06:27</h><r>jaihindhreddy</r>In a multi-tenant system for example, you might want to flow rate-limiting upstream to the tenants, whereas 503 is almost always reacted to with a retry with backoff.</z><z id="t1588861787" t="kenny I&apos;m now very much in agreement with [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] . I have a hard time qualifying with an &quot;almost always&quot; and would instead say it is very use case dependent. I see both sides of the coin now and agree that there is no default that can possibly satisfy every use case. Leaving the current defaults as is is safest. Allowing this to be configurable is really the only solution 🙂"><y>#</y><d>2020-05-07</d><h>14:29</h><r>kenny</r>I&apos;m now very much in agreement with <a>@dchelimsky</a>. I have a hard time qualifying with an &quot;almost always&quot; and would instead say it is very use case dependent. I see both sides of the coin now and agree that there is no default that can possibly satisfy every use case. Leaving the current defaults as is is safest. Allowing this to be configurable is really the only solution <b>🙂</b></z><z id="t1588802344" t="dchelimsky That&apos;s your preference, but it might not be everybody&apos;s. As Ghadi mentioned, we&apos;re working on something that will allow you to post-process errors."><y>#</y><d>2020-05-06</d><h>21:59</h><w>dchelimsky</w>That&apos;s your preference, but it might not be everybody&apos;s. As Ghadi mentioned, we&apos;re working on something that will allow you to post-process errors.</z><z id="t1588802381" t="kenny Fair enough. Curious what situation you&apos;re thinking in which you&apos;d handle them differently?"><y>#</y><d>2020-05-06</d><h>21:59</h><w>kenny</w>Fair enough. Curious what situation you&apos;re thinking in which you&apos;d handle them differently?</z><z id="t1588802393" t="dchelimsky If you&apos;re actually being rate-limited."><y>#</y><d>2020-05-06</d><h>21:59</h><w>dchelimsky</w>If you&apos;re actually being rate-limited.</z><z id="t1588802420" t="dchelimsky Retry might not be the right answer in that case."><y>#</y><d>2020-05-06</d><h>22:00</h><w>dchelimsky</w>Retry might not be the right answer in that case.</z><z id="t1588802451" t="kenny Couldn&apos;t you make the same case for a server being &quot;busy&quot;?"><y>#</y><d>2020-05-06</d><h>22:00</h><w>kenny</w>Couldn&apos;t you make the same case for a server being &quot;busy&quot;?</z><z id="t1588802532" t="dchelimsky Sure, but &quot;making a case&quot; is part of the point I"><y>#</y><d>2020-05-06</d><h>22:02</h><w>dchelimsky</w>Sure, but &quot;making a case&quot; is part of the point I</z><z id="t1588802535" t="dchelimsky &apos;m making"><y>#</y><d>2020-05-06</d><h>22:02</h><w>dchelimsky</w>&apos;m making</z><z id="t1588802592" t="dchelimsky These things are up for interpretation, and are implemented and handled wildly differently not only across the entire internet, but even across AWS services."><y>#</y><d>2020-05-06</d><h>22:03</h><w>dchelimsky</w>These things are up for interpretation, and are implemented and handled wildly differently not only across the entire internet, but even across AWS services.</z><z id="t1588802616" t="dchelimsky So, we&apos;re going to give you control over this, and probably not change any of the decisions we already made as defaults."><y>#</y><d>2020-05-06</d><h>22:03</h><w>dchelimsky</w>So, we&apos;re going to give you control over this, and probably not change any of the decisions we already made as defaults.</z><z id="t1588802666" t="dchelimsky Consider github&apos;s choice to return a 404 when you&apos;re not authorized to see a repo."><y>#</y><d>2020-05-06</d><h>22:04</h><w>dchelimsky</w>Consider github&apos;s choice to return a 404 when you&apos;re not authorized to see a repo.</z><z id="t1588802687" t="dchelimsky They&apos;ll justify it as security. Fine. But choices like that make status codes useless."><y>#</y><d>2020-05-06</d><h>22:04</h><w>dchelimsky</w>They&apos;ll justify it as security. Fine. But choices like that make status codes useless.</z><z id="t1588987306" t="gerred well, from your perspective as the requester, maybe that one&apos;s actually true? 😉"><y>#</y><d>2020-05-09</d><h>01:21</h><r>gerred</r>well, from your perspective as the requester, maybe that one&apos;s actually true? <b>😉</b></z><z id="t1588987322" t="gerred purely trolling here"><y>#</y><d>2020-05-09</d><h>01:22</h><r>gerred</r>purely trolling here</z><z id="t1589469045" t="kenny We have a use case for Lambda and found https://github.com/stediinc/lambda . Not sure if the devs are in this channel but this lib is excellent! Thank you 🙂"><y>#</y><d>2020-05-14</d><h>15:10</h><w>kenny</w>We have a use case for Lambda and found <a href="https://github.com/stediinc/lambda" target="_blank">https://github.com/stediinc/lambda</a>. Not sure if the devs are in this channel but this lib is excellent! Thank you <b>🙂</b></z><z id="t1589475554" t="localghost i’m trying to use cognitect’s aws-api library. i think deps.cdn worked okay but i can’t require s3 . tried these: (require &apos;[cognitect.aws.s3 :as s3]) (require &apos;[com.cognitect.aws.s3 :as s3]) (require &apos;[cognitect.aws/s3 :as s3]) (require &apos;[com.cognitect.aws/s3 :as s3]) neither worked. i’m a noob so apologies if something is stupid or obviously wrong. any comments/pointers will be helpful."><y>#</y><d>2020-05-14</d><h>16:59</h><w>localghost</w>i’m trying to use cognitect’s aws-api library.  i think <code>deps.cdn</code> worked okay but i can’t require <code>s3</code>.  tried these:

<pre>(require &apos;[cognitect.aws.s3 :as s3])
(require &apos;[com.cognitect.aws.s3 :as s3])
(require &apos;[cognitect.aws/s3 :as s3])
(require &apos;[com.cognitect.aws/s3 :as s3])</pre>
neither worked.  i’m a noob so apologies if something is stupid or obviously wrong.  any comments/pointers will be helpful.</z><z id="t1589475588" t="ghadi https://github.com/cognitect-labs/aws-api#deps"><y>#</y><d>2020-05-14</d><h>16:59</h><w>ghadi</w><a href="https://github.com/cognitect-labs/aws-api#deps" target="_blank">https://github.com/cognitect-labs/aws-api#deps</a></z><z id="t1589475601" t="ghadi there should be a usage example there"><y>#</y><d>2020-05-14</d><h>17:00</h><w>ghadi</w>there should be a usage example there</z><z id="t1589475643" t="ghadi for s3 specifically, but all the services work the same way"><y>#</y><d>2020-05-14</d><h>17:00</h><w>ghadi</w>for s3 specifically, but all the services work the same way</z><z id="t1589475668" t="ghadi (it&apos;s one namespace for the whole client, not one require per service)"><y>#</y><d>2020-05-14</d><h>17:01</h><w>ghadi</w>(it&apos;s one namespace for the whole client, not one require per service)</z><z id="t1589476059" t="localghost omg! my first successful aws api call from clojure! thank you so much, [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] !"><y>#</y><d>2020-05-14</d><h>17:07</h><w>localghost</w>omg! my first successful aws api call from clojure!  thank you so much, <a>@ghadi</a>!</z><z id="t1589591265" t="mruzekw Is there an easier to read version of these? https://github.com/aws/aws-sdk-js/tree/master/apis"><y>#</y><d>2020-05-16</d><h>01:07</h><w>mruzekw</w>Is there an easier to read version of these?

<a href="https://github.com/aws/aws-sdk-js/tree/master/apis" target="_blank">https://github.com/aws/aws-sdk-js/tree/master/apis</a></z><z id="t1589650693" t="kenny What do you mean by &quot;easier to read&quot;?"><y>#</y><d>2020-05-16</d><h>17:38</h><r>kenny</r>What do you mean by &quot;easier to read&quot;?</z><z id="t1589591308" t="mruzekw I&apos;d like to use aws-api, but would rather not parse several JSON files."><y>#</y><d>2020-05-16</d><h>01:08</h><w>mruzekw</w>I&apos;d like to use aws-api, but would rather not parse several JSON files.</z><z id="t1589720703" t="dchelimsky [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] you don&apos;t need to parse them to use aws-api. What makes you think you do?"><y>#</y><d>2020-05-17</d><h>13:05</h><r>dchelimsky</r><a>@U1RCQD0UE</a> you don&apos;t need to parse them to use aws-api. What makes you think you do?</z><z id="t1589744081" t="mruzekw I mean visually, as documentation."><y>#</y><d>2020-05-17</d><h>19:34</h><r>mruzekw</r>I mean visually, as documentation.</z><z id="t1589744100" t="mruzekw Sorry, poor choice of words there."><y>#</y><d>2020-05-17</d><h>19:35</h><r>mruzekw</r>Sorry, poor choice of words there.</z><z id="t1589809943" t="dchelimsky The cognitect.aws.client.api/doc function gives you a collapsed view of each operation."><y>#</y><d>2020-05-18</d><h>13:52</h><r>dchelimsky</r>The <code>cognitect.aws.client.api/doc</code> function gives you a collapsed view of each operation.</z><z id="t1589809963" t="dchelimsky (or de-normalized, if you prefer)"><y>#</y><d>2020-05-18</d><h>13:52</h><r>dchelimsky</r>(or de-normalized, if you prefer)</z><z id="t1589834448" t="mruzekw Oh, thanks, I&apos;ll try that out"><y>#</y><d>2020-05-18</d><h>20:40</h><r>mruzekw</r>Oh, thanks, I&apos;ll try that out</z><z id="t1589752307" t="Gleb Posobin I am using cognitect&apos;s aws api, and creating an api client with (aws/client {:api :s3 ...}) , for some reason it gets stuck when called from a namespace on repl init (i.e. I add (def x (aws/client ...)) call to the namespace which is marked as init-ns in my project.clj , run lein repl and it hangs), but works if I comment it out in the namespace and run (def x (aws/client ...)) inside the repl after the repl has started up. In the repl it works quickly, certainly in under a second, I&apos;ve tried larger repl timeout than the default 30s, it doesn&apos;t help. Any ideas what could be the cause of this?"><y>#</y><d>2020-05-17</d><h>21:51</h><w>Gleb Posobin</w>I am using cognitect&apos;s aws api, and creating an api client with <code>(aws/client {:api :s3 ...})</code>, for some reason it gets stuck when called from a namespace on repl init (i.e. I add <code>(def x (aws/client ...))</code> call to the namespace which is marked as <code>init-ns</code> in my <code>project.clj</code>, run <code>lein repl</code> and it hangs), but works if I comment it out in the namespace and run <code>(def x (aws/client ...))</code> inside the repl after the repl has started up. In the repl it works quickly, certainly in under a second, I&apos;ve tried larger repl timeout than the default 30s, it doesn&apos;t help. Any ideas what could be the cause of this?</z><z id="t1589753552" t="ghadi clients are not designed to be def&apos;fed top-level. wrap it in a delay if you really need it top-level"><y>#</y><d>2020-05-17</d><h>22:12</h><w>ghadi</w>clients are not designed to be def&apos;fed top-level.  wrap it in a <code>delay</code> if you really need it top-level</z><z id="t1589753890" t="Gleb Posobin Ok, thanks! Out of curiosity, what&apos;s the difference between when it is top-level vs when it is not? What breaks? I assumed that writing lines in the repl is the same as basically appending the lines to the namespace repl is in."><y>#</y><d>2020-05-17</d><h>22:18</h><w>Gleb Posobin</w>Ok, thanks! Out of curiosity, what&apos;s the difference between when it is top-level vs when it is not? What breaks? I assumed that writing lines in the repl is the same as basically appending the lines to the namespace repl is in.</z><z id="t1589753892" t="ghadi that being said, it&apos;s unclear what you&apos;re specifically running into"><y>#</y><d>2020-05-17</d><h>22:18</h><w>ghadi</w>that being said, it&apos;s unclear what you&apos;re specifically running into</z><z id="t1589753922" t="ghadi (there are some side-effects of client construction that may be undesired)"><y>#</y><d>2020-05-17</d><h>22:18</h><w>ghadi</w>(there are some side-effects of client construction that may be undesired)</z><z id="t1589753973" t="ghadi in the REPL for exploration I think it&apos;s fine, yes it&apos;s similar to top-level in a namespace"><y>#</y><d>2020-05-17</d><h>22:19</h><w>ghadi</w>in the REPL for exploration I think it&apos;s fine, yes it&apos;s similar to top-level in a namespace</z><z id="t1589754008" t="ghadi you can run jstack on the jvm to tell you what is hung"><y>#</y><d>2020-05-17</d><h>22:20</h><w>ghadi</w>you can run <code>jstack</code> on the jvm to tell you what is hung</z><z id="t1589754070" t="ghadi we have some upcoming changes that may make it easier to def a client top-level [:attrs {:href &quot;/_/_/users/UQ4RJ22EA&quot;}] , but it&apos;s not an explicit goal of those changes"><y>#</y><d>2020-05-17</d><h>22:21</h><w>ghadi</w>we have some upcoming changes that may make it easier to def a client top-level <a>@posobin</a>, but it&apos;s not an explicit goal of those changes</z><z id="t1589754127" t="ghadi i&apos;m curious what it&apos;s hung on..."><y>#</y><d>2020-05-17</d><h>22:22</h><w>ghadi</w>i&apos;m curious what it&apos;s hung on...</z><z id="t1589754380" t="Gleb Posobin"><y>#</y><d>2020-05-17</d><h>22:26</h><w>Gleb Posobin</w></z><z id="t1589834637" t="mruzekw Is there a Terraform or CloudFormation of Clojure for AWS?"><y>#</y><d>2020-05-18</d><h>20:43</h><w>mruzekw</w>Is there a Terraform or CloudFormation of Clojure for AWS?</z><z id="t1589834657" t="mruzekw I&apos;m mainly thinking about the declarative nature of both, just with EDN"><y>#</y><d>2020-05-18</d><h>20:44</h><w>mruzekw</w>I&apos;m mainly thinking about the declarative nature of both, just with EDN</z><z id="t1589840154" t="Aleed [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] As far as I know there isn’t any Clojure alternative to Terraform or Pulumi. I think many people just stick with json/yaml cloudformation templates. What I ended up doing is configuring cloudformation templates in EDN and wrapping Cognitect’s aws-api so that I could make requests to it via the repl (works well enough for me now and better than using aws console but YMMV) the repo is public in case you’d like to use/reference it: https://github.com/alidlo/infra.aws"><y>#</y><d>2020-05-18</d><h>22:15</h><w>Aleed</w><a>@mruzekw</a> As far as I know there isn’t any Clojure alternative to Terraform or Pulumi.
I think many people just stick with json/yaml cloudformation templates.

What I ended up doing is configuring cloudformation templates in EDN and wrapping Cognitect’s aws-api so that I could make requests to it via the repl (works well enough for me now and better than using aws console but YMMV)
the repo is public in case you’d like to use/reference it: <a href="https://github.com/alidlo/infra.aws" target="_blank">https://github.com/alidlo/infra.aws</a></z><z id="t1589886124" t="viesti This looks neat. While looking into Datomic Ions, I dabbled to make a yaml parser that understands the yaml tags for CFN intrinsics: https://github.com/portkey-cloud/cfn-yaml"><y>#</y><d>2020-05-19</d><h>11:02</h><r>viesti</r>This looks neat. While looking into Datomic Ions, I dabbled to make a yaml parser that understands the yaml tags for CFN intrinsics: <a href="https://github.com/portkey-cloud/cfn-yaml" target="_blank">https://github.com/portkey-cloud/cfn-yaml</a></z><z id="t1589886226" t="viesti where this came from was that I could create API GW routes for the ions that are found in the resources/datomic/ion-config.edn"><y>#</y><d>2020-05-19</d><h>11:03</h><r>viesti</r>where this came from was that I could create API GW routes for the ions that are found in the <code>resources/datomic/ion-config.edn</code></z><z id="t1589886270" t="viesti I wanted to use the ion-config.edn as &quot;source of truth&quot;, but had some yaml obstacles on the way, this kind of escalated 🙂"><y>#</y><d>2020-05-19</d><h>11:04</h><r>viesti</r>I wanted to use the ion-config.edn as &quot;source of truth&quot;, but had some yaml obstacles on the way, this kind of escalated <b>🙂</b></z><z id="t1589913639" t="Aleed what were the obstacles? I found that the aws-api made it easy to make* cloudformation requests, so as long as you don’t create some complex dsl, it’s just converting edn to json plus, reader literals make it easy to create some useful utilities that would have been otherwise difficult to do in json/yaml"><y>#</y><d>2020-05-19</d><h>18:40</h><r>Aleed</r>what were the obstacles?

I found that the aws-api made it easy to make* cloudformation requests, so as long as you don’t create some complex dsl, it’s just converting edn to json

plus, reader literals make it easy to create some useful utilities that would have been otherwise difficult to do in json/yaml</z><z id="t1589927883" t="mruzekw Wait, does aws-api create CloudFormation templates? I thought it was all imperative calls, albeit defined in a edn interface"><y>#</y><d>2020-05-19</d><h>22:38</h><r>mruzekw</r>Wait, does aws-api create CloudFormation templates? I thought it was all imperative calls, albeit defined in a edn interface</z><z id="t1589928163" t="mruzekw Looks like there&apos;s also https://github.com/luchiniatwork/terra"><y>#</y><d>2020-05-19</d><h>22:42</h><r>mruzekw</r>Looks like there&apos;s also <a href="https://github.com/luchiniatwork/terra" target="_blank">https://github.com/luchiniatwork/terra</a></z><z id="t1589928654" t="Aleed oh I meant make* cloudformation requests, not create. so you can configure templates in edn and then pass the options to :cloudformation client but as some others have mentioned might be less trouble using more robust code-as-infrastructure solution such as Pulumi"><y>#</y><d>2020-05-19</d><h>22:50</h><r>Aleed</r>oh I meant make* cloudformation requests, not create. so you can configure templates in edn and then pass the options to <code>:cloudformation</code> client
but as some others have mentioned might be less trouble using more robust code-as-infrastructure solution such as Pulumi</z><z id="t1589990308" t="viesti maybe no real obstacle other than that I wanted to generate yaml, not json, in order to compare to CFN yaml templates I was using as an example. This offered a sidetrack for looking into yaml spec 😄"><y>#</y><d>2020-05-20</d><h>15:58</h><r>viesti</r>maybe no real obstacle other than that I wanted to generate yaml, not json, in order to compare to CFN yaml templates I was using as an example. This offered a sidetrack for looking into yaml spec <b>😄</b></z><z id="t1590036430" t="mruzekw Found this for writing Cloudformation templates https://github.com/brabster/crucible"><y>#</y><d>2020-05-21</d><h>04:47</h><r>mruzekw</r>Found this for writing Cloudformation templates

<a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a></z><z id="t1590065188" t="viesti Nice, I have to have seen that before but have forgotten it, or then I just had not ran into it, swiss cheese memory :)"><y>#</y><d>2020-05-21</d><h>12:46</h><r>viesti</r>Nice, I have to have seen that before but have forgotten it, or then I just had not ran into it, swiss cheese memory :)</z><z id="t1589840442" t="ghadi [:attrs {:href &quot;/_/_/users/U1RCQD0UE&quot;}] cdk-clj seems really nice https://github.com/StediInc/cdk-clj"><y>#</y><d>2020-05-18</d><h>22:20</h><w>ghadi</w><a>@mruzekw</a> cdk-clj seems really nice <a href="https://github.com/StediInc/cdk-clj" target="_blank">https://github.com/StediInc/cdk-clj</a></z><z id="t1589840453" t="ghadi there was a nice talk about it at the Conj"><y>#</y><d>2020-05-18</d><h>22:20</h><w>ghadi</w>there was a nice talk about it at the Conj</z><z id="t1589840568" t="Aleed the repo says they’re discontinuing maintenance in favor of using aws’s typescript sdk which is why i didn’t recommend it nor consider it myself as a viable option"><y>#</y><d>2020-05-18</d><h>22:22</h><w>Aleed</w>the repo says they’re discontinuing maintenance in favor of using aws’s typescript sdk which is why i didn’t recommend it nor consider it myself as a viable option</z><z id="t1589840921" t="ghadi Oh, didn’t realize."><y>#</y><d>2020-05-18</d><h>22:28</h><w>ghadi</w>Oh, didn’t realize.</z><z id="t1589864020" t="steveb8n fyi: I used clj-cdk and then switched to typescript. it’s a really nice experience, even without the lispyness. most importantly, gets the job done quickly with lots of compile time help. sacriledge, I know, but it’s a practical solution"><y>#</y><d>2020-05-19</d><h>04:53</h><w>steveb8n</w>fyi: I used clj-cdk and then switched to typescript. it’s a really nice experience, even without the lispyness. most importantly, gets the job done quickly with lots of compile time help. sacriledge, I know, but it’s a practical solution</z><z id="t1589886317" t="viesti I&apos;ve grown to like Terraform, especially the 0.12 language improvements, HCL kind of suites for writing configuration"><y>#</y><d>2020-05-19</d><h>11:05</h><w>viesti</w>I&apos;ve grown to like Terraform, especially the 0.12 language improvements, HCL kind of suites for writing configuration</z><z id="t1589886355" t="viesti and that it has module concept built in, it&apos;s easy to make library modules and link to stateful modules"><y>#</y><d>2020-05-19</d><h>11:05</h><w>viesti</w>and that it has module concept built in, it&apos;s easy to make library modules and link to stateful modules</z><z id="t1589886396" t="viesti though still thinking that if Pulumi gets JVM support, then it would definately need a clj wrapper 🙂"><y>#</y><d>2020-05-19</d><h>11:06</h><w>viesti</w>though still thinking that if Pulumi gets JVM support, then it would definately need a clj wrapper <b>🙂</b></z><z id="t1589886436" t="viesti with specs for all the resources so that one would get autocompletion in editors (+ linting)"><y>#</y><d>2020-05-19</d><h>11:07</h><w>viesti</w>with specs for all the resources so that one would get autocompletion in editors (+ linting)</z><z id="t1589902850" t="kenny [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] We use Pulumi to deploy all of our infrastructure. We write all that code in Typescript. I really think Typescript is a good fit for this sort of thing. Having all of static help with the hundreds of AWS properties you need to configure is a win. You wouldn&apos;t get that with Clojure. In our infra code, there&apos;s no hardcore data transform. It&apos;s mostly all constructing objects that represent &quot;physical&quot; aws resources. Not sure what value Clojure would bring to writing this sort of stuff. Even using the REPL doesn&apos;t give you much -- the code is almost all mutations."><y>#</y><d>2020-05-19</d><h>15:40</h><w>kenny</w><a>@viesti</a> We use Pulumi to deploy all of our infrastructure. We write all that code in Typescript. I really think Typescript is a good fit for this sort of thing. Having all of static help with the hundreds of AWS properties you need to configure is a win. You wouldn&apos;t get that with Clojure. In our infra code, there&apos;s no hardcore data transform. It&apos;s mostly all constructing objects that represent &quot;physical&quot; aws resources. Not sure what value Clojure would bring to writing this sort of stuff. Even using the REPL doesn&apos;t give you much -- the code is almost all mutations.</z><z id="t1589903507" t="viesti I was remembering spec browser in cider, while hacking portkey-cloud/aws-clj-sdk it was nice to autocomplete and navigate namespaced keywords, was thinking that cloud resources (like in terraform) are a bit similar, attributes namespaced into resources under providers :)"><y>#</y><d>2020-05-19</d><h>15:51</h><w>viesti</w>I was remembering spec browser in cider, while hacking portkey-cloud/aws-clj-sdk it was nice to autocomplete and navigate namespaced keywords, was thinking that cloud resources (like in terraform) are a bit similar, attributes namespaced into resources under providers :)</z><z id="t1589904759" t="viesti like aws.instance.instance_type"><y>#</y><d>2020-05-19</d><h>16:12</h><w>viesti</w>like <code>aws.instance.instance_type</code></z><z id="t1589915394" t="Aleed [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] i’m only using aws services so I found Pulumi to be an unneccessary layer over what Cloudformation already provides. and even with static types I found myself needing to reference docs to see descriptions of what properties existed. also, I prefer the declarativeness of edn over typescript, and reader literals make it easy to inject useful utilities. in above repo, for example, the literal `#eid` makes a resource’s name unique per environment and `#with-ssm-params` adds an SSM parameter for every configured resource. I feel like configuring this behavior via functions in typescript would be less clear. that being said, Pulumi did have a nice command line experience and gives more out of the box, so I’m definitely sacrificing that for my own hand-rolled Clojure solution, and project* I’m using it for is still WIP so yet to see what other things I might be missing out on"><y>#</y><d>2020-05-19</d><h>19:09</h><w>Aleed</w><a>@kenny</a> i’m only using aws services so I found Pulumi to be an unneccessary layer over what Cloudformation already provides. and even with static types I found myself needing to reference docs to see descriptions of what properties existed.

also, I prefer the declarativeness of edn over typescript, and reader literals make it easy to inject useful utilities. in above repo, for example, the literal `#eid` makes a resource’s name unique per environment and `#with-ssm-params` adds an SSM parameter for every configured resource. I feel like configuring this behavior via functions in typescript would be less clear.

that being said, Pulumi did have a nice command line experience and gives more out of the box, so I’m definitely sacrificing that for my own hand-rolled Clojure solution, and project* I’m using it for is still WIP so yet to see what other things I might be missing out on</z><z id="t1589916010" t="kenny CloudFormation is okay. Pretty verbose and you&apos;re limited to the features CloudFormation supports. Pulumi has packages built on top of the &quot;raw&quot; AWS resources. These packages are absolutely fantastic for doing things that would take 50+ lines of CF yaml. (see the packages: awsx, docker, kubernetes, datadog, new relic). They have other cool features like magically creating https://www.pulumi.com/docs/guides/crosswalk/aws/lambda/#register-an-event-handler-using-a-magic-lambda-function which is great. Pulumi generates documentation for all the properties so generally you get what you need inline. I do sometimes need to reference various free-form aws docs or the API references though. This isn&apos;t something a dsl or Clojure Pulumi wrapper would solve. The edn versus typescript comparison doesn&apos;t make sense to me. It sounds like you prefer a dsl over a language. That totally works for simple use cases. When you have something that perfectly fits the dsl, you won&apos;t have any issues. When you don&apos;t, however, it becomes very painful or impossible. &apos;Tis the nature of DSLs. On top of all of that, if you need to deploy resources to a separate cloud provider, you don&apos;t need to go learn that cloud provider&apos;s DSL -- you keep using the programming model you&apos;re used to."><y>#</y><d>2020-05-19</d><h>19:20</h><r>kenny</r>CloudFormation is okay. Pretty verbose and you&apos;re limited to the features CloudFormation supports. Pulumi has packages built on top of the &quot;raw&quot; AWS resources. These packages are absolutely fantastic for doing things that would take 50+ lines of CF yaml. (see the packages: awsx, docker, kubernetes, datadog, new relic). They have other cool features like magically creating <a href="https://www.pulumi.com/docs/guides/crosswalk/aws/lambda/#register-an-event-handler-using-a-magic-lambda-function" target="_blank">https://www.pulumi.com/docs/guides/crosswalk/aws/lambda/#register-an-event-handler-using-a-magic-lambda-function</a> which is great.

Pulumi generates documentation for all the properties so generally you get what you need inline. I do sometimes need to reference various free-form aws docs or the API references though. This isn&apos;t something a dsl or Clojure Pulumi wrapper would solve.

The edn versus typescript comparison doesn&apos;t make sense to me. It sounds like you prefer a dsl over a language. That totally works for simple use cases. When you have something that perfectly fits the dsl, you won&apos;t have any issues. When you don&apos;t, however, it becomes very painful or impossible. &apos;Tis the nature of DSLs.

On top of all of that, if you need to deploy resources to a separate cloud provider, you don&apos;t need to go learn that cloud provider&apos;s DSL -- you keep using the programming model you&apos;re used to.</z><z id="t1589917093" t="Aleed thanks for the info on Pulumi, I’ll look into the utilities you mentioned. to your point, it’s not that I prefer a dsl, it’s just that I prefer data. most (if not all?) aws service configurations can be specified as Cloudformation JSON data. that’s a map of information. in a Rich Hickey talk, he mentions how only thing you can do to information is ruin it. what I like about edn is that it lets you to create utilities that transparently reduce the boilerplate of clf templates without creating another abstraction layer. as useful as Pulumi may be, it is another layer and language to account for being boxed into a cloud provider is a valid concern I had, but since I’m using Datomic, which is bound to AWS for now, it’s not one I can avoid anyway"><y>#</y><d>2020-05-19</d><h>19:38</h><r>Aleed</r>thanks for the info on Pulumi, I’ll look into the utilities you mentioned.

to your point, it’s not that I prefer a dsl, it’s just that I prefer data. most (if not all?) aws service configurations can be specified as Cloudformation JSON data. that’s a map of information. in a Rich Hickey talk, he mentions how only thing you can do to information is ruin it. what I like about edn is that it lets you to create utilities that transparently reduce the boilerplate of clf templates without creating another abstraction layer. as useful as Pulumi may be, it is another layer and language to account for

being boxed into a cloud provider is a valid concern I had, but since I’m using Datomic, which is bound to AWS for now, it’s not one I can avoid anyway</z><z id="t1589917883" t="kenny Data all the things mustn&apos;t be taken to an extreme where you start writing functions in edn. Data and functions both have a purpose, else you&apos;ll soon find you&apos;ve written yourself your own programming language. IMO https://github.com/juxt/aero is on the border there 🙂 Since I rarely need to write data transforms in Typescript, I really am only every working with the json data to construct resources. Pulumi has already built the abstractions for me. My line of business is not in deploying software, so I don&apos;t have a strong incentive to compete in the space. My guess is this was the primary motivator behind Stedi&apos;s business decision to drop cdk-clj. It&apos;s very difficult to build something that competes with AWS&apos;s CDK, Pulumi, or even Terraform when it&apos;s not your direct line of business. You&apos;ll find yourself fixing bugs in your own deployment code rather than working on revenue incentives. Our config files are written in edn. We read those in with the Javascript edn reader and use them in Typescript. There are a few cases where I find myself wishing for Clojure&apos;s data transform facilities. Some of the newer Typescript features make this a bit better."><y>#</y><d>2020-05-19</d><h>19:51</h><r>kenny</r>Data all the things mustn&apos;t be taken to an extreme where you start writing functions in edn. Data and functions both have a purpose, else you&apos;ll soon find you&apos;ve written yourself your own programming language. IMO <a href="https://github.com/juxt/aero" target="_blank">https://github.com/juxt/aero</a> is on the border there <b>🙂</b>

Since I rarely need to write data transforms in Typescript, I really am only every working with the json data to construct resources. Pulumi has already built the abstractions for me. My line of business is not in deploying software, so I don&apos;t have a strong incentive to compete in the space. My guess is this was the primary motivator behind Stedi&apos;s business decision to drop cdk-clj. It&apos;s very difficult to build something that competes with AWS&apos;s CDK, Pulumi, or even Terraform when it&apos;s not your direct line of business. You&apos;ll find yourself fixing bugs in your own deployment code rather than working on revenue incentives.

Our config files are written in edn. We read those in with the Javascript edn reader and use them in Typescript. There are a few cases where I find myself wishing for Clojure&apos;s data transform facilities. Some of the newer Typescript features make this a bit better.</z><z id="t1589921208" t="Aleed those are all valid points, and reasons for why I tried out Pulumi in the first place 🙂 . if my configuration gets too complex I’d definitely reconsider my solution . using a js edn reader together with typescript is a nice idea. hadn’t considered that"><y>#</y><d>2020-05-19</d><h>20:46</h><r>Aleed</r>those are all valid points, and reasons for why I tried out Pulumi in the first place <b>🙂</b>. if my configuration gets too complex I’d definitely reconsider my solution .

using a js edn reader together with typescript is a nice idea. hadn’t considered that</z><z id="t1590194879" t="mruzekw Would there be any reason to use Pulumi with CLJS -&gt; JS/TS?"><y>#</y><d>2020-05-23</d><h>00:47</h><r>mruzekw</r>Would there be any reason to use Pulumi with CLJS -&gt; JS/TS?</z><z id="t1590194919" t="mruzekw You&apos;re probably have to write your own specs unless there&apos;s a converter, but I wondered if y&apos;all thought there were an advantages to doing that"><y>#</y><d>2020-05-23</d><h>00:48</h><r>mruzekw</r>You&apos;re probably have to write your own specs unless there&apos;s a converter, but I wondered if y&apos;all thought there were an advantages to doing that</z><z id="t1590355028" t="Joe Lane [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] For completeness I thought I&apos;d mention that Cloudformation also lets you write inline lambda functions. It even let&apos;s you make macro transformations implemented as lambda functions in case you want to make your own sugar."><y>#</y><d>2020-05-24</d><h>21:17</h><r>Joe Lane</r><a>@kenny</a> For completeness I thought I&apos;d mention that Cloudformation also lets you write inline lambda functions. It even let&apos;s you make macro transformations implemented as lambda functions in case you want to make your own sugar.</z><z id="t1590428655" t="kenny [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] Yes but, unless things have changed, you need to write your function&apos;s code in YAML 😵 I&apos;ve used the macro transforms implemented as Lambda. It&apos;s a crazy amount of complexity for such a simple use case... Seems better off to use something purpose built (like an actual programming language 🙂 )."><y>#</y><d>2020-05-25</d><h>17:44</h><r>kenny</r><a>@U0CJ19XAM</a> Yes but, unless things have changed, you need to write your function&apos;s code in YAML <b>😵</b>

I&apos;ve used the macro transforms implemented as Lambda. It&apos;s a crazy amount of complexity for such a simple use case... Seems better off to use something purpose built (like an actual programming language <b>🙂</b>).</z><z id="t1590109226" t="agilecreativity There is also this project make working with CF easier. https://github.com/brabster/crucible"><y>#</y><d>2020-05-22</d><h>01:00</h><w>agilecreativity</w>There is also this project make working with CF easier.
<a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a></z><z id="t1590109636" t="steveb8n I used crucible before cdk. Cdk is a lot less work and has faster feedback"><y>#</y><d>2020-05-22</d><h>01:07</h><w>steveb8n</w>I used crucible before cdk. Cdk is a lot less work and has faster feedback</z><z id="t1590142368" t="valtteri When working with CloudFormation YAML/JSON this is a must https://github.com/aws-cloudformation/cfn-python-lint"><y>#</y><d>2020-05-22</d><h>10:12</h><w>valtteri</w>When working with CloudFormation YAML/JSON this is a must <a href="https://github.com/aws-cloudformation/cfn-python-lint" target="_blank">https://github.com/aws-cloudformation/cfn-python-lint</a></z><z id="t1590142380" t="valtteri It can also be hooked into emacs + flycheck. 🙂"><y>#</y><d>2020-05-22</d><h>10:13</h><w>valtteri</w>It can also be hooked into emacs + flycheck. <b>🙂</b></z><z id="t1590179122" t="kenny I&apos;m curious if anyone has an idea why AWS Trusted Advisor sets their &quot;low EC2 utilization&quot; check to look for: &gt; the daily CPU utilization was 10% or less and network I/O was 5 MB or less on 4 or more days Specifically, why would they have network I/O 5mb or less on 4 or more days? Why not the whole duration they look over (2 weeks)? Why not 2 days? Do instances typically run some sort of small update every 5 days or something?"><y>#</y><d>2020-05-22</d><h>20:25</h><w>kenny</w>I&apos;m curious if anyone has an idea why AWS Trusted Advisor sets their &quot;low EC2 utilization&quot; check to look for:
&gt; the daily CPU utilization was 10% or less and network I/O was 5 MB or less on 4 or more days 
Specifically, why would they have network I/O 5mb or less on 4 or more days? Why not the whole duration they look over (2 weeks)? Why not 2 days? Do instances typically run some sort of small update every 5 days or something?</z><z id="t1590259381" t="lvh Does anyone have any conveniently packaged ways to generate S3 pre-signed GET URLs? I don&apos;t want to use the Java SDK, because I&apos;m already using Cognitect&apos;s SDK to keep JAR size down; I&apos;ve seen https://github.com/cognitect-labs/aws-api/issues/5 which has a workaround gist but only for POSTs (and adapting it to GET/PUT style requests is nontrivial). There&apos;s https://github.com/gkarthiks/s3-presigned-url , but that only takes an access key and a secret, not a session token (which is necessary for role creds)."><y>#</y><d>2020-05-23</d><h>18:43</h><w>lvh</w>Does anyone have any conveniently packaged ways to generate S3 pre-signed GET URLs? I don&apos;t want to use the Java SDK, because I&apos;m already using Cognitect&apos;s SDK to keep JAR size down; I&apos;ve seen <a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a> which has a workaround gist but only for POSTs (and adapting it to GET/PUT style requests is nontrivial). There&apos;s <a href="https://github.com/gkarthiks/s3-presigned-url" target="_blank">https://github.com/gkarthiks/s3-presigned-url</a>, but that only takes an access key and a secret, not a session token (which is necessary for role creds).</z><z id="t1590260471" t="ghadi [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] our next version of aws-api should have some support for presigning"><y>#</y><d>2020-05-23</d><h>19:01</h><w>ghadi</w><a>@lvh</a> our next version of aws-api should have some support for presigning</z><z id="t1590261405" t="lvh Hooray! I guess I’ll put up with the extra Lambda size for a little then :)"><y>#</y><d>2020-05-23</d><h>19:16</h><r>lvh</r>Hooray! I guess I’ll put up with the extra Lambda size for a little then :)</z><z id="t1590260494" t="ghadi there are SHAs in our github that do it presently, but you&apos;re on your own"><y>#</y><d>2020-05-23</d><h>19:01</h><w>ghadi</w>there are SHAs in our github that do it presently, but you&apos;re on your own</z><z id="t1590261382" t="lvh SHAs as in specific commits?"><y>#</y><d>2020-05-23</d><h>19:16</h><r>lvh</r>SHAs as in specific commits?</z><z id="t1590264567" t="ghadi Yes"><y>#</y><d>2020-05-23</d><h>20:09</h><r>ghadi</r>Yes</z><z id="t1590504042" t="dchelimsky We&apos;re working on it in the execution-flow branch, so, for now, consider HEAD of that branch to be a moving pre-alpha target 😉"><y>#</y><d>2020-05-26</d><h>14:40</h><r>dchelimsky</r>We&apos;re working on it in the <code>execution-flow</code> branch, so, for now, consider <code>HEAD</code> of that branch to be a moving pre-alpha target <b>😉</b></z><z id="t1590535189" t="lvh Awesome, thanks! Well give it a shot :)"><y>#</y><d>2020-05-26</d><h>23:19</h><r>lvh</r>Awesome, thanks! Well give it a shot :)</z><z id="t1590432052" t="Empperi Hi. I have a problem with Amazonica and Localstack"><y>#</y><d>2020-05-25</d><h>18:40</h><w>Empperi</w>Hi. I have a problem with Amazonica and Localstack</z><z id="t1590432089" t="Empperi No matter what I do, I cannot get endpoint configuration into place in such a way that AWS SDK or Amazonica would like it"><y>#</y><d>2020-05-25</d><h>18:41</h><w>Empperi</w>No matter what I do, I cannot get endpoint configuration into place in such a way that AWS SDK or Amazonica would like it</z><z id="t1590432120" t="Empperi Any tips on how to do this?"><y>#</y><d>2020-05-25</d><h>18:42</h><w>Empperi</w>Any tips on how to do this?</z><z id="t1590432172" t="Empperi I&apos;ve tried all the usual (s3/list-buckets {:endpoint &quot;&quot;}) stuff already"><y>#</y><d>2020-05-25</d><h>18:42</h><w>Empperi</w>I&apos;ve tried all the usual <code>(s3/list-buckets {:endpoint &quot;&quot;})</code> stuff already</z><z id="t1590432207" t="Empperi All I get is java.lang.IllegalStateException: S3 client with invalid S3 endpoint configured: my-localstack-domain:4566"><y>#</y><d>2020-05-25</d><h>18:43</h><w>Empperi</w>All I get is
<pre>java.lang.IllegalStateException: S3 client with invalid S3 endpoint configured: my-localstack-domain:4566</pre></z><z id="t1590432245" t="Empperi This happens at com.amazonaws.services.s3.AmazonS3Client.getRegion(AmazonS3Client.java:4590)"><y>#</y><d>2020-05-25</d><h>18:44</h><w>Empperi</w>This happens at
<pre>com.amazonaws.services.s3.AmazonS3Client.getRegion(AmazonS3Client.java:4590)</pre></z><z id="t1590432284" t="Empperi Which makes sense since Amazonica is leaving region as nil on purpose https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L162"><y>#</y><d>2020-05-25</d><h>18:44</h><w>Empperi</w>Which makes sense since Amazonica is leaving region as <code>nil</code> on purpose <a href="https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L162" target="_blank">https://github.com/mcohen01/amazonica/blob/master/src/amazonica/core.clj#L162</a></z><z id="t1590432523" t="Empperi I however cannot create that EndpointConfiguration object myself and pass it in since Amazonica is expecting a string"><y>#</y><d>2020-05-25</d><h>18:48</h><w>Empperi</w>I however cannot create that EndpointConfiguration object myself and pass it in since Amazonica is expecting a string</z><z id="t1590434522" t="Empperi Managed to hack past that with this: (with-redefs [amazonica.core/build-client (constantly (-&gt; (AmazonS3ClientBuilder/standard) (.enablePathStyleAccess) (.withEndpointConfiguration (AwsClientBuilder$EndpointConfiguration. (format &quot;&quot; host port) &quot;eu-central-1&quot;)) (.build)))] (s3/list-buckets)) "><y>#</y><d>2020-05-25</d><h>19:22</h><w>Empperi</w>Managed to hack past that with this:
<pre>(with-redefs [amazonica.core/build-client (constantly
                                            (-&gt; (AmazonS3ClientBuilder/standard)
                                                (.enablePathStyleAccess)
                                                (.withEndpointConfiguration (AwsClientBuilder$EndpointConfiguration.
                                                                              (format &quot;&quot; host port)
                                                                              &quot;eu-central-1&quot;))
                                                (.build)))]
  (s3/list-buckets))</pre>
</z><z id="t1590434539" t="Empperi Definitely not pretty but at least now I get requests to localstack"><y>#</y><d>2020-05-25</d><h>19:22</h><w>Empperi</w>Definitely not pretty but at least now I get requests to localstack</z><z id="t1590965434" t="agilecreativity Hi, I am using cognitect/aws library and trying to interact with sesv2 I keep getting the following errors when trying during the remote invoke &quot;cognitect.anomalies/category&quot;: &quot;cognitect.anomalies/fault&quot;, &quot;cognitect.anomalies/message&quot;: &quot;Unable to fetch credentials. See log for more details.&quot;"><y>#</y><d>2020-05-31</d><h>22:50</h><w>agilecreativity</w>Hi,
I am using <code>cognitect/aws</code> library and trying to interact with <code>sesv2</code>
I keep getting the following errors when trying during the remote invoke

<pre>&quot;cognitect.anomalies/category&quot;: &quot;cognitect.anomalies/fault&quot;,
 &quot;cognitect.anomalies/message&quot;: &quot;Unable to fetch credentials. See log for more details.&quot;</pre></z><z id="t1590965648" t="agilecreativity When trying to invoke it locally, I get the proper result What I am using is something like: (def credentils (creds/profile-credentials-provider)) (def ses-client (aws/client {:region :us-east-1 :api :sesv2 :credentials-provider credentils})) ;; ... (aws/invoke ses-client {:op {:SendMail ...} :request {:.. }})"><y>#</y><d>2020-05-31</d><h>22:54</h><w>agilecreativity</w>When trying to invoke it locally, I get the proper result
What I am using is something like:
<pre>(def credentils (creds/profile-credentials-provider))

(def ses-client (aws/client {:region :us-east-1
                             :api :sesv2
                             :credentials-provider credentils}))
;; ...
(aws/invoke ses-client {:op {:SendMail ...}
                        :request {:.. }})</pre></z><z id="t1590965736" t="agilecreativity I double check my signature and I can also see that the (aws/validate-request ses-client) ;;=&gt; true For both running locally, and remotely via the AWS Lambda Anything that I may have missed?"><y>#</y><d>2020-05-31</d><h>22:55</h><w>agilecreativity</w>I double check my signature and I can also see that the
<pre>(aws/validate-request ses-client) ;;=&gt; true</pre>
For both running locally, and remotely via the AWS Lambda
Anything that I may have missed?</z><z id="t1590965786" t="agilecreativity I don’t see useful logs in aws"><y>#</y><d>2020-05-31</d><h>22:56</h><w>agilecreativity</w>I don’t see useful logs in aws</z><z id="t1590965879" t="ghadi [:attrs {:href &quot;/_/_/users/U39K1NXHP&quot;}] do you have profile credentials in ~/.aws/config?"><y>#</y><d>2020-05-31</d><h>22:57</h><w>ghadi</w><a>@agilecreativity</a> do you have profile credentials in ~/.aws/config?</z></g><g id="s12"><z id="t1590965967" t="agilecreativity Locally I do, but since I am running it through the AWS Lambda, I am not sure how to check it."><y>#</y><d>2020-05-31</d><h>22:59</h><w>agilecreativity</w>Locally I do, but since I am running it through the AWS Lambda, I am not sure how to check it.</z><z id="t1590965983" t="agilecreativity I assumed that it will use default profile?"><y>#</y><d>2020-05-31</d><h>22:59</h><w>agilecreativity</w>I assumed that it will use <code>default</code> profile?</z><z id="t1590965987" t="ghadi no"><y>#</y><d>2020-05-31</d><h>22:59</h><w>ghadi</w>no</z><z id="t1590965995" t="ghadi if you&apos;re running in lambda, you don&apos;t need to provide any config"><y>#</y><d>2020-05-31</d><h>22:59</h><w>ghadi</w>if you&apos;re running in lambda, you don&apos;t need to provide any config</z><z id="t1590966002" t="ghadi leave off the :credentials-provider"><y>#</y><d>2020-05-31</d><h>23:00</h><w>ghadi</w>leave off the :credentials-provider</z><z id="t1590966058" t="ghadi you probably don&apos;t need to provide any explicit config locally either"><y>#</y><d>2020-05-31</d><h>23:00</h><w>ghadi</w>you probably don&apos;t need to provide any explicit config locally either</z><z id="t1590966070" t="agilecreativity You mean just do (def ses-client (aws/client {:region :us-east-1 :api :sesv2})"><y>#</y><d>2020-05-31</d><h>23:01</h><w>agilecreativity</w>You mean just do
<pre>(def ses-client (aws/client {:region :us-east-1
                             :api :sesv2})</pre></z><z id="t1590966074" t="ghadi yes"><y>#</y><d>2020-05-31</d><h>23:01</h><w>ghadi</w>yes</z><z id="t1590966082" t="agilecreativity Let me give that a try."><y>#</y><d>2020-05-31</d><h>23:01</h><w>agilecreativity</w>Let me give that a try.</z><z id="t1590966086" t="ghadi you don&apos;t need to give the region either"><y>#</y><d>2020-05-31</d><h>23:01</h><w>ghadi</w>you don&apos;t need to give the region either</z><z id="t1590966090" t="ghadi if the region is the same as the lambda"><y>#</y><d>2020-05-31</d><h>23:01</h><w>ghadi</w>if the region is the same as the lambda</z><z id="t1590966105" t="agilecreativity Let me try that."><y>#</y><d>2020-05-31</d><h>23:01</h><w>agilecreativity</w>Let me try that.</z><z id="t1590966447" t="agilecreativity [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] It works! - I spent an hour try to get this to work. Thanks again."><y>#</y><d>2020-05-31</d><h>23:07</h><w>agilecreativity</w><a>@ghadi</a> It works! - I spent an hour try to get this to work. Thanks again.</z><z id="t1591913452" t="kenny Anyone know if there&apos;s an aws-api for invoking an API Gateway endpoint that is secured with AWS_IAM (it needs all requests to be signed)?"><y>#</y><d>2020-06-11</d><h>22:10</h><w>kenny</w>Anyone know if there&apos;s an aws-api for invoking an API Gateway endpoint that is secured with AWS_IAM (it needs all requests to be signed)?</z><z id="t1591916435" t="kenny Hmm, I&apos;m pretty close to getting it to work... (signers/v4-sign-http-request {:metadata {:signingName &quot;execute-api&quot;}} {:region &quot;us-west-2&quot;} {:aws/access-key-id &quot;...&quot; :aws/secret-access-key &quot;...&quot;} {:method :post :request-method :post :uri invoke-url :headers {&quot;content-type&quot; &quot;application/json&quot; &quot;host&quot; &quot;&quot; &quot;x-amz-date&quot; (aws.util/format-date aws.util/x-amz-date-format (Date.))}} :content-sha256-header? true) The AWS response tells me &quot;The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.&quot;. I&apos;m somewhat certain this has to do with the host header."><y>#</y><d>2020-06-11</d><h>23:00</h><w>kenny</w>Hmm, I&apos;m pretty close to getting it to work...
<pre>(signers/v4-sign-http-request
  {:metadata {:signingName &quot;execute-api&quot;}}
  {:region &quot;us-west-2&quot;}
  {:aws/access-key-id     &quot;...&quot;
   :aws/secret-access-key &quot;...&quot;}
  {:method         :post
   :request-method :post
   :uri            invoke-url
   :headers        {&quot;content-type&quot; &quot;application/json&quot;
                    &quot;host&quot;         &quot;&quot;
                    &quot;x-amz-date&quot;   (aws.util/format-date aws.util/x-amz-date-format (Date.))}}
  :content-sha256-header? true)</pre>
The AWS response tells me &quot;The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.&quot;. I&apos;m somewhat certain this has to do with the host header.</z><z id="t1591916508" t="ghadi disclaimer, that namespace is not public"><y>#</y><d>2020-06-11</d><h>23:01</h><w>ghadi</w>disclaimer, that namespace is not public</z><z id="t1591916522" t="ghadi and we will randomly break it"><y>#</y><d>2020-06-11</d><h>23:02</h><w>ghadi</w>and we will randomly break it</z><z id="t1591916553" t="kenny I know... After getting it to run through, I can pull the relevent pieces out 🙂"><y>#</y><d>2020-06-11</d><h>23:02</h><w>kenny</w>I know... After getting it to run through, I can pull the relevent pieces out <b>🙂</b></z><z id="t1591918370" t="Cory i&apos;m surprised how bad these docs are"><y>#</y><d>2020-06-11</d><h>23:32</h><w>Cory</w>i&apos;m surprised how bad these docs are</z><z id="t1591973049" t="kenny This is certainly a non-goal for aws-api but it seems like the creds provider &amp; client signing functionality could be pulled out into a separate, independent library."><y>#</y><d>2020-06-12</d><h>14:44</h><w>kenny</w>This is certainly a non-goal for aws-api but it seems like the creds provider &amp; client signing functionality could be pulled out into a separate, independent library.</z><z id="t1591977749" t="kenny Finally got a signed request working &amp; have started copying the bits out to get it to work independently of the internal aws-api api. It seems crazy to me that calling aws requires over 200 lines of non-trivial code!"><y>#</y><d>2020-06-12</d><h>16:02</h><w>kenny</w>Finally got a signed request working &amp; have started copying the bits out to get it to work independently of the internal aws-api api. It seems crazy to me that calling aws requires over 200 lines of non-trivial code!</z><z id="t1592110669" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] and [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] - the execution-flow branch now works (for me! pls let me know if it works for you, too!) with presigned URLs built w/ temp creds."><y>#</y><d>2020-06-14</d><h>04:57</h><w>dchelimsky</w><a>@kenny</a> and <a>@lvh</a> - the <code>execution-flow</code> branch now works (for me! pls let me know if it works for you, too!) with presigned URLs built w/ temp creds.</z><z id="t1592234673" t="kenny I haven&apos;t been closely following along with the development of that branch. I was getting notifications about a discussion on a GH issue but didn&apos;t read closely. Is there an example in code or docs that would show me how this works?"><y>#</y><d>2020-06-15</d><h>15:24</h><r>kenny</r>I haven&apos;t been closely following along with the development of that branch. I was getting notifications about a discussion on a GH issue but didn&apos;t read closely. Is there an example in code or docs that would show me how this works?</z><z id="t1592320212" t="lvh hey, sorry, I missed this announcement but I&apos;ll let dave know 🙂"><y>#</y><d>2020-06-16</d><h>15:10</h><r>lvh</r>hey, sorry, I missed this announcement but I&apos;ll let dave know <b>🙂</b></z><z id="t1592323986" t="dchelimsky [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] check https://github.com/cognitect-labs/aws-api/blob/0072c61aa8a620b2589dcb7421080ad3e13306ff/examples/assume_role_example.clj"><y>#</y><d>2020-06-16</d><h>16:13</h><r>dchelimsky</r><a>@kenny</a> check <a href="https://github.com/cognitect-labs/aws-api/blob/0072c61aa8a620b2589dcb7421080ad3e13306ff/examples/assume_role_example.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/0072c61aa8a620b2589dcb7421080ad3e13306ff/examples/assume_role_example.clj</a></z><z id="t1592324091" t="dchelimsky [:attrs {:href &quot;/_/_/users/U07QKGF9P&quot;}] calling it an announcement is a bit aggrandizing 🙂 I was just letting you and Kenny know because you&apos;ve expressed interest. We&apos;re not ready to absorb a ton of feedback yet, but once we are we&apos;ll make an actual announcement."><y>#</y><d>2020-06-16</d><h>16:14</h><r>dchelimsky</r><a>@lvh</a> calling it an announcement is a bit aggrandizing <b>🙂</b> I was just letting you and Kenny know because you&apos;ve expressed interest. We&apos;re not ready to absorb a ton of feedback yet, but once we are we&apos;ll make an actual announcement.</z><z id="t1592324227" t="lvh yeah, sorry, I meant notification, either way, much appreciated!~"><y>#</y><d>2020-06-16</d><h>16:17</h><r>lvh</r>yeah, sorry, I meant notification, either way, much appreciated!~</z><z id="t1592230402" t="souenzzo I&apos;m thinking about create a repository with &quot;common aws tasks with aws-api&quot; Thinks like &quot;create a signed s3 url&quot;, &quot;shutdown a machine&quot;, &quot;get logs from group&quot;... do something like that already exists?"><y>#</y><d>2020-06-15</d><h>14:13</h><w>souenzzo</w>I&apos;m thinking about create a repository with &quot;common aws tasks with aws-api&quot;
Thinks like &quot;create a signed s3 url&quot;, &quot;shutdown a machine&quot;, &quot;get logs from group&quot;...
do something like that already exists?</z><z id="t1592259650" t="souenzzo Done https://github.com/souenzzo/aws-api-examples"><y>#</y><d>2020-06-15</d><h>22:20</h><r>souenzzo</r>Done
<a href="https://github.com/souenzzo/aws-api-examples" target="_blank">https://github.com/souenzzo/aws-api-examples</a></z><z id="t1592383233" t="lloydshark Nice - I think that&apos;s a useful thing to do."><y>#</y><d>2020-06-17</d><h>08:40</h><r>lloydshark</r>Nice - I think that&apos;s a useful thing to do.</z><z id="t1592238587" t="kenny For those interested, here&apos;s a working example of calling AWS API Gateway using aws-api: https://gist.github.com/kennyjwilli/aa9e99321d9443a8ae80448974850e79 . Most of the code was copied out of the cognitect.aws.signers . The original goal was to be able to call an API Gateway authenticated with the AWS_IAM authenticator. This lets you publish an authenticated HTTP Direct Datomic endpoint accessible as long as you have the right AWS creds available on your system."><y>#</y><d>2020-06-15</d><h>16:29</h><w>kenny</w>For those interested, here&apos;s a working example of calling AWS API Gateway using aws-api: <a href="https://gist.github.com/kennyjwilli/aa9e99321d9443a8ae80448974850e79" target="_blank">https://gist.github.com/kennyjwilli/aa9e99321d9443a8ae80448974850e79</a>. Most of the code was copied out of the <code>cognitect.aws.signers</code> . The original goal was to be able to call an API Gateway authenticated with the AWS_IAM authenticator. This lets you publish an authenticated HTTP Direct Datomic endpoint accessible as long as you have the right AWS creds available on your system.</z><z id="t1592238839" t="kenny It&apos;s sounding like all this will be replaced with the workflow stuff in the execution-flow branch 🤞 :skin-tone-2: In the interim, this does work."><y>#</y><d>2020-06-15</d><h>16:33</h><r>kenny</r>It&apos;s sounding like all this will be replaced with the workflow stuff in the execution-flow branch <b>🤞</b><b>:skin-tone-2:</b> In the interim, this does work.</z><z id="t1592313873" t="souenzzo there is some lib/docs about how to reify / mock aws clients?"><y>#</y><d>2020-06-16</d><h>13:24</h><w>souenzzo</w>there is some lib/docs about how to <code>reify</code> / <code>mock</code> aws clients?</z><z id="t1592323581" t="dchelimsky Do you mean in aws-api?"><y>#</y><d>2020-06-16</d><h>16:06</h><r>dchelimsky</r>Do you mean in aws-api?</z><z id="t1592323695" t="dchelimsky Assuming you do, there is no specific support for doing that, so no docs. What are you trying to do?"><y>#</y><d>2020-06-16</d><h>16:08</h><r>dchelimsky</r>Assuming you do, there is no specific support for doing that, so no docs. What are you trying to do?</z><z id="t1592324304" t="dchelimsky ^^ [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2020-06-16</d><h>16:18</h><r>dchelimsky</r>^^ <a>@U2J4FRT2T</a></z><z id="t1592324709" t="souenzzo I started with (aws/invoke (reify .... {:successId 42}) {:op :DoThing}) ;;=&gt; {:successId 42} and I see that it&apos;s possible to mock out everything but i ran out of time I will try again this night. tnks 🙂"><y>#</y><d>2020-06-16</d><h>16:25</h><r>souenzzo</r>I started with <code>(aws/invoke (reify .... {:successId 42}) {:op :DoThing}) ;;=&gt; {:successId 42}</code> and I see that it&apos;s possible to mock out everything but i ran out of time

I will try again this night. tnks <b>🙂</b></z><z id="t1592336975" t="dchelimsky I still don&apos;t understand what you&apos;re trying to do. Why not just use a client as/is? Is this for testing?"><y>#</y><d>2020-06-16</d><h>19:49</h><r>dchelimsky</r>I still don&apos;t understand what you&apos;re trying to do. Why not just use a client as/is? Is this for testing?</z><z id="t1592337504" t="souenzzo Yep, for &quot;offline&quot; testing"><y>#</y><d>2020-06-16</d><h>19:58</h><r>souenzzo</r>Yep, for &quot;offline&quot; testing</z><z id="t1592342574" t="dchelimsky Why not just use with-redefs ?"><y>#</y><d>2020-06-16</d><h>21:22</h><r>dchelimsky</r>Why not just use <code>with-redefs</code>?</z><z id="t1592343327" t="dchelimsky I&apos;m assuming that you&apos;re reifying ClientSPI , but that&apos;s internal and subject to (read: likely to) change. Until there&apos;s a documented seam for what you&apos;re doing you&apos;ll be safer with with-redefs (unless you&apos;re tests are concerned w/ thread safety, in which case 🤷 )."><y>#</y><d>2020-06-16</d><h>21:35</h><r>dchelimsky</r>I&apos;m assuming that you&apos;re reifying <code>ClientSPI</code>, but that&apos;s internal and subject to (read: likely to) change. Until there&apos;s a documented seam for what you&apos;re doing you&apos;ll be safer with <code>with-redefs</code> (unless you&apos;re tests are concerned w/ thread safety, in which case <b>🤷</b> ).</z><z id="t1658847442" t="Ben Sless Bit late but you can mock the http client api more easily, make sure to return an anomaly. Take a look at the tests for reference"><y>#</y><d>2022-07-26</d><h>14:57</h><r>Ben Sless</r>Bit late but you can mock the http client api more easily, make sure to return an anomaly.
Take a look at the tests for reference</z><z id="t1658847595" t="dchelimsky That’s all internal as well. We’re working on a test double client (avoiding the word mock because we’re not going to explicitly support verification)."><y>#</y><d>2022-07-26</d><h>14:59</h><r>dchelimsky</r>That’s all internal as well. We’re working on a test double client (avoiding the word mock because we’re not going to explicitly support verification).</z><z id="t1658848044" t="Ben Sless Unfortunately since there&apos;s no support for testing or documentation of the APIs in use, users must fend for themselves"><y>#</y><d>2022-07-26</d><h>15:07</h><r>Ben Sless</r>Unfortunately since there&apos;s no support for testing or documentation of the APIs in use, users must fend for themselves</z><z id="t1658848156" t="Ben Sless Even something like &quot;here&apos;s how you should test your code when using the library&quot;"><y>#</y><d>2022-07-26</d><h>15:09</h><r>Ben Sless</r>Even something like &quot;here&apos;s how you should test your code when using the library&quot;</z><z id="t1659653763" t="dchelimsky We’re working on something that looks like this right now. (require &apos;[cognitect.aws.client.test :as test] &apos;[cognitect.aws.client.api :as aws]) ;; implementation being tested (defn do-something [s3-client] ;; if :response is bound to a value, invoke will return that value ;; if :response is bound to a funtion, invoke will return the return ;; of that function (let [res (aws/invoke s3-client {:op :CreateBucket :request {:Bucket &quot;a-bucket&quot;}})] ;; do stuff with res )) ;; test using a stub (let [test-s3-client (test/client {:api :s3})] (test/stub test-s3-client {:op :ListBuckets :response {:Location &quot;a-location&quot;}}) (let [res (do-something test-s3-client)] ;; make assertions about res )) ;; test using a handler function (let [test-s3-client (test/client {:api :s3})] (test/stub test-s3-client {:op :ListBuckets ;; op-map is the 2nd argument to `invoke` :response (fn [op-map] ;; do stuff based on op-map ;; then, return a value {:Location &quot;def&quot;})}) (let [res (do-something test-s3-client)] ;; make assertions about res )) In most cases, we’d expect that folks would just stub return values, but for those who want more interaction based tests (mocks, spies, etc), the functions let you implement whatever you want. Also, this is based on a new Client protocol with invoke and stop , that you can reify yourself and do whatever you want with. Thoughts? This is in progress now and subject to change, so any feedback would be most appreciated."><y>#</y><d>2022-08-04</d><h>22:56</h><r>dchelimsky</r>We’re working on something that looks like this right now.
<pre>(require &apos;[cognitect.aws.client.test :as test]
         &apos;[cognitect.aws.client.api :as aws])

;; implementation being tested
(defn do-something [s3-client]
  ;; if :response is bound to a value, invoke will return that value
  ;; if :response is bound to a funtion, invoke will return the return
  ;;    of that function
  (let [res (aws/invoke s3-client {:op :CreateBucket
                                   :request {:Bucket &quot;a-bucket&quot;}})]
    ;; do stuff with res
    ))

;; test using a stub
(let [test-s3-client (test/client {:api :s3})]
  (test/stub test-s3-client
             {:op :ListBuckets
              :response {:Location &quot;a-location&quot;}})
  (let [res (do-something test-s3-client)]
    ;; make assertions about res
    ))

;; test using a handler function
(let [test-s3-client (test/client {:api :s3})]
  (test/stub test-s3-client
             {:op :ListBuckets
              ;; op-map is the 2nd argument to `invoke`
              :response (fn [op-map]
                          ;; do stuff based on op-map
                          ;; then, return a value
                          {:Location &quot;def&quot;})})
  (let [res (do-something test-s3-client)]
    ;; make assertions about res
    ))</pre>
In most cases, we’d expect that folks would just stub return values, but for those who want more interaction based tests (mocks, spies, etc), the functions let you implement whatever you want.

Also, this is based on a new Client protocol with <code>invoke</code> and <code>stop</code>, that you can reify yourself and do whatever you want with.

Thoughts? This is in progress now and subject to change, so any feedback would be most appreciated.</z><z id="t1659653929" t="dchelimsky Actually, I just copied all that to a https://github.com/cognitect-labs/aws-api/issues/186#issuecomment-1205848703 . Please respond there so we more easily find the conversation later."><y>#</y><d>2022-08-04</d><h>22:58</h><r>dchelimsky</r>Actually, I just copied all that to a <a href="https://github.com/cognitect-labs/aws-api/issues/186#issuecomment-1205848703" target="_blank">https://github.com/cognitect-labs/aws-api/issues/186#issuecomment-1205848703</a>. Please respond there so we more easily find the conversation later.</z><z id="t1659654159" t="dchelimsky cc: [:attrs {:href &quot;/_/_/users/UK0810AQ2&quot;}] [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] (sorry for the noise - but just want to make sure you see this - no urgency)"><y>#</y><d>2022-08-04</d><h>23:02</h><r>dchelimsky</r>cc: <a>@UK0810AQ2</a> <a>@U2J4FRT2T</a> (sorry for the noise - but just want to make sure you see this - no urgency)</z><z id="t1659654361" t="souenzzo lgtm. Out of curiosity: why not test-s3-client (test/client {:api :s3 :stub (fn [op-map] ...)}) ? It would allow us to, for example, create things like :stub (in-memory-s3) or :stub (fs-s3 (io/file &quot;...&quot;))"><y>#</y><d>2022-08-04</d><h>23:06</h><r>souenzzo</r>lgtm.

Out of curiosity: why not <code>test-s3-client (test/client {:api :s3 :stub (fn [op-map] ...)})</code> ?
It would allow us to, for example, create things like  <code>:stub (in-memory-s3)</code> or <code>:stub (fs-s3 (io/file &quot;...&quot;))</code></z><z id="t1659656863" t="dchelimsky How would that handle different s3 ops? i.e. if you invoke :ListBuckets and :CreateBucket in the course of the same test."><y>#</y><d>2022-08-04</d><h>23:47</h><r>dchelimsky</r>How would that handle different s3 ops? i.e. if you invoke :ListBuckets and :CreateBucket in the course of the same test.</z><z id="t1659657040" t="dchelimsky Of course, now that there will be a protocol, you can reify it any way you like."><y>#</y><d>2022-08-04</d><h>23:50</h><r>dchelimsky</r>Of course, now that there will be a protocol, you can reify it any way you like.</z><z id="t1659703327" t="dchelimsky I guess we could do it this way: (test/client {:api :s3 :stubs {:ListBuckets {:Buckets [{:Name &quot;bucket-1&quot;}]} :CreateBucket (fn [op-map] ,,,)}}) That forces you to set up everything for a test at once, which is less error prone than making it stateful (i.e. registering stubs/handlers one at a time). And sure, you could implement an entire in-memory s3 as a map of operations to functions of op-map, but now you’re risking false positives by implementing behavior inconsistent with AWS. I’d stick to literal return values as much as possible."><y>#</y><d>2022-08-05</d><h>12:42</h><r>dchelimsky</r>I guess we could do it this way:
<pre>(test/client {:api :s3 :stubs {:ListBuckets {:Buckets [{:Name &quot;bucket-1&quot;}]} 
                               :CreateBucket (fn [op-map] ,,,)}})</pre>
That forces you to set up everything for a test at once, which is less error prone than making it stateful (i.e. registering stubs/handlers one at a time). And sure, you could implement an entire in-memory s3 as a map of operations to functions of op-map, but now you’re risking false positives by implementing behavior inconsistent with AWS. I’d stick to literal return values as much as possible.</z><z id="t1662148921" t="dchelimsky The test client is on the `mcrmc/test-client` branch of https://github.com/cognitect-labs/aws-api . If you’d like to try it out, git clone Now you can include it in a local project with {:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}} Doc is on that branch: https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md"><y>#</y><d>2022-09-02</d><h>20:02</h><r>dchelimsky</r>The test client is on the `mcrmc/test-client` branch of <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a>. If you’d like to try it out,
<pre>git clone </pre>
Now you can include it in a local project with <code>{:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}}</code>

Doc is on that branch: <a href="https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md</a></z><z id="t1662148928" t="dchelimsky Feedback welcome ~right here~ in https://github.com/cognitect-labs/aws-api/issues/186 ."><y>#</y><d>2022-09-02</d><h>20:02</h><r>dchelimsky</r>Feedback welcome ~right here~ in <a href="https://github.com/cognitect-labs/aws-api/issues/186" target="_blank">https://github.com/cognitect-labs/aws-api/issues/186</a>.</z><z id="t1662148951" t="dchelimsky cc [:attrs {:href &quot;/_/_/users/UK0810AQ2&quot;}] [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}]"><y>#</y><d>2022-09-02</d><h>20:02</h><r>dchelimsky</r>cc <a>@UK0810AQ2</a> <a>@U2J4FRT2T</a></z><z id="t1662502533" t="dchelimsky Posting this to the channel in case anybody is interested and hasn’t seen this thread. We’re getting ready to release aws-api with a test double client that you can instrument to respond to invoke and invoke-async (new) however you see fit for your test without any AWS account, internet access, configuration, etc, outside the test. If this sounds interesting to you, please git clone And then add {:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}} to your deps.edn (or you can mvn install and then include the “DEV” version in deps.edn or leiningen project.clj). Docs are here, on the branch: https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md Please provide feedback on https://github.com/cognitect-labs/aws-api/issues/186 . Thanks!!!!"><y>#</y><d>2022-09-06</d><h>22:15</h><r>dchelimsky</r>Posting this to the channel in case anybody is interested and hasn’t seen this thread. We’re getting ready to release aws-api with a test double client that you can instrument to respond to <code>invoke</code> and <code>invoke-async</code>(new) however you see fit for your test without any AWS account, internet access, configuration, etc, outside the test. If this sounds interesting to you, please
<pre>git clone </pre>
And then add <code>{:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}}</code> to your deps.edn (or you can <code>mvn install</code> and then include the “DEV” version in deps.edn or leiningen project.clj).

Docs are here, on the branch: <a href="https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md</a>

Please provide feedback on <a href="https://github.com/cognitect-labs/aws-api/issues/186" target="_blank">https://github.com/cognitect-labs/aws-api/issues/186</a>.

Thanks!!!!</z><z id="t1662979027" t="dchelimsky Released in version 0.8.589. I’ll send out a more complete announcement later today."><y>#</y><d>2022-09-12</d><h>10:37</h><r>dchelimsky</r>Released in version 0.8.589. I’ll send out a more complete announcement later today.</z><z id="t1665576405" t="dchelimsky I&apos;m curious to know if anybody has been using the new test-double feature and how it&apos;s working for you?"><y>#</y><d>2022-10-12</d><h>12:06</h><r>dchelimsky</r>I&apos;m curious to know if anybody has been using the new test-double feature and how it&apos;s working for you?</z><z id="t1665590822" t="souenzzo I&apos;m using it with S3 API to run in-memory tests in my app. It is a webservice + worker, that may turn into a SaaS when I have time"><y>#</y><d>2022-10-12</d><h>16:07</h><r>souenzzo</r>I&apos;m using it with S3 API to run in-memory tests in my app.
It is a webservice + worker, that may turn into a SaaS when I have time</z><z id="t1665756887" t="dchelimsky And it&apos;s working well for you? Any issues?"><y>#</y><d>2022-10-14</d><h>14:14</h><r>dchelimsky</r>And it&apos;s working well for you? Any issues?</z><z id="t1662502533" t="dchelimsky Posting this to the channel in case anybody is interested and hasn’t seen this thread. We’re getting ready to release aws-api with a test double client that you can instrument to respond to invoke and invoke-async (new) however you see fit for your test without any AWS account, internet access, configuration, etc, outside the test. If this sounds interesting to you, please git clone And then add {:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}} to your deps.edn (or you can mvn install and then include the “DEV” version in deps.edn or leiningen project.clj). Docs are here, on the branch: https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md Please provide feedback on https://github.com/cognitect-labs/aws-api/issues/186 . Thanks!!!!"><y>#</y><d>2022-09-06</d><h>22:15</h><w>dchelimsky</w>Posting this to the channel in case anybody is interested and hasn’t seen this thread. We’re getting ready to release aws-api with a test double client that you can instrument to respond to <code>invoke</code> and <code>invoke-async</code>(new) however you see fit for your test without any AWS account, internet access, configuration, etc, outside the test. If this sounds interesting to you, please
<pre>git clone </pre>
And then add <code>{:deps {com.cognitect.aws/api {:local/root &quot;&lt;path to aws-api directory&gt;&quot;}}</code> to your deps.edn (or you can <code>mvn install</code> and then include the “DEV” version in deps.edn or leiningen project.clj).

Docs are here, on the branch: <a href="https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/mcrmc/test-client/doc/testing.md</a>

Please provide feedback on <a href="https://github.com/cognitect-labs/aws-api/issues/186" target="_blank">https://github.com/cognitect-labs/aws-api/issues/186</a>.

Thanks!!!!</z><z id="t1665576405" t="dchelimsky I&apos;m curious to know if anybody has been using the new test-double feature and how it&apos;s working for you?"><y>#</y><d>2022-10-12</d><h>12:06</h><w>dchelimsky</w>I&apos;m curious to know if anybody has been using the new test-double feature and how it&apos;s working for you?</z><z id="t1592402018" t="Gleb Posobin I am getting 1. Unhandled java.lang.IllegalArgumentException No implementation of method: :-get-info of protocol: #&apos;cognitect.aws.client/ClientSPI found for class: java.lang.String on calling cognitect.aws.client.api/invoke . What could be the reason?"><y>#</y><d>2020-06-17</d><h>13:53</h><w>Gleb Posobin</w>I am getting
<pre>1. Unhandled java.lang.IllegalArgumentException
   No implementation of method: :-get-info of protocol:
   #&apos;cognitect.aws.client/ClientSPI found for class: java.lang.String</pre>
on calling <code>cognitect.aws.client.api/invoke</code>. What could be the reason?</z><z id="t1592402570" t="Alex Miller (Clojure team) invoke expects a client as the first arg but that msg looks like you passed a string ?"><y>#</y><d>2020-06-17</d><h>14:02</h><w>Alex Miller (Clojure team)</w>invoke expects a client as the first arg but that msg looks like you passed a string ?</z><z id="t1592403277" t="Gleb Posobin facepalm mixed up the order of arguments in a caller function, thank you."><y>#</y><d>2020-06-17</d><h>14:14</h><w>Gleb Posobin</w><b>facepalm</b> mixed up the order of arguments in a caller function, thank you.</z><z id="t1592421483" t="souenzzo Anyone using sesv2 ? When I send emails on local repl, it hangs for ~1s on invoke but the email arrive in less then 1min When I do the same call inside a aws ec2 instance, invoke take ~0s but the email arrive in more then 30min"><y>#</y><d>2020-06-17</d><h>19:18</h><w>souenzzo</w>Anyone using <code>sesv2</code> ?
When I send emails on local repl, it hangs for ~1s  on <code>invoke</code> but the email arrive in less then 1min
When I do the same call inside a aws ec2 instance, <code>invoke</code> take ~0s but the email arrive in more then 30min</z><z id="t1592696475" t="cfleming So I finally figured out that I should be using X-Ray, and I’m using it to debug some performance problems in my DynamoDB code. One in particular is very mysterious, this is the X-Ray view. This is using promesa/all to run a series of queries, but it looks like each one takes more time than the previous ones as if there were contention of some kind. The query is against a table using equality on the primary key of a secondary index: (defn get-renewals &quot;Given a seq of previous orders, returns a vector of renewal details for all of them as a promise.&quot; [db previous] (let [ids (-&gt;&gt; previous (map :order-id) (set)) promises (map #(dynamo/query db {:table :licence-renewals :where {:renewed-from [:= %]} :index :renewals}) ids)] (-&gt; (p/all promises) (then #(mapcat identity %))))) This table is small (~2250 elements). Any ideas why this might be taking so long?"><y>#</y><d>2020-06-20</d><h>23:41</h><w>cfleming</w>So I finally figured out that I should be using X-Ray, and I’m using it to debug some performance problems in my DynamoDB code. One in particular is very mysterious, this is the X-Ray view. This is using <code>promesa/all</code> to run a series of queries, but it looks like each one takes more time than the previous ones as if there were contention of some kind. The query is against a table using equality on the primary key of a secondary index:
<pre>(defn get-renewals
  &quot;Given a seq of previous orders, returns a vector of renewal details for all
   of them as a promise.&quot;
  [db previous]
  (let [ids (-&gt;&gt; previous
                 (map :order-id)
                 (set))
        promises (map #(dynamo/query db {:table :licence-renewals
                                         :where {:renewed-from [:= %]}
                                         :index :renewals})
                      ids)]
    (-&gt; (p/all promises)
        (then #(mapcat identity %)))))</pre>
This table is small (~2250 elements). Any ideas why this might be taking so long?</z><z id="t1592701429" t="hiredman The order may be an illusion, if they are running in parallel the order of the queries in ids may not match the order of the queries in the analysis tool"><y>#</y><d>2020-06-21</d><h>01:03</h><w>hiredman</w>The order may be an illusion, if they are running in parallel the order of the queries in ids may not match the order of the queries in the analysis tool</z><z id="t1592701599" t="hiredman If you can try them truly sequentially one after the other if the queries all take about the same time, then you know it is something about the running in parallel (contention)"><y>#</y><d>2020-06-21</d><h>01:06</h><w>hiredman</w>If you can try them truly sequentially one after the other if the queries all take about the same time, then you know it is something about the running in parallel (contention)</z><z id="t1592701636" t="ghadi A connection pool in the aws library could make this behavior"><y>#</y><d>2020-06-21</d><h>01:07</h><w>ghadi</w>A connection pool in the aws library could make this behavior</z><z id="t1592701692" t="hiredman Would time waiting on the connection pool show up in x-ray?"><y>#</y><d>2020-06-21</d><h>01:08</h><w>hiredman</w>Would time waiting on the connection pool show up in x-ray?</z><z id="t1592701809" t="ghadi the x-ray segment is measured locally, I&apos;d assume it includes a period wider than the network traffic"><y>#</y><d>2020-06-21</d><h>01:10</h><w>ghadi</w>the x-ray segment is measured locally, I&apos;d assume it includes a period wider than the network traffic</z><z id="t1592701819" t="hiredman Ah"><y>#</y><d>2020-06-21</d><h>01:10</h><w>hiredman</w>Ah</z><z id="t1592701820" t="ghadi (like forming the request, signing it...)"><y>#</y><d>2020-06-21</d><h>01:10</h><w>ghadi</w>(like forming the request, signing it...)</z><z id="t1592701892" t="ghadi besides map + future isn&apos;t always a great pattern. In this case the futures aren&apos;t launched until p/all ostensibly forces them"><y>#</y><d>2020-06-21</d><h>01:11</h><w>ghadi</w>besides map + future isn&apos;t always a great pattern.  In this case the futures aren&apos;t launched until p/all ostensibly forces them</z><z id="t1592710465" t="cfleming [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] Is there a better way to do this, then? I thought this would have been the poster child for that pattern."><y>#</y><d>2020-06-21</d><h>03:34</h><w>cfleming</w><a>@ghadi</a> Is there a better way to do this, then? I thought this would have been the poster child for that pattern.</z><z id="t1592714538" t="cfleming In case it’s useful, I should also have made clear that this is CLJS on Node, not Clojure on JVM."><y>#</y><d>2020-06-21</d><h>04:42</h><w>cfleming</w>In case it’s useful, I should also have made clear that this is CLJS on Node, not Clojure on JVM.</z><z id="t1592722865" t="hiredman http://docs.libuv.org/en/v1.x/threadpool.html might be the threadpool inside node"><y>#</y><d>2020-06-21</d><h>07:01</h><w>hiredman</w><a href="http://docs.libuv.org/en/v1.x/threadpool.html" target="_blank">http://docs.libuv.org/en/v1.x/threadpool.html</a> might be the threadpool inside node</z><z id="t1593037428" t="kenny Curious if anyone has thought about how one would dynamically change the AWS profile from the REPL for aws-api. We have some &quot;default&quot; clients def &apos;ed in many locations. I can dynamically change the aws.profile Java prop but, afaict, there&apos;s no way to bust the creds cache on all those def&apos;ed clients. The use case for changing profiles seems common enough -- I&apos;d like to have my REPL running for a while and switch between my &quot;dev&quot; and &quot;prod&quot; aws profiles."><y>#</y><d>2020-06-24</d><h>22:23</h><w>kenny</w>Curious if anyone has thought about how one would dynamically change the AWS profile from the REPL for aws-api. We have some &quot;default&quot; clients <code>def</code> &apos;ed in many locations. I can dynamically change the aws.profile Java prop but, afaict, there&apos;s no way to bust the creds cache on all those def&apos;ed clients. The use case for changing profiles seems common enough -- I&apos;d like to have my REPL running for a while and switch between my &quot;dev&quot; and &quot;prod&quot; aws profiles.</z><z id="t1593037540" t="ghadi Pass arguments"><y>#</y><d>2020-06-24</d><h>22:25</h><w>ghadi</w>Pass arguments</z><z id="t1593037585" t="ghadi Don’t try to make side effects at a distance, like marionettes "><y>#</y><d>2020-06-24</d><h>22:26</h><w>ghadi</w>Don’t try to make side effects at a distance, like marionettes </z><z id="t1593037592" t="kenny Not sure how that&apos;d solve the problem :thinking_face:"><y>#</y><d>2020-06-24</d><h>22:26</h><w>kenny</w>Not sure how that&apos;d solve the problem <b>:thinking_face:</b></z><z id="t1593037633" t="kenny There could be dozens of top level def&apos;ed clients. Each one would need to be eval&apos;ed after changing the profile."><y>#</y><d>2020-06-24</d><h>22:27</h><w>kenny</w>There could be dozens of top level def&apos;ed clients. Each one would need to be eval&apos;ed after changing the profile.</z><z id="t1593038361" t="hiredman I think the idea is top level defs are bad"><y>#</y><d>2020-06-24</d><h>22:39</h><w>hiredman</w>I think the idea is top level defs are bad</z><z id="t1593038403" t="hiredman you should pass around clients as arguments, so if you want new ones with different credentials you can create new ones and pass those around to your functions"><y>#</y><d>2020-06-24</d><h>22:40</h><w>hiredman</w>you should pass around clients as arguments, so if you want new ones with different credentials you can create new ones and pass those around to your functions</z><z id="t1593039406" t="kenny Totally agree. We have a lot of old code that would require a decent amount of eng resources to change to not be top-level def&apos;ed. It&apos;d be great to do at some point... Was trying to see if there was some sort of short-term solution to this."><y>#</y><d>2020-06-24</d><h>22:56</h><w>kenny</w>Totally agree. We have a lot of old code that would require a decent amount of eng resources to change to not be top-level def&apos;ed. It&apos;d be great to do at some point... Was trying to see if there was some sort of short-term solution to this.</z><z id="t1593040605" t="hiredman there is https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L48 I am not sure what it would take to call it"><y>#</y><d>2020-06-24</d><h>23:16</h><w>hiredman</w>there is <a href="https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L48" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L48</a> I am not sure what it would take to call it</z><z id="t1593040642" t="hiredman I guess you can get the creds provider out of the client using get-info"><y>#</y><d>2020-06-24</d><h>23:17</h><w>hiredman</w>I guess you can get the creds provider out of the client using get-info</z><z id="t1593040650" t="hiredman -get-info"><y>#</y><d>2020-06-24</d><h>23:17</h><w>hiredman</w>-get-info</z><z id="t1594224482" t="kenny When using aws-api, does :PutObject end up bringing :Body fully into memory?"><y>#</y><d>2020-07-08</d><h>16:08</h><w>kenny</w>When using aws-api, does <code>:PutObject</code> end up bringing <code>:Body</code> fully into memory?</z><z id="t1594224494" t="ghadi yes"><y>#</y><d>2020-07-08</d><h>16:08</h><w>ghadi</w>yes</z><z id="t1594224499" t="ghadi currently"><y>#</y><d>2020-07-08</d><h>16:08</h><w>ghadi</w>currently</z><z id="t1594224517" t="kenny Hmm, yeah I thought so. Getting OOMs. Any workarounds?"><y>#</y><d>2020-07-08</d><h>16:08</h><w>kenny</w>Hmm, yeah I thought so. Getting OOMs. Any workarounds?</z><z id="t1594224541" t="ghadi multipart uploads"><y>#</y><d>2020-07-08</d><h>16:09</h><w>ghadi</w>multipart uploads</z><z id="t1594224604" t="ghadi are you uploading from a File source?"><y>#</y><d>2020-07-08</d><h>16:10</h><w>ghadi</w>are you uploading from a File source?</z><z id="t1594224625" t="kenny Is there an existing example for doing that? If not, will figure it out."><y>#</y><d>2020-07-08</d><h>16:10</h><w>kenny</w>Is there an existing example for doing that? If not, will figure it out.</z><z id="t1594224628" t="kenny Yes"><y>#</y><d>2020-07-08</d><h>16:10</h><w>kenny</w>Yes</z><z id="t1594224643" t="ghadi there is not an existing example"><y>#</y><d>2020-07-08</d><h>16:10</h><w>ghadi</w>there is not an existing example</z><z id="t1594224662" t="ghadi there&apos;s an API to start an upload, then to upload pieces, then to complete the upload"><y>#</y><d>2020-07-08</d><h>16:11</h><w>ghadi</w>there&apos;s an API to start an upload, then to upload pieces, then to complete the upload</z><z id="t1594224680" t="ghadi ~pieces~ parts can be uploaded concurrently"><y>#</y><d>2020-07-08</d><h>16:11</h><w>ghadi</w>~pieces~ parts can be uploaded concurrently</z><z id="t1594224731" t="kenny Somewhat amusingly, our system uses the -XX:+HeapDumpOnOutOfMemoryError jvm flag. When the app reboots, it will upload the heap dump to s3. The heap dumps are so large that they oom the app again while uploading 😆"><y>#</y><d>2020-07-08</d><h>16:12</h><w>kenny</w>Somewhat amusingly, our system uses the <code>-XX:+HeapDumpOnOutOfMemoryError</code> jvm flag. When the app reboots, it will upload the heap dump to s3. The heap dumps are so large that they oom the app again while uploading <b>😆</b></z><z id="t1594224797" t="ghadi heh, whoops"><y>#</y><d>2020-07-08</d><h>16:13</h><w>ghadi</w>heh, whoops</z><z id="t1594231114" t="Aron same feature implemented twice? 🙂"><y>#</y><d>2020-07-08</d><h>17:58</h><w>Aron</w>same feature implemented twice? <b>🙂</b></z><z id="t1594249740" t="kenny For those interested in an example for a multipart upload..."><y>#</y><d>2020-07-08</d><h>23:09</h><w>kenny</w>For those interested in an example for a multipart upload...</z><z id="t1594340788" t="thomascothran I&apos;m using aws-api with MediaConvert. After using aws/validate-requests , I get an error: { ... :path [:Settings :OutputGroups :OutputGroupSettings :FileGroupSettings :Destination], :pred (clojure.core/fn [%] (clojure.core/re-matches (clojure.core/re-pattern &quot;^s3:\\/\\/&quot;) %)), :val &quot;&quot; ... } The :Destination value here will only match the string &quot;s3://&quot;. However, this is https://docs.aws.amazon.com/mediaconvert/latest/ug/specify-output-groups.html . I can use MediaConvert (outside aws-api ) with the rejected value and it works. Is this likely a bug or might I be overlooking something?"><y>#</y><d>2020-07-10</d><h>00:26</h><w>thomascothran</w>I&apos;m using aws-api with MediaConvert. After using <code>aws/validate-requests</code>, I get an error:

<pre>{ ...
   :path
   [:Settings
    :OutputGroups
    :OutputGroupSettings
    :FileGroupSettings
    :Destination],
   :pred
   (clojure.core/fn
    [%]
    (clojure.core/re-matches (clojure.core/re-pattern &quot;^s3:\\/\\/&quot;) %)),
   :val &quot;&quot;
   ...
   }</pre>
The <code>:Destination</code> value here will only match the string &quot;s3://&quot;. However, this is <a href="https://docs.aws.amazon.com/mediaconvert/latest/ug/specify-output-groups.html" target="_blank">https://docs.aws.amazon.com/mediaconvert/latest/ug/specify-output-groups.html</a>. I can use MediaConvert (outside <code>aws-api</code>) with the rejected value and it works. Is this likely a bug or might I be overlooking something?</z><z id="t1594340888" t="ghadi what :op ?"><y>#</y><d>2020-07-10</d><h>00:28</h><w>ghadi</w>what <code>:op</code> ?</z><z id="t1594340932" t="thomascothran :CreateJob"><y>#</y><d>2020-07-10</d><h>00:28</h><w>thomascothran</w><code>:CreateJob</code></z><z id="t1594340983" t="ghadi do you mind filing a bug for that at cognitect-labs/aws-api ?"><y>#</y><d>2020-07-10</d><h>00:29</h><w>ghadi</w>do you mind filing a bug for that at cognitect-labs/aws-api ?</z><z id="t1594341025" t="ghadi offhand, it looks like the spec is using re-matches instead of re-find"><y>#</y><d>2020-07-10</d><h>00:30</h><w>ghadi</w>offhand, it looks like the spec is using <code>re-matches</code> instead of <code>re-find</code></z><z id="t1594341076" t="ghadi (most regexes in the APIs descriptors have ^ and $ anchors, but not this one for :CreateJob )"><y>#</y><d>2020-07-10</d><h>00:31</h><w>ghadi</w>(most regexes in the APIs descriptors have ^ and $ anchors, but not this one for <code>:CreateJob</code>)</z><z id="t1594341110" t="ghadi as a workaround you could maybe redefine the spec to be a little looser [:attrs {:href &quot;/_/_/users/U7GK705MM&quot;}]"><y>#</y><d>2020-07-10</d><h>00:31</h><w>ghadi</w>as a workaround you could maybe redefine the spec to be a little looser <a>@thomas559</a></z><z id="t1594341145" t="ghadi"><y>#</y><d>2020-07-10</d><h>00:32</h><w>ghadi</w></z><z id="t1594341158" t="ghadi some other regexes from the MediaConvert API descriptors..."><y>#</y><d>2020-07-10</d><h>00:32</h><w>ghadi</w>some other regexes from the MediaConvert API descriptors...</z><z id="t1594341199" t="ghadi most have the ^ $ anchors"><y>#</y><d>2020-07-10</d><h>00:33</h><w>ghadi</w>most have the ^ $ anchors</z><z id="t1594341213" t="ghadi heh that name &quot;__stringPatternArnAwsUsGovCnKmsAZ26EastWestCentralNorthSouthEastWest1912D12KeyAFAF098AFAF094AFAF094AFAF094AFAF0912&quot;"><y>#</y><d>2020-07-10</d><h>00:33</h><w>ghadi</w>heh that name  <code>&quot;__stringPatternArnAwsUsGovCnKmsAZ26EastWestCentralNorthSouthEastWest1912D12KeyAFAF098AFAF094AFAF094AFAF094AFAF0912&quot;</code></z><z id="t1594341434" t="thomascothran Thanks, [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] . I&apos;ll file the issue. The spec part is a little opaque to me (not spec as a library, just where they are being defined by aws-api ), but I&apos;ll take a look and see if I can figure it out."><y>#</y><d>2020-07-10</d><h>00:37</h><w>thomascothran</w>Thanks, <a>@ghadi</a>. I&apos;ll file the issue. The spec part is a little opaque to me (not spec as a library, just where they are being defined by <code>aws-api</code>), but I&apos;ll take a look and see if I can figure it out.</z><z id="t1594341545" t="ghadi The specs are mechanically generated [:attrs {:href &quot;/_/_/users/U7GK705MM&quot;}] "><y>#</y><d>2020-07-10</d><h>00:39</h><w>ghadi</w>The specs are mechanically generated <a>@thomas559</a> </z><z id="t1594341578" t="ghadi We’ll have to analyze it some more and maybe modify the generator"><y>#</y><d>2020-07-10</d><h>00:39</h><w>ghadi</w>We’ll have to analyze it some more and maybe modify the generator</z><z id="t1594341587" t="ghadi (Which isn’t public)"><y>#</y><d>2020-07-10</d><h>00:39</h><w>ghadi</w>(Which isn’t public)</z><z id="t1594341903" t="thomascothran That&apos;s the part where I get lost a little, since normally I&apos;d look for a spec (e.g., :a/b ) in the source and override it. Here I&apos;m not sure where to look for the name"><y>#</y><d>2020-07-10</d><h>00:45</h><w>thomascothran</w>That&apos;s the part where I get lost a little, since normally I&apos;d look for a spec (e.g., <code>:a/b</code> ) in the source and override it. Here I&apos;m not sure where to look for the name</z><z id="t1594342357" t="ghadi Check (aws/doc client :CreateJob) and see if you can navigate through the specs"><y>#</y><d>2020-07-10</d><h>00:52</h><w>ghadi</w>Check <code>(aws/doc client :CreateJob)</code> and see if you can navigate through the specs</z><z id="t1594343348" t="thomascothran Thanks, I was able to redefine the spec. In general, having the validation function is enormously useful for something like MediaConvert where the request can be a really big map."><y>#</y><d>2020-07-10</d><h>01:09</h><w>thomascothran</w>Thanks, I was able to redefine the spec. In general, having the validation function is enormously useful for something like MediaConvert where the request can be a really big map.</z><z id="t1594910400" t="bamarco Does anyone know why the following does not actually send a response to wscat ? I have tries all kinds of things for :Data which is supposed to be a blob including (a json string, a json smile, a .getBytes of json string, a plain test string, and the object shown below) (aws/invoke (aws/client {:api :apigatewaymanagementapi}) {:op :PostToConnection :request {:Data {&quot;action&quot; &quot;pong&quot;}, :ConnectionId id}})"><y>#</y><d>2020-07-16</d><h>14:40</h><w>bamarco</w>Does anyone know why the following does not actually send a response to <code>wscat</code>? I have tries all kinds of things for :Data which is supposed to be a <code>blob</code> including (a json string, a json smile, a .getBytes of json string, a plain test string, and the object shown below)
<pre>(aws/invoke (aws/client {:api :apigatewaymanagementapi})
      {:op :PostToConnection
       :request {:Data {&quot;action&quot; &quot;pong&quot;}, :ConnectionId id}})</pre></z><z id="t1594910431" t="bamarco I get no errors at all"><y>#</y><d>2020-07-16</d><h>14:40</h><w>bamarco</w>I get no errors at all</z><z id="t1594910443" t="ghadi call (aws/doc client :PostToConnection)"><y>#</y><d>2020-07-16</d><h>14:40</h><w>ghadi</w>call <code>(aws/doc client :PostToConnection)</code></z><z id="t1594910481" t="bamarco PostToConnection :op :PostToConnection :request {:Data blob, :ConnectionId string} :required [:ConnectionId :Data] :response nil Sends the provided data to the specified connection."><y>#</y><d>2020-07-16</d><h>14:41</h><w>bamarco</w><pre>PostToConnection
:op :PostToConnection
:request
{:Data blob, :ConnectionId string}
:required
[:ConnectionId :Data]
:response
nil
Sends the provided data to the specified connection.</pre></z><z id="t1594910532" t="ghadi {&quot;action&quot; &quot;pong&quot;} is not a blob"><y>#</y><d>2020-07-16</d><h>14:42</h><w>ghadi</w>{&quot;action&quot; &quot;pong&quot;} is not a blob</z><z id="t1594910535" t="ghadi (aws/validate-requests client true) then redo your request"><y>#</y><d>2020-07-16</d><h>14:42</h><w>ghadi</w><code>(aws/validate-requests client true)</code>
then redo your request</z><z id="t1594913007" t="bamarco is aws/validate-requests something I call on the client that acts like a validate-requests! or do I get a different client back. I tried the version where I get a client back, but it said the api was not implemented so I am assuming I just need to call it and it will change the state of the client. As far as blobs go, I can&apos;t figure out how to make a blob that wscat will understand, I just tried (aws/invoke gw {:op :PostToConnection :request {:Data (bytes (byte-array (map (comp byte int) (json/generate-string {:action :pong})))), :ConnectionId id}}) and (aws/invoke gw {:op :PostToConnection :request {:Data (bytes (byte-array (map (comp byte int) &quot;test&quot;))), :ConnectionId id}})"><y>#</y><d>2020-07-16</d><h>15:23</h><w>bamarco</w>is <code>aws/validate-requests</code> something I call on the client that acts like a <code>validate-requests!</code> or do I get a different client back. I tried the version where I get a client back, but it said the api was not implemented so I am assuming I just need to call it and it will change the state of the client.

As far as blobs go, I can&apos;t figure out how to make a blob that <code>wscat</code> will understand, I just tried
<pre>(aws/invoke gw
      {:op :PostToConnection
       :request {:Data (bytes (byte-array (map (comp byte int) (json/generate-string {:action :pong})))), :ConnectionId id}})</pre>
and
<pre>(aws/invoke gw
      {:op :PostToConnection
       :request {:Data (bytes (byte-array (map (comp byte int) &quot;test&quot;))), :ConnectionId id}})</pre></z><z id="t1594913167" t="ghadi create the client, def it, call validate-requests on it, then use the client and it should throw a spec error when you give it an invalid blob"><y>#</y><d>2020-07-16</d><h>15:26</h><w>ghadi</w>create the client, def it, call validate-requests on it, then use the client and it should throw a spec error when you give it an invalid blob</z><z id="t1594913236" t="bamarco I will test giving it something bad now to make sure it throws errors. Both those do not give an error on the amazon side"><y>#</y><d>2020-07-16</d><h>15:27</h><w>bamarco</w>I will test giving it something bad now to make sure it throws errors. Both those do not give an error on the amazon side</z><z id="t1594914651" t="bamarco Okay so I get no errors from the following for some reason: (aws/validate-requests gw true) (aws/invoke gw {:op :PostToConnection :request {:VeryBad {&quot;a&quot; &quot;bad&quot;}}})"><y>#</y><d>2020-07-16</d><h>15:50</h><w>bamarco</w>Okay so I get no errors from the following for some reason:
<pre>(aws/validate-requests gw true)
(aws/invoke gw
  {:op :PostToConnection
   :request {:VeryBad {&quot;a&quot; &quot;bad&quot;}}})</pre></z><z id="t1594914712" t="bamarco will it be in the response to invoke maybe rather than thrown?"><y>#</y><d>2020-07-16</d><h>15:51</h><w>bamarco</w>will it be in the response to invoke maybe rather than thrown?</z><z id="t1594914769" t="ghadi it might not complain if :Data is optional"><y>#</y><d>2020-07-16</d><h>15:52</h><w>ghadi</w>it might not complain if :Data is optional</z><z id="t1594914783" t="ghadi give it {:Data 42} and see what happens"><y>#</y><d>2020-07-16</d><h>15:53</h><w>ghadi</w>give it <code>{:Data 42}</code> and see what happens</z><z id="t1594918417" t="bamarco It doesn&apos;t throw, but rather returns problems from the invocation call. After clearing up errors I am left with (aws/invoke gw {:op :PostToConnection :request {:Data (byte-array (map (comp byte int) (json/generate-string {:action :pong}))) :ConnectionId id}}) Which produces: &quot;#:cognitect.anomalies{:category :cognitect.anomalies/not-found, :message \&quot;: No address associated with hostname\&quot;}&quot; This leads me to believe {:api :apigatewaymanagementapi} does not detect which deployment I am running, dev in this case. Not sure where I would input this information or how to check if it does detect those things."><y>#</y><d>2020-07-16</d><h>16:53</h><w>bamarco</w>It doesn&apos;t throw, but rather returns problems from the invocation call. After clearing up errors I am left with
<pre>(aws/invoke gw
                     {:op :PostToConnection
                      :request {:Data (byte-array (map (comp byte int) (json/generate-string {:action :pong})))
                                :ConnectionId id}})</pre>
Which produces:
<pre>&quot;#:cognitect.anomalies{:category :cognitect.anomalies/not-found, :message \&quot;: No address associated with hostname\&quot;}&quot;</pre>
This leads me to believe <code>{:api :apigatewaymanagementapi}</code> does not detect which deployment I am running, <code>dev</code> in this case.  Not sure where I would input this information or how to check if it does detect those things.</z><z id="t1594918920" t="bamarco I was following https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html when I decided to try and use apigatewaymanagementapi directly rather than create my own http posts."><y>#</y><d>2020-07-16</d><h>17:02</h><w>bamarco</w>I was following <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html</a> when I decided to try and use apigatewaymanagementapi directly rather than create my own http posts.</z><z id="t1594919165" t="Joe Lane [:attrs {:href &quot;/_/_/users/U78G9NDTN&quot;}] Did you look at what I posted in the #datomic channel? https://clojurians.slack.com/archives/C03RZMDSH/p1594910648214000"><y>#</y><d>2020-07-16</d><h>17:06</h><w>Joe Lane</w><a>@mail524</a> Did you look at what I posted in the #datomic channel? <a href="https://clojurians.slack.com/archives/C03RZMDSH/p1594910648214000" target="_blank">https://clojurians.slack.com/archives/C03RZMDSH/p1594910648214000</a></z><z id="t1594920594" t="bamarco [:attrs {:href &quot;/_/_/users/U0CJ19XAM&quot;}] no! that is so much more specific to what i am trying to do. Thanks! Also thanks [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}]"><y>#</y><d>2020-07-16</d><h>17:29</h><w>bamarco</w><a>@lanejo01</a> no! that is so much more specific to what i am trying to do. Thanks! Also thanks <a>@ghadi</a></z><z id="t1595349112" t="Hlodowig Hi everybody, off-topic AWS question. Any of you have experienced terrible response times after putting your EC2 through an application LB? We had this thing running fine in a t2 micro. As soon as we put it behind the LB performance dropped. We had another case were we just removed availability zones from the LB that had no instances on them. But this time I just can&apos;t get what&apos;s going on."><y>#</y><d>2020-07-21</d><h>16:31</h><w>Hlodowig</w>Hi everybody, off-topic AWS question. Any of you have experienced terrible response times after putting your EC2 through an application LB? We had this thing running fine in a t2 micro. As soon as we put it behind the LB performance dropped.

We had another case were we just removed availability zones from the LB that had no instances on them. But this time I just can&apos;t get what&apos;s going on.</z><z id="t1595349193" t="ghadi it could be anything"><y>#</y><d>2020-07-21</d><h>16:33</h><w>ghadi</w>it could be anything</z><z id="t1595349211" t="ghadi you could have run out of cpu credits"><y>#</y><d>2020-07-21</d><h>16:33</h><w>ghadi</w>you could have run out of cpu credits</z><z id="t1595349241" t="ghadi you need some data to know definitively"><y>#</y><d>2020-07-21</d><h>16:34</h><w>ghadi</w>you need some data to know definitively</z><z id="t1595349317" t="ghadi profiling the application/JVM profiling the machine monitor the load balancer (in rough priority order of things to investigate)"><y>#</y><d>2020-07-21</d><h>16:35</h><w>ghadi</w>profiling the application/JVM
profiling the machine
monitor the load balancer

(in rough priority order of things to investigate)</z><z id="t1595355348" t="Hlodowig What&apos;s weird is this happens as soon as we put this thing behind the LB. Otherwise things run just fine."><y>#</y><d>2020-07-21</d><h>18:15</h><w>Hlodowig</w>What&apos;s weird is this happens as soon as we put this thing behind the LB. Otherwise things run just fine.</z><z id="t1595363545" t="jumar &quot;performance dropped&quot; means &quot;latency increased&quot;? How much?"><y>#</y><d>2020-07-21</d><h>20:32</h><w>jumar</w>&quot;performance dropped&quot; means &quot;latency increased&quot;? How much?</z><z id="t1595363996" t="Hlodowig Yup, from 1-3 seconds to up to a minute. Seems like the first requests you make &quot;warm up&quot; something, after that the application works fine for a while and then takes a dive again."><y>#</y><d>2020-07-21</d><h>20:39</h><w>Hlodowig</w>Yup, from 1-3 seconds to up to a minute. Seems like the first requests you make &quot;warm up&quot; something, after that the application works fine for a while and then takes a dive again.</z><z id="t1595364258" t="ghadi my $0.02; it is too early to speculate -- find some data about what is going on, then make a hypothesis"><y>#</y><d>2020-07-21</d><h>20:44</h><w>ghadi</w>my $0.02; it is too early to speculate -- find some data about what is going on, then make a hypothesis</z><z id="t1595364266" t="ghadi CPU normal?"><y>#</y><d>2020-07-21</d><h>20:44</h><w>ghadi</w>CPU normal?</z><z id="t1595364281" t="ghadi Loadbalancer target group instances healthy?"><y>#</y><d>2020-07-21</d><h>20:44</h><w>ghadi</w>Loadbalancer target group instances healthy?</z><z id="t1595364298" t="ghadi t2/t3 instances use CPU credits -- are you still running with t2 instances?"><y>#</y><d>2020-07-21</d><h>20:44</h><w>ghadi</w>t2/t3 instances use CPU credits -- are you still running with t2 instances?</z><z id="t1595364355" t="ghadi starting up the application could have used up all the cpu credits -- load balancer might be a total red herring"><y>#</y><d>2020-07-21</d><h>20:45</h><w>ghadi</w>starting up the application could have used up all the cpu credits -- load balancer might be a total red herring</z><z id="t1595364817" t="Hlodowig CPU normal. Instances show as healthy. No CPU credits since these are being paid on demand. Everything looks fine until I plug this thing to the LB. Direct access to the instances works just fine."><y>#</y><d>2020-07-21</d><h>20:53</h><w>Hlodowig</w>CPU normal. Instances show as healthy. No CPU credits since these are being paid on demand. Everything looks fine until I plug this thing to the LB. Direct access to the instances works just fine.</z><z id="t1595410247" t="jumar Can you access the load balancer logs? Maybe the load balancer considers your service as unhealthy for some reason? What do you see in the respective application logs? Do you see requests coming in and served in a timely fashion?"><y>#</y><d>2020-07-22</d><h>09:30</h><w>jumar</w>Can you access the load balancer logs? Maybe the load balancer considers your service as unhealthy for some reason?
What do you see in the respective application logs? Do you see requests coming in and served in a timely fashion?</z><z id="t1595440186" t="include which type of load balancer is? Classic, Application or Network ? Internet-facing or private? how about submeta; is it using the same subnets of your instances? (how many instances) ; "><y>#</y><d>2020-07-22</d><h>17:49</h><w>include</w>which type of load balancer is? Classic, Application or Network ? Internet-facing or private? how about submeta; is it using the same subnets of your instances? (how many instances) ; </z><z id="t1595479626" t="Hlodowig ALB, public, two AZ&apos;s, one instance in each one."><y>#</y><d>2020-07-23</d><h>04:47</h><r>Hlodowig</r>ALB, public, two AZ&apos;s, one instance in each one.</z><z id="t1595491361" t="include you just check if there is any error in the alb long and the check this ( https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-troubleshooting.html ) after that I would go through Target Groups and Listeners:ListenerRules and check if there is any problem there too"><y>#</y><d>2020-07-23</d><h>08:02</h><r>include</r>you just check if there is any error in the alb long and the check this (<a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-troubleshooting.html" target="_blank">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-troubleshooting.html</a> ) after that I would go through Target Groups and Listeners:ListenerRules and check if there is any problem there too</z><z id="t1595479626" t="Hlodowig ALB, public, two AZ&apos;s, one instance in each one."><y>#</y><d>2020-07-23</d><h>04:47</h><w>Hlodowig</w>ALB, public, two AZ&apos;s, one instance in each one.</z><z id="t1595610841" t="ghadi https://clojurians.slack.com/archives/C03S1KBA2/p1595610830343000"><y>#</y><d>2020-07-24</d><h>17:14</h><w>ghadi</w><a href="https://clojurians.slack.com/archives/C03S1KBA2/p1595610830343000" target="_blank">https://clojurians.slack.com/archives/C03S1KBA2/p1595610830343000</a></z><z id="t1595610843" t="ghadi x-post"><y>#</y><d>2020-07-24</d><h>17:14</h><w>ghadi</w>x-post</z><z id="t1595969670" t="kenny Is there any interest for Cognitect&apos;s aws-api adding :profile as a shortcut when creating a client?"><y>#</y><d>2020-07-28</d><h>20:54</h><w>kenny</w>Is there any interest for Cognitect&apos;s aws-api adding <code>:profile</code> as a shortcut when creating a client?</z><z id="t1596195182" t="dchelimsky Definitely not right now, but possibly down the road. And definitely not down the road if you don’t put the request in a github issue 😉"><y>#</y><d>2020-07-31</d><h>11:33</h><r>dchelimsky</r>Definitely not right now, but possibly down the road. And definitely not down the road if you don’t put the request in a github issue <b>😉</b></z><z id="t1596009597" t="orestis Does cognitect/aws-api not support IMDSv2?"><y>#</y><d>2020-07-29</d><h>07:59</h><w>orestis</w>Does cognitect/aws-api not support IMDSv2?</z><z id="t1596195306" t="dchelimsky Not yet. Please submit an issue https://github.com/cognitect-labs/aws-api/issues"><y>#</y><d>2020-07-31</d><h>11:35</h><r>dchelimsky</r>Not yet. Please submit an issue <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a></z><z id="t1596013415" t="orestis It seems not — I upgraded today to the Amazon Linux 2 and I disabled IMDSv1 (not fully knowing the consequences 😄 ) which led to the credentials provider not being able to fetch any credentials. On the plus side, I know know what IMDS is and how my app works by accident due to having the elastic beanstalk instance role assigned to it with just the right permissions 🙂"><y>#</y><d>2020-07-29</d><h>09:03</h><w>orestis</w>It seems not — I upgraded today to the Amazon Linux 2 and I disabled IMDSv1 (not fully knowing the consequences <b>😄</b>) which led to the credentials provider not being able to fetch any credentials. On the plus side, I know know what IMDS is and how my app works by accident due to having the elastic beanstalk instance role assigned to it with just the right permissions <b>🙂</b></z><z id="t1596013429" t="orestis I reenabled IMDSv1 and everything goes smoothly again."><y>#</y><d>2020-07-29</d><h>09:03</h><w>orestis</w>I reenabled IMDSv1 and everything goes smoothly again.</z><z id="t1597702572" t="dchelimsky [ANN] Cognitect Labs’ aws-api 0.8.474 is now available. https://groups.google.com/forum/#!topic/clojure/pB9lEKj9wcw"><y>#</y><d>2020-08-17</d><h>22:16</h><w>dchelimsky</w>[ANN] Cognitect Labs’ aws-api 0.8.474 is now available. <a href="https://groups.google.com/forum/#!topic/clojure/pB9lEKj9wcw" target="_blank">https://groups.google.com/forum/#!topic/clojure/pB9lEKj9wcw</a></z><z id="t1599130288" t="defa Is there some sort of encryption build into com.cognitect.aws/s3 like in Amazon’s AWS-SDK for Java? I need to encrypt data at rest. I can use a javax.crypto.CipherInputStream to encrypt data before passing it to the aws-client, though. But something well tested is preferable!"><y>#</y><d>2020-09-03</d><h>10:51</h><w>defa</w>Is there some sort of encryption build into <code>com.cognitect.aws/s3</code> like in Amazon’s AWS-SDK for Java? I need to encrypt data at rest. I can use a <code>javax.crypto.CipherInputStream</code> to encrypt data before passing it to the aws-client, though. But something well tested is preferable!</z><z id="t1599140057" t="ghadi [:attrs {:href &quot;/_/_/users/U5FKQSSS1&quot;}] I use &quot;SSE KMS&quot; to encrypt at REST -- https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingEncryption.html"><y>#</y><d>2020-09-03</d><h>13:34</h><w>ghadi</w><a>@defa</a> I use &quot;SSE KMS&quot; to encrypt at REST -- <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingEncryption.html" target="_blank">https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingEncryption.html</a></z><z id="t1599140074" t="ghadi there&apos;s a few different ways to do this"><y>#</y><d>2020-09-03</d><h>13:34</h><w>ghadi</w>there&apos;s a few different ways to do this</z><z id="t1599140386" t="defa [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] and you use Cognitect’s AWS client? Because I can’t find any related documentation to do that."><y>#</y><d>2020-09-03</d><h>13:39</h><w>defa</w><a>@ghadi</a> and you use Cognitect’s AWS client? Because I can’t find any related documentation to do that.</z><z id="t1599140412" t="ghadi I am a maintainer for that client"><y>#</y><d>2020-09-03</d><h>13:40</h><w>ghadi</w>I am a maintainer for that client</z><z id="t1599140455" t="ghadi You need to figure out what you want to do though -- you can do encryption at rest with S3 without needing to encrypt on the client side (e.g. CipherInputStream, etc.)"><y>#</y><d>2020-09-03</d><h>13:40</h><w>ghadi</w>You need to figure out what you want to do though -- you can do encryption at rest with S3 without needing to encrypt on the client side (e.g. CipherInputStream, etc.)</z><z id="t1599140503" t="ghadi SSE Customer KMS SSE AWS KMS Client-Side Encryption"><y>#</y><d>2020-09-03</d><h>13:41</h><w>ghadi</w>SSE Customer KMS
SSE AWS KMS
Client-Side Encryption</z><z id="t1599140510" t="ghadi ^ the three main choices"><y>#</y><d>2020-09-03</d><h>13:41</h><w>ghadi</w>^ the three main choices</z><z id="t1599143421" t="defa client-side encryption would be my choice"><y>#</y><d>2020-09-03</d><h>14:30</h><w>defa</w>client-side encryption would be my choice</z><z id="t1599143524" t="ghadi if you do client side encryption, use something like Google Tink or libsodium to encrypt"><y>#</y><d>2020-09-03</d><h>14:32</h><w>ghadi</w>if you do client side encryption, use something like Google Tink or libsodium to encrypt</z><z id="t1599143539" t="ghadi lots of ways to shoot yourself in the foot with java crypto"><y>#</y><d>2020-09-03</d><h>14:32</h><w>ghadi</w>lots of ways to shoot yourself in the foot with java crypto</z><z id="t1599147781" t="defa I’m using caesium right now which is a wrapper around libsodium."><y>#</y><d>2020-09-03</d><h>15:43</h><w>defa</w>I’m using caesium right now which is a wrapper around libsodium.</z><z id="t1599147818" t="defa https://github.com/lvh/caesium"><y>#</y><d>2020-09-03</d><h>15:43</h><w>defa</w><a href="https://github.com/lvh/caesium" target="_blank">https://github.com/lvh/caesium</a></z><z id="t1599147880" t="defa Is there an example für SSE with customer KMS?"><y>#</y><d>2020-09-03</d><h>15:44</h><w>defa</w>Is there an example für SSE with customer KMS?</z><z id="t1599148385" t="ghadi caesium is great"><y>#</y><d>2020-09-03</d><h>15:53</h><w>ghadi</w>caesium is great</z><z id="t1599148407" t="ghadi (I still prefer using KMS)"><y>#</y><d>2020-09-03</d><h>15:53</h><w>ghadi</w>(I still prefer using KMS)</z><z id="t1599579595" t="FlavaDave Having trouble writing to a dynamo db with aws api. I have also tried passing JSON as the request map but get the same error. Anyone know what im doing wrong? "><y>#</y><d>2020-09-08</d><h>15:39</h><w>FlavaDave</w>Having trouble writing to a dynamo db with aws api. I have also tried passing JSON as the request map but get the same error. Anyone know what im doing wrong?
</z><z id="t1599579595" t="FlavaDave (def dynamo-client (aws/client {:api :dynamodb})) (-&gt; dynamo-client (aws/invoke {:op :DescribeTable :request {:TableName &quot;PracticeTable&quot;}})) =&gt;{:Table {:TableStatus &quot;ACTIVE&quot;, :ItemCount 0, :TableId &quot;xxxxxxxxxxxxxxxxxxxx&quot;, :GlobalSecondaryIndexes [{:IndexSizeBytes 0, :IndexArn &quot;arn:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;, :ItemCount 0, :KeySchema [{:AttributeName &quot;GameTitle&quot;, :KeyType &quot;HASH&quot;} {:AttributeName &quot;TopScore&quot;, :KeyType &quot;RANGE&quot;}], :ProvisionedThroughput {:NumberOfDecreasesToday 0, :ReadCapacityUnits 10, :WriteCapacityUnits 10}, :IndexStatus &quot;ACTIVE&quot;, :Projection {:ProjectionType &quot;INCLUDE&quot;, :NonKeyAttributes [&quot;UserId&quot;]}, :IndexName &quot;GameTitleIndex&quot;}], :KeySchema [{:AttributeName &quot;UserId&quot;, :KeyType &quot;HASH&quot;} {:AttributeName &quot;GameTitle&quot;, :KeyType &quot;RANGE&quot;}], :ProvisionedThroughput {:NumberOfDecreasesToday 0, :ReadCapacityUnits 20, :WriteCapacityUnits 20}, :CreationDateTime #inst &quot;2020-09-05T18:52:50.000-00:00&quot;, :TableName &quot;PracticeTable&quot;, :AttributeDefinitions [{:AttributeName &quot;GameTitle&quot;, :AttributeType &quot;S&quot;} {:AttributeName &quot;TopScore&quot;, :AttributeType &quot;N&quot;} {:AttributeName &quot;UserId&quot;, :AttributeType &quot;S&quot;}], :TableArn &quot;arn:aws:dynamodb:xxxxxxxxxxxxxxxxxxxxx&quot;, :TableSizeBytes 0}} (aws/invoke dynamo-client {:op :PutItem :request {:TableName &quot;PracticeTable&quot; :Item {:GameTitle &quot;mortal Kombat&quot; :TopScore 100 :UserId &quot;Bill&quot;}}}) =&gt;{:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error { :cause &quot;No implementation of method: :kv-reduce of protocol: #&apos;clojure.core.protocols/IKVReduce found for class: java.lang.String&quot; :via [{:type java.lang.IllegalArgumentException :message &quot;No implementation of method: :kv-reduce of protocol: #&apos;clojure.core.protocols/IKVReduce found for class: java.lang.String&quot; :at [clojure.core$_cache_protocol_fn invokeStatic &quot;core_deftype.clj&quot; 583]}] :trace [[clojure.core$_cache_protocol_fn invokeStatic &quot;core_deftype.clj&quot; 583] [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175] [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856] [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847] [cognitect.aws.shape$fn__8987 invokeStatic &quot;shape.clj&quot; 184] [cognitect.aws.shape$fn__8987 invoke &quot;shape.clj&quot; 181] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234] [cognitect.aws.shape$handle_map$fn__8947 invoke &quot;shape.clj&quot; 117] [clojure.core$fn__8429$fn__8431 invoke &quot;core.clj&quot; 6840] [clojure.core.protocols$iter_reduce invokeStatic &quot;protocols.clj&quot; 49] [clojure.core.protocols$fn__8140 invokeStatic &quot;protocols.clj&quot; 75] [clojure.core.protocols$fn__8140 invoke &quot;protocols.clj&quot; 75] [clojure.core.protocols$fn__8088$G__8083__8101 invoke &quot;protocols.clj&quot; 13] [clojure.core$reduce invokeStatic &quot;core.clj&quot; 6828] [clojure.core$fn__8429 invokeStatic &quot;core.clj&quot; 6830] [clojure.core$fn__8429 invoke &quot;core.clj&quot; 6830] [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175] [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856] [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847] [cognitect.aws.shape$handle_map invokeStatic &quot;shape.clj&quot; 117] [cognitect.aws.shape$handle_map invoke &quot;shape.clj&quot; 113] [cognitect.aws.shape$fn__8993 invokeStatic &quot;shape.clj&quot; 196] [cognitect.aws.shape$fn__8993 invoke &quot;shape.clj&quot; 194] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234] [cognitect.aws.shape$fn__8987$fn__8988 invoke &quot;shape.clj&quot; 189] [clojure.core$fn__8429$fn__8431 invoke &quot;core.clj&quot; 6840] [clojure.core.protocols$iter_reduce invokeStatic &quot;protocols.clj&quot; 49] [clojure.core.protocols$fn__8140 invokeStatic &quot;protocols.clj&quot; 75] [clojure.core.protocols$fn__8140 invoke &quot;protocols.clj&quot; 75] [clojure.core.protocols$fn__8088$G__8083__8101 invoke &quot;protocols.clj&quot; 13] [clojure.core$reduce invokeStatic &quot;core.clj&quot; 6828] [clojure.core$fn__8429 invokeStatic &quot;core.clj&quot; 6830] [clojure.core$fn__8429 invoke &quot;core.clj&quot; 6830] [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175] [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856] [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847] [cognitect.aws.shape$fn__8987 invokeStatic &quot;shape.clj&quot; 184] [cognitect.aws.shape$fn__8987 invoke &quot;shape.clj&quot; 181] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234] [cognitect.aws.shape$json_serialize invokeStatic &quot;shape.clj&quot; 212] [cognitect.aws.shape$json_serialize invoke &quot;shape.clj&quot; 209] [cognitect.aws.protocols.json$fn__451 invokeStatic &quot;json.clj&quot; 22] [cognitect.aws.protocols.json$fn__451 invoke &quot;json.clj&quot; 19] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239] [cognitect.aws.protocols.json$fn__454 invokeStatic &quot;json.clj&quot; 34] [cognitect.aws.protocols.json$fn__454 invoke &quot;json.clj&quot; 24] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234] [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627$fn__9629$fn__9643 invoke &quot;client.clj&quot; 99] [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627$fn__9629 invoke &quot;client.clj&quot; 96] [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627 invoke &quot;client.clj&quot; 84] [clojure.core.async.impl.ioc_macros$run_state_machine invokeStatic &quot;ioc_macros.clj&quot; 978] [clojure.core.async.impl.ioc_macros$run_state_machine invoke &quot;ioc_macros.clj&quot; 977] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invokeStatic &quot;ioc_macros.clj&quot; 982] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invoke &quot;ioc_macros.clj&quot; 980] [cognitect.aws.client$send_request$fn__9600 invoke &quot;client.clj&quot; 84] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1149] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 624] [clojure.core.async.impl.concurrent$counted_thread_factory$reify__528$fn__529 invoke &quot;concurrent.clj&quot; 29] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.lang.Thread run &quot;Thread.java&quot; 748]]}}"><y>#</y><d>2020-09-08</d><h>15:39</h><w>FlavaDave</w><pre>(def dynamo-client (aws/client {:api :dynamodb}))

(-&gt; dynamo-client
    (aws/invoke {:op      :DescribeTable
                 :request {:TableName &quot;PracticeTable&quot;}}))

=&gt;{:Table
 {:TableStatus &quot;ACTIVE&quot;,
  :ItemCount 0,
  :TableId &quot;xxxxxxxxxxxxxxxxxxxx&quot;,
  :GlobalSecondaryIndexes
  [{:IndexSizeBytes 0,
    :IndexArn
    &quot;arn:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;,
    :ItemCount 0,
    :KeySchema
    [{:AttributeName &quot;GameTitle&quot;, :KeyType &quot;HASH&quot;}
     {:AttributeName &quot;TopScore&quot;, :KeyType &quot;RANGE&quot;}],
    :ProvisionedThroughput
    {:NumberOfDecreasesToday 0, :ReadCapacityUnits 10, :WriteCapacityUnits 10},
    :IndexStatus &quot;ACTIVE&quot;,
    :Projection {:ProjectionType &quot;INCLUDE&quot;, :NonKeyAttributes [&quot;UserId&quot;]},
    :IndexName &quot;GameTitleIndex&quot;}],
  :KeySchema
  [{:AttributeName &quot;UserId&quot;, :KeyType &quot;HASH&quot;}
   {:AttributeName &quot;GameTitle&quot;, :KeyType &quot;RANGE&quot;}],
  :ProvisionedThroughput
  {:NumberOfDecreasesToday 0, :ReadCapacityUnits 20, :WriteCapacityUnits 20},
  :CreationDateTime #inst &quot;2020-09-05T18:52:50.000-00:00&quot;,
  :TableName &quot;PracticeTable&quot;,
  :AttributeDefinitions
  [{:AttributeName &quot;GameTitle&quot;, :AttributeType &quot;S&quot;}
   {:AttributeName &quot;TopScore&quot;, :AttributeType &quot;N&quot;}
   {:AttributeName &quot;UserId&quot;, :AttributeType &quot;S&quot;}],
  :TableArn &quot;arn:aws:dynamodb:xxxxxxxxxxxxxxxxxxxxx&quot;,
  :TableSizeBytes 0}}

(aws/invoke dynamo-client {:op      :PutItem
                           :request {:TableName &quot;PracticeTable&quot;
                                     :Item      {:GameTitle &quot;mortal Kombat&quot;
                                                 :TopScore  100
                                                 :UserId    &quot;Bill&quot;}}})

=&gt;{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable #error {
 :cause &quot;No implementation of method: :kv-reduce of protocol: #&apos;clojure.core.protocols/IKVReduce found for class: java.lang.String&quot;
 :via
 [{:type java.lang.IllegalArgumentException
   :message &quot;No implementation of method: :kv-reduce of protocol: #&apos;clojure.core.protocols/IKVReduce found for class: java.lang.String&quot;
   :at [clojure.core$_cache_protocol_fn invokeStatic &quot;core_deftype.clj&quot; 583]}]
 :trace
 [[clojure.core$_cache_protocol_fn invokeStatic &quot;core_deftype.clj&quot; 583]
  [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175]
  [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856]
  [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847]
  [cognitect.aws.shape$fn__8987 invokeStatic &quot;shape.clj&quot; 184]
  [cognitect.aws.shape$fn__8987 invoke &quot;shape.clj&quot; 181]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234]
  [cognitect.aws.shape$handle_map$fn__8947 invoke &quot;shape.clj&quot; 117]
  [clojure.core$fn__8429$fn__8431 invoke &quot;core.clj&quot; 6840]
  [clojure.core.protocols$iter_reduce invokeStatic &quot;protocols.clj&quot; 49]
  [clojure.core.protocols$fn__8140 invokeStatic &quot;protocols.clj&quot; 75]
  [clojure.core.protocols$fn__8140 invoke &quot;protocols.clj&quot; 75]
  [clojure.core.protocols$fn__8088$G__8083__8101 invoke &quot;protocols.clj&quot; 13]
  [clojure.core$reduce invokeStatic &quot;core.clj&quot; 6828]
  [clojure.core$fn__8429 invokeStatic &quot;core.clj&quot; 6830]
  [clojure.core$fn__8429 invoke &quot;core.clj&quot; 6830]
  [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175]
  [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856]
  [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847]
  [cognitect.aws.shape$handle_map invokeStatic &quot;shape.clj&quot; 117]
  [cognitect.aws.shape$handle_map invoke &quot;shape.clj&quot; 113]
  [cognitect.aws.shape$fn__8993 invokeStatic &quot;shape.clj&quot; 196]
  [cognitect.aws.shape$fn__8993 invoke &quot;shape.clj&quot; 194]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234]
  [cognitect.aws.shape$fn__8987$fn__8988 invoke &quot;shape.clj&quot; 189]
  [clojure.core$fn__8429$fn__8431 invoke &quot;core.clj&quot; 6840]
  [clojure.core.protocols$iter_reduce invokeStatic &quot;protocols.clj&quot; 49]
  [clojure.core.protocols$fn__8140 invokeStatic &quot;protocols.clj&quot; 75]
  [clojure.core.protocols$fn__8140 invoke &quot;protocols.clj&quot; 75]
  [clojure.core.protocols$fn__8088$G__8083__8101 invoke &quot;protocols.clj&quot; 13]
  [clojure.core$reduce invokeStatic &quot;core.clj&quot; 6828]
  [clojure.core$fn__8429 invokeStatic &quot;core.clj&quot; 6830]
  [clojure.core$fn__8429 invoke &quot;core.clj&quot; 6830]
  [clojure.core.protocols$fn__8167$G__8162__8176 invoke &quot;protocols.clj&quot; 175]
  [clojure.core$reduce_kv invokeStatic &quot;core.clj&quot; 6856]
  [clojure.core$reduce_kv invoke &quot;core.clj&quot; 6847]
  [cognitect.aws.shape$fn__8987 invokeStatic &quot;shape.clj&quot; 184]
  [cognitect.aws.shape$fn__8987 invoke &quot;shape.clj&quot; 181]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234]
  [cognitect.aws.shape$json_serialize invokeStatic &quot;shape.clj&quot; 212]
  [cognitect.aws.shape$json_serialize invoke &quot;shape.clj&quot; 209]
  [cognitect.aws.protocols.json$fn__451 invokeStatic &quot;json.clj&quot; 22]
  [cognitect.aws.protocols.json$fn__451 invoke &quot;json.clj&quot; 19]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239]
  [cognitect.aws.protocols.json$fn__454 invokeStatic &quot;json.clj&quot; 34]
  [cognitect.aws.protocols.json$fn__454 invoke &quot;json.clj&quot; 24]
  [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 234]
  [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627$fn__9629$fn__9643 invoke &quot;client.clj&quot; 99]
  [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627$fn__9629 invoke &quot;client.clj&quot; 96]
  [cognitect.aws.client$send_request$fn__9600$state_machine__5044__auto____9627 invoke &quot;client.clj&quot; 84]
  [clojure.core.async.impl.ioc_macros$run_state_machine invokeStatic &quot;ioc_macros.clj&quot; 978]
  [clojure.core.async.impl.ioc_macros$run_state_machine invoke &quot;ioc_macros.clj&quot; 977]
  [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invokeStatic &quot;ioc_macros.clj&quot; 982]
  [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invoke &quot;ioc_macros.clj&quot; 980]
  [cognitect.aws.client$send_request$fn__9600 invoke &quot;client.clj&quot; 84]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1149]
  [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 624]
  [clojure.core.async.impl.concurrent$counted_thread_factory$reify__528$fn__529 invoke &quot;concurrent.clj&quot; 29]
  [clojure.lang.AFn run &quot;AFn.java&quot; 22]
  [java.lang.Thread run &quot;Thread.java&quot; 748]]}}</pre></z><z id="t1599580003" t="Joe Lane [:attrs {:href &quot;/_/_/users/UF41YH1CM&quot;}] You need something like (aws/invoke dynamodb-client {:op :PutItem :request {:TableName &quot;PracticeTable&quot; :Item {&quot;GameTitle&quot; {:S &quot;mortal Kombat&quot;} &quot;TopScore&quot; {:N 100} &quot;UserId&quot; {:S &quot;Bill&quot;}}}})"><y>#</y><d>2020-09-08</d><h>15:46</h><w>Joe Lane</w><a>@dgonsalves22</a> You need something like
<pre>(aws/invoke
           dynamodb-client
           {:op      :PutItem
            :request {:TableName &quot;PracticeTable&quot;
                      :Item      {&quot;GameTitle&quot; {:S &quot;mortal Kombat&quot;}
                                  &quot;TopScore&quot;  {:N 100}
                                  &quot;UserId&quot;    {:S &quot;Bill&quot;}}}})</pre></z><z id="t1599580314" t="FlavaDave That was the trick thank you very much"><y>#</y><d>2020-09-08</d><h>15:51</h><w>FlavaDave</w>That was the trick thank you very much</z><z id="t1599580370" t="souenzzo Can I do (.getCredentials (DefaultAWSCredentialsProviderChain.)) using aws-api ?"><y>#</y><d>2020-09-08</d><h>15:52</h><w>souenzzo</w>Can I do <code>(.getCredentials (DefaultAWSCredentialsProviderChain.))</code> using <code>aws-api</code>  ?</z><z id="t1599581160" t="kenny Yes. (cognitect.aws.credentials/fetch (cognitect.aws.client.shared/credentials-provider))"><y>#</y><d>2020-09-08</d><h>16:06</h><r>kenny</r>Yes.
<pre>(cognitect.aws.credentials/fetch (cognitect.aws.client.shared/credentials-provider))</pre></z><z id="t1599581209" t="kenny Can also use (cognitect.aws.credentials/default-credentials-provider) to create a new chain."><y>#</y><d>2020-09-08</d><h>16:06</h><r>kenny</r>Can also use <code>(cognitect.aws.credentials/default-credentials-provider)</code> to create a new chain.</z><z id="t1599581426" t="souenzzo Did it 🙂 (aws.cred/fetch (aws.cred/default-credentials-provider aws.cred/fetch-async)) It&apos;s a public/stable api? cc [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}]"><y>#</y><d>2020-09-08</d><h>16:10</h><r>souenzzo</r>Did it <b>🙂</b>
<pre>(aws.cred/fetch (aws.cred/default-credentials-provider aws.cred/fetch-async))</pre>
It&apos;s a public/stable api? cc <a>@U0ENYLGTA</a></z><z id="t1599581657" t="kenny I believe aws.creds is part of the public API. Not sure about aws.client.shared. The latter is the one implicitly passed when you don’t explicitly pass a creds provider. "><y>#</y><d>2020-09-08</d><h>16:14</h><r>kenny</r>I believe aws.creds is part of the public API. Not sure about aws.client.shared. The latter is the one implicitly passed when you don’t explicitly pass a creds provider. </z><z id="t1599582712" t="dchelimsky Public? Yes. Stable? “Alpha. Subject to change.” https://cognitect-labs.github.io/aws-api/cognitect.aws.credentials-api.html"><y>#</y><d>2020-09-08</d><h>16:31</h><r>dchelimsky</r>Public? Yes. Stable? “Alpha. Subject to change.” <a href="https://cognitect-labs.github.io/aws-api/cognitect.aws.credentials-api.html" target="_blank">https://cognitect-labs.github.io/aws-api/cognitect.aws.credentials-api.html</a></z><z id="t1599584940" t="kenny I&apos;m pretty sure I&apos;ve brought this up before, but I forget where we landed. Will returning an anomaly from a CredentialProvider&apos;s fetch method result in that anomaly getting returned after calling invoke ?"><y>#</y><d>2020-09-08</d><h>17:09</h><w>kenny</w>I&apos;m pretty sure I&apos;ve brought this up before, but I forget where we landed. Will returning an anomaly from a CredentialProvider&apos;s fetch method result in that anomaly getting returned after calling <code>invoke</code>?</z><z id="t1599656628" t="dchelimsky Not in the current design. In the chained-credentials-provider, it’s only an anomaly if none of the chained providers produce credentials. I think it would be more consistent with the design of the rest of the lib if the individual providers returned anomalies and the chain provider could check for that, and possibly build up list of all the failed providers to include in the anomaly it returns if none provide credentials. Definitely worth looking at."><y>#</y><d>2020-09-09</d><h>13:03</h><r>dchelimsky</r>Not in the current design. In the chained-credentials-provider, it’s only an anomaly if none of the chained providers produce credentials. I think it would be more consistent with the design of the rest of the lib if the individual providers returned anomalies and the chain provider could check for that, and possibly build up list of all the failed providers to include in the anomaly it returns if none provide credentials. Definitely worth looking at.</z><z id="t1599656692" t="dchelimsky We’d still need to handle nil in case users provide their own creds providers (in which case the lib could add the appropriate anomaly)."><y>#</y><d>2020-09-09</d><h>13:04</h><r>dchelimsky</r>We’d still need to handle nil in case users provide their own creds providers (in which case the lib could add the appropriate anomaly).</z><z id="t1599664085" t="kenny Right, okay. I actually believe it happens to work right now. (tested it with a cached-credentials-with-auto-refresh )"><y>#</y><d>2020-09-09</d><h>15:08</h><r>kenny</r>Right, okay. I actually believe it happens to work right now. (tested it with a <code>cached-credentials-with-auto-refresh</code> )</z><z id="t1599664110" t="kenny i.e., if I return an anomaly from my passed in CredentialsProvider, that anomaly will be returned from invoke ."><y>#</y><d>2020-09-09</d><h>15:08</h><r>kenny</r>i.e., if I return an anomaly from my passed in CredentialsProvider, that anomaly will be returned from <code>invoke</code>.</z><z id="t1599585065" t="kenny https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/client.clj#L91-L92 makes it appear like it will. However, valid-credentials ( https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/credentials.clj#L116 ) is used in all the provided provider constructing functions."><y>#</y><d>2020-09-08</d><h>17:11</h><w>kenny</w><a href="https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/client.clj#L91-L92" target="_blank">https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/client.clj#L91-L92</a> makes it appear like it will. However, valid-credentials (<a href="https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/credentials.clj#L116" target="_blank">https://github.com/cognitect-labs/aws-api/blob/e984cccdf78fa2212d8082546fa0ca5aa489051d/src/cognitect/aws/credentials.clj#L116</a>) is used in all the provided provider constructing functions.</z><z id="t1599585136" t="kenny At the very least, it seems returning an anomaly map instead of nil is safe."><y>#</y><d>2020-09-08</d><h>17:12</h><w>kenny</w>At the very least, it seems returning an anomaly map instead of nil is safe.</z><z id="t1599585804" t="kenny It appears like the below part of refresh! &apos;s docstring is not correct. &gt; If the credentials returned by the provider are not valid, resets &gt; both atoms to nil, logs an error, and returns nil."><y>#</y><d>2020-09-08</d><h>17:23</h><w>kenny</w>It appears like the below part of <code>refresh!</code>&apos;s docstring is not correct.
&gt; If the credentials returned by the provider are not valid, resets
&gt; both atoms to nil, logs an error, and returns nil.</z><z id="t1599656866" t="dchelimsky Yeah - that’s what you get for reading the documentation that is clearly left out of the public documentation 😉"><y>#</y><d>2020-09-09</d><h>13:07</h><r>dchelimsky</r>Yeah - that’s what you get for reading the documentation that is clearly left out of the public documentation <b>😉</b></z><z id="t1599656933" t="dchelimsky It’s mostly correct. The only thing that’s incorrect about it is that the error is only logged if there is an error. The rest is accurate."><y>#</y><d>2020-09-09</d><h>13:08</h><r>dchelimsky</r>It’s mostly correct. The only thing that’s incorrect about it is that the error is only logged if there is an error. The rest is accurate.</z><z id="t1599657062" t="dchelimsky Fixed (in github)."><y>#</y><d>2020-09-09</d><h>13:11</h><r>dchelimsky</r>Fixed (in github).</z><z id="t1599664012" t="kenny [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] It says &quot;If the credentials returned by the provider are not valid&quot; but I don&apos;t see where it is checking to see if they are valid. Am I missing something obvious? 🙈"><y>#</y><d>2020-09-09</d><h>15:06</h><r>kenny</r><a>@U0ENYLGTA</a> It says &quot;If the credentials returned by the provider are not valid&quot; but I don&apos;t see where it is checking to see if they are valid. Am I missing something obvious? <b>🙈</b></z><z id="t1599664950" t="dchelimsky It’s a sketchy assumption that all the providers use the valid-credentials fn, which is designed to return valid credentials or nil."><y>#</y><d>2020-09-09</d><h>15:22</h><r>dchelimsky</r>It’s a sketchy assumption that all the providers use the <code>valid-credentials</code> fn, which is designed to return valid credentials or nil.</z><z id="t1599665009" t="kenny Seems highly unlikely for anyone implementing their own creds provider given the docstring for valid-credentials says &quot;For internal use. Don&apos;t call directly.&quot;"><y>#</y><d>2020-09-09</d><h>15:23</h><r>kenny</r>Seems highly unlikely for anyone implementing their own creds provider given the docstring for valid-credentials says &quot;For internal use. Don&apos;t call directly.&quot;</z><z id="t1599665157" t="dchelimsky As I said, sketchy 🙂"><y>#</y><d>2020-09-09</d><h>15:25</h><r>dchelimsky</r>As I said, sketchy <b>🙂</b></z><z id="t1599815657" t="orestis An interesting discussion on Twitter about Clojure deployment on AWS https://twitter.com/pesterhazy/status/1304131064835772416?s=20"><y>#</y><d>2020-09-11</d><h>09:14</h><w>orestis</w>An interesting discussion on Twitter about Clojure deployment on AWS <a href="https://twitter.com/pesterhazy/status/1304131064835772416?s=20" target="_blank">https://twitter.com/pesterhazy/status/1304131064835772416?s=20</a></z><z id="t1599816423" t="orestis I’m doing a deployment now and I’m seeing these metrics: • Env. update is starting -&gt; registering first batch to load balancer and waiting to be healthy: 40s • First batch passed health checks: 5m • Deploying to second batch and waiting for health checks: 36s • Second batch passed health checks: 5m "><y>#</y><d>2020-09-11</d><h>09:27</h><w>orestis</w>I’m doing a deployment now and I’m seeing these metrics:
• Env. update is starting -&gt; registering first batch to load balancer and waiting to be healthy: 40s
• First batch passed health checks: 5m
• Deploying to second batch and waiting for health checks: 36s
• Second batch passed health checks: 5m </z><z id="t1599816432" t="orestis [:attrs {:href &quot;/_/_/users/U06F82LES&quot;}] ^^"><y>#</y><d>2020-09-11</d><h>09:27</h><w>orestis</w><a>@pesterhazy</a> ^^</z><z id="t1599822777" t="pesterhazy [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] thanks for bringing this up here"><y>#</y><d>2020-09-11</d><h>11:12</h><w>pesterhazy</w><a>@orestis</a> thanks for bringing this up here</z><z id="t1599822795" t="pesterhazy what deployment config are you using?"><y>#</y><d>2020-09-11</d><h>11:13</h><w>pesterhazy</w>what deployment config are you using?</z><z id="t1599823145" t="orestis Just two instances, JDK11 / Coretto, Rolling updates, 1 instance at a time."><y>#</y><d>2020-09-11</d><h>11:19</h><w>orestis</w>Just two instances, JDK11 / Coretto, Rolling updates, 1 instance at a time.</z><z id="t1599823147" t="pesterhazy I&apos;ve written up my findings and experiments, with some alternatives sketched (but I haven&apos;t figured this out yet by any means): https://gist.github.com/pesterhazy/d0030f559f600d0ce1b3a090173c9c9c"><y>#</y><d>2020-09-11</d><h>11:19</h><w>pesterhazy</w>I&apos;ve written up my findings and experiments, with some alternatives sketched (but I haven&apos;t figured this out yet by any means): <a href="https://gist.github.com/pesterhazy/d0030f559f600d0ce1b3a090173c9c9c" target="_blank">https://gist.github.com/pesterhazy/d0030f559f600d0ce1b3a090173c9c9c</a></z><z id="t1599823205" t="pesterhazy Any comments appreciated"><y>#</y><d>2020-09-11</d><h>11:20</h><w>pesterhazy</w>Any comments appreciated</z><z id="t1599823250" t="orestis “Currently we use Rolling policy with BatchSize=1” -&gt; that means you’re doing the update one-by-one, have you tried using a percent-based batch size? 25% would do two instances at a time, so it would half your deployment time."><y>#</y><d>2020-09-11</d><h>11:20</h><w>orestis</w>“Currently we use Rolling policy with BatchSize=1” -&gt; that means you’re doing the update one-by-one, have you tried using a percent-based batch size? 25% would do two instances at a time, so it would half your deployment time.</z><z id="t1599823339" t="orestis I feel your pain though. We were hosted on rackspace before, using plain old VMs and updates took seconds."><y>#</y><d>2020-09-11</d><h>11:22</h><w>orestis</w>I feel your pain though. We were hosted on rackspace before, using plain old VMs and updates took seconds.</z><z id="t1599823495" t="orestis There’s a few things I mean to try but it’s low priority for us ATM: 1. There’s a new split traffic update mechanism https://aws.amazon.com/about-aws/whats-new/2020/05/aws-elastic-beanstalk-traffic-splitting-deployment-policy/ 2. There’s a (literally yesterday) ability to share a non-EB load balancer between different EB environments: https://aws.amazon.com/blogs/containers/amazon-elastic-beanstalk-introduces-support-shared-load-balancers/"><y>#</y><d>2020-09-11</d><h>11:24</h><w>orestis</w>There’s a few things I mean to try but it’s low priority for us ATM:
1. There’s a new split traffic update mechanism <a href="https://aws.amazon.com/about-aws/whats-new/2020/05/aws-elastic-beanstalk-traffic-splitting-deployment-policy/" target="_blank">https://aws.amazon.com/about-aws/whats-new/2020/05/aws-elastic-beanstalk-traffic-splitting-deployment-policy/</a>
2. There’s a (literally yesterday) ability to share a non-EB load balancer between different EB environments: <a href="https://aws.amazon.com/blogs/containers/amazon-elastic-beanstalk-introduces-support-shared-load-balancers/" target="_blank">https://aws.amazon.com/blogs/containers/amazon-elastic-beanstalk-introduces-support-shared-load-balancers/</a></z><z id="t1599828104" t="pesterhazy Do you think these have the potential of speeding up deployments?"><y>#</y><d>2020-09-11</d><h>12:41</h><r>pesterhazy</r>Do you think these have the potential of speeding up deployments?</z><z id="t1599830921" t="orestis The split traffic will probably fix the “mixed results” problem. I’m using session stickyness to overcome it, but I don’t like session stickyness in general."><y>#</y><d>2020-09-11</d><h>13:28</h><r>orestis</r>The split traffic will probably fix the “mixed results” problem. I’m using session stickyness to overcome it, but I don’t like session stickyness in general.</z><z id="t1599830974" t="orestis The shared ELB gives you great flexibility, since you can mix-and-match environments — but I don’t think you can get faster deployments without significant engineering investment in automation, so it’s probably not that relevant."><y>#</y><d>2020-09-11</d><h>13:29</h><r>orestis</r>The shared ELB gives you great flexibility, since you can mix-and-match environments — but I don’t think you can get faster deployments without significant engineering investment in automation, so it’s probably not that relevant.</z><z id="t1599823978" t="orestis Elastic Beanstalk was nice to get us some peace of mind with minimal ops investment, as we migrated to AWS. But it feels creaky. OTOH, it is Dockerless, and there was some movement lately which makes me hopeful that it’s actively developed and improved."><y>#</y><d>2020-09-11</d><h>11:32</h><w>orestis</w>Elastic Beanstalk was nice to get us some peace of mind with minimal ops investment, as we migrated to AWS. But it feels creaky. OTOH, it is Dockerless, and there was some movement lately which makes me hopeful that it’s actively developed and improved.</z><z id="t1599828067" t="pesterhazy &gt; have you tried using a percent-based batch size Yeah that&apos;s definitely something we&apos;ll try, along with RollingWithAdditionalBatch. I figured we&apos;d try Immutable first, on the assumption that it&apos;d be faster on principle, because it spins up all 8 instances concurrently. But that doesn&apos;t seem quite true"><y>#</y><d>2020-09-11</d><h>12:41</h><w>pesterhazy</w>&gt;  have you tried using a percent-based batch size
Yeah that&apos;s definitely something we&apos;ll try, along with RollingWithAdditionalBatch. I figured we&apos;d try Immutable first, on the assumption that it&apos;d be faster on principle, because it spins up all 8 instances concurrently. But that doesn&apos;t seem quite true</z><z id="t1599828239" t="pesterhazy Another thought I&apos;ve had is this: • in the normal day-to-day deployment case, 26 min is probably acceptable; so we can keep using Rolling deployments (or Immutable deployments) • when there&apos;s a problem, however, and you need to deploy a hotfix or roll back a change, 26 min is unacceptable. In this case we could manually switch to AllAtOnce before uploading the new app version"><y>#</y><d>2020-09-11</d><h>12:43</h><w>pesterhazy</w>Another thought I&apos;ve had is this:

• in the normal day-to-day deployment case, 26 min is probably acceptable; so we can keep using Rolling deployments (or Immutable deployments)
• when there&apos;s a problem, however, and you need to deploy a hotfix or roll back a change, 26 min is unacceptable. In this case we could manually switch to AllAtOnce before uploading the new app version</z><z id="t1599830821" t="orestis The Immutable spins up new instances from scratch which takes some time."><y>#</y><d>2020-09-11</d><h>13:27</h><w>orestis</w>The Immutable spins up new instances from scratch which takes some time.</z><z id="t1599830848" t="orestis Don’t you have to wait to do a configuration deployment to specify AllAtOnce?"><y>#</y><d>2020-09-11</d><h>13:27</h><w>orestis</w>Don’t you have to wait to do a configuration deployment to specify AllAtOnce?</z><z id="t1599830881" t="orestis Ah wait — the configuration policy is different than the new application version policy. So you could keep the configuration policy at AllAtOnce indefinetely."><y>#</y><d>2020-09-11</d><h>13:28</h><w>orestis</w>Ah wait — the configuration policy is different than the new application version policy. So you could keep the configuration policy at AllAtOnce indefinetely.</z><z id="t1599914634" t="pesterhazy Just tested this. You can manually switch to AllAtOnce in the console. It takes about a minute. Then deploying a new application version takes less than a minute. The downside is that you have downtime, in our case 12 minutes"><y>#</y><d>2020-09-12</d><h>12:43</h><r>pesterhazy</r>Just tested this. You can manually switch to AllAtOnce in the console. It takes about a minute. Then deploying a new application version takes less than a minute. The downside is that you have downtime, in our case 12 minutes</z><z id="t1599914689" t="pesterhazy This tradeoff may be acceptable when hotfixing a customer facing bug "><y>#</y><d>2020-09-12</d><h>12:44</h><r>pesterhazy</r>This tradeoff may be acceptable when hotfixing a customer facing bug </z><z id="t1599832724" t="ghadi I use Fargate to deploy services"><y>#</y><d>2020-09-11</d><h>13:58</h><w>ghadi</w>I use Fargate to deploy services</z><z id="t1599832731" t="ghadi ask me anything"><y>#</y><d>2020-09-11</d><h>13:58</h><w>ghadi</w>ask me anything</z><z id="t1599833725" t="orestis [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] how long does it take for traffic to hit a new version of code, and how fast is rolling back? Also, does Fargate necessitate Docker? Does it have a nice console to get started? Is it a good fit for “monoliths”? How do you develop locally? What about monitoring things like traffic, memory use etc etc? Do you pick instance sizes eg if you want large machines with lots of memory? What about static assets, do you bundle nginx together with a JVM or do you make separate containers? "><y>#</y><d>2020-09-11</d><h>14:15</h><w>orestis</w><a>@ghadi</a> how long does it take for traffic to hit a new version of code, and how fast is rolling back? Also, does Fargate necessitate Docker? Does it have a nice console to get started? Is it a good fit for “monoliths”? How do you develop locally? What about monitoring things like traffic, memory use etc etc? Do you pick instance sizes eg if you want large machines with lots of memory? What about static assets, do you bundle nginx together with a JVM or do you make separate containers? </z><z id="t1599833767" t="orestis I’m clueless and suspicious about containers and beanstalk gave me an entry point where many things are reasonably automated, but we’re outgrowing it :)"><y>#</y><d>2020-09-11</d><h>14:16</h><w>orestis</w>I’m clueless and suspicious about containers and beanstalk gave me an entry point where many things are reasonably automated, but we’re outgrowing it :)</z><z id="t1599833768" t="ghadi traffic: 2-5 minutes"><y>#</y><d>2020-09-11</d><h>14:16</h><w>ghadi</w>traffic: 2-5 minutes</z><z id="t1599833773" t="ghadi yes fargate necessitates docker"><y>#</y><d>2020-09-11</d><h>14:16</h><w>ghadi</w>yes fargate necessitates docker</z><z id="t1599833800" t="ghadi Fargate is &quot;hostless&quot; docker, where AWS manages scheduling your containers magically"><y>#</y><d>2020-09-11</d><h>14:16</h><w>ghadi</w>Fargate is &quot;hostless&quot; docker, where AWS manages scheduling your containers magically</z><z id="t1599833831" t="ghadi monolith is broad, so I can&apos;t assess if it&apos;s a good fit, but if you can containerize your app, it&apos;s a start"><y>#</y><d>2020-09-11</d><h>14:17</h><w>ghadi</w>monolith is broad, so I can&apos;t assess if it&apos;s a good fit, but if you can containerize your app, it&apos;s a start</z><z id="t1599833876" t="ghadi I use an ALB as a load balancer, connecting to Pedestal/Jetty on the containers"><y>#</y><d>2020-09-11</d><h>14:17</h><w>ghadi</w>I use an ALB as a load balancer, connecting to Pedestal/Jetty on the containers</z><z id="t1599834192" t="orestis A few more questions: do you use AWS cli to deploy new versions? Is a new version a fresh docker image that you push to a registry, then notify Fargate to run it? How does auto scale work? Is it also suitable for “background” jobs eg if I have some cron jobs can I keep a Fargate container running forever?"><y>#</y><d>2020-09-11</d><h>14:23</h><w>orestis</w>A few more questions: do you use AWS cli to deploy new versions? Is a new version a fresh docker image that you push to a registry, then notify Fargate to run it? How does auto scale work? Is it also suitable for “background” jobs eg if I have some cron jobs can I keep a Fargate container running forever?</z><z id="t1599834249" t="orestis I think I just need to sit down and read the Fargate docs :)"><y>#</y><d>2020-09-11</d><h>14:24</h><w>orestis</w>I think I just need to sit down and read the Fargate docs :)</z><z id="t1599834315" t="orestis What about the subjective stuff instead, are you happy with it? Would you choose it for a new project? "><y>#</y><d>2020-09-11</d><h>14:25</h><w>orestis</w>What about the subjective stuff instead, are you happy with it? Would you choose it for a new project? </z><z id="t1599835978" t="ghadi I do everything through cloudformation... I haven&apos;t taken up the CDK yet."><y>#</y><d>2020-09-11</d><h>14:52</h><w>ghadi</w>I do everything through cloudformation... I haven&apos;t taken up the CDK yet.</z><z id="t1599836015" t="ghadi upstream build job makes a docker image, downstream deployment job updates cloudformation stack"><y>#</y><d>2020-09-11</d><h>14:53</h><w>ghadi</w>upstream build job makes a docker image, downstream deployment job updates cloudformation stack</z><z id="t1599836060" t="ghadi since java is so easy to deploy, sometimes I use a stock container that downloads the jar upon startup"><y>#</y><d>2020-09-11</d><h>14:54</h><w>ghadi</w>since java is so easy to deploy, sometimes I use a stock container that downloads the jar upon startup</z><z id="t1599836072" t="ghadi other times I bake the jar into the container"><y>#</y><d>2020-09-11</d><h>14:54</h><w>ghadi</w>other times I bake the jar into the container</z><z id="t1599836106" t="ghadi autoscaling in ECS/Fargate https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-auto-scaling.html"><y>#</y><d>2020-09-11</d><h>14:55</h><w>ghadi</w>autoscaling in ECS/Fargate <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-auto-scaling.html" target="_blank">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-auto-scaling.html</a></z><z id="t1599836144" t="ghadi yes Fargate containers can run indefinitely"><y>#</y><d>2020-09-11</d><h>14:55</h><w>ghadi</w>yes Fargate containers can run indefinitely</z><z id="t1599836160" t="ghadi e.g. we have some queue pollers that are in fargate"><y>#</y><d>2020-09-11</d><h>14:56</h><w>ghadi</w>e.g. we have some queue pollers that are in fargate</z><z id="t1599836207" t="ghadi Subjectively, I like Fargate, but I&apos;ve used it for several years now and have some expertise"><y>#</y><d>2020-09-11</d><h>14:56</h><w>ghadi</w>Subjectively, I like Fargate, but I&apos;ve used it for several years now and have some expertise</z><z id="t1599836227" t="ghadi It used to be really expensive compared to EC2, but now it&apos;s not as much of a premium"><y>#</y><d>2020-09-11</d><h>14:57</h><w>ghadi</w>It used to be really expensive compared to EC2, but now it&apos;s not as much of a premium</z><z id="t1599836250" t="ghadi I despise managing machines, and prefer to only manage my application"><y>#</y><d>2020-09-11</d><h>14:57</h><w>ghadi</w>I despise managing machines, and prefer to only manage my application</z><z id="t1599836261" t="ghadi don&apos;t have to worry about security updates, or ssh access with a container"><y>#</y><d>2020-09-11</d><h>14:57</h><w>ghadi</w>don&apos;t have to worry about security updates, or ssh access with a container</z><z id="t1599836273" t="ghadi well, not as much"><y>#</y><d>2020-09-11</d><h>14:57</h><w>ghadi</w>well, not as much</z><z id="t1599838527" t="kenny We used to use Fargate, and I quite liked it. Had to switch due to lack of persistent storage at the time. It&apos;s gotten some very nice features since, however. They added capacity providers so using the spot market is easy. You can now attach EFS volumes to a task for persistent storage. We use Datadog for metrics, logs, APM. If you use something similar, all tasks need a sidecar container running which is a small additional added cost per task replica. Deploy everything using Pulumi. Overall Fargate experience has been fantastic. Would also recommend."><y>#</y><d>2020-09-11</d><h>15:35</h><w>kenny</w>We used to use Fargate, and I quite liked it. Had to switch due to lack of persistent storage at the time. It&apos;s gotten some very nice features since, however. They added capacity providers so using the spot market is easy. You can now attach EFS volumes to a task for persistent storage. We use Datadog for metrics, logs, APM. If you use something similar, all tasks need a sidecar container running which is a small additional added cost per task replica. Deploy everything using Pulumi. Overall Fargate experience has been fantastic. Would also recommend.</z><z id="t1599839296" t="orestis Ah, right, so different vendors. Interesting POV, I thought that using AWS for everything was the norm but it seems not. "><y>#</y><d>2020-09-11</d><h>15:48</h><w>orestis</w>Ah, right, so different vendors. Interesting POV, I thought that using AWS for everything was the norm but it seems not. </z><z id="t1599841596" t="kenny I don&apos;t know how folks can possibly stand using CW logs. It&apos;s terrible compared to Datadog&apos;s offering."><y>#</y><d>2020-09-11</d><h>16:26</h><r>kenny</r>I don&apos;t know how folks can possibly stand using CW logs. It&apos;s terrible compared to Datadog&apos;s offering.</z><z id="t1599842610" t="orestis It’s effectively free ;)"><y>#</y><d>2020-09-11</d><h>16:43</h><r>orestis</r>It’s effectively free ;)</z><z id="t1599842653" t="kenny People time is usually far more expensive tho"><y>#</y><d>2020-09-11</d><h>16:44</h><r>kenny</r>People time is usually far more expensive tho</z><z id="t1599839326" t="orestis To be honest I don’t want to do anything with this kind of thing so the more hands off the better :)"><y>#</y><d>2020-09-11</d><h>15:48</h><w>orestis</w>To be honest I don’t want to do anything with this kind of thing so the more hands off the better :)</z><z id="t1599902327" t="viesti I&apos;ve been using ECS with Fargate and EC2 backed clusters (in the past, rolling updates with Ansible). Docker images I&apos;ve been building with Jib via pack.alpha https://github.com/juxt/pack.alpha#docker-image"><y>#</y><d>2020-09-12</d><h>09:18</h><w>viesti</w>I&apos;ve been using ECS with Fargate and EC2 backed clusters (in the past, rolling updates with Ansible). Docker images I&apos;ve been building with Jib via pack.alpha <a href="https://github.com/juxt/pack.alpha#docker-image" target="_blank">https://github.com/juxt/pack.alpha#docker-image</a></z><z id="t1599914792" t="pesterhazy I did some testing with deployment policies. Two things I’ve learned"><y>#</y><d>2020-09-12</d><h>12:46</h><w>pesterhazy</w>I did some testing with deployment policies. Two things I’ve learned</z><z id="t1599914857" t="pesterhazy First, RollingWithAdditionalBatch reduces the deploy time from 26 min to 6 min"><y>#</y><d>2020-09-12</d><h>12:47</h><w>pesterhazy</w>First, RollingWithAdditionalBatch reduces the deploy time from 26 min to 6 min</z><z id="t1599916704" t="orestis Even with batch size = 1?"><y>#</y><d>2020-09-12</d><h>13:18</h><r>orestis</r>Even with batch size  = 1?</z><z id="t1599916822" t="pesterhazy No, with BatchSize=100%. I’m not seeing disadvantages of swapping out everything at once"><y>#</y><d>2020-09-12</d><h>13:20</h><r>pesterhazy</r>No, with BatchSize=100%. I’m not seeing disadvantages of swapping out everything at once</z><z id="t1599916983" t="orestis Isn’t that effectively the same as immutable?"><y>#</y><d>2020-09-12</d><h>13:23</h><r>orestis</r>Isn’t that effectively the same as immutable?</z><z id="t1599918314" t="pesterhazy You&apos;d think that but in fact immutable is always much slower. Aws support has confirmed this"><y>#</y><d>2020-09-12</d><h>13:45</h><r>pesterhazy</r>You&apos;d think that but in fact immutable is always much slower. Aws support has confirmed this</z><z id="t1599915012" t="pesterhazy Second, I think I’ve been over-automating things. It makes sense to also have a manual mode. Whereas in auto mode, every merge to master causes a deployment, in manual developers use the EB web console directly"><y>#</y><d>2020-09-12</d><h>12:50</h><w>pesterhazy</w>Second, I think I’ve been over-automating things. It makes sense to also have a manual mode. Whereas in auto mode, every merge to master causes a deployment, in manual developers use the EB web console directly</z><z id="t1599916825" t="orestis Oh right. We don’t do that. We have scripts to do deploys, combined with aws-vault for credentials."><y>#</y><d>2020-09-12</d><h>13:20</h><r>orestis</r>Oh right. We don’t do that. We have scripts to do deploys, combined with aws-vault for credentials.</z><z id="t1599916875" t="orestis What I’d like to do is prepare the deploy artifacts on every commit, upload them to S3 or as a new version in beanstalk, then choose to deploy one manually. "><y>#</y><d>2020-09-12</d><h>13:21</h><r>orestis</r>What I’d like to do is prepare the deploy artifacts on every commit, upload them to S3 or as a new version in beanstalk, then choose to deploy one manually. </z><z id="t1599916980" t="pesterhazy Yeah creating a new version is fast , using aws elasticbeanstalk create-application-Version"><y>#</y><d>2020-09-12</d><h>13:23</h><r>pesterhazy</r>Yeah creating a new version is fast , using aws elasticbeanstalk create-application-Version</z><z id="t1599917053" t="orestis Oh, I am using the eb tool which doesn’t have such an option. I’ll have a look at the AWS cli. "><y>#</y><d>2020-09-12</d><h>13:24</h><r>orestis</r>Oh, I am using the <code>eb</code> tool which doesn’t have such an option. I’ll have a look at the AWS cli. </z><z id="t1599917056" t="pesterhazy It’s a good point: CI can always prepare the deploy artifact, then you can choose to auto-update the environment, or not"><y>#</y><d>2020-09-12</d><h>13:24</h><r>pesterhazy</r>It’s a good point: CI can always prepare the deploy artifact, then you can choose to auto-update the environment, or not</z><z id="t1599917083" t="pesterhazy Yeah I discovered that i don’t need the eb cli tool at all"><y>#</y><d>2020-09-12</d><h>13:24</h><r>pesterhazy</r>Yeah I discovered that i don’t need the eb cli tool at all</z><z id="t1599917146" t="orestis Are you pushing a zip file that you build yourself? With jars and resources and procfile and .ebextensions etc?"><y>#</y><d>2020-09-12</d><h>13:25</h><r>orestis</r>Are you pushing a zip file that you build yourself? With jars and resources and procfile and .ebextensions etc?</z><z id="t1599917157" t="orestis Or does the AWS cli do that as well?"><y>#</y><d>2020-09-12</d><h>13:25</h><r>orestis</r>Or does the AWS cli do that as well?</z><z id="t1599918239" t="pesterhazy I create a zip file containing the jar and .ebextensions and upload it to s3. The API call accepts an S3 bucket/key"><y>#</y><d>2020-09-12</d><h>13:43</h><r>pesterhazy</r>I create a zip file containing the jar and .ebextensions and upload it to s3. The API call accepts an S3 bucket/key</z><z id="t1599918268" t="pesterhazy Better to decomplect the process as much as possible"><y>#</y><d>2020-09-12</d><h>13:44</h><r>pesterhazy</r>Better to decomplect the process as much as possible</z><z id="t1599921658" t="orestis Ah that’s fantastic. I opened an issue with the EB tool some time ago asking just for this — but got no meaningful response."><y>#</y><d>2020-09-12</d><h>14:40</h><r>orestis</r>Ah that’s fantastic. I opened an issue with the EB tool some time ago asking just for this — but got no meaningful response.</z><z id="t1599922314" t="orestis Have you tried using the API directly? I think scripting with Clojure is might be faster than using a CLI 🙂"><y>#</y><d>2020-09-12</d><h>14:51</h><r>orestis</r>Have you tried using the API directly? I think scripting with Clojure is might be faster than using a CLI <b>🙂</b></z><z id="t1599924215" t="pesterhazy Haven&apos;t tried it but should be fairly easy. I&apos;m going go with bash/awscli"><y>#</y><d>2020-09-12</d><h>15:23</h><r>pesterhazy</r>Haven&apos;t tried it but should be fairly easy. I&apos;m going go with bash/awscli</z><z id="t1599918437" t="pesterhazy It’s also good to decomplect configuration changes (e.g. auto scaling group size) on the one hand and code changes on the other as much as possible"><y>#</y><d>2020-09-12</d><h>13:47</h><w>pesterhazy</w>It’s also good to decomplect configuration changes (e.g. auto scaling group size) on the one hand and code changes on the other as much as possible</z><z id="t1600140973" t="zackteo Hi guys, I have this project https://istd50043.github.io/project#implementation-requirements I&apos;m trying to consider the possibility of doing this solo (so that I can do Clojure full stack) I&apos;m thinking the &quot;Production System&quot; can be done with Clojurescript. &quot;Analytics System&quot; can be done with Clojure. But I also need to do automation scripts for AWS - not sure how possible is it to do this with babashka :o I know might be pretty intense to tackle alone. But am wondering how intense/possible is it :x"><y>#</y><d>2020-09-15</d><h>03:36</h><w>zackteo</w>Hi guys, I have this project <a href="https://istd50043.github.io/project#implementation-requirements" target="_blank">https://istd50043.github.io/project#implementation-requirements</a> I&apos;m trying to consider the possibility of doing this solo (so that I can do Clojure full stack) I&apos;m thinking the &quot;Production System&quot; can be done with Clojurescript. &quot;Analytics System&quot; can be done with Clojure. But I also need to do automation scripts for AWS - not sure how possible is it to do this with babashka :o 
I know might be pretty intense to tackle alone. But am wondering how intense/possible is it :x</z><z id="t1600141512" t="jimmy You could definitely do those things with clojure. For the automation scripts, you could use babashka, but there is no reason you can&apos;t use vanilla clojure."><y>#</y><d>2020-09-15</d><h>03:45</h><r>jimmy</r>You could definitely do those things with clojure. For the automation scripts, you could use babashka, but there is no reason you can&apos;t use vanilla clojure.</z><z id="t1600141576" t="zackteo Right! Are there any references or libraries I would wanna look at? To work with aws?"><y>#</y><d>2020-09-15</d><h>03:46</h><r>zackteo</r>Right! Are there any references or libraries I would wanna look at? To work with aws?</z><z id="t1600141635" t="zackteo Am also considering the intensity demanded if I tackle this task solo :x"><y>#</y><d>2020-09-15</d><h>03:47</h><r>zackteo</r>Am also considering the intensity demanded if I tackle this task solo :x</z><z id="t1600155478" t="dakra For working with the AWS API you can use https://github.com/cognitect-labs/aws-api"><y>#</y><d>2020-09-15</d><h>07:37</h><r>dakra</r>For working with the AWS API you can use <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a></z><z id="t1600162782" t="zackteo Thanks [:attrs {:href &quot;/_/_/users/UFAP0C8KU&quot;}] ! [:attrs {:href &quot;/_/_/users/U5K8NTHEZ&quot;}] , I will be going ahead with the project in Clojure after all! :D I miraculously found 2 peers to join me to form a 3 man team 🙂 so it isn&apos;t as ridiculously daunting anymore"><y>#</y><d>2020-09-15</d><h>09:39</h><r>zackteo</r>Thanks <a>@UFAP0C8KU</a> ! <a>@U5K8NTHEZ</a> , I will be going ahead with the project in Clojure after all! :D I miraculously found 2 peers to join me to form a 3 man team <b>🙂</b> so it isn&apos;t as ridiculously daunting anymore</z><z id="t1600163595" t="jumar Instead of calling aws api manually consider using a more declarative approach like CloudFormation (rather bad with all that JSON bloat) or better CDK (there was a clojure port but has been abandoned in favor of native TypeScript support)"><y>#</y><d>2020-09-15</d><h>09:53</h><r>jumar</r>Instead of calling aws api manually consider using a more declarative approach like CloudFormation (rather bad with all that JSON bloat) or better CDK (there was a clojure port but has been abandoned in favor of native TypeScript support)</z><z id="t1600163715" t="zackteo Do you mean this https://github.com/brabster/crucible ? o:"><y>#</y><d>2020-09-15</d><h>09:55</h><r>zackteo</r>Do you mean this <a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a>? o:</z><z id="t1600163877" t="jumar For the abandoned clojure CDK project I meant this: https://github.com/StediInc/cdk-clj I don&apos;t know the other one."><y>#</y><d>2020-09-15</d><h>09:57</h><r>jumar</r>For the abandoned clojure CDK project I meant this: <a href="https://github.com/StediInc/cdk-clj" target="_blank">https://github.com/StediInc/cdk-clj</a>
I don&apos;t know the other one.</z><z id="t1600168488" t="zackteo Isn&apos;t it a bad idea since it is abandoned? Or is it because it should still be stable o:"><y>#</y><d>2020-09-15</d><h>11:14</h><r>zackteo</r>Isn&apos;t it a bad idea since it is abandoned? Or is it because it should still be stable o:</z><z id="t1600174986" t="jumar No, don’t use it. I was broadly speaking about AWS CDK - that’s worth looking at; compiles to CloudFormation and you can write infrastructure code in Typescript, Python, Java, ... to reduce boilerplate "><y>#</y><d>2020-09-15</d><h>13:03</h><r>jumar</r>No, don’t use it. I was broadly speaking about AWS CDK - that’s worth looking at; compiles to CloudFormation and you can write infrastructure code in Typescript, Python, Java, ... to reduce boilerplate </z><z id="t1600175254" t="viesti Terraform is also a nice tool for defining infrastructure"><y>#</y><d>2020-09-15</d><h>13:07</h><r>viesti</r>Terraform is also a nice tool for defining infrastructure</z><z id="t1600209155" t="steveb8n I previously used Crucible, then switched to clj-cdk and then to typescript CDK for my clojure /full-stack system. I’m very happy using typescript for just this part. Of course there’s also Terraform, Pulumi, etc. Just pick one :)"><y>#</y><d>2020-09-15</d><h>22:32</h><r>steveb8n</r>I previously used Crucible, then switched to clj-cdk and then to typescript CDK for my clojure /full-stack system. I’m very happy using typescript for just this part. Of course there’s also Terraform, Pulumi, etc. Just pick one :)</z><z id="t1600362736" t="include +1 for CDK with Typescript. "><y>#</y><d>2020-09-17</d><h>17:12</h><r>include</r>+1  for CDK with Typescript. </z><z id="t1600409350" t="jumar I&apos;ve been thinking about starting using CDK (possibly) with Typescript for automating some of our infrastructure. What&apos;s unclear to me yet is how well CDK plays with existing resources (based on my current research not su much) - let&apos;s say I want define WAF web acl or beanstalk env via CDK and connect them to an existing CloudFront distribution; is there an easy way to do it? To me it looks like with CDK I have to define the whole stack in CDK and if I have resources created manually before I&apos;m out of luck. [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] any experience regarding this scenario?"><y>#</y><d>2020-09-18</d><h>06:09</h><r>jumar</r>I&apos;ve been thinking about starting using CDK (possibly) with Typescript for automating some of our infrastructure.

What&apos;s unclear to me yet is how well CDK plays with existing resources (based on my current research not su much) - let&apos;s say I want define WAF web acl or beanstalk env via CDK and connect them to an existing CloudFront distribution; is there an easy way to do it?
To me it looks like with CDK I have to define the whole stack in CDK and if I have resources created manually before I&apos;m out of luck.
<a>@U06QSF3BK</a> <a>@U0510KXTU</a> any experience regarding this scenario?</z><z id="t1600409382" t="jumar Sorry I meant [:attrs {:href &quot;/_/_/users/U3NP9AM0S&quot;}] not viesti 🙂"><y>#</y><d>2020-09-18</d><h>06:09</h><r>jumar</r>Sorry I meant <a>@U3NP9AM0S</a> not viesti <b>🙂</b></z><z id="t1600409392" t="viesti nah, I&apos;m curious on hearing too 🙂"><y>#</y><d>2020-09-18</d><h>06:09</h><r>viesti</r>nah, I&apos;m curious on hearing too <b>🙂</b></z><z id="t1600409422" t="viesti Cloudformation has a way to import existing resources these days, don&apos;t know how well that plays with CDK"><y>#</y><d>2020-09-18</d><h>06:10</h><r>viesti</r>Cloudformation has a way to import existing resources these days, don&apos;t know how well that plays with CDK</z></g><g id="s13"><z id="t1600409454" t="steveb8n most resources in CDK have a fromARN or fromName fn where you can load an existing resource and reference it"><y>#</y><d>2020-09-18</d><h>06:10</h><r>steveb8n</r>most resources in CDK have a fromARN or fromName fn where you can load an existing resource and reference it</z><z id="t1600409459" t="viesti With Terraform, you script the resources, possibly creating many of them and can then import the instances"><y>#</y><d>2020-09-18</d><h>06:10</h><r>viesti</r>With Terraform, you script the resources, possibly creating many of them and can then import the instances</z><z id="t1600409466" t="viesti ah nice"><y>#</y><d>2020-09-18</d><h>06:11</h><r>viesti</r>ah nice</z><z id="t1600409481" t="steveb8n so that way you can create new stack resources connected to existing ones"><y>#</y><d>2020-09-18</d><h>06:11</h><r>steveb8n</r>so that way you can create new stack resources connected to existing ones</z><z id="t1600409523" t="steveb8n but naturally those resources are not “infra as code” so it’s better to replace them with CDK created versions over time"><y>#</y><d>2020-09-18</d><h>06:12</h><r>steveb8n</r>but naturally those resources are not “infra as code” so it’s better to replace them with CDK created versions over time</z><z id="t1600409531" t="viesti https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html"><y>#</y><d>2020-09-18</d><h>06:12</h><r>viesti</r><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html</a></z><z id="t1600409544" t="jumar Interesting, how is it related to CloudFormation&apos;s import then? • https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html • Also found this: https://github.com/aws/aws-cdk-rfcs/issues/52 "><y>#</y><d>2020-09-18</d><h>06:12</h><r>jumar</r>Interesting, how is it related to CloudFormation&apos;s import then?
•  <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resource-import-existing-stack.html</a>
• Also found this: <a href="https://github.com/aws/aws-cdk-rfcs/issues/52" target="_blank">https://github.com/aws/aws-cdk-rfcs/issues/52</a>
</z><z id="t1600409604" t="steveb8n CDK is CF under the covers so anything you can do all this just using CF if you want"><y>#</y><d>2020-09-18</d><h>06:13</h><r>steveb8n</r>CDK is CF under the covers so anything you can do all this just using CF if you want</z><z id="t1600409628" t="steveb8n but CDK/typescript gives you compile time checking/intellisense etc"><y>#</y><d>2020-09-18</d><h>06:13</h><r>steveb8n</r>but CDK/typescript gives you compile time checking/intellisense etc</z><z id="t1600409655" t="viesti seems like one would do the import onto an already created stack, dunno how the resources end up into the stack though"><y>#</y><d>2020-09-18</d><h>06:14</h><r>viesti</r>seems like one would do the import onto an already created stack, dunno how the resources end up into the stack though</z><z id="t1600409658" t="steveb8n that said, lots of things only fail when you deploy the CDK stack so not everything is compile time"><y>#</y><d>2020-09-18</d><h>06:14</h><r>steveb8n</r>that said, lots of things only fail when you deploy the CDK stack so not everything is compile time</z><z id="t1600409699" t="steveb8n your best bet is just try a small stack. it’s really easy to get started. you can answer most questions for yourself then"><y>#</y><d>2020-09-18</d><h>06:14</h><r>steveb8n</r>your best bet is just try a small stack. it’s really easy to get started. you can answer most questions for yourself then</z><z id="t1600409710" t="viesti I think I&apos;m in the minority here, but I quite like Terrafrom too, it offers intellisense (IntelliJ has a nice plugin, Emacs has some support too) and the language kind of suits for configuration 🙂"><y>#</y><d>2020-09-18</d><h>06:15</h><r>viesti</r>I think I&apos;m in the minority here, but I quite like Terrafrom too, it offers intellisense (IntelliJ has a nice plugin, Emacs has some support too) and the language kind of suits for configuration <b>🙂</b></z><z id="t1600409719" t="steveb8n I didn’t know typescript at all when I started"><y>#</y><d>2020-09-18</d><h>06:15</h><r>steveb8n</r>I didn’t know typescript at all when I started</z><z id="t1600409740" t="steveb8n yep. Terraform and Pulumi are also good. CDK is AWS only"><y>#</y><d>2020-09-18</d><h>06:15</h><r>steveb8n</r>yep. Terraform and Pulumi are also good. CDK is AWS only</z><z id="t1600409764" t="viesti anyhow, interesting things 🙂"><y>#</y><d>2020-09-18</d><h>06:16</h><r>viesti</r>anyhow, interesting things <b>🙂</b></z><z id="t1600409822" t="jumar Perfect, thank you both for all the details! I did CDK workshop but need to do some &quot;real&quot; stuff too - will see how well it plays with our infrastructure (lots of things defined manually via AWS console, some via CloudFormation templates)"><y>#</y><d>2020-09-18</d><h>06:17</h><r>jumar</r>Perfect, thank you both for all the details!
I did CDK workshop but need to do some &quot;real&quot; stuff too - will see how well it plays with our infrastructure (lots of things defined manually via AWS console, some via CloudFormation templates)</z><z id="t1600409892" t="steveb8n glad to help"><y>#</y><d>2020-09-18</d><h>06:18</h><r>steveb8n</r>glad to help</z><z id="t1600409928" t="viesti glad to be part of the discussion 🙂"><y>#</y><d>2020-09-18</d><h>06:18</h><r>viesti</r>glad to be part of the discussion <b>🙂</b></z><z id="t1600419001" t="include [:attrs {:href &quot;/_/_/users/U06BE1L6T&quot;}] timezones… yes as [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] said you have a couple ways to use/import external resources/stacks."><y>#</y><d>2020-09-18</d><h>08:50</h><r>include</r><a>@U06BE1L6T</a> timezones… yes as <a>@U06QSF3BK</a> said you have a couple ways to use/import external resources/stacks.</z><z id="t1600419086" t="include [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] now we have Terraform + CDK - so we can write CDK Typescrypt and gerenate Terraform."><y>#</y><d>2020-09-18</d><h>08:51</h><r>include</r><a>@U0510KXTU</a> now we have Terraform + CDK - so we can write CDK Typescrypt and gerenate Terraform.</z><z id="t1600422836" t="viesti ah that too, had forgotten that Terraform has a CDK thing nowadays also: https://github.com/hashicorp/terraform-cdk"><y>#</y><d>2020-09-18</d><h>09:53</h><r>viesti</r>ah that too, had forgotten that Terraform has a CDK thing nowadays also: <a href="https://github.com/hashicorp/terraform-cdk" target="_blank">https://github.com/hashicorp/terraform-cdk</a></z><z id="t1600435459" t="include Yes it’s new but I am willing to give it a try. In the past I only used TF then I jumped into a pure CFN project and now I only code infra with CDK 🙂 yes… I wanna join all my experience in “one code style” and deployment tooling; still I am not a TS developer but until now I was able to move forward."><y>#</y><d>2020-09-18</d><h>13:24</h><r>include</r>Yes it’s new but I am willing to give it a try. In the past I only used TF then I jumped into a pure CFN project and now I only code infra with CDK <b>🙂</b> yes… I wanna join all my experience in “one code style” and deployment tooling; still I am not a TS developer but until now I was able to move forward.</z><z id="t1600947389" t="borkdude https://github.com/tzzh/pod-tzzh-aws &lt;- interact with AWS from babashka, a fast starting Clojure scripting env"><y>#</y><d>2020-09-24</d><h>11:36</h><w>borkdude</w><a href="https://github.com/tzzh/pod-tzzh-aws" target="_blank">https://github.com/tzzh/pod-tzzh-aws</a> &lt;- interact with AWS from babashka, a fast starting Clojure scripting env</z><z id="t1600954148" t="viesti nice :)"><y>#</y><d>2020-09-24</d><h>13:29</h><w>viesti</w>nice :)</z><z id="t1601554424" t="caleb.macdonaldblack How do I stop AWS_CLI commands from blocking the terminal? The lambda update_function_code command blocks the terminal after deploying until I quit it."><y>#</y><d>2020-10-01</d><h>12:13</h><w>caleb.macdonaldblack</w>How do I stop AWS_CLI commands from blocking the terminal? The lambda update_function_code command blocks the terminal after deploying until I quit it.</z><z id="t1601554526" t="caleb.macdonaldblack it’s opening vim export AWS_PAGER=&quot;&quot; stops it"><y>#</y><d>2020-10-01</d><h>12:15</h><w>caleb.macdonaldblack</w>it’s opening vim <code>export AWS_PAGER=&quot;&quot;</code> stops it</z><z id="t1601557538" t="viesti Timestream released, quite interesting: https://aws.amazon.com/blogs/aws/store-and-access-time-series-data-at-any-scale-with-amazon-timestream-now-generally-available/"><y>#</y><d>2020-10-01</d><h>13:05</h><w>viesti</w>Timestream released, quite interesting: <a href="https://aws.amazon.com/blogs/aws/store-and-access-time-series-data-at-any-scale-with-amazon-timestream-now-generally-available/" target="_blank">https://aws.amazon.com/blogs/aws/store-and-access-time-series-data-at-any-scale-with-amazon-timestream-now-generally-available/</a></z><z id="t1601564722" t="kenny Can&apos;t backfill data after it has left in-memory storage 😞"><y>#</y><d>2020-10-01</d><h>15:05</h><r>kenny</r>Can&apos;t backfill data after it has left in-memory storage <b>😞</b></z><z id="t1601564755" t="kenny We use InfluxDB extensively and it&apos;s wicked fast. Curious about the performance of Timestream."><y>#</y><d>2020-10-01</d><h>15:05</h><r>kenny</r>We use InfluxDB extensively and it&apos;s wicked fast. Curious about the performance of Timestream.</z><z id="t1601625197" t="viesti yeah, was thinking about backfilling too, narrows the use case a bit"><y>#</y><d>2020-10-02</d><h>07:53</h><r>viesti</r>yeah, was thinking about backfilling too, narrows the use case a bit</z><z id="t1601625254" t="viesti though I guess from point of view of AWS, it makes sense to set operational limits like that (ban ingestion of timestamps from future, ban ingestion of data beyond retention)"><y>#</y><d>2020-10-02</d><h>07:54</h><r>viesti</r>though I guess from point of view of AWS, it makes sense to set operational limits like that (ban ingestion of timestamps from future, ban ingestion of data beyond retention)</z><z id="t1601564936" t="lukasz wow, it&apos;s been a long time coming"><y>#</y><d>2020-10-01</d><h>15:08</h><w>lukasz</w>wow, it&apos;s been a long time coming</z><z id="t1601625324" t="viesti yeah, have been waiting for it, following alongside TimescaleDB RDS thread: https://github.com/timescale/timescaledb/issues/65"><y>#</y><d>2020-10-02</d><h>07:55</h><w>viesti</w>yeah, have been waiting for it, following alongside TimescaleDB RDS thread: <a href="https://github.com/timescale/timescaledb/issues/65" target="_blank">https://github.com/timescale/timescaledb/issues/65</a></z><z id="t1601625450" t="viesti also, Grafana plugin was released at the same time: https://grafana.com/grafana/plugins/grafana-timestream-datasource/installation"><y>#</y><d>2020-10-02</d><h>07:57</h><w>viesti</w>also, Grafana plugin was released at the same time: <a href="https://grafana.com/grafana/plugins/grafana-timestream-datasource/installation" target="_blank">https://grafana.com/grafana/plugins/grafana-timestream-datasource/installation</a></z><z id="t1601651754" t="lukasz Definitely gonna play with it, if it&apos;s cost effective we might migrate our 60GB postgres db to it"><y>#</y><d>2020-10-02</d><h>15:15</h><w>lukasz</w>Definitely gonna play with it, if it&apos;s cost effective we might migrate our 60GB postgres db to it</z><z id="t1601720176" t="viesti I wonder how one initializes a dump of old database into it, maybe just via the normal ingestion api?"><y>#</y><d>2020-10-03</d><h>10:16</h><w>viesti</w>I wonder how one initializes a dump of old database into it, maybe just via the normal ingestion api?</z><z id="t1601756455" t="lukasz or the usual &quot;point it at s3&quot;"><y>#</y><d>2020-10-03</d><h>20:20</h><w>lukasz</w>or the usual &quot;point it at s3&quot;</z><z id="t1602250100" t="souenzzo [thread] I needed to make aws/invoke work offline to work on our CI"><y>#</y><d>2020-10-09</d><h>13:28</h><w>souenzzo</w>[thread] I needed to make aws/invoke work offline to work on our CI</z><z id="t1602250113" t="souenzzo (let [s3 (aws/client {:api :s3}) reqs (atom []) info (aws.client/-get-info s3) s3 (reify clojure.lang.IDeref (deref [this] @reqs) aws.client/ClientSPI (-get-info [this] (assoc info :http-client (reify aws.http/HttpClient (-submit [this request channel] (swap! reqs conj request) (async/put! channel {:status 200, :headers {&quot;x-amz-version-id&quot; &quot;null&quot; &quot;content-type&quot; &quot;application/octet-stream&quot; &quot;content-length&quot; &quot;5&quot; &quot;accept-ranges&quot; &quot;bytes&quot; &quot;etag&quot; &quot;\&quot;55b84a9d317184fe61224bfb4a060fb0\&quot;&quot; &quot;last-modified&quot; &quot;Thu, 08 Oct 2020 12:32:20 GMT&quot;} :body (ByteBuffer/wrap (.getBytes &quot;1,2,3&quot;))}))))))] (is (= &quot;1,2,3&quot; (slurp (:Body (aws/invoke s3 {:op :GetObject :request {:Bucket &quot;1&quot; :Key &quot;2&quot;}}))))) (is (= 1 (count @s3))))"><y>#</y><d>2020-10-09</d><h>13:28</h><r>souenzzo</r><pre>(let [s3 (aws/client {:api :s3})
      reqs (atom [])
      info (aws.client/-get-info s3)
      s3 (reify
           clojure.lang.IDeref
           (deref [this]
             @reqs)
           aws.client/ClientSPI
           (-get-info [this]
             (assoc info
               :http-client (reify aws.http/HttpClient
                              (-submit [this request channel]
                                (swap! reqs conj request)
                                (async/put! channel
                                            {:status  200,
                                             :headers {&quot;x-amz-version-id&quot; &quot;null&quot;
                                                       &quot;content-type&quot;     &quot;application/octet-stream&quot;
                                                       &quot;content-length&quot;   &quot;5&quot;
                                                       &quot;accept-ranges&quot;    &quot;bytes&quot;
                                                       &quot;etag&quot;             &quot;\&quot;55b84a9d317184fe61224bfb4a060fb0\&quot;&quot;
                                                       &quot;last-modified&quot;    &quot;Thu, 08 Oct 2020 12:32:20 GMT&quot;}
                                             :body    (ByteBuffer/wrap (.getBytes &quot;1,2,3&quot;))}))))))]
  (is (= &quot;1,2,3&quot;
         (slurp (:Body (aws/invoke s3 {:op      :GetObject
                                       :request {:Bucket &quot;1&quot;
                                                 :Key    &quot;2&quot;}})))))
  (is (= 1 (count @s3))))</pre></z><z id="t1602742447" t="orestis Any good/bad experiences with AWS elasticsearch? The managed offering, I mean. "><y>#</y><d>2020-10-15</d><h>06:14</h><w>orestis</w>Any good/bad experiences with AWS elasticsearch? The managed offering, I mean. </z><z id="t1602770019" t="lukasz [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] the price 👎 but it&apos;s pretty hands off once it&apos;s all working - 0-downtime cluster migrations is something worth paying money for. What is your use case for using ES?"><y>#</y><d>2020-10-15</d><h>13:53</h><w>lukasz</w><a>@orestis</a> the price <b>👎</b> but it&apos;s pretty hands off once it&apos;s all working - 0-downtime cluster migrations is something worth paying money for. What is your use case for using ES?</z><z id="t1602770450" t="orestis Full text search as a secondary index. Could probably live with 1 node or perhaps 2 nodes for HA at some point."><y>#</y><d>2020-10-15</d><h>14:00</h><w>orestis</w>Full text search as a secondary index. Could probably live with 1 node or perhaps 2 nodes for HA at some point.</z><z id="t1602772082" t="lukasz [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I&apos;ll stop you right there :-) You absolutely have to run your ES cluster with min 3 nodes in AWS. single node clusters cannot survive node restarts/replacements - and AWS can trigger those at any point in time. It broke our staging environment in the early days and response I got from support was &quot;you have to run 3 nodes, otherwise we will break it again&quot;. To be honest: I wouldn&apos;t run a single node ES for anything than local development or simple testing, it&apos;s just too fragile otherwise. Other than that, I&apos;m pretty ok with how things work in AWS but with caveats: best to deploy your cluster within the VPC and not allow any traffic from the public internet, instead relying on security groups and VPC subnets to allow access from your applications. That also means if you want to access Kibana you will have to jump through some hoops (hosts). We use ES as the full text and faceted search as well as basic analytics backend in our product, and it&apos;s fine but again, that price 😢"><y>#</y><d>2020-10-15</d><h>14:28</h><w>lukasz</w><a>@orestis</a> I&apos;ll stop you right there :-) You absolutely have to run your ES cluster with min 3 nodes in AWS. single node clusters cannot survive node restarts/replacements - and AWS can trigger those at any point in time. It broke our staging environment in the early days and response I got from support was &quot;you have to run 3 nodes, otherwise we will break it again&quot;. To be honest: I wouldn&apos;t run a single node ES for anything than local development or simple testing, it&apos;s just too fragile otherwise.

Other than that, I&apos;m pretty ok with how things work in AWS but with caveats: best to deploy your cluster within the VPC and not allow any traffic from the public internet, instead relying on security groups and VPC subnets to allow access from your applications. That also means if you want to access Kibana you will have to jump through some hoops (hosts).

We use ES as the full text and faceted search as well as  basic analytics backend  in our product, and it&apos;s fine but again, that price <b>😢</b></z><z id="t1602772175" t="orestis Oh. Three t3.mediums it is :)"><y>#</y><d>2020-10-15</d><h>14:29</h><w>orestis</w>Oh. Three t3.mediums it is :)</z><z id="t1602773644" t="mccraigmccraig if you already have k8s around then the official ES operator makes an easy alternative to the AWS managed service - https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-quickstart.html"><y>#</y><d>2020-10-15</d><h>14:54</h><w>mccraigmccraig</w>if you already have k8s around then the official ES operator makes an easy alternative to the AWS managed service - <a href="https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-quickstart.html" target="_blank">https://www.elastic.co/guide/en/cloud-on-k8s/current/k8s-quickstart.html</a></z><z id="t1602797016" t="mruzekw How would I compare the price of doing this vs the managed version? I’m guessing it would mainly depend on the number of live ES containers at anytime, but is there anything else I should consider?"><y>#</y><d>2020-10-15</d><h>21:23</h><r>mruzekw</r>How would I compare the price of doing this vs the managed version? I’m guessing it would mainly depend on the number of live ES containers at anytime, but is there anything else I should consider?</z><z id="t1602831254" t="mccraigmccraig running on k8s you avoid whatever premium aws are charging over baseline ec2 for their ES service, which seems to be about 50% looking at m5.larges"><y>#</y><d>2020-10-16</d><h>06:54</h><r>mccraigmccraig</r>running on k8s you avoid whatever premium aws are charging over baseline ec2 for their ES service, which seems to be about 50% looking at m5.larges</z><z id="t1602876060" t="mruzekw Wow, that sounds worth looking into! Thanks"><y>#</y><d>2020-10-16</d><h>19:21</h><r>mruzekw</r>Wow, that sounds worth looking into! Thanks</z><z id="t1602884541" t="mccraigmccraig it&apos;s well worth it if you are already running k8s - but if you aren&apos;t then maybe it&apos;s not something which alone would make it worthwhile to go to the effort of implementing k8s"><y>#</y><d>2020-10-16</d><h>21:42</h><r>mccraigmccraig</r>it&apos;s well worth it if you are already running k8s - but if you aren&apos;t then maybe it&apos;s not something which alone would make it worthwhile to go to the effort of implementing k8s</z><z id="t1602782484" t="orestis [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] https://aws.amazon.com/blogs/database/reducing-cost-for-small-amazon-elasticsearch-service-domains/ — no mention there about single instance nodes breaking every now and then, hm. I’ll reach out to support to clarify. "><y>#</y><d>2020-10-15</d><h>17:21</h><w>orestis</w><a>@lukaszkorecki</a> <a href="https://aws.amazon.com/blogs/database/reducing-cost-for-small-amazon-elasticsearch-service-domains/" target="_blank">https://aws.amazon.com/blogs/database/reducing-cost-for-small-amazon-elasticsearch-service-domains/</a> — no mention there about single instance nodes breaking every now and then, hm. I’ll reach out to support to clarify. </z><z id="t1602782576" t="lukasz [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] admittedly it was a while ago and we were on ancient ES (1.7? 2.0?) but still, having run clusters by hand I just don&apos;t trust a single node anyway"><y>#</y><d>2020-10-15</d><h>17:22</h><w>lukasz</w><a>@orestis</a> admittedly it was a while ago and we were on ancient ES (1.7? 2.0?) but still, having run clusters by hand I just don&apos;t trust a single node anyway</z><z id="t1602782994" t="orestis It’s just such a shame that full text search is such a headache, even for very small datasets. We are currently running an in-process solr server which is more than enough but has its own set of drawbacks. "><y>#</y><d>2020-10-15</d><h>17:29</h><w>orestis</w>It’s just such a shame that full text search is such a headache, even for very small datasets. We are currently running an in-process solr server which is more than enough but has its own set of drawbacks. </z><z id="t1602783903" t="lukasz what about full text capabilities in your primary data store?"><y>#</y><d>2020-10-15</d><h>17:45</h><w>lukasz</w>what about full text capabilities in your primary data store?</z><z id="t1602783926" t="lukasz Postgres apparently can take you pretty far, of course it&apos;s not a dedicated search engine but it is capable"><y>#</y><d>2020-10-15</d><h>17:45</h><w>lukasz</w>Postgres apparently can take you pretty far, of course it&apos;s not a dedicated search engine but it is capable</z><z id="t1602786173" t="orestis I looked into that but we also want “more like this”, tf/df and better text analysis than what Postgres fts provides. Lucene is way too low level to get decent results without a huge effort. "><y>#</y><d>2020-10-15</d><h>18:22</h><w>orestis</w>I looked into that but we also want “more like this”, tf/df and better text analysis than what Postgres fts provides. Lucene is way too low level to get decent results without a huge effort. </z><z id="t1602788070" t="lukasz Yeah, we&apos;re in the same boat - ES has served us well, and given our setup and data set size, it&apos;s not that painful to use - and AWS&apos; managed service takes away a lot of the pain."><y>#</y><d>2020-10-15</d><h>18:54</h><w>lukasz</w>Yeah, we&apos;re in the same boat - ES has served us well, and given our setup and data set size, it&apos;s not that painful to use - and AWS&apos; managed service takes away a lot of the pain.</z><z id="t1602788136" t="valtteri I’ve been running single node ES in prod for a few years without issues. It’s a small project though and no-one would die if it crashed for a while."><y>#</y><d>2020-10-15</d><h>18:55</h><w>valtteri</w>I’ve been running single node ES in prod for a few years without issues. It’s a small project though and no-one would die if it crashed for a while.</z><z id="t1602788678" t="lukasz Yeah, not an option for us :-("><y>#</y><d>2020-10-15</d><h>19:04</h><w>lukasz</w>Yeah, not an option for us :-(</z><z id="t1602788695" t="lukasz (dying is not involved, but customers love to search)"><y>#</y><d>2020-10-15</d><h>19:04</h><w>lukasz</w>(dying is not involved, but customers love to search)</z><z id="t1602788918" t="valtteri Yep, for a popular service I’d go HA also. "><y>#</y><d>2020-10-15</d><h>19:08</h><w>valtteri</w>Yep, for a popular service I’d go HA also. </z><z id="t1603812536" t="Gleb Posobin What&apos;s HA?"><y>#</y><d>2020-10-27</d><h>15:28</h><r>Gleb Posobin</r>What&apos;s HA?</z><z id="t1603814862" t="valtteri High availability "><y>#</y><d>2020-10-27</d><h>16:07</h><r>valtteri</r>High availability </z><z id="t1602789243" t="valtteri How about running this in Lambda + EFS? https://github.com/valeriansaliou/sonic"><y>#</y><d>2020-10-15</d><h>19:14</h><w>valtteri</w>How about running this in Lambda + EFS? <a href="https://github.com/valeriansaliou/sonic" target="_blank">https://github.com/valeriansaliou/sonic</a></z><z id="t1602789382" t="valtteri Dunno if it would even work but somebody had this type of idea in #off-topic some time ago"><y>#</y><d>2020-10-15</d><h>19:16</h><w>valtteri</w>Dunno if it would even work but somebody had this type of idea in #off-topic some time ago</z><z id="t1602796095" t="lukasz Interesting. For a small project it could be worth a try, but ES is so battle tested, and original question was about the managed AWS service :-)"><y>#</y><d>2020-10-15</d><h>21:08</h><w>lukasz</w>Interesting. For a small project it could be worth a try, but ES is so battle tested, and original question was about the managed AWS service :-)</z><z id="t1603092249" t="orestis Follow up on my ES questions: It turns out that when using AWS-hosted ES, you have the ability to use IAM RBAC, so you need to sign outgoing http requests. Now, Cognitect’s aws-api provides a credential provider: credentials-provider which I can use call fetch on and it will give me the needed credentials. I found https://github.com/zarkone/aws-sig4 which seems to be providing both the building blocks and a clj-http middleware, but I’d prefer if I could reuse the cognitect aws-api for that too and provide my own wrapper for clj-http. It seems to be a common request for other reasons: https://github.com/cognitect-labs/aws-api/issues/5 — so, (deep breath) — any news or input on that?"><y>#</y><d>2020-10-19</d><h>07:24</h><w>orestis</w>Follow up on my ES questions: It turns out that when using AWS-hosted ES, you have the ability to use IAM RBAC, so you need to sign outgoing http requests. Now, Cognitect’s aws-api provides a credential provider: <code>credentials-provider</code> which I can use call <code>fetch</code> on and it will give me the needed credentials. I found <a href="https://github.com/zarkone/aws-sig4" target="_blank">https://github.com/zarkone/aws-sig4</a> which seems to be providing both the building blocks and a clj-http middleware, but I’d prefer if I could reuse the cognitect aws-api for that too and provide my own wrapper for clj-http. It seems to be a common request for other reasons: <a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a> — so, (deep breath) — any news or input on that?</z><z id="t1603108715" t="viesti interesting, wasn&apos;t aware of that fork from org.sharetribe/aws-sig4 (which I&apos;ve used before and has worked well)"><y>#</y><d>2020-10-19</d><h>11:58</h><w>viesti</w>interesting, wasn&apos;t aware of that fork from org.sharetribe/aws-sig4 (which I&apos;ve used before and has worked well)</z><z id="t1603120386" t="lukasz [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I tried to make it work but gave up :-) instead we run the ES cluster in a special subnet with no ingress/egress outside of the VPC + security group rules"><y>#</y><d>2020-10-19</d><h>15:13</h><w>lukasz</w><a>@orestis</a> I tried to make it work but gave up :-) instead we run the ES cluster in a special subnet with no ingress/egress outside of the VPC + security group rules</z><z id="t1603129364" t="orestis It’s my fallback :) but at least I would like some username and password going on :)"><y>#</y><d>2020-10-19</d><h>17:42</h><r>orestis</r>It’s my fallback :) but at least I would like some username and password going on :)</z><z id="t1603738138" t="Drew Verlee Would it help to either add a blog post or extend the fulcro docs to include some of the ideas i learned deploying fulcro with datomic cloud leaning on AWS. A word cloud might include: s3, amplify, gitops, CI. Has anyone see a resource/experience report i should reference before i jump in?"><y>#</y><d>2020-10-26</d><h>18:48</h><w>Drew Verlee</w>Would it help to either add a blog post or extend the fulcro docs to include some of the ideas i learned deploying fulcro with datomic cloud leaning on AWS. A word cloud might include: s3, amplify, gitops, CI. Has anyone see a resource/experience report i should reference before i jump in?</z><z id="t1603811866" t="viesti at least I haven&apos;t seen, sounds interesting 🙂"><y>#</y><d>2020-10-27</d><h>15:17</h><w>viesti</w>at least I haven&apos;t seen, sounds interesting <b>🙂</b></z><z id="t1604037126" t="onetom has anyone tried the AWS SSO system? im trying to use it with https://github.com/cognitect-labs/aws-api but i don&apos;t see a credentials provider which would support SSO. it does give access to the SSO AWS API though, so i can try to put a signin flow together with that..."><y>#</y><d>2020-10-30</d><h>05:52</h><w>onetom</w>has anyone tried the AWS SSO system?

im trying to use it with <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a> but i don&apos;t see a credentials provider which would support SSO.
it does give access to the SSO AWS API though, so i can try to put a signin flow together with that...</z><z id="t1604037328" t="onetom i tried our AWS SSO setup and it works with the new AWS CLI 2: https://aws.amazon.com/blogs/developer/aws-cli-v2-is-now-generally-available/ but what it puts into ~/.aws/config is not understood by cognitect.aws.client.api 😞 it looks something like this: [&lt;some profile name&gt;] sso_start_url = https://&lt;org-name&gt;. sso_region = ap-southeast-1 sso_account_id = 179999999999 sso_role_name = AdministratorAccess # sso_role_name = PowerUserAccess region = ap-southeast-1"><y>#</y><d>2020-10-30</d><h>05:55</h><w>onetom</w>i tried our AWS SSO setup and it works with the new AWS CLI 2:
<a href="https://aws.amazon.com/blogs/developer/aws-cli-v2-is-now-generally-available/" target="_blank">https://aws.amazon.com/blogs/developer/aws-cli-v2-is-now-generally-available/</a>
but what it puts into <code>~/.aws/config</code> is not understood by <code>cognitect.aws.client.api</code> <b>😞</b>
it looks something like this:
<pre>[&lt;some profile name&gt;]
sso_start_url = https://&lt;org-name&gt;.
sso_region = ap-southeast-1
sso_account_id = 179999999999
sso_role_name = AdministratorAccess
# sso_role_name = PowerUserAccess
region = ap-southeast-1</pre></z><z id="t1604066386" t="rutledgepaulv I think the credential support in aws-api is sort of minimal in an attempt to keep the core lightweight and not require other aws-api services to implement auth. I needed to extend the profile provider to support assume role sts tokens, for example. https://github.com/RutledgePaulV/aws-api-credential-providers/blob/master/src/aws_api_credential_providers/core.clj"><y>#</y><d>2020-10-30</d><h>13:59</h><r>rutledgepaulv</r>I think the credential support in aws-api is sort of minimal in an attempt to keep the core lightweight and not require other aws-api services to implement auth. I needed to extend the profile provider to support assume role sts tokens, for example. <a href="https://github.com/RutledgePaulV/aws-api-credential-providers/blob/master/src/aws_api_credential_providers/core.clj" target="_blank">https://github.com/RutledgePaulV/aws-api-credential-providers/blob/master/src/aws_api_credential_providers/core.clj</a></z><z id="t1604037346" t="onetom is there a better channel where i can ask such questions?"><y>#</y><d>2020-10-30</d><h>05:55</h><w>onetom</w>is there a better channel where i can ask  such questions?</z><z id="t1604074887" t="lukasz [:attrs {:href &quot;/_/_/users/U086D6TBN&quot;}] (I&apos;ll be going deep into this in a week or two but I did some research already). Atm most AWS SDK&apos;s do not support obtaining credentials via SSO - that includes Java and Go SDK (the latter is rather infuriating because I work a lot with terraform). The workaround is to use a small Python script, which does some munging of credentials obtained via cli v2 and can inject them to your shell environment. https://github.com/linaro-its/aws2-wrap can work for you or you might need to tweak it a bit (like we did)"><y>#</y><d>2020-10-30</d><h>16:21</h><w>lukasz</w><a>@onetom</a> (I&apos;ll be going deep into this in a week or two but I did some research already). Atm most AWS SDK&apos;s do not support obtaining credentials via SSO - that includes Java and Go SDK (the latter is rather infuriating because I work a lot with terraform). The workaround is to use a small Python script, which does some munging of credentials obtained via cli v2 and can inject them to your  shell environment. <a href="https://github.com/linaro-its/aws2-wrap" target="_blank">https://github.com/linaro-its/aws2-wrap</a> can work for you or you might need to tweak it a bit (like we did)</z><z id="t1604657991" t="dazld I&apos;m wondering about using cognitect&apos;s AWS library for defining and deploying cloudformation stacks (ALB, lambdas, S3, cloudfront etc..) - do any of you do this, and how did you find it?"><y>#</y><d>2020-11-06</d><h>10:19</h><w>dazld</w>I&apos;m wondering about using cognitect&apos;s AWS library for defining and deploying cloudformation stacks (ALB, lambdas, S3, cloudfront etc..) - do any of you do this, and how did you find it?</z><z id="t1604717266" t="steveb8n Try CDK instead. I use typescript for this, even though my app is all clojure"><y>#</y><d>2020-11-07</d><h>02:47</h><r>steveb8n</r>Try CDK instead. I use typescript for this, even though my app is all clojure</z><z id="t1604775146" t="dazld Thanks, will look into it"><y>#</y><d>2020-11-07</d><h>18:52</h><r>dazld</r>Thanks, will look into it</z><z id="t1605318022" t="jjttjj I have ec2 classic enabled on aws because my account is old. For the first time, I&apos;m trying to make an instance of a type not allowed with ec2 classic. So apparently this involves making a VPC/subnet/gateway/routes/security group manually in order to get a basic server running that I can ssh into remotely. Apparently on non-ec2-classic accounts, there is a default VPC. Does anyone know if this makes it easier to get the ssh&apos;able server I want? Is that default VPC configured for public access by default, or are there fewer steps you need to do than the ec2-classic account? Based on these docs, ( https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html ), I believe that is the case, that it is much easier to get an ssh server running with a default VPC, but I&apos;m not 100% sure I&apos;m reading it right. Is there a way to &quot;disable&quot; ec2 classic on an account if I want to enable this default vpc?"><y>#</y><d>2020-11-14</d><h>01:40</h><w>jjttjj</w>I have ec2 classic enabled on aws because my account is old. For the first time, I&apos;m trying to make an instance of a type not allowed with ec2 classic. So apparently this involves making a VPC/subnet/gateway/routes/security group manually in order to get a basic server running that I can ssh into remotely.
Apparently on non-ec2-classic accounts, there is a default VPC. Does anyone know if this makes it easier to get the ssh&apos;able server I want? Is that default VPC configured for public access by default, or are there fewer steps you need to do than the ec2-classic account?
Based on these docs,  (<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-classic-platform.html</a>), I believe that is the case, that it is much easier to get an ssh server running with a default VPC, but I&apos;m not 100% sure I&apos;m reading it right.
Is there a way to &quot;disable&quot; ec2 classic on an account if I want to enable this default vpc?</z><z id="t1605365225" t="viesti the default VPC has subnets that have a route to internet gateway and by default, instances placed into the subnets in the default VPC, get a public IP address"><y>#</y><d>2020-11-14</d><h>14:47</h><w>viesti</w>the default VPC has subnets that have a route to internet gateway and by default, instances placed into the subnets in the default VPC, get a public IP address</z><z id="t1605365254" t="viesti you can disable assignment of a public IP address, but if I recall correctly, it is on by default"><y>#</y><d>2020-11-14</d><h>14:47</h><w>viesti</w>you can disable assignment of a public IP address, but if I recall correctly, it is on by default</z><z id="t1605365302" t="viesti so you can get a publicly reachable instance easily running in the default VPC"><y>#</y><d>2020-11-14</d><h>14:48</h><w>viesti</w>so you can get a publicly reachable instance easily running in the default VPC</z><z id="t1605367794" t="jjttjj Thanks! Good to know. It looks like it is possible to convert my account to use the default VPC for a region that&apos;s currently on ec2 classic if I get rid of all ec2-classic resources in that region (or just use a different region)."><y>#</y><d>2020-11-14</d><h>15:29</h><w>jjttjj</w>Thanks! Good to know. It looks like it is possible to convert my account to use the default VPC for a region that&apos;s currently on ec2 classic if I get rid of all ec2-classic resources in that region (or just use a different region).</z><z id="t1605367832" t="jjttjj Alternatively it looks like there are some cloud formation templates that I could also use to do essentially the same thing"><y>#</y><d>2020-11-14</d><h>15:30</h><w>jjttjj</w>Alternatively it looks like there are some cloud formation templates that I could also use to do essentially the same thing</z><z id="t1605618285" t="AJ Jaro Using https://github.com/mcohen01/amazonica I’ve tried adjusting the client config using code like below but it doesn’t seem to affect the results. I continue to receive a SocketTimeoutException after 200 seconds. Has anyone successfully configured the timeout? (lambda/invoke {:client-config {:connection-timeout 500000}} :function-name &quot;lambda-fn&quot; :log-type &quot;Tail&quot; :payload payload)"><y>#</y><d>2020-11-17</d><h>13:04</h><w>AJ Jaro</w>Using <a href="https://github.com/mcohen01/amazonica" target="_blank">https://github.com/mcohen01/amazonica</a> I’ve tried adjusting the client config using code like below but it doesn’t seem to affect the results. I continue to receive a SocketTimeoutException after 200 seconds.

Has anyone successfully configured the timeout?

<pre>(lambda/invoke {:client-config
                    {:connection-timeout 500000}}
                   :function-name &quot;lambda-fn&quot;
                   :log-type &quot;Tail&quot;
                   :payload payload)</pre></z><z id="t1605619645" t="AJ Jaro SOLVED: I was using the incorrect timeout arg, it should’ve been… :socket-timeout ugh"><y>#</y><d>2020-11-17</d><h>13:27</h><r>AJ Jaro</r>SOLVED: I was using the incorrect timeout arg, it should’ve been…
<pre>:socket-timeout</pre>
ugh</z><z id="t1605738455" t="zackteo Hello, I am trying to automate the creation of a spark and HDFS cluster with EC2. Am thinking of using Amazonica. Is there any resources that might help to guide me with this?"><y>#</y><d>2020-11-18</d><h>22:27</h><w>zackteo</w>Hello, I am trying to automate the creation of a spark and HDFS cluster with EC2. Am thinking of using Amazonica. Is there any resources that might help to guide me with this?</z><z id="t1605763975" t="zackteo I understand one usually types their bash script in User data but I can&apos;t seem to find a Clojure library that allows me to do this? Not sure if this is how to do automate the spinning up of a EC2 cluster"><y>#</y><d>2020-11-19</d><h>05:32</h><w>zackteo</w>I understand one usually types their bash script in <code>User data</code> but I can&apos;t seem to find a Clojure library that allows me to do this? Not sure if this is how to do automate the spinning up of a EC2 cluster</z><z id="t1605764673" t="zackteo Am not allowed to use managed services such as EMR, RDS, Kubernetes (it is a school project)"><y>#</y><d>2020-11-19</d><h>05:44</h><w>zackteo</w>Am not allowed to use managed services such as EMR, RDS, Kubernetes (it is a school project)</z><z id="t1605765629" t="zackteo I understand this exists https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html but automatically do this instead of having to go through the process via a website?"><y>#</y><d>2020-11-19</d><h>06:00</h><w>zackteo</w>I understand this exists <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html</a> but automatically do this instead of having to go through the process via a website?</z><z id="t1605768287" t="valtteri [:attrs {:href &quot;/_/_/users/UUSQHP535&quot;}] did you check this recipe from Spark docs already? https://spark.apache.org/docs/1.6.2/ec2-scripts.html"><y>#</y><d>2020-11-19</d><h>06:44</h><w>valtteri</w><a>@zackteo</a> did you check this recipe from Spark docs already? <a href="https://spark.apache.org/docs/1.6.2/ec2-scripts.html" target="_blank">https://spark.apache.org/docs/1.6.2/ec2-scripts.html</a></z><z id="t1605769524" t="zackteo [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] I actually don&apos;t understand how this works. Is this a preconfigured OS image?"><y>#</y><d>2020-11-19</d><h>07:05</h><w>zackteo</w><a>@valtteri</a> I actually don&apos;t understand how this works. Is this a preconfigured OS image?</z><z id="t1605769588" t="zackteo ohhh I&apos;m not sure if i can expect spark to be locally installed - if this is what it requires"><y>#</y><d>2020-11-19</d><h>07:06</h><w>zackteo</w>ohhh I&apos;m not sure if i can expect spark to be locally installed - if this is what it requires</z><z id="t1605770350" t="valtteri It&apos;s a script that you run locally with your AWS credentials and it will spin up the EC2 cluster for you."><y>#</y><d>2020-11-19</d><h>07:19</h><w>valtteri</w>It&apos;s a script that you run locally with your AWS credentials and it will spin up the EC2 cluster for you.</z><z id="t1605770391" t="zackteo Where is this Spark’s ec2 directory suppose to be located"><y>#</y><d>2020-11-19</d><h>07:19</h><w>zackteo</w>Where is this Spark’s <code>ec2</code> directory suppose to be located</z><z id="t1605770422" t="valtteri Probably inside the Spark distribution"><y>#</y><d>2020-11-19</d><h>07:20</h><w>valtteri</w>Probably inside the Spark distribution</z><z id="t1605770497" t="valtteri I&apos;ve never used it myself but I&apos;d guess that does all the steps you need to achieve. 🙂"><y>#</y><d>2020-11-19</d><h>07:21</h><w>valtteri</w>I&apos;ve never used it myself but I&apos;d guess that does all the steps you need to achieve. <b>🙂</b></z><z id="t1605770601" t="zackteo Thanks [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] 🙂 Let me look into it - I&apos;m not sure if I am allowed to do it this way"><y>#</y><d>2020-11-19</d><h>07:23</h><w>zackteo</w>Thanks <a>@valtteri</a> <b>🙂</b> Let me look into it - I&apos;m not sure if I am allowed to do it this way</z><z id="t1605770682" t="valtteri Ahh, if the goal is to learn how to set it up from scratch manually then that might be too automated. 😄 However, you can check clues from the script what kind of things are involved and try to reproduce them using Amazonica or whatever"><y>#</y><d>2020-11-19</d><h>07:24</h><w>valtteri</w>Ahh, if the goal is to learn how to set it up from scratch manually then that might be too automated. <b>😄</b> However, you can check clues from the script what kind of things are involved and try to reproduce them using Amazonica or whatever</z><z id="t1605770727" t="valtteri I guess there are many steps involved (firing up the instances, installing the libs, setting up networking, security groups, autoscaling etc..)"><y>#</y><d>2020-11-19</d><h>07:25</h><w>valtteri</w>I guess there are many steps involved (firing up the instances, installing the libs, setting up networking, security groups, autoscaling etc..)</z><z id="t1605771335" t="zackteo I guess my issue is that I understand how I might want to use Amazonica to initialise the instance. But how do I access that instance in an automated way to run script to just install dependencies etc"><y>#</y><d>2020-11-19</d><h>07:35</h><w>zackteo</w>I guess my issue is that I understand how I might want to use Amazonica to initialise the instance. But how do I access that instance in an automated way to run script to just install dependencies etc</z><z id="t1605771668" t="valtteri Yeah, Amazonica just delegates stuff to the AWS Java SDK afaik.. So you need to check how that&apos;s done on Java side and then figure out how to tell Amazonica to do that. You can provide the &apos;user data script&apos; with the runInstances request if I remember correctly."><y>#</y><d>2020-11-19</d><h>07:41</h><w>valtteri</w>Yeah, Amazonica just delegates stuff to the AWS Java SDK afaik.. So you need to check how that&apos;s done on Java side and then figure out how to tell Amazonica to do that. You can provide the &apos;user data script&apos; with the <code>runInstances</code> request if I remember correctly.</z><z id="t1605771693" t="valtteri It&apos;s been a while since I&apos;ve been bootstrapping EC2-instances.."><y>#</y><d>2020-11-19</d><h>07:41</h><w>valtteri</w>It&apos;s been a while since I&apos;ve been bootstrapping EC2-instances..</z><z id="t1605771836" t="valtteri Perhaps you can shortcut by setting up one of the instances manually and then saving it as a machine image (AMI) and then just telling Amazonica to launch an instance that uses that AMI"><y>#</y><d>2020-11-19</d><h>07:43</h><w>valtteri</w>Perhaps you can shortcut by setting up one of the instances manually and then saving it as a machine image (AMI) and then just telling Amazonica to launch an instance that uses that AMI</z><z id="t1605771868" t="zackteo unfortunately we need to start off from a base ami :x"><y>#</y><d>2020-11-19</d><h>07:44</h><w>zackteo</w>unfortunately we need to start off from a base ami :x</z><z id="t1605771936" t="valtteri aws ec2 run-instances --image-id ami-abcd1234 --count 1 --instance-type m3.medium \ --key-name my-key-pair --subnet-id subnet-abcd1234 --security-group-ids sg-abcd1234 \ --user-data "><y>#</y><d>2020-11-19</d><h>07:45</h><w>valtteri</w><pre>aws ec2 run-instances --image-id ami-abcd1234 --count 1 --instance-type m3.medium \
--key-name my-key-pair --subnet-id subnet-abcd1234 --security-group-ids sg-abcd1234 \
--user-data </pre></z><z id="t1605771950" t="valtteri user-data script will be run when the instance launches"><y>#</y><d>2020-11-19</d><h>07:45</h><w>valtteri</w><code>user-data</code>  script will be run when the instance launches</z><z id="t1605771974" t="zackteo Think they expect us to use boto3 from python but that&apos;s also just the aws sdk"><y>#</y><d>2020-11-19</d><h>07:46</h><w>zackteo</w>Think they expect us to use <code>boto3</code> from python but that&apos;s also just the aws sdk</z><z id="t1605771979" t="zackteo That&apos;s bash right?"><y>#</y><d>2020-11-19</d><h>07:46</h><w>zackteo</w>That&apos;s bash right?</z><z id="t1605771983" t="valtteri Yes"><y>#</y><d>2020-11-19</d><h>07:46</h><w>valtteri</w>Yes</z><z id="t1605772013" t="valtteri https://github.com/coresoftwaregroup/boto-examples/blob/master/32-create-instance-enhanced-with-user-data.py"><y>#</y><d>2020-11-19</d><h>07:46</h><w>valtteri</w><a href="https://github.com/coresoftwaregroup/boto-examples/blob/master/32-create-instance-enhanced-with-user-data.py" target="_blank">https://github.com/coresoftwaregroup/boto-examples/blob/master/32-create-instance-enhanced-with-user-data.py</a></z><z id="t1605772014" t="zackteo Was trying to find that in the aws sdk but maybe ill just have to use bash"><y>#</y><d>2020-11-19</d><h>07:46</h><w>zackteo</w>Was trying to find that in the aws sdk but maybe ill just have to use bash</z><z id="t1605772050" t="valtteri ☝️ there&apos;s how to do it with boto"><y>#</y><d>2020-11-19</d><h>07:47</h><w>valtteri</w><b>☝️</b> there&apos;s how to do it with boto</z><z id="t1605772055" t="zackteo ooo! Thanks 😄"><y>#</y><d>2020-11-19</d><h>07:47</h><w>zackteo</w>ooo! Thanks <b>😄</b></z><z id="t1605774552" t="zackteo I tried to find the equivalent on amazonica but to no avail - also considered using babashka with https://github.com/tzzh/pod-tzzh-aws but think it isn&apos;t worth the trouble &gt;&lt;. I&apos;m just gonna approach this with boto3 after all 😅 makes more sense to revisit the project and rewrite this part in Clojure if I am interested"><y>#</y><d>2020-11-19</d><h>08:29</h><w>zackteo</w>I tried to find the equivalent on amazonica but to no avail - also considered using babashka with <a href="https://github.com/tzzh/pod-tzzh-aws" target="_blank">https://github.com/tzzh/pod-tzzh-aws</a> but think it isn&apos;t worth the trouble &gt;&lt;. I&apos;m just gonna approach this with boto3 after all <b>😅</b> makes more sense to revisit the project and rewrite this part in Clojure if I am interested</z><z id="t1605781195" t="viesti I&apos;m thinking that it might be easier to do the setup with Terraform for example, is has great support for the AWS APIs and makes it easier to destroy resources after creation. There is some learning curve, but for a school project, one could use local state file store for example."><y>#</y><d>2020-11-19</d><h>10:19</h><w>viesti</w>I&apos;m thinking that it might be easier to do the setup with Terraform for example, is has great support for the AWS APIs and makes it easier to destroy resources after creation. There is some learning curve, but for a school project, one could use local state file store for example.</z><z id="t1605783486" t="viesti that said, I&apos;m too biased, since I like Terraform too much 🙂"><y>#</y><d>2020-11-19</d><h>10:58</h><w>viesti</w>that said, I&apos;m too biased, since I like Terraform too much <b>🙂</b></z><z id="t1605786568" t="borkdude [:attrs {:href &quot;/_/_/users/UUSQHP535&quot;}] Shelling out to the AWS cli is pretty common with babashka"><y>#</y><d>2020-11-19</d><h>11:49</h><w>borkdude</w><a>@zackteo</a> Shelling out to the AWS cli is pretty common with babashka</z><z id="t1605786666" t="zackteo @vlesti unfortunately am only allowed to use cloud formation at max ... would like to learn Terraform at some point!"><y>#</y><d>2020-11-19</d><h>11:51</h><w>zackteo</w>@vlesti unfortunately am only allowed to use cloud formation at max ... would like to learn Terraform at some point!</z><z id="t1605786840" t="zackteo [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] ohhh. Are there any AWS and/or spark examples? Though I think that I&apos;ll likely end up sticking to bash given my use case of mainly installing dependencies and doing hadoop and spark setup"><y>#</y><d>2020-11-19</d><h>11:54</h><w>zackteo</w><a>@borkdude</a> ohhh. Are there any AWS and/or spark examples?

Though I think that I&apos;ll likely end up sticking to bash given my use case of mainly installing dependencies and doing hadoop and spark setup</z><z id="t1605787101" t="borkdude [:attrs {:href &quot;/_/_/users/UUSQHP535&quot;}] For example: https://github.com/borkdude/babashka/issues/575#issuecomment-712460781 I think [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] might also be doing something like this."><y>#</y><d>2020-11-19</d><h>11:58</h><w>borkdude</w><a>@zackteo</a> For example: <a href="https://github.com/borkdude/babashka/issues/575#issuecomment-712460781" target="_blank">https://github.com/borkdude/babashka/issues/575#issuecomment-712460781</a>
I think <a>@lukaszkorecki</a> might also be doing something like this.</z><z id="t1605788927" t="zackteo okay!"><y>#</y><d>2020-11-19</d><h>12:28</h><w>zackteo</w>okay!</z><z id="t1605789145" t="zackteo Btw, could someone explain how I might cloud formation fit into all this? I will also need to create a web app that links to MongoDB and MySQL so probably separate servers for each. I understand that cloud formation just makes things more declarative?"><y>#</y><d>2020-11-19</d><h>12:32</h><w>zackteo</w>Btw, could someone explain how I might cloud formation fit into all this? I will also need to create a web app that links to MongoDB and MySQL so probably separate servers for each. I understand that cloud formation just makes things more declarative?</z><z id="t1605789482" t="valtteri Yes, CloudFormation is a JSON declaration of the AWS resources that you want to setup. It&apos;s pretty hard to grasp in the beginning, but I&apos;ve learned to like it a lot over the years."><y>#</y><d>2020-11-19</d><h>12:38</h><w>valtteri</w>Yes, CloudFormation is a JSON declaration of the AWS resources that you want to setup. It&apos;s pretty hard to grasp in the beginning, but I&apos;ve learned to like it a lot over the years.</z><z id="t1605791967" t="zackteo If I set it up with cloud formation. How do I insert the instance with scripts I it want executed :o is there also a user-data part in the declaration?"><y>#</y><d>2020-11-19</d><h>13:19</h><w>zackteo</w>If I set it up with cloud formation. How do I insert the instance with scripts I it want executed :o is there also a <code>user-data</code> part in the declaration?</z><z id="t1605791984" t="zackteo Or do I need to access the instances in another way?"><y>#</y><d>2020-11-19</d><h>13:19</h><w>zackteo</w>Or do I need to access the instances in another way?</z><z id="t1605797229" t="valtteri You embed the script into the cloudformation template JSON. Yes it&apos;s ugly. 😄"><y>#</y><d>2020-11-19</d><h>14:47</h><w>valtteri</w>You embed the script into the cloudformation template JSON. Yes it&apos;s ugly. <b>😄</b></z><z id="t1605797344" t="valtteri &quot;UserData&quot;: { &quot;Fn::Base64&quot;: { &quot;Fn::Join&quot;: [ &quot;&quot;, &quot;#!/bin/bash\n&quot;, &quot;echo &apos;doing stuff&apos;\n&quot; ] } }"><y>#</y><d>2020-11-19</d><h>14:49</h><r>valtteri</r><pre>&quot;UserData&quot;: { &quot;Fn::Base64&quot;: { &quot;Fn::Join&quot;: [ &quot;&quot;, 
  &quot;#!/bin/bash\n&quot;,
  &quot;echo &apos;doing stuff&apos;\n&quot;
] } }</pre></z><z id="t1605798191" t="lukasz [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] yes, that&apos;s my current approach."><y>#</y><d>2020-11-19</d><h>15:03</h><w>lukasz</w><a>@borkdude</a> yes, that&apos;s my current approach.</z><z id="t1605798238" t="lukasz FWIW I&apos;d recommend Terraform over cloudformation as it covers 99% of the usecases with much nicer syntax and better primitives. And yes, you can specify user-data scripts there. Or use Packer to pre-bake machine images"><y>#</y><d>2020-11-19</d><h>15:03</h><w>lukasz</w>FWIW I&apos;d recommend Terraform over cloudformation as it covers 99% of the usecases with much nicer syntax and better primitives. And yes, you can specify user-data scripts there. Or use Packer to pre-bake machine images</z><z id="t1605811594" t="markbastian When calling :GetExport with the cognitect aws api for apigateway I get the following response: {:logref &quot;4b35cdac-1783-4c1d-bdc2-ef84bc1fa68e&quot;, :message &quot;Unable to build exporter: null&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} Here is my invocation: (aws-api/invoke client {:op :GetExport :request {:restApiId api-id :stageName stage-name :exportType &quot;swagger&quot;}}) When I use the exact same arguments with boto3 it works, so I think the arguments are right. Anything seem wrong that I am missing?"><y>#</y><d>2020-11-19</d><h>18:46</h><w>markbastian</w>When calling :GetExport with the cognitect aws api for apigateway I get the following response:
<pre>{:logref &quot;4b35cdac-1783-4c1d-bdc2-ef84bc1fa68e&quot;,
 :message &quot;Unable to build exporter: null&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre>
Here is my invocation:
<pre>(aws-api/invoke
  client
  {:op      :GetExport
   :request {:restApiId  api-id
             :stageName  stage-name
             :exportType &quot;swagger&quot;}})</pre>
When I use the exact same arguments with boto3 it works, so I think the arguments are right. Anything seem wrong that I am missing?</z><z id="t1606067289" t="dchelimsky [:attrs {:href &quot;/_/_/users/U0JUR9FPH&quot;}] this will work: (aws-api/invoke client {:op :GetExport :request {:restApiId api-id :stageName stage-name :exportType &quot;swagger&quot; :accepts &quot;application/json&quot;}}) I posted an issue https://github.com/cognitect-labs/aws-api/issues/158 . Please keep the convo going there if you’re interested."><y>#</y><d>2020-11-22</d><h>17:48</h><r>dchelimsky</r><a>@U0JUR9FPH</a> this will work:
<pre>(aws-api/invoke
 client
 {:op      :GetExport
  :request {:restApiId  api-id
            :stageName  stage-name
            :exportType &quot;swagger&quot;
            :accepts    &quot;application/json&quot;}})</pre>
I posted an issue <a href="https://github.com/cognitect-labs/aws-api/issues/158" target="_blank">https://github.com/cognitect-labs/aws-api/issues/158</a>. Please keep the convo going there if you’re interested.</z><z id="t1606759010" t="markbastian Thanks!"><y>#</y><d>2020-11-30</d><h>17:56</h><r>markbastian</r>Thanks!</z><z id="t1606170447" t="gzmask has any body figured out how to use a http proxy for the cognitect  AWS API?  I saw the `endpoint-override` thing  https://github.com/cognitect-labs/aws-api/issues/64  but it’s not exactly as simple as a http proxy config and looks like it needs some complicated path overriding"><y>#</y><d>2020-11-23</d><h>22:27</h><w>gzmask</w>has any body figured out how to use a http proxy for the cognitect  AWS API?  I saw the `endpoint-override` thing <a href="https://github.com/cognitect-labs/aws-api/issues/64" target="_blank">https://github.com/cognitect-labs/aws-api/issues/64</a> but it’s not exactly as simple as a http proxy config and looks like it needs some complicated path overriding</z><z id="t1606170559" t="lukasz I don&apos;t have much experience with this bit, but have your JVM-wide proxy flags? https://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html"><y>#</y><d>2020-11-23</d><h>22:29</h><w>lukasz</w>I don&apos;t have much experience with this bit, but have your JVM-wide proxy flags? <a href="https://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html" target="_blank">https://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html</a></z><z id="t1606170725" t="gzmask interesting, will give this a try."><y>#</y><d>2020-11-23</d><h>22:32</h><w>gzmask</w>interesting, will give this a try.</z><z id="t1606199141" t="zackteo [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] Does anyone know how to use cloudformation for to fix the internal ip of EC2 instances so that I can put something like this in my hosts file (for hadoop + spark cluster) # /etc/hosts 172.31.80.0 hadoop-master 172.31.80.1 hadoop-worker-1 172.31.80.2 hadoop-worker-2 172.31.80.3 hadoop-worker-3"><y>#</y><d>2020-11-24</d><h>06:25</h><w>zackteo</w><a>@valtteri</a> Does anyone know how to use cloudformation for to fix the internal ip of EC2 instances so that I can put something like this in my hosts file (for hadoop + spark cluster)
<pre># /etc/hosts
172.31.80.0 hadoop-master
172.31.80.1 hadoop-worker-1
172.31.80.2 hadoop-worker-2
172.31.80.3 hadoop-worker-3</pre></z><z id="t1606291304" t="viesti [:attrs {:href &quot;/_/_/users/UUSQHP535&quot;}] internal Route53 might suite better for name resolution"><y>#</y><d>2020-11-25</d><h>08:01</h><w>viesti</w><a>@zackteo</a> internal Route53 might suite better for name resolution</z><z id="t1606301243" t="kulminaator route53 or tag your cluster machines and filter them out from ec2 list and looking for the tags ... if you go for stuff like autoscaling groups then reasonably naming random machines that pop up gets complicated"><y>#</y><d>2020-11-25</d><h>10:47</h><w>kulminaator</w>route53 or tag your cluster machines and filter them out from ec2 list and looking for the tags ... if you go for stuff like autoscaling groups then reasonably naming random machines that pop up gets complicated</z><z id="t1606496924" t="kenny I have a task running on EC2 ECS and am using Cognitect&apos;s aws-api to make API calls. I am constructing a regular sts client (e.g., (aws/client {:api :sts}) ) and issuing an :AssumeRole API call. That call is failing with an anomaly saying &quot;No region found by any region provider.&quot; I have traced the call back to the cognitect.aws.ec2-metadata-utils namespace. It is attempting to fetch the region from this endpoint &quot; http://169.254.170.2/latest/dynamic/instance-identity/document &quot;. If I curl that endpoint from within my container, I get a 404. I can curl the credentials using curl ${AWS_CONTAINER_CREDENTIALS_RELATIVE_URI} and get a successful response. Any idea why the former endpoint used for the region is returning a 404?"><y>#</y><d>2020-11-27</d><h>17:08</h><w>kenny</w>I have a task running on EC2 ECS and am using Cognitect&apos;s aws-api to make API calls. I am constructing a regular sts client (e.g., <code>(aws/client {:api :sts})</code>) and issuing an :AssumeRole API call. That call is failing with an anomaly saying &quot;No region found by any region provider.&quot; I have traced the call back to the <code>cognitect.aws.ec2-metadata-utils</code> namespace. It is attempting to fetch the region from this endpoint &quot;<a href="http://169.254.170.2/latest/dynamic/instance-identity/document" target="_blank">http://169.254.170.2/latest/dynamic/instance-identity/document</a>&quot;. If I curl that endpoint from within my container, I get a 404. I can curl the credentials using <code>curl ${AWS_CONTAINER_CREDENTIALS_RELATIVE_URI}</code> and get a successful response. Any idea why the former endpoint used for the region is returning a 404?</z><z id="t1606497589" t="kenny I can work around this by setting the AWS_REGION env var. Curious how default region identification is supposed to work in EC2 ECS though."><y>#</y><d>2020-11-27</d><h>17:19</h><w>kenny</w>I can work around this by setting the AWS_REGION env var. Curious how default region identification is supposed to work in EC2 ECS though.</z><z id="t1606497801" t="ghadi Do you have the instance metadata v1 service disabled [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] ?"><y>#</y><d>2020-11-27</d><h>17:23</h><w>ghadi</w>Do you have the instance metadata v1 service disabled <a>@kenny</a> ?</z><z id="t1606497819" t="kenny How would I know?"><y>#</y><d>2020-11-27</d><h>17:23</h><w>kenny</w>How would I know?</z><z id="t1606497851" t="kenny (Afaik, I did not explicitly disable it)"><y>#</y><d>2020-11-27</d><h>17:24</h><w>kenny</w>(Afaik, I did not explicitly disable it)</z><z id="t1606497875" t="ghadi Check the properties in the console"><y>#</y><d>2020-11-27</d><h>17:24</h><w>ghadi</w>Check the properties in the console</z><z id="t1606497936" t="kenny What am I looking for?"><y>#</y><d>2020-11-27</d><h>17:25</h><w>kenny</w>What am I looking for?</z><z id="t1606498083" t="ghadi Google imds v2, sorry afk"><y>#</y><d>2020-11-27</d><h>17:28</h><w>ghadi</w>Google imds v2, sorry afk</z><z id="t1606498676" t="kenny I see how to https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html . Not seeing how to view the property from an already running instance though."><y>#</y><d>2020-11-27</d><h>17:37</h><w>kenny</w>I see how to <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html</a>. Not seeing how to view the property from an already running instance though.</z><z id="t1606498817" t="orestis You need to relaunch afaik"><y>#</y><d>2020-11-27</d><h>17:40</h><w>orestis</w>You need to relaunch afaik</z><z id="t1606499101" t="kenny This seems relevant here: https://docs.aws.amazon.com/AmazonECS/latest/developerguide/container-metadata.html#enable-metadata . Container metadata is disabled by default for ECS."><y>#</y><d>2020-11-27</d><h>17:45</h><w>kenny</w>This seems relevant here: <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/container-metadata.html#enable-metadata" target="_blank">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/container-metadata.html#enable-metadata</a>. Container metadata is disabled by default for ECS.</z><z id="t1606499628" t="ghadi That’s the wrong metadata service"><y>#</y><d>2020-11-27</d><h>17:53</h><w>ghadi</w>That’s the wrong metadata service</z><z id="t1606499637" t="ghadi I thought EC2?"><y>#</y><d>2020-11-27</d><h>17:53</h><w>ghadi</w>I thought EC2?</z><z id="t1606499646" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] "><y>#</y><d>2020-11-27</d><h>17:54</h><w>ghadi</w><a>@kenny</a> </z><z id="t1606501264" t="kenny The issue is occurring inside a task that is running on ECS EC2."><y>#</y><d>2020-11-27</d><h>18:21</h><w>kenny</w>The issue is occurring inside a task that is running on ECS EC2.</z><z id="t1606512352" t="viesti hmm, I remember setting the AWS_REGION &amp; AWS_DEFAULT_REGION to make python boto3 applications work when run on ECS"><y>#</y><d>2020-11-27</d><h>21:25</h><w>viesti</w>hmm, I remember setting the AWS_REGION &amp; AWS_DEFAULT_REGION to make python boto3 applications work when run on ECS</z><z id="t1606512414" t="viesti it didn&apos;t occur to me that the region would actually be available from the container metadata service"><y>#</y><d>2020-11-27</d><h>21:26</h><w>viesti</w>it didn&apos;t occur to me that the region would actually be available from the container metadata service</z><z id="t1606702385" t="zackteo Could someone help me to understand what I am missing to allow ssh into my EC2 instances in my cloudFormation template? I&apos;m guessing that my connections are being blocked somewhere but I don&apos;t seem to find any semblance of network configuration options for the VPC or subnet https://gist.github.com/zackteo/cc5f3d718f4ada748c1d56805cc97a37"><y>#</y><d>2020-11-30</d><h>02:13</h><w>zackteo</w>Could someone help me to understand what I am missing to allow ssh into my EC2 instances in my cloudFormation template? I&apos;m guessing that my connections are being blocked somewhere but I don&apos;t seem to find any semblance of network configuration options for the VPC or subnet
<a href="https://gist.github.com/zackteo/cc5f3d718f4ada748c1d56805cc97a37" target="_blank">https://gist.github.com/zackteo/cc5f3d718f4ada748c1d56805cc97a37</a></z><z id="t1606716713" t="zackteo I managed to get it to work already 🙂 https://www.reddit.com/r/aws/comments/k3mu8r/cloudformation_lacking_permissions_to_ssh_into/"><y>#</y><d>2020-11-30</d><h>06:11</h><r>zackteo</r>I managed to get it to work already <b>🙂</b> <a href="https://www.reddit.com/r/aws/comments/k3mu8r/cloudformation_lacking_permissions_to_ssh_into/" target="_blank">https://www.reddit.com/r/aws/comments/k3mu8r/cloudformation_lacking_permissions_to_ssh_into/</a></z><z id="t1606732575" t="zackteo Also, does anyone know what is the best way to automate copying of public key from namenode to worker nodes in EC2 Cluster in CloudFormation? I want to do ssh hadoop-worker-1 &apos;cat &gt;&gt; ~/.ssh/authorized_keys&apos; &lt; ~/.ssh/id_rsa.pub in my namenode but will be stopped by a password request. I believe I need my aws-key but I&apos;m not sure what&apos;s a reasonable way for my namenode to get it. Or what might be a good workaround"><y>#</y><d>2020-11-30</d><h>10:36</h><w>zackteo</w>Also, does anyone know what is the best way to automate copying of public key from namenode to worker nodes in EC2 Cluster in CloudFormation?
I want to do <code>ssh hadoop-worker-1 &apos;cat &gt;&gt; ~/.ssh/authorized_keys&apos; &lt; ~/.ssh/id_rsa.pub</code> in my namenode but will be stopped by a password request.

I believe I need my aws-key but I&apos;m not sure what&apos;s a reasonable way for my namenode to get it. Or what might be a good workaround</z><z id="t1606747433" t="lukasz I believe AWS systems manager is what you&apos;re looking for - it can run scripts etc on your behalf across your ec2 instances https://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html Another approach is to use user-data and cloud-init to build the authorized keys on machine boot (that&apos;s something I used to do: we&apos;d pull public keys from GitHub&apos;s user api and bake in an authorized_keys file for a jump host"><y>#</y><d>2020-11-30</d><h>14:43</h><w>lukasz</w>I believe AWS systems manager is what you&apos;re looking for - it can run scripts etc on your behalf across your ec2 instances <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html" target="_blank">https://docs.aws.amazon.com/systems-manager/latest/userguide/execute-remote-commands.html</a> Another approach is to use user-data and cloud-init to build the authorized keys on machine boot (that&apos;s something I used to do: we&apos;d pull public keys from GitHub&apos;s user api and bake in an authorized_keys file for a jump host</z><z id="t1606749502" t="orestis I dimly remember that there is a way to do ssh into an EC2 instance using AMI instead of dealing with keys etc."><y>#</y><d>2020-11-30</d><h>15:18</h><w>orestis</w>I dimly remember that there is a way to do ssh into an EC2 instance using AMI instead of dealing with keys etc.</z><z id="t1606750046" t="lukasz You can configure your EC2 instance to allow a ssh key when building it or pre-bake the authorized_keys in your AMI image"><y>#</y><d>2020-11-30</d><h>15:27</h><w>lukasz</w>You can configure your EC2 instance to allow a ssh key when building it or pre-bake the authorized_keys in your AMI image</z><z id="t1606750068" t="lukasz Nowadays best practice is to go through AWS SSM and not use SSH keys at all, and instead delegate to your AWS credentials/identity"><y>#</y><d>2020-11-30</d><h>15:27</h><w>lukasz</w>Nowadays best practice is to go through AWS SSM and not use SSH keys at all, and instead delegate to your AWS credentials/identity</z><z id="t1606750080" t="lukasz https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-enable-ssh-connections.html"><y>#</y><d>2020-11-30</d><h>15:28</h><w>lukasz</w><a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-enable-ssh-connections.html" target="_blank">https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-getting-started-enable-ssh-connections.html</a></z><z id="t1606750111" t="lukasz Something I really miss from Google Cloud - you can magically SSH to an instance, provided you have access to the GCP project"><y>#</y><d>2020-11-30</d><h>15:28</h><w>lukasz</w>Something I really miss from Google Cloud - you can magically SSH to an instance, provided you have access to the GCP project</z><z id="t1606750118" t="lukasz in AWS it requires some setup"><y>#</y><d>2020-11-30</d><h>15:28</h><w>lukasz</w>in AWS it requires some setup</z><z id="t1606822849" t="viesti +1 for SSM tunneling, it&apos;s my go-to tool currently. There&apos;s a nice helper for selecting the EC2 instance to connect to https://github.com/disneystreaming/ssm-helpers"><y>#</y><d>2020-12-01</d><h>11:40</h><w>viesti</w>+1 for SSM tunneling, it&apos;s my go-to tool currently. There&apos;s a nice helper for selecting the EC2 instance to connect to <a href="https://github.com/disneystreaming/ssm-helpers" target="_blank">https://github.com/disneystreaming/ssm-helpers</a></z><z id="t1606823013" t="viesti wrote a helper script for tunneling to rds via a host using ssm: https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/bastion/ssm-rds-tunnel.sh"><y>#</y><d>2020-12-01</d><h>11:43</h><w>viesti</w>wrote a helper script for tunneling to rds via a host using ssm: <a href="https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/bastion/ssm-rds-tunnel.sh" target="_blank">https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/bastion/ssm-rds-tunnel.sh</a></z><z id="t1606823127" t="viesti there&apos;s some hoops to jump, the target instance has to have arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore policy attached and has to have the ssm agent running (current amazon linux 2 ami&apos;s have this agent running by default) and also ec2-instance-connect installed (that is installed to current amazon linux 2 ami&apos;s as well)"><y>#</y><d>2020-12-01</d><h>11:45</h><w>viesti</w>there&apos;s some hoops to jump, the target instance has to have <code>arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore</code> policy attached and has to have the ssm agent running (current amazon linux 2 ami&apos;s have this agent running by default) and also ec2-instance-connect installed (that is installed to current amazon linux 2 ami&apos;s as well)</z><z id="t1606823159" t="viesti the script then uses the ssh daemon on the target host for port forwarding to remote hosts (ssm agent doen&apos;t yet support remote port forwarding)"><y>#</y><d>2020-12-01</d><h>11:45</h><w>viesti</w>the script then uses the ssh daemon on the target host for port forwarding to remote hosts (ssm agent doen&apos;t yet support remote port forwarding)</z><z id="t1606823214" t="viesti anyhow, if the hadoop nodes don&apos;t explicitly require ssh access between each other, and you need only ssh access to the hosts themselves, then ssm is quite nice (competes with the gcp option)"><y>#</y><d>2020-12-01</d><h>11:46</h><w>viesti</w>anyhow, if the hadoop nodes don&apos;t explicitly require ssh access between each other, and you need only ssh access to the hosts themselves, then ssm is quite nice (competes with the gcp option)</z><z id="t1606831349" t="orestis [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] thanks for that link, does that replace the clumsy (IMO) need to install a separate plugin to the AWS CLI?"><y>#</y><d>2020-12-01</d><h>14:02</h><w>orestis</w><a>@viesti</a> thanks for that link, does that replace the clumsy (IMO) need to install a separate plugin to the AWS CLI?</z><z id="t1606831464" t="viesti I have the plugin installed so didn&apos;t actually know until reading the readme :) &gt; It uses the Amazon-supplied session-manager-plugin binary in combination with the AWS CLI tool to create the actual sessions."><y>#</y><d>2020-12-01</d><h>14:04</h><w>viesti</w>I have the plugin installed so didn&apos;t actually know until reading the readme :)

&gt; It uses the Amazon-supplied session-manager-plugin binary in combination with the AWS CLI tool to create the actual sessions.</z><z id="t1606831585" t="viesti anyways, provides a list of instances and -f tag=value is neat, e.g. -f Name=backend-1"><y>#</y><d>2020-12-01</d><h>14:06</h><w>viesti</w>anyways, provides a list of instances and <code>-f tag=value</code> is neat, e.g. <code>-f Name=backend-1</code></z><z id="t1607276838" t="jjttjj anyone know of a &quot;fully featured&quot; cloud formation template for hosting static pages on s3? It must include default directory indexes for subdirectories and https on a root domain and subdomain. I&apos;m only finding partial/scattered solutions to these"><y>#</y><d>2020-12-06</d><h>17:47</h><w>jjttjj</w>anyone know of a &quot;fully featured&quot; cloud formation template for hosting static pages on s3? It must include default directory indexes for subdirectories and https on a root domain and subdomain.  I&apos;m only finding partial/scattered solutions to these</z><z id="t1607278217" t="jjttjj Ok maybe AWS Amplify is actually what I want"><y>#</y><d>2020-12-06</d><h>18:10</h><r>jjttjj</r>Ok maybe AWS Amplify is actually what I want</z><z id="t1607349092" t="dabrazhe Hi. Does anyone have an example or can explain how to work with ClientBuilders in AWS SDK in Clojure? I am can create a builder (AmazonKinesisVideoClient/builder) but when trying to (.build) it, I am getting all sorts of errors, eg - call to method withRegion can&apos;t be resolved (target class is unknown)."><y>#</y><d>2020-12-07</d><h>13:51</h><w>dabrazhe</w>Hi. Does anyone have an example or can explain how to work with ClientBuilders in AWS SDK in Clojure? I am can create a builder <code>(AmazonKinesisVideoClient/builder)</code>  but when trying to <code>(.build)</code> it, I am getting all sorts of errors, eg <code>- call to method withRegion can&apos;t be resolved (target class is unknown).</code></z><z id="t1607350358" t="ghadi [:attrs {:href &quot;/_/_/users/U96LS78UV&quot;}] paste your code"><y>#</y><d>2020-12-07</d><h>14:12</h><w>ghadi</w><a>@dennisa</a> paste your code</z><z id="t1607350389" t="ghadi BTW Have you tried the Cognitect Labs aws client? Much more native feel"><y>#</y><d>2020-12-07</d><h>14:13</h><w>ghadi</w>BTW Have you tried the Cognitect Labs aws client? Much more native feel</z><z id="t1607373933" t="dabrazhe It&apos;s along the lines of (doto (AmazonKinesisVideoClientBuilder/standard) (.withRegion region-const) (.withCredentials credential-provider) .... (.build))"><y>#</y><d>2020-12-07</d><h>20:45</h><w>dabrazhe</w>It&apos;s  along the lines of
<pre>(doto (AmazonKinesisVideoClientBuilder/standard)
  (.withRegion region-const)
  (.withCredentials credential-provider)
....
  (.build))</pre></z><z id="t1607374071" t="dabrazhe I haven&apos;t tried the cognitect aws client yet. It&apos;s more an API caller. It felt calling the Java SDK from Clojure would be more native : )"><y>#</y><d>2020-12-07</d><h>20:47</h><w>dabrazhe</w>I haven&apos;t tried the cognitect aws client yet. It&apos;s more an API caller. It felt calling the Java SDK from Clojure would be more native : )</z><z id="t1607374258" t="Alex Miller (Clojure team) it&apos;s not :)"><y>#</y><d>2020-12-07</d><h>20:50</h><w>Alex Miller (Clojure team)</w>it&apos;s not :)</z><z id="t1607374321" t="Alex Miller (Clojure team) using the java sdk means making function calls to generate a bunch of objects which get turned into a bunch of http calls. the cognitect aws api is a functional api to make those http calls without all the junk in the middle"><y>#</y><d>2020-12-07</d><h>20:52</h><w>Alex Miller (Clojure team)</w>using the java sdk means making function calls to generate a bunch of objects which get turned into a bunch of http calls. the cognitect aws api is a functional api to make those http calls without all the junk in the middle</z><z id="t1607375265" t="dabrazhe Isn&apos;t processing java objects returned by the SDK easier than parsing the output of the https calls ? : )"><y>#</y><d>2020-12-07</d><h>21:07</h><w>dabrazhe</w>Isn&apos;t processing java objects returned by the SDK easier than parsing the output of the https calls ? : )</z><z id="t1607375314" t="Alex Miller (Clojure team) no, it&apos;s all autogenerated"><y>#</y><d>2020-12-07</d><h>21:08</h><w>Alex Miller (Clojure team)</w>no, it&apos;s all autogenerated</z><z id="t1607375339" t="Alex Miller (Clojure team) amazon publishes data files describing the apis"><y>#</y><d>2020-12-07</d><h>21:08</h><w>Alex Miller (Clojure team)</w>amazon publishes data files describing the apis</z><z id="t1607375373" t="Alex Miller (Clojure team) https://www.youtube.com/watch?v=ppDtDP0Rntw if you&apos;re interested in more talking :)"><y>#</y><d>2020-12-07</d><h>21:09</h><w>Alex Miller (Clojure team)</w><a href="https://www.youtube.com/watch?v=ppDtDP0Rntw" target="_blank">https://www.youtube.com/watch?v=ppDtDP0Rntw</a> if you&apos;re interested in more talking :)</z><z id="t1607375410" t="Alex Miller (Clojure team) also has autogenerated docs and clojure specs"><y>#</y><d>2020-12-07</d><h>21:10</h><w>Alex Miller (Clojure team)</w>also has autogenerated docs and clojure specs</z><z id="t1607379308" t="dabrazhe Thank you, will have a look. I guess the cognitect aws client is similar to aws-cli in a way? Does the api it return the native Clojure data stuctures ? : )"><y>#</y><d>2020-12-07</d><h>22:15</h><w>dabrazhe</w>Thank you, will have a look. I guess the cognitect aws client is similar to aws-cli in a way? Does the api it return the native Clojure data stuctures ? : )</z><z id="t1607379343" t="ghadi takes data, returns data"><y>#</y><d>2020-12-07</d><h>22:15</h><w>ghadi</w>takes data, returns data</z><z id="t1607379790" t="Alex Miller (Clojure team) you can find some examples here https://github.com/cognitect-labs/aws-api/blob/master/README.md#usage"><y>#</y><d>2020-12-07</d><h>22:23</h><w>Alex Miller (Clojure team)</w>you can find some examples here <a href="https://github.com/cognitect-labs/aws-api/blob/master/README.md#usage" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/README.md#usage</a></z><z id="t1607527513" t="lgouger In the AWS announcement for  https://crossplane.io/  ( https://aws.amazon.com/blogs/containers/aws-controllers-for-kubernetes-ack/ ) They mention that it’s based on the model defined in aws-sdk-go &gt; … we consume model information from a canonical source of truth about AWS services. We settled on the source of truth as  https://github.com/aws/aws-sdk-go/tree/master/models/apis  from the `aws/aws-sdk-go` repository. AWS SDKs are regularly updated with all API changes so this is an accurate source of information and closely tracks the service API avilability. … Sharing in case the json files in the aws-sdk-go model are destined to be a better source of truth than aws-sdk-js."><y>#</y><d>2020-12-09</d><h>15:25</h><w>lgouger</w>In the AWS announcement for <a href="https://crossplane.io/" target="_blank">https://crossplane.io/</a> (<a href="https://aws.amazon.com/blogs/containers/aws-controllers-for-kubernetes-ack/" target="_blank">https://aws.amazon.com/blogs/containers/aws-controllers-for-kubernetes-ack/</a>)
They mention that it’s based on the model defined in aws-sdk-go
&gt; … we consume model information from a canonical source of truth about AWS services. We settled on the source of truth as <a href="https://github.com/aws/aws-sdk-go/tree/master/models/apis" target="_blank">https://github.com/aws/aws-sdk-go/tree/master/models/apis</a> from the `aws/aws-sdk-go` repository. AWS SDKs are regularly updated with all API changes so this is an accurate source of information and closely tracks the service API avilability. …
Sharing in case the json files in the aws-sdk-go model are destined to be a better source of truth than aws-sdk-js.</z><z id="t1607588098" t="viesti it&apos;s a bit funny that there are so many sources of AWS API descriptions :D"><y>#</y><d>2020-12-10</d><h>08:14</h><w>viesti</w>it&apos;s a bit funny that there are so many sources of AWS API descriptions :D</z><z id="t1607617632" t="dabrazhe Regarding the Cognitect aws-api. I need to pass https://docs.aws.amazon.com/cli/latest/reference/ , to an aws client. Can use the :endpoint keyword?"><y>#</y><d>2020-12-10</d><h>16:27</h><w>dabrazhe</w>Regarding the Cognitect aws-api. I need to pass <a href="https://docs.aws.amazon.com/cli/latest/reference/" target="_blank">https://docs.aws.amazon.com/cli/latest/reference/</a>, to an aws client. Can use the :endpoint keyword?</z><z id="t1607617731" t="dabrazhe (def kvmedia (aws/client {:api :kinesis-video-media :endpoint kvs-endpoint :credentials-provider (cred/profile-credentials-provider &quot;devpl&quot;)}))"><y>#</y><d>2020-12-10</d><h>16:28</h><w>dabrazhe</w><pre>(def kvmedia (aws/client {:api :kinesis-video-media :endpoint kvs-endpoint :credentials-provider (cred/profile-credentials-provider &quot;devpl&quot;)}))</pre></z><z id="t1607619844" t="Alex Miller (Clojure team) did you check the doc string?"><y>#</y><d>2020-12-10</d><h>17:04</h><w>Alex Miller (Clojure team)</w>did you check the doc string?</z><z id="t1607620493" t="dabrazhe yes: ) endpoint it&apos;s not described in the doc string. The reason I am asking: I can successfully execute the call to kinesis-video-media with aws-CLI from the terminal. But the aws/invoke gives me headaches; I am getting an error which makes not much sense to me. {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error {:cause &quot;JSON error (unexpected character): &lt;&quot;, :trace..."><y>#</y><d>2020-12-10</d><h>17:14</h><w>dabrazhe</w>yes: ) <code>endpoint</code> it&apos;s not described in the doc string. The reason I am asking: I can successfully execute the call to kinesis-video-media with aws-CLI from the terminal. But the aws/invoke gives me headaches; I am getting an error which makes not much sense to me.
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable
   #error
    {:cause &quot;JSON error (unexpected character): &lt;&quot;,
     :trace...</pre></z><z id="t1607620533" t="Alex Miller (Clojure team) I see :endpoint-override in the doc string?"><y>#</y><d>2020-12-10</d><h>17:15</h><w>Alex Miller (Clojure team)</w>I see :endpoint-override in the doc string?</z><z id="t1607620551" t="dabrazhe Does this mean there&apos;s a fault my client config, or aws/invoke or is it a bug in aws-cli? 🙂"><y>#</y><d>2020-12-10</d><h>17:15</h><w>dabrazhe</w>Does this mean there&apos;s a fault my client config, or aws/invoke or is it a bug in aws-cli? <b>🙂</b></z><z id="t1607620588" t="Alex Miller (Clojure team) it sounds to me like you&apos;re invoking the client with options that aren&apos;t documented and maybe don&apos;t exist, so without knowing more that sounds like an error in your code"><y>#</y><d>2020-12-10</d><h>17:16</h><w>Alex Miller (Clojure team)</w>it sounds to me like you&apos;re invoking the client with options that aren&apos;t documented and maybe don&apos;t exist, so without knowing more that sounds like an error in your code</z><z id="t1607620865" t="Alex Miller (Clojure team) I believe :endpoint as a key there is deprecated (which is why it&apos;s not doc&apos;ed) and :endpoint-override is the documented support for this"><y>#</y><d>2020-12-10</d><h>17:21</h><w>Alex Miller (Clojure team)</w>I believe :endpoint as a key there is deprecated (which is why it&apos;s not doc&apos;ed) and :endpoint-override is the documented support for this</z><z id="t1607687976" t="viesti error sounds like xml stuff landing where json expected, wonder if kinesis-video-media wire format is supported via aws-api 😬"><y>#</y><d>2020-12-11</d><h>11:59</h><w>viesti</w>error sounds like xml stuff landing where json expected, wonder if kinesis-video-media wire format is supported via aws-api <b>😬</b></z><z id="t1607688009" t="viesti sometimes hard to cook one up, but maybe a small reproducible example would help"><y>#</y><d>2020-12-11</d><h>12:00</h><w>viesti</w>sometimes hard to cook one up, but maybe a small reproducible example would help</z><z id="t1607714633" t="dabrazhe Sure, perhaps you will see what I am missing. The aws-cli command works fine. aws kinesis-video-media get-media --stream-arn &quot;arn:aws:kinesisvideo:eu-west-1:9000ACCOUNT:stream/camera1/1607464961761&quot; --start-selector StartSelectorType=&quot;NOW&quot; --p devpl2 --endpoint-url &quot;&quot; cam.mkv"><y>#</y><d>2020-12-11</d><h>19:23</h><w>dabrazhe</w>Sure, perhaps you will see what I am missing. The aws-cli command works fine.
<pre>aws kinesis-video-media get-media --stream-arn &quot;arn:aws:kinesisvideo:eu-west-1:9000ACCOUNT:stream/camera1/1607464961761&quot; --start-selector StartSelectorType=&quot;NOW&quot; --p devpl2 --endpoint-url &quot;&quot; cam.mkv</pre></z><z id="t1607714646" t="dabrazhe I am able to invoke on the :kinesisvideo client and get Endpoint and StreamArn without any issues. To read from the stream I am creating a :kinesis-video-media client, which is created fine. (def kvmedia (aws/client {:api :kinesis-video-media :region &quot;eu-west-1&quot; :endpoint kvs-endpoint :credentials-provider (cred/profile-credentials-provider &quot;devpl2&quot;)}))"><y>#</y><d>2020-12-11</d><h>19:24</h><w>dabrazhe</w>I am able to invoke on the :kinesisvideo client and get Endpoint and StreamArn without any issues. To read from the stream I am creating a :kinesis-video-media client, which is created fine.
<pre>(def kvmedia (aws/client {:api :kinesis-video-media :region &quot;eu-west-1&quot; :endpoint kvs-endpoint :credentials-provider (cred/profile-credentials-provider &quot;devpl2&quot;)}))</pre></z><z id="t1607714709" t="dabrazhe What breaks is invoke on the :kinesis-video-media client . Whatever I invoke with results in the cryptic json error. (aws/invoke kvmedia {:op :GetMedia :request {:StartSelector {:StartSelectorType &quot;EARLIEST&quot;} :StreamARN stream-arn}}) "><y>#</y><d>2020-12-11</d><h>19:25</h><w>dabrazhe</w>What breaks is invoke on the <code>:kinesis-video-media client</code>. Whatever I invoke with results in the cryptic json error.
<pre>(aws/invoke kvmedia {:op :GetMedia 
    :request {:StartSelector {:StartSelectorType &quot;EARLIEST&quot;}
                               :StreamARN stream-arn}})</pre>
</z><z id="t1607714776" t="dabrazhe The json error {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.aws.client/throwable #error {:cause &quot;JSON error (unexpected character): &lt;&quot;, :trace [[clojure.data.json$_read invokeStatic &quot;json.clj&quot; 230] [clojure.data.json$_read invoke &quot;json.clj&quot; 181] [clojure.data.json$read invokeStatic &quot;json.clj&quot; 276] [clojure.data.json$read doInvoke &quot;json.clj&quot; 232] [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139] [clojure.core$apply invokeStatic &quot;core.clj&quot; 667] [clojure.core$apply invoke &quot;core.clj&quot; 660] [clojure.data.json$read_str invokeStatic &quot;json.clj&quot; 282] [clojure.data.json$read_str doInvoke &quot;json.clj&quot; 278] [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 439] [cognitect.aws.protocols.common$json_parse_error invokeStatic &quot;common.clj&quot; 42] [cognitect.aws.protocols.common$json_parse_error invoke &quot;common.clj&quot; 40] [cognitect.aws.protocols.rest$parse_http_response invokeStatic &quot;rest.clj&quot; 261] [cognitect.aws.protocols.rest$parse_http_response invoke &quot;rest.clj&quot; 249] [cognitect.aws.protocols.rest_json$eval32496$fn__32497 invoke &quot;rest_json.clj&quot; 61] [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239] [cognitect.aws.client$handle_http_response invokeStatic &quot;client.clj&quot; 48] [cognitect.aws.client$handle_http_response invoke &quot;client.clj&quot; 43] [cognitect.aws.client$send_request$fn__12219$state_machine__6619__auto____12246$fn__12249 invoke &quot;client.clj&quot; 111] [cognitect.aws.client$send_request$fn__12219$state_machine__6619__auto____12246 invoke &quot;client.clj&quot; 107] [clojure.core.async.impl.ioc_macros$run_state_machine invokeStatic &quot;ioc_macros.clj&quot; 978] [clojure.core.async.impl.ioc_macros$run_state_machine invoke &quot;ioc_macros.clj&quot; 977] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invokeStatic &quot;ioc_macros.clj&quot; 982] [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped invoke &quot;ioc_macros.clj&quot; 980] [clojure.core.async.impl.ioc_macros$take_BANG_$fn__6637 invoke &quot;ioc_macros.clj&quot; 991] [clojure.core.async.impl.channels.ManyToManyChannel$fn__623$fn__624 invoke &quot;channels.clj&quot; 95] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.util.concurrent.ThreadPoolExecutor runWorker &quot;ThreadPoolExecutor.java&quot; 1135] [java.util.concurrent.ThreadPoolExecutor$Worker run &quot;ThreadPoolExecutor.java&quot; 635] [clojure.core.async.impl.concurrent$counted_thread_factory$reify__492$fn__493 invoke &quot;concurrent.clj&quot; 29] [clojure.lang.AFn run &quot;AFn.java&quot; 22] [java.lang.Thread run &quot;Thread.java&quot; 844]], :via [{:at [clojure.data.json$_read invokeStatic &quot;json.clj&quot; 230], :message &quot;JSON error (unexpected character): &lt;&quot;, :type java.lang.Exception}]}}"><y>#</y><d>2020-12-11</d><h>19:26</h><r>dabrazhe</r>The json error
<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.aws.client/throwable
   #error
    {:cause &quot;JSON error (unexpected character): &lt;&quot;,
     :trace
       [[clojure.data.json$_read invokeStatic &quot;json.clj&quot;
         230]
        [clojure.data.json$_read invoke &quot;json.clj&quot; 181]
        [clojure.data.json$read invokeStatic &quot;json.clj&quot; 276]
        [clojure.data.json$read doInvoke &quot;json.clj&quot; 232]
        [clojure.lang.RestFn applyTo &quot;RestFn.java&quot; 139]
        [clojure.core$apply invokeStatic &quot;core.clj&quot; 667]
        [clojure.core$apply invoke &quot;core.clj&quot; 660]
        [clojure.data.json$read_str invokeStatic &quot;json.clj&quot;
         282]
        [clojure.data.json$read_str doInvoke &quot;json.clj&quot; 278]
        [clojure.lang.RestFn invoke &quot;RestFn.java&quot; 439]
        [cognitect.aws.protocols.common$json_parse_error
         invokeStatic &quot;common.clj&quot; 42]
        [cognitect.aws.protocols.common$json_parse_error
         invoke &quot;common.clj&quot; 40]
        [cognitect.aws.protocols.rest$parse_http_response
         invokeStatic &quot;rest.clj&quot; 261]
        [cognitect.aws.protocols.rest$parse_http_response
         invoke &quot;rest.clj&quot; 249]
        [cognitect.aws.protocols.rest_json$eval32496$fn__32497
         invoke &quot;rest_json.clj&quot; 61]
        [clojure.lang.MultiFn invoke &quot;MultiFn.java&quot; 239]
        [cognitect.aws.client$handle_http_response
         invokeStatic &quot;client.clj&quot; 48]
        [cognitect.aws.client$handle_http_response invoke
         &quot;client.clj&quot; 43]
        [cognitect.aws.client$send_request$fn__12219$state_machine__6619__auto____12246$fn__12249
         invoke &quot;client.clj&quot; 111]
        [cognitect.aws.client$send_request$fn__12219$state_machine__6619__auto____12246
         invoke &quot;client.clj&quot; 107]
        [clojure.core.async.impl.ioc_macros$run_state_machine
         invokeStatic &quot;ioc_macros.clj&quot; 978]
        [clojure.core.async.impl.ioc_macros$run_state_machine
         invoke &quot;ioc_macros.clj&quot; 977]
        [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped
         invokeStatic &quot;ioc_macros.clj&quot; 982]
        [clojure.core.async.impl.ioc_macros$run_state_machine_wrapped
         invoke &quot;ioc_macros.clj&quot; 980]
        [clojure.core.async.impl.ioc_macros$take_BANG_$fn__6637
         invoke &quot;ioc_macros.clj&quot; 991]
        [clojure.core.async.impl.channels.ManyToManyChannel$fn__623$fn__624
         invoke &quot;channels.clj&quot; 95]
        [clojure.lang.AFn run &quot;AFn.java&quot; 22]
        [java.util.concurrent.ThreadPoolExecutor runWorker
         &quot;ThreadPoolExecutor.java&quot; 1135]
        [java.util.concurrent.ThreadPoolExecutor$Worker run
         &quot;ThreadPoolExecutor.java&quot; 635]
        [clojure.core.async.impl.concurrent$counted_thread_factory$reify__492$fn__493
         invoke &quot;concurrent.clj&quot; 29]
        [clojure.lang.AFn run &quot;AFn.java&quot; 22]
        [java.lang.Thread run &quot;Thread.java&quot; 844]],
     :via [{:at [clojure.data.json$_read invokeStatic
                 &quot;json.clj&quot; 230],
            :message &quot;JSON error (unexpected character): &lt;&quot;,
            :type java.lang.Exception}]}}</pre></z><z id="t1607725186" t="lukasz Just guessing here - since it starts with &lt; - that means you&apos;re getting an XML/HTML response?"><y>#</y><d>2020-12-11</d><h>22:19</h><r>lukasz</r>Just guessing here - since it starts with &lt; - that means you&apos;re getting an XML/HTML response?</z><z id="t1607725201" t="lukasz You can bump logging level of the underlying http client and see if that helps"><y>#</y><d>2020-12-11</d><h>22:20</h><r>lukasz</r>You can bump logging level of the underlying http client and see if that helps</z><z id="t1607981465" t="dabrazhe That&apos;s the whole errors I am getting in response. What do you meany by logging level by the client?"><y>#</y><d>2020-12-14</d><h>21:31</h><r>dabrazhe</r>That&apos;s the whole errors I am getting in response. What do you meany by logging level by the client?</z><z id="t1607983604" t="lukasz if you&apos;re using clojure.tools.logging and switch the log level from info to debug, you&apos;ll see debug logs from the underlying HTTP client (I believe it&apos;s based on Jetty) - this way you&apos;ll see all of the request details"><y>#</y><d>2020-12-14</d><h>22:06</h><r>lukasz</r>if you&apos;re using <code>clojure.tools.logging</code> and switch the log level from info to debug, you&apos;ll see debug logs from the underlying HTTP client (I believe it&apos;s based on Jetty) - this way you&apos;ll see all of the request details</z><z id="t1607714880" t="dabrazhe The json error is in the thread. I even found the boto3 api for :kinesis-video-media and it seems like I am doing things in the same way."><y>#</y><d>2020-12-11</d><h>19:28</h><w>dabrazhe</w>The json error is in the thread. I even found the boto3 api for :kinesis-video-media and it seems like I am doing things in the same way.</z><z id="t1608204333" t="dabrazhe I was able to make the request with Boto3 in python using the same parameters and it works right away. There&apos;s likely to be a bug in aws-cli for this client, [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}]"><y>#</y><d>2020-12-17</d><h>11:25</h><w>dabrazhe</w>I was able to make the request with Boto3 in python using the same parameters and it works right away. There&apos;s likely to be a bug in aws-cli for this client, <a>@alexmiller</a></z><z id="t1608210373" t="Alex Miller (Clojure team) https://github.com/cognitect-labs/aws-api/issues is the best place to file bugs"><y>#</y><d>2020-12-17</d><h>13:06</h><w>Alex Miller (Clojure team)</w><a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> is the best place to file bugs</z><z id="t1608242293" t="dchelimsky [:attrs {:href &quot;/_/_/users/U96LS78UV&quot;}] what Alex says is true, however, since I’m here …"><y>#</y><d>2020-12-17</d><h>21:58</h><w>dchelimsky</w><a>@dennisa</a> what Alex says is true, however, since I’m here …</z><z id="t1608242548" t="dchelimsky (doc aws/client) ------------------------- cognitect.aws.client.api/client ([{:keys [api region region-provider retriable? backoff credentials-provider endpoint endpoint-override http-client], :or {endpoint-override {}}}]) Given a config map, create a client for specified api. Supported keys: :api - required, this or api-descriptor required, the name of the api you want to interact with e.g. :s3, :cloudformation, etc :http-client - optional, to share http-clients across aws-clients. See default-http-client. :region-provider - optional, implementation of aws-clojure.region/RegionProvider protocol, defaults to cognitect.aws.region/default-region-provider. Ignored if :region is also provided :region - optional, the aws region serving the API endpoints you want to interact with, defaults to region provided by by the region-provider :credentials-provider - optional, implementation of cognitect.aws.credentials/CredentialsProvider protocol, defaults to cognitect.aws.credentials/default-credentials-provider :endpoint-override - optional, map to override parts of the endpoint. Supported keys: :protocol - :http or :https :hostname - string :port - int :path - string If the hostname includes an AWS region, be sure use the same region for the client (either via out of process configuration or the :region key supplied to this fn). Also supports a string representing just the hostname, though support for a string is deprectated and may be removed in the future. :retriable? - optional, fn of http-response (see cognitect.aws.http/submit). Should return a boolean telling the client whether or not the request is retriable. The default, cognitect.aws.retry/default-retriable?, returns true when the response indicates that the service is busy or unavailable. :backoff - optional, fn of number of retries so far. Should return number of milliseconds to wait before the next retry (if the request is retriable?), or nil if it should stop. Defaults to cognitect.aws.retry/default-backoff. By default, all clients use shared http-client, credentials-provider, and region-provider instances which use a small collection of daemon threads. Alpha. Subject to change. You should use the `:endpoint-override` key. There is no support for `:endpoint`."><y>#</y><d>2020-12-17</d><h>22:02</h><r>dchelimsky</r><pre>(doc aws/client)
-------------------------
cognitect.aws.client.api/client
([{:keys [api region region-provider retriable? backoff credentials-provider endpoint endpoint-override http-client], :or {endpoint-override {}}}])
  Given a config map, create a client for specified api. Supported keys:
  :api                  - required, this or api-descriptor required, the name of the api
                          you want to interact with e.g. :s3, :cloudformation, etc
  :http-client          - optional, to share http-clients across aws-clients.
                          See default-http-client.
  :region-provider      - optional, implementation of aws-clojure.region/RegionProvider
                          protocol, defaults to cognitect.aws.region/default-region-provider.
                          Ignored if :region is also provided
  :region               - optional, the aws region serving the API endpoints you
                          want to interact with, defaults to region provided by
                          by the region-provider
  :credentials-provider - optional, implementation of
                          cognitect.aws.credentials/CredentialsProvider
                          protocol, defaults to
                          cognitect.aws.credentials/default-credentials-provider
  :endpoint-override    - optional, map to override parts of the endpoint. Supported keys:
                            :protocol     - :http or :https
                            :hostname     - string
                            :port         - int
                            :path         - string
                          If the hostname includes an AWS region, be sure use the same
                          region for the client (either via out of process configuration
                          or the :region key supplied to this fn).
                          Also supports a string representing just the hostname, though
                          support for a string is deprectated and may be removed in the
                          future.
  :retriable?           - optional, fn of http-response (see cognitect.aws.http/submit).
                          Should return a boolean telling the client whether or
                          not the request is retriable.  The default,
                          cognitect.aws.retry/default-retriable?, returns
                          true when the response indicates that the service is
                          busy or unavailable.
  :backoff              - optional, fn of number of retries so far. Should return
                          number of milliseconds to wait before the next retry
                          (if the request is retriable?), or nil if it should stop.
                          Defaults to cognitect.aws.retry/default-backoff.
  By default, all clients use shared http-client, credentials-provider, and
  region-provider instances which use a small collection of daemon threads.
  Alpha. Subject to change.</pre>
You should use the `:endpoint-override` key. There is no support for `:endpoint`.</z><z id="t1608242700" t="dchelimsky I see that endpoint is included in the destructuring vector. I’ll remove that. I can’t recall if it was ever supported."><y>#</y><d>2020-12-17</d><h>22:05</h><r>dchelimsky</r>I see that <code>endpoint</code> is included in the destructuring vector. I’ll remove that. I can’t recall if it was ever supported.</z><z id="t1608257592" t="dchelimsky https://github.com/cognitect-labs/aws-api/issues/161 / https://github.com/cognitect-labs/aws-api/commit/93c6ac08141a168fd430ce3fb043e2b6f62e8bf4"><y>#</y><d>2020-12-18</d><h>02:13</h><r>dchelimsky</r><a href="https://github.com/cognitect-labs/aws-api/issues/161" target="_blank">https://github.com/cognitect-labs/aws-api/issues/161</a> / <a href="https://github.com/cognitect-labs/aws-api/commit/93c6ac08141a168fd430ce3fb043e2b6f62e8bf4" target="_blank">https://github.com/cognitect-labs/aws-api/commit/93c6ac08141a168fd430ce3fb043e2b6f62e8bf4</a></z><z id="t1609702400" t="borkdude [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] Thanks for fixing the reflection warnings on aws-api master. I and a group of people are trying to use the lib with GraalVM native-image and that helps. Can we use the master version using deps.edn? Is this just a matter of updating com.cognitect.aws/api {:mvn/version &quot;0.8.484&quot;} to the master SHA?"><y>#</y><d>2021-01-03</d><h>19:33</h><w>borkdude</w><a>@dchelimsky</a> Thanks for fixing the reflection warnings on aws-api master. I and a group of people are trying to use the lib with GraalVM native-image and that helps.
Can we use the master version using deps.edn? Is this just a matter of updating <code>com.cognitect.aws/api       {:mvn/version &quot;0.8.484&quot;}</code> to the master SHA?</z><z id="t1609702541" t="dchelimsky Yes, that’s how you do it."><y>#</y><d>2021-01-03</d><h>19:35</h><r>dchelimsky</r>Yes, that’s how you do it.</z><z id="t1609702558" t="borkdude cool, thanks"><y>#</y><d>2021-01-03</d><h>19:35</h><r>borkdude</r>cool, thanks</z><z id="t1609702628" t="valtteri Sounds interesting! Is there discussion somewhere where I could follow?"><y>#</y><d>2021-01-03</d><h>19:37</h><r>valtteri</r>Sounds interesting! Is there discussion somewhere where I could follow?</z><z id="t1609702677" t="borkdude [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] About using it with native-image?"><y>#</y><d>2021-01-03</d><h>19:37</h><r>borkdude</r><a>@U6N4HSMFW</a> About using it with native-image?</z><z id="t1609702723" t="valtteri Yea, I’m guessing you’re trying to get it to work with babashka? "><y>#</y><d>2021-01-03</d><h>19:38</h><r>valtteri</r>Yea, I’m guessing you’re trying to get it to work with babashka? </z><z id="t1609702735" t="borkdude [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] correct, we&apos;re writing a babashka pod"><y>#</y><d>2021-01-03</d><h>19:38</h><r>borkdude</r><a>@U6N4HSMFW</a> correct, we&apos;re writing a babashka pod</z><z id="t1609702852" t="valtteri That would be super cool. I’m interested to spectate at least but I can also try to help if I can. My gh username is vharmain"><y>#</y><d>2021-01-03</d><h>19:40</h><r>valtteri</r>That would be super cool. I’m interested to spectate at least but I can also try to help if I can. My gh username is vharmain</z><z id="t1609702860" t="borkdude OK, I&apos;ll add you"><y>#</y><d>2021-01-03</d><h>19:41</h><r>borkdude</r>OK, I&apos;ll add you</z><z id="t1609702873" t="valtteri Thanks a lot!"><y>#</y><d>2021-01-03</d><h>19:41</h><r>valtteri</r>Thanks a lot!</z><z id="t1609710223" t="borkdude [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] I&apos;m looking at a reflection warning in the cognitect.http-client code, but I have trouble finding where that is hosted on github. Is that generated code perhaps?"><y>#</y><d>2021-01-03</d><h>21:43</h><r>borkdude</r><a>@dchelimsky</a> I&apos;m looking at a reflection warning in the cognitect.http-client code, but I have trouble finding where that is hosted on github. Is that generated code perhaps?</z><z id="t1609710520" t="borkdude it&apos;s around line 108 in the cognitect.http-client namespace: &quot;Class java.nio.HeapByteBuffer[] is instantiated reflectively but was never registered. Register the class by using org.graalvm.nativeimage.hosted.RuntimeReflection&quot;"><y>#</y><d>2021-01-03</d><h>21:48</h><r>borkdude</r>it&apos;s around line 108 in the cognitect.http-client namespace:
<pre>&quot;Class java.nio.HeapByteBuffer[] is instantiated reflectively but was never registered. Register the class by using org.graalvm.nativeimage.hosted.RuntimeReflection&quot;</pre></z><z id="t1609710572" t="borkdude Can also fix this using a config"><y>#</y><d>2021-01-03</d><h>21:49</h><r>borkdude</r>Can also fix this using a config</z><z id="t1609712005" t="dchelimsky The code is open source (it’s in the jar), but the repo is not public."><y>#</y><d>2021-01-03</d><h>22:13</h><r>dchelimsky</r>The code is open source (it’s in the jar), but the repo is not public.</z><z id="t1609712052" t="borkdude right"><y>#</y><d>2021-01-03</d><h>22:14</h><r>borkdude</r>right</z><z id="t1609712073" t="borkdude yeah, I already found the source using (slurp (io/resource ...)) :)"><y>#</y><d>2021-01-03</d><h>22:14</h><r>borkdude</r>yeah, I already found the source using <code>(slurp (io/resource ...))</code> :)</z><z id="t1609712178" t="dchelimsky How can you fix it with a config?"><y>#</y><d>2021-01-03</d><h>22:16</h><r>dchelimsky</r>How can you fix it with a config?</z><z id="t1609712379" t="borkdude In GraalVM native-image you can pass it a config with classes that need reflection: Mine now looks like: [ {&quot;name&quot;: &quot;[Ljava.nio.HeapByteBuffer;&quot;} ] to fix the issue with the http-client"><y>#</y><d>2021-01-03</d><h>22:19</h><r>borkdude</r>In GraalVM native-image you can pass it a config with classes that need reflection:
Mine now looks like:
<pre>[
  {&quot;name&quot;: &quot;[Ljava.nio.HeapByteBuffer;&quot;}
]</pre>
to fix the issue with the http-client</z><z id="t1609712413" t="borkdude Preferably you fix the reflection issue, but if you really can&apos;t this is a way to deal with it"><y>#</y><d>2021-01-03</d><h>22:20</h><r>borkdude</r>Preferably you fix the reflection issue, but if you really can&apos;t this is a way to deal with it</z><z id="t1609712434" t="dchelimsky I don’t own that repo, but I know the people who do 😉"><y>#</y><d>2021-01-03</d><h>22:20</h><r>dchelimsky</r>I don’t own that repo, but I know the people who do <b>😉</b></z><z id="t1609712459" t="borkdude I meant &quot;you&quot; in the general sense :)"><y>#</y><d>2021-01-03</d><h>22:20</h><r>borkdude</r>I meant &quot;you&quot; in the general sense :)</z><z id="t1609712471" t="borkdude when dealing with native-image"><y>#</y><d>2021-01-03</d><h>22:21</h><r>borkdude</r>when dealing with native-image</z><z id="t1609713241" t="dchelimsky I’ve reported it, but I don’t anticipate hearing anything back before tomorrow. I’ll follow up here when I know something."><y>#</y><d>2021-01-03</d><h>22:34</h><r>dchelimsky</r>I’ve reported it, but I don’t anticipate hearing anything back before tomorrow. I’ll follow up here when I know something.</z><z id="t1609713413" t="borkdude cool, thanks a lot"><y>#</y><d>2021-01-03</d><h>22:36</h><r>borkdude</r>cool, thanks a lot</z><z id="t1609763065" t="stuarthalloway [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] is there a way to repro the http-client reflection warning on the JVM? I am happy to fix it but don&apos;t see a warning when loading the namespace (from Java 11)."><y>#</y><d>2021-01-04</d><h>12:24</h><w>stuarthalloway</w><a>@borkdude</a> is there a way to repro the http-client reflection warning on the JVM? I am happy to fix it but don&apos;t see a warning when loading the namespace (from Java 11).</z><z id="t1609764184" t="borkdude [:attrs {:href &quot;/_/_/users/U072WS7PE&quot;}] After closer inspection, I think the warning came from using import java.lang.reflect.Array; . This is the warning I got from graalvm: &quot;Class java.nio.HeapByteBuffer[] is instantiated reflectively but was never registered. Register the class by using org.graalvm.nativeimage.hosted.RuntimeReflection&quot; from around line 108 in the cognitect.http-client namespace and this config fixed it for me (using a reflection.json config file): [ {&quot;name&quot;: &quot;[Ljava.nio.HeapByteBuffer;&quot;} ] So it&apos;s no longer a problem for me and probably not something that can be fixed without avoiding reflect.Array , which is used by into-array (although it&apos;s the first time I encountered this specific problem with into-array ). Thanks for looking into it and sorry for taking up your time."><y>#</y><d>2021-01-04</d><h>12:43</h><w>borkdude</w><a>@stuarthalloway</a> After closer inspection, I think the warning came from using <code>import java.lang.reflect.Array;</code>. This is the warning I got from graalvm:
<pre>&quot;Class java.nio.HeapByteBuffer[] is instantiated reflectively but was never registered. Register the class by using org.graalvm.nativeimage.hosted.RuntimeReflection&quot;</pre>
from around line 108 in the cognitect.http-client namespace
and this config fixed it for me (using a reflection.json config file):
<pre>[
  {&quot;name&quot;: &quot;[Ljava.nio.HeapByteBuffer;&quot;}
]</pre>
So it&apos;s no longer a problem for me and probably not something that can be fixed without avoiding <code>reflect.Array</code>, which is used by <code>into-array</code> (although it&apos;s the first time I encountered this specific problem with <code>into-array</code>). Thanks for looking into it and sorry for taking up your time.</z><z id="t1609765646" t="stuarthalloway [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] Thanks for all you are doing exploring that is possible with GraalVM. I don&apos;t use it for day job stuff (yet?), but if there is low hanging fruit happy to help grab it."><y>#</y><d>2021-01-04</d><h>13:07</h><w>stuarthalloway</w><a>@borkdude</a> Thanks for all you are doing exploring that is possible with GraalVM. I don&apos;t use it for day job stuff (yet?), but if there is low hanging fruit happy to help grab it.</z><z id="t1609765910" t="borkdude Good to hear. For context, we are working on a babashka aws pod (which wraps aws-api), which runs natively, so you can use aws-api in scripts without a JVM with very fast startup time."><y>#</y><d>2021-01-04</d><h>13:11</h><w>borkdude</w>Good to hear. For context, we are working on a babashka aws pod (which wraps aws-api), which runs natively, so you can use aws-api in scripts without a JVM with very fast startup time.</z><z id="t1609766178" t="borkdude Babashka pods are basically CLIs but they expose their data through EDN or Transit (or JSON) and can be called using normal functions instead of shelling out, RPC-style."><y>#</y><d>2021-01-04</d><h>13:16</h><r>borkdude</r>Babashka pods are basically CLIs but they expose their data through EDN or Transit (or JSON) and can be called using normal functions instead of shelling out, RPC-style.</z><z id="t1609766927" t="stuarthalloway that sounds terrific"><y>#</y><d>2021-01-04</d><h>13:28</h><r>stuarthalloway</r>that sounds terrific</z><z id="t1609766986" t="borkdude This is a list of existing pods that can already be used from babashka: https://github.com/babashka/pod-registry A few of them are written in Clojure and compiled with GraalVM native-image."><y>#</y><d>2021-01-04</d><h>13:29</h><r>borkdude</r>This is a list of existing pods that can already be used from babashka:

<a href="https://github.com/babashka/pod-registry" target="_blank">https://github.com/babashka/pod-registry</a>

A few of them are written in Clojure and compiled with GraalVM native-image.</z><z id="t1609788874" t="ghadi Which AWS service(s) are you planning on exposing?"><y>#</y><d>2021-01-04</d><h>19:34</h><r>ghadi</r>Which AWS service(s) are you planning on exposing?</z><z id="t1609789128" t="borkdude all that are available in aws-api"><y>#</y><d>2021-01-04</d><h>19:38</h><r>borkdude</r>all that are available in aws-api</z><z id="t1609789224" t="borkdude we have a working prototype, but there is some stuff around aws-api returning an inputstream for resources from s3 (and possibly others) which we have to translate into bytes, because it has to go over the wire via transit"><y>#</y><d>2021-01-04</d><h>19:40</h><r>borkdude</r>we have a working prototype, but there is some stuff around aws-api returning an inputstream for resources from s3 (and possibly others) which we have to translate into bytes, because it has to go over the wire via transit</z><z id="t1609789248" t="borkdude it seems that aws-api turns a byte buffer into an inputstream for some reason"><y>#</y><d>2021-01-04</d><h>19:40</h><r>borkdude</r>it seems that aws-api turns a byte buffer into an inputstream for some reason</z><z id="t1609788770" t="lukasz Any idea how to pass x-aws-acl header in the PutObject when using cognitect-labs/aws-api? - I tried overriding the default multimethod for modify-http-request but no luck so far. It&apos;s relevant when uploading files so s3 and making them publicly accessible in one request"><y>#</y><d>2021-01-04</d><h>19:32</h><w>lukasz</w>Any idea how to pass <code>x-aws-acl</code> header in the <code>PutObject</code> when using cognitect-labs/aws-api? - I tried overriding the default multimethod for <code>modify-http-request</code> but no luck so far. It&apos;s relevant when uploading files so s3 and making them publicly accessible in one request</z><z id="t1609788983" t="ghadi Which s3 API?"><y>#</y><d>2021-01-04</d><h>19:36</h><r>ghadi</r>Which s3 API?</z><z id="t1609789939" t="lukasz Ah, forgot to mention - :PutObject"><y>#</y><d>2021-01-04</d><h>19:52</h><r>lukasz</r>Ah, forgot to mention - <code>:PutObject</code></z><z id="t1609791040" t="dchelimsky ~You can (should?) use ~"><y>#</y><d>2021-01-04</d><h>20:10</h><r>dchelimsky</r>~You can (should?) use ~</z><z id="t1609791092" t="dchelimsky ~I see you want to do it in one request, but that’s not how it’s designed.~"><y>#</y><d>2021-01-04</d><h>20:11</h><r>dchelimsky</r>~I see you want to do it in one request, but that’s not how it’s designed.~</z><z id="t1609791422" t="ghadi is the ACL not available on PutObject? (aws/doc client :PutObject)"><y>#</y><d>2021-01-04</d><h>20:17</h><r>ghadi</r>is the ACL not available on PutObject?  <code>(aws/doc client :PutObject)</code></z><z id="t1609791424" t="dchelimsky [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] it’s x-amz-acl , not x-aws-acl . Did your attempt with modify-http-request use the right header name?"><y>#</y><d>2021-01-04</d><h>20:17</h><r>dchelimsky</r><a>@U0JEFEZH6</a> it’s <code>x-amz-acl</code>, not <code>x-aws-acl</code>. Did your attempt with <code>modify-http-request</code> use the right header name?</z><z id="t1609791514" t="ghadi you should not need to mess with with modify-http-request for this"><y>#</y><d>2021-01-04</d><h>20:18</h><r>ghadi</r>you should not need to mess with with <code>modify-http-request</code> for this</z><z id="t1609791522" t="ghadi pass :ACL"><y>#</y><d>2021-01-04</d><h>20:18</h><r>ghadi</r>pass <code>:ACL</code></z><z id="t1609791541" t="ghadi [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}]"><y>#</y><d>2021-01-04</d><h>20:19</h><r>ghadi</r><a>@U0JEFEZH6</a></z><z id="t1609791553" t="dchelimsky &gt; is the ACL not available on PutObject? No, [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] , it is not not available on PutObject."><y>#</y><d>2021-01-04</d><h>20:19</h><r>dchelimsky</r>&gt; is the ACL not available on PutObject?
No, <a>@U050ECB92</a>, it is not not available on PutObject.</z><z id="t1609791651" t="dchelimsky FYI :ACL is also available on :CreateBucket"><y>#</y><d>2021-01-04</d><h>20:20</h><r>dchelimsky</r>FYI <code>:ACL</code> is also available on <code>:CreateBucket</code></z><z id="t1609791886" t="dchelimsky Apparently, my joke about “not not” was missed by at least one reader, so to clarify …. :ACL is absolutely, definitely, 100% a supported key on :PutObject"><y>#</y><d>2021-01-04</d><h>20:24</h><r>dchelimsky</r>Apparently, my joke about “not not” was missed by at least one reader, so to clarify …. <code>:ACL</code> is absolutely, definitely, 100% a supported key on <code>:PutObject</code></z><z id="t1609791911" t="dchelimsky Got that [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] ?"><y>#</y><d>2021-01-04</d><h>20:25</h><r>dchelimsky</r>Got that <a>@U0JEFEZH6</a>?</z><z id="t1609792359" t="lukasz I&apos;ll double check in ~45m, AFK right now. But thanks for the pointers - I&apos;m fairy sure there were no typos, but I&apos;ll verify everything :thumbsup:"><y>#</y><d>2021-01-04</d><h>20:32</h><r>lukasz</r>I&apos;ll double check in ~45m, AFK right now. But thanks for the pointers - I&apos;m fairy sure there were no typos, but I&apos;ll verify everything <b>:thumbsup:</b></z><z id="t1609792406" t="dchelimsky OK. I’d recommend you don’t worry about the header and just use the :ACL key in the :request map. Let us know how it goes!"><y>#</y><d>2021-01-04</d><h>20:33</h><r>dchelimsky</r>OK. I’d recommend you don’t worry about the header and just use the <code>:ACL</code> key in the <code>:request</code> map. Let us know how it goes!</z><z id="t1609795455" t="lukasz [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] that works, thank you! Next time, I&apos;ll check aws.client.api/doc "><y>#</y><d>2021-01-04</d><h>21:24</h><r>lukasz</r><a>@U0ENYLGTA</a> that works, thank you! Next time, I&apos;ll check <code>aws.client.api/doc </code></z><z id="t1609795467" t="lukasz as the ACL param is listed there, of course facepalm"><y>#</y><d>2021-01-04</d><h>21:24</h><r>lukasz</r>as the ACL param is listed there, of course <b>facepalm</b></z><z id="t1609797626" t="dchelimsky Glad that worked out."><y>#</y><d>2021-01-04</d><h>22:00</h><r>dchelimsky</r>Glad that worked out.</z><z id="t1609937311" t="borkdude"><y>#</y><d>2021-01-06</d><h>12:48</h><w>borkdude</w></z><z id="t1609945917" t="lukasz Amazing 🎉"><y>#</y><d>2021-01-06</d><h>15:11</h><w>lukasz</w>Amazing <b>🎉</b></z><z id="t1609946003" t="dchelimsky Congratulations [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] !"><y>#</y><d>2021-01-06</d><h>15:13</h><w>dchelimsky</w>Congratulations <a>@borkdude</a>!</z><z id="t1609946039" t="dchelimsky (and [:attrs {:href &quot;/_/_/users/U0FT7SRLP&quot;}] , [:attrs {:href &quot;/_/_/users/U7ERLH6JX&quot;}] , and [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] !)"><y>#</y><d>2021-01-06</d><h>15:13</h><w>dchelimsky</w>(and <a>@jeroenvandijk</a>, <a>@rahul080327</a>, and <a>@valtteri</a>!)</z><z id="t1609946277" t="dchelimsky [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] I assume https://github.com/babashka/pod-babashka-aws/blob/02b775df2af0b4d9db9bf93166288fabed1d43e8/deps.edn#L13-L14 is referencing the sha instead of a release because you’re waiting on a release that addresses the reflection issues, right?"><y>#</y><d>2021-01-06</d><h>15:17</h><w>dchelimsky</w><a>@borkdude</a> I assume <a href="https://github.com/babashka/pod-babashka-aws/blob/02b775df2af0b4d9db9bf93166288fabed1d43e8/deps.edn#L13-L14" target="_blank">https://github.com/babashka/pod-babashka-aws/blob/02b775df2af0b4d9db9bf93166288fabed1d43e8/deps.edn#L13-L14</a> is referencing the sha instead of a release because you’re waiting on a release that addresses the reflection issues, right?</z><z id="t1609946388" t="borkdude Correct, but it&apos;s not a problem for us, since we use deps.edn to build everything"><y>#</y><d>2021-01-06</d><h>15:19</h><r>borkdude</r>Correct, but it&apos;s not a problem for us, since we use deps.edn to build everything</z><z id="t1610379644" t="dchelimsky [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] Cool. Just FYI that I quietly released it over the weekend: aws-api-0.8.498 with the reflection issues addressed."><y>#</y><d>2021-01-11</d><h>15:40</h><r>dchelimsky</r><a>@borkdude</a> Cool. Just FYI that I quietly released it over the weekend: aws-api-0.8.498 with the reflection issues addressed.</z><z id="t1610379681" t="borkdude 🎉 thank you!"><y>#</y><d>2021-01-11</d><h>15:41</h><r>borkdude</r><b>🎉</b>  thank you!</z><z id="t1609946312" t="Alex Miller (Clojure team) nice"><y>#</y><d>2021-01-06</d><h>15:18</h><w>Alex Miller (Clojure team)</w>nice</z><z id="t1609946557" t="lukasz ☝️ same!"><y>#</y><d>2021-01-06</d><h>15:22</h><w>lukasz</w><b>☝️</b> same!</z><z id="t1610088279" t="viesti on GraalVM/native-image and Lambda, here&apos;s a post on using the newly released container support to create GraalVM native-image Lambdas: https://nitor.com/en/articles/fast-cold-starts-for-clojure-in-aws-lambda-using-graalvm-native-image (repo of the project, has some Terraform for deployment too https://github.com/luontola/native-clojure-lambda )"><y>#</y><d>2021-01-08</d><h>06:44</h><w>viesti</w>on GraalVM/native-image and Lambda, here&apos;s a post on using the newly released container support to create GraalVM native-image Lambdas: <a href="https://nitor.com/en/articles/fast-cold-starts-for-clojure-in-aws-lambda-using-graalvm-native-image" target="_blank">https://nitor.com/en/articles/fast-cold-starts-for-clojure-in-aws-lambda-using-graalvm-native-image</a> (repo of the project, has some Terraform for deployment too <a href="https://github.com/luontola/native-clojure-lambda" target="_blank">https://github.com/luontola/native-clojure-lambda</a>)</z><z id="t1610112015" t="borkdude &gt; The cold start time goes from 1500ms down to 10ms! nice :)"><y>#</y><d>2021-01-08</d><h>13:20</h><w>borkdude</w>&gt; The cold start time goes from 1500ms down to 10ms! 
nice :)</z><z id="t1610373325" t="lgouger Hoping this is useful and also looking for feedback.  paging-invoke a function to lazily call aws/invoke to page through large result sets. https://gist.github.com/lgouger/2262e2d2503306f2595e48a7888f4e73"><y>#</y><d>2021-01-11</d><h>13:55</h><w>lgouger</w>Hoping this is useful and also looking for feedback.  paging-invoke a function to lazily call aws/invoke to page through large result sets.
<a href="https://gist.github.com/lgouger/2262e2d2503306f2595e48a7888f4e73" target="_blank">https://gist.github.com/lgouger/2262e2d2503306f2595e48a7888f4e73</a></z><z id="t1610373398" t="borkdude nice, also feel free to share in the #babashka channel"><y>#</y><d>2021-01-11</d><h>13:56</h><r>borkdude</r>nice, also feel free to share in the #babashka channel</z><z id="t1610396571" t="hiredman https://clojure.atlassian.net/browse/CLJ-1906 and https://clojure.atlassian.net/browse/CLJ-2555"><y>#</y><d>2021-01-11</d><h>20:22</h><r>hiredman</r><a href="https://clojure.atlassian.net/browse/CLJ-1906" target="_blank">https://clojure.atlassian.net/browse/CLJ-1906</a> and <a href="https://clojure.atlassian.net/browse/CLJ-2555" target="_blank">https://clojure.atlassian.net/browse/CLJ-2555</a></z><z id="t1610542750" t="borkdude Quick bb script to update deps.edn with all the latest aws-api deps: https://github.com/babashka/pod-babashka-aws/blob/main/script/update-deps.clj Also bumped pod-babashka-aws to the latest aws-api deps."><y>#</y><d>2021-01-13</d><h>12:59</h><w>borkdude</w>Quick bb script to update deps.edn with all the latest aws-api deps:
<a href="https://github.com/babashka/pod-babashka-aws/blob/main/script/update-deps.clj" target="_blank">https://github.com/babashka/pod-babashka-aws/blob/main/script/update-deps.clj</a>

Also bumped pod-babashka-aws to the latest aws-api deps.</z><z id="t1611042689" t="zendevil.eth I’m using amazonica to upload a file to a bucket like so:"><y>#</y><d>2021-01-19</d><h>07:51</h><w>zendevil.eth</w>I’m using amazonica to upload a file to a bucket like so:</z><z id="t1611042700" t="zendevil.eth (s3/put-object “humboi-videos” “video1.mp4&quot; “./resources/public/sample.mp4”)"><y>#</y><d>2021-01-19</d><h>07:51</h><w>zendevil.eth</w>(s3/put-object “humboi-videos” “video1.mp4&quot;
                 “./resources/public/sample.mp4”)</z><z id="t1611042773" t="zendevil.eth The objects that are created are not publicly readable, and I want them to be publicly readable. How to do this? Secondly, how to programmatically access the object uri?"><y>#</y><d>2021-01-19</d><h>07:52</h><w>zendevil.eth</w>The objects that are created are not publicly readable, and I want them to be publicly readable. How to do this? Secondly, how to programmatically access the object uri?</z><z id="t1611068723" t="lukasz You need to pass :access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;] to put-object"><y>#</y><d>2021-01-19</d><h>15:05</h><w>lukasz</w>You need to pass <code>:access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;]</code> to <code>put-object</code></z><z id="t1611068816" t="lukasz [:attrs {:href &quot;/_/_/users/U01F1TM2FD5&quot;}] The URIs... as far as I remember , the public ones you have to construct yourself - the follow the same pattern as described here: https://docs.aws.amazon.com/general/latest/gr/s3.html For pre-signed, limited access urls (which are usually better solution than making objects public) you have to use the S3 SDK directly by using the GeneratePresignedUrlRequest class"><y>#</y><d>2021-01-19</d><h>15:06</h><w>lukasz</w><a>@ps</a> The URIs... as far as I remember , the public ones you have to construct yourself - the follow the same pattern as described here: <a href="https://docs.aws.amazon.com/general/latest/gr/s3.html" target="_blank">https://docs.aws.amazon.com/general/latest/gr/s3.html</a> For pre-signed, limited access urls (which are usually better solution than making objects public) you have to use the S3 SDK directly by using the <code>GeneratePresignedUrlRequest</code> class</z><z id="t1611230385" t="zendevil.eth thanks [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}]"><y>#</y><d>2021-01-21</d><h>11:59</h><r>zendevil.eth</r>thanks <a>@U0JEFEZH6</a></z><z id="t1611245828" t="kenny (def sp (aws-api/client {:api :savingsplans})) (aws-api/invoke sp {:op :DescribeSavingsPlansOfferingRates :request {:products [&quot;EC2&quot;]}}) =&gt; {:message &quot;Unsupported Media Type&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} It seems the savingsplan API is not supported? I can get a result back via the CLI *aws* savingsplans describe-savings-plans-offerings --product-types EC2"><y>#</y><d>2021-01-21</d><h>16:17</h><w>kenny</w><pre>(def sp (aws-api/client {:api :savingsplans}))
(aws-api/invoke sp
  {:op      :DescribeSavingsPlansOfferingRates
   :request {:products [&quot;EC2&quot;]}})
=&gt; {:message &quot;Unsupported Media Type&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre>
It seems the savingsplan API is not supported? I can get a result back via the CLI <code>*aws* savingsplans describe-savings-plans-offerings --product-types EC2</code></z><z id="t1611246110" t="kenny com.cognitect.aws/api {:mvn/version &quot;0.8.498&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.11.934&quot;} com.cognitect.aws/savingsplans {:mvn/version &quot;809.2.784.0&quot;} "><y>#</y><d>2021-01-21</d><h>16:21</h><r>kenny</r><pre>com.cognitect.aws/api          {:mvn/version &quot;0.8.498&quot;}
 com.cognitect.aws/endpoints    {:mvn/version &quot;1.1.11.934&quot;}
 com.cognitect.aws/savingsplans {:mvn/version &quot;809.2.784.0&quot;}</pre>
</z><z id="t1611246949" t="dchelimsky What does (aws-api/doc sp :DescribeSavingsPlansOfferingRates) say?"><y>#</y><d>2021-01-21</d><h>16:35</h><r>dchelimsky</r>What does <code>(aws-api/doc sp :DescribeSavingsPlansOfferingRates)</code> say?</z><z id="t1611247012" t="kenny {:serviceCodes [:seq-of [:one-of [&quot;AmazonEC2&quot; &quot;AmazonECS&quot; &quot;AWSLambda&quot;]]], :filters [:seq-of {:name [:one-of [&quot;region&quot; &quot;instanceFamily&quot; &quot;instanceType&quot; &quot;productDescription&quot; &quot;tenancy&quot; &quot;productId&quot;]], :values [:seq-of string]}], :savingsPlanOfferingIds [:seq-of string], :savingsPlanPaymentOptions [:seq-of [:one-of [&quot;All Upfront&quot; &quot;Partial Upfront&quot; &quot;No Upfront&quot;]]], :products [:seq-of [:one-of [&quot;EC2&quot; &quot;Fargate&quot; &quot;Lambda&quot;]]], :usageTypes [:seq-of string], :savingsPlanTypes [:seq-of [:one-of [&quot;Compute&quot; &quot;EC2Instance&quot;]]], :operations [:seq-of string], :nextToken string, :maxResults integer}"><y>#</y><d>2021-01-21</d><h>16:36</h><r>kenny</r><pre>{:serviceCodes
 [:seq-of [:one-of [&quot;AmazonEC2&quot; &quot;AmazonECS&quot; &quot;AWSLambda&quot;]]],
 :filters
 [:seq-of
  {:name
   [:one-of
    [&quot;region&quot;
     &quot;instanceFamily&quot;
     &quot;instanceType&quot;
     &quot;productDescription&quot;
     &quot;tenancy&quot;
     &quot;productId&quot;]],
   :values [:seq-of string]}],
 :savingsPlanOfferingIds [:seq-of string],
 :savingsPlanPaymentOptions
 [:seq-of [:one-of [&quot;All Upfront&quot; &quot;Partial Upfront&quot; &quot;No Upfront&quot;]]],
 :products [:seq-of [:one-of [&quot;EC2&quot; &quot;Fargate&quot; &quot;Lambda&quot;]]],
 :usageTypes [:seq-of string],
 :savingsPlanTypes [:seq-of [:one-of [&quot;Compute&quot; &quot;EC2Instance&quot;]]],
 :operations [:seq-of string],
 :nextToken string,
 :maxResults integer}</pre></z></g><g id="s14"><z id="t1611247037" t="kenny ^ for the request"><y>#</y><d>2021-01-21</d><h>16:37</h><r>kenny</r>^ for the request</z><z id="t1611247039" t="dchelimsky What is required?"><y>#</y><d>2021-01-21</d><h>16:37</h><r>dchelimsky</r>What is required?</z><z id="t1611247048" t="dchelimsky (below what you posted)"><y>#</y><d>2021-01-21</d><h>16:37</h><r>dchelimsky</r>(below what you posted)</z><z id="t1611247069" t="kenny Nothing"><y>#</y><d>2021-01-21</d><h>16:37</h><r>kenny</r>Nothing</z><z id="t1611247084" t="kenny"><y>#</y><d>2021-01-21</d><h>16:38</h><r>kenny</r></z><z id="t1611247117" t="kenny (aws-api/invoke sp {:op :DescribeSavingsPlansOfferingRates}) =&gt; {:message &quot;Unsupported Media Type&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}"><y>#</y><d>2021-01-21</d><h>16:38</h><r>kenny</r><pre>(aws-api/invoke sp
  {:op :DescribeSavingsPlansOfferingRates})
=&gt; {:message &quot;Unsupported Media Type&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre></z><z id="t1611247125" t="dchelimsky &gt; It seems the savingsplan API is not supported You’d be getting different errors if that were true."><y>#</y><d>2021-01-21</d><h>16:38</h><r>dchelimsky</r>&gt;  It seems the savingsplan API is not supported
You’d be getting different errors if that were true.</z><z id="t1611247152" t="kenny Perhaps my definition of supported is different than yours? 🙂"><y>#</y><d>2021-01-21</d><h>16:39</h><r>kenny</r>Perhaps my definition of supported is different than yours? <b>🙂</b></z><z id="t1611247286" t="dchelimsky We don’t “support apis” in that definition, but we’re splitting hairs."><y>#</y><d>2021-01-21</d><h>16:41</h><r>dchelimsky</r>We don’t “support apis” in that definition, but we’re splitting hairs.</z><z id="t1611247308" t="dchelimsky Would you please report this as a bug?"><y>#</y><d>2021-01-21</d><h>16:41</h><r>dchelimsky</r>Would you please report this as a bug?</z><z id="t1611247312" t="kenny Sure"><y>#</y><d>2021-01-21</d><h>16:41</h><r>kenny</r>Sure</z><z id="t1611247315" t="dchelimsky I can’t really investigate it right now."><y>#</y><d>2021-01-21</d><h>16:41</h><r>dchelimsky</r>I can’t really investigate it right now.</z><z id="t1611247316" t="dchelimsky Thanks."><y>#</y><d>2021-01-21</d><h>16:41</h><r>dchelimsky</r>Thanks.</z><z id="t1611247327" t="kenny Do you have any idea where I could look to fix this?"><y>#</y><d>2021-01-21</d><h>16:42</h><r>kenny</r>Do you have any idea where I could look to fix this?</z><z id="t1611247478" t="dchelimsky I’d look at the request info from (meta (aws-api/invoke sp {:op :DescribeSavingsPlansOfferingRates})) and check to see the headers align w/ the aws docs."><y>#</y><d>2021-01-21</d><h>16:44</h><r>dchelimsky</r>I’d look at the request info from
<pre>(meta (aws-api/invoke sp
  {:op :DescribeSavingsPlansOfferingRates}))</pre>
and check to see the headers align w/ the aws docs.</z><z id="t1611247576" t="dchelimsky Also, we’ve had cases where required things are not listed as such e.g. https://github.com/cognitect-labs/aws-api/issues/158"><y>#</y><d>2021-01-21</d><h>16:46</h><r>dchelimsky</r>Also, we’ve had cases where required things are not listed as such e.g. <a href="https://github.com/cognitect-labs/aws-api/issues/158" target="_blank">https://github.com/cognitect-labs/aws-api/issues/158</a></z><z id="t1611247605" t="kenny I was thinking that, however, my call via the aws cli succeeds."><y>#</y><d>2021-01-21</d><h>16:46</h><r>kenny</r>I was thinking that, however, my call via the aws cli succeeds.</z><z id="t1611247618" t="kenny Maybe they implicitly include some params?"><y>#</y><d>2021-01-21</d><h>16:46</h><r>kenny</r>Maybe they implicitly include some params?</z><z id="t1611247658" t="dchelimsky That’s the problem in the issue I linked"><y>#</y><d>2021-01-21</d><h>16:47</h><r>dchelimsky</r>That’s the problem in the issue I linked</z><z id="t1611248031" t="kenny Thanks for the info. Will dig in. Here&apos;s the issue https://github.com/cognitect-labs/aws-api/issues/168"><y>#</y><d>2021-01-21</d><h>16:53</h><r>kenny</r>Thanks for the info. Will dig in. Here&apos;s the issue <a href="https://github.com/cognitect-labs/aws-api/issues/168" target="_blank">https://github.com/cognitect-labs/aws-api/issues/168</a></z><z id="t1611248184" t="kenny &gt; and check to see the headers align w/ the aws docs. Aren&apos;t headers common across all services?"><y>#</y><d>2021-01-21</d><h>16:56</h><r>kenny</r>&gt; and check to see the headers align w/ the aws docs.
Aren&apos;t headers common across all services?</z><z id="t1611250655" t="Alex Miller (Clojure team) :rolling_on_the_floor_laughing:"><y>#</y><d>2021-01-21</d><h>17:37</h><r>Alex Miller (Clojure team)</r><b>:rolling_on_the_floor_laughing:</b></z><z id="t1611250975" t="kenny I know s3 is a monster. Was somewhat hoping newer aws apis would be mostly very similar. Do you know of service specific docs for the headers? The regular API references only point to the &quot;CommonParameters&quot; section."><y>#</y><d>2021-01-21</d><h>17:42</h><r>kenny</r>I know s3 is a monster. Was somewhat hoping newer aws apis would be mostly very similar. Do you know of service specific docs for the headers? The regular API references only point to the &quot;CommonParameters&quot; section.</z><z id="t1611494221" t="dchelimsky I’m updating the issue so please check there for more info https://github.com/cognitect-labs/aws-api/issues/168"><y>#</y><d>2021-01-24</d><h>13:17</h><r>dchelimsky</r>I’m updating the issue so please check there for more info <a href="https://github.com/cognitect-labs/aws-api/issues/168" target="_blank">https://github.com/cognitect-labs/aws-api/issues/168</a></z><z id="t1611501649" t="kenny Great, thanks"><y>#</y><d>2021-01-24</d><h>15:20</h><r>kenny</r>Great, thanks</z><z id="t1613401907" t="Lyn Headley Hi 👋 . I&apos;m wondering if these goals seem straightforward to build, and if there are any writeups touching on them: 1. Write a pure clojure, serverside web app without any mobile or javascript support. 2. Use api gateway and cognito to authenticate once per session. I haven&apos;t found much out there on this exact combination so any discussion or pointers would be much appreciated."><y>#</y><d>2021-02-15</d><h>15:11</h><w>Lyn Headley</w>Hi <b>👋</b> . I&apos;m wondering if these goals seem straightforward to build, and if there are any writeups touching on them: 1. Write a pure clojure, serverside web app without any mobile or javascript support. 2. Use api gateway and cognito to authenticate once per session. I haven&apos;t found much out there on this exact combination so any discussion or pointers would be much appreciated.</z><z id="t1613405092" t="Joe Lane I’ve done several of these on client projects, seemed like a fine approach to me. "><y>#</y><d>2021-02-15</d><h>16:04</h><r>Joe Lane</r>I’ve done several of these on client projects, seemed like a fine approach to me. </z><z id="t1613508078" t="fmnoise Hi! Do you know any good library supporting https://developer.amazon.com/docs/incentives-api/incentives-api.html ? Or maybe any plans to add this api into https://github.com/cognitect-labs/aws-api ?"><y>#</y><d>2021-02-16</d><h>20:41</h><w>fmnoise</w>Hi! Do you know any good library supporting <a href="https://developer.amazon.com/docs/incentives-api/incentives-api.html" target="_blank">https://developer.amazon.com/docs/incentives-api/incentives-api.html</a> ? Or maybe any plans to add this api into <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a> ?</z><z id="t1613508331" t="lukasz Technically - that&apos;s not an AWS (as in Amazon Web Services) API - so I wouldn&apos;t count on it"><y>#</y><d>2021-02-16</d><h>20:45</h><r>lukasz</r>Technically - that&apos;s not an AWS (as in Amazon Web Services) API - so I wouldn&apos;t count on it</z><z id="t1613508417" t="lukasz But, since it&apos;s requiring some of the AWS mechanisms such as v4 signature, you could use aws-api to pull the functionality to create sigs and call the API directly yourself with something like clj-http"><y>#</y><d>2021-02-16</d><h>20:46</h><r>lukasz</r>But, since it&apos;s requiring some of the AWS mechanisms such as v4 signature, you could use aws-api to pull the functionality to create sigs and call the API directly yourself with something like clj-http</z><z id="t1613509046" t="fmnoise thanks!"><y>#</y><d>2021-02-16</d><h>20:57</h><r>fmnoise</r>thanks!</z><z id="t1613584837" t="viesti check out https://github.com/sharetribe/aws-sig4"><y>#</y><d>2021-02-17</d><h>18:00</h><r>viesti</r>check out <a href="https://github.com/sharetribe/aws-sig4" target="_blank">https://github.com/sharetribe/aws-sig4</a></z><z id="t1613584882" t="fmnoise thanks [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}]"><y>#</y><d>2021-02-17</d><h>18:01</h><r>fmnoise</r>thanks <a>@U06QSF3BK</a></z><z id="t1613584965" t="viesti I&apos;ve used that to make http requests to aws elasticsearch service, with the sig4 signature"><y>#</y><d>2021-02-17</d><h>18:02</h><r>viesti</r>I&apos;ve used that to make http requests to aws  elasticsearch service, with the sig4 signature</z><z id="t1613585072" t="lukasz Ah yes - same, until we just moved ES to VPC - whenever they added that capability"><y>#</y><d>2021-02-17</d><h>18:04</h><r>lukasz</r>Ah yes - same, until we just moved ES to VPC - whenever they added that capability</z><z id="t1613638120" t="viesti yeah same thing with ES for me too, just that I left the project before the VPC transition, so didn&apos;t get to discard the auth, though thinking that might still be worth to keep authentication with sig4 even with a VPC endpoint"><y>#</y><d>2021-02-18</d><h>08:48</h><r>viesti</r>yeah same thing with ES for me too, just that I left the project before the VPC transition, so didn&apos;t get to discard the auth, though thinking that might still be worth to keep authentication with sig4 even with a VPC endpoint</z><z id="t1614148199" t="viesti apropo, has anyway tried out Timestream yet? 🙂"><y>#</y><d>2021-02-24</d><h>06:29</h><w>viesti</w>apropo, has anyway tried out Timestream yet? <b>🙂</b></z><z id="t1616097078" t="zendevil.eth I using amazonica to put an object in a bucket like so:"><y>#</y><d>2021-03-18</d><h>19:51</h><w>zendevil.eth</w>I using amazonica to put an object in a bucket like so:</z><z id="t1616097102" t="zendevil.eth (s3/put-object :endpoint &quot;&quot; :bucket-name &quot;humboi-videos&quot; :key thumbnail-name :file &quot;./resources/public/thumbnail.png&quot; :access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;]}) "><y>#</y><d>2021-03-18</d><h>19:51</h><w>zendevil.eth</w><pre>(s3/put-object
           :endpoint &quot;&quot;
           :bucket-name &quot;humboi-videos&quot;
           :key thumbnail-name
           :file &quot;./resources/public/thumbnail.png&quot;
           :access-control-list {:grant-permission [&quot;AllUsers&quot; &quot;Read&quot;]})</pre>
</z><z id="t1616097144" t="zendevil.eth What I want to know is how much progress has been made in putting the object in the bucket. For example if the total data is 1000 bytes, I want to know how many bytes has been uploaded to the s3 bucket. How can I achieve this?"><y>#</y><d>2021-03-18</d><h>19:52</h><w>zendevil.eth</w>What I want to know is how much progress has been made in putting the object in the bucket. For example if the total data is 1000 bytes, I want to know how many bytes has been uploaded to the s3 bucket. How can I achieve this?</z><z id="t1616104262" t="nbardiuk there is no solution out of the box. But with some effort you can write it yourself. The trick is to upload :input-stream instead of :file where the input stream would be a proxy that notify about how much data was consumed"><y>#</y><d>2021-03-18</d><h>21:51</h><w>nbardiuk</w>there is no solution out of the box. But with some effort you can write it yourself. The trick is to upload <code>:input-stream</code> instead of <code>:file</code> where the input stream would be a proxy that notify about how much data was consumed</z><z id="t1616104335" t="nbardiuk like in this question https://stackoverflow.com/questions/1339437/inputstream-or-reader-wrapper-for-progress-reporting"><y>#</y><d>2021-03-18</d><h>21:52</h><w>nbardiuk</w>like in this question <a href="https://stackoverflow.com/questions/1339437/inputstream-or-reader-wrapper-for-progress-reporting" target="_blank">https://stackoverflow.com/questions/1339437/inputstream-or-reader-wrapper-for-progress-reporting</a></z><z id="t1616106071" t="zendevil.eth thanks [:attrs {:href &quot;/_/_/users/U076FM90B&quot;}]"><y>#</y><d>2021-03-18</d><h>22:21</h><w>zendevil.eth</w>thanks <a>@nbardiuk</a></z><z id="t1616106233" t="zendevil.eth I’m uploading a jar on Elastic Beanstalk. The lein project was created using #luminus. The jar is created with lein uberjar and when run on the local machine works fine, i.e., requests to localhost:3000 work fine. But when I upload the jar on Elastic Beanstalk on the java platform, I’m getting a 502 Bad Gateway on the app link. How do I fix this?"><y>#</y><d>2021-03-18</d><h>22:23</h><w>zendevil.eth</w>I’m uploading a jar on Elastic Beanstalk. The lein project was created using #luminus. The jar is created with lein uberjar and when run on the local machine works fine, i.e., requests to localhost:3000 work fine. But when I upload the jar on Elastic Beanstalk on the java platform, I’m getting a 502 Bad Gateway on the app link. How do I fix this?</z><z id="t1616109309" t="lukasz Never used EB, but according to these docs - you need to listen to port 5000 https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-se-nginx.html"><y>#</y><d>2021-03-18</d><h>23:15</h><r>lukasz</r>Never used EB, but according to these docs - you need to listen to port 5000 <a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-se-nginx.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/java-se-nginx.html</a></z><z id="t1616109668" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] what do you use instead of eb?"><y>#</y><d>2021-03-18</d><h>23:21</h><r>zendevil.eth</r><a>@U0JEFEZH6</a> what do you use instead of eb?</z><z id="t1616109680" t="lukasz ECS+Fargate"><y>#</y><d>2021-03-18</d><h>23:21</h><r>lukasz</r>ECS+Fargate</z><z id="t1616109798" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] changing to 5000 didn’t work. Getting the same error"><y>#</y><d>2021-03-18</d><h>23:23</h><r>zendevil.eth</r><a>@U0JEFEZH6</a> changing to 5000 didn’t work. Getting the same error</z><z id="t1616109805" t="zendevil.eth 502"><y>#</y><d>2021-03-18</d><h>23:23</h><r>zendevil.eth</r>502</z><z id="t1616109829" t="lukasz Digging through docs should help, as I mentioned - never used it, but the setup is pretty clearly explained."><y>#</y><d>2021-03-18</d><h>23:23</h><r>lukasz</r>Digging through docs should help, as I mentioned - never used it, but the setup is pretty clearly explained.</z><z id="t1616110025" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] is there a reason you chose ecs + fargate rather than elastic beanstalk?"><y>#</y><d>2021-03-18</d><h>23:27</h><r>zendevil.eth</r><a>@U0JEFEZH6</a> is there a reason you chose ecs + fargate rather than elastic beanstalk?</z><z id="t1616110054" t="zendevil.eth it seems like eb manages scaling automatically and doesn’t charge extra for it"><y>#</y><d>2021-03-18</d><h>23:27</h><r>zendevil.eth</r>it seems like eb manages scaling automatically and doesn’t charge extra for it</z><z id="t1616110131" t="lukasz We have dozen or so Clojure services and we&apos;ve been using Docker for last 4 year or so. Autoscaling is not a requirement, and ECS can guarantee that the system stays up in rare case of something shutting down"><y>#</y><d>2021-03-18</d><h>23:28</h><r>lukasz</r>We have dozen or so Clojure services and we&apos;ve been using Docker for last 4 year or so. Autoscaling is not a requirement, and ECS can guarantee that the system stays up in rare case of something shutting down</z><z id="t1616110156" t="lukasz Was easier to transition to ECS from our previous setup, than learn EB"><y>#</y><d>2021-03-18</d><h>23:29</h><r>lukasz</r>Was easier to transition to ECS from our previous setup, than learn EB</z><z id="t1616110212" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] just curious. What was the previous setup?"><y>#</y><d>2021-03-18</d><h>23:30</h><r>zendevil.eth</r><a>@U0JEFEZH6</a> just curious. What was the previous setup?</z><z id="t1616110396" t="lukasz Terraform + Ansible + Google Cloud platform VMs. Became too manual to maintain, even though it was simple to operate. ECS+Fragate is working great for us, never had issues with it and we&apos;re Ansible-free. Everything is stored as code and cleanly setup."><y>#</y><d>2021-03-18</d><h>23:33</h><r>lukasz</r>Terraform + Ansible + Google Cloud platform VMs. Became too manual to maintain, even though it was simple to operate. ECS+Fragate is working great for us, never had issues with it and we&apos;re Ansible-free. Everything is stored as code and cleanly setup.</z><z id="t1616110572" t="zendevil.eth do you use aws lambda with ecs + fargate?"><y>#</y><d>2021-03-18</d><h>23:36</h><r>zendevil.eth</r>do you use aws lambda with ecs + fargate?</z><z id="t1616110620" t="zendevil.eth and what does one need to learn in terms of devops to use ecs + fargate?"><y>#</y><d>2021-03-18</d><h>23:37</h><r>zendevil.eth</r>and what does one need to learn in terms of devops to use ecs + fargate?</z><z id="t1616111035" t="lukasz AWS docs have a lot of resources explaining how to get started, including the copilot tool that they released not long ago. Not sure if it&apos;s learnable, like a programming language- there&apos;s way more moving parts (IAM, AWS networking, Docker itself and more)."><y>#</y><d>2021-03-18</d><h>23:43</h><r>lukasz</r>AWS docs have a lot of resources explaining how to get started, including the copilot tool that they released not long ago. Not sure if it&apos;s learnable, like a programming language- there&apos;s way more moving parts (IAM, AWS networking, Docker itself and more).</z><z id="t1616111052" t="lukasz Lambda has nothing to do with ECS/Fargate directly, as far as application deployments are concerned. Different tool"><y>#</y><d>2021-03-18</d><h>23:44</h><r>lukasz</r>Lambda has nothing to do with ECS/Fargate directly, as far as application deployments are concerned. Different tool</z><z id="t1616112077" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] have you ever used k8s with eks?"><y>#</y><d>2021-03-19</d><h>00:01</h><r>zendevil.eth</r><a>@U0JEFEZH6</a> have you ever used k8s with eks?</z><z id="t1616112111" t="zendevil.eth instead of fargate? I’ve heard that the provisioning with fargate isn’t reliable because cpu power can vary by a factor of 5"><y>#</y><d>2021-03-19</d><h>00:01</h><r>zendevil.eth</r>instead of fargate? I’ve heard that the provisioning with fargate isn’t reliable because cpu power can vary by a factor of 5</z><z id="t1616120586" t="zendevil.eth"><y>#</y><d>2021-03-19</d><h>02:23</h><r>zendevil.eth</r></z><z id="t1616120600" t="zendevil.eth Here are the logs of the deployment"><y>#</y><d>2021-03-19</d><h>02:23</h><r>zendevil.eth</r>Here are the logs of the deployment</z><z id="t1616123642" t="phoenixjj Unable to connect to localhost:8182 ?"><y>#</y><d>2021-03-19</d><h>03:14</h><r>phoenixjj</r>Unable to connect to localhost:8182 ?</z><z id="t1616123671" t="phoenixjj what is running on 8182 ? and on which server ?"><y>#</y><d>2021-03-19</d><h>03:14</h><r>phoenixjj</r>what is running on 8182 ? and on which server ?</z><z id="t1616123801" t="zendevil.eth I think the problem is that the datomic access gateway needs to be run before the client can connect "><y>#</y><d>2021-03-19</d><h>03:16</h><r>zendevil.eth</r>I think the problem is that the datomic access gateway needs to be run  before the client can connect </z><z id="t1616123831" t="zendevil.eth And I don’t know of a simple way to do that other than creating a docket image with those commands"><y>#</y><d>2021-03-19</d><h>03:17</h><r>zendevil.eth</r>And I don’t know of a simple way to do that other than creating a docket image with those commands</z><z id="t1616123847" t="zendevil.eth There must be a simpler way?"><y>#</y><d>2021-03-19</d><h>03:17</h><r>zendevil.eth</r>There must be a simpler way?</z><z id="t1616106331" t="zendevil.eth I’m getting a severe status with the following points: • 100.0 % of the requests are failing with HTTP 5xx. • ELB processes are not healthy on all instances. • ELB health is failing or not available for all instances. "><y>#</y><d>2021-03-18</d><h>22:25</h><w>zendevil.eth</w>I’m getting a severe status with the following points:
• 100.0 % of the requests are failing with HTTP 5xx.
• ELB processes are not healthy on all instances.
• ELB health is failing or not available for all instances.
</z><z id="t1616324157" t="zendevil.eth"><y>#</y><d>2021-03-21</d><h>10:55</h><w>zendevil.eth</w></z><z id="t1616329543" t="valtteri Do you happen to have AWS_* environment variables or Java System properties set in project.clj ? Those would override ~/.aws/credentials"><y>#</y><d>2021-03-21</d><h>12:25</h><r>valtteri</r>Do you happen to have <code>AWS_*</code> environment variables or Java System properties set in <code>project.clj</code> ? Those would override <code>~/.aws/credentials</code></z><z id="t1616330025" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] I get the same error whether the AWS_* are set or not in project.clj"><y>#</y><d>2021-03-21</d><h>12:33</h><r>zendevil.eth</r><a>@U6N4HSMFW</a> I get the same error whether the <code>AWS_*</code> are set or not in project.clj</z><z id="t1616330558" t="valtteri Sorry, I don’t have other ideas. 😞"><y>#</y><d>2021-03-21</d><h>12:42</h><r>valtteri</r>Sorry, I don’t have other ideas. <b>😞</b></z><z id="t1616863679" t="zendevil.eth I want to see logs of my elastic beanstalk environment in the command line, for which I’m doing the following: eb logs --cloudwatch-logs enable --cloudwatch-log-source instance Humboialpha2021-env However, I’m seeing the following error: https://gist.github.com/zendevil/0025d4c2bd54a4111f0ebb7efa6ec37e How to fix this?"><y>#</y><d>2021-03-27</d><h>16:47</h><w>zendevil.eth</w>I want to see logs of my elastic beanstalk environment in the command line, for which I’m doing the following:
<pre>eb logs --cloudwatch-logs enable --cloudwatch-log-source instance Humboialpha2021-env</pre>
However, I’m seeing the following error:
<a href="https://gist.github.com/zendevil/0025d4c2bd54a4111f0ebb7efa6ec37e" target="_blank">https://gist.github.com/zendevil/0025d4c2bd54a4111f0ebb7efa6ec37e</a>
How to fix this?</z><z id="t1616864605" t="orestis You have to check the eb logs. You can access the full logs from the console too. "><y>#</y><d>2021-03-27</d><h>17:03</h><w>orestis</w>You have to check the eb logs. You can access the full logs from the console too. </z><z id="t1616864643" t="orestis Sometimes if EB thinks that your software is unhealthy it will refuse to apply even configuration changes. Not sure if this is the case"><y>#</y><d>2021-03-27</d><h>17:04</h><w>orestis</w>Sometimes if EB thinks that your software is unhealthy it will refuse to apply even configuration changes. Not sure if this is the case</z><z id="t1616867153" t="zendevil.eth [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] I can’t access the logs from the console. When I click access logs, it keeps loading and the logs don’t show"><y>#</y><d>2021-03-27</d><h>17:45</h><w>zendevil.eth</w><a>@orestis</a> I can’t access the logs from the console. When I click access logs, it keeps loading and the logs don’t show</z><z id="t1616871129" t="orestis That’s pretty strange. Do you have all the permissions needed?"><y>#</y><d>2021-03-27</d><h>18:52</h><w>orestis</w>That’s pretty strange. Do you have all the permissions needed?</z><z id="t1616871142" t="orestis It should give you a button to request logs. "><y>#</y><d>2021-03-27</d><h>18:52</h><w>orestis</w>It should give you a button to request logs. </z><z id="t1616896337" t="zendevil.eth it was a permissions issue. Too bad aws doesn’t tell that permissions aren’t met, and silently blocks accessing logs"><y>#</y><d>2021-03-28</d><h>01:52</h><r>zendevil.eth</r>it was a permissions issue. Too bad aws doesn’t tell that permissions aren’t met, and silently blocks accessing logs</z><z id="t1617729712" t="mlimotte Hi. I’m using the aws-api to upload a file to S3, and I want to set the Content-Type. I converted a java example I found to roughly this code: (let [md {&quot;content-type&quot; &quot;text/plain&quot;} response (core/throw-on-error (aws/invoke client {:op :PutObject :request {:Bucket &quot;&quot; :Key &quot;marc/foo2.txt&quot; :Body (-&gt; &quot;some text&quot; (.getBytes &quot;UTF-8&quot;) (ByteArrayInputStream.)) :Metadata md}}))] (:Body response)) But this is not working. When I check out the newly uploaded file in Amazon, I see: • System defined, Content-Type , application/octet-stream • User defined, x-amz-meta-content-type, text/plain So, instead of setting the system defined “Content-Type”, it stuffed my value into x-amz-meta-content-type . Any suggestions?"><y>#</y><d>2021-04-06</d><h>17:21</h><w>mlimotte</w>Hi. I’m using the aws-api to upload a file to S3, and I want to set the Content-Type.  I converted a java example I found to roughly this code:

<pre>(let [md       {&quot;content-type&quot; &quot;text/plain&quot;}
      response (core/throw-on-error
                 (aws/invoke client
                             {:op      :PutObject
                              :request {:Bucket   &quot;&quot;
                                        :Key      &quot;marc/foo2.txt&quot;
                                        :Body     (-&gt; &quot;some text&quot; (.getBytes &quot;UTF-8&quot;) (ByteArrayInputStream.))
                                        :Metadata md}}))]
  (:Body response))</pre>
But this is not working.  When I check out the newly uploaded file in Amazon, I see:

• System defined, 	Content-Type	,   application/octet-stream
• User defined, 	x-amz-meta-content-type, 	text/plain
So, instead of setting the system defined “Content-Type”, it stuffed my value into <code>x-amz-meta-content-type</code> .

Any suggestions?</z><z id="t1617730089" t="ghadi (aws/doc client :PutObject) call that [:attrs {:href &quot;/_/_/users/U0E703ECU&quot;}] and check out the :ContentType option"><y>#</y><d>2021-04-06</d><h>17:28</h><w>ghadi</w><code>(aws/doc client :PutObject)</code>
call that <a>@mlimotte</a> and check out the :ContentType option</z><z id="t1617730110" t="ghadi content type might be special in that it won&apos;t appear in Metadata"><y>#</y><d>2021-04-06</d><h>17:28</h><w>ghadi</w>content type might be special in that it won&apos;t appear in Metadata</z><z id="t1617737274" t="mlimotte [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] Yep--- that resolved the issue. Was not aware of that divergence from the java sdk. Thanks."><y>#</y><d>2021-04-06</d><h>19:27</h><w>mlimotte</w><a>@ghadi</a> Yep--- that resolved the issue.  Was not aware of that divergence from the java sdk.  Thanks.</z><z id="t1617737318" t="ghadi aws-api is generated from descriptor files, which is similar to how the java v2 sdk is generated (but java v1 sdk is ad hoc)"><y>#</y><d>2021-04-06</d><h>19:28</h><w>ghadi</w>aws-api is generated from descriptor files, which is similar to how the java v2 sdk is generated (but java v1 sdk is ad hoc)</z><z id="t1617914317" t="Daniel Craig Can I make a request to a Neptune stream from outside of my VPC?"><y>#</y><d>2021-04-08</d><h>20:38</h><w>Daniel Craig</w>Can I make a request to a Neptune stream from outside of my VPC?</z><z id="t1618597543" t="kenny It seems like aws-api does not support https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html as a credential provider. I have a profile in my config file with a role_arn and source_profile specified. If I try using that profile via AWS_PROFILE, aws-api will log that it cannot fetch from aws profiles file. Thinking I&apos;ll just copy that code out and add support for it locally. I&apos;m not missing existing functionality, am I? https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/credentials.clj#L241-L243"><y>#</y><d>2021-04-16</d><h>18:25</h><w>kenny</w>It seems like aws-api does not support <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html" target="_blank">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html</a> as a credential provider. I have a profile in my config file with a role_arn and source_profile specified. If I try using that profile via AWS_PROFILE, aws-api will log that it cannot fetch from aws profiles file. Thinking I&apos;ll just copy that code out and add support for it locally. I&apos;m not missing existing functionality, am I?
<a href="https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/credentials.clj#L241-L243" target="_blank">https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/credentials.clj#L241-L243</a></z><z id="t1618599396" t="lukasz [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] writing your own credentials providers is pretty straightforward, we had to add our own for credentials fetched via SSO locally"><y>#</y><d>2021-04-16</d><h>18:56</h><r>lukasz</r><a>@U083D6HK9</a> writing your own credentials providers is pretty straightforward, we had to add our own for credentials fetched via SSO locally</z><z id="t1618599671" t="kenny Yep"><y>#</y><d>2021-04-16</d><h>19:01</h><r>kenny</r>Yep</z><z id="t1618622048" t="rutledgepaulv I made this to address some of these missing auth modes: https://github.com/RutledgePaulV/aws-api-credential-providers"><y>#</y><d>2021-04-17</d><h>01:14</h><r>rutledgepaulv</r>I made this to address some of these missing auth modes: <a href="https://github.com/RutledgePaulV/aws-api-credential-providers" target="_blank">https://github.com/RutledgePaulV/aws-api-credential-providers</a></z><z id="t1618598288" t="Alex Miller (Clojure team) issues can go here https://github.com/cognitect-labs/aws-api/issues"><y>#</y><d>2021-04-16</d><h>18:38</h><w>Alex Miller (Clojure team)</w>issues can go here <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a></z><z id="t1618603235" t="kenny Don&apos;t have time to make an issue atm. For those interested, I published my first cut from our internal version here. Anyone is welcome to use it. https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a ."><y>#</y><d>2021-04-16</d><h>20:00</h><w>kenny</w>Don&apos;t have time to make an issue atm. For those interested, I published my first cut from our internal version here. Anyone is welcome to use it. <a href="https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a" target="_blank">https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a</a>.</z><z id="t1619020948" t="kenny I&apos;m calling :DescribeSavingsPlans from the :savingsplans api and getting back an anomaly that has the message &quot;Too Many Active Keys&quot; and the category &quot;incorrect&quot;. This is only occurring in production, and I have not been able to repro locally. My first theory was too many concurrent calls to the api endpoint. Simply executing many concurrent calls locally results in a different anomaly with the message &quot;Too Many Requests&quot;. I&apos;m curious if anyone has seen an anomaly with an anomaly message like &quot;Too Many Active Keys&quot; before."><y>#</y><d>2021-04-21</d><h>16:02</h><w>kenny</w>I&apos;m calling :DescribeSavingsPlans from the :savingsplans api and getting back an anomaly that has the message &quot;Too Many Active Keys&quot; and the category &quot;incorrect&quot;. This is only occurring in production, and I have not been able to repro locally. My first theory was too many concurrent calls to the api endpoint. Simply executing many concurrent calls locally results in a different anomaly with the message &quot;Too Many Requests&quot;. I&apos;m curious if anyone has seen an anomaly with an anomaly message like &quot;Too Many Active Keys&quot; before.</z><z id="t1619202237" t="dabrazhe [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] I managed to assume role based on the source profile defined in the aws credentials file. Is it smth you are looking for ? (def cred-provider (assumed-role-credentials-provider &quot;devprofile2&quot; &quot;arn:aws:iam::61823312345:role/SysAdmin&quot;))"><y>#</y><d>2021-04-23</d><h>18:23</h><w>dabrazhe</w><a>@kenny</a> I managed to assume role based on the source profile defined in the aws credentials file. Is it smth you are looking for ?
<pre>(def cred-provider (assumed-role-credentials-provider &quot;devprofile2&quot; &quot;arn:aws:iam::61823312345:role/SysAdmin&quot;))</pre></z><z id="t1619202324" t="kenny Not sure. I wrote up the thing I was hoping for 🙂 https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a"><y>#</y><d>2021-04-23</d><h>18:25</h><r>kenny</r>Not sure. I wrote up the thing I was hoping for <b>🙂</b> <a href="https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a" target="_blank">https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a</a></z><z id="t1619202648" t="dabrazhe That&apos;s lots of text : ) , cant go through it now. In short, there are examples here how to assume the IAM role, have a look at (defn assumed-role-credentials-provider [role-arn] https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj"><y>#</y><d>2021-04-23</d><h>18:30</h><r>dabrazhe</r>That&apos;s lots of text : ) , cant go through it now. In short, there are examples here how to assume the IAM role, have a look at <code>(defn assumed-role-credentials-provider [role-arn]</code>
<a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/assume_role_example.clj</a></z><z id="t1619203063" t="kenny Right. That’s the first part. The above implements the flow described here https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html"><y>#</y><d>2021-04-23</d><h>18:37</h><r>kenny</r>Right. That’s the first part. The above implements the flow described here <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html" target="_blank">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-role.html</a></z><z id="t1620036355" t="cfleming Has anyone successfully used a lambda proxy integration to return binary data? I cannot for the life of me get AWS to convert the base64 encoded response to binary. I’m returning content-type: application/zip (checked with curl), I have binaryMediaTypes: [&quot;application/zip&quot;] set on my REST API with CDK and I’ve checked in the console that it’s there, and I’m passing curl -i -H &quot;Accept: application/zip&quot; &lt;url&gt; , and I’m still getting base64 encoded text back. Any further ideas?"><y>#</y><d>2021-05-03</d><h>10:05</h><w>cfleming</w>Has anyone successfully used a lambda proxy integration to return binary data? I cannot for the life of me get AWS to convert the base64 encoded response to binary. I’m returning <code>content-type: application/zip</code> (checked with curl), I have <code>binaryMediaTypes: [&quot;application/zip&quot;]</code> set on my REST API with CDK and I’ve checked in the console that it’s there, and I’m passing <code>curl -i -H &quot;Accept: application/zip&quot; &lt;url&gt;</code>, and I’m still getting base64 encoded text back. Any further ideas?</z><z id="t1620036951" t="cfleming Oh, and I also have contentHandling: apigateway.ContentHandling.CONVERT_TO_BINARY"><y>#</y><d>2021-05-03</d><h>10:15</h><r>cfleming</r>Oh, and I also have <code>contentHandling: apigateway.ContentHandling.CONVERT_TO_BINARY</code></z><z id="t1620166610" t="cfleming More detail here: https://stackoverflow.com/questions/67377365/aws-lambda-doesnt-return-binary-content"><y>#</y><d>2021-05-04</d><h>22:16</h><r>cfleming</r>More detail here: <a href="https://stackoverflow.com/questions/67377365/aws-lambda-doesnt-return-binary-content" target="_blank">https://stackoverflow.com/questions/67377365/aws-lambda-doesnt-return-binary-content</a></z><z id="t1620646945" t="dabrazhe The gut feeling is there’s something off with the API Gateway settings ( i am not familiar with it enough to be sure). You could try invoking the Lambda function directly, via its url, and reproduce the issue."><y>#</y><d>2021-05-10</d><h>11:42</h><r>dabrazhe</r>The gut feeling is there’s something off with the API Gateway settings ( i am not familiar with it enough to be sure). You could try invoking the Lambda function directly, via its url, and reproduce the issue.</z><z id="t1620703763" t="cfleming Yes, it must be a problem with the API gateway, since the lambda is behaving correctly. When using the lambda proxy integration, the lambda has to return base64 (which it is) but for some reason I’m missing the magic incantation to make API gateway convert that result to binary data."><y>#</y><d>2021-05-11</d><h>03:29</h><r>cfleming</r>Yes, it must be a problem with the API gateway, since the lambda is behaving correctly. When using the lambda proxy integration, the lambda has to return base64 (which it is) but for some reason I’m missing the magic incantation to make API gateway convert that result to binary data.</z><z id="t1620735021" t="dabrazhe If you have the option of AWS tech support you can ask them the question, or ask a friend who has access to the AWS support : )"><y>#</y><d>2021-05-11</d><h>12:10</h><r>dabrazhe</r>If you have the option of AWS tech support you can ask them the question, or ask a friend who has access to the AWS support : )</z><z id="t1620770775" t="kenny Does anyone know of a pre-built script, tool, or whatever that would let me spin up a specific ec2 instance, clone a github project, open a nrepl in that project, and allow me to connect to it locally? I can do all of that stuff myself, but, as usual, the devil is in the details. Was hoping to not lose a few hours if there&apos;s something pre-built to do that 😅 My use case is I have some huge batch jobs I want to run on a 64+ core machine and be able to interact with the results in the repl."><y>#</y><d>2021-05-11</d><h>22:06</h><w>kenny</w>Does anyone know of a pre-built script, tool, or whatever that would let me spin up a specific ec2 instance, clone a github project, open a nrepl in that project, and allow me to connect to it locally? I can do all of that stuff myself, but, as usual, the devil is in the details. Was hoping to not lose a few hours if there&apos;s something pre-built to do that <b>😅</b> My use case is I have some huge batch jobs I want to run on a 64+ core machine and be able to interact with the results in the repl.</z><z id="t1620781061" t="em Closest thing off the top of my mind is: https://www.gitpod.io/ but unfortunately they&apos;re kind of a closed SaaS type deal, and won&apos;t really let you do it on your own account/EC2 instance. I&apos;m not a fan of their service for this reason (waaaay too much on the side of ease instead of simplicity), but maybe searching for alternatives in this space will yield something close to what you want?"><y>#</y><d>2021-05-12</d><h>00:57</h><r>em</r>Closest thing off the top of my mind is:
<a href="https://www.gitpod.io/" target="_blank">https://www.gitpod.io/</a>

but unfortunately they&apos;re kind of a closed SaaS type deal, and won&apos;t really let you do it on your own account/EC2 instance. I&apos;m not a fan of their service for this reason (waaaay too much on the side of ease instead of simplicity), but maybe searching for alternatives in this space will yield something close to what you want?</z><z id="t1620785162" t="kenny Huh, interesting. Didn&apos;t know there was an actual market for that sort of thing. That looks way more formal that I was looking for, haha."><y>#</y><d>2021-05-12</d><h>02:06</h><r>kenny</r>Huh, interesting. Didn&apos;t know there was an actual market for that sort of thing. That looks way more formal that I was looking for, haha.</z><z id="t1620785567" t="em Yeah, I was surprised myself. I couldn&apos;t imagine doing all my dev work on a paid boxed service over the internet just to save 5 minutes of installing dependencies - some of the comments are really funny about how it revolutionizes everything"><y>#</y><d>2021-05-12</d><h>02:12</h><r>em</r>Yeah, I was surprised myself. I couldn&apos;t imagine doing all my dev work on a paid boxed service over the internet just to save 5 minutes of installing dependencies - some of the comments are really funny about how it revolutionizes everything</z><z id="t1620828788" t="lukasz Technically you should be able to do all of the above with Clojure and cognitect-labs/aws-api: • create a VPC • define security group to allow connection via SSH • create an ec2 instance with user-data script which will clone your code, setup SSH keys necessary for opening a tunnel to to the nrepl server • destroys the VPC, security groups and the EC2 instance when you&apos;re done "><y>#</y><d>2021-05-12</d><h>14:13</h><r>lukasz</r>Technically you should be able to do all of the above with Clojure and cognitect-labs/aws-api:
• create a VPC
• define security group to allow connection via SSH
• create an ec2 instance with user-data script which will clone your code, setup SSH keys necessary for opening a tunnel to to the nrepl server
• destroys the VPC, security groups and the EC2 instance when you&apos;re done </z><z id="t1621016792" t="dabrazhe The easiest option is to install an EC2 from an existing template in IOC, there should be plenty in Terraform or pulumi . Beware of the ones that use the NAT gateway, they can be expensive in case your need a lot of traffic for the batch data. You can the internet gateway. Once the ec2 is setup and patched, ssh to it, install lein and upload your data. I&apos;ve done a similar setup on my Raspbery pi."><y>#</y><d>2021-05-14</d><h>18:26</h><r>dabrazhe</r>The easiest option is to install an EC2 from an existing template in IOC, there should be plenty in  Terraform or pulumi . Beware of the ones that use the NAT gateway, they can be expensive in case your need a lot of traffic for the batch data. You can the internet gateway. Once the ec2 is setup and patched, ssh to it, install lein and upload  your data. I&apos;ve done a similar setup on my Raspbery pi.</z><z id="t1621016851" t="dabrazhe But you can consider running the jobs on the local machine overnight, persist the results and read them in repl the next day. it will save you a lot of hassle and let you focus on the problem instead of infrastructure"><y>#</y><d>2021-05-14</d><h>18:27</h><r>dabrazhe</r>But you can  consider running the jobs on the local machine overnight, persist the results and read them in repl the next day. it will  save you a lot of hassle and let you focus on the problem instead of infrastructure</z><z id="t1621016992" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] https://theconsultingcto.com/posts/bastions-on-demand/"><y>#</y><d>2021-05-14</d><h>18:29</h><w>ghadi</w><a>@kenny</a> <a href="https://theconsultingcto.com/posts/bastions-on-demand/" target="_blank">https://theconsultingcto.com/posts/bastions-on-demand/</a></z><z id="t1621017004" t="ghadi not prebuilt, but inspiration"><y>#</y><d>2021-05-14</d><h>18:30</h><w>ghadi</w>not prebuilt, but inspiration</z><z id="t1621202117" t="hiredman https://github.com/technomancy/syme was a thing, the author used to have a running instance but doesn&apos;t seem to anymore"><y>#</y><d>2021-05-16</d><h>21:55</h><w>hiredman</w><a href="https://github.com/technomancy/syme" target="_blank">https://github.com/technomancy/syme</a> was a thing, the author used to have a running instance but doesn&apos;t seem to anymore</z><z id="t1621538248" t="Daniel Craig is anyone here using Neptune? I want to connect to Neptune using Clojure, but I’m struggling to get the authentication correct. Here’s what I’ve tried: (let [endpoint &quot;&quot; builder (-&gt; (Cluster/build) (.addContactPoint endpoint) (.port 8182) (.enableSsl true) (.keyCertChainFile &quot;resources/SFSRootCAG2.pem&quot;)) cluster (.create builder) client (.connect cluster) conn (org.apache.tinkerpop.gremlin.driver.remote.DriverRemoteConnection/using client) g (traversal conn)] (traverse g V (count) (iterate!)) ) I need it to use IAM authentication and that’s the big hurdle. I should mention that I’m using Ogre"><y>#</y><d>2021-05-20</d><h>19:17</h><w>Daniel Craig</w>is anyone here using Neptune?  I want to connect to Neptune using Clojure, but I’m struggling to get the authentication correct.  Here’s what I’ve tried: 

  (let [endpoint &quot;&quot;
        builder (-&gt; (Cluster/build)
                    (.addContactPoint endpoint)
                    (.port 8182)
                    (.enableSsl true)
                    (.keyCertChainFile &quot;resources/SFSRootCAG2.pem&quot;))
        cluster (.create builder)
        client  (.connect cluster)
        conn (org.apache.tinkerpop.gremlin.driver.remote.DriverRemoteConnection/using client)
        g (traversal conn)]
    (traverse g V (count) (iterate!))
    )

I need it to use IAM authentication and that’s the big hurdle.  I should mention that I’m using Ogre</z><z id="t1621679483" t="Joe Is there is an idiot proof end-to-end guide to setting up an S3 bucket and accessing it with Clojure? I&apos;ve set up the bucket, set up an IAM policy / user to access it, but am not having any luck."><y>#</y><d>2021-05-22</d><h>10:31</h><w>Joe</w>Is there is an idiot proof end-to-end guide to setting up an S3 bucket and accessing it with Clojure? I&apos;ve set up the bucket, set up an IAM policy / user to access it, but am not having any luck.</z><z id="t1621679543" t="Joe IAM policy { &quot;Version&quot;: &quot;2012-10-17&quot;, &quot;Statement&quot;: [ { &quot;Sid&quot;: &quot;ListObjectsInBucket&quot;, &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: [ &quot;s3:ListBucket&quot; ], &quot;Resource&quot;: [ &quot;arn:aws:s3:::snip&quot; ] }, { &quot;Sid&quot;: &quot;AllObjectActions&quot;, &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: &quot;s3:*Object&quot;, &quot;Resource&quot;: [ &quot;arn:aws:s3:::snip/*&quot; ] } ] }"><y>#</y><d>2021-05-22</d><h>10:32</h><r>Joe</r>IAM policy
<pre>{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;ListObjectsInBucket&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;s3:ListBucket&quot;
            ],
            &quot;Resource&quot;: [
                &quot;arn:aws:s3:::snip&quot;
            ]
        },
        {
            &quot;Sid&quot;: &quot;AllObjectActions&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: &quot;s3:*Object&quot;,
            &quot;Resource&quot;: [
                &quot;arn:aws:s3:::snip/*&quot;
            ]
        }
    ]
}</pre></z><z id="t1621679572" t="Joe Clojure code - this hangs on the list buckets op (comment (def config (edn/read-string (slurp &quot;resources/.secrets.edn&quot;))) (def s3 (aws/client {:api :s3 :credentials-provider (creds/default-credentials-provider (:s3 config))})) (aws/validate-requests s3 true) (aws/invoke s3 {:op :ListBuckets}))"><y>#</y><d>2021-05-22</d><h>10:32</h><r>Joe</r>Clojure code - this hangs on the list buckets op
<pre>(comment
  (def config (edn/read-string (slurp &quot;resources/.secrets.edn&quot;)))
  (def s3 (aws/client {:api :s3
                       :credentials-provider (creds/default-credentials-provider (:s3 config))}))

  (aws/validate-requests s3 true)

  (aws/invoke s3 {:op :ListBuckets}))</pre></z><z id="t1621679633" t="Joe The AWS docs are very sprawling, so I can&apos;t tell if it&apos;s the S3 side of things I&apos;m messing up or the Clojure side (or both)"><y>#</y><d>2021-05-22</d><h>10:33</h><r>Joe</r>The AWS docs are very sprawling, so I can&apos;t tell if it&apos;s the S3 side of things I&apos;m messing up or the Clojure side (or both)</z><z id="t1621679731" t="Joe In particular I&apos;m unclear on whether the IAM policy itself is sufficient, or whether I need to change the permissions on the Bucket itself also"><y>#</y><d>2021-05-22</d><h>10:35</h><r>Joe</r>In particular I&apos;m unclear on whether the IAM policy itself is sufficient, or whether I need to change the permissions on the Bucket itself also</z><z id="t1621680306" t="nbardiuk Try aws cli https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3/ls.html Use it to test if policy setup is sufficient to do what you want. When you figure out policies you can reproduce aws cli commands in clojure"><y>#</y><d>2021-05-22</d><h>10:45</h><r>nbardiuk</r>Try aws cli <a href="https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3/ls.html" target="_blank">https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3/ls.html</a>
Use it to test if policy setup is sufficient to do what you want.
When you figure out policies you can reproduce aws cli commands in clojure</z><z id="t1621680432" t="Joe Thanks, I will give that a go"><y>#</y><d>2021-05-22</d><h>10:47</h><r>Joe</r>Thanks, I will give that a go</z><z id="t1621680589" t="valtteri I’m not sure if you can use wildcards like this &quot;Action&quot;: &quot;s3:*Object&quot;"><y>#</y><d>2021-05-22</d><h>10:49</h><r>valtteri</r>I’m not sure if you can use wildcards like this <code>&quot;Action&quot;: &quot;s3:*Object&quot;</code></z><z id="t1621680626" t="valtteri I recommend trying with s3:* or by listing all the relevant operation names"><y>#</y><d>2021-05-22</d><h>10:50</h><r>valtteri</r>I recommend trying with <code>s3:*</code>  or by listing all the relevant operation names</z><z id="t1621680648" t="jumar This is the policy we use for dev buckets and it works { &quot;Version&quot;: &quot;2012-10-17&quot;, &quot;Statement&quot;: [ { &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: &quot;s3:ListAllMyBuckets&quot;, &quot;Resource&quot;: &quot;arn:aws:s3:::*&quot; }, { &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: [ &quot;s3:ListBucket&quot;, &quot;s3:GetBucketLocation&quot; ], &quot;Resource&quot;: &quot;arn:aws:s3:::dev-${aws:username}&quot; }, { &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: [ &quot;s3:PutObject&quot;, &quot;s3:PutObjectAcl&quot;, &quot;s3:GetObject&quot;, &quot;s3:GetObjectAcl&quot;, &quot;s3:DeleteObject&quot; ], &quot;Resource&quot;: &quot;arn:aws:s3:::dev-${aws:username}/*&quot; } ] } "><y>#</y><d>2021-05-22</d><h>10:50</h><r>jumar</r>This is the policy  we use for dev buckets and it works
<pre>{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: &quot;s3:ListAllMyBuckets&quot;,
            &quot;Resource&quot;: &quot;arn:aws:s3:::*&quot;
        },
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;s3:ListBucket&quot;,
                &quot;s3:GetBucketLocation&quot;
            ],
            &quot;Resource&quot;: &quot;arn:aws:s3:::dev-${aws:username}&quot;
        },
        {
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;s3:PutObject&quot;,
                &quot;s3:PutObjectAcl&quot;,
                &quot;s3:GetObject&quot;,
                &quot;s3:GetObjectAcl&quot;,
                &quot;s3:DeleteObject&quot;
            ],
            &quot;Resource&quot;: &quot;arn:aws:s3:::dev-${aws:username}/*&quot;
        }
    ]
}</pre>
</z><z id="t1621681822" t="Joe Thanks, I got it figured - the cli wasn&apos;t able to ls because the IAM wasn&apos;t set up to allow it facepalm Also I wasn&apos;t setting the environment variables (the region). Once i corrected those it worked!"><y>#</y><d>2021-05-22</d><h>11:10</h><r>Joe</r>Thanks, I got it figured - the cli wasn&apos;t able to ls because the IAM wasn&apos;t set up to allow it <b>facepalm</b> Also I wasn&apos;t setting the environment variables (the region). Once i corrected those it worked!</z><z id="t1622120199" t="MikeE Hello - I need to generate a signed url to allow client uploading to an S3 bucket and I don’t see in the aws-api library any way to actually do that.. There’s a long standing https://github.com/cognitect-labs/aws-api/issues/5 saying it’s in progress so I’m wondering how folks are doing this. I could include the java AWS SDK core (i’m assuming that’s where the v4 signing utility lives) in my project.clj and use interop but wasn’t sure if there was a better solution."><y>#</y><d>2021-05-27</d><h>12:56</h><w>MikeE</w>Hello - I need to generate a signed url to allow client uploading to an S3 bucket and I don’t see in the aws-api library any way to actually do that.. There’s a long standing <a href="https://github.com/cognitect-labs/aws-api/issues/5" target="_blank">https://github.com/cognitect-labs/aws-api/issues/5</a> saying it’s in progress so I’m wondering how folks are doing this.  I could include the java AWS SDK core (i’m assuming that’s where the v4 signing utility lives) in my project.clj and use interop but wasn’t sure if there was a better solution.</z><z id="t1622123190" t="lukasz We solved it by including the java sdk, it works fine"><y>#</y><d>2021-05-27</d><h>13:46</h><r>lukasz</r>We solved it by including the java sdk, it works fine</z><z id="t1622121477" t="Alex Miller (Clojure team) That’s probably a good solution for now"><y>#</y><d>2021-05-27</d><h>13:17</h><w>Alex Miller (Clojure team)</w>That’s probably a good solution for now</z><z id="t1622121876" t="MikeE Thanks [:attrs {:href &quot;/_/_/users/U064X3EF3&quot;}] !"><y>#</y><d>2021-05-27</d><h>13:24</h><w>MikeE</w>Thanks <a>@alexmiller</a>!</z><z id="t1622123062" t="viesti Here&apos;s an example for using the aws java sdk v2 for presigning: https://gist.github.com/viesti/4fbe2e226b923adebadffcf44a3ed8e7"><y>#</y><d>2021-05-27</d><h>13:44</h><w>viesti</w>Here&apos;s an example for using the aws java sdk v2 for presigning: <a href="https://gist.github.com/viesti/4fbe2e226b923adebadffcf44a3ed8e7" target="_blank">https://gist.github.com/viesti/4fbe2e226b923adebadffcf44a3ed8e7</a></z><z id="t1622124515" t="MikeE thank you [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] !"><y>#</y><d>2021-05-27</d><h>14:08</h><w>MikeE</w>thank you <a>@viesti</a>!</z><z id="t1622125190" t="MikeE your gist worked great"><y>#</y><d>2021-05-27</d><h>14:19</h><w>MikeE</w>your gist worked great</z><z id="t1622180050" t="viesti 🙇"><y>#</y><d>2021-05-28</d><h>05:34</h><w>viesti</w><b>🙇</b></z><z id="t1622280246" t="indy Has anyone migrated from AWS EC2 + Kubernetes to AWS Fargate + Kubernetes? Any pros and cons of doing this? The goal is to reduce costs."><y>#</y><d>2021-05-29</d><h>09:24</h><w>indy</w>Has anyone migrated from AWS EC2 + Kubernetes to AWS Fargate + Kubernetes? Any pros and cons of doing this? The goal is to reduce costs.</z><z id="t1622317993" t="lukasz Best to check pricing but EC2 is always going to be cheaper than Fargate, but it involves more management and prep. We&apos;re running all workloads on ECS+Fargate, but not because of the direct cost, but because it cuts human cost required in managing everything."><y>#</y><d>2021-05-29</d><h>19:53</h><r>lukasz</r>Best to check pricing but EC2 is always going to be cheaper than Fargate, but it involves more management and prep. We&apos;re running all workloads on ECS+Fargate, but not because of the direct cost, but because it cuts human cost required in managing everything.</z><z id="t1622324246" t="kenny We switched from EKS to ECS Fargate. Far less overhead with Fargate."><y>#</y><d>2021-05-29</d><h>21:37</h><r>kenny</r>We switched from EKS to ECS Fargate. Far less overhead with Fargate.</z><z id="t1622574611" t="futuro One potential con, depending on your workload, is that Fargate has more restrictive cpu/memory limits. So if you need more than 8 vCPUs per container, Fargate may be a bad fit. "><y>#</y><d>2021-06-01</d><h>19:10</h><r>futuro</r>One potential con, depending on your workload, is that Fargate has more restrictive cpu/memory limits. So if you need more than 8 vCPUs per container, Fargate may be a bad fit. </z><z id="t1622574627" t="futuro That said, the savings in time may allow you to rework your code to need less cpu. "><y>#</y><d>2021-06-01</d><h>19:10</h><r>futuro</r>That said, the savings in time may allow you to rework your code to need less cpu. </z><z id="t1622574827" t="kenny 4 vcpu 🙂"><y>#</y><d>2021-06-01</d><h>19:13</h><r>kenny</r>4 vcpu <b>🙂</b></z><z id="t1622574848" t="futuro Haha, whoops! Thanks Kenny!"><y>#</y><d>2021-06-01</d><h>19:14</h><r>futuro</r>Haha, whoops! Thanks Kenny!</z><z id="t1622576212" t="kenny It’s be great to have 8. When you said that I got excited since we’d love more vcpu per node. "><y>#</y><d>2021-06-01</d><h>19:36</h><r>kenny</r>It’s be great to have 8. When you said that I got excited since we’d love more vcpu per node. </z><z id="t1622577408" t="lukasz I&apos;ve recently run into this... but yes - refactoring code and fixing hotspots quickly addressed that"><y>#</y><d>2021-06-01</d><h>19:56</h><r>lukasz</r>I&apos;ve recently run into this... but yes - refactoring code and fixing hotspots quickly addressed that</z><z id="t1622578547" t="indy Thanks for the input, all. I think I’ll let the Fargate idea pass since we have been running with a decent setup of EKS + EC2 + Chef + Terraform and the cost savings might only be marginal if any. "><y>#</y><d>2021-06-01</d><h>20:15</h><r>indy</r>Thanks for the input, all. I think I’ll let the Fargate idea pass since we have been running with a decent setup of EKS + EC2 + Chef + Terraform and the cost savings might only be marginal if any. </z><z id="t1622592726" t="kenny Yeah, the cost savings with Fargate typically comes by freeing up eng resources to work on product instead of infra. "><y>#</y><d>2021-06-02</d><h>00:12</h><r>kenny</r>Yeah, the cost savings with Fargate typically comes by freeing up eng resources to work on product instead of infra. </z><z id="t1622641555" t="lukasz Absolutely, I went from part time managing our EC2 fleet to not worrying about it at all, after we solidified our setup and created Terraform modules for everything"><y>#</y><d>2021-06-02</d><h>13:45</h><r>lukasz</r>Absolutely, I went from part time managing our EC2 fleet to not worrying about it at all, after we solidified our setup and created Terraform modules for everything</z><z id="t1622609469" t="zackteo Hello, a more generic AWS question here, but is I have a python script that I want to offload to AWS, because it needs way too much RAM and runs for many hours to generate a model (similar to ML but for Optimisation). Is AWS Lambda or Fargate what I need?"><y>#</y><d>2021-06-02</d><h>04:51</h><w>zackteo</w>Hello, a more generic AWS question here, but is I have a python script that I want to offload to AWS, because it needs way too much RAM and runs for many hours to generate a model (similar to ML but for Optimisation). Is AWS Lambda or Fargate what I need?</z><z id="t1622609884" t="zackteo The alternative to have run the script on a server instead"><y>#</y><d>2021-06-02</d><h>04:58</h><w>zackteo</w>The alternative to have run the script on a server instead</z><z id="t1622611104" t="Daniel Craig Lambdas cannot run for longer than 15 minutes as a hard limit, so that might eliminate Lambda for your use case"><y>#</y><d>2021-06-02</d><h>05:18</h><w>Daniel Craig</w>Lambdas cannot run for longer than 15 minutes as a hard limit, so that might eliminate Lambda for your use case</z><z id="t1622611230" t="Daniel Craig EC2 would be the most akin to running your script the way it’s already running; EC2 just gives you a virtual machine to run your program on, you can install python and run your script "><y>#</y><d>2021-06-02</d><h>05:20</h><w>Daniel Craig</w>EC2 would be the most akin to running your script the way it’s already running; EC2 just gives you a virtual machine to run your program on, you can install python and run your script </z><z id="t1622611271" t="Daniel Craig I don’t think you need fargate "><y>#</y><d>2021-06-02</d><h>05:21</h><w>Daniel Craig</w>I don’t think you need fargate </z><z id="t1622619049" t="zackteo Right, I just looked at https://greenm.io/aws-lambda-or-aws-fargate/ and seems like fargate might fit quite well. Or do you still recommend EC2? I agree that EC2 is most akin to doing so. But would serverless be a better way since it is like a one time use thing?"><y>#</y><d>2021-06-02</d><h>07:30</h><w>zackteo</w>Right, I just looked at <a href="https://greenm.io/aws-lambda-or-aws-fargate/" target="_blank">https://greenm.io/aws-lambda-or-aws-fargate/</a> and seems like fargate might fit quite well. Or do you still recommend EC2?
I agree that EC2 is most akin to doing so. But would serverless be a better way since it is like a one time use thing?</z><z id="t1622621043" t="zackteo Maybe Ill just go with EC2 after all, there is no option to use fargate with aws educate it seems"><y>#</y><d>2021-06-02</d><h>08:04</h><w>zackteo</w>Maybe Ill just go with EC2 after all, there is no option to use fargate with aws educate it seems</z><z id="t1622629013" t="raspasov I would say go with EC2 to start. It’s the “simplest” in a way, and things like Lambda, etc are more akin to cost optimization strategies."><y>#</y><d>2021-06-02</d><h>10:16</h><r>raspasov</r>I would say go with EC2 to start. It’s the “simplest” in a way, and things like Lambda, etc are more akin to cost optimization strategies.</z><z id="t1622634689" t="zackteo Right, that makes sense! Will go with that! Think that workflow might work out better after all"><y>#</y><d>2021-06-02</d><h>11:51</h><r>zackteo</r>Right, that makes sense! Will go with that! Think that workflow might work out better after all</z><z id="t1622726681" t="dabrazhe The most flexible approach would be to containerise your app. you can start with running it on EC2 and when comfortable migrate to Fargate. you can also consider Sagemaker that is geared towards ML, but it&apos;s more expensive"><y>#</y><d>2021-06-03</d><h>13:24</h><r>dabrazhe</r>The most flexible approach would be to containerise your app. you can start with running it on EC2 and when comfortable migrate to Fargate. you can also consider Sagemaker that is geared towards ML, but it&apos;s more expensive</z><z id="t1624448308" t="zackteo Hypothetically speaking, does AWS Fargate support running functions that use above 100 GB RAM? I think I got a bit confused looking at the maximum compute savings plan supported configuration of Min. 8GB and Max. 30GB, in 1GB increments"><y>#</y><d>2021-06-23</d><h>11:38</h><w>zackteo</w>Hypothetically speaking, does <code>AWS Fargate</code> support running functions that use above 100 GB RAM? I think I got a bit confused looking at the maximum compute savings plan supported configuration of <code>Min. 8GB and Max. 30GB, in 1GB increments</code></z><z id="t1624456222" t="lukasz [:attrs {:href &quot;/_/_/users/UUSQHP535&quot;}] there&apos;s an upper limit, I think biggest container instance we were able to deploy was 64GB"><y>#</y><d>2021-06-23</d><h>13:50</h><w>lukasz</w><a>@zackteo</a> there&apos;s an upper limit, I think biggest container instance we were able to deploy was 64GB</z><z id="t1624456230" t="lukasz (not function, Fargate runs containers)"><y>#</y><d>2021-06-23</d><h>13:50</h><w>lukasz</w>(not function, Fargate runs containers)</z><z id="t1624457309" t="zackteo Oh, so it isn&apos;t like aws lambda after all? Was thinking if there was an alternative to having a dedicated server for high RAM workloads. Because there is no need for constant high RAM usage"><y>#</y><d>2021-06-23</d><h>14:08</h><w>zackteo</w>Oh, so it isn&apos;t like aws lambda after all? Was thinking if there was an alternative to having a dedicated server for high RAM workloads. Because there is no need for constant high RAM usage</z><z id="t1624458419" t="ghadi I&apos;m confused around the question"><y>#</y><d>2021-06-23</d><h>14:26</h><w>ghadi</w>I&apos;m confused around the question</z><z id="t1624458459" t="ghadi what are the requirements?"><y>#</y><d>2021-06-23</d><h>14:27</h><w>ghadi</w>what are the requirements?</z><z id="t1624458471" t="lukasz The only difference between Fargate and Lambda is the execution model: Lambda is based on events/invokations, Fargate is more like a good old server, just runs your application in a container and never scales to 0"><y>#</y><d>2021-06-23</d><h>14:27</h><w>lukasz</w>The only difference between Fargate and Lambda is the execution model: Lambda is based on events/invokations, Fargate is more like a good old server, just runs your application in a container and never scales to 0</z><z id="t1624458494" t="lukasz (Lambda can now use container images as the runtime so the lines start to blur quite a lot)"><y>#</y><d>2021-06-23</d><h>14:28</h><w>lukasz</w>(Lambda can now use container images as the runtime so the lines start to blur quite a lot)</z><z id="t1624486253" t="zackteo [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] I guess the requirements are for high RAM workloads (&gt; 100 GB) and wondering I should be using a server since the high RAM workloads are uncommon. I realise ECS might be what I am thinking of"><y>#</y><d>2021-06-23</d><h>22:10</h><w>zackteo</w><a>@ghadi</a> I guess the requirements are for high RAM workloads (&gt; 100 GB) and wondering I should be using a server since the high RAM workloads are uncommon.
I realise ECS might be what I am thinking of</z><z id="t1624487370" t="Drew Verlee Using the cognitect aws client i&apos;m uploading a index.html to my bucket just fine, but the browser seems to always default to downloading it. I have scanned the first three hits on google and i&apos;m doing everything people are suggesting. My bucket is configured as a website. Here is my api call (aws/invoke s3 {:op :PutObject :request {:Bucket website-bucket-name :Key &quot;index.html&quot; :Body (io/input-stream (.getBytes &quot;&lt;h1&gt;Hello World!&lt;/h1&gt;&quot;)) :ACL &quot;public-read&quot; :ConentType &quot;text/html&quot;}})"><y>#</y><d>2021-06-23</d><h>22:29</h><w>Drew Verlee</w>Using the cognitect aws client i&apos;m uploading a index.html to my bucket just fine, but the browser seems to always default to downloading it. I have scanned the first three hits on google and i&apos;m doing everything people are suggesting. My bucket is configured as a website.

Here is my api call

<pre>(aws/invoke s3 {:op :PutObject :request {:Bucket     website-bucket-name :Key &quot;index.html&quot;
                                             :Body       (io/input-stream (.getBytes &quot;&lt;h1&gt;Hello World!&lt;/h1&gt;&quot;))
                                             :ACL        &quot;public-read&quot;
                                             :ConentType &quot;text/html&quot;}})</pre></z><z id="t1624487612" t="Alex Miller (Clojure team) There is a typo in last line?"><y>#</y><d>2021-06-23</d><h>22:33</h><w>Alex Miller (Clojure team)</w>There is a typo in last line?</z><z id="t1624487625" t="Alex Miller (Clojure team) ConentType"><y>#</y><d>2021-06-23</d><h>22:33</h><w>Alex Miller (Clojure team)</w>ConentType</z><z id="t1624487627" t="Drew Verlee there is, hmm"><y>#</y><d>2021-06-23</d><h>22:33</h><w>Drew Verlee</w>there is, hmm</z><z id="t1624487710" t="Drew Verlee thanks! weird, i thought it was uploading fine because the aws console the type was properly displaying as html."><y>#</y><d>2021-06-23</d><h>22:35</h><w>Drew Verlee</w>thanks! weird, i thought it was uploading fine because the aws console the type was properly displaying as html.</z><z id="t1624487855" t="Drew Verlee I should make a habit of just copy pasting field names until their in my autocomplete. Or stop working when my head starts to hurt. I assume if it was easy to validate the functions it would be done."><y>#</y><d>2021-06-23</d><h>22:37</h><w>Drew Verlee</w>I should make a habit of just copy pasting field names until their in my autocomplete. Or stop working when my head starts to hurt.  I assume if it was easy to validate the functions it would be done.</z><z id="t1624718014" t="zendevil.eth I have a few react native image components that simultaneously fetch their url from a db, and the urls are Amazon cloudfront urls on top of s3 storage. But the images take a significant time to load. Snapchat, which runs on AWS and GCP loads successive videos super fast, so they must be doing something more than using cloudfront. How can I improve the image loading speeds to Snapchat, TikTok levels? "><y>#</y><d>2021-06-26</d><h>14:33</h><w>zendevil.eth</w>I have a few react native image components that simultaneously fetch their url from a db, and the urls are Amazon cloudfront urls on top of s3 storage. 
But the images take a significant time to load. Snapchat, which runs on AWS and GCP loads successive videos super fast, so they must be doing something more than using cloudfront. 
How can I improve the image loading speeds to Snapchat, TikTok levels? </z><z id="t1624729308" t="lukasz off the top of my head: optimize your images - CDN won&apos;t help you if your files are big"><y>#</y><d>2021-06-26</d><h>17:41</h><r>lukasz</r>off the top of my head: optimize your images - CDN won&apos;t help you if your files are big</z><z id="t1624729877" t="zendevil.eth The files are compressed as much as possible without losing considerable visual quality "><y>#</y><d>2021-06-26</d><h>17:51</h><r>zendevil.eth</r>The files are compressed as much as possible without losing considerable visual quality </z><z id="t1624761378" t="indy Try using gumlet or thumbor"><y>#</y><d>2021-06-27</d><h>02:36</h><r>indy</r>Try using gumlet or thumbor</z><z id="t1624811182" t="jumar How big are the images? How long does it take to actually load the images? How much of that is the actual network latency?"><y>#</y><d>2021-06-27</d><h>16:26</h><r>jumar</r>How big are the images? How long does it take to actually load the images? How much of that is the actual network latency?</z><z id="t1624826389" t="Drew Verlee Anyone have any experience report for doing server side rendering for a web application on AWS? Would there be a downside to doing it for the initial load of a page? I figure it should be better then making the user wait for the double load main then data."><y>#</y><d>2021-06-27</d><h>20:39</h><w>Drew Verlee</w>Anyone have any experience report for doing server side rendering for a web application on AWS? 

Would there be a downside to doing it for the initial load of a page? I figure it should be better then making the user wait for the double load main then data.</z><z id="t1624826449" t="Drew Verlee Past that, I&apos;ll just be doing the rendering client side."><y>#</y><d>2021-06-27</d><h>20:40</h><w>Drew Verlee</w>Past that, I&apos;ll just be doing the rendering client side.</z><z id="t1624884262" t="fogus (Clojure Team) [ANN] Cognitect Labs&apos; aws-api 0.8.515 released. Details at https://groups.google.com/g/clojure/c/418Xbk77ILw"><y>#</y><d>2021-06-28</d><h>12:44</h><w>fogus (Clojure Team)</w>[ANN] Cognitect Labs&apos; aws-api 0.8.515 released. Details at <a href="https://groups.google.com/g/clojure/c/418Xbk77ILw" target="_blank">https://groups.google.com/g/clojure/c/418Xbk77ILw</a></z><z id="t1625332403" t="Drew Verlee Where would you ask aws questions that aren&apos;t very clojure specific? Meanwhile, do Rest Api Gateway endpoints support websockets? The https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-overview.html on websockets says it&apos;s for HTTP endpoints, as where the https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-vs-rest.html doesn&apos;t mention them all. Thanks for any help in advance,"><y>#</y><d>2021-07-03</d><h>17:13</h><w>Drew Verlee</w>Where would you ask aws questions that aren&apos;t very clojure specific?

Meanwhile, do Rest Api Gateway endpoints support websockets?

The <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-overview.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-overview.html</a> on websockets says it&apos;s for HTTP endpoints, as where the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-vs-rest.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-vs-rest.html</a> doesn&apos;t mention them all.
Thanks for any help in advance,</z><z id="t1625333391" t="Drew Verlee hmm maybe its a third type of endpoint."><y>#</y><d>2021-07-03</d><h>17:29</h><w>Drew Verlee</w>hmm maybe its a third type of endpoint.</z><z id="t1625333411" t="Drew Verlee it is."><y>#</y><d>2021-07-03</d><h>17:30</h><w>Drew Verlee</w>it is.</z><z id="t1625485068" t="onetom im getting 5 of these log messages from the cognitect aws-api: Jul 05, 2021 7:22:53 PM com.amazonaws.auth.profile.internal.BasicProfileConfigLoader loadProfiles WARNING: Your profile name includes a &apos;profile &apos; prefix. This is considered part of the profile name in the Java SDK, so you will need to include this prefix in your profile name when you reference this profile from your Java code. how can i disable them?"><y>#</y><d>2021-07-05</d><h>11:37</h><w>onetom</w>im getting 5 of these log messages from the cognitect aws-api:
<pre>Jul 05, 2021 7:22:53 PM com.amazonaws.auth.profile.internal.BasicProfileConfigLoader loadProfiles
WARNING: Your profile name includes a &apos;profile &apos; prefix. This is considered part of the profile name in the Java SDK, so you will need to include this prefix in your profile name when you reference this profile from your Java code.</pre>
how can i disable them?</z><z id="t1625485179" t="onetom after these messages, i also see another log message on the stderr: 2021-07-05 19:22:54.723:INFO::nREPL-session-c95f0d6e-f1cc-472d-85b4-dcd1d1820ae8: Logging initialized @109640ms to org.eclipse.jetty.util.log.StdErrLog so it seems this jetty logger is starting after the amazon libs has already sent some logs."><y>#</y><d>2021-07-05</d><h>11:39</h><r>onetom</r>after these messages, i also see another log message on the stderr:
<pre>2021-07-05 19:22:54.723:INFO::nREPL-session-c95f0d6e-f1cc-472d-85b4-dcd1d1820ae8: Logging initialized @109640ms to org.eclipse.jetty.util.log.StdErrLog</pre>
so it seems this jetty logger is starting after the amazon libs has already sent some logs.</z><z id="t1625485374" t="onetom according to https://docs.huihoo.com/jetty/the-definitive-reference/configuring-logging.html , i should be able to just do something like clj -J-Dcom.amazonaws.auth.profile.internal.LEVEL=OFF to suppress these messages, but that didn&apos;t work. i also tried to put a jetty-logging.properties on my classpath, but interestingly enough ( &quot;jetty-logging.properties&quot;) just returns nil . im working on a minimal repro case now, but if anyone has some pointers to some examples, it would be great."><y>#</y><d>2021-07-05</d><h>11:42</h><r>onetom</r>according to <a href="https://docs.huihoo.com/jetty/the-definitive-reference/configuring-logging.html" target="_blank">https://docs.huihoo.com/jetty/the-definitive-reference/configuring-logging.html</a> , i should be able to just do something like <code>clj -J-Dcom.amazonaws.auth.profile.internal.LEVEL=OFF</code> to suppress these messages, but that didn&apos;t work.
i also tried to put a <code>jetty-logging.properties</code> on my classpath, but interestingly enough <code>( &quot;jetty-logging.properties&quot;)</code> just returns <code>nil</code>.

im working on a minimal repro case now, but if anyone has some pointers to some examples, it would be great.</z><z id="t1625486602" t="onetom We are using awscli v2, so we can use single sign on. For that we need to have section names in ~/.aws/config to be prefixed with &quot;profile&lt;space&gt;&quot; and that triggers these warnings."><y>#</y><d>2021-07-05</d><h>12:03</h><r>onetom</r>We are using awscli v2, so we can use single sign on. For that we need to have section names in <code>~/.aws/config</code> to be prefixed with &quot;profile&lt;space&gt;&quot; and that triggers these warnings.</z><z id="t1625486658" t="onetom (It&apos;s really painful, because these warnings often totally obscure the useful output...)"><y>#</y><d>2021-07-05</d><h>12:04</h><r>onetom</r>(It&apos;s really painful, because these warnings often totally obscure the useful output...)</z><z id="t1625521030" t="onetom After reading the docs of a bunch of logging related libs, this is what worked for me finally: 1. create a logging.properties file at the same directory level as the deps.edn file. NOT in src/ or whatever dir, which is on the classpath! example content: handlers=java.util.logging.ConsoleHandler .level=INFO java.util.logging.ConsoleHandler.level=ALL java.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter java.util.logging.SimpleFormatter.format=[%1$tF %1$tT] [%4$-7s] %3$s: %5$s%6$s%n cognitect.aws.credentials.level=WARNING 2. reference this file via :jvm-opts in deps.edn . eg, here is a map-entry from the :aliases : :aliases {:dev {:extra-paths [&quot;dev&quot;] :jvm-opts [&quot;-Dclojure.tools.logging.factory=clojure.tools.logging.impl/jul-factory&quot; &quot;-Djava.util.logging.config.file=logging.properties&quot;]} } and also wire up the jul (`java.util.logging`) to the clojure.tools.logging abstraction layer"><y>#</y><d>2021-07-05</d><h>21:37</h><r>onetom</r>After reading the docs of a bunch of logging related libs, this is what worked for me finally:

1. create a <code>logging.properties</code> file at the same directory level as the <code>deps.edn</code> file. NOT in <code>src/</code> or whatever dir, which is on the classpath! example content:
<pre>handlers=java.util.logging.ConsoleHandler
.level=INFO
java.util.logging.ConsoleHandler.level=ALL
java.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter
java.util.logging.SimpleFormatter.format=[%1$tF %1$tT] [%4$-7s] %3$s: %5$s%6$s%n

cognitect.aws.credentials.level=WARNING</pre>
2. reference this file via <code>:jvm-opts</code> in <code>deps.edn</code>. eg, here is a map-entry from the <code>:aliases</code>:
<pre>:aliases
 {:dev
  {:extra-paths [&quot;dev&quot;]
   :jvm-opts    [&quot;-Dclojure.tools.logging.factory=clojure.tools.logging.impl/jul-factory&quot;
                 &quot;-Djava.util.logging.config.file=logging.properties&quot;]}
 }</pre>
and also wire up the <code>jul</code> (`java.util.logging`) to the <code>clojure.tools.logging</code> abstraction layer</z><z id="t1625521126" t="onetom I still see a log message, which has a different format, than the one I specified, and I can&apos;t suppress it: (def s3 (aws.api/client {:api :s3})) 2021-07-06 05:28:44.781:INFO::nREPL-session-2b108885-7ed5-4894-bedd-6077fd6b02c0: Logging initialized @12704ms to org.eclipse.jetty.util.log.StdErrLog"><y>#</y><d>2021-07-05</d><h>21:38</h><r>onetom</r>I still see a log message, which has a different format, than the one I specified, and I can&apos;t suppress it:
<pre>(def s3 (aws.api/client {:api :s3}))

2021-07-06 05:28:44.781:INFO::nREPL-session-2b108885-7ed5-4894-bedd-6077fd6b02c0: Logging initialized @12704ms to org.eclipse.jetty.util.log.StdErrLog</pre></z><z id="t1625541405" t="onetom actually, this is the line needed in logging.properties , for suppressing the warnings about the &quot;`profile `&quot; prefix: com.amazonaws.auth.profile.internal.BasicProfileConfigLoader.level=SEVERE"><y>#</y><d>2021-07-06</d><h>03:16</h><r>onetom</r>actually, this is the line needed in <code>logging.properties</code>, for suppressing the warnings about the &quot;`profile `&quot; prefix:
<pre>com.amazonaws.auth.profile.internal.BasicProfileConfigLoader.level=SEVERE</pre></z><z id="t1625553919" t="onetom managed to suppress the jetty related log message too. took this advice: https://stackoverflow.com/a/53064639/263983 and added &quot;-Dorg.eclipse.jetty.util.log.announce=false&quot; to the :jvm-opts too."><y>#</y><d>2021-07-06</d><h>06:45</h><r>onetom</r>managed to suppress the jetty related log message too. took this advice: <a href="https://stackoverflow.com/a/53064639/263983" target="_blank">https://stackoverflow.com/a/53064639/263983</a> and added <code>&quot;-Dorg.eclipse.jetty.util.log.announce=false&quot;</code> to the <code>:jvm-opts</code> too.</z><z id="t1625765809" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U086D6TBN&quot;}] thanks for sharing, i was curious how to fix that message myself."><y>#</y><d>2021-07-08</d><h>17:36</h><r>Drew Verlee</r><a>@U086D6TBN</a> thanks for sharing, i was curious how to fix that message myself.</z><z id="t1625800883" t="onetom where would be a good place to put all this info, so more cognitect.aws.api and datomic cloud users can benefit from it?"><y>#</y><d>2021-07-09</d><h>03:21</h><r>onetom</r>where would be a good place to put all this info, so more cognitect.aws.api and datomic cloud users can benefit from it?</z><z id="t1625817539" t="Drew Verlee The datomic forum maybe? Someone official would say least see it there and meet help redirect. Also it&apos;s persistent"><y>#</y><d>2021-07-09</d><h>07:58</h><r>Drew Verlee</r>The datomic forum maybe? 

Someone official would say least see it there and meet help redirect. Also it&apos;s persistent</z><z id="t1625766209" t="Drew Verlee I assume what and how many lambdas one should configure is mostly function of the processing power of that lambda. E.g given a webserver where all routes are relatively the same (simple gets, puts, etc..) it would be approprate to simply have one lambda given instances of it are created on demand. Where it would make sense to have two different lambdas, is when they handled vastly different loads. E.g i wanted to spin one up with twice the ram. Given that, is it reasonable that all my websocket handlers (connect, disconnect, default, custom) with a similar load, all go to one handler function and i just use polymorphic dispatch?"><y>#</y><d>2021-07-08</d><h>17:43</h><w>Drew Verlee</w>I assume what and how many lambdas one should configure is mostly function of the processing power of that lambda.

E.g given a webserver where all routes are relatively the same (simple gets, puts, etc..) it would be approprate to simply have one lambda given instances of it are created on demand.


Where it would make sense to have two different lambdas, is when they handled vastly different loads. E.g i wanted to spin one up with twice the ram.

Given that, is it reasonable that all my websocket handlers (connect, disconnect, default, custom) with a similar load, all go to one handler function and i just use polymorphic dispatch?</z><z id="t1625767297" t="Daniel Craig I think the more common pattern would be to put all your lambdas behind an API gateway api, and then just let API gateway handle the routing. That way you avoid having a dispatch lambda that invokes other lambdas"><y>#</y><d>2021-07-08</d><h>18:01</h><r>Daniel Craig</r>I think the more common pattern would be to put all your lambdas behind an API gateway api, and then just let API gateway handle the routing.  That way you avoid having a dispatch lambda that invokes other lambdas</z><z id="t1625770745" t="Drew Verlee [:attrs {:href &quot;/_/_/users/USDPTD3FY&quot;}] I agree, i plan on using API gateway protocals/fns to route to a single lambda."><y>#</y><d>2021-07-08</d><h>18:59</h><r>Drew Verlee</r><a>@USDPTD3FY</a>

I agree, i plan on using API gateway protocals/fns to route to a single lambda.</z><z id="t1625766247" t="Drew Verlee this is what i&apos;m using to guide my understanding of how to think about lambdas https://docs.aws.amazon.com/lambda/latest/dg/invocation-scaling.html"><y>#</y><d>2021-07-08</d><h>17:44</h><w>Drew Verlee</w>this is what i&apos;m using to guide my understanding of how to think about lambdas

<a href="https://docs.aws.amazon.com/lambda/latest/dg/invocation-scaling.html" target="_blank">https://docs.aws.amazon.com/lambda/latest/dg/invocation-scaling.html</a></z><z id="t1626082358" t="steveb8n Q: anyone have a sample or a gist showing how to use x-ray with the Cognitect aws client lib?"><y>#</y><d>2021-07-12</d><h>09:32</h><w>steveb8n</w>Q: anyone have a sample or a gist showing how to use x-ray with the Cognitect aws client lib?</z><z id="t1627054587" t="tbrooke I am starting with the Cognitect AWS client - just experimenting from the command line and I keep getting :Execution error (InstantiationError) at cognitect.http-client/ssl-context-factory (http_client.clj:253). org.eclipse.jetty.util.ssl.SslContextFactory I am thinking it is a credentials problem - I read that it gets credentials form the ENV I have ~/.aws and set AWS_SHARED_CREDENTIALS_FILE . I am not sure what else to do."><y>#</y><d>2021-07-23</d><h>15:36</h><w>tbrooke</w>I am starting with the Cognitect AWS client - just experimenting from the command line and I keep getting
 <code>:Execution error (InstantiationError) at cognitect.http-client/ssl-context-factory (http_client.clj:253).</code>
<code>org.eclipse.jetty.util.ssl.SslContextFactory</code>    
 I am thinking it is a credentials problem - I read that it gets credentials form the ENV I have ~/.aws and set AWS_SHARED_CREDENTIALS_FILE . I am not sure what else to do.</z><z id="t1627054698" t="ghadi can you paste the full stack trace, not just the first line?"><y>#</y><d>2021-07-23</d><h>15:38</h><w>ghadi</w>can you paste the full stack trace, not just the first line?</z><z id="t1627054713" t="ghadi also please paste what you typed to receive this error"><y>#</y><d>2021-07-23</d><h>15:38</h><w>ghadi</w>also please paste what you typed to receive this error</z><z id="t1627054724" t="ghadi and your dependencies"><y>#</y><d>2021-07-23</d><h>15:38</h><w>ghadi</w>and your dependencies</z><z id="t1627058056" t="tbrooke My namespace is: (ns trustblocks.awsclient (:require [cognitect.aws.client.api :as aws] [cognitect.aws.credentials :as creds])) Command: (def s3 (aws/client {:api :s3})) Stacktrace: clj꞉trustblocks.awsclient꞉&gt; (def s3 (aws/client {:api :s3})) ; Execution error (InstantiationError) at cognitect.http-client/ssl-context-factory (http_client.clj:253). ; org.eclipse.jetty.util.ssl.SslContextFactory clj꞉trustblocks.awsclient꞉&gt;   clojure.lang.Compiler$InvokeExpr/eval (Compiler.java:3711) clojure.lang.Compiler$DefExpr/eval (Compiler.java:457) clojure.lang.Compiler/eval (Compiler.java:7186) clojure.core/eval (core.clj:3202) clojure.core/eval (core.clj:3198) nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:87) clojure.core/apply (core.clj:667) clojure.core/with-bindings* (core.clj:1977) nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:87) clojure.main/repl (main.clj:437) clojure.main/repl (main.clj:458) clojure.main/repl (main.clj:368) nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:84) nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:56) nrepl.middleware.interruptible-eval/interruptible-eval (interruptible_eval.clj:152) nrepl.middleware.session/session-exec (session.clj:202) nrepl.middleware.session/session-exec (session.clj:201) java.lang.Thread/run (Thread.java:832)"><y>#</y><d>2021-07-23</d><h>16:34</h><w>tbrooke</w>My namespace is:
<code>(ns trustblocks.awsclient</code>
  (:require
    [cognitect.aws.client.api :as aws]
     [cognitect.aws.credentials :as creds]))

Command: <code>(def s3 (aws/client {:api :s3}))</code>
Stacktrace:
<code>clj꞉trustblocks.awsclient꞉&gt; (def s3 (aws/client {:api :s3}))</code>
<code>; Execution error (InstantiationError) at cognitect.http-client/ssl-context-factory (http_client.clj:253).</code>
<code>; org.eclipse.jetty.util.ssl.SslContextFactory</code>
<code>clj꞉trustblocks.awsclient꞉&gt;</code> 
<code>clojure.lang.Compiler$InvokeExpr/eval (Compiler.java:3711)</code>
<code>clojure.lang.Compiler$DefExpr/eval (Compiler.java:457)</code>
<code>clojure.lang.Compiler/eval (Compiler.java:7186)</code>
<code>clojure.core/eval (core.clj:3202)</code>
<code>clojure.core/eval (core.clj:3198)</code>
<code>nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:87)</code>
<code>clojure.core/apply (core.clj:667)</code>
<code>clojure.core/with-bindings* (core.clj:1977)</code>
<code>nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:87)</code>
<code>clojure.main/repl (main.clj:437)</code>
<code>clojure.main/repl (main.clj:458)</code>
<code>clojure.main/repl (main.clj:368)</code>
<code>nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:84)</code>
<code>nrepl.middleware.interruptible-eval/evaluate (interruptible_eval.clj:56)</code>
<code>nrepl.middleware.interruptible-eval/interruptible-eval (interruptible_eval.clj:152)</code>
<code>nrepl.middleware.session/session-exec (session.clj:202)</code>
<code>nrepl.middleware.session/session-exec (session.clj:201)</code>
<code>java.lang.Thread/run (Thread.java:832)</code></z><z id="t1627058273" t="ghadi https://clojurians.slack.com/archives/C09N0H1RB/p1627054724096200"><y>#</y><d>2021-07-23</d><h>16:37</h><w>ghadi</w><a href="https://clojurians.slack.com/archives/C09N0H1RB/p1627054724096200" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1627054724096200</a></z><z id="t1627059376" t="tbrooke :deps {metosin/malli {:mvn/version &quot;0.5.1&quot;} com.kiranshila/cybermonday {:mvn/version “0.2.0&quot;} ;; org.arachne-framework/arachne-fileset {:mvn/version “1.0.0-beta1”}, metosin/jsonista {:mvn/version “0.3.3&quot;} com.cognitect.aws/api {:mvn/version “0.8.515”} com.cognitect.aws/endpoints {:mvn/version “1.1.12.13&quot;} com.cognitect.aws/s3 {:mvn/version “811.2.934.0”} org.clojure/test.check {:mvn/version “1.1.0&quot;} cheshire/cheshire {:mvn/version “5.10.0”} biff/main {:git/url “ https://github.com/jacobobryant/biff ” :deps/root “libs/main” :sha “2a82eee794e0b34908ce169f3acfa322108b26cc”}} From command line: Echo $AWS_SHARED_CREDENTIALS_FILE /Users/tmb/.aws/credentials"><y>#</y><d>2021-07-23</d><h>16:56</h><w>tbrooke</w><code>:deps    {metosin/malli           {:mvn/version &quot;0.5.1&quot;}</code>
            com.kiranshila/cybermonday      {:mvn/version “0.2.0&quot;}
        ;;    org.arachne-framework/arachne-fileset {:mvn/version “1.0.0-beta1”},
            metosin/jsonista                          {:mvn/version “0.3.3&quot;}
            com.cognitect.aws/api                 {:mvn/version “0.8.515”}
            com.cognitect.aws/endpoints     {:mvn/version “1.1.12.13&quot;}
            com.cognitect.aws/s3                  {:mvn/version “811.2.934.0”}
            org.clojure/test.check                  {:mvn/version “1.1.0&quot;}
            cheshire/cheshire                        {:mvn/version “5.10.0”}
            biff/main                                       {:git/url   “<a href="https://github.com/jacobobryant/biff" target="_blank">https://github.com/jacobobryant/biff</a>”
                                                                    :deps/root “libs/main”
                                                                    :sha       “2a82eee794e0b34908ce169f3acfa322108b26cc”}}

From command line:

<code>Echo $AWS_SHARED_CREDENTIALS_FILE</code>
<code>/Users/tmb/.aws/credentials</code></z><z id="t1627059488" t="ghadi thanks!"><y>#</y><d>2021-07-23</d><h>16:58</h><w>ghadi</w>thanks!</z><z id="t1627060492" t="ghadi [:attrs {:href &quot;/_/_/users/U054219BT&quot;}] you have conflicting Jetty dependencies coming from aws-api and your web framework (biff?)"><y>#</y><d>2021-07-23</d><h>17:14</h><w>ghadi</w><a>@tbrooke</a>  you have conflicting Jetty dependencies coming from <code>aws-api</code>  and your web framework (biff?)</z><z id="t1627060524" t="ghadi"><y>#</y><d>2021-07-23</d><h>17:15</h><w>ghadi</w></z><z id="t1627060674" t="ghadi Not sure this is resolvable. You have half jetty 9.4 deps from aws-api, and half jetty 10.2 deps from biff"><y>#</y><d>2021-07-23</d><h>17:17</h><w>ghadi</w>Not sure this is resolvable.  You have half jetty 9.4 deps from aws-api, and half jetty 10.2 deps from biff</z><z id="t1627060795" t="tbrooke [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] Got it - I guess I can fork biff and change jetty dependency unless it breaks something else"><y>#</y><d>2021-07-23</d><h>17:19</h><w>tbrooke</w><a>@ghadi</a> Got it - I guess I can fork biff and change jetty dependency unless it breaks something else</z><z id="t1627060816" t="tbrooke [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] Thanks"><y>#</y><d>2021-07-23</d><h>17:20</h><w>tbrooke</w><a>@ghadi</a> Thanks</z><z id="t1627922548" t="Drew Verlee Has anyone successful set up AWS gateway-api with api-type=websockets and route integation type=http? AWS says they support this, but it&apos;s not clear how to properly configure it. e.g the http method for a $connect route should be what? (post, get, etc...) My context is datomic cloud which certainly matters."><y>#</y><d>2021-08-02</d><h>16:42</h><w>Drew Verlee</w>Has anyone successful set up AWS gateway-api with api-type=websockets and route integation type=http?

AWS says they support this, but it&apos;s not clear how to properly configure it. e.g the http method for a $connect route should be what? (post, get, etc...)

 My context is datomic cloud which certainly matters.</z><z id="t1628696739" t="Drew Verlee i was able to resolve this"><y>#</y><d>2021-08-11</d><h>15:45</h><r>Drew Verlee</r>i was able to resolve this</z><z id="t1628505238" t="practicalli-john Given a pipeline of services, all connected via kafka topics, would it be possible to programmatically spin up a particular service in the middle of the pipleline, based on a new kafka partition appearing? For example, we have ingestion, assembly, process, publish, export services. Assembly puts messages onto individual kafka partitions based on a unique id shared by 10,000 events Events are ingested and assembled sequentially. However, to scale the processing service, a new instance of the processing service would spin up when a new unique id was detected by one of the previous services (or some kind of monitoring service that had oversight over the whole process). Has anyone done anything like this before with Clojure and AWS (it doesnt have to be aws though)."><y>#</y><d>2021-08-09</d><h>10:33</h><w>practicalli-john</w>Given a pipeline of services, all connected via kafka topics, would it be possible to programmatically spin up a particular service in the middle of the pipleline, based on a new kafka partition appearing?
For example,  we have ingestion, assembly, process, publish, export services.  Assembly puts messages onto individual kafka partitions based on a unique id shared by 10,000 events
Events are ingested and assembled sequentially.  However, to scale the processing service, a new instance of the processing service would spin up when a new unique id was detected by one of the previous services (or some kind of monitoring service that had oversight over the whole process).
Has anyone done anything like this before with Clojure and AWS (it doesnt have to be aws though).</z><z id="t1628519045" t="dominicm ASGs run based on CloudWatch metrics. I&apos;m not sure if the managed kafka service publishes anyway CloudWatch metrics, but you could try that."><y>#</y><d>2021-08-09</d><h>14:24</h><r>dominicm</r>ASGs run based on CloudWatch metrics.  I&apos;m not sure if the managed kafka service publishes anyway CloudWatch metrics, but you could try that.</z><z id="t1628520755" t="practicalli-john Interesting. Ideally all events with the same id should be processed by the same instance (usually a stream of several thousand events), as data contained in previous events may affect the processing of newer events. I guess that is what makes it more than just scaling, its more like spinning up a parallel processing service with the data segregated by a specific data value. The data value to segregate the data is usually known a little in advance, up to a day, so there would be time to spin up and configure each specific process to use a specific id."><y>#</y><d>2021-08-09</d><h>14:52</h><r>practicalli-john</r>Interesting.
Ideally all events with the same id should be processed by the same instance (usually a stream of several thousand events), as data contained in previous events may affect the processing of newer events.  I guess that is what makes it more than just scaling, its more like spinning up a parallel processing service with the data segregated by a specific data value.  The data value to segregate the data is usually known a little in advance, up to a day, so there would be time to spin up and configure each specific process to use a specific id.</z><z id="t1628522231" t="dominicm I know Kafka Streams does that when it scales out, it has a whole system around state preservation and leader election to manage that."><y>#</y><d>2021-08-09</d><h>15:17</h><r>dominicm</r>I know Kafka Streams does that when it scales out, it has a whole system around state preservation and leader election to manage that.</z><z id="t1628523674" t="practicalli-john Yes, Kafka Streams seems to be the driver and it fit into what we are doing with events... Thanks"><y>#</y><d>2021-08-09</d><h>15:41</h><r>practicalli-john</r>Yes, Kafka Streams seems to be the driver and it fit into what we are doing with events...  Thanks</z><z id="t1628693965" t="Drew Verlee Any full examples of setting up a aws gateway API using cognitects client? Really, the client is clear, but what resources to create and how to integrate them isn&apos;t. Not a big issue for me, but it would be ideal to have the setup on code rather then through the console."><y>#</y><d>2021-08-11</d><h>14:59</h><w>Drew Verlee</w>Any full examples of setting up a aws gateway  API using cognitects client? Really, the client is clear, but what resources to create and how to integrate them isn&apos;t. 

Not a big  issue for me, but it would be ideal to have the setup on code rather then through the console.</z><z id="t1628699492" t="dabrazhe If you prefer to use code you could have a look at Pulumi IOC framework. There’s a port to ClojureScript. The Aws api is too verbose imho. "><y>#</y><d>2021-08-11</d><h>16:31</h><r>dabrazhe</r>If you prefer to use code you could have a look at Pulumi IOC framework. There’s a port to ClojureScript. The Aws api is too verbose imho. </z><z id="t1628855878" t="Dimitar Uzunov anyone been using graviton instances with Datomic for example? they seem to be a good idea for Clojure + Datomic peers"><y>#</y><d>2021-08-13</d><h>11:57</h><w>Dimitar Uzunov</w>anyone been using graviton instances with Datomic for example? they seem to be a good idea for Clojure + Datomic peers</z><z id="t1628965001" t="jjttjj I can use instance profiles so that, for example, the aws-api library wont need to be passed credentials because it uses this chain to check for credentials https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html Does anyone know if there&apos;s a way to use the aws CLI tools like this, avoiding explicitly passing credentials to the instance?"><y>#</y><d>2021-08-14</d><h>18:16</h><w>jjttjj</w>I can use instance profiles so that, for example, the aws-api library wont need to be passed credentials because it uses this chain to check for credentials <a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html" target="_blank">https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/credentials.html</a> Does anyone know if there&apos;s a way to use the aws CLI tools like this, avoiding explicitly passing credentials to the instance?</z><z id="t1628965703" t="viesti Seems possible https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-metadata.html"><y>#</y><d>2021-08-14</d><h>18:28</h><r>viesti</r>Seems possible <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-metadata.html" target="_blank">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-metadata.html</a></z><z id="t1628965754" t="viesti I thought that aws cli would automatically pick up the EC2 metadata server, if present, but seems there&apos;s credential_source = Ec2InstanceMetadata option: [profile profilename] role_arn = arn:aws:iam::123456789012:role/rolename credential_source = Ec2InstanceMetadata region = region"><y>#</y><d>2021-08-14</d><h>18:29</h><r>viesti</r>I thought that aws cli would automatically pick up the EC2 metadata server, if present, but seems there&apos;s <code>credential_source = Ec2InstanceMetadata</code> option:
<pre>[profile profilename]
role_arn = arn:aws:iam::123456789012:role/rolename
credential_source = Ec2InstanceMetadata
region = region</pre></z><z id="t1628967465" t="jjttjj Thanks! Somehow couldn&apos;t find that"><y>#</y><d>2021-08-14</d><h>18:57</h><r>jjttjj</r>Thanks! Somehow couldn&apos;t find that</z><z id="t1629123921" t="lukasz That&apos;s required only if you&apos;re using assume-role via CLI - EC2 instance can also assume a role automatically and expose credentials via the metadata endpoint without ~/.aws/config file"><y>#</y><d>2021-08-16</d><h>14:25</h><r>lukasz</r>That&apos;s required only if you&apos;re using assume-role via CLI - EC2 instance can also assume a role automatically and expose credentials via the metadata endpoint without ~/.aws/config file</z><z id="t1629369700" t="dabrazhe The right practice would be to use the instance profile and add the policies that allow access to the resources your cli command need. There should not be a need to use the --profile option, if done right"><y>#</y><d>2021-08-19</d><h>10:41</h><r>dabrazhe</r>The right practice would be to use the instance profile and add the policies that allow access to the resources your cli command need. There should not be a need to use the --profile option, if done right</z><z id="t1629304432" t="Ben Hammond Hi. I am trying to hook into AWS Cognito to exchange an authorization code for an id_token using #pedestal I have found that I can cobble something together using raw `org.eclipse.jetty.client.HttpClient` like this (defn logged-in [request] (println &quot;logged-in&quot;) (prn request) (let [cli (doto (HttpClient. (SslContextFactory$Client. true)) (.start)) req (doto (.POST cli &quot;&quot;) (.content (FormContentProvider. (doto (Fields.) (.add &quot;grant_type&quot; &quot;authorization_code&quot;) (.add &quot;client_id&quot; &quot;*****&quot;) (.add &quot;code&quot; (get-in request [:params :code])) (.add &quot;redirect_uri&quot; &quot;&quot;)))) ) ^ContentResponse cr (.send req) ] (clojure.pprint/pprint cr) (println (.getContentAsString cr)) but this seems a bit ugly but I don&apos;t want to introduce a new `clj-http` library just to extract id_token; mostly I am using `com.cognitect.aws/api` libraries Is that a cognitect api library function that will exchange authorization codes for id_tokens (that I&apos;ve not found)? Is there some more elegant way to run this code? I imagine it must be a fairly common thing to do... (cross-posted from #pedestal without waiting very long... hope that&apos;s ok)"><y>#</y><d>2021-08-18</d><h>16:33</h><w>Ben Hammond</w>Hi.
I am trying to hook into AWS Cognito to exchange an authorization code for an id_token using #pedestal
I have found that I can cobble something together using raw `org.eclipse.jetty.client.HttpClient` like this
<pre>(defn logged-in [request]
  (println &quot;logged-in&quot;)
  (prn request)
  (let [cli (doto (HttpClient. (SslContextFactory$Client. true)) (.start))
        req (doto
            (.POST cli &quot;&quot;)
              (.content (FormContentProvider.
                         (doto (Fields.)
                           (.add &quot;grant_type&quot; &quot;authorization_code&quot;)
                           (.add &quot;client_id&quot; &quot;*****&quot;)
                           (.add &quot;code&quot; (get-in request [:params :code]))
                           (.add &quot;redirect_uri&quot; &quot;&quot;))))
              )
        ^ContentResponse cr (.send req)
        ]
    (clojure.pprint/pprint cr)
    (println (.getContentAsString cr))</pre>
but this seems a bit ugly

but I don&apos;t want to introduce a new `clj-http` library just to extract id_token;
mostly I am using `com.cognitect.aws/api` libraries

Is that a cognitect api library function that will exchange authorization codes for id_tokens (that I&apos;ve not found)?
Is there some more elegant way to run this code?
I imagine it must be a fairly common thing to do...
(cross-posted from #pedestal without waiting very long... hope that&apos;s ok)</z><z id="t1629310857" t="ghadi cognitect aws-api only deals with AWS service APIs -- anything like oAuth is like an application level thing"><y>#</y><d>2021-08-18</d><h>18:20</h><w>ghadi</w>cognitect <code>aws-api</code> only deals with AWS service APIs -- anything like oAuth is like an application level thing</z><z id="t1629310977" t="ghadi (same thing interacting with ECR -- creating ECR repos is an amazon api, but using the docker registry that it created is an application thing)"><y>#</y><d>2021-08-18</d><h>18:22</h><w>ghadi</w>(same thing interacting with ECR -- creating ECR repos is an amazon api, but using the docker registry that it created is an application thing)</z><z id="t1629311123" t="ghadi [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] ^"><y>#</y><d>2021-08-18</d><h>18:25</h><w>ghadi</w><a>@ben.hammond</a> ^</z><z id="t1629316087" t="dominicm [:attrs {:href &quot;/_/_/users/U793EL04V&quot;}] You could use the http client that cognitect/aws-api uses? https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L10 I&apos;m not sure if the client was ever documented."><y>#</y><d>2021-08-18</d><h>19:48</h><w>dominicm</w><a>@ben.hammond</a> You could use the http client that cognitect/aws-api uses? <a href="https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L10" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/deps.edn#L10</a>   I&apos;m not sure if the client was ever documented.</z><z id="t1629316104" t="ghadi please don&apos;t use that"><y>#</y><d>2021-08-18</d><h>19:48</h><w>ghadi</w>please don&apos;t use that</z><z id="t1629316129" t="Ben Hammond I did consider it for 10 mins"><y>#</y><d>2021-08-18</d><h>19:48</h><w>Ben Hammond</w>I did consider it for 10 mins</z><z id="t1629316165" t="Ben Hammond Jetty one or the new java one is fine"><y>#</y><d>2021-08-18</d><h>19:49</h><w>Ben Hammond</w>Jetty one or the new java one is fine</z><z id="t1629316245" t="dominicm [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] What ever happened with the cognitect http-client? I vaguely recall hints that it would be open sourced at some point. Is that still the eventual plan?"><y>#</y><d>2021-08-18</d><h>19:50</h><w>dominicm</w><a>@ghadi</a> What ever happened with the cognitect http-client?  I vaguely recall hints that it would be open sourced at some point.  Is that still the eventual plan?</z><z id="t1629316571" t="Alex Miller (Clojure team) It is open source - the source is in the jar"><y>#</y><d>2021-08-18</d><h>19:56</h><w>Alex Miller (Clojure team)</w>It is open source - the source is in the jar</z><z id="t1629316779" t="dominicm Hmm, I thought it originally was licensed such that it wasn&apos;t open source. Are there plans to publish it as a project with documentation?"><y>#</y><d>2021-08-18</d><h>19:59</h><w>dominicm</w>Hmm, I thought it originally was licensed such that it wasn&apos;t open source.  Are there plans to publish it as a project with documentation?</z><z id="t1629318929" t="Alex Miller (Clojure team) it has always been open source afaik. I do not think there are any plans to publish it as a project (but not really my area)"><y>#</y><d>2021-08-18</d><h>20:35</h><w>Alex Miller (Clojure team)</w>it has always been open source afaik. I do not think there are any plans to publish it as a project (but not really my area)</z><z id="t1629319090" t="Alex Miller (Clojure team) all versions on Maven central include source, and it&apos;s licensed Apache 2"><y>#</y><d>2021-08-18</d><h>20:38</h><w>Alex Miller (Clojure team)</w>all versions on Maven central include source, and it&apos;s licensed Apache 2</z><z id="t1629319710" t="ghadi What alex said. It&apos;s always been open-source, and has a narrow scope, not a general purpose http lib, like you&apos;d want for aws api"><y>#</y><d>2021-08-18</d><h>20:48</h><w>ghadi</w>What alex said.  It&apos;s always been open-source, and has a narrow scope, not a general purpose http lib, like you&apos;d want for aws api</z><z id="t1629822240" t="kenny Does cognitect.aws.credentials.CredentialsProvider support returning an anomaly from the fetch method and &quot;forwarding&quot; that to invoke calls? I see that it does work right now, but is it intentional? (def c (aws/client {:api :ec2 :region &quot;us-west-2&quot; :credentials-provider (reify aws-creds/CredentialsProvider (fetch [_] {:cognitect.anomalies/category :cognitect.anomalies/forbidden}))})) (aws/invoke c {:op :DescribeInstances}) =&gt; #:cognitect.anomalies{:category :cognitect.anomalies/forbidden}"><y>#</y><d>2021-08-24</d><h>16:24</h><w>kenny</w>Does <code>cognitect.aws.credentials.CredentialsProvider</code> support returning an anomaly from the <code>fetch</code> method and &quot;forwarding&quot; that to <code>invoke</code> calls? I see that it does work right now, but is it intentional?
<pre>(def c (aws/client
           {:api                  :ec2
            :region               &quot;us-west-2&quot;
            :credentials-provider (reify aws-creds/CredentialsProvider
                                    (fetch [_]
                                      {:cognitect.anomalies/category :cognitect.anomalies/forbidden}))}))

  (aws/invoke c {:op :DescribeInstances})
=&gt; #:cognitect.anomalies{:category :cognitect.anomalies/forbidden}</pre></z><z id="t1629822475" t="kenny It seems like it supports it in https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/client.clj#L91-L92 . My hesitation comes from https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/credentials.clj#L26 of the fetch method."><y>#</y><d>2021-08-24</d><h>16:27</h><r>kenny</r>It seems like it supports it in <a href="https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/client.clj#L91-L92" target="_blank">https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/client.clj#L91-L92</a>. My hesitation comes from <a href="https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/credentials.clj#L26" target="_blank">https://github.com/cognitect-labs/aws-api/blob/33848c413144db7734db330386c1ae570936c959/src/cognitect/aws/credentials.clj#L26</a> of the fetch method.</z><z id="t1630483618" t="Ben Hammond What is considered best practise for secure handling of AWS id_token s within a CLJS app? AWS (unhelpfully) says &gt; Important &gt; We strongly recommended that you secure all tokens in transit and storage in the context of your application. But without much guidance about how to go about doing that... the CLJS app • receives an id_token from a pedestal datomic ions back-end • needs to present this id_token within an HTTP header upon every REST call which implies keeping it with a state variable or in Browser local storage How can do I do better than that? (Its not like I&apos;m working with super sensitive data...)"><y>#</y><d>2021-09-01</d><h>08:06</h><w>Ben Hammond</w>What is considered best practise for secure handling of AWS <code>id_token</code>s within a CLJS app?

AWS (unhelpfully) says
&gt; Important
&gt; We strongly recommended that you secure all tokens in transit and storage in the context of your application.
But without much guidance about how to go about doing that...

the CLJS app
• receives an <code>id_token</code> from a pedestal datomic ions back-end
• needs to present this <code>id_token</code> within an HTTP header upon every REST call
which implies keeping it with a state variable or in Browser local storage
How can do I do better than that?
(Its not like I&apos;m working with super sensitive data...)</z><z id="t1630627006" t="MikeE Local storage has a risk of XSS. A better option is to use cookies but you need to set the httpOnly flag, send over SSL and only to the same site you served the client application from. That scenario may or may not be a situation you&apos;re deployment supports ."><y>#</y><d>2021-09-02</d><h>23:56</h><w>MikeE</w>Local storage has a risk of XSS.   A better option is to use cookies but you need to set the httpOnly flag, send over SSL and only to the same site you served the client application from.    That scenario may or may not be a situation you&apos;re deployment supports .</z><z id="t1631497869" t="Drew Verlee FWIW this post seems to disagree that it&apos;s more secure. https://academind.com/tutorials/localstorage-vs-cookies-xss"><y>#</y><d>2021-09-13</d><h>01:51</h><r>Drew Verlee</r>FWIW this post seems to disagree that it&apos;s more secure. <a href="https://academind.com/tutorials/localstorage-vs-cookies-xss" target="_blank">https://academind.com/tutorials/localstorage-vs-cookies-xss</a></z><z id="t1630672726" t="dominicm pedestal may set the flag by default, given it&apos;s secure defaults approach."><y>#</y><d>2021-09-03</d><h>12:38</h><w>dominicm</w>pedestal may set the flag by default, given it&apos;s secure defaults approach.</z><z id="t1631062434" t="Drew Verlee Xss is cross site scripting? I thought local storage read write was per domain. Why would cookies be better?"><y>#</y><d>2021-09-08</d><h>00:53</h><w>Drew Verlee</w>Xss is cross site scripting? I thought local storage read write was per domain. Why would cookies be better?</z><z id="t1631063143" t="Drew Verlee Oh right, the malicious code could come from your origin for one."><y>#</y><d>2021-09-08</d><h>01:05</h><w>Drew Verlee</w>Oh right, the malicious code could come from your origin for one.</z><z id="t1631224140" t="dominicm cookies can be fenced off from js altogether, yeah"><y>#</y><d>2021-09-09</d><h>21:49</h><w>dominicm</w>cookies can be fenced off from js altogether, yeah</z><z id="t1631303146" t="fogus (Clojure Team) New Cognitect Labs aws-api service APIs available! CHANGES new AWS service API available (services version v814.2.986.0): opensearch README: https://github.com/cognitect-labs/aws-api/ API Docs: https://cognitect-labs.github.io/aws-api/ Changelog: https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md Upgrade Notes: https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md Latest Releases of api, endpoints, and all services: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2021-09-10</d><h>19:45</h><w>fogus (Clojure Team)</w>New Cognitect Labs aws-api service APIs available!

CHANGES
new AWS service API available (services version v814.2.986.0): opensearch

README: <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a>

API Docs: <a href="https://cognitect-labs.github.io/aws-api/" target="_blank">https://cognitect-labs.github.io/aws-api/</a>
Changelog: <a href="https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md</a>
Upgrade Notes: <a href="https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md</a>
Latest Releases of api, endpoints, and all services: <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1631531828" t="thomas Hi, a slightly more generic (yet, also very specific) question regarding AWS RDS. How do people manage db changes on different env (like add column in all you envs)"><y>#</y><d>2021-09-13</d><h>11:17</h><w>thomas</w>Hi, a slightly more generic (yet, also very specific) question regarding AWS RDS. How do people manage db changes on different env (like add column in all you envs)</z><z id="t1631537631" t="nbardiuk Our team uses https://github.com/weavejester/ragtime to migrate DB schema and sometimes update data. We run the DB migration during deployment pipeline for each env."><y>#</y><d>2021-09-13</d><h>12:53</h><w>nbardiuk</w>Our team uses <a href="https://github.com/weavejester/ragtime" target="_blank">https://github.com/weavejester/ragtime</a> to migrate DB schema and sometimes update data. We run the DB migration during deployment pipeline for each env.</z><z id="t1631537691" t="nbardiuk Another approach is to run migrations during application startup that is was metabase doing (using liquibase) https://github.com/metabase/metabase/search?p=1&amp;amp;q=liquibase"><y>#</y><d>2021-09-13</d><h>12:54</h><w>nbardiuk</w>Another approach is to run migrations during application startup that is was metabase doing (using liquibase) <a href="https://github.com/metabase/metabase/search?p=1&amp;amp;q=liquibase" target="_blank">https://github.com/metabase/metabase/search?p=1&amp;amp;q=liquibase</a></z><z id="t1631542819" t="thomas I have used Liquibase in the past, but that was for self hosted DB, and not RDS. But I&apos;ll have a look into it. Thank you"><y>#</y><d>2021-09-13</d><h>14:20</h><r>thomas</r>I have used Liquibase in the past, but that was for self hosted DB, and not RDS. But I&apos;ll have a look into it. Thank you</z><z id="t1631612378" t="Ben Hammond oh I only iust realised that it should be possible to get an AWS JWT authorizer to read cookes (rather than just an HTTP Header) I mean Cookies IS an http header, so it becomes more about how to extract the JWT substring"><y>#</y><d>2021-09-14</d><h>09:39</h><w>Ben Hammond</w>oh I only iust realised that it should be possible to get an AWS JWT authorizer to read cookes (rather than just an HTTP Header)
I mean <code>Cookies</code> IS an http header, so it becomes more about how to extract the JWT substring</z><z id="t1631612699" t="Ben Hammond the syntax of the identity Source is not obvious; if I guessed at something like $request.cookies.idtoken is that likely, do you think?"><y>#</y><d>2021-09-14</d><h>09:44</h><r>Ben Hammond</r>the syntax of the identity Source is not obvious;
if I guessed at something like
<pre>$request.cookies.idtoken</pre>
is that likely, do you think?</z><z id="t1631612758" t="Ben Hammond https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-lambda-authorizer.html"><y>#</y><d>2021-09-14</d><h>09:45</h><r>Ben Hammond</r><a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-lambda-authorizer.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-lambda-authorizer.html</a></z><z id="t1631612780" t="Ben Hammond maybe I have to linearly search the cookies"><y>#</y><d>2021-09-14</d><h>09:46</h><r>Ben Hammond</r>maybe I have to linearly search the cookies</z><z id="t1631613105" t="Ben Hammond meh &gt; For `JWT`, a single entry that specifies where to extract the JSON Web Token (JWT) from inbound requests. Currently only header-based and query parameter-based selections are supported, for example `$request.header.Authorization`."><y>#</y><d>2021-09-14</d><h>09:51</h><r>Ben Hammond</r>meh
&gt; For `JWT`, a single entry that specifies where to extract the JSON Web Token (JWT) from inbound requests. Currently only header-based and query parameter-based selections are supported, for example `$request.header.Authorization`.</z><z id="t1631613166" t="Ben Hammond no cookies"><y>#</y><d>2021-09-14</d><h>09:52</h><r>Ben Hammond</r>no cookies</z><z id="t1631613548" t="Ben Hammond so I have a server generated /logged-in that has an ID token JWT I have a clent react app that will need to make API calls presenting the JWT in a header or query the /logged-in makes an HTTP/302 to redirect to the client url I would rather not use query params if I can avoid it but how can I get the idtoken to the react app? Seems like cookie is my best option? maybe I can put it in an HTTP response header"><y>#</y><d>2021-09-14</d><h>09:59</h><r>Ben Hammond</r>so
I have a server generated <code>/logged-in</code> that has an ID token JWT
I have a clent react app that will need to make API calls presenting the JWT in a header or query

the <code>/logged-in</code> makes an HTTP/302 to redirect to the client url

I would rather not use query params if I can avoid it

but how can I get the idtoken to the react app?
Seems like cookie is my best option?
maybe I can put it in an HTTP response header</z><z id="t1631614397" t="Ben Hammond seems like 1. server drops a session cookie, redirects to react app /loggedin route 2. react /loggedin makes a fetchApi request to server /credentials endpoint 3. server responds with JWT string and other client-useful info in a JSON map body; it also deletes the session cookie 4. client stashes the JWT string in its (volatile) global state and presents in HTTP header going forwards seems a bit round the houses though; is there really no way to shortcut this?"><y>#</y><d>2021-09-14</d><h>10:13</h><r>Ben Hammond</r>seems like
1. server drops a session cookie, redirects to react app <code>/loggedin</code> route
2. react <code>/loggedin</code> makes a fetchApi request to server <code>/credentials</code> endpoint
3. server responds with JWT string and other client-useful info in a JSON map body; it also deletes the session cookie
4. client stashes the JWT string in its (volatile) global state and presents in HTTP header going forwards
seems a bit round the houses though; is there really no way to shortcut this?</z><z id="t1631614451" t="Ben Hammond I guess there might be better security in taking each step one at a time..?"><y>#</y><d>2021-09-14</d><h>10:14</h><r>Ben Hammond</r>I guess there might be better security in taking each step one at a time..?</z><z id="t1631612699" t="Ben Hammond the syntax of the identity Source is not obvious; if I guessed at something like $request.cookies.idtoken is that likely, do you think?"><y>#</y><d>2021-09-14</d><h>09:44</h><w>Ben Hammond</w>the syntax of the identity Source is not obvious;
if I guessed at something like
<pre>$request.cookies.idtoken</pre>
is that likely, do you think?</z><z id="t1631893762" t="aaelony Hi! In the R language community there exists a place (e.g. https://r-universe.dev/organizations/ to house working scripts that others may find useful and use). It occurs to me that the excellent cognitect-labs/aws-api project has been around for a few years and there are likely many who have put together generic utilities that spin up ec2 nodes in a &quot;batteries included&quot; fashion (e.g. OS, latest version of emacs and installs, perhaps latest R installed and more) and these might be in such a sharable place described above. My question might be (1) Does anything like this shareable place exist? and (2) where might I find interesting uses of aws-api used to launch ec2 nodes in clever ways ? Thanks in advance!"><y>#</y><d>2021-09-17</d><h>15:49</h><w>aaelony</w>Hi!  In the R language community there exists a place (e.g. <a href="https://r-universe.dev/organizations/" target="_blank">https://r-universe.dev/organizations/</a> to house working scripts that others may find useful and use).  It occurs to me that the excellent <code>cognitect-labs/aws-api</code> project has been around for a few years and there are likely many who have put together generic utilities that spin up <code>ec2</code> nodes in a &quot;batteries included&quot; fashion (e.g. OS, latest version of emacs and installs, perhaps latest R installed and more) and these might be in such a sharable place described above.  My question might be (1) Does anything like this shareable place exist? and (2) where might I find interesting uses of <code>aws-api</code> used to launch <code>ec2</code> nodes in clever ways ?  Thanks in advance!</z><z id="t1631893836" t="aaelony to be clear, I am seeking things in similar vein to https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj but going far beyond that"><y>#</y><d>2021-09-17</d><h>15:50</h><w>aaelony</w>to be clear, I am seeking things in similar vein to <a href="https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/examples/ec2_examples.clj</a> but going far beyond that</z><z id="t1632169503" t="Ben Hammond I am using Cognito to generate user id_tokens I would like to be able to hand-create my own id_token, with the public bit of the signing key available at . So I need to either i) access the Signing Key that Cognito is using to sign its tokens OR ii) create my own signing key , and poke the public bit ito ~/.well-known/jwks.json I was just having a go at i), and I thought that https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_GetSigningCertificate.html looked promising, but then I released that I didn&apos;t known what to do with it ... (-&gt; (-&gt;&gt; {:op :GetSigningCertificate :request {:UserPoolId &quot;eu-west-2_*****&quot;}} (aws/invoke (aws/client {:api :cognito-idp :region :eu-west-2})) (:Certificate) (.decode (java.util.Base64/getDecoder))) (String. &quot;ISO-8859-1&quot;)) returns garbage How would you go about signing your own JWTs and making the verification key available?"><y>#</y><d>2021-09-20</d><h>20:25</h><w>Ben Hammond</w>I am using Cognito to generate user id_tokens
I would like to be able to hand-create my own id_token,
with the public bit of the signing key available at
<code>.</code>

So I need to either
i) access the Signing Key that Cognito is using to sign  its tokens
OR
ii) create my own signing key , and poke the public bit ito <code>~/.well-known/jwks.json</code>

I was just having a go at i), and I thought that <a href="https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_GetSigningCertificate.html" target="_blank">https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_GetSigningCertificate.html</a> looked promising,
but then I released that I didn&apos;t known what to do with it ...
<pre>(-&gt; 
 (-&gt;&gt;
  {:op :GetSigningCertificate :request {:UserPoolId &quot;eu-west-2_*****&quot;}}
  (aws/invoke (aws/client {:api :cognito-idp :region :eu-west-2}))
  (:Certificate)
  (.decode (java.util.Base64/getDecoder)))
 (String. &quot;ISO-8859-1&quot;))</pre>
returns garbage

How would you go about signing your own JWTs and making the verification key available?</z><z id="t1632658769" t="viesti I wonder if anyone has tried to make use of Terraform provider schemas in Clojure land"><y>#</y><d>2021-09-26</d><h>12:19</h><w>viesti</w>I wonder if anyone has tried to make use of Terraform provider schemas in Clojure land</z><z id="t1632658807" t="viesti So I went and hacked a sample, that reads in provider schemas, and make some additional namespaced keywords to give helpers for typing out resources at the repl: https://github.com/viesti/clj-tf"><y>#</y><d>2021-09-26</d><h>12:20</h><w>viesti</w>So I went and hacked a sample, that reads in provider schemas, and make some additional namespaced keywords to give helpers for typing out resources at the repl: <a href="https://github.com/viesti/clj-tf" target="_blank">https://github.com/viesti/clj-tf</a></z><z id="t1632658849" t="viesti just a hacky idea, was thinking on how to do somethink like CDK intellisense, but for pure data"><y>#</y><d>2021-09-26</d><h>12:20</h><w>viesti</w>just a hacky idea, was thinking on how to do somethink like CDK intellisense, but for pure data</z><z id="t1632658873" t="viesti and then thought about making all resource blocks/attributes namespaced..."><y>#</y><d>2021-09-26</d><h>12:21</h><w>viesti</w>and then thought about making all resource blocks/attributes namespaced...</z><z id="t1632658937" t="viesti the above doesn&apos;t make nested blocks into namespaced keywords though, since keywords have a single namespace only, could maybe make a convention to glue type name + block name as namespace"><y>#</y><d>2021-09-26</d><h>12:22</h><w>viesti</w>the above doesn&apos;t make nested blocks into namespaced keywords though, since keywords have a single namespace only, could maybe make a convention to glue type name + block name as namespace</z><z id="t1632660713" t="kulminaator :thinking_face: isn&apos;t the output of cdk pure data anyway?"><y>#</y><d>2021-09-26</d><h>12:51</h><w>kulminaator</w><b>:thinking_face:</b> isn&apos;t the output of cdk pure data anyway?</z><z id="t1632661672" t="viesti yup"><y>#</y><d>2021-09-26</d><h>13:07</h><w>viesti</w>yup</z><z id="t1632661695" t="viesti just that cdk makes kinda this &quot;dsl&quot; to create the data"><y>#</y><d>2021-09-26</d><h>13:08</h><w>viesti</w>just that cdk makes kinda this &quot;dsl&quot; to create the data</z><z id="t1632661756" t="Karol Wójcik Btw is using CDK makes it really easier/more reliable to provision infrastructure? I have used it several times, but always come back to terraform with huge relief."><y>#</y><d>2021-09-26</d><h>13:09</h><w>Karol Wójcik</w>Btw is using CDK makes it really easier/more reliable to provision infrastructure? I have used it several times, but always come back to terraform with huge relief.</z><z id="t1632661768" t="viesti and langs that popup stuff in ides after typing a dot after a symbol kinda limit the amout of options to put &quot;data&quot; in"><y>#</y><d>2021-09-26</d><h>13:09</h><w>viesti</w>and langs that popup stuff in ides after typing a dot after a symbol kinda limit the amout of options to put &quot;data&quot; in</z><z id="t1632661788" t="viesti terraform has a cdk also btw"><y>#</y><d>2021-09-26</d><h>13:09</h><w>viesti</w>terraform has a cdk also btw</z><z id="t1632661811" t="viesti they even use this same jsii magic"><y>#</y><d>2021-09-26</d><h>13:10</h><w>viesti</w>they even use this same jsii magic</z><z id="t1632661848" t="viesti https://github.com/hashicorp/terraform-cdk"><y>#</y><d>2021-09-26</d><h>13:10</h><w>viesti</w><a href="https://github.com/hashicorp/terraform-cdk" target="_blank">https://github.com/hashicorp/terraform-cdk</a></z><z id="t1632661884" t="viesti but anyhow, that bottoms out on plain tf, you get plan &amp; other normal TF niceties"><y>#</y><d>2021-09-26</d><h>13:11</h><w>viesti</w>but anyhow, that bottoms out on plain tf, you get plan &amp; other normal TF niceties</z><z id="t1632662933" t="kulminaator we run very small and shallow stacks, so pure aws cloudformation has so far been rather sufficient. the only parts where this is annoying is cases where you need stuff like 5 almost identical machines across 3 availability zones. in those cases i feel like cdk would help. after amazon added the import-export of variables it&apos;s somewhat usable approach"><y>#</y><d>2021-09-26</d><h>13:28</h><w>kulminaator</w>we run very small and shallow stacks, so pure aws cloudformation has so far been rather sufficient. the only parts where this is annoying is cases where you need stuff like 5 almost identical machines across 3 availability zones. in those cases i feel like cdk would help. after amazon added the import-export of variables it&apos;s somewhat usable approach</z><z id="t1632663278" t="viesti just thinking that spitting out data is nice in Clojure, there are these odd data spitting libs in other langs (like sceptre for python), CDK goes towards kind of extreme in having data spitting with this jsii thing for many langs, how to get a nice data feel for Clojure, with just some added typing (completion) helpers"><y>#</y><d>2021-09-26</d><h>13:34</h><w>viesti</w>just thinking that spitting out data is nice in Clojure, there are these odd data spitting libs in other langs (like sceptre for python), CDK goes towards kind of extreme in having data spitting with this jsii thing for many langs, how to get a nice data feel for Clojure, with just some added typing (completion) helpers</z><z id="t1632678752" t="ghadi anyone have a theory for why cdk-clj didn&apos;t take off? [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] "><y>#</y><d>2021-09-26</d><h>17:52</h><w>ghadi</w>anyone have a theory for why cdk-clj didn&apos;t take off? <a>@viesti</a> </z><z id="t1632743042" t="steveb8n I was using it, then followed the authors to typescript cdk and the DX was much better. Since it&apos;s all side effects, a functional language didn&apos;t add much benefit. My guess, they realised it wasn&apos;t a good fit and required a lot of maintenance"><y>#</y><d>2021-09-27</d><h>11:44</h><r>steveb8n</r>I was using it, then followed the authors to typescript cdk and the DX was much better. Since it&apos;s all side effects, a functional language didn&apos;t add much benefit. My guess, they realised it wasn&apos;t a good fit and required a lot of maintenance</z><z id="t1632744840" t="viesti good summary, though I&apos;d still kinda think that Clojure is pretty neat for generating data, and CloudFormation bottoms out as data (that is consumed by the CloudFormation service itself) and funny thing that only after just now trying to generate Terraform as JSON, the whole HCL mapping to data structures feels kinda nice 🙂 So this got me thinking on a way to make typing the data easier on Clojure side, best would be to have some intellisense that could suggest attribute names and references to other resource attributes, wondering this could partially be solved with fully qualified keywords 🙂"><y>#</y><d>2021-09-27</d><h>12:14</h><r>viesti</r>good summary, though I&apos;d still kinda think that Clojure is pretty neat for generating data, and CloudFormation bottoms out as data (that is consumed by the CloudFormation service itself) and funny thing that only after just now trying to generate Terraform as JSON, the whole HCL mapping to data structures feels kinda nice <b>🙂</b>

So this got me thinking on a way to make typing the data easier on Clojure side, best would be to have some intellisense that could suggest attribute names and references to other resource attributes, wondering this could partially be solved with fully qualified keywords <b>🙂</b></z><z id="t1632779033" t="steveb8n If you just want CF json then this works well https://github.com/brabster/crucible"><y>#</y><d>2021-09-27</d><h>21:43</h><r>steveb8n</r>If you just want CF json then this works well <a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a></z><z id="t1632779127" t="steveb8n [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}]"><y>#</y><d>2021-09-27</d><h>21:45</h><r>steveb8n</r><a>@viesti</a></z><z id="t1632806615" t="viesti ah yes, have forgotten about that 🙂 There also this edn-to-cfn spike that my colleague did, generates clojure.spec from the CF schema programmatically: https://github.com/portkey-cloud/edn-to-cfn"><y>#</y><d>2021-09-28</d><h>05:23</h><r>viesti</r>ah yes, have forgotten about that <b>🙂</b> There also this edn-to-cfn spike that my colleague did, generates clojure.spec from the CF schema programmatically: <a href="https://github.com/portkey-cloud/edn-to-cfn" target="_blank">https://github.com/portkey-cloud/edn-to-cfn</a></z><z id="t1632806686" t="viesti both Terraform and Cloudformation have their &quot;spec&quot; in machine readable format, allows to programmatically generate them"><y>#</y><d>2021-09-28</d><h>05:24</h><r>viesti</r>both Terraform and Cloudformation have their &quot;spec&quot; in machine readable format, allows to programmatically generate them</z><z id="t1632806754" t="viesti Emacs Cider even has a spec browser to navigate the generated specs"><y>#</y><d>2021-09-28</d><h>05:25</h><r>viesti</r>Emacs Cider even has a spec browser to navigate the generated specs</z><z id="t1632679076" t="viesti I guess the editor intellisense just wasn&apos;t there for Clojure, there&apos;s so many resource names and attributes/block per resource that looking up the correct names to spell without any help takes time, at least if you&apos;re not familiar with the resources"><y>#</y><d>2021-09-26</d><h>17:57</h><w>viesti</w>I guess the editor intellisense just wasn&apos;t there for Clojure, there&apos;s so many resource names and attributes/block per resource that looking up the correct names to spell without any help takes time, at least if you&apos;re not familiar with the resources</z><z id="t1632679171" t="viesti somewhere along those lines, if I remember correctly from following the #cdk-clj channel back in the day :)"><y>#</y><d>2021-09-26</d><h>17:59</h><w>viesti</w>somewhere along those lines, if I remember correctly from following the #cdk-clj channel back in the day :)</z><z id="t1632680743" t="viesti So I thought that could these resource thingies be baked into keywords, bake the context into the keyword namespace+name, so completing &amp; discovery would be easy. The keywords might become kinda long though 🙂 (like :aws_cloudfront_distribution-origin-custom_header/name )"><y>#</y><d>2021-09-26</d><h>18:25</h><w>viesti</w>So I thought that could these resource thingies be baked into keywords, bake the context into the keyword namespace+name, so completing &amp; discovery would be easy. The keywords might become kinda long though <b>🙂</b> (like <code>:aws_cloudfront_distribution-origin-custom_header/name</code>)</z><z id="t1632680886" t="viesti now remembering aws-api Conj presentation and datafy+nav, didn&apos;t Stu say that he almost had a navigable aws service api thing at hand? 🙂"><y>#</y><d>2021-09-26</d><h>18:28</h><w>viesti</w>now remembering aws-api Conj presentation and datafy+nav, didn&apos;t Stu say that he almost had a navigable aws service api thing at hand? <b>🙂</b></z><z id="t1632681378" t="Alex Miller (Clojure team) The cognitect aws-api supports datafy/nav and works well with REBL (and David Chelimsky demo&apos;ed that in a different talk at the same conj)"><y>#</y><d>2021-09-26</d><h>18:36</h><w>Alex Miller (Clojure team)</w>The cognitect aws-api supports datafy/nav and works well with REBL (and David Chelimsky demo&apos;ed that in a different talk at the same conj)</z><z id="t1632681516" t="Alex Miller (Clojure team) https://www.youtube.com/watch?v=ppDtDP0Rntw"><y>#</y><d>2021-09-26</d><h>18:38</h><w>Alex Miller (Clojure team)</w><a href="https://www.youtube.com/watch?v=ppDtDP0Rntw" target="_blank">https://www.youtube.com/watch?v=ppDtDP0Rntw</a></z><z id="t1632681528" t="Alex Miller (Clojure team) I&apos;m not sure if that&apos;s what you&apos;re referring to?"><y>#</y><d>2021-09-26</d><h>18:38</h><w>Alex Miller (Clojure team)</w>I&apos;m not sure if that&apos;s what you&apos;re referring to?</z></g><g id="s15"><z id="t1632682112" t="viesti it might be &quot;datafy ARN&quot; that I was trying to remember https://youtu.be/ppDtDP0Rntw?t=2639"><y>#</y><d>2021-09-26</d><h>18:48</h><w>viesti</w>it might be &quot;datafy ARN&quot; that I was trying to remember <a href="https://youtu.be/ppDtDP0Rntw?t=2639" target="_blank">https://youtu.be/ppDtDP0Rntw?t=2639</a></z><z id="t1632682169" t="viesti Stu&apos;s example on look datomic logs, find a thing that looks like an ARN, datafy it and hop onto it, something like that 🙂"><y>#</y><d>2021-09-26</d><h>18:49</h><w>viesti</w>Stu&apos;s example on look datomic logs, find a thing that looks like an ARN, datafy it and hop onto it, something like that <b>🙂</b></z><z id="t1632682429" t="Alex Miller (Clojure team) ah, don&apos;t know about that"><y>#</y><d>2021-09-26</d><h>18:53</h><w>Alex Miller (Clojure team)</w>ah, don&apos;t know about that</z><z id="t1632843284" t="Ben Hammond I&apos;m trying to understand how to manually verify a JWT from its jwks public key properties I have a ~/.well-known/jwks.json that looki like {&quot;alg&quot;:&quot;RS256&quot;, &quot;e&quot;:&quot;AQAB&quot;, &quot;kid&quot;:&quot;nIkH2Qf4xgTHg5Tyr8kb6EbrACIbzdbjjKjsIgThxAk=&quot;, &quot;kty&quot;:&quot;RSA&quot;, &quot;n&quot;:&quot;twLD4PL2Dk0SB1kpv34Vkv7ChT78idsbbu08bzzn0e3hCxehKPB3K8X_0aL99lxpgRDzUjuFYYeOTlzcHQUdb5L9E68Ktd_H8nxvLC1oqTkTyUp6xgbdiKh6OGg3AVE65lensfDeAn_BpR7TTnffeTBIVrI2KD8Vyt2CnfPKNfwSblHKtfNKm-o0Rb_IiGzdAutbedACToEkmsfnQ_AaMqHiY7XBuZ12qR04lbKGqWEol5PHKFquXtw7Nrs7CaXx0RqDesKHuRIC-FXGNs8jzfRzv2nNUAbG__jjsqlwlr-6OUSaHpuIf0hWJOG3mzc_6QAaB_TiIQuL2TmMEV_lew&quot;, &quot;use&quot;:&quot;sig&quot;}, and I am trying to plug those key properties into (com.auth0.jwt.JWT/require (com.auth0.jwt.algorithms.Algorithm/RSA256 (.generatePublic (KeyFactory/getInstance &quot;RSA&quot;) (RSAPublicKeySpec. (biginteger (.decode (java.util.Base64/getUrlDecoder) n)) (biginteger (.decode (Base64/getUrlDecoder) e)))) nil)) but the modulus is coming out negative (and it is supposed to be a Base64urlUInt putting an .abs on does not seem to help tells me the signature is good, so what am I missing? how do I decode a a jwks modulus into a positive BigInteger?"><y>#</y><d>2021-09-28</d><h>15:34</h><w>Ben Hammond</w>I&apos;m trying to understand how to manually verify a JWT from its jwks public key properties
I have a ~/.well-known/jwks.json that looki like
<pre>{&quot;alg&quot;:&quot;RS256&quot;,
&quot;e&quot;:&quot;AQAB&quot;,
&quot;kid&quot;:&quot;nIkH2Qf4xgTHg5Tyr8kb6EbrACIbzdbjjKjsIgThxAk=&quot;,
&quot;kty&quot;:&quot;RSA&quot;,
&quot;n&quot;:&quot;twLD4PL2Dk0SB1kpv34Vkv7ChT78idsbbu08bzzn0e3hCxehKPB3K8X_0aL99lxpgRDzUjuFYYeOTlzcHQUdb5L9E68Ktd_H8nxvLC1oqTkTyUp6xgbdiKh6OGg3AVE65lensfDeAn_BpR7TTnffeTBIVrI2KD8Vyt2CnfPKNfwSblHKtfNKm-o0Rb_IiGzdAutbedACToEkmsfnQ_AaMqHiY7XBuZ12qR04lbKGqWEol5PHKFquXtw7Nrs7CaXx0RqDesKHuRIC-FXGNs8jzfRzv2nNUAbG__jjsqlwlr-6OUSaHpuIf0hWJOG3mzc_6QAaB_TiIQuL2TmMEV_lew&quot;,
&quot;use&quot;:&quot;sig&quot;},</pre>
and I am trying to plug those key properties into
<pre>(com.auth0.jwt.JWT/require
     (com.auth0.jwt.algorithms.Algorithm/RSA256
      (.generatePublic (KeyFactory/getInstance &quot;RSA&quot;)
                       (RSAPublicKeySpec.
                        (biginteger (.decode (java.util.Base64/getUrlDecoder) n))
                        (biginteger (.decode (Base64/getUrlDecoder) e)))) nil))</pre>
but the modulus is coming out negative
(and it is supposed to be a <code>Base64urlUInt</code>
putting an .abs on does not seem to help

<code></code> tells me the signature is good, so what am I missing?

how do I decode a a jwks modulus into a positive BigInteger?</z><z id="t1632843591" t="Ben Hammond oh theres an arity-2 BigInteger constructor public BigInteger(int signum, byte[] magnitude, int off, int len) { "><y>#</y><d>2021-09-28</d><h>15:39</h><r>Ben Hammond</r>oh theres an arity-2 BigInteger constructor
<pre>public BigInteger(int signum, byte[] magnitude, int off, int len) {
 </pre></z><z id="t1632843712" t="Ben Hammond that was indeed my problem..."><y>#</y><d>2021-09-28</d><h>15:41</h><r>Ben Hammond</r>that was indeed my problem...</z><z id="t1632844090" t="Ben Hammond my next question is &gt; is it possible to cajole the Cognito User Pool App signing key into signing my customized JWT? "><y>#</y><d>2021-09-28</d><h>15:48</h><r>Ben Hammond</r>my next question is
&gt;  is it possible to cajole the Cognito User Pool App signing key into signing my customized JWT?
</z><z id="t1632844787" t="Ben Hammond I had a small hope that I could plug the &gt; Cognito App Client Secret into an RSAPrivateKeySpec as the private Exponent but it does not does appear to work..."><y>#</y><d>2021-09-28</d><h>15:59</h><r>Ben Hammond</r>I had a small hope that I could plug the
&gt;  Cognito App Client Secret
into an RSAPrivateKeySpec as the private Exponent

but it does not does appear to work...</z><z id="t1632844790" t="Ben Hammond Ho Hum"><y>#</y><d>2021-09-28</d><h>15:59</h><r>Ben Hammond</r>Ho Hum</z><z id="t1633093073" t="Ben Hammond I have concluded that it is not"><y>#</y><d>2021-10-01</d><h>12:57</h><r>Ben Hammond</r>I have concluded that it is not</z><z id="t1632844090" t="Ben Hammond my next question is &gt; is it possible to cajole the Cognito User Pool App signing key into signing my customized JWT? "><y>#</y><d>2021-09-28</d><h>15:48</h><w>Ben Hammond</w>my next question is
&gt;  is it possible to cajole the Cognito User Pool App signing key into signing my customized JWT?
</z><z id="t1632957210" t="jjttjj I&apos;m thinking about storing time series data in DynamoDB. This article: https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-time-series.html suggests using a table per day. If I understand correctly, it&apos;s due to the fact that in the example they give there is no other partition key besides time, so using multiple tables allows one to adjust the provision capacities separately for less frequently used days in the past, otherwise some of the provisioned capacity will kind of be &quot;wasted&quot; (in a sense). But what if I do have other partition keys that make sense. For example what if I&apos;m recording stock prices for 100 stocks with similar activity. Does this make sense now to use a single table, with the stock ticker as a partition key and time as the sort key?"><y>#</y><d>2021-09-29</d><h>23:13</h><w>jjttjj</w>I&apos;m thinking about storing time series data in DynamoDB. This article: <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-time-series.html" target="_blank">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/bp-time-series.html</a> suggests using a table per day. If I understand correctly, it&apos;s due to the fact that in the example they give there is no other partition key besides time, so using multiple tables allows one to adjust the provision capacities separately for less frequently used days in the past, otherwise some of the provisioned capacity will kind of be &quot;wasted&quot; (in a sense).

But what if I do have other partition keys that make sense. For example what if I&apos;m recording stock prices for 100 stocks with similar activity. Does this make sense now to use a single table, with the stock ticker as a partition key and time as the sort key?</z><z id="t1633015966" t="viesti is there actually different amount of data points for each ticker?"><y>#</y><d>2021-09-30</d><h>15:32</h><r>viesti</r>is there actually different amount of data points for each ticker?</z><z id="t1633026972" t="jjttjj Roughly. I suppose that could be dealt with by dividing up ones with a lot more points into multiple partitions (ie AAPL#A / AAPL#B . I guess I&apos;m mainly wondering if DDB will remain efficient for range queries for this type of table with ~100 partitions with a large number (millions) of points"><y>#</y><d>2021-09-30</d><h>18:36</h><r>jjttjj</r>Roughly. I suppose that could be dealt with by dividing up ones with a lot more points into multiple partitions (ie <code>AAPL#A</code> / <code>AAPL#B</code>.
I guess I&apos;m mainly wondering if DDB will remain efficient for range queries for this type of table with ~100 partitions with a large number (millions) of points</z><z id="t1633094598" t="viesti I&apos;d be really interested on what you find 🙂"><y>#</y><d>2021-10-01</d><h>13:23</h><r>viesti</r>I&apos;d be really interested on what you find <b>🙂</b></z><z id="t1633094629" t="viesti have been thinking this partition by time and by other dimensions (like IoT devices) elsewhere too"><y>#</y><d>2021-10-01</d><h>13:23</h><r>viesti</r>have been thinking this partition by time and by other dimensions (like IoT devices) elsewhere too</z><z id="t1633094693" t="viesti I&apos;d think that other databases too have some hard time, if you put all data into same slot"><y>#</y><d>2021-10-01</d><h>13:24</h><r>viesti</r>I&apos;d think that other databases too have some hard time, if you put all data into same slot</z><z id="t1633094715" t="viesti maybe there could be two types of &quot;indexes&quot;, one per time, one per ticker, would mean more tables"><y>#</y><d>2021-10-01</d><h>13:25</h><r>viesti</r>maybe there could be two types of &quot;indexes&quot;, one per time, one per ticker, would mean more tables</z><z id="t1633094975" t="jjttjj Yeah really all I want, in Clojure data structure terms, is a map of ticker symbol -&gt; sorted maps (by time) like {&quot;aapl&quot; {1633094934884 {:price 500 :qty 1}}} "><y>#</y><d>2021-10-01</d><h>13:29</h><r>jjttjj</r>Yeah really all I want, in Clojure data structure terms, is a map of ticker symbol -&gt; sorted maps (by time) like
<pre>{&quot;aapl&quot; {1633094934884 {:price 500 :qty 1}}}</pre>
</z><z id="t1633019906" t="kulminaator i suggest careful math if you really have traffic that is so stable that provisioned capacity pays off"><y>#</y><d>2021-09-30</d><h>16:38</h><w>kulminaator</w>i suggest careful math if you really have traffic that is so stable that provisioned capacity pays off</z><z id="t1633019919" t="kulminaator ondemand might be more suitable for extremely erratic traffic"><y>#</y><d>2021-09-30</d><h>16:38</h><w>kulminaator</w>ondemand might be more suitable for extremely erratic traffic</z><z id="t1633097608" t="dabrazhe Time to create a new CLJ library : ) https://aws.amazon.com/about-aws/whats-new/2021/09/aws-announces-cloud-control-api/"><y>#</y><d>2021-10-01</d><h>14:13</h><w>dabrazhe</w>Time to create a new CLJ library : )
<a href="https://aws.amazon.com/about-aws/whats-new/2021/09/aws-announces-cloud-control-api/" target="_blank">https://aws.amazon.com/about-aws/whats-new/2021/09/aws-announces-cloud-control-api/</a></z><z id="t1633097652" t="dabrazhe https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/"><y>#</y><d>2021-10-01</d><h>14:14</h><w>dabrazhe</w><a href="https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/" target="_blank">https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/</a></z><z id="t1633687078" t="jumar Any recommendations on config params / secrets management on AWS? Do you use Secrets Manager or Parameter Store or both? I&apos;d like to store the configuration in a single place. For example our beanstalk app has 50+ config properties which are right now only managed via Beanstalk config. Lots of them are secrets (like api keys) but a bunch of them is also something else. So far I&apos;m leaning towards Parameter Store but some of the features of Secrets Manager are compelling - like seamless secrets rotation."><y>#</y><d>2021-10-08</d><h>09:57</h><w>jumar</w>Any recommendations on config params / secrets management on AWS?
Do you use Secrets Manager or Parameter Store or both?

I&apos;d like to store the configuration in a single place.
For example our beanstalk app has 50+ config properties which are right now only managed via Beanstalk config.
Lots of them are secrets (like api keys) but a bunch of them is also something else.

So far I&apos;m leaning towards Parameter Store but some of the features of Secrets Manager are compelling - like seamless secrets rotation.</z><z id="t1633687134" t="jumar I also found this: https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-ps-secretsmanager.html Sounds like it could be a good idea to actually combine them."><y>#</y><d>2021-10-08</d><h>09:58</h><r>jumar</r>I also found this: <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-ps-secretsmanager.html" target="_blank">https://docs.aws.amazon.com/systems-manager/latest/userguide/integration-ps-secretsmanager.html</a>
Sounds like it could be a good idea to actually combine them.</z><z id="t1633698558" t="Max I’ve tried both and I prefer https://github.com/mozilla/sops with the KMS encryption option. Config should deploy on the same lifecycle as code, if you want to change config live then you really want feature flags instead. As for my experiences with Secrets Manager and Param Store, I found they did more harm than good. This culminated in an incident where I accidentally deleted some critical and irreplaceable configs. After that we switched to a method with version control and code reviews. "><y>#</y><d>2021-10-08</d><h>13:09</h><r>Max</r>I’ve tried both and I prefer <a href="https://github.com/mozilla/sops" target="_blank">https://github.com/mozilla/sops</a> with the KMS encryption option. Config should deploy on the same lifecycle as code, if you want to change config live then you really want feature flags instead. 

As for my experiences with Secrets Manager and Param Store, I found they did more harm than good. This culminated in an incident where I accidentally deleted some critical and irreplaceable configs. After that we switched to a method with version control and code reviews. </z><z id="t1633702910" t="lukasz ECS + SecretsManager is pretty great. Or alternatively - you can use a tool like Doppler or EnvKey and only use SecretsManager to store the individual service key used to obtain the secrets - reduces the blast radius"><y>#</y><d>2021-10-08</d><h>14:21</h><r>lukasz</r>ECS + SecretsManager is pretty great. Or alternatively - you can use a tool like Doppler or EnvKey and only use SecretsManager to store the individual service key used to obtain the secrets - reduces the blast radius</z><z id="t1633726691" t="viesti I&apos;ve been using SOPS too, for keeping secrets from integrations in a vault in version control. But if there are secrets that are internal to a system, like say a RDS master user + app user password, those could be generated inside the infrastructure, either by Terraform or by the Secrets Manager lifecycle (have to probably call rotation after initial creation). Vaults are nice for versioning though."><y>#</y><d>2021-10-08</d><h>20:58</h><r>viesti</r>I&apos;ve been using SOPS too, for keeping secrets from integrations in a vault in version control.

But if there are secrets that are internal to a system, like say a RDS master user + app user password, those could be generated inside the infrastructure, either by Terraform or by the Secrets Manager lifecycle (have to probably call rotation after initial creation). Vaults are nice for versioning though.</z><z id="t1633780543" t="AJ Jaro We just switched from Beanstalk config to the Parameter Store and it has worked fine so far. I, however, don&apos;t have experience using the secrets manager"><y>#</y><d>2021-10-09</d><h>11:55</h><r>AJ Jaro</r>We just switched from Beanstalk config to the Parameter Store and it has worked fine so far. I, however, don&apos;t have experience using the secrets manager</z><z id="t1634098244" t="jumar [:attrs {:href &quot;/_/_/users/UGMAVSMUM&quot;}] how did you do that? Do you have the configuration values version controlled and updated automatically in the parameter store?"><y>#</y><d>2021-10-13</d><h>04:10</h><r>jumar</r><a>@UGMAVSMUM</a> how did you do that? Do you have the configuration values version controlled and updated automatically in the parameter store?</z><z id="t1634119353" t="jumar [:attrs {:href &quot;/_/_/users/U01EB0V3H39&quot;}] and [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] thanks a lot for the valueable info. With SOPS + KMS, are you still able to reproduce/fetch configuration as it was at any point in time in the past? What happens when you rotate keys and the config files get re-encrypted? Also, how do you integrate SOPS with your apps? Do you just run sops and store its output somewhere in ~the file~ a config file read by the application or you use something more sophisticated?"><y>#</y><d>2021-10-13</d><h>10:02</h><r>jumar</r><a>@U01EB0V3H39</a> and <a>@U06QSF3BK</a> thanks a lot for the valueable info.

With SOPS + KMS, are you still able to reproduce/fetch configuration as it was at any point in time in the past?
What happens when you rotate keys and the config files get re-encrypted?

Also, how do you integrate SOPS with your apps? Do you just run <code>sops</code> and store its output somewhere in ~the file~ a config file read by the application or you use something more sophisticated?</z><z id="t1634119447" t="viesti apropo, just learned https://github.com/mozilla/sops#passing-secrets-to-other-processes"><y>#</y><d>2021-10-13</d><h>10:04</h><r>viesti</r>apropo, just learned <a href="https://github.com/mozilla/sops#passing-secrets-to-other-processes" target="_blank">https://github.com/mozilla/sops#passing-secrets-to-other-processes</a></z><z id="t1634119473" t="viesti Terraform also has a sops provider also: https://github.com/carlpett/terraform-provider-sops"><y>#</y><d>2021-10-13</d><h>10:04</h><r>viesti</r>Terraform also has a sops provider also: <a href="https://github.com/carlpett/terraform-provider-sops" target="_blank">https://github.com/carlpett/terraform-provider-sops</a></z><z id="t1634120275" t="jumar I&apos;m wondering if I could/should just invoke sops from the app process when it starts and read the configuration dynamically without storing the plaintext anywhere...."><y>#</y><d>2021-10-13</d><h>10:17</h><r>jumar</r>I&apos;m wondering if I could/should just invoke <code>sops</code> from the app process when it starts and read the configuration dynamically without storing the plaintext anywhere....</z><z id="t1634120394" t="jumar So in my case, I could package the encrypted file within the Beanstalk app archive and when the app starts it would use sops to get the plaintext version of the config. It would be great to integrate this somehow with a fine clojure config library like aero, omniconf, etc."><y>#</y><d>2021-10-13</d><h>10:19</h><r>jumar</r>So in my case, I could package the encrypted file within the Beanstalk app archive and when the app starts it would use <code>sops</code> to get the plaintext version of the config.
It would be great to integrate this somehow with a fine clojure config library like aero, omniconf, etc.</z><z id="t1634127377" t="AJ Jaro [:attrs {:href &quot;/_/_/users/U06BE1L6T&quot;}] They are not currently version controlled so that&apos;s something we still need to figure out, yep."><y>#</y><d>2021-10-13</d><h>12:16</h><r>AJ Jaro</r><a>@U06BE1L6T</a> They are not currently version controlled so that&apos;s something we still need to figure out, yep.</z><z id="t1634131423" t="Max My sops files are checked into git. I haven’t had to think much about key rotations, so that would be a flaw in the plan. Maybe there’s a way to archive old kms keys rather than delete them when rotating? We use both aero and sops: the app startup command is actually a sops command that decrypts the secrets and injects them into the app process as environment variables. Then aero brings in the env vars. This is generally good practice: your config will likely be more complicated than the values you need to inject into it, and injecting config via env vars is in line with 12 factor principles (in addition to just being a good idea in general)"><y>#</y><d>2021-10-13</d><h>13:23</h><r>Max</r>My sops files are checked into git. I haven’t had to think much about key rotations, so that would be a flaw in the plan. Maybe there’s a way to archive old kms keys rather than delete them when rotating?

We use both aero and sops: the app startup command is actually a sops command that decrypts the secrets and injects them into the app process as environment variables. Then aero brings in the env vars. This is generally good practice: your config will likely be more complicated than the values you need to inject into it, and injecting config via env vars is in line with 12 factor principles (in addition to just being a good idea in general)</z><z id="t1634131519" t="Max I would avoid integrating sops into my app code, that’s not really its concern. Using env vars means I have options for different deployment modes, eg local dev. No sops needed there!"><y>#</y><d>2021-10-13</d><h>13:25</h><r>Max</r>I would avoid integrating sops into my app code, that’s not really its concern. Using env vars means I have options for different deployment modes, eg local dev. No sops needed there!</z><z id="t1634150313" t="jumar Thanks, Max, this has been very helpful! Environment variables have their own weaknesses (like being exposed to sub-processes) but that&apos;s another discussion and I agree it&apos;s probably the most common approach (it&apos;s what we use right now anyway). And I actually see the value in using sops in local/dev environment too - we have some shared stuff in dev environment for which we share secrets (like GitHub OAuth app keys) and need to distribute those keys to devs."><y>#</y><d>2021-10-13</d><h>18:38</h><r>jumar</r>Thanks, Max, this has been very helpful!
Environment variables have their own weaknesses (like being exposed to sub-processes) but that&apos;s another discussion and I agree it&apos;s probably the most common approach (it&apos;s what we use right now anyway).

And I actually see the value in using sops in local/dev environment too - we have some shared stuff in dev environment for which we share secrets (like GitHub OAuth app keys) and need to distribute those keys to devs.</z><z id="t1634227598" t="jjttjj Am I doing something wrong here? (clojure.datafy/datafy ec2-client) ArityException Wrong number of args (1) passed to: cognitect.aws.endpoint/fetch cognitect.aws.client.api/client/fn--41910 (api.clj:95) clojure.core.protocols/fn--8213/G--8208--8218 (protocols.clj:182) "><y>#</y><d>2021-10-14</d><h>16:06</h><w>jjttjj</w>Am I doing something wrong here?
<pre>(clojure.datafy/datafy ec2-client)

  ArityException Wrong number of args (1) passed to: cognitect.aws.endpoint/fetch
  cognitect.aws.client.api/client/fn--41910 (api.clj:95)
  clojure.core.protocols/fn--8213/G--8208--8218 (protocols.clj:182)</pre>
</z><z id="t1634417908" t="kenny Does anyone happen to know the convention/schema name aws follows in their API json descriptor files? e.g., https://raw.githubusercontent.com/aws/aws-sdk-js/master/apis/ec2-2016-11-15.normal.json ."><y>#</y><d>2021-10-16</d><h>20:58</h><w>kenny</w>Does anyone happen to know the convention/schema name aws follows in their API json descriptor files? e.g., <a href="https://raw.githubusercontent.com/aws/aws-sdk-js/master/apis/ec2-2016-11-15.normal.json" target="_blank">https://raw.githubusercontent.com/aws/aws-sdk-js/master/apis/ec2-2016-11-15.normal.json</a>.</z><z id="t1634423429" t="kenny Found it 🙂 https://awslabs.github.io/smithy/index.html"><y>#</y><d>2021-10-16</d><h>22:30</h><w>kenny</w>Found it <b>🙂</b> <a href="https://awslabs.github.io/smithy/index.html" target="_blank">https://awslabs.github.io/smithy/index.html</a></z><z id="t1634459314" t="viesti oh neat, didn&apos;t know about smithy :)"><y>#</y><d>2021-10-17</d><h>08:28</h><w>viesti</w>oh neat, didn&apos;t know about smithy :)</z><z id="t1634481377" t="ghadi [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] whatcha cookin’?"><y>#</y><d>2021-10-17</d><h>14:36</h><w>ghadi</w><a>@kenny</a> whatcha cookin’?</z><z id="t1634561781" t="grant Does anyone have any experience with using aws-api with CodeCommit? I tried listing the repositories for an account with (aws/invoke codecommit {:op :ListRepositories}) and got {:repositories []} while aws codecommit list-repositories returns one repo, as expected. { &quot;repositories&quot;: [ { &quot;repositoryName&quot;: &quot;repo&quot;, &quot;repositoryId&quot;: ... } ] }"><y>#</y><d>2021-10-18</d><h>12:56</h><w>grant</w>Does anyone have any experience with using aws-api with CodeCommit? I tried listing the repositories for an account with <code>(aws/invoke codecommit {:op :ListRepositories})</code> and got <code>{:repositories []}</code> while <code>aws codecommit list-repositories</code> returns one repo, as expected.
<pre>{
   &quot;repositories&quot;: [
       {
           &quot;repositoryName&quot;: &quot;repo&quot;,
           &quot;repositoryId&quot;: ...
       }
   ]
}</pre></z><z id="t1634564394" t="jjttjj They&apos;re both using the same region right?"><y>#</y><d>2021-10-18</d><h>13:39</h><r>jjttjj</r>They&apos;re both using the same region right?</z><z id="t1634566417" t="grant Yes."><y>#</y><d>2021-10-18</d><h>14:13</h><r>grant</r>Yes.</z><z id="t1634570204" t="grant [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] Your suspicion was correct, explicitly setting the region for the client gives the expected results. I’ll have to figure out why the region wasn’t getting set the way I thought it was. Thank you for your help."><y>#</y><d>2021-10-18</d><h>15:16</h><r>grant</r><a>@U064UGEUQ</a> Your suspicion was correct, explicitly setting the region for the client gives the expected results. I’ll have to figure out why the region wasn’t getting set the way I thought it was. Thank you for your help.</z><z id="t1634570737" t="jjttjj No problem, I just guessed because I&apos;ve done this myself 10+ times 🙂"><y>#</y><d>2021-10-18</d><h>15:25</h><r>jjttjj</r>No problem, I just guessed because I&apos;ve done this myself 10+ times <b>🙂</b></z><z id="t1634694181" t="steveb8n Q: when using the Cognitect aws client lib with async calls, is it safe to call http://cognitect.aws.client.api.as/stop immediately? I’m concerned that the client might then suppress the value returned in the channel"><y>#</y><d>2021-10-20</d><h>01:43</h><w>steveb8n</w>Q: when using the Cognitect aws client lib with async calls, is it safe to call <a href="http://cognitect.aws.client.api.as/stop" target="_blank">http://cognitect.aws.client.api.as/stop</a> immediately? I’m concerned that the client might then suppress the value returned in the channel</z><z id="t1634931286" t="fogus (Clojure Team) New Cognitect Labs aws-api service APIs available! CHANGES - new endpoints version 1.1.12.93 - new AWS service API available (services version v814.2.1012.0): panorama README: https://github.com/cognitect-labs/aws-api/ API Docs: https://cognitect-labs.github.io/aws-api/ Changelog: https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md Upgrade Notes: https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md Latest Releases of api, endpoints, and all services: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2021-10-22</d><h>19:34</h><w>fogus (Clojure Team)</w>New Cognitect Labs aws-api service APIs available!

CHANGES
- new endpoints version 1.1.12.93
- new AWS service API available (services version v814.2.1012.0): panorama

README: <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a>

API Docs: <a href="https://cognitect-labs.github.io/aws-api/" target="_blank">https://cognitect-labs.github.io/aws-api/</a>
Changelog: <a href="https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md</a>
Upgrade Notes: <a href="https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md</a>
Latest Releases of api, endpoints, and all services: <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1635179604" t="slipset Any chance that https://github.com/cognitect-labs/aws-api/issues/183 could be looked at soon (or perhaps someone knows about a workaround?)"><y>#</y><d>2021-10-25</d><h>16:33</h><w>slipset</w>Any chance that <a href="https://github.com/cognitect-labs/aws-api/issues/183" target="_blank">https://github.com/cognitect-labs/aws-api/issues/183</a> could be looked at soon (or perhaps someone knows about a workaround?)</z><z id="t1635698791" t="borkdude Running #nbb on AWS Lambda: https://twitter.com/borkdude/status/1454836645279186946 Live editing of CLJS code in the console and execute right away."><y>#</y><d>2021-10-31</d><h>16:46</h><w>borkdude</w>Running #nbb on AWS Lambda: <a href="https://twitter.com/borkdude/status/1454836645279186946" target="_blank">https://twitter.com/borkdude/status/1454836645279186946</a>
Live editing of CLJS code in the console and execute right away.</z><z id="t1635894423" t="devn am i missing something, or are there some credential resolvers missing? i have an assume role scenario with source_profile and role_arn."><y>#</y><d>2021-11-02</d><h>23:07</h><w>devn</w>am i missing something, or are there some credential resolvers missing? i have an assume role scenario with source_profile and role_arn.</z><z id="t1635894585" t="devn it looks like the provider chain for the Java 2.X SDK has grown but the aws-api side is missing more than a few options at this point"><y>#</y><d>2021-11-02</d><h>23:09</h><w>devn</w>it looks like the provider chain for the Java 2.X SDK has grown but the aws-api side is missing more than a few options at this point</z><z id="t1635900031" t="kenny Hi [:attrs {:href &quot;/_/_/users/U06DQC6MA&quot;}] . You&apos;re correct — aws-api does not include a built-in provider for the assume role scenario. You can write one and add it in, if you&apos;d like. Here&apos;s a POC https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a"><y>#</y><d>2021-11-03</d><h>00:40</h><w>kenny</w>Hi <a>@devn</a>. You&apos;re correct — aws-api does not include a built-in provider for the assume role scenario. You can write one and add it in, if you&apos;d like. Here&apos;s a POC <a href="https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a" target="_blank">https://gist.github.com/kennyjwilli/c640f76845451cb145cedaee790d4f9a</a></z><z id="t1635900617" t="devn thanks kenny"><y>#</y><d>2021-11-03</d><h>00:50</h><w>devn</w>thanks kenny</z><z id="t1635945497" t="lukasz [:attrs {:href &quot;/_/_/users/U06DQC6MA&quot;}] if you need more inspiration - here are two developed by my team( for ECS and SSO profiles): https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5"><y>#</y><d>2021-11-03</d><h>13:18</h><w>lukasz</w><a>@devn</a> if you need more inspiration - here are two developed by my team( for ECS and SSO profiles): <a href="https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5" target="_blank">https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5</a></z><z id="t1635955444" t="devn beautiful. i wonder: is there any chance the aws-api default-credentials-provider will expand in the near future to include these kinds of things, or is the vibe like: “well, you can make your own provider, so no”"><y>#</y><d>2021-11-03</d><h>16:04</h><w>devn</w>beautiful. i wonder: is there any chance the aws-api default-credentials-provider will expand in the near future to include these kinds of things, or is the vibe like: “well, you can make your own provider, so no”</z><z id="t1635955517" t="lukasz I believe it&apos;s the 2nd option, my understanding is that aws-api is just for communication with the API itself, how you authorize it is up to you"><y>#</y><d>2021-11-03</d><h>16:05</h><w>lukasz</w>I believe it&apos;s the 2nd option, my understanding is that aws-api is just for communication with the API itself, how you authorize it is up to you</z><z id="t1635955562" t="lukasz it&apos;s not an equivalent of the official AWS SDK basically, which comes with a lot of extra functionality beyond API integration (for example S3 request pre-signing is a SDK feature, not covered by the API)"><y>#</y><d>2021-11-03</d><h>16:06</h><w>lukasz</w>it&apos;s not an equivalent of the official AWS SDK basically, which comes with a lot of extra functionality beyond API integration (for example S3 request pre-signing is a SDK feature, not covered by the API)</z><z id="t1635957903" t="devn if i were more ambitious id probably try to build out some of these providers and drop them in a lib because for instance, sts assume role is not a rare case"><y>#</y><d>2021-11-03</d><h>16:45</h><w>devn</w>if i were more ambitious id probably try to build out some of these providers and drop them in a lib because for instance, sts assume role is not a rare case</z><z id="t1635958035" t="lukasz yeah, we have an internal wrapper around aws-api which does exactly that (+ a couple of other things that we needed)"><y>#</y><d>2021-11-03</d><h>16:47</h><w>lukasz</w>yeah, we have an internal wrapper around aws-api which does exactly that (+ a couple of other things that we needed)</z><z id="t1635963090" t="devn what if… hear me out.. it were an external wrapper 😉"><y>#</y><d>2021-11-03</d><h>18:11</h><w>devn</w>what if… hear me out.. it were an external wrapper <b>😉</b></z><z id="t1635967290" t="lukasz heh, we can&apos;t disclose too much of our secret sauce 😉"><y>#</y><d>2021-11-03</d><h>19:21</h><r>lukasz</r>heh, we can&apos;t disclose too much of our secret sauce <b>😉</b></z><z id="t1635963592" t="Karol Wójcik I got the question. Why you don’t use official SDK V2 if you know that there are some limitations that you face in aws-api? Not a rant or anything like that, just curiosity."><y>#</y><d>2021-11-03</d><h>18:19</h><w>Karol Wójcik</w>I got the question. Why you don’t use official SDK V2 if you know that there are some limitations that you face in aws-api? Not a rant or anything like that, just curiosity.</z><z id="t1635964346" t="viesti depends on what you want to do, I think it&apos;s ok to use both if you can get best of both worlds (like presigned signature calculation or multipart parallel S3 downloads with TansferManager, but have a more data like access to other APIs)"><y>#</y><d>2021-11-03</d><h>18:32</h><w>viesti</w>depends on what you want to do, I think it&apos;s ok to use both if you can get best of both worlds (like presigned signature calculation or multipart parallel S3 downloads with TansferManager, but have a more data like access to other APIs)</z><z id="t1635967290" t="lukasz heh, we can&apos;t disclose too much of our secret sauce 😉"><y>#</y><d>2021-11-03</d><h>19:21</h><w>lukasz</w>heh, we can&apos;t disclose too much of our secret sauce <b>😉</b></z><z id="t1635967390" t="lukasz [:attrs {:href &quot;/_/_/users/UJ1339K2B&quot;}] that&apos;s a fair question, right now we use the official SDK only for s3 url presigning, but we keep extending our usage of S3 apis, and they way they&apos;re modeled in aws-api is way easier to handle than the interop - in this case it&apos;s pretty verbose when using the Java SDK"><y>#</y><d>2021-11-03</d><h>19:23</h><w>lukasz</w><a>@karol.wojcik</a> that&apos;s a fair question, right now we use the official SDK only for s3 url presigning, but we keep extending our usage of S3 apis, and they way they&apos;re modeled in aws-api is way easier to handle than the interop - in this case it&apos;s pretty verbose when using the Java SDK</z><z id="t1635967804" t="devn literally just did a presigned URL thing and ultimately decided to just skip using aws-api due to credentials providers and this"><y>#</y><d>2021-11-03</d><h>19:30</h><w>devn</w>literally just did a presigned URL thing and ultimately decided to just skip using aws-api due to credentials providers and this</z><z id="t1635970677" t="lukasz yeah, if it&apos;s only about that - I wouldn&apos;t bother with aws-api, but as I mentioned - we use S3 in a lot of different ways beyond get/put/delete"><y>#</y><d>2021-11-03</d><h>20:17</h><w>lukasz</w>yeah, if it&apos;s only about that - I wouldn&apos;t bother with aws-api, but as I mentioned - we use S3 in a lot of different ways beyond get/put/delete</z><z id="t1635971539" t="devn yeah that’s totally fair"><y>#</y><d>2021-11-03</d><h>20:32</h><w>devn</w>yeah that’s totally fair</z><z id="t1635971565" t="devn i would love to have been able to use it without feeling like i was forcing the issue to stay in clojure-y land"><y>#</y><d>2021-11-03</d><h>20:32</h><w>devn</w>i would love to have been able to use it without feeling like i was forcing the issue to stay in clojure-y land</z><z id="t1635971570" t="devn but that’s kind of how it wound up feeling"><y>#</y><d>2021-11-03</d><h>20:32</h><w>devn</w>but that’s kind of how it wound up feeling</z><z id="t1635971615" t="Karol Wójcik Got it. You have to keep aws-api for consistency and because it makes easier to reason about the code."><y>#</y><d>2021-11-03</d><h>20:33</h><w>Karol Wójcik</w>Got it. You have to keep aws-api for consistency and because it makes easier to reason about the code.</z><z id="t1635971784" t="lukasz Yes, if we need to use a specific API, we just use it, rather than figure out how to use PutObjectRequest class"><y>#</y><d>2021-11-03</d><h>20:36</h><w>lukasz</w>Yes, if we need to use a specific API, we just use it, rather than figure out how to use <code>PutObjectRequest</code> class</z><z id="t1635990356" t="rutledgepaulv I have a library where I&apos;ve been trying to define these additional credential providers. Additions welcome.. https://github.com/RutledgePaulV/aws-api-credential-providers"><y>#</y><d>2021-11-04</d><h>01:45</h><w>rutledgepaulv</w>I have a library where I&apos;ve been trying to define these additional credential providers. Additions welcome.. <a href="https://github.com/RutledgePaulV/aws-api-credential-providers" target="_blank">https://github.com/RutledgePaulV/aws-api-credential-providers</a></z><z id="t1636008764" t="Karol Wójcik Question: [:attrs {:href &quot;/_/_/users/U06DQC6MA&quot;}] [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] [:attrs {:href &quot;/_/_/users/U5RCSJ6BB&quot;}] : If more performant version of aws-api would be available that accepts PR and would be a drop in replacement for official aws-api, then would you like to contribute to it?"><y>#</y><d>2021-11-04</d><h>06:52</h><w>Karol Wójcik</w>Question: <a>@devn</a> <a>@lukaszkorecki</a> <a>@rutledgepaulv</a>:
If more performant version of aws-api would be available that accepts PR and would be a drop in replacement for official aws-api, then would you like to contribute to it?</z><z id="t1636029215" t="rutledgepaulv No thanks. I&apos;d prefer to keep the official aws-api as maintained by cognitect and just have libraries that fill in some of the commonly desired features that don&apos;t fit the minimal / unbundled artifact model of the aws-api releases."><y>#</y><d>2021-11-04</d><h>12:33</h><r>rutledgepaulv</r>No thanks. I&apos;d prefer to keep the official aws-api as maintained by cognitect and just have libraries that fill in some of the commonly desired features that don&apos;t fit the minimal / unbundled artifact model of the aws-api releases.</z><z id="t1636029247" t="rutledgepaulv Batteries don&apos;t need to come in the same box as the rest :)"><y>#</y><d>2021-11-04</d><h>12:34</h><r>rutledgepaulv</r>Batteries don&apos;t need to come in the same box as the rest :)</z><z id="t1636034040" t="lukasz A year too late for us too - when we need performance we drop in to the Java SDK, otherwise aws-api works as-is"><y>#</y><d>2021-11-04</d><h>13:54</h><r>lukasz</r>A year too late for us too - when we need performance we drop in to the Java SDK, otherwise aws-api works as-is</z><z id="t1636398945" t="fogus (Clojure Team) New Cognitect Labs aws-api service APIs available! CHANGES - new endpoints version 1.1.12.105 - new AWS service API available (services version v814.2.1023.0): chime-sdk-meetings README: https://github.com/cognitect-labs/aws-api/ API Docs: https://cognitect-labs.github.io/aws-api/ Changelog: https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md Upgrade Notes: https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md Latest Releases of api, endpoints, and all services: https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn"><y>#</y><d>2021-11-08</d><h>19:15</h><w>fogus (Clojure Team)</w>New Cognitect Labs aws-api service APIs available!

CHANGES
- new endpoints version 1.1.12.105
- new AWS service API available (services version v814.2.1023.0): chime-sdk-meetings

README: <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a>

API Docs: <a href="https://cognitect-labs.github.io/aws-api/" target="_blank">https://cognitect-labs.github.io/aws-api/</a>
Changelog: <a href="https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/CHANGES.md</a>
Upgrade Notes: <a href="https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/UPGRADE.md</a>
Latest Releases of api, endpoints, and all services: <a href="https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/latest-releases.edn</a></z><z id="t1637138293" t="slipset To be very pedantic, the changelog doesn’t seem to ve updated?"><y>#</y><d>2021-11-17</d><h>08:38</h><r>slipset</r>To be very pedantic, the changelog doesn’t seem to ve updated?</z><z id="t1637593476" t="popeye I am integrating aws redis cache in my clojure code, Can anyone help me in this? Any documentation and which library to be used ?"><y>#</y><d>2021-11-22</d><h>15:04</h><w>popeye</w>I am integrating aws redis cache in my clojure code, Can anyone help me in this? Any documentation and which library to be used ?</z><z id="t1637595889" t="danieroux https://github.com/ptaoussanis/carmine is where I would start"><y>#</y><d>2021-11-22</d><h>15:44</h><r>danieroux</r><a href="https://github.com/ptaoussanis/carmine" target="_blank">https://github.com/ptaoussanis/carmine</a> is where I would start</z><z id="t1637868590" t="danieroux Checking if this is a bug or my misunderstanding. I am writing to AWS Timestream. And this happens: {:__type &quot;com.amazonaws.timestream.v20181101#ThrottlingException&quot; :Message &quot;Request rate limit exceeded&quot; :cognitect.anomalies/category :cognitect.anomalies/incorrect}"><y>#</y><d>2021-11-25</d><h>19:29</h><w>danieroux</w>Checking if this is a bug or my misunderstanding. I am writing to AWS Timestream. And this happens:

<pre>{:__type &quot;com.amazonaws.timestream.v20181101#ThrottlingException&quot;
   :Message &quot;Request rate limit exceeded&quot;
   :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre></z><z id="t1637868636" t="danieroux I am surprised the category there is :cognitect.anomalies/incorrect - I expected a retriable category like :cognitect.anomalies/busy ?"><y>#</y><d>2021-11-25</d><h>19:30</h><w>danieroux</w>I am surprised the category there is <code>:cognitect.anomalies/incorrect</code> - I expected a retriable category like <code>:cognitect.anomalies/busy</code>?</z><z id="t1637952843" t="ghadi seems like a bug -- can you file an issue [:attrs {:href &quot;/_/_/users/U9E8C7QRJ&quot;}] ? I would love it if you can include the metadata attached to that map you received ^"><y>#</y><d>2021-11-26</d><h>18:54</h><w>ghadi</w>seems like a bug -- can you file an issue <a>@danie</a>?

I would love it if you can include the metadata attached to that map you received ^</z><z id="t1637959745" t="kenny IIRC, I&apos;ve discussed this with David. Often AWS returns non-compliant statuses, and indicates errors in other manners. I&apos;ll bet in this case, AWS returns a 400. I believe our previous conclusion was that this would be more configurable with the work in this execution-flow branch. As a workaround, we have our own wrapper invoke function that will “fix” anomaly categories by manually specifying how each service might return a busy status. "><y>#</y><d>2021-11-26</d><h>20:49</h><r>kenny</r>IIRC, I&apos;ve discussed this with David. Often AWS returns non-compliant statuses, and indicates errors in other manners. I&apos;ll bet in this case, AWS returns a 400. I believe our previous conclusion was that this would be more configurable with the work in this execution-flow branch. As a workaround, we have our own wrapper invoke function that will “fix” anomaly categories by manually specifying how each service might return a busy status. </z><z id="t1637962879" t="ghadi that may be the case, still want to examine the RAW"><y>#</y><d>2021-11-26</d><h>21:41</h><r>ghadi</r>that may be the case, still want to examine the RAW</z><z id="t1637971966" t="danieroux https://github.com/cognitect-labs/aws-api/issues/197 And there’s a :status 429 in there."><y>#</y><d>2021-11-27</d><h>00:12</h><r>danieroux</r><a href="https://github.com/cognitect-labs/aws-api/issues/197" target="_blank">https://github.com/cognitect-labs/aws-api/issues/197</a>

And there’s a <code>:status 429</code> in there.</z><z id="t1637974054" t="kenny We have a function like this to fix the categories. There&apos;s some other edge cases. (defn canonical-anomaly-category [api aws-api-anomaly] (or (when (anom/retryable? aws-api-anomaly) (anom/category aws-api-anomaly)) (when-let [retriable? (get api-&gt;retriable-fn api)] (when (retriable? aws-api-anomaly) ::anomalies/busy)) (when-let [anom-type (:__type aws-api-anomaly)] (case anom-type &quot;AccessDeniedException&quot; ::anomalies/forbidden nil)) (anom/http-status-&gt;category-lookup (get-in (meta aws-api-anomaly) [:http-response :status]))))"><y>#</y><d>2021-11-27</d><h>00:47</h><r>kenny</r>We have a function like this to fix the categories. There&apos;s some other edge cases. 
<pre>(defn canonical-anomaly-category
  [api aws-api-anomaly]
  (or
    (when (anom/retryable? aws-api-anomaly) (anom/category aws-api-anomaly))
    (when-let [retriable? (get api-&gt;retriable-fn api)]
      (when (retriable? aws-api-anomaly)
        ::anomalies/busy))
    (when-let [anom-type (:__type aws-api-anomaly)]
      (case anom-type
        &quot;AccessDeniedException&quot; ::anomalies/forbidden
        nil))
    (anom/http-status-&gt;category-lookup
      (get-in (meta aws-api-anomaly) [:http-response :status]))))</pre></z><z id="t1637952860" t="ghadi feel free to sanitize private details"><y>#</y><d>2021-11-26</d><h>18:54</h><w>ghadi</w>feel free to sanitize private details</z><z id="t1638017357" t="danieroux I found another edge case, do I log it separately or is there an issue to track all these? {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Abruptly closed by peer&quot;, :cognitect.http-client/throwable {:cause &quot;closing inbound before receiving peer&apos;s close_notify&quot;}} (I do have the :via for filing purposes)"><y>#</y><d>2021-11-27</d><h>12:49</h><w>danieroux</w>I found another edge case, do I log it separately or is there an issue to track all these?

<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.anomalies/message &quot;Abruptly closed by peer&quot;,
 :cognitect.http-client/throwable {:cause &quot;closing inbound before receiving peer&apos;s close_notify&quot;}}</pre>
(I do have the <code>:via</code> for filing purposes)</z><z id="t1638398697" t="hadils Hi! Does anyone have any experience integrating sente with AWS web sockets?"><y>#</y><d>2021-12-01</d><h>22:44</h><w>hadils</w>Hi!  Does anyone have any experience integrating sente with AWS web sockets?</z><z id="t1638895916" t="Benjamin Hi I&apos;m searching for aws status page. Login seems to be down atm"><y>#</y><d>2021-12-07</d><h>16:51</h><w>Benjamin</w>Hi I&apos;m searching for aws status page. Login seems to be down atm</z><z id="t1638895954" t="lukasz us-east-1 is down, https://status.aws.amazon.com/?ascsubtag=[]vg[p]22586373[t]w[d]D"><y>#</y><d>2021-12-07</d><h>16:52</h><w>lukasz</w>us-east-1 is down, <a href="https://status.aws.amazon.com/?ascsubtag=[]vg[p]22586373[t]w[d]D" target="_blank">https://status.aws.amazon.com/?ascsubtag=[]vg[p]22586373[t]w[d]D</a></z><z id="t1638896038" t="Benjamin don&apos;t get it where it talks about the login? Or is that aws management console?"><y>#</y><d>2021-12-07</d><h>16:53</h><r>Benjamin</r>don&apos;t get it where it talks about the login? Or is that aws management console?</z><z id="t1638896102" t="Benjamin ah I didn&apos;t check &quot;more&quot;"><y>#</y><d>2021-12-07</d><h>16:55</h><r>Benjamin</r>ah I didn&apos;t check &quot;more&quot;</z><z id="t1638895959" t="lukasz well, parts of it"><y>#</y><d>2021-12-07</d><h>16:52</h><w>lukasz</w>well, parts of it</z><z id="t1639151612" t="hadils I am having problems with ` :apigatewaymanagementapi I can’t seem to :GetConnection :PostToConnection or :DeleteConnection . I followed all the instructions in the Cognitect API manual and have a valid endpoint."><y>#</y><d>2021-12-10</d><h>15:53</h><w>hadils</w>I am having problems with `
<pre>:apigatewaymanagementapi</pre>
I can’t seem to <code>:GetConnection</code> <code>:PostToConnection</code> or <code>:DeleteConnection</code>. I followed all the instructions in the Cognitect API manual and have a valid endpoint.</z><z id="t1639151881" t="Alex Miller (Clojure team) what error are you seeing? might also be helpful to post the metadata on the response"><y>#</y><d>2021-12-10</d><h>15:58</h><w>Alex Miller (Clojure team)</w>what error are you seeing? might also be helpful to post the metadata on the response</z><z id="t1639151892" t="Alex Miller (Clojure team) (and be aware that there are some reports of AWS issues right now)"><y>#</y><d>2021-12-10</d><h>15:58</h><w>Alex Miller (Clojure team)</w>(and be aware that there are some reports of AWS issues right now)</z><z id="t1639152262" t="hadils How do you get the metadata?"><y>#</y><d>2021-12-10</d><h>16:04</h><w>hadils</w>How do you get the metadata?</z><z id="t1639152299" t="ghadi (meta response)"><y>#</y><d>2021-12-10</d><h>16:04</h><w>ghadi</w><code>(meta response)</code></z><z id="t1639152315" t="ghadi where response is the return value from aws/invoke"><y>#</y><d>2021-12-10</d><h>16:05</h><w>ghadi</w>where response is the return value from aws/invoke</z><z id="t1639152337" t="hadils Thanks! Let me take a look. "><y>#</y><d>2021-12-10</d><h>16:05</h><w>hadils</w>Thanks!  Let me take a look. </z><z id="t1639153093" t="hadils Here’s what i found: def r (aws/invoke apigwmgtapi {:op :GetConnection :request {:ConnectionId connection-id}})) =&gt; #&apos;com.yardwerkz.components.ring-middleware/r r =&gt; #:cognitect.anomalies{:category :cognitect.anomalies/not-found, :message &quot;: nodename nor servname provided, or not known&quot;} (meta r) =&gt; {:http-request {:request-method :get, :scheme :https, :server-port 443, :uri &quot;/@connections/KI_kqfLjvHcCGQQ%3D&quot;, :headers {&quot;x-amz-date&quot; &quot;20211210T161455Z&quot;, &quot;x-amz-target&quot; &quot;.GetConnection&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;, &quot;host&quot; &quot;&quot;, &quot;authorization&quot; &quot;AWS4-HMAC-SHA256 Credential=AKIAQ66JWWZ5V3F4MLM4/20211210/us-west-2/execute-api/aws4_request, SignedHeaders=content-type;host;x-amz-date;x-amz-target, Signature=0046c6adfc560b2d9102b0c388f69eb3642906c5f76813eb9e413f7c484d1a02&quot;}, :body nil, :server-name &quot;&quot;}, :http-response {:cognitect.anomalies/category :cognitect.anomalies/not-found, :cognitect.anomalies/message &quot;: nodename nor servname provided, or not known&quot;, :body nil}} (def r (aws/invoke apipost {:op :GetConnection :request {:ConnectionId connection-id}})) =&gt; #&apos;com.yardwerkz.components.ring-middleware/r r =&gt; {:message &quot;No method found matching route @connections/ for http method GET.&quot;, :cognitect.anomalies/category :cognitect.anomalies/not-found} (meta r) =&gt; {:http-request {:request-method :get, :scheme :https, :server-port 443, :uri &quot;/production/@connections/&quot;, :headers {&quot;x-amz-date&quot; &quot;20211210T161538Z&quot;, &quot;x-amz-target&quot; &quot;.GetConnection&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;, &quot;host&quot; &quot;&quot;, &quot;authorization&quot; &quot;AWS4-HMAC-SHA256 Credential=AKIAQ66JWWZ5V3F4MLM4/20211210/us-west-2/execute-api/aws4_request, SignedHeaders=content-type;host;x-amz-date;x-amz-target, Signature=469260a8d59c47e93fd9a288d4daa86765055a8477949d448d142cacb688d2ea&quot;}, :body nil, :server-name &quot;&quot;}, :http-response {:status 404, :headers {&quot;x-amz-apigw-id&quot; &quot;KJB-sE1avHcFcGQ=&quot;, &quot;connection&quot; &quot;keep-alive&quot;, &quot;x-amzn-requestid&quot; &quot;43c66301-3469-4fee-87b7-ffeab3d9bc6d&quot;, &quot;x-amzn-errortype&quot; &quot;NotFoundException&quot;, &quot;content-length&quot; &quot;79&quot;, &quot;date&quot; &quot;Fri, 10 Dec 2021 16:15:38 GMT&quot;, &quot;content-type&quot; &quot;application/json&quot;}, :body #object[java.io.BufferedInputStream 0x77e80748 &quot; where (def apigwmgtapi (aws/client {:api :apigatewaymanagementapi})) (def apipost (aws/client {:api :apigatewaymanagementapi :endpoint-override {:hostname host :path (str &quot;/&quot; stage &quot;/@connections/&quot;)}}))"><y>#</y><d>2021-12-10</d><h>16:18</h><w>hadils</w>Here’s what i found:
<pre>def r (aws/invoke apigwmgtapi {:op          :GetConnection
                                :request {:ConnectionId connection-id}}))
=&gt; #&apos;com.yardwerkz.components.ring-middleware/r
r
=&gt;
#:cognitect.anomalies{:category :cognitect.anomalies/not-found,
                      :message &quot;: nodename nor servname provided, or not known&quot;}
(meta r)
=&gt;
{:http-request {:request-method :get,
                :scheme :https,
                :server-port 443,
                :uri &quot;/@connections/KI_kqfLjvHcCGQQ%3D&quot;,
                :headers {&quot;x-amz-date&quot; &quot;20211210T161455Z&quot;,
                          &quot;x-amz-target&quot; &quot;.GetConnection&quot;,
                          &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;,
                          &quot;host&quot; &quot;&quot;,
                          &quot;authorization&quot; &quot;AWS4-HMAC-SHA256 Credential=AKIAQ66JWWZ5V3F4MLM4/20211210/us-west-2/execute-api/aws4_request, SignedHeaders=content-type;host;x-amz-date;x-amz-target, Signature=0046c6adfc560b2d9102b0c388f69eb3642906c5f76813eb9e413f7c484d1a02&quot;},
                :body nil,
                :server-name &quot;&quot;},
 :http-response {:cognitect.anomalies/category :cognitect.anomalies/not-found,
                 :cognitect.anomalies/message &quot;: nodename nor servname provided, or not known&quot;,
                 :body nil}}
(def r (aws/invoke apipost {:op          :GetConnection
                                :request {:ConnectionId connection-id}}))
=&gt; #&apos;com.yardwerkz.components.ring-middleware/r
r
=&gt;
{:message &quot;No method found matching route @connections/ for http method GET.&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/not-found}
(meta r)
=&gt;
{:http-request {:request-method :get,
                :scheme :https,
                :server-port 443,
                :uri &quot;/production/@connections/&quot;,
                :headers {&quot;x-amz-date&quot; &quot;20211210T161538Z&quot;,
                          &quot;x-amz-target&quot; &quot;.GetConnection&quot;,
                          &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;,
                          &quot;host&quot; &quot;&quot;,
                          &quot;authorization&quot; &quot;AWS4-HMAC-SHA256 Credential=AKIAQ66JWWZ5V3F4MLM4/20211210/us-west-2/execute-api/aws4_request, SignedHeaders=content-type;host;x-amz-date;x-amz-target, Signature=469260a8d59c47e93fd9a288d4daa86765055a8477949d448d142cacb688d2ea&quot;},
                :body nil,
                :server-name &quot;&quot;},
 :http-response {:status 404,
                 :headers {&quot;x-amz-apigw-id&quot; &quot;KJB-sE1avHcFcGQ=&quot;,
                           &quot;connection&quot; &quot;keep-alive&quot;,
                           &quot;x-amzn-requestid&quot; &quot;43c66301-3469-4fee-87b7-ffeab3d9bc6d&quot;,
                           &quot;x-amzn-errortype&quot; &quot;NotFoundException&quot;,
                           &quot;content-length&quot; &quot;79&quot;,
                           &quot;date&quot; &quot;Fri, 10 Dec 2021 16:15:38 GMT&quot;,
                           &quot;content-type&quot; &quot;application/json&quot;},
                 :body #object[java.io.BufferedInputStream 0x77e80748 &quot;</pre>
where
<pre>(def apigwmgtapi (aws/client {:api :apigatewaymanagementapi}))
(def apipost (aws/client
                 {:api               :apigatewaymanagementapi
                  :endpoint-override {:hostname host
                                      :path     (str &quot;/&quot; stage &quot;/@connections/&quot;)}}))</pre></z><z id="t1639165014" t="hadils I think the problem is that is a Private API."><y>#</y><d>2021-12-10</d><h>19:36</h><w>hadils</w>I think the problem is that <code></code> is a Private API.</z><z id="t1639171560" t="hadils No, it is being called from a VPC."><y>#</y><d>2021-12-10</d><h>21:26</h><w>hadils</w>No, it is being called from a VPC.</z><z id="t1639403828" t="Benjamin do you use the typescript cdk and is there any reasonable way to not have version incompatibility issues with that?"><y>#</y><d>2021-12-13</d><h>13:57</h><w>Benjamin</w>do you use the typescript cdk and is there any reasonable way to not have version incompatibility issues with that?</z><z id="t1639403900" t="Benjamin I&apos;m depending on &quot;aws-cdk-lib&quot; and &quot;aws-cdk/aws-iam&quot; error: Argument of type &apos;import(&quot;/home/benj/repos/typescript/version-file/node_modules/@aws-cdk/aws-iam/lib/policy-statement&quot;).PolicyStatement&apos; is not assignable to parameter of type &apos;import(&quot;/home/benj/repos/typescript/version-file/node_modules/aws-cdk-lib/aws-iam/lib/policy-statement&quot;).PolicyStatement&apos;. Types have separate declarations of a private property &apos;action&apos; "><y>#</y><d>2021-12-13</d><h>13:58</h><r>Benjamin</r>I&apos;m depending on &quot;aws-cdk-lib&quot; and &quot;aws-cdk/aws-iam&quot; error:
<pre>Argument of type &apos;import(&quot;/home/benj/repos/typescript/version-file/node_modules/@aws-cdk/aws-iam/lib/policy-statement&quot;).PolicyStatement&apos; is not assignable to parameter of type &apos;import(&quot;/home/benj/repos/typescript/version-file/node_modules/aws-cdk-lib/aws-iam/lib/policy-statement&quot;).PolicyStatement&apos;.
  Types have separate declarations of a private property &apos;action&apos;</pre>
</z><z id="t1639405477" t="Benjamin seems like mixing aws-cdk-lib and @aws-cdk/ was the issue"><y>#</y><d>2021-12-13</d><h>14:24</h><r>Benjamin</r>seems like mixing aws-cdk-lib and @aws-cdk/ was the issue</z><z id="t1639403962" t="hadils I think there’s a bug in (aws/client {:api :apigatewaymanagementapi :region &quot;us-west-2&quot; :credentials-provider (credentials/basic-credentials-provider {:access-key-id &quot;&lt;access-key&gt;&quot; :secret-access-key &quot;&lt;secret&gt;&quot;}) :endpoint-override {:hostname host :path (str &quot;/&quot; stage &quot;/@connections/&quot;)}}) I. don’t think it’s appending the connectionId to the end of the URL (aws/invoke apipost {:op :GetConnection :request {:ConnectionId connection-id}}) "><y>#</y><d>2021-12-13</d><h>13:59</h><w>hadils</w>I think there’s a bug in
<pre>(aws/client
               {:api                  :apigatewaymanagementapi
                :region               &quot;us-west-2&quot;
                :credentials-provider (credentials/basic-credentials-provider
                                        {:access-key-id     &quot;&lt;access-key&gt;&quot;
                                         :secret-access-key &quot;&lt;secret&gt;&quot;})
                :endpoint-override    {:hostname host
                                       :path     (str &quot;/&quot; stage &quot;/@connections/&quot;)}})</pre>
I. don’t think it’s appending the connectionId to the end of the URL
<pre>(aws/invoke apipost {:op      :GetConnection
                                                 :request {:ConnectionId connection-id}})</pre>
</z><z id="t1639521741" t="jjttjj I have to expose a couple of http endpoints on a server for a Clojure app running jetty that I&apos;d like to avoid directly exposing to incoming traffic. Is there a way to use something on AWS (ApiGateway?) to avoid having to set up an nginx proxy to the jetty server? I can&apos;t seem to verify if it&apos;s possible to route public requests from ApiGateway to server in a private VPC, and if it is possible, if that&apos;s overkill and I&apos;m better off just setting up and maintaining nginx"><y>#</y><d>2021-12-14</d><h>22:42</h><w>jjttjj</w>I have to expose a couple of http endpoints on a server for a Clojure app running jetty that I&apos;d like to avoid directly exposing to incoming traffic. Is there a way to use something on AWS (ApiGateway?) to avoid having to set up an nginx proxy to the jetty server? I can&apos;t seem to verify if it&apos;s possible to route public requests from ApiGateway to server in a private VPC, and if it is possible, if that&apos;s overkill and I&apos;m better off just setting up and maintaining nginx</z><z id="t1639522024" t="hiredman depending on the functionality you want it might be simpler to standup cloudfront in front"><y>#</y><d>2021-12-14</d><h>22:47</h><w>hiredman</w>depending on the functionality you want it might be simpler to standup cloudfront in front</z><z id="t1639522510" t="jjttjj Thanks! I&apos;ll look at that closer"><y>#</y><d>2021-12-14</d><h>22:55</h><w>jjttjj</w>Thanks! I&apos;ll look at that closer</z><z id="t1639543625" t="jumar Not sure what you mean by private vpc. You will need to put your instance into a public subnet (associated with a internet gateway). "><y>#</y><d>2021-12-15</d><h>04:47</h><w>jumar</w>Not sure what you mean by private vpc. You will need to put your instance into a public subnet (associated with a internet gateway).
</z><z id="t1639575680" t="viesti Usually you&apos;d have in a VPC a public subnet, that has a 0.0.0.0/0 route to internet gateway and put a NAT gateway in that subnet and then have private subnet, that has a 0.0.0.0/0 route to the NAT gateway, so that hosts in the private subnet are not directly accessible from the internet and don&apos;t have public IP addresses. Then you&apos;d put a load balancer (ALB) into the public subnet and have a listener in the load balancer direct traffic to say EC2 instance or ECS service etc. Not sure if Cloudfront can reach a private subnet directly, but there might be something in API Gateway for such https://aws.amazon.com/about-aws/whats-new/2017/11/amazon-api-gateway-supports-endpoint-integrations-with-private-vpcs/"><y>#</y><d>2021-12-15</d><h>13:41</h><w>viesti</w>Usually you&apos;d have in a VPC a public subnet, that has a 0.0.0.0/0 route to internet gateway and put a NAT gateway in that subnet and then have private subnet, that has a 0.0.0.0/0 route to the NAT gateway, so that hosts in the private subnet are not directly accessible from the internet and don&apos;t have public IP addresses.

Then you&apos;d put a load balancer (ALB) into the public subnet and have a listener in the load balancer direct traffic to say EC2 instance or ECS service etc. Not sure if Cloudfront can reach a private subnet directly, but there might be something in API Gateway for such <a href="https://aws.amazon.com/about-aws/whats-new/2017/11/amazon-api-gateway-supports-endpoint-integrations-with-private-vpcs/" target="_blank">https://aws.amazon.com/about-aws/whats-new/2017/11/amazon-api-gateway-supports-endpoint-integrations-with-private-vpcs/</a></z><z id="t1639644360" t="Benjamin do you know the simplest way to trigger a cloudformation stack rollback?"><y>#</y><d>2021-12-16</d><h>08:46</h><w>Benjamin</w>do you know the simplest way to trigger a cloudformation stack rollback?</z><z id="t1639644403" t="Benjamin I have an idea to add a custom resource function that returns FAILED"><y>#</y><d>2021-12-16</d><h>08:46</h><r>Benjamin</r>I have an idea to add a custom resource function that returns FAILED</z><z id="t1639970788" t="Drew Verlee In dynamodB where do you draw the line between indexing and run time filtering? It seems like you could push everything into a key-value relationships if you index aggressively enough. http://2.in DynamoDB a GSI is hydrated off the main table, does that mean when you do an insert into the main table you have to add the attribute to that insert that is used as the PK of the GSI? e.g use case. I have users in a class So my primary table pk is class#uuid:user#uuid and then use the query &quot;starts_with&quot; argument if i wanted all users for a class? But what If i wanted to quickly pull all users that were in a specific set of class how would i do that as efficiently as possible? I&apos;m thinking the pk on the GSI would be class-1#&lt;uuid&gt;:class-2#&lt;uuid&gt;:user#uuid and then when i inserted records it would look like insert into class table attributes: • pk -&gt; class#123 • users -&gt; [...] • class-1#123:class-2#abc:user#a -&gt; user info • class-1#123:class-3#abc:user#a -&gt; user-info ... One record for each secondary class they took so they all get updated. Then i can do the same thing i did with my primary table when i wanted all users that took those 2 classes and use &quot;starts_with&quot; e.g starts_with(class-1#123:class-3#abc) I&apos;ll assume i always ask for classes in a sorted order to so they are always in the same order. Does that seem right?"><y>#</y><d>2021-12-20</d><h>03:26</h><w>Drew Verlee</w>In dynamodB where do you draw the line between indexing and run time filtering? It seems like you could push everything into a key-value relationships if you index aggressively enough.

<a href="http://2.in" target="_blank">http://2.in</a> DynamoDB a GSI is hydrated off the main table, does that mean when you do an insert into the main table you have to add the attribute to that insert that is used as the PK of the GSI?

e.g use case. I have users in a class

So my primary table pk is class#uuid:user#uuid and then use the query &quot;starts_with&quot; argument if i wanted all users for a class?

But what If i wanted to quickly pull all users that were in a specific set of class how would i do that as efficiently as possible? I&apos;m thinking the pk on the GSI would be class-1#&lt;uuid&gt;:class-2#&lt;uuid&gt;:user#uuid and then when i inserted records it would look like

insert into class table
attributes:
• pk -&gt; class#123
• users -&gt; [...]
• class-1#123:class-2#abc:user#a -&gt; user info
• class-1#123:class-3#abc:user#a -&gt; user-info
...

One record for each secondary class they took so they all get updated. Then i can do the same thing i did with my primary table when i wanted all users that took those 2 classes and use &quot;starts_with&quot; e.g  starts_with(class-1#123:class-3#abc)

I&apos;ll assume i always ask for classes in a sorted order to so they are always in the same order.

Does that seem right?</z><z id="t1640887948" t="orestis Once again I&apos;m looking into using Docker containers in production, in order to simplify and future-proof our Elastic Beanstalk situation. It seems like there&apos;s some effort into making both EB and ECS understand docker-compose.yaml files but I&apos;m not sure if it&apos;s going to be really supported or if it&apos;s half-baked."><y>#</y><d>2022-12-30</d><h>18:12</h><w>orestis</w>Once again I&apos;m looking into using Docker containers in production, in order to simplify and future-proof our Elastic Beanstalk situation. It seems like there&apos;s some effort into making both EB and ECS understand <code>docker-compose.yaml</code> files but I&apos;m not sure if it&apos;s going to be really supported or if it&apos;s half-baked.</z><z id="t1640888003" t="orestis So far we haven&apos;t used any cloud provisioning tool (e.g. Cloudformation/Terraform/Pulumi), because spinning up an EB environment is simple enough to do via the console and we don&apos;t really do it often. But I&apos;d like to rectify this going forward."><y>#</y><d>2022-12-30</d><h>18:13</h><w>orestis</w>So far we haven&apos;t used any cloud provisioning tool (e.g. Cloudformation/Terraform/Pulumi), because spinning up an EB environment is simple enough to do via the console and we don&apos;t really do it often. But I&apos;d like to rectify this going forward.</z><z id="t1640888073" t="orestis So my question is, would you use something like e.g. Terraform to both provision e.g. an ECS cluster with services and task definitions and keep using to do day-to-day deployments? Or would you provision the cluster once then use the AWS API to update Task definitions and do deploys?"><y>#</y><d>2022-12-30</d><h>18:14</h><w>orestis</w>So my question is, would you use something like e.g. Terraform to both provision e.g. an ECS cluster with services and task definitions and keep using to do day-to-day deployments? Or would you provision the cluster once then use the AWS API to update Task definitions and do deploys?</z><z id="t1640888362" t="lukasz We use Fargate+ECS+ECR quite a lot, all configuration, services, tasks and related AWS resources (ALB, RDS and more) are managed exclusively via Terraform. The only things we do outside of TF are: • triggering deployments (we use mutable tags, so :release points at the latest stable version of the container image built in CI) • scaling up and down manually - this alters the number of instances of given service/task that runs right now, applying TF would roll it back to the &quot;standard&quot; configuration "><y>#</y><d>2022-12-30</d><h>18:19</h><r>lukasz</r>We use Fargate+ECS+ECR quite a lot, all configuration, services, tasks and related AWS resources (ALB, RDS and more) are managed exclusively via Terraform. The only things we do outside of TF are:
• triggering deployments (we use mutable tags, so <code>:release</code> points at the latest stable version of the container image built in CI)
• scaling up and down manually - this alters the number of instances of given service/task that runs  right now, applying TF would roll it back to the &quot;standard&quot; configuration </z><z id="t1640888385" t="lukasz These two tasks are done via a couple of scripts that interact with AWS API via AWS CLI"><y>#</y><d>2022-12-30</d><h>18:19</h><r>lukasz</r>These two tasks are done via a couple of scripts that interact with AWS API via AWS CLI</z><z id="t1640888728" t="orestis Thanks! So e.g. in your CI you would build new container images, push them to ECR via docker-cli, then perhaps also change the task description or just trigger a deploy to pick up the current :release image via the aws-cli."><y>#</y><d>2022-12-30</d><h>18:25</h><r>orestis</r>Thanks! So e.g. in your CI you would build new container images, push them to ECR via docker-cli, then perhaps also change the task description or just trigger a deploy to pick up the current <code>:release</code> image via the aws-cli.</z><z id="t1640888951" t="lukasz Pretty much: CI runs tests, build the image and pushes it to ECR. Then anybody can trigger a deploy either via GH Actions UI or a script. All other changes to tasks, services etc have to be done in Terraform via normal pull request flow. We have built a couple of scripts that help with things like &apos;is the latest version of given service built and deployed to ECS&apos; but on a day to day basis, everyone just runs 2 make tasks. Next year we will most likely move to triggering deployments via CI too. One less command to run"><y>#</y><d>2022-12-30</d><h>18:29</h><r>lukasz</r>Pretty much: CI runs tests, build the image and pushes it to ECR. Then anybody can trigger a deploy either via GH Actions UI or a script. All other changes to tasks, services etc have to be done in Terraform via normal pull request flow.
We have built a couple of scripts that help with things like &apos;is the latest version of given service built and deployed to ECS&apos; but  on a day to day basis, everyone just runs 2 make tasks. Next year we will most likely move to triggering deployments via CI too. One less command to run</z><z id="t1640889110" t="orestis How complicated was the initial terraform configuration? Would you do it again if you had to start from scratch?"><y>#</y><d>2022-12-30</d><h>18:31</h><r>orestis</r>How complicated was the initial terraform configuration? Would you do it again if you had to start from scratch?</z><z id="t1640889127" t="orestis Also, do you keep TF state in e.g. S3 or elsewhere?"><y>#</y><d>2022-12-30</d><h>18:32</h><r>orestis</r>Also, do you keep TF state in e.g. S3 or elsewhere?</z><z id="t1640889366" t="lukasz We use TF Cloud for state storage, but moving to S3 wouldn&apos;t be an issue (just bootstrapping requires a couple of manual steps). The thing is I evolved our infra over last 5 years so there was always some prior setup I could lean on, e.g. we used to deploy our services in Docker via Ansible on to bunch of GCP hosts, but all images were already hosted in ECR, so bootstrapping the ECS cluster was that much easier. But yes, I built a library of internal modules that I would use again if I were to start from scratch and had to use AWS"><y>#</y><d>2022-12-30</d><h>18:36</h><r>lukasz</r>We use TF Cloud for state storage, but moving to S3 wouldn&apos;t be an issue (just bootstrapping requires a couple of manual steps).

The thing is I evolved our infra over last 5 years so there was always some prior setup I could lean on, e.g. we used to deploy our services in Docker via Ansible on to bunch of GCP hosts, but all images were already hosted in ECR, so bootstrapping the ECS cluster was that much easier.

But yes, I built a library of internal modules that I would use again if I were to start from scratch and had to use AWS</z><z id="t1640889476" t="lukasz It looks daunting in the beginning, but in my experience the most complicated bits were around observability and getting all of the metrics and logs working outside of AWS (we use Grafana Cloud, not CloudWatch). Other than that once I got how things are related to each other it was pretty straight forward"><y>#</y><d>2022-12-30</d><h>18:37</h><r>lukasz</r>It looks daunting in the beginning, but in my experience the most complicated bits were around observability and getting all of the metrics and logs working outside of AWS (we use Grafana Cloud, not CloudWatch). Other than that once I got how things are related to each other it was pretty straight forward</z><z id="t1640889503" t="lukasz One thing, I wouldn&apos;t use any of the public modules for any of this - every infra is a unique snowflake, and it&apos;s better to have 100% control over it"><y>#</y><d>2022-12-30</d><h>18:38</h><r>lukasz</r>One thing, I wouldn&apos;t use any of the public modules for any of this - every infra is a unique snowflake, and it&apos;s better to have 100% control over it</z><z id="t1640889646" t="orestis Can you explain the bit about public modules? You still need to bottom out to something TF-provided to build e.g. an ECS cluster or an RDS database, right?"><y>#</y><d>2022-12-30</d><h>18:40</h><r>orestis</r>Can you explain the bit about public modules? You still need to bottom out to something TF-provided to build e.g. an ECS cluster or an RDS database, right?</z><z id="t1640889723" t="lukasz Oh, I mean stuff like this: https://registry.terraform.io/modules/trussworks/ecs-service/aws/latest Of course you will use the AWS provider and built-in AWS resources"><y>#</y><d>2022-12-30</d><h>18:42</h><r>lukasz</r>Oh, I mean stuff like this: <a href="https://registry.terraform.io/modules/trussworks/ecs-service/aws/latest" target="_blank">https://registry.terraform.io/modules/trussworks/ecs-service/aws/latest</a> Of course you will use the AWS provider and built-in AWS resources</z><z id="t1640889775" t="orestis Ah yes, I would avoid that out of instinct too. The point is to do exactly what you want, otherwise I&apos;d stick with Elastic Beanstalk and the AWS opinions, at least I have a support contract with them 🙂"><y>#</y><d>2022-12-30</d><h>18:42</h><r>orestis</r>Ah yes, I would avoid that out of instinct too. The point is to do exactly what you want, otherwise I&apos;d stick with Elastic Beanstalk and the AWS opinions, at least I have a support contract with them <b>🙂</b></z><z id="t1640889838" t="orestis Thanks for this info. We&apos;re not even in Docker yet, but finally I can see some upside in bringing that complexity onto us."><y>#</y><d>2022-12-30</d><h>18:43</h><r>orestis</r>Thanks for this info. We&apos;re not even in Docker yet, but finally I can see some upside in bringing that complexity onto us.</z><z id="t1640889881" t="lukasz Yeah, in the end AWS doesn&apos;t care how you manage your infra - but given that I went through all of the SOC2 stuff, investing in IaC pays off, because it helps a lot with maintaining compliance and having things organized. I&apos;d use Terraform for smaller projects too, e.g. orchestrating Digital Ocean resources and their app platform. It&apos;s just better than relying on manually clicking in consoles and such."><y>#</y><d>2022-12-30</d><h>18:44</h><r>lukasz</r>Yeah, in the end AWS doesn&apos;t care how you manage your infra - but given that I went through all of the SOC2 stuff, investing in IaC pays off, because it helps a lot with maintaining compliance and having things organized.

I&apos;d use Terraform for smaller projects too, e.g. orchestrating Digital Ocean resources and their app platform. It&apos;s just better than relying on manually clicking in consoles and such.</z><z id="t1640889906" t="lukasz In that case, I&apos;d Dockerize first (I think EB supports it), then think about ECS (either with Fargate or EC2)"><y>#</y><d>2022-12-30</d><h>18:45</h><r>lukasz</r>In that case, I&apos;d Dockerize first (I think EB supports it), then think about ECS (either with Fargate or EC2)</z><z id="t1640890233" t="valtteri Beanstalk supports Docker via ECS with some limitations which may or may not be showstoppers for you. • unit of scaling is your application • application can consist of max 10 containers"><y>#</y><d>2022-12-30</d><h>18:50</h><r>valtteri</r>Beanstalk supports Docker via ECS with some limitations which may or may not be showstoppers for you.
• unit of scaling is your application
• application can consist of max 10 containers</z><z id="t1640890330" t="valtteri I wouldn’t recommend it as the first choice. 🙂"><y>#</y><d>2022-12-30</d><h>18:52</h><r>valtteri</r>I wouldn’t recommend it as the first choice. <b>🙂</b></z><z id="t1640890335" t="valtteri (been there, done that)"><y>#</y><d>2022-12-30</d><h>18:52</h><r>valtteri</r>(been there, done that)</z><z id="t1640890357" t="lukasz ah there you go, I thought it works somewhat similar to App Engine, where Docker is just a different runtime"><y>#</y><d>2022-12-30</d><h>18:52</h><r>lukasz</r>ah there you go, I thought it works somewhat similar to App Engine, where Docker is just a different runtime</z><z id="t1640890397" t="lukasz so yeah, investing in Fargate+ECS is imho easiest, potentially this might be worth looking into: https://aws.amazon.com/blogs/containers/introducing-aws-copilot/"><y>#</y><d>2022-12-30</d><h>18:53</h><r>lukasz</r>so yeah, investing in Fargate+ECS is imho easiest, potentially this might be worth looking into: <a href="https://aws.amazon.com/blogs/containers/introducing-aws-copilot/" target="_blank">https://aws.amazon.com/blogs/containers/introducing-aws-copilot/</a></z><z id="t1640890427" t="valtteri I’ve been 👀 :ing this https://aws.amazon.com/apprunner/"><y>#</y><d>2022-12-30</d><h>18:53</h><r>valtteri</r>I’ve been <b>👀</b> :ing this <a href="https://aws.amazon.com/apprunner/" target="_blank">https://aws.amazon.com/apprunner/</a></z><z id="t1640890451" t="lukasz oh, that&apos;s the Cloud Run equivalent, right?"><y>#</y><d>2022-12-30</d><h>18:54</h><r>lukasz</r>oh, that&apos;s the Cloud Run equivalent, right?</z><z id="t1640890524" t="valtteri I’m not too familiar with the GCP offering so hard to say. But it looks like it’s an easy way to setup a load-balanced docker app"><y>#</y><d>2022-12-30</d><h>18:55</h><r>valtteri</r>I’m not too familiar with the GCP offering so hard to say. But it looks like it’s an easy way to setup a load-balanced docker app</z><z id="t1640890566" t="lukasz Yeah, looks pretty much the same - give it an image and ✨ magic ✨ you have a running service. For simple workloads it&apos;s def the way to go"><y>#</y><d>2022-12-30</d><h>18:56</h><r>lukasz</r>Yeah, looks pretty much the same - give it an image and <b>✨</b> magic <b>✨</b> you have a running service. For simple workloads it&apos;s def the way to go</z><z id="t1640890664" t="orestis I&apos;ve seen references about EB using ECS under the hood but I can&apos;t find any docs about it. But yes, Dockerize is the first step. App runner unfortunately isn&apos;t available in my region (eu-central-1) and I suspect soc2 and our B2B platform would be better suited for something a bit more explicit. "><y>#</y><d>2022-12-30</d><h>18:57</h><r>orestis</r>I&apos;ve seen references about EB using ECS under the hood but I can&apos;t find any docs about it. But yes, Dockerize is the first step.  App runner unfortunately isn&apos;t available in my region (eu-central-1) and I suspect soc2 and our B2B platform would be better suited for something a bit more explicit. </z><z id="t1640890712" t="valtteri We’re currently using Fargate heavily. I’m quite happy with it. We setup the infra with CloudFormation and deploy by pushing images to ECS and reloading the containers with aws sdk"><y>#</y><d>2022-12-30</d><h>18:58</h><r>valtteri</r>We’re currently using Fargate heavily. I’m quite happy with it. We setup the infra with CloudFormation and deploy by pushing images to ECS and reloading the containers with aws sdk</z><z id="t1640890733" t="orestis Our app is a very basic one, but we are slowly rewriting in Clojure so having everything in containers that communicate with each other make some sense. So far we&apos;ve been hard coding URLs for this communication. "><y>#</y><d>2022-12-30</d><h>18:58</h><r>orestis</r>Our app is a very basic one, but we are slowly rewriting in Clojure so having everything in containers that communicate with each other make some sense. So far we&apos;ve been hard coding URLs for this communication. </z><z id="t1640890766" t="orestis Fargate seems tempting too, even at a bit higher prices than plain EC2. "><y>#</y><d>2022-12-30</d><h>18:59</h><r>orestis</r>Fargate seems tempting too, even at a bit higher prices than plain EC2. </z><z id="t1640890793" t="valtteri [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] &gt; The other generic platform, Multicontainer Docker, uses the Amazon Elastic Container Service (Amazon ECS) to coordinate a deployment of multiple Docker containers to an Amazon ECS cluster in an Elastic Beanstalk environment. From https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html"><y>#</y><d>2022-12-30</d><h>18:59</h><r>valtteri</r><a>@U7PBP4UVA</a>
&gt; The other generic platform, Multicontainer Docker, uses the Amazon Elastic Container Service (Amazon ECS) to coordinate a deployment of multiple Docker containers to an Amazon ECS cluster in an Elastic Beanstalk environment.
From <a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html" target="_blank">https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html</a></z><z id="t1640890856" t="lukasz Yeah, it requires cost calculation (ops time vs fargate cost). Plus, there are some thing you won&apos;t be able to do with Fargate, but the low operational overhead is imho worth it"><y>#</y><d>2022-12-30</d><h>19:00</h><r>lukasz</r>Yeah, it requires cost calculation (ops time vs fargate cost). Plus, there are some thing you won&apos;t be able to do with Fargate, but the low operational overhead is imho worth it</z><z id="t1640890902" t="orestis [:attrs {:href &quot;/_/_/users/U6N4HSMFW&quot;}] ah thanks, that&apos;s using an older version of Amazon linux so I never clicked on that, thinking it was deprecated."><y>#</y><d>2022-12-30</d><h>19:01</h><r>orestis</r><a>@U6N4HSMFW</a> ah thanks, that&apos;s using an older version of Amazon linux so I never clicked on that, thinking it was deprecated.</z><z id="t1640890952" t="orestis Thanks to both of you for the guidance. I guess Terraform in Action goes to my reading list 🙂"><y>#</y><d>2022-12-30</d><h>19:02</h><r>orestis</r>Thanks to both of you for the guidance. I guess Terraform in Action goes to my reading list <b>🙂</b></z><z id="t1640890954" t="valtteri Ahh true. It seems like they have a newer platform version nowadays! Wonder what it does under the hood.."><y>#</y><d>2022-12-30</d><h>19:02</h><r>valtteri</r>Ahh true. It seems like they have a newer platform version nowadays! Wonder what it does under the hood..</z><z id="t1640890982" t="orestis Seems like all glue and bash scripts, judging from the logs. They do seem to run plain docker compose though."><y>#</y><d>2022-12-30</d><h>19:03</h><r>orestis</r>Seems like all glue and bash scripts, judging from the logs. They do seem to run plain docker compose though.</z><z id="t1640891019" t="valtteri Oh my."><y>#</y><d>2022-12-30</d><h>19:03</h><r>valtteri</r>Oh my.</z><z id="t1640891087" t="valtteri I’m not sure what to think about that. I mean using docker-compose on EC2. Well why not. At least parity with dev would be 1:1 minus load balancing"><y>#</y><d>2022-12-30</d><h>19:04</h><r>valtteri</r>I’m not sure what to think about that. I mean using <code>docker-compose</code>  on EC2. Well why not. At least parity with dev would be 1:1 minus load balancing</z><z id="t1640891096" t="orestis Oh, a final Clojure question: are you able to have a nRepl session to a Fargate container? Sometimes we need to do that for support, not for our main deployments but for a bastion server that runs some back-office support tasks. It&apos;s a unique snowflake with an Elastic IP, not sure if it&apos;s worth bringing over to ECS or even containerise."><y>#</y><d>2022-12-30</d><h>19:04</h><r>orestis</r>Oh, a final Clojure question: are you able to have a nRepl session to a Fargate container? Sometimes we need to do that for support, not for our main deployments but for a bastion server that runs some back-office support tasks. It&apos;s a unique snowflake with an Elastic IP, not sure if it&apos;s worth bringing over to ECS or even containerise.</z><z id="t1640891196" t="lukasz Yes. It comes with one limitation though: in order to expose a port your service has to be a part of a load balancer target group. I have not been able to have nrepl working for non-HTTP services (I need to revise that). So in your task config, you&apos;d expose the nREPL port, and once it&apos;s live you can get the IP of the fargate instance and connect to it from within the VPC"><y>#</y><d>2022-12-30</d><h>19:06</h><r>lukasz</r>Yes. It comes with one limitation though: in order to expose a port your service has to be a part of a load balancer target group. I have not been able to have nrepl working for non-HTTP services (I need to revise that). So in your task config, you&apos;d expose the nREPL port, and once it&apos;s live you can get the IP of the fargate instance and connect to it from within the VPC</z><z id="t1640891308" t="valtteri I think you could achieve the same for non-http services with a Network Load Balancer"><y>#</y><d>2022-12-30</d><h>19:08</h><r>valtteri</r>I think you could achieve the same for non-http services with a Network Load Balancer</z><z id="t1640891326" t="valtteri Might require some 🍻 and 🚬 to setup though"><y>#</y><d>2022-12-30</d><h>19:08</h><r>valtteri</r>Might require some <b>🍻</b> and <b>🚬</b> to setup though</z><z id="t1640891327" t="orestis (We use ssm to start a port forwarding session, it&apos;s nice because it generates a CloudTrail log)."><y>#</y><d>2022-12-30</d><h>19:08</h><r>orestis</r>(We use ssm to start a port forwarding session, it&apos;s nice because it generates a CloudTrail log).</z><z id="t1640891354" t="orestis We have an http service, even a load balancer to setup SSL via ACM so thankfully that&apos;s a moot point for us."><y>#</y><d>2022-12-30</d><h>19:09</h><r>orestis</r>We have an http service, even a load balancer to setup SSL via ACM so thankfully that&apos;s a moot point for us.</z><z id="t1640891387" t="lukasz We have a G-Suite-&gt;AWS SSO -&gt; IAM roles setup so we get that too :-) You have to go through SSM to access the one and only ec2 host that we have to connect to the REPL"><y>#</y><d>2022-12-30</d><h>19:09</h><r>lukasz</r>We have a G-Suite-&gt;AWS SSO -&gt; IAM roles setup so we get that too :-) You have to go through SSM to access the one and only ec2 host that we have to connect to the REPL</z><z id="t1641241203" t="viesti ECS also has this Exec functionality to run commands and even a shell inside a container, even on Fargate: https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/"><y>#</y><d>2022-01-03</d><h>20:20</h><r>viesti</r>ECS also has this Exec functionality to run commands and even a shell inside a container, even on Fargate: <a href="https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/" target="_blank">https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/</a></z><z id="t1641241364" t="viesti so you can say, have socket repl listening locally inside the container and bundle say netcat in the docker image and connect to the socket repl"><y>#</y><d>2022-01-03</d><h>20:22</h><r>viesti</r>so you can say, have socket repl listening locally inside the container and bundle say netcat in the docker image and connect to the socket repl</z><z id="t1641241393" t="viesti I haven&apos;t yet tested if this could be used for forwarding also"><y>#</y><d>2022-01-03</d><h>20:23</h><r>viesti</r>I haven&apos;t yet tested if this could be used for forwarding also</z><z id="t1641241717" t="viesti Here&apos;s a small Terraform setup to play with ECS Exec: https://github.com/viesti/ecs-exec"><y>#</y><d>2022-01-03</d><h>20:28</h><r>viesti</r>Here&apos;s a small Terraform setup to play with ECS Exec: <a href="https://github.com/viesti/ecs-exec" target="_blank">https://github.com/viesti/ecs-exec</a></z><z id="t1641313125" t="lukasz Nice! I&apos;m testing this today in our env, if all goes well we will go EC2-less in a couple of weeks"><y>#</y><d>2022-01-04</d><h>16:18</h><r>lukasz</r>Nice! I&apos;m testing this today in our env, if all goes well we will go EC2-less in a couple of weeks</z><z id="t1641364563" t="viesti The tech behind ECS Exec is interesting (from introduction post https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/ ) &gt; The long story short is that we bind-mount the necessary SSM agent binaries into the container(s). Looking at the description, if the whole ssm agent is mounted into the container, that makes me think that could the port forwarding capability of the agent be also used.... https://github.com/aws/containers-roadmap/issues/1050"><y>#</y><d>2022-01-05</d><h>06:36</h><r>viesti</r>The tech behind ECS Exec is interesting (from introduction post <a href="https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/" target="_blank">https://aws.amazon.com/blogs/containers/new-using-amazon-ecs-exec-access-your-containers-fargate-ec2/</a>)
&gt; The long story short is that we bind-mount the necessary SSM agent binaries into the container(s).
Looking at the description, if the whole ssm agent is mounted into the container, that makes me think that could the port forwarding capability of the agent be also used.... <a href="https://github.com/aws/containers-roadmap/issues/1050" target="_blank">https://github.com/aws/containers-roadmap/issues/1050</a></z><z id="t1640888146" t="orestis Currently we do the latter, with aws cli or even via Clojure you can easily deploy something to Elastic beanstalk, I don&apos;t really see the point to use a cloud provisioning tool to do that. Of course both EB and ECS have their own provisioning for deploys behind the scenes, perhaps that&apos;s the point?"><y>#</y><d>2022-12-30</d><h>18:15</h><w>orestis</w>Currently we do the latter, with aws cli or even via Clojure you can easily deploy something to Elastic beanstalk, I don&apos;t really see the point to use a cloud provisioning tool to do that. Of course both EB and ECS have their own provisioning for deploys behind the scenes, perhaps that&apos;s the point?</z><z id="t1640888739" t="Max I&apos;d recommend against using terraform to trigger deployments. Usually you end up defining a line between “provisioned infra” and “ephemeral infra”, where the former is controlled by IaC and the former is controlled by CI/CD pipelines. Terraform (and I think other IaC tools?) don&apos;t tend to handle that line terribly well, I usually just use ignore_changes on things I expect the pipelines to change. https://github.com/hashicorp/terraform-provider-aws/issues/632 . "><y>#</y><d>2022-12-30</d><h>18:25</h><w>Max</w>I&apos;d recommend against using terraform to trigger deployments. Usually you end up defining a line between “provisioned infra” and “ephemeral infra”, where the former is controlled by IaC and the former is controlled by CI/CD pipelines. Terraform (and I think other IaC tools?) don&apos;t tend to handle that line terribly well, I usually just use <code>ignore_changes</code> on things I expect the pipelines to change. <a href="https://github.com/hashicorp/terraform-provider-aws/issues/632" target="_blank">https://github.com/hashicorp/terraform-provider-aws/issues/632</a>. </z><z id="t1640889016" t="orestis I guess the issue being, if you do this, then a terraform apply would probably roll back your deployed code to a previous state. So I guess terraform apply isn&apos;t something that&apos;s done automatically and without thought, it&apos;s something you do once when setting up and then manually on big infra changes."><y>#</y><d>2022-12-30</d><h>18:30</h><r>orestis</r>I guess the issue being, if you do this, then a terraform apply would probably roll back your deployed code to a previous state. So I guess <code>terraform apply</code> isn&apos;t something that&apos;s done automatically and without thought, it&apos;s something you do once when setting up and then manually on big infra changes.</z><z id="t1640889556" t="Max It shouldn&apos;t, that&apos;s why you use ignore_changes on the infra managed by the pipelines. The whole value prop of terraform is that it&apos;s not just fire-and-forget, as you make further infra changes over time it will keep your infra in line with the code. That said, you should always review your terraform plans before applying them, just like you would with code changes. You never want to do it automatically. "><y>#</y><d>2022-12-30</d><h>18:39</h><r>Max</r>It shouldn&apos;t, that&apos;s why you use <code>ignore_changes</code> on the infra managed by the pipelines. The whole value prop of terraform is that it&apos;s not just fire-and-forget, as you make further infra changes over time it will keep your infra in line with the code.

That said, you should always review your terraform plans before applying them, just like you would with code changes. You never want to do it automatically. </z><z id="t1640889681" t="Max In general, if you&apos;re doing everything right and you run terraform plan on any random day on your main branch, terraform shouldn&apos;t find any changes. Getting that to happen just sometimes requires playing with lifecycle stuff a little"><y>#</y><d>2022-12-30</d><h>18:41</h><r>Max</r>In general, if you&apos;re doing everything right and you run <code>terraform plan</code> on any random day on your main branch, terraform shouldn&apos;t find any changes. Getting that to happen just sometimes requires playing with lifecycle stuff a little</z><z id="t1640889726" t="orestis Right, so there&apos;s a way to make TF ignore changes in some &quot;leaf&quot; nodes that change with every deploy. Good to know. I&apos;m still evaluating on whether I should dedicate a couple of days on reading the available books 🙂"><y>#</y><d>2022-12-30</d><h>18:42</h><r>orestis</r>Right, so there&apos;s a way to make TF ignore changes in some &quot;leaf&quot; nodes that change with every deploy. Good to know. I&apos;m still evaluating on whether I should dedicate a couple of days on reading the available books <b>🙂</b></z><z id="t1640891491" t="kardan Last time we ended up using a “latest” tag and then triggering deployment with “aws ecs update-service --cluster &lt;cluster&gt; --service &lt;service&gt; --force-new-deployment”"><y>#</y><d>2022-12-30</d><h>19:11</h><r>kardan</r>Last time we ended up using a “latest” tag and then triggering deployment with “aws ecs update-service --cluster &lt;cluster&gt; --service &lt;service&gt; --force-new-deployment”</z><z id="t1640891523" t="kardan That way terraform apply will always apply whatever is tagged as latest"><y>#</y><d>2022-12-30</d><h>19:12</h><r>kardan</r>That way terraform apply will always apply whatever is tagged as latest</z><z id="t1640891553" t="kardan Maybe there is downsides to this, but that is we’re we ended up 🙂"><y>#</y><d>2022-12-30</d><h>19:12</h><r>kardan</r>Maybe there is downsides to this, but that is we’re we ended up <b>🙂</b></z><z id="t1640897860" t="Max That&apos;s also a viable strategy. The only downside is that you don&apos;t really get blue/green deployments that way because you can&apos;t roll back. If you&apos;re not worried about having to trigger a deploy to roll back though it works great "><y>#</y><d>2022-12-30</d><h>20:57</h><r>Max</r>That&apos;s also a viable strategy. The only downside is that you don&apos;t really get blue/green deployments that way because you can&apos;t roll back. If you&apos;re not worried about having to trigger a deploy to roll back though it works great </z><z id="t1640933289" t="kardan True"><y>#</y><d>2022-12-31</d><h>06:48</h><r>kardan</r>True</z><z id="t1641240355" t="viesti Hmm, I&apos;ve done Terraform + ECS setups a couple of times and haven&apos;t run into problems. The task_definition attribute takes also a ARN of the task definition so you can just simply do task_definition = aws_ecs_task_definition.backend.arn to refer to the newly created task definition"><y>#</y><d>2022-01-03</d><h>20:05</h><r>viesti</r>Hmm, I&apos;ve done Terraform + ECS setups a couple of times and haven&apos;t run into problems. The <code>task_definition</code> attribute takes also a ARN of the task definition so you can just simply do
<pre>task_definition = aws_ecs_task_definition.backend.arn</pre>
to refer to the newly created  task definition</z><z id="t1641240476" t="viesti perhaps not the most simples example, but here&apos;s one with infra split into couple of modules: https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/ecs/main.tf#L33"><y>#</y><d>2022-01-03</d><h>20:07</h><r>viesti</r>perhaps not the most simples example, but here&apos;s one with infra split into couple of modules: <a href="https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/ecs/main.tf#L33" target="_blank">https://github.com/metosin/cloud-busting/blob/main/aws/ecs-demo/modules/ecs/main.tf#L33</a></z><z id="t1641240639" t="viesti I&apos;d suggest to do a split where you have &quot;infra&quot; root module and a &quot;app&quot; root module, the &quot;app&quot; module containing only aws_ecs_service and aws_ecs_task_definition resources and pick attributes needed by the app module via remote state from the infra module. The infra module then itself can comprise of stateless utility modules (like network, database etc)"><y>#</y><d>2022-01-03</d><h>20:10</h><r>viesti</r>I&apos;d suggest to do a split where you have &quot;infra&quot; root module and a &quot;app&quot; root module, the &quot;app&quot; module containing only aws_ecs_service and aws_ecs_task_definition resources and pick attributes needed by the app module via remote state from the infra module. The infra module then itself can comprise of stateless utility modules (like network, database etc)</z><z id="t1641919818" t="Daniel Craig What&apos;s the best way to make a signed request to an AWS endpoint? I want to make a request to the Neptune Streams endpoint of my neptune db. https://docs.aws.amazon.com/neptune/latest/userguide/streams-using.html#streams-using-api-call"><y>#</y><d>2022-01-11</d><h>16:50</h><w>Daniel Craig</w>What&apos;s the best way to make a signed request to an AWS endpoint?  I want to make a request to the Neptune Streams endpoint of my neptune db.  <a href="https://docs.aws.amazon.com/neptune/latest/userguide/streams-using.html#streams-using-api-call" target="_blank">https://docs.aws.amazon.com/neptune/latest/userguide/streams-using.html#streams-using-api-call</a></z><z id="t1641932727" t="viesti in the past I&apos;ve used this clj-http middleware https://github.com/sharetribe/aws-sig4"><y>#</y><d>2022-01-11</d><h>20:25</h><r>viesti</r>in the past I&apos;ve used this clj-http middleware <a href="https://github.com/sharetribe/aws-sig4" target="_blank">https://github.com/sharetribe/aws-sig4</a></z><z id="t1641946155" t="Daniel Craig Thank you!!"><y>#</y><d>2022-01-12</d><h>00:09</h><r>Daniel Craig</r>Thank you!!</z><z id="t1642086074" t="souenzzo This is the main channel for discuss aws-api issues? I found this line of code https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/http/cognitect.clj#L9 I can&apos;t add a reference to cognitect http-client , but in version 1.0.110 , that is the one that I&apos;m using, the usage of this trust-all parameter looks like this: (SslContextFactory. false) #_(boolean trust-all) So this trust-all is not used in my version of http-client . Can we remove this unused parameter? As far I know, it is not desired to use options like this in prod scenarios. [reference to SslContextFactory] https://github.com/eclipse/jetty.project/blob/jetty-9.4.x/jetty-util/src/main/java/org/eclipse/jetty/util/ssl/SslContextFactory.java#L208"><y>#</y><d>2022-01-13</d><h>15:01</h><w>souenzzo</w>This is the main channel for discuss <code>aws-api</code> issues?
I found this line of code
<a href="https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/http/cognitect.clj#L9" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/http/cognitect.clj#L9</a>
I can&apos;t add a reference to cognitect <code>http-client</code>, but in version <code>1.0.110</code>, that is the one that I&apos;m using, the usage of this trust-all parameter looks like this:
<code>(SslContextFactory. false) #_(boolean trust-all)</code>
So this <code>trust-all</code> is not used in my version of <code>http-client</code>.
Can we remove this unused parameter?
As far I know, it is not desired to use options like this in prod scenarios.

[reference to SslContextFactory]
<a href="https://github.com/eclipse/jetty.project/blob/jetty-9.4.x/jetty-util/src/main/java/org/eclipse/jetty/util/ssl/SslContextFactory.java#L208" target="_blank">https://github.com/eclipse/jetty.project/blob/jetty-9.4.x/jetty-util/src/main/java/org/eclipse/jetty/util/ssl/SslContextFactory.java#L208</a></z><z id="t1642087092" t="Alex Miller (Clojure team) can you file an issue at https://github.com/cognitect-labs/aws-api/issues ?"><y>#</y><d>2022-01-13</d><h>15:18</h><w>Alex Miller (Clojure team)</w>can you file an issue at <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> ?</z><z id="t1642179852" t="Daniel Jomphe Hi! Has anyone seen any team use a https://docs.amplify.aws/cli/usage/containers/ ? Do the high-level features of Amplify, like coordination of backend and frontend CI-CD deployments including https://docs.aws.amazon.com/amplify/latest/userguide/pr-previews.html work when we use Serverless containers for the backend? I&apos;ve already got CI-CD Datomic Cloud Ion deployments where the frontend is backed by Amplify and the backend by Datomic Cloud Ion, and I&apos;m thinking of adding ephemeral backend deployments with Datomic dev-local to preview our pull requests. This would yield an asymmetric workflow, but still..."><y>#</y><d>2022-01-14</d><h>17:04</h><w>Daniel Jomphe</w>Hi! Has anyone seen any team use a <a href="https://docs.amplify.aws/cli/usage/containers/" target="_blank">https://docs.amplify.aws/cli/usage/containers/</a>?

Do the high-level features of Amplify, like coordination of backend and frontend CI-CD deployments including <a href="https://docs.aws.amazon.com/amplify/latest/userguide/pr-previews.html" target="_blank">https://docs.aws.amazon.com/amplify/latest/userguide/pr-previews.html</a> work when we use Serverless containers for the backend?

I&apos;ve already got CI-CD Datomic Cloud Ion deployments where the frontend is backed by Amplify and the backend by Datomic Cloud Ion, and I&apos;m thinking of adding ephemeral backend deployments with Datomic dev-local to preview our pull requests.

This would yield an asymmetric workflow, but still...</z><z id="t1642205281" t="Ben Hammond Hi. I am trying to use apigatewaymanagementapi to post data to a websocket When I run this from the repl (-&gt; (aws/client {:api :apigatewaymanagementapi :region :eu-west-2 :endpoint-override {:hostname &quot;ws.foo.bar&quot; :stage &quot;dev&quot; :protocol :https} }) (aws/invoke {:op :PostToConnection :request {:ConnectionId &quot;L9YKjdwtrPEAbMA=&quot; :Data &quot;helloworld&quot;}})) =&gt; {:message &quot;Invalid connectionId: L9YKjdwtrPEAbMA=L9YKjdwtrPEAbMA=&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} and I see from the meta that somehow the ConnectionId `L9YKjdwtrPEAbMA=` gets turned in to `L9YKjdwtrPEAbMA=L9YKjdwtrPEAbMA=` (meta *1) =&gt; {:http-request {:request-method :post, :scheme :https, :server-port 443, :uri &quot;/@connections/L9YKjdwtrPEAbMA%3DL9YKjdwtrPEAbMA=&quot;, :headers {&quot;x-amz-date&quot; &quot;20220114T233422Z&quot;, &quot;x-amz-target&quot; &quot;.PostToConnection&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;, &quot;host&quot; &quot;ws.foo.bar&quot;, &quot;authorization&quot; &quot;***&quot; :body #object[java.nio.HeapByteBuffer 0x2e98a804 &quot;java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]&quot;], :server-name &quot;&quot;}, :http-response {:status 400, :headers {&quot;x-amz-apigw-id&quot; &quot;***=&quot;, &quot;connection&quot; &quot;keep-alive&quot;, &quot;x-amzn-requestid&quot; &quot;4af13b6f-5010-4f5e-b8cf-59eff9f856ba&quot;, &quot;x-amzn-errortype&quot; &quot;BadRequestException&quot;, &quot;content-length&quot; &quot;68&quot;, &quot;date&quot; &quot;Fri, 14 Jan 2022 23:34:22 GMT&quot;, &quot;content-type&quot; &quot;application/json&quot;}, :body #object[java.io.BufferedInputStream 0x12c52eb4 &quot; I am running com.cognitect.aws/apigatewaymanagementapi {:mvn/version &quot;770.2.568.0&quot;} am I somehow misusing the api? is this a bug? How can I work around it?"><y>#</y><d>2022-01-15</d><h>00:08</h><w>Ben Hammond</w>Hi. I am trying to use <code>apigatewaymanagementapi</code> to post data to a websocket

When I run this from the repl
<pre>(-&gt; (aws/client {:api :apigatewaymanagementapi
                 :region :eu-west-2
                 :endpoint-override {:hostname &quot;ws.foo.bar&quot;
                                     :stage &quot;dev&quot;
                                     :protocol :https}
                 })
    (aws/invoke {:op :PostToConnection
                 :request {:ConnectionId &quot;L9YKjdwtrPEAbMA=&quot;
                           :Data &quot;helloworld&quot;}}))
=&gt;
{:message &quot;Invalid connectionId: L9YKjdwtrPEAbMA=L9YKjdwtrPEAbMA=&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre>
and I see from the meta that somehow the ConnectionId `L9YKjdwtrPEAbMA=` gets turned in to `L9YKjdwtrPEAbMA=L9YKjdwtrPEAbMA=`
<pre>(meta *1)
=&gt;
{:http-request {:request-method :post,
                :scheme :https,
                :server-port 443,
                :uri &quot;/@connections/L9YKjdwtrPEAbMA%3DL9YKjdwtrPEAbMA=&quot;,
                :headers {&quot;x-amz-date&quot; &quot;20220114T233422Z&quot;,
                          &quot;x-amz-target&quot; &quot;.PostToConnection&quot;,
                          &quot;content-type&quot; &quot;application/x-amz-json-1.1&quot;,
                          &quot;host&quot; &quot;ws.foo.bar&quot;,
                          &quot;authorization&quot; &quot;***&quot;
                          :body #object[java.nio.HeapByteBuffer
                              0x2e98a804
                              &quot;java.nio.HeapByteBuffer[pos=0 lim=10 cap=10]&quot;],
                :server-name &quot;&quot;},
 :http-response {:status 400,
                 :headers {&quot;x-amz-apigw-id&quot; &quot;***=&quot;,
                           &quot;connection&quot; &quot;keep-alive&quot;,
                           &quot;x-amzn-requestid&quot; &quot;4af13b6f-5010-4f5e-b8cf-59eff9f856ba&quot;,
                           &quot;x-amzn-errortype&quot; &quot;BadRequestException&quot;,
                           &quot;content-length&quot; &quot;68&quot;,
                           &quot;date&quot; &quot;Fri, 14 Jan 2022 23:34:22 GMT&quot;,
                           &quot;content-type&quot; &quot;application/json&quot;},
                 :body #object[java.io.BufferedInputStream
                               0x12c52eb4
                               &quot;</pre>
I am running
<pre>com.cognitect.aws/apigatewaymanagementapi {:mvn/version &quot;770.2.568.0&quot;}</pre>
am I somehow misusing the api?
is this a bug? How can I work around it?</z><z id="t1642206293" t="jarrodctaylor I am successfully sending messages with the following:"><y>#</y><d>2022-01-15</d><h>00:24</h><r>jarrodctaylor</r>I am successfully sending messages with the following:</z><z id="t1642206297" t="jarrodctaylor"><y>#</y><d>2022-01-15</d><h>00:24</h><r>jarrodctaylor</r></z><z id="t1642220475" t="hadils Thanks [:attrs {:href &quot;/_/_/users/U0508JRJC&quot;}] I reported this problem over a month ago. I appreciate this solution. "><y>#</y><d>2022-01-15</d><h>04:21</h><r>hadils</r>Thanks <a>@U0508JRJC</a>   I reported this problem over a month ago. I appreciate this solution. </z><z id="t1642241829" t="Ben Hammond thanks very much [:attrs {:href &quot;/_/_/users/U0508JRJC&quot;}]"><y>#</y><d>2022-01-15</d><h>10:17</h><r>Ben Hammond</r>thanks very much <a>@U0508JRJC</a></z><z id="t1642257154" t="jarrodctaylor You are both welcome. It took longer that I would have liked to workout all the parts of a functioning websocket implementation through API Gateway. I have a blog post in the works that walks through the full process of implementing an authenticated websocket. My hope is it will save others significant time when endeavoring to do the same."><y>#</y><d>2022-01-15</d><h>14:32</h><r>jarrodctaylor</r>You are both welcome. It took longer that I would have liked to workout all the parts of a functioning websocket implementation through API Gateway. I have a blog post in the works that walks through the full process of implementing an authenticated websocket. My hope is it will save others significant time when endeavoring to do the same.</z><z id="t1642266324" t="Ben Hammond do you know of a way to pass an x-api-key HttpHeader in the initial js/WebSocket() call? Do you authenticate AFTER the WebSocket is hooked up?"><y>#</y><d>2022-01-15</d><h>17:05</h><r>Ben Hammond</r>do you know of a way to pass an <code>x-api-key</code> HttpHeader in the initial <code>js/WebSocket()</code> call?
Do you authenticate AFTER the WebSocket is hooked up?</z><z id="t1642392162" t="hadils I am trying to adapt sente to an api gw solution. "><y>#</y><d>2022-01-17</d><h>04:02</h><r>hadils</r>I am trying to adapt sente to an api gw solution. </z><z id="t1642405223" t="danieroux This seems useful too: https://github.com/cognitect-labs/aws-api#posttoconnection"><y>#</y><d>2022-01-17</d><h>07:40</h><r>danieroux</r>This seems useful too: <a href="https://github.com/cognitect-labs/aws-api#posttoconnection" target="_blank">https://github.com/cognitect-labs/aws-api#posttoconnection</a></z><z id="t1642242583" t="borkdude"><y>#</y><d>2022-01-15</d><h>10:29</h><w>borkdude</w></z><z id="t1642271757" t="kenny Does DefaultAwsRegionProviderChain also work for AWS Fargate tasks? The https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/regions/providers/DefaultAwsRegionProviderChain.html seems to imply no. &gt; AWS Region provider that looks for the region in this order: &gt; 1. Check the &apos;aws.region&apos; system property for the region. &gt; 2. Check the &apos;AWS_REGION&apos; environment variable for the region. &gt; 3. Check the {user.home}/.aws/credentials and {user.home}/.aws/config files for the region. &gt; 4. If running in EC2, check the EC2 metadata service for the region. "><y>#</y><d>2022-01-15</d><h>18:35</h><w>kenny</w>Does DefaultAwsRegionProviderChain also work for AWS Fargate tasks? The <a href="https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/regions/providers/DefaultAwsRegionProviderChain.html" target="_blank">https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/regions/providers/DefaultAwsRegionProviderChain.html</a> seems to imply no.
&gt; AWS Region provider that looks for the region in this order:
&gt; 1. Check the &apos;aws.region&apos; system property for the region.
&gt; 2. Check the &apos;AWS_REGION&apos; environment variable for the region.
&gt; 3. Check the {user.home}/.aws/credentials and {user.home}/.aws/config files for the region.
&gt; 4. If running in EC2, check the EC2 metadata service for the region.
</z><z id="t1642271992" t="kenny It potentially, happens, to work as per https://stackoverflow.com/questions/51886219/how-can-we-determine-the-current-region-with-aws-fargate/51886404 settings the AWS_REGION env var."><y>#</y><d>2022-01-15</d><h>18:39</h><r>kenny</r>It potentially, happens, to work as per <a href="https://stackoverflow.com/questions/51886219/how-can-we-determine-the-current-region-with-aws-fargate/51886404" target="_blank">https://stackoverflow.com/questions/51886219/how-can-we-determine-the-current-region-with-aws-fargate/51886404</a> settings the AWS_REGION env var.</z><z id="t1642331288" t="viesti I remember having to specify AWS_REGION for Fargate tasks"><y>#</y><d>2022-01-16</d><h>11:08</h><r>viesti</r>I remember having to specify AWS_REGION for Fargate tasks</z><z id="t1642331568" t="viesti so maybe DefaultAwsRegionProviderChain doesn&apos;t use the AWS_CONTAINER_CREDENTIALS_RELATIVE_URI that is available when running in ECS"><y>#</y><d>2022-01-16</d><h>11:12</h><r>viesti</r>so maybe DefaultAwsRegionProviderChain doesn&apos;t use the <code>AWS_CONTAINER_CREDENTIALS_RELATIVE_URI</code> that is available when running in ECS</z><z id="t1642331592" t="viesti not sure, but would explain why I remember having to manually specify AWS_REGION"><y>#</y><d>2022-01-16</d><h>11:13</h><r>viesti</r>not sure, but would explain why I remember having to manually specify AWS_REGION</z><z id="t1642331617" t="viesti I remember having to do that for python libs too, wondering is there some reason for this..."><y>#</y><d>2022-01-16</d><h>11:13</h><r>viesti</r>I remember having to do that for python libs too, wondering is there some reason for this...</z><z id="t1642331849" t="viesti heh, looked too quick, that metadata service in ECS that I was remembering might be only for the credentials, like it kinda says in that environment variable name.. so maybe (str &quot;&quot; (System/getenv &quot;AWS_CONTAINER_CREDENTIALS_RELATIVE_URI&quot;)) gives only the api keys, not the region, would have to check"><y>#</y><d>2022-01-16</d><h>11:17</h><r>viesti</r>heh, looked too quick, that metadata service in ECS that I was remembering might be only for the credentials, like it kinda says in that environment variable name.. so maybe <code>(str &quot;&quot; (System/getenv &quot;AWS_CONTAINER_CREDENTIALS_RELATIVE_URI&quot;))</code> gives only the api keys, not the region, would have to check</z><z id="t1642334381" t="viesti so I guess the answer is that no"><y>#</y><d>2022-01-16</d><h>11:59</h><r>viesti</r>so I guess the answer is that no</z><z id="t1642334412" t="viesti but interestingly, you can read stuff from the ECS metadata server and deduce the current region from say ARNs 😄 sh-4.2# curl -s | jq -r &apos;.ContainerARN&apos; | cut -d: -f4 eu-west-1"><y>#</y><d>2022-01-16</d><h>12:00</h><r>viesti</r>but interestingly, you can read stuff from the ECS metadata server and deduce the current region from say ARNs <b>😄</b>
<pre>sh-4.2# curl -s  | jq -r &apos;.ContainerARN&apos; | cut -d: -f4
eu-west-1</pre></z><z id="t1642334544" t="viesti but if you know the region where you deploy to, depending on the deploy system, I guess specifying the region at deploy time as environment variable in the task definition isn&apos;t that bad (I&apos;ve been using Terraform so you could read the current region from the aws provider)"><y>#</y><d>2022-01-16</d><h>12:02</h><r>viesti</r>but if you know the region where you deploy to, depending on the deploy system, I guess specifying the region at deploy time as environment variable in the task definition isn&apos;t that bad (I&apos;ve been using Terraform so you could read the current region from the aws provider)</z><z id="t1642334557" t="viesti or then hack and use say ContainerARN 🙂"><y>#</y><d>2022-01-16</d><h>12:02</h><r>viesti</r>or then hack and use say ContainerARN <b>🙂</b></z><z id="t1642334818" t="viesti also, if you manually specify region, then you don&apos;t need DefaultAwsRegionProviderChain"><y>#</y><d>2022-01-16</d><h>12:06</h><r>viesti</r>also, if you manually specify region, then you don&apos;t need  DefaultAwsRegionProviderChain</z><z id="t1642335029" t="viesti the above curl thing I quickly explored with https://github.com/viesti/ecs-exec , running a shell in the container and looking at the env"><y>#</y><d>2022-01-16</d><h>12:10</h><r>viesti</r>the above curl thing I quickly explored with <a href="https://github.com/viesti/ecs-exec" target="_blank">https://github.com/viesti/ecs-exec</a>, running a shell in the container and looking at the env</z><z id="t1642349127" t="lukasz Here&apos;s the ECS creds provider that we have in use in prod for over a year: https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5#file-ecs-simple-clj no issues whatsoever"><y>#</y><d>2022-01-16</d><h>16:05</h><r>lukasz</r>Here&apos;s the ECS creds provider that we have in use in prod for over a year: <a href="https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5#file-ecs-simple-clj" target="_blank">https://gist.github.com/lukaszkorecki/120008f7832e23702e94f4205b8e3df5#file-ecs-simple-clj</a> no issues whatsoever</z><z id="t1642349151" t="lukasz the region only comes in play when making calls against AWS APIs so we set that as application level configuration"><y>#</y><d>2022-01-16</d><h>16:05</h><r>lukasz</r>the region only comes in play when making calls against AWS APIs so we set that as application level configuration</z><z id="t1642529895" t="orestis I am investigating adding X-ray tracing to our app. It looks like using the Java SDK is probably the best approach. But I see that cognitect/aws-api doesn&apos;t support tracing requests- there&apos;s an open issue but no further info: https://github.com/cognitect-labs/aws-api/issues/112 - can anyone with experience with AWS x-ray share their experience?"><y>#</y><d>2022-01-18</d><h>18:18</h><w>orestis</w>I am investigating adding X-ray tracing to our app. It looks like using the Java SDK is probably the best approach. But I see that cognitect/aws-api doesn&apos;t support tracing requests- there&apos;s an open issue but no further info: <a href="https://github.com/cognitect-labs/aws-api/issues/112" target="_blank">https://github.com/cognitect-labs/aws-api/issues/112</a> - can anyone with experience with AWS x-ray share their experience?</z><z id="t1642796090" t="karol.adamiec hi, i think i have issues with connection to aws with aws-api. I get SSLHandshake exception. Works from AWS CLI. seems to me it is AWS_CA_BUNDLE issue and aws-api or its default http-client is not picking up these extra certs? Looking for issues i found this: https://github.com/cognitect-labs/aws-api/issues/127 and this does ring true... is there a way to somehow force these extra certs to be used?"><y>#</y><d>2022-01-21</d><h>20:14</h><w>karol.adamiec</w>hi,

i think i have issues with connection to aws with aws-api. I get SSLHandshake exception. Works from AWS CLI.
seems to me it is AWS_CA_BUNDLE issue and aws-api or its default http-client is not picking up these extra certs?
Looking for issues i found this:
<a href="https://github.com/cognitect-labs/aws-api/issues/127" target="_blank">https://github.com/cognitect-labs/aws-api/issues/127</a>
and this does ring true...
is there a way to somehow force these extra certs to be used?</z><z id="t1642822661" t="Drew Verlee Do you have to use the ca bundle? It looks like using that is a low priority feature for the lib maintainers."><y>#</y><d>2022-01-22</d><h>03:37</h><w>Drew Verlee</w>Do you have to use the ca bundle? It looks like using that is a low priority feature for the lib maintainers.</z><z id="t1642837385" t="karol.adamiec i think i have to. this is how the infrastructure is set at at company..... unless i do not understand something and there is a trivial workaround to not use it... it MIGHT be maybe possible to add AWS_CA_BUNDLE certs into java cacerts.... but that would involve changes on developer machines an or docker building tooling. is this how usually people do it?"><y>#</y><d>2022-01-22</d><h>07:43</h><w>karol.adamiec</w>i think i have to. this is how the infrastructure is set at at company..... unless i do not understand something and there is a trivial workaround to not use it...
it MIGHT be maybe possible to add AWS_CA_BUNDLE certs into java cacerts.... but that would involve changes on developer machines an or docker building tooling.
is this how usually people do it?</z><z id="t1643002086" t="Drew Verlee I don&apos;t really know, you likely want to add your use case to the open issue or at at least bump it. Someone with more experience then me will likely be more likely to direct the request."><y>#</y><d>2022-01-24</d><h>05:28</h><w>Drew Verlee</w>I don&apos;t really know, you likely want to add your use case to the open issue or at at least bump it. Someone with more experience then me will likely be more likely to direct the request.</z><z id="t1643016194" t="karol.adamiec i did. thanks. for now we use amazonica, and it works. the thing that worries me though is datomic also using http-client and having issues too. we do not use it ATM, but the plan is there to replace s3 buckets with it.... 😿"><y>#</y><d>2022-01-24</d><h>09:23</h><w>karol.adamiec</w>i did. thanks. for now we use amazonica, and it works. the thing that worries me though is datomic also using http-client and having issues too. we do not use it ATM, but the plan is there to replace s3 buckets with it.... <b>😿</b></z><z id="t1643048156" t="fogus (Clojure Team) I don&apos;t think that the issue is with the client but instead it seems that the aws-api doesn&apos;t currently handle AWS_CA_BUNDLE. I have some cycles to look into this and will get that feature implemented ASAP."><y>#</y><d>2022-01-24</d><h>18:15</h><w>fogus (Clojure Team)</w>I don&apos;t think that the issue is with the client but instead it seems that the aws-api doesn&apos;t currently handle AWS_CA_BUNDLE. I have some cycles to look into this and will get that feature implemented ASAP.</z><z id="t1643632167" t="karol.adamiec anyone is aware how can one get around this issue? is it even possible? pass in custom http-client??"><y>#</y><d>2022-01-31</d><h>12:29</h><r>karol.adamiec</r>anyone is aware how can one get around this issue? is it even possible? pass in custom http-client??</z><z id="t1643054882" t="karol.adamiec 🙇 thanks a lot. that would be great."><y>#</y><d>2022-01-24</d><h>20:08</h><w>karol.adamiec</w><b>🙇</b>
thanks a lot. that would be great.</z><z id="t1643632167" t="karol.adamiec anyone is aware how can one get around this issue? is it even possible? pass in custom http-client??"><y>#</y><d>2022-01-31</d><h>12:29</h><w>karol.adamiec</w>anyone is aware how can one get around this issue? is it even possible? pass in custom http-client??</z><z id="t1643197891" t="orestis Would I be completely crazy to want to implement the AWS X-ray SDK in pure Clojure? The Java implementation is such a tangle of concerns, global mutating things..."><y>#</y><d>2022-01-26</d><h>11:51</h><w>orestis</w>Would I be completely crazy to want to implement the AWS X-ray SDK in pure Clojure? The Java implementation is such a tangle of concerns, global mutating things...</z><z id="t1643198027" t="orestis And all of that to send JSON objects at a UDP port."><y>#</y><d>2022-01-26</d><h>11:53</h><w>orestis</w>And all of that to send JSON objects at a UDP port.</z><z id="t1643207809" t="lukasz You should give it a shot :-)"><y>#</y><d>2022-01-26</d><h>14:36</h><w>lukasz</w>You should give it a shot :-)</z><z id="t1643270865" t="orestis Heh. I&apos;ve started, but I have to put it on ice for a bit to focus on some feature work."><y>#</y><d>2022-01-27</d><h>08:07</h><w>orestis</w>Heh. I&apos;ve started, but I have to put it on ice for a bit to focus on some feature work.</z><z id="t1643282150" t="Ben Sless Question regarding the s3 client, is it possible get an object as a stream instead of first downloading it into memory?"><y>#</y><d>2022-01-27</d><h>11:15</h><w>Ben Sless</w>Question regarding the s3 client, is it possible get an object as a stream instead of first downloading it into memory?</z><z id="t1643293497" t="ghadi are you asking about a particular AWS library?"><y>#</y><d>2022-01-27</d><h>14:24</h><r>ghadi</r>are you asking about a particular AWS library?</z><z id="t1643293920" t="Ben Sless cognitect aws client"><y>#</y><d>2022-01-27</d><h>14:32</h><r>Ben Sless</r>cognitect aws client</z><z id="t1643293945" t="ghadi so there is a branch called execution-flow that includes streaming responses"><y>#</y><d>2022-01-27</d><h>14:32</h><r>ghadi</r>so there is a branch called execution-flow that includes streaming responses</z><z id="t1643293952" t="ghadi it&apos;s unfortunately not been mainlined"><y>#</y><d>2022-01-27</d><h>14:32</h><r>ghadi</r>it&apos;s unfortunately not been mainlined</z><z id="t1643293973" t="Ben Sless 😞"><y>#</y><d>2022-01-27</d><h>14:32</h><r>Ben Sless</r><b>😞</b></z><z id="t1643313414" t="hiredman getobject supports ranged requests"><y>#</y><d>2022-01-27</d><h>19:56</h><r>hiredman</r>getobject supports ranged requests</z><z id="t1660309359" t="dangercoder [:attrs {:href &quot;/_/_/users/UK0810AQ2&quot;}] I know this is a rather old question, did you end up using the Java Lib directly?"><y>#</y><d>2022-08-12</d><h>13:02</h><r>dangercoder</r><a>@UK0810AQ2</a> I know this is a rather old question, did you end up using the Java Lib directly?</z><z id="t1660309687" t="Ben Sless No, I just gzipped it. Data was so repetitive zipping proved to be super effective"><y>#</y><d>2022-08-12</d><h>13:08</h><r>Ben Sless</r>No, I just gzipped it. Data was so repetitive zipping proved to be super effective</z><z id="t1643335442" t="Drew Verlee I just wanna walk through what this AWS X-ray thing is at a high level as i&apos;m really unclear what i&apos;m looking at. &gt; AWS X-Ray helps developers analyze and debug production, distributed applications, such as those built using a microservices architecture. With X-Ray, you can understand how your application and its underlying services are performing to identify and troubleshoot the root cause of performance issues and errors. X-Ray provides an end-to-end view of requests as they travel through your application, and shows a map of your application’s underlying components. You can use X-Ray to analyze both applications in development and in production, from simple three-tier applications to complex microservices applications consisting of thousands of services. Let me try to pair this down... &gt; are performing Like how would it know if my computer are really crunching away at some meaningful task or just adding numbers in a loop endless? &gt; end-to-end view of requests as they travel through your application, Ok so they mean they are going to add tags to network requests and register individual servers in a cluster as entities as well as handlers at entry points that will log the flow of traffic to another database? I&apos;m guessing Jepsen might have some tools for doing this if you want to take inspiration from somewhere. Not sure that adds to the conversation..."><y>#</y><d>2022-01-28</d><h>02:04</h><w>Drew Verlee</w>I just wanna walk through what this AWS X-ray thing is at a high level as i&apos;m really unclear what i&apos;m looking at.

&gt; AWS X-Ray helps developers analyze and debug production, distributed applications, such as those built using a microservices architecture. With X-Ray, you can understand how your application and its underlying services are performing to identify and troubleshoot the root cause of performance issues and errors. X-Ray provides an end-to-end view of requests as they travel through your application, and shows a map of your application’s underlying components. You can use X-Ray to analyze both applications in development and in production, from simple three-tier applications to complex microservices applications consisting of thousands of services.
Let me try to pair this down...

&gt;  are performing 
Like how would it know if my computer are really crunching away at some meaningful task or just adding numbers in a loop endless?

&gt;  end-to-end view of requests as they travel through your application, 
Ok so they mean they are going to add tags to network requests and register individual servers in a cluster as entities as well as handlers at entry points that will  log the flow of traffic to another database?

I&apos;m guessing Jepsen might have some tools for doing this if you want to take inspiration from somewhere. Not sure that adds to the conversation...</z><z id="t1643384345" t="lukasz Usually the way it&apos;s done is by attaching a unique ID to an incoming request and that ID is passed along with extra metadata down the stack, and propagated up once the request is done (request can be sync or async), that&apos;s why all of the JVM tools offer extensions to things like Jetty, gRPC so that this instrumentation happens automatically - for Clojure the usual approach is a ring middleware but once you step out of that, you&apos;ll have to instrument all of your code to pass the context when doing HTTP calls (or similar)"><y>#</y><d>2022-01-28</d><h>15:39</h><w>lukasz</w>Usually the way it&apos;s done is by attaching a unique ID to an incoming request and that ID is passed along with extra metadata down the stack, and propagated up once the request is done (request can be sync or async), that&apos;s why all of the JVM tools offer extensions to things like Jetty, gRPC so that this instrumentation happens automatically - for Clojure the usual approach is a ring middleware but once you step out of that, you&apos;ll have to instrument all of your code to pass the context when doing HTTP calls (or similar)</z><z id="t1643669311" t="Nick Stares Hi! First time using aws-api and I I am trying to invoke a https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-private-api-test-invoke-url.html . Basically the equivalent of hitting https://{restapi-id}.execute-api.{region}. With a GET or POST request. How should I go about doing this? I took a shot in the dark but I don&apos;t know what the value for :api should be: (aws/client {:api :apigateway :region &quot;us-east-1&quot; :endpoint-override {:hostname &quot;ry8g3pqgz5&quot; :path &quot;/prod/workflows&quot;}})) I&apos;ll also need to supply a session token. If I am able to build the client successfully, what would the Invoke :op be? I would have used an http client but then I think I would have to implement the signature calculations for the authorization header from scratch[??]"><y>#</y><d>2022-01-31</d><h>22:48</h><w>Nick Stares</w>Hi! First time using <code>aws-api</code> and I I am trying to invoke a <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-private-api-test-invoke-url.html" target="_blank">https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-private-api-test-invoke-url.html</a>. Basically the equivalent of hitting
<pre>https://{restapi-id}.execute-api.{region}.</pre>
 With a <code>GET</code> or <code>POST</code> request. How should I go about doing this? I took a shot in the dark but I don&apos;t know what the value for <code>:api</code> should be:
<pre>(aws/client {:api :apigateway
               :region &quot;us-east-1&quot;
               :endpoint-override {:hostname &quot;ry8g3pqgz5&quot;
                                   :path     &quot;/prod/workflows&quot;}}))</pre>
I&apos;ll also need to supply a session token. If I am able to build the client successfully, what would the Invoke <code>:op</code> be? I would have used an http client but then I think I would have to implement the signature calculations for the authorization header from scratch[??]</z><z id="t1643723176" t="thegeez The url you want to reach looks similar to the websocket example with :PostToConnection, that might work for your use-case, see: https://github.com/cognitect-labs/aws-api#posttoconnection"><y>#</y><d>2022-02-01</d><h>13:46</h><r>thegeez</r>The url you want to reach looks similar to the websocket example with :PostToConnection, that might work for your use-case, see: <a href="https://github.com/cognitect-labs/aws-api#posttoconnection" target="_blank">https://github.com/cognitect-labs/aws-api#posttoconnection</a></z><z id="t1643739216" t="Nick Stares Hmm, I tried this but it didn&apos;t work (def amc (aws/client {:api :apigatewaymanagementapi :region &quot;us-east-1&quot; :endpoint-override {:hostname &quot;ry8g3pqgz4&quot; :path &quot;/prod/workflows&quot;} :credentials-provider (credentials/basic-credentials-provider {:access-key-id (:AccessKeyId creds) :secret-access-key (:SecretAccessKey creds) :session-token (:SessionToken creds)})})) (aws/invoke amc {:op :PostToConnection}) ;; =&gt; {:cognitect.anomalies/category :cognitect.anomalies/not-found, :cognitect.anomalies/message &quot;ry8g3pqgz4: nodename nor servname provided, or not known&quot;}"><y>#</y><d>2022-02-01</d><h>18:13</h><r>Nick Stares</r>Hmm, I tried this but it didn&apos;t work
<pre>(def amc
  (aws/client {:api :apigatewaymanagementapi
               :region &quot;us-east-1&quot;
               :endpoint-override {:hostname &quot;ry8g3pqgz4&quot;
                                   :path     &quot;/prod/workflows&quot;}
               :credentials-provider (credentials/basic-credentials-provider
                                            {:access-key-id     (:AccessKeyId creds)
                                             :secret-access-key (:SecretAccessKey creds)
                                             :session-token     (:SessionToken creds)})}))

(aws/invoke amc {:op :PostToConnection})
;; =&gt; {:cognitect.anomalies/category :cognitect.anomalies/not-found, :cognitect.anomalies/message &quot;ry8g3pqgz4: nodename nor servname provided, or not known&quot;}</pre></z><z id="t1643739328" t="Nick Stares Also, not sure what operation I would use for GET   since I assume :PostToConnection is only for`POST`"><y>#</y><d>2022-02-01</d><h>18:15</h><r>Nick Stares</r>Also, not sure what operation I would use for <code>GET</code>  since I assume <code>:PostToConnection</code> is only for`POST`</z><z id="t1643755935" t="borkdude Just in case anyone hasn&apos;t seen this yet: this is a pretty cool way of adding some analytics to a website using AWS Lambda and #nbb https://www.loop-code-recur.io/simple-site-analytics-with-serverless-clojure/?utm_source=slack"><y>#</y><d>2022-02-01</d><h>22:52</h><w>borkdude</w>Just in case anyone hasn&apos;t seen this yet: this is a pretty cool way of adding some analytics to a website using AWS Lambda and #nbb
<a href="https://www.loop-code-recur.io/simple-site-analytics-with-serverless-clojure/?utm_source=slack" target="_blank">https://www.loop-code-recur.io/simple-site-analytics-with-serverless-clojure/?utm_source=slack</a></z><z id="t1643865926" t="danieroux Does aws-api ’s http-client do keep-alive? It seems not?"><y>#</y><d>2022-02-03</d><h>05:25</h><w>danieroux</w>Does <code>aws-api</code> ’s http-client do keep-alive? It seems not?</z><z id="t1643866166" t="danieroux https://aws.amazon.com/blogs/developer/http-keep-alive-is-on-by-default-in-modular-aws-sdk-for-javascript/ The connection setup time is slowing down my time-to-first-result"><y>#</y><d>2022-02-03</d><h>05:29</h><r>danieroux</r><a href="https://aws.amazon.com/blogs/developer/http-keep-alive-is-on-by-default-in-modular-aws-sdk-for-javascript/" target="_blank">https://aws.amazon.com/blogs/developer/http-keep-alive-is-on-by-default-in-modular-aws-sdk-for-javascript/</a>

The connection setup time is slowing down my time-to-first-result</z><z id="t1644098434" t="Ben Hammond I have a webpage hosted in an S3 Bucket and using Static Website Hosting I recently switched to using BrowserRouter style URLs eg instead of but now I have the problem that S3 wants to service the logged-in URL from the (non-existant) public/logged-in file whereas I want it to be directed to the cljs app at and let react router pick up the specifics Can I do this with S3 static website hosting?"><y>#</y><d>2022-02-05</d><h>22:00</h><w>Ben Hammond</w>I have a webpage hosted in an S3 Bucket and using Static Website Hosting
I recently switched to using BrowserRouter style URLs eg
<code></code>
instead of
<code></code>
but now I have the problem that S3 wants to service the logged-in URL from the (non-existant) <code>public/logged-in</code> file
whereas I want it to be directed to the cljs app at <code></code> and let react router pick up the specifics

Can I do this with S3 static website hosting?</z><z id="t1644099331" t="Ben Hammond oh actually https://stackoverflow.com/questions/16267339/s3-static-website-hosting-route-all-paths-to-index-html helped"><y>#</y><d>2022-02-05</d><h>22:15</h><r>Ben Hammond</r>oh actually
<a href="https://stackoverflow.com/questions/16267339/s3-static-website-hosting-route-all-paths-to-index-html" target="_blank">https://stackoverflow.com/questions/16267339/s3-static-website-hosting-route-all-paths-to-index-html</a>
helped</z><z id="t1644103142" t="Ben Hammond I am trying to use io.pedestal.http.ring-middlewares.cookies with io.pedestal.ions using http-direct datomic-ions but I see the error &quot;Msg&quot;: &quot;http-endpoint respond failed: &quot;, &quot;Ex&quot;: { &quot;Via&quot;: [ { &quot;Type&quot;: &quot;java.lang.ClassCastException&quot;, &quot;Message&quot;: &quot;class clojure.lang.LazySeq cannot be cast to class java.lang.String (clojure.lang.LazySeq is in unnamed module of loader &apos;app&apos;; java.lang.String is in module java.base of loader &apos;bootstrap&apos;)&quot;, &quot;At&quot;: [ &quot;cognitect.http_endpoint.jetty$respond_bbuf_STAR_&quot;, &quot;invokeStatic&quot;, &quot;jetty.clj&quot;, 342 ] } ], I strongly suspect that this is because ring.middleware.cookies/write-cookies is outputting a Set-Cookies Header like &quot;Set-Cookie&quot; (&quot;__HostID=eyJr***;Secure;HttpOnly;Expires=Mon Mar 07 22:58:14 UTC 2022;Path=/\&quot;) does this mean that I am using the cookies interceptor wrongly? Is there some io.pedestal.ions shim that I should be applying? Do I have to write my own shim?"><y>#</y><d>2022-02-05</d><h>23:19</h><w>Ben Hammond</w>I am trying to use <code>io.pedestal.http.ring-middlewares.cookies</code> with <code>io.pedestal.ions</code> using http-direct datomic-ions
but I see the error
<pre>&quot;Msg&quot;: &quot;http-endpoint respond failed: &quot;,
    &quot;Ex&quot;: {
        &quot;Via&quot;: [
            {
                &quot;Type&quot;: &quot;java.lang.ClassCastException&quot;,
                &quot;Message&quot;: &quot;class clojure.lang.LazySeq cannot be cast to class java.lang.String (clojure.lang.LazySeq is in unnamed module of loader &apos;app&apos;; java.lang.String is in module java.base of loader &apos;bootstrap&apos;)&quot;,
                &quot;At&quot;: [
                    &quot;cognitect.http_endpoint.jetty$respond_bbuf_STAR_&quot;,
                    &quot;invokeStatic&quot;,
                    &quot;jetty.clj&quot;,
                    342
                ]
            }
        ],</pre>
I strongly suspect that this is because <code>ring.middleware.cookies/write-cookies</code> is outputting a Set-Cookies Header like
<pre>&quot;Set-Cookie&quot; (&quot;__HostID=eyJr***;Secure;HttpOnly;Expires=Mon Mar 07 22:58:14 UTC 2022;Path=/\&quot;)</pre>
does this mean that I am using the cookies interceptor wrongly?
Is there some io.pedestal.ions shim that I should be applying?
Do I have to write my own shim?</z><z id="t1644104881" t="Ben Hammond so I can make this particular problem go away by writing (def cookiehack-interceptor (interceptor/interceptor {:name ::cookiehack-interceptor :leave (fn [ctx] (if-let [cookies (get-in ctx [:response :headers &quot;Set-Cookie&quot;])] (cond (string? cookies) ctx (seq? cookies) (assoc-in ctx [:response :headers &quot;Set-Cookie&quot;] (first cookies)) :else ctx) ctx)) })) is there a better way to solve this..?"><y>#</y><d>2022-02-05</d><h>23:48</h><r>Ben Hammond</r>so I can make this particular problem go away by writing
<pre>(def cookiehack-interceptor
  (interceptor/interceptor
   {:name ::cookiehack-interceptor
    :leave
    (fn [ctx]
      (if-let [cookies (get-in ctx [:response :headers &quot;Set-Cookie&quot;])]
        (cond (string? cookies) ctx
              (seq? cookies) (assoc-in ctx [:response :headers &quot;Set-Cookie&quot;] (first cookies))
              :else ctx)
        ctx))
    }))</pre>
is there a better way to solve this..?</z><z id="t1644104988" t="Ben Hammond (it looks like (string/join \, cookies) is discouraged...)"><y>#</y><d>2022-02-05</d><h>23:49</h><r>Ben Hammond</r>(it looks like <code>(string/join \, cookies)</code> is discouraged...)</z><z id="t1644105057" t="Ben Hammond https://stackoverflow.com/questions/4843556/in-http-specification-what-is-the-string-that-separates-cookies"><y>#</y><d>2022-02-05</d><h>23:50</h><r>Ben Hammond</r><a href="https://stackoverflow.com/questions/4843556/in-http-specification-what-is-the-string-that-separates-cookies" target="_blank">https://stackoverflow.com/questions/4843556/in-http-specification-what-is-the-string-that-separates-cookies</a></z><z id="t1644654159" t="Benjamin with cloudwatch there is some way to log a json with some specification right? Is this different from putting metrics?"><y>#</y><d>2022-02-12</d><h>08:22</h><w>Benjamin</w>with cloudwatch there is some way to log a json with some specification right? Is this different from putting metrics?</z><z id="t1644657510" t="jumar You mean embedded cloudwatch metrics?"><y>#</y><d>2022-02-12</d><h>09:18</h><r>jumar</r>You mean embedded cloudwatch metrics?</z><z id="t1644657551" t="Benjamin ah I&apos;m not sure what I mean 😅"><y>#</y><d>2022-02-12</d><h>09:19</h><r>Benjamin</r>ah I&apos;m not sure what I mean <b>😅</b></z><z id="t1644657654" t="Benjamin ah team mate of mine mentioned to print out json to cloudwatch and get nice stats from it with &quot;group, sum..&quot;. Maybe I misunderstood and it&apos;s not even a special feature of cloudwatch, just a normal log event"><y>#</y><d>2022-02-12</d><h>09:20</h><r>Benjamin</r>ah team mate of mine mentioned to print out json to cloudwatch and get nice stats from it with &quot;group, sum..&quot;. Maybe I misunderstood and it&apos;s not even a special feature of cloudwatch, just a normal log event</z><z id="t1644657933" t="Benjamin my use case is getting stats about the activity of my program. Like it responds to some user. Then we like to view the stats and check if on mondays some particular response is more frequent etc."><y>#</y><d>2022-02-12</d><h>09:25</h><r>Benjamin</r>my use case is getting stats about the activity of my program. Like it responds to some  user. Then we like to view the stats and check if on mondays some particular response is more frequent etc.</z><z id="t1644660020" t="valtteri Yep, just start logging json and CloudWatch will parse them automatically."><y>#</y><d>2022-02-12</d><h>10:00</h><r>valtteri</r>Yep, just start logging json and CloudWatch will parse them automatically.</z><z id="t1644660058" t="Benjamin https://docs.datomic.com/cloud/ions/ions-monitoring.html#events going to use this since it&apos;s an ion"><y>#</y><d>2022-02-12</d><h>10:00</h><r>Benjamin</r><a href="https://docs.datomic.com/cloud/ions/ions-monitoring.html#events" target="_blank">https://docs.datomic.com/cloud/ions/ions-monitoring.html#events</a> going to use this since it&apos;s an ion</z><z id="t1645022793" t="Benjamin {:field &quot;@timestamp&quot;, :value &quot;2022-02-16 03:00:23.196&quot;} what is the best way to read this cloudwatch log timestamp?"><y>#</y><d>2022-02-16</d><h>14:46</h><w>Benjamin</w><code>{:field &quot;@timestamp&quot;, :value &quot;2022-02-16 03:00:23.196&quot;}</code>  what is the best way to read this  cloudwatch log timestamp?</z><z id="t1645028513" t="AJ Jaro [:attrs {:href &quot;/_/_/users/U02CV2P4J6S&quot;}] Can you be more specific about what you’re asking? I’m not sure if you mean read it in a query in CloudWatch or some other utility. However, I’m pretty sure you don’t mean physically read it 😅"><y>#</y><d>2022-02-16</d><h>16:21</h><r>AJ Jaro</r><a>@U02CV2P4J6S</a> Can you be more specific about what you’re asking? I’m not sure if you mean read it in a query in CloudWatch or some other utility. However, I’m pretty sure you don’t mean physically read it <b>😅</b></z><z id="t1645158596" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U02CV2P4J6S&quot;}] i&apos;m going to take a guess at what you mean. The answer is using the AWS client-cloud-watch logs SDK, either java (clj) or javascript (node)."><y>#</y><d>2022-02-18</d><h>04:29</h><r>Drew Verlee</r><a>@U02CV2P4J6S</a> i&apos;m going to take a guess at what you mean. The answer is using the AWS client-cloud-watch logs SDK, either java (clj) or javascript (node).</z><z id="t1645158703" t="Drew Verlee for example here is me reading some logs: (ns core3 (:require [cljs.core.async :refer [go]] [cljs.core.async.interop :refer-macros [&lt;p!]] [common.transit :as transit] [common.json :refer [json-&gt;clj]] [&quot;@aws-sdk/client-cloudwatch-logs&quot; :refer (CloudWatchLogsClient FilterLogEventsCommand)] [clojure.string :as str] [tick.alpha.api :as t])) (def client (new CloudWatchLogsClient #js{:region &quot;us-east-1&quot;})) (def command (new FilterLogEventsCommand #js{:logGroupName &quot;/aws/lambda/drew-dev-EqlRoute&quot; :filterPattern &quot;eql&quot; :startTime 1644887463000 :limit 100 })) (def r (atom nil)) (go (try (reset! r (&lt;p! (.send client command))) (catch js/Error err (js/console.log (str &quot;err: &quot; err)))))"><y>#</y><d>2022-02-18</d><h>04:31</h><r>Drew Verlee</r>for example here is me reading some logs:

<pre>(ns core3
  (:require [cljs.core.async :refer [go]]
            [cljs.core.async.interop :refer-macros [&lt;p!]]
            [common.transit :as transit]
            [common.json :refer [json-&gt;clj]]
            [&quot;@aws-sdk/client-cloudwatch-logs&quot; :refer (CloudWatchLogsClient FilterLogEventsCommand)]
            [clojure.string :as str]
            [tick.alpha.api :as t]))


(def client (new CloudWatchLogsClient #js{:region &quot;us-east-1&quot;}))

(def command (new FilterLogEventsCommand #js{:logGroupName  &quot;/aws/lambda/drew-dev-EqlRoute&quot;
                                             :filterPattern &quot;eql&quot;
                                             :startTime 1644887463000
                                             :limit 100
                                             }))

(def r (atom nil))


(go
  (try
    (reset! r
            (&lt;p! (.send client command)))
    (catch js/Error err (js/console.log (str &quot;err: &quot; err)))))</pre></z><z id="t1645170185" t="Benjamin [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] thanks for the example"><y>#</y><d>2022-02-18</d><h>07:43</h><r>Benjamin</r><a>@U0DJ4T5U1</a> thanks for the example</z><z id="t1645190389" t="thomas Hi, anyone here with Amplify experience (not a clj project/problem)"><y>#</y><d>2022-02-18</d><h>13:19</h><w>thomas</w>Hi, anyone here with Amplify experience (not a clj project/problem)</z><z id="t1645190415" t="thomas our prod is no longer accessible via the web interface."><y>#</y><d>2022-02-18</d><h>13:20</h><w>thomas</w>our <code>prod</code> is no longer accessible via the web interface.</z><z id="t1645202999" t="Daniel Craig wish I could help, my amplify experience was really frustrating "><y>#</y><d>2022-02-18</d><h>16:49</h><w>Daniel Craig</w>wish I could help, my amplify experience was really frustrating </z><z id="t1645264738" t="thomas Thank you anyways."><y>#</y><d>2022-02-19</d><h>09:58</h><r>thomas</r>Thank you anyways.</z><z id="t1645694947" t="neil.clarke Hi guys - does anyone have experience with sending binary data to DynamoDB via the Cognitect AWS API?"><y>#</y><d>2022-02-24</d><h>09:29</h><w>neil.clarke</w>Hi guys - does anyone have experience with sending binary data to DynamoDB via the Cognitect AWS API?</z><z id="t1645716832" t="jjttjj I&apos;ve done it"><y>#</y><d>2022-02-24</d><h>15:33</h><r>jjttjj</r>I&apos;ve done it</z><z id="t1645718250" t="jjttjj (aws/invoke ddb {:op :PutItem :request {:TableName &quot;my-table&quot; :Item {:pk {:S &quot;myData&quot;} :myData {:B (nippy/freeze {:hello :world})}}}}) (aws/invoke ddb {:op :GetItem :request {:TableName &quot;my-table&quot; :Key {:pk {:S &quot;myData&quot;}}}}) #_{:Item {:pk {:S &quot;myData&quot;}, :myData {:B #object[java.io.BufferedInputStream &quot;0x4606379e&quot; &quot; "><y>#</y><d>2022-02-24</d><h>15:57</h><r>jjttjj</r><pre>(aws/invoke ddb
  {:op      :PutItem
   :request {:TableName &quot;my-table&quot;
             :Item {:pk {:S &quot;myData&quot;}
                    :myData {:B (nippy/freeze {:hello :world})}}}})

(aws/invoke ddb
  {:op      :GetItem
   :request {:TableName &quot;my-table&quot;
             :Key       {:pk {:S &quot;myData&quot;}}}})

#_{:Item {:pk     {:S &quot;myData&quot;},
        :myData {:B #object[java.io.BufferedInputStream
                            &quot;0x4606379e&quot;
                            &quot;</pre>
</z><z id="t1645718295" t="jjttjj (`.readAllBytes` i think was only added in a slight more recent java version, maybe 1.9? )"><y>#</y><d>2022-02-24</d><h>15:58</h><r>jjttjj</r>(`.readAllBytes` i think was only added in a slight more recent java version, maybe 1.9? )</z><z id="t1645778197" t="neil.clarke [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}] Many thanks, I came right. I needed to send a binary blob which was zlib-compressed JSON; what I did was I shelled out and used pigz (from babashka) and wrapped the console output in (byte-array)"><y>#</y><d>2022-02-25</d><h>08:36</h><r>neil.clarke</r><a>@U064UGEUQ</a> Many thanks, I came right. I needed to send a binary blob which was zlib-compressed JSON; what I did was I shelled out and used pigz (from babashka) and wrapped the console output in (byte-array)</z><z id="t1647039656" t="rmxm hey, i was wondering if I could do a list of operations on api. (aws/doc s3-client) without providing :op name, like (aws/doc s3-client :ListBuckets)"><y>#</y><d>2022-03-11</d><h>23:00</h><w>rmxm</w>hey, i was wondering if I could do a list of operations on api.
<code>(aws/doc s3-client)</code> without providing :op name, like <code>(aws/doc s3-client :ListBuckets)</code></z><z id="t1647039676" t="ghadi (aws/ops s3-client)"><y>#</y><d>2022-03-11</d><h>23:01</h><w>ghadi</w><code>(aws/ops s3-client)</code></z><z id="t1647039751" t="rmxm hmmm cool, thanks, but I would still consider adding arity for (aws/doc s3-client) It seems intuitive. If you see it somewhere in git repo, you try and reach for it -at least I did -&gt; probably doc is supported generically, so I might be dreaming 🙂"><y>#</y><d>2022-03-11</d><h>23:02</h><w>rmxm</w>hmmm cool, thanks, but I would still consider adding arity for <code>(aws/doc s3-client)</code> It seems intuitive. If you see it somewhere in git repo, you try and reach for it -at least I did -&gt; probably doc is supported generically, so I might be dreaming <b>🙂</b></z><z id="t1647041328" t="rmxm One last thing, is there some easy path to &quot;paged&quot; results? or do I have to come up with mine?"><y>#</y><d>2022-03-11</d><h>23:28</h><w>rmxm</w>One last thing, is there some easy path to &quot;paged&quot; results? or do I have to come up with mine?</z><z id="t1647046438" t="kenny Nothing built in. "><y>#</y><d>2022-03-12</d><h>00:53</h><r>kenny</r>Nothing built in. </z><z id="t1647047851" t="rmxm if anybody needs, tested with s3 (defn paged-invoke ([client {:keys [op results is-truncated marker next-marker request] :or {results :Contents is-truncated :IsTruncated marker :Marker next-marker :Marker} :as options}] (let [response (aws/invoke client {:op op :request request})] (when (contains? response :cognitect.anomalies/category) (throw (ex-info &quot;aws/invoke error&quot; {:op op :request request :response response}))) (if (is-truncated response) (lazy-cat (results response) (paged-invoke client (assoc options marker (next-marker response)))) (results response)))))"><y>#</y><d>2022-03-12</d><h>01:17</h><r>rmxm</r>if anybody needs, tested with s3
<pre>(defn paged-invoke
  ([client
    {:keys [op results is-truncated marker next-marker request]
     :or {results :Contents is-truncated :IsTruncated marker :Marker next-marker :Marker}
     :as options}]
   (let [response (aws/invoke client {:op op :request request})]
    (when (contains? response :cognitect.anomalies/category)
      (throw (ex-info &quot;aws/invoke error&quot; {:op op :request request :response response})))
    (if (is-truncated response)
       (lazy-cat (results response)
                 (paged-invoke client (assoc options marker (next-marker response))))
       (results response)))))</pre></z><z id="t1647047906" t="kenny Another example https://gist.github.com/kennyjwilli/65dfbc30c75d76ba2e22cb044c3f8d1f"><y>#</y><d>2022-03-12</d><h>01:18</h><r>kenny</r>Another example <a href="https://gist.github.com/kennyjwilli/65dfbc30c75d76ba2e22cb044c3f8d1f" target="_blank">https://gist.github.com/kennyjwilli/65dfbc30c75d76ba2e22cb044c3f8d1f</a></z><z id="t1647048340" t="Max Isn&apos;t this what iteration was added for? https://github.com/clojure/clojure/blob/master/changes.md"><y>#</y><d>2022-03-12</d><h>01:25</h><r>Max</r>Isn&apos;t this what iteration was added for? <a href="https://github.com/clojure/clojure/blob/master/changes.md" target="_blank">https://github.com/clojure/clojure/blob/master/changes.md</a></z><z id="t1647049576" t="hiredman It is"><y>#</y><d>2022-03-12</d><h>01:46</h><r>hiredman</r>It is</z><z id="t1647049665" t="kenny How each api paginates still must be manually written. There are some libs that try to specify where the req/resp pagination tokens are stored. It&apos;s not included in the all smithy files. "><y>#</y><d>2022-03-12</d><h>01:47</h><r>kenny</r>How each api paginates still must be manually written. There are some libs that try to specify where the req/resp pagination tokens are stored. It&apos;s not included in the all smithy files. </z><z id="t1647083732" t="steveb8n I agree. I think a bunch of new libs will address similar problems using Iteration https://www.juxt.pro/blog/new-clojure-iteration"><y>#</y><d>2022-03-12</d><h>11:15</h><r>steveb8n</r>I agree. I think a bunch of new libs will address similar problems using Iteration <a href="https://www.juxt.pro/blog/new-clojure-iteration" target="_blank">https://www.juxt.pro/blog/new-clojure-iteration</a></z><z id="t1647705891" t="jjttjj trivial question of the day. When you want your clojure keywords to also be aws tags, do you write the tag name with the colon or without? ie &quot;:x.y/z&quot; or &quot;x.y/z&quot; . Or is attempting to treat tags and keywords interchangeably not worth it and it&apos;s best to just use strings in clojure (though you still might want a hand rolled namespacing mechanism anyway, so what would you use for that?)"><y>#</y><d>2022-03-19</d><h>16:04</h><w>jjttjj</w>trivial question of the day. When you want your clojure keywords to also be aws tags, do you write the tag name with the colon or without? ie <code>&quot;:x.y/z&quot;</code> or <code>&quot;x.y/z&quot;</code>. Or is attempting to treat tags and keywords interchangeably not worth it and it&apos;s best to just use strings in clojure (though you still might want a hand rolled namespacing mechanism anyway, so what would you use for that?)</z><z id="t1648147956" t="Ovidiu Stoica Hey there, aws clojurians 👋 What are the best resources to learn Clojure x AWS for a SaaS server less stack? I know how to use the server less framework with node is but I want a similar setup with Clojure but to have fast startup times. I know that people use graalVM lambdas, any resources for that?"><y>#</y><d>2022-03-24</d><h>18:52</h><w>Ovidiu Stoica</w>Hey there, aws clojurians <b>👋</b>

What are the best resources to learn Clojure x AWS for a SaaS server less stack?

I know how to use the server less framework with node is but I want a similar setup with Clojure but to have fast startup times.

I know that people use graalVM lambdas, any resources for that?</z><z id="t1648148948" t="Karol Wójcik You can find this one useful: https://github.com/FieryCod/holy-lambda"><y>#</y><d>2022-03-24</d><h>19:09</h><r>Karol Wójcik</r>You can find this one useful: <a href="https://github.com/FieryCod/holy-lambda" target="_blank">https://github.com/FieryCod/holy-lambda</a></z><z id="t1648148998" t="Karol Wójcik You can use any deployment tool you want. Serverless Framework included."><y>#</y><d>2022-03-24</d><h>19:09</h><r>Karol Wójcik</r>You can use any deployment tool you want. Serverless Framework included.</z><z id="t1648469789" t="Maxime Devos Hi, is this an appropriate place to ask questions about com.cognitect.aws.s3?"><y>#</y><d>2022-03-28</d><h>12:16</h><w>Maxime Devos</w>Hi, is this an appropriate place to ask questions about com.cognitect.aws.s3?</z><z id="t1648478212" t="kenny Yes"><y>#</y><d>2022-03-28</d><h>14:36</h><r>kenny</r>Yes</z><z id="t1648478800" t="kenny Hi all. I&apos;m curious if anyone using the Java S3 SDK has encountered &quot;java.net.SocketException: Connection reset&quot; exceptions during a GetObject call (full stacktrace in thread). There&apos;s a variety of folks talking about this exception online (GH, AWS forums, etc), and it&apos;s not totally obvious how or if folks fix this issue. One suggestion I&apos;ve seen is to increase the socket timeout (default is 50s), but I&apos;m not completely clear if that will help. There&apos;s also suggestions to retry from the beginning after receiving this exception. That doesn&apos;t seem like it would work because we&apos;re streaming data in and downstream consumers would have already started to process the data. A retry would need to be smarter and start exactly where it left off. I&apos;m quite unsure if any of those would fix the issue for us mostly because I&apos;m not sure what the problem is. Of course this issue only occurs in production and is not readily reproducible on a local machine. So, has anyone encountered this exception with S3? If so, what did you determine your problem was and what was your solution?"><y>#</y><d>2022-03-28</d><h>14:46</h><w>kenny</w>Hi all. I&apos;m curious if anyone using the Java S3 SDK has encountered &quot;java.net.SocketException: Connection reset&quot; exceptions during a GetObject call (full stacktrace in thread). There&apos;s a variety of folks talking about this exception online (GH, AWS forums, etc), and it&apos;s not totally obvious how or if folks fix this issue. One suggestion I&apos;ve seen is to increase the socket timeout (default is 50s), but I&apos;m not completely clear if that will help. There&apos;s also suggestions to retry from the beginning after receiving this exception. That doesn&apos;t seem like it would work because we&apos;re streaming data in and downstream consumers would have already started to process the data. A retry would need to be smarter and start exactly where it left off. I&apos;m quite unsure if any of those would fix the issue for us mostly because I&apos;m not sure what the problem is. Of course this issue only occurs in production and is not readily reproducible on a local machine.

So, has anyone encountered this exception with S3? If so, what did you determine your problem was and what was your solution?</z><z id="t1648478812" t="kenny Context: We&apos;re downloading hundreds of large(ish) files (~1gb gziped csv) in parallel. Perhaps the problem is that the download is taking more than 50s (a bit surprising for 1gb from s3 running in aws), and the connection times out. Thus, the socket timeout increase will fix it. I&apos;m really not sure, though. The API call is a regular .getObject call, upon which we call .getObjectContent and use the inputstream to process the data downstream."><y>#</y><d>2022-03-28</d><h>14:46</h><r>kenny</r>Context:

We&apos;re downloading hundreds of large(ish) files (~1gb gziped csv) in parallel. Perhaps the problem is that the download is taking more than 50s (a bit surprising for 1gb from s3 running in aws), and the connection times out. Thus, the socket timeout increase will fix it. I&apos;m really not sure, though. The API call is a regular <code>.getObject</code> call, upon which we call <code>.getObjectContent</code> and use the inputstream to process the data downstream.</z><z id="t1648478837" t="kenny Full stacktrace"><y>#</y><d>2022-03-28</d><h>14:47</h><r>kenny</r>Full stacktrace</z><z id="t1648479131" t="lukasz We do process much smaller files (200MB-400MB range) and never hit a timeout issue :thinking_face: One thing we&apos;ve been doing though is avoid buffering contents in memory, and write to tmp files instead - all of the file processing we do via various Java libs and such knows how to consume File instances rather than work on bytes in memory"><y>#</y><d>2022-03-28</d><h>14:52</h><r>lukasz</r>We do process much smaller files (200MB-400MB range) and never hit a timeout issue  <b>:thinking_face:</b> One thing we&apos;ve been doing though is avoid buffering contents in memory, and write to tmp files instead - all of the file processing we do via various Java libs and such knows how to consume File instances rather than work on bytes in memory</z><z id="t1648479167" t="lukasz so they get streamed in chunks and we don&apos;t get OOMs anymore"><y>#</y><d>2022-03-28</d><h>14:52</h><r>lukasz</r>so they get streamed in chunks and we don&apos;t get OOMs anymore</z></g><g id="s16"><z id="t1648479178" t="kenny Hmm. I don&apos;t think memory contention is a problem here. "><y>#</y><d>2022-03-28</d><h>14:52</h><r>kenny</r>Hmm. I don&apos;t think memory contention is a problem here. </z><z id="t1648479395" t="lukasz Perhaps it is related to how many concurrent connections you have - does S3 client use some sort of keep-alive + connection pool approach?"><y>#</y><d>2022-03-28</d><h>14:56</h><r>lukasz</r>Perhaps it is related to how many concurrent connections you have - does S3 client use some sort of keep-alive + connection pool approach?</z><z id="t1648479442" t="kenny Yes. I believe it defaults to 50. We&apos;re making, at most, 8 concurrent getobject requests. "><y>#</y><d>2022-03-28</d><h>14:57</h><r>kenny</r>Yes. I believe it defaults to 50. We&apos;re making, at most, 8 concurrent getobject requests. </z><z id="t1648479591" t="lukasz Very odd, sorry I can&apos;t help more 😢"><y>#</y><d>2022-03-28</d><h>14:59</h><r>lukasz</r>Very odd, sorry I can&apos;t help more <b>😢</b></z><z id="t1648479681" t="kenny Thanks for the reply! I&apos;m pondering the concurrent idea. I am blindly trying the increased connection timeout, but the debugging process will be slow since these conditions only occur once per day…"><y>#</y><d>2022-03-28</d><h>15:01</h><r>kenny</r>Thanks for the reply! I&apos;m pondering the concurrent idea. I am blindly trying the increased connection timeout, but the debugging process will be slow since these conditions only occur once per day…</z><z id="t1648479892" t="lukasz Do you use any of the VPC endpoints stuff? Or just public URLs for S3?"><y>#</y><d>2022-03-28</d><h>15:04</h><r>lukasz</r>Do you use any of the VPC endpoints stuff? Or just public URLs for S3?</z><z id="t1648479990" t="kenny Public "><y>#</y><d>2022-03-28</d><h>15:06</h><r>kenny</r>Public </z><z id="t1648480016" t="lukasz So not a DNS or NAT issue then - no idea where to go from there"><y>#</y><d>2022-03-28</d><h>15:06</h><r>lukasz</r>So not a DNS or NAT issue then - no idea where to go from there</z><z id="t1648480177" t="kenny What do you think of the socket timeout theory?"><y>#</y><d>2022-03-28</d><h>15:09</h><r>kenny</r>What do you think of the socket timeout theory?</z><z id="t1648480280" t="lukasz So you&apos;re using claypoole for concurrent downloads, are you sure you&apos;re not hitting the 50 connections limit?"><y>#</y><d>2022-03-28</d><h>15:11</h><r>lukasz</r>So you&apos;re using claypoole for concurrent downloads, are you sure you&apos;re not hitting the 50 connections limit?</z><z id="t1648480321" t="lukasz (While I like claypoole we&apos;ve been slowly moving to directly using j.u.c.Executors stuff so that we can have more control over timeouts and pool sizes, but that&apos;s just as an aside)"><y>#</y><d>2022-03-28</d><h>15:12</h><r>lukasz</r>(While I like claypoole we&apos;ve been slowly moving to directly using j.u.c.Executors stuff so that we can have more control over timeouts and pool sizes, but that&apos;s just as an aside)</z><z id="t1648480849" t="kenny 1. I&apos;m fairly sure it&apos;s not the concurrent downloads. We&apos;re passing in a fixed size thread pool with a size of 8. 2. If it was the concurrent downloads, why would it manifest in a socket timeout? 3. I&apos;m certainly not tied to claypoole, but it was already used in many places in the code, so it was easy to reach for. FWIW, I think you can directly pass an ExecutorService to claypoole. "><y>#</y><d>2022-03-28</d><h>15:20</h><r>kenny</r>1. I&apos;m fairly sure it&apos;s not the concurrent downloads. We&apos;re passing in a fixed size thread pool with a size of 8. 
2. If it was the concurrent downloads, why would it manifest in a socket timeout?
3. I&apos;m certainly not tied to claypoole, but it was already used in many places in the code, so it was easy to reach for. FWIW, I think you can directly pass an ExecutorService to claypoole. </z><z id="t1648481968" t="lukasz Yeah, it&apos;s very confusing - my only hunch was that issuing concurrent requests and somehow exhausting the 50 connections limit - but yes, very unlikely given your setup"><y>#</y><d>2022-03-28</d><h>15:39</h><r>lukasz</r>Yeah, it&apos;s very confusing - my only hunch was that issuing concurrent requests and somehow exhausting the 50 connections limit - but yes, very unlikely given your setup</z><z id="t1648482000" t="lukasz In my experience when I run into something like this - it was either broken or not, sporadic issues like this are rare"><y>#</y><d>2022-03-28</d><h>15:40</h><r>lukasz</r>In my experience when I run into something like this - it was either broken or not, sporadic issues like this are rare</z><z id="t1648482222" t="kenny Interesting. If I was exhausting the pool, I&apos;d expect a rejected exception immediately. There&apos;s a lot of stuff going on in the sdk, so that could be a poor assumption on my part 😅"><y>#</y><d>2022-03-28</d><h>15:43</h><r>kenny</r>Interesting. If I was exhausting the pool, I&apos;d expect a rejected exception immediately. There&apos;s a lot of stuff going on in the sdk, so that could be a poor assumption on my part <b>😅</b></z><z id="t1648486007" t="Maxime Devos A contributor wants to include com.cognitect.aws.s3 (see https://issues.guix.gnu.org/53765 ) in a distribution. However, there is a slight problem: it is apparently EPL licensed, but the EPL license file itself is missing and according to 3.2(b) of the EPL, a copy of the EPL must be included with the source code. As such, it seems that com.cognitect.aws.s3 cannot legally be redistributed as-is. Any chance the EPL can be included in the jar?"><y>#</y><d>2022-03-28</d><h>16:46</h><w>Maxime Devos</w>A contributor wants to include <code>com.cognitect.aws.s3</code> (see <a href="https://issues.guix.gnu.org/53765" target="_blank">https://issues.guix.gnu.org/53765</a>) in a distribution. However, there is a slight problem: it is apparently EPL licensed, but the EPL license file itself is missing and according to 3.2(b) of the EPL, a copy of the EPL must be included with the source code. As such, it seems that  <code>com.cognitect.aws.s3</code>  cannot legally be redistributed as-is. Any chance the EPL can be included in the jar?</z><z id="t1648489269" t="Alex Miller (Clojure team) can you file a ticket at https://github.com/cognitect-labs/aws-api/issues ? /cc [:attrs {:href &quot;/_/_/users/U050WRF8X&quot;}]"><y>#</y><d>2022-03-28</d><h>17:41</h><r>Alex Miller (Clojure team)</r>can you file a ticket at <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> ? /cc <a>@U050WRF8X</a></z><z id="t1648548872" t="Reily Siegel So, a few updates here, [:attrs {:href &quot;/_/_/users/U037R2N2FRC&quot;}] . aws-s3 is licensed under apache 2.0, not EPL. However, the Apache license also has a clause that the license must be redistributed with the source. It appears that the sources at https://repo1.maven.org/maven2/com/cognitect/aws/s3/820.2.1083.0/s3-820.2.1083.0-sources.jar do not contain any indication of the license, and I can&apos;t find a github repository that contians the sources for the s3 specs. I understand that there is a POM file stating that the sources are licensed under the ASL2.0, but Maxime would prefer an indication distributed with the sources. I will open a github issue with this info."><y>#</y><d>2022-03-29</d><h>10:14</h><r>Reily Siegel</r>So, a few updates here, <a>@U037R2N2FRC</a>. aws-s3 is licensed under apache 2.0, not EPL. However, the Apache license also has a clause that the license must be redistributed with the source. It appears that the sources at <a href="https://repo1.maven.org/maven2/com/cognitect/aws/s3/820.2.1083.0/s3-820.2.1083.0-sources.jar" target="_blank">https://repo1.maven.org/maven2/com/cognitect/aws/s3/820.2.1083.0/s3-820.2.1083.0-sources.jar</a> do not contain any indication of the license, and I can&apos;t find a github repository that contians the sources for the s3 specs. I understand that there is a POM file stating that the sources are licensed under the ASL2.0, but Maxime would prefer an indication distributed with the sources. I will open a github issue with this info.</z><z id="t1648553723" t="Alex Miller (Clojure team) The service artifacts are all generated from data so there is no repo for those, but the artifacts should bundle the license"><y>#</y><d>2022-03-29</d><h>11:35</h><r>Alex Miller (Clojure team)</r>The service artifacts are all generated from data so there is no repo for those, but the artifacts should bundle the license</z><z id="t1648750517" t="lukasz I&apos;m not sure if it&apos;s a valid issue - or just inconsistency in AWS APIs? When using Cognitect&apos;s aws-api lib - S3 operations use title-case for request args (e.g :Bucket or :Key ) but ECS uses camel case (`:forceNewDeployment` or :service ) - is that expected? (I checked output of the doc function as well)"><y>#</y><d>2022-03-31</d><h>18:15</h><w>lukasz</w>I&apos;m not sure if it&apos;s a valid issue - or just inconsistency in AWS APIs? When using Cognitect&apos;s aws-api lib - S3 operations use title-case for request args (e.g <code>:Bucket</code> or <code>:Key</code>) but ECS uses camel case (`:forceNewDeployment` or <code>:service</code>) - is that expected? (I checked output of the <code>doc</code> function as well)</z><z id="t1648751129" t="ghadi inconsistency"><y>#</y><d>2022-03-31</d><h>18:25</h><w>ghadi</w>inconsistency</z><z id="t1648751147" t="Alex Miller (Clojure team) all that stuff is generated from apis provided by AWS"><y>#</y><d>2022-03-31</d><h>18:25</h><w>Alex Miller (Clojure team)</w>all that stuff is generated from apis provided by AWS</z><z id="t1648751159" t="ghadi there are all sorts of annoying variations, that&apos;s why the aws-api library is driven by descriptors provided by AWS"><y>#</y><d>2022-03-31</d><h>18:25</h><w>ghadi</w>there are all sorts of annoying variations, that&apos;s why the aws-api library is driven by descriptors provided by AWS</z><z id="t1648751160" t="ghadi jinx"><y>#</y><d>2022-03-31</d><h>18:26</h><w>ghadi</w>jinx</z><z id="t1648751287" t="lukasz got it :thumbsup:"><y>#</y><d>2022-03-31</d><h>18:28</h><w>lukasz</w>got it <b>:thumbsup:</b></z><z id="t1648791914" t="viesti Apropo, I haven&apos;t yet taken a look, but last fall they released a kind of unified API, the https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/ , which seems to have at least unified https://docs.aws.amazon.com/cloudcontrolapi/latest/APIReference/API_CreateResource.html (didn&apos;t yet look where schemas for resources are). Existing will APIs still stay as-is."><y>#</y><d>2022-04-01</d><h>05:45</h><w>viesti</w>Apropo, I haven&apos;t yet taken a look, but last fall they released a kind of unified API, the <a href="https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/" target="_blank">https://aws.amazon.com/blogs/aws/announcing-aws-cloud-control-api/</a>, which seems to have at least unified <a href="https://docs.aws.amazon.com/cloudcontrolapi/latest/APIReference/API_CreateResource.html" target="_blank">https://docs.aws.amazon.com/cloudcontrolapi/latest/APIReference/API_CreateResource.html</a> (didn&apos;t yet look where schemas for resources are). Existing will APIs still stay as-is.</z><z id="t1648823417" t="kenny TIL: a path for IaC + Clojure -- check out https://www.terraform.io/cdktf ."><y>#</y><d>2022-04-01</d><h>14:30</h><w>kenny</w>TIL: a path for IaC + Clojure -- check out <a href="https://www.terraform.io/cdktf" target="_blank">https://www.terraform.io/cdktf</a>.</z><z id="t1648826484" t="redinger Do you see an advantage that CDKTF has that https://docs.aws.amazon.com/cdk/v2/guide/home.html doesn’t? (Other than Terraform)"><y>#</y><d>2022-04-01</d><h>15:21</h><r>redinger</r>Do you see an advantage that CDKTF has that <a href="https://docs.aws.amazon.com/cdk/v2/guide/home.html" target="_blank">https://docs.aws.amazon.com/cdk/v2/guide/home.html</a> doesn’t? (Other than Terraform)</z><z id="t1648826503" t="redinger I’ve looked at CDK and haven’t fallen in love"><y>#</y><d>2022-04-01</d><h>15:21</h><r>redinger</r>I’ve looked at CDK and haven’t fallen in love</z><z id="t1648826533" t="kenny 1. Not based on CF 2. Cloud agnostic 3. Access to rich Terraform provider ecosystem"><y>#</y><d>2022-04-01</d><h>15:22</h><r>kenny</r>1. Not based on CF
2. Cloud agnostic
3. Access to rich Terraform provider ecosystem</z><z id="t1648861533" t="Max I’ve always been a little confused why people want to do IaC using a typical programming language. To me it seems like an odd match, IaC is essentially static data that defines infra config, whereas programming languages are more about defining processes. By lines of code, plain old config properties tend to dwarf the number of actual computations that need to be performed. So to me a Clojure IaC would probably want to start with EDN, and probably wouldn’t look all that different from HCL in the end"><y>#</y><d>2022-04-02</d><h>01:05</h><w>Max</w>I’ve always been a little confused why people want to do IaC using a typical programming language. To me it  seems like an odd match, IaC is essentially static data that defines infra config, whereas programming languages are more about defining processes. By lines of code, plain old config properties tend to dwarf the number of actual computations that need to be performed. So to me a Clojure IaC would probably want to start with EDN, and probably wouldn’t look all that different from HCL in the end</z><z id="t1648915802" t="lukasz Except that you do want programming language features like for , ifs and ability to create reusable modules - otherwise you run into hacks like Terraform&apos;s count attribute"><y>#</y><d>2022-04-02</d><h>16:10</h><w>lukasz</w>Except that you do want programming language features like <code>for</code>, <code>ifs</code> and ability to create reusable modules - otherwise you run into hacks like Terraform&apos;s <code>count</code> attribute</z><z id="t1648917841" t="kenny Anytime you want to do something special (outside the bounds of the DSL), and in a big enough system this is inevitable, you wish you could “just write some code” to make it work. "><y>#</y><d>2022-04-02</d><h>16:44</h><w>kenny</w>Anytime you want to do something special (outside the bounds of the DSL), and in a big enough system this is inevitable, you wish you could “just write some code” to make it work. </z><z id="t1648918227" t="Max I guess I&apos;ve never run into a situation where I couldn&apos;t simplify my IaC to the point where that wasn&apos;t a problem by decomposing modules and refactoring. Optional resources via count is definitely ugly, I tend to take the Maybe Not approach and just include them or not. Terraform makes it easy to hang modules off of the outputs of other modules, let the user decide which ones to use"><y>#</y><d>2022-04-02</d><h>16:50</h><w>Max</w>I guess I&apos;ve never run into a situation where I couldn&apos;t simplify my IaC to the point where that wasn&apos;t a problem by decomposing modules and refactoring. Optional resources via count is definitely ugly, I tend to take the Maybe Not approach and just include them or not. Terraform makes it easy to hang modules off of the outputs of other modules, let the user decide which ones to use</z><z id="t1648918329" t="Max I think often the more advanced terraform features can be a bit of a trap. Certainly they should be used sometimes, but I think people overuse them trying to DRY out their code, forgetting that HCL is data, not code. "><y>#</y><d>2022-04-02</d><h>16:52</h><w>Max</w>I think often the more advanced terraform features can be a bit of a trap. Certainly they should be used sometimes, but I think people overuse them trying to DRY out their code, forgetting that HCL is data, not code. </z><z id="t1648918752" t="lukasz I agree, I wouldn&apos;t use a full on prog lang for managing infrastructure (I tried that 6 or 7 years ago with DigitalOcean, AWS and Ruby) but some of the recent additions to HCL/TF were absolutely necessary - I was able to simplify a lot of our manifests and merge modules together because we couldn&apos;t use dynamic blocks before. It&apos;s a balancing act, but anyobody who used Ansible will definitely say that &quot;infrastructure-as-data&quot; is not the way to go"><y>#</y><d>2022-04-02</d><h>16:59</h><w>lukasz</w>I agree, I wouldn&apos;t use a full on prog lang for managing infrastructure (I tried that 6 or 7 years ago with DigitalOcean, AWS and Ruby) but some of the recent additions to HCL/TF were absolutely necessary - I was able to simplify a lot of our manifests and merge modules together because we couldn&apos;t use dynamic blocks before. It&apos;s a balancing act, but anyobody who used Ansible will definitely say that &quot;infrastructure-as-data&quot; is not the way to go</z><z id="t1648919012" t="kenny fwiw, our v1 infra deployment was with Terraform HCL. We switched to Pulumi and the code size decrease by 1/3 and we were able to remove extra CLI based steps. This was ~3 yrs ago, so things could have changed. "><y>#</y><d>2022-04-02</d><h>17:03</h><w>kenny</w>fwiw, our v1 infra deployment was with Terraform HCL. We switched to Pulumi and the code size decrease by 1/3 and we were able to remove extra CLI based steps. This was ~3 yrs ago, so things could have changed. </z><z id="t1648919033" t="Max Well I&apos;d hesitate to call Ansible “data”. It&apos;s more of a programming language that uses YAML syntax. But yes I mostly agree. All the CDKTF examples remind me way too much of building up HTML using imperative DOM APIs, you&apos;re describing a process for building up your data, not the data itself. "><y>#</y><d>2022-04-02</d><h>17:03</h><w>Max</w>Well I&apos;d hesitate to call Ansible “data”. It&apos;s more of a programming language that uses YAML syntax. But yes I mostly agree.

All the CDKTF examples remind me way too much of building up HTML using imperative DOM APIs, you&apos;re describing a process for building up your data, not the data itself. </z><z id="t1648919070" t="Max Yeah, a lot changed in the last 3 years for terraform."><y>#</y><d>2022-04-02</d><h>17:04</h><w>Max</w>Yeah, a lot changed in the last 3 years for terraform.</z><z id="t1648919447" t="Max [:attrs {:href &quot;/_/_/users/U083D6HK9&quot;}] I’m guessing you last used HCL before the https://www.terraform.io/language/upgrade-guides/0-12 ?"><y>#</y><d>2022-04-02</d><h>17:10</h><w>Max</w><a>@kenny</a> I’m guessing you last used HCL before the <a href="https://www.terraform.io/language/upgrade-guides/0-12" target="_blank">https://www.terraform.io/language/upgrade-guides/0-12</a>?</z><z id="t1648919692" t="kenny Timeline seems about right. IIRC, simplifications for our code base were reusability of data maps (e.g., merging), inline lambda functions, arbitrary external api calls, EDN config reading. "><y>#</y><d>2022-04-02</d><h>17:14</h><w>kenny</w>Timeline seems about right. IIRC, simplifications for our code base were reusability of data maps (e.g., merging), inline lambda functions, arbitrary external api calls, EDN config reading. </z><z id="t1648919854" t="Max If your infra depends on external API calls then we are definitely working on different worlds"><y>#</y><d>2022-04-02</d><h>17:17</h><w>Max</w>If your infra depends on external API calls then we are definitely working on different worlds</z><z id="t1648920131" t="kenny IIRC, it was to support creation of Datadog resources. "><y>#</y><d>2022-04-02</d><h>17:22</h><w>kenny</w>IIRC, it was to support creation of Datadog resources. </z><z id="t1648920519" t="Max Isn&apos;t there a datadog provider now? Might not have been at the time"><y>#</y><d>2022-04-02</d><h>17:28</h><w>Max</w>Isn&apos;t there a datadog provider now? Might not have been at the time</z><z id="t1648922419" t="kenny Ah yep"><y>#</y><d>2022-04-02</d><h>18:00</h><r>kenny</r>Ah yep</z><z id="t1648922175" t="lukasz Yeah, the provider list ballooned in size - you can also pull in 3rd party ones . I need to try Pulumi to understand all the praise it gets"><y>#</y><d>2022-04-02</d><h>17:56</h><w>lukasz</w>Yeah, the provider list ballooned in size - you can also pull in 3rd party ones . I need to try Pulumi to understand all the praise it gets</z><z id="t1649029346" t="Augustus Hi in https://github.com/cognitect-labs/aws-api is the code that generates the specs for each client publicly available?"><y>#</y><d>2022-04-03</d><h>23:42</h><w>Augustus</w>Hi in <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a> is the code that generates the specs for each client publicly available?</z><z id="t1649029759" t="Alex Miller (Clojure team) No, the generator has not been released"><y>#</y><d>2022-04-03</d><h>23:49</h><r>Alex Miller (Clojure team)</r>No, the generator has not been released</z><z id="t1649031109" t="Augustus Thank you"><y>#</y><d>2022-04-04</d><h>00:11</h><r>Augustus</r>Thank you</z><z id="t1649033034" t="kenny [:attrs {:href &quot;/_/_/users/U03099N7XU2&quot;}] , funny you ask today... It&apos;s quite simple to generate the specs from the api input files. I happened to have a use case for doing so and so I just pushed the code here: https://github.com/kennyjwilli/smithy-spec . Here&apos;s an example call: (smithy-spec/-&gt;specs {::api-input ec2-input} {::smithy-spec/input-shape &quot;TagList&quot; ::smithy-spec/base-ns &quot;aws.ec2&quot;}) =&gt; ((clojure.spec.alpha/def :aws.ec2/TagList (clojure.spec.alpha/coll-of :aws.ec2.TagList/Tag)) (clojure.spec.alpha/def :aws.ec2.TagList/Key clojure.core/string?) (clojure.spec.alpha/def :aws.ec2.TagList/Tag (clojure.spec.alpha/keys :opt-un [:aws.ec2.TagList/Key :aws.ec2.TagList/Value])) (clojure.spec.alpha/def :aws.ec2.TagList/Value clojure.core/string?))"><y>#</y><d>2022-04-04</d><h>00:43</h><w>kenny</w><a>@equal.car1805</a>, funny you ask today... It&apos;s quite simple to generate the specs from the api input files. I happened to have a use case for doing so and so I just pushed the code here: <a href="https://github.com/kennyjwilli/smithy-spec" target="_blank">https://github.com/kennyjwilli/smithy-spec</a>. Here&apos;s an example call:

<pre>(smithy-spec/-&gt;specs {::api-input ec2-input}
  {::smithy-spec/input-shape &quot;TagList&quot;
   ::smithy-spec/base-ns     &quot;aws.ec2&quot;})
=&gt;
((clojure.spec.alpha/def :aws.ec2/TagList (clojure.spec.alpha/coll-of :aws.ec2.TagList/Tag))
 (clojure.spec.alpha/def :aws.ec2.TagList/Key clojure.core/string?)
 (clojure.spec.alpha/def
   :aws.ec2.TagList/Tag
   (clojure.spec.alpha/keys :opt-un [:aws.ec2.TagList/Key :aws.ec2.TagList/Value]))
 (clojure.spec.alpha/def :aws.ec2.TagList/Value clojure.core/string?))</pre></z><z id="t1649033082" t="Augustus wow, looks perfect thanks!"><y>#</y><d>2022-04-04</d><h>00:44</h><r>Augustus</r>wow, looks perfect thanks!</z><z id="t1649033200" t="kenny Cannot confirm it works on everything since it&apos;s hot off the press. Still working to get it to better fit my use case."><y>#</y><d>2022-04-04</d><h>00:46</h><r>kenny</r>Cannot confirm it works on everything since it&apos;s hot off the press. Still working to get it to better fit my use case.</z><z id="t1649168556" t="Benjamin Hello I&apos;d like to make a &quot;v4 signed&quot; http request. Is there a snippet out there or something in cognitect-api that already does that?"><y>#</y><d>2022-04-05</d><h>14:22</h><w>Benjamin</w>Hello I&apos;d like to make a &quot;v4 signed&quot; http request. Is there a snippet out there or something in cognitect-api that already does that?</z><z id="t1649168618" t="Benjamin now I&apos;m checking out this https://github.com/sharetribe/aws-sig4"><y>#</y><d>2022-04-05</d><h>14:23</h><r>Benjamin</r>now I&apos;m checking out this <a href="https://github.com/sharetribe/aws-sig4" target="_blank">https://github.com/sharetribe/aws-sig4</a></z><z id="t1649181850" t="Daniel Craig I have this same need but I haven&apos;t settled on how to do it yet"><y>#</y><d>2022-04-05</d><h>18:04</h><r>Daniel Craig</r>I have this same need but I haven&apos;t settled on how to do it yet</z><z id="t1649181908" t="Daniel Craig For me I want to make a request to a neptune streams endpoint, and a signed request is the way to do that"><y>#</y><d>2022-04-05</d><h>18:05</h><r>Daniel Craig</r>For me I want to make a request to a neptune streams endpoint, and a signed request is the way to do that</z><z id="t1649935722" t="Benjamin In a simple use case I was able to use nbb + got4aws"><y>#</y><d>2022-04-14</d><h>11:28</h><r>Benjamin</r>In a simple use case I was able to use nbb + got4aws</z><z id="t1649935772" t="Benjamin (ns script (:require [&quot;got4aws$default&quot; :as got4aws] [&quot;aws-sdk$default&quot; :as AWS] [applied-science.js-interop :as j] [promesa.core :as p])) (p/let [opts (nbb.core/slurp &quot;options.edn&quot;) opts (read-string opts) client (got4aws (clj-&gt;js {:providers (clj-&gt;js (AWS/SharedIniFileCredentials. (clj-&gt;js (:creds opts)))) :service &quot;execute-api&quot; :region &quot;us-east-1&quot;})) result (-&gt; client (.post (:url opts) (clj-&gt;js {:json .... })))] (prn (js-&gt;clj (j/get-in result :body))) (println))"><y>#</y><d>2022-04-14</d><h>11:29</h><r>Benjamin</r><pre>(ns
    script
    (:require
     [&quot;got4aws$default&quot; :as got4aws]
     [&quot;aws-sdk$default&quot; :as AWS]
     [applied-science.js-interop :as j]
     [promesa.core :as p]))


(p/let
    [opts
     (nbb.core/slurp &quot;options.edn&quot;)
     opts
     (read-string opts)
     client
     (got4aws
      (clj-&gt;js
       {:providers (clj-&gt;js
                    (AWS/SharedIniFileCredentials.
                     (clj-&gt;js (:creds opts))))
        :service &quot;execute-api&quot;
        :region &quot;us-east-1&quot;}))
     result
     (-&gt;
      client
      (.post
       (:url opts)
       (clj-&gt;js
        {:json  .... })))]
    (prn
     (js-&gt;clj
      (j/get-in
       result :body)))
    (println))</pre></z><z id="t1651266666" t="Daniel Craig I&apos;m looking into NeptuneNettyHttpSigV4Signer from the aws neptune sdk for my use case"><y>#</y><d>2022-04-29</d><h>21:11</h><r>Daniel Craig</r>I&apos;m looking into <code>NeptuneNettyHttpSigV4Signer</code> from the aws neptune sdk for my use case</z><z id="t1649368623" t="Drew Verlee I need to run a very short (less then a minute) function on a very loose (hours) schedule. Does aws Lambda seem like the best fit for this? If so, what path to setting that up have people had success with? Any experience reports with Holy Lambda https://fierycod.github.io/holy-lambda/#/ Additionally, I don&apos;t need GraalVM startup speed but i suppose it would be nice to have the option or easily transition. I&apos;m just not sure even considering the trade offs is worth it. I would be curious what others have done and learned though."><y>#</y><d>2022-04-07</d><h>21:57</h><w>Drew Verlee</w>I need to run a very short (less then a minute) function on a very loose (hours) schedule. Does aws Lambda seem like the best fit for this? If so, what path to setting that up have people had success with? Any experience reports with Holy Lambda

<a href="https://fierycod.github.io/holy-lambda/#/" target="_blank">https://fierycod.github.io/holy-lambda/#/</a>

Additionally, I don&apos;t need GraalVM startup speed but i suppose it would be nice to have the option or easily transition. I&apos;m just not sure even considering the trade offs is worth it. I would be curious what others have done and learned though.</z><z id="t1649368802" t="Daniel Jomphe No experience yet but you may also want to ask there too #holy-lambda. BTW Lambdas can now expose URLs without having to be fronted by API Gateway, so they&apos;re even easier to expose than before."><y>#</y><d>2022-04-07</d><h>22:00</h><r>Daniel Jomphe</r>No experience yet but you may also want to ask there too #holy-lambda.

BTW Lambdas can now expose URLs without having to be fronted by API Gateway, so they&apos;re even easier to expose than before.</z><z id="t1649368853" t="Daniel Jomphe Remember that you&apos;ve got million(s) of free Lambda calls per month (I suppose it&apos;s for small-sized CPU and RAM ones). Looks like it&apos;s really worth checking out."><y>#</y><d>2022-04-07</d><h>22:00</h><r>Daniel Jomphe</r>Remember that you&apos;ve got million(s) of free Lambda calls per month (I suppose it&apos;s for small-sized CPU and RAM ones).

Looks like it&apos;s really worth checking out.</z><z id="t1649369464" t="Drew Verlee Thanks Daniel, i don&apos;t need to expose this to a public endpoint/url as it will only need to make http calls then send an email. It&apos;s good to know there are free calls per month."><y>#</y><d>2022-04-07</d><h>22:11</h><r>Drew Verlee</r>Thanks Daniel, i don&apos;t need to expose this to a public endpoint/url as it will only need to make http calls then send an email. It&apos;s good to know there are free calls per month.</z><z id="t1649375358" t="Max I&apos;ve been itching for an excuse to try holy lambda’s babashka backend. If you do end up going the holy lambda route I&apos;d love to see an experience report!"><y>#</y><d>2022-04-07</d><h>23:49</h><r>Max</r>I&apos;ve been itching for an excuse to try holy lambda’s babashka backend. If you do end up going the holy lambda route I&apos;d love to see an experience report!</z><z id="t1649399994" t="Karol Wójcik [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] I think the easiest option for you is HL on the custom Java17 Layer, since: • your use case doesn&apos;t require a fast startup time, • going with GraalVM would be an overkill for now since this is another tool you have to learn about. This repository contains a ready-to-go template with mentioned above configuration. In the future, you can always &quot;easily&quot; migrate to the Native backend with this."><y>#</y><d>2022-04-08</d><h>06:39</h><r>Karol Wójcik</r><a>@drewverlee</a> I think the easiest option for you is HL on the custom Java17 Layer, since:

• your use case doesn&apos;t require a fast startup time,
• going with GraalVM would be an overkill for now since this is another tool you have to learn about.
This repository contains a ready-to-go template with mentioned above configuration. In the future, you can always &quot;easily&quot; migrate to the Native backend with this.</z><z id="t1649400006" t="Karol Wójcik https://github.com/FieryCod/holy-lambda-on-java-17"><y>#</y><d>2022-04-08</d><h>06:40</h><r>Karol Wójcik</r><a href="https://github.com/FieryCod/holy-lambda-on-java-17" target="_blank">https://github.com/FieryCod/holy-lambda-on-java-17</a></z><z id="t1649400244" t="Karol Wójcik What is cool about this layer is it enables TieredCompilation=1 by default and by that speeding the startup time significantly. https://aws.amazon.com/blogs/compute/increasing-performance-of-java-aws-lambda-functions-using-tiered-compilation/"><y>#</y><d>2022-04-08</d><h>06:44</h><r>Karol Wójcik</r>What is cool about this layer is it enables TieredCompilation=1 by default and by that speeding the startup time significantly.
<a href="https://aws.amazon.com/blogs/compute/increasing-performance-of-java-aws-lambda-functions-using-tiered-compilation/" target="_blank">https://aws.amazon.com/blogs/compute/increasing-performance-of-java-aws-lambda-functions-using-tiered-compilation/</a></z><z id="t1649432550" t="Drew Verlee thanks Karol, i&apos;m taking a look now"><y>#</y><d>2022-04-08</d><h>15:42</h><r>Drew Verlee</r>thanks Karol, i&apos;m taking a look now</z><z id="t1649433802" t="Karol Wójcik Cool! "><y>#</y><d>2022-04-08</d><h>16:03</h><r>Karol Wójcik</r>Cool! </z><z id="t1649369114" t="ghadi [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] CloudWatch scheduled trigger -&gt; Lambda"><y>#</y><d>2022-04-07</d><h>22:05</h><w>ghadi</w><a>@drewverlee</a> CloudWatch scheduled trigger -&gt; Lambda</z><z id="t1649428904" t="Ben Sless Is there any protocol or recommendation for metrics for the aws API? Something like success rate and latency for different ops. I know it can be done trivially by wrapping invoke, but it would have been nice to have a metrics protocol for clients. Some things I can&apos;t measure by wrapping like retries."><y>#</y><d>2022-04-08</d><h>14:41</h><w>Ben Sless</w>Is there any protocol or recommendation for metrics for the aws API? Something like success rate and latency for different ops. I know it can be done trivially by wrapping invoke, but it would have been nice to have a metrics protocol for clients. Some things I can&apos;t measure by wrapping like retries.</z><z id="t1649429456" t="Alex Miller (Clojure team) adding an issue at https://github.com/cognitect-labs/aws-api/issues would be best for tracking"><y>#</y><d>2022-04-08</d><h>14:50</h><w>Alex Miller (Clojure team)</w>adding an issue at <a href="https://github.com/cognitect-labs/aws-api/issues" target="_blank">https://github.com/cognitect-labs/aws-api/issues</a> would be best for tracking</z><z id="t1649553226" t="wimomisterx Trying to get aws-api to work with https://github.com/p4tin/goaws but running into #:cognitect.anomalies{:category :cognitect.anomalies/unavailable, :message &quot;Connection refused&quot;} . Works fine when I use the aws cli to list topics. This is how I&apos;m using it... (def sns (aws/client {:api :sns :endpoint-override {:protocol :http :host &quot;localhost&quot; :port 4100} :credentials-provider (credentials/basic-credentials-provider {:access-key-id &quot;gimme&quot; :secret-access-key &quot;access&quot;})})) (aws/invoke sns-client {:op :ListTopics}) Has anyone been able to get aws-api to work with goaws or localstack?"><y>#</y><d>2022-04-10</d><h>01:13</h><w>wimomisterx</w>Trying to get aws-api to work with <a href="https://github.com/p4tin/goaws" target="_blank">https://github.com/p4tin/goaws</a> but running into <code>#:cognitect.anomalies{:category :cognitect.anomalies/unavailable, :message &quot;Connection refused&quot;}</code> . Works fine when I use the aws cli to list topics.

This is how I&apos;m using it...
<pre>(def sns (aws/client {:api :sns
                      :endpoint-override {:protocol :http
                                          :host &quot;localhost&quot;
                                          :port 4100}
                      :credentials-provider (credentials/basic-credentials-provider
                                              {:access-key-id     &quot;gimme&quot;
                                               :secret-access-key &quot;access&quot;})}))

(aws/invoke sns-client {:op :ListTopics})</pre>
Has anyone been able to get aws-api to work with goaws or localstack?</z><z id="t1649606669" t="lukasz What&apos;s the error that you&apos;re getting? We use aws-api with Minio and the configuration looks more or less the same as your SNS client"><y>#</y><d>2022-04-10</d><h>16:04</h><r>lukasz</r>What&apos;s the error that you&apos;re getting? We use aws-api with Minio and the configuration looks more or less the same as your SNS client</z><z id="t1649606721" t="lukasz The only difference is that rather than :host our code has :hostname"><y>#</y><d>2022-04-10</d><h>16:05</h><r>lukasz</r>The only difference is that rather than <code>:host</code> our code has <code>:hostname</code></z><z id="t1649606729" t="lukasz in the :endpoint-override config"><y>#</y><d>2022-04-10</d><h>16:05</h><r>lukasz</r>in the <code>:endpoint-override</code> config</z><z id="t1649636616" t="wimomisterx ah! that was it. Thanks [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] :thumbsup:"><y>#</y><d>2022-04-11</d><h>00:23</h><r>wimomisterx</r>ah! that was it. Thanks <a>@U0JEFEZH6</a> <b>:thumbsup:</b></z><z id="t1649942184" t="Daniel Shriki Hi! Hope that everybody feeling good. Is anyone has a suggestion wether to use amazonica or aws-api (cognitect)? - note that we have to use presigned-url functionality which looks like it is still missing from aws-api, but maybe there are more things to consider. our mainly uses are S3, SQS, and cognito services. happy to hear your thoughts. thanks! 🙂"><y>#</y><d>2022-04-14</d><h>13:16</h><w>Daniel Shriki</w>Hi! Hope that everybody feeling good. Is anyone has a suggestion wether to use amazonica or aws-api (cognitect)? - note that we have to use presigned-url functionality which looks like it is still missing from aws-api, but maybe there are more things to consider. our mainly uses are S3, SQS, and cognito services. happy to hear your thoughts. thanks! <b>🙂</b></z><z id="t1649948439" t="lukasz If you need presigned urls then you need the java sdk (which is surprisingly ok to use from Clj). Our internal library that simplifies working with AWS combines both aws-api and Java SDK (latter part is for IO intensive code or pre-signing)"><y>#</y><d>2022-04-14</d><h>15:00</h><r>lukasz</r>If you need presigned urls then you need the java sdk (which is surprisingly ok to use from Clj). Our internal library that simplifies working with AWS combines both aws-api and Java SDK (latter part is for IO intensive code or pre-signing)</z><z id="t1649971111" t="kenny I&apos;d like to experiment on dynamodb to better understand its scaling behavior under very high load (e.g., 40k req/s). I have code written to run an experiment for some duration and to fire ddb GetItem or PutItem requests off at 40k/sec, spread uniformly over a single second. However, when running this with Cognitect&apos;s aws-api at 3k GetItem req/s, I will receive thousands of anomalies that look like this: #:cognitect.anomalies{:category :cognitect.anomalies/busy, :message &quot;Ops limit reached: 64&quot;} So I&apos;m curious, is the ops limit something I can change? Should I use the Java SDK for this instead? Am I just going to run into 1 compute limitations anyway?"><y>#</y><d>2022-04-14</d><h>21:18</h><w>kenny</w>I&apos;d like to experiment on dynamodb to better understand its scaling behavior under very high load (e.g., 40k req/s). I have code written to run an experiment for some duration and to fire ddb GetItem or PutItem requests off at 40k/sec, spread uniformly over a single second. However, when running this with Cognitect&apos;s aws-api at 3k GetItem req/s, I will receive thousands of anomalies that look like this:
<pre>#:cognitect.anomalies{:category :cognitect.anomalies/busy,
                      :message &quot;Ops limit reached: 64&quot;}</pre>
So I&apos;m curious, is the ops limit something I can change? Should I use the Java SDK for this instead? Am I just going to run into 1 compute limitations anyway?</z><z id="t1649978717" t="hiredman https://github.com/cognitect-labs/aws-api/blob/f9eec3b2ac4b199139cbde7964337bc522ba440b/README.md#ops-limit-reached"><y>#</y><d>2022-04-14</d><h>23:25</h><w>hiredman</w><a href="https://github.com/cognitect-labs/aws-api/blob/f9eec3b2ac4b199139cbde7964337bc522ba440b/README.md#ops-limit-reached" target="_blank">https://github.com/cognitect-labs/aws-api/blob/f9eec3b2ac4b199139cbde7964337bc522ba440b/README.md#ops-limit-reached</a></z><z id="t1650340645" t="jjttjj I want to start getting a little more organized with my spinning up of ec2 servers (for long running and short lived things) as well as a slowly expanding list of other cloud resources. Is it worth it to just go all in on cloudformation right away, encode the few ec2 instance setups that I use as templates and grow them slowly over time? Or is that overkill if it&apos;s not clear that I need it, and sticking with the clojure aws-api library and functions wrapping instance request data the way to go? This seems more ad hoc and perhaps not taking advantage of the &quot;Right tool for the job&quot; on aws."><y>#</y><d>2022-04-19</d><h>03:57</h><w>jjttjj</w>I want to start getting a little more organized with my spinning up of ec2 servers (for long running and short lived things) as well as a slowly expanding list of other cloud resources.
Is it worth it to just go all in on cloudformation right away, encode the few ec2 instance setups that I use as templates and grow them slowly over time?
Or is that overkill if it&apos;s not clear that I need it, and sticking with the clojure aws-api library and functions wrapping instance request data the way to go? This seems more ad hoc and perhaps not taking advantage of the &quot;Right tool for the job&quot; on aws.</z><z id="t1650346259" t="kardan I can’t say that I used Cloudformation much but I would recommend looking into Terraform."><y>#</y><d>2022-04-19</d><h>05:30</h><r>kardan</r>I can’t say that I used Cloudformation much but I would recommend looking into Terraform.</z><z id="t1650369636" t="AJ Jaro Yep terraform and Pulumi is another good iaas"><y>#</y><d>2022-04-19</d><h>12:00</h><r>AJ Jaro</r>Yep terraform and Pulumi is another good iaas</z><z id="t1650395903" t="jjttjj Sorry I know this is googleable/researchable but if you have a chance, is there a quick reason you prefer them? Is it that they are more general and don&apos;t tie you to AWS? Nicer to use ergonomically? My first impressions are that Terraform might be a bit less tedious than typing out the cloud formation json but introduces its own config language. And pulumi offers an sdk but not for any jvm language. Neither really is getting me excited to try them out vs just big json files I can work with from clojure. Is it just that you have to try them all to get a real sense for the pros/cons of each?"><y>#</y><d>2022-04-19</d><h>19:18</h><r>jjttjj</r>Sorry I know this is googleable/researchable but if you have a chance, is there a quick reason you prefer them? Is it that they are more general and don&apos;t tie you to AWS? Nicer to use ergonomically? My first impressions are that Terraform might be a bit less tedious than typing out the cloud formation json but introduces its own config language. And pulumi offers an sdk but not for any jvm language. Neither really is getting me excited to try them out vs just big json files I can work with from clojure. Is it just that you have to try them all to get a real sense for the pros/cons of each?</z><z id="t1650407029" t="AJ Jaro Right, yeah our Pulumi is written in TypeScript while our app is in Clojure. It allows the automated build up and tear down of resources on command with dynamic values based on previously spun up &quot;things&quot; Depending on what you&apos;re building this can be way overkill."><y>#</y><d>2022-04-19</d><h>22:23</h><r>AJ Jaro</r>Right, yeah our Pulumi is written in TypeScript while our app is in Clojure. It allows the automated build up and tear down of resources on command with dynamic values based on previously spun up &quot;things&quot; 

Depending on what you&apos;re building this can be way overkill.</z><z id="t1650433541" t="kardan I’m not in love with all thing Terraform, like the HCL language but it’s practical and I find the Terraform AWS provider docs great."><y>#</y><d>2022-04-20</d><h>05:45</h><r>kardan</r>I’m not in love with all thing Terraform, like the HCL language but it’s practical and I find the Terraform AWS provider docs great.</z><z id="t1650552366" t="jjttjj What&apos;s the current best practice to get github credentials to an EC2 instance? I need to pull from private github repos. My current thinking is: Put the github ssh private key into Secrets Manager, restrict it&apos;s access to a IAM role that you give to the instance profile of the EC2 instance, then run a script on the instance that fetches the secret and saves it"><y>#</y><d>2022-04-21</d><h>14:46</h><w>jjttjj</w>What&apos;s the current best practice to get github credentials to an EC2 instance? I need to pull from private github repos.
My current thinking is: Put the github ssh private key into Secrets Manager, restrict it&apos;s access to a IAM role that you give to the instance profile of the EC2 instance, then run a script on the instance that fetches the secret and saves it</z><z id="t1650552471" t="lukasz We&apos;re doing something like that - let me check how we solved it"><y>#</y><d>2022-04-21</d><h>14:47</h><r>lukasz</r>We&apos;re doing something like that - let me check how we solved it</z><z id="t1650552945" t="lukasz So, each team member that requires access has to generate a new key pair used only for access to the bastion instance. The same key is added to GH to allow pull/push. And lastly, we have a cloudinit template that creates ~/.ssh/authorized_keys for each user automatically on instance creation. So don&apos;t need to worry about private keys really, as long as individuals take care of securing them on their end."><y>#</y><d>2022-04-21</d><h>14:55</h><r>lukasz</r>So, each team member that requires access has to generate a new key pair used only for access to the bastion instance. The same key is added to GH to allow pull/push. And lastly, we have a cloudinit template that creates <code>~/.ssh/authorized_keys</code> for each user automatically on instance creation. So don&apos;t need to worry about private keys really, as long as individuals take care of securing them on their end.</z><z id="t1650553635" t="jumar If there&apos;s a user on behalf of whom you&apos;re doing the clone then OAuth is a common choice "><y>#</y><d>2022-04-21</d><h>15:07</h><r>jumar</r>If there&apos;s a user on behalf of whom you&apos;re doing the clone then OAuth is a common choice </z><z id="t1650556746" t="jjttjj So github deploy keys would be added for each project for each user that works on it right?"><y>#</y><d>2022-04-21</d><h>15:59</h><r>jjttjj</r>So github deploy keys would be added for each project for each user that works on it right?</z><z id="t1650556836" t="lukasz Yes, that&apos;s how all CI systems automate this, there&apos;s an API to generate a key for deploy-only scenarios I believe - not something I worked with"><y>#</y><d>2022-04-21</d><h>16:00</h><r>lukasz</r>Yes, that&apos;s how all CI systems automate this, there&apos;s an API to generate a key for deploy-only scenarios I believe - not something I worked with</z><z id="t1650556854" t="jjttjj Cool, thanks for the input!"><y>#</y><d>2022-04-21</d><h>16:00</h><r>jjttjj</r>Cool, thanks for the input!</z><z id="t1650557312" t="lukasz (as an aside: we have factored out GitHub out of deployments completely, but using Docker containers - and &quot;fat&quot; Debian packages before that)"><y>#</y><d>2022-04-21</d><h>16:08</h><r>lukasz</r>(as an aside: we have factored out GitHub out of deployments completely, but using Docker containers - and &quot;fat&quot; Debian packages before that)</z><z id="t1651074574" t="lispers-anonymous I am using the cognitect labs aws api and am occasionally seeing this error when calling invoke on an aws client for the ~SNS~ SQS api {:cognitect.anomalies/category :cognitect.anomalies/fault, :cognitect.anomalies/message &quot;Abruptly closed by peer&quot;, :cognitect.http-client/throwable #error {:cause &quot;Abruptly closed by peer&quot; :via [{:type javax.net.ssl.SSLHandshakeException :message &quot;Abruptly closed by peer&quot; :at [org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 769]}] :trace [[org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 769] [org.eclipse.jetty.client.http.HttpReceiverOverHTTP process &quot;HttpReceiverOverHTTP.java&quot; 164] [org.eclipse.jetty.client.http.HttpReceiverOverHTTP receive &quot;HttpReceiverOverHTTP.java&quot; 79] [org.eclipse.jetty.client.http.HttpChannelOverHTTP receive &quot;HttpChannelOverHTTP.java&quot; 131] [org.eclipse.jetty.client.http.HttpConnectionOverHTTP onFillable &quot;HttpConnectionOverHTTP.java&quot; 172] [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded &quot;AbstractConnection.java&quot; 311] [org.eclipse.jetty.io.FillInterest fillable &quot;FillInterest.java&quot; 105] [org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 555] [org.eclipse.jetty.io.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 410] [org.eclipse.jetty.io.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 164] [org.eclipse.jetty.io.FillInterest fillable &quot;FillInterest.java&quot; 105] [org.eclipse.jetty.io.ChannelEndPoint$1 run &quot;ChannelEndPoint.java&quot; 104] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 338] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 315] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 173] [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 131] [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 409] [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 883] [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 1034] [java.lang.Thread run nil -1]]}}} It does not happen every time, just sporadically. Has anyone seen this before, or know how I can prevent it? Is it okay to retry? Edit: our version numbers com.cognitect.aws/api {:mvn/version &quot;0.8.539&quot;} com.cognitect.aws/endpoints {:mvn/version &quot;1.1.12.181&quot;} com.cognitect.aws/sns {:mvn/version &quot;820.2.1083.0&quot;} com.cognitect.aws/sqs {:mvn/version &quot;814.2.1053.0&quot;}"><y>#</y><d>2022-04-27</d><h>15:49</h><w>lispers-anonymous</w>I am using the cognitect labs aws api and am occasionally seeing this error when calling invoke on an aws client for the ~SNS~ SQS api

<pre>{:cognitect.anomalies/category :cognitect.anomalies/fault,
 :cognitect.anomalies/message  &quot;Abruptly closed by peer&quot;,
 :cognitect.http-client/throwable #error {:cause &quot;Abruptly closed by peer&quot;
 :via
 [{:type javax.net.ssl.SSLHandshakeException
   :message &quot;Abruptly closed by peer&quot;
   :at [org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 769]}]
   :trace
   [[org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint fill &quot;SslConnection.java&quot; 769]
    [org.eclipse.jetty.client.http.HttpReceiverOverHTTP process &quot;HttpReceiverOverHTTP.java&quot; 164]
    [org.eclipse.jetty.client.http.HttpReceiverOverHTTP receive &quot;HttpReceiverOverHTTP.java&quot; 79]
    [org.eclipse.jetty.client.http.HttpChannelOverHTTP receive &quot;HttpChannelOverHTTP.java&quot; 131]
    [org.eclipse.jetty.client.http.HttpConnectionOverHTTP onFillable &quot;HttpConnectionOverHTTP.java&quot; 172]
    [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded &quot;AbstractConnection.java&quot; 311]
    [org.eclipse.jetty.io.FillInterest fillable &quot;FillInterest.java&quot; 105]
    [org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint onFillable &quot;SslConnection.java&quot; 555]
    [org.eclipse.jetty.io.ssl.SslConnection onFillable &quot;SslConnection.java&quot; 410]
    [org.eclipse.jetty.io.ssl.SslConnection$2 succeeded &quot;SslConnection.java&quot; 164]
    [org.eclipse.jetty.io.FillInterest fillable &quot;FillInterest.java&quot; 105]
    [org.eclipse.jetty.io.ChannelEndPoint$1 run &quot;ChannelEndPoint.java&quot; 104]
    [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill runTask &quot;EatWhatYouKill.java&quot; 338]
    [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill doProduce &quot;EatWhatYouKill.java&quot; 315]
    [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill tryProduce &quot;EatWhatYouKill.java&quot; 173]
    [org.eclipse.jetty.util.thread.strategy.EatWhatYouKill run &quot;EatWhatYouKill.java&quot; 131]
    [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run &quot;ReservedThreadExecutor.java&quot; 409]
    [org.eclipse.jetty.util.thread.QueuedThreadPool runJob &quot;QueuedThreadPool.java&quot; 883]
    [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run &quot;QueuedThreadPool.java&quot; 1034]
    [java.lang.Thread run nil -1]]}}}</pre>
It does not happen every time, just sporadically. Has anyone seen this before, or know how I can prevent it? Is it okay to retry?

Edit: our version numbers

<pre>com.cognitect.aws/api           {:mvn/version &quot;0.8.539&quot;}
com.cognitect.aws/endpoints     {:mvn/version &quot;1.1.12.181&quot;}
com.cognitect.aws/sns           {:mvn/version &quot;820.2.1083.0&quot;}
com.cognitect.aws/sqs           {:mvn/version &quot;814.2.1053.0&quot;}</pre></z><z id="t1651074657" t="ghadi calling from inside a Lambda or elsewhere?"><y>#</y><d>2022-04-27</d><h>15:50</h><w>ghadi</w>calling from inside a Lambda or elsewhere?</z><z id="t1651074671" t="lispers-anonymous No sir, this is running in an ECS container"><y>#</y><d>2022-04-27</d><h>15:51</h><w>lispers-anonymous</w>No sir, this is running in an ECS container</z><z id="t1651075199" t="ghadi though it&apos;s not marked so, I think it&apos;s retriable [:attrs {:href &quot;/_/_/users/UDVJE9RE3&quot;}] ."><y>#</y><d>2022-04-27</d><h>15:59</h><w>ghadi</w>though it&apos;s not marked so, I think it&apos;s retriable <a>@dannyfreeman</a>.</z><z id="t1651075225" t="ghadi I wonder if the process is hitting an idleness timeout"><y>#</y><d>2022-04-27</d><h>16:00</h><w>ghadi</w>I wonder if the process is hitting an idleness timeout</z><z id="t1651075593" t="lispers-anonymous I&apos;m not sure we have any way to tell. There is not much other context to the error. We have other core async work happening, while I don&apos;t believe it&apos;s hogging the thread pool used by core async (and don&apos;t really have a way to prove it right now), could that cause timeout issues, or would it be a problem with the aws service we are hitting? I said above it was an SNS api, but I meant SQS. This issue only happens when we call the DeleteMessage sqs api endpoint."><y>#</y><d>2022-04-27</d><h>16:06</h><w>lispers-anonymous</w>I&apos;m not sure we have any way to tell. There is not much other context to the error. We have other core async work happening, while I don&apos;t believe it&apos;s hogging the thread pool used by core async (and don&apos;t really have a way to prove it right now), could that cause timeout issues, or would it be a problem with the aws service we are hitting?

I said above it was  an SNS api, but I meant SQS. This issue only happens when we call the <code>DeleteMessage</code> sqs api endpoint.</z><z id="t1651076293" t="lispers-anonymous We&apos;re going to try to retry by providing an override for :retriable? when calling (aws/invoke client ...) that checks for the default retry conditions and this specific error."><y>#</y><d>2022-04-27</d><h>16:18</h><w>lispers-anonymous</w>We&apos;re going to try to retry by providing an override for <code>:retriable?</code> when calling <code>(aws/invoke client ...)</code> that checks for the default retry conditions and this specific error.</z><z id="t1651080857" t="lispers-anonymous We&apos;ve been cooking with a retry for a little while now and it seems to have taken care of this issue. Is this something that could be added to the the default https://github.com/cognitect-labs/aws-api/blob/a1c15961b35c1a40a76fe9ab4dddfeafc4474eb1/src/cognitect/aws/retry.clj#L47-L56 [:attrs {:href &quot;/_/_/users/U050ECB92&quot;}] ? If so I can open up a ticket or PR in that repository"><y>#</y><d>2022-04-27</d><h>17:34</h><w>lispers-anonymous</w>We&apos;ve been cooking with a retry for a little while now and it seems to have taken care of this issue. Is this something that could be added to the the default <a href="https://github.com/cognitect-labs/aws-api/blob/a1c15961b35c1a40a76fe9ab4dddfeafc4474eb1/src/cognitect/aws/retry.clj#L47-L56" target="_blank">https://github.com/cognitect-labs/aws-api/blob/a1c15961b35c1a40a76fe9ab4dddfeafc4474eb1/src/cognitect/aws/retry.clj#L47-L56</a> <a>@ghadi</a>? If so I can open up a ticket or PR in that repository</z><z id="t1651080922" t="ghadi an issue would be welcome -- http/connection faults should be classified as one of the retryable anomalies, not the fallthrough &quot;fault&quot;"><y>#</y><d>2022-04-27</d><h>17:35</h><w>ghadi</w>an issue would be welcome -- http/connection faults should be classified as one of the retryable anomalies, not the fallthrough &quot;fault&quot;</z><z id="t1651081042" t="lispers-anonymous Right on. I&apos;ll work on writing up an issue to describe what we&apos;re experiencing and how we solved it. Thanks for your help"><y>#</y><d>2022-04-27</d><h>17:37</h><w>lispers-anonymous</w>Right on. I&apos;ll work on writing up an issue to describe what we&apos;re experiencing and how we solved it. Thanks for your help</z><z id="t1651082292" t="Daniel Jomphe Seeing this today is interesting. We finished the most basic solution for working around intermittent DNS issues with a condition like this: (and (#{::anomalies/not-found} category) (str/includes? (or (-&gt; e ex-data ::anomalies/message) &quot;&quot;) &quot;&quot;)) Said issues only happen on a local dev machine with wired connection to their router. We&apos;re wondering if some other conditions could happen that would make this solution a solid bother. After all, not-found is not part of the set of retryable anomalies provided by Cognitect."><y>#</y><d>2022-04-27</d><h>17:58</h><w>Daniel Jomphe</w>Seeing this today is interesting.
We finished the most basic solution for working around intermittent DNS issues with a condition like this:
<pre>(and (#{::anomalies/not-found} category)
     (str/includes? (or (-&gt; e ex-data ::anomalies/message) &quot;&quot;) &quot;&quot;))</pre>
Said issues only happen on a local dev machine with wired connection to their router.
We&apos;re wondering if some other conditions could happen that would make this solution a solid bother. After all, not-found is not part of the set of retryable anomalies provided by Cognitect.</z><z id="t1651447072" t="grzm Hey, y&apos;all! [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] finally prodded me enough to get my babashka-compatible port of Cognitect&apos;s aws-api into good enough shape that I&apos;m not too terribly embarrassed to release it: https://github.com/grzm/awyeah-api babashka Kick the tires, and let me know how it goes! Aw, yeah!"><y>#</y><d>2022-05-01</d><h>23:17</h><w>grzm</w>Hey, y&apos;all! <a>@borkdude</a> finally prodded me enough to get my babashka-compatible port of Cognitect&apos;s aws-api  into good enough shape that I&apos;m not too terribly embarrassed to release it: <a href="https://github.com/grzm/awyeah-api" target="_blank">https://github.com/grzm/awyeah-api</a> <b>babashka</b> Kick the tires, and let me know how it goes! Aw, yeah!</z><z id="t1651560117" t="orestis So I just discovered that AWS roles have a limit of 10/20 managed policies attached. So I guess that many fine-grained policies is a dead end, and instead I should use fewer coarse-grained policies (or even a single policy file). For example, a single policy that deals with all S3 buckets etc that can be accessed, rather than one-policy-per-bucket. Is that correct or am I missing something?"><y>#</y><d>2022-05-03</d><h>06:41</h><w>orestis</w>So I just discovered that AWS roles have a limit of 10/20 managed policies attached. So I guess that many fine-grained policies is a dead end, and instead I should use fewer coarse-grained policies (or even a single policy file). For example, a single policy that deals with all S3 buckets etc that can be accessed, rather than one-policy-per-bucket. Is that correct or am I missing something?</z><z id="t1651565748" t="Leaf Garland Look at resource based policies? e.g. attach your policies to the buckets, instead of to the identities. "><y>#</y><d>2022-05-03</d><h>08:15</h><r>Leaf Garland</r>Look at resource based policies? e.g. attach your policies to the buckets, instead of to the identities. </z><z id="t1651567817" t="orestis Thanks, I didn&apos;t know those existed. Might solve some (but not all) cases for services that do support them."><y>#</y><d>2022-05-03</d><h>08:50</h><r>orestis</r>Thanks, I didn&apos;t know those existed. Might solve some (but not all) cases for services that do support them.</z><z id="t1651634266" t="Max How do you manage your policies? If you’re using something like terraform, in my experience there’s little benefit to managed policies, since in your tf code there’s not much of a difference between a managed policy and a bunch of inline policies that use the same text that comes out of a single file"><y>#</y><d>2022-05-04</d><h>03:17</h><r>Max</r>How do you manage your policies? If you’re using something like terraform, in my experience there’s little benefit to managed policies, since in your tf code there’s not much of a difference between a managed policy and a bunch of inline policies that use the same text that comes out of a single file</z><z id="t1651641596" t="orestis I practice ClickOps :) Terraform or something like it is on the way some time this year. "><y>#</y><d>2022-05-04</d><h>05:19</h><r>orestis</r>I practice ClickOps :) Terraform or something like it is on the way some time this year. </z><z id="t1651641637" t="orestis AWS managed policies are good because they get updated by AWS as services evolve. We need some of them for eg ElasticBeanstalk. "><y>#</y><d>2022-05-04</d><h>05:20</h><r>orestis</r>AWS managed policies are good because they get updated by AWS as services evolve. We need some of them for eg ElasticBeanstalk. </z><z id="t1651630945" t="Drew Verlee Anyone have an example of creating a public static website using the cognitet aws api? I feel like i&apos;m reinventing the wheel here a bit. Like I think i need to call PutBucketPolicy now to make it available to read?"><y>#</y><d>2022-05-04</d><h>02:22</h><w>Drew Verlee</w>Anyone have an example of creating a public static website using the cognitet aws api? I feel like i&apos;m reinventing the wheel here a bit.

Like I think i need to call PutBucketPolicy now to make it available to read?</z><z id="t1651642408" t="jumar It seems you mean website backed by an s3 bucket, perhaps served via cloudfront? I&apos;d seriously consider using Cloudformation or Terraform for that. You will find numerous examples on the Internet "><y>#</y><d>2022-05-04</d><h>05:33</h><r>jumar</r>It seems you mean website backed by an s3 bucket, perhaps served via cloudfront?

I&apos;d seriously consider using Cloudformation or Terraform for that. You will find numerous examples on the Internet </z><z id="t1651667100" t="Drew Verlee Good idea."><y>#</y><d>2022-05-04</d><h>12:25</h><r>Drew Verlee</r>Good idea.</z><z id="t1651830750" t="kouvas Hi. I am trying to set a filter on an sns subscription but i get the following error message. The doc says :Attributes must be map of sting, string. :Message &quot;Invalid parameter: Attributes Reason: FilterPolicy: \&quot;test\&quot; must be an object or an array at [Source: (String)\&quot;{\&quot;test\&quot;:\&quot;this\&quot;}\&quot;; line: 1, column: 15]&quot;, (aws/invoke aws-client {:op :Subscribe :request {:TopicArn topic :Protocol &quot;sqs&quot; :Endpoint &quot;arn:aws:sqs:eu-west-1:44444:queueue&quot; :ReturnSubscriptionArn true :Attributes {&quot;FilterPolicy&quot; (clojure.data.json/json-str {&quot;test&quot; &quot;this&quot;})}}}) "><y>#</y><d>2022-05-06</d><h>09:52</h><w>kouvas</w>Hi. I am trying to set a filter on an sns subscription but i get the following error message. The doc says :Attributes must be map of sting, string.
<pre>:Message &quot;Invalid parameter: Attributes Reason: FilterPolicy: \&quot;test\&quot; must be an object or an array
                                   at [Source: (String)\&quot;{\&quot;test\&quot;:\&quot;this\&quot;}\&quot;; line: 1, column: 15]&quot;,</pre>
<pre>(aws/invoke aws-client {:op :Subscribe
                          :request {:TopicArn topic
                                    :Protocol &quot;sqs&quot;
                                    :Endpoint &quot;arn:aws:sqs:eu-west-1:44444:queueue&quot;
                                    :ReturnSubscriptionArn true
                                    :Attributes {&quot;FilterPolicy&quot; (clojure.data.json/json-str {&quot;test&quot; &quot;this&quot;})}}})

                   </pre></z><z id="t1651836609" t="jjttjj Haven&apos;t done anything with sns filter policies but based on https://docs.aws.amazon.com/sns/latest/dg/example-filter-policies.html it seems like you need the values in your Json maps to be sequential, representing sets of values you&apos;ll accept. So in your case the Json should be {&quot;test&quot;:[&quot;test&quot;]}"><y>#</y><d>2022-05-06</d><h>11:30</h><r>jjttjj</r>Haven&apos;t done anything with sns filter policies but based on <a href="https://docs.aws.amazon.com/sns/latest/dg/example-filter-policies.html" target="_blank">https://docs.aws.amazon.com/sns/latest/dg/example-filter-policies.html</a> it seems like you need the values in your Json maps to be sequential, representing sets of values you&apos;ll accept. So in your case the Json should be 

<pre>{&quot;test&quot;:[&quot;test&quot;]}</pre></z><z id="t1651841855" t="jjttjj Regarding https://github.com/cognitect-labs/aws-api Assuming things like region/creds are constant throughout my app (and/or use defaults), is it reasonable to do something like: (def get-client (memoize (fn [api] (aws/client {:api api})))) (defn get-object [bucket key] (aws/invoke (get-client :s3) {:op :GetObject :request {:Bucket bucket :Key key}})) or even: (defn invoke [api op-map] (aws/invoke (get-client api) op-map))"><y>#</y><d>2022-05-06</d><h>12:57</h><w>jjttjj</w>Regarding <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a>
Assuming things like region/creds are constant throughout my app (and/or use defaults), is it reasonable to do something like:
<pre>(def get-client (memoize (fn [api] (aws/client {:api api}))))

(defn get-object [bucket key]
  (aws/invoke (get-client :s3)
    {:op      :GetObject
     :request {:Bucket bucket
               :Key    key}}))</pre>
or even:
<pre>(defn invoke [api op-map]
  (aws/invoke (get-client api) op-map))</pre></z><z id="t1651842131" t="ghadi clients can be memoized but I&apos;d always pass them explicitly to functions wrappers like get-object above don&apos;t add value (they&apos;re just taking positional syntax, making a map, then calling invoke) since there&apos;s only one function to invoke clients aws/invoke, such wrappers all have the same shape: form a request, then invoke it. Instead, make functions that simply form the request."><y>#</y><d>2022-05-06</d><h>13:02</h><w>ghadi</w>clients can be memoized but I&apos;d always pass them explicitly to functions

wrappers like <code>get-object</code> above don&apos;t add value (they&apos;re just taking positional syntax, making a map, then calling invoke)

since there&apos;s only one function to invoke clients aws/invoke, such wrappers all have the same shape: form a request, then invoke it.

Instead, make functions that simply form the request.</z><z id="t1651842286" t="jjttjj Just curious, why always explicitly pass the clients?"><y>#</y><d>2022-05-06</d><h>13:04</h><w>jjttjj</w>Just curious, why always explicitly pass the clients?</z><z id="t1651842315" t="ghadi global state sucks"><y>#</y><d>2022-05-06</d><h>13:05</h><w>ghadi</w>global state sucks</z><z id="t1651842332" t="ghadi args &gt; global state"><y>#</y><d>2022-05-06</d><h>13:05</h><w>ghadi</w>args &gt; global state</z><z id="t1651842358" t="jjttjj Oh yeah makes sense 🙂"><y>#</y><d>2022-05-06</d><h>13:05</h><w>jjttjj</w>Oh yeah makes sense <b>🙂</b></z><z id="t1651928690" t="lispers-anonymous Memoize can be not that great if you want to override the default http-client (see this section of the readme: https://github.com/cognitect-labs/aws-api#ops-limit-reached ) and need to shut the client down when it&apos;s not in use. There is no good way to bust a cached value with memoize. We create our clients once and then pass them around where they are needed. No need to worry about stale clients that have been shutdown when we control it&apos;s lifecycle."><y>#</y><d>2022-05-07</d><h>13:04</h><w>lispers-anonymous</w>Memoize can be not that great if you want to override the default http-client (see this section of the readme: <a href="https://github.com/cognitect-labs/aws-api#ops-limit-reached" target="_blank">https://github.com/cognitect-labs/aws-api#ops-limit-reached</a>) and need to shut the client down when it&apos;s not in use. There is no good way to bust a cached value with memoize. We create our clients once and then pass them around where they are needed. No need to worry about stale clients that have been shutdown when we control it&apos;s lifecycle.</z><z id="t1651928786" t="lispers-anonymous That&apos;s a specific example of why global state sucks. I do not trust memoize for managing long lived objects. It has bitten my team pretty hard a couple times now."><y>#</y><d>2022-05-07</d><h>13:06</h><r>lispers-anonymous</r>That&apos;s a specific example of why global state sucks. I do not trust memoize for managing long lived objects. It has bitten my team pretty hard a couple times now.</z><z id="t1652101946" t="jjttjj In aws-api, the docs for client (and invoke as well) say that it takes the option: :retriable? - optional, fn of http-response (see cognitect.aws.http/submit). It seems that the http-reponse it&apos;s referring to should be: https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/http.clj#L29-L36 In practice it seems that the retriable? fn actually takes the fully parsed api client response, not the http response. Is this a typo on the docstring? Or is this just an implementation detail, because the library&apos;s defaults only check for a couple anomalies which would be on an http response map as well as the final parsed response? Should retriable? implementations assume they are receiving an http response map (linked above?). I&apos;m asking because I&apos;ve been thinking about using the retry/backoff mechanism for non-anomalous responses/application level polling. For example, calling ec2&apos;s :DescribeInstances to wait for a particular status change to complete. Is this a bad idea, due to the above (or any other reason)?"><y>#</y><d>2022-05-09</d><h>13:12</h><w>jjttjj</w>In aws-api, the docs for <code>client</code> (and invoke as well) say that it takes the option:
<pre>:retriable? - optional, fn of http-response (see cognitect.aws.http/submit).</pre>
It seems that the <code>http-reponse</code> it&apos;s referring to should be:
<a href="https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/http.clj#L29-L36" target="_blank">https://github.com/cognitect-labs/aws-api/blob/5843c22679f28dd70fa3180e5a2487ebab7eb770/src/cognitect/aws/http.clj#L29-L36</a>

In practice it seems that the <code>retriable?</code> fn actually takes the fully parsed api client response, not the http response.

Is this a typo on the docstring? Or is this just an implementation detail, because the library&apos;s defaults only check for a couple anomalies which would be on an http response map as well as the final parsed response? Should <code>retriable?</code> implementations assume they are receiving an http response map (linked above?).

I&apos;m asking because I&apos;ve been thinking about using the retry/backoff mechanism for non-anomalous responses/application level polling. For example, calling ec2&apos;s <code>:DescribeInstances</code> to wait for a particular status change to complete. Is this a bad idea, due to the above (or any other reason)?</z><z id="t1652120734" t="viesti thinking out loud, depending on what happens after status change, started wondering if you could use https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html (used to be called cloudwatch event rules), to listen for status changes: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/automating_with_eventbridge.html"><y>#</y><d>2022-05-09</d><h>18:25</h><r>viesti</r>thinking out loud, depending on what happens after status change, started wondering if you could use <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" target="_blank">https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html</a> (used to be called cloudwatch event rules), to listen for status changes: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/automating_with_eventbridge.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/automating_with_eventbridge.html</a></z><z id="t1652124645" t="jjttjj Yeah I had considered something like that, but if i want just a notification on my dev machine roughly when an instance is ready, it doesn&apos;t really prevent having to either poll something or set up a lambda or server or something. This actually works pretty good and doesn&apos;t require any more code, assuming retriable? can be relied on to always be passed the actual api result as it is now. {:op :DescribeInstances :request {;;... } :retriable? not-running? :backoff (fn [x] (cond (zero? x) 60000 (&lt; x 20) 5000))}"><y>#</y><d>2022-05-09</d><h>19:30</h><r>jjttjj</r>Yeah I had considered something like that, but if i want just a notification on my dev machine roughly when an instance is ready, it doesn&apos;t really prevent having to either poll something or set up a lambda or server or something.
This actually works pretty good and doesn&apos;t require any more code, assuming <code>retriable?</code> can be relied on to always be passed the actual api result as it is now.
<pre>{:op :DescribeInstances
   :request {;;...
             }
   :retriable? not-running?
   :backoff (fn [x]
              (cond
                (zero? x) 60000
                (&lt; x 20)  5000))}</pre></z><z id="t1652877601" t="Daniel Shriki aws has changed slightly the appconfig service’s rest api for fetching the configuration data - ‘./getConfigurations’ has deprecated, and now there is another mechanism using ‘StartConfigurationSession’ and ‘GetLatestConfiguration’ ( https://docs.aws.amazon.com/appconfig/latest/userguide/appconfig-retrieving-the-configuration.html ) . I’ve tried to use cognitect (it’s the main aws lib I’m using) but when I’m running (aws/ops appconfig) it shows only the deprecated function. does anyone knows an alternative? amazonica does not support this service yet. tnx!"><y>#</y><d>2022-05-18</d><h>12:40</h><w>Daniel Shriki</w>aws has changed slightly the appconfig service’s rest api for fetching the configuration data -  ‘./getConfigurations’ has deprecated, and now there is another mechanism using ‘StartConfigurationSession’ and ‘GetLatestConfiguration’ (<a href="https://docs.aws.amazon.com/appconfig/latest/userguide/appconfig-retrieving-the-configuration.html" target="_blank">https://docs.aws.amazon.com/appconfig/latest/userguide/appconfig-retrieving-the-configuration.html</a>) . I’ve tried to use cognitect (it’s the main aws lib I’m using) but when I’m running <code>(aws/ops appconfig)</code> it shows only the deprecated function. does anyone knows an alternative? amazonica does not support this service yet. tnx!</z><z id="t1652880500" t="ghadi [:attrs {:href &quot;/_/_/users/U032ZPU44KD&quot;}] if it&apos;s a recently added API method, it take only a release of new library bumps after we run the service generators"><y>#</y><d>2022-05-18</d><h>13:28</h><w>ghadi</w><a>@daniels</a> if it&apos;s a recently added API method, it take only a release of new library bumps after we run the service generators</z><z id="t1652880763" t="Alex Miller (Clojure team) they do a new service generator release about once/week (usually on Mondays)"><y>#</y><d>2022-05-18</d><h>13:32</h><w>Alex Miller (Clojure team)</w>they do a new service generator release about once/week (usually on Mondays)</z><z id="t1652882443" t="Daniel Shriki apparently I just wasn’t on the newest endpoint version, and it has been released not long ago 🙂 thanks!"><y>#</y><d>2022-05-18</d><h>14:00</h><w>Daniel Shriki</w>apparently I just wasn’t on the newest endpoint version, and it has been released not long ago <b>🙂</b> thanks!</z><z id="t1653590119" t="Benjamin what is a good auth strategy for team internal tools - for analytics stuff, the users are not coders. I&apos;m not sure yet if I want to serve my tool as a website, or run as desktop app. If it is local I know sso is an option (I&apos;m wondering if there is something easier for the user than sso - it can be complicated with broken credentials files or something). I think there is cognito but I am not sure if it is a fit for like other users on the same aws account."><y>#</y><d>2022-05-26</d><h>18:35</h><w>Benjamin</w>what is a good auth strategy for team internal tools - for analytics stuff, the users are not coders. I&apos;m not sure yet if I want to serve my tool as a website, or run as desktop app. If it is local I know sso is an option (I&apos;m wondering if there is something easier for the user than sso - it can be complicated with broken credentials files or something). I think there is cognito but I am not sure if it is a fit for like other users on the same aws account.</z><z id="t1653592620" t="thomas Cognito users are not AWS users... just users of your service."><y>#</y><d>2022-05-26</d><h>19:17</h><r>thomas</r>Cognito users are not AWS users... just users of your service.</z><z id="t1653592633" t="thomas (in case you didn&apos;t kow that already)"><y>#</y><d>2022-05-26</d><h>19:17</h><r>thomas</r>(in case you  didn&apos;t kow that already)</z><z id="t1653595626" t="lukasz Deploying something like https://github.com/oauth2-proxy/oauth2-proxy is prolly the best, given how much bad stuff I see about Cognito"><y>#</y><d>2022-05-26</d><h>20:07</h><r>lukasz</r>Deploying something like <a href="https://github.com/oauth2-proxy/oauth2-proxy" target="_blank">https://github.com/oauth2-proxy/oauth2-proxy</a> is prolly the best, given how much bad stuff I see about Cognito</z><z id="t1653631646" t="orestis We are using Google workspace so we ended up with Google sign in for internal tools. "><y>#</y><d>2022-05-27</d><h>06:07</h><r>orestis</r>We are using Google workspace so we ended up with Google sign in for internal tools. </z><z id="t1653636764" t="Benjamin thanks for the tips"><y>#</y><d>2022-05-27</d><h>07:32</h><r>Benjamin</r>thanks for the tips</z><z id="t1653717139" t="Martynas M Hey. I have no experience with AWS and currently have my app on Heroku. Why is it so complicated? Is there a basic way to do it? For my development I use docker-compose and I found that I could simply use that to deploy my containers. But even then it&apos;s too overwhelming... what do I even choose...?"><y>#</y><d>2022-05-28</d><h>05:52</h><w>Martynas M</w>Hey. I have no experience with AWS and currently have my app on Heroku.
Why is it so complicated? Is there a basic way to do it?
For my development I use docker-compose and I found that I could simply use that to deploy my containers. But even then it&apos;s too overwhelming... what do I even choose...?</z><z id="t1653720272" t="jumar AWS lightsail is one option to get started. Could you be more specific about what exactly have you tried or looked at ?"><y>#</y><d>2022-05-28</d><h>06:44</h><r>jumar</r>AWS lightsail is one option to get started.
Could you be more specific about what exactly have you tried or looked at ?</z><z id="t1653725406" t="Martynas M What I expect is to somehow spin up a couple of docker containers that would see each other (as in a docker network) and then I&apos;d to route network traffic between all of them but I don&apos;t yet know how it will work. Also instance names, abbreviations, pricing... Thanks, I&apos;ll try to look at lightsail. Maybe they offer to load some containers and could somehow work. I&apos;ll try to watch this vid: https://www.youtube.com/watch?v=6S2brobgmBA"><y>#</y><d>2022-05-28</d><h>08:10</h><r>Martynas M</r>What I expect is to somehow spin up a couple of docker containers that would see each other (as in a docker network) and then I&apos;d to route network traffic between all of them but I don&apos;t yet know how it will work.

Also instance names, abbreviations, pricing...

Thanks, I&apos;ll try to look at lightsail. Maybe they offer to load some containers and could somehow work.

I&apos;ll try to watch this vid: <a href="https://www.youtube.com/watch?v=6S2brobgmBA" target="_blank">https://www.youtube.com/watch?v=6S2brobgmBA</a></z><z id="t1653752582" t="lukasz Yeah, AWS can be used for what you want to do (you&apos;ll need a VPC, ECS cluster with Fargate instances running your apps, all communicating via Application Load Balancer, there&apos;s more to it though), but I&apos;d say that unless you&apos;re building a business or work at one that uses AWS, pick something more suitable for small projects like http://fly.io or https://render.com"><y>#</y><d>2022-05-28</d><h>15:43</h><r>lukasz</r>Yeah, AWS can be used for what you want to do (you&apos;ll need a VPC, ECS cluster with Fargate instances running your apps, all communicating via Application Load Balancer, there&apos;s more to it though), but I&apos;d say that unless you&apos;re building a business or work at one that uses AWS, pick something more suitable for small projects like <a href="http://fly.io" target="_blank">http://fly.io</a> or <a href="https://render.com" target="_blank">https://render.com</a></z><z id="t1653752604" t="lukasz the whole &quot;how do I run a container image in AWS&quot; thing has become a meme of sorts: https://www.lastweekinaws.com/blog/the-17-ways-to-run-containers-on-aws/"><y>#</y><d>2022-05-28</d><h>15:43</h><r>lukasz</r>the whole &quot;how do I run a container image in AWS&quot; thing has become a meme of sorts: <a href="https://www.lastweekinaws.com/blog/the-17-ways-to-run-containers-on-aws/" target="_blank">https://www.lastweekinaws.com/blog/the-17-ways-to-run-containers-on-aws/</a></z><z id="t1653757797" t="Martynas M I spent today mostly researching how to run containers there and Lightsail works similar to as Heroku does but then I&apos;ll need to move away from it into either Kubernetes or Terraform. And in Lightsail I&apos;ll be able to have containers that see each other but then I&apos;d need to deploy each container by hand. And I lean towards using ECS (not sure how yet) with Kubernetes. I don&apos;t yet know what I&apos;ll need to configure but I think that&apos;s the setup that I&apos;ll need. Are there any things that I should consider in favor of Terraform? I had this guide but it seems that it doesn&apos;t actually compare anything: https://phoenixnap.com/kb/terraform-vs-kubernetes It says that TF can deploy across clouds but so does Kubernetes. So it almost seems as it&apos;s comparing two kinds of apples and with Terraform I&apos;d need to bother with running my own node state DB and Kubernetes has its etcd. So I think Kubernetes is simpler here, at least by having less parts that I need to think about. But yes, if I&apos;ll need to migrate across cloud providers then I&apos;ll need to export that etcd data. I think that is too much thinking."><y>#</y><d>2022-05-28</d><h>17:09</h><r>Martynas M</r>I spent today mostly researching how to run containers there and Lightsail works similar to as Heroku does but then I&apos;ll need to move away from it into either Kubernetes or Terraform. And in Lightsail I&apos;ll be able to have containers that see each other but then I&apos;d need to deploy each container by hand. And I lean towards using ECS (not sure how yet) with Kubernetes. I don&apos;t yet know what I&apos;ll need to configure but I think that&apos;s the setup that I&apos;ll need.
Are there any things that I should consider in favor of Terraform? I had this guide but it seems that it doesn&apos;t actually compare anything: <a href="https://phoenixnap.com/kb/terraform-vs-kubernetes" target="_blank">https://phoenixnap.com/kb/terraform-vs-kubernetes</a>
It says that TF can deploy across clouds but so does Kubernetes. So it almost seems as it&apos;s comparing two kinds of apples and with Terraform I&apos;d need to bother with running my own node state DB and Kubernetes has its etcd. So I think Kubernetes is simpler here, at least by having less parts that I need to think about.
But yes, if I&apos;ll need to migrate across cloud providers then I&apos;ll need to export that etcd data. I think that is too much thinking.</z><z id="t1653758023" t="lukasz Terraform and Kubernetes are two different things - one is a generic tool for managing cloud infrastructure, the second is a container orchestrator that happens to be able to manage cloud infrastructure"><y>#</y><d>2022-05-28</d><h>17:13</h><r>lukasz</r>Terraform and Kubernetes are two different things - one is a generic tool for managing cloud infrastructure, the second is a container orchestrator that happens to be able to manage cloud infrastructure</z><z id="t1653758277" t="lukasz I&apos;d go with Terraform and use free Terraform Cloud for state storage, forget about K8S and use AWS services like ECS and Fargate (and VPC and IAM and ALB and Security Groups and CloudWatch and whatever data stores you have to use). Very unlikely you&apos;ll be moving clouds (says the guy how migrated a system from AWS -&gt; GCP -&gt; AWS 🤷 ) and the perceived lock-in and working around it are a bit of a straw man: yes you can use K8S everywhere but that&apos;s about it: networking, IAM and APIs work differently across clouds so you&apos;ll have to learn things anyway, there&apos;s no &quot;lift and shift&quot; strategy once you reach a certain level of complexity. My 2 cents of course"><y>#</y><d>2022-05-28</d><h>17:17</h><r>lukasz</r>I&apos;d go with Terraform and use free  Terraform Cloud for state storage, forget about K8S and use AWS services like ECS and Fargate (and VPC and IAM and ALB and Security Groups and CloudWatch and whatever data stores you have to use).
 Very unlikely you&apos;ll be moving clouds (says the guy how migrated a system from AWS -&gt; GCP -&gt; AWS  <b>🤷</b>) and the perceived lock-in and working around it are a bit of a straw man: yes you can use K8S everywhere but that&apos;s about it: networking, IAM and APIs work differently across clouds so you&apos;ll have to learn things anyway, there&apos;s no &quot;lift and shift&quot; strategy once you reach a certain level of complexity. My 2 cents of course</z><z id="t1653758348" t="Martynas M Can you add to pros and cons of Kubernetes and Terraform? I&apos;m not yet sure how to compare them. What I expect from it is that I&apos;ll have a stateful (maybe several-node Raft) cluster and maybe be able to even replicate it in the future. If I understand correctly in K8S I could do it with pods as each pod would be a small &quot;printable&quot; cluster. Because I won&apos;t be able to scale horizontally by simply adding more nodes. I&apos;ll have a stateful node and it will be more complicated."><y>#</y><d>2022-05-28</d><h>17:19</h><r>Martynas M</r>Can you add to pros and cons of Kubernetes and Terraform? I&apos;m not yet sure how to compare them.
What I expect from it is that I&apos;ll have a stateful (maybe several-node Raft) cluster and maybe be able to even replicate it in the future.
If I understand correctly in K8S I could do it with pods as each pod would be a small &quot;printable&quot; cluster. Because I won&apos;t be able to scale horizontally by simply adding more nodes. I&apos;ll have a stateful node and it will be more complicated.</z><z id="t1653758521" t="lukasz I never used Kubernetes in anger but played with it every now and then. I have operational experience of running things on ECS (with Fargate too) and from how things work - you still need to orchestrate some resources with Terraform to get a functional cluster, so at this point why bother with having two systems managing different parts. It just adds complextity, with Terraform you can define everything including your services and tasks in one place, and let AWS take care of the rest. You really don&apos;t want to run K8S yourself unless it&apos;s a learning/hobby project, otherwise - just leverage managed services as much as possible and save yourself some time"><y>#</y><d>2022-05-28</d><h>17:22</h><r>lukasz</r>I never used Kubernetes in anger but played with it every now and then. I have operational experience of running things on ECS (with Fargate too) and from how things work - you still need to orchestrate some resources with Terraform to get a functional cluster, so at this point why bother with having two systems managing different parts. It just adds complextity, with Terraform you can define everything including your services and tasks in one place, and let AWS take care of the rest.
You really don&apos;t want to run K8S yourself unless it&apos;s a learning/hobby project, otherwise - just leverage managed services as much as possible and save yourself some time</z><z id="t1653758681" t="Martynas M Oh, so then I misunderstood how ECS works. Because I thought that ECS would basically give me a Kubernetes cluster where I could simply deploy directly from kubectl. I thought that it was that basic. Some of the tutorials were using aws ECS directly and others were using minikube which is a local single-node kubernetes install. So that&apos;s what I wanted - try it out locally and then run it on the real thing."><y>#</y><d>2022-05-28</d><h>17:24</h><r>Martynas M</r>Oh, so then I misunderstood how ECS works. Because I thought that ECS would basically give me a Kubernetes cluster where I could simply deploy directly from kubectl. I thought that it was that basic. Some of the tutorials were using aws ECS directly and others were using minikube which is a local single-node kubernetes install.
So that&apos;s what I wanted - try it out locally and then run it on the real thing.</z><z id="t1653758721" t="lukasz ah I see the confusion"><y>#</y><d>2022-05-28</d><h>17:25</h><r>lukasz</r>ah I see the confusion</z><z id="t1653758728" t="lukasz ECS and EKS are different services, that do the same thing"><y>#</y><d>2022-05-28</d><h>17:25</h><r>lukasz</r>ECS and EKS are different services, that do the same thing</z><z id="t1653758833" t="lukasz ECS: managed container orchestrator from AWS, done their way (predates K8S if I remember correctly) EKS: managed K8S offered by AWS: you get the control plane and whatever else it needs Then you have the nodes that actually run your container instances - that can be EC2 or Fargate, you can use either compute types with either ECS or EKS. All of that needs to be created and managed somehow, this is where Terraform comes into play. Or you setup stuff in the AWS console 😉"><y>#</y><d>2022-05-28</d><h>17:27</h><r>lukasz</r>ECS: managed container orchestrator from AWS, done their way (predates K8S if I remember correctly)
EKS: managed K8S offered by AWS: you get the control plane and whatever else it needs

Then you have the nodes that actually run your container instances - that can be EC2 or Fargate, you can use either compute types with either ECS or EKS. All of that needs to be created and managed somehow, this is where Terraform comes into play. Or you setup stuff in the AWS console <b>😉</b></z><z id="t1653759274" t="Martynas M Yeah, I found one vid too: https://www.youtube.com/watch?v=p6xDCz00TxU So why is Terraform going to be easier? Because I saw in one tutorial about Kubernetes that I can rollback to a previous service or it can even rollback by itself if something fails. And this comparison says that there is no rollback in Terraform: https://phoenixnap.com/kb/terraform-vs-kubernetes &gt; No rollback - if the need arises, the user must destroy the managed object and re-apply it. This is kind of bad because if my nodes are stateful yes, I&apos;ll have my state in my &quot;colder&quot; storage and some in MQ but it&apos;s not an instant reboot. I can&apos;t do an immediate reboot (also I&apos;m lazy to do graalvm). So this means that with Terraform it can get unpredictable. If I understand correctly Terraform is focused more on the preparation of the machines themselves (VM, hypervisor things and so on). But if I use EKS instead then I won&apos;t need to bother about machine types. Is that correct?"><y>#</y><d>2022-05-28</d><h>17:34</h><r>Martynas M</r>Yeah, I found one vid too: <a href="https://www.youtube.com/watch?v=p6xDCz00TxU" target="_blank">https://www.youtube.com/watch?v=p6xDCz00TxU</a>
So why is Terraform going to be easier? Because I saw in one tutorial about Kubernetes that I can rollback to a previous service or it can even rollback by itself if something fails. And this comparison says that there is no rollback in Terraform: <a href="https://phoenixnap.com/kb/terraform-vs-kubernetes" target="_blank">https://phoenixnap.com/kb/terraform-vs-kubernetes</a>
&gt;  No rollback - if the need arises, the user must destroy the managed object and re-apply it.
This is kind of bad because if my nodes are stateful yes, I&apos;ll have my state in my &quot;colder&quot; storage and some in MQ but it&apos;s not an instant reboot. I can&apos;t do an immediate reboot (also I&apos;m lazy to do graalvm). So this means that with Terraform it can get unpredictable.
If I understand correctly Terraform is focused more on the preparation of the machines themselves (VM, hypervisor things and so on).

But if I use EKS instead then I won&apos;t need to bother about machine types. Is that correct?</z><z id="t1653759380" t="lukasz No, Terraform doesn&apos;t prepare anything for you - that&apos;s a job for Packer. I suggest reading about the tools themselves directly from the source, not comparison articles: https://www.terraform.io/intro You can rollback changes with ECS just fine, it only depends on how you manage your container images and their tags, nothing to do with Terraform per-se."><y>#</y><d>2022-05-28</d><h>17:36</h><r>lukasz</r>No, Terraform doesn&apos;t prepare anything for you - that&apos;s a job for Packer. I suggest reading about the tools themselves directly from the source, not comparison articles: <a href="https://www.terraform.io/intro" target="_blank">https://www.terraform.io/intro</a>

You can rollback changes with ECS just fine, it only depends on how you manage your container images and their tags, nothing to do with Terraform per-se.</z><z id="t1653760611" t="Martynas M What I didn&apos;t think about was that I&apos;ll need to choose a database and set up that by hand in the GUI. And then I&apos;ll forget what I configured. That I may not be able to do in Kubernetes or then I&apos;ll need to deploy my own DB and handle it myself. That would actually be bad. So would this be the main difference?"><y>#</y><d>2022-05-28</d><h>17:56</h><r>Martynas M</r>What I didn&apos;t think about was that I&apos;ll need to choose a database and set up that by hand in the GUI. And then I&apos;ll forget what I configured. That I may not be able to do in Kubernetes or then I&apos;ll need to deploy my own DB and handle it myself. That would actually be bad.
So would this be the main difference?</z><z id="t1653760740" t="lukasz That&apos;s my point: with Terraform you can set up all of that, using infrastructure as code, no manual setup (as in: in AWS console) required. Not sure if K8S can manage AWS resources (it probably can, given how extensible it is)"><y>#</y><d>2022-05-28</d><h>17:59</h><r>lukasz</r>That&apos;s my point: with Terraform you can set up all of that, using infrastructure as code, no manual setup (as in: in AWS console) required. Not sure if K8S can manage AWS resources (it probably can, given how extensible it is)</z><z id="t1653831817" t="Martynas M Is it possible to create a terraform config for aws and run it locally as if it would be a dev topology? I like how I can do it with docker-compose and I wanted this kind of workflow. Is there a way? Or is it then coupled to AWS? Edit: Not possible. https://stackoverflow.com/questions/39211000/experimenting-locally-with-terraform"><y>#</y><d>2022-05-29</d><h>13:43</h><r>Martynas M</r>Is it possible to create a terraform config for aws and run it locally as if it would be a dev topology?
I like how I can do it with docker-compose and I wanted this kind of workflow. Is there a way?
Or is it then coupled to AWS?
Edit: Not possible. <a href="https://stackoverflow.com/questions/39211000/experimenting-locally-with-terraform" target="_blank">https://stackoverflow.com/questions/39211000/experimenting-locally-with-terraform</a></z><z id="t1653837387" t="lukasz No, that&apos;s not possible - you can open an account and use the free tier, but you&apos;ll be eventually charged. Even Terraform&apos;s own tests assume that and incur cost. AWS might be giving some educational credits but I know next to nothing about this"><y>#</y><d>2022-05-29</d><h>15:16</h><r>lukasz</r>No, that&apos;s not possible - you can open an account and use the free tier, but you&apos;ll be eventually charged. Even Terraform&apos;s own tests assume that and incur cost. AWS might be giving some educational credits but I know next to nothing about this</z><z id="t1653841255" t="Martynas M Alright. Well that&apos;s probably fine."><y>#</y><d>2022-05-29</d><h>16:20</h><r>Martynas M</r>Alright. Well that&apos;s probably fine.</z><z id="t1654347955" t="Martynas M Hey. My friend told me that he had a problem when he was upgrading his AWS RDS DB using terraform. He said he experienced 10 minutes of downtime. I think he was upgrading between major versions. How do I write my terraform config so that this wouldn&apos;t happen?"><y>#</y><d>2022-06-04</d><h>13:05</h><w>Martynas M</w>Hey.
My friend told me that he had a problem when he was upgrading his AWS RDS DB using terraform.
He said he experienced 10 minutes of downtime. I think he was upgrading between major versions.
How do I write my terraform config so that this wouldn&apos;t happen?</z><z id="t1654348076" t="apiology The output of terraform plan will tell you what it plans to change. Consult with the AWS documentation to find out what the implications are for those changes."><y>#</y><d>2022-06-04</d><h>13:07</h><r>apiology</r>The output of <code>terraform plan</code> will tell you what it plans to change.  Consult with the AWS documentation to find out what the implications are for those changes.</z><z id="t1654348156" t="apiology Your friend was lucky if they weren’t doing that already - some seemingly simple changes require deleting and recreating resources in AWS, including databases!"><y>#</y><d>2022-06-04</d><h>13:09</h><r>apiology</r>Your friend was lucky if they weren’t doing that already - some seemingly simple changes require deleting and recreating resources in AWS, including databases!</z><z id="t1654348300" t="Martynas M I think he caused prod to go down for 10 minutes. I didn&apos;t yet write a single line of terraform as I&apos;m afraid of the options. 😄 😅"><y>#</y><d>2022-06-04</d><h>13:11</h><r>Martynas M</r>I think he caused prod to go down for 10 minutes.
I didn&apos;t yet write a single line of terraform as I&apos;m afraid of the options. <b>😄</b> <b>😅</b></z><z id="t1654348420" t="apiology Some things in AWS require downtime - I’m not sure what those are for RDS, and it may depend on the database, but I wouldn’t be surprised if resizing is one of them. Others can’t be done directly and require deletion and recreation - for some resources, name changes are like that. Your little PR going from kabob-case to snake-case in identifiers can get a little scary!"><y>#</y><d>2022-06-04</d><h>13:13</h><r>apiology</r>Some things in AWS require downtime - I’m not sure what those are for RDS, and it may depend on the database, but I wouldn’t be surprised if resizing is one of them.

Others can’t be done directly and require deletion and recreation - for some resources, name changes are like that.  Your little PR going from kabob-case to snake-case in identifiers can get a little scary!</z><z id="t1654348460" t="Martynas M What does it mean to recreating resources in AWS, including databases ? Does it drop the instance or does it drop the storage too? So if it will recreate a DB then will it irrecoverably delete the contents and won&apos;t restore?"><y>#</y><d>2022-06-04</d><h>13:14</h><r>Martynas M</r>What does it mean to <code>recreating resources in AWS, including databases</code>?
Does it drop the instance or does it drop the storage too? So if it will recreate a DB then will it irrecoverably delete the contents and won&apos;t restore?</z><z id="t1654348498" t="apiology Up to and including deleting data."><y>#</y><d>2022-06-04</d><h>13:14</h><r>apiology</r>Up to and including deleting data.</z><z id="t1654348523" t="apiology It’s on you to understand the terraform plan, and cross check with AWS docs."><y>#</y><d>2022-06-04</d><h>13:15</h><r>apiology</r>It’s on you to understand the terraform plan, and cross check with AWS docs.</z><z id="t1654348678" t="apiology Terraform gives you great power, and the https://en.wikipedia.org/wiki/With_great_power_comes_great_responsibility applies."><y>#</y><d>2022-06-04</d><h>13:17</h><r>apiology</r>Terraform gives you great power, and the <a href="https://en.wikipedia.org/wiki/With_great_power_comes_great_responsibility" target="_blank">https://en.wikipedia.org/wiki/With_great_power_comes_great_responsibility</a> applies.</z><z id="t1654348803" t="Martynas M I think that my friend said this: &quot;well, you could use terraform with CI-CD stuff&quot;. And in my opinion the deletion may mean that you probably wouldn&apos;t want to use it with CI-CD for more than execution where you looked up through the plan beforehand :thinking_face:"><y>#</y><d>2022-06-04</d><h>13:20</h><r>Martynas M</r>I think that my friend said this: &quot;well, you could use terraform with CI-CD stuff&quot;.
And in my opinion the deletion may mean that you probably wouldn&apos;t want to use it with CI-CD for more than execution where you looked up through the plan beforehand <b>:thinking_face:</b></z><z id="t1654348827" t="apiology Yeah, you’d absolutely want a human in the loop for review there."><y>#</y><d>2022-06-04</d><h>13:20</h><r>apiology</r>Yeah, you’d absolutely want a human in the loop for review there.</z><z id="t1654348877" t="apiology Usually the CI/CD aspect is there to separate out the roles of writing the terraform from reviewing the plan, and to keep the high-power credentials used to apply the plans out of grubby human hands."><y>#</y><d>2022-06-04</d><h>13:21</h><r>apiology</r>Usually the CI/CD aspect is there to separate out the roles of writing the terraform from reviewing the plan, and to keep the high-power credentials used to apply the plans out of grubby human hands.</z><z id="t1654361787" t="orestis Updating RDS always has downtime, even without terraform. Major versions take 10-30 minutes, minor versions are quicker."><y>#</y><d>2022-06-04</d><h>16:56</h><r>orestis</r>Updating RDS always has downtime, even without terraform. Major versions take 10-30 minutes, minor versions are quicker.</z><z id="t1654553779" t="Drew Verlee Who do you follow for aws content? Preferably video. I&apos;m not looking for something specific, just people who are clear and entertaining."><y>#</y><d>2022-06-06</d><h>22:16</h><w>Drew Verlee</w>Who do you follow for aws content? Preferably video. I&apos;m not looking for something specific, just people who are clear and entertaining.</z><z id="t1654554708" t="kenny Corey Quinn "><y>#</y><d>2022-06-06</d><h>22:31</h><r>kenny</r>Corey Quinn </z><z id="t1654867990" t="Martynas M I have a question about Terraform on AWS. Do I need to do this: https://awsmag.com/how-to-create-a-vpc-using-terraform/ I.e. Do I need to do this every time I want to deploy some kind of thing or is there a simpler way? It&apos;s great that I get so much control about the subnets and so on. But I&apos;m not sure how much I actually need yet. i.e. I don&apos;t ask about VPC because I probably need it for every different deployment. But what&apos;s odd is that there is so much stuff in this config. Because the more there is the more can go wrong."><y>#</y><d>2022-06-10</d><h>13:33</h><w>Martynas M</w>I have a question about Terraform on AWS.

Do I need to do this: <a href="https://awsmag.com/how-to-create-a-vpc-using-terraform/" target="_blank">https://awsmag.com/how-to-create-a-vpc-using-terraform/</a>
I.e. Do I need to do this every time I want to deploy some kind of thing or is there a simpler way? It&apos;s great that I get so much control about the subnets and so on. But I&apos;m not sure how much I actually need yet.

i.e. I don&apos;t ask about VPC because I probably need it for every different deployment. But what&apos;s odd is that there is so much stuff in this config. Because the more there is the more can go wrong.</z><z id="t1654869843" t="viesti usually the network structure is created once and then used as the ground for everything else, e.g. databases in private subnets, webapp backends and the load balancers in the dmz (public subnet). You can also attach Lambdas to VPCs so you can use Lambdas as glue in private subnets. Anything that should not be directly reachable from the public Internet should be in private subnets. Depending on the system you are building, there can be more network segments, to limit blast radius etc. I guess it comes down to what is the context and what one is doing. If say DynamoDB is enough, then you can do with VPCs and go towards more serverless. VPC just allows one to do networking as you would do in a physical office, with routers and firewalls and segmented networks. Just that all that is virtualized :)"><y>#</y><d>2022-06-10</d><h>14:04</h><r>viesti</r>usually the network structure is created once and then used as the ground for everything else, e.g. databases in private subnets, webapp backends and the load balancers in the dmz (public subnet). You can also attach Lambdas to VPCs so you can use Lambdas as glue in private subnets. Anything that should not be directly reachable from the public Internet should be in private subnets. Depending on the system you are building, there can be more network segments, to limit blast radius etc. 

I guess it comes down to what is the context and what one is doing. If say DynamoDB is enough, then you can do with VPCs and go towards more serverless. VPC just allows one to do networking as you would do in a physical office, with routers and firewalls and segmented networks. Just that all that is virtualized :)</z><z id="t1654870270" t="viesti but yeah, I know it&apos;s a lot to chew, if building a webapp with a database and networking is not familiar, there are a lot of knobs, but I think that the Terraform in the blog post could be simpler, and probably there are posts from aws that document best practices (yeah, I know I should link to them, bad excuse not having time now to look)"><y>#</y><d>2022-06-10</d><h>14:11</h><r>viesti</r>but yeah, I know it&apos;s a lot to chew, if building a webapp with a database and networking is not familiar, there are a lot of knobs, but I think that the Terraform in the blog post could be simpler, and probably there are posts from aws that document best practices (yeah, I know I should link to them, bad excuse not having time now to look)</z><z id="t1654870892" t="Martynas M I know the subnets and all the things. But I thought that it&apos;s too much to have Elastic IP. But then I may actually need an IP... but then how do I assign different hosts to different ports... Or then multiple IPs... oh my oh my..."><y>#</y><d>2022-06-10</d><h>14:21</h><r>Martynas M</r>I know the subnets and all the things. But I thought that it&apos;s too much to have Elastic IP. But then I may actually need an IP... but then how do I assign different hosts to different ports... Or then multiple IPs... oh my oh my...</z><z id="t1654877700" t="lukasz Yeah, AWS is not digital ocean, it&apos;s a data center as a service so you&apos;ll have to figure out things like networking, managed services and what not. Or use Lightsail (?) which I believe does all of this for you, or https://github.com/aws/copilot-cli"><y>#</y><d>2022-06-10</d><h>16:15</h><r>lukasz</r>Yeah, AWS is not digital ocean, it&apos;s a data center as a service so you&apos;ll have to figure out things like networking, managed services and what not. Or use Lightsail (?) which I believe does all of this for you, or <a href="https://github.com/aws/copilot-cli" target="_blank">https://github.com/aws/copilot-cli</a></z><z id="t1654878391" t="viesti I guess the thing is that is there a path onwards to a data center, if you need one :) Lightsail might be easier in at least keeping the data center complexity away more, IIRC it allows to connect to a VPC too. Copilot probably interesting too, IIRC it makes a sane VPC setup with private/public subnet, so you might turn that into more datacenterish if needed."><y>#</y><d>2022-06-10</d><h>16:26</h><r>viesti</r>I guess the thing is that is there a path onwards to a data center, if you need one :) Lightsail might be easier in at least keeping the data center complexity away more, IIRC it allows to connect to a VPC too. Copilot probably interesting too, IIRC it makes a sane VPC setup with private/public subnet, so you might turn that into more datacenterish if needed.</z><z id="t1654904753" t="Max Glancing at that article a little, I’m not sure I’d trust everything it says. It makes liberal and unnecessary use of depends_on , which is generally an antipattern. Not knowing that you should let terraform manage your resource dependencies for you is a little bit of a red flag. I didn’t read the article in enough detail to see how legit the rest was, but I wanted to flag this for y’all to be cautious."><y>#</y><d>2022-06-10</d><h>23:45</h><r>Max</r>Glancing at that article a little, I’m not sure I’d trust everything it says. It makes liberal and unnecessary use of <code>depends_on</code>, which is generally an antipattern. Not knowing that you should let terraform manage your resource dependencies for you is a little bit of a red flag.

I didn’t read the article in enough detail to see how legit the rest was, but I wanted to flag this for y’all to be cautious.</z><z id="t1654922647" t="Martynas M Who knows if they look for good and bad patterns in their examples. After all the original webpage containing tutorial is which means that they aren&apos;t really concerned with offering alternatives and preventing lock-in. I think the person that wrote this is paid not for maintaining these examples but for producing them. And it may have been OK at the time of writing (2021): https://github.com/awsmag/aws-vpc-terraform/commits/master It could mean that the tutorial is outdated. Not sure."><y>#</y><d>2022-06-11</d><h>04:44</h><r>Martynas M</r>Who knows if they look for good and bad patterns in their examples. After all the original webpage containing tutorial is <code></code> which means that they aren&apos;t really concerned with offering alternatives and preventing lock-in.

I think the person that wrote this is paid not for maintaining these examples but for producing them. And it may have been OK at the time of writing (2021): <a href="https://github.com/awsmag/aws-vpc-terraform/commits/master" target="_blank">https://github.com/awsmag/aws-vpc-terraform/commits/master</a>

It could mean that the tutorial is outdated. Not sure.</z><z id="t1654923081" t="Martynas M depends_on: https://technotrampoline.com/articles/how-does-terraform-depends-on-work/"><y>#</y><d>2022-06-11</d><h>04:51</h><r>Martynas M</r>depends_on:
<a href="https://technotrampoline.com/articles/how-does-terraform-depends-on-work/" target="_blank">https://technotrampoline.com/articles/how-does-terraform-depends-on-work/</a></z><z id="t1654904850" t="Max I’m a bit of a networking dummy, but if you want to have a 3-tier VPC setup (internet &lt;--&gt; public subnet &lt;--&gt; private subnet &lt;--&gt; data subnet), is the only way to restrict traffic between, say, the public and data subnets via NACLs? Is there no way to do it via route tables?"><y>#</y><d>2022-06-10</d><h>23:47</h><w>Max</w>I’m a bit of a networking dummy, but if you want to have a 3-tier VPC setup (internet &lt;--&gt; public subnet &lt;--&gt; private subnet &lt;--&gt; data subnet), is the only way to restrict traffic between, say, the public and data subnets via NACLs? Is there no way to do it via route tables?</z><z id="t1654924406" t="Martynas M This tutorial and diagram shows that there is a NAT component between networks: https://awsmag.com/how-to-create-a-vpc-using-terraform/ So what this means is that you would have two different subnets (networks with different addr ranges) and NAT router would translate between them. So for instance you could have subnets 192.168.1.0/24 and 10.0.0.0/24. And then IMO the NAT router would convert between them. At least in theory. I don&apos;t know how it will work in that example and on AWS. When you have internet at home this is what your ISP does for you. They have a router (not the one that you have in your home) that takes your packets and routes them to your cable. And then your local box (let&apos;s not call it a router (it&apos;s a dumbed down version of a router that does much of other stuff too)) does the NAT translation into your local subnet (which probably is 192.168.1.0/24 and can have 255 hosts (including your modem box)). I have no idea."><y>#</y><d>2022-06-11</d><h>05:13</h><r>Martynas M</r>This tutorial and diagram shows that there is a NAT component between networks:
<a href="https://awsmag.com/how-to-create-a-vpc-using-terraform/" target="_blank">https://awsmag.com/how-to-create-a-vpc-using-terraform/</a>

So what this means is that you would have two different subnets (networks with different addr ranges) and NAT router would translate between them.
So for instance you could have subnets 192.168.1.0/24 and 10.0.0.0/24. And then IMO the NAT router would convert between them. At least in theory. I don&apos;t know how it will work in that example and on AWS.

When you have internet at home this is what your ISP does for you. They have a router (not the one that you have in your home) that takes your packets and routes them to your cable. And then your local box (let&apos;s not call it a router (it&apos;s a dumbed down version of a router that does much of other stuff too)) does the NAT translation into your local subnet (which probably is 192.168.1.0/24 and can have 255 hosts (including your modem box)).

I have no idea.</z><z id="t1654926009" t="Martynas M If I use terraform and I want to do rolling update of my container (no downtime). Should I use this monstrosity (tutorial shows cloud formation but I also have found one for kubernetes some time ago): https://github.com/souzaxx/Rolling-Update-Terraform/blob/master/main.tf#L18 This is the source but it contains too many stupid memes: https://dev.to/souzaxx/rolling-update-ec2-with-terraform-13bf Yes, I understand that I can&apos;t restart my instances one by one directly from terraform. But then is there a better way than to inline a bunch of configs? For instance this tutorial says that I can use create_before_destroy : https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c But then what if my container doesn&apos;t start immediately? What if it starts after... 1 minute...? This second tutorial also has Load balancer health check that&apos;s based on ELB. Will it make it so that there won&apos;t be downtime if I would configure it correctly? Or does it mean that I should use CF or ECS/EKS to handle my rolling upgrade? I also want to use Docker and not learn Ansible."><y>#</y><d>2022-06-11</d><h>05:40</h><w>Martynas M</w>If I use terraform and I want to do rolling update of my container (no downtime). Should I use this monstrosity (tutorial shows cloud formation but I also have found one for kubernetes some time ago): <a href="https://github.com/souzaxx/Rolling-Update-Terraform/blob/master/main.tf#L18" target="_blank">https://github.com/souzaxx/Rolling-Update-Terraform/blob/master/main.tf#L18</a>

This is the source but it contains too many stupid memes: <a href="https://dev.to/souzaxx/rolling-update-ec2-with-terraform-13bf" target="_blank">https://dev.to/souzaxx/rolling-update-ec2-with-terraform-13bf</a>

Yes, I understand that I can&apos;t restart my instances one by one directly from terraform. But then is there a better way than to inline a bunch of configs?

For instance this tutorial says that I can use <code>create_before_destroy</code>: <a href="https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c" target="_blank">https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c</a>
But then what if my container doesn&apos;t start immediately? What if it starts after... 1 minute...?

This second tutorial also has Load balancer health check that&apos;s based on ELB. Will it make it so that there won&apos;t be downtime if I would configure it correctly?
Or does it mean that I should use CF or ECS/EKS to handle my rolling upgrade? I also want to use Docker and not learn Ansible.</z><z id="t1654953987" t="Max I&apos;ve never managed instances directly from terraform. I always manage an auto scaling group and let it manage instances instead. Then you can use all the baked in update strategies, and if all else fails, kill them and let them respawn one by one yourself"><y>#</y><d>2022-06-11</d><h>13:26</h><r>Max</r>I&apos;ve never managed instances directly from terraform. I always manage an auto scaling group and let it manage instances instead. Then you can use all the baked in update strategies, and if all else fails, kill them and let them respawn one by one yourself</z><z id="t1654954097" t="Martynas M I found that I can specify the scaling group from terraform and do rolling deployment. The guide said that it will recreate the scaling group but I&apos;m neither sure what it means nor the guide said that it will destroy running instances. Probably it matters when it fails to deploy and then the currently running instances shouldn&apos;t drain. Source: https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c"><y>#</y><d>2022-06-11</d><h>13:28</h><r>Martynas M</r>I found that I can specify the scaling group from terraform and do rolling deployment. The guide said that it will recreate the scaling group but I&apos;m neither sure what it means nor the guide said that it will destroy running instances.
Probably it matters when it fails to deploy and then the currently running instances shouldn&apos;t drain.
Source: <a href="https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c" target="_blank">https://medium.com/inspiredbrilliance/rolling-deployment-with-terraform-on-aws-6a0d1587c82c</a></z><z id="t1654954317" t="Max It depends whether the symbol in the plan is ~ or +/-. +/- means it&apos;ll destroy and recreate the ASG and all its instances, if this happens, make sure you haven&apos;t messed up your tf change. ~ means you&apos;re changing the group configuration in place, instances will get the updated config when they are replaced, which happens either when you kick them or die for any other reason"><y>#</y><d>2022-06-11</d><h>13:31</h><r>Max</r>It depends whether the symbol in the plan is ~ or +/-. +/- means it&apos;ll destroy and recreate the ASG and all its instances, if this happens, make sure you haven&apos;t messed up your tf change. ~ means you&apos;re changing the group configuration in place, instances will get the updated config when they are replaced, which happens either when you kick them or die for any other reason</z><z id="t1654954346" t="Martynas M create_before_destroy = true is this what your symbol means?"><y>#</y><d>2022-06-11</d><h>13:32</h><r>Martynas M</r><code>create_before_destroy = true</code> is this what your symbol means?</z><z id="t1654954477" t="Max Another way to do it if your ASG is behind a load balancer is to create a whole new ASG, let it fill up, then tear down the old one. I think that&apos;s Netflix&apos;s model"><y>#</y><d>2022-06-11</d><h>13:34</h><r>Max</r>Another way to do it if your ASG is behind a load balancer is to create a whole new ASG, let it fill up, then tear down the old one. I think that&apos;s Netflix&apos;s model</z><z id="t1654954531" t="Max In general I prefer not to manage deployments in terraform. I only manage the stuff that doesn&apos;t change and manage deployments from somewhere else"><y>#</y><d>2022-06-11</d><h>13:35</h><r>Max</r>In general I prefer not to manage deployments in terraform. I only manage the stuff that doesn&apos;t change and manage deployments from somewhere else</z><z id="t1654954541" t="Martynas M So probably this example is what you told about Netflix&apos;s model: https://robmorgan.id.au/posts/rolling-deploys-on-aws-using-terraform/ &gt; We set the waitfor_elb_capacity_ attribute of the auto scaling group, so Terraform does not prematurely terminate the current auto scaling group. Is this what you meant?"><y>#</y><d>2022-06-11</d><h>13:35</h><r>Martynas M</r>So probably this example is what you told about Netflix&apos;s model:
<a href="https://robmorgan.id.au/posts/rolling-deploys-on-aws-using-terraform/" target="_blank">https://robmorgan.id.au/posts/rolling-deploys-on-aws-using-terraform/</a>

&gt; We set the waitfor_elb_capacity_ attribute of the auto scaling group, so Terraform does not prematurely terminate the current auto scaling group.
Is this what you meant?</z><z id="t1654954597" t="Max Right but that uses terraform to orchestrate the deploy which I would not do"><y>#</y><d>2022-06-11</d><h>13:36</h><r>Max</r>Right but that uses terraform to orchestrate the deploy which I would not do</z><z id="t1654954626" t="Max I&apos;d manage it from a script or codedeploy or something else, and only terraform the stuff that doesn&apos;t change"><y>#</y><d>2022-06-11</d><h>13:37</h><r>Max</r>I&apos;d manage it from a script or codedeploy or something else, and only terraform the stuff that doesn&apos;t change</z><z id="t1654954684" t="Max I know some people use terraform to do that but I feel like it goes against the grain with terraform’s declarative approach "><y>#</y><d>2022-06-11</d><h>13:38</h><r>Max</r>I know some people use terraform to do that but I feel like it goes against the grain with terraform’s declarative approach </z><z id="t1654954882" t="Martynas M I don&apos;t yet know what I want. For me less tools and less config is currently better. I currently try to dig through 1K LOC terraform config that I found online and I want to understand how to do a basic thing. So for now for me less tools will be better. I don&apos;t want to configure code deploy and CD yet. I&apos;ll be very happy when I&apos;ll push a Docker image to deploy without getting into packer ."><y>#</y><d>2022-06-11</d><h>13:41</h><r>Martynas M</r>I don&apos;t yet know what I want. For me less tools and less config is currently better. I currently try to dig through 1K LOC terraform config that I found online and I want to understand how to do a basic thing. So for now for me less tools will be better. I don&apos;t want to configure code deploy and CD yet. I&apos;ll be very happy when I&apos;ll push a Docker image to deploy without getting into <code>packer</code>.</z><z id="t1654954966" t="Max Stepping back a little, what are you trying to accomplish? "><y>#</y><d>2022-06-11</d><h>13:42</h><r>Max</r>Stepping back a little, what are you trying to accomplish? </z><z id="t1654955146" t="Martynas M I tried to understand what level of abstraction I should use for my deployment of stateful backend(s). I can run a single back-end on Heroku right now but I&apos;ll want to run multiple instances of the same back-end for redundancy (well it&apos;s stateful and I&apos;ll have a consensus protocol). This is why I want to have rolling deployments. So I&apos;ll go with ECS and Fargate for now (nothing is more constant than temporary, yes). Currently I want to run one docker container instance in one scaling group that I can reach from internets. The most basic thing but with the &quot;scalability&quot; knob. And the difference between this and Heroku is that the instance can see its peers. This is important."><y>#</y><d>2022-06-11</d><h>13:45</h><r>Martynas M</r>I tried to understand what level of abstraction I should use for my deployment of stateful backend(s). I can run a single back-end on Heroku right now but I&apos;ll want to run multiple instances of the same back-end for redundancy (well it&apos;s stateful and I&apos;ll have a consensus protocol).
This is why I want to have rolling deployments.

So I&apos;ll go with ECS and Fargate for now (nothing is more constant than temporary, yes).

Currently I want to run one docker container instance in one scaling group that I can reach from internets. The most basic thing but with the &quot;scalability&quot; knob.

And the difference between this and Heroku is that the instance can see its peers. This is important.</z><z id="t1654955314" t="Max I would strongly recommend using ecs/fargste unless you have a good reason to be getting into ec2s. Even for stateful services, the overhead is sooo much lower "><y>#</y><d>2022-06-11</d><h>13:48</h><r>Max</r>I would strongly recommend using ecs/fargste unless you have a good reason to be getting into ec2s. Even for stateful services, the overhead is sooo much lower </z><z id="t1654955342" t="Max If you need a persistent file system you can just stick efs on it"><y>#</y><d>2022-06-11</d><h>13:49</h><r>Max</r>If you need a persistent file system you can just stick efs on it</z><z id="t1654955350" t="Martynas M I was considering EC2 but you misunderstood. I&apos;ll take Fargate. No. It&apos;s all in memory."><y>#</y><d>2022-06-11</d><h>13:49</h><r>Martynas M</r>I was considering EC2 but you misunderstood. I&apos;ll take Fargate.
No. It&apos;s all in memory.</z><z id="t1654955373" t="Max Aaahhh ok got it."><y>#</y><d>2022-06-11</d><h>13:49</h><r>Max</r>Aaahhh ok got it.</z><z id="t1654955440" t="Martynas M It&apos;s actually more complicated than that. But this is the deployment bit. The app bit is more complicated because I&apos;ll have to do a consensus algorithm. That&apos;s going to be fun. But I want to not limit myself with this deployment. Maybe I&apos;m stupid enough to try it 😄 I hope that&apos;s probably a good thing..."><y>#</y><d>2022-06-11</d><h>13:50</h><r>Martynas M</r>It&apos;s actually more complicated than that. But this is the deployment bit. The app bit is more complicated because I&apos;ll have to do a consensus algorithm. That&apos;s going to be fun. But I want to not limit myself with this deployment.
Maybe I&apos;m stupid enough to try it <b>😄</b> I hope that&apos;s probably a good thing...</z><z id="t1654955506" t="Max As for deployments I tend to tell terraform to ignore all of or part of the task definition, and deploy by changing the TD. You could even do that manually initially"><y>#</y><d>2022-06-11</d><h>13:51</h><r>Max</r>As for deployments I tend to tell terraform to ignore all of or part of the task definition, and deploy by changing the TD. You could even do that manually initially</z><z id="t1654955534" t="Max So same thing as above with an asg"><y>#</y><d>2022-06-11</d><h>13:52</h><r>Max</r>So same thing as above with an asg</z><z id="t1654955579" t="Martynas M Yes, I could do the ASG manually when I&apos;ll have it. 😄 But I was suggested to not bother with UI and go with terraform. So I&apos;m trying to do it this way. Maybe it will be alright."><y>#</y><d>2022-06-11</d><h>13:52</h><r>Martynas M</r>Yes, I could do the ASG manually when I&apos;ll have it. <b>😄</b>  But I was suggested to not bother with UI and go with terraform. So I&apos;m trying to do it this way. Maybe it will be alright.</z><z id="t1654955913" t="Martynas M What&apos;s actually more interesting is how will I assign different IPs to my backends when I&apos;ll redeploy the same infra :thinking_face: And how will the already deployed backends know about these new backends :thinking_face: Maybe that could mean that I can only deploy without recreating the ASG."><y>#</y><d>2022-06-11</d><h>13:58</h><r>Martynas M</r>What&apos;s actually more interesting is how will I assign different IPs to my backends when I&apos;ll redeploy the same infra <b>:thinking_face:</b>
And how will the already deployed backends know about these new backends <b>:thinking_face:</b>
Maybe that could mean that I can only deploy without recreating the ASG.</z><z id="t1654963242" t="viesti didn&apos;t read whole thread, but with say a webapp that has ALB (Application Load Balancer) in front of thr backends run as ECS containers, with ECS you have a thing called Service in which you define how many copies of containers you run with a TaskDefinition, then you can tell ECS to use a launch type. If you use Fargate launch type, you will get a Fargate VM per task (task is a group of containers that run on same docker daemon). You tell the ECS Service what is the load balancer that the containers register to with a Target Group. When ECS starts Fargate VMs, they VMs will get fresh IP address from the VPC and the ECS service then tells the Load Balancer what the IP of the new VM is and the port of the container, in order to route traffic to that container on the Fargate VM"><y>#</y><d>2022-06-11</d><h>16:00</h><r>viesti</r>didn&apos;t read whole thread, but with say a webapp that has ALB (Application Load Balancer) in front of thr backends run as ECS containers, with ECS you have a thing called Service in which you define how many copies of containers you run with a TaskDefinition, then you can tell ECS to use a launch type. If you use Fargate launch type, you will get a Fargate VM per task (task is a group of containers that run on same docker daemon). You tell the ECS Service what is the load balancer that the containers register to with a Target Group. When ECS starts Fargate VMs, they VMs will get fresh IP address from the VPC and the ECS service then tells the Load Balancer what the IP of the new VM is and the port of the container, in order to route traffic to that container on the Fargate VM</z><z id="t1654963336" t="viesti you can use EC2 with a Autoscaling group, and then ECS will fit the new containers onto the EC2 machines, based on free memory etc requirements defined in the Task Definition. The ECS Service will then inform the load balancer where the new containers are and deregister old ones"><y>#</y><d>2022-06-11</d><h>16:02</h><r>viesti</r>you can use EC2 with a Autoscaling group, and then ECS will fit the new containers onto the EC2 machines, based on free memory etc requirements defined in the Task Definition. The ECS Service will then inform the load balancer where the new containers are and deregister old ones</z><z id="t1654963397" t="viesti ECS will do this in a rolling manner, you can specify hoe many containers have to be online st all times (I forget what the config was, healthy percentage or something like that)"><y>#</y><d>2022-06-11</d><h>16:03</h><r>viesti</r>ECS will do this in a rolling manner, you can specify hoe many containers have to be online st all times (I forget what the config was, healthy percentage or something like that)</z><z id="t1654963563" t="viesti there&apos;s this service discovery thing, which I think is DNS based, which I haven&apos;t used, but thinking that the service discovery is something that you might want to use if you&apos;re building something like the load balancer, that needs to know where new backends are and what old backends to retire"><y>#</y><d>2022-06-11</d><h>16:06</h><r>viesti</r>there&apos;s this service discovery thing, which I think is DNS based, which I haven&apos;t used, but thinking that the service discovery is something that you might want to use if you&apos;re building something like the load balancer, that needs to know where new backends are and what old backends to retire</z><z id="t1654963573" t="viesti (sorry braindump :D)"><y>#</y><d>2022-06-11</d><h>16:06</h><r>viesti</r>(sorry braindump :D)</z><z id="t1654964612" t="viesti oh and when you update the container image in a TaskDefinition, that means that a the ECS Service will make a new Fargate VM (if you use Fargate) and go through the register/deregister cycle for LB, telling the new IPs to LB. So when updating the app and running it via Fargate, you&apos;ll get fresh VMs on every update. With EC2 as launch type, the existing EC2 VMs get reused, so IPs stay same but the container ports differ since new containers get bound to ephemeral ports so that ECS can decide to run old and new container on same host. You can define exposed ports on the host side on your own in the TaskDefinition, but you then need to take care that ports don&apos;t collide. This you could do in Terraform, with just say random data source, or you could to the whole bokkeeping yourself with say https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data_source"><y>#</y><d>2022-06-11</d><h>16:23</h><r>viesti</r>oh and when you update the container image in a TaskDefinition, that means that a the ECS Service will make a new Fargate VM (if you use Fargate) and go through the register/deregister cycle for LB, telling the new IPs to LB. So when updating the app and running it via Fargate, you&apos;ll get fresh VMs on every update.

With EC2 as launch type, the existing EC2 VMs get reused, so IPs stay same but the container ports differ since new containers get bound to ephemeral ports so that ECS can decide to run old and new container on same host. You can define exposed ports on the host side on your own in the TaskDefinition, but you then need to take care that ports don&apos;t collide. This you could do in Terraform, with just say random data source, or you could to the whole bokkeeping yourself with say <a href="https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data_source" target="_blank">https://registry.terraform.io/providers/hashicorp/external/latest/docs/data-sources/data_source</a></z><z id="t1654965022" t="viesti (I once used ECS with ASG, and used NLB (Network Load Balancer) in order to do UDP traffic load balancing and that lead to speccing the ports on the TaskDefinition beforehand, and https://registry.terraform.io/providers/hashicorp/random/latest/docs worked for avoiding stepping over ports already in use, at least works till today also :D)"><y>#</y><d>2022-06-11</d><h>16:30</h><r>viesti</r>(I once used ECS with ASG, and used NLB (Network Load Balancer) in order to do UDP traffic load balancing and that lead to speccing the ports on the TaskDefinition beforehand, and <a href="https://registry.terraform.io/providers/hashicorp/random/latest/docs" target="_blank">https://registry.terraform.io/providers/hashicorp/random/latest/docs</a> worked for avoiding stepping over ports already in use, at least works till today also :D)</z><z id="t1654967751" t="Martynas M Thanks. I already deployed a hello world and it seems to be working. But now I&apos;ll have to think about more stuff. Thanks."><y>#</y><d>2022-06-11</d><h>17:15</h><r>Martynas M</r>Thanks. I already deployed a hello world and it seems to be working. But now I&apos;ll have to think about more stuff. Thanks.</z><z id="t1655019590" t="Martynas M [:attrs {:href &quot;/_/_/users/U01EB0V3H39&quot;}] Hey. I was thinking about how to make deploys work and I found this post that says that I shouldn&apos;t use latest tag on my containers. Yes, my container could then probably deploy automatically but then I can&apos;t roll-back if I want to. For instance a comment of this answer mentions that there is a &quot;force new deployment&quot; parameter that could pick up latest container: https://stackoverflow.com/questions/53510783/ecs-auto-deploy-with-ecr But the answer itself says that I shouldn&apos;t use the latest tag for deployment and I agree with it. So I&apos;m not sure what you really meant by &quot;goes against the grain with terraform’s declarative approach&quot; because if I would use a specific version of the container then I would probably be fine. I would be more concerned about the use of Terraform if I would rerun the cluster and use latest tag instead :thinking_face:"><y>#</y><d>2022-06-12</d><h>07:39</h><r>Martynas M</r><a>@U01EB0V3H39</a> Hey.
I was thinking about how to make deploys work and I found this post that says that I shouldn&apos;t use <code>latest</code> tag on my containers.
Yes, my container could then probably deploy automatically but then I can&apos;t roll-back if I want to.

For instance a comment of this answer mentions that there is a &quot;force new deployment&quot; parameter that could pick up <code>latest</code> container: <a href="https://stackoverflow.com/questions/53510783/ecs-auto-deploy-with-ecr" target="_blank">https://stackoverflow.com/questions/53510783/ecs-auto-deploy-with-ecr</a>

But the answer itself says that I shouldn&apos;t use the <code>latest</code> tag for deployment and I agree with it.

So I&apos;m not sure what you really meant by &quot;goes against the grain with terraform’s declarative approach&quot; because if I would use a specific version of the container then I would probably be fine. I would be more concerned about the use of Terraform if I would rerun the cluster and use <code>latest</code> tag instead <b>:thinking_face:</b></z><z id="t1655025861" t="viesti I guess the thing is to split the infra and app deployment into modules (app deploy outside of Terraform can be like a &quot;module&quot;, if thought that way :)). If everything is in same Terraform state, then if you only want to deploy a new version of the app, all other resources are refreshed (=checked for changes) by Terraform too. Also, with container image tagging, this creates a funny chicken-and-egg dilemma where you need a ECR registry and an image inside the registry on the first deploy, if you refer to the ECR registry from a TaskDefinition. While I&apos;ve heard advise of keeping app deployment out of Terraform, I&apos;ve done app deployment with Terraform too, by having two modules: infra and app. The app module contains ECS Service and TaskDefinition, so things like environment variables etc. changes to co-locate the app more then the infra. The app module then takes the container image name as a variable, so you can use tags on the image name. Then the app module just references by remote state to stuff like VPC ID, for telling into which subnet to run the ECS services (with Fargate, you need to tell the network that is used inside the TaskDefinition). So I think you can do app deployment with Terraform too. You then just have two runs of terraform apply : infra and app. If the &quot;datacenter&quot; would happen to grow more, you would then probably have more Terraform root modules (= module with state), for each of the &quot;parts&quot; in the datacenter. The whole &quot;datacenter&quot; doesn&apos;t change all the time, probably more often changes happen inside modules, and probably the infra for a module changes seldomly than the code for the app. So this rate of change kind of form modules boundaries."><y>#</y><d>2022-06-12</d><h>09:24</h><r>viesti</r>I guess the thing is to split the infra and app deployment into modules (app deploy outside of Terraform can be like a &quot;module&quot;, if thought that way :)).

If everything is in same Terraform state, then if you only want to deploy a new version of the app, all other resources are refreshed (=checked for changes) by Terraform too. Also, with container image tagging, this creates a funny chicken-and-egg dilemma where you need a ECR registry and an image inside the registry on the first deploy, if you refer to the ECR registry from a TaskDefinition.

While I&apos;ve heard advise of keeping app deployment out of Terraform, I&apos;ve done app deployment with Terraform too, by having two modules: infra and app. The app module contains ECS Service and TaskDefinition, so things like environment variables etc. changes to co-locate the app more then the infra. The app module then takes the container image name as a variable, so you can use tags on the image name. Then the app module just references by remote state to stuff like VPC ID, for telling into which subnet to run the ECS services (with Fargate, you need to tell the network that is used inside the TaskDefinition).

So I think you can do app deployment with Terraform too. You then just have two runs of <code>terraform apply</code>: infra and app. If the &quot;datacenter&quot; would happen to grow more, you would then probably have more Terraform root modules (= module with state), for each of the &quot;parts&quot; in the datacenter. The whole &quot;datacenter&quot; doesn&apos;t change all the time, probably more often changes happen inside modules, and probably the infra for a module changes seldomly than the code for the app. So this rate of change kind of form modules boundaries.</z><z id="t1655045465" t="Martynas M One more catch is that you also create ECR in a specific region. And one more catch which is somewhat strange is that they want you to create ECR per image type. https://stackoverflow.com/questions/48567787/ecs-ecr-is-common-practice-to-have-one-repository-per-image-and-associated-ver So the more image types there are the more ECR repos there will be. This is puzzling because in Azure I could upload any container names. And in here I have to specify it specifically or else it won&apos;t work :thinking_face:"><y>#</y><d>2022-06-12</d><h>14:51</h><r>Martynas M</r>One more catch is that you also create ECR in a specific region.
And one more catch which is somewhat strange is that they want you to create ECR per image type.
<a href="https://stackoverflow.com/questions/48567787/ecs-ecr-is-common-practice-to-have-one-repository-per-image-and-associated-ver" target="_blank">https://stackoverflow.com/questions/48567787/ecs-ecr-is-common-practice-to-have-one-repository-per-image-and-associated-ver</a>
So the more image types there are the more ECR repos there will be. This is puzzling because in Azure I could upload any container names. And in here I have to specify it specifically or else it won&apos;t work <b>:thinking_face:</b></z><z id="t1655053583" t="viesti personally I haven&apos;t found it a problem to have repository per app"><y>#</y><d>2022-06-12</d><h>17:06</h><r>viesti</r>personally I haven&apos;t found it a problem to have repository per app</z><z id="t1655060689" t="Martynas M I&apos;ve managed to make rolling deployment work by specifying a docker container version. But what puzzles me is that if there is nothing to deploy it still &quot;finds&quot; something to ask as if it changed. I tried to do ignore_changes=[task_definition] but then it doesn&apos;t deploy. This is without the &quot;force-redeploy&quot; flag. Probably there is no way around this strange thing. But yes, I&apos;ll do a repo per container type 😄 And I also tried to do deployments via Terraform. It works but if I run two deployments at the same time then it doesn&apos;t deploy the newer one. But it&apos;s probably fine if I&apos;m deploying by hand."><y>#</y><d>2022-06-12</d><h>19:04</h><r>Martynas M</r>I&apos;ve managed to make rolling deployment work by specifying a docker container version. But what puzzles me is that if there is nothing to deploy it still &quot;finds&quot; something to ask as if it changed. I tried to do <code>ignore_changes=[task_definition]</code> but then it doesn&apos;t deploy. This is without the &quot;force-redeploy&quot; flag. Probably there is no way around this strange thing.
But yes, I&apos;ll do a repo per container type <b>😄</b>
And I also tried to do deployments via Terraform. It works but if I run two deployments at the same time then it doesn&apos;t deploy the newer one. But it&apos;s probably fine if I&apos;m deploying by hand.</z><z id="t1655021405" t="Martynas M What does aws_ecs_service.network_configuration.assign_public_ip do? For me the doc seems to be very vague and maybe even misleading. The doc says that it somehow assigns public IP. And when I deploy it with false then it says it&apos;s 503. Default is false but then what does it do? Is it meant for tasks that can&apos;t be reached from the internet? I deployed with false and that container should then serve a webpage but it was 503-ing for 5 minutes. And when I redeployed using true then it came online. So does it mean that it exposes the container to the subnet or does it mean that the container actually gets a real public IP with all ports visible publicly? This is the doc (I use Fargate instances): https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service#assign_public_ip Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols: ~ update in-place Terraform will perform the following actions: # aws_ecs_service.landing_service will be updated in-place ~ resource &quot;aws_ecs_service&quot; &quot;my_service&quot; { id = &quot;&lt;removed&gt;&quot; name = &quot;my_service&quot; tags = {} # (15 unchanged attributes hidden) ~ network_configuration { ~ assign_public_ip = false -&gt; true # (2 unchanged attributes hidden) } # (3 unchanged blocks hidden) } Plan: 0 to add, 1 to change, 0 to destroy."><y>#</y><d>2022-06-12</d><h>08:10</h><w>Martynas M</w>What does <code>aws_ecs_service.network_configuration.assign_public_ip</code>  do? For me the doc seems to be very vague and maybe even misleading.
The doc says that it somehow assigns public IP. And when I deploy it with <code>false</code> then it says it&apos;s 503.
Default is <code>false</code> but then what does it do? Is it meant for tasks that can&apos;t be reached from the internet?

I deployed with <code>false</code> and that container should then serve a webpage but it was 503-ing for 5 minutes. And when I redeployed using <code>true</code> then it came online. So does it mean that it exposes the container to the subnet or does it mean that the container actually gets a real public IP with all ports visible publicly?

This is the doc (I use Fargate instances):
<a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service#assign_public_ip" target="_blank">https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_service#assign_public_ip</a>

<pre>Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  ~ update in-place

Terraform will perform the following actions:

  # aws_ecs_service.landing_service will be updated in-place
  ~ resource &quot;aws_ecs_service&quot; &quot;my_service&quot; {
        id                                 = &quot;&lt;removed&gt;&quot;
        name                               = &quot;my_service&quot;
        tags                               = {}
        # (15 unchanged attributes hidden)




      ~ network_configuration {
          ~ assign_public_ip = false -&gt; true
            # (2 unchanged attributes hidden)
        }
        # (3 unchanged blocks hidden)
    }

Plan: 0 to add, 1 to change, 0 to destroy.</pre></z><z id="t1655309013" t="dabrazhe What people are using these days to create and deploy AWS Lambda? I used https://github.com/dainiusjocas/babashka-lambda a while ago, but the repo is not maintained and automation is pretty basic. I heard about Holy Lambda recently, what is your experience?"><y>#</y><d>2022-06-15</d><h>16:03</h><w>dabrazhe</w>What people are using these days to create and deploy AWS Lambda?
I used <a href="https://github.com/dainiusjocas/babashka-lambda" target="_blank">https://github.com/dainiusjocas/babashka-lambda</a> a while ago, but the repo is not maintained and automation is pretty basic. I heard about Holy Lambda recently, what is your experience?</z><z id="t1655309521" t="lukasz We just build a JAR and deploy it using Terraform, our Lambdas are used only for infrastructure stuff so they don&apos;t change that often"><y>#</y><d>2022-06-15</d><h>16:12</h><r>lukasz</r>We just build a JAR and deploy it using Terraform, our Lambdas are used only for infrastructure stuff so they don&apos;t change that often</z><z id="t1655324115" t="thomas have you looked at #nbb ? that can run on Lambda&apos;s. I haven&apos;t tried it myself though."><y>#</y><d>2022-06-15</d><h>20:15</h><r>thomas</r>have you looked at #nbb ? that can run on Lambda&apos;s. I haven&apos;t tried it myself though.</z><z id="t1655340412" t="steveb8n HL is excellent. we use it for many lambdas in prod"><y>#</y><d>2022-06-16</d><h>00:46</h><r>steveb8n</r>HL is excellent. we use it for many lambdas in prod</z><z id="t1655386995" t="Karol Wójcik HL is quite minimal and ships with the great performance. It&apos;s faster than running Clojure on official Java runtime consume less memory. "><y>#</y><d>2022-06-16</d><h>13:43</h><r>Karol Wójcik</r>HL is quite minimal and ships with the great performance. It&apos;s faster than running Clojure on official Java runtime consume less memory. </z><z id="t1655387074" t="Karol Wójcik The current pain points are the HL tasks that are planned to get rewritten in few weeks / months depending on my mood :D "><y>#</y><d>2022-06-16</d><h>13:44</h><r>Karol Wójcik</r>The current pain points are the HL tasks that are planned to get rewritten in few weeks / months depending on my mood :D </z><z id="t1655378876" t="Martynas M Hey. What would one use to do service peer discovery on AWS? I found that I can&apos;t use multicast. What should I do to find out what IPs are &quot;alive&quot; in my network?"><y>#</y><d>2022-06-16</d><h>11:27</h><w>Martynas M</w>Hey.
What would one use to do service peer discovery on AWS?
I found that I can&apos;t use multicast. What should I do to find out what IPs are &quot;alive&quot; in my network?</z><z id="t1655384503" t="Martynas M I&apos;ll probably need to do polling. I don&apos;t want to use their service discovery using Route 53 and all other proprietary things because I want it real-time. Also they assume that I&apos;ll do requests to their services which are stil TCP one-to-one requests. Which is still the same except now I couple my system to theirs. AND on top of that it will have TTL parameters which means it&apos;s additional lag to find out that my service may have already been killed. Correct me if I&apos;m wrong."><y>#</y><d>2022-06-16</d><h>13:01</h><r>Martynas M</r>I&apos;ll probably need to do polling. I don&apos;t want to use their service discovery using Route 53 and all other proprietary things because I want it real-time.
Also they assume that I&apos;ll do requests to their services which are stil TCP one-to-one requests. Which is still the same except now I couple my system to theirs.

AND on top of that it will have TTL parameters which means it&apos;s additional lag to find out that my service may have already been killed.

Correct me if I&apos;m wrong.</z><z id="t1655390889" t="lukasz What sort of service discovery? Are you building a clustered system or do you just need to route requests to different HTTP backend? (because the later can be done with ALB and multiple target groups)"><y>#</y><d>2022-06-16</d><h>14:48</h><r>lukasz</r>What sort of service discovery? Are you building a clustered system or do you just need to route requests to different HTTP backend? (because the later can be done with ALB and multiple target groups)</z><z id="t1655390906" t="lukasz For the first one, I think something like Consul would be a better choice"><y>#</y><d>2022-06-16</d><h>14:48</h><r>lukasz</r>For the first one, I think something like Consul would be a better choice</z><z id="t1655391560" t="Martynas M I thought about not using additional services. Because I wanted a lightweight way of finding the hosts. I wanted the hosts to find each other to run a consensus protocol between them. And I see that Consul already says &quot;You can choose to create 3, 5, or 7 servers&quot; which means they will run Raft and negotiate their own states."><y>#</y><d>2022-06-16</d><h>14:59</h><r>Martynas M</r>I thought about not using additional services. Because I wanted a lightweight way of finding the hosts. I wanted the hosts to find each other to run a consensus protocol between them. And I see that Consul already says &quot;You can choose to create 3, 5, or 7 servers&quot; which means they will run Raft and negotiate their own states.</z><z id="t1655392049" t="lukasz Maybe you can make it work with jGroups - I build a proof of concept and it worked pretty well"><y>#</y><d>2022-06-16</d><h>15:07</h><r>lukasz</r>Maybe you can make it work with jGroups - I build a proof of concept and it worked pretty well</z><z id="t1655392063" t="lukasz no extra infra to deploy, the clustering is built-in into your services"><y>#</y><d>2022-06-16</d><h>15:07</h><r>lukasz</r>no extra infra to deploy, the clustering is built-in into your services</z><z id="t1655402480" t="Martynas M I think I&apos;ve read about JGroups today. They have way too many features but what they also say is that ( http://www.jgroups.org/ ): Transport protocols: UDP (IP Multicast) or TCP So it&apos;s already going to be based on IP multicast which I can&apos;t use on AWS. And if I use TCP then I would probably be better off without using JGroups. What kind of POC did you have? Was it on AWS? Maybe that means that you were able to use IP Multicast? I want to have hosts that are located in different availability zones. I also can use TCP but TCP is one-to-one which means I have to not rely on AWS&apos;s DHCP."><y>#</y><d>2022-06-16</d><h>18:01</h><r>Martynas M</r>I think I&apos;ve read about JGroups today. They have way too many features but what they also say is that (<a href="http://www.jgroups.org/" target="_blank">http://www.jgroups.org/</a>):
<pre>Transport protocols: UDP (IP Multicast) or TCP</pre>
So it&apos;s already going to be based on IP multicast which I can&apos;t use on AWS. And if I use TCP then I would probably be better off without using JGroups. What kind of POC did you have? Was it on AWS? Maybe that means that you were able to use IP Multicast?
I want to have hosts that are located in different availability zones.

I also can use TCP but TCP is one-to-one which means I have to not rely on AWS&apos;s DHCP.</z><z id="t1655402563" t="lukasz I used Google Cloud at that time and run into issues with GCP&apos;s networking, if so I tried autodiscovery plugins and these didn&apos;t work either. There&apos;s a AWS auto-discovery plugin for jGroups however: https://github.com/meltmedia/jgroups-aws"><y>#</y><d>2022-06-16</d><h>18:02</h><r>lukasz</r>I used Google Cloud at that time and run into issues with GCP&apos;s networking, if so I tried autodiscovery plugins and these didn&apos;t work either. There&apos;s a AWS auto-discovery plugin for jGroups however: <a href="https://github.com/meltmedia/jgroups-aws" target="_blank">https://github.com/meltmedia/jgroups-aws</a></z><z id="t1655403794" t="Martynas M It says it uses EC2 node tag names . What if I&apos;ll use Fargate with containers inside (ECS)? Also is it supposed to be used as a transport layer for original JGroups? I hope it should :thinking_face:"><y>#</y><d>2022-06-16</d><h>18:23</h><r>Martynas M</r>It says it uses <code>EC2 node tag names</code>. What if I&apos;ll use Fargate with containers inside (ECS)? Also is it supposed to be used as a transport layer for original JGroups? I hope it should <b>:thinking_face:</b></z><z id="t1655404843" t="lukasz ah yeah, Fargate might not work"><y>#</y><d>2022-06-16</d><h>18:40</h><r>lukasz</r>ah yeah, Fargate might not work</z><z id="t1655404870" t="lukasz but then again - you can use ECS API to get services, task IPs and all of that and build your own service discovery"><y>#</y><d>2022-06-16</d><h>18:41</h><r>lukasz</r>but then again - you can use ECS API to get services, task IPs and all of that and build your own service discovery</z><z id="t1655404904" t="lukasz there&apos;s also this: https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-discovery.html"><y>#</y><d>2022-06-16</d><h>18:41</h><r>lukasz</r>there&apos;s also this: <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-discovery.html" target="_blank">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-discovery.html</a></z><z id="t1655404922" t="lukasz never used any of them, we engineered ourselves out of having a service discovery/clustering"><y>#</y><d>2022-06-16</d><h>18:42</h><r>lukasz</r>never used any of them, we engineered ourselves out of having a service discovery/clustering</z><z id="t1655405952" t="Martynas M My other idea is to simply allocate a very small CIDR range and ping them from each other. I don&apos;t need more than twice the size of my deployment at the same time :thinking_face: Maybe even node-count+1 of IPs would be enough but it depends on how the deployment works :thinking_face:"><y>#</y><d>2022-06-16</d><h>18:59</h><r>Martynas M</r>My other idea is to simply allocate a very small CIDR range and ping them from each other. I don&apos;t need more than twice the size of my deployment at the same time <b>:thinking_face:</b>  Maybe even node-count+1 of IPs would be enough but it depends on how the deployment works <b>:thinking_face:</b></z><z id="t1655406049" t="Martynas M Also if my subnet would be that small I may not even need to do any pinging as I could simply hardcode the IPs and call it a day :thinking_face:"><y>#</y><d>2022-06-16</d><h>19:00</h><r>Martynas M</r>Also if my subnet would be that small I may not even need to do any pinging as I could simply hardcode the IPs and call it a day <b>:thinking_face:</b></z><z id="t1655406146" t="Martynas M And what the JGroups-aws gave me an idea about was to have TCP_ALL security parameter. That could be handy."><y>#</y><d>2022-06-16</d><h>19:02</h><r>Martynas M</r>And what the <code>JGroups-aws</code> gave me an idea about was to have <code>TCP_ALL</code> security parameter. That could be handy.</z><z id="t1655406204" t="lukasz IP allocation is random from what I can see when we do rolling deployments of our tasks"><y>#</y><d>2022-06-16</d><h>19:03</h><r>lukasz</r>IP allocation is random from what I can see when we do rolling deployments of our tasks</z><z id="t1655406351" t="Martynas M I know that IP allocation is random and yes, I want to do rolling deployments. But I don&apos;t yet know but if I&apos;d force the DHCP server of ECS to return an IP from predefined list then it should be fine to simply ping all of the IPs in that range. So if range would be 10 IPs and I&apos;d be running 3-5 hosts then it should be good."><y>#</y><d>2022-06-16</d><h>19:05</h><r>Martynas M</r>I know that IP allocation is random and yes, I want to do rolling deployments. But I don&apos;t yet know but if I&apos;d force the DHCP server of ECS to return an IP from predefined list then it should be fine to simply ping all of the IPs in that range.
So if range would be 10 IPs and I&apos;d be running 3-5 hosts then it should be good.</z><z id="t1655406387" t="lukasz ah yeah, with these numbers of nodes that could def work"><y>#</y><d>2022-06-16</d><h>19:06</h><r>lukasz</r>ah yeah, with these numbers of nodes that could def work</z><z id="t1655406482" t="Martynas M I don&apos;t know whether it&apos;s more or less hacky than that global store. But yes, the solution with global registry would probably be easier to scale. But then I could do very many small subnets and it could still be &quot;scalable&quot; that way...? Not sure."><y>#</y><d>2022-06-16</d><h>19:08</h><r>Martynas M</r>I don&apos;t know whether it&apos;s more or less hacky than that global store. But yes, the solution with global registry would probably be easier to scale.
But then I could do very many small subnets and it could still be &quot;scalable&quot; that way...? Not sure.</z><z id="t1655561553" t="Benjamin trying to run my jar with aws lambda java11 runtime getting some json parse error"><y>#</y><d>2022-06-18</d><h>14:12</h><w>Benjamin</w>trying to run my jar with aws lambda java11 runtime getting some json parse error</z><z id="t1655561558" t="Benjamin START RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf Version: $LATEST An error occurred during JSON parsing: java.lang.RuntimeException java.lang.RuntimeException: An error occurred during JSON parsing Caused by: java.io.UncheckedIOException: com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of `java.lang.String` out of START_OBJECT token at [Source: (ByteArrayInputStream); line: 1, column: 1] at com.amazonaws.services.lambda.runtime.serialization.factories.JacksonFactory$InternalSerializer.fromJson(JacksonFactory.java:184) Caused by: com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of `java.lang.String` out of START_OBJECT token at [Source: (ByteArrayInputStream); line: 1, column: 1] at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1445) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1219) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1129) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:609) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.handleNonArray(StringArrayDeserializer.java:304) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.deserialize(StringArrayDeserializer.java:132) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.deserialize(StringArrayDeserializer.java:21) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.ObjectReader._bindAndClose(ObjectReader.java:1719) at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:1228) at com.amazonaws.services.lambda.runtime.serialization.factories.JacksonFactory$InternalSerializer.fromJson(JacksonFactory.java:182) END RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf REPORT RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf Duration: 249.56 ms Billed Duration: 250 ms Memory Size: 512 MB Max Memory Used: 206 MB Init Duration: 8371.93 ms "><y>#</y><d>2022-06-18</d><h>14:12</h><r>Benjamin</r><pre>START RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf Version: $LATEST
An error occurred during JSON parsing: java.lang.RuntimeException
java.lang.RuntimeException: An error occurred during JSON parsing
Caused by: java.io.UncheckedIOException: com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of `java.lang.String` out of START_OBJECT token
 at [Source: (ByteArrayInputStream); line: 1, column: 1]
	at com.amazonaws.services.lambda.runtime.serialization.factories.JacksonFactory$InternalSerializer.fromJson(JacksonFactory.java:184)
Caused by: com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException: Cannot deserialize instance of `java.lang.String` out of START_OBJECT token
 at [Source: (ByteArrayInputStream); line: 1, column: 1]
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.reportInputMismatch(DeserializationContext.java:1445)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1219)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.DeserializationContext.handleUnexpectedToken(DeserializationContext.java:1129)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StdDeserializer._parseString(StdDeserializer.java:609)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.handleNonArray(StringArrayDeserializer.java:304)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.deserialize(StringArrayDeserializer.java:132)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.deser.std.StringArrayDeserializer.deserialize(StringArrayDeserializer.java:21)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.ObjectReader._bindAndClose(ObjectReader.java:1719)
	at com.amazonaws.lambda.thirdparty.com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:1228)
	at com.amazonaws.services.lambda.runtime.serialization.factories.JacksonFactory$InternalSerializer.fromJson(JacksonFactory.java:182)

END RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf
REPORT RequestId: e6768c98-0e4f-43fc-9160-d0a820bfe2cf	Duration: 249.56 ms	Billed Duration: 250 ms	Memory Size: 512 MB	Max Memory Used: 206 MB	Init Duration: 8371.93 ms</pre>
</z><z id="t1655561579" t="Benjamin I wonder a little if it is because it tries to parse everything that goes to stdout as json?"><y>#</y><d>2022-06-18</d><h>14:12</h><r>Benjamin</r>I wonder a little if it is because it tries to parse everything that goes to stdout as json?</z><z id="t1655564062" t="Benjamin Maybe my handler needs some special signature"><y>#</y><d>2022-06-18</d><h>14:54</h><r>Benjamin</r>Maybe my handler needs some special signature</z><z id="t1655566851" t="Benjamin ok I needed to implement some handler like here https://docs.aws.amazon.com/lambda/latest/dg/java-handler.html at least that was a way"><y>#</y><d>2022-06-18</d><h>15:40</h><r>Benjamin</r>ok I needed to implement some handler like here <a href="https://docs.aws.amazon.com/lambda/latest/dg/java-handler.html" target="_blank">https://docs.aws.amazon.com/lambda/latest/dg/java-handler.html</a>
at least that was a  way</z><z id="t1655566872" t="Benjamin next time #holy-lambda 😅"><y>#</y><d>2022-06-18</d><h>15:41</h><r>Benjamin</r>next time #holy-lambda <b>😅</b></z><z id="t1655567211" t="lukasz We have a bunch of JVM lambdas, and all of them basically implement com.amazonaws.services.lambda.runtime.RequestStreamHandler interface https://gist.github.com/lukaszkorecki/4ddede30578bcdd00f043be861ba568f"><y>#</y><d>2022-06-18</d><h>15:46</h><r>lukasz</r>We have a bunch of JVM lambdas, and all of them basically implement  <code>com.amazonaws.services.lambda.runtime.RequestStreamHandler</code> interface <a href="https://gist.github.com/lukaszkorecki/4ddede30578bcdd00f043be861ba568f" target="_blank">https://gist.github.com/lukaszkorecki/4ddede30578bcdd00f043be861ba568f</a></z><z id="t1655569567" t="Karol Wójcik [:attrs {:href &quot;/_/_/users/U02CV2P4J6S&quot;}] you could use HL with Java as well, did you know that?"><y>#</y><d>2022-06-18</d><h>16:26</h><r>Karol Wójcik</r><a>@U02CV2P4J6S</a> you could use HL with Java as well, did you know that?</z><z id="t1655569660" t="Karol Wójcik Memory consumption and cold start time is much lower for HL compared to AWS Official Runtime. Also you don’t have to use HL tasks if you don’t like and treat HL as just a library. "><y>#</y><d>2022-06-18</d><h>16:27</h><r>Karol Wójcik</r>Memory consumption and cold start time is much lower for HL compared to AWS Official Runtime. Also you don’t have to use HL tasks if you don’t like and treat HL as just a library. </z><z id="t1655569709" t="lukasz [:attrs {:href &quot;/_/_/users/UJ1339K2B&quot;}] is the last part documented anywhere - I just had a quick look but couldn&apos;t find it"><y>#</y><d>2022-06-18</d><h>16:28</h><r>lukasz</r><a>@UJ1339K2B</a> is the last part documented anywhere - I just had a quick look but couldn&apos;t find it</z><z id="t1655569810" t="Karol Wójcik https://github.com/FieryCod/holy-lambda/blob/master/benchmarks/holy-lambda-vs-other-runtimes/README.md"><y>#</y><d>2022-06-18</d><h>16:30</h><r>Karol Wójcik</r><a href="https://github.com/FieryCod/holy-lambda/blob/master/benchmarks/holy-lambda-vs-other-runtimes/README.md" target="_blank">https://github.com/FieryCod/holy-lambda/blob/master/benchmarks/holy-lambda-vs-other-runtimes/README.md</a></z><z id="t1655569844" t="lukasz Sorry, I wasn&apos;t clear - the bit about using HL as a library :-)"><y>#</y><d>2022-06-18</d><h>16:30</h><r>lukasz</r>Sorry, I wasn&apos;t clear - the bit about using HL as a library :-)</z><z id="t1655569874" t="Karol Wójcik Here is the example that uses Docker images https://fierycod.github.io/holy-lambda/#/clojure-backend-tutorial"><y>#</y><d>2022-06-18</d><h>16:31</h><r>Karol Wójcik</r>Here is the example that uses Docker images <a href="https://fierycod.github.io/holy-lambda/#/clojure-backend-tutorial" target="_blank">https://fierycod.github.io/holy-lambda/#/clojure-backend-tutorial</a></z><z id="t1655569989" t="Karol Wójcik Here is the example with custom layer https://github.com/FieryCod/holy-lambda-on-java-17"><y>#</y><d>2022-06-18</d><h>16:33</h><r>Karol Wójcik</r>Here is the example with custom layer <a href="https://github.com/FieryCod/holy-lambda-on-java-17" target="_blank">https://github.com/FieryCod/holy-lambda-on-java-17</a></z><z id="t1655570004" t="lukasz Awesome, thanks!"><y>#</y><d>2022-06-18</d><h>16:33</h><r>lukasz</r>Awesome, thanks!</z><z id="t1655570103" t="Karol Wójcik Anyway, you can remove the bb tasks completely. What you need is compile the Clojure sources to uberjar and then build the custom layer as in the last example."><y>#</y><d>2022-06-18</d><h>16:35</h><r>Karol Wójcik</r>Anyway, you can remove the bb tasks completely. What you need is compile the Clojure sources to uberjar and then build the custom layer as in the last example.</z><z id="t1655570149" t="Karol Wójcik Fairly easy I would say and you can save some $ by this switch. "><y>#</y><d>2022-06-18</d><h>16:35</h><r>Karol Wójcik</r>Fairly easy I would say and you can save some $ by this switch. </z><z id="t1655570191" t="Karol Wójcik Also you can run full featured ring apps with HL on both native and Java/Clojure runtime via https://github.com/FieryCod/holy-lambda-ring-adapter ."><y>#</y><d>2022-06-18</d><h>16:36</h><r>Karol Wójcik</r>Also you can run full featured ring apps with HL on both native and Java/Clojure runtime via <a href="https://github.com/FieryCod/holy-lambda-ring-adapter" target="_blank">https://github.com/FieryCod/holy-lambda-ring-adapter</a>.</z><z id="t1655570213" t="Karol Wójcik It&apos;s already used in production, so I can recommend this one. "><y>#</y><d>2022-06-18</d><h>16:36</h><r>Karol Wójcik</r>It&apos;s already used in production, so I can recommend this one. </z><z id="t1655572622" t="Benjamin [:attrs {:href &quot;/_/_/users/UJ1339K2B&quot;}] I totally should do this. I somehow thought using &quot;just the java runtime&quot; would be simpler but ended being a pain. But also my lambda only runs 1/day so right now I don&apos;t have a reason to switch 😄"><y>#</y><d>2022-06-18</d><h>17:17</h><r>Benjamin</r><a>@UJ1339K2B</a> I totally should do this. I somehow thought using &quot;just the java runtime&quot; would be simpler but ended being a pain.
But also my lambda only runs 1/day so right now I don&apos;t have a reason to switch <b>😄</b></z><z id="t1655573128" t="Karol Wójcik Hope the lesson is learned :D "><y>#</y><d>2022-06-18</d><h>17:25</h><r>Karol Wójcik</r>Hope the lesson is learned :D </z><z id="t1655804335" t="Dimitar Uzunov how do you use a waiter with https://github.com/cognitect-labs/aws-api ? I.e. I’m starting a cluster and I want to block the thread until it is done starting?"><y>#</y><d>2022-06-21</d><h>09:38</h><w>Dimitar Uzunov</w>how do you use a waiter with <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a>? I.e. I’m starting a cluster and I want to block the thread until it is done starting?</z><z id="t1655816321" t="jjttjj I don&apos;t think this is fully intended to be used like this, but you can use the async version of the api&apos;s invoke along with :retriable to check if your thing is ready (a/&lt;!! (aaws/invoke cfn {:op &lt;describe resources&gt; :request &lt;request for resource info&gt; :retriable? (fn [result] &lt;truthy when resource is ready&gt;) :backoff (fn [x] (println &quot;retry&quot; (str &quot;#&quot; x)) (cond (zero? x) 60000 (&lt; x 20) 10000))}))"><y>#</y><d>2022-06-21</d><h>12:58</h><r>jjttjj</r>I don&apos;t think this is fully intended to be used like this, but you can use the async version of the api&apos;s <code>invoke</code> along with <code>:retriable</code> to check if your thing is ready
<pre>(a/&lt;!!
  (aaws/invoke cfn
    {:op         &lt;describe resources&gt;
     :request    &lt;request  for resource info&gt;
     :retriable? (fn [result] &lt;truthy when resource is ready&gt;)
     :backoff    (fn [x]
                   (println &quot;retry&quot; (str &quot;#&quot; x))
                   (cond
                     (zero? x) 60000
                     (&lt; x 20)  10000))}))</pre></z><z id="t1655816405" t="Dimitar Uzunov yep that looks quite useful, I was just wondering what is the recommended way"><y>#</y><d>2022-06-21</d><h>13:00</h><r>Dimitar Uzunov</r>yep that looks quite useful, I was just wondering what is the recommended way</z><z id="t1655816566" t="jjttjj You could always just do the polling manually in a normal loop also"><y>#</y><d>2022-06-21</d><h>13:02</h><r>jjttjj</r>You could always just do the polling manually in a normal loop also</z><z id="t1655816661" t="jjttjj Here&apos;s a bit more info why I don&apos;t think the :retriable thing is offically supported (I could be wrong) https://clojurians.slack.com/archives/C09N0H1RB/p1652101946639159"><y>#</y><d>2022-06-21</d><h>13:04</h><r>jjttjj</r>Here&apos;s a bit more info why I don&apos;t think the :retriable thing is offically supported (I could be wrong) <a href="https://clojurians.slack.com/archives/C09N0H1RB/p1652101946639159" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1652101946639159</a></z><z id="t1655913525" t="ghadi that&apos;s not what retriable is for"><y>#</y><d>2022-06-22</d><h>15:58</h><r>ghadi</r>that&apos;s not what retriable is for</z><z id="t1655913558" t="ghadi retriable is for failures, not stuff like status transitions from IN_PROGRESS -&gt; READY"><y>#</y><d>2022-06-22</d><h>15:59</h><r>ghadi</r>retriable is for failures, not stuff like status transitions from IN_PROGRESS -&gt; READY</z><z id="t1655913653" t="ghadi probably could use an issue for adding Waiters to aws-api"><y>#</y><d>2022-06-22</d><h>16:00</h><r>ghadi</r>probably could use an issue for adding Waiters to aws-api</z><z id="t1656087175" t="Martynas M Hey. I&apos;m thinking about a very basic code deploy functionality so that I could push a container and then change that version using Terraform. This works but now I think about DB migration. Basically that means that I want a second docker container that will contain the migrations. Currently I think whether I should include the migration functionality into the main production-like container or I could somehow make it work with two containers :thinking_face: Does anyone have any other ideas? I&apos;ll be using this alone so for now I don&apos;t need full CICD and code building thing."><y>#</y><d>2022-06-24</d><h>16:12</h><w>Martynas M</w>Hey.
I&apos;m thinking about a very basic code deploy functionality so that I could push a container and then change that version using Terraform.
This works but now I think about DB migration. Basically that means that I want a second docker container that will contain the migrations.

Currently I think whether I should include the migration functionality into the main production-like container or I could somehow make it work with two containers <b>:thinking_face:</b>

Does anyone have any other ideas? I&apos;ll be using this alone so for now I don&apos;t need full CICD and code building thing.</z><z id="t1656087602" t="valtteri I&apos;ve encountered two approaches. One is to run migrations each time the app starts. Downside is that the runtime will have privileges for schema alterations. Another approach is to have a build step rhat runs the migrations where the downside is additional complexity. Not aware of other ways."><y>#</y><d>2022-06-24</d><h>16:20</h><r>valtteri</r>I&apos;ve encountered two approaches. One is to run migrations each time the app starts. Downside is that the runtime will have privileges for schema alterations. Another approach is to have a build step rhat runs the migrations where the downside is additional complexity. Not aware of other ways.</z><z id="t1656087719" t="Martynas M In my case I also have a JVM artifact that has some JARs that it depends on. And that means that the resulting container would have to contain all of them :thinking_face: But probably that&apos;s the way for now."><y>#</y><d>2022-06-24</d><h>16:21</h><r>Martynas M</r>In my case I also have a JVM artifact that has some JARs that it depends on. And that means that the resulting container would have to contain all of them <b>:thinking_face:</b>
But probably that&apos;s the way for now.</z><z id="t1656446603" t="viesti In the past, I have had CI step run the migrations, by tunneling to the database from the CI. You could also use the same container image as the app, and have say an environment variable, based on which you select an entrypoint to run migrations, instead of the normal application start. You could then call https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_RunTask.html to run a single container to do the migrations, and poll for the exit code of the task created by that API call with https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_DescribeTasks.html#API_DescribeTasks_ResponseSyntax . That migration task can then use a user that has more rights (rights to migrate schema) than the application user. This way you don’t need to tunnel access to the database from the CI."><y>#</y><d>2022-06-28</d><h>20:03</h><r>viesti</r>In the past, I have had CI step run the migrations, by tunneling to the database from the CI.

You could also use the same container image as the app, and have say an environment variable, based on which you select an entrypoint to run migrations, instead of the normal application start. You could then call <a href="https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_RunTask.html" target="_blank">https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_RunTask.html</a> to run a single container to do the migrations, and poll for the exit code of the task created by that API call with <a href="https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_DescribeTasks.html#API_DescribeTasks_ResponseSyntax" target="_blank">https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_DescribeTasks.html#API_DescribeTasks_ResponseSyntax</a>. That migration task can then use a user that has more rights (rights to migrate schema) than the application user. This way you don’t need to tunnel access to the database from the CI.</z><z id="t1656430506" t="iamjarvo I have a repl with the where i am experimenting with aws-api it uses the default profile creds which expires. when the profile creds are renewed the code still uses the expired creds. i was reading through the docs and the code to figure out what i should be doing differently but havent come across anything. seems like cached-credentials-with-auto-refresh is called for profiles so i am assuming that the creds should auto refresh https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L233 (def secretsmanager-client (aws/client {:api :secretsmanager :region &quot;us-west-2&quot;}))"><y>#</y><d>2022-06-28</d><h>15:35</h><w>iamjarvo</w>I have a repl with the where i am experimenting with <code>aws-api</code>  it uses the default profile creds which expires. when the profile creds are renewed the code still uses the expired creds. i was reading through the docs and the code to figure out what  i should be doing differently but havent come across anything. seems like <code>cached-credentials-with-auto-refresh</code> is called for profiles so i am assuming that the creds should auto refresh <a href="https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L233" target="_blank">https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L233</a>

<pre>(def secretsmanager-client
  (aws/client
   {:api :secretsmanager
    :region &quot;us-west-2&quot;}))</pre></z><z id="t1656431259" t="lukasz I think it depends on the type of auth you&apos;re using - e.g. I had to implement our own to use AWS SSO creds, and that requires refresh"><y>#</y><d>2022-06-28</d><h>15:47</h><r>lukasz</r>I think it depends on the type of auth you&apos;re using - e.g. I had to implement our own to use AWS SSO creds, and that requires refresh</z><z id="t1657031129" t="Benjamin if you would build a web app ala clj-kit, how would you deploy? Just lambda?"><y>#</y><d>2022-07-05</d><h>14:25</h><w>Benjamin</w>if you would build a web app ala clj-kit, how would you deploy? Just lambda?</z><z id="t1657031775" t="Karol Wójcik Clj-kit?"><y>#</y><d>2022-07-05</d><h>14:36</h><r>Karol Wójcik</r>Clj-kit?</z><z id="t1657035124" t="Benjamin https://kit-clj.github.io/ I just mean the style of app. Like you have some website, and it has some frontend, users click around maybe"><y>#</y><d>2022-07-05</d><h>15:32</h><r>Benjamin</r><a href="https://kit-clj.github.io/" target="_blank">https://kit-clj.github.io/</a> I just mean the style of app.
Like you have some website, and it has some frontend, users click around maybe</z><z id="t1657035253" t="Benjamin I guess it was called kit-clj"><y>#</y><d>2022-07-05</d><h>15:34</h><r>Benjamin</r>I guess it was called kit-clj</z><z id="t1657040978" t="Karol Wójcik Lambda and hl ring adapter to host static files if the size of a single file is less than 11MB and you dont expect much traffic. But if you do then S3 + Cloudfront is the cheapest option on AWS."><y>#</y><d>2022-07-05</d><h>17:09</h><r>Karol Wójcik</r>Lambda and hl ring adapter to host static files if the size of a single file is less than 11MB and you dont expect much traffic. But if you do then S3 + Cloudfront is the cheapest option on AWS.</z><z id="t1657091803" t="Dimitar Uzunov What artifacts does clj-kit produce? I assume a JAR + some static assets?"><y>#</y><d>2022-07-06</d><h>07:16</h><r>Dimitar Uzunov</r>What artifacts does clj-kit produce? I assume a JAR + some static assets?</z><z id="t1657091873" t="Dimitar Uzunov seems like the static assets are in the jar, so only a jar"><y>#</y><d>2022-07-06</d><h>07:17</h><r>Dimitar Uzunov</r>seems like the static assets are in the jar, so only a jar</z><z id="t1657091904" t="Dimitar Uzunov I would probably deploy on an ec2 instance"><y>#</y><d>2022-07-06</d><h>07:18</h><r>Dimitar Uzunov</r>I would probably deploy on an ec2 instance</z><z id="t1657091915" t="Dimitar Uzunov the new graviton ones can be really affordable"><y>#</y><d>2022-07-06</d><h>07:18</h><r>Dimitar Uzunov</r>the new graviton ones can be really affordable</z><z id="t1657091936" t="Dimitar Uzunov and the JVM doesn’t care its ARM 🙂"><y>#</y><d>2022-07-06</d><h>07:18</h><r>Dimitar Uzunov</r>and the JVM doesn’t care its ARM <b>🙂</b></z><z id="t1657092139" t="Dimitar Uzunov You need to configure nginx with some nice secure setting, lets encrypt + a systemd service for the jar. If I were to do it from scratch I would template the configs with sablono which is included in babashka and run all of that from cloud-init - nice and simple 🙂"><y>#</y><d>2022-07-06</d><h>07:22</h><r>Dimitar Uzunov</r>You need to configure nginx with some nice secure setting, lets encrypt + a systemd service for the jar. If I were to do it from scratch I would template the configs with sablono which is included in babashka and run all of that from cloud-init - nice and simple <b>🙂</b></z><z id="t1657092448" t="Dimitar Uzunov or I will try Lightsail (the AWS VPS); of course I’m making a lot of assumptions on the needs."><y>#</y><d>2022-07-06</d><h>07:27</h><r>Dimitar Uzunov</r>or I will try Lightsail (the AWS VPS); of course I’m making a lot of assumptions on the needs.</z><z id="t1657093487" t="Karol Wójcik [:attrs {:href &quot;/_/_/users/U02CV2P4J6S&quot;}] can you elaborate what is your use case and what you need? How frequently the API will be used etc? PS: You can always develop your app with clj-kit and add hl-ring-adapter to target Lambda, since I know you mostly build apps on this service."><y>#</y><d>2022-07-06</d><h>07:44</h><r>Karol Wójcik</r><a>@U02CV2P4J6S</a> can you elaborate what is your use case and what you need? How frequently the API will be used etc?

PS: You can always develop your app with clj-kit and add hl-ring-adapter to target Lambda, since I know you mostly build apps on this service.</z><z id="t1657094179" t="Benjamin sounds interesting. It would be single users (team mates in house) clicking around for a few minutes. The thing would serve I think small html files. 1. a session might be more than 15min 2. I like the user to login with oauth2, so I would like to keep a session around. I guess with lambda I would need to log them in again after 15min, or persist the session."><y>#</y><d>2022-07-06</d><h>07:56</h><r>Benjamin</r>sounds interesting.
It would be single users (team mates in house) clicking around for a few minutes. The thing would serve I think small html files.
1. a session might be   more than 15min
2. I like the user to login with  oauth2, so I would like to keep a session around. 
I guess with lambda I would need to log them in again after 15min, or persist the session.</z><z id="t1657097205" t="Karol Wójcik &gt; persist the session Isn&apos;t oauth2 a stateless authentication strategy? Therefore by persist you mean a &quot;cookie&quot; on frontend side? If yes why would you bother with how long the lambda lives?"><y>#</y><d>2022-07-06</d><h>08:46</h><r>Karol Wójcik</r>&gt; persist the session
Isn&apos;t oauth2 a stateless authentication strategy? Therefore by persist you mean a &quot;cookie&quot; on frontend side? If yes why would you bother with how long the lambda lives?</z></g><g id="s17"><z id="t1657100261" t="Benjamin You probably make perfect sense, yea. Indeed the fronted cookie fixes it"><y>#</y><d>2022-07-06</d><h>09:37</h><r>Benjamin</r>You probably make perfect sense, yea. Indeed the fronted cookie fixes it</z><z id="t1657100435" t="Karol Wójcik Okay, so if you expect only few mates to use the service then maybe you don&apos;t need Cloudfront, EC2, Nginx or whatever. Single lambda will do the trick."><y>#</y><d>2022-07-06</d><h>09:40</h><r>Karol Wójcik</r>Okay, so if you expect only few mates to use the service then  maybe you don&apos;t need Cloudfront, EC2, Nginx or whatever. Single lambda will do the trick.</z><z id="t1657101010" t="Benjamin yea thanks. I&apos;ll keep EC2 in mind for the next bigger thing"><y>#</y><d>2022-07-06</d><h>09:50</h><r>Benjamin</r>yea thanks. I&apos;ll keep EC2 in mind for the next bigger thing</z><z id="t1657101278" t="Karol Wójcik Yeah, you can also switch to EC2 if you didn&apos;t like the Lambda experience. Adding/removing adapter to a project is 2/3 lines of code 🙂"><y>#</y><d>2022-07-06</d><h>09:54</h><r>Karol Wójcik</r>Yeah, you can also switch to EC2 if you didn&apos;t like the Lambda experience. Adding/removing adapter to a project is 2/3 lines of code <b>🙂</b></z><z id="t1657124425" t="Martynas M Hey. I&apos;ve came accross this funny error that makes my webpage redirect to HTTPS when it&apos;s already on HTTPS. It does that because after the balancer routes the requests it uses HTTP in the internal AWS network. So that makes my server think that it&apos;s on HTTP 🥳 and it responds with 301 to HTTPS 💥 . Is there a way to fix it by sending HTTPS traffic to the service and not HTTP? Basically my question is: How do I prevent at least the HTTP MITM inside AWS?"><y>#</y><d>2022-07-06</d><h>16:20</h><w>Martynas M</w>Hey.
I&apos;ve came accross this funny error that makes my webpage redirect to HTTPS when it&apos;s already on HTTPS. It does that because after the balancer routes the requests it uses HTTP in the internal AWS network.
So that makes my server think that it&apos;s on HTTP <b>🥳</b>  and it responds with 301 to HTTPS <b>💥</b>.
Is there a way to fix it by sending HTTPS traffic to the service and not HTTP?

Basically my question is: How do I prevent at least the HTTP MITM inside AWS?</z><z id="t1657126532" t="jumar You should be able to configure the load balancer listener to use https if you really want to do that. But then you need to manage TLS certificates in multiple places?"><y>#</y><d>2022-07-06</d><h>16:55</h><r>jumar</r>You should be able to configure the load balancer listener to use https if you really want to do that. But then you need to manage TLS certificates in multiple places?</z><z id="t1657126693" t="Martynas M I already configured the outside one to provide a certificate. Web -&gt; HTTPS -&gt; LB -&gt; HTTP -&gt; Back-end But that HTTP layer is something that I don&apos;t know whether it&apos;s good :thinking_face: Is it worth doing? I&apos;m not sure"><y>#</y><d>2022-07-06</d><h>16:58</h><r>Martynas M</r>I already configured the outside one to provide a certificate.
<code>Web -&gt; HTTPS -&gt; LB -&gt; HTTP -&gt; Back-end</code>
But that <code>HTTP</code> layer is something that I don&apos;t know whether it&apos;s good <b>:thinking_face:</b>

Is it worth doing? I&apos;m not sure</z><z id="t1657126854" t="jumar We use HTTP inside and I think it&apos;s fine. But your requirements might be different. Anyway, you should be able to configure the target group to use HTTPS: https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-target-group.html"><y>#</y><d>2022-07-06</d><h>17:00</h><r>jumar</r>We use HTTP inside and I think it&apos;s fine.
But your requirements might be different.
Anyway, you should be able to configure the target group to use HTTPS: <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-target-group.html" target="_blank">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-target-group.html</a></z><z id="t1657170740" t="Leaf Garland We fixed what seems like the same thing recently (redirects go to http by default because we terminate https further downstream). We are using nginx, and used proxy_redirect http:// https://; to get nginx to change the location header in redirects to use https."><y>#</y><d>2022-07-07</d><h>05:12</h><r>Leaf Garland</r>We fixed what seems like the same thing recently (redirects go to http by default because we terminate https further downstream). We are using nginx, and used <code>proxy_redirect http:// https://;</code> to get nginx to change the location header in redirects to use https.</z><z id="t1657172585" t="Martynas M But even if you use nginx to receive encrypted traffic then part of your traffic is still unencrypted inside of AWS network. So yes, you simply move the problem further but it&apos;s still unencrypted when it reaches the back-end :thinking_face:"><y>#</y><d>2022-07-07</d><h>05:43</h><r>Martynas M</r>But even if you use nginx to receive encrypted traffic then part of your traffic is still unencrypted inside of AWS network.
So yes, you simply move the problem further but it&apos;s still unencrypted when it reaches the back-end <b>:thinking_face:</b></z><z id="t1657172973" t="Leaf Garland Perhaps we didn&apos;t have the same issue. In our case it&apos;s all HTTP inside the load balancer. When our clojure app redirects, eg. 302 location /somepage the location header would end up with a value like http://example.com/somepage but it should have been https://example.com/somepage . This added an extra HTTP hop into our redirects. Apologies for the distraction if this is not similar to what you&apos;re dealing with."><y>#</y><d>2022-07-07</d><h>05:49</h><r>Leaf Garland</r>Perhaps we didn&apos;t have the same issue. In our case it&apos;s all HTTP inside the load balancer. When our clojure app redirects, eg. 302 location /somepage the location header would end up with a value like <a href="http://example.com/somepage" target="_blank">http://example.com/somepage</a> but it should have been <a href="https://example.com/somepage" target="_blank">https://example.com/somepage</a>. This added an extra HTTP hop into our redirects. Apologies for the distraction if this is not similar to what you&apos;re dealing with.</z><z id="t1657173079" t="jumar I think you are talking about different things. The issue that Leaf is mentioning is relatively common. It&apos;s a mismatch between the app who thinks there&apos;s only &quot;HTTP world &quot; while the client behind the load balancer thinks there&apos;s only &quot;HTTPS world&quot;. One common culprit of this is &quot;Absolute redirects&quot; - see https://github.com/ring-clojure/ring-defaults/pull/40 Martynas seem to have an app that&apos;s aware of HTTPS (is actually forcing HTTPS)"><y>#</y><d>2022-07-07</d><h>05:51</h><r>jumar</r>I think you are talking about different things.
The issue that Leaf is mentioning is relatively common.
It&apos;s a mismatch between the app who thinks there&apos;s only &quot;HTTP world &quot; while the client behind the load balancer thinks there&apos;s only &quot;HTTPS world&quot;.
One common culprit of this is &quot;Absolute redirects&quot; - see <a href="https://github.com/ring-clojure/ring-defaults/pull/40" target="_blank">https://github.com/ring-clojure/ring-defaults/pull/40</a>

Martynas seem to have an app that&apos;s aware of HTTPS (is actually forcing HTTPS)</z><z id="t1657173166" t="Leaf Garland [:attrs {:href &quot;/_/_/users/U06BE1L6T&quot;}] thanks for clarifying, and many thanks for pointing out that issue - could be helpful."><y>#</y><d>2022-07-07</d><h>05:52</h><r>Leaf Garland</r><a>@U06BE1L6T</a> thanks for clarifying, and many thanks for pointing out that issue - could be helpful.</z><z id="t1657173170" t="jumar [:attrs {:href &quot;/_/_/users/U028ART884X&quot;}] I think you just need to decide whether you need HTTPS inside VPC - if so, then configure the load balancer to use HTTPS, that&apos;s it."><y>#</y><d>2022-07-07</d><h>05:52</h><r>jumar</r><a>@U028ART884X</a> I think you just need to decide whether you need HTTPS inside VPC - if so, then configure the load balancer to use HTTPS, that&apos;s it.</z><z id="t1657173523" t="Martynas M I already configured it back to HTTP because it&apos;s simpler. But I&apos;m not yet sure how absolute redirects work and I do remember that I enabled them. So yes, probably that could be a problem."><y>#</y><d>2022-07-07</d><h>05:58</h><r>Martynas M</r>I already configured it back to HTTP because it&apos;s simpler. But I&apos;m not yet sure how absolute redirects work and I do remember that I enabled them. So yes, probably that could be a problem.</z><z id="t1657173634" t="jumar I submitted a patch that changed ring-defaults so it shouldn&apos;t force it by default. We also had issues with friend library - I think it&apos;s linked in the PR. Another thing is that some servers like Jetty (used to?) force absolute redirects."><y>#</y><d>2022-07-07</d><h>06:00</h><r>jumar</r>I submitted a patch that changed ring-defaults so it shouldn&apos;t force it by default.
We also had issues with friend library - I think it&apos;s linked in the PR.

Another thing is that some servers like Jetty (used to?) force absolute redirects.</z><z id="t1657569749" t="jjttjj I keep getting the following error when attempting to use timestream from aws-api . Any tips on how to debug this? It seems to be happening on all the :timestream-write endpoints. I&apos;m using the latest deps for the api/endpoints/services. (def tsw (aws/client {:api :timestream-write :region &quot;us-east-1&quot;})) (aws/invoke tsw {:op :CreateDatabase :request {:DatabaseName &quot;test123&quot;}}) {:__type &quot;com.amazon.coral.service#UnknownOperationException&quot;, :cognitect.anomalies/category :cognitect.anomalies/not-found} (meta (aws/invoke tsw {:op :CreateDatabase :request {:DatabaseName &quot;test123&quot;}})) {:http-request {:request-method :post, :scheme :https, :server-port 443, :uri &quot;/&quot;, :headers {&quot;x-amz-date&quot; &quot;20220711T200159Z&quot;, &quot;x-amz-target&quot; &quot;Timestream_20181101.CreateDatabase&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;, &quot;accept&quot; &quot;application/json&quot;, &quot;host&quot; &quot;&quot;, &quot;authorization&quot; &quot;...&quot;}, :body #object[java.nio.HeapByteBuffer 0x1ad00694 &quot;java.nio.HeapByteBuffer[pos=0 lim=26 cap=26]&quot;], :server-name &quot;&quot;}, :http-response {:status 404, :headers {&quot;x-amzn-requestid&quot; &quot;b6d35cfb-c4df-4c2c-b819-445df0ed9d65&quot;, &quot;content-length&quot; &quot;63&quot;, &quot;date&quot; &quot;Mon, 11 Jul 2022 20:01:58 GMT&quot;, &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;}, :body #object[java.io.BufferedInputStream 0xbf8e637 &quot;"><y>#</y><d>2022-07-11</d><h>20:02</h><w>jjttjj</w>I keep getting the following error when attempting to use timestream from <code>aws-api</code>. Any tips on how to debug this? It seems to be happening on all the <code>:timestream-write</code> endpoints. I&apos;m using the latest deps for the api/endpoints/services.

<pre>(def tsw (aws/client {:api :timestream-write
                      :region &quot;us-east-1&quot;}))

(aws/invoke tsw
  {:op      :CreateDatabase
   :request {:DatabaseName &quot;test123&quot;}})</pre>
<pre>{:__type                       &quot;com.amazon.coral.service#UnknownOperationException&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/not-found}</pre>
<pre>(meta
  (aws/invoke tsw
    {:op      :CreateDatabase
     :request {:DatabaseName &quot;test123&quot;}}))

{:http-request
 {:request-method :post,
  :scheme         :https,
  :server-port    443,
  :uri            &quot;/&quot;,
  :headers
  {&quot;x-amz-date&quot;   &quot;20220711T200159Z&quot;,
   &quot;x-amz-target&quot; &quot;Timestream_20181101.CreateDatabase&quot;,
   &quot;content-type&quot; &quot;application/x-amz-json-1.0&quot;,
   &quot;accept&quot;       &quot;application/json&quot;,
   &quot;host&quot;         &quot;&quot;,
   &quot;authorization&quot;
   &quot;...&quot;},
  :body
  #object[java.nio.HeapByteBuffer 0x1ad00694 &quot;java.nio.HeapByteBuffer[pos=0 lim=26 cap=26]&quot;],
  :server-name    &quot;&quot;},
 :http-response
 {:status 404,
  :headers
  {&quot;x-amzn-requestid&quot; &quot;b6d35cfb-c4df-4c2c-b819-445df0ed9d65&quot;,
   &quot;content-length&quot;   &quot;63&quot;,
   &quot;date&quot;             &quot;Mon, 11 Jul 2022 20:01:58 GMT&quot;,
   &quot;content-type&quot;     &quot;application/x-amz-json-1.0&quot;},
  :body
  #object[java.io.BufferedInputStream 0xbf8e637 &quot;</pre></z><z id="t1657571598" t="jjttjj Ok I got it. Timestream requires a custom endpoint described here: https://docs.aws.amazon.com/timestream/latest/developerguide/API_DescribeEndpoints.html So to use the cognitect lib you need to make a client, get the endpoint address, then make a new client using that endpoint adddress, like so: (def tsw (aws/client {:api :timestream-write :region &quot;us-east-1&quot; :endpoint-override {:hostname (-&gt; (aws/invoke (aws/client {:api :timestream-write :region &quot;us-east-1&quot;}) {:op :DescribeEndpoints :request {}}) :Endpoints first :Address)}}))"><y>#</y><d>2022-07-11</d><h>20:33</h><r>jjttjj</r>Ok I got it. Timestream requires a custom endpoint described here:
<a href="https://docs.aws.amazon.com/timestream/latest/developerguide/API_DescribeEndpoints.html" target="_blank">https://docs.aws.amazon.com/timestream/latest/developerguide/API_DescribeEndpoints.html</a>
So to use the cognitect lib you need to make a client, get the endpoint address, then make a new client using that endpoint adddress, like so:
(def tsw (aws/client {:api :timestream-write
                      :region &quot;us-east-1&quot;
                      :endpoint-override
                      {:hostname (-&gt; (aws/invoke (aws/client {:api :timestream-write
                                                                                          :region &quot;us-east-1&quot;})
                                       {:op      :DescribeEndpoints
                                        :request {}})
                                     :Endpoints
                                     first
                                     :Address)}}))</z><z id="t1657915568" t="Drew Verlee Is there anything that makes working with Codeformation easier in terms of seeing documentation? Or is the best thing to just click around the aws cloudformation docs? For example i&apos;m looking at an https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-codepipeline-pipeline-stages-actions-actiontypeid.html with a Category value of Source but annoyingly &quot;Source&quot; isn&apos;t a link itself so i it&apos;s not immediately clear what it means."><y>#</y><d>2022-07-15</d><h>20:06</h><w>Drew Verlee</w>Is there anything that makes working with Codeformation easier in terms of seeing documentation? Or is the best thing to just click around the aws cloudformation docs? For example i&apos;m looking at an <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-codepipeline-pipeline-stages-actions-actiontypeid.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-codepipeline-pipeline-stages-actions-actiontypeid.html</a> with a Category value of <code>Source</code> but annoyingly &quot;Source&quot; isn&apos;t a link itself so i it&apos;s not immediately clear what it means.</z><z id="t1657925430" t="jjttjj Some of the Cloudformation pages are better than others. I&apos;ve heard they&apos;re pretty responsive to the feedback you can provide at the bottom of the page. I haven&apos;t yet found great alternative to just jumping back and forth a ton between the cloudformation docs and various parts of the service&apos;s docs."><y>#</y><d>2022-07-15</d><h>22:50</h><r>jjttjj</r>Some of the Cloudformation pages are better than others. I&apos;ve heard they&apos;re pretty responsive to the feedback you can provide at the bottom of the page.
I haven&apos;t yet found great alternative to just jumping back and forth a ton between the cloudformation docs and various parts of the service&apos;s docs.</z><z id="t1658113888" t="seepel Hi there, I&apos;m trying to use the java aws sdk to initialize a SecretsManagerClient following along with examples I found online this is the code I expect to work (-&gt; (SecretsManagerClient/builder) (.region (Region/of &quot;us-west-2&quot;)) .build) But I get the following error Execution error (IllegalArgumentException) at user/eval18745 (form-init12695352935497667069.clj:1). No matching method of found taking 1 args for class java.lang.Class However, if I import the class at the repl, calling (Region/of &quot;us-west-2&quot;) does indeed work correctly. Does anyone have experience with something like this? EDIT: here is another more clear error message that I also got: No matching method of found taking 1 args for class com.amazonaws.regions.Region "><y>#</y><d>2022-07-18</d><h>03:11</h><w>seepel</w>Hi there, I&apos;m trying to use the java aws sdk to initialize a <code>SecretsManagerClient</code>  following along with examples I found online this is the code I expect to work
<pre>(-&gt; (SecretsManagerClient/builder)
                   (.region (Region/of &quot;us-west-2&quot;))
                   .build)</pre>
But I get the following error
<pre>Execution error (IllegalArgumentException) at user/eval18745 (form-init12695352935497667069.clj:1).
No matching method of found taking 1 args for class java.lang.Class</pre>
However, if I import the class at the repl, calling
<pre>(Region/of &quot;us-west-2&quot;)</pre>
does indeed work correctly. Does anyone have experience with something like this?

EDIT: here is another more clear error message that I also got:
<pre>No matching method of found taking 1 args for class com.amazonaws.regions.Region</pre>
</z><z id="t1658114382" t="hiredman https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/regions/Region.html has no of method"><y>#</y><d>2022-07-18</d><h>03:19</h><w>hiredman</w><a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/regions/Region.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/regions/Region.html</a> has no of method</z><z id="t1658114446" t="hiredman My guess is when you &quot;import the class at the repl&quot; you are importing a different class"><y>#</y><d>2022-07-18</d><h>03:20</h><w>hiredman</w>My guess is when you &quot;import the class at the repl&quot; you are importing a different class</z><z id="t1658114762" t="seepel Ohhhh, indeed. In my code it is imported as (com.amazon.regions Region) Whereas at the repl I imported (software.amazon.awssdk.regions Region) The latter doesn&apos;t work in my namespace though... Even though I guess I don&apos;t really understand what is going on, I think I did sort out that I can get the region like this... (-&gt; (SecretsManagerClient/builder) (.region (Region/getRegion Regions/US_WEST_2)) .build) Thank you for the tip [:attrs {:href &quot;/_/_/users/U0NCTKEV8&quot;}] !"><y>#</y><d>2022-07-18</d><h>03:26</h><w>seepel</w>Ohhhh, indeed. In my code it is imported as
<pre>(com.amazon.regions Region)</pre>
Whereas at the repl I imported
<pre>(software.amazon.awssdk.regions Region)</pre>
The latter doesn&apos;t work in my namespace though...

Even though I guess I don&apos;t  really understand what is going on, I think I did sort out that I can get the region like this...
<pre>(-&gt; (SecretsManagerClient/builder)
                   (.region (Region/getRegion Regions/US_WEST_2))
                   .build)</pre>
Thank you for the tip <a>@hiredman</a>!</z><z id="t1658114914" t="seepel Oh gosh, maybe not. class com.amazonaws.regions.Region cannot be cast to class software.amazon.awssdk.regions.Region (com.amazonaws.regions.Region and software.amazon.awssdk.regions.Region are in unnamed module of loader &apos;app&apos;)"><y>#</y><d>2022-07-18</d><h>03:28</h><w>seepel</w>Oh gosh, maybe not.
<pre>class com.amazonaws.regions.Region cannot be cast to class software.amazon.awssdk.regions.Region (com.amazonaws.regions.Region and software.amazon.awssdk.regions.Region are in unnamed module of loader &apos;app&apos;)</pre></z><z id="t1658115115" t="seepel I must&apos;ve had a typo, I just deleted everything and very carefully added it back in. Thank you for the duckie"><y>#</y><d>2022-07-18</d><h>03:31</h><w>seepel</w>I must&apos;ve had a typo, I just deleted everything and very carefully added it back in. Thank you for the <b>duckie</b></z><z id="t1658161135" t="Benjamin Does anybody have experience with redshift and sorting the data correctly, so queries stay fast? General RDB advice is welcome"><y>#</y><d>2022-07-18</d><h>16:18</h><w>Benjamin</w>Does anybody have experience with redshift and sorting the data correctly,  so queries stay fast? General RDB advice is welcome</z><z id="t1658182598" t="Drew Verlee advice specific to redshift or in general? In general the only way something can traverse something fast is if it&apos;s close together. As in, you have to store things in the sorted order. In database speak, that&apos;s indexing. space for time."><y>#</y><d>2022-07-18</d><h>22:16</h><r>Drew Verlee</r>advice specific to redshift or in general?

In general the only way something can traverse something fast is if it&apos;s close together. As in, you have to store things in the sorted order. In database speak, that&apos;s indexing. space for time.</z><z id="t1658182659" t="Drew Verlee In cloudformation, when your spinning up resources, if one requires the ARN of another how do you handle that? like, how do they do references?"><y>#</y><d>2022-07-18</d><h>22:17</h><w>Drew Verlee</w>In cloudformation, when your spinning up resources, if one requires the ARN of another how do you handle that? like, how do they do references?</z><z id="t1658182763" t="jjttjj https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html"><y>#</y><d>2022-07-18</d><h>22:19</h><r>jjttjj</r><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html</a></z><z id="t1658182767" t="Drew Verlee probably !REF https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html"><y>#</y><d>2022-07-18</d><h>22:19</h><r>Drew Verlee</r>probably <code>!REF</code> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html</a></z><z id="t1658182789" t="Drew Verlee lol. thanks [:attrs {:href &quot;/_/_/users/U064UGEUQ&quot;}]"><y>#</y><d>2022-07-18</d><h>22:19</h><r>Drew Verlee</r>lol. thanks <a>@U064UGEUQ</a></z><z id="t1658182847" t="Drew Verlee i&apos;ll figure it out from here i&apos;m sure, but this example is funny because it has a ref but not the important bit where it shows the other end of the edge. MyEIP: Type: &quot;AWS::EC2::EIP&quot; Properties: InstanceId: !Ref MyEC2Instance # &lt;--- where is this declared?"><y>#</y><d>2022-07-18</d><h>22:20</h><r>Drew Verlee</r>i&apos;ll figure it out from here i&apos;m sure, but this example is funny because it has a ref but not the important bit where it shows the other end of the edge.

<pre>MyEIP:
  Type: &quot;AWS::EC2::EIP&quot;
  Properties:
    InstanceId: !Ref MyEC2Instance # &lt;--- where is this declared?</pre></z><z id="t1658182855" t="jjttjj Depending on the resource type, it may or may not return what you need for the other resource parameter. Sometimes you&apos;ll need to use Fn::GetAtt instead. I find i consult this a lot https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/"><y>#</y><d>2022-07-18</d><h>22:20</h><r>jjttjj</r>Depending on the resource type, it may or may not return what you need for the other resource parameter. Sometimes you&apos;ll need to use <code>Fn::GetAtt</code> instead. I find i consult this a lot
<a href="https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/" target="_blank">https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/</a></z><z id="t1658182924" t="jjttjj The Ref argument refers to either the name you give the resource (ie, names on the level of MyEIP in that example, MyEC2Instance would be a sibling ), or the name of a parameter of your template. (and maybe some more stuff I&apos;m forgetting)"><y>#</y><d>2022-07-18</d><h>22:22</h><r>jjttjj</r>The Ref argument refers to either the name you give the resource (ie, names on the level of MyEIP in that example, MyEC2Instance
would be a sibling ), or the name of a parameter of your template. (and maybe some more stuff I&apos;m forgetting)</z><z id="t1658183014" t="Drew Verlee This is how cloudformation makes me feel on the inside."><y>#</y><d>2022-07-18</d><h>22:23</h><r>Drew Verlee</r>This is how cloudformation makes me feel on the inside.</z><z id="t1658183064" t="jjttjj Haha yup it definitely feels like coding in json a bit, wait til you get to if statements/conditionals"><y>#</y><d>2022-07-18</d><h>22:24</h><r>jjttjj</r>Haha yup it definitely feels like coding in json a bit, wait til you get to if statements/conditionals</z><z id="t1658183284" t="jjttjj I&apos;ve been on an ongoing deep dive in to cloudformation. Overall I like it, after getting comfortable with the ways to do things. In the end I like that it&apos;s just JSON and it&apos;s nice that you can just stick some edn in a clojure file and break it up and add as many helpers as you want before calling some json library to write it out as json."><y>#</y><d>2022-07-18</d><h>22:28</h><r>jjttjj</r>I&apos;ve been on an ongoing deep dive in to cloudformation. Overall I like it, after getting comfortable with the ways to do things. In the end I like that it&apos;s just JSON and it&apos;s nice that you can just stick some edn in a clojure file and break it up and add as many helpers as you want before calling some json library to write it out as json.</z><z id="t1658183620" t="Drew Verlee I&apos;m certainly glad it&apos;s an option! I wonder if there are any clojure wrappers that do some really fun runtime analysis to try and help you intelligent build and update cloudformation though. You could pull the api and return suggestions in the editor. etc... I know you can output CF from the design tool, but it doesn&apos;t seem to actually help you with anything other then putting pictures together. which is odd... Is &quot;taskdefination&quot; the name of the instance of this task below? taskdefinition: Type: AWS::ECS::TaskDefinition "><y>#</y><d>2022-07-18</d><h>22:33</h><r>Drew Verlee</r>I&apos;m certainly glad it&apos;s an option!

I wonder if there are any clojure wrappers that do some really fun runtime analysis to try and help you intelligent build and update cloudformation though. You could pull the api and return suggestions in the editor. etc...

I know you can output CF from the design tool, but it doesn&apos;t seem to actually help you with anything other then putting pictures together. which is odd...

Is &quot;taskdefination&quot; the name of the instance of this task below?

<pre>taskdefinition: 
  Type: AWS::ECS::TaskDefinition</pre>
</z><z id="t1658183675" t="jjttjj yes"><y>#</y><d>2022-07-18</d><h>22:34</h><r>jjttjj</r>yes</z><z id="t1658183762" t="jjttjj {:Resources {&quot;&lt;your names&gt;&quot; {:Type &quot;&quot; :Properties {...}} ...}"><y>#</y><d>2022-07-18</d><h>22:36</h><r>jjttjj</r><pre>{:Resources {&quot;&lt;your names&gt;&quot; {:Type &quot;&quot; :Properties {...}} ...}</pre></z><z id="t1658184023" t="jjttjj There are a few attempts at tooling in clojure ie https://github.com/brabster/crucible , but I don&apos; think it has that many resource types supported and isn&apos;t actively being updated"><y>#</y><d>2022-07-18</d><h>22:40</h><r>jjttjj</r>There are a few attempts at tooling in clojure ie <a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a>, but I don&apos; think it has that many resource types supported and isn&apos;t actively being updated</z><z id="t1658184068" t="jjttjj the specification for everything is here though so it shouldn&apos;t be too hard to get an auto-complete thing going https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html"><y>#</y><d>2022-07-18</d><h>22:41</h><r>jjttjj</r>the specification for everything is here though so it shouldn&apos;t be too hard to get an auto-complete thing going <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html</a></z><z id="t1658184163" t="Drew Verlee interesting, ill have to take a look. If for no other reason then it will probably help me conceptualize whats going on."><y>#</y><d>2022-07-18</d><h>22:42</h><r>Drew Verlee</r>interesting, ill have to take a look. If for no other reason then it will probably help me conceptualize whats going on.</z><z id="t1658204116" t="Drew Verlee My toy cf template fails. I shall resolve to understand why in the morning. The error is Requested attribute Arn does not exist in schema for AWS::ECS::TaskDefinition and i don&apos;t understand why because i feel like it should have an Arn. My worry is that you have to have a cluster that the task definition is part of. Though that doesn&apos;t make sense to me because i thought the point of fargate was that you didn&apos;t have to do that. AWSTemplateFormatVersion: 2010-09-09 Description: The template used to create an ECS Task definition from the ECS Console. Resources: JarCreator: Type: &apos;AWS::ECS::TaskDefinition&apos; Properties: ContainerDefinitions: - LogConfiguration: Options: awslogs-group: /ecs/tiny-function-task awslogs-region: us-east-2 awslogs-stream-prefix: ecs awslogs-create-group: &apos;true&apos; LogDriver: awslogs Name: tiny-function Image: &apos;&apos; Essential: true PortMappings: [] EnvironmentFiles: [] Family: tiny-function-task NetworkMode: awsvpc RequiresCompatibilities: - FARGATE Cpu: .5 vCPU Memory: 1 GB RuntimePlatform: CpuArchitecture: X86_64 OperatingSystemFamily: LINUX ExecutionRoleArn: &apos;arn:aws:iam::595680822218:role/ecsTaskExecutionRole&apos; Tags: - Key: &apos;ecs:taskDefinition:createdFrom&apos; Value: ecs-console-v2 - Key: &apos;ecs:taskDefinition:stackId&apos; Value: !Ref &apos;AWS::StackId&apos; Metadata: &apos;AWS::CloudFormation::Designer&apos;: id: 3b65a475-eeb6-45ea-b1f5-314e0b332333 Hourly: Type: &apos;AWS::Events::Rule&apos; Properties: Description: it does things you cant imagine ScheduleExpression: rate(1 hour) State: Enabled Targets: - Arn: !GetAtt - JarCreator - Arn ID: &quot;Id123&quot; EcsParameters: TaskDefinationArn: !Ref JarCreator EnableExecuteCommand: True LaunchType: FARGATE Outputs: TaskDefinitionARN: Description: The created task definition ARN. Value: !Ref JarCreator"><y>#</y><d>2022-07-19</d><h>04:15</h><w>Drew Verlee</w>My toy cf template fails. I shall resolve to understand why in the morning. The error is

<code>Requested attribute Arn does not exist in schema for AWS::ECS::TaskDefinition</code> and i don&apos;t understand why because i feel like it should have an Arn.

My worry is that you have to have a cluster that the task definition is part of. Though that doesn&apos;t make sense to me because i thought the point of fargate was that you didn&apos;t have to do that.

<pre>AWSTemplateFormatVersion: 2010-09-09
Description: The template used to create an ECS Task definition from the ECS Console.
Resources:
  JarCreator:
    Type: &apos;AWS::ECS::TaskDefinition&apos;
    Properties:
      ContainerDefinitions:
        - LogConfiguration:
            Options:
              awslogs-group: /ecs/tiny-function-task
              awslogs-region: us-east-2
              awslogs-stream-prefix: ecs
              awslogs-create-group: &apos;true&apos;
            LogDriver: awslogs
          Name: tiny-function
          Image: &apos;&apos;
          Essential: true
          PortMappings: []
          EnvironmentFiles: []
      Family: tiny-function-task
      NetworkMode: awsvpc
      RequiresCompatibilities:
        - FARGATE
      Cpu: .5 vCPU
      Memory: 1 GB
      RuntimePlatform:
        CpuArchitecture: X86_64
        OperatingSystemFamily: LINUX
      ExecutionRoleArn: &apos;arn:aws:iam::595680822218:role/ecsTaskExecutionRole&apos;
      Tags:
        - Key: &apos;ecs:taskDefinition:createdFrom&apos;
          Value: ecs-console-v2
        - Key: &apos;ecs:taskDefinition:stackId&apos;
          Value: !Ref &apos;AWS::StackId&apos;
    Metadata:
      &apos;AWS::CloudFormation::Designer&apos;:
        id: 3b65a475-eeb6-45ea-b1f5-314e0b332333
  Hourly:
    Type: &apos;AWS::Events::Rule&apos;
    Properties:
      Description: it does things you cant imagine
      ScheduleExpression: rate(1 hour)
      State: Enabled
      Targets: 
        - Arn: !GetAtt
          - JarCreator
          - Arn
          ID: &quot;Id123&quot;
          EcsParameters:
            TaskDefinationArn: !Ref JarCreator
            EnableExecuteCommand: True
            LaunchType: FARGATE
Outputs:
  TaskDefinitionARN:
    Description: The created task definition ARN.
    Value: !Ref JarCreator</pre></z><z id="t1658205183" t="hiredman It has been a few years since I tangled with cloudformation, but if recall you can think of a resource definition as sort of an expression that evaluates to creating the resource"><y>#</y><d>2022-07-19</d><h>04:33</h><w>hiredman</w>It has been a few years since I tangled with cloudformation, but if recall you can think of a resource definition as sort of an expression that evaluates to creating the resource</z><z id="t1658205249" t="hiredman The result of creating the resource is some value, which is bound to the name of the resource !Ref gets you the value bound to the name"><y>#</y><d>2022-07-19</d><h>04:34</h><w>hiredman</w>The result of creating the resource is some value, which is bound to the name of the resource !Ref gets you the value bound to the name</z><z id="t1658205275" t="hiredman The value returned from creating the resource is not always the arn is the tricky thing"><y>#</y><d>2022-07-19</d><h>04:34</h><w>hiredman</w>The value returned from creating the resource is not always the arn is the tricky thing</z><z id="t1658205285" t="hiredman Which I think is what that error means"><y>#</y><d>2022-07-19</d><h>04:34</h><w>hiredman</w>Which I think is what that error means</z><z id="t1658205358" t="valtteri Exactly what hiredman says. See Return values section here https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"><y>#</y><d>2022-07-19</d><h>04:35</h><w>valtteri</w>Exactly what hiredman says. See Return values section here <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html</a></z><z id="t1658205473" t="valtteri You&apos;re trying to reference attribute abc.Arn but you get the arn with just referencing abc"><y>#</y><d>2022-07-19</d><h>04:37</h><w>valtteri</w>You&apos;re trying to reference attribute abc.Arn but you get the arn with just referencing abc</z><z id="t1658235970" t="jjttjj [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] Yeah in this case it looks like TaskDefinition does return the Arn with Ref, but Arn isn&apos;t availble with GetAtt, and you attempt to get it with GettAtt in the hourly rule. https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/ This list I linked before will show what is returned/available with GetAtt all in one place"><y>#</y><d>2022-07-19</d><h>13:06</h><w>jjttjj</w><a>@drewverlee</a> Yeah in this case it looks like TaskDefinition does return the Arn with Ref, but Arn isn&apos;t availble with GetAtt, and you attempt to get it with GettAtt in the hourly rule. <a href="https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/" target="_blank">https://theburningmonk.com/cloudformation-ref-and-getatt-cheatsheet/</a> This list I linked before will show what is returned/available with GetAtt all in one place</z><z id="t1658242626" t="Drew Verlee Thanks everyone. I think the more fundamental issue is that i was trying to target the task definition resource directly instead of the &lt;AWS: :ECS: :Service|AWS: :ECS: :Servic&gt;e that runs the task. I thought with fargate you didn&apos;t need to even reference this layer, but that doesn&apos;t seem to be the case."><y>#</y><d>2022-07-19</d><h>14:57</h><w>Drew Verlee</w>Thanks everyone. I think the more fundamental issue is that i was trying to target the task definition resource directly instead of the &lt;AWS:<b>:ECS:</b>:Service|AWS:<b>:ECS:</b>:Servic&gt;e that runs the task. I thought with fargate you didn&apos;t need to even reference this layer, but that doesn&apos;t seem to be the case.</z><z id="t1658371328" t="Drew Verlee Does anyone know of a wider aws community to ask questions in? I&apos;m trying reddit and it&apos;s been hit or mis. I don&apos;t want to flood the channel here either. (he says as he asks another question 😕 ) In a https://docs.amazonaws.cn/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-ecsparameters.html with a ec2 (fargate) https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html what resource i&apos;m i supposed to point at for the ARN? In the rule docs we get this example which might be informative MyEventsRule: Type: AWS::Events::Rule Properties: Description: Events Rule with EcsParameters EventPattern: source: - aws.ec2 detail-type: - EC2 Instance State-change Notification detail: state: - stopping ScheduleExpression: rate(15 minutes) State: DISABLED Targets: - Arn: !GetAtt - MyCluster #&lt;------- I assume this means i&apos;m supposed to point at the &apos;AWS::ECS::Cluster&apos; that has the &apos;AWS::ECS::Service&apos; that has the &apos;task defination i reference below?&apos;. - Arn RoleArn: !GetAtt - ECSTaskRole - Arn Id: Id345 EcsParameters: TaskCount: 1 TaskDefinitionArn: !Ref MyECSTask If my comment (# &lt;--) midway in the cf is correct, then why does the Events::Rule need both the cluster and the task definition referenced? What does providing the ARN do? The https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-target.html#cfn-events-rule-target-arn for the arn just say: &quot;The Amazon Resource Name (ARN) of the target.&quot; I feel like this kind of thing should be obvious, maybe is obvious to someone that has been around a bit, but i fee like i just circled the internet and came up short."><y>#</y><d>2022-07-21</d><h>02:42</h><w>Drew Verlee</w>Does anyone know of a wider aws community to ask questions in? I&apos;m trying reddit and it&apos;s been hit or mis. I don&apos;t want to flood the channel here either. (he says as he asks another question <b>😕</b> )

In a <a href="https://docs.amazonaws.cn/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-ecsparameters.html" target="_blank">https://docs.amazonaws.cn/en_us/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-ecsparameters.html</a> with a ec2 (fargate) <a href="https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html" target="_blank">https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html</a> what resource i&apos;m i supposed to point at for the ARN?
In the rule docs we get this example which might be informative
<pre>MyEventsRule:
  Type: AWS::Events::Rule
  Properties:
    Description: Events Rule with EcsParameters
    EventPattern:
      source:
        - aws.ec2
      detail-type:
        - EC2 Instance State-change Notification
      detail:
        state:
          - stopping
    ScheduleExpression: rate(15 minutes)
    State: DISABLED
    Targets:
      - Arn: !GetAtt 
          - MyCluster #&lt;------- I assume this means i&apos;m supposed to point at the &apos;AWS::ECS::Cluster&apos; that has the &apos;AWS::ECS::Service&apos; that has the &apos;task defination i reference below?&apos;. 
          - Arn 
        RoleArn: !GetAtt 
          - ECSTaskRole
          - Arn
        Id: Id345
        EcsParameters:
          TaskCount: 1
          TaskDefinitionArn: !Ref MyECSTask</pre>
If my comment (# &lt;--) midway in the cf is correct, then why does the Events::Rule need both the cluster and the task definition referenced? What does providing the ARN do?
The <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-target.html#cfn-events-rule-target-arn" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-events-rule-target.html#cfn-events-rule-target-arn</a> for the arn just say: &quot;The Amazon Resource Name (ARN) of the target.&quot;

I feel like this kind of thing should be obvious, maybe is obvious to someone that has been around a bit, but i fee like i just circled the internet and came up short.</z><z id="t1658373197" t="Drew Verlee stackoverflow is probably one place for this kind of thing."><y>#</y><d>2022-07-21</d><h>03:13</h><r>Drew Verlee</r>stackoverflow is probably one place for this kind of thing.</z><z id="t1658373410" t="Drew Verlee here is a https://kennyballou.com/blog/2019/10/aws-ecs-events-target-input/index.html from 2019 (basically the stone age) and a recent https://stackoverflow.com/questions/70735649/aws-cli-events-put-targets-ecsparameters-structure . Yea, they also target the cluster. I guess i&apos;ll just turn off my brain and accept that it has to be the cluster without any clue why."><y>#</y><d>2022-07-21</d><h>03:16</h><r>Drew Verlee</r>here is a <a href="https://kennyballou.com/blog/2019/10/aws-ecs-events-target-input/index.html" target="_blank">https://kennyballou.com/blog/2019/10/aws-ecs-events-target-input/index.html</a> from 2019 (basically the stone age) and a recent <a href="https://stackoverflow.com/questions/70735649/aws-cli-events-put-targets-ecsparameters-structure" target="_blank">https://stackoverflow.com/questions/70735649/aws-cli-events-put-targets-ecsparameters-structure</a>. Yea, they also target the cluster. I guess i&apos;ll just turn off my brain and accept that it has to be the cluster without any clue why.</z><z id="t1658373765" t="Drew Verlee maybe all the cool kids use event bridge instead of directly to the service. I have no idea why that would be useful in my case but maybe it&apos;s better described."><y>#</y><d>2022-07-21</d><h>03:22</h><r>Drew Verlee</r>maybe all the cool kids use event bridge instead of directly to the service. I have no idea why that would be useful in my case but maybe it&apos;s better described.</z><z id="t1658386357" t="Leaf Garland The AWS docs page you posted says that this page lists the resources that can be targets https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html"><y>#</y><d>2022-07-21</d><h>06:52</h><r>Leaf Garland</r>The AWS docs page you posted says that this page lists the resources that can be targets
<a href="https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html" target="_blank">https://docs.aws.amazon.com/eventbridge/latest/APIReference/API_PutTargets.html</a></z><z id="t1658405414" t="Drew Verlee Yep. The church one in my case is the ecs task. Which means the arm should be the cluster of the task. Essentially the outer most layer. Can&apos;t find any docs on why. But it&apos;s ok, i just need to put it together. :)"><y>#</y><d>2022-07-21</d><h>12:10</h><r>Drew Verlee</r>Yep. The church one in my case is the ecs task. Which means the arm should be the cluster of the task. Essentially the outer most layer.

Can&apos;t find any docs on why. But it&apos;s ok, i just need to put it together. :)</z><z id="t1658415298" t="Benjamin What&apos;s wrong with asking here? The answers might be as a reference for others and in tge worst case nobody knows."><y>#</y><d>2022-07-21</d><h>14:54</h><r>Benjamin</r>What&apos;s wrong with asking here? The answers might be as a reference for others and in tge worst case nobody knows.</z><z id="t1659003138" t="Sathiya Hi. I am using https://github.com/mcohen01/amazonica to connect to s3 to upload and download files. My requirements needs me to download a large number of files in parallel. We are running into Unable to execute HTTP request: Timeout waiting for connection from pool . We would like to increase the max connections and reduce the max idle time. But we are not sure how to set these configruation. We tried setting properties in defclientconfig but not sure if we are setting it right. We are getting null pointers after that. Can some one help with this configuration change. Thanks in advance"><y>#</y><d>2022-07-28</d><h>10:12</h><w>Sathiya</w>Hi. I am using <a href="https://github.com/mcohen01/amazonica" target="_blank">https://github.com/mcohen01/amazonica</a> to connect to s3 to upload and download files. My requirements needs me to download a large number of files in parallel. We are running into <code>Unable to execute HTTP request: Timeout waiting for connection from pool</code> . We would like to increase the max connections and reduce the max idle time. But we are not sure how to set these configruation. We tried setting properties in <code>defclientconfig</code> but not sure if we are setting it right. We are getting null pointers after that.

Can some one help with this configuration change. Thanks in advance</z><z id="t1659008208" t="jumar How many files are you downloading in parallel? And how exactly you are doing that?"><y>#</y><d>2022-07-28</d><h>11:36</h><r>jumar</r>How many files are you downloading in parallel?
And how exactly you are doing that?</z><z id="t1659008638" t="Sathiya we have multiple users downloading or uploading. so there is a constant flow of requests. also there is option to select multiple files and download. in that case, we spawn multiple thread and download in parallel"><y>#</y><d>2022-07-28</d><h>11:43</h><r>Sathiya</r>we have multiple users downloading or uploading. so there is a constant flow of requests. also there is option to select multiple files and download. in that case, we spawn multiple thread and download in parallel</z><z id="t1659009333" t="jumar We use claypoole&apos;s pmap like this and I haven&apos;t seen this problem yet: (cp/pmap 100 #(s3/get-object bucket-name %) keys) "><y>#</y><d>2022-07-28</d><h>11:55</h><r>jumar</r>We use claypoole&apos;s <code>pmap</code> like this and I haven&apos;t seen this problem yet:
<pre>(cp/pmap 100 #(s3/get-object bucket-name %) keys)</pre>
</z><z id="t1659009414" t="jumar I guess your files are probably much bigger than ours (they are quite small, a few kilobytes usually)"><y>#</y><d>2022-07-28</d><h>11:56</h><r>jumar</r>I guess your files are probably much bigger than ours (they are quite small, a few kilobytes usually)</z><z id="t1659009801" t="jumar Do you know how many of them are running in parallel when the problem happens? If it&apos;s more than 100, I would think about introducing a queue and delay the new requests, because I guess you won&apos;t get better throughput by launching that many connections from a single machine. https://aws.amazon.com/blogs/developer/enabling-metrics-with-the-aws-sdk-for-java/ might be useful as they recommend https://github.com/aws/aws-sdk-java/issues/2663 ."><y>#</y><d>2022-07-28</d><h>12:03</h><r>jumar</r>Do you know how many of them are running in parallel when the problem happens?
If it&apos;s more than 100, I would think about introducing a queue and delay the new requests,
because I guess you won&apos;t get better throughput by launching that many connections from a single machine.

<a href="https://aws.amazon.com/blogs/developer/enabling-metrics-with-the-aws-sdk-for-java/" target="_blank">https://aws.amazon.com/blogs/developer/enabling-metrics-with-the-aws-sdk-for-java/</a> might be useful as they recommend <a href="https://github.com/aws/aws-sdk-java/issues/2663" target="_blank">https://github.com/aws/aws-sdk-java/issues/2663</a>.</z><z id="t1659010269" t="Sathiya yeah we have most of our files over 10Mbs. some may be around 500Mbs. Also its not just once. There will be constant hits with this ranges. Thats why we are considering increasing the connection pool size. any ideas on how to achieve it with amazonica"><y>#</y><d>2022-07-28</d><h>12:11</h><r>Sathiya</r>yeah we have most of our files over 10Mbs. some may be around 500Mbs. Also its not just once. There will be constant hits with this ranges. Thats why we are considering increasing the connection pool size. any ideas on how to achieve it with amazonica</z><z id="t1659010405" t="jumar What I&apos;m saying is that increasing the pool size might not be the best idea because it can already be quite big. Anyway, did you look at this? https://github.com/mcohen01/amazonica#client-configuration -&gt; https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html"><y>#</y><d>2022-07-28</d><h>12:13</h><r>jumar</r>What I&apos;m saying is that increasing the pool size might not be the best idea because it can already be quite big.

Anyway, did you look at this? <a href="https://github.com/mcohen01/amazonica#client-configuration" target="_blank">https://github.com/mcohen01/amazonica#client-configuration</a>
-&gt; <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html" target="_blank">https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/ClientConfiguration.html</a></z><z id="t1659115197" t="Sathiya Yeah. But not sure how too add it in configuration and use it while calling s3/get-object."><y>#</y><d>2022-07-29</d><h>17:19</h><r>Sathiya</r>Yeah. But not sure how too add it in configuration and use it while calling <code>s3/get-object.</code></z><z id="t1659479206" t="jjttjj The pending-ops-limit in aws-api &apos;s http client ( https://github.com/cognitect-labs/aws-api#ops-limit-reached ) shouldn&apos;t be hit if I&apos;m only invoking all api calls from a single thread, right? I keep getting this error. Specifically I&apos;m using a lambda with a concurrency of 1, with the clients created outside of the handler function (so on the lambda initialization). I&apos;m only using a single thread in the lambda, and only making ~1 req/second. I&apos;ve already tried the &quot;each api gets its own custom http-client&quot; thing suggested in the readme, and also doubled the ops-limit, but it&apos;s still getting hit. Any clues as to what could cause this?"><y>#</y><d>2022-08-02</d><h>22:26</h><w>jjttjj</w>The <code>pending-ops-limit</code> in <code>aws-api</code>&apos;s http client ( <a href="https://github.com/cognitect-labs/aws-api#ops-limit-reached" target="_blank">https://github.com/cognitect-labs/aws-api#ops-limit-reached</a>) shouldn&apos;t be hit if I&apos;m only invoking all api calls from a single thread, right? I keep getting this error.
Specifically I&apos;m using a lambda with a concurrency of 1, with the clients created outside of the handler function (so on the lambda initialization). I&apos;m only using a single thread in the lambda, and only making ~1 req/second.
I&apos;ve already tried the &quot;each api gets its own custom http-client&quot; thing suggested in the readme, and also doubled the ops-limit, but it&apos;s still getting hit.
Any clues as to what could cause this?</z><z id="t1659480052" t="hiredman it has been a minute, but if you are using aws-api asynchronously and not waiting for the result of each operation maybe"><y>#</y><d>2022-08-02</d><h>22:40</h><w>hiredman</w>it has been a minute, but if you are using aws-api asynchronously and not waiting for the result of each operation maybe</z><z id="t1659480074" t="jjttjj Nope, only the sync api"><y>#</y><d>2022-08-02</d><h>22:41</h><w>jjttjj</w>Nope, only the sync api</z><z id="t1659624975" t="Ian Fernandez are there any examples of aws sqs using cognitect aws-api?"><y>#</y><d>2022-08-04</d><h>14:56</h><w>Ian Fernandez</w>are there any examples of aws sqs using cognitect aws-api?</z><z id="t1659624997" t="Ian Fernandez I would like to reach out an example for retrieving messages from time to time"><y>#</y><d>2022-08-04</d><h>14:56</h><w>Ian Fernandez</w>I would like to reach out an example for retrieving messages from time to time</z><z id="t1659625123" t="Ian Fernandez (require &apos;[promesa.core :as p]) (defonce consume-sqs-scheduler-running (atom true)) (def consume-sqs-scheduler (let [{::keys [event-pull-seconds]} config] (p/loop [] (p/delay (* 1000 event-pull-seconds)) (when @consume-sqs-scheduler-running (handle-sqs-data (pull-sqs-data! config)) #_(println ::RUN!)) (p/recur))))"><y>#</y><d>2022-08-04</d><h>14:58</h><w>Ian Fernandez</w><pre>(require &apos;[promesa.core :as p])

(defonce consume-sqs-scheduler-running
  (atom true))

(def consume-sqs-scheduler
  (let [{::keys [event-pull-seconds]} config]
    (p/loop []
      (p/delay (* 1000 event-pull-seconds))
      (when @consume-sqs-scheduler-running
        (handle-sqs-data (pull-sqs-data! config))
        #_(println ::RUN!))
      (p/recur))))</pre></z><z id="t1659625775" t="valtteri SQS client has built-in long-polling support if max 20sec interval is OK for you https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/examples-sqs-long-polling.html"><y>#</y><d>2022-08-04</d><h>15:09</h><r>valtteri</r>SQS client has built-in long-polling support if max 20sec interval is OK for you <a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/examples-sqs-long-polling.html" target="_blank">https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/examples-sqs-long-polling.html</a></z><z id="t1659625799" t="valtteri Sorry, I don’t have an example how to use that with cognitect aws-api but just wanted to point out this as an option. 🙂"><y>#</y><d>2022-08-04</d><h>15:09</h><r>valtteri</r>Sorry, I don’t have an example how to use that with cognitect aws-api but just wanted to point out this as an option. <b>🙂</b></z><z id="t1659625908" t="valtteri Oh wait… cognitect aws-api uses the API directly and there’s no “official” aws-client involved.. So you’ll probably need to build the delay mechanism yourself. Your example with promesa looks like a an OK starting point. It’s very simple and probably works. If you you need something more robust I’d look into quarts (maybe a bit overkill), tea-time or similar scheduler."><y>#</y><d>2022-08-04</d><h>15:11</h><r>valtteri</r>Oh wait… cognitect aws-api uses the API directly and there’s no “official” aws-client involved.. So you’ll probably need to build the delay mechanism yourself. Your example with promesa looks like a an OK starting point. It’s very simple and probably works. If you you need something more robust I’d look into quarts (maybe a bit overkill), tea-time or similar scheduler.</z><z id="t1659626041" t="valtteri Or.. since you’re on AWS.. it’s also possible to schedule a lambda to periodically read the queue"><y>#</y><d>2022-08-04</d><h>15:14</h><r>valtteri</r>Or.. since you’re on AWS.. it’s also possible to schedule a lambda to periodically read the queue</z><z id="t1659626148" t="valtteri Actually.. it would be kinda interesting if someone has figured out how to do long-polling with cognitect aws-api"><y>#</y><d>2022-08-04</d><h>15:15</h><r>valtteri</r>Actually.. it would be kinda interesting if someone has figured out how to do long-polling with cognitect aws-api</z><z id="t1659627423" t="Karol Wójcik I would go for Lambda. Typically you want consume message &amp; dead letter queue. This is very easy to setup with Lambda. "><y>#</y><d>2022-08-04</d><h>15:37</h><r>Karol Wójcik</r>I would go for Lambda. Typically you want consume message &amp; dead letter queue. This is very easy to setup with Lambda. </z><z id="t1659634110" t="jjttjj https://github.com/RutledgePaulV/piped is an SQS client implemented with aws-api, might be worth checking out the source code"><y>#</y><d>2022-08-04</d><h>17:28</h><r>jjttjj</r><a href="https://github.com/RutledgePaulV/piped" target="_blank">https://github.com/RutledgePaulV/piped</a> is an SQS client implemented with aws-api, might be worth checking out the source code</z><z id="t1659625136" t="Ian Fernandez if it&apos;s not possible, I&apos;ll do something like this"><y>#</y><d>2022-08-04</d><h>14:58</h><w>Ian Fernandez</w>if it&apos;s not possible, I&apos;ll do something like this</z><z id="t1659978055" t="Benjamin moving my question to #off-topic"><y>#</y><d>2022-08-08</d><h>17:00</h><w>Benjamin</w>moving my question to #off-topic</z><z id="t1660136684" t="Ian Fernandez anyone knows about this?"><y>#</y><d>2022-08-10</d><h>13:04</h><w>Ian Fernandez</w>anyone knows about this?</z><z id="t1660136686" t="Ian Fernandez Execution error (ExceptionInfo) at cognitect.aws.service/service-description (service.clj:33). Cannot find resource cognitect/aws/sqs-client/service.edn."><y>#</y><d>2022-08-10</d><h>13:04</h><w>Ian Fernandez</w><pre>Execution error (ExceptionInfo) at cognitect.aws.service/service-description (service.clj:33).
Cannot find resource cognitect/aws/sqs-client/service.edn.</pre></z><z id="t1660136756" t="ghadi Type in your deps and your client construction expression [:attrs {:href &quot;/_/_/users/U9ABG0ERZ&quot;}] "><y>#</y><d>2022-08-10</d><h>13:05</h><w>ghadi</w>Type in your deps and your client construction expression <a>@d.ian.b</a> </z><z id="t1660136953" t="Ian Fernandez no worries found"><y>#</y><d>2022-08-10</d><h>13:09</h><w>Ian Fernandez</w>no worries found</z><z id="t1660136961" t="Ian Fernandez typo in client build"><y>#</y><d>2022-08-10</d><h>13:09</h><w>Ian Fernandez</w>typo in client build</z><z id="t1660136980" t="Ian Fernandez (aws/client {:api :some-typo :credentials-provider creds}) "><y>#</y><d>2022-08-10</d><h>13:09</h><w>Ian Fernandez</w><pre>(aws/client {:api :some-typo
             :credentials-provider creds})</pre>
</z><z id="t1660136994" t="Ian Fernandez that was the thing caused the error"><y>#</y><d>2022-08-10</d><h>13:09</h><w>Ian Fernandez</w>that was the thing caused the error</z><z id="t1660137014" t="Ian Fernandez kinda cryptic, for this, right?"><y>#</y><d>2022-08-10</d><h>13:10</h><w>Ian Fernandez</w>kinda cryptic, for this, right?</z><z id="t1660139364" t="Ian Fernandez &quot;data&quot;: { &quot;ErrorResponse&quot;: { &quot;Error&quot;: { &quot;Type&quot;: &quot;Sender&quot;, &quot;TypeAttrs&quot;: {}, &quot;Code&quot;: &quot;AccessDenied&quot;, &quot;CodeAttrs&quot;: {}, &quot;Message&quot;: &quot;Access to the resource is denied.&quot;, &quot;MessageAttrs&quot;: {}, &quot;Detail&quot;: null, &quot;DetailAttrs&quot;: {} }, &quot;ErrorAttrs&quot;: {}, &quot;RequestId&quot;: &quot;d16a1885-6555-51c5-93c9-43e8ddbaae75&quot;, &quot;RequestIdAttrs&quot;: {} }, &quot;ErrorResponseAttrs&quot;: { &quot;xmlns&quot;: &quot;&quot; }, &quot;cognitect.anomalies/category&quot;: &quot;cognitect.anomalies/forbidden&quot; },"><y>#</y><d>2022-08-10</d><h>13:49</h><w>Ian Fernandez</w><pre>&quot;data&quot;: {
        &quot;ErrorResponse&quot;: {
            &quot;Error&quot;: {
                &quot;Type&quot;: &quot;Sender&quot;,
                &quot;TypeAttrs&quot;: {},
                &quot;Code&quot;: &quot;AccessDenied&quot;,
                &quot;CodeAttrs&quot;: {},
                &quot;Message&quot;: &quot;Access to the resource  is denied.&quot;,
                &quot;MessageAttrs&quot;: {},
                &quot;Detail&quot;: null,
                &quot;DetailAttrs&quot;: {}
            },
            &quot;ErrorAttrs&quot;: {},
            &quot;RequestId&quot;: &quot;d16a1885-6555-51c5-93c9-43e8ddbaae75&quot;,
            &quot;RequestIdAttrs&quot;: {}
        },
        &quot;ErrorResponseAttrs&quot;: {
            &quot;xmlns&quot;: &quot;&quot;
        },
        &quot;cognitect.anomalies/category&quot;: &quot;cognitect.anomalies/forbidden&quot;
    },</pre></z><z id="t1660139394" t="Ian Fernandez In terraform I have { &quot;Effect&quot;: &quot;Allow&quot;, &quot;Action&quot;: [ &quot;SQS:SendMessage&quot;, &quot;SQS:ReceiveMessage&quot; ], &quot;Resource&quot;: &quot;${my_events_q_arn}&quot; },"><y>#</y><d>2022-08-10</d><h>13:49</h><w>Ian Fernandez</w>In terraform I have
<pre>{
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Action&quot;: [
        &quot;SQS:SendMessage&quot;,
        &quot;SQS:ReceiveMessage&quot;
      ],
      &quot;Resource&quot;: &quot;${my_events_q_arn}&quot;
    },</pre></z><z id="t1660139410" t="Ian Fernandez though that it would be alright this"><y>#</y><d>2022-08-10</d><h>13:50</h><w>Ian Fernandez</w>though that it would be alright this</z><z id="t1660941926" t="Drew Verlee When i isseue a request like :op GetUser ... i get an error that prompts me to check the logs. Anyone know what logs aws means specifically? Is there a way to make the aws-api return more information?"><y>#</y><d>2022-08-19</d><h>20:45</h><w>Drew Verlee</w>When i isseue a request like :op GetUser ... i get an error that prompts me to check the logs. Anyone know what logs  aws means specifically? Is there a way to make the aws-api return more information?</z><z id="t1660942238" t="Drew Verlee looks like i&apos;m supposed to check cloudtrail"><y>#</y><d>2022-08-19</d><h>20:50</h><w>Drew Verlee</w>looks like i&apos;m supposed to check cloudtrail</z><z id="t1661195580" t="Drew Verlee The value for an aws-api CreateStack is described like this :Parameters [:seq-of {:ParameterKey string, :ParameterValue string, :UsePreviousValue boolean, :ResolvedValue string}] So what i supply is like this: [{:ParameterKey &quot;AppName&quot;, :ParameterValue &quot;api&quot;}] And the warnings me the key should be a string { :path [ :Parameters :ParameterValue ], :pred clojure.core/string?, :val 2, :via [ :cognitect.aws.cloudformation/CreateStackInput :cognitect.aws.cloudformation/Parameters :cognitect.aws.cloudformation/Parameter :cognitect.aws.cloudformation/ParameterValue ], :in [ :Parameters 1 :ParameterValue ] } So i make the key a string and try again and i&apos;m told the parameters don&apos;t have values... &quot;Parameters: [AppName ...] must have values i&apos;m starting to guess the warnings are coming from the spec (aws/validate-requests cf-with-assumed-role true) and that there wrong..."><y>#</y><d>2022-08-22</d><h>19:13</h><w>Drew Verlee</w>The value for an aws-api CreateStack is described like this

<pre>:Parameters
 [:seq-of
  {:ParameterKey string,
   :ParameterValue string,
   :UsePreviousValue boolean,
   :ResolvedValue string}]</pre>
So what i supply is like this:

<pre>[{:ParameterKey &quot;AppName&quot;, :ParameterValue &quot;api&quot;}]</pre>
And the warnings me the key should be a string

<pre>{ :path [ :Parameters :ParameterValue ], :pred clojure.core/string?, :val 2, :via [ :cognitect.aws.cloudformation/CreateStackInput :cognitect.aws.cloudformation/Parameters :cognitect.aws.cloudformation/Parameter :cognitect.aws.cloudformation/ParameterValue ], :in [ :Parameters 1 :ParameterValue ] }</pre>
So i make the key a string and try again and i&apos;m told the parameters don&apos;t have values...

<pre>&quot;Parameters: [AppName ...] must have values</pre>
i&apos;m starting to guess the warnings are coming from the spec <code>(aws/validate-requests cf-with-assumed-role true)</code> and that there wrong...</z><z id="t1661195874" t="ghadi You&apos;re missing a literal key named :Parameters"><y>#</y><d>2022-08-22</d><h>19:17</h><w>ghadi</w>You&apos;re missing a literal key named :Parameters</z><z id="t1661195892" t="ghadi Nested under the :request"><y>#</y><d>2022-08-22</d><h>19:18</h><w>ghadi</w>Nested under the :request</z><z id="t1661195922" t="Alex Miller (Clojure team) (def cf (aws/client {:api :cloudformation})) (aws/doc cf :CreateStack)"><y>#</y><d>2022-08-22</d><h>19:18</h><w>Alex Miller (Clojure team)</w><pre>(def cf (aws/client {:api :cloudformation}))
(aws/doc cf :CreateStack)</pre></z><z id="t1661195994" t="Alex Miller (Clojure team) ^^ to figure this kind of thing out using the built-ins"><y>#</y><d>2022-08-22</d><h>19:19</h><w>Alex Miller (Clojure team)</w>^^ to figure this kind of thing out using the built-ins</z><z id="t1661196005" t="Drew Verlee the abbreviated request is {:Parameters [{&quot;ParameterKey&quot; &quot;AppName&quot;, &quot;ParameterValue&quot; &quot;api&quot;} ...]} Maybe it&apos;s supposed to just be {:Parameters {&quot;AppName&quot; &quot;api&quot;}}"><y>#</y><d>2022-08-22</d><h>19:20</h><w>Drew Verlee</w>the abbreviated request is <code>{:Parameters [{&quot;ParameterKey&quot; &quot;AppName&quot;, &quot;ParameterValue&quot; &quot;api&quot;} ...]}</code>

Maybe it&apos;s supposed to just be {:Parameters {&quot;AppName&quot; &quot;api&quot;}}</z><z id="t1661196018" t="Drew Verlee err"><y>#</y><d>2022-08-22</d><h>19:20</h><w>Drew Verlee</w>err</z><z id="t1661196028" t="Drew Verlee {:Parameters [{&quot;AppName&quot; &quot;api&quot;}...]}"><y>#</y><d>2022-08-22</d><h>19:20</h><w>Drew Verlee</w><code>{:Parameters [{&quot;AppName&quot; &quot;api&quot;}...]}</code></z><z id="t1661196127" t="Alex Miller (Clojure team) the error you had was { :path [ :Parameters :ParameterValue ], :pred clojure.core/string?, :val 2 - which looks like the :ParameterValue value was supposed to be a string, but was the number 2"><y>#</y><d>2022-08-22</d><h>19:22</h><w>Alex Miller (Clojure team)</w>the error you had was <code>{ :path [ :Parameters :ParameterValue ], :pred clojure.core/string?, :val 2</code>   - which looks like the :ParameterValue value was supposed to be a string, but was the number 2</z><z id="t1661196206" t="Alex Miller (Clojure team) then you &quot;So i make the key a string&quot; - I think you took the wrong turn here"><y>#</y><d>2022-08-22</d><h>19:23</h><w>Alex Miller (Clojure team)</w>then you &quot;So i make the key a string&quot;  - I think you took the wrong turn here</z><z id="t1661196312" t="Drew Verlee hmm yes"><y>#</y><d>2022-08-22</d><h>19:25</h><w>Drew Verlee</w>hmm yes</z><z id="t1661197538" t="Drew Verlee Thanks Alex, i forgot the first rule (for me at least) is to just use expound rather then try to manually read the spec. It was the fact that one of the values wasn&apos;t a string"><y>#</y><d>2022-08-22</d><h>19:45</h><w>Drew Verlee</w>Thanks Alex, i forgot the first rule (for me at least) is to just use expound rather then try to manually read the spec. It was the fact that one of the values wasn&apos;t a string</z><z id="t1662422138" t="greg I&apos;m looking at the https://github.com/cognitect-labs/aws-api/ on github and I can&apos;t find the bits responsible for parsing https://github.com/aws/aws-sdk-js and processing it into specs definitions. Is it part of https://github.com/cognitect-labs/aws-api/ or is it somewhere else?"><y>#</y><d>2022-09-05</d><h>23:55</h><w>greg</w>I&apos;m looking at the <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a> on github and I can&apos;t find the bits responsible for parsing <a href="https://github.com/aws/aws-sdk-js" target="_blank">https://github.com/aws/aws-sdk-js</a> and processing it into specs definitions. Is it part of <a href="https://github.com/cognitect-labs/aws-api/" target="_blank">https://github.com/cognitect-labs/aws-api/</a> or is it somewhere else?</z><z id="t1662422174" t="Alex Miller (Clojure team) The generator is not open source"><y>#</y><d>2022-09-05</d><h>23:56</h><r>Alex Miller (Clojure team)</r>The generator is not open source</z><z id="t1662422307" t="greg Oh ok, thanks"><y>#</y><d>2022-09-05</d><h>23:58</h><r>greg</r>Oh ok, thanks</z><z id="t1662422717" t="greg I was looking for inspiration and examples how to build this type of library. I thought about making something similar for terraform providers. It is possible to https://www.terraform.io/cli/commands/providers/schema for a provider to json, so it looked like a very similar use case. For every terraform provider out there, we could have a spec definitions auto-generated from these jsons. Just an idea."><y>#</y><d>2022-09-06</d><h>00:05</h><r>greg</r>I was looking for inspiration and examples how to build this type of library. I thought about making something similar for terraform providers. It is possible to <a href="https://www.terraform.io/cli/commands/providers/schema" target="_blank">https://www.terraform.io/cli/commands/providers/schema</a> for a provider to json, so it looked like a very similar use case.

For every terraform provider out there, we could have a spec definitions auto-generated from these jsons. Just an idea.</z><z id="t1662445812" t="Drew Verlee Look at the k8s clojure api. [:attrs {:href &quot;/_/_/users/U023TQF5FM3&quot;}] https://github.com/nubank/k8s-api"><y>#</y><d>2022-09-06</d><h>06:30</h><r>Drew Verlee</r>Look at the k8s clojure api. <a>@U023TQF5FM3</a>

<a href="https://github.com/nubank/k8s-api" target="_blank">https://github.com/nubank/k8s-api</a></z><z id="t1662446236" t="lispyclouds [:attrs {:href &quot;/_/_/users/U023TQF5FM3&quot;}] you could also have a look at a lib I made on similar ideas: https://github.com/lispyclouds/contajners Specially this part: https://github.com/lispyclouds/contajners/tree/main/fetch_api"><y>#</y><d>2022-09-06</d><h>06:37</h><r>lispyclouds</r><a>@U023TQF5FM3</a> you could also have a look at a lib I made on similar ideas: <a href="https://github.com/lispyclouds/contajners" target="_blank">https://github.com/lispyclouds/contajners</a>
Specially this part: <a href="https://github.com/lispyclouds/contajners/tree/main/fetch_api" target="_blank">https://github.com/lispyclouds/contajners/tree/main/fetch_api</a></z><z id="t1662471194" t="kenny If you&apos;re just interested in generating Clojure Specs from the AWS smithy files, this might be of interest to you https://github.com/kennyjwilli/smithy-spec"><y>#</y><d>2022-09-06</d><h>13:33</h><r>kenny</r>If you&apos;re just interested in generating Clojure Specs from the AWS smithy files, this might be of interest to you <a href="https://github.com/kennyjwilli/smithy-spec" target="_blank">https://github.com/kennyjwilli/smithy-spec</a></z><z id="t1662762865" t="Drew Verlee What&apos;s the closest thing in aws to google cloud could build? Having a docker container as the unit of work seems so much better to me."><y>#</y><d>2022-09-09</d><h>22:34</h><w>Drew Verlee</w>What&apos;s the closest thing in aws to google cloud could build? Having a docker container as the unit of work seems so much better to me.</z><z id="t1662763975" t="jjttjj Not familiar with google cloud but https://aws.amazon.com/fargate/ let&apos;s you run a docker image for long running stuff, and you can also use containers as lambdas"><y>#</y><d>2022-09-09</d><h>22:52</h><r>jjttjj</r>Not familiar with google cloud but <a href="https://aws.amazon.com/fargate/" target="_blank">https://aws.amazon.com/fargate/</a> let&apos;s you run a docker image for long running stuff, and you can also use containers as lambdas</z><z id="t1662764355" t="Drew Verlee Fargate isn&apos;t comparable here. Aws code build batch is a similar idea to cloud build."><y>#</y><d>2022-09-09</d><h>22:59</h><r>Drew Verlee</r>Fargate isn&apos;t comparable here. Aws code build batch is a similar idea to cloud build.</z><z id="t1662764499" t="Drew Verlee It&apos;s basically a distributed graph, where each node is an os/container and the edges are some sharded file system."><y>#</y><d>2022-09-09</d><h>23:01</h><r>Drew Verlee</r>It&apos;s basically a distributed graph, where each node is an os/container and the edges are some sharded file system.</z><z id="t1662765774" t="Drew Verlee Codepipeline seems sightly more generic but i think it&apos;s also the same idea with less control over the os maybe..."><y>#</y><d>2022-09-09</d><h>23:22</h><r>Drew Verlee</r>Codepipeline seems sightly more generic but i think it&apos;s also the same idea with less control over the os maybe...</z><z id="t1662825558" t="lukasz oh AWS... :-) CodePipeline is one thing, but there&apos;s also CodeBuild https://aws.amazon.com/codebuild/"><y>#</y><d>2022-09-10</d><h>15:59</h><r>lukasz</r>oh AWS... :-) CodePipeline is one thing, but there&apos;s also CodeBuild <a href="https://aws.amazon.com/codebuild/" target="_blank">https://aws.amazon.com/codebuild/</a></z><z id="t1662825575" t="lukasz I think if you glue the two together you get an equivalent of GCP&apos;s service"><y>#</y><d>2022-09-10</d><h>15:59</h><r>lukasz</r>I think if you glue the two together you get an equivalent of GCP&apos;s service</z><z id="t1662993915" t="dchelimsky https://clojurians.slack.com/archives/C06MAR553/p1662993895998439"><y>#</y><d>2022-09-12</d><h>14:45</h><w>dchelimsky</w><a href="https://clojurians.slack.com/archives/C06MAR553/p1662993895998439" target="_blank">https://clojurians.slack.com/archives/C06MAR553/p1662993895998439</a></z><z id="t1663025991" t="kenny Curious, what was the discussion on this change? &gt; add api/invoke-async and deprecate api.async/invoke"><y>#</y><d>2022-09-12</d><h>23:39</h><r>kenny</r>Curious, what was the discussion on this change?
&gt; add api/invoke-async and deprecate api.async/invoke</z><z id="t1663026253" t="dchelimsky There wasn’t much. It solved some implementation problems, and the outcome leaves users with one less namespace to worry about. Is it causing some problem for you?"><y>#</y><d>2022-09-12</d><h>23:44</h><r>dchelimsky</r>There wasn’t much. It solved some implementation problems, and the outcome leaves users with one less namespace to worry about. Is it causing some problem for you?</z><z id="t1663026301" t="kenny Not at all. Was interested. I like the change."><y>#</y><d>2022-09-12</d><h>23:45</h><r>kenny</r>Not at all. Was interested. I like the change.</z><z id="t1663345884" t="Drew Verlee aws is so mysterious at times that i&apos;m starting to turn religious. Is there a patron saint of Cloudformation i can turn to in my time of need? (i&apos;ll also accept a less holy bond, some form of ancient being of unspeakable horror maybe)"><y>#</y><d>2022-09-16</d><h>16:31</h><w>Drew Verlee</w>aws is so mysterious at times that i&apos;m starting to turn religious. Is there a patron saint of Cloudformation i can turn to in my time of need?

(i&apos;ll also accept a less holy bond, some form of ancient being of unspeakable horror maybe)</z><z id="t1663345927" t="lukasz yes, switch to Terraform 😉"><y>#</y><d>2022-09-16</d><h>16:32</h><w>lukasz</w>yes, switch to Terraform <b>😉</b></z><z id="t1663348344" t="Drew Verlee One issue is that cloudformation isn&apos;t re-playable. e.g i can&apos;t submit a createChangeSet without manually removing some resources like the git repo and deleting the previous stack."><y>#</y><d>2022-09-16</d><h>17:12</h><w>Drew Verlee</w>One issue is that cloudformation isn&apos;t re-playable. e.g i can&apos;t submit a createChangeSet without manually removing some resources like the git repo and deleting the previous stack.</z><z id="t1663348447" t="Drew Verlee and the feedback i&apos;m getting on cloudformation is very limted. I have a stack that has been in review for 10 minutes, it clearly has failed, but it&apos;s not moving to that state or signaling what went wrong. It&apos;s like i&apos;m coding in a language that doesn&apos;t want to admit its code by simply not sharing the stack trace."><y>#</y><d>2022-09-16</d><h>17:14</h><w>Drew Verlee</w>and the feedback i&apos;m getting on cloudformation is very limted. I have a stack that has been in review for 10 minutes, it clearly has failed, but it&apos;s not moving to that state or signaling what went wrong.

It&apos;s like i&apos;m coding in a language that doesn&apos;t want to admit its code by simply not sharing the stack trace.</z><z id="t1663348519" t="hiredman you can have cloudformation send event information to sqs, where you can consume it with our own tools, but it is pretty much the same data that is displayed in the ui"><y>#</y><d>2022-09-16</d><h>17:15</h><w>hiredman</w>you can have cloudformation send event information to sqs, where you can consume it with our own tools, but it is pretty much the same data that is displayed in the ui</z><z id="t1663348574" t="Drew Verlee I could see how that would be useful."><y>#</y><d>2022-09-16</d><h>17:16</h><w>Drew Verlee</w>I could see how that would be useful.</z><z id="t1663351256" t="Daniel Jomphe In reaction to your thoughts, Drew, I&apos;ll add that I&apos;m very curious of how CDK, Terraform (with or without) CDK and Pulumi bring (or don&apos;t bring) improvements over our experience with classic CloudFormation. I&apos;m still using standard CloudFormation until I get more time to investigate these options."><y>#</y><d>2022-09-16</d><h>18:00</h><w>Daniel Jomphe</w>In reaction to your thoughts, Drew, I&apos;ll add that I&apos;m very curious of how CDK, Terraform (with or without) CDK and Pulumi bring (or don&apos;t bring) improvements over our experience with classic CloudFormation.

I&apos;m still using standard CloudFormation until I get more time to investigate these options.</z><z id="t1663356247" t="Daniel Craig Cloudformation makes me feel like this: 😱"><y>#</y><d>2022-09-16</d><h>19:24</h><w>Daniel Craig</w>Cloudformation makes me feel like this: <b>😱</b></z><z id="t1663370951" t="steveb8n I use CDK (typescript) for everything now and it has been great. if you don’t need multi-cloud I would suggest it’s the best option"><y>#</y><d>2022-09-16</d><h>23:29</h><w>steveb8n</w>I use CDK (typescript) for everything now and it has been great. if you don’t need multi-cloud I would suggest it’s the best option</z><z id="t1663371036" t="steveb8n of course I’m biased by my own choice. ymmv"><y>#</y><d>2022-09-16</d><h>23:30</h><r>steveb8n</r>of course I’m biased by my own choice. ymmv</z><z id="t1663371789" t="jjttjj I actually like plain Cloudformation (plus aws-api for deploying). I&apos;ve been using it with a fairly light clojure wrapper I&apos;ve been slowly building up at my company. I like that it&apos;s just json and I can write it as edn. I have a multimethod that can transform a nested value in the template map according to a qualified key, and output some deterministic value to show up in the template, optionally building and deploying the actual resources. ie if a resource needs a s3 object, we generate the path based on some config, and optionally actually upload the file to that path. This has gone a long way for me. There are definitely a lot of times where cloudformation feels like they&apos;re challenging you for the fun of it with arbitrary seeming rules/edge cases, but overall I like it."><y>#</y><d>2022-09-16</d><h>23:43</h><w>jjttjj</w>I actually like plain Cloudformation (plus aws-api for deploying). I&apos;ve been using it with a fairly light clojure wrapper I&apos;ve been slowly building up at my company.  I like that it&apos;s just json and I can write it as edn.
I have a multimethod that can transform a nested value in the template map according to a qualified key, and output some deterministic value to show up in the template, optionally building and deploying the actual resources. ie if a resource needs a s3 object, we generate the path based on some config, and optionally actually upload the file to that path.
This has gone a long way for me.
There are definitely a lot of times where cloudformation feels like they&apos;re challenging you for the fun of it with arbitrary seeming rules/edge cases, but overall I like it.</z><z id="t1663374821" t="Cory we started exploring a clojure cdk wrapper at last job, with some success. particularly, cdk-tf which gets rid of the multi-cloud argument too. i definitely have some opposition to introducing turing-completeness to this space, but if your state is sufficiently small and isolated to the service / repo it&apos;s bound to, then it can be a great pattern."><y>#</y><d>2022-09-17</d><h>00:33</h><w>Cory</w>we started exploring a clojure cdk wrapper at last job, with some success. particularly, cdk-tf which gets rid of the multi-cloud argument too. i definitely have some opposition to introducing turing-completeness to this space, but if your state is sufficiently small and isolated to the service / repo it&apos;s bound to, then it can be a great pattern.</z><z id="t1663384337" t="Drew Verlee What is &quot;the multicloud argument&quot;?"><y>#</y><d>2022-09-17</d><h>03:12</h><r>Drew Verlee</r>What is &quot;the multicloud argument&quot;?</z><z id="t1663387040" t="Cory CloudFormation brought up before this is AWS specific. I&apos;ve always thought that TF advertising multi-cloud vs multi-platform was silly. Terraform can declaratively manage resources for you across everything; CF doesn&apos;t just miss out on GCP and Azure, it misses out on Pagerduty, Sentry, et al, anything you&apos;d like to compose with your infrastructure data plane."><y>#</y><d>2022-09-17</d><h>03:57</h><r>Cory</r>CloudFormation brought up before this is AWS specific. I&apos;ve always thought that TF advertising multi-cloud vs multi-platform was silly. Terraform can declaratively manage resources for you across everything; CF doesn&apos;t just miss out on GCP and Azure, it misses out on Pagerduty, Sentry, et al, anything you&apos;d like to compose with your infrastructure data plane.</z><z id="t1663538241" t="Drew Verlee Thanks cory."><y>#</y><d>2022-09-18</d><h>21:57</h><r>Drew Verlee</r>Thanks cory.</z><z id="t1663374956" t="Cory terraform can also be just json and gives you opportunity to, for example, set up a sentry app / datadog app + dashboards / etc in conjunction with your service deployment itself to ensure optimal reuse / composition of contextual variables and, in general, more standardization across various *aaS deps."><y>#</y><d>2022-09-17</d><h>00:35</h><w>Cory</w>terraform can also be just json and gives you opportunity to, for example, set up a sentry app / datadog app + dashboards / etc in conjunction with your service deployment itself to ensure optimal reuse / composition of contextual variables and, in general, more standardization across various *aaS deps.</z><z id="t1663423849" t="jjttjj Oh wow, I can&apos;t believe I missed the fact that they have a json-compatible syntax. I thought I tried googling that when I was looking into them but I must have done a bad job"><y>#</y><d>2022-09-17</d><h>14:10</h><r>jjttjj</r>Oh wow, I can&apos;t believe I missed the fact that they have a json-compatible syntax. I thought I tried googling that when I was looking into them but I must have done a bad job</z><z id="t1663375933" t="steveb8n one way to evaluate anything above CF is high vs low level constructs. low level are just a DSL on top of CF. high level are constructs which do extra stuff for you e.g. add a lambda to a gateway, the construct adds all the IAM stuff for you transparently. This is a big time saver. This is where CDK shines."><y>#</y><d>2022-09-17</d><h>00:52</h><w>steveb8n</w>one way to evaluate anything above CF is high vs low level constructs. low level are just a DSL on top of CF. high level are constructs which do extra stuff for you e.g. add a lambda to a gateway, the construct adds all the IAM stuff for you transparently. This is a big time saver. This is where CDK shines.</z><z id="t1663586873" t="dchelimsky https://clojurians.slack.com/archives/C06MAR553/p1663586861031969"><y>#</y><d>2022-09-19</d><h>11:27</h><w>dchelimsky</w><a href="https://clojurians.slack.com/archives/C06MAR553/p1663586861031969" target="_blank">https://clojurians.slack.com/archives/C06MAR553/p1663586861031969</a></z><z id="t1663612687" t="Drew Verlee When cloudformation fails, is there a way to get the full logs? I see the events tab, but that seems to have only a very high level overview."><y>#</y><d>2022-09-19</d><h>18:38</h><w>Drew Verlee</w>When cloudformation fails, is there a way to get the full logs? I see the events tab, but that seems to have only a very high level overview.</z><z id="t1663612764" t="Drew Verlee I don&apos;t see a link to any logs, maybe i have to set that up? Not sure why it wouldn&apos;t be on by default."><y>#</y><d>2022-09-19</d><h>18:39</h><r>Drew Verlee</r>I don&apos;t see a link to any logs, maybe i have to set that up? Not sure why it wouldn&apos;t be on by default.</z><z id="t1663614001" t="Daniel Craig it helps to look at the resources status too, but I&apos;m sure you knew that already"><y>#</y><d>2022-09-19</d><h>19:00</h><r>Daniel Craig</r>it helps to look at the resources status too, but I&apos;m sure you knew that already</z><z id="t1663614038" t="Daniel Craig Maybe try https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-events.html ? I haven&apos;t tried this before"><y>#</y><d>2022-09-19</d><h>19:00</h><r>Daniel Craig</r>Maybe try <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-events.html" target="_blank">https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stack-events.html</a>?  I haven&apos;t tried this before</z><z id="t1663614393" t="Drew Verlee Thanks [:attrs {:href &quot;/_/_/users/U032ZPU44KD&quot;}] ! we tried describe-stack-events and it didn&apos;t give a more specific reasons then &quot;resource failed to create&quot; when we were hoping for &quot;resource failed to create bc.... x&quot;"><y>#</y><d>2022-09-19</d><h>19:06</h><r>Drew Verlee</r>Thanks <a>@U032ZPU44KD</a>!  we tried describe-stack-events and it didn&apos;t give a more specific reasons then &quot;resource failed to create&quot; when we were hoping for &quot;resource failed to create bc.... x&quot;</z><z id="t1663616146" t="Leaf Garland Cloud trail events sometimes has more"><y>#</y><d>2022-09-19</d><h>19:35</h><r>Leaf Garland</r>Cloud trail events sometimes has more</z><z id="t1663616294" t="Drew Verlee Does that require setup? I don&apos;t see anything from the cloudformation browser console that looks like a link to cloud trail."><y>#</y><d>2022-09-19</d><h>19:38</h><r>Drew Verlee</r>Does that require setup? I don&apos;t see anything from the cloudformation browser console that looks like a link to cloud trail.</z><z id="t1663634769" t="Leaf Garland Cloudtrail events has everything that happens in an account. You can make custom trails and setup logging to cloudwatch etc, but you don&apos;t need it here. Between the stack events, the status of the resources in the stack, and cloudtrail events I can usually piece together what happened to a stack. Sometimes I need to look at the failed resource directly, assuming it managed to create it. "><y>#</y><d>2022-09-20</d><h>00:46</h><r>Leaf Garland</r>Cloudtrail events has everything that happens in an account. You can make custom trails and setup logging to cloudwatch etc, but you don&apos;t need it here. 

Between the stack events, the status of the resources in the stack, and cloudtrail events I can usually piece together what happened to a stack. Sometimes I need to look at the failed resource directly, assuming it managed to create it. </z><z id="t1663638106" t="Drew Verlee Thanks a lot for the response. 🙂 I&apos;ll want to automate enabling cloudtrail for everything then. And then turn it off after I&apos;m done debugging. I can piece what happened together too, but I expect the stack trace to be available. If i can&apos;t get that, then i have a cloud service startup idea. 😆"><y>#</y><d>2022-09-20</d><h>01:41</h><r>Drew Verlee</r>Thanks a lot for the response. <b>🙂</b>

I&apos;ll want to automate enabling cloudtrail for everything then. And then turn it off after I&apos;m done debugging. 

I can piece what happened together too, but I expect the stack trace to be available. If i can&apos;t get that, then i have a cloud service startup idea. <b>😆</b></z><z id="t1663648873" t="Drew Verlee Any idea how to get a full list of clients for the https://github.com/cognitect-labs/aws-api ? e.g s3, cloudwatch, etc..."><y>#</y><d>2022-09-20</d><h>04:41</h><w>Drew Verlee</w>Any idea how to get a full list of clients for the <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a>? e.g s3, cloudwatch, etc...</z><z id="t1663648993" t="Drew Verlee would it just be the deps.edn deps key &quot;name&quot;? com.cognitect.aws/logs -&gt; logs -&gt; (aws/client {:api :logs ...})"><y>#</y><d>2022-09-20</d><h>04:43</h><r>Drew Verlee</r>would it just be the deps.edn deps key &quot;name&quot;? com.cognitect.aws/logs -&gt; logs -&gt; (aws/client {:api :logs ...})</z><z id="t1663649504" t="Drew Verlee yes, that seems to be the case."><y>#</y><d>2022-09-20</d><h>04:51</h><r>Drew Verlee</r>yes, that seems to be the case.</z><z id="t1663651356" t="Drew Verlee i&apos;m guessing someone has built an aws cloudwatch client for clojure and i don&apos;t need to re-invent the wheel here... but it might be just as easy using clojures built in https://www.juxt.pro/blog/new-clojure-iteration function"><y>#</y><d>2022-09-20</d><h>05:22</h><r>Drew Verlee</r>i&apos;m guessing someone has built an aws cloudwatch client for clojure and i don&apos;t need to re-invent the wheel here... but it might be just as easy using clojures built in <a href="https://www.juxt.pro/blog/new-clojure-iteration" target="_blank">https://www.juxt.pro/blog/new-clojure-iteration</a> function</z><z id="t1663667695" t="Dimitar Uzunov [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] do you mean the list of APIs? This library just uses the api descriptions from the js sdk. It is described here: https://github.com/cognitect-labs/aws-api#approach I don’t see cloudwatch in the list, but if you are making cloudwatch rules you can use the eventbridge api (aws renamed it)"><y>#</y><d>2022-09-20</d><h>09:54</h><r>Dimitar Uzunov</r><a>@U0DJ4T5U1</a> do you mean the list of APIs? This library just uses the api descriptions from the js sdk. It is described here: <a href="https://github.com/cognitect-labs/aws-api#approach" target="_blank">https://github.com/cognitect-labs/aws-api#approach</a>

I don’t see cloudwatch in the list, but if you are making cloudwatch rules you can use the eventbridge api (aws renamed it)</z><z id="t1663668400" t="Dimitar Uzunov ok so Cloudwatch is there [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] , check out :monitoring, :logs and others"><y>#</y><d>2022-09-20</d><h>10:06</h><r>Dimitar Uzunov</r>ok so Cloudwatch is there <a>@U0DJ4T5U1</a>, check out :monitoring, :logs and others</z><z id="t1663677808" t="Drew Verlee [:attrs {:href &quot;/_/_/users/ULE3UT8Q5&quot;}] Ty, yes i meant the list of apis. I was able to find cloudwatch, though as your comment suggests, there are a couple different takes on logs. I sort of want all the logs, So i can search them..."><y>#</y><d>2022-09-20</d><h>12:43</h><r>Drew Verlee</r><a>@ULE3UT8Q5</a> Ty, yes i meant the list of apis. I was able to find cloudwatch, though as your comment suggests, there are a couple different takes on logs. 

I sort of want all the logs, So i can search them...</z><z id="t1663678428" t="Dimitar Uzunov this is the cloudwatch api, it is just that cw is actually multiple services"><y>#</y><d>2022-09-20</d><h>12:53</h><r>Dimitar Uzunov</r>this is the cloudwatch api, it is just that cw is actually multiple services</z><z id="t1663685810" t="Daniel Jomphe I check it here, is that what you want? https://github.com/cognitect-labs/aws-api/blob/main/latest-releases.edn"><y>#</y><d>2022-09-20</d><h>14:56</h><r>Daniel Jomphe</r>I check it here, is that what you want?

<a href="https://github.com/cognitect-labs/aws-api/blob/main/latest-releases.edn" target="_blank">https://github.com/cognitect-labs/aws-api/blob/main/latest-releases.edn</a></z><z id="t1663687260" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U0514DPR7&quot;}] yep, the list of &quot;api&quot;&apos;s you can pass as the :api key to aws/client seems to be (-&gt;&gt; &quot;latest-releases.edn&quot; slurp edn/read-string keys (map name) (map keyword)) it&apos;s not obvious from the start thats the case though."><y>#</y><d>2022-09-20</d><h>15:21</h><r>Drew Verlee</r><a>@U0514DPR7</a> yep, the list of &quot;api&quot;&apos;s you can pass as the :api key to aws/client seems to be <code>(-&gt;&gt; &quot;latest-releases.edn&quot; slurp edn/read-string keys (map name) (map keyword))</code> it&apos;s not obvious from the start thats the case though.</z><z id="t1663651738" t="Drew Verlee Would there be a wider interest in some examples of how to pull data from cloudwatch using aws-api? If so, I might try to clean up the code i write and make a small library and/or set of examples. I mostly foresee having to write some pagination code using the iteration function (as i mention in the thread above). Meanwhile, if you read this and happen to have done this already and want to share notes let me know 🙂"><y>#</y><d>2022-09-20</d><h>05:28</h><w>Drew Verlee</w>Would there be a wider interest in some examples of how to pull data from cloudwatch using aws-api? If so, I might try to clean up the code i write and make a small library and/or set of examples. I mostly foresee having to write some pagination code using the iteration function (as i mention in the thread above).

Meanwhile, if you read this and happen to have done this already and want to share notes let me know <b>🙂</b></z><z id="t1663866931" t="Joshua Suskalo Are there any examples of using aws-api with s3 access control lists? Looking at the javadocs for the java api it&apos;s unclear to me if aws-api would manage to have a data representation of those parts of the api."><y>#</y><d>2022-09-22</d><h>17:15</h><w>Joshua Suskalo</w>Are there any examples of using aws-api with s3 access control lists? Looking at the javadocs for the java api it&apos;s unclear to me if aws-api would manage to have a data representation of those parts of the api.</z><z id="t1663870626" t="Drew Verlee like making a bucket public?"><y>#</y><d>2022-09-22</d><h>18:17</h><r>Drew Verlee</r>like making a bucket public?</z><z id="t1663870679" t="Joshua Suskalo Well my usecase is assigning a grant to a specific user on specific objects as I create them in the bucket, but just any example of using ACL stuff would satisfy me."><y>#</y><d>2022-09-22</d><h>18:17</h><r>Joshua Suskalo</r>Well my usecase is assigning a grant to a specific user on specific objects as I create them in the bucket, but just any example of using ACL stuff would satisfy me.</z><z id="t1663873024" t="Drew Verlee I think granting a user access to a bucket would be done through IAM and would reference the bucket. here is an example of some code that uses the s3 aws-api to make a bucket public: {:op :PutObject :request {:Bucket bucket :Key (str stack-name &quot;/&quot; to-file) :ACL &quot;public-read&quot; :Body (io/input-stream from-file)}}"><y>#</y><d>2022-09-22</d><h>18:57</h><r>Drew Verlee</r>I think granting a user access to a bucket would be done through IAM and would reference the bucket.

here is an example of some code that uses the s3 aws-api to make a bucket public:

<pre>{:op :PutObject :request {:Bucket bucket  :Key (str stack-name &quot;/&quot; to-file)
                                                                  :ACL &quot;public-read&quot;
                                                                  :Body (io/input-stream from-file)}}</pre></z><z id="t1663873130" t="Joshua Suskalo the use of :ACL there surprises me since the Java SDK has that property as :AccessControlList . Where in the docs should I be looking for this sort of thing? Do I need to be finding aws&apos; http docs or something?"><y>#</y><d>2022-09-22</d><h>18:58</h><r>Joshua Suskalo</r>the use of <code>:ACL</code> there surprises me since the Java SDK has that property as <code>:AccessControlList</code>. Where in the docs should I be looking for this sort of thing? Do I need to be finding aws&apos; http docs or something?</z><z id="t1663873956" t="viesti might be that :ACL maps to the x-amz-acl header in the underlying https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutObject.html#API_PutObject_RequestSyntax"><y>#</y><d>2022-09-22</d><h>19:12</h><r>viesti</r>might be that <code>:ACL</code> maps to the <code>x-amz-acl</code> header in the underlying <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutObject.html#API_PutObject_RequestSyntax" target="_blank">https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutObject.html#API_PutObject_RequestSyntax</a></z><z id="t1663873999" t="Joshua Suskalo Ok, cool, that&apos;s what I&apos;d wanted to know about, that I have to match the http api, not the java sdk"><y>#</y><d>2022-09-22</d><h>19:13</h><r>Joshua Suskalo</r>Ok, cool, that&apos;s what I&apos;d wanted to know about, that I have to match the http api, not the java sdk</z><z id="t1663874167" t="Drew Verlee The aws api has a doc function you can call on putobject to get more information."><y>#</y><d>2022-09-22</d><h>19:16</h><r>Drew Verlee</r>The aws api has a doc function you can call on putobject to get more information.</z><z id="t1663874188" t="viesti &gt; here is an example of some code that uses the s3 aws-api to make a bucket public: Had to nit a bit 😄 , that set&apos;s the ACL for a single object to be public, not the whole bucket 🙂 But a very great example indeed, just the right example indeed 🙂"><y>#</y><d>2022-09-22</d><h>19:16</h><r>viesti</r>&gt; here is an example of some code that uses the s3 aws-api to make a bucket public:
Had to nit a bit <b>😄</b> , that set&apos;s the ACL for a single object to be public, not the whole bucket <b>🙂</b> But a very great example indeed, just the right example indeed <b>🙂</b></z><z id="t1663874221" t="Drew Verlee Right."><y>#</y><d>2022-09-22</d><h>19:17</h><r>Drew Verlee</r>Right.</z><z id="t1663874231" t="Drew Verlee I forget, but you might need to do both."><y>#</y><d>2022-09-22</d><h>19:17</h><r>Drew Verlee</r>I forget, but you might need to do both.</z><z id="t1663874246" t="Joshua Suskalo the single object is actually what I have to mess with"><y>#</y><d>2022-09-22</d><h>19:17</h><r>Joshua Suskalo</r>the single object is actually what I have to mess with</z><z id="t1663874249" t="Joshua Suskalo not the bucket"><y>#</y><d>2022-09-22</d><h>19:17</h><r>Joshua Suskalo</r>not the bucket</z><z id="t1663874357" t="viesti yup, though there is also this https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html , so if that is turned on, then those single object ACLs might not apply"><y>#</y><d>2022-09-22</d><h>19:19</h><r>viesti</r>yup, though there is also this <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html" target="_blank">https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html</a>, so if that is turned on, then those single object ACLs might not apply</z><z id="t1663874375" t="Drew Verlee The aws-api repo has s3 examples that will give you a good idea of how to work with it in general. The rest is on aws to explain."><y>#</y><d>2022-09-22</d><h>19:19</h><r>Drew Verlee</r>The aws-api repo has s3 examples that will give you a good idea of how to work with it in general. The rest is on aws to explain.</z><z id="t1663874426" t="viesti This could be the source in the https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json#L9412-L9417 from where that ACL key is picked up"><y>#</y><d>2022-09-22</d><h>19:20</h><r>viesti</r>This could be the source in the <a href="https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json#L9412-L9417" target="_blank">https://github.com/aws/aws-sdk-js/blob/master/apis/s3-2006-03-01.normal.json#L9412-L9417</a> from where that <code>ACL</code> key is picked up</z><z id="t1663874960" t="viesti &gt; The aws api has a doc function you can call on putobject to get more information. &gt; That is probably best source for docs, there are actually links to aws rest apis even I think"><y>#</y><d>2022-09-22</d><h>19:29</h><r>viesti</r>&gt; The aws api has a doc function you can call on putobject to get more information.
&gt; 
That is probably best source for docs, there are actually links to aws rest apis even I think</z><z id="t1664304014" t="Daniel Craig How can I tell Cider what AWS profile I want to use when I start my repl?"><y>#</y><d>2022-09-27</d><h>18:40</h><w>Daniel Craig</w>How can I tell Cider what AWS profile I want to use when I start my repl?</z><z id="t1664337745" t="Drew Verlee i&apos;m confused, whats the overlap between cider and your aws profile?"><y>#</y><d>2022-09-28</d><h>04:02</h><r>Drew Verlee</r>i&apos;m confused, whats the overlap between cider and your aws profile?</z><z id="t1664337797" t="Drew Verlee are you speaking generally about your clojure application state choosing an aws profile?"><y>#</y><d>2022-09-28</d><h>04:03</h><r>Drew Verlee</r>are you speaking generally about your clojure application state choosing an aws profile?</z><z id="t1664376170" t="Daniel Craig So I want to use named profiles to manage my credentials for different AWS accounts, but when I start cider I don&apos;t see an opportunity to set the AWS_PROFILE environment variable as described in the docs: export AWS_PROFILE=user1 the reference is https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html"><y>#</y><d>2022-09-28</d><h>14:42</h><r>Daniel Craig</r>So I want to use named profiles to manage my credentials for different AWS accounts, but when I start cider I don&apos;t see an opportunity to set the AWS_PROFILE environment variable as described in the docs: <code>export AWS_PROFILE=user1</code>  the reference is <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html" target="_blank">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html</a></z><z id="t1664377152" t="lukasz You&apos;ll have to do this without using environment variables - for example, the code I&apos;m working on uses a config map to figure out how to connect to given AWS account and get credentials (ECS metadata, profile in ~/.aws/config etc."><y>#</y><d>2022-09-28</d><h>14:59</h><r>lukasz</r>You&apos;ll have to do this without using environment variables - for example, the code I&apos;m working on uses a config map to figure out how to connect to given AWS account  and get credentials (ECS metadata, profile in <code>~/.aws/config</code> etc.</z><z id="t1664378995" t="Daniel Craig [:attrs {:href &quot;/_/_/users/U0JEFEZH6&quot;}] so does your code explicitly read ~/.aws/config ?"><y>#</y><d>2022-09-28</d><h>15:29</h><r>Daniel Craig</r><a>@U0JEFEZH6</a> so does your code explicitly read ~/.aws/config ?</z><z id="t1664379170" t="lukasz locally yes"><y>#</y><d>2022-09-28</d><h>15:32</h><r>lukasz</r>locally yes</z><z id="t1664379199" t="lukasz we use AWS SSO linked with Okta so we need to pull that info from the profile file"><y>#</y><d>2022-09-28</d><h>15:33</h><r>lukasz</r>we use AWS SSO linked with Okta so we need to pull that info from the profile  file</z><z id="t1664507433" t="Drew Verlee are there any helpful tools for updating aws-api libs like &gt; update! ssm 823 -&gt; 834? (y/n) y! .....823 -&gt; 834"><y>#</y><d>2022-09-30</d><h>03:10</h><w>Drew Verlee</w>are there any helpful tools for updating aws-api libs like

 &gt; update!

ssm 823 -&gt; 834? (y/n)

y!

.....823 -&gt; 834</z><z id="t1664507567" t="Drew Verlee asking bc i&apos;m about to write one unless someone else jumps in."><y>#</y><d>2022-09-30</d><h>03:12</h><r>Drew Verlee</r>asking bc i&apos;m about to write one unless someone else jumps in.</z><z id="t1664511068" t="viesti https://github.com/liquidz/antq can do library updates"><y>#</y><d>2022-09-30</d><h>04:11</h><r>viesti</r><a href="https://github.com/liquidz/antq" target="_blank">https://github.com/liquidz/antq</a> can do library updates</z><z id="t1664511291" t="Drew Verlee yeah, but the aws-api latest-release isn&apos;t a deps.edn file at the project root, so it wouldn&apos;t know to compare it against your deps.."><y>#</y><d>2022-09-30</d><h>04:14</h><r>Drew Verlee</r>yeah, but the aws-api latest-release isn&apos;t a deps.edn file at the project root, so it wouldn&apos;t know to compare it against your deps..</z><z id="t1664514032" t="Drew Verlee though i guess i can just make it into one then run the tool lol."><y>#</y><d>2022-09-30</d><h>05:00</h><r>Drew Verlee</r>though i guess i can just make it into one then run the tool lol.</z><z id="t1664514219" t="Drew Verlee that will probably be harder though honestly."><y>#</y><d>2022-09-30</d><h>05:03</h><r>Drew Verlee</r>that will probably be harder though honestly.</z><z id="t1664516530" t="viesti ah right, antq just quickly came to my mind, thought that looking up latest libs in maven would be enough :)"><y>#</y><d>2022-09-30</d><h>05:42</h><r>viesti</r>ah right, antq just quickly came to my mind, thought that looking up latest libs in maven would be enough :)</z><z id="t1664521065" t="Drew Verlee oh cool. the aws libs don&apos;t even follow semantic versioning."><y>#</y><d>2022-09-30</d><h>06:57</h><r>Drew Verlee</r>oh cool. the aws libs don&apos;t even follow semantic versioning.</z><z id="t1664521112" t="Drew Verlee so this semvar library i wanted to use doesn&apos;t work. Why are we using strings to carry information separated by dots. why is everything not clojure data structures?"><y>#</y><d>2022-09-30</d><h>06:58</h><r>Drew Verlee</r>so this semvar library i wanted to use doesn&apos;t work. Why are we using strings to carry information separated by dots. why is everything not clojure data structures?</z><z id="t1664521196" t="viesti Heh 🙂"><y>#</y><d>2022-09-30</d><h>06:59</h><r>viesti</r>Heh <b>🙂</b></z><z id="t1664521328" t="viesti A formatted string is easy to type and read for humans, a &quot;version&quot; is just an identifier, an awfully small piece of data to express possibly a big lot of information, with human interpretation in the middle"><y>#</y><d>2022-09-30</d><h>07:02</h><r>viesti</r>A formatted string is easy to type and read for humans, a &quot;version&quot; is just an identifier, an awfully small piece of data to express possibly a big lot of information, with human interpretation in the middle</z><z id="t1664521361" t="viesti it&apos;s data that humans make, with potential for error 😄"><y>#</y><d>2022-09-30</d><h>07:02</h><r>viesti</r>it&apos;s data that humans make, with potential for error <b>😄</b></z><z id="t1664521422" t="Drew Verlee i guess i can probably write a recursive compare function"><y>#</y><d>2022-09-30</d><h>07:03</h><r>Drew Verlee</r>i guess i can probably write a recursive compare function</z><z id="t1664521973" t="viesti I wonder what/who creates/maintains that latest-releases.edn file, seems that it is used to update other resources in the repo (readme, libs under the examples alias in deps.edn file in the repo) I think the released libs have to have been pushed to maven central before updating the latest-releases.edn end file, since otherwise the clj -A:examples example wont work"><y>#</y><d>2022-09-30</d><h>07:12</h><r>viesti</r>I wonder what/who creates/maintains that latest-releases.edn file, seems that it is used to update other resources in the repo (readme, libs under the examples alias in deps.edn file in the repo)

I think the released libs have to have been pushed to maven central before updating the latest-releases.edn end file, since otherwise the <code>clj -A:examples</code> example wont work</z><z id="t1664522067" t="viesti for just for moving to the latest version of all libs I think looking up the current latest artifact in maven central via antq (for Leiningen only there used to be lein-ancient I think?) should be enough, if I&apos;m on the right track 🙂"><y>#</y><d>2022-09-30</d><h>07:14</h><r>viesti</r>for just for moving to the latest version of all libs I think looking up the current latest artifact in maven central via antq (for Leiningen only there used to be lein-ancient I think?) should be enough, if I&apos;m on the right track <b>🙂</b></z><z id="t1664524059" t="Drew Verlee Here i wrote these helper functions to do the update on a deps file. I doubt ill ever use them, but i was tired of not doing things. https://github.com/drewverlee/aws-api-lib-crudanator/blob/e5a80060a782e4417920ca04acae1c2ec2b75294/src/drewverlee/aws_api_lib_crudanator.clj#L75"><y>#</y><d>2022-09-30</d><h>07:47</h><r>Drew Verlee</r>Here i wrote these helper functions to do the update on a deps file. I doubt ill ever use them, but i was tired of not doing things. <a href="https://github.com/drewverlee/aws-api-lib-crudanator/blob/e5a80060a782e4417920ca04acae1c2ec2b75294/src/drewverlee/aws_api_lib_crudanator.clj#L75" target="_blank">https://github.com/drewverlee/aws-api-lib-crudanator/blob/e5a80060a782e4417920ca04acae1c2ec2b75294/src/drewverlee/aws_api_lib_crudanator.clj#L75</a></z><z id="t1664533500" t="viesti Nice! At times it is good to just hack on things instead of reasoning why not :D"><y>#</y><d>2022-09-30</d><h>10:25</h><r>viesti</r>Nice! At times it is good to just hack on things instead of reasoning why not :D</z><z id="t1664662395" t="Drew Verlee I&apos;m trying to make my aws cloudformation experience better. The obvious way to do that is to code cloudformation in clojure and have a way to get function documentation quickly as well as specs on required fields. So there is some prior art in this regard from https://github.com/brabster/crucible . for example (def simple (template &quot;A simple sample template&quot; :my-vpc-cidr (parameter) :my-vpc (ec2/vpc {::ec2/cidr-block (xref :my-vpc-cidr)}) :vpc (output (join &quot;/&quot; [&quot;foo&quot; (xref :my-vpc)])))) What do people think of that idea? Anyone with first hand experence? Why have the output produce Refs instead of just inline the value, it&apos;s not like it forces you do to that but i&apos;m not sure why its useful to use the cf language at all instead of the static output. Maybe you can&apos;t always make a reference via an ID?"><y>#</y><d>2022-10-01</d><h>22:13</h><w>Drew Verlee</w>I&apos;m trying to make my aws cloudformation experience better. The obvious way to do that is to code cloudformation in clojure and have a way to get function documentation quickly as well as specs on required fields.

So there is some prior art in this regard from <a href="https://github.com/brabster/crucible" target="_blank">https://github.com/brabster/crucible</a>. for example

<pre>(def simple (template &quot;A simple sample template&quot;
                      :my-vpc-cidr (parameter)
                      :my-vpc (ec2/vpc {::ec2/cidr-block (xref :my-vpc-cidr)})
                      :vpc (output (join &quot;/&quot; [&quot;foo&quot; (xref :my-vpc)]))))</pre>
What do people think of that idea? Anyone with first hand experence? Why have the output produce <code>Refs</code> instead of just inline the value, it&apos;s not like it forces you do to that but i&apos;m not sure why its useful to use the cf language at all instead of the static output. Maybe you can&apos;t always make a reference via an ID?</z><z id="t1664662939" t="Drew Verlee There is also https://github.com/Stedi/cdk-clj which was abandoned. &gt; After developing and using this Clojure wrapper for https://github.com/aws/aws-cdk#aws-cloud-development-kit-aws-cdk for the past six months, we&apos;ve decided to use TypeScript and AWS&apos; library directly."><y>#</y><d>2022-10-01</d><h>22:22</h><r>Drew Verlee</r>There is also <a href="https://github.com/Stedi/cdk-clj" target="_blank">https://github.com/Stedi/cdk-clj</a> which was abandoned.

&gt;  After developing and using this Clojure wrapper for <a href="https://github.com/aws/aws-cdk#aws-cloud-development-kit-aws-cdk" target="_blank">https://github.com/aws/aws-cdk#aws-cloud-development-kit-aws-cdk</a> for the past six months, we&apos;ve decided to use TypeScript and AWS&apos; library directly.</z><z id="t1664663027" t="Drew Verlee What&apos;s interesting is that the docs are obviously machine generated some structure. e.g https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-role.html So if compiler could get that, it should be possible to generate clojure code from it."><y>#</y><d>2022-10-01</d><h>22:23</h><r>Drew Verlee</r>What&apos;s interesting is that the docs are obviously machine generated some structure. e.g

<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-role.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-role.html</a>

So if compiler could get that, it should be possible to generate clojure code from it.</z><z id="t1664665302" t="Drew Verlee Another interesting tid bit is that cloudformation and the aws api seem to be subtly different and i&apos;m not sure why: ;; Create Role API call ;; {:Path string, ;; :RoleName string, ;; :AssumeRolePolicyDocument string, ;; :Description string, ;; :MaxSessionDuration integer, ;; :PermissionsBoundary string, ;; :Tags [:seq-of {:Key string, :Value string}]} ;; cloudformation for aws iam role ;; {&quot;Type&quot; : &quot;AWS::IAM::Role&quot;, ;; &quot;Properties&quot; ​ {&quot;AssumeRolePolicyDocument&quot; ​ Json, ;; &quot;Description&quot; ​ String, ;; &quot;ManagedPolicyArns&quot; ​ [String, ...], ;; &quot;MaxSessionDuration&quot; ​ Integer, ;; &quot;Path&quot; ​ String, ;; &quot;PermissionsBoundary&quot; ​ String, ;; &quot;Policies&quot; ​ [Policy, ...], ;; &quot;RoleName&quot; ​ String, ;; &quot;Tags&quot; ​ [Tag, ...]}} ;; things cloudformation has the api doesn&apos;t ;; &quot;ManagedPolicyArns&quot; ​ [String, ...], ;; &quot;Policies&quot; ​ [Policy, ...], "><y>#</y><d>2022-10-01</d><h>23:01</h><r>Drew Verlee</r>Another interesting tid bit is that cloudformation and the aws api seem to be subtly different and i&apos;m not sure why:

<pre>;; Create Role API call

;; {:Path string,
;;  :RoleName string,
;;  :AssumeRolePolicyDocument string,
;;  :Description string,
;;  :MaxSessionDuration integer,
;;  :PermissionsBoundary string,
;;  :Tags [:seq-of {:Key string, :Value string}]}


;; cloudformation for aws iam role
;; {&quot;Type&quot; : &quot;AWS::IAM::Role&quot;,
;;  &quot;Properties&quot; ​ {&quot;AssumeRolePolicyDocument&quot; ​ Json,
;;                 &quot;Description&quot; ​ String,
;;                 &quot;ManagedPolicyArns&quot; ​ [String, ...],
;;                 &quot;MaxSessionDuration&quot; ​ Integer,
;;                 &quot;Path&quot; ​ String,
;;                 &quot;PermissionsBoundary&quot; ​ String,
;;                 &quot;Policies&quot; ​ [Policy, ...],
;;                 &quot;RoleName&quot; ​ String,
;;                 &quot;Tags&quot; ​ [Tag, ...]}}


;; things cloudformation has the api doesn&apos;t
;;                 &quot;ManagedPolicyArns&quot; ​ [String, ...],
;;                 &quot;Policies&quot; ​ [Policy, ...],</pre>
</z><z id="t1664667847" t="Drew Verlee using the cdk might be promising https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_iam.CfnRole.html"><y>#</y><d>2022-10-01</d><h>23:44</h><r>Drew Verlee</r>using the cdk might be promising <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_iam.CfnRole.html" target="_blank">https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_iam.CfnRole.html</a></z><z id="t1664667891" t="Drew Verlee except thats what the cdk-clj was and they gave up..."><y>#</y><d>2022-10-01</d><h>23:44</h><r>Drew Verlee</r>except thats what the cdk-clj was and they gave up...</z><z id="t1664667988" t="Drew Verlee Though it&apos;s possible things have improved sense then with the new version I mean aws has to invent lisp eventually, how else are the going to manage all these non lisp languages. https://docs.aws.amazon.com/cdk/v2/guide/home.html"><y>#</y><d>2022-10-01</d><h>23:46</h><r>Drew Verlee</r>Though it&apos;s possible things have improved sense then with the new version

I mean aws has to invent lisp eventually, how else are the going to manage all these non lisp languages.

<a href="https://docs.aws.amazon.com/cdk/v2/guide/home.html" target="_blank">https://docs.aws.amazon.com/cdk/v2/guide/home.html</a></z><z id="t1664675243" t="jjttjj For your first point about improving dev experience, have you checked out the cloud formation json spec at all? https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html I messed with a nested search of that once, where I had a rough/quick function that could take a search string for a resource type and spit out a rough skeleton of the resource template."><y>#</y><d>2022-10-02</d><h>01:47</h><r>jjttjj</r>For your first point about improving dev experience, have you checked out the cloud formation json spec at all? <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html</a>
I messed with a nested search of that once, where I had a rough/quick function that could take a search string for a resource type and spit out a rough skeleton of the resource template.</z><z id="t1664675325" t="Drew Verlee I hadn&apos;t looked at it, that looks promising."><y>#</y><d>2022-10-02</d><h>01:48</h><r>Drew Verlee</r>I hadn&apos;t looked at it, that looks promising.</z><z id="t1664675421" t="jjttjj I&apos;ve seen the cdk java libs used directly from clojure too, which seems pretty nice. I have preferred so far just sticking with cloud formation templates, but cdk had stuff that is much higher levels and for certain types of things it seems nicer"><y>#</y><d>2022-10-02</d><h>01:50</h><r>jjttjj</r>I&apos;ve seen the cdk java libs used directly from clojure too, which seems pretty nice. I have preferred so far just sticking with cloud formation templates, but cdk had stuff that is much higher levels and for certain types of things it seems nicer</z><z id="t1664675515" t="Drew Verlee interesting, yeah, i&apos;m curious if there are any easy wins here. Something tells me the answer is &quot;no&quot; but maybe things have changed sense the last time someone tried."><y>#</y><d>2022-10-02</d><h>01:51</h><r>Drew Verlee</r>interesting, yeah, i&apos;m curious if there are any easy wins here. Something tells me the answer is &quot;no&quot; but maybe things have changed sense the last time someone tried.</z><z id="t1664675667" t="jjttjj I think a lot of it might depend on what you&apos;re trying to do. Lately I&apos;ve been working primarily with lambdas and have settled on using the serverless transform macro in cloud formation to use this https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html (without using any of the rest of the serverless stack or the sam cli) which has been pretty nice for that"><y>#</y><d>2022-10-02</d><h>01:54</h><r>jjttjj</r>I think a lot of it might depend on what you&apos;re trying to do. Lately I&apos;ve been working primarily with lambdas and have settled on using the serverless transform macro in cloud formation to use this <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html" target="_blank">https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html</a> (without using any of the rest of the serverless stack or the sam cli) which has been pretty nice for that</z><z id="t1664675766" t="jjttjj But I&apos;ve also tried to get a fairly minimal fargate example working using cfn, and it wasn&apos;t pleasant at all, for that cdk seems much more useful"><y>#</y><d>2022-10-02</d><h>01:56</h><r>jjttjj</r>But I&apos;ve also tried to get a fairly minimal fargate example working using cfn, and it wasn&apos;t pleasant at all, for that cdk seems much more useful</z><z id="t1664675816" t="Drew Verlee i&apos;m suprised aws doesn&apos;t have a &quot;how to build a cdk&quot; section for xyz language."><y>#</y><d>2022-10-02</d><h>01:56</h><r>Drew Verlee</r>i&apos;m suprised aws doesn&apos;t have a &quot;how to build a cdk&quot; section for xyz language.</z><z id="t1664675830" t="Drew Verlee i guess they don&apos;t want to expose... something"><y>#</y><d>2022-10-02</d><h>01:57</h><r>Drew Verlee</r>i guess they don&apos;t want to expose... something</z><z id="t1664675898" t="jjttjj You mean like how to build a higher layer library on top of cloud formation?"><y>#</y><d>2022-10-02</d><h>01:58</h><r>jjttjj</r>You mean like how to build a higher layer library on top of cloud formation?</z><z id="t1664675991" t="Drew Verlee idk. 🤷"><y>#</y><d>2022-10-02</d><h>01:59</h><r>Drew Verlee</r>idk. <b>🤷</b></z><z id="t1664676083" t="jjttjj What kind of resources are you typically putting together in the stuff you work with?"><y>#</y><d>2022-10-02</d><h>02:01</h><r>jjttjj</r>What kind of resources are you typically putting together in the stuff you work with?</z><z id="t1664676163" t="Drew Verlee Iam, s3, cloudfront, recorsets, coudepipeline, route53"><y>#</y><d>2022-10-02</d><h>02:02</h><r>Drew Verlee</r>Iam, s3, cloudfront, recorsets, coudepipeline, route53</z><z id="t1664676483" t="jjttjj &gt; Another interesting tid bit is that cloudformation and the aws api seem to be subtly different and i&apos;m not sure why: One thing about this is the cloudformation templates need to be able to be diffed with the previous template in such a way that aws can magically make your old stack look like the new template in a sensible way, while the api just needs to say &quot;make this thing happen&quot;. It&apos;s a subtle difference and I can&apos;t think of any great examples at the moment that make it clear why they&apos;re different, but you&apos;ll hit them eventually"><y>#</y><d>2022-10-02</d><h>02:08</h><r>jjttjj</r>&gt; Another interesting tid bit is that cloudformation and the aws api seem to be subtly different and i&apos;m not sure why:
One thing about this is the cloudformation templates need to be able to be diffed with the previous template in such a way that aws can magically make your old stack look like the new template in a sensible way, while the api just needs to say &quot;make this thing happen&quot;. It&apos;s a subtle difference and I can&apos;t think of any great examples at the moment that make it clear why they&apos;re different, but you&apos;ll hit them eventually</z><z id="t1664676584" t="Drew Verlee yeah, that makes perfect sense. I was thinking i might be able to use the api fn signatures, but it&apos;s probably not worth it if there are even slightly different."><y>#</y><d>2022-10-02</d><h>02:09</h><r>Drew Verlee</r>yeah, that makes perfect sense. I was thinking i might be able to use the api fn signatures, but it&apos;s probably not worth it if there are even slightly different.</z><z id="t1664676698" t="jjttjj &gt; Iam, s3, cloudfront, recorsets, coudepipeline, route53 Gotcha yeah I&apos;m just starting to work with some of these but can&apos;t speak to them much from experience. I think I saw from one of the earlier discussions here that a lot of people here use cdk or terraform, which might have a better story for those than raw cfn. Personally my tendency is to try to stay in raw cfn but it definitely has its limits."><y>#</y><d>2022-10-02</d><h>02:11</h><r>jjttjj</r>&gt; Iam, s3, cloudfront, recorsets, coudepipeline, route53
Gotcha yeah I&apos;m just starting to work with some of these but can&apos;t speak to them much from experience. I think I saw from one of the earlier discussions here that a lot of people here use cdk or terraform, which might have a better story for those than raw cfn. Personally my tendency is to try to stay in raw cfn but it definitely has its limits.</z><z id="t1664676870" t="Drew Verlee i&apos;m just fing shocked that we live in a world where i can ask a machine to generate a picture of our president fighting a dinosaur. And at the same time, i&apos;m coding in YAML. It&apos;s like someone looked at the last 3 decades of pl research and wisdom and was like nah i don&apos;t need any of that."><y>#</y><d>2022-10-02</d><h>02:14</h><r>Drew Verlee</r>i&apos;m just fing shocked that we live in a world where i can ask a machine to generate a picture of our president fighting a dinosaur. And at the same time, i&apos;m coding in YAML. It&apos;s like someone looked at the last 3 decades of pl research and wisdom and was like nah i don&apos;t need any of that.</z><z id="t1664676936" t="jjttjj For example, this is kinda where I drew the line before with cfn, fargate: https://github.com/1Strategy/fargate-cloudformation-example/blob/master/fargate.yaml It&apos;s a massive template where you&apos;re working with pretty low level stuff compare to what you want to do with the deploying an image, and that template doesn&apos;t even include part you need like the VPC/subnets/etc which are in parameters (not my git repo just an example of what it looks like)"><y>#</y><d>2022-10-02</d><h>02:15</h><r>jjttjj</r>For example, this is kinda where I drew the line before with cfn, fargate: <a href="https://github.com/1Strategy/fargate-cloudformation-example/blob/master/fargate.yaml" target="_blank">https://github.com/1Strategy/fargate-cloudformation-example/blob/master/fargate.yaml</a> It&apos;s  a massive template where you&apos;re working with pretty low level stuff compare to what you want to do with the deploying an image, and that template doesn&apos;t even include part you need like the VPC/subnets/etc which are in parameters (not my git repo just an example of what it looks like)</z><z id="t1664677087" t="jjttjj but then the AWS: :Serverless: :Function I linked above on the other hand is pretty much just an all-in-one resource that will basically be sort of like a deployment config file for your function and is pretty nice to work with"><y>#</y><d>2022-10-02</d><h>02:18</h><r>jjttjj</r>but then the AWS:<b>:Serverless:</b>:Function I linked above on the other hand is pretty much just an all-in-one resource that will basically be sort of like a deployment config file for your function and is pretty nice to work with</z><z id="t1664677228" t="Drew Verlee I&apos;ll take a look when i get back, have to do life stuff. i&apos;m currently assuming i&apos;m going to be sticking with raw cf yaml for a while. 😢"><y>#</y><d>2022-10-02</d><h>02:20</h><r>Drew Verlee</r>I&apos;ll take a look when i get back, have to do life stuff. i&apos;m currently assuming i&apos;m going to be sticking with raw cf yaml for a while. <b>😢</b></z><z id="t1664677412" t="jjttjj It might just be a personal thing, but i really dislike yaml and would say that switching to edn then converting to json would be a big quality of life improvement, but i realize this might not be possible or ideal in all real world situations for various reasons"><y>#</y><d>2022-10-02</d><h>02:23</h><r>jjttjj</r>It might just be a personal thing, but i really dislike yaml and would say that switching to edn then converting to json would be a big quality of life improvement, but i realize this might not be possible or ideal in all real world situations for various reasons</z><z id="t1664677835" t="Drew Verlee Oh yeah, that&apos;s something we might be able to do. Alternatively, maybe just use typescript cdk."><y>#</y><d>2022-10-02</d><h>02:30</h><r>Drew Verlee</r>Oh yeah, that&apos;s something we might be able to do. Alternatively, maybe just use typescript cdk.</z><z id="t1664684516" t="Leaf Garland We looked at clj-cdk a while back but felt that a lot of the benefits of the cdk are lost unless you use a language with good completion and docs. So we went with typescript cdk. Clojure lsp is loads better these days so I can imagine that a better experience is possible, perhaps with spec to help validate."><y>#</y><d>2022-10-02</d><h>04:21</h><r>Leaf Garland</r>We looked at clj-cdk a while back but felt that a lot of the benefits of the cdk are lost unless you use a language with good completion and docs. So we went with typescript cdk. Clojure lsp is loads better these days so I can imagine that a better experience is possible, perhaps with spec to help validate.</z><z id="t1664686557" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U02EP7NKPAL&quot;}] the issue is aws doesn&apos;t seem to provide a full spec for cloudformation in a machine readable way. Given they have reimplemented it in 5 languages, they either have such a thing, or is a mad house over there. I suspect the later."><y>#</y><d>2022-10-02</d><h>04:55</h><r>Drew Verlee</r><a>@U02EP7NKPAL</a> the issue is aws doesn&apos;t seem to provide a full spec for cloudformation in a machine readable way. Given they have reimplemented it in 5 languages, they either have such a thing, or is a mad house over there. I suspect the later.</z><z id="t1664694386" t="Leaf Garland Oh they do have https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html . Also all the different language versions are partly generated and partly wrappers around the typescript SDK - when you use the java CDK lib it https://github.com/aws/jsii . Checkout https://github.com/aws/aws-cdk/tree/main/packages/@aws-cdk/cfnspec to see how they use that data in CDK."><y>#</y><d>2022-10-02</d><h>07:06</h><r>Leaf Garland</r>Oh they do have <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-resource-specification.html</a>. Also all the different language versions are partly generated and partly wrappers around the typescript SDK - when you use the java CDK lib it <a href="https://github.com/aws/jsii" target="_blank">https://github.com/aws/jsii</a>.

Checkout <a href="https://github.com/aws/aws-cdk/tree/main/packages/@aws-cdk/cfnspec" target="_blank">https://github.com/aws/aws-cdk/tree/main/packages/@aws-cdk/cfnspec</a> to see how they use that data in CDK.</z><z id="t1664768978" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U02EP7NKPAL&quot;}] i really appreciate you relinking that, i didn&apos;t read it right the first time, now i see the information is in there! Let see what i can do."><y>#</y><d>2022-10-03</d><h>03:49</h><r>Drew Verlee</r><a>@U02EP7NKPAL</a> i really appreciate you relinking that, i didn&apos;t read it right the first time, now i see the information is in there! Let see what i can do.</z><z id="t1664773318" t="Drew Verlee (-&gt;&gt; cloud-formation-resource-specification :ResourceTypes :aws.iam/role :Properties keys ) ;; =&gt; (:ManagedPolicyArns ;; :PermissionsBoundary ;; :Path ;; :Policies ;; :Tags ;; :RoleName ;; :MaxSessionDuration ;; :Description ;; :AssumeRolePolicyDocument) (-&gt;&gt; cloud-formation-resource-specification :ResourceTypes :aws.iam/role :Properties :RoleName) ;; =&gt; {:Documentation ;; &quot;&quot;, ;; :PrimitiveType &quot;String&quot;, ;; :Required false, ;; :UpdateType &quot;Immutable&quot;}"><y>#</y><d>2022-10-03</d><h>05:01</h><r>Drew Verlee</r><pre>(-&gt;&gt; cloud-formation-resource-specification
     :ResourceTypes
     :aws.iam/role
     :Properties
     keys
     )
;; =&gt; (:ManagedPolicyArns
;;     :PermissionsBoundary
;;     :Path
;;     :Policies
;;     :Tags
;;     :RoleName
;;     :MaxSessionDuration
;;     :Description
;;     :AssumeRolePolicyDocument)


(-&gt;&gt; cloud-formation-resource-specification
     :ResourceTypes
     :aws.iam/role
     :Properties
     :RoleName)
;; =&gt; {:Documentation
;;     &quot;&quot;,
;;     :PrimitiveType &quot;String&quot;,
;;     :Required false,
;;     :UpdateType &quot;Immutable&quot;}</pre></z><z id="t1664773324" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U02EP7NKPAL&quot;}] ^"><y>#</y><d>2022-10-03</d><h>05:02</h><r>Drew Verlee</r><a>@U02EP7NKPAL</a> ^</z><z id="t1664773346" t="Drew Verlee (ns drewverlee.aws.convert-cloud-formation-resource-specification (:require [hickory.core :as h] [clojure.string :as str] [clojure.data.json :as json] [camel-snake-kebab.core :as csk])) (defn aws-resource-string-&gt;aws-resource-keyword [aws-resource-string] (let [ss (map csk/-&gt;kebab-case (str/split aws-resource-string #&quot;::|\.&quot;))] (keyword (str (str/join &quot;.&quot; (butlast ss)) &quot;/&quot; (last ss))))) (def cloud-formation-resource-specification (-&gt; &quot;/home/drewverlee/Personal/try-cloudfromation/src/CloudFormationResourceSpecification.json&quot; slurp (json/read-str :key-fn (fn [k] (if-not (str/includes? k &quot;::&quot;) (keyword k) (aws-resource-string-&gt;aws-resource-keyword k))))))"><y>#</y><d>2022-10-03</d><h>05:02</h><r>Drew Verlee</r><pre>(ns drewverlee.aws.convert-cloud-formation-resource-specification
  (:require
   [hickory.core :as h]
   [clojure.string :as str]
   [clojure.data.json :as json]
   [camel-snake-kebab.core :as csk]))

(defn aws-resource-string-&gt;aws-resource-keyword
  [aws-resource-string]
  (let [ss (map csk/-&gt;kebab-case (str/split aws-resource-string #&quot;::|\.&quot;))]
    (keyword
     (str
      (str/join &quot;.&quot;  (butlast ss))
      &quot;/&quot;
      (last ss)))))

(def cloud-formation-resource-specification
  (-&gt; &quot;/home/drewverlee/Personal/try-cloudfromation/src/CloudFormationResourceSpecification.json&quot;
      slurp
      (json/read-str :key-fn (fn [k] (if-not (str/includes? k &quot;::&quot;)
                                       (keyword k)
                                       (aws-resource-string-&gt;aws-resource-keyword k))))))</pre></z><z id="t1664773366" t="Drew Verlee ill push to a github repo in a second."><y>#</y><d>2022-10-03</d><h>05:02</h><r>Drew Verlee</r>ill push to a github repo in a second.</z><z id="t1664777225" t="Drew Verlee Here is the repo! https://github.com/drewverlee/clojure-cloud-formation"><y>#</y><d>2022-10-03</d><h>06:07</h><r>Drew Verlee</r>Here is the repo! <a href="https://github.com/drewverlee/clojure-cloud-formation" target="_blank">https://github.com/drewverlee/clojure-cloud-formation</a></z><z id="t1664794103" t="danm Does the Cognitect AWS API offer anything interacting with the EC2 instance metadata? I can&apos;t find it in the docs, but other SDKs do. We want a Clojure process to be able to read the tags of the instance it&apos;s running on, which should be exposed via instance metadata"><y>#</y><d>2022-10-03</d><h>10:48</h><w>danm</w>Does the Cognitect AWS API offer anything interacting with the EC2 instance metadata? I can&apos;t find it in the docs, but other SDKs do. We want a Clojure process to be able to read the tags of the instance it&apos;s running on, which should be exposed via instance metadata</z><z id="t1664874694" t="Drew Verlee If you can tell me the name of the aws APi service that would respond with the ev2 metadata i can probably give you an example of getting it using the clojure api."><y>#</y><d>2022-10-04</d><h>09:11</h><r>Drew Verlee</r>If you can tell me the name of the aws APi service that would respond with the ev2 metadata i can probably give you an example of getting it using the clojure api.</z><z id="t1664893748" t="Dimitar Uzunov You can make a call to the metadata service and it responds with a json doc: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-identity-documents.html"><y>#</y><d>2022-10-04</d><h>14:29</h><r>Dimitar Uzunov</r>You can make a call to the metadata service and it responds with a json doc: <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-identity-documents.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-identity-documents.html</a></z><z id="t1664893844" t="Dimitar Uzunov This is useful when you want to query the tags from a process running on the instance"><y>#</y><d>2022-10-04</d><h>14:30</h><r>Dimitar Uzunov</r>This is useful when you want to query the tags from a process running on the instance</z><z id="t1664893884" t="Dimitar Uzunov A more flexible that works even if your process is not on the instance is to use describe instances and you get a ton of stuff"><y>#</y><d>2022-10-04</d><h>14:31</h><r>Dimitar Uzunov</r>A more flexible that works even if your process is not on the instance is to use describe instances and you get a ton of stuff</z><z id="t1664894113" t="Dimitar Uzunov Since originally tags were not available in the metadata service, you previously had to get the instance Id and then use it with describe instances to get get the tags; now the tags are available, but not by default - they have to be enabled"><y>#</y><d>2022-10-04</d><h>14:35</h><r>Dimitar Uzunov</r>Since originally tags were not available in the metadata service, you previously had to get the instance Id and then use it with describe instances to get get the tags; now the tags are available, but not by default - they have to be enabled</z><z id="t1664894132" t="Dimitar Uzunov I hope this helps [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}]"><y>#</y><d>2022-10-04</d><h>14:35</h><r>Dimitar Uzunov</r>I hope this helps <a>@U0DJ4T5U1</a></z><z id="t1664894990" t="Dimitar Uzunov Sorry I meant [:attrs {:href &quot;/_/_/users/U6SUWNB9N&quot;}]"><y>#</y><d>2022-10-04</d><h>14:49</h><r>Dimitar Uzunov</r>Sorry I meant <a>@U6SUWNB9N</a></z><z id="t1664898743" t="danm Cool, ta 🙂"><y>#</y><d>2022-10-04</d><h>15:52</h><r>danm</r>Cool, ta <b>🙂</b></z><z id="t1664899009" t="danm Yeah, there isn&apos;t really an API in the way we were originally hoping, we meant using the IMDSv2 service that runs on AWS instances. A lot of other AWS SDKs include support for getting the information out of that in a more &apos;language standard&apos; way, even though it&apos;s not explicitly an AWS API. It seems that neither the java v2 SDK nor the Cognitect Clojure SDK support it, so doing an instance metadata lookup externally is our best bet. We&apos;re using an ASG, and it seems to you can&apos;t turn the ability to read tags via instance metadata on through an ASG template, only through the launch template for an explicit instance, so :man-shrugging: :skin-tone-2:"><y>#</y><d>2022-10-04</d><h>15:56</h><r>danm</r>Yeah, there isn&apos;t really an API in the way we were originally hoping, we meant using the IMDSv2 service that runs on AWS instances. A lot of other AWS SDKs include support for getting the information out of that in a more &apos;language standard&apos; way, even though it&apos;s not explicitly an AWS API. It seems that neither the java v2 SDK nor the Cognitect Clojure SDK support it, so doing an instance metadata lookup externally is our best bet.

We&apos;re using an ASG, and it seems to you can&apos;t turn the ability to read tags via instance metadata on through an ASG template, only through the launch template for an explicit instance, so <b>:man-shrugging:</b><b>:skin-tone-2:</b></z><z id="t1664900595" t="Dimitar Uzunov Well in that case you can use the regular describe instances to get the tags, the v1 version is simple as curl to get you the instanceId"><y>#</y><d>2022-10-04</d><h>16:23</h><r>Dimitar Uzunov</r>Well in that case you can use the regular describe instances to get the tags, the v1 version is simple as <code>curl </code> to get you the instanceId</z><z id="t1665254654" t="lukasz in some environments, (Fargate for example) metadata URL is even provided via standard environment variable - so you don&apos;t have to hardcode the standard url (I believe it can change under certain circumstances)"><y>#</y><d>2022-10-08</d><h>18:44</h><r>lukasz</r>in some environments, (Fargate for example) metadata URL is even provided via standard environment variable - so you don&apos;t have to hardcode the standard url (I believe it can change under certain circumstances)</z><z id="t1664794197" t="danm I found https://cljdoc.org/d/com.cognitect.aws/api/0.8.301/api/cognitect.aws.client.api , but that specifically says it&apos;s implementation-internal"><y>#</y><d>2022-10-03</d><h>10:49</h><w>danm</w>I found <a href="https://cljdoc.org/d/com.cognitect.aws/api/0.8.301/api/cognitect.aws.client.api" target="_blank">https://cljdoc.org/d/com.cognitect.aws/api/0.8.301/api/cognitect.aws.client.api</a>, but that specifically says it&apos;s implementation-internal</z><z id="t1664810477" t="lukasz Are there any plans to migrate aws-api internals to use Jetty 10 (or 11)? Right now it&apos;s pulling jetty-util 9.4, which conflicts with dependencies required by Jetty 10 (the webserver part)"><y>#</y><d>2022-10-03</d><h>15:21</h><w>lukasz</w>Are there any plans to migrate aws-api internals to use Jetty 10 (or 11)? Right now it&apos;s pulling jetty-util 9.4, which conflicts with dependencies required by Jetty 10 (the webserver part)</z><z id="t1665502054" t="dchelimsky aws-api uses the Cognitect http-client, which is where the jetty dependency comes from. There is no plan to upgrade the http-client to jetty 10, however we are working on supporting the java http-client in aws-api when you&apos;re running on java &gt;= 11. I can&apos;t give you a solid timeline on that, but it is in progress work."><y>#</y><d>2022-10-11</d><h>15:27</h><r>dchelimsky</r>aws-api uses the Cognitect http-client, which is where the jetty dependency comes from. There is no plan to upgrade the http-client to jetty 10, however we are working on supporting the java http-client in aws-api when you&apos;re running on java &gt;= 11. I can&apos;t give you a solid timeline on that, but it is in progress work.</z><z id="t1665502129" t="Daniel Jomphe This looks even better to me than simply upgrading jetty!"><y>#</y><d>2022-10-11</d><h>15:28</h><r>Daniel Jomphe</r>This looks even better to me than simply upgrading jetty!</z><z id="t1665502212" t="Daniel Jomphe When you do so, if it makes sense, please remember to document the impact of configuring with jetty vs 11&apos;s client, if you measured some."><y>#</y><d>2022-10-11</d><h>15:30</h><r>Daniel Jomphe</r>When you do so, if it makes sense, please remember to document the impact of configuring with jetty vs 11&apos;s client, if you measured some.</z><z id="t1665502330" t="lukasz [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] nice, that sounds great, we&apos;re on java 11 and moving to 17 soon 👍"><y>#</y><d>2022-10-11</d><h>15:32</h><r>lukasz</r><a>@U0ENYLGTA</a> nice, that sounds great, we&apos;re on java 11 and moving to 17 soon <b>👍</b></z><z id="t1665503312" t="dchelimsky The feature we&apos;re introducing is more like &quot;Bring Your Own Http Client&quot; than &quot;yay, java 11 client&quot;. When we roll it out, there will be a protocol that you can reify to wrap the client of your choice, with implementations for the Cognitect http-client and the java 11 client. Once that&apos;s out, you could also write your own wrapper for jetty 10 or 11, clj-http, etc, etc."><y>#</y><d>2022-10-11</d><h>15:48</h><r>dchelimsky</r>The feature we&apos;re introducing is more like &quot;Bring Your Own Http Client&quot; than &quot;yay, java 11 client&quot;. When we roll it out, there will be a protocol that you can reify to wrap the client of your choice, with implementations for the Cognitect http-client and the java 11 client. Once that&apos;s out, you could also write your own wrapper for jetty 10 or 11, clj-http, etc, etc.</z><z id="t1665502054" t="dchelimsky aws-api uses the Cognitect http-client, which is where the jetty dependency comes from. There is no plan to upgrade the http-client to jetty 10, however we are working on supporting the java http-client in aws-api when you&apos;re running on java &gt;= 11. I can&apos;t give you a solid timeline on that, but it is in progress work."><y>#</y><d>2022-10-11</d><h>15:27</h><w>dchelimsky</w>aws-api uses the Cognitect http-client, which is where the jetty dependency comes from. There is no plan to upgrade the http-client to jetty 10, however we are working on supporting the java http-client in aws-api when you&apos;re running on java &gt;= 11. I can&apos;t give you a solid timeline on that, but it is in progress work.</z><z id="t1664980168" t="jjttjj Anyone happen to know if the latest version of https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html supports the recent https://aws.amazon.com/about-aws/whats-new/2022/09/amazon-dynamodb-supports-100-actions-per-transaction ? I&apos;m using the latest version of the dynamodb local, which was release after that announcement, but am getting {:__type &quot;com.amazon.coral.validate#ValidationException&quot;, :Message &quot;Member must have length less than or equal to 25&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} When transact-writing more than the old limit of 25. I&apos;m using aws-api with the latest versions and dynamodb release (which also happens after the new transaction increase announcement)."><y>#</y><d>2022-10-05</d><h>14:29</h><w>jjttjj</w>Anyone happen to know if the latest version of <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html" target="_blank">https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBLocal.DownloadingAndRunning.html</a> supports the recent <a href="https://aws.amazon.com/about-aws/whats-new/2022/09/amazon-dynamodb-supports-100-actions-per-transaction" target="_blank">https://aws.amazon.com/about-aws/whats-new/2022/09/amazon-dynamodb-supports-100-actions-per-transaction</a>? I&apos;m using the latest version of the dynamodb local, which was release after that announcement, but am getting
<pre>{:__type &quot;com.amazon.coral.validate#ValidationException&quot;,
  :Message &quot;Member must have length less than or equal to 25&quot;,
  :cognitect.anomalies/category :cognitect.anomalies/incorrect}</pre>
When transact-writing more than the old limit of 25.
I&apos;m using aws-api with the latest versions and dynamodb release (which also happens after the new transaction increase announcement).</z><z id="t1664995486" t="Drew Verlee Which library do you use to talk to aws? 1️⃣ Amazonica 2️⃣ aws-api 3️⃣ both 4️⃣ other?"><y>#</y><d>2022-10-05</d><h>18:44</h><w>Drew Verlee</w>Which library do you use to talk to aws?

<b>1️⃣</b> Amazonica
<b>2️⃣</b> aws-api
<b>3️⃣</b> both
<b>4️⃣</b> other?</z><z id="t1664999568" t="souenzzo My workflow is Start with aws-api, it is easy and idiomatic. In case of performance issue, or some missing operation, switch to java SDK(only for this operation)"><y>#</y><d>2022-10-05</d><h>19:52</h><r>souenzzo</r>My workflow is

Start with aws-api, it is easy and idiomatic.

In case of performance issue, or some missing operation, switch to java SDK(only for this operation)</z><z id="t1665001588" t="Drew Verlee thanks [:attrs {:href &quot;/_/_/users/U2J4FRT2T&quot;}] i have just been using the aws-api, so i was curious about amazonica and why people what people were using it for."><y>#</y><d>2022-10-05</d><h>20:26</h><r>Drew Verlee</r>thanks <a>@U2J4FRT2T</a> i have just been using the aws-api, so i was curious about amazonica and why people what people were using it for.</z><z id="t1665003711" t="lukasz Java SDK + aws-api in my case"><y>#</y><d>2022-10-05</d><h>21:01</h><r>lukasz</r>Java SDK + aws-api in my case</z><z id="t1665040020" t="Dimitar Uzunov No option for interop so I checked 2 and 4"><y>#</y><d>2022-10-06</d><h>07:07</h><r>Dimitar Uzunov</r>No option for interop so I checked 2 and 4</z><z id="t1665040061" t="Dimitar Uzunov But tbh I would take the cognitect lib over interop any time"><y>#</y><d>2022-10-06</d><h>07:07</h><r>Dimitar Uzunov</r>But tbh I would take the cognitect lib over interop any time</z><z id="t1665434337" t="Drew Verlee Is there anything to make aws respect change sets so that you can always roll forward? The headache is that if a aws cloudformation change set fails, you get stuck in some state and you have to delete the stack to try again. Which isn&apos;t ideal. Then when you go to delete the stack, that too can fail because the stack can&apos;t recursively delete things like s3 buckets. Does terraform improve on this?"><y>#</y><d>2022-10-10</d><h>20:38</h><w>Drew Verlee</w>Is there anything to make aws respect change sets so that you can always roll forward?

The headache is that if a aws cloudformation change set fails, you get stuck in some state and you have to delete the stack to try again. Which isn&apos;t ideal. Then when you go to delete the stack, that too can fail because the stack can&apos;t recursively delete things like s3 buckets.

Does terraform improve on this?</z><z id="t1665434924" t="lukasz yes"><y>#</y><d>2022-10-10</d><h>20:48</h><w>lukasz</w>yes</z><z id="t1665434962" t="lukasz most of the time you can: • re-apply and TF will resolve the changes and get you into correct state • you can taint selected resources to recreate them after next plan+apply cycle"><y>#</y><d>2022-10-10</d><h>20:49</h><w>lukasz</w>most of the time you can:
• re-apply and TF will resolve the changes and get you into correct state
• you can taint selected resources to recreate them after next plan+apply cycle</z><z id="t1665438300" t="Drew Verlee Why hasn&apos;t aws done this? i&apos;m baffled, do they just not care to match expectations with modern devops functionality?"><y>#</y><d>2022-10-10</d><h>21:45</h><w>Drew Verlee</w>Why hasn&apos;t aws done this? i&apos;m baffled, do they just not care to match expectations with modern devops functionality?</z><z id="t1665442492" t="lukasz Not sure, never used CloudFormation to be honest, so I&apos;m kinda surprised it doesn&apos;t have that kind of a feature"><y>#</y><d>2022-10-10</d><h>22:54</h><w>lukasz</w>Not sure, never used CloudFormation to be honest, so  I&apos;m kinda surprised it doesn&apos;t have that kind of a feature</z><z id="t1665591733" t="Drew Verlee does anyone have some aws-api code that will delete a bucket and all its objects? apparently aws doesn&apos;t believe i would ever want to do such a thing and requires this to be several steps."><y>#</y><d>2022-10-12</d><h>16:22</h><w>Drew Verlee</w>does anyone have some aws-api code that will delete a bucket and all its objects? apparently aws doesn&apos;t believe i would ever want to do such a thing and requires this to be several steps.</z><z id="t1665592099" t="lukasz you need to combine ListObjectsV2 with DeleteVersion and/or DeleteObject - there&apos;s no single API call that nukes a bucket and its contents"><y>#</y><d>2022-10-12</d><h>16:28</h><r>lukasz</r>you need to combine <code>ListObjectsV2</code> with <code>DeleteVersion</code> and/or <code>DeleteObject</code> - there&apos;s no single API call that nukes a bucket and its contents</z><z id="t1665592464" t="Drew Verlee And then delete bucket. Yeah thats what i figured, it really feels like aws doesn&apos;t use there own api&apos;s. A file system where you cant delete a folder? That&apos;s unheard of."><y>#</y><d>2022-10-12</d><h>16:34</h><r>Drew Verlee</r>And then delete bucket. Yeah thats what i figured, it really feels like aws doesn&apos;t use there own api&apos;s. A file system where you cant delete a folder? That&apos;s unheard of.</z><z id="t1665592571" t="lukasz because it&apos;s not a file system :-)"><y>#</y><d>2022-10-12</d><h>16:36</h><r>lukasz</r>because it&apos;s not a file system :-)</z><z id="t1665592806" t="Drew Verlee Sure, but the fact remains, it&apos;s forcing it&apos;s users to jump through hopes for reasons i can&apos;t fathom."><y>#</y><d>2022-10-12</d><h>16:40</h><r>Drew Verlee</r>Sure, but the fact remains, it&apos;s forcing it&apos;s users to jump through hopes for reasons i can&apos;t fathom.</z><z id="t1665592908" t="lukasz It&apos;s because of customer support: if there was a DeleteBucketAndEverything API call, there&apos;s no way to recover, at least with object versioning (if it&apos;s enabled!) you have a chance to get your data back somehow. Source: I deleted customer data way too many times I&apos;m caring to admit and had to build DR features into many products"><y>#</y><d>2022-10-12</d><h>16:41</h><r>lukasz</r>It&apos;s because of customer support: if there was a <code>DeleteBucketAndEverything</code> API call, there&apos;s no way to recover, at least with object versioning (if it&apos;s enabled!) you have a chance to get your data back somehow. Source: I deleted customer data way too many times I&apos;m caring to admit and had to build DR features into many products</z><z id="t1665593091" t="Drew Verlee Thanks, yeah. I guess I see why they would think that, even if i fundementally disagree that adding steps makes things more secure. Where do you draw the line? What if you had to call aws and talk to a s3 supervisor to delete your bucket? Sure less buckets would get deleted, but at what cost?"><y>#</y><d>2022-10-12</d><h>16:44</h><r>Drew Verlee</r>Thanks, yeah. I guess I see why they would think that, even if i fundementally disagree that adding steps makes things more secure.

Where do you draw the line? What if you had to call aws and talk to a s3 supervisor to delete your bucket? Sure less buckets would get deleted, but at what cost?</z><z id="t1665593155" t="lukasz You can&apos;t actually, I have a 2TB bucket that needs to go and support told me to do it myself, carefully"><y>#</y><d>2022-10-12</d><h>16:45</h><r>lukasz</r>You can&apos;t actually,  I have a 2TB bucket that needs to go and support told me to do it myself, carefully</z><z id="t1665593218" t="Drew Verlee can&apos;t what? call support? I was suggesting it would be a huge time sink if you had to call support, not that i wanted to."><y>#</y><d>2022-10-12</d><h>16:46</h><r>Drew Verlee</r>can&apos;t what? call support? I was suggesting it would be a huge time sink if you had to call support, not that i wanted to.</z><z id="t1665593288" t="lukasz sorry, what I meant was that I requested that from support (my co had/has a paid support tier) and they do not perform data deletion requests on your behalf - at least they didn&apos;t in my case"><y>#</y><d>2022-10-12</d><h>16:48</h><r>lukasz</r>sorry, what I meant was that I requested that from support (my co had/has a paid support tier) and they do not perform data deletion requests on your behalf - at least they didn&apos;t in my case</z><z id="t1665594181" t="lispyclouds depending on how big the bucket is ive seen creating a lifecycle policy of deletion after 0 daysand attaching to all objects is nicer. we had 3 ~550TB buckets, that did it much better than any direct api calls"><y>#</y><d>2022-10-12</d><h>17:03</h><r>lispyclouds</r>depending on how big the bucket is ive seen creating a lifecycle policy of deletion after 0 daysand attaching to all objects is nicer. we had 3 ~550TB buckets, that did it much better than any direct api calls</z><z id="t1665594254" t="lukasz ah yeah, at bigger scales you can&apos;t use the API for deletions"><y>#</y><d>2022-10-12</d><h>17:04</h><r>lukasz</r>ah yeah, at bigger scales you can&apos;t use the API for deletions</z><z id="t1665594395" t="lispyclouds If anyone’s wondering, that took about 2 days to delete 😅"><y>#</y><d>2022-10-12</d><h>17:06</h><r>lispyclouds</r>If anyone’s wondering, that took about 2 days to delete <b>😅</b></z><z id="t1665596227" t="kenny Somewhat related: a technique for speeding up list object calls https://www.genui.com/open-source/s3p-massively-parallel-s3-copying"><y>#</y><d>2022-10-12</d><h>17:37</h><r>kenny</r>Somewhat related: a technique for speeding up list object calls <a href="https://www.genui.com/open-source/s3p-massively-parallel-s3-copying" target="_blank">https://www.genui.com/open-source/s3p-massively-parallel-s3-copying</a></z><z id="t1665641818" t="Dimitar Uzunov You can shell out to this: https://docs.aws.amazon.com/cli/latest/reference/s3/rb.html There is a --force option that deletes bucket contents"><y>#</y><d>2022-10-13</d><h>06:16</h><r>Dimitar Uzunov</r>You can shell out to this: <a href="https://docs.aws.amazon.com/cli/latest/reference/s3/rb.html" target="_blank">https://docs.aws.amazon.com/cli/latest/reference/s3/rb.html</a>

There is a --force option that deletes bucket contents</z><z id="t1665642138" t="Dimitar Uzunov you may need to implement retries if you have lots of items in a bucket, I remember running this a more than once on a bucket"><y>#</y><d>2022-10-13</d><h>06:22</h><r>Dimitar Uzunov</r>you may need to implement retries if you have lots of items in a bucket, I remember running this a more than once on a bucket</z><z id="t1665642187" t="Dimitar Uzunov (clojure.java.shell/sh &quot;aws&quot; &quot;s3&quot; &quot;rb&quot; (str &quot;s3://&quot; bucket-name) &quot;--force&quot;)"><y>#</y><d>2022-10-13</d><h>06:23</h><r>Dimitar Uzunov</r><pre>(clojure.java.shell/sh &quot;aws&quot; &quot;s3&quot; &quot;rb&quot; (str &quot;s3://&quot; bucket-name) &quot;--force&quot;)</pre></z><z id="t1665642195" t="Dimitar Uzunov you must have the aws cli installed though"><y>#</y><d>2022-10-13</d><h>06:23</h><r>Dimitar Uzunov</r>you must have the aws cli installed though</z><z id="t1665772253" t="dchelimsky [ANN] https://groups.google.com/g/clojure/c/1p3v71uWJY0/m/tX8p4eMDCgAJ"><y>#</y><d>2022-10-14</d><h>18:30</h><w>dchelimsky</w>[ANN] <a href="https://groups.google.com/g/clojure/c/1p3v71uWJY0/m/tX8p4eMDCgAJ" target="_blank">https://groups.google.com/g/clojure/c/1p3v71uWJY0/m/tX8p4eMDCgAJ</a></z><z id="t1666298322" t="Drew Verlee Has anyone effectively used datalog (datomic, juxt, datascript, etc..) to manage and organize there cloudformation information?"><y>#</y><d>2022-10-20</d><h>20:38</h><w>Drew Verlee</w>Has anyone effectively used datalog (datomic, juxt, datascript, etc..) to manage and organize there cloudformation information?</z><z id="t1666298496" t="Drew Verlee Having to use the aws console to go from my cf stack -&gt; resources -&gt; other info is fairly exhausting. I&apos;m thinking something like: [?s :stack/name &quot;test&quot;] [?s :stack/resource ?res] [?res :resource/name &quot;repo&quot;] [?res :cloudwatch/logs ?logs] where logs is the url of the log that you can then query against to get information like events or the fact that my cf deploy failed bc, etc..."><y>#</y><d>2022-10-20</d><h>20:41</h><w>Drew Verlee</w>Having to use the aws console to go from my cf stack -&gt; resources -&gt; other info is fairly exhausting. I&apos;m thinking something like:

[?s :stack/name &quot;test&quot;]
[?s :stack/resource ?res]
[?res :resource/name &quot;repo&quot;]
[?res :cloudwatch/logs ?logs]

where logs is the url of the log that you can then query against to get information like events or the fact that my  cf deploy failed bc, etc...</z><z id="t1666307266" t="kenny The resource mapping will be tricky. You may be able to get by with a 3rd party tool like https://www.cloudquery.io/ . "><y>#</y><d>2022-10-20</d><h>23:07</h><r>kenny</r>The resource mapping will be tricky. You may be able to get by with a 3rd party tool like <a href="https://www.cloudquery.io/" target="_blank">https://www.cloudquery.io/</a>. </z><z id="t1666307399" t="Drew Verlee What do you mean resource mapping? I&apos;m thinking the resource name to arn mapping"><y>#</y><d>2022-10-20</d><h>23:09</h><r>Drew Verlee</r>What do you mean resource mapping? I&apos;m thinking the resource name to arn mapping</z></g><g id="s18"><z id="t1666321736" t="Drew Verlee Is it possible to rename an ecr repo? Put a better way, &quot;how would you rename an ecr repo&quot;?"><y>#</y><d>2022-10-21</d><h>03:08</h><w>Drew Verlee</w>Is it possible to rename an ecr repo? Put a better way, &quot;how would you rename an ecr repo&quot;?</z><z id="t1666338196" t="msolli You can’t. You must create a new repo with a name. Cloudformation and Terraform will manage the replacement for you, though; ( https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html ) &gt; Update requires: https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement"><y>#</y><d>2022-10-21</d><h>07:43</h><w>msolli</w>You can’t. You must create a new repo with a name. Cloudformation and Terraform will manage the replacement for you, though; (<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html</a>)
&gt; Update requires: <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement" target="_blank">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-update-behaviors.html#update-replacement</a></z><z id="t1666338886" t="Drew Verlee I&apos;ll give that a close read... Does that link tell me how to tell aws to do the replacement?"><y>#</y><d>2022-10-21</d><h>07:54</h><r>Drew Verlee</r>I&apos;ll give that a close read... Does that link tell me how to tell aws to do the replacement?</z><z id="t1666338899" t="Drew Verlee And thanks a ton!"><y>#</y><d>2022-10-21</d><h>07:54</h><r>Drew Verlee</r>And thanks a ton!</z><z id="t1666338963" t="msolli Well, no, or that depends how you provision resources in AWS. Don’t think you can do it in the console, for example."><y>#</y><d>2022-10-21</d><h>07:56</h><r>msolli</r>Well, no, or that depends how you provision resources in AWS. Don’t think you can do it in the console, for example.</z><z id="t1666339027" t="msolli I use Terraform - if I would change the name in the Terraform config, then Terraform would create a new repo, and updated the references to the old repo wherever that referenced in the config."><y>#</y><d>2022-10-21</d><h>07:57</h><r>msolli</r>I use Terraform - if I would change the name in the Terraform config, then Terraform would create a new repo, and updated the references to the old repo wherever that referenced in the config.</z><z id="t1666367505" t="Drew Verlee [:attrs {:href &quot;/_/_/users/U06BEJGKD&quot;}] by &quot;provision the resource&quot; are my options cf or tf?"><y>#</y><d>2022-10-21</d><h>15:51</h><r>Drew Verlee</r><a>@U06BEJGKD</a> by &quot;provision the resource&quot; are my options cf or tf?</z><z id="t1666596944" t="msolli There are probably many more options, but Cloudformation and Terraform are certainly among the most widely used. AWS CDK is getting popular, as well ( https://aws.amazon.com/cdk/ ). I have experience with Terraform, which I highly recommend. As for your specific question - how did you create the ECR repo? In the console? Then I guess you should just create a new repo with the new name and start using that, and delete the old."><y>#</y><d>2022-10-24</d><h>07:35</h><r>msolli</r>There are probably many more options, but Cloudformation and Terraform are certainly among the most widely used. AWS CDK is getting popular, as well (<a href="https://aws.amazon.com/cdk/" target="_blank">https://aws.amazon.com/cdk/</a>). I have experience with Terraform, which I highly recommend.

As for your specific question - how did you create the ECR repo? In the console? Then I guess you should just create a new repo with the new name and start using that, and delete the old.</z><z id="t1666632617" t="Drew Verlee thanks [:attrs {:href &quot;/_/_/users/U06BEJGKD&quot;}] that makes sense, yeah, i think we can build a clojure cdk using the cloudformation resource specification. i tried starting to do that here. https://github.com/drewverlee/clojure-cloud-formation but currently i&apos;m still in the research phase to see if it&apos;s possible. I looked at jsii and i didn&apos;t look as appealing as using the spec (above)."><y>#</y><d>2022-10-24</d><h>17:30</h><r>Drew Verlee</r>thanks <a>@U06BEJGKD</a> that makes sense, yeah, i think we can build a clojure cdk using the cloudformation resource specification. i tried starting to do that here.  <a href="https://github.com/drewverlee/clojure-cloud-formation" target="_blank">https://github.com/drewverlee/clojure-cloud-formation</a> but currently i&apos;m still in the research phase to see if it&apos;s possible. I looked at jsii and i didn&apos;t look as appealing as using the spec (above).</z><z id="t1666371359" t="Drew Verlee Would anyone be up for a live virtual online meeting about devops via clojure? Right here in this channel via huddle? As to when, i&apos;m down for this whenever."><y>#</y><d>2022-10-21</d><h>16:55</h><w>Drew Verlee</w>Would anyone be up for a live virtual online meeting about devops via clojure? Right here in this channel via huddle? As to when, i&apos;m down for this whenever.</z><z id="t1666428711" t="Dimitar Uzunov I can join in"><y>#</y><d>2022-10-22</d><h>08:51</h><r>Dimitar Uzunov</r>I can join in</z><z id="t1666483050" t="Drew Verlee Sounds good, you tell me when in the next couple days, and we can just jump into a huddle and chat for a bit. I&apos;m open ended, just want to talk and show how i interact with aws"><y>#</y><d>2022-10-22</d><h>23:57</h><r>Drew Verlee</r>Sounds good, you tell me when in the next couple days, and we can just jump into a huddle and chat for a bit. I&apos;m open ended, just want to talk and show how i interact with aws</z><z id="t1666611322" t="Dimitar Uzunov Sure [:attrs {:href &quot;/_/_/users/U0DJ4T5U1&quot;}] ! I would love to check it out and exchange experience. Currently I’m home with my daughter who has a cold but I expect her to recover if not tomorrow then on Wednesday . I’m in Europe"><y>#</y><d>2022-10-24</d><h>11:35</h><r>Dimitar Uzunov</r>Sure <a>@U0DJ4T5U1</a>! I would love to check it out and exchange experience. Currently I’m home with my daughter who has a cold but I expect her to recover if not tomorrow then on Wednesday . I’m in Europe</z><z id="t1666746808" t="Drew Verlee [:attrs {:href &quot;/_/_/users/ULE3UT8Q5&quot;}] let me know when your free tomorrow."><y>#</y><d>2022-10-26</d><h>01:13</h><r>Drew Verlee</r><a>@ULE3UT8Q5</a> let me know when your free tomorrow.</z><z id="t1666765409" t="Dimitar Uzunov 7PM EEST (UTC+3)?"><y>#</y><d>2022-10-26</d><h>06:23</h><r>Dimitar Uzunov</r>7PM EEST (UTC+3)?</z><z id="t1666813586" t="Drew Verlee err your 8 hours ahead of me. So maybe like friday at like 10am my time and 6pm your time?"><y>#</y><d>2022-10-26</d><h>19:46</h><r>Drew Verlee</r>err your 8 hours ahead of me. So maybe like friday at like 10am my time and 6pm your time?</z><z id="t1666844053" t="Dimitar Uzunov I&apos;m flying out on Friday, sometime next week then?"><y>#</y><d>2022-10-27</d><h>04:14</h><r>Dimitar Uzunov</r>I&apos;m flying out on Friday, sometime next week then?</z><z id="t1666893538" t="Drew Verlee sounds good, will make it happen 🙂"><y>#</y><d>2022-10-27</d><h>17:58</h><r>Drew Verlee</r>sounds good, will make it happen <b>🙂</b></z><z id="t1666486095" t="Drew Verlee working the aws-api makes me understand why there is an iteration function in the core library now."><y>#</y><d>2022-10-23</d><h>00:48</h><w>Drew Verlee</w>working the aws-api makes me understand why there is an iteration function in the core library now.</z><z id="t1666489601" t="Drew Verlee basically i&apos;m doing a lot of this: (iteration (fn [token] (aws/invoke (aws/client {:api :codepipeline :region &quot;us-east-2&quot; :provider caws/provider}) {:op :ListPipelines :request {:nextToken token}})) :kf :nextToken :vf :pipelines) (take 3 pipe) ;; =&gt; ([{:name &quot;cac-training-Pipeline-BATF3SECTRPT&quot;, ;; :version 1, ;; :created #inst &quot;2022-10-21T04:16:15.000-00:00&quot;, ;; :updated #inst &quot;2022-10-21T04:16:15.000-00:00&quot;} ;; {:name ;; &quot;cacapi-training-DeploymentPipeline-1A5UTBE4M0MM0-Pipeline-1EK0CVNJQP4TL&quot;, ;; :version 2, ;; :created #inst &quot;2022-10-21T03:46:36.000-00:00&quot;, ;; :updated #inst &quot;2022-10-21T20:21:33.000-00:00&quot;}])"><y>#</y><d>2022-10-23</d><h>01:46</h><w>Drew Verlee</w>basically i&apos;m doing a lot of this:

<pre>(iteration (fn [token]
               (aws/invoke (aws/client {:api :codepipeline :region &quot;us-east-2&quot; :provider caws/provider})
                           {:op :ListPipelines :request {:nextToken token}}))
             :kf :nextToken
             :vf :pipelines)

  (take 3 pipe)
  ;; =&gt; ([{:name &quot;cac-training-Pipeline-BATF3SECTRPT&quot;,
  ;;       :version 1,
  ;;       :created #inst &quot;2022-10-21T04:16:15.000-00:00&quot;,
  ;;       :updated #inst &quot;2022-10-21T04:16:15.000-00:00&quot;}
  ;;      {:name
  ;;       &quot;cacapi-training-DeploymentPipeline-1A5UTBE4M0MM0-Pipeline-1EK0CVNJQP4TL&quot;,
  ;;       :version 2,
  ;;       :created #inst &quot;2022-10-21T03:46:36.000-00:00&quot;,
  ;;       :updated #inst &quot;2022-10-21T20:21:33.000-00:00&quot;}])</pre></z><z id="t1666574808" t="Drew Verlee code i wrote recently to get logs: ;; credit for lazy-concat this goes to juxt post on iterat (defn lazy-concat &quot;A concat version that is completely lazy and does not require to use apply.&quot; [colls] (lazy-seq (when-first [c colls] (lazy-cat c (lazy-concat (rest colls)))))) (defn log-group-name-&gt;logs &quot;given a `log-group-name` (e.g &apos;staging&apos;) returns the log locally&quot; [log-group-name] (-&gt;&gt; (iteration (fn [token] (icc :DescribeLogStreams (cond-&gt; {:logGroupName log-group-name} token (assoc :nextToken token)))) :vf (fn [{:keys [logStreams]}] (reduce (fn [all-log-streams log-stream] (concat all-log-streams (-&gt; (icc :GetLogEvents (-&gt; log-stream (select-keys [:logStreamName]) (assoc :logGroupName log-group-name))) :events))) [] logStreams)) :kf :nextToken) ;;TODO make this lazy by using something other then apply concat lazy-concat)) And then i do this: (defn get-codebuild-logs [] (log-group-name-&gt;logs &quot;/aws/codebuild/cacapi-training-codebuildproject&quot;)) (transduce (halt-when (fn [{:keys [message]}] (str/includes? message &quot;FAILED&quot;)) (fn [completed-result input-triggered] {:trigger input-triggered :last-5-leading-upto-it (take-last 5 completed-result)})) conj codebuild-logs) It still takes about 15 seconds, which is 15 seconds longer then i would like.. I mean, that seems really slow honestly. Whats going on here? Do i have some huge area for improvement or is aws just throttling requests because they want me to use the console (i&apos;m only half joking)."><y>#</y><d>2022-10-24</d><h>01:26</h><w>Drew Verlee</w>code i wrote recently to get logs:

<pre>;; credit for lazy-concat this goes to juxt post on iterat
(defn lazy-concat
  &quot;A concat version that is completely lazy and
  does not require to use apply.&quot;
  [colls]
  (lazy-seq
   (when-first [c colls]
     (lazy-cat c (lazy-concat (rest colls))))))


(defn log-group-name-&gt;logs
  &quot;given a `log-group-name` (e.g &apos;staging&apos;) returns the log locally&quot;
  [log-group-name]
  (-&gt;&gt; (iteration
        (fn [token]
          (icc :DescribeLogStreams
               (cond-&gt; {:logGroupName log-group-name} token (assoc :nextToken token))))
        :vf (fn [{:keys [logStreams]}]
              (reduce
               (fn [all-log-streams log-stream]
                 (concat all-log-streams (-&gt; (icc :GetLogEvents
                                                  (-&gt; log-stream
                                                      (select-keys [:logStreamName])
                                                      (assoc :logGroupName log-group-name)))
                                             :events)))
               []
               logStreams))
        :kf :nextToken)
         ;;TODO make this lazy by using something other then apply concat
       lazy-concat))</pre>
And then i do this:

<pre>(defn get-codebuild-logs []
  (log-group-name-&gt;logs &quot;/aws/codebuild/cacapi-training-codebuildproject&quot;))</pre>
<pre>(transduce
    (halt-when (fn [{:keys [message]}] (str/includes? message &quot;FAILED&quot;))
              (fn [completed-result input-triggered] {:trigger input-triggered
                                                      :last-5-leading-upto-it (take-last 5 completed-result)}))
   conj
   codebuild-logs)</pre>
It still takes about 15 seconds, which is 15 seconds longer then i would like.. I mean, that seems really slow honestly. Whats going on here? Do i have some huge area for improvement or is aws just throttling requests because they want me to use the console (i&apos;m only half joking).</z><z id="t1667065203" t="Benjamin I have queried cloudwatch in the past and found it extremely slow. Depends on the amount of logs I suppose. For some production log stream it took 2-5minutes to query a timerange of 15 hours or so. And limiting the time range sped it up significantly"><y>#</y><d>2022-10-29</d><h>17:40</h><r>Benjamin</r>I  have queried cloudwatch in the past and found it extremely slow. Depends on the amount of logs I suppose. For some production log stream it took 2-5minutes to query a timerange of 15 hours or so. And limiting the time range sped it up significantly</z><z id="t1667058786" t="Drew Verlee Anyone know how to get a bucket in another region using amazonica? i&apos;m looking at the docs now..."><y>#</y><d>2022-10-29</d><h>15:53</h><w>Drew Verlee</w>Anyone know how to get a bucket in another region using amazonica? i&apos;m looking at the docs now...</z><z id="t1667058876" t="Drew Verlee Additionally, all of the functions may take as their first argument an optional map of credentials: (def cred {:access-key &quot;aws-access-key&quot; :secret-key &quot;aws-secret-key&quot; :endpoint &quot;us-west-1&quot;}) "><y>#</y><d>2022-10-29</d><h>15:54</h><r>Drew Verlee</r>Additionally, all of the functions may take as their first argument an optional map of credentials:
<pre>(def cred {:access-key &quot;aws-access-key&quot;
           :secret-key &quot;aws-secret-key&quot;
           :endpoint   &quot;us-west-1&quot;})</pre>
</z><z id="t1667204163" t="msolli Buckets are global. What do you mean by “get a bucket in another region”?"><y>#</y><d>2022-10-31</d><h>08:16</h><r>msolli</r>Buckets are global. What do you mean by “get a bucket in another region”?</z><z id="t1667205974" t="msolli Sorry, bucket names are global. Buckets are in a particular region, of course."><y>#</y><d>2022-10-31</d><h>08:46</h><r>msolli</r>Sorry, bucket names are global. Buckets are in a particular region, of course.</z><z id="t1667538304" t="Drew Verlee Here is some example code of querying ssm using datalog. ;; get all the ssm parameters (get-all-ssm-params!) ;; =&gt; [{:LastModifiedDate #inst &quot;2022-11-04T03:57:44.000-00:00&quot;, ;; :Value &quot;mi-woot&quot;, ;; :ARN ;; &quot;arn:aws:ssm:us-east-1:595680822218:parameter/state/michigan/zip/123/password&quot;, ;; :Name &quot;/state/michigan/zip/123/password&quot;, ;; :Type &quot;String&quot;, ;; :Version 1, ;; :DataType &quot;text&quot;} ;; {:LastModifiedDate #inst &quot;2022-11-04T03:58:12.000-00:00&quot;, ;; :Value &quot;mi-nope&quot;, ;; :ARN ;; &quot;arn:aws:ssm:us-east-1:595680822218:parameter/state/michigan/zip/981/password&quot;, ;; :Name &quot;/state/michigan/zip/981/password&quot;, ;; :Type &quot;String&quot;, ;; :Version 1, ;; :DataType &quot;text&quot;}] ;; are all our params with a zip code in the 981 area secure? (let [ssm-params (get-all-ssm-params!) schema (ssm-params-&gt;schema ssm-params) conn (d/create-conn schema)] (d/transact! conn (mapcat param-&gt;txts ssm-params)) (d/q &apos;[:find ?type :where [?e :zip &quot;981&quot;] [?e :password ?v] [?v :Type ?type]] @conn)) ;; =&gt; #{[&quot;String&quot;]} ;; oh no, there all strings! Not SecureStings!"><y>#</y><d>2022-11-04</d><h>05:05</h><w>Drew Verlee</w>Here is some example code of querying ssm using datalog.

<pre>;; get all the ssm parameters
(get-all-ssm-params!)
;; =&gt; [{:LastModifiedDate #inst &quot;2022-11-04T03:57:44.000-00:00&quot;,
;;      :Value &quot;mi-woot&quot;,
;;      :ARN
;;      &quot;arn:aws:ssm:us-east-1:595680822218:parameter/state/michigan/zip/123/password&quot;,
;;      :Name &quot;/state/michigan/zip/123/password&quot;,
;;      :Type &quot;String&quot;,
;;      :Version 1,
;;      :DataType &quot;text&quot;}
;;     {:LastModifiedDate #inst &quot;2022-11-04T03:58:12.000-00:00&quot;,
;;      :Value &quot;mi-nope&quot;,
;;      :ARN
;;      &quot;arn:aws:ssm:us-east-1:595680822218:parameter/state/michigan/zip/981/password&quot;,
;;      :Name &quot;/state/michigan/zip/981/password&quot;,
;;      :Type &quot;String&quot;,
;;      :Version 1,
;;      :DataType &quot;text&quot;}]

;; are all our params with a zip code in the 981 area secure?
(let [ssm-params (get-all-ssm-params!)
      schema (ssm-params-&gt;schema ssm-params)
      conn   (d/create-conn schema)]
  (d/transact! conn (mapcat param-&gt;txts ssm-params))
  (d/q &apos;[:find ?type
         :where
         [?e :zip &quot;981&quot;]
         [?e :password ?v]
         [?v :Type ?type]]
       @conn))
;; =&gt; #{[&quot;String&quot;]}

;; oh no, there all strings! Not SecureStings!</pre></z><z id="t1667538531" t="Drew Verlee I have found that a lot of places i have worked at use ssm and end up copying a set param keys per something (sometimes customer or env). And it quickly becomes really hard to get views over various parts of the trees. E.g all the passwords for a common thing all the customers have. Idk let me know if you think this sounds useful or if you see some issue with it. I&apos;ll try to get the rest of the code in a git hub repo if ppl are interested."><y>#</y><d>2022-11-04</d><h>05:08</h><w>Drew Verlee</w>I have found that a lot of places i have worked at use ssm and end up copying a set param keys per something (sometimes customer or env). And it quickly becomes really hard to get views over various parts of the trees. E.g all the passwords for a common thing all the customers have.

Idk let me know if you think this sounds useful or if you see some issue with it. I&apos;ll try to get the rest of the code in a git hub repo if ppl are interested.</z><z id="t1667548508" t="viesti I heard a story from a customer that they do this kind of data extraction from client AWS accounts, by extracting bunch of data from the AWS account, tucking it into Datahike (I think?) and then making all sorts of queries to analyse security aspects"><y>#</y><d>2022-11-04</d><h>07:55</h><w>viesti</w>I heard a story from a customer that they do this kind of data extraction from client AWS accounts, by extracting bunch of data from the AWS account, tucking it into Datahike (I think?) and then making all sorts of queries to analyse security aspects</z><z id="t1667548530" t="viesti So yeah, I think tucking the data into a queryable database for analysis is a thing"><y>#</y><d>2022-11-04</d><h>07:55</h><w>viesti</w>So yeah, I think tucking the data into a queryable database for analysis is a thing</z><z id="t1667598722" t="sun-one Does anyone have a work around for invoking lambdas using ARNs with cognitect/aws lib see ( https://github.com/cognitect-labs/aws-api/issues/193 ) ?"><y>#</y><d>2022-11-04</d><h>21:52</h><w>sun-one</w>Does anyone have a work around for invoking lambdas using ARNs with cognitect/aws lib see (<a href="https://github.com/cognitect-labs/aws-api/issues/193" target="_blank">https://github.com/cognitect-labs/aws-api/issues/193</a>) ?</z><z id="t1667609624" t="Drew Verlee Never ran into it :("><y>#</y><d>2022-11-05</d><h>00:53</h><r>Drew Verlee</r>Never ran into it :(</z><z id="t1667615797" t="sun-one I ended up just biting the bullet and using the aws java sdk package (not nearly as good UX wise as the cognitect package unfortunately). It looks like the issue with ARN is not restricted to just invocation but really all uses (for example I tried just retrieving the function using the ARN in Getfunction op and failed for same reason). Which makes sense given the underlying problem."><y>#</y><d>2022-11-05</d><h>02:36</h><r>sun-one</r>I ended up just biting the bullet and using the aws java sdk package (not nearly as good UX wise as the cognitect package unfortunately). It looks like the issue with ARN is not restricted  to just invocation but really all uses (for example I tried just retrieving the function using the ARN in Getfunction op and failed for same reason). Which makes sense given the underlying problem.</z><z id="t1668782434" t="lepistane Hi How do i use does-object-exist ? i can&apos;t find example anywhere solved `(amazonica.aws.s3/does-object-exist credentials bucket-name key)"><y>#</y><d>2022-11-18</d><h>14:40</h><w>lepistane</w>Hi

How do i use <code>does-object-exist</code> ?

i can&apos;t find example anywhere

<code>solved</code>
<pre>`(amazonica.aws.s3/does-object-exist credentials
                                     bucket-name
                                     key)</pre></z><z id="t1669074870" t="seancorfield Hi! Because we just ran into this at work, I&apos;d like to raise the profile of https://github.com/cognitect-labs/aws-api/issues/181 and see where folks are in terms of Jetty 9/10/11?"><y>#</y><d>2022-11-21</d><h>23:54</h><w>seancorfield</w>Hi! Because we just ran into this at work, I&apos;d like to raise the profile of <a href="https://github.com/cognitect-labs/aws-api/issues/181" target="_blank">https://github.com/cognitect-labs/aws-api/issues/181</a> and see where folks are in terms of Jetty 9/10/11?</z><z id="t1669134204" t="lukasz I asked the same question not long ago: https://clojurians.slack.com/archives/C09N0H1RB/p1664810477149209 - basically there will be a new version of aws-api that will allow you to bring your own HTTP client and opt-out of bundled jetty http client"><y>#</y><d>2022-11-22</d><h>16:23</h><r>lukasz</r>I asked the same question not long ago: <a href="https://clojurians.slack.com/archives/C09N0H1RB/p1664810477149209" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1664810477149209</a> - basically there will be a new version of aws-api that will allow you to bring your own HTTP client and opt-out of bundled jetty http client</z><z id="t1669134245" t="lukasz and yeah, we&apos;re blocked from moving to jetty10 for the same reason - at least in the services that depend on aws-api"><y>#</y><d>2022-11-22</d><h>16:24</h><r>lukasz</r>and yeah, we&apos;re blocked from moving to jetty10 for the same reason - at least in the services that depend on aws-api</z><z id="t1669137561" t="seancorfield Yeah, [:attrs {:href &quot;/_/_/users/U0ENYLGTA&quot;}] mentioned that in the ticket. I was hoping to provoke an update on the status of those plans 🙂"><y>#</y><d>2022-11-22</d><h>17:19</h><r>seancorfield</r>Yeah, <a>@U0ENYLGTA</a> mentioned that in the ticket. I was hoping to provoke an update on the status of those plans <b>🙂</b></z><z id="t1669138094" t="lukasz I need to subscribe to that issue - I didn&apos;t know there was a reply"><y>#</y><d>2022-11-22</d><h>17:28</h><r>lukasz</r>I need to subscribe to that issue - I didn&apos;t know there was a reply</z><z id="t1669247400" t="dchelimsky Well, color me provoked: https://github.com/cognitect-labs/aws-api/issues/181"><y>#</y><d>2022-11-23</d><h>23:50</h><r>dchelimsky</r>Well, color me provoked: <a href="https://github.com/cognitect-labs/aws-api/issues/181" target="_blank">https://github.com/cognitect-labs/aws-api/issues/181</a></z><z id="t1669251196" t="seancorfield [:attrs {:href &quot;/_/_/users/U0EHU1800&quot;}] I&apos;m looking at switching from the Cognitect AWS API to awyeah so we can get around the Jetty 9 issue. Your docs say: &gt; The awyeah-api client does not auto-refresh AWS credentials. The aws-api behavior relies on features that aren&apos;t present in babashka, and I haven&apos;t figured out an alternative implementation of the behavior. My use case is short-lived scripts, where JVM start-up time can dwarf script execution time: credentials don&apos;t have much time to get stale. Does that mean if I create a basic-credentials-provider and a client based on it at startup in a long-lived process and use it for uploading stuff to S3, after some period of time, it will fail because the credentials have gone stale?"><y>#</y><d>2022-11-24</d><h>00:53</h><w>seancorfield</w><a>@grzm</a> I&apos;m looking at switching from the Cognitect AWS API to awyeah so we can get around the Jetty 9 issue. Your docs say:

&gt; The awyeah-api client does not auto-refresh AWS credentials. The aws-api behavior relies on features that aren&apos;t present in babashka, and I haven&apos;t figured out an alternative implementation of the behavior. My use case is short-lived scripts, where JVM start-up time can dwarf script execution time: credentials don&apos;t have much time to get stale.
Does that mean if I create a <code>basic-credentials-provider</code> and a <code>client</code> based on it at startup in a long-lived process and use it for uploading stuff to S3, after some period of time, it will fail because the credentials have gone stale?</z><z id="t1669251257" t="seancorfield Since we don&apos;t upload to S3 very often, it would be easy for us to recreate the whole client each time we need to do a short batch of uploads -- if we have to."><y>#</y><d>2022-11-24</d><h>00:54</h><r>seancorfield</r>Since we don&apos;t upload to S3 very often, it would be easy for us to recreate the whole client each time we need to do a short batch of uploads -- if we have to.</z><z id="t1669255838" t="Cory If it doesn&apos;t handle the STS refresh then it&apos;s eventually going to fail."><y>#</y><d>2022-11-24</d><h>02:10</h><r>Cory</r>If it doesn&apos;t handle the STS refresh then it&apos;s eventually going to fail.</z><z id="t1669256050" t="Cory if your architecture can use presigned urls, then move further that direction"><y>#</y><d>2022-11-24</d><h>02:14</h><r>Cory</r>if your architecture can use presigned urls, then move further that direction</z><z id="t1669263009" t="seancorfield Yeah, we use presigned URLs."><y>#</y><d>2022-11-24</d><h>04:10</h><r>seancorfield</r>Yeah, we use presigned URLs.</z><z id="t1669726351" t="borkdude Feel free to bug me about missing classes"><y>#</y><d>2022-11-29</d><h>12:52</h><r>borkdude</r>Feel free to bug me about missing classes</z><z id="t1669726296" t="borkdude Has someone tried this? :) https://aws.amazon.com/jp/blogs/aws/new-accelerate-your-lambda-functions-with-lambda-snapstart/"><y>#</y><d>2022-11-29</d><h>12:51</h><w>borkdude</w>Has someone tried this? :)
<a href="https://aws.amazon.com/jp/blogs/aws/new-accelerate-your-lambda-functions-with-lambda-snapstart/" target="_blank">https://aws.amazon.com/jp/blogs/aws/new-accelerate-your-lambda-functions-with-lambda-snapstart/</a></z><z id="t1669726678" t="Karol Wójcik Not yet, but [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] and [:attrs {:href &quot;/_/_/users/U0510KXTU&quot;}] will do some research. Maybe we will be able to run just Clojure on the JVM without GraalVM 😀"><y>#</y><d>2022-11-29</d><h>12:57</h><r>Karol Wójcik</r>Not yet, but <a>@U06QSF3BK</a> and <a>@U0510KXTU</a> will do some research. Maybe we will be able to run just Clojure on the JVM without GraalVM <b>😀</b></z><z id="t1669726745" t="borkdude seems like it :)"><y>#</y><d>2022-11-29</d><h>12:59</h><r>borkdude</r>seems like it :)</z><z id="t1669726799" t="viesti I did try it, and it does give a nice speedup: https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1669711630530119?thread_ts=1669707352.165539&amp;amp;cid=C01UQJ4JC9Y"><y>#</y><d>2022-11-29</d><h>12:59</h><r>viesti</r>I did try it, and it does give a nice speedup: <a href="https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1669711630530119?thread_ts=1669707352.165539&amp;amp;cid=C01UQJ4JC9Y" target="_blank">https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1669711630530119?thread_ts=1669707352.165539&amp;amp;cid=C01UQJ4JC9Y</a></z><z id="t1669726828" t="viesti but there are some caveats, like that the snapshots are cached for 14 days"><y>#</y><d>2022-11-29</d><h>13:00</h><r>viesti</r>but there are some caveats, like that the snapshots are cached for 14 days</z><z id="t1669726842" t="borkdude 500ms, we can do better :P"><y>#</y><d>2022-11-29</d><h>13:00</h><r>borkdude</r>500ms, we can do better :P</z><z id="t1669726849" t="viesti yeah well that is me 😛"><y>#</y><d>2022-11-29</d><h>13:00</h><r>viesti</r>yeah well that is me <b>😛</b></z><z id="t1669726853" t="Karol Wójcik Cached for 14 days if you do not use it."><y>#</y><d>2022-11-29</d><h>13:00</h><r>Karol Wójcik</r>Cached for 14 days if you do not use it.</z><z id="t1669726855" t="borkdude oh, actually, 500ms is quite good isn&apos;t it?"><y>#</y><d>2022-11-29</d><h>13:00</h><r>borkdude</r>oh, actually, 500ms is quite good isn&apos;t it?</z><z id="t1669726855" t="viesti sure can be better"><y>#</y><d>2022-11-29</d><h>13:00</h><r>viesti</r>sure can be better</z><z id="t1669726861" t="viesti yeah I think so"><y>#</y><d>2022-11-29</d><h>13:01</h><r>viesti</r>yeah I think so</z><z id="t1669726871" t="Karol Wójcik It depends. What architecture?"><y>#</y><d>2022-11-29</d><h>13:01</h><r>Karol Wójcik</r>It depends. What architecture?</z><z id="t1669726873" t="viesti like, from 7s -&gt; 5ms"><y>#</y><d>2022-11-29</d><h>13:01</h><r>viesti</r>like, from 7s -&gt; 5ms</z><z id="t1669726883" t="viesti x86 only supported now for snapshots I think"><y>#</y><d>2022-11-29</d><h>13:01</h><r>viesti</r>x86 only supported now for snapshots I think</z><z id="t1669726895" t="viesti it relies on Firecracker VM snapshots"><y>#</y><d>2022-11-29</d><h>13:01</h><r>viesti</r>it relies on Firecracker VM snapshots</z><z id="t1669726906" t="viesti https://github.com/firecracker-microvm/firecracker/blob/main/docs/snapshotting/snapshot-support.md"><y>#</y><d>2022-11-29</d><h>13:01</h><r>viesti</r><a href="https://github.com/firecracker-microvm/firecracker/blob/main/docs/snapshotting/snapshot-support.md" target="_blank">https://github.com/firecracker-microvm/firecracker/blob/main/docs/snapshotting/snapshot-support.md</a></z><z id="t1669726911" t="Karol Wójcik How it compares with HL GraalVM?"><y>#</y><d>2022-11-29</d><h>13:01</h><r>Karol Wójcik</r>How it compares with HL GraalVM?</z><z id="t1669726926" t="viesti 270ms cold start with HL GraalVM"><y>#</y><d>2022-11-29</d><h>13:02</h><r>viesti</r>270ms cold start with HL GraalVM</z><z id="t1669726926" t="borkdude in the future, the JVM will probably have some image capabilities too, as project Leyden, but this will take a while"><y>#</y><d>2022-11-29</d><h>13:02</h><r>borkdude</r>in the future, the JVM will probably have some image capabilities too, as project Leyden, but this will take a while</z><z id="t1669726947" t="viesti yeah Leyden interesting, I think there are broad fronts into this"><y>#</y><d>2022-11-29</d><h>13:02</h><r>viesti</r>yeah Leyden interesting, I think there are broad fronts into this</z><z id="t1669727019" t="Karol Wójcik Seems HL native backend still wins a little bit :D"><y>#</y><d>2022-11-29</d><h>13:03</h><r>Karol Wójcik</r>Seems HL native backend still wins a little bit :D</z><z id="t1669727065" t="viesti I think we don&apos;t need to throw native-image totally away, this is just something different"><y>#</y><d>2022-11-29</d><h>13:04</h><r>viesti</r>I think we don&apos;t need to throw native-image totally away, this is just something different</z><z id="t1669727075" t="viesti like, one could do preloading stuff into the snapshot"><y>#</y><d>2022-11-29</d><h>13:04</h><r>viesti</r>like, one could do preloading stuff into the snapshot</z><z id="t1669727091" t="viesti well, ok, snapshot now only supported for jvm"><y>#</y><d>2022-11-29</d><h>13:04</h><r>viesti</r>well, ok, snapshot now only supported for jvm</z><z id="t1669727099" t="borkdude and with bb holy lambda you can still edit code in the console ;)"><y>#</y><d>2022-11-29</d><h>13:04</h><r>borkdude</r>and with bb holy lambda you can still edit code in the console ;)</z><z id="t1669727101" t="Karol Wójcik Btw, what is the project Leyden?"><y>#</y><d>2022-11-29</d><h>13:05</h><r>Karol Wójcik</r>Btw, what is the project Leyden?</z><z id="t1669727127" t="viesti but if it would be supported for other runtimes, was thinking that one could use native-image and the do some computation that would be preloaded, like NLP model loading etc."><y>#</y><d>2022-11-29</d><h>13:05</h><r>viesti</r>but if it would be supported for other runtimes, was thinking that one could use native-image and the do some computation that would be preloaded, like NLP model loading etc.</z><z id="t1669727142" t="viesti https://openjdk.org/projects/leyden/"><y>#</y><d>2022-11-29</d><h>13:05</h><r>viesti</r><a href="https://openjdk.org/projects/leyden/" target="_blank">https://openjdk.org/projects/leyden/</a></z><z id="t1669727202" t="borkdude btw [:attrs {:href &quot;/_/_/users/U06QSF3BK&quot;}] it was nice to meet you at the Dutch Clojure Days. Your nREPL that went into nbb now also lives in #C03DPCLCV9N"><y>#</y><d>2022-11-29</d><h>13:06</h><r>borkdude</r>btw <a>@U06QSF3BK</a> it was nice to meet you at the Dutch Clojure Days. Your nREPL that went into nbb now also lives in #C03DPCLCV9N</z><z id="t1669727222" t="viesti it was nice meeting you too 🙂"><y>#</y><d>2022-11-29</d><h>13:07</h><r>viesti</r>it was nice meeting you too <b>🙂</b></z><z id="t1669727744" t="viesti I think post outlines Leyden better: https://openjdk.org/projects/leyden/notes/02-shift-and-constrain with &gt; [:attrs {:href &quot;https://openjdk.org/projects/leyden/notes/02-shift-and-constrain#roadmap&quot;}] &gt; We have two categories of work before us: Specify and implement the concept of condensers, and research and develop specific condensers and related new language features. there was an earlier post too https://mail.openjdk.org/pipermail/discuss/2020-April/005429.html , which sounded more like re-awakening jaotc/jlink, but I guess the idea is to allow these features more broadly in the java language"><y>#</y><d>2022-11-29</d><h>13:15</h><r>viesti</r>I think post outlines Leyden better: <a href="https://openjdk.org/projects/leyden/notes/02-shift-and-constrain" target="_blank">https://openjdk.org/projects/leyden/notes/02-shift-and-constrain</a> with
&gt; <a>https://openjdk.org/projects/leyden/notes/02-shift-and-constrain#roadmap</a>
&gt; We have two categories of work before us: Specify and implement the concept of condensers, and research and develop specific condensers and related new language features.
there was an earlier post too <a href="https://mail.openjdk.org/pipermail/discuss/2020-April/005429.html" target="_blank">https://mail.openjdk.org/pipermail/discuss/2020-April/005429.html</a>, which sounded more like re-awakening jaotc/jlink, but I guess the idea is to allow these features more broadly in the java language</z><z id="t1669727780" t="viesti I think I should also try joyride/VSCode, fearing that it might bump be away from Emacs, let&apos;s see 😄"><y>#</y><d>2022-11-29</d><h>13:16</h><r>viesti</r>I think I should also try joyride/VSCode, fearing that it might bump be away from Emacs, let&apos;s see <b>😄</b></z><z id="t1669727813" t="Karol Wójcik Well, the previous description depicts Leyden as some kind of GraalVM native-image competitor?"><y>#</y><d>2022-11-29</d><h>13:16</h><r>Karol Wójcik</r>Well, the previous description depicts Leyden as some kind of GraalVM native-image competitor?</z><z id="t1669728048" t="borkdude not competitor, native-image is one of the many possible approaches, Leyden is more broader and more configurable take and native-image fits into that specification (or so)"><y>#</y><d>2022-11-29</d><h>13:20</h><r>borkdude</r>not competitor, native-image is one of the many possible approaches, Leyden is more broader and more configurable take and native-image fits into that specification (or so)</z><z id="t1669754900" t="grav Leyden sounds ... complex ... ! Wonder how the dev-ex will be! I also cannot quite gather from the post if it&apos;s relevant for other JVM languages or java-only?"><y>#</y><d>2022-11-29</d><h>20:48</h><r>grav</r>Leyden sounds ... complex ... ! Wonder how the dev-ex will be!

I also cannot quite gather from the post if it&apos;s relevant for other JVM languages or java-only?</z><z id="t1669805301" t="viesti thinking that Leyden is about moving the faster startup time underpinnings into the Java Platform Specifications, so I guess other languages that target the JVM could generate bytecode that is more suitable for these kinds of optimizations (not necessarily new type of bytecode)"><y>#</y><d>2022-11-30</d><h>10:48</h><r>viesti</r>thinking that Leyden is about moving the faster startup time underpinnings into the Java Platform Specifications, so I guess other languages that target the JVM could generate bytecode that is more suitable for these kinds of optimizations (not necessarily new type of bytecode)</z><z id="t1669806474" t="steveb8n In my systems cold start includes init for vpc ens and other infra so anything less than 1 second is excellent if the Dev ex is also good"><y>#</y><d>2022-11-30</d><h>11:07</h><r>steveb8n</r>In my systems cold start includes init for vpc ens and other infra so anything less than 1 second is excellent if the Dev ex is also good</z><z id="t1670619668" t="steveb8n [:attrs {:href &quot;/_/_/users/U04V15CAJ&quot;}] I have tried it now. you can see my interim results here https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1670564880315559?thread_ts=1670372673.558019&amp;amp;cid=C01UQJ4JC9Y"><y>#</y><d>2022-12-09</d><h>21:01</h><r>steveb8n</r><a>@U04V15CAJ</a> I have tried it now. you can see my interim results here <a href="https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1670564880315559?thread_ts=1670372673.558019&amp;amp;cid=C01UQJ4JC9Y" target="_blank">https://clojurians.slack.com/archives/C01UQJ4JC9Y/p1670564880315559?thread_ts=1670372673.558019&amp;amp;cid=C01UQJ4JC9Y</a></z><z id="t1670620025" t="borkdude very nice!"><y>#</y><d>2022-12-09</d><h>21:07</h><r>borkdude</r>very nice!</z><z id="t1670626754" t="steveb8n it really is. just setting up my devops scripts for it using bb/cli now"><y>#</y><d>2022-12-09</d><h>22:59</h><r>steveb8n</r>it really is. just setting up my devops scripts for it using bb/cli now</z><z id="t1670626765" t="steveb8n p.s. shame about the penalties"><y>#</y><d>2022-12-09</d><h>22:59</h><r>steveb8n</r>p.s. shame about the penalties</z><z id="t1670627422" t="borkdude penalties?"><y>#</y><d>2022-12-09</d><h>23:10</h><r>borkdude</r>penalties?</z><z id="t1670627458" t="borkdude oh you mean soccer, I&apos;m blissfully ignorant of all of that ;)"><y>#</y><d>2022-12-09</d><h>23:10</h><r>borkdude</r>oh you mean soccer, I&apos;m blissfully ignorant of all of that ;)</z><z id="t1670627884" t="steveb8n today your ignorance is providing extra bliss (c.f. with my family)"><y>#</y><d>2022-12-09</d><h>23:18</h><r>steveb8n</r>today your ignorance is providing extra bliss (c.f. with my family)</z><z id="t1669754799" t="Drew Verlee Anyone know where i can get the set of allowed values for a service in the aws configuration tree: AssumedRolePolicyDocument &gt; Statment &gt; Principle &gt; Service e.g http://ecs-tasks.amazonaws.com"><y>#</y><d>2022-11-29</d><h>20:46</h><w>Drew Verlee</w>Anyone know where i can get the set of allowed values for a service in the aws configuration tree:

AssumedRolePolicyDocument &gt; Statment &gt; Principle &gt; Service

e.g <a href="http://ecs-tasks.amazonaws.com" target="_blank">http://ecs-tasks.amazonaws.com</a></z><z id="t1669768888" t="Leaf Garland Unofficial list https://gist.github.com/shortjared/4c1e3fe52bdfa47522cfe5b41e5d6f22 . The aws docs suggest you can find some by digging through the list of services that work with IAM. Not very helpful. &gt; The identifier for a service principal includes the service name, and is usually in the following format: &gt; _service-name_. &gt; The service principal is defined by the service. You can find the service principal for some services by opening https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html , checking whether the service has Yes in the Service-linked role column, and opening the Yes link to view the service-linked role documentation for that service. Find the Service-Linked Role Permissions section for that service to view the service principal. &gt; The following example shows a policy that can be attached to a service role. The policy enables two services, Amazon ECS and Elastic Load Balancing, to assume the role. The services can then perform any tasks granted by the permissions policy assigned to the role (not shown). To specify multiple service principals, you do not specify two Service elements; you can have only one. Instead, you use an array of multiple service principals as the value of a single Service element."><y>#</y><d>2022-11-30</d><h>00:41</h><r>Leaf Garland</r>Unofficial list <a href="https://gist.github.com/shortjared/4c1e3fe52bdfa47522cfe5b41e5d6f22" target="_blank">https://gist.github.com/shortjared/4c1e3fe52bdfa47522cfe5b41e5d6f22</a>.

The aws docs suggest you can find some by digging through the list of services that work with IAM. Not very helpful.
&gt; The identifier for a service principal includes the service name, and is usually in the following format:
&gt; <code>_service-name_.</code>
&gt; The service principal is defined by the service. You can find the service principal for some services by opening <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html" target="_blank">https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html</a>, checking whether the service has Yes in the Service-linked role column, and opening the Yes link to view the service-linked role documentation for that service. Find the Service-Linked Role Permissions section for that service to view the service principal.
&gt; The following example shows a policy that can be attached to a service role. The policy enables two services, Amazon ECS and Elastic Load Balancing, to assume the role. The services can then perform any tasks granted by the permissions policy assigned to the role (not shown). To specify multiple service principals, you do not specify two <code>Service</code> elements; you can have only one. Instead, you use an array of multiple service principals as the value of a single <code>Service</code> element.</z><z id="t1669770209" t="Drew Verlee Ty leaf"><y>#</y><d>2022-11-30</d><h>01:03</h><r>Drew Verlee</r>Ty leaf</z><z id="t1669755281" t="stopa Hey team, some noob questions on Aurora — not strictly clojure related but thought ya’ll may know: 1. How does the connection string work for writer / reader instances? I see that I have two endpoints with Aurora. One writer, and one reader. Does that mean that I have to manage which of my servers call the writer and which of my servers call the reader? I am a bit surprised (I would have thought AWS would have “handled” this for me)"><y>#</y><d>2022-11-29</d><h>20:54</h><w>stopa</w>Hey team, some noob questions on Aurora — not strictly clojure related but thought ya’ll may know:

1. How does the connection string work for writer / reader instances? 
I see that I have two endpoints with Aurora. One writer, and one reader. Does that mean that I have to manage which of my servers call the writer and which of my servers call the reader? I am a bit surprised (I would have thought AWS would have “handled” this for me)</z><z id="t1669759045" t="grav Not sure if you&apos;re misunderstanding what the writer is? A writer does both reads and writes - so if your service needs to be able to write, it needs to use the writer. It&apos;ll have read-access as well through that endpoint though. Using the reader is not necessary, but it can be a good idea for security reasons, if a specific services only needs read-access (eg a BI application), and for performance as well, if you want to save some load on the writer."><y>#</y><d>2022-11-29</d><h>21:57</h><r>grav</r>Not sure if you&apos;re misunderstanding what the writer is? A writer does both reads and writes - so if your service needs to be able to write, it needs to use the writer. It&apos;ll have read-access as well through that endpoint though.

Using the reader is not necessary, but it can be a good idea for security reasons, if a specific services only needs read-access (eg a BI application), and for performance as well, if you want to save some load on the writer.</z><z id="t1669759142" t="stopa My thought was, that AWS would have a kind of “load balancer” connection string: It would take SQL commands, and if it was an “write”, send it to the writer instance. If it was a read, it would balance the requests to both writer and reader. But indeed, I realize this is not how things work xD. I guess I would just have two connection pools, and write in my application which queries I want to get where"><y>#</y><d>2022-11-29</d><h>21:59</h><r>stopa</r>My thought was, that AWS would have a kind of “load balancer” connection string:

It would take SQL commands, and if it was an “write”, send it to the writer instance. If it was a read, it would balance the requests to both writer and reader.

But indeed, I realize this is not how things work xD. I guess I would just have two connection pools, and write in my application which queries I want to get where</z><z id="t1669759770" t="grav The reader is not necessarily in sync with the writer - so that would not be consistent"><y>#</y><d>2022-11-29</d><h>22:09</h><r>grav</r>The reader is not necessarily in sync with the writer - so that would not be consistent</z><z id="t1669760057" t="grav From https://aws.amazon.com/rds/aurora/faqs/ &gt; How far behind the primary will my replicas be? &gt; Since Amazon Aurora Replicas share the same data volume as the primary instance in the same AWS Region, there is virtually no replication lag. We typically observe lag times in the tens of milliseconds"><y>#</y><d>2022-11-29</d><h>22:14</h><r>grav</r>From <a href="https://aws.amazon.com/rds/aurora/faqs/" target="_blank">https://aws.amazon.com/rds/aurora/faqs/</a>

&gt; How far behind the primary will my replicas be?
&gt; Since Amazon Aurora Replicas share the same data volume as the primary instance in the same AWS Region, there is virtually no replication lag. We typically observe lag times in the tens of milliseconds</z><z id="t1669760152" t="grav &gt; I guess I would just have two connection pools, and write in my application which queries I want to get where Yeah, exactly. If you can sacrifice some consistency, then you can use the reader in some cases - but that would be very application-specific."><y>#</y><d>2022-11-29</d><h>22:15</h><r>grav</r>&gt; I guess I would just have two connection pools, and write in my application which queries I want to get where 
Yeah, exactly. If you can sacrifice some consistency, then you can use the reader in some cases - but that would be very application-specific.</z><z id="t1669760191" t="stopa Makes sense, thanks [:attrs {:href &quot;/_/_/users/U052XLL3A&quot;}] !"><y>#</y><d>2022-11-29</d><h>22:16</h><r>stopa</r>Makes sense, thanks <a>@U052XLL3A</a>!</z><z id="t1669756061" t="stopa 2. Sanity check: how does DNS resolution work in EC2 instances? I wanted to sanity check one thing. Say I make my aurora endpoint publicly accessible. Then, I connect to it from my EC2 instance. Ideally, EC2 would leverage the internal network and make a super-quick hop to aurora. How do I know this happened, and that it didn’t actually go outside of the network? I guess EC2 is smart about the routing, and knows that if the url is something like *. http://amazonaws.com to route internally first?"><y>#</y><d>2022-11-29</d><h>21:07</h><w>stopa</w>2. Sanity check: how does DNS resolution work in EC2 instances?

I wanted to sanity check one thing. Say I make my aurora endpoint publicly accessible. Then, I connect to it from my EC2 instance.

Ideally, EC2 would leverage the internal network and make a super-quick hop to aurora. How do I know this happened, and that it didn’t actually go outside of the network? I guess EC2 is smart about the routing, and knows that if the url is something like *.<a href="http://amazonaws.com" target="_blank">http://amazonaws.com</a> to route internally first?</z><z id="t1669759505" t="grav I&apos;m pretty sure that by default, if you create an ec2 instance and use aurora within the same aws region, AWS will be smart about the routing, and it&apos;ll just work -- by default. But networking config can be customized in all sorts of ways in AWS, and be arbitrarily complex, so I&apos;m not sure how to verify that a specific configuration isn&apos;t problematic in some way. I have always had trouble finding a good to-the-point guide about networking concepts for AWS. If anyone has a good link, it&apos;d be much appreciated!"><y>#</y><d>2022-11-29</d><h>22:05</h><r>grav</r>I&apos;m pretty sure that by default, if you create an ec2 instance and use aurora within the same aws region, AWS will be smart about the routing, and it&apos;ll just work -- by default.

But networking config can be customized in all sorts of ways in AWS, and be arbitrarily complex, so I&apos;m not sure how to verify that a specific configuration isn&apos;t problematic in some way.

I have always had trouble finding a good to-the-point guide about networking concepts for AWS. If anyone has a good link, it&apos;d be much appreciated!</z><z id="t1669759549" t="grav One thing that you can do is to log on to the ec2 instance and then do a ~`nslookup`~ traceroute to the aurora host and see what happens"><y>#</y><d>2022-11-29</d><h>22:05</h><r>grav</r>One thing that you can do is to log on to the ec2 instance and then do a ~`nslookup`~ <code>traceroute</code> to the aurora host and see what happens</z><z id="t1669760379" t="stopa I spoke with an aws solutions architect — they say that if the db is publicly accessible, it will use the public internet, but if it’s set to vpc only, it will use the private internet. I was surprised that the network layer wouldn’t be smart about this. I’ll look deeper into traceroute!"><y>#</y><d>2022-11-29</d><h>22:19</h><r>stopa</r>I spoke with an aws solutions architect — they say that if the db is publicly accessible, it will use the public internet, but if it’s set to vpc only, it will use the private internet. I was surprised that the network layer wouldn’t be smart about this.

I’ll look deeper into traceroute!</z><z id="t1669760501" t="grav Could be interesting to verify it 👍 I&apos;m pretty sure it depends on the routers involved, and it sounds odd that they wouldn&apos;t optimize for the least amount of hops no matter what url is used. But I guess there&apos;s some reasoning behind it ..."><y>#</y><d>2022-11-29</d><h>22:21</h><r>grav</r>Could be interesting to verify it <b>👍</b>

I&apos;m pretty sure it depends on the routers involved, and it sounds odd that they wouldn&apos;t optimize for the least amount of hops no matter what url is used. But I guess there&apos;s some reasoning behind it ...</z><z id="t1669760610" t="stopa When I run traceroute I see: traceroute to ***. (), 30 hops max, 60 byte packets 1 * * * 2 * * * 3 * * * 4 * * * 5 * * * 6 * * * 7 * * * 8 * * * 9 * * * 10 * * * 11 * * * 12 * * * 13 * * * 14 * * * 15 * * * 16 * * * 17 * * * 18 * * * 19 * * * 20 * * * 21 * * * 22 * * * 23 * * * 24 * * * 25 * * * 26 * * * 27 * * * 28 * * * 29 * * * 30 * * * Have never used traceroute before — looking to understand what the stars mean!"><y>#</y><d>2022-11-29</d><h>22:23</h><r>stopa</r>When I run traceroute I see:

<pre>traceroute to ***. (), 30 hops max, 60 byte packets
 1  * * *
 2  * * *
 3  * * *
 4  * * *
 5  * * *
 6  * * *
 7  * * *
 8  * * *
 9  * * *
10  * * *
11  * * *
12  * * *
13  * * *
14  * * *
15  * * *
16  * * *
17  * * *
18  * * *
19  * * *
20  * * *
21  * * *
22  * * *
23  * * *
24  * * *
25  * * *
26  * * *
27  * * *
28  * * *
29  * * *
30  * * *</pre>
Have never used traceroute before — looking to understand what the stars mean!</z><z id="t1669760885" t="grav If I do a traceroute from my local machine to a cloudfront-hosted website, I get ~15 hops, some of which go past my ISP and then end up at cloudfront."><y>#</y><d>2022-11-29</d><h>22:28</h><r>grav</r>If I do a traceroute from my local machine to a  cloudfront-hosted website, I get ~15 hops, some of which go past my ISP and then end up at cloudfront.</z><z id="t1669760906" t="grav I don&apos;t have an aurora db or ec2 instance at hand so I can&apos;t do a similar test."><y>#</y><d>2022-11-29</d><h>22:28</h><r>grav</r>I don&apos;t have an aurora db or ec2 instance at hand so I can&apos;t do a similar test.</z><z id="t1669760918" t="grav But 30 hops sound like alot, if it&apos;s from one aws host to another"><y>#</y><d>2022-11-29</d><h>22:28</h><r>grav</r>But 30 hops sound like alot, if it&apos;s from one aws host to another</z><z id="t1669760972" t="grav what happens if you put the ec2 and aurora inside the same vpc and repeat the experiment?"><y>#</y><d>2022-11-29</d><h>22:29</h><r>grav</r>what happens if you put the ec2 and aurora inside the same vpc and repeat the experiment?</z><z id="t1669761040" t="grav btw I also get a few lines with * - maybe some routers don&apos;t want to reveal themselves"><y>#</y><d>2022-11-29</d><h>22:30</h><r>grav</r>btw I also get a few  lines with   * - maybe some routers don&apos;t want to reveal themselves</z><z id="t1669761050" t="stopa Just tested — I get the same thing! Iinteresting"><y>#</y><d>2022-11-29</d><h>22:30</h><r>stopa</r>Just tested — I get the same thing! Iinteresting</z><z id="t1669761077" t="stopa (I disabled public access and ran traceroute, and got stars all the way down to 30)"><y>#</y><d>2022-11-29</d><h>22:31</h><r>stopa</r>(I disabled public access and ran traceroute, and got stars all the way down to 30)</z><z id="t1669761122" t="grav do you have access to the aurora instance at all from the ec2? eg can you do telnet [host] [port] and get a reply back?"><y>#</y><d>2022-11-29</d><h>22:32</h><r>grav</r>do you have access to the aurora instance at all from the ec2? eg can you do <code>telnet [host] [port]</code> and get a reply back?</z><z id="t1669761152" t="grav (aurora instance is probably the wrong term 😉 )"><y>#</y><d>2022-11-29</d><h>22:32</h><r>grav</r>(aurora instance is probably the wrong term <b>😉</b> )</z><z id="t1669761204" t="stopa the ec2 instance doesn’t have telnet, but I can confirm I have access; I was able to set up a jdbc connection pool from a clojure repl that I set up on it"><y>#</y><d>2022-11-29</d><h>22:33</h><r>stopa</r>the ec2 instance doesn’t have telnet, but I can confirm I have access; I was able to set up a jdbc connection pool from a clojure repl that I set up on it</z><z id="t1669761314" t="grav I think you can install telnet with sudo yum -y install telnet , but yeah, sounds like things work. not sure why the traceroute isn&apos;t helpful"><y>#</y><d>2022-11-29</d><h>22:35</h><r>grav</r>I think you can install telnet with <code> sudo yum -y install telnet</code>, but yeah, sounds like things work. not sure why the traceroute isn&apos;t helpful</z><z id="t1669769949" t="stopa Update: here’s what makes me think that it does indeed use the vpc. If I write nslookup inside ec2, I get an ip address that’s like 172.xx But if I nslookup from my mac, it’s a more “external looking” ip address."><y>#</y><d>2022-11-30</d><h>00:59</h><r>stopa</r>Update: here’s what makes me think that it does indeed use the vpc.

If I write <code>nslookup </code> inside ec2, I get an ip address that’s like 172.xx

But if I nslookup from my mac, it’s a more “external looking” ip address.</z><z id="t1669769965" t="stopa https://repost.aws/questions/QU0d7EgUotRfWuExYl4b-0Nw/how-does-ec-2-hop-to-a-publicly-accessible-rds-endpoint &lt;- on aws too"><y>#</y><d>2022-11-30</d><h>00:59</h><r>stopa</r><a href="https://repost.aws/questions/QU0d7EgUotRfWuExYl4b-0Nw/how-does-ec-2-hop-to-a-publicly-accessible-rds-endpoint" target="_blank">https://repost.aws/questions/QU0d7EgUotRfWuExYl4b-0Nw/how-does-ec-2-hop-to-a-publicly-accessible-rds-endpoint</a> &lt;- on aws too</z><z id="t1669793612" t="grav And does it then return the external ip if you nslookup from ec2 without the vpc being active?"><y>#</y><d>2022-11-30</d><h>07:33</h><r>grav</r>And does it then return the external ip if you <code>nslookup</code> from ec2 without the vpc being active?</z><z id="t1669821798" t="stopa Ooh good question. I am not quite sure sure how I would disable the vpc. I only have one (the default), would this break something? I’ll note to look into it!"><y>#</y><d>2022-11-30</d><h>15:23</h><r>stopa</r>Ooh good question. I am not quite sure sure how I would disable the vpc. I only have one (the default), would this break something? I’ll note to look into it!</z><z id="t1669956055" t="jumar It indeed uses the internal network. As you observed, the IP address associated with that hostname is a [:attrs nil] Such addresses aren&apos;t routable on the internet, only within a private network. You can also see this with host &lt;dns name&gt; (try host -v or dig and you&apos;ll see more details) For other services like S3, that are not deployed within VPC, there are &quot;VPC endpoints&quot; to make sure your traffic uses a dedicated link within Aws network and doesn&apos;t go through the Internet."><y>#</y><d>2022-12-02</d><h>04:40</h><r>jumar</r>It indeed uses the internal network.
As you observed, the IP address associated with that hostname is a <i>private</i>
Such addresses aren&apos;t routable on the internet, only within a private network.

You can also see this with <code>host &lt;dns name&gt;</code> (try <code>host -v</code> or <code>dig</code> and you&apos;ll see more details)

For other services like S3, that are not deployed within VPC, there are &quot;VPC endpoints&quot; to make sure your traffic uses a dedicated link within Aws network and doesn&apos;t go through the Internet.</z><z id="t1669957435" t="jumar This is for RDS but I guess that&apos;s the same for Aurora? Can&apos;t find the private IP address for my Amazon-RDS instance https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance &gt; RDS instances can change their IPs unexpectedly, so they should not be used nor are they provided in the console or API (although you can technically dig for them). The DNS endpoint provided in the AWS console will resolve to the internal IPs from within Amazon&apos;s network. "><y>#</y><d>2022-12-02</d><h>05:03</h><r>jumar</r>This is for RDS but I guess that&apos;s the same for Aurora?
Can&apos;t find the private IP address for my Amazon-RDS instance <a href="https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance" target="_blank">https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance</a>
&gt;  RDS instances can change their IPs unexpectedly, so they should not be used nor are they provided in the console or API (although you can technically dig for them). The DNS endpoint provided in the AWS console will resolve to the internal IPs from within Amazon&apos;s network.
</z><z id="t1669957963" t="jumar You can also try reachability analyzer: https://docs.aws.amazon.com/network-manager/latest/tgwnm/route-analyzer.html It is a bit complicated (with rds at least) but these help • https://repost.aws/questions/QUyE7QG44dQtaUNe6unO-KPg/possible-to-run-aws-vpc-reachability-analyzer-from-lambda-eni-to-rds-endpoint • https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance ◦ see filtering network interfaces by security group"><y>#</y><d>2022-12-02</d><h>05:12</h><r>jumar</r>You can also try reachability analyzer: <a href="https://docs.aws.amazon.com/network-manager/latest/tgwnm/route-analyzer.html" target="_blank">https://docs.aws.amazon.com/network-manager/latest/tgwnm/route-analyzer.html</a>

It is a bit complicated (with rds at least) but these help
• <a href="https://repost.aws/questions/QUyE7QG44dQtaUNe6unO-KPg/possible-to-run-aws-vpc-reachability-analyzer-from-lambda-eni-to-rds-endpoint" target="_blank">https://repost.aws/questions/QUyE7QG44dQtaUNe6unO-KPg/possible-to-run-aws-vpc-reachability-analyzer-from-lambda-eni-to-rds-endpoint</a>
• <a href="https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance" target="_blank">https://serverfault.com/questions/601548/cant-find-the-private-ip-address-for-my-amazon-rds-instance</a> 
    ◦ see filtering network interfaces by security group</z><z id="t1670298006" t="dchelimsky [ANN] Cognitect Labs&apos; https://groups.google.com/g/clojure/c/3fXGjfLNOik/m/VV901_9FAQAJ"><y>#</y><d>2022-12-06</d><h>03:40</h><w>dchelimsky</w>[ANN] Cognitect Labs&apos; <a href="https://groups.google.com/g/clojure/c/3fXGjfLNOik/m/VV901_9FAQAJ" target="_blank">https://groups.google.com/g/clojure/c/3fXGjfLNOik/m/VV901_9FAQAJ</a></z><z id="t1670797962" t="Jacob Emcken Why is declaring com.cognitect.aws/endpoints as a dependency mandatory when I provide a :endpoint-override anyway for my s3 client? Not a big deal, but I am curious after getting: clojure.lang.ExceptionInfo: Cannot find resource cognitect/aws/endpoints.edn and wondering why it is required."><y>#</y><d>2022-12-11</d><h>22:32</h><w>Jacob Emcken</w>Why is declaring <code>com.cognitect.aws/endpoints</code> as a dependency mandatory when I provide a <code>:endpoint-override</code> anyway for my s3 client?
Not a big deal, but I am curious after getting: <code>clojure.lang.ExceptionInfo: Cannot find resource cognitect/aws/endpoints.edn</code> and wondering why it is required.</z><z id="t1670799599" t="lukasz Can&apos;t answer your question directly, but what happens if you create an empty aws/endpoints.edn somewhere in the classpath and exclude the endpoints jar?"><y>#</y><d>2022-12-11</d><h>22:59</h><r>lukasz</r>Can&apos;t answer your question directly, but what happens if you create an empty <code>aws/endpoints.edn</code> somewhere in the classpath and exclude the endpoints jar?</z><z id="t1671160639" t="Drew Verlee Does anyone have a good set of functions for searching cloudwatch?"><y>#</y><d>2022-12-16</d><h>03:17</h><w>Drew Verlee</w>Does anyone have a good set of functions for searching cloudwatch?</z><z id="t1671225672" t="Drew Verlee I&apos;m working on a cloudwatch repo that lazyloads the logs given a log-group-name. it currently fails with a stackoverflow... https://github.com/drewverlee/cloudwatch/blob/master/src/drewverlee/aws/cloudwatch.clj#L84"><y>#</y><d>2022-12-16</d><h>21:21</h><w>Drew Verlee</w>I&apos;m working on a cloudwatch repo that lazyloads the logs given a log-group-name. it currently fails with a stackoverflow...

<a href="https://github.com/drewverlee/cloudwatch/blob/master/src/drewverlee/aws/cloudwatch.clj#L84" target="_blank">https://github.com/drewverlee/cloudwatch/blob/master/src/drewverlee/aws/cloudwatch.clj#L84</a></z><z id="t1671225681" t="Drew Verlee ideas, concerns, insults welcome."><y>#</y><d>2022-12-16</d><h>21:21</h><w>Drew Verlee</w>ideas, concerns, insults welcome.</z><z id="t1671550236" t="Leonid Korogodski In amazonica , the with-client-config macro is described as follows: (defmacro with-client-config &quot;Per invocation binding of client-config for ad-hoc service calls using alternate client configuration.&quot; I&apos;m confused by the &quot;per invocation&quot; part. If I pass {:max-connections 1024} as the client config, does it set the connection pool size to 1024? From what I understand, amazonica uses a global S3 client."><y>#</y><d>2022-12-20</d><h>15:30</h><w>Leonid Korogodski</w>In <code>amazonica</code>, the <code>with-client-config</code> macro is described as follows:
<pre>(defmacro with-client-config
  &quot;Per invocation binding of client-config for ad-hoc
  service calls using alternate client configuration.&quot;</pre>
I&apos;m confused by the &quot;per invocation&quot; part. If I pass <code>{:max-connections 1024}</code> as the client config, does it set the connection pool size to 1024? From what I understand, <code>amazonica</code> uses a global S3 client.</z><z id="t1672249198" t="dchelimsky https://clojurians.slack.com/archives/C06MAR553/p1672249179394479"><y>#</y><d>2022-12-28</d><h>17:39</h><w>dchelimsky</w><a href="https://clojurians.slack.com/archives/C06MAR553/p1672249179394479" target="_blank">https://clojurians.slack.com/archives/C06MAR553/p1672249179394479</a></z><z id="t1673420706" t="Loic Hi, I am using the cognitect-labs/aws-api to deploy my resources on my AWS account. However, I have issue with the :Tags . The resource is created but without the tags. (aws/invoke ec2-client {:op :CreateVpc :request {:CidrBlock &quot;192.168.0.0/16&quot; :Tags [{:Key &quot;Name&quot; :Value &quot;my-vpc&quot;}]}}) I tried with CreateSubnet, CreateInternetGateway etc, still the same result. Am I missing something?"><y>#</y><d>2023-01-11</d><h>07:05</h><w>Loic</w>Hi,

I am using the cognitect-labs/aws-api to deploy my resources on my AWS account.
However, I have issue with the <code>:Tags</code>. The resource is created but without the tags.

<pre>(aws/invoke ec2-client {:op :CreateVpc
                        :request {:CidrBlock &quot;192.168.0.0/16&quot;
                                  :Tags [{:Key &quot;Name&quot; :Value &quot;my-vpc&quot;}]}})</pre>
I tried with CreateSubnet, CreateInternetGateway etc, still the same result.
Am I missing something?</z><z id="t1673424207" t="Bingen Galartza Iparragirre According to the docs the CreateVPC API operation doesn&apos;t have a &quot;Tags&quot; option. You can check it in the docs site: https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateVpc.html It has something called &quot;TagSpecification&quot; which maybe is what you need? (never used it myself)"><y>#</y><d>2023-01-11</d><h>08:03</h><r>Bingen Galartza Iparragirre</r>According to the docs the CreateVPC API operation doesn&apos;t have a &quot;Tags&quot; option. You can check it in the docs site: <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateVpc.html" target="_blank">https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateVpc.html</a>

It has something called &quot;TagSpecification&quot; which maybe is what you need? (never used it myself)</z><z id="t1673424270" t="Bingen Galartza Iparragirre You can also run (aws/doc ec2-client :CreateVpc) to see the exact Clojure data structure that the aws-api client expects"><y>#</y><d>2023-01-11</d><h>08:04</h><r>Bingen Galartza Iparragirre</r>You can also run <code>(aws/doc ec2-client :CreateVpc)</code>  to see the exact Clojure data structure that the aws-api client expects</z><z id="t1673424710" t="Loic The aws/doc or aws/op both show a Tags param: {:Vpc {:Tags [:seq-of {:Key string, :Value string}], :IsDefault boolean, :InstanceTenancy [:one-of [&quot;default&quot; &quot;dedicated&quot; &quot;host&quot;]], :CidrBlock string, ... :VpcId string}} "><y>#</y><d>2023-01-11</d><h>08:11</h><r>Loic</r>The <code>aws/doc</code> or <code>aws/op</code> both show a <code>Tags</code> param:

<pre>{:Vpc
 {:Tags [:seq-of {:Key string, :Value string}],
  :IsDefault boolean,
  :InstanceTenancy [:one-of [&quot;default&quot; &quot;dedicated&quot; &quot;host&quot;]],
  :CidrBlock string,
  ...
  :VpcId string}}</pre>
</z><z id="t1673424825" t="Loic And when I :DescribeVpcs with Name tag I manually added via the Console, they do show in a :Tags param with same syntax as I tried above."><y>#</y><d>2023-01-11</d><h>08:13</h><r>Loic</r>And when I :DescribeVpcs with <code>Name</code> tag I manually added via the Console, they do show in a <code>:Tags</code> param with same syntax as I tried above.</z><z id="t1673425521" t="Bingen Galartza Iparragirre The aws/doc command shows both the Request and the Response. I can only see Tags in the Response section."><y>#</y><d>2023-01-11</d><h>08:25</h><r>Bingen Galartza Iparragirre</r>The <code>aws/doc</code> command shows both the Request and the Response.  I can only see <code>Tags</code> in the Response section.</z><z id="t1673428628" t="Loic Oh got it: (aws/invoke ec2-client {:op :CreateVpc :request {:CidrBlock &quot;192.168.0.0/16&quot; :TagSpecifications [{:ResourceType &quot;vpc&quot; :Tags [{:Key &quot;Name&quot; :Value &quot;my-vpc&quot;}]}]}}) You were right, TagSpecification is what I needed. I just had to add the mandatory ResourceType Thank you"><y>#</y><d>2023-01-11</d><h>09:17</h><r>Loic</r>Oh got it:

<pre>(aws/invoke ec2-client {:op :CreateVpc
                        :request {:CidrBlock &quot;192.168.0.0/16&quot;
                                  :TagSpecifications [{:ResourceType &quot;vpc&quot;
                                                       :Tags [{:Key &quot;Name&quot; :Value &quot;my-vpc&quot;}]}]}})</pre>
You were right, <code>TagSpecification</code> is what I needed. I just had to add the mandatory <code>ResourceType</code>

Thank you</z><z id="t1673430007" t="Bingen Galartza Iparragirre Great!"><y>#</y><d>2023-01-11</d><h>09:40</h><r>Bingen Galartza Iparragirre</r>Great!</z><z id="t1673464069" t="kouvas Is there already a way to easily convert a dynamoDB response map with types to one without?"><y>#</y><d>2023-01-11</d><h>19:07</h><w>kouvas</w>Is there already a way to easily convert a dynamoDB response map with types to one without?</z><z id="t1673519655" t="Dimitar Uzunov Which API are you using? There should be methods to marshall and unmarshall dynamodb JSON"><y>#</y><d>2023-01-12</d><h>10:34</h><r>Dimitar Uzunov</r>Which API are you using? There should be methods to marshall and unmarshall dynamodb JSON</z><z id="t1673520285" t="Dimitar Uzunov https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/modules/_aws_sdk_util_dynamodb.html"><y>#</y><d>2023-01-12</d><h>10:44</h><r>Dimitar Uzunov</r><a href="https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/modules/_aws_sdk_util_dynamodb.html" target="_blank">https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/modules/_aws_sdk_util_dynamodb.html</a></z><z id="t1673546862" t="kouvas Cognitect&apos;s api, don&apos;t see support for marhsalling"><y>#</y><d>2023-01-12</d><h>18:07</h><r>kouvas</r>Cognitect&apos;s api, don&apos;t see support for marhsalling</z><z id="t1673644388" t="kouvas I see amazonica&apos;s ddb client supports marhalling"><y>#</y><d>2023-01-13</d><h>21:13</h><r>kouvas</r>I see amazonica&apos;s ddb client supports marhalling</z><z id="t1673647368" t="Dimitar Uzunov or if you use interop with JS or Java"><y>#</y><d>2023-01-13</d><h>22:02</h><r>Dimitar Uzunov</r>or if you use interop with JS or Java</z><z id="t1673652998" t="Dimitar Uzunov Hmm this doesn’t look too hard: https://github.com/aws/aws-sdk-js-v3/blob/6d48f1be73d63eeddef4cf10f1b05d313f9e1495/packages/util-dynamodb/src/convertToNative.ts#L12"><y>#</y><d>2023-01-13</d><h>23:36</h><r>Dimitar Uzunov</r>Hmm this doesn’t look too hard: <a href="https://github.com/aws/aws-sdk-js-v3/blob/6d48f1be73d63eeddef4cf10f1b05d313f9e1495/packages/util-dynamodb/src/convertToNative.ts#L12" target="_blank">https://github.com/aws/aws-sdk-js-v3/blob/6d48f1be73d63eeddef4cf10f1b05d313f9e1495/packages/util-dynamodb/src/convertToNative.ts#L12</a></z><z id="t1673868112" t="dchelimsky [:attrs {:href &quot;/_/_/users/UBTMXD33J&quot;}] I&apos;m not sure what you&apos;re after here. What response are you getting and what do you want it to be?"><y>#</y><d>2023-01-16</d><h>11:21</h><r>dchelimsky</r><a>@UBTMXD33J</a> I&apos;m not sure what you&apos;re after here. What response are you getting and what do you want it to be?</z><z id="t1674171520" t="kouvas I was looking if something like this https://github.com/ctorrisi/franklin/blob/master/src/franklin/core.clj#L56-L72 was already available"><y>#</y><d>2023-01-19</d><h>23:38</h><r>kouvas</r>I was looking if something like this <a href="https://github.com/ctorrisi/franklin/blob/master/src/franklin/core.clj#L56-L72" target="_blank">https://github.com/ctorrisi/franklin/blob/master/src/franklin/core.clj#L56-L72</a> was already available</z><z id="t1674194925" t="Jungwoo Kim Hi, TL;DR) I’m struggling to find any clues to investigate and reduce a red area in the picture about GraphQL response. captured by Datadog. I’m using https://github.com/cognitect-labs/aws-api to call a dynamodb api on GraphQL. I also use https://github.com/oliyh/superlifter to resolve N+1 problems with interval settings. To handle an aws client, I have declared a single aws client in a single server. (sometimes it reached https://github.com/cognitect-labs/aws-api/blob/adc65f7ed1a040617c3b77988ff8a5bdad6cddad/README.md#ops-limit-reached under the stress test). For some reasons, if I just query of GraphQL calling only aurora db, that problem doesnt occur. So dynamodb looks suspicious but not sure. Is there anyone experienced with this sort of response patterns?"><y>#</y><d>2023-01-20</d><h>06:08</h><w>Jungwoo Kim</w>Hi,

TL;DR) I’m struggling to find any clues to investigate and reduce a red area in the picture about GraphQL response. captured by Datadog.

I’m using <a href="https://github.com/cognitect-labs/aws-api" target="_blank">https://github.com/cognitect-labs/aws-api</a> to call a dynamodb api on GraphQL. I also use <a href="https://github.com/oliyh/superlifter" target="_blank">https://github.com/oliyh/superlifter</a> to resolve N+1 problems with interval settings. To handle an aws client, I have declared a single aws client in a single server. (sometimes it reached <a href="https://github.com/cognitect-labs/aws-api/blob/adc65f7ed1a040617c3b77988ff8a5bdad6cddad/README.md#ops-limit-reached" target="_blank">https://github.com/cognitect-labs/aws-api/blob/adc65f7ed1a040617c3b77988ff8a5bdad6cddad/README.md#ops-limit-reached</a> under the stress test).

For some reasons, if I just query of GraphQL calling only aurora db, that problem doesnt occur. So dynamodb looks suspicious but not sure. Is there anyone experienced with this sort of response patterns?</z><z id="t1674195004" t="Jungwoo Kim is that possible that a long wait of requests/responses even though ops limit error is not happened?"><y>#</y><d>2023-01-20</d><h>06:10</h><r>Jungwoo Kim</r>is that possible that a long wait of requests/responses even though ops limit error is not happened?</z><z id="t1674195176" t="Jungwoo Kim let me know if you have any information to get to know this phenomenon."><y>#</y><d>2023-01-20</d><h>06:12</h><r>Jungwoo Kim</r>let me know if you have any information to get to know this phenomenon.</z><z id="t1674243979" t="hkrish I am using Pedestal and try to call AWS Cognito idp API with cognitect aws library. Created a User Pool at Cognito, and created new IAM user. I have set up the credential &amp; config files at .aws directory. The AWS CLI call works just fine, and showing the User Pool Information as below: $$&gt; aws cognito-idp list-user-pools --region us-west-1 --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-west-1_uVhjybJkfk&quot;, &quot;Name&quot;: &quot;XXXXXX&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot; } ] } But the from the REPL using Cognitect API: (aws/invoke cognito-idp {:op :SignUp :request {:ClientId &quot;XXXXXXXX&quot; :Username &quot;&lt;mailto: /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt;&quot; :Password &quot;Password&quot; :SecretHash (calculate-secret-hash {:client-id &quot;-------&quot; :client-secret &quot;--------&quot; :username &quot;&lt;mailto: /cdn-cgi/l/email-protection | /cdn-cgi/l/email-protection &gt;&quot;})}}) =&gt; {: type &quot;ResourceNotFoundException&quot;, :message &quot;User pool client XXXXXXX does not exist.&quot;, :cognitect.anomalies/category :cognitect.anomalies/incorrect} Any hints? Thanks in advance."><y>#</y><d>2023-01-20</d><h>19:46</h><w>hkrish</w>I am using Pedestal and try to call AWS Cognito idp API with cognitect aws library.  Created a User Pool at Cognito, and created new IAM user.  I have set up the credential &amp; config files at .aws directory.  The AWS CLI call works just fine, and showing the User Pool Information as below:

$$&gt; aws  cognito-idp list-user-pools --region us-west-1 --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-west-1_uVhjybJkfk&quot;,
            &quot;Name&quot;: &quot;XXXXXX&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-19T23:09:55.977000-08:00&quot;
        }
    ]
}

But the from the REPL using Cognitect API:

(aws/invoke cognito-idp
              {:op :SignUp
               :request
               {:ClientId  &quot;XXXXXXXX&quot;
                :Username &quot;&lt;mailto:<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;&quot;
                :Password &quot;Password&quot;
                :SecretHash (calculate-secret-hash
                              {:client-id &quot;-------&quot;
                               :client-secret &quot;--------&quot;
                               :username &quot;&lt;mailto:<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>|<a href="/cdn-cgi/l/email-protection" target="_blank">/cdn-cgi/l/email-protection</a>&gt;&quot;})}})
=&gt;
{:type &quot;ResourceNotFoundException&quot;,
 :message &quot;User pool client XXXXXXX does not exist.&quot;,
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}

Any hints?  Thanks in advance.</z><z id="t1674261232" t="hkrish I think I got it solved. I am not sure this is the cause. But I found it very interesting. 1. Created a user pool on us-west-1. Run the command: % aws cognito-idp list-user-pools --region us-west-1 --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-west-1_mUijhrymkU&quot;, &quot;Name&quot;: &quot;--&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot; } ] } 2. Run the command again with no region parameter: % aws cognito-idp list-user-pools --max-results 10 { &quot;UserPools&quot;: [] } 3. Created a user pool on us-east-1. Run the command: % aws cognito-idp list-user-pools --max-results 10 { &quot;UserPools&quot;: [ { &quot;Id&quot;: &quot;us-east-1_7nUtrAsfj&quot;, &quot;Name&quot;: &quot;----&quot;, &quot;LambdaConfig&quot;: {}, &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;, &quot;CreationDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot; } ] } Interesting. So when I call the cognito-idp Signup API from cognitect aws api, I got this response on the REPL: {:UserConfirmed false, :CodeDeliveryDetails {:Destination &quot;h* [:attrs {:class &quot;username&quot;}] *&quot;, :DeliveryMedium &quot;EMAIL&quot;, :AttributeName &quot;email&quot;}, :UserSub &quot;53bc5c-------------------24----d52&quot;} Problem solved by creating the USER POOL in the US-EAST-1 region!! (A bug in the AWS CLI?)"><y>#</y><d>2023-01-21</d><h>00:33</h><r>hkrish</r>I think I got it solved.  I am not sure this is the cause.  But I found it very interesting.

1. Created a user pool on us-west-1.  Run the command:
% aws  cognito-idp list-user-pools --region us-west-1 --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-west-1_mUijhrymkU&quot;,
            &quot;Name&quot;: &quot;--&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-20T14:12:50.797000-08:00&quot;
        }
    ]
}
2. Run the command again with no region parameter:
 % aws  cognito-idp list-user-pools  --max-results 10
{
    &quot;UserPools&quot;: []
}
3. Created a user pool on us-east-1.  Run the command:
% aws  cognito-idp list-user-pools  --max-results 10
{
    &quot;UserPools&quot;: [
        {
            &quot;Id&quot;: &quot;us-east-1_7nUtrAsfj&quot;,
            &quot;Name&quot;: &quot;----&quot;,
            &quot;LambdaConfig&quot;: {},
            &quot;LastModifiedDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;,
            &quot;CreationDate&quot;: &quot;2023-01-20T14:26:53.394000-08:00&quot;
        }
    ]
}
Interesting.  So when I call the cognito-idp Signup API from cognitect aws api, I got this response on the REPL:

{:UserConfirmed false,
 :CodeDeliveryDetails {:Destination &quot;h*<span>{:tag :a, :attrs {:href &quot;/_/_/users/UAKE446AJ&quot;}, :content (&quot;@UAKE446AJ&quot;)}</span>*&quot;, :DeliveryMedium &quot;EMAIL&quot;, :AttributeName &quot;email&quot;},
 :UserSub &quot;53bc5c-------------------24----d52&quot;}

Problem solved by creating the USER POOL in the US-EAST-1 region!!  (A bug in the AWS CLI?)</z><z id="t1675263104" t="CarnunMP Hi. I&apos;m in the process of deploying a Clojure webapp to Elastic Beanstalk as per https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161 (cc: [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] 🙏 ) And it&apos;s working, it&apos;s up and running... but CPU utilization Idle% hovers near 100% and page load times are (consequently) super sluggish. Granted, it&apos;s a single t2.small instance (up from the t2.micro that I started with). But still! Any general thoughts as to why, before I dive into figuring out monitoring and profiling and such on AWS (all ~new to me) and hopefully get to the root of it? E.g. is it expected that running Clojure apps this way is more CPU-intensive than running an Uberjar? :thinking_face:"><y>#</y><d>2023-02-01</d><h>14:51</h><w>CarnunMP</w>Hi. I&apos;m in the process of deploying a Clojure webapp to Elastic Beanstalk as per <a href="https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161" target="_blank">https://clojureverse.org/t/running-a-clojure-application-on-aws-elastic-beanstalk-with-clojure-cli-tools/4161</a> (cc: <a>@orestis</a> <b>🙏</b>)

And it&apos;s working, it&apos;s up and running... but CPU utilization Idle% hovers near 100% and page load times are (consequently) super sluggish.

Granted, it&apos;s a single <code>t2.small</code> instance (up from the <code>t2.micro</code> that I started with). But still!

Any general thoughts as to why, before I dive into figuring out monitoring and profiling and such on AWS (all ~new to me) and hopefully get to the root of it? E.g. is it expected that running Clojure apps this way is more CPU-intensive than running an Uberjar? <b>:thinking_face:</b></z><z id="t1675263201" t="orestis Shouldn&apos;t you see idle% close to 100%?"><y>#</y><d>2023-02-01</d><h>14:53</h><r>orestis</r>Shouldn&apos;t you see idle% close to 100%?</z><z id="t1675263210" t="orestis That means it&apos;s an idle instance 🙂"><y>#</y><d>2023-02-01</d><h>14:53</h><r>orestis</r>That means it&apos;s an idle instance <b>🙂</b></z><z id="t1675263286" t="orestis For the first few ~seconds, you might still be compiling (but you wouldn&apos;t see a response just yet)."><y>#</y><d>2023-02-01</d><h>14:54</h><r>orestis</r>For the first few ~seconds, you might still be compiling (but you wouldn&apos;t see a response just yet).</z><z id="t1675263331" t="orestis Have you checked whether it&apos;s the database that&apos;s slow? If you have a page that just does CPU-only stuff (just rendering some html without touching network/filesystem) you should be able to see if it&apos;s the CPU that&apos;s slow or something else."><y>#</y><d>2023-02-01</d><h>14:55</h><r>orestis</r>Have you checked whether it&apos;s the database that&apos;s slow? If you have a page that just does CPU-only stuff (just rendering some html without touching network/filesystem) you should be able to see if it&apos;s the CPU that&apos;s slow or something else.</z><z id="t1675263371" t="orestis Our staging environment runs on a t3.medium and it&apos;s very acceptable performance wise."><y>#</y><d>2023-02-01</d><h>14:56</h><r>orestis</r>Our staging environment runs on a t3.medium and it&apos;s very acceptable performance wise.</z><z id="t1675263472" t="CarnunMP &gt; Shouldn&apos;t you see idle% close to 100%? D&apos;oh if so! 😄 But it&apos;s not just the (maybe misread) CPU usage that&apos;s throwing me off. Health stuff keeps dipping into &apos;Severe&apos; more generally:"><y>#</y><d>2023-02-01</d><h>14:57</h><r>CarnunMP</r>&gt; Shouldn&apos;t you see idle% close to 100%?
D&apos;oh if so! <b>😄</b>

But it&apos;s not just the (maybe misread) CPU usage that&apos;s throwing me off. Health stuff keeps dipping into &apos;Severe&apos; more generally:</z><z id="t1675263604" t="CarnunMP Also not a first few secs (or first request) vs subsequent requests problem. It&apos;s every page load that&apos;s slow. (Perhaps because I&apos;m generating/parsing each page anew from markdown stored in the DB, and this would be the time to look into doing some caching...? 😅 )"><y>#</y><d>2023-02-01</d><h>15:00</h><r>CarnunMP</r>Also not a first few secs (or first request) vs subsequent requests problem. It&apos;s every page load that&apos;s slow. (Perhaps because I&apos;m generating/parsing each page anew from markdown stored in the DB, and this would be the time to look into doing some caching...? <b>😅</b> )</z><z id="t1675263670" t="CarnunMP &gt; Have you checked whether it&apos;s the database that&apos;s slow? If you have a page that just does CPU-only stuff (just rendering some html without touching network/filesystem) you should be able to see if it&apos;s the CPU that&apos;s slow or something else. Hmm, I&apos;ll give this a shot. 🙂"><y>#</y><d>2023-02-01</d><h>15:01</h><r>CarnunMP</r>&gt;  Have you checked whether it&apos;s the database that&apos;s slow? If you have a page that just does CPU-only stuff (just rendering some html without touching network/filesystem) you should be able to see if it&apos;s the CPU that&apos;s slow or something else.
Hmm, I&apos;ll give this a shot. <b>🙂</b></z><z id="t1675263739" t="orestis Can you check perhaps if your application is restarting all the time? Do you see anything suspicious in the logs?"><y>#</y><d>2023-02-01</d><h>15:02</h><r>orestis</r>Can you check perhaps if your application is restarting all the time? Do you see anything suspicious in the logs?</z><z id="t1675263823" t="orestis Looks like you had only 2 requests, so probably it&apos;s not the requests that are causing this."><y>#</y><d>2023-02-01</d><h>15:03</h><r>orestis</r>Looks like you had only 2 requests, so probably it&apos;s not the requests that are causing this.</z><z id="t1675263905" t="CarnunMP One suspicious thing is that it looks like there are constant GETs of / : Feb 1 14:32:24 ip-172-31-80-204 web: system started Feb 1 14:32:28 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:28 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:30 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:43 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:43 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:45 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:58 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:32:58 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:00 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:13 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:13 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:15 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /words/1C67kb9It/home&quot;, :line 80} Feb 1 14:33:30 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:36 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /words/FC9iGu9V5/foo&quot;, :line 80} Feb 1 14:33:43 ip-172-31-80-204 web: [qtp1843774765-20] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:43 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:45 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80} Feb 1 14:33:58 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}"><y>#</y><d>2023-02-01</d><h>15:05</h><r>CarnunMP</r>One suspicious thing is that it looks like there are constant GETs of <code>/</code>:

<pre>Feb  1 14:32:24 ip-172-31-80-204 web: system started
Feb  1 14:32:28 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:28 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:30 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:43 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:43 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:45 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:58 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:32:58 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:00 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:13 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:13 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:15 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:28 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /words/1C67kb9It/home&quot;, :line 80}
Feb  1 14:33:30 ip-172-31-80-204 web: [qtp1843774765-17] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:36 ip-172-31-80-204 web: [qtp1843774765-21] INFO io.pedestal.http - {:msg &quot;GET /words/FC9iGu9V5/foo&quot;, :line 80}
Feb  1 14:33:43 ip-172-31-80-204 web: [qtp1843774765-20] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:43 ip-172-31-80-204 web: [qtp1843774765-23] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:45 ip-172-31-80-204 web: [qtp1843774765-22] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}
Feb  1 14:33:58 ip-172-31-80-204 web: [qtp1843774765-24] INFO io.pedestal.http - {:msg &quot;GET /&quot;, :line 80}</pre></z><z id="t1675263926" t="orestis Sounds like the health check"><y>#</y><d>2023-02-01</d><h>15:05</h><r>orestis</r>Sounds like the health check</z><z id="t1675263974" t="orestis We&apos;ve set the health check endpoint to something like _health so that it&apos;s obvious in the logs. We just reach out to the database (to check connectivity, a simple &quot;SELECT 1&quot; does the trick) and return a 200."><y>#</y><d>2023-02-01</d><h>15:06</h><r>orestis</r>We&apos;ve set the health check endpoint to something like <code>_health</code> so that it&apos;s obvious in the logs. We just reach out to the database (to check connectivity, a simple &quot;SELECT 1&quot; does the trick) and return a 200.</z><z id="t1675264083" t="CarnunMP Hmm, makes sense! Maybe the health check doesn&apos;t like that / returns a 302? :thinking_face: /var/log/nginx/access.log ---------------------------------------- 172.31.67.190 - - [01/Feb/2023:14:57:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.94.1 - - [01/Feb/2023:14:58:01 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.34.70 - - [01/Feb/2023:14:58:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.67.190 - - [01/Feb/2023:14:58:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.94.1 - - [01/Feb/2023:14:58:16 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.34.70 - - [01/Feb/2023:14:58:29 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.67.190 - - [01/Feb/2023:14:58:29 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.94.1 - - [01/Feb/2023:14:58:31 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.67.190 - - [01/Feb/2023:14:58:44 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.34.70 - - [01/Feb/2023:14:58:44 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.94.1 - - [01/Feb/2023:14:58:46 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.67.190 - - [01/Feb/2023:14:58:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.34.70 - - [01/Feb/2023:14:58:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.94.1 - - [01/Feb/2023:14:59:01 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.67.190 - - [01/Feb/2023:14:59:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; 172.31.34.70 - - [01/Feb/2023:14:59:15 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot; ... ---------------------------------------- /var/log/nginx/error.log ---------------------------------------- 2023/02/01 14:24:00 [error] 20449#20449: *259 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:13 [error] 20449#20449: *261 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:13 [error] 20449#20449: *263 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:15 [error] 20449#20449: *265 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:28 [error] 20449#20449: *267 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:28 [error] 20449#20449: *269 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:30 [error] 20449#20449: *271 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:43 [error] 20449#20449: *273 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:43 [error] 20449#20449: *275 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:45 [error] 20449#20449: *277 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:58 [error] 20449#20449: *279 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:24:58 [error] 20449#20449: *281 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:25:00 [error] 20449#20449: *283 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:25:13 [error] 20449#20449: *285 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot; 2023/02/01 14:25:13 [error] 20449#20449: *287 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;"><y>#</y><d>2023-02-01</d><h>15:08</h><r>CarnunMP</r>Hmm, makes sense! Maybe the health check doesn&apos;t like that <code>/</code> returns a 302? <b>:thinking_face:</b>

<pre>/var/log/nginx/access.log
----------------------------------------
172.31.67.190 - - [01/Feb/2023:14:57:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.94.1 - - [01/Feb/2023:14:58:01 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.34.70 - - [01/Feb/2023:14:58:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.67.190 - - [01/Feb/2023:14:58:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.94.1 - - [01/Feb/2023:14:58:16 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.34.70 - - [01/Feb/2023:14:58:29 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.67.190 - - [01/Feb/2023:14:58:29 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.94.1 - - [01/Feb/2023:14:58:31 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.67.190 - - [01/Feb/2023:14:58:44 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.34.70 - - [01/Feb/2023:14:58:44 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.94.1 - - [01/Feb/2023:14:58:46 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.67.190 - - [01/Feb/2023:14:58:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.34.70 - - [01/Feb/2023:14:58:59 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.94.1 - - [01/Feb/2023:14:59:01 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.67.190 - - [01/Feb/2023:14:59:14 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;
172.31.34.70 - - [01/Feb/2023:14:59:15 +0000] &quot;GET / HTTP/1.1&quot; 302 5 &quot;-&quot; &quot;ELB-HealthChecker/2.0&quot; &quot;-&quot;

...

----------------------------------------
/var/log/nginx/error.log
----------------------------------------
2023/02/01 14:24:00 [error] 20449#20449: *259 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:13 [error] 20449#20449: *261 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:13 [error] 20449#20449: *263 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:15 [error] 20449#20449: *265 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:28 [error] 20449#20449: *267 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:28 [error] 20449#20449: *269 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:30 [error] 20449#20449: *271 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:43 [error] 20449#20449: *273 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:43 [error] 20449#20449: *275 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:45 [error] 20449#20449: *277 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:58 [error] 20449#20449: *279 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:24:58 [error] 20449#20449: *281 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:25:00 [error] 20449#20449: *283 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.94.1, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:25:13 [error] 20449#20449: *285 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.34.70, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;
2023/02/01 14:25:13 [error] 20449#20449: *287 connect() failed (111: Connection refused) while connecting to upstream, client: 172.31.67.190, server: , request: &quot;GET / HTTP/1.1&quot;, upstream: &quot;&quot;, host: &quot;172.31.80.204&quot;</pre></z><z id="t1675264122" t="CarnunMP &gt; We&apos;ve set the health check endpoint to something like _health so that it&apos;s obvious in the logs. We just reach out to the database (to check connectivity, a simple &quot;SELECT 1&quot; does the trick) and return a 200. Neat!"><y>#</y><d>2023-02-01</d><h>15:08</h><r>CarnunMP</r>&gt;  We&apos;ve set the health check endpoint to something like <code>_health</code> so that it&apos;s obvious in the logs. We just reach out to the database (to check connectivity, a simple &quot;SELECT 1&quot; does the trick) and return a 200.
Neat!</z><z id="t1675264491" t="orestis Yep, I think it’s best to always have an explicit health check path that can do exactly what you need it to, without authentication and other concerns. "><y>#</y><d>2023-02-01</d><h>15:14</h><r>orestis</r>Yep, I think it’s best to always have an explicit health check path that can do exactly what you need it to, without authentication and other concerns. </z><z id="t1675264537" t="CarnunMP It&apos;s possible that&apos;s the only reason I&apos;m getting health warnings."><y>#</y><d>2023-02-01</d><h>15:15</h><r>CarnunMP</r>It&apos;s possible that&apos;s the only reason I&apos;m getting health warnings.</z><z id="t1675264639" t="CarnunMP But still there&apos;s the question of slow loads, hmm... Out of interest [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] , how would you go about monitoring/profiling such a project? (E.g. is it worth setting up X-Ray?)"><y>#</y><d>2023-02-01</d><h>15:17</h><r>CarnunMP</r>But still there&apos;s the question of slow loads, hmm...

Out of interest <a>@orestis</a>, how would you go about monitoring/profiling such a project? (E.g. is it worth setting up X-Ray?)</z><z id="t1675264659" t="orestis You get a lot of nginx errors too"><y>#</y><d>2023-02-01</d><h>15:17</h><r>orestis</r>You get a lot of nginx errors too</z><z id="t1675264704" t="orestis We use cloud watch. X-ray is for tracing individual requests which is useful but at another level. "><y>#</y><d>2023-02-01</d><h>15:18</h><r>orestis</r>We use cloud watch. X-ray is for tracing individual requests which is useful but at another level. </z><z id="t1675264853" t="orestis In the beginning, the easiest way is to ssh in and tail the log files."><y>#</y><d>2023-02-01</d><h>15:20</h><r>orestis</r>In the beginning, the easiest way is to ssh in and tail the log files.</z><z id="t1675264856" t="CarnunMP &gt; You get a lot of nginx errors too Hmm... still need to confirm the 302 hunch of course, but I assumed this was the same problem?"><y>#</y><d>2023-02-01</d><h>15:20</h><r>CarnunMP</r>&gt;  You get a lot of nginx errors too
Hmm... still need to confirm the 302 hunch of course, but I assumed this was the same problem?</z><z id="t1675264891" t="orestis It&apos;s curious that nginx reports &quot;connection refused&quot; too. You should see this during application startup but not any more."><y>#</y><d>2023-02-01</d><h>15:21</h><r>orestis</r>It&apos;s curious that nginx reports &quot;connection refused&quot; too. You should see this during application startup but not any more.</z><z id="t1675264993" t="orestis No, the 302 you see in the pedestal logs which means it&apos;s already past the nginx and into your Clojure code. The 500 means nginx can&apos;t connect to your app. It seems that the timestamps are different though (14:25 for the errors, 14:59 for the 302)"><y>#</y><d>2023-02-01</d><h>15:23</h><r>orestis</r>No, the 302 you see in the pedestal logs which means it&apos;s already past the nginx and into your Clojure code. The 500 means nginx can&apos;t connect to your app. It seems that the timestamps are different though (14:25 for the errors, 14:59 for the 302)</z><z id="t1675265066" t="CarnunMP &gt; It&apos;s curious that nginx reports &quot;connection refused&quot; too. You should see this during application startup but not any more. Hmm, ^that might be exactly it actually... looking more carefully at the timestamps. :))"><y>#</y><d>2023-02-01</d><h>15:24</h><r>CarnunMP</r>&gt;  It&apos;s curious that nginx reports &quot;connection refused&quot; too. You should see this during application startup but not any more.
Hmm, ^that might be exactly it actually... looking more carefully at the timestamps. :))</z><z id="t1675265076" t="CarnunMP Gotcha!"><y>#</y><d>2023-02-01</d><h>15:24</h><r>CarnunMP</r>Gotcha!</z><z id="t1675265090" t="CarnunMP And ha, yeah. Beat me to noticing the timestamps. 😛"><y>#</y><d>2023-02-01</d><h>15:24</h><r>CarnunMP</r>And ha, yeah. Beat me to noticing the timestamps. <b>😛</b></z><z id="t1675265151" t="CarnunMP Brill, okay. I have some stuff to dig into. Thanks a bunch [:attrs {:href &quot;/_/_/users/U7PBP4UVA&quot;}] !"><y>#</y><d>2023-02-01</d><h>15:25</h><r>CarnunMP</r>Brill, okay. I have some stuff to dig into. Thanks a bunch <a>@orestis</a>!</z><z id="t1675265178" t="orestis 🙌"><y>#</y><d>2023-02-01</d><h>15:26</h><r>orestis</r><b>🙌</b></z><z id="t1675279500" t="CarnunMP Been away from this for a little while. But the dedicated health check endpoint is working a treat! 🙂"><y>#</y><d>2023-02-01</d><h>19:25</h><r>CarnunMP</r>Been away from this for a little while. But the dedicated health check endpoint is working a treat! <b>🙂</b></z><z id="t1675330895" t="msolli A nice way to tail logs on AWS EB is using the aws command-line tool: aws logs tail /aws/elasticbeanstalk/&lt;env-name&gt;/var/log/web.stdout.log --follow"><y>#</y><d>2023-02-02</d><h>09:41</h><r>msolli</r>A nice way to tail logs on AWS EB is using the aws command-line tool:
<code>aws logs tail /aws/elasticbeanstalk/&lt;env-name&gt;/var/log/web.stdout.log --follow</code></z><z id="t1675331093" t="msolli For troubleshooting performance issues I use https://github.com/steffan-westcott/clj-otel along with service providers such as Honeycomb and New Relic. I’m sure you can use X-Ray too."><y>#</y><d>2023-02-02</d><h>09:44</h><r>msolli</r>For troubleshooting performance issues I use <a href="https://github.com/steffan-westcott/clj-otel" target="_blank">https://github.com/steffan-westcott/clj-otel</a> along with service providers such as Honeycomb and New Relic. I’m sure you can use X-Ray too.</z><z id="t1675348533" t="CarnunMP Fuck yeah. ~10x faster page loads (e.g. see first and last foo?single=true req in screenshot) after ruling out the DB connection as slow, some profiling with https://github.com/clojure-goes-fast/clj-async-profiler identifying page parsing/generation as the likely culprit, and implementing caching. https://clojurians.slack.com/archives/C09N0H1RB/p1675263604685469?thread_ts=1675263104.785889&amp;amp;cid=C09N0H1RB"><y>#</y><d>2023-02-02</d><h>14:35</h><r>CarnunMP</r>Fuck yeah. ~10x faster page loads (e.g. see first and last <code>foo?single=true</code> req in screenshot) after ruling out the DB connection as slow, some profiling with <a href="https://github.com/clojure-goes-fast/clj-async-profiler" target="_blank">https://github.com/clojure-goes-fast/clj-async-profiler</a> identifying page parsing/generation as the likely culprit, and implementing caching.

<a href="https://clojurians.slack.com/archives/C09N0H1RB/p1675263604685469?thread_ts=1675263104.785889&amp;amp;cid=C09N0H1RB" target="_blank">https://clojurians.slack.com/archives/C09N0H1RB/p1675263604685469?thread_ts=1675263104.785889&amp;amp;cid=C09N0H1RB</a></z></g></div></body>